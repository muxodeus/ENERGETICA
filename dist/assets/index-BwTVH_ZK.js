(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const A of d.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&s(A)}).observe(document,{childList:!0,subtree:!0});function i(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(c){if(c.ep)return;c.ep=!0;const d=i(c);fetch(c.href,d)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function v1(a){const e=Object.create(null);for(const i of a.split(","))e[i]=1;return i=>i in e}const da={},Kg=[],jA=()=>{},c3=()=>!1,Qv=a=>a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&(a.charCodeAt(2)>122||a.charCodeAt(2)<97),_1=a=>a.startsWith("onUpdate:"),lu=Object.assign,x1=(a,e)=>{const i=a.indexOf(e);i>-1&&a.splice(i,1)},u3=Object.prototype.hasOwnProperty,Do=(a,e)=>u3.call(a,e),Gn=Array.isArray,qg=a=>Hy(a)==="[object Map]",Vv=a=>Hy(a)==="[object Set]",XC=a=>Hy(a)==="[object Date]",Bs=a=>typeof a=="function",Ml=a=>typeof a=="string",QA=a=>typeof a=="symbol",wa=a=>a!==null&&typeof a=="object",YE=a=>(wa(a)||Bs(a))&&Bs(a.then)&&Bs(a.catch),KE=Object.prototype.toString,Hy=a=>KE.call(a),h3=a=>Hy(a).slice(8,-1),qE=a=>Hy(a)==="[object Object]",b1=a=>Ml(a)&&a!=="NaN"&&a[0]!=="-"&&""+parseInt(a,10)===a,cy=v1(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gv=a=>{const e=Object.create(null);return i=>e[i]||(e[i]=a(i))},d3=/-(\w)/g,ad=Gv(a=>a.replace(d3,(e,i)=>i?i.toUpperCase():"")),A3=/\B([A-Z])/g,yg=Gv(a=>a.replace(A3,"-$1").toLowerCase()),Wv=Gv(a=>a.charAt(0).toUpperCase()+a.slice(1)),Px=Gv(a=>a?`on${Wv(a)}`:""),pp=(a,e)=>!Object.is(a,e),ov=(a,...e)=>{for(let i=0;i<a.length;i++)a[i](...e)},wb=(a,e,i,s=!1)=>{Object.defineProperty(a,e,{configurable:!0,enumerable:!1,writable:s,value:i})},bv=a=>{const e=parseFloat(a);return isNaN(e)?a:e};let YC;const Xv=()=>YC||(YC=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function w1(a){if(Gn(a)){const e={};for(let i=0;i<a.length;i++){const s=a[i],c=Ml(s)?m3(s):w1(s);if(c)for(const d in c)e[d]=c[d]}return e}else if(Ml(a)||wa(a))return a}const f3=/;(?![^(]*\))/g,p3=/:([^]+)/,g3=/\/\*[^]*?\*\//g;function m3(a){const e={};return a.replace(g3,"").split(f3).forEach(i=>{if(i){const s=i.split(p3);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function yp(a){let e="";if(Ml(a))e=a;else if(Gn(a))for(let i=0;i<a.length;i++){const s=yp(a[i]);s&&(e+=s+" ")}else if(wa(a))for(const i in a)a[i]&&(e+=i+" ");return e.trim()}const y3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",v3=v1(y3);function $E(a){return!!a||a===""}function _3(a,e){if(a.length!==e.length)return!1;let i=!0;for(let s=0;i&&s<a.length;s++)i=Yv(a[s],e[s]);return i}function Yv(a,e){if(a===e)return!0;let i=XC(a),s=XC(e);if(i||s)return i&&s?a.getTime()===e.getTime():!1;if(i=QA(a),s=QA(e),i||s)return a===e;if(i=Gn(a),s=Gn(e),i||s)return i&&s?_3(a,e):!1;if(i=wa(a),s=wa(e),i||s){if(!i||!s)return!1;const c=Object.keys(a).length,d=Object.keys(e).length;if(c!==d)return!1;for(const A in a){const r=a.hasOwnProperty(A),y=e.hasOwnProperty(A);if(r&&!y||!r&&y||!Yv(a[A],e[A]))return!1}}return String(a)===String(e)}function x3(a,e){return a.findIndex(i=>Yv(i,e))}const ZE=a=>!!(a&&a.__v_isRef===!0),$s=a=>Ml(a)?a:a==null?"":Gn(a)||wa(a)&&(a.toString===KE||!Bs(a.toString))?ZE(a)?$s(a.value):JSON.stringify(a,JE,2):String(a),JE=(a,e)=>ZE(e)?JE(a,e.value):qg(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[s,c],d)=>(i[kx(s,d)+" =>"]=c,i),{})}:Vv(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>kx(i))}:QA(e)?kx(e):wa(e)&&!Gn(e)&&!qE(e)?String(e):e,kx=(a,e="")=>{var i;return QA(a)?`Symbol(${(i=a.description)!=null?i:e})`:a};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rh;class b3{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=rh,!e&&rh&&(this.index=(rh.scopes||(rh.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=rh;try{return rh=this,e()}finally{rh=i}}}on(){++this._on===1&&(this.prevScope=rh,rh=this)}off(){this._on>0&&--this._on===0&&(rh=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(this.effects.length=0,i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function w3(){return rh}let xa;const Rx=new WeakSet;class e5{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,rh&&rh.active&&rh.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Rx.has(this)&&(Rx.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||i5(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,KC(this),r5(this);const e=xa,i=Wd;xa=this,Wd=!0;try{return this.fn()}finally{n5(this),xa=e,Wd=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)S1(e);this.deps=this.depsTail=void 0,KC(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Rx.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Bb(this)&&this.run()}get dirty(){return Bb(this)}}let t5=0,uy,hy;function i5(a,e=!1){if(a.flags|=8,e){a.next=hy,hy=a;return}a.next=uy,uy=a}function B1(){t5++}function C1(){if(--t5>0)return;if(hy){let e=hy;for(hy=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let a;for(;uy;){let e=uy;for(uy=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){a||(a=s)}e=i}}if(a)throw a}function r5(a){for(let e=a.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function n5(a){let e,i=a.depsTail,s=i;for(;s;){const c=s.prevDep;s.version===-1?(s===i&&(i=c),S1(s),B3(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=c}a.deps=e,a.depsTail=i}function Bb(a){for(let e=a.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(s5(e.dep.computed)||e.dep.version!==e.version))return!0;return!!a._dirty}function s5(a){if(a.flags&4&&!(a.flags&16)||(a.flags&=-17,a.globalVersion===Cy)||(a.globalVersion=Cy,!a.isSSR&&a.flags&128&&(!a.deps&&!a._dirty||!Bb(a))))return;a.flags|=2;const e=a.dep,i=xa,s=Wd;xa=a,Wd=!0;try{r5(a);const c=a.fn(a._value);(e.version===0||pp(c,a._value))&&(a.flags|=128,a._value=c,e.version++)}catch(c){throw e.version++,c}finally{xa=i,Wd=s,n5(a),a.flags&=-3}}function S1(a,e=!1){const{dep:i,prevSub:s,nextSub:c}=a;if(s&&(s.nextSub=c,a.prevSub=void 0),c&&(c.prevSub=s,a.nextSub=void 0),i.subs===a&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let d=i.computed.deps;d;d=d.nextDep)S1(d,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function B3(a){const{prevDep:e,nextDep:i}=a;e&&(e.nextDep=i,a.prevDep=void 0),i&&(i.prevDep=e,a.nextDep=void 0)}let Wd=!0;const o5=[];function wf(){o5.push(Wd),Wd=!1}function Bf(){const a=o5.pop();Wd=a===void 0?!0:a}function KC(a){const{cleanup:e}=a;if(a.cleanup=void 0,e){const i=xa;xa=void 0;try{e()}finally{xa=i}}}let Cy=0;class C3{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class E1{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!xa||!Wd||xa===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==xa)i=this.activeLink=new C3(xa,this),xa.deps?(i.prevDep=xa.depsTail,xa.depsTail.nextDep=i,xa.depsTail=i):xa.deps=xa.depsTail=i,a5(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const s=i.nextDep;s.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=s),i.prevDep=xa.depsTail,i.nextDep=void 0,xa.depsTail.nextDep=i,xa.depsTail=i,xa.deps===i&&(xa.deps=s)}return i}trigger(e){this.version++,Cy++,this.notify(e)}notify(e){B1();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{C1()}}}function a5(a){if(a.dep.sc++,a.sub.flags&4){const e=a.dep.computed;if(e&&!a.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)a5(s)}const i=a.dep.subs;i!==a&&(a.prevSub=i,i&&(i.nextSub=a)),a.dep.subs=a}}const wv=new WeakMap,lg=Symbol(""),Cb=Symbol(""),Sy=Symbol("");function su(a,e,i){if(Wd&&xa){let s=wv.get(a);s||wv.set(a,s=new Map);let c=s.get(i);c||(s.set(i,c=new E1),c.map=s,c.key=i),c.track()}}function vf(a,e,i,s,c,d){const A=wv.get(a);if(!A){Cy++;return}const r=y=>{y&&y.trigger()};if(B1(),e==="clear")A.forEach(r);else{const y=Gn(a),b=y&&b1(i);if(y&&i==="length"){const x=Number(s);A.forEach((B,T)=>{(T==="length"||T===Sy||!QA(T)&&T>=x)&&r(B)})}else switch((i!==void 0||A.has(void 0))&&r(A.get(i)),b&&r(A.get(Sy)),e){case"add":y?b&&r(A.get("length")):(r(A.get(lg)),qg(a)&&r(A.get(Cb)));break;case"delete":y||(r(A.get(lg)),qg(a)&&r(A.get(Cb)));break;case"set":qg(a)&&r(A.get(lg));break}}C1()}function S3(a,e){const i=wv.get(a);return i&&i.get(e)}function zg(a){const e=Lo(a);return e===a?e:(su(e,"iterate",Sy),sd(a)?e:e.map(Lc))}function Kv(a){return su(a=Lo(a),"iterate",Sy),a}const E3={__proto__:null,[Symbol.iterator](){return Dx(this,Symbol.iterator,Lc)},concat(...a){return zg(this).concat(...a.map(e=>Gn(e)?zg(e):e))},entries(){return Dx(this,"entries",a=>(a[1]=Lc(a[1]),a))},every(a,e){return pf(this,"every",a,e,void 0,arguments)},filter(a,e){return pf(this,"filter",a,e,i=>i.map(Lc),arguments)},find(a,e){return pf(this,"find",a,e,Lc,arguments)},findIndex(a,e){return pf(this,"findIndex",a,e,void 0,arguments)},findLast(a,e){return pf(this,"findLast",a,e,Lc,arguments)},findLastIndex(a,e){return pf(this,"findLastIndex",a,e,void 0,arguments)},forEach(a,e){return pf(this,"forEach",a,e,void 0,arguments)},includes(...a){return Ox(this,"includes",a)},indexOf(...a){return Ox(this,"indexOf",a)},join(a){return zg(this).join(a)},lastIndexOf(...a){return Ox(this,"lastIndexOf",a)},map(a,e){return pf(this,"map",a,e,void 0,arguments)},pop(){return Zm(this,"pop")},push(...a){return Zm(this,"push",a)},reduce(a,...e){return qC(this,"reduce",a,e)},reduceRight(a,...e){return qC(this,"reduceRight",a,e)},shift(){return Zm(this,"shift")},some(a,e){return pf(this,"some",a,e,void 0,arguments)},splice(...a){return Zm(this,"splice",a)},toReversed(){return zg(this).toReversed()},toSorted(a){return zg(this).toSorted(a)},toSpliced(...a){return zg(this).toSpliced(...a)},unshift(...a){return Zm(this,"unshift",a)},values(){return Dx(this,"values",Lc)}};function Dx(a,e,i){const s=Kv(a),c=s[e]();return s!==a&&!sd(a)&&(c._next=c.next,c.next=()=>{const d=c._next();return d.value&&(d.value=i(d.value)),d}),c}const T3=Array.prototype;function pf(a,e,i,s,c,d){const A=Kv(a),r=A!==a&&!sd(a),y=A[e];if(y!==T3[e]){const B=y.apply(a,d);return r?Lc(B):B}let b=i;A!==a&&(r?b=function(B,T){return i.call(this,Lc(B),T,a)}:i.length>2&&(b=function(B,T){return i.call(this,B,T,a)}));const x=y.call(A,b,s);return r&&c?c(x):x}function qC(a,e,i,s){const c=Kv(a);let d=i;return c!==a&&(sd(a)?i.length>3&&(d=function(A,r,y){return i.call(this,A,r,y,a)}):d=function(A,r,y){return i.call(this,A,Lc(r),y,a)}),c[e](d,...s)}function Ox(a,e,i){const s=Lo(a);su(s,"iterate",Sy);const c=s[e](...i);return(c===-1||c===!1)&&F1(i[0])?(i[0]=Lo(i[0]),s[e](...i)):c}function Zm(a,e,i=[]){wf(),B1();const s=Lo(a)[e].apply(a,i);return C1(),Bf(),s}const I3=v1("__proto__,__v_isRef,__isVue"),l5=new Set(Object.getOwnPropertyNames(Symbol).filter(a=>a!=="arguments"&&a!=="caller").map(a=>Symbol[a]).filter(QA));function F3(a){QA(a)||(a=String(a));const e=Lo(this);return su(e,"has",a),e.hasOwnProperty(a)}class c5{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,s){if(i==="__v_skip")return e.__v_skip;const c=this._isReadonly,d=this._isShallow;if(i==="__v_isReactive")return!c;if(i==="__v_isReadonly")return c;if(i==="__v_isShallow")return d;if(i==="__v_raw")return s===(c?d?N3:A5:d?d5:h5).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const A=Gn(e);if(!c){let y;if(A&&(y=E3[i]))return y;if(i==="hasOwnProperty")return F3}const r=Reflect.get(e,i,Dc(e)?e:s);return(QA(i)?l5.has(i):I3(i))||(c||su(e,"get",i),d)?r:Dc(r)?A&&b1(i)?r:r.value:wa(r)?c?p5(r):Qy(r):r}}class u5 extends c5{constructor(e=!1){super(!1,e)}set(e,i,s,c){let d=e[i];if(!this._isShallow){const y=vp(d);if(!sd(s)&&!vp(s)&&(d=Lo(d),s=Lo(s)),!Gn(e)&&Dc(d)&&!Dc(s))return y?!1:(d.value=s,!0)}const A=Gn(e)&&b1(i)?Number(i)<e.length:Do(e,i),r=Reflect.set(e,i,s,Dc(e)?e:c);return e===Lo(c)&&(A?pp(s,d)&&vf(e,"set",i,s):vf(e,"add",i,s)),r}deleteProperty(e,i){const s=Do(e,i);e[i];const c=Reflect.deleteProperty(e,i);return c&&s&&vf(e,"delete",i,void 0),c}has(e,i){const s=Reflect.has(e,i);return(!QA(i)||!l5.has(i))&&su(e,"has",i),s}ownKeys(e){return su(e,"iterate",Gn(e)?"length":lg),Reflect.ownKeys(e)}}class L3 extends c5{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const M3=new u5,P3=new L3,k3=new u5(!0);const Sb=a=>a,K0=a=>Reflect.getPrototypeOf(a);function R3(a,e,i){return function(...s){const c=this.__v_raw,d=Lo(c),A=qg(d),r=a==="entries"||a===Symbol.iterator&&A,y=a==="keys"&&A,b=c[a](...s),x=i?Sb:e?Bv:Lc;return!e&&su(d,"iterate",y?Cb:lg),{next(){const{value:B,done:T}=b.next();return T?{value:B,done:T}:{value:r?[x(B[0]),x(B[1])]:x(B),done:T}},[Symbol.iterator](){return this}}}}function q0(a){return function(...e){return a==="delete"?!1:a==="clear"?void 0:this}}function D3(a,e){const i={get(c){const d=this.__v_raw,A=Lo(d),r=Lo(c);a||(pp(c,r)&&su(A,"get",c),su(A,"get",r));const{has:y}=K0(A),b=e?Sb:a?Bv:Lc;if(y.call(A,c))return b(d.get(c));if(y.call(A,r))return b(d.get(r));d!==A&&d.get(c)},get size(){const c=this.__v_raw;return!a&&su(Lo(c),"iterate",lg),Reflect.get(c,"size",c)},has(c){const d=this.__v_raw,A=Lo(d),r=Lo(c);return a||(pp(c,r)&&su(A,"has",c),su(A,"has",r)),c===r?d.has(c):d.has(c)||d.has(r)},forEach(c,d){const A=this,r=A.__v_raw,y=Lo(r),b=e?Sb:a?Bv:Lc;return!a&&su(y,"iterate",lg),r.forEach((x,B)=>c.call(d,b(x),b(B),A))}};return lu(i,a?{add:q0("add"),set:q0("set"),delete:q0("delete"),clear:q0("clear")}:{add(c){!e&&!sd(c)&&!vp(c)&&(c=Lo(c));const d=Lo(this);return K0(d).has.call(d,c)||(d.add(c),vf(d,"add",c,c)),this},set(c,d){!e&&!sd(d)&&!vp(d)&&(d=Lo(d));const A=Lo(this),{has:r,get:y}=K0(A);let b=r.call(A,c);b||(c=Lo(c),b=r.call(A,c));const x=y.call(A,c);return A.set(c,d),b?pp(d,x)&&vf(A,"set",c,d):vf(A,"add",c,d),this},delete(c){const d=Lo(this),{has:A,get:r}=K0(d);let y=A.call(d,c);y||(c=Lo(c),y=A.call(d,c)),r&&r.call(d,c);const b=d.delete(c);return y&&vf(d,"delete",c,void 0),b},clear(){const c=Lo(this),d=c.size!==0,A=c.clear();return d&&vf(c,"clear",void 0,void 0),A}}),["keys","values","entries",Symbol.iterator].forEach(c=>{i[c]=R3(c,a,e)}),i}function T1(a,e){const i=D3(a,e);return(s,c,d)=>c==="__v_isReactive"?!a:c==="__v_isReadonly"?a:c==="__v_raw"?s:Reflect.get(Do(i,c)&&c in s?i:s,c,d)}const O3={get:T1(!1,!1)},U3={get:T1(!1,!0)},z3={get:T1(!0,!1)};const h5=new WeakMap,d5=new WeakMap,A5=new WeakMap,N3=new WeakMap;function j3(a){switch(a){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function H3(a){return a.__v_skip||!Object.isExtensible(a)?0:j3(h3(a))}function Qy(a){return vp(a)?a:I1(a,!1,M3,O3,h5)}function f5(a){return I1(a,!1,k3,U3,d5)}function p5(a){return I1(a,!0,P3,z3,A5)}function I1(a,e,i,s,c){if(!wa(a)||a.__v_raw&&!(e&&a.__v_isReactive))return a;const d=H3(a);if(d===0)return a;const A=c.get(a);if(A)return A;const r=new Proxy(a,d===2?s:i);return c.set(a,r),r}function $g(a){return vp(a)?$g(a.__v_raw):!!(a&&a.__v_isReactive)}function vp(a){return!!(a&&a.__v_isReadonly)}function sd(a){return!!(a&&a.__v_isShallow)}function F1(a){return a?!!a.__v_raw:!1}function Lo(a){const e=a&&a.__v_raw;return e?Lo(e):a}function Q3(a){return!Do(a,"__v_skip")&&Object.isExtensible(a)&&wb(a,"__v_skip",!0),a}const Lc=a=>wa(a)?Qy(a):a,Bv=a=>wa(a)?p5(a):a;function Dc(a){return a?a.__v_isRef===!0:!1}function fr(a){return g5(a,!1)}function V3(a){return g5(a,!0)}function g5(a,e){return Dc(a)?a:new G3(a,e)}class G3{constructor(e,i){this.dep=new E1,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:Lo(e),this._value=i?e:Lc(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,s=this.__v_isShallow||sd(e)||vp(e);e=s?e:Lo(e),pp(e,i)&&(this._rawValue=e,this._value=s?e:Lc(e),this.dep.trigger())}}function Aa(a){return Dc(a)?a.value:a}const W3={get:(a,e,i)=>e==="__v_raw"?a:Aa(Reflect.get(a,e,i)),set:(a,e,i,s)=>{const c=a[e];return Dc(c)&&!Dc(i)?(c.value=i,!0):Reflect.set(a,e,i,s)}};function m5(a){return $g(a)?a:new Proxy(a,W3)}function X3(a){const e=Gn(a)?new Array(a.length):{};for(const i in a)e[i]=K3(a,i);return e}class Y3{constructor(e,i,s){this._object=e,this._key=i,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return S3(Lo(this._object),this._key)}}function K3(a,e,i){const s=a[e];return Dc(s)?s:new Y3(a,e,i)}class q3{constructor(e,i,s){this.fn=e,this.setter=i,this._value=void 0,this.dep=new E1(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Cy-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&xa!==this)return i5(this,!0),!0}get value(){const e=this.dep.track();return s5(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function $3(a,e,i=!1){let s,c;return Bs(a)?s=a:(s=a.get,c=a.set),new q3(s,c,i)}const $0={},Cv=new WeakMap;let Kp;function Z3(a,e=!1,i=Kp){if(i){let s=Cv.get(i);s||Cv.set(i,s=[]),s.push(a)}}function J3(a,e,i=da){const{immediate:s,deep:c,once:d,scheduler:A,augmentJob:r,call:y}=i,b=ne=>c?ne:sd(ne)||c===!1||c===0?_f(ne,1):_f(ne);let x,B,T,E,R=!1,P=!1;if(Dc(a)?(B=()=>a.value,R=sd(a)):$g(a)?(B=()=>b(a),R=!0):Gn(a)?(P=!0,R=a.some(ne=>$g(ne)||sd(ne)),B=()=>a.map(ne=>{if(Dc(ne))return ne.value;if($g(ne))return b(ne);if(Bs(ne))return y?y(ne,2):ne()})):Bs(a)?e?B=y?()=>y(a,2):a:B=()=>{if(T){wf();try{T()}finally{Bf()}}const ne=Kp;Kp=x;try{return y?y(a,3,[E]):a(E)}finally{Kp=ne}}:B=jA,e&&c){const ne=B,re=c===!0?1/0:c;B=()=>_f(ne(),re)}const G=w3(),U=()=>{x.stop(),G&&G.active&&x1(G.effects,x)};if(d&&e){const ne=e;e=(...re)=>{ne(...re),U()}}let Q=P?new Array(a.length).fill($0):$0;const q=ne=>{if(!(!(x.flags&1)||!x.dirty&&!ne))if(e){const re=x.run();if(c||R||(P?re.some((pe,fe)=>pp(pe,Q[fe])):pp(re,Q))){T&&T();const pe=Kp;Kp=x;try{const fe=[re,Q===$0?void 0:P&&Q[0]===$0?[]:Q,E];Q=re,y?y(e,3,fe):e(...fe)}finally{Kp=pe}}}else x.run()};return r&&r(q),x=new e5(B),x.scheduler=A?()=>A(q,!1):q,E=ne=>Z3(ne,!1,x),T=x.onStop=()=>{const ne=Cv.get(x);if(ne){if(y)y(ne,4);else for(const re of ne)re();Cv.delete(x)}},e?s?q(!0):Q=x.run():A?A(q.bind(null,!0),!0):x.run(),U.pause=x.pause.bind(x),U.resume=x.resume.bind(x),U.stop=U,U}function _f(a,e=1/0,i){if(e<=0||!wa(a)||a.__v_skip||(i=i||new Set,i.has(a)))return a;if(i.add(a),e--,Dc(a))_f(a.value,e,i);else if(Gn(a))for(let s=0;s<a.length;s++)_f(a[s],e,i);else if(Vv(a)||qg(a))a.forEach(s=>{_f(s,e,i)});else if(qE(a)){for(const s in a)_f(a[s],e,i);for(const s of Object.getOwnPropertySymbols(a))Object.prototype.propertyIsEnumerable.call(a,s)&&_f(a[s],e,i)}return a}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Vy(a,e,i,s){try{return s?a(...s):a()}catch(c){qv(c,e,i)}}function VA(a,e,i,s){if(Bs(a)){const c=Vy(a,e,i,s);return c&&YE(c)&&c.catch(d=>{qv(d,e,i)}),c}if(Gn(a)){const c=[];for(let d=0;d<a.length;d++)c.push(VA(a[d],e,i,s));return c}}function qv(a,e,i,s=!0){const c=e?e.vnode:null,{errorHandler:d,throwUnhandledErrorInProduction:A}=e&&e.appContext.config||da;if(e){let r=e.parent;const y=e.proxy,b=`https://vuejs.org/error-reference/#runtime-${i}`;for(;r;){const x=r.ec;if(x){for(let B=0;B<x.length;B++)if(x[B](a,y,b)===!1)return}r=r.parent}if(d){wf(),Vy(d,null,10,[a,y,b]),Bf();return}}eP(a,i,c,s,A)}function eP(a,e,i,s=!0,c=!1){if(c)throw a;console.error(a)}const Mu=[];let UA=-1;const Zg=[];let cp=null,Vg=0;const y5=Promise.resolve();let Sv=null;function $v(a){const e=Sv||y5;return a?e.then(this?a.bind(this):a):e}function tP(a){let e=UA+1,i=Mu.length;for(;e<i;){const s=e+i>>>1,c=Mu[s],d=Ey(c);d<a||d===a&&c.flags&2?e=s+1:i=s}return e}function L1(a){if(!(a.flags&1)){const e=Ey(a),i=Mu[Mu.length-1];!i||!(a.flags&2)&&e>=Ey(i)?Mu.push(a):Mu.splice(tP(e),0,a),a.flags|=1,v5()}}function v5(){Sv||(Sv=y5.then(x5))}function iP(a){Gn(a)?Zg.push(...a):cp&&a.id===-1?cp.splice(Vg+1,0,a):a.flags&1||(Zg.push(a),a.flags|=1),v5()}function $C(a,e,i=UA+1){for(;i<Mu.length;i++){const s=Mu[i];if(s&&s.flags&2){if(a&&s.id!==a.uid)continue;Mu.splice(i,1),i--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function _5(a){if(Zg.length){const e=[...new Set(Zg)].sort((i,s)=>Ey(i)-Ey(s));if(Zg.length=0,cp){cp.push(...e);return}for(cp=e,Vg=0;Vg<cp.length;Vg++){const i=cp[Vg];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}cp=null,Vg=0}}const Ey=a=>a.id==null?a.flags&2?-1:1/0:a.id;function x5(a){try{for(UA=0;UA<Mu.length;UA++){const e=Mu[UA];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Vy(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;UA<Mu.length;UA++){const e=Mu[UA];e&&(e.flags&=-2)}UA=-1,Mu.length=0,_5(),Sv=null,(Mu.length||Zg.length)&&x5()}}let nh=null,b5=null;function Ev(a){const e=nh;return nh=a,b5=a&&a.type.__scopeId||null,e}function rP(a,e=nh,i){if(!e||a._n)return a;const s=(...c)=>{s._d&&aS(-1);const d=Ev(e);let A;try{A=a(...c)}finally{Ev(d),s._d&&aS(1)}return A};return s._n=!0,s._c=!0,s._d=!0,s}function fa(a,e){if(nh===null)return a;const i=i_(nh),s=a.dirs||(a.dirs=[]);for(let c=0;c<e.length;c++){let[d,A,r,y=da]=e[c];d&&(Bs(d)&&(d={mounted:d,updated:d}),d.deep&&_f(A),s.push({dir:d,instance:i,value:A,oldValue:void 0,arg:r,modifiers:y}))}return a}function Xp(a,e,i,s){const c=a.dirs,d=e&&e.dirs;for(let A=0;A<c.length;A++){const r=c[A];d&&(r.oldValue=d[A].value);let y=r.dir[s];y&&(wf(),VA(y,i,8,[a.el,r,a,e]),Bf())}}const nP=Symbol("_vte"),sP=a=>a.__isTeleport;function M1(a,e){a.shapeFlag&6&&a.component?(a.transition=e,M1(a.component.subTree,e)):a.shapeFlag&128?(a.ssContent.transition=e.clone(a.ssContent),a.ssFallback.transition=e.clone(a.ssFallback)):a.transition=e}/*! #__NO_SIDE_EFFECTS__ */function P1(a,e){return Bs(a)?lu({name:a.name},e,{setup:a}):a}function w5(a){a.ids=[a.ids[0]+a.ids[2]+++"-",0,0]}function dy(a,e,i,s,c=!1){if(Gn(a)){a.forEach((R,P)=>dy(R,e&&(Gn(e)?e[P]:e),i,s,c));return}if(Ay(s)&&!c){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&dy(a,e,i,s.component.subTree);return}const d=s.shapeFlag&4?i_(s.component):s.el,A=c?null:d,{i:r,r:y}=a,b=e&&e.r,x=r.refs===da?r.refs={}:r.refs,B=r.setupState,T=Lo(B),E=B===da?()=>!1:R=>Do(T,R);if(b!=null&&b!==y&&(Ml(b)?(x[b]=null,E(b)&&(B[b]=null)):Dc(b)&&(b.value=null)),Bs(y))Vy(y,r,12,[A,x]);else{const R=Ml(y),P=Dc(y);if(R||P){const G=()=>{if(a.f){const U=R?E(y)?B[y]:x[y]:y.value;c?Gn(U)&&x1(U,d):Gn(U)?U.includes(d)||U.push(d):R?(x[y]=[d],E(y)&&(B[y]=x[y])):(y.value=[d],a.k&&(x[a.k]=y.value))}else R?(x[y]=A,E(y)&&(B[y]=A)):P&&(y.value=A,a.k&&(x[a.k]=A))};A?(G.id=-1,Rh(G,i)):G()}}}Xv().requestIdleCallback;Xv().cancelIdleCallback;const Ay=a=>!!a.type.__asyncLoader,B5=a=>a.type.__isKeepAlive;function oP(a,e){C5(a,"a",e)}function aP(a,e){C5(a,"da",e)}function C5(a,e,i=kc){const s=a.__wdc||(a.__wdc=()=>{let c=i;for(;c;){if(c.isDeactivated)return;c=c.parent}return a()});if(Zv(e,s,i),i){let c=i.parent;for(;c&&c.parent;)B5(c.parent.vnode)&&lP(s,e,i,c),c=c.parent}}function lP(a,e,i,s){const c=Zv(e,a,s,!0);Ty(()=>{x1(s[e],c)},i)}function Zv(a,e,i=kc,s=!1){if(i){const c=i[a]||(i[a]=[]),d=e.__weh||(e.__weh=(...A)=>{wf();const r=Wy(i),y=VA(e,i,a,A);return r(),Bf(),y});return s?c.unshift(d):c.push(d),d}}const Cf=a=>(e,i=kc)=>{(!Fy||a==="sp")&&Zv(a,(...s)=>e(...s),i)},S5=Cf("bm"),_p=Cf("m"),cP=Cf("bu"),uP=Cf("u"),E5=Cf("bum"),Ty=Cf("um"),hP=Cf("sp"),dP=Cf("rtg"),AP=Cf("rtc");function fP(a,e=kc){Zv("ec",a,e)}const pP="components";function Gy(a,e){return mP(pP,a,!0,e)||a}const gP=Symbol.for("v-ndc");function mP(a,e,i=!0,s=!1){const c=nh||kc;if(c){const d=c.type;{const r=n4(d,!1);if(r&&(r===e||r===ad(e)||r===Wv(ad(e))))return d}const A=ZC(c[a]||d[a],e)||ZC(c.appContext[a],e);return!A&&s?d:A}}function ZC(a,e){return a&&(a[e]||a[ad(e)]||a[Wv(ad(e))])}function xp(a,e,i,s){let c;const d=i,A=Gn(a);if(A||Ml(a)){const r=A&&$g(a);let y=!1,b=!1;r&&(y=!sd(a),b=vp(a),a=Kv(a)),c=new Array(a.length);for(let x=0,B=a.length;x<B;x++)c[x]=e(y?b?Bv(Lc(a[x])):Lc(a[x]):a[x],x,void 0,d)}else if(typeof a=="number"){c=new Array(a);for(let r=0;r<a;r++)c[r]=e(r+1,r,void 0,d)}else if(wa(a))if(a[Symbol.iterator])c=Array.from(a,(r,y)=>e(r,y,void 0,d));else{const r=Object.keys(a);c=new Array(r.length);for(let y=0,b=r.length;y<b;y++){const x=r[y];c[y]=e(a[x],x,y,d)}}else c=[];return c}const Eb=a=>a?X5(a)?i_(a):Eb(a.parent):null,fy=lu(Object.create(null),{$:a=>a,$el:a=>a.vnode.el,$data:a=>a.data,$props:a=>a.props,$attrs:a=>a.attrs,$slots:a=>a.slots,$refs:a=>a.refs,$parent:a=>Eb(a.parent),$root:a=>Eb(a.root),$host:a=>a.ce,$emit:a=>a.emit,$options:a=>I5(a),$forceUpdate:a=>a.f||(a.f=()=>{L1(a.update)}),$nextTick:a=>a.n||(a.n=$v.bind(a.proxy)),$watch:a=>UP.bind(a)}),Ux=(a,e)=>a!==da&&!a.__isScriptSetup&&Do(a,e),yP={get({_:a},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:s,data:c,props:d,accessCache:A,type:r,appContext:y}=a;let b;if(e[0]!=="$"){const E=A[e];if(E!==void 0)switch(E){case 1:return s[e];case 2:return c[e];case 4:return i[e];case 3:return d[e]}else{if(Ux(s,e))return A[e]=1,s[e];if(c!==da&&Do(c,e))return A[e]=2,c[e];if((b=a.propsOptions[0])&&Do(b,e))return A[e]=3,d[e];if(i!==da&&Do(i,e))return A[e]=4,i[e];Tb&&(A[e]=0)}}const x=fy[e];let B,T;if(x)return e==="$attrs"&&su(a.attrs,"get",""),x(a);if((B=r.__cssModules)&&(B=B[e]))return B;if(i!==da&&Do(i,e))return A[e]=4,i[e];if(T=y.config.globalProperties,Do(T,e))return T[e]},set({_:a},e,i){const{data:s,setupState:c,ctx:d}=a;return Ux(c,e)?(c[e]=i,!0):s!==da&&Do(s,e)?(s[e]=i,!0):Do(a.props,e)||e[0]==="$"&&e.slice(1)in a?!1:(d[e]=i,!0)},has({_:{data:a,setupState:e,accessCache:i,ctx:s,appContext:c,propsOptions:d}},A){let r;return!!i[A]||a!==da&&Do(a,A)||Ux(e,A)||(r=d[0])&&Do(r,A)||Do(s,A)||Do(fy,A)||Do(c.config.globalProperties,A)},defineProperty(a,e,i){return i.get!=null?a._.accessCache[e]=0:Do(i,"value")&&this.set(a,e,i.value,null),Reflect.defineProperty(a,e,i)}};function JC(a){return Gn(a)?a.reduce((e,i)=>(e[i]=null,e),{}):a}let Tb=!0;function vP(a){const e=I5(a),i=a.proxy,s=a.ctx;Tb=!1,e.beforeCreate&&eS(e.beforeCreate,a,"bc");const{data:c,computed:d,methods:A,watch:r,provide:y,inject:b,created:x,beforeMount:B,mounted:T,beforeUpdate:E,updated:R,activated:P,deactivated:G,beforeDestroy:U,beforeUnmount:Q,destroyed:q,unmounted:ne,render:re,renderTracked:pe,renderTriggered:fe,errorCaptured:he,serverPrefetch:be,expose:Se,inheritAttrs:oe,components:ye,directives:Me,filters:Be}=e;if(b&&_P(b,s,null),A)for(const et in A){const Ye=A[et];Bs(Ye)&&(s[et]=Ye.bind(i))}if(c){const et=c.call(i,i);wa(et)&&(a.data=Qy(et))}if(Tb=!0,d)for(const et in d){const Ye=d[et],bt=Bs(Ye)?Ye.bind(i,i):Bs(Ye.get)?Ye.get.bind(i,i):jA,pt=!Bs(Ye)&&Bs(Ye.set)?Ye.set.bind(i):jA,Qt=Dh({get:bt,set:pt});Object.defineProperty(s,et,{enumerable:!0,configurable:!0,get:()=>Qt.value,set:Ie=>Qt.value=Ie})}if(r)for(const et in r)T5(r[et],s,i,et);if(y){const et=Bs(y)?y.call(i):y;Reflect.ownKeys(et).forEach(Ye=>{av(Ye,et[Ye])})}x&&eS(x,a,"c");function De(et,Ye){Gn(Ye)?Ye.forEach(bt=>et(bt.bind(i))):Ye&&et(Ye.bind(i))}if(De(S5,B),De(_p,T),De(cP,E),De(uP,R),De(oP,P),De(aP,G),De(fP,he),De(AP,pe),De(dP,fe),De(E5,Q),De(Ty,ne),De(hP,be),Gn(Se))if(Se.length){const et=a.exposed||(a.exposed={});Se.forEach(Ye=>{Object.defineProperty(et,Ye,{get:()=>i[Ye],set:bt=>i[Ye]=bt})})}else a.exposed||(a.exposed={});re&&a.render===jA&&(a.render=re),oe!=null&&(a.inheritAttrs=oe),ye&&(a.components=ye),Me&&(a.directives=Me),be&&w5(a)}function _P(a,e,i=jA){Gn(a)&&(a=Ib(a));for(const s in a){const c=a[s];let d;wa(c)?"default"in c?d=Xd(c.from||s,c.default,!0):d=Xd(c.from||s):d=Xd(c),Dc(d)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>d.value,set:A=>d.value=A}):e[s]=d}}function eS(a,e,i){VA(Gn(a)?a.map(s=>s.bind(e.proxy)):a.bind(e.proxy),e,i)}function T5(a,e,i,s){let c=s.includes(".")?H5(i,s):()=>i[s];if(Ml(a)){const d=e[a];Bs(d)&&xf(c,d)}else if(Bs(a))xf(c,a.bind(i));else if(wa(a))if(Gn(a))a.forEach(d=>T5(d,e,i,s));else{const d=Bs(a.handler)?a.handler.bind(i):e[a.handler];Bs(d)&&xf(c,d,a)}}function I5(a){const e=a.type,{mixins:i,extends:s}=e,{mixins:c,optionsCache:d,config:{optionMergeStrategies:A}}=a.appContext,r=d.get(e);let y;return r?y=r:!c.length&&!i&&!s?y=e:(y={},c.length&&c.forEach(b=>Tv(y,b,A,!0)),Tv(y,e,A)),wa(e)&&d.set(e,y),y}function Tv(a,e,i,s=!1){const{mixins:c,extends:d}=e;d&&Tv(a,d,i,!0),c&&c.forEach(A=>Tv(a,A,i,!0));for(const A in e)if(!(s&&A==="expose")){const r=xP[A]||i&&i[A];a[A]=r?r(a[A],e[A]):e[A]}return a}const xP={data:tS,props:iS,emits:iS,methods:ay,computed:ay,beforeCreate:Lu,created:Lu,beforeMount:Lu,mounted:Lu,beforeUpdate:Lu,updated:Lu,beforeDestroy:Lu,beforeUnmount:Lu,destroyed:Lu,unmounted:Lu,activated:Lu,deactivated:Lu,errorCaptured:Lu,serverPrefetch:Lu,components:ay,directives:ay,watch:wP,provide:tS,inject:bP};function tS(a,e){return e?a?function(){return lu(Bs(a)?a.call(this,this):a,Bs(e)?e.call(this,this):e)}:e:a}function bP(a,e){return ay(Ib(a),Ib(e))}function Ib(a){if(Gn(a)){const e={};for(let i=0;i<a.length;i++)e[a[i]]=a[i];return e}return a}function Lu(a,e){return a?[...new Set([].concat(a,e))]:e}function ay(a,e){return a?lu(Object.create(null),a,e):e}function iS(a,e){return a?Gn(a)&&Gn(e)?[...new Set([...a,...e])]:lu(Object.create(null),JC(a),JC(e??{})):e}function wP(a,e){if(!a)return e;if(!e)return a;const i=lu(Object.create(null),a);for(const s in e)i[s]=Lu(a[s],e[s]);return i}function F5(){return{app:null,config:{isNativeTag:c3,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let BP=0;function CP(a,e){return function(s,c=null){Bs(s)||(s=lu({},s)),c!=null&&!wa(c)&&(c=null);const d=F5(),A=new WeakSet,r=[];let y=!1;const b=d.app={_uid:BP++,_component:s,_props:c,_container:null,_context:d,_instance:null,version:o4,get config(){return d.config},set config(x){},use(x,...B){return A.has(x)||(x&&Bs(x.install)?(A.add(x),x.install(b,...B)):Bs(x)&&(A.add(x),x(b,...B))),b},mixin(x){return d.mixins.includes(x)||d.mixins.push(x),b},component(x,B){return B?(d.components[x]=B,b):d.components[x]},directive(x,B){return B?(d.directives[x]=B,b):d.directives[x]},mount(x,B,T){if(!y){const E=b._ceVNode||$n(s,c);return E.appContext=d,T===!0?T="svg":T===!1&&(T=void 0),a(E,x,T),y=!0,b._container=x,x.__vue_app__=b,i_(E.component)}},onUnmount(x){r.push(x)},unmount(){y&&(VA(r,b._instance,16),a(null,b._container),delete b._container.__vue_app__)},provide(x,B){return d.provides[x]=B,b},runWithContext(x){const B=Jg;Jg=b;try{return x()}finally{Jg=B}}};return b}}let Jg=null;function av(a,e){if(kc){let i=kc.provides;const s=kc.parent&&kc.parent.provides;s===i&&(i=kc.provides=Object.create(s)),i[a]=e}}function Xd(a,e,i=!1){const s=kc||nh;if(s||Jg){let c=Jg?Jg._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(c&&a in c)return c[a];if(arguments.length>1)return i&&Bs(e)?e.call(s&&s.proxy):e}}const L5={},M5=()=>Object.create(L5),P5=a=>Object.getPrototypeOf(a)===L5;function SP(a,e,i,s=!1){const c={},d=M5();a.propsDefaults=Object.create(null),k5(a,e,c,d);for(const A in a.propsOptions[0])A in c||(c[A]=void 0);i?a.props=s?c:f5(c):a.type.props?a.props=c:a.props=d,a.attrs=d}function EP(a,e,i,s){const{props:c,attrs:d,vnode:{patchFlag:A}}=a,r=Lo(c),[y]=a.propsOptions;let b=!1;if((s||A>0)&&!(A&16)){if(A&8){const x=a.vnode.dynamicProps;for(let B=0;B<x.length;B++){let T=x[B];if(Jv(a.emitsOptions,T))continue;const E=e[T];if(y)if(Do(d,T))E!==d[T]&&(d[T]=E,b=!0);else{const R=ad(T);c[R]=Fb(y,r,R,E,a,!1)}else E!==d[T]&&(d[T]=E,b=!0)}}}else{k5(a,e,c,d)&&(b=!0);let x;for(const B in r)(!e||!Do(e,B)&&((x=yg(B))===B||!Do(e,x)))&&(y?i&&(i[B]!==void 0||i[x]!==void 0)&&(c[B]=Fb(y,r,B,void 0,a,!0)):delete c[B]);if(d!==r)for(const B in d)(!e||!Do(e,B))&&(delete d[B],b=!0)}b&&vf(a.attrs,"set","")}function k5(a,e,i,s){const[c,d]=a.propsOptions;let A=!1,r;if(e)for(let y in e){if(cy(y))continue;const b=e[y];let x;c&&Do(c,x=ad(y))?!d||!d.includes(x)?i[x]=b:(r||(r={}))[x]=b:Jv(a.emitsOptions,y)||(!(y in s)||b!==s[y])&&(s[y]=b,A=!0)}if(d){const y=Lo(i),b=r||da;for(let x=0;x<d.length;x++){const B=d[x];i[B]=Fb(c,y,B,b[B],a,!Do(b,B))}}return A}function Fb(a,e,i,s,c,d){const A=a[i];if(A!=null){const r=Do(A,"default");if(r&&s===void 0){const y=A.default;if(A.type!==Function&&!A.skipFactory&&Bs(y)){const{propsDefaults:b}=c;if(i in b)s=b[i];else{const x=Wy(c);s=b[i]=y.call(null,e),x()}}else s=y;c.ce&&c.ce._setProp(i,s)}A[0]&&(d&&!r?s=!1:A[1]&&(s===""||s===yg(i))&&(s=!0))}return s}const TP=new WeakMap;function R5(a,e,i=!1){const s=i?TP:e.propsCache,c=s.get(a);if(c)return c;const d=a.props,A={},r=[];let y=!1;if(!Bs(a)){const x=B=>{y=!0;const[T,E]=R5(B,e,!0);lu(A,T),E&&r.push(...E)};!i&&e.mixins.length&&e.mixins.forEach(x),a.extends&&x(a.extends),a.mixins&&a.mixins.forEach(x)}if(!d&&!y)return wa(a)&&s.set(a,Kg),Kg;if(Gn(d))for(let x=0;x<d.length;x++){const B=ad(d[x]);rS(B)&&(A[B]=da)}else if(d)for(const x in d){const B=ad(x);if(rS(B)){const T=d[x],E=A[B]=Gn(T)||Bs(T)?{type:T}:lu({},T),R=E.type;let P=!1,G=!0;if(Gn(R))for(let U=0;U<R.length;++U){const Q=R[U],q=Bs(Q)&&Q.name;if(q==="Boolean"){P=!0;break}else q==="String"&&(G=!1)}else P=Bs(R)&&R.name==="Boolean";E[0]=P,E[1]=G,(P||Do(E,"default"))&&r.push(B)}}const b=[A,r];return wa(a)&&s.set(a,b),b}function rS(a){return a[0]!=="$"&&!cy(a)}const k1=a=>a[0]==="_"||a==="$stable",R1=a=>Gn(a)?a.map(zA):[zA(a)],IP=(a,e,i)=>{if(e._n)return e;const s=rP((...c)=>R1(e(...c)),i);return s._c=!1,s},D5=(a,e,i)=>{const s=a._ctx;for(const c in a){if(k1(c))continue;const d=a[c];if(Bs(d))e[c]=IP(c,d,s);else if(d!=null){const A=R1(d);e[c]=()=>A}}},O5=(a,e)=>{const i=R1(e);a.slots.default=()=>i},U5=(a,e,i)=>{for(const s in e)(i||!k1(s))&&(a[s]=e[s])},FP=(a,e,i)=>{const s=a.slots=M5();if(a.vnode.shapeFlag&32){const c=e.__;c&&wb(s,"__",c,!0);const d=e._;d?(U5(s,e,i),i&&wb(s,"_",d,!0)):D5(e,s)}else e&&O5(a,e)},LP=(a,e,i)=>{const{vnode:s,slots:c}=a;let d=!0,A=da;if(s.shapeFlag&32){const r=e._;r?i&&r===1?d=!1:U5(c,e,i):(d=!e.$stable,D5(e,c)),A=e}else e&&(O5(a,e),A={default:1});if(d)for(const r in c)!k1(r)&&A[r]==null&&delete c[r]},Rh=GP;function MP(a){return PP(a)}function PP(a,e){const i=Xv();i.__VUE__=!0;const{insert:s,remove:c,patchProp:d,createElement:A,createText:r,createComment:y,setText:b,setElementText:x,parentNode:B,nextSibling:T,setScopeId:E=jA,insertStaticContent:R}=a,P=(qe,Ke,Pt,It=null,Ze=null,yi=null,bi=void 0,Kt=null,di=!!Ke.dynamicChildren)=>{if(qe===Ke)return;qe&&!Jm(qe,Ke)&&(It=rt(qe),Ie(qe,Ze,yi,!0),qe=null),Ke.patchFlag===-2&&(di=!1,Ke.dynamicChildren=null);const{type:pi,ref:Ri,shapeFlag:Oi}=Ke;switch(pi){case e_:G(qe,Ke,Pt,It);break;case bp:U(qe,Ke,Pt,It);break;case Nx:qe==null&&Q(Ke,Pt,It,bi);break;case Mc:ye(qe,Ke,Pt,It,Ze,yi,bi,Kt,di);break;default:Oi&1?re(qe,Ke,Pt,It,Ze,yi,bi,Kt,di):Oi&6?Me(qe,Ke,Pt,It,Ze,yi,bi,Kt,di):(Oi&64||Oi&128)&&pi.process(qe,Ke,Pt,It,Ze,yi,bi,Kt,di,Ut)}Ri!=null&&Ze?dy(Ri,qe&&qe.ref,yi,Ke||qe,!Ke):Ri==null&&qe&&qe.ref!=null&&dy(qe.ref,null,yi,qe,!0)},G=(qe,Ke,Pt,It)=>{if(qe==null)s(Ke.el=r(Ke.children),Pt,It);else{const Ze=Ke.el=qe.el;Ke.children!==qe.children&&b(Ze,Ke.children)}},U=(qe,Ke,Pt,It)=>{qe==null?s(Ke.el=y(Ke.children||""),Pt,It):Ke.el=qe.el},Q=(qe,Ke,Pt,It)=>{[qe.el,qe.anchor]=R(qe.children,Ke,Pt,It,qe.el,qe.anchor)},q=({el:qe,anchor:Ke},Pt,It)=>{let Ze;for(;qe&&qe!==Ke;)Ze=T(qe),s(qe,Pt,It),qe=Ze;s(Ke,Pt,It)},ne=({el:qe,anchor:Ke})=>{let Pt;for(;qe&&qe!==Ke;)Pt=T(qe),c(qe),qe=Pt;c(Ke)},re=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di)=>{Ke.type==="svg"?bi="svg":Ke.type==="math"&&(bi="mathml"),qe==null?pe(Ke,Pt,It,Ze,yi,bi,Kt,di):be(qe,Ke,Ze,yi,bi,Kt,di)},pe=(qe,Ke,Pt,It,Ze,yi,bi,Kt)=>{let di,pi;const{props:Ri,shapeFlag:Oi,transition:Ji,dirs:ar}=qe;if(di=qe.el=A(qe.type,yi,Ri&&Ri.is,Ri),Oi&8?x(di,qe.children):Oi&16&&he(qe.children,di,null,It,Ze,zx(qe,yi),bi,Kt),ar&&Xp(qe,null,It,"created"),fe(di,qe,qe.scopeId,bi,It),Ri){for(const Dr in Ri)Dr!=="value"&&!cy(Dr)&&d(di,Dr,null,Ri[Dr],yi,It);"value"in Ri&&d(di,"value",null,Ri.value,yi),(pi=Ri.onVnodeBeforeMount)&&RA(pi,It,qe)}ar&&Xp(qe,null,It,"beforeMount");const br=kP(Ze,Ji);br&&Ji.beforeEnter(di),s(di,Ke,Pt),((pi=Ri&&Ri.onVnodeMounted)||br||ar)&&Rh(()=>{pi&&RA(pi,It,qe),br&&Ji.enter(di),ar&&Xp(qe,null,It,"mounted")},Ze)},fe=(qe,Ke,Pt,It,Ze)=>{if(Pt&&E(qe,Pt),It)for(let yi=0;yi<It.length;yi++)E(qe,It[yi]);if(Ze){let yi=Ze.subTree;if(Ke===yi||V5(yi.type)&&(yi.ssContent===Ke||yi.ssFallback===Ke)){const bi=Ze.vnode;fe(qe,bi,bi.scopeId,bi.slotScopeIds,Ze.parent)}}},he=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di=0)=>{for(let pi=di;pi<qe.length;pi++){const Ri=qe[pi]=Kt?up(qe[pi]):zA(qe[pi]);P(null,Ri,Ke,Pt,It,Ze,yi,bi,Kt)}},be=(qe,Ke,Pt,It,Ze,yi,bi)=>{const Kt=Ke.el=qe.el;let{patchFlag:di,dynamicChildren:pi,dirs:Ri}=Ke;di|=qe.patchFlag&16;const Oi=qe.props||da,Ji=Ke.props||da;let ar;if(Pt&&Yp(Pt,!1),(ar=Ji.onVnodeBeforeUpdate)&&RA(ar,Pt,Ke,qe),Ri&&Xp(Ke,qe,Pt,"beforeUpdate"),Pt&&Yp(Pt,!0),(Oi.innerHTML&&Ji.innerHTML==null||Oi.textContent&&Ji.textContent==null)&&x(Kt,""),pi?Se(qe.dynamicChildren,pi,Kt,Pt,It,zx(Ke,Ze),yi):bi||Ye(qe,Ke,Kt,null,Pt,It,zx(Ke,Ze),yi,!1),di>0){if(di&16)oe(Kt,Oi,Ji,Pt,Ze);else if(di&2&&Oi.class!==Ji.class&&d(Kt,"class",null,Ji.class,Ze),di&4&&d(Kt,"style",Oi.style,Ji.style,Ze),di&8){const br=Ke.dynamicProps;for(let Dr=0;Dr<br.length;Dr++){const Fr=br[Dr],Qr=Oi[Fr],ui=Ji[Fr];(ui!==Qr||Fr==="value")&&d(Kt,Fr,Qr,ui,Ze,Pt)}}di&1&&qe.children!==Ke.children&&x(Kt,Ke.children)}else!bi&&pi==null&&oe(Kt,Oi,Ji,Pt,Ze);((ar=Ji.onVnodeUpdated)||Ri)&&Rh(()=>{ar&&RA(ar,Pt,Ke,qe),Ri&&Xp(Ke,qe,Pt,"updated")},It)},Se=(qe,Ke,Pt,It,Ze,yi,bi)=>{for(let Kt=0;Kt<Ke.length;Kt++){const di=qe[Kt],pi=Ke[Kt],Ri=di.el&&(di.type===Mc||!Jm(di,pi)||di.shapeFlag&198)?B(di.el):Pt;P(di,pi,Ri,null,It,Ze,yi,bi,!0)}},oe=(qe,Ke,Pt,It,Ze)=>{if(Ke!==Pt){if(Ke!==da)for(const yi in Ke)!cy(yi)&&!(yi in Pt)&&d(qe,yi,Ke[yi],null,Ze,It);for(const yi in Pt){if(cy(yi))continue;const bi=Pt[yi],Kt=Ke[yi];bi!==Kt&&yi!=="value"&&d(qe,yi,Kt,bi,Ze,It)}"value"in Pt&&d(qe,"value",Ke.value,Pt.value,Ze)}},ye=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di)=>{const pi=Ke.el=qe?qe.el:r(""),Ri=Ke.anchor=qe?qe.anchor:r("");let{patchFlag:Oi,dynamicChildren:Ji,slotScopeIds:ar}=Ke;ar&&(Kt=Kt?Kt.concat(ar):ar),qe==null?(s(pi,Pt,It),s(Ri,Pt,It),he(Ke.children||[],Pt,Ri,Ze,yi,bi,Kt,di)):Oi>0&&Oi&64&&Ji&&qe.dynamicChildren?(Se(qe.dynamicChildren,Ji,Pt,Ze,yi,bi,Kt),(Ke.key!=null||Ze&&Ke===Ze.subTree)&&z5(qe,Ke,!0)):Ye(qe,Ke,Pt,Ri,Ze,yi,bi,Kt,di)},Me=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di)=>{Ke.slotScopeIds=Kt,qe==null?Ke.shapeFlag&512?Ze.ctx.activate(Ke,Pt,It,bi,di):Be(Ke,Pt,It,Ze,yi,bi,di):Pe(qe,Ke,di)},Be=(qe,Ke,Pt,It,Ze,yi,bi)=>{const Kt=qe.component=ZP(qe,It,Ze);if(B5(qe)&&(Kt.ctx.renderer=Ut),e4(Kt,!1,bi),Kt.asyncDep){if(Ze&&Ze.registerDep(Kt,De,bi),!qe.el){const di=Kt.subTree=$n(bp);U(null,di,Ke,Pt)}}else De(Kt,qe,Ke,Pt,Ze,yi,bi)},Pe=(qe,Ke,Pt)=>{const It=Ke.component=qe.component;if(QP(qe,Ke,Pt))if(It.asyncDep&&!It.asyncResolved){et(It,Ke,Pt);return}else It.next=Ke,It.update();else Ke.el=qe.el,It.vnode=Ke},De=(qe,Ke,Pt,It,Ze,yi,bi)=>{const Kt=()=>{if(qe.isMounted){let{next:Oi,bu:Ji,u:ar,parent:br,vnode:Dr}=qe;{const Vi=N5(qe);if(Vi){Oi&&(Oi.el=Dr.el,et(qe,Oi,bi)),Vi.asyncDep.then(()=>{qe.isUnmounted||Kt()});return}}let Fr=Oi,Qr;Yp(qe,!1),Oi?(Oi.el=Dr.el,et(qe,Oi,bi)):Oi=Dr,Ji&&ov(Ji),(Qr=Oi.props&&Oi.props.onVnodeBeforeUpdate)&&RA(Qr,br,Oi,Dr),Yp(qe,!0);const ui=sS(qe),li=qe.subTree;qe.subTree=ui,P(li,ui,B(li.el),rt(li),qe,Ze,yi),Oi.el=ui.el,Fr===null&&VP(qe,ui.el),ar&&Rh(ar,Ze),(Qr=Oi.props&&Oi.props.onVnodeUpdated)&&Rh(()=>RA(Qr,br,Oi,Dr),Ze)}else{let Oi;const{el:Ji,props:ar}=Ke,{bm:br,m:Dr,parent:Fr,root:Qr,type:ui}=qe,li=Ay(Ke);Yp(qe,!1),br&&ov(br),!li&&(Oi=ar&&ar.onVnodeBeforeMount)&&RA(Oi,Fr,Ke),Yp(qe,!0);{Qr.ce&&Qr.ce._def.shadowRoot!==!1&&Qr.ce._injectChildStyle(ui);const Vi=qe.subTree=sS(qe);P(null,Vi,Pt,It,qe,Ze,yi),Ke.el=Vi.el}if(Dr&&Rh(Dr,Ze),!li&&(Oi=ar&&ar.onVnodeMounted)){const Vi=Ke;Rh(()=>RA(Oi,Fr,Vi),Ze)}(Ke.shapeFlag&256||Fr&&Ay(Fr.vnode)&&Fr.vnode.shapeFlag&256)&&qe.a&&Rh(qe.a,Ze),qe.isMounted=!0,Ke=Pt=It=null}};qe.scope.on();const di=qe.effect=new e5(Kt);qe.scope.off();const pi=qe.update=di.run.bind(di),Ri=qe.job=di.runIfDirty.bind(di);Ri.i=qe,Ri.id=qe.uid,di.scheduler=()=>L1(Ri),Yp(qe,!0),pi()},et=(qe,Ke,Pt)=>{Ke.component=qe;const It=qe.vnode.props;qe.vnode=Ke,qe.next=null,EP(qe,Ke.props,It,Pt),LP(qe,Ke.children,Pt),wf(),$C(qe),Bf()},Ye=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di=!1)=>{const pi=qe&&qe.children,Ri=qe?qe.shapeFlag:0,Oi=Ke.children,{patchFlag:Ji,shapeFlag:ar}=Ke;if(Ji>0){if(Ji&128){pt(pi,Oi,Pt,It,Ze,yi,bi,Kt,di);return}else if(Ji&256){bt(pi,Oi,Pt,It,Ze,yi,bi,Kt,di);return}}ar&8?(Ri&16&&Ct(pi,Ze,yi),Oi!==pi&&x(Pt,Oi)):Ri&16?ar&16?pt(pi,Oi,Pt,It,Ze,yi,bi,Kt,di):Ct(pi,Ze,yi,!0):(Ri&8&&x(Pt,""),ar&16&&he(Oi,Pt,It,Ze,yi,bi,Kt,di))},bt=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di)=>{qe=qe||Kg,Ke=Ke||Kg;const pi=qe.length,Ri=Ke.length,Oi=Math.min(pi,Ri);let Ji;for(Ji=0;Ji<Oi;Ji++){const ar=Ke[Ji]=di?up(Ke[Ji]):zA(Ke[Ji]);P(qe[Ji],ar,Pt,null,Ze,yi,bi,Kt,di)}pi>Ri?Ct(qe,Ze,yi,!0,!1,Oi):he(Ke,Pt,It,Ze,yi,bi,Kt,di,Oi)},pt=(qe,Ke,Pt,It,Ze,yi,bi,Kt,di)=>{let pi=0;const Ri=Ke.length;let Oi=qe.length-1,Ji=Ri-1;for(;pi<=Oi&&pi<=Ji;){const ar=qe[pi],br=Ke[pi]=di?up(Ke[pi]):zA(Ke[pi]);if(Jm(ar,br))P(ar,br,Pt,null,Ze,yi,bi,Kt,di);else break;pi++}for(;pi<=Oi&&pi<=Ji;){const ar=qe[Oi],br=Ke[Ji]=di?up(Ke[Ji]):zA(Ke[Ji]);if(Jm(ar,br))P(ar,br,Pt,null,Ze,yi,bi,Kt,di);else break;Oi--,Ji--}if(pi>Oi){if(pi<=Ji){const ar=Ji+1,br=ar<Ri?Ke[ar].el:It;for(;pi<=Ji;)P(null,Ke[pi]=di?up(Ke[pi]):zA(Ke[pi]),Pt,br,Ze,yi,bi,Kt,di),pi++}}else if(pi>Ji)for(;pi<=Oi;)Ie(qe[pi],Ze,yi,!0),pi++;else{const ar=pi,br=pi,Dr=new Map;for(pi=br;pi<=Ji;pi++){const _r=Ke[pi]=di?up(Ke[pi]):zA(Ke[pi]);_r.key!=null&&Dr.set(_r.key,pi)}let Fr,Qr=0;const ui=Ji-br+1;let li=!1,Vi=0;const rr=new Array(ui);for(pi=0;pi<ui;pi++)rr[pi]=0;for(pi=ar;pi<=Oi;pi++){const _r=qe[pi];if(Qr>=ui){Ie(_r,Ze,yi,!0);continue}let Zr;if(_r.key!=null)Zr=Dr.get(_r.key);else for(Fr=br;Fr<=Ji;Fr++)if(rr[Fr-br]===0&&Jm(_r,Ke[Fr])){Zr=Fr;break}Zr===void 0?Ie(_r,Ze,yi,!0):(rr[Zr-br]=pi+1,Zr>=Vi?Vi=Zr:li=!0,P(_r,Ke[Zr],Pt,null,Ze,yi,bi,Kt,di),Qr++)}const qr=li?RP(rr):Kg;for(Fr=qr.length-1,pi=ui-1;pi>=0;pi--){const _r=br+pi,Zr=Ke[_r],io=_r+1<Ri?Ke[_r+1].el:It;rr[pi]===0?P(null,Zr,Pt,io,Ze,yi,bi,Kt,di):li&&(Fr<0||pi!==qr[Fr]?Qt(Zr,Pt,io,2):Fr--)}}},Qt=(qe,Ke,Pt,It,Ze=null)=>{const{el:yi,type:bi,transition:Kt,children:di,shapeFlag:pi}=qe;if(pi&6){Qt(qe.component.subTree,Ke,Pt,It);return}if(pi&128){qe.suspense.move(Ke,Pt,It);return}if(pi&64){bi.move(qe,Ke,Pt,Ut);return}if(bi===Mc){s(yi,Ke,Pt);for(let Oi=0;Oi<di.length;Oi++)Qt(di[Oi],Ke,Pt,It);s(qe.anchor,Ke,Pt);return}if(bi===Nx){q(qe,Ke,Pt);return}if(It!==2&&pi&1&&Kt)if(It===0)Kt.beforeEnter(yi),s(yi,Ke,Pt),Rh(()=>Kt.enter(yi),Ze);else{const{leave:Oi,delayLeave:Ji,afterLeave:ar}=Kt,br=()=>{qe.ctx.isUnmounted?c(yi):s(yi,Ke,Pt)},Dr=()=>{Oi(yi,()=>{br(),ar&&ar()})};Ji?Ji(yi,br,Dr):Dr()}else s(yi,Ke,Pt)},Ie=(qe,Ke,Pt,It=!1,Ze=!1)=>{const{type:yi,props:bi,ref:Kt,children:di,dynamicChildren:pi,shapeFlag:Ri,patchFlag:Oi,dirs:Ji,cacheIndex:ar}=qe;if(Oi===-2&&(Ze=!1),Kt!=null&&(wf(),dy(Kt,null,Pt,qe,!0),Bf()),ar!=null&&(Ke.renderCache[ar]=void 0),Ri&256){Ke.ctx.deactivate(qe);return}const br=Ri&1&&Ji,Dr=!Ay(qe);let Fr;if(Dr&&(Fr=bi&&bi.onVnodeBeforeUnmount)&&RA(Fr,Ke,qe),Ri&6)mt(qe.component,Pt,It);else{if(Ri&128){qe.suspense.unmount(Pt,It);return}br&&Xp(qe,null,Ke,"beforeUnmount"),Ri&64?qe.type.remove(qe,Ke,Pt,Ut,It):pi&&!pi.hasOnce&&(yi!==Mc||Oi>0&&Oi&64)?Ct(pi,Ke,Pt,!1,!0):(yi===Mc&&Oi&384||!Ze&&Ri&16)&&Ct(di,Ke,Pt),It&&ot(qe)}(Dr&&(Fr=bi&&bi.onVnodeUnmounted)||br)&&Rh(()=>{Fr&&RA(Fr,Ke,qe),br&&Xp(qe,null,Ke,"unmounted")},Pt)},ot=qe=>{const{type:Ke,el:Pt,anchor:It,transition:Ze}=qe;if(Ke===Mc){ut(Pt,It);return}if(Ke===Nx){ne(qe);return}const yi=()=>{c(Pt),Ze&&!Ze.persisted&&Ze.afterLeave&&Ze.afterLeave()};if(qe.shapeFlag&1&&Ze&&!Ze.persisted){const{leave:bi,delayLeave:Kt}=Ze,di=()=>bi(Pt,yi);Kt?Kt(qe.el,yi,di):di()}else yi()},ut=(qe,Ke)=>{let Pt;for(;qe!==Ke;)Pt=T(qe),c(qe),qe=Pt;c(Ke)},mt=(qe,Ke,Pt)=>{const{bum:It,scope:Ze,job:yi,subTree:bi,um:Kt,m:di,a:pi,parent:Ri,slots:{__:Oi}}=qe;nS(di),nS(pi),It&&ov(It),Ri&&Gn(Oi)&&Oi.forEach(Ji=>{Ri.renderCache[Ji]=void 0}),Ze.stop(),yi&&(yi.flags|=8,Ie(bi,qe,Ke,Pt)),Kt&&Rh(Kt,Ke),Rh(()=>{qe.isUnmounted=!0},Ke),Ke&&Ke.pendingBranch&&!Ke.isUnmounted&&qe.asyncDep&&!qe.asyncResolved&&qe.suspenseId===Ke.pendingId&&(Ke.deps--,Ke.deps===0&&Ke.resolve())},Ct=(qe,Ke,Pt,It=!1,Ze=!1,yi=0)=>{for(let bi=yi;bi<qe.length;bi++)Ie(qe[bi],Ke,Pt,It,Ze)},rt=qe=>{if(qe.shapeFlag&6)return rt(qe.component.subTree);if(qe.shapeFlag&128)return qe.suspense.next();const Ke=T(qe.anchor||qe.el),Pt=Ke&&Ke[nP];return Pt?T(Pt):Ke};let Bt=!1;const tt=(qe,Ke,Pt)=>{qe==null?Ke._vnode&&Ie(Ke._vnode,null,null,!0):P(Ke._vnode||null,qe,Ke,null,null,null,Pt),Ke._vnode=qe,Bt||(Bt=!0,$C(),_5(),Bt=!1)},Ut={p:P,um:Ie,m:Qt,r:ot,mt:Be,mc:he,pc:Ye,pbc:Se,n:rt,o:a};return{render:tt,hydrate:void 0,createApp:CP(tt)}}function zx({type:a,props:e},i){return i==="svg"&&a==="foreignObject"||i==="mathml"&&a==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Yp({effect:a,job:e},i){i?(a.flags|=32,e.flags|=4):(a.flags&=-33,e.flags&=-5)}function kP(a,e){return(!a||a&&!a.pendingBranch)&&e&&!e.persisted}function z5(a,e,i=!1){const s=a.children,c=e.children;if(Gn(s)&&Gn(c))for(let d=0;d<s.length;d++){const A=s[d];let r=c[d];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=c[d]=up(c[d]),r.el=A.el),!i&&r.patchFlag!==-2&&z5(A,r)),r.type===e_&&(r.el=A.el),r.type===bp&&!r.el&&(r.el=A.el)}}function RP(a){const e=a.slice(),i=[0];let s,c,d,A,r;const y=a.length;for(s=0;s<y;s++){const b=a[s];if(b!==0){if(c=i[i.length-1],a[c]<b){e[s]=c,i.push(s);continue}for(d=0,A=i.length-1;d<A;)r=d+A>>1,a[i[r]]<b?d=r+1:A=r;b<a[i[d]]&&(d>0&&(e[s]=i[d-1]),i[d]=s)}}for(d=i.length,A=i[d-1];d-- >0;)i[d]=A,A=e[A];return i}function N5(a){const e=a.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:N5(e)}function nS(a){if(a)for(let e=0;e<a.length;e++)a[e].flags|=8}const DP=Symbol.for("v-scx"),OP=()=>Xd(DP);function xf(a,e,i){return j5(a,e,i)}function j5(a,e,i=da){const{immediate:s,deep:c,flush:d,once:A}=i,r=lu({},i),y=e&&s||!e&&d!=="post";let b;if(Fy){if(d==="sync"){const E=OP();b=E.__watcherHandles||(E.__watcherHandles=[])}else if(!y){const E=()=>{};return E.stop=jA,E.resume=jA,E.pause=jA,E}}const x=kc;r.call=(E,R,P)=>VA(E,x,R,P);let B=!1;d==="post"?r.scheduler=E=>{Rh(E,x&&x.suspense)}:d!=="sync"&&(B=!0,r.scheduler=(E,R)=>{R?E():L1(E)}),r.augmentJob=E=>{e&&(E.flags|=4),B&&(E.flags|=2,x&&(E.id=x.uid,E.i=x))};const T=J3(a,e,r);return Fy&&(b?b.push(T):y&&T()),T}function UP(a,e,i){const s=this.proxy,c=Ml(a)?a.includes(".")?H5(s,a):()=>s[a]:a.bind(s,s);let d;Bs(e)?d=e:(d=e.handler,i=e);const A=Wy(this),r=j5(c,d.bind(s),i);return A(),r}function H5(a,e){const i=e.split(".");return()=>{let s=a;for(let c=0;c<i.length&&s;c++)s=s[i[c]];return s}}const zP=(a,e)=>e==="modelValue"||e==="model-value"?a.modelModifiers:a[`${e}Modifiers`]||a[`${ad(e)}Modifiers`]||a[`${yg(e)}Modifiers`];function NP(a,e,...i){if(a.isUnmounted)return;const s=a.vnode.props||da;let c=i;const d=e.startsWith("update:"),A=d&&zP(s,e.slice(7));A&&(A.trim&&(c=i.map(x=>Ml(x)?x.trim():x)),A.number&&(c=i.map(bv)));let r,y=s[r=Px(e)]||s[r=Px(ad(e))];!y&&d&&(y=s[r=Px(yg(e))]),y&&VA(y,a,6,c);const b=s[r+"Once"];if(b){if(!a.emitted)a.emitted={};else if(a.emitted[r])return;a.emitted[r]=!0,VA(b,a,6,c)}}function Q5(a,e,i=!1){const s=e.emitsCache,c=s.get(a);if(c!==void 0)return c;const d=a.emits;let A={},r=!1;if(!Bs(a)){const y=b=>{const x=Q5(b,e,!0);x&&(r=!0,lu(A,x))};!i&&e.mixins.length&&e.mixins.forEach(y),a.extends&&y(a.extends),a.mixins&&a.mixins.forEach(y)}return!d&&!r?(wa(a)&&s.set(a,null),null):(Gn(d)?d.forEach(y=>A[y]=null):lu(A,d),wa(a)&&s.set(a,A),A)}function Jv(a,e){return!a||!Qv(e)?!1:(e=e.slice(2).replace(/Once$/,""),Do(a,e[0].toLowerCase()+e.slice(1))||Do(a,yg(e))||Do(a,e))}function sS(a){const{type:e,vnode:i,proxy:s,withProxy:c,propsOptions:[d],slots:A,attrs:r,emit:y,render:b,renderCache:x,props:B,data:T,setupState:E,ctx:R,inheritAttrs:P}=a,G=Ev(a);let U,Q;try{if(i.shapeFlag&4){const ne=c||s,re=ne;U=zA(b.call(re,ne,x,B,E,T,R)),Q=r}else{const ne=e;U=zA(ne.length>1?ne(B,{attrs:r,slots:A,emit:y}):ne(B,null)),Q=e.props?r:jP(r)}}catch(ne){py.length=0,qv(ne,a,1),U=$n(bp)}let q=U;if(Q&&P!==!1){const ne=Object.keys(Q),{shapeFlag:re}=q;ne.length&&re&7&&(d&&ne.some(_1)&&(Q=HP(Q,d)),q=im(q,Q,!1,!0))}return i.dirs&&(q=im(q,null,!1,!0),q.dirs=q.dirs?q.dirs.concat(i.dirs):i.dirs),i.transition&&M1(q,i.transition),U=q,Ev(G),U}const jP=a=>{let e;for(const i in a)(i==="class"||i==="style"||Qv(i))&&((e||(e={}))[i]=a[i]);return e},HP=(a,e)=>{const i={};for(const s in a)(!_1(s)||!(s.slice(9)in e))&&(i[s]=a[s]);return i};function QP(a,e,i){const{props:s,children:c,component:d}=a,{props:A,children:r,patchFlag:y}=e,b=d.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&y>=0){if(y&1024)return!0;if(y&16)return s?oS(s,A,b):!!A;if(y&8){const x=e.dynamicProps;for(let B=0;B<x.length;B++){const T=x[B];if(A[T]!==s[T]&&!Jv(b,T))return!0}}}else return(c||r)&&(!r||!r.$stable)?!0:s===A?!1:s?A?oS(s,A,b):!0:!!A;return!1}function oS(a,e,i){const s=Object.keys(e);if(s.length!==Object.keys(a).length)return!0;for(let c=0;c<s.length;c++){const d=s[c];if(e[d]!==a[d]&&!Jv(i,d))return!0}return!1}function VP({vnode:a,parent:e},i){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===a&&(s.el=a.el),s===a)(a=e.vnode).el=i,e=e.parent;else break}}const V5=a=>a.__isSuspense;function GP(a,e){e&&e.pendingBranch?Gn(a)?e.effects.push(...a):e.effects.push(a):iP(a)}const Mc=Symbol.for("v-fgt"),e_=Symbol.for("v-txt"),bp=Symbol.for("v-cmt"),Nx=Symbol.for("v-stc"),py=[];let Oh=null;function os(a=!1){py.push(Oh=a?null:[])}function WP(){py.pop(),Oh=py[py.length-1]||null}let Iy=1;function aS(a,e=!1){Iy+=a,a<0&&Oh&&e&&(Oh.hasOnce=!0)}function G5(a){return a.dynamicChildren=Iy>0?Oh||Kg:null,WP(),Iy>0&&Oh&&Oh.push(a),a}function Hs(a,e,i,s,c,d){return G5(Tt(a,e,i,s,c,d,!0))}function tg(a,e,i,s,c){return G5($n(a,e,i,s,c,!0))}function Iv(a){return a?a.__v_isVNode===!0:!1}function Jm(a,e){return a.type===e.type&&a.key===e.key}const W5=({key:a})=>a??null,lv=({ref:a,ref_key:e,ref_for:i})=>(typeof a=="number"&&(a=""+a),a!=null?Ml(a)||Dc(a)||Bs(a)?{i:nh,r:a,k:e,f:!!i}:a:null);function Tt(a,e=null,i=null,s=0,c=null,d=a===Mc?0:1,A=!1,r=!1){const y={__v_isVNode:!0,__v_skip:!0,type:a,props:e,key:e&&W5(e),ref:e&&lv(e),scopeId:b5,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:s,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:nh};return r?(D1(y,i),d&128&&a.normalize(y)):i&&(y.shapeFlag|=Ml(i)?8:16),Iy>0&&!A&&Oh&&(y.patchFlag>0||d&6)&&y.patchFlag!==32&&Oh.push(y),y}const $n=XP;function XP(a,e=null,i=null,s=0,c=null,d=!1){if((!a||a===gP)&&(a=bp),Iv(a)){const r=im(a,e,!0);return i&&D1(r,i),Iy>0&&!d&&Oh&&(r.shapeFlag&6?Oh[Oh.indexOf(a)]=r:Oh.push(r)),r.patchFlag=-2,r}if(s4(a)&&(a=a.__vccOpts),e){e=YP(e);let{class:r,style:y}=e;r&&!Ml(r)&&(e.class=yp(r)),wa(y)&&(F1(y)&&!Gn(y)&&(y=lu({},y)),e.style=w1(y))}const A=Ml(a)?1:V5(a)?128:sP(a)?64:wa(a)?4:Bs(a)?2:0;return Tt(a,e,i,s,c,A,d,!0)}function YP(a){return a?F1(a)||P5(a)?lu({},a):a:null}function im(a,e,i=!1,s=!1){const{props:c,ref:d,patchFlag:A,children:r,transition:y}=a,b=e?KP(c||{},e):c,x={__v_isVNode:!0,__v_skip:!0,type:a.type,props:b,key:b&&W5(b),ref:e&&e.ref?i&&d?Gn(d)?d.concat(lv(e)):[d,lv(e)]:lv(e):d,scopeId:a.scopeId,slotScopeIds:a.slotScopeIds,children:r,target:a.target,targetStart:a.targetStart,targetAnchor:a.targetAnchor,staticCount:a.staticCount,shapeFlag:a.shapeFlag,patchFlag:e&&a.type!==Mc?A===-1?16:A|16:A,dynamicProps:a.dynamicProps,dynamicChildren:a.dynamicChildren,appContext:a.appContext,dirs:a.dirs,transition:y,component:a.component,suspense:a.suspense,ssContent:a.ssContent&&im(a.ssContent),ssFallback:a.ssFallback&&im(a.ssFallback),el:a.el,anchor:a.anchor,ctx:a.ctx,ce:a.ce};return y&&s&&M1(x,y.clone(x)),x}function Fv(a=" ",e=0){return $n(e_,null,a,e)}function t_(a="",e=!1){return e?(os(),tg(bp,null,a)):$n(bp,null,a)}function zA(a){return a==null||typeof a=="boolean"?$n(bp):Gn(a)?$n(Mc,null,a.slice()):Iv(a)?up(a):$n(e_,null,String(a))}function up(a){return a.el===null&&a.patchFlag!==-1||a.memo?a:im(a)}function D1(a,e){let i=0;const{shapeFlag:s}=a;if(e==null)e=null;else if(Gn(e))i=16;else if(typeof e=="object")if(s&65){const c=e.default;c&&(c._c&&(c._d=!1),D1(a,c()),c._c&&(c._d=!0));return}else{i=32;const c=e._;!c&&!P5(e)?e._ctx=nh:c===3&&nh&&(nh.slots._===1?e._=1:(e._=2,a.patchFlag|=1024))}else Bs(e)?(e={default:e,_ctx:nh},i=32):(e=String(e),s&64?(i=16,e=[Fv(e)]):i=8);a.children=e,a.shapeFlag|=i}function KP(...a){const e={};for(let i=0;i<a.length;i++){const s=a[i];for(const c in s)if(c==="class")e.class!==s.class&&(e.class=yp([e.class,s.class]));else if(c==="style")e.style=w1([e.style,s.style]);else if(Qv(c)){const d=e[c],A=s[c];A&&d!==A&&!(Gn(d)&&d.includes(A))&&(e[c]=d?[].concat(d,A):A)}else c!==""&&(e[c]=s[c])}return e}function RA(a,e,i,s=null){VA(a,e,7,[i,s])}const qP=F5();let $P=0;function ZP(a,e,i){const s=a.type,c=(e?e.appContext:a.appContext)||qP,d={uid:$P++,vnode:a,type:s,parent:e,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new b3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(c.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:R5(s,c),emitsOptions:Q5(s,c),emit:null,emitted:null,propsDefaults:da,inheritAttrs:s.inheritAttrs,ctx:da,data:da,props:da,attrs:da,slots:da,refs:da,setupState:da,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=e?e.root:d,d.emit=NP.bind(null,d),a.ce&&a.ce(d),d}let kc=null;const JP=()=>kc||nh;let Lv,Lb;{const a=Xv(),e=(i,s)=>{let c;return(c=a[i])||(c=a[i]=[]),c.push(s),d=>{c.length>1?c.forEach(A=>A(d)):c[0](d)}};Lv=e("__VUE_INSTANCE_SETTERS__",i=>kc=i),Lb=e("__VUE_SSR_SETTERS__",i=>Fy=i)}const Wy=a=>{const e=kc;return Lv(a),a.scope.on(),()=>{a.scope.off(),Lv(e)}},lS=()=>{kc&&kc.scope.off(),Lv(null)};function X5(a){return a.vnode.shapeFlag&4}let Fy=!1;function e4(a,e=!1,i=!1){e&&Lb(e);const{props:s,children:c}=a.vnode,d=X5(a);SP(a,s,d,e),FP(a,c,i||e);const A=d?t4(a,e):void 0;return e&&Lb(!1),A}function t4(a,e){const i=a.type;a.accessCache=Object.create(null),a.proxy=new Proxy(a.ctx,yP);const{setup:s}=i;if(s){wf();const c=a.setupContext=s.length>1?r4(a):null,d=Wy(a),A=Vy(s,a,0,[a.props,c]),r=YE(A);if(Bf(),d(),(r||a.sp)&&!Ay(a)&&w5(a),r){if(A.then(lS,lS),e)return A.then(y=>{cS(a,y)}).catch(y=>{qv(y,a,0)});a.asyncDep=A}else cS(a,A)}else Y5(a)}function cS(a,e,i){Bs(e)?a.type.__ssrInlineRender?a.ssrRender=e:a.render=e:wa(e)&&(a.setupState=m5(e)),Y5(a)}function Y5(a,e,i){const s=a.type;a.render||(a.render=s.render||jA);{const c=Wy(a);wf();try{vP(a)}finally{Bf(),c()}}}const i4={get(a,e){return su(a,"get",""),a[e]}};function r4(a){const e=i=>{a.exposed=i||{}};return{attrs:new Proxy(a.attrs,i4),slots:a.slots,emit:a.emit,expose:e}}function i_(a){return a.exposed?a.exposeProxy||(a.exposeProxy=new Proxy(m5(Q3(a.exposed)),{get(e,i){if(i in e)return e[i];if(i in fy)return fy[i](a)},has(e,i){return i in e||i in fy}})):a.proxy}function n4(a,e=!0){return Bs(a)?a.displayName||a.name:a.name||e&&a.__name}function s4(a){return Bs(a)&&"__vccOpts"in a}const Dh=(a,e)=>$3(a,e,Fy);function O1(a,e,i){const s=arguments.length;return s===2?wa(e)&&!Gn(e)?Iv(e)?$n(a,null,[e]):$n(a,e):$n(a,null,e):(s>3?i=Array.prototype.slice.call(arguments,2):s===3&&Iv(i)&&(i=[i]),$n(a,e,i))}const o4="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Mb;const uS=typeof window<"u"&&window.trustedTypes;if(uS)try{Mb=uS.createPolicy("vue",{createHTML:a=>a})}catch{}const K5=Mb?a=>Mb.createHTML(a):a=>a,a4="http://www.w3.org/2000/svg",l4="http://www.w3.org/1998/Math/MathML",yf=typeof document<"u"?document:null,hS=yf&&yf.createElement("template"),c4={insert:(a,e,i)=>{e.insertBefore(a,i||null)},remove:a=>{const e=a.parentNode;e&&e.removeChild(a)},createElement:(a,e,i,s)=>{const c=e==="svg"?yf.createElementNS(a4,a):e==="mathml"?yf.createElementNS(l4,a):i?yf.createElement(a,{is:i}):yf.createElement(a);return a==="select"&&s&&s.multiple!=null&&c.setAttribute("multiple",s.multiple),c},createText:a=>yf.createTextNode(a),createComment:a=>yf.createComment(a),setText:(a,e)=>{a.nodeValue=e},setElementText:(a,e)=>{a.textContent=e},parentNode:a=>a.parentNode,nextSibling:a=>a.nextSibling,querySelector:a=>yf.querySelector(a),setScopeId(a,e){a.setAttribute(e,"")},insertStaticContent(a,e,i,s,c,d){const A=i?i.previousSibling:e.lastChild;if(c&&(c===d||c.nextSibling))for(;e.insertBefore(c.cloneNode(!0),i),!(c===d||!(c=c.nextSibling)););else{hS.innerHTML=K5(s==="svg"?`<svg>${a}</svg>`:s==="mathml"?`<math>${a}</math>`:a);const r=hS.content;if(s==="svg"||s==="mathml"){const y=r.firstChild;for(;y.firstChild;)r.appendChild(y.firstChild);r.removeChild(y)}e.insertBefore(r,i)}return[A?A.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},u4=Symbol("_vtc");function h4(a,e,i){const s=a[u4];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?a.removeAttribute("class"):i?a.setAttribute("class",e):a.className=e}const Mv=Symbol("_vod"),q5=Symbol("_vsh"),Z0={beforeMount(a,{value:e},{transition:i}){a[Mv]=a.style.display==="none"?"":a.style.display,i&&e?i.beforeEnter(a):ey(a,e)},mounted(a,{value:e},{transition:i}){i&&e&&i.enter(a)},updated(a,{value:e,oldValue:i},{transition:s}){!e!=!i&&(s?e?(s.beforeEnter(a),ey(a,!0),s.enter(a)):s.leave(a,()=>{ey(a,!1)}):ey(a,e))},beforeUnmount(a,{value:e}){ey(a,e)}};function ey(a,e){a.style.display=e?a[Mv]:"none",a[q5]=!e}const d4=Symbol(""),A4=/(^|;)\s*display\s*:/;function f4(a,e,i){const s=a.style,c=Ml(i);let d=!1;if(i&&!c){if(e)if(Ml(e))for(const A of e.split(";")){const r=A.slice(0,A.indexOf(":")).trim();i[r]==null&&cv(s,r,"")}else for(const A in e)i[A]==null&&cv(s,A,"");for(const A in i)A==="display"&&(d=!0),cv(s,A,i[A])}else if(c){if(e!==i){const A=s[d4];A&&(i+=";"+A),s.cssText=i,d=A4.test(i)}}else e&&a.removeAttribute("style");Mv in a&&(a[Mv]=d?s.display:"",a[q5]&&(s.display="none"))}const dS=/\s*!important$/;function cv(a,e,i){if(Gn(i))i.forEach(s=>cv(a,e,s));else if(i==null&&(i=""),e.startsWith("--"))a.setProperty(e,i);else{const s=p4(a,e);dS.test(i)?a.setProperty(yg(s),i.replace(dS,""),"important"):a[s]=i}}const AS=["Webkit","Moz","ms"],jx={};function p4(a,e){const i=jx[e];if(i)return i;let s=ad(e);if(s!=="filter"&&s in a)return jx[e]=s;s=Wv(s);for(let c=0;c<AS.length;c++){const d=AS[c]+s;if(d in a)return jx[e]=d}return e}const fS="http://www.w3.org/1999/xlink";function pS(a,e,i,s,c,d=v3(e)){s&&e.startsWith("xlink:")?i==null?a.removeAttributeNS(fS,e.slice(6,e.length)):a.setAttributeNS(fS,e,i):i==null||d&&!$E(i)?a.removeAttribute(e):a.setAttribute(e,d?"":QA(i)?String(i):i)}function gS(a,e,i,s,c){if(e==="innerHTML"||e==="textContent"){i!=null&&(a[e]=e==="innerHTML"?K5(i):i);return}const d=a.tagName;if(e==="value"&&d!=="PROGRESS"&&!d.includes("-")){const r=d==="OPTION"?a.getAttribute("value")||"":a.value,y=i==null?a.type==="checkbox"?"on":"":String(i);(r!==y||!("_value"in a))&&(a.value=y),i==null&&a.removeAttribute(e),a._value=i;return}let A=!1;if(i===""||i==null){const r=typeof a[e];r==="boolean"?i=$E(i):i==null&&r==="string"?(i="",A=!0):r==="number"&&(i=0,A=!0)}try{a[e]=i}catch{}A&&a.removeAttribute(c||e)}function Jp(a,e,i,s){a.addEventListener(e,i,s)}function g4(a,e,i,s){a.removeEventListener(e,i,s)}const mS=Symbol("_vei");function m4(a,e,i,s,c=null){const d=a[mS]||(a[mS]={}),A=d[e];if(s&&A)A.value=s;else{const[r,y]=y4(e);if(s){const b=d[e]=x4(s,c);Jp(a,r,b,y)}else A&&(g4(a,r,A,y),d[e]=void 0)}}const yS=/(?:Once|Passive|Capture)$/;function y4(a){let e;if(yS.test(a)){e={};let s;for(;s=a.match(yS);)a=a.slice(0,a.length-s[0].length),e[s[0].toLowerCase()]=!0}return[a[2]===":"?a.slice(3):yg(a.slice(2)),e]}let Hx=0;const v4=Promise.resolve(),_4=()=>Hx||(v4.then(()=>Hx=0),Hx=Date.now());function x4(a,e){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;VA(b4(s,i.value),e,5,[s])};return i.value=a,i.attached=_4(),i}function b4(a,e){if(Gn(e)){const i=a.stopImmediatePropagation;return a.stopImmediatePropagation=()=>{i.call(a),a._stopped=!0},e.map(s=>c=>!c._stopped&&s&&s(c))}else return e}const vS=a=>a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)>96&&a.charCodeAt(2)<123,w4=(a,e,i,s,c,d)=>{const A=c==="svg";e==="class"?h4(a,s,A):e==="style"?f4(a,i,s):Qv(e)?_1(e)||m4(a,e,i,s,d):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):B4(a,e,s,A))?(gS(a,e,s),!a.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&pS(a,e,s,A,d,e!=="value")):a._isVueCE&&(/[A-Z]/.test(e)||!Ml(s))?gS(a,ad(e),s,d,e):(e==="true-value"?a._trueValue=s:e==="false-value"&&(a._falseValue=s),pS(a,e,s,A))};function B4(a,e,i,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in a&&vS(e)&&Bs(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&a.tagName==="INPUT"||e==="type"&&a.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const c=a.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return vS(e)&&Ml(i)?!1:e in a}const Pv=a=>{const e=a.props["onUpdate:modelValue"]||!1;return Gn(e)?i=>ov(e,i):e};function C4(a){a.target.composing=!0}function _S(a){const e=a.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const em=Symbol("_assign"),Yl={created(a,{modifiers:{lazy:e,trim:i,number:s}},c){a[em]=Pv(c);const d=s||c.props&&c.props.type==="number";Jp(a,e?"change":"input",A=>{if(A.target.composing)return;let r=a.value;i&&(r=r.trim()),d&&(r=bv(r)),a[em](r)}),i&&Jp(a,"change",()=>{a.value=a.value.trim()}),e||(Jp(a,"compositionstart",C4),Jp(a,"compositionend",_S),Jp(a,"change",_S))},mounted(a,{value:e}){a.value=e??""},beforeUpdate(a,{value:e,oldValue:i,modifiers:{lazy:s,trim:c,number:d}},A){if(a[em]=Pv(A),a.composing)return;const r=(d||a.type==="number")&&!/^0\d/.test(a.value)?bv(a.value):a.value,y=e??"";r!==y&&(document.activeElement===a&&a.type!=="range"&&(s&&e===i||c&&a.value.trim()===y)||(a.value=y))}},r_={deep:!0,created(a,{value:e,modifiers:{number:i}},s){const c=Vv(e);Jp(a,"change",()=>{const d=Array.prototype.filter.call(a.options,A=>A.selected).map(A=>i?bv(kv(A)):kv(A));a[em](a.multiple?c?new Set(d):d:d[0]),a._assigning=!0,$v(()=>{a._assigning=!1})}),a[em]=Pv(s)},mounted(a,{value:e}){xS(a,e)},beforeUpdate(a,e,i){a[em]=Pv(i)},updated(a,{value:e}){a._assigning||xS(a,e)}};function xS(a,e){const i=a.multiple,s=Gn(e);if(!(i&&!s&&!Vv(e))){for(let c=0,d=a.options.length;c<d;c++){const A=a.options[c],r=kv(A);if(i)if(s){const y=typeof r;y==="string"||y==="number"?A.selected=e.some(b=>String(b)===String(r)):A.selected=x3(e,r)>-1}else A.selected=e.has(r);else if(Yv(kv(A),e)){a.selectedIndex!==c&&(a.selectedIndex=c);return}}!i&&a.selectedIndex!==-1&&(a.selectedIndex=-1)}}function kv(a){return"_value"in a?a._value:a.value}const S4=["ctrl","shift","alt","meta"],E4={stop:a=>a.stopPropagation(),prevent:a=>a.preventDefault(),self:a=>a.target!==a.currentTarget,ctrl:a=>!a.ctrlKey,shift:a=>!a.shiftKey,alt:a=>!a.altKey,meta:a=>!a.metaKey,left:a=>"button"in a&&a.button!==0,middle:a=>"button"in a&&a.button!==1,right:a=>"button"in a&&a.button!==2,exact:(a,e)=>S4.some(i=>a[`${i}Key`]&&!e.includes(i))},T4=(a,e)=>{const i=a._withMods||(a._withMods={}),s=e.join(".");return i[s]||(i[s]=(c,...d)=>{for(let A=0;A<e.length;A++){const r=E4[e[A]];if(r&&r(c,e))return}return a(c,...d)})},I4=lu({patchProp:w4},c4);let bS;function F4(){return bS||(bS=MP(I4))}const L4=(...a)=>{const e=F4().createApp(...a),{mount:i}=e;return e.mount=s=>{const c=P4(s);if(!c)return;const d=e._component;!Bs(d)&&!d.render&&!d.template&&(d.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const A=i(c,!1,M4(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),A},e};function M4(a){if(a instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&a instanceof MathMLElement)return"mathml"}function P4(a){return Ml(a)?document.querySelector(a):a}const Uc=(a,e)=>{const i=a.__vccOpts||a;for(const[s,c]of e)i[s]=c;return i},k4={class:"custom-sidebar-header"},R4={class:"sidebar-title"},D4={class:"sidebar-title"},O4={class:"custom-sidebar-menu"},U4=["href"],z4={key:0,class:"submenu"},N4=["href"],j4={class:"sidebar-footer"},H4={key:0,class:"mdi mdi-chevron-left"},Q4={key:1,class:"mdi mdi-chevron-right"},V4={__name:"Sidebar",props:{isCollapsed:{type:Boolean,default:!1}},emits:["toggleSidebar"],setup(a,{emit:e}){const i=[{href:"/",title:"Tiempo Real",icon:"mdi mdi-clock-outline"},{title:"Histricos",icon:"mdi mdi-history",child:[{href:"/historicos/tendencias",title:"Tendencias"},{href:"/historicos/estadisticas",title:"Estadsticas"},{href:"/historicos/factor-carga",title:"Factor de Carga"},{href:"/historicos/anomalias",title:"Anomalas"},{href:"/historicos/patrones",title:"Patrones"}]},{href:"/reportes",title:"Reportes",icon:"mdi mdi-file-chart"},{href:"/consumo",title:"Anlisis de Consumo",icon:"mdi mdi-flash-auto"},{href:"/configuracion",title:"Configuracin",icon:"mdi mdi-cog-outline"}];return(s,c)=>(os(),Hs("div",{class:yp(["custom-sidebar",{collapsed:a.isCollapsed}])},[Tt("div",k4,[fa(Tt("h1",R4,"ANALTICA ENERGTICA",512),[[Z0,!a.isCollapsed]]),fa(Tt("h1",D4,"AE",512),[[Z0,a.isCollapsed]])]),Tt("nav",O4,[Tt("ul",null,[(os(),Hs(Mc,null,xp(i,(d,A)=>Tt("li",{key:A},[Tt("a",{href:d.href?d.href:"#",class:"menu-item"},[Tt("i",{class:yp(d.icon)},null,2),fa(Tt("span",{class:"menu-title"},$s(d.title),513),[[Z0,!a.isCollapsed]])],8,U4),d.child?fa((os(),Hs("ul",z4,[(os(!0),Hs(Mc,null,xp(d.child,(r,y)=>(os(),Hs("li",{key:y},[Tt("a",{href:r.href,class:"submenu-item"},$s(r.title),9,N4)]))),128))],512)),[[Z0,!a.isCollapsed]]):t_("",!0)])),64))])]),Tt("div",j4,[Tt("button",{class:"toggle-button",onClick:c[0]||(c[0]=d=>s.$emit("toggleSidebar"))},[a.isCollapsed?(os(),Hs("i",Q4)):(os(),Hs("i",H4))])])],2))}},G4=Uc(V4,[["__scopeId","data-v-58342198"]]),W4={class:"layout"},X4={class:"main-content"},Y4={__name:"App",setup(a){const e=fr(!1);function i(){e.value=!e.value}return(s,c)=>{const d=Gy("router-view");return os(),Hs("div",W4,[Tt("aside",{class:yp({sidebar:!0,collapsed:e.value})},[$n(G4,{"is-collapsed":e.value,onToggleSidebar:i},null,8,["is-collapsed"])],2),Tt("main",X4,[(os(),tg(d,{key:s.$route.fullPath}))])])}}},K4=Uc(Y4,[["__scopeId","data-v-f2f7c615"]]);/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Gg=typeof document<"u";function $5(a){return typeof a=="object"||"displayName"in a||"props"in a||"__vccOpts"in a}function q4(a){return a.__esModule||a[Symbol.toStringTag]==="Module"||a.default&&$5(a.default)}const Ro=Object.assign;function Qx(a,e){const i={};for(const s in e){const c=e[s];i[s]=Kd(c)?c.map(a):a(c)}return i}const gy=()=>{},Kd=Array.isArray,Z5=/#/g,$4=/&/g,Z4=/\//g,J4=/=/g,ek=/\?/g,J5=/\+/g,tk=/%5B/g,ik=/%5D/g,eT=/%5E/g,rk=/%60/g,tT=/%7B/g,nk=/%7C/g,iT=/%7D/g,sk=/%20/g;function U1(a){return encodeURI(""+a).replace(nk,"|").replace(tk,"[").replace(ik,"]")}function ok(a){return U1(a).replace(tT,"{").replace(iT,"}").replace(eT,"^")}function Pb(a){return U1(a).replace(J5,"%2B").replace(sk,"+").replace(Z5,"%23").replace($4,"%26").replace(rk,"`").replace(tT,"{").replace(iT,"}").replace(eT,"^")}function ak(a){return Pb(a).replace(J4,"%3D")}function lk(a){return U1(a).replace(Z5,"%23").replace(ek,"%3F")}function ck(a){return a==null?"":lk(a).replace(Z4,"%2F")}function Ly(a){try{return decodeURIComponent(""+a)}catch{}return""+a}const uk=/\/$/,hk=a=>a.replace(uk,"");function Vx(a,e,i="/"){let s,c={},d="",A="";const r=e.indexOf("#");let y=e.indexOf("?");return r<y&&r>=0&&(y=-1),y>-1&&(s=e.slice(0,y),d=e.slice(y+1,r>-1?r:e.length),c=a(d)),r>-1&&(s=s||e.slice(0,r),A=e.slice(r,e.length)),s=pk(s??e,i),{fullPath:s+(d&&"?")+d+A,path:s,query:c,hash:Ly(A)}}function dk(a,e){const i=e.query?a(e.query):"";return e.path+(i&&"?")+i+(e.hash||"")}function wS(a,e){return!e||!a.toLowerCase().startsWith(e.toLowerCase())?a:a.slice(e.length)||"/"}function Ak(a,e,i){const s=e.matched.length-1,c=i.matched.length-1;return s>-1&&s===c&&rm(e.matched[s],i.matched[c])&&rT(e.params,i.params)&&a(e.query)===a(i.query)&&e.hash===i.hash}function rm(a,e){return(a.aliasOf||a)===(e.aliasOf||e)}function rT(a,e){if(Object.keys(a).length!==Object.keys(e).length)return!1;for(const i in a)if(!fk(a[i],e[i]))return!1;return!0}function fk(a,e){return Kd(a)?BS(a,e):Kd(e)?BS(e,a):a===e}function BS(a,e){return Kd(e)?a.length===e.length&&a.every((i,s)=>i===e[s]):a.length===1&&a[0]===e}function pk(a,e){if(a.startsWith("/"))return a;if(!a)return e;const i=e.split("/"),s=a.split("/"),c=s[s.length-1];(c===".."||c===".")&&s.push("");let d=i.length-1,A,r;for(A=0;A<s.length;A++)if(r=s[A],r!==".")if(r==="..")d>1&&d--;else break;return i.slice(0,d).join("/")+"/"+s.slice(A).join("/")}const op={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var My;(function(a){a.pop="pop",a.push="push"})(My||(My={}));var my;(function(a){a.back="back",a.forward="forward",a.unknown=""})(my||(my={}));function gk(a){if(!a)if(Gg){const e=document.querySelector("base");a=e&&e.getAttribute("href")||"/",a=a.replace(/^\w+:\/\/[^\/]+/,"")}else a="/";return a[0]!=="/"&&a[0]!=="#"&&(a="/"+a),hk(a)}const mk=/^[^#]+#/;function yk(a,e){return a.replace(mk,"#")+e}function vk(a,e){const i=document.documentElement.getBoundingClientRect(),s=a.getBoundingClientRect();return{behavior:e.behavior,left:s.left-i.left-(e.left||0),top:s.top-i.top-(e.top||0)}}const n_=()=>({left:window.scrollX,top:window.scrollY});function _k(a){let e;if("el"in a){const i=a.el,s=typeof i=="string"&&i.startsWith("#"),c=typeof i=="string"?s?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!c)return;e=vk(c,a)}else e=a;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function CS(a,e){return(history.state?history.state.position-e:-1)+a}const kb=new Map;function xk(a,e){kb.set(a,e)}function bk(a){const e=kb.get(a);return kb.delete(a),e}let wk=()=>location.protocol+"//"+location.host;function nT(a,e){const{pathname:i,search:s,hash:c}=e,d=a.indexOf("#");if(d>-1){let r=c.includes(a.slice(d))?a.slice(d).length:1,y=c.slice(r);return y[0]!=="/"&&(y="/"+y),wS(y,"")}return wS(i,a)+s+c}function Bk(a,e,i,s){let c=[],d=[],A=null;const r=({state:T})=>{const E=nT(a,location),R=i.value,P=e.value;let G=0;if(T){if(i.value=E,e.value=T,A&&A===R){A=null;return}G=P?T.position-P.position:0}else s(E);c.forEach(U=>{U(i.value,R,{delta:G,type:My.pop,direction:G?G>0?my.forward:my.back:my.unknown})})};function y(){A=i.value}function b(T){c.push(T);const E=()=>{const R=c.indexOf(T);R>-1&&c.splice(R,1)};return d.push(E),E}function x(){const{history:T}=window;T.state&&T.replaceState(Ro({},T.state,{scroll:n_()}),"")}function B(){for(const T of d)T();d=[],window.removeEventListener("popstate",r),window.removeEventListener("beforeunload",x)}return window.addEventListener("popstate",r),window.addEventListener("beforeunload",x,{passive:!0}),{pauseListeners:y,listen:b,destroy:B}}function SS(a,e,i,s=!1,c=!1){return{back:a,current:e,forward:i,replaced:s,position:window.history.length,scroll:c?n_():null}}function Ck(a){const{history:e,location:i}=window,s={value:nT(a,i)},c={value:e.state};c.value||d(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function d(y,b,x){const B=a.indexOf("#"),T=B>-1?(i.host&&document.querySelector("base")?a:a.slice(B))+y:wk()+a+y;try{e[x?"replaceState":"pushState"](b,"",T),c.value=b}catch(E){console.error(E),i[x?"replace":"assign"](T)}}function A(y,b){const x=Ro({},e.state,SS(c.value.back,y,c.value.forward,!0),b,{position:c.value.position});d(y,x,!0),s.value=y}function r(y,b){const x=Ro({},c.value,e.state,{forward:y,scroll:n_()});d(x.current,x,!0);const B=Ro({},SS(s.value,y,null),{position:x.position+1},b);d(y,B,!1),s.value=y}return{location:s,state:c,push:r,replace:A}}function Sk(a){a=gk(a);const e=Ck(a),i=Bk(a,e.state,e.location,e.replace);function s(d,A=!0){A||i.pauseListeners(),history.go(d)}const c=Ro({location:"",base:a,go:s,createHref:yk.bind(null,a)},e,i);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>e.state.value}),c}function Ek(a){return typeof a=="string"||a&&typeof a=="object"}function sT(a){return typeof a=="string"||typeof a=="symbol"}const oT=Symbol("");var ES;(function(a){a[a.aborted=4]="aborted",a[a.cancelled=8]="cancelled",a[a.duplicated=16]="duplicated"})(ES||(ES={}));function nm(a,e){return Ro(new Error,{type:a,[oT]:!0},e)}function gf(a,e){return a instanceof Error&&oT in a&&(e==null||!!(a.type&e))}const TS="[^/]+?",Tk={sensitive:!1,strict:!1,start:!0,end:!0},Ik=/[.+*?^${}()[\]/\\]/g;function Fk(a,e){const i=Ro({},Tk,e),s=[];let c=i.start?"^":"";const d=[];for(const b of a){const x=b.length?[]:[90];i.strict&&!b.length&&(c+="/");for(let B=0;B<b.length;B++){const T=b[B];let E=40+(i.sensitive?.25:0);if(T.type===0)B||(c+="/"),c+=T.value.replace(Ik,"\\$&"),E+=40;else if(T.type===1){const{value:R,repeatable:P,optional:G,regexp:U}=T;d.push({name:R,repeatable:P,optional:G});const Q=U||TS;if(Q!==TS){E+=10;try{new RegExp(`(${Q})`)}catch(ne){throw new Error(`Invalid custom RegExp for param "${R}" (${Q}): `+ne.message)}}let q=P?`((?:${Q})(?:/(?:${Q}))*)`:`(${Q})`;B||(q=G&&b.length<2?`(?:/${q})`:"/"+q),G&&(q+="?"),c+=q,E+=20,G&&(E+=-8),P&&(E+=-20),Q===".*"&&(E+=-50)}x.push(E)}s.push(x)}if(i.strict&&i.end){const b=s.length-1;s[b][s[b].length-1]+=.7000000000000001}i.strict||(c+="/?"),i.end?c+="$":i.strict&&!c.endsWith("/")&&(c+="(?:/|$)");const A=new RegExp(c,i.sensitive?"":"i");function r(b){const x=b.match(A),B={};if(!x)return null;for(let T=1;T<x.length;T++){const E=x[T]||"",R=d[T-1];B[R.name]=E&&R.repeatable?E.split("/"):E}return B}function y(b){let x="",B=!1;for(const T of a){(!B||!x.endsWith("/"))&&(x+="/"),B=!1;for(const E of T)if(E.type===0)x+=E.value;else if(E.type===1){const{value:R,repeatable:P,optional:G}=E,U=R in b?b[R]:"";if(Kd(U)&&!P)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const Q=Kd(U)?U.join("/"):U;if(!Q)if(G)T.length<2&&(x.endsWith("/")?x=x.slice(0,-1):B=!0);else throw new Error(`Missing required param "${R}"`);x+=Q}}return x||"/"}return{re:A,score:s,keys:d,parse:r,stringify:y}}function Lk(a,e){let i=0;for(;i<a.length&&i<e.length;){const s=e[i]-a[i];if(s)return s;i++}return a.length<e.length?a.length===1&&a[0]===80?-1:1:a.length>e.length?e.length===1&&e[0]===80?1:-1:0}function aT(a,e){let i=0;const s=a.score,c=e.score;for(;i<s.length&&i<c.length;){const d=Lk(s[i],c[i]);if(d)return d;i++}if(Math.abs(c.length-s.length)===1){if(IS(s))return 1;if(IS(c))return-1}return c.length-s.length}function IS(a){const e=a[a.length-1];return a.length>0&&e[e.length-1]<0}const Mk={type:0,value:""},Pk=/[a-zA-Z0-9_]/;function kk(a){if(!a)return[[]];if(a==="/")return[[Mk]];if(!a.startsWith("/"))throw new Error(`Invalid path "${a}"`);function e(E){throw new Error(`ERR (${i})/"${b}": ${E}`)}let i=0,s=i;const c=[];let d;function A(){d&&c.push(d),d=[]}let r=0,y,b="",x="";function B(){b&&(i===0?d.push({type:0,value:b}):i===1||i===2||i===3?(d.length>1&&(y==="*"||y==="+")&&e(`A repeatable param (${b}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:b,regexp:x,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):e("Invalid state to consume buffer"),b="")}function T(){b+=y}for(;r<a.length;){if(y=a[r++],y==="\\"&&i!==2){s=i,i=4;continue}switch(i){case 0:y==="/"?(b&&B(),A()):y===":"?(B(),i=1):T();break;case 4:T(),i=s;break;case 1:y==="("?i=2:Pk.test(y)?T():(B(),i=0,y!=="*"&&y!=="?"&&y!=="+"&&r--);break;case 2:y===")"?x[x.length-1]=="\\"?x=x.slice(0,-1)+y:i=3:x+=y;break;case 3:B(),i=0,y!=="*"&&y!=="?"&&y!=="+"&&r--,x="";break;default:e("Unknown state");break}}return i===2&&e(`Unfinished custom RegExp for param "${b}"`),B(),A(),c}function Rk(a,e,i){const s=Fk(kk(a.path),i),c=Ro(s,{record:a,parent:e,children:[],alias:[]});return e&&!c.record.aliasOf==!e.record.aliasOf&&e.children.push(c),c}function Dk(a,e){const i=[],s=new Map;e=PS({strict:!1,end:!0,sensitive:!1},e);function c(B){return s.get(B)}function d(B,T,E){const R=!E,P=LS(B);P.aliasOf=E&&E.record;const G=PS(e,B),U=[P];if("alias"in B){const ne=typeof B.alias=="string"?[B.alias]:B.alias;for(const re of ne)U.push(LS(Ro({},P,{components:E?E.record.components:P.components,path:re,aliasOf:E?E.record:P})))}let Q,q;for(const ne of U){const{path:re}=ne;if(T&&re[0]!=="/"){const pe=T.record.path,fe=pe[pe.length-1]==="/"?"":"/";ne.path=T.record.path+(re&&fe+re)}if(Q=Rk(ne,T,G),E?E.alias.push(Q):(q=q||Q,q!==Q&&q.alias.push(Q),R&&B.name&&!MS(Q)&&A(B.name)),lT(Q)&&y(Q),P.children){const pe=P.children;for(let fe=0;fe<pe.length;fe++)d(pe[fe],Q,E&&E.children[fe])}E=E||Q}return q?()=>{A(q)}:gy}function A(B){if(sT(B)){const T=s.get(B);T&&(s.delete(B),i.splice(i.indexOf(T),1),T.children.forEach(A),T.alias.forEach(A))}else{const T=i.indexOf(B);T>-1&&(i.splice(T,1),B.record.name&&s.delete(B.record.name),B.children.forEach(A),B.alias.forEach(A))}}function r(){return i}function y(B){const T=zk(B,i);i.splice(T,0,B),B.record.name&&!MS(B)&&s.set(B.record.name,B)}function b(B,T){let E,R={},P,G;if("name"in B&&B.name){if(E=s.get(B.name),!E)throw nm(1,{location:B});G=E.record.name,R=Ro(FS(T.params,E.keys.filter(q=>!q.optional).concat(E.parent?E.parent.keys.filter(q=>q.optional):[]).map(q=>q.name)),B.params&&FS(B.params,E.keys.map(q=>q.name))),P=E.stringify(R)}else if(B.path!=null)P=B.path,E=i.find(q=>q.re.test(P)),E&&(R=E.parse(P),G=E.record.name);else{if(E=T.name?s.get(T.name):i.find(q=>q.re.test(T.path)),!E)throw nm(1,{location:B,currentLocation:T});G=E.record.name,R=Ro({},T.params,B.params),P=E.stringify(R)}const U=[];let Q=E;for(;Q;)U.unshift(Q.record),Q=Q.parent;return{name:G,path:P,params:R,matched:U,meta:Uk(U)}}a.forEach(B=>d(B));function x(){i.length=0,s.clear()}return{addRoute:d,resolve:b,removeRoute:A,clearRoutes:x,getRoutes:r,getRecordMatcher:c}}function FS(a,e){const i={};for(const s of e)s in a&&(i[s]=a[s]);return i}function LS(a){const e={path:a.path,redirect:a.redirect,name:a.name,meta:a.meta||{},aliasOf:a.aliasOf,beforeEnter:a.beforeEnter,props:Ok(a),children:a.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in a?a.components||null:a.component&&{default:a.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Ok(a){const e={},i=a.props||!1;if("component"in a)e.default=i;else for(const s in a.components)e[s]=typeof i=="object"?i[s]:i;return e}function MS(a){for(;a;){if(a.record.aliasOf)return!0;a=a.parent}return!1}function Uk(a){return a.reduce((e,i)=>Ro(e,i.meta),{})}function PS(a,e){const i={};for(const s in a)i[s]=s in e?e[s]:a[s];return i}function zk(a,e){let i=0,s=e.length;for(;i!==s;){const d=i+s>>1;aT(a,e[d])<0?s=d:i=d+1}const c=Nk(a);return c&&(s=e.lastIndexOf(c,s-1)),s}function Nk(a){let e=a;for(;e=e.parent;)if(lT(e)&&aT(a,e)===0)return e}function lT({record:a}){return!!(a.name||a.components&&Object.keys(a.components).length||a.redirect)}function jk(a){const e={};if(a===""||a==="?")return e;const s=(a[0]==="?"?a.slice(1):a).split("&");for(let c=0;c<s.length;++c){const d=s[c].replace(J5," "),A=d.indexOf("="),r=Ly(A<0?d:d.slice(0,A)),y=A<0?null:Ly(d.slice(A+1));if(r in e){let b=e[r];Kd(b)||(b=e[r]=[b]),b.push(y)}else e[r]=y}return e}function kS(a){let e="";for(let i in a){const s=a[i];if(i=ak(i),s==null){s!==void 0&&(e+=(e.length?"&":"")+i);continue}(Kd(s)?s.map(d=>d&&Pb(d)):[s&&Pb(s)]).forEach(d=>{d!==void 0&&(e+=(e.length?"&":"")+i,d!=null&&(e+="="+d))})}return e}function Hk(a){const e={};for(const i in a){const s=a[i];s!==void 0&&(e[i]=Kd(s)?s.map(c=>c==null?null:""+c):s==null?s:""+s)}return e}const Qk=Symbol(""),RS=Symbol(""),s_=Symbol(""),z1=Symbol(""),Rb=Symbol("");function ty(){let a=[];function e(s){return a.push(s),()=>{const c=a.indexOf(s);c>-1&&a.splice(c,1)}}function i(){a=[]}return{add:e,list:()=>a.slice(),reset:i}}function hp(a,e,i,s,c,d=A=>A()){const A=s&&(s.enterCallbacks[c]=s.enterCallbacks[c]||[]);return()=>new Promise((r,y)=>{const b=T=>{T===!1?y(nm(4,{from:i,to:e})):T instanceof Error?y(T):Ek(T)?y(nm(2,{from:e,to:T})):(A&&s.enterCallbacks[c]===A&&typeof T=="function"&&A.push(T),r())},x=d(()=>a.call(s&&s.instances[c],e,i,b));let B=Promise.resolve(x);a.length<3&&(B=B.then(b)),B.catch(T=>y(T))})}function Gx(a,e,i,s,c=d=>d()){const d=[];for(const A of a)for(const r in A.components){let y=A.components[r];if(!(e!=="beforeRouteEnter"&&!A.instances[r]))if($5(y)){const x=(y.__vccOpts||y)[e];x&&d.push(hp(x,i,s,A,r,c))}else{let b=y();d.push(()=>b.then(x=>{if(!x)throw new Error(`Couldn't resolve component "${r}" at "${A.path}"`);const B=q4(x)?x.default:x;A.mods[r]=x,A.components[r]=B;const E=(B.__vccOpts||B)[e];return E&&hp(E,i,s,A,r,c)()}))}}return d}function DS(a){const e=Xd(s_),i=Xd(z1),s=Dh(()=>{const y=Aa(a.to);return e.resolve(y)}),c=Dh(()=>{const{matched:y}=s.value,{length:b}=y,x=y[b-1],B=i.matched;if(!x||!B.length)return-1;const T=B.findIndex(rm.bind(null,x));if(T>-1)return T;const E=OS(y[b-2]);return b>1&&OS(x)===E&&B[B.length-1].path!==E?B.findIndex(rm.bind(null,y[b-2])):T}),d=Dh(()=>c.value>-1&&Yk(i.params,s.value.params)),A=Dh(()=>c.value>-1&&c.value===i.matched.length-1&&rT(i.params,s.value.params));function r(y={}){if(Xk(y)){const b=e[Aa(a.replace)?"replace":"push"](Aa(a.to)).catch(gy);return a.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>b),b}return Promise.resolve()}return{route:s,href:Dh(()=>s.value.href),isActive:d,isExactActive:A,navigate:r}}function Vk(a){return a.length===1?a[0]:a}const Gk=P1({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:DS,setup(a,{slots:e}){const i=Qy(DS(a)),{options:s}=Xd(s_),c=Dh(()=>({[US(a.activeClass,s.linkActiveClass,"router-link-active")]:i.isActive,[US(a.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const d=e.default&&Vk(e.default(i));return a.custom?d:O1("a",{"aria-current":i.isExactActive?a.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:c.value},d)}}}),Wk=Gk;function Xk(a){if(!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)&&!a.defaultPrevented&&!(a.button!==void 0&&a.button!==0)){if(a.currentTarget&&a.currentTarget.getAttribute){const e=a.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return a.preventDefault&&a.preventDefault(),!0}}function Yk(a,e){for(const i in e){const s=e[i],c=a[i];if(typeof s=="string"){if(s!==c)return!1}else if(!Kd(c)||c.length!==s.length||s.some((d,A)=>d!==c[A]))return!1}return!0}function OS(a){return a?a.aliasOf?a.aliasOf.path:a.path:""}const US=(a,e,i)=>a??e??i,Kk=P1({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(a,{attrs:e,slots:i}){const s=Xd(Rb),c=Dh(()=>a.route||s.value),d=Xd(RS,0),A=Dh(()=>{let b=Aa(d);const{matched:x}=c.value;let B;for(;(B=x[b])&&!B.components;)b++;return b}),r=Dh(()=>c.value.matched[A.value]);av(RS,Dh(()=>A.value+1)),av(Qk,r),av(Rb,c);const y=fr();return xf(()=>[y.value,r.value,a.name],([b,x,B],[T,E,R])=>{x&&(x.instances[B]=b,E&&E!==x&&b&&b===T&&(x.leaveGuards.size||(x.leaveGuards=E.leaveGuards),x.updateGuards.size||(x.updateGuards=E.updateGuards))),b&&x&&(!E||!rm(x,E)||!T)&&(x.enterCallbacks[B]||[]).forEach(P=>P(b))},{flush:"post"}),()=>{const b=c.value,x=a.name,B=r.value,T=B&&B.components[x];if(!T)return zS(i.default,{Component:T,route:b});const E=B.props[x],R=E?E===!0?b.params:typeof E=="function"?E(b):E:null,G=O1(T,Ro({},R,e,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(B.instances[x]=null)},ref:y}));return zS(i.default,{Component:G,route:b})||G}}});function zS(a,e){if(!a)return null;const i=a(e);return i.length===1?i[0]:i}const qk=Kk;function $k(a){const e=Dk(a.routes,a),i=a.parseQuery||jk,s=a.stringifyQuery||kS,c=a.history,d=ty(),A=ty(),r=ty(),y=V3(op);let b=op;Gg&&a.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const x=Qx.bind(null,rt=>""+rt),B=Qx.bind(null,ck),T=Qx.bind(null,Ly);function E(rt,Bt){let tt,Ut;return sT(rt)?(tt=e.getRecordMatcher(rt),Ut=Bt):Ut=rt,e.addRoute(Ut,tt)}function R(rt){const Bt=e.getRecordMatcher(rt);Bt&&e.removeRoute(Bt)}function P(){return e.getRoutes().map(rt=>rt.record)}function G(rt){return!!e.getRecordMatcher(rt)}function U(rt,Bt){if(Bt=Ro({},Bt||y.value),typeof rt=="string"){const Pt=Vx(i,rt,Bt.path),It=e.resolve({path:Pt.path},Bt),Ze=c.createHref(Pt.fullPath);return Ro(Pt,It,{params:T(It.params),hash:Ly(Pt.hash),redirectedFrom:void 0,href:Ze})}let tt;if(rt.path!=null)tt=Ro({},rt,{path:Vx(i,rt.path,Bt.path).path});else{const Pt=Ro({},rt.params);for(const It in Pt)Pt[It]==null&&delete Pt[It];tt=Ro({},rt,{params:B(Pt)}),Bt.params=B(Bt.params)}const Ut=e.resolve(tt,Bt),Ai=rt.hash||"";Ut.params=x(T(Ut.params));const qe=dk(s,Ro({},rt,{hash:ok(Ai),path:Ut.path})),Ke=c.createHref(qe);return Ro({fullPath:qe,hash:Ai,query:s===kS?Hk(rt.query):rt.query||{}},Ut,{redirectedFrom:void 0,href:Ke})}function Q(rt){return typeof rt=="string"?Vx(i,rt,y.value.path):Ro({},rt)}function q(rt,Bt){if(b!==rt)return nm(8,{from:Bt,to:rt})}function ne(rt){return fe(rt)}function re(rt){return ne(Ro(Q(rt),{replace:!0}))}function pe(rt){const Bt=rt.matched[rt.matched.length-1];if(Bt&&Bt.redirect){const{redirect:tt}=Bt;let Ut=typeof tt=="function"?tt(rt):tt;return typeof Ut=="string"&&(Ut=Ut.includes("?")||Ut.includes("#")?Ut=Q(Ut):{path:Ut},Ut.params={}),Ro({query:rt.query,hash:rt.hash,params:Ut.path!=null?{}:rt.params},Ut)}}function fe(rt,Bt){const tt=b=U(rt),Ut=y.value,Ai=rt.state,qe=rt.force,Ke=rt.replace===!0,Pt=pe(tt);if(Pt)return fe(Ro(Q(Pt),{state:typeof Pt=="object"?Ro({},Ai,Pt.state):Ai,force:qe,replace:Ke}),Bt||tt);const It=tt;It.redirectedFrom=Bt;let Ze;return!qe&&Ak(s,Ut,tt)&&(Ze=nm(16,{to:It,from:Ut}),Qt(Ut,Ut,!0,!1)),(Ze?Promise.resolve(Ze):Se(It,Ut)).catch(yi=>gf(yi)?gf(yi,2)?yi:pt(yi):Ye(yi,It,Ut)).then(yi=>{if(yi){if(gf(yi,2))return fe(Ro({replace:Ke},Q(yi.to),{state:typeof yi.to=="object"?Ro({},Ai,yi.to.state):Ai,force:qe}),Bt||It)}else yi=ye(It,Ut,!0,Ke,Ai);return oe(It,Ut,yi),yi})}function he(rt,Bt){const tt=q(rt,Bt);return tt?Promise.reject(tt):Promise.resolve()}function be(rt){const Bt=ut.values().next().value;return Bt&&typeof Bt.runWithContext=="function"?Bt.runWithContext(rt):rt()}function Se(rt,Bt){let tt;const[Ut,Ai,qe]=Zk(rt,Bt);tt=Gx(Ut.reverse(),"beforeRouteLeave",rt,Bt);for(const Pt of Ut)Pt.leaveGuards.forEach(It=>{tt.push(hp(It,rt,Bt))});const Ke=he.bind(null,rt,Bt);return tt.push(Ke),Ct(tt).then(()=>{tt=[];for(const Pt of d.list())tt.push(hp(Pt,rt,Bt));return tt.push(Ke),Ct(tt)}).then(()=>{tt=Gx(Ai,"beforeRouteUpdate",rt,Bt);for(const Pt of Ai)Pt.updateGuards.forEach(It=>{tt.push(hp(It,rt,Bt))});return tt.push(Ke),Ct(tt)}).then(()=>{tt=[];for(const Pt of qe)if(Pt.beforeEnter)if(Kd(Pt.beforeEnter))for(const It of Pt.beforeEnter)tt.push(hp(It,rt,Bt));else tt.push(hp(Pt.beforeEnter,rt,Bt));return tt.push(Ke),Ct(tt)}).then(()=>(rt.matched.forEach(Pt=>Pt.enterCallbacks={}),tt=Gx(qe,"beforeRouteEnter",rt,Bt,be),tt.push(Ke),Ct(tt))).then(()=>{tt=[];for(const Pt of A.list())tt.push(hp(Pt,rt,Bt));return tt.push(Ke),Ct(tt)}).catch(Pt=>gf(Pt,8)?Pt:Promise.reject(Pt))}function oe(rt,Bt,tt){r.list().forEach(Ut=>be(()=>Ut(rt,Bt,tt)))}function ye(rt,Bt,tt,Ut,Ai){const qe=q(rt,Bt);if(qe)return qe;const Ke=Bt===op,Pt=Gg?history.state:{};tt&&(Ut||Ke?c.replace(rt.fullPath,Ro({scroll:Ke&&Pt&&Pt.scroll},Ai)):c.push(rt.fullPath,Ai)),y.value=rt,Qt(rt,Bt,tt,Ke),pt()}let Me;function Be(){Me||(Me=c.listen((rt,Bt,tt)=>{if(!mt.listening)return;const Ut=U(rt),Ai=pe(Ut);if(Ai){fe(Ro(Ai,{replace:!0,force:!0}),Ut).catch(gy);return}b=Ut;const qe=y.value;Gg&&xk(CS(qe.fullPath,tt.delta),n_()),Se(Ut,qe).catch(Ke=>gf(Ke,12)?Ke:gf(Ke,2)?(fe(Ro(Q(Ke.to),{force:!0}),Ut).then(Pt=>{gf(Pt,20)&&!tt.delta&&tt.type===My.pop&&c.go(-1,!1)}).catch(gy),Promise.reject()):(tt.delta&&c.go(-tt.delta,!1),Ye(Ke,Ut,qe))).then(Ke=>{Ke=Ke||ye(Ut,qe,!1),Ke&&(tt.delta&&!gf(Ke,8)?c.go(-tt.delta,!1):tt.type===My.pop&&gf(Ke,20)&&c.go(-1,!1)),oe(Ut,qe,Ke)}).catch(gy)}))}let Pe=ty(),De=ty(),et;function Ye(rt,Bt,tt){pt(rt);const Ut=De.list();return Ut.length?Ut.forEach(Ai=>Ai(rt,Bt,tt)):console.error(rt),Promise.reject(rt)}function bt(){return et&&y.value!==op?Promise.resolve():new Promise((rt,Bt)=>{Pe.add([rt,Bt])})}function pt(rt){return et||(et=!rt,Be(),Pe.list().forEach(([Bt,tt])=>rt?tt(rt):Bt()),Pe.reset()),rt}function Qt(rt,Bt,tt,Ut){const{scrollBehavior:Ai}=a;if(!Gg||!Ai)return Promise.resolve();const qe=!tt&&bk(CS(rt.fullPath,0))||(Ut||!tt)&&history.state&&history.state.scroll||null;return $v().then(()=>Ai(rt,Bt,qe)).then(Ke=>Ke&&_k(Ke)).catch(Ke=>Ye(Ke,rt,Bt))}const Ie=rt=>c.go(rt);let ot;const ut=new Set,mt={currentRoute:y,listening:!0,addRoute:E,removeRoute:R,clearRoutes:e.clearRoutes,hasRoute:G,getRoutes:P,resolve:U,options:a,push:ne,replace:re,go:Ie,back:()=>Ie(-1),forward:()=>Ie(1),beforeEach:d.add,beforeResolve:A.add,afterEach:r.add,onError:De.add,isReady:bt,install(rt){const Bt=this;rt.component("RouterLink",Wk),rt.component("RouterView",qk),rt.config.globalProperties.$router=Bt,Object.defineProperty(rt.config.globalProperties,"$route",{enumerable:!0,get:()=>Aa(y)}),Gg&&!ot&&y.value===op&&(ot=!0,ne(c.location).catch(Ai=>{}));const tt={};for(const Ai in op)Object.defineProperty(tt,Ai,{get:()=>y.value[Ai],enumerable:!0});rt.provide(s_,Bt),rt.provide(z1,f5(tt)),rt.provide(Rb,y);const Ut=rt.unmount;ut.add(rt),rt.unmount=function(){ut.delete(rt),ut.size<1&&(b=op,Me&&Me(),Me=null,y.value=op,ot=!1,et=!1),Ut()}}};function Ct(rt){return rt.reduce((Bt,tt)=>Bt.then(()=>be(tt)),Promise.resolve())}return mt}function Zk(a,e){const i=[],s=[],c=[],d=Math.max(e.matched.length,a.matched.length);for(let A=0;A<d;A++){const r=e.matched[A];r&&(a.matched.find(b=>rm(b,r))?s.push(r):i.push(r));const y=a.matched[A];y&&(e.matched.find(b=>rm(b,y))||c.push(y))}return[i,s,c]}function Jk(){return Xd(s_)}function eR(a){return Xd(z1)}var J0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N1(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function tR(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var e=a.default;if(typeof e=="function"){var i=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(a).forEach(function(s){var c=Object.getOwnPropertyDescriptor(a,s);Object.defineProperty(i,s,c.get?c:{enumerable:!0,get:function(){return a[s]}})}),i}var uv={exports:{}},iR=uv.exports,NS;function rR(){return NS||(NS=1,function(a,e){(function(i,s){a.exports=s()})(iR,function(){var i=1e3,s=6e4,c=36e5,d="millisecond",A="second",r="minute",y="hour",b="day",x="week",B="month",T="quarter",E="year",R="date",P="Invalid Date",G=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Be){var Pe=["th","st","nd","rd"],De=Be%100;return"["+Be+(Pe[(De-20)%10]||Pe[De]||Pe[0])+"]"}},q=function(Be,Pe,De){var et=String(Be);return!et||et.length>=Pe?Be:""+Array(Pe+1-et.length).join(De)+Be},ne={s:q,z:function(Be){var Pe=-Be.utcOffset(),De=Math.abs(Pe),et=Math.floor(De/60),Ye=De%60;return(Pe<=0?"+":"-")+q(et,2,"0")+":"+q(Ye,2,"0")},m:function Be(Pe,De){if(Pe.date()<De.date())return-Be(De,Pe);var et=12*(De.year()-Pe.year())+(De.month()-Pe.month()),Ye=Pe.clone().add(et,B),bt=De-Ye<0,pt=Pe.clone().add(et+(bt?-1:1),B);return+(-(et+(De-Ye)/(bt?Ye-pt:pt-Ye))||0)},a:function(Be){return Be<0?Math.ceil(Be)||0:Math.floor(Be)},p:function(Be){return{M:B,y:E,w:x,d:b,D:R,h:y,m:r,s:A,ms:d,Q:T}[Be]||String(Be||"").toLowerCase().replace(/s$/,"")},u:function(Be){return Be===void 0}},re="en",pe={};pe[re]=Q;var fe="$isDayjsObject",he=function(Be){return Be instanceof ye||!(!Be||!Be[fe])},be=function Be(Pe,De,et){var Ye;if(!Pe)return re;if(typeof Pe=="string"){var bt=Pe.toLowerCase();pe[bt]&&(Ye=bt),De&&(pe[bt]=De,Ye=bt);var pt=Pe.split("-");if(!Ye&&pt.length>1)return Be(pt[0])}else{var Qt=Pe.name;pe[Qt]=Pe,Ye=Qt}return!et&&Ye&&(re=Ye),Ye||!et&&re},Se=function(Be,Pe){if(he(Be))return Be.clone();var De=typeof Pe=="object"?Pe:{};return De.date=Be,De.args=arguments,new ye(De)},oe=ne;oe.l=be,oe.i=he,oe.w=function(Be,Pe){return Se(Be,{locale:Pe.$L,utc:Pe.$u,x:Pe.$x,$offset:Pe.$offset})};var ye=function(){function Be(De){this.$L=be(De.locale,null,!0),this.parse(De),this.$x=this.$x||De.x||{},this[fe]=!0}var Pe=Be.prototype;return Pe.parse=function(De){this.$d=function(et){var Ye=et.date,bt=et.utc;if(Ye===null)return new Date(NaN);if(oe.u(Ye))return new Date;if(Ye instanceof Date)return new Date(Ye);if(typeof Ye=="string"&&!/Z$/i.test(Ye)){var pt=Ye.match(G);if(pt){var Qt=pt[2]-1||0,Ie=(pt[7]||"0").substring(0,3);return bt?new Date(Date.UTC(pt[1],Qt,pt[3]||1,pt[4]||0,pt[5]||0,pt[6]||0,Ie)):new Date(pt[1],Qt,pt[3]||1,pt[4]||0,pt[5]||0,pt[6]||0,Ie)}}return new Date(Ye)}(De),this.init()},Pe.init=function(){var De=this.$d;this.$y=De.getFullYear(),this.$M=De.getMonth(),this.$D=De.getDate(),this.$W=De.getDay(),this.$H=De.getHours(),this.$m=De.getMinutes(),this.$s=De.getSeconds(),this.$ms=De.getMilliseconds()},Pe.$utils=function(){return oe},Pe.isValid=function(){return this.$d.toString()!==P},Pe.isSame=function(De,et){var Ye=Se(De);return this.startOf(et)<=Ye&&Ye<=this.endOf(et)},Pe.isAfter=function(De,et){return Se(De)<this.startOf(et)},Pe.isBefore=function(De,et){return this.endOf(et)<Se(De)},Pe.$g=function(De,et,Ye){return oe.u(De)?this[et]:this.set(Ye,De)},Pe.unix=function(){return Math.floor(this.valueOf()/1e3)},Pe.valueOf=function(){return this.$d.getTime()},Pe.startOf=function(De,et){var Ye=this,bt=!!oe.u(et)||et,pt=oe.p(De),Qt=function(tt,Ut){var Ai=oe.w(Ye.$u?Date.UTC(Ye.$y,Ut,tt):new Date(Ye.$y,Ut,tt),Ye);return bt?Ai:Ai.endOf(b)},Ie=function(tt,Ut){return oe.w(Ye.toDate()[tt].apply(Ye.toDate("s"),(bt?[0,0,0,0]:[23,59,59,999]).slice(Ut)),Ye)},ot=this.$W,ut=this.$M,mt=this.$D,Ct="set"+(this.$u?"UTC":"");switch(pt){case E:return bt?Qt(1,0):Qt(31,11);case B:return bt?Qt(1,ut):Qt(0,ut+1);case x:var rt=this.$locale().weekStart||0,Bt=(ot<rt?ot+7:ot)-rt;return Qt(bt?mt-Bt:mt+(6-Bt),ut);case b:case R:return Ie(Ct+"Hours",0);case y:return Ie(Ct+"Minutes",1);case r:return Ie(Ct+"Seconds",2);case A:return Ie(Ct+"Milliseconds",3);default:return this.clone()}},Pe.endOf=function(De){return this.startOf(De,!1)},Pe.$set=function(De,et){var Ye,bt=oe.p(De),pt="set"+(this.$u?"UTC":""),Qt=(Ye={},Ye[b]=pt+"Date",Ye[R]=pt+"Date",Ye[B]=pt+"Month",Ye[E]=pt+"FullYear",Ye[y]=pt+"Hours",Ye[r]=pt+"Minutes",Ye[A]=pt+"Seconds",Ye[d]=pt+"Milliseconds",Ye)[bt],Ie=bt===b?this.$D+(et-this.$W):et;if(bt===B||bt===E){var ot=this.clone().set(R,1);ot.$d[Qt](Ie),ot.init(),this.$d=ot.set(R,Math.min(this.$D,ot.daysInMonth())).$d}else Qt&&this.$d[Qt](Ie);return this.init(),this},Pe.set=function(De,et){return this.clone().$set(De,et)},Pe.get=function(De){return this[oe.p(De)]()},Pe.add=function(De,et){var Ye,bt=this;De=Number(De);var pt=oe.p(et),Qt=function(ut){var mt=Se(bt);return oe.w(mt.date(mt.date()+Math.round(ut*De)),bt)};if(pt===B)return this.set(B,this.$M+De);if(pt===E)return this.set(E,this.$y+De);if(pt===b)return Qt(1);if(pt===x)return Qt(7);var Ie=(Ye={},Ye[r]=s,Ye[y]=c,Ye[A]=i,Ye)[pt]||1,ot=this.$d.getTime()+De*Ie;return oe.w(ot,this)},Pe.subtract=function(De,et){return this.add(-1*De,et)},Pe.format=function(De){var et=this,Ye=this.$locale();if(!this.isValid())return Ye.invalidDate||P;var bt=De||"YYYY-MM-DDTHH:mm:ssZ",pt=oe.z(this),Qt=this.$H,Ie=this.$m,ot=this.$M,ut=Ye.weekdays,mt=Ye.months,Ct=Ye.meridiem,rt=function(Ut,Ai,qe,Ke){return Ut&&(Ut[Ai]||Ut(et,bt))||qe[Ai].slice(0,Ke)},Bt=function(Ut){return oe.s(Qt%12||12,Ut,"0")},tt=Ct||function(Ut,Ai,qe){var Ke=Ut<12?"AM":"PM";return qe?Ke.toLowerCase():Ke};return bt.replace(U,function(Ut,Ai){return Ai||function(qe){switch(qe){case"YY":return String(et.$y).slice(-2);case"YYYY":return oe.s(et.$y,4,"0");case"M":return ot+1;case"MM":return oe.s(ot+1,2,"0");case"MMM":return rt(Ye.monthsShort,ot,mt,3);case"MMMM":return rt(mt,ot);case"D":return et.$D;case"DD":return oe.s(et.$D,2,"0");case"d":return String(et.$W);case"dd":return rt(Ye.weekdaysMin,et.$W,ut,2);case"ddd":return rt(Ye.weekdaysShort,et.$W,ut,3);case"dddd":return ut[et.$W];case"H":return String(Qt);case"HH":return oe.s(Qt,2,"0");case"h":return Bt(1);case"hh":return Bt(2);case"a":return tt(Qt,Ie,!0);case"A":return tt(Qt,Ie,!1);case"m":return String(Ie);case"mm":return oe.s(Ie,2,"0");case"s":return String(et.$s);case"ss":return oe.s(et.$s,2,"0");case"SSS":return oe.s(et.$ms,3,"0");case"Z":return pt}return null}(Ut)||pt.replace(":","")})},Pe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Pe.diff=function(De,et,Ye){var bt,pt=this,Qt=oe.p(et),Ie=Se(De),ot=(Ie.utcOffset()-this.utcOffset())*s,ut=this-Ie,mt=function(){return oe.m(pt,Ie)};switch(Qt){case E:bt=mt()/12;break;case B:bt=mt();break;case T:bt=mt()/3;break;case x:bt=(ut-ot)/6048e5;break;case b:bt=(ut-ot)/864e5;break;case y:bt=ut/c;break;case r:bt=ut/s;break;case A:bt=ut/i;break;default:bt=ut}return Ye?bt:oe.a(bt)},Pe.daysInMonth=function(){return this.endOf(B).$D},Pe.$locale=function(){return pe[this.$L]},Pe.locale=function(De,et){if(!De)return this.$L;var Ye=this.clone(),bt=be(De,et,!0);return bt&&(Ye.$L=bt),Ye},Pe.clone=function(){return oe.w(this.$d,this)},Pe.toDate=function(){return new Date(this.valueOf())},Pe.toJSON=function(){return this.isValid()?this.toISOString():null},Pe.toISOString=function(){return this.$d.toISOString()},Pe.toString=function(){return this.$d.toUTCString()},Be}(),Me=ye.prototype;return Se.prototype=Me,[["$ms",d],["$s",A],["$m",r],["$H",y],["$W",b],["$M",B],["$y",E],["$D",R]].forEach(function(Be){Me[Be[1]]=function(Pe){return this.$g(Pe,Be[0],Be[1])}}),Se.extend=function(Be,Pe){return Be.$i||(Be(Pe,ye,Se),Be.$i=!0),Se},Se.locale=be,Se.isDayjs=he,Se.unix=function(Be){return Se(1e3*Be)},Se.en=pe[re],Se.Ls=pe,Se.p={},Se})}(uv)),uv.exports}var nR=rR();const Mo=N1(nR);/*!
 * ApexCharts v4.7.0
 * (c) 2018-2025 ApexCharts
 * Released under the MIT License.
 */function Db(a,e){(e==null||e>a.length)&&(e=a.length);for(var i=0,s=Array(e);i<e;i++)s[i]=a[i];return s}function cT(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function en(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function jS(a,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,dT(s.key),s)}}function tn(a,e,i){return e&&jS(a.prototype,e),i&&jS(a,i),Object.defineProperty(a,"prototype",{writable:!1}),a}function ly(a,e){var i=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!i){if(Array.isArray(a)||(i=j1(a))||e){i&&(a=i);var s=0,c=function(){};return{s:c,n:function(){return s>=a.length?{done:!0}:{done:!1,value:a[s++]}},e:function(y){throw y},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d,A=!0,r=!1;return{s:function(){i=i.call(a)},n:function(){var y=i.next();return A=y.done,y},e:function(y){r=!0,d=y},f:function(){try{A||i.return==null||i.return()}finally{if(r)throw d}}}}function Xy(a){var e=uT();return function(){var i,s=Dv(a);if(e){var c=Dv(this).constructor;i=Reflect.construct(s,arguments,c)}else i=s.apply(this,arguments);return function(d,A){if(A&&(typeof A=="object"||typeof A=="function"))return A;if(A!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cT(d)}(this,i)}}function Rv(a,e,i){return(e=dT(e))in a?Object.defineProperty(a,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[e]=i,a}function Dv(a){return Dv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dv(a)}function Yy(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&Ob(a,e)}function uT(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uT=function(){return!!a})()}function HS(a,e){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(a,c).enumerable})),i.push.apply(i,s)}return i}function Tr(a){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?HS(Object(i),!0).forEach(function(s){Rv(a,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):HS(Object(i)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(i,s))})}return a}function Ob(a,e){return Ob=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Ob(a,e)}function hT(a,e){return function(i){if(Array.isArray(i))return i}(a)||function(i,s){var c=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(c!=null){var d,A,r,y,b=[],x=!0,B=!1;try{if(r=(c=c.call(i)).next,s===0){if(Object(c)!==c)return;x=!1}else for(;!(x=(d=r.call(c)).done)&&(b.push(d.value),b.length!==s);x=!0);}catch(T){B=!0,A=T}finally{try{if(!x&&c.return!=null&&(y=c.return(),Object(y)!==y))return}finally{if(B)throw A}}return b}}(a,e)||j1(a,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Kl(a){return function(e){if(Array.isArray(e))return Db(e)}(a)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(a)||j1(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function dT(a){var e=function(i,s){if(typeof i!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var d=c.call(i,s);if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}(a,"string");return typeof e=="symbol"?e:e+""}function sm(a){return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sm(a)}function j1(a,e){if(a){if(typeof a=="string")return Db(a,e);var i={}.toString.call(a).slice(8,-1);return i==="Object"&&a.constructor&&(i=a.constructor.name),i==="Map"||i==="Set"?Array.from(a):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Db(a,e):void 0}}var ni=function(){function a(){en(this,a)}return tn(a,[{key:"shadeRGBColor",value:function(e,i){var s=i.split(","),c=e<0?0:255,d=e<0?-1*e:e,A=parseInt(s[0].slice(4),10),r=parseInt(s[1],10),y=parseInt(s[2],10);return"rgb("+(Math.round((c-A)*d)+A)+","+(Math.round((c-r)*d)+r)+","+(Math.round((c-y)*d)+y)+")"}},{key:"shadeHexColor",value:function(e,i){var s=parseInt(i.slice(1),16),c=e<0?0:255,d=e<0?-1*e:e,A=s>>16,r=s>>8&255,y=255&s;return"#"+(16777216+65536*(Math.round((c-A)*d)+A)+256*(Math.round((c-r)*d)+r)+(Math.round((c-y)*d)+y)).toString(16).slice(1)}},{key:"shadeColor",value:function(e,i){return a.isColorHex(i)?this.shadeHexColor(e,i):this.shadeRGBColor(e,i)}}],[{key:"bind",value:function(e,i){return function(){return e.apply(i,arguments)}}},{key:"isObject",value:function(e){return e&&sm(e)==="object"&&!Array.isArray(e)&&e!=null}},{key:"is",value:function(e,i){return Object.prototype.toString.call(i)==="[object "+e+"]"}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"listToArray",value:function(e){var i,s=[];for(i=0;i<e.length;i++)s[i]=e[i];return s}},{key:"extend",value:function(e,i){var s=this;typeof Object.assign!="function"&&(Object.assign=function(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var A=Object(d),r=1;r<arguments.length;r++){var y=arguments[r];if(y!=null)for(var b in y)y.hasOwnProperty(b)&&(A[b]=y[b])}return A});var c=Object.assign({},e);return this.isObject(e)&&this.isObject(i)&&Object.keys(i).forEach(function(d){s.isObject(i[d])&&d in e?c[d]=s.extend(e[d],i[d]):Object.assign(c,Rv({},d,i[d]))}),c}},{key:"extendArray",value:function(e,i){var s=[];return e.map(function(c){s.push(a.extend(i,c))}),e=s}},{key:"monthMod",value:function(e){return e%12}},{key:"clone",value:function(e){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new WeakMap;if(e===null||sm(e)!=="object")return e;if(s.has(e))return s.get(e);if(Array.isArray(e)){i=[],s.set(e,i);for(var c=0;c<e.length;c++)i[c]=this.clone(e[c],s)}else if(e instanceof Date)i=new Date(e.getTime());else for(var d in i={},s.set(e,i),e)e.hasOwnProperty(d)&&(i[d]=this.clone(e[d],s));return i}},{key:"log10",value:function(e){return Math.log(e)/Math.LN10}},{key:"roundToBase10",value:function(e){return Math.pow(10,Math.floor(Math.log10(e)))}},{key:"roundToBase",value:function(e,i){return Math.pow(i,Math.floor(Math.log(e)/Math.log(i)))}},{key:"parseNumber",value:function(e){return e===null?e:parseFloat(e)}},{key:"stripNumber",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return Number.isInteger(e)?e:parseFloat(e.toPrecision(i))}},{key:"randomId",value:function(){return(Math.random()+1).toString(36).substring(4)}},{key:"noExponents",value:function(e){return e.toString().includes("e")?Math.round(e):e}},{key:"elementExists",value:function(e){return!(!e||!e.isConnected)}},{key:"getDimensions",value:function(e){var i=getComputedStyle(e,null),s=e.clientHeight,c=e.clientWidth;return s-=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom),[c-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),s]}},{key:"getBoundingClientRect",value:function(e){var i=e.getBoundingClientRect();return{top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:e.clientWidth,height:e.clientHeight,x:i.left,y:i.top}}},{key:"getLargestStringFromArr",value:function(e){return e.reduce(function(i,s){return Array.isArray(s)&&(s=s.reduce(function(c,d){return c.length>d.length?c:d})),i.length>s.length?i:s},0)}},{key:"hexToRgba",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"#999999",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.6;e.substring(0,1)!=="#"&&(e="#999999");var s=e.replace("#","");s=s.match(new RegExp("(.{"+s.length/3+"})","g"));for(var c=0;c<s.length;c++)s[c]=parseInt(s[c].length===1?s[c]+s[c]:s[c],16);return i!==void 0&&s.push(i),"rgba("+s.join(",")+")"}},{key:"getOpacityFromRGBA",value:function(e){return parseFloat(e.replace(/^.*,(.+)\)/,"$1"))}},{key:"rgb2hex",value:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&e.length===4?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}},{key:"isColorHex",value:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i.test(e)}},{key:"getPolygonPos",value:function(e,i){for(var s=[],c=2*Math.PI/i,d=0;d<i;d++){var A={};A.x=e*Math.sin(d*c),A.y=-e*Math.cos(d*c),s.push(A)}return s}},{key:"polarToCartesian",value:function(e,i,s,c){var d=(c-90)*Math.PI/180;return{x:e+s*Math.cos(d),y:i+s*Math.sin(d)}}},{key:"escapeString",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"x",s=e.toString().slice();return s=s.replace(/[` ~!@#$%^&*()|+\=?;:'",.<>{}[\]\\/]/gi,i)}},{key:"negToZero",value:function(e){return e<0?0:e}},{key:"moveIndexInArray",value:function(e,i,s){if(s>=e.length)for(var c=s-e.length+1;c--;)e.push(void 0);return e.splice(s,0,e.splice(i,1)[0]),e}},{key:"extractNumber",value:function(e){return parseFloat(e.replace(/[^\d.]*/g,""))}},{key:"findAncestor",value:function(e,i){for(;(e=e.parentElement)&&!e.classList.contains(i););return e}},{key:"setELstyles",value:function(e,i){for(var s in i)i.hasOwnProperty(s)&&(e.style.key=i[s])}},{key:"preciseAddition",value:function(e,i){var s=(String(e).split(".")[1]||"").length,c=(String(i).split(".")[1]||"").length,d=Math.pow(10,Math.max(s,c));return(Math.round(e*d)+Math.round(i*d))/d}},{key:"isNumber",value:function(e){return!isNaN(e)&&parseFloat(Number(e))===e&&!isNaN(parseInt(e,10))}},{key:"isFloat",value:function(e){return Number(e)===e&&e%1!=0}},{key:"isMsEdge",value:function(){var e=window.navigator.userAgent,i=e.indexOf("Edge/");return i>0&&parseInt(e.substring(i+5,e.indexOf(".",i)),10)}},{key:"getGCD",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:7,c=Math.pow(10,s-Math.floor(Math.log10(Math.max(e,i))));for(e=Math.round(Math.abs(e)*c),i=Math.round(Math.abs(i)*c);i;){var d=i;i=e%i,e=d}return e/c}},{key:"getPrimeFactors",value:function(e){for(var i=[],s=2;e>=2;)e%s==0?(i.push(s),e/=s):s++;return i}},{key:"mod",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:7,c=Math.pow(10,s-Math.floor(Math.log10(Math.max(e,i))));return(e=Math.round(Math.abs(e)*c))%(i=Math.round(Math.abs(i)*c))/c}}]),a}(),cm=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"animateLine",value:function(e,i,s,c){e.attr(i).animate(c).attr(s)}},{key:"animateMarker",value:function(e,i,s,c){e.attr({opacity:0}).animate(i).attr({opacity:1}).after(function(){c()})}},{key:"animateRect",value:function(e,i,s,c,d){e.attr(i).animate(c).attr(s).after(function(){return d()})}},{key:"animatePathsGradually",value:function(e){var i=e.el,s=e.realIndex,c=e.j,d=e.fill,A=e.pathFrom,r=e.pathTo,y=e.speed,b=e.delay,x=this.w,B=0;x.config.chart.animations.animateGradually.enabled&&(B=x.config.chart.animations.animateGradually.delay),x.config.chart.animations.dynamicAnimation.enabled&&x.globals.dataChanged&&x.config.chart.type!=="bar"&&(B=0),this.morphSVG(i,s,c,x.config.chart.type!=="line"||x.globals.comboCharts?d:"stroke",A,r,y,b*B)}},{key:"showDelayedElements",value:function(){this.w.globals.delayedElements.forEach(function(e){var i=e.el;i.classList.remove("apexcharts-element-hidden"),i.classList.add("apexcharts-hidden-element-shown")})}},{key:"animationCompleted",value:function(e){var i=this.w;i.globals.animationEnded||(i.globals.animationEnded=!0,this.showDelayedElements(),typeof i.config.chart.events.animationEnd=="function"&&i.config.chart.events.animationEnd(this.ctx,{el:e,w:i}))}},{key:"morphSVG",value:function(e,i,s,c,d,A,r,y){var b=this,x=this.w;d||(d=e.attr("pathFrom")),A||(A=e.attr("pathTo"));var B=function(T){return x.config.chart.type==="radar"&&(r=1),"M 0 ".concat(x.globals.gridHeight)};(!d||d.indexOf("undefined")>-1||d.indexOf("NaN")>-1)&&(d=B()),(!A.trim()||A.indexOf("undefined")>-1||A.indexOf("NaN")>-1)&&(A=B()),x.globals.shouldAnimate||(r=1),e.plot(d).animate(1,y).plot(d).animate(r,y).plot(A).after(function(){ni.isNumber(s)?s===x.globals.series[x.globals.maxValsInArrayIndex].length-2&&x.globals.shouldAnimate&&b.animationCompleted(e):c!=="none"&&x.globals.shouldAnimate&&(!x.globals.comboCharts&&i===x.globals.series.length-1||x.globals.comboCharts)&&b.animationCompleted(e),b.showDelayedElements()})}}]),a}();const Ub={},AT=[];function Os(a,e){if(Array.isArray(a))for(const i of a)Os(i,e);else if(typeof a!="object")fT(Object.getOwnPropertyNames(e)),Ub[a]=Object.assign(Ub[a]||{},e);else for(const i in a)Os(i,a[i])}function ih(a){return Ub[a]||{}}function fT(a){AT.push(...a)}function H1(a,e){let i;const s=a.length,c=[];for(i=0;i<s;i++)c.push(e(a[i]));return c}function Wx(a){return a%360*Math.PI/180}function um(a){return a.charAt(0).toUpperCase()+a.slice(1)}function hm(a,e,i,s){return e!=null&&i!=null||(s=s||a.bbox(),e==null?e=s.width/s.height*i:i==null&&(i=s.height/s.width*e)),{width:e,height:i}}function zb(a,e){const i=a.origin;let s=a.ox!=null?a.ox:a.originX!=null?a.originX:"center",c=a.oy!=null?a.oy:a.originY!=null?a.originY:"center";i!=null&&([s,c]=Array.isArray(i)?i:typeof i=="object"?[i.x,i.y]:[i,i]);const d=typeof s=="string",A=typeof c=="string";if(d||A){const{height:r,width:y,x:b,y:x}=e.bbox();d&&(s=s.includes("left")?b:s.includes("right")?b+y:b+y/2),A&&(c=c.includes("top")?x:c.includes("bottom")?x+r:x+r/2)}return[s,c]}const sR=new Set(["desc","metadata","title"]),Nb=a=>sR.has(a.nodeName),pT=(a,e,i={})=>{const s={...e};for(const c in s)s[c].valueOf()===i[c]&&delete s[c];Object.keys(s).length?a.node.setAttribute("data-svgjs",JSON.stringify(s)):(a.node.removeAttribute("data-svgjs"),a.node.removeAttribute("svgjs:data"))},Q1="http://www.w3.org/2000/svg",Xx="http://www.w3.org/2000/xmlns/",dm="http://www.w3.org/1999/xlink",ho={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};function Ky(){return ho.window}let V1=class{};const cg={},G1="___SYMBOL___ROOT___";function Py(a,e=Q1){return ho.document.createElementNS(e,a)}function Pu(a,e=!1){if(a instanceof V1)return a;if(typeof a=="object")return Yx(a);if(a==null)return new cg[G1];if(typeof a=="string"&&a.charAt(0)!=="<")return Yx(ho.document.querySelector(a));const i=e?ho.document.createElement("div"):Py("svg");return i.innerHTML=a,a=Yx(i.firstChild),i.removeChild(i.firstChild),a}function ea(a,e){return e&&(e instanceof ho.window.Node||e.ownerDocument&&e instanceof e.ownerDocument.defaultView.Node)?e:Py(a)}function rd(a){if(!a)return null;if(a.instance instanceof V1)return a.instance;if(a.nodeName==="#document-fragment")return new cg.Fragment(a);let e=um(a.nodeName||"Dom");return e==="LinearGradient"||e==="RadialGradient"?e="Gradient":cg[e]||(e="Dom"),new cg[e](a)}let Yx=rd;function Ao(a,e=a.name,i=!1){return cg[e]=a,i&&(cg[G1]=a),fT(Object.getOwnPropertyNames(a.prototype)),a}let oR=1e3;function gT(a){return"Svgjs"+um(a)+oR++}function mT(a){for(let e=a.children.length-1;e>=0;e--)mT(a.children[e]);return a.id&&(a.id=gT(a.nodeName)),a}function jn(a,e){let i,s;for(s=(a=Array.isArray(a)?a:[a]).length-1;s>=0;s--)for(i in e)a[s].prototype[i]=e[i]}function Jo(a){return function(...e){const i=e[e.length-1];return!i||i.constructor!==Object||i instanceof Array?a.apply(this,e):a.apply(this,e.slice(0,-1)).attr(i)}}Os("Dom",{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},prev:function(){return this.siblings()[this.position()-1]},forward:function(){const a=this.position();return this.parent().add(this.remove(),a+1),this},backward:function(){const a=this.position();return this.parent().add(this.remove(),a?a-1:0),this},front:function(){return this.parent().add(this.remove()),this},back:function(){return this.parent().add(this.remove(),0),this},before:function(a){(a=Pu(a)).remove();const e=this.position();return this.parent().add(a,e),this},after:function(a){(a=Pu(a)).remove();const e=this.position();return this.parent().add(a,e+1),this},insertBefore:function(a){return(a=Pu(a)).before(this),this},insertAfter:function(a){return(a=Pu(a)).after(this),this}});const yT=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,aR=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,lR=/rgb\((\d+),(\d+),(\d+)\)/,cR=/(#[a-z_][a-z0-9\-_]*)/i,uR=/\)\s*,?\s*/,hR=/\s/g,QS=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,VS=/^rgb\(/,GS=/^(\s+)?$/,WS=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,dR=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,Sf=/[\s,]+/,W1=/[MLHVCSQTAZ]/i;function AR(a){const e=Math.round(a),i=Math.max(0,Math.min(255,e)).toString(16);return i.length===1?"0"+i:i}function Ng(a,e){for(let i=e.length;i--;)if(a[e[i]]==null)return!1;return!0}function Kx(a,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?a+6*(e-a)*i:i<.5?e:i<2/3?a+(e-a)*(2/3-i)*6:a}Os("Dom",{classes:function(){const a=this.attr("class");return a==null?[]:a.trim().split(Sf)},hasClass:function(a){return this.classes().indexOf(a)!==-1},addClass:function(a){if(!this.hasClass(a)){const e=this.classes();e.push(a),this.attr("class",e.join(" "))}return this},removeClass:function(a){return this.hasClass(a)&&this.attr("class",this.classes().filter(function(e){return e!==a}).join(" ")),this},toggleClass:function(a){return this.hasClass(a)?this.removeClass(a):this.addClass(a)}}),Os("Dom",{css:function(a,e){const i={};if(arguments.length===0)return this.node.style.cssText.split(/\s*;\s*/).filter(function(s){return!!s.length}).forEach(function(s){const c=s.split(/\s*:\s*/);i[c[0]]=c[1]}),i;if(arguments.length<2){if(Array.isArray(a)){for(const s of a){const c=s;i[s]=this.node.style.getPropertyValue(c)}return i}if(typeof a=="string")return this.node.style.getPropertyValue(a);if(typeof a=="object")for(const s in a)this.node.style.setProperty(s,a[s]==null||GS.test(a[s])?"":a[s])}return arguments.length===2&&this.node.style.setProperty(a,e==null||GS.test(e)?"":e),this},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},visible:function(){return this.css("display")!=="none"}}),Os("Dom",{data:function(a,e,i){if(a==null)return this.data(H1(function(s,c){let d;const A=s.length,r=[];for(d=0;d<A;d++)c(s[d])&&r.push(s[d]);return r}(this.node.attributes,s=>s.nodeName.indexOf("data-")===0),s=>s.nodeName.slice(5)));if(a instanceof Array){const s={};for(const c of a)s[c]=this.data(c);return s}if(typeof a=="object")for(e in a)this.data(e,a[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch{return this.attr("data-"+a)}else this.attr("data-"+a,e===null?null:i===!0||typeof e=="string"||typeof e=="number"?e:JSON.stringify(e));return this}}),Os("Dom",{remember:function(a,e){if(typeof arguments[0]=="object")for(const i in a)this.remember(i,a[i]);else{if(arguments.length===1)return this.memory()[a];this.memory()[a]=e}return this},forget:function(){if(arguments.length===0)this._memory={};else for(let a=arguments.length-1;a>=0;a--)delete this.memory()[arguments[a]];return this},memory:function(){return this._memory=this._memory||{}}});let GA=class Gl{constructor(...e){this.init(...e)}static isColor(e){return e&&(e instanceof Gl||this.isRgb(e)||this.test(e))}static isRgb(e){return e&&typeof e.r=="number"&&typeof e.g=="number"&&typeof e.b=="number"}static random(e="vibrant",i){const{random:s,round:c,sin:d,PI:A}=Math;if(e==="vibrant"){const r=24*s()+57,y=38*s()+45,b=360*s();return new Gl(r,y,b,"lch")}if(e==="sine"){const r=c(80*d(2*A*(i=i??s())/.5+.01)+150),y=c(50*d(2*A*i/.5+4.6)+200),b=c(100*d(2*A*i/.5+2.3)+150);return new Gl(r,y,b)}if(e==="pastel"){const r=8*s()+86,y=17*s()+9,b=360*s();return new Gl(r,y,b,"lch")}if(e==="dark"){const r=10+10*s(),y=50*s()+86,b=360*s();return new Gl(r,y,b,"lch")}if(e==="rgb"){const r=255*s(),y=255*s(),b=255*s();return new Gl(r,y,b)}if(e==="lab"){const r=100*s(),y=256*s()-128,b=256*s()-128;return new Gl(r,y,b,"lab")}if(e==="grey"){const r=255*s();return new Gl(r,r,r)}throw new Error("Unsupported random color mode")}static test(e){return typeof e=="string"&&(QS.test(e)||VS.test(e))}cmyk(){const{_a:e,_b:i,_c:s}=this.rgb(),[c,d,A]=[e,i,s].map(y=>y/255),r=Math.min(1-c,1-d,1-A);return r===1?new Gl(0,0,0,1,"cmyk"):new Gl((1-c-r)/(1-r),(1-d-r)/(1-r),(1-A-r)/(1-r),r,"cmyk")}hsl(){const{_a:e,_b:i,_c:s}=this.rgb(),[c,d,A]=[e,i,s].map(T=>T/255),r=Math.max(c,d,A),y=Math.min(c,d,A),b=(r+y)/2,x=r===y,B=r-y;return new Gl(360*(x?0:r===c?((d-A)/B+(d<A?6:0))/6:r===d?((A-c)/B+2)/6:r===A?((c-d)/B+4)/6:0),100*(x?0:b>.5?B/(2-r-y):B/(r+y)),100*b,"hsl")}init(e=0,i=0,s=0,c=0,d="rgb"){if(e=e||0,this.space)for(const B in this.space)delete this[this.space[B]];if(typeof e=="number")d=typeof c=="string"?c:d,c=typeof c=="string"?0:c,Object.assign(this,{_a:e,_b:i,_c:s,_d:c,space:d});else if(e instanceof Array)this.space=i||(typeof e[3]=="string"?e[3]:e[4])||"rgb",Object.assign(this,{_a:e[0],_b:e[1],_c:e[2],_d:e[3]||0});else if(e instanceof Object){const B=function(T,E){const R=Ng(T,"rgb")?{_a:T.r,_b:T.g,_c:T.b,_d:0,space:"rgb"}:Ng(T,"xyz")?{_a:T.x,_b:T.y,_c:T.z,_d:0,space:"xyz"}:Ng(T,"hsl")?{_a:T.h,_b:T.s,_c:T.l,_d:0,space:"hsl"}:Ng(T,"lab")?{_a:T.l,_b:T.a,_c:T.b,_d:0,space:"lab"}:Ng(T,"lch")?{_a:T.l,_b:T.c,_c:T.h,_d:0,space:"lch"}:Ng(T,"cmyk")?{_a:T.c,_b:T.m,_c:T.y,_d:T.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return R.space=E||R.space,R}(e,i);Object.assign(this,B)}else if(typeof e=="string")if(VS.test(e)){const B=e.replace(hR,""),[T,E,R]=lR.exec(B).slice(1,4).map(P=>parseInt(P));Object.assign(this,{_a:T,_b:E,_c:R,_d:0,space:"rgb"})}else{if(!QS.test(e))throw Error("Unsupported string format, can't construct Color");{const B=P=>parseInt(P,16),[,T,E,R]=aR.exec(function(P){return P.length===4?["#",P.substring(1,2),P.substring(1,2),P.substring(2,3),P.substring(2,3),P.substring(3,4),P.substring(3,4)].join(""):P}(e)).map(B);Object.assign(this,{_a:T,_b:E,_c:R,_d:0,space:"rgb"})}}const{_a:A,_b:r,_c:y,_d:b}=this,x=this.space==="rgb"?{r:A,g:r,b:y}:this.space==="xyz"?{x:A,y:r,z:y}:this.space==="hsl"?{h:A,s:r,l:y}:this.space==="lab"?{l:A,a:r,b:y}:this.space==="lch"?{l:A,c:r,h:y}:this.space==="cmyk"?{c:A,m:r,y,k:b}:{};Object.assign(this,x)}lab(){const{x:e,y:i,z:s}=this.xyz();return new Gl(116*i-16,500*(e-i),200*(i-s),"lab")}lch(){const{l:e,a:i,b:s}=this.lab(),c=Math.sqrt(i**2+s**2);let d=180*Math.atan2(s,i)/Math.PI;return d<0&&(d*=-1,d=360-d),new Gl(e,c,d,"lch")}rgb(){if(this.space==="rgb")return this;if((e=this.space)==="lab"||e==="xyz"||e==="lch"){let{x:i,y:s,z:c}=this;if(this.space==="lab"||this.space==="lch"){let{l:E,a:R,b:P}=this;if(this.space==="lch"){const{c:pe,h:fe}=this,he=Math.PI/180;R=pe*Math.cos(he*fe),P=pe*Math.sin(he*fe)}const G=(E+16)/116,U=R/500+G,Q=G-P/200,q=16/116,ne=.008856,re=7.787;i=.95047*(U**3>ne?U**3:(U-q)/re),s=1*(G**3>ne?G**3:(G-q)/re),c=1.08883*(Q**3>ne?Q**3:(Q-q)/re)}const d=3.2406*i+-1.5372*s+-.4986*c,A=-.9689*i+1.8758*s+.0415*c,r=.0557*i+-.204*s+1.057*c,y=Math.pow,b=.0031308,x=d>b?1.055*y(d,1/2.4)-.055:12.92*d,B=A>b?1.055*y(A,1/2.4)-.055:12.92*A,T=r>b?1.055*y(r,1/2.4)-.055:12.92*r;return new Gl(255*x,255*B,255*T)}if(this.space==="hsl"){let{h:i,s,l:c}=this;if(i/=360,s/=100,c/=100,s===0)return c*=255,new Gl(c,c,c);const d=c<.5?c*(1+s):c+s-c*s,A=2*c-d,r=255*Kx(A,d,i+1/3),y=255*Kx(A,d,i),b=255*Kx(A,d,i-1/3);return new Gl(r,y,b)}if(this.space==="cmyk"){const{c:i,m:s,y:c,k:d}=this,A=255*(1-Math.min(1,i*(1-d)+d)),r=255*(1-Math.min(1,s*(1-d)+d)),y=255*(1-Math.min(1,c*(1-d)+d));return new Gl(A,r,y)}return this;var e}toArray(){const{_a:e,_b:i,_c:s,_d:c,space:d}=this;return[e,i,s,c,d]}toHex(){const[e,i,s]=this._clamped().map(AR);return`#${e}${i}${s}`}toRgb(){const[e,i,s]=this._clamped();return`rgb(${e},${i},${s})`}toString(){return this.toHex()}xyz(){const{_a:e,_b:i,_c:s}=this.rgb(),[c,d,A]=[e,i,s].map(G=>G/255),r=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,y=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,b=A>.04045?Math.pow((A+.055)/1.055,2.4):A/12.92,x=(.4124*r+.3576*y+.1805*b)/.95047,B=(.2126*r+.7152*y+.0722*b)/1,T=(.0193*r+.1192*y+.9505*b)/1.08883,E=x>.008856?Math.pow(x,1/3):7.787*x+16/116,R=B>.008856?Math.pow(B,1/3):7.787*B+16/116,P=T>.008856?Math.pow(T,1/3):7.787*T+16/116;return new Gl(E,R,P,"xyz")}_clamped(){const{_a:e,_b:i,_c:s}=this.rgb(),{max:c,min:d,round:A}=Math;return[e,i,s].map(r=>c(0,d(A(r),255)))}},Vo=class vT{constructor(...e){this.init(...e)}clone(){return new vT(this)}init(e,i){const d=Array.isArray(e)?{x:e[0],y:e[1]}:typeof e=="object"?{x:e.x,y:e.y}:{x:e,y:i};return this.x=d.x==null?0:d.x,this.y=d.y==null?0:d.y,this}toArray(){return[this.x,this.y]}transform(e){return this.clone().transformO(e)}transformO(e){Ks.isMatrixLike(e)||(e=new Ks(e));const{x:i,y:s}=this;return this.x=e.a*i+e.c*s+e.e,this.y=e.b*i+e.d*s+e.f,this}};function jg(a,e,i){return Math.abs(e-a)<1e-6}let Ks=class Wl{constructor(...e){this.init(...e)}static formatTransforms(e){const i=e.flip==="both"||e.flip===!0,s=e.flip&&(i||e.flip==="x")?-1:1,c=e.flip&&(i||e.flip==="y")?-1:1,d=e.skew&&e.skew.length?e.skew[0]:isFinite(e.skew)?e.skew:isFinite(e.skewX)?e.skewX:0,A=e.skew&&e.skew.length?e.skew[1]:isFinite(e.skew)?e.skew:isFinite(e.skewY)?e.skewY:0,r=e.scale&&e.scale.length?e.scale[0]*s:isFinite(e.scale)?e.scale*s:isFinite(e.scaleX)?e.scaleX*s:s,y=e.scale&&e.scale.length?e.scale[1]*c:isFinite(e.scale)?e.scale*c:isFinite(e.scaleY)?e.scaleY*c:c,b=e.shear||0,x=e.rotate||e.theta||0,B=new Vo(e.origin||e.around||e.ox||e.originX,e.oy||e.originY),T=B.x,E=B.y,R=new Vo(e.position||e.px||e.positionX||NaN,e.py||e.positionY||NaN),P=R.x,G=R.y,U=new Vo(e.translate||e.tx||e.translateX,e.ty||e.translateY),Q=U.x,q=U.y,ne=new Vo(e.relative||e.rx||e.relativeX,e.ry||e.relativeY);return{scaleX:r,scaleY:y,skewX:d,skewY:A,shear:b,theta:x,rx:ne.x,ry:ne.y,tx:Q,ty:q,ox:T,oy:E,px:P,py:G}}static fromArray(e){return{a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]}}static isMatrixLike(e){return e.a!=null||e.b!=null||e.c!=null||e.d!=null||e.e!=null||e.f!=null}static matrixMultiply(e,i,s){const c=e.a*i.a+e.c*i.b,d=e.b*i.a+e.d*i.b,A=e.a*i.c+e.c*i.d,r=e.b*i.c+e.d*i.d,y=e.e+e.a*i.e+e.c*i.f,b=e.f+e.b*i.e+e.d*i.f;return s.a=c,s.b=d,s.c=A,s.d=r,s.e=y,s.f=b,s}around(e,i,s){return this.clone().aroundO(e,i,s)}aroundO(e,i,s){const c=e||0,d=i||0;return this.translateO(-c,-d).lmultiplyO(s).translateO(c,d)}clone(){return new Wl(this)}decompose(e=0,i=0){const s=this.a,c=this.b,d=this.c,A=this.d,r=this.e,y=this.f,b=s*A-c*d,x=b>0?1:-1,B=x*Math.sqrt(s*s+c*c),T=Math.atan2(x*c,x*s),E=180/Math.PI*T,R=Math.cos(T),P=Math.sin(T),G=(s*d+c*A)/b,U=d*B/(G*s-c)||A*B/(G*c+s);return{scaleX:B,scaleY:U,shear:G,rotate:E,translateX:r-e+e*R*B+i*(G*R*B-P*U),translateY:y-i+e*P*B+i*(G*P*B+R*U),originX:e,originY:i,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(e){if(e===this)return!0;const i=new Wl(e);return jg(this.a,i.a)&&jg(this.b,i.b)&&jg(this.c,i.c)&&jg(this.d,i.d)&&jg(this.e,i.e)&&jg(this.f,i.f)}flip(e,i){return this.clone().flipO(e,i)}flipO(e,i){return e==="x"?this.scaleO(-1,1,i,0):e==="y"?this.scaleO(1,-1,0,i):this.scaleO(-1,-1,e,i||e)}init(e){const i=Wl.fromArray([1,0,0,1,0,0]);return e=e instanceof Oc?e.matrixify():typeof e=="string"?Wl.fromArray(e.split(Sf).map(parseFloat)):Array.isArray(e)?Wl.fromArray(e):typeof e=="object"&&Wl.isMatrixLike(e)?e:typeof e=="object"?new Wl().transform(e):arguments.length===6?Wl.fromArray([].slice.call(arguments)):i,this.a=e.a!=null?e.a:i.a,this.b=e.b!=null?e.b:i.b,this.c=e.c!=null?e.c:i.c,this.d=e.d!=null?e.d:i.d,this.e=e.e!=null?e.e:i.e,this.f=e.f!=null?e.f:i.f,this}inverse(){return this.clone().inverseO()}inverseO(){const e=this.a,i=this.b,s=this.c,c=this.d,d=this.e,A=this.f,r=e*c-i*s;if(!r)throw new Error("Cannot invert "+this);const y=c/r,b=-i/r,x=-s/r,B=e/r,T=-(y*d+x*A),E=-(b*d+B*A);return this.a=y,this.b=b,this.c=x,this.d=B,this.e=T,this.f=E,this}lmultiply(e){return this.clone().lmultiplyO(e)}lmultiplyO(e){const i=e instanceof Wl?e:new Wl(e);return Wl.matrixMultiply(i,this,this)}multiply(e){return this.clone().multiplyO(e)}multiplyO(e){const i=e instanceof Wl?e:new Wl(e);return Wl.matrixMultiply(this,i,this)}rotate(e,i,s){return this.clone().rotateO(e,i,s)}rotateO(e,i=0,s=0){e=Wx(e);const c=Math.cos(e),d=Math.sin(e),{a:A,b:r,c:y,d:b,e:x,f:B}=this;return this.a=A*c-r*d,this.b=r*c+A*d,this.c=y*c-b*d,this.d=b*c+y*d,this.e=x*c-B*d+s*d-i*c+i,this.f=B*c+x*d-i*d-s*c+s,this}scale(){return this.clone().scaleO(...arguments)}scaleO(e,i=e,s=0,c=0){arguments.length===3&&(c=s,s=i,i=e);const{a:d,b:A,c:r,d:y,e:b,f:x}=this;return this.a=d*e,this.b=A*i,this.c=r*e,this.d=y*i,this.e=b*e-s*e+s,this.f=x*i-c*i+c,this}shear(e,i,s){return this.clone().shearO(e,i,s)}shearO(e,i=0,s=0){const{a:c,b:d,c:A,d:r,e:y,f:b}=this;return this.a=c+d*e,this.c=A+r*e,this.e=y+b*e-s*e,this}skew(){return this.clone().skewO(...arguments)}skewO(e,i=e,s=0,c=0){arguments.length===3&&(c=s,s=i,i=e),e=Wx(e),i=Wx(i);const d=Math.tan(e),A=Math.tan(i),{a:r,b:y,c:b,d:x,e:B,f:T}=this;return this.a=r+y*d,this.b=y+r*A,this.c=b+x*d,this.d=x+b*A,this.e=B+T*d-c*d,this.f=T+B*A-s*A,this}skewX(e,i,s){return this.skew(e,0,i,s)}skewY(e,i,s){return this.skew(0,e,i,s)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(e){if(Wl.isMatrixLike(e))return new Wl(e).multiplyO(this);const i=Wl.formatTransforms(e),{x:s,y:c}=new Vo(i.ox,i.oy).transform(this),d=new Wl().translateO(i.rx,i.ry).lmultiplyO(this).translateO(-s,-c).scaleO(i.scaleX,i.scaleY).skewO(i.skewX,i.skewY).shearO(i.shear).rotateO(i.theta).translateO(s,c);if(isFinite(i.px)||isFinite(i.py)){const A=new Vo(s,c).transform(d),r=isFinite(i.px)?i.px-A.x:0,y=isFinite(i.py)?i.py-A.y:0;d.translateO(r,y)}return d.translateO(i.tx,i.ty),d}translate(e,i){return this.clone().translateO(e,i)}translateO(e,i){return this.e+=e||0,this.f+=i||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}};function dp(){if(!dp.nodes){const a=Pu().size(2,0);a.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),a.attr("focusable","false"),a.attr("aria-hidden","true");const e=a.path().node;dp.nodes={svg:a,path:e}}if(!dp.nodes.svg.node.parentNode){const a=ho.document.body||ho.document.documentElement;dp.nodes.svg.addTo(a)}return dp.nodes}function _T(a){return!(a.width||a.height||a.x||a.y)}Ao(Ks,"Matrix");let Ac=class hv{constructor(...e){this.init(...e)}addOffset(){return this.x+=ho.window.pageXOffset,this.y+=ho.window.pageYOffset,new hv(this)}init(e){return e=typeof e=="string"?e.split(Sf).map(parseFloat):Array.isArray(e)?e:typeof e=="object"?[e.left!=null?e.left:e.x,e.top!=null?e.top:e.y,e.width,e.height]:arguments.length===4?[].slice.call(arguments):[0,0,0,0],this.x=e[0]||0,this.y=e[1]||0,this.width=this.w=e[2]||0,this.height=this.h=e[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return _T(this)}merge(e){const i=Math.min(this.x,e.x),s=Math.min(this.y,e.y),c=Math.max(this.x+this.width,e.x+e.width)-i,d=Math.max(this.y+this.height,e.y+e.height)-s;return new hv(i,s,c,d)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(e){e instanceof Ks||(e=new Ks(e));let i=1/0,s=-1/0,c=1/0,d=-1/0;return[new Vo(this.x,this.y),new Vo(this.x2,this.y),new Vo(this.x,this.y2),new Vo(this.x2,this.y2)].forEach(function(A){A=A.transform(e),i=Math.min(i,A.x),s=Math.max(s,A.x),c=Math.min(c,A.y),d=Math.max(d,A.y)}),new hv(i,c,s-i,d-c)}};function XS(a,e,i){let s;try{if(s=e(a.node),_T(s)&&(c=a.node)!==ho.document&&!(ho.document.documentElement.contains||function(d){for(;d.parentNode;)d=d.parentNode;return d===ho.document}).call(ho.document.documentElement,c))throw new Error("Element not in the dom")}catch{s=i(a)}var c;return s}Os({viewbox:{viewbox(a,e,i,s){return a==null?new Ac(this.attr("viewBox")):this.attr("viewBox",new Ac(a,e,i,s))},zoom(a,e){let{width:i,height:s}=this.attr(["width","height"]);if((i||s)&&typeof i!="string"&&typeof s!="string"||(i=this.node.clientWidth,s=this.node.clientHeight),!i||!s)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const c=this.viewbox(),d=i/c.width,A=s/c.height,r=Math.min(d,A);if(a==null)return r;let y=r/a;y===1/0&&(y=Number.MAX_SAFE_INTEGER/100),e=e||new Vo(i/2/d+c.x,s/2/A+c.y);const b=new Ac(c).transform(new Ks({scale:y,origin:e}));return this.viewbox(b)}}}),Ao(Ac,"Box");let pg=class extends Array{constructor(e=[],...i){if(super(e,...i),typeof e=="number")return this;this.length=0,this.push(...e)}};jn([pg],{each(a,...e){return typeof a=="function"?this.map((i,s,c)=>a.call(i,i,s,c)):this.map(i=>i[a](...e))},toArray(){return Array.prototype.concat.apply([],this)}});const fR=["toArray","constructor","each"];function vg(a,e){return new pg(H1((e||ho.document).querySelectorAll(a),function(i){return rd(i)}))}pg.extend=function(a){a=a.reduce((e,i)=>(fR.includes(i)||i[0]==="_"||(i in Array.prototype&&(e["$"+i]=Array.prototype[i]),e[i]=function(...s){return this.each(i,...s)}),e),{}),jn([pg],a)};let pR=0;const xT={};function bT(a){let e=a.getEventHolder();return e===ho.window&&(e=xT),e.events||(e.events={}),e.events}function X1(a){return a.getEventTarget()}function bf(a,e,i,s,c){const d=i.bind(s||a),A=Pu(a),r=bT(A),y=X1(A);e=Array.isArray(e)?e:e.split(Sf),i._svgjsListenerId||(i._svgjsListenerId=++pR),e.forEach(function(b){const x=b.split(".")[0],B=b.split(".")[1]||"*";r[x]=r[x]||{},r[x][B]=r[x][B]||{},r[x][B][i._svgjsListenerId]=d,y.addEventListener(x,d,c||!1)})}function nd(a,e,i,s){const c=Pu(a),d=bT(c),A=X1(c);(typeof i!="function"||(i=i._svgjsListenerId))&&(e=Array.isArray(e)?e:(e||"").split(Sf)).forEach(function(r){const y=r&&r.split(".")[0],b=r&&r.split(".")[1];let x,B;if(i)d[y]&&d[y][b||"*"]&&(A.removeEventListener(y,d[y][b||"*"][i],s||!1),delete d[y][b||"*"][i]);else if(y&&b){if(d[y]&&d[y][b]){for(B in d[y][b])nd(A,[y,b].join("."),B);delete d[y][b]}}else if(b)for(r in d)for(x in d[r])b===x&&nd(A,[r,b].join("."));else if(y){if(d[y]){for(x in d[y])nd(A,[y,x].join("."));delete d[y]}}else{for(r in d)nd(A,r);(function(T){let E=T.getEventHolder();E===ho.window&&(E=xT),E.events&&(E.events={})})(c)}})}let qy=class extends V1{addEventListener(){}dispatch(e,i,s){return function(c,d,A,r){const y=X1(c);return d instanceof ho.window.Event||(d=new ho.window.CustomEvent(d,{detail:A,cancelable:!0,...r})),y.dispatchEvent(d),d}(this,e,i,s)}dispatchEvent(e){const i=this.getEventHolder().events;if(!i)return!0;const s=i[e.type];for(const c in s)for(const d in s[c])s[c][d](e);return!e.defaultPrevented}fire(e,i,s){return this.dispatch(e,i,s),this}getEventHolder(){return this}getEventTarget(){return this}off(e,i,s){return nd(this,e,i,s),this}on(e,i,s,c){return bf(this,e,i,s,c),this}removeEventListener(){}};function YS(){}Ao(qy,"EventTarget");const qx=400,gR=">",mR=0,yR={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};let gg=class extends Array{constructor(...e){super(...e),this.init(...e)}clone(){return new this.constructor(this)}init(e){return typeof e=="number"||(this.length=0,this.push(...this.parse(e))),this}parse(e=[]){return e instanceof Array?e:e.trim().split(Sf).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const e=[];return e.push(...this),e}},mo=class Hd{constructor(...e){this.init(...e)}convert(e){return new Hd(this.value,e)}divide(e){return e=new Hd(e),new Hd(this/e,this.unit||e.unit)}init(e,i){return i=Array.isArray(e)?e[1]:i,e=Array.isArray(e)?e[0]:e,this.value=0,this.unit=i||"",typeof e=="number"?this.value=isNaN(e)?0:isFinite(e)?e:e<0?-34e37:34e37:typeof e=="string"?(i=e.match(yT))&&(this.value=parseFloat(i[1]),i[5]==="%"?this.value/=100:i[5]==="s"&&(this.value*=1e3),this.unit=i[5]):e instanceof Hd&&(this.value=e.valueOf(),this.unit=e.unit),this}minus(e){return e=new Hd(e),new Hd(this-e,this.unit||e.unit)}plus(e){return e=new Hd(e),new Hd(this+e,this.unit||e.unit)}times(e){return e=new Hd(e),new Hd(this*e,this.unit||e.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return(this.unit==="%"?~~(1e8*this.value)/1e6:this.unit==="s"?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}};const vR=new Set(["fill","stroke","color","bgcolor","stop-color","flood-color","lighting-color"]),wT=[];let om=class BT extends qy{constructor(e,i){super(),this.node=e,this.type=e.nodeName,i&&e!==i&&this.attr(i)}add(e,i){return(e=Pu(e)).removeNamespace&&this.node instanceof ho.window.SVGElement&&e.removeNamespace(),i==null?this.node.appendChild(e.node):e.node!==this.node.childNodes[i]&&this.node.insertBefore(e.node,this.node.childNodes[i]),this}addTo(e,i){return Pu(e).put(this,i)}children(){return new pg(H1(this.node.children,function(e){return rd(e)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(e=!0,i=!0){this.writeDataToDom();let s=this.node.cloneNode(e);return i&&(s=mT(s)),new this.constructor(s)}each(e,i){const s=this.children();let c,d;for(c=0,d=s.length;c<d;c++)e.apply(s[c],[c,s]),i&&s[c].each(e,i);return this}element(e,i){return this.put(new BT(Py(e),i))}first(){return rd(this.node.firstChild)}get(e){return rd(this.node.childNodes[e])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(e){return this.index(e)>=0}html(e,i){return this.xml(e,i,"http://www.w3.org/1999/xhtml")}id(e){return e!==void 0||this.node.id||(this.node.id=gT(this.type)),this.attr("id",e)}index(e){return[].slice.call(this.node.childNodes).indexOf(e.node)}last(){return rd(this.node.lastChild)}matches(e){const i=this.node,s=i.matches||i.matchesSelector||i.msMatchesSelector||i.mozMatchesSelector||i.webkitMatchesSelector||i.oMatchesSelector||null;return s&&s.call(i,e)}parent(e){let i=this;if(!i.node.parentNode)return null;if(i=rd(i.node.parentNode),!e)return i;do if(typeof e=="string"?i.matches(e):i instanceof e)return i;while(i=rd(i.node.parentNode));return i}put(e,i){return e=Pu(e),this.add(e,i),e}putIn(e,i){return Pu(e).add(this,i)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(e){return this.node.removeChild(e.node),this}replace(e){return e=Pu(e),this.node.parentNode&&this.node.parentNode.replaceChild(e.node,this.node),e}round(e=2,i=null){const s=10**e,c=this.attr(i);for(const d in c)typeof c[d]=="number"&&(c[d]=Math.round(c[d]*s)/s);return this.attr(c),this}svg(e,i){return this.xml(e,i,Q1)}toString(){return this.id()}words(e){return this.node.textContent=e,this}wrap(e){const i=this.parent();if(!i)return this.addTo(e);const s=i.index(this);return i.put(e,s).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(e,i,s){if(typeof e=="boolean"&&(s=i,i=e,e=null),e==null||typeof e=="function"){i=i==null||i,this.writeDataToDom();let r=this;if(e!=null){if(r=rd(r.node.cloneNode(!0)),i){const y=e(r);if(r=y||r,y===!1)return""}r.each(function(){const y=e(this),b=y||this;y===!1?this.remove():y&&this!==b&&this.replace(b)},!0)}return i?r.node.outerHTML:r.node.innerHTML}i=i!=null&&i;const c=Py("wrapper",s),d=ho.document.createDocumentFragment();c.innerHTML=e;for(let r=c.children.length;r--;)d.appendChild(c.firstElementChild);const A=this.parent();return i?this.replace(d)&&A:this.add(d)}};jn(om,{attr:function(a,e,i){if(a==null){a={},e=this.node.attributes;for(const s of e)a[s.nodeName]=WS.test(s.nodeValue)?parseFloat(s.nodeValue):s.nodeValue;return a}if(a instanceof Array)return a.reduce((s,c)=>(s[c]=this.attr(c),s),{});if(typeof a=="object"&&a.constructor===Object)for(e in a)this.attr(e,a[e]);else if(e===null)this.node.removeAttribute(a);else{if(e==null)return(e=this.node.getAttribute(a))==null?yR[a]:WS.test(e)?parseFloat(e):e;typeof(e=wT.reduce((s,c)=>c(a,s,this),e))=="number"?e=new mo(e):vR.has(a)&&GA.isColor(e)?e=new GA(e):e.constructor===Array&&(e=new gg(e)),a==="leading"?this.leading&&this.leading(e):typeof i=="string"?this.node.setAttributeNS(i,a,e.toString()):this.node.setAttribute(a,e.toString()),!this.rebuild||a!=="font-size"&&a!=="x"||this.rebuild()}return this},find:function(a){return vg(a,this.node)},findOne:function(a){return rd(this.node.querySelector(a))}}),Ao(om,"Dom");let Oc=class extends om{constructor(e,i){super(e,i),this.dom={},this.node.instance=this,(e.hasAttribute("data-svgjs")||e.hasAttribute("svgjs:data"))&&this.setData(JSON.parse(e.getAttribute("data-svgjs"))??JSON.parse(e.getAttribute("svgjs:data"))??{})}center(e,i){return this.cx(e).cy(i)}cx(e){return e==null?this.x()+this.width()/2:this.x(e-this.width()/2)}cy(e){return e==null?this.y()+this.height()/2:this.y(e-this.height()/2)}defs(){const e=this.root();return e&&e.defs()}dmove(e,i){return this.dx(e).dy(i)}dx(e=0){return this.x(new mo(e).plus(this.x()))}dy(e=0){return this.y(new mo(e).plus(this.y()))}getEventHolder(){return this}height(e){return this.attr("height",e)}move(e,i){return this.x(e).y(i)}parents(e=this.root()){const i=typeof e=="string";i||(e=Pu(e));const s=new pg;let c=this;for(;(c=c.parent())&&c.node!==ho.document&&c.nodeName!=="#document-fragment"&&(s.push(c),i||c.node!==e.node)&&(!i||!c.matches(e));)if(c.node===this.root().node)return null;return s}reference(e){if(!(e=this.attr(e)))return null;const i=(e+"").match(cR);return i?Pu(i[1]):null}root(){const e=this.parent(function(i){return cg[i]}(G1));return e&&e.root()}setData(e){return this.dom=e,this}size(e,i){const s=hm(this,e,i);return this.width(new mo(s.width)).height(new mo(s.height))}width(e){return this.attr("width",e)}writeDataToDom(){return pT(this,this.dom),super.writeDataToDom()}x(e){return this.attr("x",e)}y(e){return this.attr("y",e)}};jn(Oc,{bbox:function(){const a=XS(this,e=>e.getBBox(),e=>{try{const i=e.clone().addTo(dp().svg).show(),s=i.node.getBBox();return i.remove(),s}catch(i){throw new Error(`Getting bbox of element "${e.node.nodeName}" is not possible: ${i.toString()}`)}});return new Ac(a)},rbox:function(a){const e=XS(this,s=>s.getBoundingClientRect(),s=>{throw new Error(`Getting rbox of element "${s.node.nodeName}" is not possible`)}),i=new Ac(e);return a?i.transform(a.screenCTM().inverseO()):i.addOffset()},inside:function(a,e){const i=this.bbox();return a>i.x&&e>i.y&&a<i.x+i.width&&e<i.y+i.height},point:function(a,e){return new Vo(a,e).transformO(this.screenCTM().inverseO())},ctm:function(){return new Ks(this.node.getCTM())},screenCTM:function(){try{if(typeof this.isRoot=="function"&&!this.isRoot()){const a=this.rect(1,1),e=a.node.getScreenCTM();return a.remove(),new Ks(e)}return new Ks(this.node.getScreenCTM())}catch{return console.warn(`Cannot get CTM from SVG node ${this.node.nodeName}. Is the element rendered?`),new Ks}}}),Ao(Oc,"Element");const iy={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(a,e){return e==="color"?a:a+"-"+e}};["fill","stroke"].forEach(function(a){const e={};let i;e[a]=function(s){if(s===void 0)return this.attr(a);if(typeof s=="string"||s instanceof GA||GA.isRgb(s)||s instanceof Oc)this.attr(a,s);else for(i=iy[a].length-1;i>=0;i--)s[iy[a][i]]!=null&&this.attr(iy.prefix(a,iy[a][i]),s[iy[a][i]]);return this},Os(["Element","Runner"],e)}),Os(["Element","Runner"],{matrix:function(a,e,i,s,c,d){return a==null?new Ks(this):this.attr("transform",new Ks(a,e,i,s,c,d))},rotate:function(a,e,i){return this.transform({rotate:a,ox:e,oy:i},!0)},skew:function(a,e,i,s){return arguments.length===1||arguments.length===3?this.transform({skew:a,ox:e,oy:i},!0):this.transform({skew:[a,e],ox:i,oy:s},!0)},shear:function(a,e,i){return this.transform({shear:a,ox:e,oy:i},!0)},scale:function(a,e,i,s){return arguments.length===1||arguments.length===3?this.transform({scale:a,ox:e,oy:i},!0):this.transform({scale:[a,e],ox:i,oy:s},!0)},translate:function(a,e){return this.transform({translate:[a,e]},!0)},relative:function(a,e){return this.transform({relative:[a,e]},!0)},flip:function(a="both",e="center"){return"xybothtrue".indexOf(a)===-1&&(e=a,a="both"),this.transform({flip:a,origin:e},!0)},opacity:function(a){return this.attr("opacity",a)}}),Os("radius",{radius:function(a,e=a){return(this._element||this).type==="radialGradient"?this.attr("r",new mo(a)):this.rx(a).ry(e)}}),Os("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(a){return new Vo(this.node.getPointAtLength(a))}}),Os(["Element","Runner"],{font:function(a,e){if(typeof a=="object"){for(e in a)this.font(e,a[e]);return this}return a==="leading"?this.leading(e):a==="anchor"?this.attr("text-anchor",e):a==="size"||a==="family"||a==="weight"||a==="stretch"||a==="variant"||a==="style"?this.attr("font-"+a,e):this.attr(a,e)}});Os("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel","contextmenu","wheel","pointerdown","pointermove","pointerup","pointerleave","pointercancel"].reduce(function(a,e){return a[e]=function(i){return i===null?this.off(e):this.on(e,i),this},a},{})),Os("Element",{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(uR).slice(0,-1).map(function(e){const i=e.trim().split("(");return[i[0],i[1].split(Sf).map(function(s){return parseFloat(s)})]}).reverse().reduce(function(e,i){return i[0]==="matrix"?e.lmultiply(Ks.fromArray(i[1])):e[i[0]].apply(e,i[1])},new Ks)},toParent:function(a,e){if(this===a)return this;if(Nb(this.node))return this.addTo(a,e);const i=this.screenCTM(),s=a.screenCTM().inverse();return this.addTo(a,e).untransform().transform(s.multiply(i)),this},toRoot:function(a){return this.toParent(this.root(),a)},transform:function(a,e){if(a==null||typeof a=="string"){const s=new Ks(this).decompose();return a==null?s:s[a]}Ks.isMatrixLike(a)||(a={...a,origin:zb(a,this)});const i=new Ks(e===!0?this:e||!1).transform(a);return this.attr("transform",i)}});let Nh=class CT extends Oc{flatten(){return this.each(function(){if(this instanceof CT)return this.flatten().ungroup()}),this}ungroup(e=this.parent(),i=e.index(this)){return i=i===-1?e.children().length:i,this.each(function(s,c){return c[c.length-s-1].toParent(e,i)}),this.remove()}};Ao(Nh,"Container");let o_=class extends Nh{constructor(e,i=e){super(ea("defs",e),i)}flatten(){return this}ungroup(){return this}};Ao(o_,"Defs");let jh=class extends Oc{};function Y1(a){return this.attr("rx",a)}function K1(a){return this.attr("ry",a)}function ST(a){return a==null?this.cx()-this.rx():this.cx(a+this.rx())}function ET(a){return a==null?this.cy()-this.ry():this.cy(a+this.ry())}function TT(a){return this.attr("cx",a)}function IT(a){return this.attr("cy",a)}function FT(a){return a==null?2*this.rx():this.rx(new mo(a).divide(2))}function LT(a){return a==null?2*this.ry():this.ry(new mo(a).divide(2))}Ao(jh,"Shape");var _R=Object.freeze({__proto__:null,cx:TT,cy:IT,height:LT,rx:Y1,ry:K1,width:FT,x:ST,y:ET});let dv=class extends jh{constructor(e,i=e){super(ea("ellipse",e),i)}size(e,i){const s=hm(this,e,i);return this.rx(new mo(s.width).divide(2)).ry(new mo(s.height).divide(2))}};jn(dv,_R),Os("Container",{ellipse:Jo(function(a=0,e=a){return this.put(new dv).size(a,e).move(0,0)})}),Ao(dv,"Ellipse");let MT=class extends om{constructor(e=ho.document.createDocumentFragment()){super(e)}xml(e,i,s){if(typeof e=="boolean"&&(s=i,i=e,e=null),e==null||typeof e=="function"){const c=new om(Py("wrapper",s));return c.add(this.node.cloneNode(!0)),c.xml(!1,s)}return super.xml(e,!1,s)}};function PT(a,e){return(this._element||this).type==="radialGradient"?this.attr({fx:new mo(a),fy:new mo(e)}):this.attr({x1:new mo(a),y1:new mo(e)})}function kT(a,e){return(this._element||this).type==="radialGradient"?this.attr({cx:new mo(a),cy:new mo(e)}):this.attr({x2:new mo(a),y2:new mo(e)})}Ao(MT,"Fragment");var xR=Object.freeze({__proto__:null,from:PT,to:kT});let yy=class extends Nh{constructor(e,i){super(ea(e+"Gradient",typeof e=="string"?null:e),i)}attr(e,i,s){return e==="transform"&&(e="gradientTransform"),super.attr(e,i,s)}bbox(){return new Ac}targets(){return vg("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}};jn(yy,xR),Os({Container:{gradient(...a){return this.defs().gradient(...a)}},Defs:{gradient:Jo(function(a,e){return this.put(new yy(a)).update(e)})}}),Ao(yy,"Gradient");let ky=class extends Nh{constructor(e,i=e){super(ea("pattern",e),i)}attr(e,i,s){return e==="transform"&&(e="patternTransform"),super.attr(e,i,s)}bbox(){return new Ac}targets(){return vg("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}};Os({Container:{pattern(...a){return this.defs().pattern(...a)}},Defs:{pattern:Jo(function(a,e,i){return this.put(new ky).update(i).attr({x:0,y:0,width:a,height:e,patternUnits:"userSpaceOnUse"})})}}),Ao(ky,"Pattern");let Av=class extends jh{constructor(e,i=e){super(ea("image",e),i)}load(e,i){if(!e)return this;const s=new ho.window.Image;return bf(s,"load",function(c){const d=this.parent(ky);this.width()===0&&this.height()===0&&this.size(s.width,s.height),d instanceof ky&&d.width()===0&&d.height()===0&&d.size(this.width(),this.height()),typeof i=="function"&&i.call(this,c)},this),bf(s,"load error",function(){nd(s)}),this.attr("href",s.src=e,dm)}};var KS;KS=function(a,e,i){return a!=="fill"&&a!=="stroke"||dR.test(e)&&(e=i.root().defs().image(e)),e instanceof Av&&(e=i.root().defs().pattern(0,0,s=>{s.add(e)})),e},wT.push(KS),Os({Container:{image:Jo(function(a,e){return this.put(new Av).size(0,0).load(a,e)})}}),Ao(Av,"Image");let wp=class extends gg{bbox(){let e=-1/0,i=-1/0,s=1/0,c=1/0;return this.forEach(function(d){e=Math.max(d[0],e),i=Math.max(d[1],i),s=Math.min(d[0],s),c=Math.min(d[1],c)}),new Ac(s,c,e-s,i-c)}move(e,i){const s=this.bbox();if(e-=s.x,i-=s.y,!isNaN(e)&&!isNaN(i))for(let c=this.length-1;c>=0;c--)this[c]=[this[c][0]+e,this[c][1]+i];return this}parse(e=[0,0]){const i=[];(e=e instanceof Array?Array.prototype.concat.apply([],e):e.trim().split(Sf).map(parseFloat)).length%2!=0&&e.pop();for(let s=0,c=e.length;s<c;s+=2)i.push([e[s],e[s+1]]);return i}size(e,i){let s;const c=this.bbox();for(s=this.length-1;s>=0;s--)c.width&&(this[s][0]=(this[s][0]-c.x)*e/c.width+c.x),c.height&&(this[s][1]=(this[s][1]-c.y)*i/c.height+c.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const e=[];for(let i=0,s=this.length;i<s;i++)e.push(this[i].join(","));return e.join(" ")}transform(e){return this.clone().transformO(e)}transformO(e){Ks.isMatrixLike(e)||(e=new Ks(e));for(let i=this.length;i--;){const[s,c]=this[i];this[i][0]=e.a*s+e.c*c+e.e,this[i][1]=e.b*s+e.d*c+e.f}return this}};const bR=wp;var q1=Object.freeze({__proto__:null,MorphArray:bR,height:function(a){const e=this.bbox();return a==null?e.height:this.size(e.width,a)},width:function(a){const e=this.bbox();return a==null?e.width:this.size(a,e.height)},x:function(a){return a==null?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return a==null?this.bbox().y:this.move(this.bbox().x,a)}});let ig=class extends jh{constructor(a,e=a){super(ea("line",a),e)}array(){return new wp([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(a,e){return this.attr(this.array().move(a,e).toLine())}plot(a,e,i,s){return a==null?this.array():(a=e!==void 0?{x1:a,y1:e,x2:i,y2:s}:new wp(a).toLine(),this.attr(a))}size(a,e){const i=hm(this,a,e);return this.attr(this.array().size(i.width,i.height).toLine())}};jn(ig,q1),Os({Container:{line:Jo(function(...a){return ig.prototype.plot.apply(this.put(new ig),a[0]!=null?a:[0,0,0,0])})}}),Ao(ig,"Line");let fv=class extends Nh{constructor(e,i=e){super(ea("marker",e),i)}height(e){return this.attr("markerHeight",e)}orient(e){return this.attr("orient",e)}ref(e,i){return this.attr("refX",e).attr("refY",i)}toString(){return"url(#"+this.id()+")"}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}width(e){return this.attr("markerWidth",e)}};function Yg(a,e){return function(i){return i==null?this[a]:(this[a]=i,e&&e.call(this),this)}}Os({Container:{marker(...a){return this.defs().marker(...a)}},Defs:{marker:Jo(function(a,e,i){return this.put(new fv).size(a,e).ref(a/2,e/2).viewbox(0,0,a,e).attr("orient","auto").update(i)})},marker:{marker(a,e,i,s){let c=["marker"];return a!=="all"&&c.push(a),c=c.join("-"),a=arguments[1]instanceof fv?arguments[1]:this.defs().marker(e,i,s),this.attr(c,a)}}}),Ao(fv,"Marker");const wR={"-":function(a){return a},"<>":function(a){return-Math.cos(a*Math.PI)/2+.5},">":function(a){return Math.sin(a*Math.PI/2)},"<":function(a){return 1-Math.cos(a*Math.PI/2)},bezier:function(a,e,i,s){return function(c){return c<0?a>0?e/a*c:i>0?s/i*c:0:c>1?i<1?(1-s)/(1-i)*c+(s-i)/(1-i):a<1?(1-e)/(1-a)*c+(e-a)/(1-a):1:3*c*(1-c)**2*e+3*c**2*(1-c)*s+c**3}},steps:function(a,e="end"){e=e.split("-").reverse()[0];let i=a;return e==="none"?--i:e==="both"&&++i,(s,c=!1)=>{let d=Math.floor(s*a);const A=s*d%1==0;return e!=="start"&&e!=="both"||++d,c&&A&&--d,s>=0&&d<0&&(d=0),s<=1&&d>i&&(d=i),d/i}}};let $1=class{done(){return!1}},jb=class extends $1{constructor(e=gR){super(),this.ease=wR[e]||e}step(e,i,s){return typeof e!="number"?s<1?e:i:e+(i-e)*this.ease(s)}};class Ov extends $1{constructor(e){super(),this.stepper=e}done(e){return e.done}step(e,i,s,c){return this.stepper(e,i,s,c)}}function qS(){const a=(this._duration||500)/1e3,e=this._overshoot||0,i=Math.PI,s=Math.log(e/100+1e-10),c=-s/Math.sqrt(i*i+s*s),d=3.9/(c*a);this.d=2*c*d,this.k=d*d}jn(class extends Ov{constructor(a=500,e=0){super(),this.duration(a).overshoot(e)}step(a,e,i,s){if(typeof a=="string")return a;if(s.done=i===1/0,i===1/0)return e;if(i===0)return a;i>100&&(i=16),i/=1e3;const c=s.velocity||0,d=-this.d*c-this.k*(a-e),A=a+c*i+d*i*i/2;return s.velocity=c+d*i,s.done=Math.abs(e-A)+Math.abs(c)<.002,s.done?e:A}},{duration:Yg("_duration",qS),overshoot:Yg("_overshoot",qS)});jn(class extends Ov{constructor(a=.1,e=.01,i=0,s=1e3){super(),this.p(a).i(e).d(i).windup(s)}step(a,e,i,s){if(typeof a=="string")return a;if(s.done=i===1/0,i===1/0)return e;if(i===0)return a;const c=e-a;let d=(s.integral||0)+c*i;const A=(c-(s.error||0))/i,r=this._windup;return r!==!1&&(d=Math.max(-r,Math.min(d,r))),s.error=c,s.integral=d,s.done=Math.abs(c)<.001,s.done?e:a+(this.P*c+this.I*d+this.D*A)}},{windup:Yg("_windup"),p:Yg("P"),i:Yg("I"),d:Yg("D")});const BR={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Hb={M:function(a,e,i){return e.x=i.x=a[0],e.y=i.y=a[1],["M",e.x,e.y]},L:function(a,e){return e.x=a[0],e.y=a[1],["L",a[0],a[1]]},H:function(a,e){return e.x=a[0],["H",a[0]]},V:function(a,e){return e.y=a[0],["V",a[0]]},C:function(a,e){return e.x=a[4],e.y=a[5],["C",a[0],a[1],a[2],a[3],a[4],a[5]]},S:function(a,e){return e.x=a[2],e.y=a[3],["S",a[0],a[1],a[2],a[3]]},Q:function(a,e){return e.x=a[2],e.y=a[3],["Q",a[0],a[1],a[2],a[3]]},T:function(a,e){return e.x=a[0],e.y=a[1],["T",a[0],a[1]]},Z:function(a,e,i){return e.x=i.x,e.y=i.y,["Z"]},A:function(a,e){return e.x=a[5],e.y=a[6],["A",a[0],a[1],a[2],a[3],a[4],a[5],a[6]]}},$x="mlhvqtcsaz".split("");for(let a=0,e=$x.length;a<e;++a)Hb[$x[a]]=function(i){return function(s,c,d){if(i==="H")s[0]=s[0]+c.x;else if(i==="V")s[0]=s[0]+c.y;else if(i==="A")s[5]=s[5]+c.x,s[6]=s[6]+c.y;else for(let A=0,r=s.length;A<r;++A)s[A]=s[A]+(A%2?c.y:c.x);return Hb[i](s,c,d)}}($x[a].toUpperCase());function Qb(a){return a.segment.length&&a.segment.length-1===BR[a.segment[0].toUpperCase()]}function CR(a,e){a.inNumber&&qp(a,!1);const i=W1.test(e);if(i)a.segment=[e];else{const s=a.lastCommand,c=s.toLowerCase(),d=s===c;a.segment=[c==="m"?d?"l":"L":s]}return a.inSegment=!0,a.lastCommand=a.segment[0],i}function qp(a,e){if(!a.inNumber)throw new Error("Parser Error");a.number&&a.segment.push(parseFloat(a.number)),a.inNumber=e,a.number="",a.pointSeen=!1,a.hasExponent=!1,Qb(a)&&Vb(a)}function Vb(a){a.inSegment=!1,a.absolute&&(a.segment=function(e){const i=e.segment[0];return Hb[i](e.segment.slice(1),e.p,e.p0)}(a)),a.segments.push(a.segment)}function SR(a){if(!a.segment.length)return!1;const e=a.segment[0].toUpperCase()==="A",i=a.segment.length;return e&&(i===4||i===5)}function ER(a){return a.lastToken.toUpperCase()==="E"}const TR=new Set([" ",",","	",`
`,"\r","\f"]);class Vd extends gg{bbox(){return dp().path.setAttribute("d",this.toString()),new Ac(dp.nodes.path.getBBox())}move(e,i){const s=this.bbox();if(e-=s.x,i-=s.y,!isNaN(e)&&!isNaN(i))for(let c,d=this.length-1;d>=0;d--)c=this[d][0],c==="M"||c==="L"||c==="T"?(this[d][1]+=e,this[d][2]+=i):c==="H"?this[d][1]+=e:c==="V"?this[d][1]+=i:c==="C"||c==="S"||c==="Q"?(this[d][1]+=e,this[d][2]+=i,this[d][3]+=e,this[d][4]+=i,c==="C"&&(this[d][5]+=e,this[d][6]+=i)):c==="A"&&(this[d][6]+=e,this[d][7]+=i);return this}parse(e="M0 0"){return Array.isArray(e)&&(e=Array.prototype.concat.apply([],e).toString()),function(i,s=!0){let c=0,d="";const A={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:s,p0:new Vo,p:new Vo};for(;A.lastToken=d,d=i.charAt(c++);)if(A.inSegment||!CR(A,d))if(d!==".")if(isNaN(parseInt(d)))if(TR.has(d))A.inNumber&&qp(A,!1);else if(d!=="-"&&d!=="+")if(d.toUpperCase()!=="E"){if(W1.test(d)){if(A.inNumber)qp(A,!1);else{if(!Qb(A))throw new Error("parser Error");Vb(A)}--c}}else A.number+=d,A.hasExponent=!0;else{if(A.inNumber&&!ER(A)){qp(A,!1),--c;continue}A.number+=d,A.inNumber=!0}else{if(A.number==="0"||SR(A)){A.inNumber=!0,A.number=d,qp(A,!0);continue}A.inNumber=!0,A.number+=d}else{if(A.pointSeen||A.hasExponent){qp(A,!1),--c;continue}A.inNumber=!0,A.pointSeen=!0,A.number+=d}return A.inNumber&&qp(A,!1),A.inSegment&&Qb(A)&&Vb(A),A.segments}(e)}size(e,i){const s=this.bbox();let c,d;for(s.width=s.width===0?1:s.width,s.height=s.height===0?1:s.height,c=this.length-1;c>=0;c--)d=this[c][0],d==="M"||d==="L"||d==="T"?(this[c][1]=(this[c][1]-s.x)*e/s.width+s.x,this[c][2]=(this[c][2]-s.y)*i/s.height+s.y):d==="H"?this[c][1]=(this[c][1]-s.x)*e/s.width+s.x:d==="V"?this[c][1]=(this[c][1]-s.y)*i/s.height+s.y:d==="C"||d==="S"||d==="Q"?(this[c][1]=(this[c][1]-s.x)*e/s.width+s.x,this[c][2]=(this[c][2]-s.y)*i/s.height+s.y,this[c][3]=(this[c][3]-s.x)*e/s.width+s.x,this[c][4]=(this[c][4]-s.y)*i/s.height+s.y,d==="C"&&(this[c][5]=(this[c][5]-s.x)*e/s.width+s.x,this[c][6]=(this[c][6]-s.y)*i/s.height+s.y)):d==="A"&&(this[c][1]=this[c][1]*e/s.width,this[c][2]=this[c][2]*i/s.height,this[c][6]=(this[c][6]-s.x)*e/s.width+s.x,this[c][7]=(this[c][7]-s.y)*i/s.height+s.y);return this}toString(){return function(e){let i="";for(let s=0,c=e.length;s<c;s++)i+=e[s][0],e[s][1]!=null&&(i+=e[s][1],e[s][2]!=null&&(i+=" ",i+=e[s][2],e[s][3]!=null&&(i+=" ",i+=e[s][3],i+=" ",i+=e[s][4],e[s][5]!=null&&(i+=" ",i+=e[s][5],i+=" ",i+=e[s][6],e[s][7]!=null&&(i+=" ",i+=e[s][7])))));return i+" "}(this)}}const RT=a=>{const e=typeof a;return e==="number"?mo:e==="string"?GA.isColor(a)?GA:Sf.test(a)?W1.test(a)?Vd:gg:yT.test(a)?mo:Gb:Wb.indexOf(a.constructor)>-1?a.constructor:Array.isArray(a)?gg:e==="object"?Ry:Gb};class $p{constructor(e){this._stepper=e||new jb("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(e){return this._morphObj.morph(this._from,this._to,e,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,i){return e&&i},!0)}from(e){return e==null?this._from:(this._from=this._set(e),this)}stepper(e){return e==null?this._stepper:(this._stepper=e,this)}to(e){return e==null?this._to:(this._to=this._set(e),this)}type(e){return e==null?this._type:(this._type=e,this)}_set(e){this._type||this.type(RT(e));let i=new this._type(e);return this._type===GA&&(i=this._to?i[this._to[4]]():this._from?i[this._from[4]]():i),this._type===Ry&&(i=this._to?i.align(this._to):this._from?i.align(this._from):i),i=i.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(i.length)).map(Object).map(function(s){return s.done=!0,s}),i}}class Gb{constructor(...e){this.init(...e)}init(e){return e=Array.isArray(e)?e[0]:e,this.value=e,this}toArray(){return[this.value]}valueOf(){return this.value}}class $y{constructor(...e){this.init(...e)}init(e){return Array.isArray(e)&&(e={scaleX:e[0],scaleY:e[1],shear:e[2],rotate:e[3],translateX:e[4],translateY:e[5],originX:e[6],originY:e[7]}),Object.assign(this,$y.defaults,e),this}toArray(){const e=this;return[e.scaleX,e.scaleY,e.shear,e.rotate,e.translateX,e.translateY,e.originX,e.originY]}}$y.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const IR=(a,e)=>a[0]<e[0]?-1:a[0]>e[0]?1:0;class Ry{constructor(...e){this.init(...e)}align(e){const i=this.values;for(let s=0,c=i.length;s<c;++s){if(i[s+1]===e[s+1]){if(i[s+1]===GA&&e[s+7]!==i[s+7]){const r=e[s+7],y=new GA(this.values.splice(s+3,5))[r]().toArray();this.values.splice(s+3,0,...y)}s+=i[s+2]+2;continue}if(!e[s+1])return this;const d=new e[s+1]().toArray(),A=i[s+2]+3;i.splice(s,A,e[s],e[s+1],e[s+2],...d),s+=i[s+2]+2}return this}init(e){if(this.values=[],Array.isArray(e))return void(this.values=e.slice());e=e||{};const i=[];for(const s in e){const c=RT(e[s]),d=new c(e[s]).toArray();i.push([s,c,d.length,...d])}return i.sort(IR),this.values=i.reduce((s,c)=>s.concat(c),[]),this}toArray(){return this.values}valueOf(){const e={},i=this.values;for(;i.length;){const s=i.shift(),c=i.shift(),d=i.shift(),A=i.splice(0,d);e[s]=new c(A)}return e}}const Wb=[Gb,$y,Ry];class tm extends jh{constructor(e,i=e){super(ea("path",e),i)}array(){return this._array||(this._array=new Vd(this.attr("d")))}clear(){return delete this._array,this}height(e){return e==null?this.bbox().height:this.size(this.bbox().width,e)}move(e,i){return this.attr("d",this.array().move(e,i))}plot(e){return e==null?this.array():this.clear().attr("d",typeof e=="string"?e:this._array=new Vd(e))}size(e,i){const s=hm(this,e,i);return this.attr("d",this.array().size(s.width,s.height))}width(e){return e==null?this.bbox().width:this.size(e,this.bbox().height)}x(e){return e==null?this.bbox().x:this.move(e,this.bbox().y)}y(e){return e==null?this.bbox().y:this.move(this.bbox().x,e)}}tm.prototype.MorphArray=Vd,Os({Container:{path:Jo(function(a){return this.put(new tm).plot(a||new Vd)})}}),Ao(tm,"Path");var DT=Object.freeze({__proto__:null,array:function(){return this._array||(this._array=new wp(this.attr("points")))},clear:function(){return delete this._array,this},move:function(a,e){return this.attr("points",this.array().move(a,e))},plot:function(a){return a==null?this.array():this.clear().attr("points",typeof a=="string"?a:this._array=new wp(a))},size:function(a,e){const i=hm(this,a,e);return this.attr("points",this.array().size(i.width,i.height))}});class rg extends jh{constructor(e,i=e){super(ea("polygon",e),i)}}Os({Container:{polygon:Jo(function(a){return this.put(new rg).plot(a||new wp)})}}),jn(rg,q1),jn(rg,DT),Ao(rg,"Polygon");class ng extends jh{constructor(e,i=e){super(ea("polyline",e),i)}}Os({Container:{polyline:Jo(function(a){return this.put(new ng).plot(a||new wp)})}}),jn(ng,q1),jn(ng,DT),Ao(ng,"Polyline");class pv extends jh{constructor(e,i=e){super(ea("rect",e),i)}}jn(pv,{rx:Y1,ry:K1}),Os({Container:{rect:Jo(function(a,e){return this.put(new pv).size(a,e)})}}),Ao(pv,"Rect");class Zx{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(e){const i=e.next!==void 0?e:{value:e,next:null,prev:null};return this._last?(i.prev=this._last,this._last.next=i,this._last=i):(this._last=i,this._first=i),i}remove(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this._last&&(this._last=e.prev),e===this._first&&(this._first=e.next),e.prev=null,e.next=null}shift(){const e=this._first;return e?(this._first=e.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,e.value):null}}const ko={nextDraw:null,frames:new Zx,timeouts:new Zx,immediates:new Zx,timer:()=>ho.window.performance||ho.window.Date,transforms:[],frame(a){const e=ko.frames.push({run:a});return ko.nextDraw===null&&(ko.nextDraw=ho.window.requestAnimationFrame(ko._draw)),e},timeout(a,e){e=e||0;const i=ko.timer().now()+e,s=ko.timeouts.push({run:a,time:i});return ko.nextDraw===null&&(ko.nextDraw=ho.window.requestAnimationFrame(ko._draw)),s},immediate(a){const e=ko.immediates.push(a);return ko.nextDraw===null&&(ko.nextDraw=ho.window.requestAnimationFrame(ko._draw)),e},cancelFrame(a){a!=null&&ko.frames.remove(a)},clearTimeout(a){a!=null&&ko.timeouts.remove(a)},cancelImmediate(a){a!=null&&ko.immediates.remove(a)},_draw(a){let e=null;const i=ko.timeouts.last();for(;(e=ko.timeouts.shift())&&(a>=e.time?e.run():ko.timeouts.push(e),e!==i););let s=null;const c=ko.frames.last();for(;s!==c&&(s=ko.frames.shift());)s.run(a);let d=null;for(;d=ko.immediates.shift();)d();ko.nextDraw=ko.timeouts.first()||ko.frames.first()?ho.window.requestAnimationFrame(ko._draw):null}},FR=function(a){const e=a.start,i=a.runner.duration();return{start:e,duration:i,end:e+i,runner:a.runner}},LR=function(){const a=ho.window;return(a.performance||a.Date).now()};class OT extends qy{constructor(e=LR){super(),this._timeSource=e,this.terminate()}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const e=this.getLastRunnerInfo(),i=e?e.runner.duration():0;return(e?e.start:this._time)+i}getEndTimeOfTimeline(){const e=this._runners.map(i=>i.start+i.runner.duration());return Math.max(0,...e)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(e){return this._runners[this._runnerIds.indexOf(e)]||null}pause(){return this._paused=!0,this._continue()}persist(e){return e==null?this._persist:(this._persist=e,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(e){const i=this.speed();if(e==null)return this.speed(-i);const s=Math.abs(i);return this.speed(e?-s:s)}schedule(e,i,s){if(e==null)return this._runners.map(FR);let c=0;const d=this.getEndTime();if(i=i||0,s==null||s==="last"||s==="after")c=d;else if(s==="absolute"||s==="start")c=i,i=0;else if(s==="now")c=this._time;else if(s==="relative"){const y=this.getRunnerInfoById(e.id);y&&(c=y.start+i,i=0)}else{if(s!=="with-last")throw new Error('Invalid value for the "when" parameter');{const y=this.getLastRunnerInfo();c=y?y.start:this._time}}e.unschedule(),e.timeline(this);const A=e.persist(),r={persist:A===null?this._persist:A,start:c+i,runner:e};return this._lastRunnerId=e.id,this._runners.push(r),this._runners.sort((y,b)=>y.start-b.start),this._runnerIds=this._runners.map(y=>y.runner.id),this.updateTime()._continue(),this}seek(e){return this.time(this._time+e)}source(e){return e==null?this._timeSource:(this._timeSource=e,this)}speed(e){return e==null?this._speed:(this._speed=e,this)}stop(){return this.time(0),this.pause()}time(e){return e==null?this._time:(this._time=e,this._continue(!0))}unschedule(e){const i=this._runnerIds.indexOf(e.id);return i<0||(this._runners.splice(i,1),this._runnerIds.splice(i,1),e.timeline(null)),this}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(e=!1){return ko.cancelFrame(this._nextFrame),this._nextFrame=null,e?this._stepImmediate():(this._paused||(this._nextFrame=ko.frame(this._step)),this)}_stepFn(e=!1){const i=this._timeSource();let s=i-this._lastSourceTime;e&&(s=0);const c=this._speed*s+(this._time-this._lastStepTime);this._lastSourceTime=i,e||(this._time+=c,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let A=this._runners.length;A--;){const r=this._runners[A],y=r.runner;this._time-r.start<=0&&y.reset()}let d=!1;for(let A=0,r=this._runners.length;A<r;A++){const y=this._runners[A],b=y.runner;let x=c;const B=this._time-y.start;if(B<=0){d=!0;continue}B<x&&(x=B),b.active()&&(b.step(x).done?y.persist!==!0&&b.duration()-b.time()+this._time+y.persist<this._time&&(b.unschedule(),--A,--r):d=!0)}return d&&!(this._speed<0&&this._time===0)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}terminate(){this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}}Os({Element:{timeline:function(a){return a==null?(this._timeline=this._timeline||new OT,this._timeline):(this._timeline=a,this)}}});class zh extends qy{constructor(e){super(),this.id=zh.id++,e=typeof(e=e??qx)=="function"?new Ov(e):e,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration=typeof e=="number"&&e,this._isDeclarative=e instanceof Ov,this._stepper=this._isDeclarative?e:new jb,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new Ks,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=!!this._isDeclarative||null}static sanitise(e,i,s){let c=1,d=!1,A=0;return i=i??mR,s=s||"last",typeof(e=e??qx)!="object"||e instanceof $1||(i=e.delay??i,s=e.when??s,d=e.swing||d,c=e.times??c,A=e.wait??A,e=e.duration??qx),{duration:e,delay:i,swing:d,times:c,wait:A,when:s}}active(e){return e==null?this.enabled:(this.enabled=e,this)}addTransform(e){return this.transforms.lmultiplyO(e),this}after(e){return this.on("finished",e)}animate(e,i,s){const c=zh.sanitise(e,i,s),d=new zh(c.duration);return this._timeline&&d.timeline(this._timeline),this._element&&d.element(this._element),d.loop(c).schedule(c.delay,c.when)}clearTransform(){return this.transforms=new Ks,this}clearTransformsFromQueue(){this.done&&this._timeline&&this._timeline._runnerIds.includes(this.id)||(this._queue=this._queue.filter(e=>!e.isTransform))}delay(e){return this.animate(0,e)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(e){return this.queue(null,e)}ease(e){return this._stepper=new jb(e),this}element(e){return e==null?this._element:(this._element=e,e._prepareRunner(),this)}finish(){return this.step(1/0)}loop(e,i,s){return typeof e=="object"&&(i=e.swing,s=e.wait,e=e.times),this._times=e||1/0,this._swing=i||!1,this._wait=s||0,this._times===!0&&(this._times=1/0),this}loops(e){const i=this._duration+this._wait;if(e==null){const d=Math.floor(this._time/i),A=(this._time-d*i)/this._duration;return Math.min(d+A,this._times)}const s=e%1,c=i*Math.floor(e)+this._duration*s;return this.time(c)}persist(e){return e==null?this._persist:(this._persist=e,this)}position(e){const i=this._time,s=this._duration,c=this._wait,d=this._times,A=this._swing,r=this._reverse;let y;if(e==null){const B=function(E){const R=A*Math.floor(E%(2*(c+s))/(c+s)),P=R&&!r||!R&&r,G=Math.pow(-1,P)*(E%(c+s))/s+P;return Math.max(Math.min(G,1),0)},T=d*(c+s)-c;return y=i<=0?Math.round(B(1e-5)):i<T?B(i):Math.round(B(T-1e-5)),y}const b=Math.floor(this.loops()),x=A&&b%2==0;return y=b+(x&&!r||r&&x?e:1-e),this.loops(y)}progress(e){return e==null?Math.min(1,this._time/this.duration()):this.time(e*this.duration())}queue(e,i,s,c){return this._queue.push({initialiser:e||YS,runner:i||YS,retarget:s,isTransform:c,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted||(this.time(0),this._reseted=!0),this}reverse(e){return this._reverse=e??!this._reverse,this}schedule(e,i,s){if(e instanceof OT||(s=i,i=e,e=this.timeline()),!e)throw Error("Runner cannot be scheduled without timeline");return e.schedule(this,i,s),this}step(e){if(!this.enabled)return this;e=e??16,this._time+=e;const i=this.position(),s=this._lastPosition!==i&&this._time>=0;this._lastPosition=i;const c=this.duration(),d=this._lastTime<=0&&this._time>0,A=this._lastTime<c&&this._time>=c;this._lastTime=this._time,d&&this.fire("start",this);const r=this._isDeclarative;this.done=!r&&!A&&this._time>=c,this._reseted=!1;let y=!1;return(s||r)&&(this._initialise(s),this.transforms=new Ks,y=this._run(r?e:i),this.fire("step",this)),this.done=this.done||y&&r,A&&this.fire("finished",this),this}time(e){if(e==null)return this._time;const i=e-this._time;return this.step(i),this}timeline(e){return e===void 0?this._timeline:(this._timeline=e,this)}unschedule(){const e=this.timeline();return e&&e.unschedule(this),this}_initialise(e){if(e||this._isDeclarative)for(let i=0,s=this._queue.length;i<s;++i){const c=this._queue[i],d=this._isDeclarative||!c.initialised&&e;e=!c.finished,d&&e&&(c.initialiser.call(this),c.initialised=!0)}}_rememberMorpher(e,i){if(this._history[e]={morpher:i,caller:this._queue[this._queue.length-1]},this._isDeclarative){const s=this.timeline();s&&s.play()}}_run(e){let i=!0;for(let s=0,c=this._queue.length;s<c;++s){const d=this._queue[s],A=d.runner.call(this,e);d.finished=d.finished||A===!0,i=i&&d.finished}return i}_tryRetarget(e,i,s){if(this._history[e]){if(!this._history[e].caller.initialised){const d=this._queue.indexOf(this._history[e].caller);return this._queue.splice(d,1),!1}this._history[e].caller.retarget?this._history[e].caller.retarget.call(this,i,s):this._history[e].morpher.to(i),this._history[e].caller.finished=!1;const c=this.timeline();return c&&c.play(),!0}return!1}}zh.id=0;class Uv{constructor(e=new Ks,i=-1,s=!0){this.transforms=e,this.id=i,this.done=s}clearTransformsFromQueue(){}}jn([zh,Uv],{mergeWith(a){return new Uv(a.transforms.lmultiply(this.transforms),a.id)}});const UT=(a,e)=>a.lmultiplyO(e),zT=a=>a.transforms;function MR(){const a=this._transformationRunners.runners.map(zT).reduce(UT,new Ks);this.transform(a),this._transformationRunners.merge(),this._transformationRunners.length()===1&&(this._frameId=null)}class PR{constructor(){this.runners=[],this.ids=[]}add(e){if(this.runners.includes(e))return;const i=e.id+1;return this.runners.push(e),this.ids.push(i),this}clearBefore(e){const i=this.ids.indexOf(e+1)||1;return this.ids.splice(0,i,0),this.runners.splice(0,i,new Uv).forEach(s=>s.clearTransformsFromQueue()),this}edit(e,i){const s=this.ids.indexOf(e+1);return this.ids.splice(s,1,e+1),this.runners.splice(s,1,i),this}getByID(e){return this.runners[this.ids.indexOf(e+1)]}length(){return this.ids.length}merge(){let e=null;for(let i=0;i<this.runners.length;++i){const s=this.runners[i];if(e&&s.done&&e.done&&(!s._timeline||!s._timeline._runnerIds.includes(s.id))&&(!e._timeline||!e._timeline._runnerIds.includes(e.id))){this.remove(s.id);const c=s.mergeWith(e);this.edit(e.id,c),e=c,--i}else e=s}return this}remove(e){const i=this.ids.indexOf(e+1);return this.ids.splice(i,1),this.runners.splice(i,1),this}}Os({Element:{animate(a,e,i){const s=zh.sanitise(a,e,i),c=this.timeline();return new zh(s.duration).loop(s).element(this).timeline(c.play()).schedule(s.delay,s.when)},delay(a,e){return this.animate(0,a,e)},_clearTransformRunnersBefore(a){this._transformationRunners.clearBefore(a.id)},_currentTransform(a){return this._transformationRunners.runners.filter(e=>e.id<=a.id).map(zT).reduce(UT,new Ks)},_addRunner(a){this._transformationRunners.add(a),ko.cancelImmediate(this._frameId),this._frameId=ko.immediate(MR.bind(this))},_prepareRunner(){this._frameId==null&&(this._transformationRunners=new PR().add(new Uv(new Ks(this))))}}});jn(zh,{attr(a,e){return this.styleAttr("attr",a,e)},css(a,e){return this.styleAttr("css",a,e)},styleAttr(a,e,i){if(typeof e=="string")return this.styleAttr(a,{[e]:i});let s=e;if(this._tryRetarget(a,s))return this;let c=new $p(this._stepper).to(s),d=Object.keys(s);return this.queue(function(){c=c.from(this.element()[a](d))},function(A){return this.element()[a](c.at(A).valueOf()),c.done()},function(A){const r=Object.keys(A),y=(b=d,r.filter(B=>!b.includes(B)));var b;if(y.length){const B=this.element()[a](y),T=new Ry(c.from()).valueOf();Object.assign(T,B),c.from(T)}const x=new Ry(c.to()).valueOf();Object.assign(x,A),c.to(x),d=r,s=A}),this._rememberMorpher(a,c),this},zoom(a,e){if(this._tryRetarget("zoom",a,e))return this;let i=new $p(this._stepper).to(new mo(a));return this.queue(function(){i=i.from(this.element().zoom())},function(s){return this.element().zoom(i.at(s),e),i.done()},function(s,c){e=c,i.to(s)}),this._rememberMorpher("zoom",i),this},transform(a,e,i){if(e=a.relative||e,this._isDeclarative&&!e&&this._tryRetarget("transform",a))return this;const s=Ks.isMatrixLike(a);i=a.affine!=null?a.affine:i??!s;const c=new $p(this._stepper).type(i?$y:Ks);let d,A,r,y,b;return this.queue(function(){A=A||this.element(),d=d||zb(a,A),b=new Ks(e?void 0:A),A._addRunner(this),e||A._clearTransformRunnersBefore(this)},function(x){e||this.clearTransform();const{x:B,y:T}=new Vo(d).transform(A._currentTransform(this));let E=new Ks({...a,origin:[B,T]}),R=this._isDeclarative&&r?r:b;if(i){E=E.decompose(B,T),R=R.decompose(B,T);const G=E.rotate,U=R.rotate,Q=[G-360,G,G+360],q=Q.map(pe=>Math.abs(pe-U)),ne=Math.min(...q),re=q.indexOf(ne);E.rotate=Q[re]}e&&(s||(E.rotate=a.rotate||0),this._isDeclarative&&y&&(R.rotate=y)),c.from(R),c.to(E);const P=c.at(x);return y=P.rotate,r=new Ks(P),this.addTransform(r),A._addRunner(this),c.done()},function(x){(x.origin||"center").toString()!==(a.origin||"center").toString()&&(d=zb(x,A)),a={...x,origin:d}},!0),this._isDeclarative&&this._rememberMorpher("transform",c),this},x(a){return this._queueNumber("x",a)},y(a){return this._queueNumber("y",a)},ax(a){return this._queueNumber("ax",a)},ay(a){return this._queueNumber("ay",a)},dx(a=0){return this._queueNumberDelta("x",a)},dy(a=0){return this._queueNumberDelta("y",a)},dmove(a,e){return this.dx(a).dy(e)},_queueNumberDelta(a,e){if(e=new mo(e),this._tryRetarget(a,e))return this;const i=new $p(this._stepper).to(e);let s=null;return this.queue(function(){s=this.element()[a](),i.from(s),i.to(s+e)},function(c){return this.element()[a](i.at(c)),i.done()},function(c){i.to(s+new mo(c))}),this._rememberMorpher(a,i),this},_queueObject(a,e){if(this._tryRetarget(a,e))return this;const i=new $p(this._stepper).to(e);return this.queue(function(){i.from(this.element()[a]())},function(s){return this.element()[a](i.at(s)),i.done()}),this._rememberMorpher(a,i),this},_queueNumber(a,e){return this._queueObject(a,new mo(e))},cx(a){return this._queueNumber("cx",a)},cy(a){return this._queueNumber("cy",a)},move(a,e){return this.x(a).y(e)},amove(a,e){return this.ax(a).ay(e)},center(a,e){return this.cx(a).cy(e)},size(a,e){let i;return a&&e||(i=this._element.bbox()),a||(a=i.width/i.height*e),e||(e=i.height/i.width*a),this.width(a).height(e)},width(a){return this._queueNumber("width",a)},height(a){return this._queueNumber("height",a)},plot(a,e,i,s){if(arguments.length===4)return this.plot([a,e,i,s]);if(this._tryRetarget("plot",a))return this;const c=new $p(this._stepper).type(this._element.MorphArray).to(a);return this.queue(function(){c.from(this._element.array())},function(d){return this._element.plot(c.at(d)),c.done()}),this._rememberMorpher("plot",c),this},leading(a){return this._queueNumber("leading",a)},viewbox(a,e,i,s){return this._queueObject("viewbox",new Ac(a,e,i,s))},update(a){return typeof a!="object"?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(a.opacity!=null&&this.attr("stop-opacity",a.opacity),a.color!=null&&this.attr("stop-color",a.color),a.offset!=null&&this.attr("offset",a.offset),this)}}),jn(zh,{rx:Y1,ry:K1,from:PT,to:kT}),Ao(zh,"Runner");class Xb extends Nh{constructor(e,i=e){super(ea("svg",e),i),this.namespace()}defs(){return this.isRoot()?rd(this.node.querySelector("defs"))||this.put(new o_):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof ho.window.SVGElement)&&this.node.parentNode.nodeName!=="#document-fragment"}namespace(){return this.isRoot()?this.attr({xmlns:Q1,version:"1.1"}).attr("xmlns:xlink",dm,Xx):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,Xx).attr("xmlns:svgjs",null,Xx)}root(){return this.isRoot()?this:super.root()}}Os({Container:{nested:Jo(function(){return this.put(new Xb)})}}),Ao(Xb,"Svg",!0);let Yb=class extends Nh{constructor(a,e=a){super(ea("symbol",a),e)}};Os({Container:{symbol:Jo(function(){return this.put(new Yb)})}}),Ao(Yb,"Symbol");var NT=Object.freeze({__proto__:null,amove:function(a,e){return this.ax(a).ay(e)},ax:function(a){return this.attr("x",a)},ay:function(a){return this.attr("y",a)},build:function(a){return this._build=!!a,this},center:function(a,e,i=this.bbox()){return this.cx(a,i).cy(e,i)},cx:function(a,e=this.bbox()){return a==null?e.cx:this.attr("x",this.attr("x")+a-e.cx)},cy:function(a,e=this.bbox()){return a==null?e.cy:this.attr("y",this.attr("y")+a-e.cy)},length:function(){return this.node.getComputedTextLength()},move:function(a,e,i=this.bbox()){return this.x(a,i).y(e,i)},plain:function(a){return this._build===!1&&this.clear(),this.node.appendChild(ho.document.createTextNode(a)),this},x:function(a,e=this.bbox()){return a==null?e.x:this.attr("x",this.attr("x")+a-e.x)},y:function(a,e=this.bbox()){return a==null?e.y:this.attr("y",this.attr("y")+a-e.y)}});class Gd extends jh{constructor(e,i=e){super(ea("text",e),i),this.dom.leading=this.dom.leading??new mo(1.3),this._rebuild=!0,this._build=!1}leading(e){return e==null?this.dom.leading:(this.dom.leading=new mo(e),this.rebuild())}rebuild(e){if(typeof e=="boolean"&&(this._rebuild=e),this._rebuild){const i=this;let s=0;const c=this.dom.leading;this.each(function(d){if(Nb(this.node))return;const A=ho.window.getComputedStyle(this.node).getPropertyValue("font-size"),r=c*new mo(A);this.dom.newLined&&(this.attr("x",i.attr("x")),this.text()===`
`?s+=r:(this.attr("dy",d?r+s:0),s=0))}),this.fire("rebuild")}return this}setData(e){return this.dom=e,this.dom.leading=new mo(e.leading||1.3),this}writeDataToDom(){return pT(this,this.dom,{leading:1.3}),this}text(e){if(e===void 0){const i=this.node.childNodes;let s=0;e="";for(let c=0,d=i.length;c<d;++c)i[c].nodeName==="textPath"||Nb(i[c])?c===0&&(s=c+1):(c!==s&&i[c].nodeType!==3&&rd(i[c]).dom.newLined===!0&&(e+=`
`),e+=i[c].textContent);return e}if(this.clear().build(!0),typeof e=="function")e.call(this,this);else for(let i=0,s=(e=(e+"").split(`
`)).length;i<s;i++)this.newLine(e[i]);return this.build(!1).rebuild()}}jn(Gd,NT),Os({Container:{text:Jo(function(a=""){return this.put(new Gd).text(a)}),plain:Jo(function(a=""){return this.put(new Gd).plain(a)})}}),Ao(Gd,"Text");class gv extends jh{constructor(e,i=e){super(ea("tspan",e),i),this._build=!1}dx(e){return this.attr("dx",e)}dy(e){return this.attr("dy",e)}newLine(){this.dom.newLined=!0;const e=this.parent();if(!(e instanceof Gd))return this;const i=e.index(this),s=ho.window.getComputedStyle(this.node).getPropertyValue("font-size"),c=e.dom.leading*new mo(s);return this.dy(i?c:0).attr("x",e.x())}text(e){return e==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof e=="function"?(this.clear().build(!0),e.call(this,this),this.build(!1)):this.plain(e),this)}}jn(gv,NT),Os({Tspan:{tspan:Jo(function(a=""){const e=new gv;return this._build||this.clear(),this.put(e).text(a)})},Text:{newLine:function(a=""){return this.tspan(a).newLine()}}}),Ao(gv,"Tspan");class Jx extends jh{constructor(e,i=e){super(ea("circle",e),i)}radius(e){return this.attr("r",e)}rx(e){return this.attr("r",e)}ry(e){return this.rx(e)}size(e){return this.radius(new mo(e).divide(2))}}jn(Jx,{x:ST,y:ET,cx:TT,cy:IT,width:FT,height:LT}),Os({Container:{circle:Jo(function(a=0){return this.put(new Jx).size(a).move(0,0)})}}),Ao(Jx,"Circle");class eb extends Nh{constructor(e,i=e){super(ea("clipPath",e),i)}remove(){return this.targets().forEach(function(e){e.unclip()}),super.remove()}targets(){return vg("svg [clip-path*="+this.id()+"]")}}Os({Container:{clip:Jo(function(){return this.defs().put(new eb)})},Element:{clipper(){return this.reference("clip-path")},clipWith(a){const e=a instanceof eb?a:this.parent().clip().add(a);return this.attr("clip-path","url(#"+e.id()+")")},unclip(){return this.attr("clip-path",null)}}}),Ao(eb,"ClipPath");class $S extends Oc{constructor(e,i=e){super(ea("foreignObject",e),i)}}Os({Container:{foreignObject:Jo(function(a,e){return this.put(new $S).size(a,e)})}}),Ao($S,"ForeignObject");var jT=Object.freeze({__proto__:null,dmove:function(a,e){return this.children().forEach(i=>{let s;try{s=i.node instanceof Ky().SVGSVGElement?new Ac(i.attr(["x","y","width","height"])):i.bbox()}catch{return}const c=new Ks(i),d=c.translate(a,e).transform(c.inverse()),A=new Vo(s.x,s.y).transform(d);i.move(A.x,A.y)}),this},dx:function(a){return this.dmove(a,0)},dy:function(a){return this.dmove(0,a)},height:function(a,e=this.bbox()){return a==null?e.height:this.size(e.width,a,e)},move:function(a=0,e=0,i=this.bbox()){const s=a-i.x,c=e-i.y;return this.dmove(s,c)},size:function(a,e,i=this.bbox()){const s=hm(this,a,e,i),c=s.width/i.width,d=s.height/i.height;return this.children().forEach(A=>{const r=new Vo(i).transform(new Ks(A).inverse());A.scale(c,d,r.x,r.y)}),this},width:function(a,e=this.bbox()){return a==null?e.width:this.size(a,e.height,e)},x:function(a,e=this.bbox()){return a==null?e.x:this.move(a,e.y,e)},y:function(a,e=this.bbox()){return a==null?e.y:this.move(e.x,a,e)}});class gp extends Nh{constructor(e,i=e){super(ea("g",e),i)}}jn(gp,jT),Os({Container:{group:Jo(function(){return this.put(new gp)})}}),Ao(gp,"G");class ev extends Nh{constructor(e,i=e){super(ea("a",e),i)}target(e){return this.attr("target",e)}to(e){return this.attr("href",e,dm)}}jn(ev,jT),Os({Container:{link:Jo(function(a){return this.put(new ev).to(a)})},Element:{unlink(){const a=this.linker();if(!a)return this;const e=a.parent();if(!e)return this.remove();const i=e.index(a);return e.add(this,i),a.remove(),this},linkTo(a){let e=this.linker();return e||(e=new ev,this.wrap(e)),typeof a=="function"?a.call(e,e):e.to(a),this},linker(){const a=this.parent();return a&&a.node.nodeName.toLowerCase()==="a"?a:null}}}),Ao(ev,"A");class tb extends Nh{constructor(e,i=e){super(ea("mask",e),i)}remove(){return this.targets().forEach(function(e){e.unmask()}),super.remove()}targets(){return vg("svg [mask*="+this.id()+"]")}}Os({Container:{mask:Jo(function(){return this.defs().put(new tb)})},Element:{masker(){return this.reference("mask")},maskWith(a){const e=a instanceof tb?a:this.parent().mask().add(a);return this.attr("mask","url(#"+e.id()+")")},unmask(){return this.attr("mask",null)}}}),Ao(tb,"Mask");class ZS extends Oc{constructor(e,i=e){super(ea("stop",e),i)}update(e){return(typeof e=="number"||e instanceof mo)&&(e={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),e.opacity!=null&&this.attr("stop-opacity",e.opacity),e.color!=null&&this.attr("stop-color",e.color),e.offset!=null&&this.attr("offset",new mo(e.offset)),this}}Os({Gradient:{stop:function(a,e,i){return this.put(new ZS).update(a,e,i)}}}),Ao(ZS,"Stop");class ib extends Oc{constructor(e,i=e){super(ea("style",e),i)}addText(e=""){return this.node.textContent+=e,this}font(e,i,s={}){return this.rule("@font-face",{fontFamily:e,src:i,...s})}rule(e,i){return this.addText(function(s,c){if(!s)return"";if(!c)return s;let d=s+"{";for(const A in c)d+=A.replace(/([A-Z])/g,function(r,y){return"-"+y.toLowerCase()})+":"+c[A]+";";return d+="}",d}(e,i))}}Os("Dom",{style(a,e){return this.put(new ib).rule(a,e)},fontface(a,e,i){return this.put(new ib).font(a,e,i)}}),Ao(ib,"Style");class rb extends Gd{constructor(e,i=e){super(ea("textPath",e),i)}array(){const e=this.track();return e?e.array():null}plot(e){const i=this.track();let s=null;return i&&(s=i.plot(e)),e==null?s:this}track(){return this.reference("href")}}Os({Container:{textPath:Jo(function(a,e){return a instanceof Gd||(a=this.text(a)),a.path(e)})},Text:{path:Jo(function(a,e=!0){const i=new rb;let s;if(a instanceof tm||(a=this.defs().path(a)),i.attr("href","#"+a,dm),e)for(;s=this.node.firstChild;)i.node.appendChild(s);return this.put(i)}),textPath(){return this.findOne("textPath")}},Path:{text:Jo(function(a){return a instanceof Gd||(a=new Gd().addTo(this.parent()).text(a)),a.path(this)}),targets(){return vg("svg textPath").filter(a=>(a.attr("href")||"").includes(this.id()))}}}),rb.prototype.MorphArray=Vd,Ao(rb,"TextPath");class JS extends jh{constructor(e,i=e){super(ea("use",e),i)}use(e,i){return this.attr("href",(i||"")+"#"+e,dm)}}Os({Container:{use:Jo(function(a,e){return this.put(new JS).use(a,e)})}}),Ao(JS,"Use");const kR=Pu;jn([Xb,Yb,Av,ky,fv],ih("viewbox")),jn([ig,ng,rg,tm],ih("marker")),jn(Gd,ih("Text")),jn(tm,ih("Path")),jn(o_,ih("Defs")),jn([Gd,gv],ih("Tspan")),jn([pv,dv,yy,zh],ih("radius")),jn(qy,ih("EventTarget")),jn(om,ih("Dom")),jn(Oc,ih("Element")),jn(jh,ih("Shape")),jn([Nh,MT],ih("Container")),jn(yy,ih("Gradient")),jn(zh,ih("Runner")),pg.extend([...new Set(AT)]),function(a=[]){Wb.push(...[].concat(a))}([mo,GA,Ac,Ks,gg,wp,Vd,Vo]),jn(Wb,{to(a){return new $p().type(this.constructor).from(this.toArray()).to(a)},fromArray(a){return this.init(a),this},toConsumable(){return this.toArray()},morph(a,e,i,s,c){return this.fromArray(a.map(function(d,A){return s.step(d,e[A],i,c[A],c)}))}});class ba extends Oc{constructor(e){super(ea("filter",e),e),this.$source="SourceGraphic",this.$sourceAlpha="SourceAlpha",this.$background="BackgroundImage",this.$backgroundAlpha="BackgroundAlpha",this.$fill="FillPaint",this.$stroke="StrokePaint",this.$autoSetIn=!0}put(e,i){return!(e=super.put(e,i)).attr("in")&&this.$autoSetIn&&e.attr("in",this.$source),e.attr("result")||e.attr("result",e.id()),e}remove(){return this.targets().each("unfilter"),super.remove()}targets(){return vg('svg [filter*="'+this.id()+'"]')}toString(){return"url(#"+this.id()+")"}}class Z1 extends Oc{constructor(e,i){super(e,i),this.result(this.id())}in(e){if(e==null){const i=this.attr("in");return this.parent()&&this.parent().find(`[result="${i}"]`)[0]||i}return this.attr("in",e)}result(e){return this.attr("result",e)}toString(){return this.result()}}const id=a=>function(...e){for(let i=a.length;i--;)e[i]!=null&&this.attr(a[i],e[i])},RR={blend:id(["in","in2","mode"]),colorMatrix:id(["type","values"]),composite:id(["in","in2","operator"]),convolveMatrix:function(a){a=new gg(a).toString(),this.attr({order:Math.sqrt(a.split(" ").length),kernelMatrix:a})},diffuseLighting:id(["surfaceScale","lightingColor","diffuseConstant","kernelUnitLength"]),displacementMap:id(["in","in2","scale","xChannelSelector","yChannelSelector"]),dropShadow:id(["in","dx","dy","stdDeviation"]),flood:id(["flood-color","flood-opacity"]),gaussianBlur:function(a=0,e=a){this.attr("stdDeviation",a+" "+e)},image:function(a){this.attr("href",a,dm)},morphology:id(["operator","radius"]),offset:id(["dx","dy"]),specularLighting:id(["surfaceScale","lightingColor","diffuseConstant","specularExponent","kernelUnitLength"]),tile:id([]),turbulence:id(["baseFrequency","numOctaves","seed","stitchTiles","type"])};["blend","colorMatrix","componentTransfer","composite","convolveMatrix","diffuseLighting","displacementMap","dropShadow","flood","gaussianBlur","image","merge","morphology","offset","specularLighting","tile","turbulence"].forEach(a=>{const e=um(a),i=RR[a];ba[e+"Effect"]=class extends Z1{constructor(s){super(ea("fe"+e,s),s)}update(s){return i.apply(this,s),this}},ba.prototype[a]=Jo(function(s,...c){const d=new ba[e+"Effect"];return s==null?this.put(d):(typeof s=="function"?s.call(d,d):c.unshift(s),this.put(d).update(c))})}),jn(ba,{merge(a){const e=this.put(new ba.MergeEffect);return typeof a=="function"?(a.call(e,e),e):((a instanceof Array?a:[...arguments]).forEach(i=>{i instanceof ba.MergeNode?e.put(i):e.mergeNode(i)}),e)},componentTransfer(a={}){const e=this.put(new ba.ComponentTransferEffect);if(typeof a=="function")return a.call(e,e),e;a.r||a.g||a.b||a.a||(a={r:a,g:a,b:a,a});for(const i in a)e.add(new ba["Func"+i.toUpperCase()](a[i]));return e}});["distantLight","pointLight","spotLight","mergeNode","FuncR","FuncG","FuncB","FuncA"].forEach(a=>{const e=um(a);ba[e]=class extends Z1{constructor(i){super(ea("fe"+e,i),i)}}});["funcR","funcG","funcB","funcA"].forEach(function(a){const e=ba[um(a)],i=Jo(function(){return this.put(new e)});ba.ComponentTransferEffect.prototype[a]=i});["distantLight","pointLight","spotLight"].forEach(a=>{const e=ba[um(a)],i=Jo(function(){return this.put(new e)});ba.DiffuseLightingEffect.prototype[a]=i,ba.SpecularLightingEffect.prototype[a]=i}),jn(ba.MergeEffect,{mergeNode(a){return this.put(new ba.MergeNode).attr("in",a)}}),jn(o_,{filter:function(a){const e=this.put(new ba);return typeof a=="function"&&a.call(e,e),e}}),jn(Nh,{filter:function(a){return this.defs().filter(a)}}),jn(Oc,{filterWith:function(a){const e=a instanceof ba?a:this.defs().filter(a);return this.attr("filter",e)},unfilter:function(a){return this.attr("filter",null)},filterer(){return this.reference("filter")}});const DR={blend:function(a,e){return this.parent()&&this.parent().blend(this,a,e)},colorMatrix:function(a,e){return this.parent()&&this.parent().colorMatrix(a,e).in(this)},componentTransfer:function(a){return this.parent()&&this.parent().componentTransfer(a).in(this)},composite:function(a,e){return this.parent()&&this.parent().composite(this,a,e)},convolveMatrix:function(a){return this.parent()&&this.parent().convolveMatrix(a).in(this)},diffuseLighting:function(a,e,i,s){return this.parent()&&this.parent().diffuseLighting(a,i,s).in(this)},displacementMap:function(a,e,i,s){return this.parent()&&this.parent().displacementMap(this,a,e,i,s)},dropShadow:function(a,e,i){return this.parent()&&this.parent().dropShadow(this,a,e,i).in(this)},flood:function(a,e){return this.parent()&&this.parent().flood(a,e)},gaussianBlur:function(a,e){return this.parent()&&this.parent().gaussianBlur(a,e).in(this)},image:function(a){return this.parent()&&this.parent().image(a)},merge:function(a){return a=a instanceof Array?a:[...a],this.parent()&&this.parent().merge(this,...a)},morphology:function(a,e){return this.parent()&&this.parent().morphology(a,e).in(this)},offset:function(a,e){return this.parent()&&this.parent().offset(a,e).in(this)},specularLighting:function(a,e,i,s,c){return this.parent()&&this.parent().specularLighting(a,i,s,c).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(a,e,i,s,c){return this.parent()&&this.parent().turbulence(a,e,i,s,c).in(this)}};jn(Z1,DR),jn(ba.MergeEffect,{in:function(a){return a instanceof ba.MergeNode?this.add(a,0):this.add(new ba.MergeNode().in(a),0),this}}),jn([ba.CompositeEffect,ba.BlendEffect,ba.DisplacementMapEffect],{in2:function(a){if(a==null){const e=this.attr("in2");return this.parent()&&this.parent().find(`[result="${e}"]`)[0]||e}return this.attr("in2",a)}}),ba.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]};var Rc=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getDefaultFilter",value:function(e,i){var s=this.w;e.unfilter(!0),new ba().size("120%","180%","-5%","-40%"),s.config.chart.dropShadow.enabled&&this.dropShadow(e,s.config.chart.dropShadow,i)}},{key:"applyFilter",value:function(e,i,s){var c,d=this,A=this.w;if(e.unfilter(!0),s!=="none"){var r,y,b=A.config.chart.dropShadow,x=s==="lighten"?2:.3;e.filterWith(function(B){B.colorMatrix({type:"matrix",values:`
          `.concat(x,` 0 0 0 0
          0 `).concat(x,` 0 0 0
          0 0 `).concat(x,` 0 0
          0 0 0 1 0
        `),in:"SourceGraphic",result:"brightness"}),b.enabled&&d.addShadow(B,i,b,"brightness")}),!b.noUserSpaceOnUse&&((r=e.filterer())===null||r===void 0||(y=r.node)===null||y===void 0||y.setAttribute("filterUnits","userSpaceOnUse")),this._scaleFilterSize((c=e.filterer())===null||c===void 0?void 0:c.node)}else this.getDefaultFilter(e,i)}},{key:"addShadow",value:function(e,i,s,c){var d,A=this.w,r=s.blur,y=s.top,b=s.left,x=s.color,B=s.opacity;if(x=Array.isArray(x)?x[i]:x,((d=A.config.chart.dropShadow.enabledOnSeries)===null||d===void 0?void 0:d.length)>0&&A.config.chart.dropShadow.enabledOnSeries.indexOf(i)===-1)return e;e.offset({in:c,dx:b,dy:y,result:"offset"}),e.gaussianBlur({in:"offset",stdDeviation:r,result:"blur"}),e.flood({"flood-color":x,"flood-opacity":B,result:"flood"}),e.composite({in:"flood",in2:"blur",operator:"in",result:"shadow"}),e.merge(["shadow",c])}},{key:"dropShadow",value:function(e,i){var s,c,d,A,r,y=this,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=this.w;return e.unfilter(!0),ni.isMsEdge()&&x.config.chart.type==="radialBar"||((s=x.config.chart.dropShadow.enabledOnSeries)===null||s===void 0?void 0:s.length)>0&&((d=x.config.chart.dropShadow.enabledOnSeries)===null||d===void 0?void 0:d.indexOf(b))===-1?e:(e.filterWith(function(B){y.addShadow(B,b,i,"SourceGraphic")}),i.noUserSpaceOnUse||(A=e.filterer())===null||A===void 0||(r=A.node)===null||r===void 0||r.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize((c=e.filterer())===null||c===void 0?void 0:c.node),e)}},{key:"setSelectionFilter",value:function(e,i,s){var c=this.w;if(c.globals.selectedDataPoints[i]!==void 0&&c.globals.selectedDataPoints[i].indexOf(s)>-1){e.node.setAttribute("selected",!0);var d=c.config.states.active.filter;d!=="none"&&this.applyFilter(e,i,d.type)}}},{key:"_scaleFilterSize",value:function(e){e&&function(i){for(var s in i)i.hasOwnProperty(s)&&e.setAttribute(s,i[s])}({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}]),a}(),ur=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"roundPathCorners",value:function(e,i){function s(he,be,Se){var oe=be.x-he.x,ye=be.y-he.y,Me=Math.sqrt(oe*oe+ye*ye);return c(he,be,Math.min(1,Se/Me))}function c(he,be,Se){return{x:he.x+(be.x-he.x)*Se,y:he.y+(be.y-he.y)*Se}}function d(he,be){he.length>2&&(he[he.length-2]=be.x,he[he.length-1]=be.y)}function A(he){return{x:parseFloat(he[he.length-2]),y:parseFloat(he[he.length-1])}}e.indexOf("NaN")>-1&&(e="");var r=e.split(/[,\s]/).reduce(function(he,be){var Se=be.match(/^([a-zA-Z])(.+)/);return Se?(he.push(Se[1]),he.push(Se[2])):he.push(be),he},[]).reduce(function(he,be){return parseFloat(be)==be&&he.length?he[he.length-1].push(be):he.push([be]),he},[]),y=[];if(r.length>1){var b=A(r[0]),x=null;r[r.length-1][0]=="Z"&&r[0].length>2&&(x=["L",b.x,b.y],r[r.length-1]=x),y.push(r[0]);for(var B=1;B<r.length;B++){var T=y[y.length-1],E=r[B],R=E==x?r[1]:r[B+1];if(R&&T&&T.length>2&&E[0]=="L"&&R.length>2&&R[0]=="L"){var P,G,U=A(T),Q=A(E),q=A(R);P=s(Q,U,i),G=s(Q,q,i),d(E,P),E.origPoint=Q,y.push(E);var ne=c(P,Q,.5),re=c(Q,G,.5),pe=["C",ne.x,ne.y,re.x,re.y,G.x,G.y];pe.origPoint=Q,y.push(pe)}else y.push(E)}if(x){var fe=A(y[y.length-1]);y.push(["Z"]),d(y[0],fe)}}else y=r;return y.reduce(function(he,be){return he+be.join(" ")+" "},"")}},{key:"drawLine",value:function(e,i,s,c){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"#a8a8a8",A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"butt";return this.w.globals.dom.Paper.line().attr({x1:e,y1:i,x2:s,y2:c,stroke:d,"stroke-dasharray":A,"stroke-width":r,"stroke-linecap":y})}},{key:"drawRect",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"#fefefe",r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,b=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,x=arguments.length>9&&arguments[9]!==void 0?arguments[9]:0,B=this.w.globals.dom.Paper.rect();return B.attr({x:e,y:i,width:s>0?s:0,height:c>0?c:0,rx:d,ry:d,opacity:r,"stroke-width":y!==null?y:0,stroke:b!==null?b:"none","stroke-dasharray":x}),B.node.setAttribute("fill",A),B}},{key:"drawPolygon",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#e1e1e1",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none";return this.w.globals.dom.Paper.polygon(e).attr({fill:c,stroke:i,"stroke-width":s})}},{key:"drawCircle",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e<0&&(e=0);var s=this.w.globals.dom.Paper.circle(2*e);return i!==null&&s.attr(i),s}},{key:"drawPath",value:function(e){var i=e.d,s=i===void 0?"":i,c=e.stroke,d=c===void 0?"#a8a8a8":c,A=e.strokeWidth,r=A===void 0?1:A,y=e.fill,b=e.fillOpacity,x=b===void 0?1:b,B=e.strokeOpacity,T=B===void 0?1:B,E=e.classes,R=e.strokeLinecap,P=R===void 0?null:R,G=e.strokeDashArray,U=G===void 0?0:G,Q=this.w;return P===null&&(P=Q.config.stroke.lineCap),(s.indexOf("undefined")>-1||s.indexOf("NaN")>-1)&&(s="M 0 ".concat(Q.globals.gridHeight)),Q.globals.dom.Paper.path(s).attr({fill:y,"fill-opacity":x,stroke:d,"stroke-opacity":T,"stroke-linecap":P,"stroke-width":r,"stroke-dasharray":U,class:E})}},{key:"group",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.w.globals.dom.Paper.group();return e!==null&&i.attr(e),i}},{key:"move",value:function(e,i){var s=["M",e,i].join(" ");return s}},{key:"line",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=null;return s===null?c=[" L",e,i].join(" "):s==="H"?c=[" H",e].join(" "):s==="V"&&(c=[" V",i].join(" ")),c}},{key:"curve",value:function(e,i,s,c,d,A){var r=["C",e,i,s,c,d,A].join(" ");return r}},{key:"quadraticCurve",value:function(e,i,s,c){return["Q",e,i,s,c].join(" ")}},{key:"arc",value:function(e,i,s,c,d,A,r){var y="A";arguments.length>7&&arguments[7]!==void 0&&arguments[7]&&(y="a");var b=[y,e,i,s,c,d,A,r].join(" ");return b}},{key:"renderPaths",value:function(e){var i,s=e.j,c=e.realIndex,d=e.pathFrom,A=e.pathTo,r=e.stroke,y=e.strokeWidth,b=e.strokeLinecap,x=e.fill,B=e.animationDelay,T=e.initialSpeed,E=e.dataChangeSpeed,R=e.className,P=e.chartType,G=e.shouldClipToGrid,U=G===void 0||G,Q=e.bindEventsOnPaths,q=Q===void 0||Q,ne=e.drawShadow,re=ne===void 0||ne,pe=this.w,fe=new Rc(this.ctx),he=new cm(this.ctx),be=this.w.config.chart.animations.enabled,Se=be&&this.w.config.chart.animations.dynamicAnimation.enabled;if(d&&d.startsWith("M 0 0")&&A){var oe=A.match(/^M\s+[\d.-]+\s+[\d.-]+/);oe&&(d=d.replace(/^M\s+0\s+0/,oe[0]))}var ye=!!(be&&!pe.globals.resized||Se&&pe.globals.dataChanged&&pe.globals.shouldAnimate);ye?i=d:(i=A,pe.globals.animationEnded=!0);var Me=pe.config.stroke.dashArray,Be=0;Be=Array.isArray(Me)?Me[c]:pe.config.stroke.dashArray;var Pe=this.drawPath({d:i,stroke:r,strokeWidth:y,fill:x,fillOpacity:1,classes:R,strokeLinecap:b,strokeDashArray:Be});Pe.attr("index",c),U&&(P==="bar"&&!pe.globals.isHorizontal||pe.globals.comboCharts?Pe.attr({"clip-path":"url(#gridRectBarMask".concat(pe.globals.cuid,")")}):Pe.attr({"clip-path":"url(#gridRectMask".concat(pe.globals.cuid,")")})),pe.config.chart.dropShadow.enabled&&re&&fe.dropShadow(Pe,pe.config.chart.dropShadow,c),q&&(Pe.node.addEventListener("mouseenter",this.pathMouseEnter.bind(this,Pe)),Pe.node.addEventListener("mouseleave",this.pathMouseLeave.bind(this,Pe)),Pe.node.addEventListener("mousedown",this.pathMouseDown.bind(this,Pe))),Pe.attr({pathTo:A,pathFrom:d});var De={el:Pe,j:s,realIndex:c,pathFrom:d,pathTo:A,fill:x,strokeWidth:y,delay:B};return!be||pe.globals.resized||pe.globals.dataChanged?!pe.globals.resized&&pe.globals.dataChanged||he.showDelayedElements():he.animatePathsGradually(Tr(Tr({},De),{},{speed:T})),pe.globals.dataChanged&&Se&&ye&&he.animatePathsGradually(Tr(Tr({},De),{},{speed:E})),Pe}},{key:"drawPattern",value:function(e,i,s){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"#a8a8a8",d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;return this.w.globals.dom.Paper.pattern(i,s,function(A){e==="horizontalLines"?A.line(0,0,s,0).stroke({color:c,width:d+1}):e==="verticalLines"?A.line(0,0,0,i).stroke({color:c,width:d+1}):e==="slantedLines"?A.line(0,0,i,s).stroke({color:c,width:d}):e==="squares"?A.rect(i,s).fill("none").stroke({color:c,width:d}):e==="circles"&&A.circle(i).fill("none").stroke({color:c,width:d})})}},{key:"drawGradient",value:function(e,i,s,c,d){var A,r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,b=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],x=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0,B=this.w;i.length<9&&i.indexOf("#")===0&&(i=ni.hexToRgba(i,c)),s.length<9&&s.indexOf("#")===0&&(s=ni.hexToRgba(s,d));var T=0,E=1,R=1,P=null;y!==null&&(T=y[0]!==void 0?y[0]/100:0,E=y[1]!==void 0?y[1]/100:1,R=y[2]!==void 0?y[2]/100:1,P=y[3]!==void 0?y[3]/100:null);var G=!(B.config.chart.type!=="donut"&&B.config.chart.type!=="pie"&&B.config.chart.type!=="polarArea"&&B.config.chart.type!=="bubble");if(A=b&&b.length!==0?B.globals.dom.Paper.gradient(G?"radial":"linear",function(q){(Array.isArray(b[x])?b[x]:b).forEach(function(ne){q.stop(ne.offset/100,ne.color,ne.opacity)})}):B.globals.dom.Paper.gradient(G?"radial":"linear",function(q){q.stop(T,i,c),q.stop(E,s,d),q.stop(R,s,d),P!==null&&q.stop(P,i,c)}),G){var U=B.globals.gridWidth/2,Q=B.globals.gridHeight/2;B.config.chart.type!=="bubble"?A.attr({gradientUnits:"userSpaceOnUse",cx:U,cy:Q,r}):A.attr({cx:.5,cy:.5,r:.8,fx:.2,fy:.2})}else e==="vertical"?A.from(0,0).to(0,1):e==="diagonal"?A.from(0,0).to(1,1):e==="horizontal"?A.from(0,1).to(1,1):e==="diagonal2"&&A.from(1,0).to(0,1);return A}},{key:"getTextBasedOnMaxWidth",value:function(e){var i=e.text,s=e.maxWidth,c=e.fontSize,d=e.fontFamily,A=this.getTextRects(i,c,d),r=A.width/i.length,y=Math.floor(s/r);return s<A.width?i.slice(0,y-3)+"...":i}},{key:"drawText",value:function(e){var i=this,s=e.x,c=e.y,d=e.text,A=e.textAnchor,r=e.fontSize,y=e.fontFamily,b=e.fontWeight,x=e.foreColor,B=e.opacity,T=e.maxWidth,E=e.cssClass,R=E===void 0?"":E,P=e.isPlainText,G=P===void 0||P,U=e.dominantBaseline,Q=U===void 0?"auto":U,q=this.w;d===void 0&&(d="");var ne=d;A||(A="start"),x&&x.length||(x=q.config.chart.foreColor),y=y||q.config.chart.fontFamily,b=b||"regular";var re,pe={maxWidth:T,fontSize:r=r||"11px",fontFamily:y};return Array.isArray(d)?re=q.globals.dom.Paper.text(function(fe){for(var he=0;he<d.length;he++)ne=d[he],T&&(ne=i.getTextBasedOnMaxWidth(Tr({text:d[he]},pe))),he===0?fe.tspan(ne):fe.tspan(ne).newLine()}):(T&&(ne=this.getTextBasedOnMaxWidth(Tr({text:d},pe))),re=G?q.globals.dom.Paper.plain(d):q.globals.dom.Paper.text(function(fe){return fe.tspan(ne)})),re.attr({x:s,y:c,"text-anchor":A,"dominant-baseline":Q,"font-size":r,"font-family":y,"font-weight":b,fill:x,class:"apexcharts-text "+R}),re.node.style.fontFamily=y,re.node.style.opacity=B,re}},{key:"getMarkerPath",value:function(e,i,s,c){var d="";switch(s){case"cross":d="M ".concat(e-(c/=1.4)," ").concat(i-c," L ").concat(e+c," ").concat(i+c,"  M ").concat(e-c," ").concat(i+c," L ").concat(e+c," ").concat(i-c);break;case"plus":d="M ".concat(e-(c/=1.12)," ").concat(i," L ").concat(e+c," ").concat(i,"  M ").concat(e," ").concat(i-c," L ").concat(e," ").concat(i+c);break;case"star":case"sparkle":var A=5;c*=1.15,s==="sparkle"&&(c/=1.1,A=4);for(var r=Math.PI/A,y=0;y<=2*A;y++){var b=y*r,x=y%2==0?c:c/2;d+=(y===0?"M":"L")+(e+x*Math.sin(b))+","+(i-x*Math.cos(b))}d+="Z";break;case"triangle":d="M ".concat(e," ").concat(i-c,` 
             L `).concat(e+c," ").concat(i+c,` 
             L `).concat(e-c," ").concat(i+c,` 
             Z`);break;case"square":case"rect":d="M ".concat(e-(c/=1.125)," ").concat(i-c,` 
           L `).concat(e+c," ").concat(i-c,` 
           L `).concat(e+c," ").concat(i+c,` 
           L `).concat(e-c," ").concat(i+c,` 
           Z`);break;case"diamond":c*=1.05,d="M ".concat(e," ").concat(i-c,` 
             L `).concat(e+c," ").concat(i,` 
             L `).concat(e," ").concat(i+c,` 
             L `).concat(e-c," ").concat(i,` 
            Z`);break;case"line":d="M ".concat(e-(c/=1.1)," ").concat(i,` 
           L `).concat(e+c," ").concat(i);break;default:c*=2,d="M ".concat(e,", ").concat(i,` 
           m -`).concat(c/2,`, 0 
           a `).concat(c/2,",").concat(c/2," 0 1,0 ").concat(c,`,0 
           a `).concat(c/2,",").concat(c/2," 0 1,0 -").concat(c,",0")}return d}},{key:"drawMarkerShape",value:function(e,i,s,c,d){var A=this.drawPath({d:this.getMarkerPath(e,i,s,c,d),stroke:d.pointStrokeColor,strokeDashArray:d.pointStrokeDashArray,strokeWidth:d.pointStrokeWidth,fill:d.pointFillColor,fillOpacity:d.pointFillOpacity,strokeOpacity:d.pointStrokeOpacity});return A.attr({cx:e,cy:i,shape:d.shape,class:d.class?d.class:""}),A}},{key:"drawMarker",value:function(e,i,s){e=e||0;var c=s.pSize||0;return ni.isNumber(i)||(c=0,i=0),this.drawMarkerShape(e,i,s==null?void 0:s.shape,c,Tr(Tr({},s),s.shape==="line"||s.shape==="plus"||s.shape==="cross"?{pointStrokeColor:s.pointFillColor,pointStrokeOpacity:s.pointFillOpacity}:{}))}},{key:"pathMouseEnter",value:function(e,i){var s=this.w,c=new Rc(this.ctx),d=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10);if(typeof s.config.chart.events.dataPointMouseEnter=="function"&&s.config.chart.events.dataPointMouseEnter(i,this.ctx,{seriesIndex:d,dataPointIndex:A,w:s}),this.ctx.events.fireEvent("dataPointMouseEnter",[i,this.ctx,{seriesIndex:d,dataPointIndex:A,w:s}]),(s.config.states.active.filter.type==="none"||e.node.getAttribute("selected")!=="true")&&s.config.states.hover.filter.type!=="none"&&!s.globals.isTouchDevice){var r=s.config.states.hover.filter;c.applyFilter(e,d,r.type)}}},{key:"pathMouseLeave",value:function(e,i){var s=this.w,c=new Rc(this.ctx),d=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10);typeof s.config.chart.events.dataPointMouseLeave=="function"&&s.config.chart.events.dataPointMouseLeave(i,this.ctx,{seriesIndex:d,dataPointIndex:A,w:s}),this.ctx.events.fireEvent("dataPointMouseLeave",[i,this.ctx,{seriesIndex:d,dataPointIndex:A,w:s}]),s.config.states.active.filter.type!=="none"&&e.node.getAttribute("selected")==="true"||s.config.states.hover.filter.type!=="none"&&c.getDefaultFilter(e,d)}},{key:"pathMouseDown",value:function(e,i){var s=this.w,c=new Rc(this.ctx),d=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10),r="false";if(e.node.getAttribute("selected")==="true"){if(e.node.setAttribute("selected","false"),s.globals.selectedDataPoints[d].indexOf(A)>-1){var y=s.globals.selectedDataPoints[d].indexOf(A);s.globals.selectedDataPoints[d].splice(y,1)}}else{if(!s.config.states.active.allowMultipleDataPointsSelection&&s.globals.selectedDataPoints.length>0){s.globals.selectedDataPoints=[];var b=s.globals.dom.Paper.find(".apexcharts-series path:not(.apexcharts-decoration-element)"),x=s.globals.dom.Paper.find(".apexcharts-series circle:not(.apexcharts-decoration-element), .apexcharts-series rect:not(.apexcharts-decoration-element)"),B=function(R){Array.prototype.forEach.call(R,function(P){P.node.setAttribute("selected","false"),c.getDefaultFilter(P,d)})};B(b),B(x)}e.node.setAttribute("selected","true"),r="true",s.globals.selectedDataPoints[d]===void 0&&(s.globals.selectedDataPoints[d]=[]),s.globals.selectedDataPoints[d].push(A)}if(r==="true"){var T=s.config.states.active.filter;if(T!=="none")c.applyFilter(e,d,T.type);else if(s.config.states.hover.filter!=="none"&&!s.globals.isTouchDevice){var E=s.config.states.hover.filter;c.applyFilter(e,d,E.type)}}else s.config.states.active.filter.type!=="none"&&(s.config.states.hover.filter.type==="none"||s.globals.isTouchDevice?c.getDefaultFilter(e,d):(E=s.config.states.hover.filter,c.applyFilter(e,d,E.type)));typeof s.config.chart.events.dataPointSelection=="function"&&s.config.chart.events.dataPointSelection(i,this.ctx,{selectedDataPoints:s.globals.selectedDataPoints,seriesIndex:d,dataPointIndex:A,w:s}),i&&this.ctx.events.fireEvent("dataPointSelection",[i,this.ctx,{selectedDataPoints:s.globals.selectedDataPoints,seriesIndex:d,dataPointIndex:A,w:s}])}},{key:"rotateAroundCenter",value:function(e){var i={};return e&&typeof e.getBBox=="function"&&(i=e.getBBox()),{x:i.x+i.width/2,y:i.y+i.height/2}}},{key:"getTextRects",value:function(e,i,s,c){var d=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],A=this.w,r=this.drawText({x:-200,y:-200,text:e,textAnchor:"start",fontSize:i,fontFamily:s,foreColor:"#fff",opacity:0});c&&r.attr("transform",c),A.globals.dom.Paper.add(r);var y=r.bbox();return d||(y=r.node.getBoundingClientRect()),r.remove(),{width:y.width,height:y.height}}},{key:"placeTextWithEllipsis",value:function(e,i,s){if(typeof e.getComputedTextLength=="function"&&(e.textContent=i,i.length>0&&e.getComputedTextLength()>=s/1.1)){for(var c=i.length-3;c>0;c-=3)if(e.getSubStringLength(0,c)<=s/1.1)return void(e.textContent=i.substring(0,c)+"...");e.textContent="."}}}],[{key:"setAttrs",value:function(e,i){for(var s in i)i.hasOwnProperty(s)&&e.setAttribute(s,i[s])}}]),a}(),nl=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getStackedSeriesTotals",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=this.w,s=[];if(i.globals.series.length===0)return s;for(var c=0;c<i.globals.series[i.globals.maxValsInArrayIndex].length;c++){for(var d=0,A=0;A<i.globals.series.length;A++)i.globals.series[A][c]!==void 0&&e.indexOf(A)===-1&&(d+=i.globals.series[A][c]);s.push(d)}return s}},{key:"getSeriesTotalByIndex",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null?this.w.config.series.reduce(function(i,s){return i+s},0):this.w.globals.series[e].reduce(function(i,s){return i+s},0)}},{key:"getStackedSeriesTotalsByGroups",value:function(){var e=this,i=this.w,s=[];return i.globals.seriesGroups.forEach(function(c){var d=[];i.config.series.forEach(function(r,y){c.indexOf(i.globals.seriesNames[y])>-1&&d.push(y)});var A=i.globals.series.map(function(r,y){return d.indexOf(y)===-1?y:-1}).filter(function(r){return r!==-1});s.push(e.getStackedSeriesTotals(A))}),s}},{key:"setSeriesYAxisMappings",value:function(){var e=this.w.globals,i=this.w.config,s=[],c=[],d=[],A=e.series.length>i.yaxis.length||i.yaxis.some(function(B){return Array.isArray(B.seriesName)});i.series.forEach(function(B,T){d.push(T),c.push(null)}),i.yaxis.forEach(function(B,T){s[T]=[]});var r=[];i.yaxis.forEach(function(B,T){var E=!1;if(B.seriesName){var R=[];Array.isArray(B.seriesName)?R=B.seriesName:R.push(B.seriesName),R.forEach(function(P){i.series.forEach(function(G,U){if(G.name===P){var Q=U;T===U||A?!A||d.indexOf(U)>-1?s[T].push([T,U]):console.warn("Series '"+G.name+"' referenced more than once in what looks like the new style. That is, when using either seriesName: [], or when there are more series than yaxes."):(s[U].push([U,T]),Q=T),E=!0,(Q=d.indexOf(Q))!==-1&&d.splice(Q,1)}})})}E||r.push(T)}),s=s.map(function(B,T){var E=[];return B.forEach(function(R){c[R[1]]=R[0],E.push(R[1])}),E});for(var y=i.yaxis.length-1,b=0;b<r.length&&(y=r[b],s[y]=[],d);b++){var x=d[0];d.shift(),s[y].push(x),c[x]=y}d.forEach(function(B){s[y].push(B),c[B]=y}),e.seriesYAxisMap=s.map(function(B){return B}),e.seriesYAxisReverseMap=c.map(function(B){return B}),e.seriesYAxisMap.forEach(function(B,T){B.forEach(function(E){i.series[E]&&i.series[E].group===void 0&&(i.series[E].group="apexcharts-axis-".concat(T.toString()))})})}},{key:"isSeriesNull",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return(e===null?this.w.config.series.filter(function(i){return i!==null}):this.w.config.series[e].data.filter(function(i){return i!==null})).length===0}},{key:"seriesHaveSameValues",value:function(e){return this.w.globals.series[e].every(function(i,s,c){return i===c[0]})}},{key:"getCategoryLabels",value:function(e){var i=this.w,s=e.slice();return i.config.xaxis.convertedCatToNumeric&&(s=e.map(function(c,d){return i.config.xaxis.labels.formatter(c-i.globals.minX+1)})),s}},{key:"getLargestSeries",value:function(){var e=this.w;e.globals.maxValsInArrayIndex=e.globals.series.map(function(i){return i.length}).indexOf(Math.max.apply(Math,e.globals.series.map(function(i){return i.length})))}},{key:"getLargestMarkerSize",value:function(){var e=this.w,i=0;return e.globals.markers.size.forEach(function(s){i=Math.max(i,s)}),e.config.markers.discrete&&e.config.markers.discrete.length&&e.config.markers.discrete.forEach(function(s){i=Math.max(i,s.size)}),i>0&&(e.config.markers.hover.size>0?i=e.config.markers.hover.size:i+=e.config.markers.hover.sizeOffset),e.globals.markers.largestSize=i,i}},{key:"getSeriesTotals",value:function(){var e=this.w;e.globals.seriesTotals=e.globals.series.map(function(i,s){var c=0;if(Array.isArray(i))for(var d=0;d<i.length;d++)c+=i[d];else c+=i;return c})}},{key:"getSeriesTotalsXRange",value:function(e,i){var s=this.w;return s.globals.series.map(function(c,d){for(var A=0,r=0;r<c.length;r++)s.globals.seriesX[d][r]>e&&s.globals.seriesX[d][r]<i&&(A+=c[r]);return A})}},{key:"getPercentSeries",value:function(){var e=this.w;e.globals.seriesPercent=e.globals.series.map(function(i,s){var c=[];if(Array.isArray(i))for(var d=0;d<i.length;d++){var A=e.globals.stackedSeriesTotals[d],r=0;A&&(r=100*i[d]/A),c.push(r)}else{var y=100*i/e.globals.seriesTotals.reduce(function(b,x){return b+x},0);c.push(y)}return c})}},{key:"getCalculatedRatios",value:function(){var e,i,s,c=this,d=this.w,A=d.globals,r=[],y=0,b=[],x=.1,B=0;if(A.yRange=[],A.isMultipleYAxis)for(var T=0;T<A.minYArr.length;T++)A.yRange.push(Math.abs(A.minYArr[T]-A.maxYArr[T])),b.push(0);else A.yRange.push(Math.abs(A.minY-A.maxY));A.xRange=Math.abs(A.maxX-A.minX),A.zRange=Math.abs(A.maxZ-A.minZ);for(var E=0;E<A.yRange.length;E++)r.push(A.yRange[E]/A.gridHeight);if(i=A.xRange/A.gridWidth,e=A.yRange/A.gridWidth,s=A.xRange/A.gridHeight,(y=A.zRange/A.gridHeight*16)||(y=1),A.minY!==Number.MIN_VALUE&&Math.abs(A.minY)!==0&&(A.hasNegs=!0),d.globals.seriesYAxisReverseMap.length>0){var R=function(G,U){var Q=d.config.yaxis[d.globals.seriesYAxisReverseMap[U]],q=G<0?-1:1;return G=Math.abs(G),Q.logarithmic&&(G=c.getBaseLog(Q.logBase,G)),-q*G/r[U]};if(A.isMultipleYAxis){b=[];for(var P=0;P<r.length;P++)b.push(R(A.minYArr[P],P))}else(b=[]).push(R(A.minY,0)),A.minY!==Number.MIN_VALUE&&Math.abs(A.minY)!==0&&(x=-A.minY/e,B=A.minX/i)}else(b=[]).push(0),x=0,B=0;return{yRatio:r,invertedYRatio:e,zRatio:y,xRatio:i,invertedXRatio:s,baseLineInvertedY:x,baseLineY:b,baseLineX:B}}},{key:"getLogSeries",value:function(e){var i=this,s=this.w;return s.globals.seriesLog=e.map(function(c,d){var A=s.globals.seriesYAxisReverseMap[d];return s.config.yaxis[A]&&s.config.yaxis[A].logarithmic?c.map(function(r){return r===null?null:i.getLogVal(s.config.yaxis[A].logBase,r,d)}):c}),s.globals.invalidLogScale?e:s.globals.seriesLog}},{key:"getLogValAtSeriesIndex",value:function(e,i){if(e===null)return null;var s=this.w,c=s.globals.seriesYAxisReverseMap[i];return s.config.yaxis[c]&&s.config.yaxis[c].logarithmic?this.getLogVal(s.config.yaxis[c].logBase,e,i):e}},{key:"getBaseLog",value:function(e,i){return Math.log(i)/Math.log(e)}},{key:"getLogVal",value:function(e,i,s){if(i<=0)return 0;var c=this.w,d=c.globals.minYArr[s]===0?-1:this.getBaseLog(e,c.globals.minYArr[s]),A=(c.globals.maxYArr[s]===0?0:this.getBaseLog(e,c.globals.maxYArr[s]))-d;return i<1?i/A:(this.getBaseLog(e,i)-d)/A}},{key:"getLogYRatios",value:function(e){var i=this,s=this.w,c=this.w.globals;return c.yLogRatio=e.slice(),c.logYRange=c.yRange.map(function(d,A){var r=s.globals.seriesYAxisReverseMap[A];if(s.config.yaxis[r]&&i.w.config.yaxis[r].logarithmic){var y,b=-Number.MAX_VALUE,x=Number.MIN_VALUE;return c.seriesLog.forEach(function(B,T){B.forEach(function(E){s.config.yaxis[T]&&s.config.yaxis[T].logarithmic&&(b=Math.max(E,b),x=Math.min(E,x))})}),y=Math.pow(c.yRange[A],Math.abs(x-b)/c.yRange[A]),c.yLogRatio[A]=y/c.gridHeight,y}}),c.invalidLogScale?e.slice():c.yLogRatio}},{key:"drawSeriesByGroup",value:function(e,i,s,c){var d=this.w,A=[];return e.series.length>0&&i.forEach(function(r){var y=[],b=[];e.i.forEach(function(x,B){d.config.series[x].group===r&&(y.push(e.series[B]),b.push(x))}),y.length>0&&A.push(c.draw(y,s,b))}),A}}],[{key:"checkComboSeries",value:function(e,i){var s=!1,c=0,d=0;return i===void 0&&(i="line"),e.length&&e[0].type!==void 0&&e.forEach(function(A){A.type!=="bar"&&A.type!=="column"&&A.type!=="candlestick"&&A.type!=="boxPlot"||c++,A.type!==void 0&&A.type!==i&&d++}),d>0&&(s=!0),{comboBarCount:c,comboCharts:s}}},{key:"extendArrayProps",value:function(e,i,s){var c,d,A,r,y,b;return(c=i)!==null&&c!==void 0&&c.yaxis&&(i=e.extendYAxis(i,s)),(d=i)!==null&&d!==void 0&&d.annotations&&(i.annotations.yaxis&&(i=e.extendYAxisAnnotations(i)),(A=i)!==null&&A!==void 0&&(r=A.annotations)!==null&&r!==void 0&&r.xaxis&&(i=e.extendXAxisAnnotations(i)),(y=i)!==null&&y!==void 0&&(b=y.annotations)!==null&&b!==void 0&&b.points&&(i=e.extendPointAnnotations(i))),i}}]),a}(),a_=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e}return tn(a,[{key:"setOrientations",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.w;if(e.label.orientation==="vertical"){var c=i!==null?i:0,d=s.globals.dom.baseEl.querySelector(".apexcharts-xaxis-annotations .apexcharts-xaxis-annotation-label[rel='".concat(c,"']"));if(d!==null){var A=d.getBoundingClientRect();d.setAttribute("x",parseFloat(d.getAttribute("x"))-A.height+4);var r=e.label.position==="top"?A.width:-A.width;d.setAttribute("y",parseFloat(d.getAttribute("y"))+r);var y=this.annoCtx.graphics.rotateAroundCenter(d),b=y.x,x=y.y;d.setAttribute("transform","rotate(-90 ".concat(b," ").concat(x,")"))}}}},{key:"addBackgroundToAnno",value:function(e,i){var s=this.w;if(!e||!i.label.text||!String(i.label.text).trim())return null;var c=s.globals.dom.baseEl.querySelector(".apexcharts-grid").getBoundingClientRect(),d=e.getBoundingClientRect(),A=i.label.style.padding,r=A.left,y=A.right,b=A.top,x=A.bottom;if(i.label.orientation==="vertical"){var B=[r,y,b,x];b=B[0],x=B[1],r=B[2],y=B[3]}var T=d.left-c.left-r,E=d.top-c.top-b,R=this.annoCtx.graphics.drawRect(T-s.globals.barPadForNumericAxis,E,d.width+r+y,d.height+b+x,i.label.borderRadius,i.label.style.background,1,i.label.borderWidth,i.label.borderColor,0);return i.id&&R.node.classList.add(i.id),R}},{key:"annotationsBackground",value:function(){var e=this,i=this.w,s=function(c,d,A){var r=i.globals.dom.baseEl.querySelector(".apexcharts-".concat(A,"-annotations .apexcharts-").concat(A,"-annotation-label[rel='").concat(d,"']"));if(r){var y=r.parentNode,b=e.addBackgroundToAnno(r,c);b&&(y.insertBefore(b.node,r),c.label.mouseEnter&&b.node.addEventListener("mouseenter",c.label.mouseEnter.bind(e,c)),c.label.mouseLeave&&b.node.addEventListener("mouseleave",c.label.mouseLeave.bind(e,c)),c.label.click&&b.node.addEventListener("click",c.label.click.bind(e,c)))}};i.config.annotations.xaxis.forEach(function(c,d){return s(c,d,"xaxis")}),i.config.annotations.yaxis.forEach(function(c,d){return s(c,d,"yaxis")}),i.config.annotations.points.forEach(function(c,d){return s(c,d,"point")})}},{key:"getY1Y2",value:function(e,i){var s,c=this.w,d=e==="y1"?i.y:i.y2,A=!1;if(this.annoCtx.invertAxis){var r=c.config.xaxis.convertedCatToNumeric?c.globals.categoryLabels:c.globals.labels,y=r.indexOf(d),b=c.globals.dom.baseEl.querySelector(".apexcharts-yaxis-texts-g text:nth-child(".concat(y+1,")"));s=b?parseFloat(b.getAttribute("y")):(c.globals.gridHeight/r.length-1)*(y+1)-c.globals.barHeight,i.seriesIndex!==void 0&&c.globals.barHeight&&(s-=c.globals.barHeight/2*(c.globals.series.length-1)-c.globals.barHeight*i.seriesIndex)}else{var x,B=c.globals.seriesYAxisMap[i.yAxisIndex][0],T=c.config.yaxis[i.yAxisIndex].logarithmic?new nl(this.annoCtx.ctx).getLogVal(c.config.yaxis[i.yAxisIndex].logBase,d,B)/c.globals.yLogRatio[B]:(d-c.globals.minYArr[B])/(c.globals.yRange[B]/c.globals.gridHeight);s=c.globals.gridHeight-Math.min(Math.max(T,0),c.globals.gridHeight),A=T>c.globals.gridHeight||T<0,!i.marker||i.y!==void 0&&i.y!==null||(s=0),(x=c.config.yaxis[i.yAxisIndex])!==null&&x!==void 0&&x.reversed&&(s=T)}return typeof d=="string"&&d.includes("px")&&(s=parseFloat(d)),{yP:s,clipped:A}}},{key:"getX1X2",value:function(e,i){var s=this.w,c=e==="x1"?i.x:i.x2,d=this.annoCtx.invertAxis?s.globals.minY:s.globals.minX,A=this.annoCtx.invertAxis?s.globals.maxY:s.globals.maxX,r=this.annoCtx.invertAxis?s.globals.yRange[0]:s.globals.xRange,y=!1,b=this.annoCtx.inversedReversedAxis?(A-c)/(r/s.globals.gridWidth):(c-d)/(r/s.globals.gridWidth);return s.config.xaxis.type!=="category"&&!s.config.xaxis.convertedCatToNumeric||this.annoCtx.invertAxis||s.globals.dataFormatXNumeric||s.config.chart.sparkline.enabled||(b=this.getStringX(c)),typeof c=="string"&&c.includes("px")&&(b=parseFloat(c)),c==null&&i.marker&&(b=s.globals.gridWidth),i.seriesIndex!==void 0&&s.globals.barWidth&&!this.annoCtx.invertAxis&&(b-=s.globals.barWidth/2*(s.globals.series.length-1)-s.globals.barWidth*i.seriesIndex),typeof b!="number"&&(b=0,y=!0),parseFloat(b.toFixed(10))>parseFloat(s.globals.gridWidth.toFixed(10))?(b=s.globals.gridWidth,y=!0):b<0&&(b=0,y=!0),{x:b,clipped:y}}},{key:"getStringX",value:function(e){var i=this.w,s=e;i.config.xaxis.convertedCatToNumeric&&i.globals.categoryLabels.length&&(e=i.globals.categoryLabels.indexOf(e)+1);var c=i.globals.labels.map(function(A){return Array.isArray(A)?A.join(" "):A}).indexOf(e),d=i.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g text:nth-child(".concat(c+1,")"));return d&&(s=parseFloat(d.getAttribute("x"))),s}}]),a}(),OR=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.invertAxis=this.annoCtx.invertAxis,this.helpers=new a_(this.annoCtx)}return tn(a,[{key:"addXaxisAnnotation",value:function(e,i,s){var c,d=this.w,A=this.helpers.getX1X2("x1",e),r=A.x,y=A.clipped,b=!0,x=e.label.text,B=e.strokeDashArray;if(ni.isNumber(r)){if(e.x2===null||e.x2===void 0){if(!y){var T=this.annoCtx.graphics.drawLine(r+e.offsetX,0+e.offsetY,r+e.offsetX,d.globals.gridHeight+e.offsetY,e.borderColor,B,e.borderWidth);i.appendChild(T.node),e.id&&T.node.classList.add(e.id)}}else{var E=this.helpers.getX1X2("x2",e);if(c=E.x,b=E.clipped,c<r){var R=r;r=c,c=R}var P=this.annoCtx.graphics.drawRect(r+e.offsetX,0+e.offsetY,c-r,d.globals.gridHeight+e.offsetY,0,e.fillColor,e.opacity,1,e.borderColor,B);P.node.classList.add("apexcharts-annotation-rect"),P.attr("clip-path","url(#gridRectMask".concat(d.globals.cuid,")")),i.appendChild(P.node),e.id&&P.node.classList.add(e.id)}if(!y||!b){var G=this.annoCtx.graphics.getTextRects(x,parseFloat(e.label.style.fontSize)),U=e.label.position==="top"?4:e.label.position==="center"?d.globals.gridHeight/2+(e.label.orientation==="vertical"?G.width/2:0):d.globals.gridHeight,Q=this.annoCtx.graphics.drawText({x:r+e.label.offsetX,y:U+e.label.offsetY-(e.label.orientation==="vertical"?e.label.position==="top"?G.width/2-12:-G.width/2:0),text:x,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-xaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});Q.attr({rel:s}),i.appendChild(Q.node),this.annoCtx.helpers.setOrientations(e,s)}}}},{key:"drawXAxisAnnotations",value:function(){var e=this,i=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return i.config.annotations.xaxis.map(function(c,d){e.addXaxisAnnotation(c,s.node,d)}),s}}]),a}(),Pc=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.months31=[1,3,5,7,8,10,12],this.months30=[2,4,6,9,11],this.daysCntOfYear=[0,31,59,90,120,151,181,212,243,273,304,334]}return tn(a,[{key:"isValidDate",value:function(e){return typeof e!="number"&&!isNaN(this.parseDate(e))}},{key:"getTimeStamp",value:function(e){return Date.parse(e)?this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toISOString().substr(0,25)).getTime():new Date(e).getTime():e}},{key:"getDate",value:function(e){return this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toUTCString()):new Date(e)}},{key:"parseDate",value:function(e){var i=Date.parse(e);if(!isNaN(i))return this.getTimeStamp(e);var s=Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "));return s=this.getTimeStamp(s)}},{key:"parseDateWithTimezone",value:function(e){return Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "))}},{key:"formatDate",value:function(e,i){var s=this.w.globals.locale,c=this.w.config.xaxis.labels.datetimeUTC,d=["\0"].concat(Kl(s.months)),A=[""].concat(Kl(s.shortMonths)),r=[""].concat(Kl(s.days)),y=[""].concat(Kl(s.shortDays));function b(he,be){var Se=he+"";for(be=be||2;Se.length<be;)Se="0"+Se;return Se}var x=c?e.getUTCFullYear():e.getFullYear();i=(i=(i=i.replace(/(^|[^\\])yyyy+/g,"$1"+x)).replace(/(^|[^\\])yy/g,"$1"+x.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+x);var B=(c?e.getUTCMonth():e.getMonth())+1;i=(i=(i=(i=i.replace(/(^|[^\\])MMMM+/g,"$1"+d[0])).replace(/(^|[^\\])MMM/g,"$1"+A[0])).replace(/(^|[^\\])MM/g,"$1"+b(B))).replace(/(^|[^\\])M/g,"$1"+B);var T=c?e.getUTCDate():e.getDate();i=(i=(i=(i=i.replace(/(^|[^\\])dddd+/g,"$1"+r[0])).replace(/(^|[^\\])ddd/g,"$1"+y[0])).replace(/(^|[^\\])dd/g,"$1"+b(T))).replace(/(^|[^\\])d/g,"$1"+T);var E=c?e.getUTCHours():e.getHours(),R=E>12?E-12:E===0?12:E;i=(i=(i=(i=i.replace(/(^|[^\\])HH+/g,"$1"+b(E))).replace(/(^|[^\\])H/g,"$1"+E)).replace(/(^|[^\\])hh+/g,"$1"+b(R))).replace(/(^|[^\\])h/g,"$1"+R);var P=c?e.getUTCMinutes():e.getMinutes();i=(i=i.replace(/(^|[^\\])mm+/g,"$1"+b(P))).replace(/(^|[^\\])m/g,"$1"+P);var G=c?e.getUTCSeconds():e.getSeconds();i=(i=i.replace(/(^|[^\\])ss+/g,"$1"+b(G))).replace(/(^|[^\\])s/g,"$1"+G);var U=c?e.getUTCMilliseconds():e.getMilliseconds();i=i.replace(/(^|[^\\])fff+/g,"$1"+b(U,3)),U=Math.round(U/10),i=i.replace(/(^|[^\\])ff/g,"$1"+b(U)),U=Math.round(U/10);var Q=E<12?"AM":"PM";i=(i=(i=i.replace(/(^|[^\\])f/g,"$1"+U)).replace(/(^|[^\\])TT+/g,"$1"+Q)).replace(/(^|[^\\])T/g,"$1"+Q.charAt(0));var q=Q.toLowerCase();i=(i=i.replace(/(^|[^\\])tt+/g,"$1"+q)).replace(/(^|[^\\])t/g,"$1"+q.charAt(0));var ne=-e.getTimezoneOffset(),re=c||!ne?"Z":ne>0?"+":"-";if(!c){var pe=(ne=Math.abs(ne))%60;re+=b(Math.floor(ne/60))+":"+b(pe)}i=i.replace(/(^|[^\\])K/g,"$1"+re);var fe=(c?e.getUTCDay():e.getDay())+1;return i=(i=(i=(i=(i=i.replace(new RegExp(r[0],"g"),r[fe])).replace(new RegExp(y[0],"g"),y[fe])).replace(new RegExp(d[0],"g"),d[B])).replace(new RegExp(A[0],"g"),A[B])).replace(/\\(.)/g,"$1")}},{key:"getTimeUnitsfromTimestamp",value:function(e,i,s){var c=this.w;c.config.xaxis.min!==void 0&&(e=c.config.xaxis.min),c.config.xaxis.max!==void 0&&(i=c.config.xaxis.max);var d=this.getDate(e),A=this.getDate(i),r=this.formatDate(d,"yyyy MM dd HH mm ss fff").split(" "),y=this.formatDate(A,"yyyy MM dd HH mm ss fff").split(" ");return{minMillisecond:parseInt(r[6],10),maxMillisecond:parseInt(y[6],10),minSecond:parseInt(r[5],10),maxSecond:parseInt(y[5],10),minMinute:parseInt(r[4],10),maxMinute:parseInt(y[4],10),minHour:parseInt(r[3],10),maxHour:parseInt(y[3],10),minDate:parseInt(r[2],10),maxDate:parseInt(y[2],10),minMonth:parseInt(r[1],10)-1,maxMonth:parseInt(y[1],10)-1,minYear:parseInt(r[0],10),maxYear:parseInt(y[0],10)}}},{key:"isLeapYear",value:function(e){return e%4==0&&e%100!=0||e%400==0}},{key:"calculcateLastDaysOfMonth",value:function(e,i,s){return this.determineDaysOfMonths(e,i)-s}},{key:"determineDaysOfYear",value:function(e){var i=365;return this.isLeapYear(e)&&(i=366),i}},{key:"determineRemainingDaysOfYear",value:function(e,i,s){var c=this.daysCntOfYear[i]+s;return i>1&&this.isLeapYear()&&c++,c}},{key:"determineDaysOfMonths",value:function(e,i){var s=30;switch(e=ni.monthMod(e),!0){case this.months30.indexOf(e)>-1:e===2&&(s=this.isLeapYear(i)?29:28);break;case this.months31.indexOf(e)>-1:default:s=31}return s}}]),a}(),Zy=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.tooltipKeyFormat="dd MMM"}return tn(a,[{key:"xLabelFormat",value:function(e,i,s,c){var d=this.w;if(d.config.xaxis.type==="datetime"&&d.config.xaxis.labels.formatter===void 0&&d.config.tooltip.x.formatter===void 0){var A=new Pc(this.ctx);return A.formatDate(A.getDate(i),d.config.tooltip.x.format)}return e(i,s,c)}},{key:"defaultGeneralFormatter",value:function(e){return Array.isArray(e)?e.map(function(i){return i}):e}},{key:"defaultYFormatter",value:function(e,i,s){var c=this.w;if(ni.isNumber(e))if(c.globals.yValueDecimal!==0)e=e.toFixed(i.decimalsInFloat!==void 0?i.decimalsInFloat:c.globals.yValueDecimal);else{var d=e.toFixed(0);e=e==d?d:e.toFixed(1)}return e}},{key:"setLabelFormatters",value:function(){var e=this,i=this.w;return i.globals.xaxisTooltipFormatter=function(s){return e.defaultGeneralFormatter(s)},i.globals.ttKeyFormatter=function(s){return e.defaultGeneralFormatter(s)},i.globals.ttZFormatter=function(s){return s},i.globals.legendFormatter=function(s){return e.defaultGeneralFormatter(s)},i.config.xaxis.labels.formatter!==void 0?i.globals.xLabelFormatter=i.config.xaxis.labels.formatter:i.globals.xLabelFormatter=function(s){if(ni.isNumber(s)){if(!i.config.xaxis.convertedCatToNumeric&&i.config.xaxis.type==="numeric"){if(ni.isNumber(i.config.xaxis.decimalsInFloat))return s.toFixed(i.config.xaxis.decimalsInFloat);var c=i.globals.maxX-i.globals.minX;return c>0&&c<100?s.toFixed(1):s.toFixed(0)}return i.globals.isBarHorizontal&&i.globals.maxY-i.globals.minYArr<4?s.toFixed(1):s.toFixed(0)}return s},typeof i.config.tooltip.x.formatter=="function"?i.globals.ttKeyFormatter=i.config.tooltip.x.formatter:i.globals.ttKeyFormatter=i.globals.xLabelFormatter,typeof i.config.xaxis.tooltip.formatter=="function"&&(i.globals.xaxisTooltipFormatter=i.config.xaxis.tooltip.formatter),(Array.isArray(i.config.tooltip.y)||i.config.tooltip.y.formatter!==void 0)&&(i.globals.ttVal=i.config.tooltip.y),i.config.tooltip.z.formatter!==void 0&&(i.globals.ttZFormatter=i.config.tooltip.z.formatter),i.config.legend.formatter!==void 0&&(i.globals.legendFormatter=i.config.legend.formatter),i.config.yaxis.forEach(function(s,c){s.labels.formatter!==void 0?i.globals.yLabelFormatters[c]=s.labels.formatter:i.globals.yLabelFormatters[c]=function(d){return i.globals.xyCharts?Array.isArray(d)?d.map(function(A){return e.defaultYFormatter(A,s,c)}):e.defaultYFormatter(d,s,c):d}}),i.globals}},{key:"heatmapLabelFormatters",value:function(){var e=this.w;if(e.config.chart.type==="heatmap"){e.globals.yAxisScale[0].result=e.globals.seriesNames.slice();var i=e.globals.seriesNames.reduce(function(s,c){return s.length>c.length?s:c},0);e.globals.yAxisScale[0].niceMax=i,e.globals.yAxisScale[0].niceMin=i}}}]),a}(),Bp=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getLabel",value:function(e,i,s,c){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"12px",r=!(arguments.length>6&&arguments[6]!==void 0)||arguments[6],y=this.w,b=e[c]===void 0?"":e[c],x=b,B=y.globals.xLabelFormatter,T=y.config.xaxis.labels.formatter,E=!1,R=new Zy(this.ctx),P=b;r&&(x=R.xLabelFormat(B,b,P,{i:c,dateFormatter:new Pc(this.ctx).formatDate,w:y}),T!==void 0&&(x=T(b,e[c],{i:c,dateFormatter:new Pc(this.ctx).formatDate,w:y})));var G,U;i.length>0?(G=i[c].unit,U=null,i.forEach(function(re){re.unit==="month"?U="year":re.unit==="day"?U="month":re.unit==="hour"?U="day":re.unit==="minute"&&(U="hour")}),E=U===G,s=i[c].position,x=i[c].value):y.config.xaxis.type==="datetime"&&T===void 0&&(x=""),x===void 0&&(x=""),x=Array.isArray(x)?x:x.toString();var Q=new ur(this.ctx),q={};q=y.globals.rotateXLabels&&r?Q.getTextRects(x,parseInt(A,10),null,"rotate(".concat(y.config.xaxis.labels.rotate," 0 0)"),!1):Q.getTextRects(x,parseInt(A,10));var ne=!y.config.xaxis.labels.showDuplicates&&this.ctx.timeScale;return!Array.isArray(x)&&(String(x)==="NaN"||d.indexOf(x)>=0&&ne)&&(x=""),{x:s,text:x,textRect:q,isBold:E}}},{key:"checkLabelBasedOnTickamount",value:function(e,i,s){var c=this.w,d=c.config.xaxis.tickAmount;return d==="dataPoints"&&(d=Math.round(c.globals.gridWidth/120)),d>s||e%Math.round(s/(d+1))==0||(i.text=""),i}},{key:"checkForOverflowingLabels",value:function(e,i,s,c,d){var A=this.w;if(e===0&&A.globals.skipFirstTimelinelabel&&(i.text=""),e===s-1&&A.globals.skipLastTimelinelabel&&(i.text=""),A.config.xaxis.labels.hideOverlappingLabels&&c.length>0){var r=d[d.length-1];i.x<r.textRect.width/(A.globals.rotateXLabels?Math.abs(A.config.xaxis.labels.rotate)/12:1.01)+r.x&&(i.text="")}return i}},{key:"checkForReversedLabels",value:function(e,i){var s=this.w;return s.config.yaxis[e]&&s.config.yaxis[e].reversed&&i.reverse(),i}},{key:"yAxisAllSeriesCollapsed",value:function(e){var i=this.w.globals;return!i.seriesYAxisMap[e].some(function(s){return i.collapsedSeriesIndices.indexOf(s)===-1})}},{key:"translateYAxisIndex",value:function(e){var i=this.w,s=i.globals,c=i.config.yaxis;return s.series.length>c.length||c.some(function(d){return Array.isArray(d.seriesName)})?e:s.seriesYAxisReverseMap[e]}},{key:"isYAxisHidden",value:function(e){var i=this.w,s=i.config.yaxis[e];if(!s.show||this.yAxisAllSeriesCollapsed(e))return!0;if(!s.showForNullSeries){var c=i.globals.seriesYAxisMap[e],d=new nl(this.ctx);return c.every(function(A){return d.isSeriesNull(A)})}return!1}},{key:"getYAxisForeColor",value:function(e,i){var s=this.w;return Array.isArray(e)&&s.globals.yAxisScale[i]&&this.ctx.theme.pushExtraColors(e,s.globals.yAxisScale[i].result.length,!1),e}},{key:"drawYAxisTicks",value:function(e,i,s,c,d,A,r){var y=this.w,b=new ur(this.ctx),x=y.globals.translateY+y.config.yaxis[d].labels.offsetY;if(y.globals.isBarHorizontal?x=0:y.config.chart.type==="heatmap"&&(x+=A/2),c.show&&i>0){y.config.yaxis[d].opposite===!0&&(e+=c.width);for(var B=i;B>=0;B--){var T=b.drawLine(e+s.offsetX-c.width+c.offsetX,x+c.offsetY,e+s.offsetX+c.offsetX,x+c.offsetY,c.color);r.add(T),x+=A}}}}]),a}(),UR=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.helpers=new a_(this.annoCtx),this.axesUtils=new Bp(this.annoCtx)}return tn(a,[{key:"addYaxisAnnotation",value:function(e,i,s){var c,d=this.w,A=e.strokeDashArray,r=this.helpers.getY1Y2("y1",e),y=r.yP,b=r.clipped,x=!0,B=!1,T=e.label.text;if(e.y2===null||e.y2===void 0){if(!b){B=!0;var E=this.annoCtx.graphics.drawLine(0+e.offsetX,y+e.offsetY,this._getYAxisAnnotationWidth(e),y+e.offsetY,e.borderColor,A,e.borderWidth);i.appendChild(E.node),e.id&&E.node.classList.add(e.id)}}else{if(c=(r=this.helpers.getY1Y2("y2",e)).yP,x=r.clipped,c>y){var R=y;y=c,c=R}if(!b||!x){B=!0;var P=this.annoCtx.graphics.drawRect(0+e.offsetX,c+e.offsetY,this._getYAxisAnnotationWidth(e),y-c,0,e.fillColor,e.opacity,1,e.borderColor,A);P.node.classList.add("apexcharts-annotation-rect"),P.attr("clip-path","url(#gridRectMask".concat(d.globals.cuid,")")),i.appendChild(P.node),e.id&&P.node.classList.add(e.id)}}if(B){var G=e.label.position==="right"?d.globals.gridWidth:e.label.position==="center"?d.globals.gridWidth/2:0,U=this.annoCtx.graphics.drawText({x:G+e.label.offsetX,y:(c??y)+e.label.offsetY-3,text:T,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-yaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});U.attr({rel:s}),i.appendChild(U.node)}}},{key:"_getYAxisAnnotationWidth",value:function(e){var i=this.w;return i.globals.gridWidth,(e.width.indexOf("%")>-1?i.globals.gridWidth*parseInt(e.width,10)/100:parseInt(e.width,10))+e.offsetX}},{key:"drawYAxisAnnotations",value:function(){var e=this,i=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-yaxis-annotations"});return i.config.annotations.yaxis.forEach(function(c,d){c.yAxisIndex=e.axesUtils.translateYAxisIndex(c.yAxisIndex),e.axesUtils.isYAxisHidden(c.yAxisIndex)&&e.axesUtils.yAxisAllSeriesCollapsed(c.yAxisIndex)||e.addYaxisAnnotation(c,s.node,d)}),s}}]),a}(),zR=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.helpers=new a_(this.annoCtx)}return tn(a,[{key:"addPointAnnotation",value:function(e,i,s){if(!(this.w.globals.collapsedSeriesIndices.indexOf(e.seriesIndex)>-1)){var c=this.helpers.getX1X2("x1",e),d=c.x,A=c.clipped,r=(c=this.helpers.getY1Y2("y1",e)).yP,y=c.clipped;if(ni.isNumber(d)&&!y&&!A){var b={pSize:e.marker.size,pointStrokeWidth:e.marker.strokeWidth,pointFillColor:e.marker.fillColor,pointStrokeColor:e.marker.strokeColor,shape:e.marker.shape,pRadius:e.marker.radius,class:"apexcharts-point-annotation-marker ".concat(e.marker.cssClass," ").concat(e.id?e.id:"")},x=this.annoCtx.graphics.drawMarker(d+e.marker.offsetX,r+e.marker.offsetY,b);i.appendChild(x.node);var B=e.label.text?e.label.text:"",T=this.annoCtx.graphics.drawText({x:d+e.label.offsetX,y:r+e.label.offsetY-e.marker.size-parseFloat(e.label.style.fontSize)/1.6,text:B,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-point-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});if(T.attr({rel:s}),i.appendChild(T.node),e.customSVG.SVG){var E=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+e.customSVG.cssClass});E.attr({transform:"translate(".concat(d+e.customSVG.offsetX,", ").concat(r+e.customSVG.offsetY,")")}),E.node.innerHTML=e.customSVG.SVG,i.appendChild(E.node)}if(e.image.path){var R=e.image.width?e.image.width:20,P=e.image.height?e.image.height:20;x=this.annoCtx.addImage({x:d+e.image.offsetX-R/2,y:r+e.image.offsetY-P/2,width:R,height:P,path:e.image.path,appendTo:".apexcharts-point-annotations"})}e.mouseEnter&&x.node.addEventListener("mouseenter",e.mouseEnter.bind(this,e)),e.mouseLeave&&x.node.addEventListener("mouseleave",e.mouseLeave.bind(this,e)),e.click&&x.node.addEventListener("click",e.click.bind(this,e))}}}},{key:"drawPointAnnotations",value:function(){var e=this,i=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return i.config.annotations.points.map(function(c,d){e.addPointAnnotation(c,s.node,d)}),s}}]),a}(),HT={name:"en",options:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],toolbar:{exportToSVG:"Download SVG",exportToPNG:"Download PNG",exportToCSV:"Download CSV",menu:"Menu",selection:"Selection",selectionZoom:"Selection Zoom",zoomIn:"Zoom In",zoomOut:"Zoom Out",pan:"Panning",reset:"Reset Zoom"}}},eg=function(){function a(){en(this,a),this.yAxis={show:!0,showAlways:!1,showForNullSeries:!0,seriesName:void 0,opposite:!1,reversed:!1,logarithmic:!1,logBase:10,tickAmount:void 0,stepSize:void 0,forceNiceScale:!1,max:void 0,min:void 0,floating:!1,decimalsInFloat:void 0,labels:{show:!0,showDuplicates:!1,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,align:void 0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",fontWeight:400,fontFamily:void 0,cssClass:""},formatter:void 0},axisBorder:{show:!1,color:"#e0e0e0",width:1,offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#e0e0e0",width:6,offsetX:0,offsetY:0},title:{text:void 0,rotate:-90,offsetY:0,offsetX:0,style:{color:void 0,fontSize:"11px",fontWeight:900,fontFamily:void 0,cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}},this.pointAnnotation={id:void 0,x:0,y:null,yAxisIndex:0,seriesIndex:void 0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,marker:{size:4,fillColor:"#fff",strokeWidth:2,strokeColor:"#333",shape:"circle",offsetX:0,offsetY:0,cssClass:""},label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}},customSVG:{SVG:void 0,cssClass:void 0,offsetX:0,offsetY:0},image:{path:void 0,width:20,height:20,offsetX:0,offsetY:0}},this.yAxisAnnotation={id:void 0,y:0,y2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,width:"100%",yAxisIndex:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"end",position:"right",offsetX:0,offsetY:-3,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.xAxisAnnotation={id:void 0,x:0,x2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",orientation:"vertical",position:"top",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.text={x:0,y:0,text:"",textAnchor:"start",foreColor:void 0,fontSize:"13px",fontFamily:void 0,fontWeight:400,appendTo:".apexcharts-annotations",backgroundColor:"transparent",borderColor:"#c2c2c2",borderRadius:0,borderWidth:0,paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2}}return tn(a,[{key:"init",value:function(){return{annotations:{yaxis:[this.yAxisAnnotation],xaxis:[this.xAxisAnnotation],points:[this.pointAnnotation],texts:[],images:[],shapes:[]},chart:{animations:{enabled:!0,speed:800,animateGradually:{delay:150,enabled:!0},dynamicAnimation:{enabled:!0,speed:350}},background:"",locales:[HT],defaultLocale:"en",dropShadow:{enabled:!1,enabledOnSeries:void 0,top:2,left:2,blur:4,color:"#000",opacity:.7},events:{animationEnd:void 0,beforeMount:void 0,mounted:void 0,updated:void 0,click:void 0,mouseMove:void 0,mouseLeave:void 0,xAxisLabelClick:void 0,legendClick:void 0,markerClick:void 0,selection:void 0,dataPointSelection:void 0,dataPointMouseEnter:void 0,dataPointMouseLeave:void 0,beforeZoom:void 0,beforeResetZoom:void 0,zoomed:void 0,scrolled:void 0,brushScrolled:void 0},foreColor:"#373d3f",fontFamily:"Helvetica, Arial, sans-serif",height:"auto",parentHeightOffset:15,redrawOnParentResize:!0,redrawOnWindowResize:!0,id:void 0,group:void 0,nonce:void 0,offsetX:0,offsetY:0,selection:{enabled:!1,type:"x",fill:{color:"#24292e",opacity:.1},stroke:{width:1,color:"#24292e",opacity:.4,dashArray:3},xaxis:{min:void 0,max:void 0},yaxis:{min:void 0,max:void 0}},sparkline:{enabled:!1},brush:{enabled:!1,autoScaleYaxis:!0,target:void 0,targets:void 0},stacked:!1,stackOnlyBar:!0,stackType:"normal",toolbar:{show:!0,offsetX:0,offsetY:0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0,customIcons:[]},export:{csv:{filename:void 0,columnDelimiter:",",headerCategory:"category",headerValue:"value",categoryFormatter:void 0,valueFormatter:void 0},png:{filename:void 0},svg:{filename:void 0},scale:void 0,width:void 0},autoSelected:"zoom"},type:"line",width:"100%",zoom:{enabled:!0,type:"x",autoScaleYaxis:!1,allowMouseWheelZoom:!0,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},plotOptions:{line:{isSlopeChart:!1,colors:{threshold:0,colorAboveThreshold:void 0,colorBelowThreshold:void 0}},area:{fillTo:"origin"},bar:{horizontal:!1,columnWidth:"70%",barHeight:"70%",distributed:!1,borderRadius:0,borderRadiusApplication:"around",borderRadiusWhenStacked:"last",rangeBarOverlap:!0,rangeBarGroupRows:!1,hideZeroBarsWhenGrouped:!1,isDumbbell:!1,dumbbellColors:void 0,isFunnel:!1,isFunnel3d:!0,colors:{ranges:[],backgroundBarColors:[],backgroundBarOpacity:1,backgroundBarRadius:0},dataLabels:{position:"top",maxItems:100,hideOverflowingLabels:!0,orientation:"horizontal",total:{enabled:!1,formatter:void 0,offsetX:0,offsetY:0,style:{color:"#373d3f",fontSize:"12px",fontFamily:void 0,fontWeight:600}}}},bubble:{zScaling:!0,minBubbleRadius:void 0,maxBubbleRadius:void 0},candlestick:{colors:{upward:"#00B746",downward:"#EF403C"},wick:{useFillColor:!0}},boxPlot:{colors:{upper:"#00E396",lower:"#008FFB"}},heatmap:{radius:2,enableShades:!0,shadeIntensity:.5,reverseNegativeShade:!1,distributed:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},treemap:{enableShades:!0,shadeIntensity:.5,distributed:!1,reverseNegativeShade:!1,useFillColorAsStroke:!1,borderRadius:4,dataLabels:{format:"scale"},colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0},seriesTitle:{show:!0,offsetY:1,offsetX:1,borderColor:"#000",borderWidth:1,borderRadius:2,style:{background:"rgba(0, 0, 0, 0.6)",color:"#fff",fontSize:"12px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:6,right:6,top:2,bottom:2}}}},radialBar:{inverseOrder:!1,startAngle:0,endAngle:360,offsetX:0,offsetY:0,hollow:{margin:5,size:"50%",background:"transparent",image:void 0,imageWidth:150,imageHeight:150,imageOffsetX:0,imageOffsetY:0,imageClipped:!0,position:"front",dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},track:{show:!0,startAngle:void 0,endAngle:void 0,background:"#f2f2f2",strokeWidth:"97%",opacity:1,margin:5,dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:0,formatter:function(e){return e}},value:{show:!0,fontSize:"14px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:16,formatter:function(e){return e+"%"}},total:{show:!1,label:"Total",fontSize:"16px",fontWeight:600,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(i,s){return i+s},0)/e.globals.series.length+"%"}}},barLabels:{enabled:!1,offsetX:0,offsetY:0,useSeriesColors:!0,fontFamily:void 0,fontWeight:600,fontSize:"16px",formatter:function(e){return e},onClick:void 0}},pie:{customScale:1,offsetX:0,offsetY:0,startAngle:0,endAngle:360,expandOnClick:!0,dataLabels:{offset:0,minAngleToShowLabel:10},donut:{size:"65%",background:"transparent",labels:{show:!1,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:-10,formatter:function(e){return e}},value:{show:!0,fontSize:"20px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:10,formatter:function(e){return e}},total:{show:!1,showAlways:!1,label:"Total",fontSize:"16px",fontWeight:400,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(i,s){return i+s},0)}}}}},polarArea:{rings:{strokeWidth:1,strokeColor:"#e8e8e8"},spokes:{strokeWidth:1,connectorColors:"#e8e8e8"}},radar:{size:void 0,offsetX:0,offsetY:0,polygons:{strokeWidth:1,strokeColors:"#e8e8e8",connectorColors:"#e8e8e8",fill:{colors:void 0}}}},colors:void 0,dataLabels:{enabled:!0,enabledOnSeries:void 0,formatter:function(e){return e!==null?e:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"12px",fontFamily:void 0,fontWeight:600,colors:void 0},background:{enabled:!0,foreColor:"#fff",backgroundColor:void 0,borderRadius:2,padding:4,opacity:.9,borderWidth:1,borderColor:"#fff",dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},image:{src:[],width:void 0,height:void 0},pattern:{style:"squares",width:6,height:6,strokeWidth:2}},forecastDataPoints:{count:0,fillOpacity:.5,strokeWidth:void 0,dashArray:4},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:0,position:"back",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}},row:{colors:void 0,opacity:.5},column:{colors:void 0,opacity:.5},padding:{top:0,right:10,bottom:0,left:12}},labels:[],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,floating:!1,position:"bottom",horizontalAlign:"center",inverseOrder:!1,fontSize:"12px",fontFamily:void 0,fontWeight:400,width:void 0,height:void 0,formatter:void 0,tooltipHoverFormatter:void 0,offsetX:-20,offsetY:4,customLegendItems:[],clusterGroupedSeries:!0,clusterGroupedSeriesOrientation:"vertical",labels:{colors:void 0,useSeriesColors:!1},markers:{size:7,fillColors:void 0,strokeWidth:1,shape:void 0,offsetX:0,offsetY:0,customHTML:void 0,onClick:void 0},itemMargin:{horizontal:5,vertical:4},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},markers:{discrete:[],size:0,colors:void 0,strokeColors:"#fff",strokeWidth:2,strokeOpacity:.9,strokeDashArray:0,fillOpacity:1,shape:"circle",offsetX:0,offsetY:0,showNullDataPoints:!0,onClick:void 0,onDblClick:void 0,hover:{size:void 0,sizeOffset:3}},noData:{text:void 0,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},responsive:[],series:void 0,states:{hover:{filter:{type:"lighten"}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken"}}},title:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:900,fontFamily:void 0,color:void 0}},subtitle:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:30,floating:!1,style:{fontSize:"12px",fontWeight:400,fontFamily:void 0,color:void 0}},stroke:{show:!0,curve:"smooth",lineCap:"butt",width:2,colors:void 0,dashArray:0,fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]}}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,hideEmptySeries:!1,followCursor:!1,intersect:!1,inverseOrder:!1,custom:void 0,fillSeriesColor:!1,theme:"light",cssClass:"",style:{fontSize:"12px",fontFamily:void 0},onDatasetHover:{highlightDataSeries:!1},x:{show:!0,format:"dd MMM",formatter:void 0},y:{formatter:void 0,title:{formatter:function(e){return e?e+": ":""}}},z:{formatter:void 0,title:"Size: "},marker:{show:!0,fillColors:void 0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0}},xaxis:{type:"category",categories:[],convertedCatToNumeric:!1,offsetX:0,offsetY:0,overwriteCategories:void 0,labels:{show:!0,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!0,trim:!1,minHeight:void 0,maxHeight:120,showDuplicates:!0,style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""},offsetX:0,offsetY:0,format:void 0,formatter:void 0,datetimeUTC:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm",minute:"HH:mm:ss",second:"HH:mm:ss"}},group:{groups:[],style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""}},axisBorder:{show:!0,color:"#e0e0e0",width:"100%",height:1,offsetX:0,offsetY:0},axisTicks:{show:!0,color:"#e0e0e0",height:6,offsetX:0,offsetY:0},stepSize:void 0,tickAmount:void 0,tickPlacement:"on",min:void 0,max:void 0,range:void 0,floating:!1,decimalsInFloat:void 0,position:"bottom",title:{text:void 0,offsetX:0,offsetY:0,style:{color:void 0,fontSize:"12px",fontWeight:900,fontFamily:void 0,cssClass:""}},crosshairs:{show:!0,width:1,position:"back",opacity:.9,stroke:{color:"#b6b6b6",width:1,dashArray:3},fill:{type:"solid",color:"#B1B9C4",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}},dropShadow:{enabled:!1,left:0,top:0,blur:1,opacity:.8}},tooltip:{enabled:!0,offsetY:0,formatter:void 0,style:{fontSize:"12px",fontFamily:void 0}}},yaxis:this.yAxis,theme:{mode:"",palette:"palette1",monochrome:{enabled:!1,color:"#008FFB",shadeTo:"light",shadeIntensity:.65}}}}}]),a}(),NR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.graphics=new ur(this.ctx),this.w.globals.isBarHorizontal&&(this.invertAxis=!0),this.helpers=new a_(this),this.xAxisAnnotations=new OR(this),this.yAxisAnnotations=new UR(this),this.pointsAnnotations=new zR(this),this.w.globals.isBarHorizontal&&this.w.config.yaxis[0].reversed&&(this.inversedReversedAxis=!0),this.xDivision=this.w.globals.gridWidth/this.w.globals.dataPoints}return tn(a,[{key:"drawAxesAnnotations",value:function(){var e=this.w;if(e.globals.axisCharts&&e.globals.dataPoints){for(var i=this.yAxisAnnotations.drawYAxisAnnotations(),s=this.xAxisAnnotations.drawXAxisAnnotations(),c=this.pointsAnnotations.drawPointAnnotations(),d=e.config.chart.animations.enabled,A=[i,s,c],r=[s.node,i.node,c.node],y=0;y<3;y++)e.globals.dom.elGraphical.add(A[y]),!d||e.globals.resized||e.globals.dataChanged||e.config.chart.type!=="scatter"&&e.config.chart.type!=="bubble"&&e.globals.dataPoints>1&&r[y].classList.add("apexcharts-element-hidden"),e.globals.delayedElements.push({el:r[y],index:0});this.helpers.annotationsBackground()}}},{key:"drawImageAnnos",value:function(){var e=this;this.w.config.annotations.images.map(function(i,s){e.addImage(i,s)})}},{key:"drawTextAnnos",value:function(){var e=this;this.w.config.annotations.texts.map(function(i,s){e.addText(i,s)})}},{key:"addXaxisAnnotation",value:function(e,i,s){this.xAxisAnnotations.addXaxisAnnotation(e,i,s)}},{key:"addYaxisAnnotation",value:function(e,i,s){this.yAxisAnnotations.addYaxisAnnotation(e,i,s)}},{key:"addPointAnnotation",value:function(e,i,s){this.pointsAnnotations.addPointAnnotation(e,i,s)}},{key:"addText",value:function(e,i){var s=e.x,c=e.y,d=e.text,A=e.textAnchor,r=e.foreColor,y=e.fontSize,b=e.fontFamily,x=e.fontWeight,B=e.cssClass,T=e.backgroundColor,E=e.borderWidth,R=e.strokeDashArray,P=e.borderRadius,G=e.borderColor,U=e.appendTo,Q=U===void 0?".apexcharts-svg":U,q=e.paddingLeft,ne=q===void 0?4:q,re=e.paddingRight,pe=re===void 0?4:re,fe=e.paddingBottom,he=fe===void 0?2:fe,be=e.paddingTop,Se=be===void 0?2:be,oe=this.w,ye=this.graphics.drawText({x:s,y:c,text:d,textAnchor:A||"start",fontSize:y||"12px",fontWeight:x||"regular",fontFamily:b||oe.config.chart.fontFamily,foreColor:r||oe.config.chart.foreColor,cssClass:B}),Me=oe.globals.dom.baseEl.querySelector(Q);Me&&Me.appendChild(ye.node);var Be=ye.bbox();if(d){var Pe=this.graphics.drawRect(Be.x-ne,Be.y-Se,Be.width+ne+pe,Be.height+he+Se,P,T||"transparent",1,E,G,R);Me.insertBefore(Pe.node,ye.node)}}},{key:"addImage",value:function(e,i){var s=this.w,c=e.path,d=e.x,A=d===void 0?0:d,r=e.y,y=r===void 0?0:r,b=e.width,x=b===void 0?20:b,B=e.height,T=B===void 0?20:B,E=e.appendTo,R=E===void 0?".apexcharts-svg":E,P=s.globals.dom.Paper.image(c);P.size(x,T).move(A,y);var G=s.globals.dom.baseEl.querySelector(R);return G&&G.appendChild(P.node),P}},{key:"addXaxisAnnotationExternal",value:function(e,i,s){return this.addAnnotationExternal({params:e,pushToMemory:i,context:s,type:"xaxis",contextMethod:s.addXaxisAnnotation}),s}},{key:"addYaxisAnnotationExternal",value:function(e,i,s){return this.addAnnotationExternal({params:e,pushToMemory:i,context:s,type:"yaxis",contextMethod:s.addYaxisAnnotation}),s}},{key:"addPointAnnotationExternal",value:function(e,i,s){return this.invertAxis===void 0&&(this.invertAxis=s.w.globals.isBarHorizontal),this.addAnnotationExternal({params:e,pushToMemory:i,context:s,type:"point",contextMethod:s.addPointAnnotation}),s}},{key:"addAnnotationExternal",value:function(e){var i=e.params,s=e.pushToMemory,c=e.context,d=e.type,A=e.contextMethod,r=c,y=r.w,b=y.globals.dom.baseEl.querySelector(".apexcharts-".concat(d,"-annotations")),x=b.childNodes.length+1,B=new eg,T=Object.assign({},d==="xaxis"?B.xAxisAnnotation:d==="yaxis"?B.yAxisAnnotation:B.pointAnnotation),E=ni.extend(T,i);switch(d){case"xaxis":this.addXaxisAnnotation(E,b,x);break;case"yaxis":this.addYaxisAnnotation(E,b,x);break;case"point":this.addPointAnnotation(E,b,x)}var R=y.globals.dom.baseEl.querySelector(".apexcharts-".concat(d,"-annotations .apexcharts-").concat(d,"-annotation-label[rel='").concat(x,"']")),P=this.helpers.addBackgroundToAnno(R,E);return P&&b.insertBefore(P.node,R),s&&y.globals.memory.methodsToExec.push({context:r,id:E.id?E.id:ni.randomId(),method:A,label:"addAnnotation",params:i}),c}},{key:"clearAnnotations",value:function(e){for(var i=e.w,s=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-annotations, .apexcharts-xaxis-annotations, .apexcharts-point-annotations"),c=i.globals.memory.methodsToExec.length-1;c>=0;c--)i.globals.memory.methodsToExec[c].label!=="addText"&&i.globals.memory.methodsToExec[c].label!=="addAnnotation"||i.globals.memory.methodsToExec.splice(c,1);s=ni.listToArray(s),Array.prototype.forEach.call(s,function(d){for(;d.firstChild;)d.removeChild(d.firstChild)})}},{key:"removeAnnotation",value:function(e,i){var s=e.w,c=s.globals.dom.baseEl.querySelectorAll(".".concat(i));c&&(s.globals.memory.methodsToExec.map(function(d,A){d.id===i&&s.globals.memory.methodsToExec.splice(A,1)}),Object.keys(s.config.annotations).forEach(function(d){var A=s.config.annotations[d];Array.isArray(A)&&(s.config.annotations[d]=A.filter(function(r){return r.id!==i}))}),Array.prototype.forEach.call(c,function(d){d.parentElement.removeChild(d)}))}}]),a}(),nb=function(a){var e,i=a.isTimeline,s=a.ctx,c=a.seriesIndex,d=a.dataPointIndex,A=a.y1,r=a.y2,y=a.w,b=y.globals.seriesRangeStart[c][d],x=y.globals.seriesRangeEnd[c][d],B=y.globals.labels[d],T=y.config.series[c].name?y.config.series[c].name:"",E=y.globals.ttKeyFormatter,R=y.config.tooltip.y.title.formatter,P={w:y,seriesIndex:c,dataPointIndex:d,start:b,end:x};typeof R=="function"&&(T=R(T,P)),(e=y.config.series[c].data[d])!==null&&e!==void 0&&e.x&&(B=y.config.series[c].data[d].x),i||y.config.xaxis.type==="datetime"&&(B=new Zy(s).xLabelFormat(y.globals.ttKeyFormatter,B,B,{i:void 0,dateFormatter:new Pc(s).formatDate,w:y})),typeof E=="function"&&(B=E(B,P)),Number.isFinite(A)&&Number.isFinite(r)&&(b=A,x=r);var G="",U="",Q=y.globals.colors[c];if(y.config.tooltip.x.formatter===void 0)if(y.config.xaxis.type==="datetime"){var q=new Pc(s);G=q.formatDate(q.getDate(b),y.config.tooltip.x.format),U=q.formatDate(q.getDate(x),y.config.tooltip.x.format)}else G=b,U=x;else G=y.config.tooltip.x.formatter(b),U=y.config.tooltip.x.formatter(x);return{start:b,end:x,startVal:G,endVal:U,ylabel:B,color:Q,seriesName:T}},sb=function(a){var e=a.color,i=a.seriesName,s=a.ylabel,c=a.start,d=a.end,A=a.seriesIndex,r=a.dataPointIndex,y=a.ctx.tooltip.tooltipLabels.getFormatters(A);c=y.yLbFormatter(c),d=y.yLbFormatter(d);var b=y.yLbFormatter(a.w.globals.series[A][r]),x=`<span class="value start-value">
  `.concat(c,`
  </span> <span class="separator">-</span> <span class="value end-value">
  `).concat(d,`
  </span>`);return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+e+'">'+(i||"")+'</span></div><div> <span class="category">'+s+": </span> "+(a.w.globals.comboCharts?a.w.config.series[A].type==="rangeArea"||a.w.config.series[A].type==="rangeBar"?x:"<span>".concat(b,"</span>"):x)+" </div></div>"},Dy=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"hideYAxis",value:function(){this.opts.yaxis[0].show=!1,this.opts.yaxis[0].title.text="",this.opts.yaxis[0].axisBorder.show=!1,this.opts.yaxis[0].axisTicks.show=!1,this.opts.yaxis[0].floating=!0}},{key:"line",value:function(){return{dataLabels:{enabled:!1},stroke:{width:5,curve:"straight"},markers:{size:0,hover:{sizeOffset:6}},xaxis:{crosshairs:{width:1}}}}},{key:"sparkline",value:function(e){return this.hideYAxis(),ni.extend(e,{grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},legend:{show:!1},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}},chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1}})}},{key:"slope",value:function(){return this.hideYAxis(),{chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!0,formatter:function(e,i){var s=i.w.config.series[i.seriesIndex].name;return e!==null?s+": "+e:""},background:{enabled:!1},offsetX:-5},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},xaxis:{position:"top",labels:{style:{fontSize:14,fontWeight:900}},tooltip:{enabled:!1},crosshairs:{show:!1}},markers:{size:8,hover:{sizeOffset:1}},legend:{show:!1},tooltip:{shared:!1,intersect:!0,followCursor:!0},stroke:{width:5,curve:"straight"}}}},{key:"bar",value:function(){return{chart:{stacked:!1},plotOptions:{bar:{dataLabels:{position:"center"}}},dataLabels:{style:{colors:["#fff"]},background:{enabled:!1}},stroke:{width:0,lineCap:"square"},fill:{opacity:.85},legend:{markers:{shape:"square"}},tooltip:{shared:!1,intersect:!0},xaxis:{tooltip:{enabled:!1},tickPlacement:"between",crosshairs:{width:"barWidth",position:"back",fill:{type:"gradient"},dropShadow:{enabled:!1},stroke:{width:0}}}}}},{key:"funnel",value:function(){return this.hideYAxis(),Tr(Tr({},this.bar()),{},{chart:{animations:{speed:800,animateGradually:{enabled:!1}}},plotOptions:{bar:{horizontal:!0,borderRadiusApplication:"around",borderRadius:0,dataLabels:{position:"center"}}},grid:{show:!1,padding:{left:0,right:0}},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}}})}},{key:"candlestick",value:function(){var e=this;return{stroke:{width:1},fill:{opacity:1},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(i){var s=i.seriesIndex,c=i.dataPointIndex,d=i.w;return e._getBoxTooltip(d,s,c,["Open","High","","Low","Close"],"candlestick")}},states:{active:{filter:{type:"none"}}},xaxis:{crosshairs:{width:1}}}}},{key:"boxPlot",value:function(){var e=this;return{chart:{animations:{dynamicAnimation:{enabled:!1}}},stroke:{width:1,colors:["#24292e"]},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(i){var s=i.seriesIndex,c=i.dataPointIndex,d=i.w;return e._getBoxTooltip(d,s,c,["Minimum","Q1","Median","Q3","Maximum"],"boxPlot")}},markers:{size:7,strokeWidth:1,strokeColors:"#111"},xaxis:{crosshairs:{width:1}}}}},{key:"rangeBar",value:function(){return{chart:{animations:{animateGradually:!1}},stroke:{width:0,lineCap:"square"},plotOptions:{bar:{borderRadius:0,dataLabels:{position:"center"}}},dataLabels:{enabled:!1,formatter:function(e,i){i.ctx;var s=i.seriesIndex,c=i.dataPointIndex,d=i.w,A=function(){var r=d.globals.seriesRangeStart[s][c];return d.globals.seriesRangeEnd[s][c]-r};return d.globals.comboCharts?d.config.series[s].type==="rangeBar"||d.config.series[s].type==="rangeArea"?A():e:A()},background:{enabled:!1},style:{colors:["#fff"]}},markers:{size:10},tooltip:{shared:!1,followCursor:!0,custom:function(e){return e.w.config.plotOptions&&e.w.config.plotOptions.bar&&e.w.config.plotOptions.bar.horizontal?function(i){var s=nb(Tr(Tr({},i),{},{isTimeline:!0})),c=s.color,d=s.seriesName,A=s.ylabel,r=s.startVal,y=s.endVal;return sb(Tr(Tr({},i),{},{color:c,seriesName:d,ylabel:A,start:r,end:y}))}(e):function(i){var s=nb(i),c=s.color,d=s.seriesName,A=s.ylabel,r=s.start,y=s.end;return sb(Tr(Tr({},i),{},{color:c,seriesName:d,ylabel:A,start:r,end:y}))}(e)}},xaxis:{tickPlacement:"between",tooltip:{enabled:!1},crosshairs:{stroke:{width:0}}}}}},{key:"dumbbell",value:function(e){var i,s;return(i=e.plotOptions.bar)!==null&&i!==void 0&&i.barHeight||(e.plotOptions.bar.barHeight=2),(s=e.plotOptions.bar)!==null&&s!==void 0&&s.columnWidth||(e.plotOptions.bar.columnWidth=2),e}},{key:"area",value:function(){return{stroke:{width:4,fill:{type:"solid",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}}},fill:{type:"gradient",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}},markers:{size:0,hover:{sizeOffset:6}},tooltip:{followCursor:!1}}}},{key:"rangeArea",value:function(){return{stroke:{curve:"straight",width:0},fill:{type:"solid",opacity:.6},markers:{size:0},states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}},tooltip:{intersect:!1,shared:!0,followCursor:!0,custom:function(e){return function(i){var s=nb(i),c=s.color,d=s.seriesName,A=s.ylabel,r=s.start,y=s.end;return sb(Tr(Tr({},i),{},{color:c,seriesName:d,ylabel:A,start:r,end:y}))}(e)}}}}},{key:"brush",value:function(e){return ni.extend(e,{chart:{toolbar:{autoSelected:"selection",show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{width:1},tooltip:{enabled:!1},xaxis:{tooltip:{enabled:!1}}})}},{key:"stacked100",value:function(e){e.dataLabels=e.dataLabels||{},e.dataLabels.formatter=e.dataLabels.formatter||void 0;var i=e.dataLabels.formatter;return e.yaxis.forEach(function(s,c){e.yaxis[c].min=0,e.yaxis[c].max=100}),e.chart.type==="bar"&&(e.dataLabels.formatter=i||function(s){return typeof s=="number"&&s?s.toFixed(0)+"%":s}),e}},{key:"stackedBars",value:function(){var e=this.bar();return Tr(Tr({},e),{},{plotOptions:Tr(Tr({},e.plotOptions),{},{bar:Tr(Tr({},e.plotOptions.bar),{},{borderRadiusApplication:"end",borderRadiusWhenStacked:"last"})})})}},{key:"convertCatToNumeric",value:function(e){return e.xaxis.convertedCatToNumeric=!0,e}},{key:"convertCatToNumericXaxis",value:function(e,i,s){e.xaxis.type="numeric",e.xaxis.labels=e.xaxis.labels||{},e.xaxis.labels.formatter=e.xaxis.labels.formatter||function(A){return ni.isNumber(A)?Math.floor(A):A};var c=e.xaxis.labels.formatter,d=e.xaxis.categories&&e.xaxis.categories.length?e.xaxis.categories:e.labels;return s&&s.length&&(d=s.map(function(A){return Array.isArray(A)?A:String(A)})),d&&d.length&&(e.xaxis.labels.formatter=function(A){return ni.isNumber(A)?c(d[Math.floor(A)-1]):c(A)}),e.xaxis.categories=[],e.labels=[],e.xaxis.tickAmount=e.xaxis.tickAmount||"dataPoints",e}},{key:"bubble",value:function(){return{dataLabels:{style:{colors:["#fff"]}},tooltip:{shared:!1,intersect:!0},xaxis:{crosshairs:{width:0}},fill:{type:"solid",gradient:{shade:"light",inverse:!0,shadeIntensity:.55,opacityFrom:.4,opacityTo:.8}}}}},{key:"scatter",value:function(){return{dataLabels:{enabled:!1},tooltip:{shared:!1,intersect:!0},markers:{size:6,strokeWidth:1,hover:{sizeOffset:2}}}}},{key:"heatmap",value:function(){return{chart:{stacked:!1},fill:{opacity:1},dataLabels:{style:{colors:["#fff"]}},stroke:{colors:["#fff"]},tooltip:{followCursor:!0,marker:{show:!1},x:{show:!1}},legend:{position:"top",markers:{shape:"square"}},grid:{padding:{right:20}}}}},{key:"treemap",value:function(){return{chart:{zoom:{enabled:!1}},dataLabels:{style:{fontSize:14,fontWeight:600,colors:["#fff"]}},stroke:{show:!0,width:2,colors:["#fff"]},legend:{show:!1},fill:{opacity:1,gradient:{stops:[0,100]}},tooltip:{followCursor:!0,x:{show:!1}},grid:{padding:{left:0,right:0}},xaxis:{crosshairs:{show:!1},tooltip:{enabled:!1}}}}},{key:"pie",value:function(){return{chart:{toolbar:{show:!1}},plotOptions:{pie:{donut:{labels:{show:!1}}}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",stops:[0,100]}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"donut",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",shadeIntensity:.35,stops:[80,100],opacityFrom:1,opacityTo:1}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"polarArea",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},enabled:!1},stroke:{show:!0,width:2},fill:{opacity:.7},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"radar",value:function(){return this.opts.yaxis[0].labels.offsetY=this.opts.yaxis[0].labels.offsetY?this.opts.yaxis[0].labels.offsetY:6,{dataLabels:{enabled:!1,style:{fontSize:"11px"}},stroke:{width:2},markers:{size:5,strokeWidth:1,strokeOpacity:1},fill:{opacity:.2},tooltip:{shared:!1,intersect:!0,followCursor:!0},grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},xaxis:{labels:{formatter:function(e){return e},style:{colors:["#a8a8a8"],fontSize:"11px"}},tooltip:{enabled:!1},crosshairs:{show:!1}}}}},{key:"radialBar",value:function(){return{chart:{animations:{dynamicAnimation:{enabled:!0,speed:800}},toolbar:{show:!1}},fill:{gradient:{shade:"dark",shadeIntensity:.4,inverseColors:!1,type:"diagonal2",opacityFrom:1,opacityTo:1,stops:[70,98,100]}},legend:{show:!1,position:"right"},tooltip:{enabled:!1,fillSeriesColor:!0},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"_getBoxTooltip",value:function(e,i,s,c,d){var A=e.globals.seriesCandleO[i][s],r=e.globals.seriesCandleH[i][s],y=e.globals.seriesCandleM[i][s],b=e.globals.seriesCandleL[i][s],x=e.globals.seriesCandleC[i][s];return e.config.series[i].type&&e.config.series[i].type!==d?`<div class="apexcharts-custom-tooltip">
          `.concat(e.config.series[i].name?e.config.series[i].name:"series-"+(i+1),": <strong>").concat(e.globals.series[i][s],`</strong>
        </div>`):'<div class="apexcharts-tooltip-box apexcharts-tooltip-'.concat(e.config.chart.type,'">')+"<div>".concat(c[0],': <span class="value">')+A+"</span></div>"+"<div>".concat(c[1],': <span class="value">')+r+"</span></div>"+(y?"<div>".concat(c[2],': <span class="value">')+y+"</span></div>":"")+"<div>".concat(c[3],': <span class="value">')+b+"</span></div>"+"<div>".concat(c[4],': <span class="value">')+x+"</span></div></div>"}}]),a}(),Oy=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"init",value:function(e){var i=e.responsiveOverride,s=this.opts,c=new eg,d=new Dy(s);this.chartType=s.chart.type,s=this.extendYAxis(s),s=this.extendAnnotations(s);var A=c.init(),r={};if(s&&sm(s)==="object"){var y,b,x,B,T,E,R,P,G,U,Q={};Q=["line","area","bar","candlestick","boxPlot","rangeBar","rangeArea","bubble","scatter","heatmap","treemap","pie","polarArea","donut","radar","radialBar"].indexOf(s.chart.type)!==-1?d[s.chart.type]():d.line(),(y=s.plotOptions)!==null&&y!==void 0&&(b=y.bar)!==null&&b!==void 0&&b.isFunnel&&(Q=d.funnel()),s.chart.stacked&&s.chart.type==="bar"&&(Q=d.stackedBars()),(x=s.chart.brush)!==null&&x!==void 0&&x.enabled&&(Q=d.brush(Q)),(B=s.plotOptions)!==null&&B!==void 0&&(T=B.line)!==null&&T!==void 0&&T.isSlopeChart&&(Q=d.slope()),s.chart.stacked&&s.chart.stackType==="100%"&&(s=d.stacked100(s)),(E=s.plotOptions)!==null&&E!==void 0&&(R=E.bar)!==null&&R!==void 0&&R.isDumbbell&&(s=d.dumbbell(s)),this.checkForDarkTheme(window.Apex),this.checkForDarkTheme(s),s.xaxis=s.xaxis||window.Apex.xaxis||{},i||(s.xaxis.convertedCatToNumeric=!1),((P=(s=this.checkForCatToNumericXAxis(this.chartType,Q,s)).chart.sparkline)!==null&&P!==void 0&&P.enabled||(G=window.Apex.chart)!==null&&G!==void 0&&(U=G.sparkline)!==null&&U!==void 0&&U.enabled)&&(Q=d.sparkline(Q)),r=ni.extend(A,Q)}var q=ni.extend(r,window.Apex);return A=ni.extend(q,s),A=this.handleUserInputErrors(A)}},{key:"checkForCatToNumericXAxis",value:function(e,i,s){var c,d,A=new Dy(s),r=(e==="bar"||e==="boxPlot")&&((c=s.plotOptions)===null||c===void 0||(d=c.bar)===null||d===void 0?void 0:d.horizontal),y=e==="pie"||e==="polarArea"||e==="donut"||e==="radar"||e==="radialBar"||e==="heatmap",b=s.xaxis.type!=="datetime"&&s.xaxis.type!=="numeric",x=s.xaxis.tickPlacement?s.xaxis.tickPlacement:i.xaxis&&i.xaxis.tickPlacement;return r||y||!b||x==="between"||(s=A.convertCatToNumeric(s)),s}},{key:"extendYAxis",value:function(e,i){var s=new eg;(e.yaxis===void 0||!e.yaxis||Array.isArray(e.yaxis)&&e.yaxis.length===0)&&(e.yaxis={}),e.yaxis.constructor!==Array&&window.Apex.yaxis&&window.Apex.yaxis.constructor!==Array&&(e.yaxis=ni.extend(e.yaxis,window.Apex.yaxis)),e.yaxis.constructor!==Array?e.yaxis=[ni.extend(s.yAxis,e.yaxis)]:e.yaxis=ni.extendArray(e.yaxis,s.yAxis);var c=!1;e.yaxis.forEach(function(A){A.logarithmic&&(c=!0)});var d=e.series;return i&&!d&&(d=i.config.series),c&&d.length!==e.yaxis.length&&d.length&&(e.yaxis=d.map(function(A,r){if(A.name||(d[r].name="series-".concat(r+1)),e.yaxis[r])return e.yaxis[r].seriesName=d[r].name,e.yaxis[r];var y=ni.extend(s.yAxis,e.yaxis[0]);return y.show=!1,y})),c&&d.length>1&&d.length!==e.yaxis.length&&console.warn("A multi-series logarithmic chart should have equal number of series and y-axes"),e}},{key:"extendAnnotations",value:function(e){return e.annotations===void 0&&(e.annotations={},e.annotations.yaxis=[],e.annotations.xaxis=[],e.annotations.points=[]),e=this.extendYAxisAnnotations(e),e=this.extendXAxisAnnotations(e),e=this.extendPointAnnotations(e)}},{key:"extendYAxisAnnotations",value:function(e){var i=new eg;return e.annotations.yaxis=ni.extendArray(e.annotations.yaxis!==void 0?e.annotations.yaxis:[],i.yAxisAnnotation),e}},{key:"extendXAxisAnnotations",value:function(e){var i=new eg;return e.annotations.xaxis=ni.extendArray(e.annotations.xaxis!==void 0?e.annotations.xaxis:[],i.xAxisAnnotation),e}},{key:"extendPointAnnotations",value:function(e){var i=new eg;return e.annotations.points=ni.extendArray(e.annotations.points!==void 0?e.annotations.points:[],i.pointAnnotation),e}},{key:"checkForDarkTheme",value:function(e){e.theme&&e.theme.mode==="dark"&&(e.tooltip||(e.tooltip={}),e.tooltip.theme!=="light"&&(e.tooltip.theme="dark"),e.chart.foreColor||(e.chart.foreColor="#f6f7f8"),e.theme.palette||(e.theme.palette="palette4"))}},{key:"handleUserInputErrors",value:function(e){var i=e;if(i.tooltip.shared&&i.tooltip.intersect)throw new Error("tooltip.shared cannot be enabled when tooltip.intersect is true. Turn off any other option by setting it to false.");if(i.chart.type==="bar"&&i.plotOptions.bar.horizontal){if(i.yaxis.length>1)throw new Error("Multiple Y Axis for bars are not supported. Switch to column chart by setting plotOptions.bar.horizontal=false");i.yaxis[0].reversed&&(i.yaxis[0].opposite=!0),i.xaxis.tooltip.enabled=!1,i.yaxis[0].tooltip.enabled=!1,i.chart.zoom.enabled=!1}return i.chart.type!=="bar"&&i.chart.type!=="rangeBar"||i.tooltip.shared&&i.xaxis.crosshairs.width==="barWidth"&&i.series.length>1&&(i.xaxis.crosshairs.width="tickWidth"),i.chart.type!=="candlestick"&&i.chart.type!=="boxPlot"||i.yaxis[0].reversed&&(console.warn("Reversed y-axis in ".concat(i.chart.type," chart is not supported.")),i.yaxis[0].reversed=!1),i}}]),a}(),QT=function(){function a(){en(this,a)}return tn(a,[{key:"initGlobalVars",value:function(e){e.series=[],e.seriesCandleO=[],e.seriesCandleH=[],e.seriesCandleM=[],e.seriesCandleL=[],e.seriesCandleC=[],e.seriesRangeStart=[],e.seriesRangeEnd=[],e.seriesRange=[],e.seriesPercent=[],e.seriesGoals=[],e.seriesX=[],e.seriesZ=[],e.seriesNames=[],e.seriesTotals=[],e.seriesLog=[],e.seriesColors=[],e.stackedSeriesTotals=[],e.seriesXvalues=[],e.seriesYvalues=[],e.labels=[],e.hasXaxisGroups=!1,e.groups=[],e.barGroups=[],e.lineGroups=[],e.areaGroups=[],e.hasSeriesGroups=!1,e.seriesGroups=[],e.categoryLabels=[],e.timescaleLabels=[],e.noLabelsProvided=!1,e.resizeTimer=null,e.selectionResizeTimer=null,e.lastWheelExecution=0,e.delayedElements=[],e.pointsArray=[],e.dataLabelsRects=[],e.isXNumeric=!1,e.skipLastTimelinelabel=!1,e.skipFirstTimelinelabel=!1,e.isDataXYZ=!1,e.isMultiLineX=!1,e.isMultipleYAxis=!1,e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE,e.minYArr=[],e.maxYArr=[],e.maxX=-Number.MAX_VALUE,e.minX=Number.MAX_VALUE,e.initialMaxX=-Number.MAX_VALUE,e.initialMinX=Number.MAX_VALUE,e.maxDate=0,e.minDate=Number.MAX_VALUE,e.minZ=Number.MAX_VALUE,e.maxZ=-Number.MAX_VALUE,e.minXDiff=Number.MAX_VALUE,e.yAxisScale=[],e.xAxisScale=null,e.xAxisTicksPositions=[],e.yLabelsCoords=[],e.yTitleCoords=[],e.barPadForNumericAxis=0,e.padHorizontal=0,e.xRange=0,e.yRange=[],e.zRange=0,e.dataPoints=0,e.xTickAmount=0,e.multiAxisTickAmount=0}},{key:"globalVars",value:function(e){return{chartID:null,cuid:null,events:{beforeMount:[],mounted:[],updated:[],clicked:[],selection:[],dataPointSelection:[],zoomed:[],scrolled:[]},colors:[],clientX:null,clientY:null,fill:{colors:[]},stroke:{colors:[]},dataLabels:{style:{colors:[]}},radarPolygons:{fill:{colors:[]}},markers:{colors:[],size:e.markers.size,largestSize:0},animationEnded:!1,isTouchDevice:"ontouchstart"in window||navigator.msMaxTouchPoints,isDirty:!1,isExecCalled:!1,initialConfig:null,initialSeries:[],lastXAxis:[],lastYAxis:[],columnSeries:null,labels:[],timescaleLabels:[],noLabelsProvided:!1,allSeriesCollapsed:!1,collapsedSeries:[],collapsedSeriesIndices:[],ancillaryCollapsedSeries:[],ancillaryCollapsedSeriesIndices:[],risingSeries:[],dataFormatXNumeric:!1,capturedSeriesIndex:-1,capturedDataPointIndex:-1,selectedDataPoints:[],invalidLogScale:!1,ignoreYAxisIndexes:[],maxValsInArrayIndex:0,radialSize:0,selection:void 0,zoomEnabled:e.chart.toolbar.autoSelected==="zoom"&&e.chart.toolbar.tools.zoom&&e.chart.zoom.enabled,panEnabled:e.chart.toolbar.autoSelected==="pan"&&e.chart.toolbar.tools.pan,selectionEnabled:e.chart.toolbar.autoSelected==="selection"&&e.chart.toolbar.tools.selection,yaxis:null,mousedown:!1,lastClientPosition:{},visibleXRange:void 0,yValueDecimal:0,total:0,SVGNS:"http://www.w3.org/2000/svg",svgWidth:0,svgHeight:0,noData:!1,locale:{},dom:{},memory:{methodsToExec:[]},shouldAnimate:!0,skipLastTimelinelabel:!1,skipFirstTimelinelabel:!1,delayedElements:[],axisCharts:!0,isDataXYZ:!1,isSlopeChart:e.plotOptions.line.isSlopeChart,resized:!1,resizeTimer:null,comboCharts:!1,dataChanged:!1,previousPaths:[],allSeriesHasEqualX:!0,pointsArray:[],dataLabelsRects:[],lastDrawnDataLabelsIndexes:[],hasNullValues:!1,zoomed:!1,gridWidth:0,gridHeight:0,rotateXLabels:!1,defaultLabels:!1,xLabelFormatter:void 0,yLabelFormatters:[],xaxisTooltipFormatter:void 0,ttKeyFormatter:void 0,ttVal:void 0,ttZFormatter:void 0,LINE_HEIGHT_RATIO:1.618,xAxisLabelsHeight:0,xAxisGroupLabelsHeight:0,xAxisLabelsWidth:0,yAxisLabelsWidth:0,scaleX:1,scaleY:1,translateX:0,translateY:0,translateYAxisX:[],yAxisWidths:[],translateXAxisY:0,translateXAxisX:0,tooltip:null,niceScaleAllowedMagMsd:[[1,1,2,5,5,5,10,10,10,10,10],[1,1,2,5,5,5,10,10,10,10,10]],niceScaleDefaultTicks:[1,2,4,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,12,12,12,12,12,12,12,12,12,24],seriesYAxisMap:[],seriesYAxisReverseMap:[]}}},{key:"init",value:function(e){var i=this.globalVars(e);return this.initGlobalVars(i),i.initialConfig=ni.extend({},e),i.initialSeries=ni.clone(e.series),i.lastXAxis=ni.clone(i.initialConfig.xaxis),i.lastYAxis=ni.clone(i.initialConfig.yaxis),i}}]),a}(),jR=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"init",value:function(){var e=new Oy(this.opts).init({responsiveOverride:!1});return{config:e,globals:new QT().init(e)}}}]),a}(),Yd=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.opts=null,this.seriesIndex=0,this.patternIDs=[]}return tn(a,[{key:"clippedImgArea",value:function(e){var i=this.w,s=i.config,c=parseInt(i.globals.gridWidth,10),d=parseInt(i.globals.gridHeight,10),A=c>d?c:d,r=e.image,y=0,b=0;e.width===void 0&&e.height===void 0?s.fill.image.width!==void 0&&s.fill.image.height!==void 0?(y=s.fill.image.width+1,b=s.fill.image.height):(y=A+1,b=A):(y=e.width,b=e.height);var x=document.createElementNS(i.globals.SVGNS,"pattern");ur.setAttrs(x,{id:e.patternID,patternUnits:e.patternUnits?e.patternUnits:"userSpaceOnUse",width:y+"px",height:b+"px"});var B=document.createElementNS(i.globals.SVGNS,"image");x.appendChild(B),B.setAttributeNS(window.SVG.xlink,"href",r),ur.setAttrs(B,{x:0,y:0,preserveAspectRatio:"none",width:y+"px",height:b+"px"}),B.style.opacity=e.opacity,i.globals.dom.elDefs.node.appendChild(x)}},{key:"getSeriesIndex",value:function(e){var i=this.w,s=i.config.chart.type;return(s==="bar"||s==="rangeBar")&&i.config.plotOptions.bar.distributed||s==="heatmap"||s==="treemap"?this.seriesIndex=e.seriesNumber:this.seriesIndex=e.seriesNumber%i.globals.series.length,this.seriesIndex}},{key:"computeColorStops",value:function(e,i){var s,c=this.w,d=null,A=null,r=ly(e);try{for(r.s();!(s=r.n()).done;){var y=s.value;y>=i.threshold?(d===null||y>d)&&(d=y):(A===null||y<A)&&(A=y)}}catch(B){r.e(B)}finally{r.f()}d===null&&(d=i.threshold),A===null&&(A=i.threshold);var b=d-i.threshold+(i.threshold-A);b===0&&(b=1);var x=100-(i.threshold-A)/b*100;return[{offset:x=Math.max(0,Math.min(x,100)),color:i.colorAboveThreshold,opacity:c.config.fill.opacity},{offset:0,color:i.colorBelowThreshold,opacity:c.config.fill.opacity}]}},{key:"fillPath",value:function(e){var i,s,c,d=this.w;this.opts=e;var A,r,y,b=this.w.config;this.seriesIndex=this.getSeriesIndex(e);var x=b.plotOptions.line.colors.colorAboveThreshold&&b.plotOptions.line.colors.colorBelowThreshold,B=this.getFillColors()[this.seriesIndex];d.globals.seriesColors[this.seriesIndex]!==void 0&&(B=d.globals.seriesColors[this.seriesIndex]),typeof B=="function"&&(B=B({seriesIndex:this.seriesIndex,dataPointIndex:e.dataPointIndex,value:e.value,w:d}));var T,E,R,P=e.fillType?e.fillType:this.getFillType(this.seriesIndex),G=Array.isArray(b.fill.opacity)?b.fill.opacity[this.seriesIndex]:b.fill.opacity,U=P==="gradient"||x;e.color&&(B=e.color),(i=d.config.series[this.seriesIndex])!==null&&i!==void 0&&(s=i.data)!==null&&s!==void 0&&(c=s[e.dataPointIndex])!==null&&c!==void 0&&c.fillColor&&(B=(T=d.config.series[this.seriesIndex])===null||T===void 0||(E=T.data)===null||E===void 0||(R=E[e.dataPointIndex])===null||R===void 0?void 0:R.fillColor),B||(B="#fff",console.warn("undefined color - ApexCharts"));var Q=B;if(B.indexOf("rgb")===-1?B.indexOf("#")===-1?Q=B:B.length<9&&(Q=ni.hexToRgba(B,G)):B.indexOf("rgba")>-1?G=ni.getOpacityFromRGBA(B):Q=ni.hexToRgba(ni.rgb2hex(B),G),e.opacity&&(G=e.opacity),P==="pattern"&&(r=this.handlePatternFill({fillConfig:e.fillConfig,patternFill:r,fillColor:B,fillOpacity:G,defaultColor:Q})),U){var q=Kl(b.fill.gradient.colorStops)||[],ne=b.fill.gradient.type;x&&(q[this.seriesIndex]=this.computeColorStops(d.globals.series[this.seriesIndex],b.plotOptions.line.colors),ne="vertical"),y=this.handleGradientFill({type:ne,fillConfig:e.fillConfig,fillColor:B,fillOpacity:G,colorStops:q,i:this.seriesIndex})}if(P==="image"){var re=b.fill.image.src,pe=e.patternID?e.patternID:"",fe="pattern".concat(d.globals.cuid).concat(e.seriesNumber+1).concat(pe);this.patternIDs.indexOf(fe)===-1&&(this.clippedImgArea({opacity:G,image:Array.isArray(re)?e.seriesNumber<re.length?re[e.seriesNumber]:re[0]:re,width:e.width?e.width:void 0,height:e.height?e.height:void 0,patternUnits:e.patternUnits,patternID:fe}),this.patternIDs.push(fe)),A="url(#".concat(fe,")")}else A=U?y:P==="pattern"?r:Q;return e.solid&&(A=Q),A}},{key:"getFillType",value:function(e){var i=this.w;return Array.isArray(i.config.fill.type)?i.config.fill.type[e]:i.config.fill.type}},{key:"getFillColors",value:function(){var e=this.w,i=e.config,s=this.opts,c=[];return e.globals.comboCharts?e.config.series[this.seriesIndex].type==="line"?Array.isArray(e.globals.stroke.colors)?c=e.globals.stroke.colors:c.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?c=e.globals.fill.colors:c.push(e.globals.fill.colors):i.chart.type==="line"?Array.isArray(e.globals.stroke.colors)?c=e.globals.stroke.colors:c.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?c=e.globals.fill.colors:c.push(e.globals.fill.colors),s.fillColors!==void 0&&(c=[],Array.isArray(s.fillColors)?c=s.fillColors.slice():c.push(s.fillColors)),c}},{key:"handlePatternFill",value:function(e){var i=e.fillConfig,s=e.patternFill,c=e.fillColor,d=e.fillOpacity,A=e.defaultColor,r=this.w.config.fill;i&&(r=i);var y=this.opts,b=new ur(this.ctx),x=Array.isArray(r.pattern.strokeWidth)?r.pattern.strokeWidth[this.seriesIndex]:r.pattern.strokeWidth,B=c;return Array.isArray(r.pattern.style)?s=r.pattern.style[y.seriesNumber]!==void 0?b.drawPattern(r.pattern.style[y.seriesNumber],r.pattern.width,r.pattern.height,B,x,d):A:s=b.drawPattern(r.pattern.style,r.pattern.width,r.pattern.height,B,x,d),s}},{key:"handleGradientFill",value:function(e){var i=e.type,s=e.fillColor,c=e.fillOpacity,d=e.fillConfig,A=e.colorStops,r=e.i,y=this.w.config.fill;d&&(y=Tr(Tr({},y),d));var b=this.opts,x=new ur(this.ctx),B=new ni;i=i||y.gradient.type;var T,E=s,R=y.gradient.opacityFrom===void 0?c:Array.isArray(y.gradient.opacityFrom)?y.gradient.opacityFrom[r]:y.gradient.opacityFrom;E.indexOf("rgba")>-1&&(R=ni.getOpacityFromRGBA(E));var P=y.gradient.opacityTo===void 0?c:Array.isArray(y.gradient.opacityTo)?y.gradient.opacityTo[r]:y.gradient.opacityTo;if(y.gradient.gradientToColors===void 0||y.gradient.gradientToColors.length===0)T=y.gradient.shade==="dark"?B.shadeColor(-1*parseFloat(y.gradient.shadeIntensity),s.indexOf("rgb")>-1?ni.rgb2hex(s):s):B.shadeColor(parseFloat(y.gradient.shadeIntensity),s.indexOf("rgb")>-1?ni.rgb2hex(s):s);else if(y.gradient.gradientToColors[b.seriesNumber]){var G=y.gradient.gradientToColors[b.seriesNumber];T=G,G.indexOf("rgba")>-1&&(P=ni.getOpacityFromRGBA(G))}else T=s;if(y.gradient.gradientFrom&&(E=y.gradient.gradientFrom),y.gradient.gradientTo&&(T=y.gradient.gradientTo),y.gradient.inverseColors){var U=E;E=T,T=U}return E.indexOf("rgb")>-1&&(E=ni.rgb2hex(E)),T.indexOf("rgb")>-1&&(T=ni.rgb2hex(T)),x.drawGradient(i,E,T,R,P,b.size,y.gradient.stops,A,r)}}]),a}(),Am=function(){function a(e,i){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"setGlobalMarkerSize",value:function(){var e=this.w;if(e.globals.markers.size=Array.isArray(e.config.markers.size)?e.config.markers.size:[e.config.markers.size],e.globals.markers.size.length>0){if(e.globals.markers.size.length<e.globals.series.length+1)for(var i=0;i<=e.globals.series.length;i++)e.globals.markers.size[i]===void 0&&e.globals.markers.size.push(e.globals.markers.size[0])}else e.globals.markers.size=e.config.series.map(function(s){return e.config.markers.size})}},{key:"plotChartMarkers",value:function(e){var i=e.pointsPos,s=e.seriesIndex,c=e.j,d=e.pSize,A=e.alwaysDrawMarker,r=A!==void 0&&A,y=e.isVirtualPoint,b=y!==void 0&&y,x=this.w,B=s,T=i,E=null,R=new ur(this.ctx),P=x.config.markers.discrete&&x.config.markers.discrete.length;if(Array.isArray(T.x))for(var G=0;G<T.x.length;G++){var U=void 0,Q=c,q=!ni.isNumber(T.y[G]);x.globals.markers.largestSize===0&&x.globals.hasNullValues&&x.globals.series[B][c+1]!==null&&!b&&(q=!0),c===1&&G===0&&(Q=0),c===1&&G===1&&(Q=1);var ne="apexcharts-marker";if(x.config.chart.type!=="line"&&x.config.chart.type!=="area"||x.globals.comboCharts||x.config.tooltip.intersect||(ne+=" no-pointer-events"),(Array.isArray(x.config.markers.size)?x.globals.markers.size[s]>0:x.config.markers.size>0)||r||P){q||(ne+=" w".concat(ni.randomId()));var re=this.getMarkerConfig({cssClass:ne,seriesIndex:s,dataPointIndex:Q});x.config.series[B].data[Q]&&(x.config.series[B].data[Q].fillColor&&(re.pointFillColor=x.config.series[B].data[Q].fillColor),x.config.series[B].data[Q].strokeColor&&(re.pointStrokeColor=x.config.series[B].data[Q].strokeColor)),d!==void 0&&(re.pSize=d),(T.x[G]<-x.globals.markers.largestSize||T.x[G]>x.globals.gridWidth+x.globals.markers.largestSize||T.y[G]<-x.globals.markers.largestSize||T.y[G]>x.globals.gridHeight+x.globals.markers.largestSize)&&(re.pSize=0),!q&&((x.globals.markers.size[s]>0||r||P)&&!E&&(E=R.group({class:r||P?"":"apexcharts-series-markers"})).attr("clip-path","url(#gridRectMarkerMask".concat(x.globals.cuid,")")),(U=R.drawMarker(T.x[G],T.y[G],re)).attr("rel",Q),U.attr("j",Q),U.attr("index",s),U.node.setAttribute("default-marker-size",re.pSize),new Rc(this.ctx).setSelectionFilter(U,s,Q),this.addEvents(U),E&&E.add(U))}else x.globals.pointsArray[s]===void 0&&(x.globals.pointsArray[s]=[]),x.globals.pointsArray[s].push([T.x[G],T.y[G]])}return E}},{key:"getMarkerConfig",value:function(e){var i=e.cssClass,s=e.seriesIndex,c=e.dataPointIndex,d=c===void 0?null:c,A=e.radius,r=A===void 0?null:A,y=e.size,b=y===void 0?null:y,x=e.strokeWidth,B=x===void 0?null:x,T=this.w,E=this.getMarkerStyle(s),R=b===null?T.globals.markers.size[s]:b,P=T.config.markers;return d!==null&&P.discrete.length&&P.discrete.map(function(G){G.seriesIndex===s&&G.dataPointIndex===d&&(E.pointStrokeColor=G.strokeColor,E.pointFillColor=G.fillColor,R=G.size,E.pointShape=G.shape)}),{pSize:r===null?R:r,pRadius:r!==null?r:P.radius,pointStrokeWidth:B!==null?B:Array.isArray(P.strokeWidth)?P.strokeWidth[s]:P.strokeWidth,pointStrokeColor:E.pointStrokeColor,pointFillColor:E.pointFillColor,shape:E.pointShape||(Array.isArray(P.shape)?P.shape[s]:P.shape),class:i,pointStrokeOpacity:Array.isArray(P.strokeOpacity)?P.strokeOpacity[s]:P.strokeOpacity,pointStrokeDashArray:Array.isArray(P.strokeDashArray)?P.strokeDashArray[s]:P.strokeDashArray,pointFillOpacity:Array.isArray(P.fillOpacity)?P.fillOpacity[s]:P.fillOpacity,seriesIndex:s}}},{key:"addEvents",value:function(e){var i=this.w,s=new ur(this.ctx);e.node.addEventListener("mouseenter",s.pathMouseEnter.bind(this.ctx,e)),e.node.addEventListener("mouseleave",s.pathMouseLeave.bind(this.ctx,e)),e.node.addEventListener("mousedown",s.pathMouseDown.bind(this.ctx,e)),e.node.addEventListener("click",i.config.markers.onClick),e.node.addEventListener("dblclick",i.config.markers.onDblClick),e.node.addEventListener("touchstart",s.pathMouseDown.bind(this.ctx,e),{passive:!0})}},{key:"getMarkerStyle",value:function(e){var i=this.w,s=i.globals.markers.colors,c=i.config.markers.strokeColor||i.config.markers.strokeColors;return{pointStrokeColor:Array.isArray(c)?c[e]:c,pointFillColor:Array.isArray(s)?s[e]:s}}}]),a}(),VT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.initialAnim=this.w.config.chart.animations.enabled}return tn(a,[{key:"draw",value:function(e,i,s){var c=this.w,d=new ur(this.ctx),A=s.realIndex,r=s.pointsPos,y=s.zRatio,b=s.elParent,x=d.group({class:"apexcharts-series-markers apexcharts-series-".concat(c.config.chart.type)});if(x.attr("clip-path","url(#gridRectMarkerMask".concat(c.globals.cuid,")")),Array.isArray(r.x))for(var B=0;B<r.x.length;B++){var T=i+1,E=!0;i===0&&B===0&&(T=0),i===0&&B===1&&(T=1);var R=c.globals.markers.size[A];if(y!==1/0){var P=c.config.plotOptions.bubble;R=c.globals.seriesZ[A][T],P.zScaling&&(R/=y),P.minBubbleRadius&&R<P.minBubbleRadius&&(R=P.minBubbleRadius),P.maxBubbleRadius&&R>P.maxBubbleRadius&&(R=P.maxBubbleRadius)}var G=r.x[B],U=r.y[B];if(R=R||0,U!==null&&c.globals.series[A][T]!==void 0||(E=!1),E){var Q=this.drawPoint(G,U,R,A,T,i);x.add(Q)}b.add(x)}}},{key:"drawPoint",value:function(e,i,s,c,d,A){var r=this.w,y=c,b=new cm(this.ctx),x=new Rc(this.ctx),B=new Yd(this.ctx),T=new Am(this.ctx),E=new ur(this.ctx),R=T.getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:y,dataPointIndex:d,radius:r.config.chart.type==="bubble"||r.globals.comboCharts&&r.config.series[c]&&r.config.series[c].type==="bubble"?s:null}),P=B.fillPath({seriesNumber:c,dataPointIndex:d,color:R.pointFillColor,patternUnits:"objectBoundingBox",value:r.globals.series[c][A]}),G=E.drawMarker(e,i,R);if(r.config.series[y].data[d]&&r.config.series[y].data[d].fillColor&&(P=r.config.series[y].data[d].fillColor),G.attr({fill:P}),r.config.chart.dropShadow.enabled){var U=r.config.chart.dropShadow;x.dropShadow(G,U,c)}if(!this.initialAnim||r.globals.dataChanged||r.globals.resized)r.globals.animationEnded=!0;else{var Q=r.config.chart.animations.speed;b.animateMarker(G,Q,r.globals.easing,function(){window.setTimeout(function(){b.animationCompleted(G)},100)})}return G.attr({rel:d,j:d,index:c,"default-marker-size":R.pSize}),x.setSelectionFilter(G,c,d),T.addEvents(G),G.node.classList.add("apexcharts-marker"),G}},{key:"centerTextInBubble",value:function(e){var i=this.w;return{y:e+=parseInt(i.config.dataLabels.style.fontSize,10)/4}}}]),a}(),am=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"dataLabelsCorrection",value:function(e,i,s,c,d,A,r){var y=this.w,b=!1,x=new ur(this.ctx).getTextRects(s,r),B=x.width,T=x.height;i<0&&(i=0),i>y.globals.gridHeight+T&&(i=y.globals.gridHeight+T/2),y.globals.dataLabelsRects[c]===void 0&&(y.globals.dataLabelsRects[c]=[]),y.globals.dataLabelsRects[c].push({x:e,y:i,width:B,height:T});var E=y.globals.dataLabelsRects[c].length-2,R=y.globals.lastDrawnDataLabelsIndexes[c]!==void 0?y.globals.lastDrawnDataLabelsIndexes[c][y.globals.lastDrawnDataLabelsIndexes[c].length-1]:0;if(y.globals.dataLabelsRects[c][E]!==void 0){var P=y.globals.dataLabelsRects[c][R];(e>P.x+P.width||i>P.y+P.height||i+T<P.y||e+B<P.x)&&(b=!0)}return(d===0||A)&&(b=!0),{x:e,y:i,textRects:x,drawnextLabel:b}}},{key:"drawDataLabel",value:function(e){var i=this,s=e.type,c=e.pos,d=e.i,A=e.j,r=e.isRangeStart,y=e.strokeWidth,b=y===void 0?2:y,x=this.w,B=new ur(this.ctx),T=x.config.dataLabels,E=0,R=0,P=A,G=null;if(x.globals.collapsedSeriesIndices.indexOf(d)!==-1||!T.enabled||!Array.isArray(c.x))return G;G=B.group({class:"apexcharts-data-labels"});for(var U=0;U<c.x.length;U++)if(E=c.x[U]+T.offsetX,R=c.y[U]+T.offsetY+b,!isNaN(E)){A===1&&U===0&&(P=0),A===1&&U===1&&(P=1);var Q=x.globals.series[d][P];s==="rangeArea"&&(Q=r?x.globals.seriesRangeStart[d][P]:x.globals.seriesRangeEnd[d][P]);var q="",ne=function(pe){return x.config.dataLabels.formatter(pe,{ctx:i.ctx,seriesIndex:d,dataPointIndex:P,w:x})};x.config.chart.type==="bubble"?(q=ne(Q=x.globals.seriesZ[d][P]),R=c.y[U],R=new VT(this.ctx).centerTextInBubble(R,d,P).y):Q!==void 0&&(q=ne(Q));var re=x.config.dataLabels.textAnchor;x.globals.isSlopeChart&&(re=P===0?"end":P===x.config.series[d].data.length-1?"start":"middle"),this.plotDataLabelsText({x:E,y:R,text:q,i:d,j:P,parent:G,offsetCorrection:!0,dataLabelsConfig:x.config.dataLabels,textAnchor:re})}return G}},{key:"plotDataLabelsText",value:function(e){var i=this.w,s=new ur(this.ctx),c=e.x,d=e.y,A=e.i,r=e.j,y=e.text,b=e.textAnchor,x=e.fontSize,B=e.parent,T=e.dataLabelsConfig,E=e.color,R=e.alwaysDrawDataLabel,P=e.offsetCorrection,G=e.className,U=null;if(Array.isArray(i.config.dataLabels.enabledOnSeries)&&i.config.dataLabels.enabledOnSeries.indexOf(A)<0)return U;var Q={x:c,y:d,drawnextLabel:!0,textRects:null};P&&(Q=this.dataLabelsCorrection(c,d,y,A,r,R,parseInt(T.style.fontSize,10))),i.globals.zoomed||(c=Q.x,d=Q.y),Q.textRects&&(c<-20-Q.textRects.width||c>i.globals.gridWidth+Q.textRects.width+30)&&(y="");var q=i.globals.dataLabels.style.colors[A];((i.config.chart.type==="bar"||i.config.chart.type==="rangeBar")&&i.config.plotOptions.bar.distributed||i.config.dataLabels.distributed)&&(q=i.globals.dataLabels.style.colors[r]),typeof q=="function"&&(q=q({series:i.globals.series,seriesIndex:A,dataPointIndex:r,w:i})),E&&(q=E);var ne=T.offsetX,re=T.offsetY;if(i.config.chart.type!=="bar"&&i.config.chart.type!=="rangeBar"||(ne=0,re=0),i.globals.isSlopeChart&&(r!==0&&(ne=-2*T.offsetX+5),r!==0&&r!==i.config.series[A].data.length-1&&(ne=0)),Q.drawnextLabel){if((U=s.drawText({width:100,height:parseInt(T.style.fontSize,10),x:c+ne,y:d+re,foreColor:q,textAnchor:b||T.textAnchor,text:y,fontSize:x||T.style.fontSize,fontFamily:T.style.fontFamily,fontWeight:T.style.fontWeight||"normal"})).attr({class:G||"apexcharts-datalabel",cx:c,cy:d}),T.dropShadow.enabled){var pe=T.dropShadow;new Rc(this.ctx).dropShadow(U,pe)}B.add(U),i.globals.lastDrawnDataLabelsIndexes[A]===void 0&&(i.globals.lastDrawnDataLabelsIndexes[A]=[]),i.globals.lastDrawnDataLabelsIndexes[A].push(r)}return U}},{key:"addBackgroundToDataLabel",value:function(e,i){var s=this.w,c=s.config.dataLabels.background,d=c.padding,A=c.padding/2,r=i.width,y=i.height,b=new ur(this.ctx).drawRect(i.x-d,i.y-A/2,r+2*d,y+A,c.borderRadius,s.config.chart.background!=="transparent"&&s.config.chart.background?s.config.chart.background:"#fff",c.opacity,c.borderWidth,c.borderColor);return c.dropShadow.enabled&&new Rc(this.ctx).dropShadow(b,c.dropShadow),b}},{key:"dataLabelsBackground",value:function(){var e=this.w;if(e.config.chart.type!=="bubble")for(var i=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text"),s=0;s<i.length;s++){var c=i[s],d=c.getBBox(),A=null;if(d.width&&d.height&&(A=this.addBackgroundToDataLabel(c,d)),A){c.parentNode.insertBefore(A.node,c);var r=e.config.dataLabels.background.backgroundColor||c.getAttribute("fill");e.config.chart.animations.enabled&&!e.globals.resized&&!e.globals.dataChanged?A.animate().attr({fill:r}):A.attr({fill:r}),c.setAttribute("fill",e.config.dataLabels.background.foreColor)}}}},{key:"bringForward",value:function(){for(var e=this.w,i=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),s=e.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child"),c=0;c<i.length;c++)s&&s.insertBefore(i[c],s.nextSibling)}}]),a}(),od=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.legendInactiveClass="legend-mouseover-inactive"}return tn(a,[{key:"getAllSeriesEls",value:function(){return this.w.globals.dom.baseEl.getElementsByClassName("apexcharts-series")}},{key:"getSeriesByName",value:function(e){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner .apexcharts-series[seriesName='".concat(ni.escapeString(e),"']"))}},{key:"isSeriesHidden",value:function(e){var i=this.getSeriesByName(e),s=parseInt(i.getAttribute("data:realIndex"),10);return{isHidden:i.classList.contains("apexcharts-series-collapsed"),realIndex:s}}},{key:"addCollapsedClassToSeries",value:function(e,i){var s=this.w;function c(d){for(var A=0;A<d.length;A++)d[A].index===i&&e.node.classList.add("apexcharts-series-collapsed")}c(s.globals.collapsedSeries),c(s.globals.ancillaryCollapsedSeries)}},{key:"toggleSeries",value:function(e){var i=this.isSeriesHidden(e);return this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,i.isHidden),i.isHidden}},{key:"showSeries",value:function(e){var i=this.isSeriesHidden(e);i.isHidden&&this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,!0)}},{key:"hideSeries",value:function(e){var i=this.isSeriesHidden(e);i.isHidden||this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,!1)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],c=this.w,d=ni.clone(c.globals.initialSeries);c.globals.previousPaths=[],s?(c.globals.collapsedSeries=[],c.globals.ancillaryCollapsedSeries=[],c.globals.collapsedSeriesIndices=[],c.globals.ancillaryCollapsedSeriesIndices=[]):d=this.emptyCollapsedSeries(d),c.config.series=d,e&&(i&&(c.globals.zoomed=!1,this.ctx.updateHelpers.revertDefaultAxisMinMax()),this.ctx.updateHelpers._updateSeries(d,c.config.chart.animations.dynamicAnimation.enabled))}},{key:"emptyCollapsedSeries",value:function(e){for(var i=this.w,s=0;s<e.length;s++)i.globals.collapsedSeriesIndices.indexOf(s)>-1&&(e[s].data=[]);return e}},{key:"highlightSeries",value:function(e){var i=this.w,s=this.getSeriesByName(e),c=parseInt(s==null?void 0:s.getAttribute("data:realIndex"),10),d=i.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis"),A=null,r=null,y=null;if(i.globals.axisCharts||i.config.chart.type==="radialBar")if(i.globals.axisCharts){A=i.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(c,"']")),r=i.globals.dom.baseEl.querySelector(".apexcharts-datalabels[data\\:realIndex='".concat(c,"']"));var b=i.globals.seriesYAxisReverseMap[c];y=i.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(b,"']"))}else A=i.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(c+1,"']"));else A=i.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(c+1,"'] path"));for(var x=0;x<d.length;x++)d[x].classList.add(this.legendInactiveClass);if(A)i.globals.axisCharts||A.parentNode.classList.remove(this.legendInactiveClass),A.classList.remove(this.legendInactiveClass),r!==null&&r.classList.remove(this.legendInactiveClass),y!==null&&y.classList.remove(this.legendInactiveClass);else for(var B=0;B<d.length;B++)d[B].classList.remove(this.legendInactiveClass)}},{key:"toggleSeriesOnHover",value:function(e,i){var s=this.w;i||(i=e.target);var c=s.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis");if(e.type==="mousemove"){var d=parseInt(i.getAttribute("rel"),10)-1;this.highlightSeries(s.globals.seriesNames[d])}else if(e.type==="mouseout")for(var A=0;A<c.length;A++)c[A].classList.remove(this.legendInactiveClass)}},{key:"highlightRangeInSeries",value:function(e,i){var s=this,c=this.w,d=c.globals.dom.baseEl.getElementsByClassName("apexcharts-heatmap-rect"),A=function(b){for(var x=0;x<d.length;x++)d[x].classList[b](s.legendInactiveClass)};if(e.type==="mousemove"){var r=parseInt(i.getAttribute("rel"),10)-1;A("add");var y=c.config.plotOptions.heatmap.colorScale.ranges;(function(b,x){for(var B=0;B<d.length;B++){var T=Number(d[B].getAttribute("val"));T>=b.from&&(T<b.to||b.to===x&&T===x)&&d[B].classList.remove(s.legendInactiveClass)}})(y[r],y.reduce(function(b,x){return Math.max(b,x.to)},0))}else e.type==="mouseout"&&A("remove")}},{key:"getActiveConfigSeriesIndex",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"asc",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=this.w,c=0;if(s.config.series.length>1){for(var d=s.config.series.map(function(r,y){return r.data&&r.data.length>0&&s.globals.collapsedSeriesIndices.indexOf(y)===-1&&(!s.globals.comboCharts||i.length===0||i.length&&i.indexOf(s.config.series[y].type)>-1)?y:-1}),A=e==="asc"?0:d.length-1;e==="asc"?A<d.length:A>=0;e==="asc"?A++:A--)if(d[A]!==-1){c=d[A];break}}return c}},{key:"getBarSeriesIndices",value:function(){return this.w.globals.comboCharts?this.w.config.series.map(function(e,i){return e.type==="bar"||e.type==="column"?i:-1}).filter(function(e){return e!==-1}):this.w.config.series.map(function(e,i){return i})}},{key:"getPreviousPaths",value:function(){var e=this.w;function i(A,r,y){for(var b=A[r].childNodes,x={type:y,paths:[],realIndex:A[r].getAttribute("data:realIndex")},B=0;B<b.length;B++)if(b[B].hasAttribute("pathTo")){var T=b[B].getAttribute("pathTo");x.paths.push({d:T})}e.globals.previousPaths.push(x)}e.globals.previousPaths=[],["line","area","bar","rangebar","rangeArea","candlestick","radar"].forEach(function(A){for(var r,y=(r=A,e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r,"-series .apexcharts-series"))),b=0;b<y.length;b++)i(y,b,A)});var s=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series"));if(s.length>0)for(var c=function(A){for(var r=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series[data\\:realIndex='").concat(A,"'] rect")),y=[],b=function(B){var T=function(R){return r[B].getAttribute(R)},E={x:parseFloat(T("x")),y:parseFloat(T("y")),width:parseFloat(T("width")),height:parseFloat(T("height"))};y.push({rect:E,color:r[B].getAttribute("color")})},x=0;x<r.length;x++)b(x);e.globals.previousPaths.push(y)},d=0;d<s.length;d++)c(d);e.globals.axisCharts||(e.globals.previousPaths=e.globals.series)}},{key:"clearPreviousPaths",value:function(){var e=this.w;e.globals.previousPaths=[],e.globals.allSeriesCollapsed=!1}},{key:"handleNoData",value:function(){var e=this.w,i=e.config.noData,s=new ur(this.ctx),c=e.globals.svgWidth/2,d=e.globals.svgHeight/2,A="middle";if(e.globals.noData=!0,e.globals.animationEnded=!0,i.align==="left"?(c=10,A="start"):i.align==="right"&&(c=e.globals.svgWidth-10,A="end"),i.verticalAlign==="top"?d=50:i.verticalAlign==="bottom"&&(d=e.globals.svgHeight-50),c+=i.offsetX,d=d+parseInt(i.style.fontSize,10)+2+i.offsetY,i.text!==void 0&&i.text!==""){var r=s.drawText({x:c,y:d,text:i.text,textAnchor:A,fontSize:i.style.fontSize,fontFamily:i.style.fontFamily,foreColor:i.style.color,opacity:1,class:"apexcharts-text-nodata"});e.globals.dom.Paper.add(r)}}},{key:"setNullSeriesToZeroValues",value:function(e){for(var i=this.w,s=0;s<e.length;s++)if(e[s].length===0)for(var c=0;c<e[i.globals.maxValsInArrayIndex].length;c++)e[s].push(0);return e}},{key:"hasAllSeriesEqualX",value:function(){for(var e=!0,i=this.w,s=this.filteredSeriesX(),c=0;c<s.length-1;c++)if(s[c][0]!==s[c+1][0]){e=!1;break}return i.globals.allSeriesHasEqualX=e,e}},{key:"filteredSeriesX",value:function(){var e=this.w.globals.seriesX.map(function(i){return i.length>0?i:[]});return e}}]),a}(),J1=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.twoDSeries=[],this.threeDSeries=[],this.twoDSeriesX=[],this.seriesGoals=[],this.coreUtils=new nl(this.ctx)}return tn(a,[{key:"isMultiFormat",value:function(){return this.isFormatXY()||this.isFormat2DArray()}},{key:"isFormatXY",value:function(){var e=this.w.config.series.slice(),i=new od(this.ctx);if(this.activeSeriesIndex=i.getActiveConfigSeriesIndex(),e[this.activeSeriesIndex].data!==void 0&&e[this.activeSeriesIndex].data.length>0&&e[this.activeSeriesIndex].data[0]!==null&&e[this.activeSeriesIndex].data[0].x!==void 0&&e[this.activeSeriesIndex].data[0]!==null)return!0}},{key:"isFormat2DArray",value:function(){var e=this.w.config.series.slice(),i=new od(this.ctx);if(this.activeSeriesIndex=i.getActiveConfigSeriesIndex(),e[this.activeSeriesIndex].data!==void 0&&e[this.activeSeriesIndex].data.length>0&&e[this.activeSeriesIndex].data[0]!==void 0&&e[this.activeSeriesIndex].data[0]!==null&&e[this.activeSeriesIndex].data[0].constructor===Array)return!0}},{key:"handleFormat2DArray",value:function(e,i){for(var s=this.w.config,c=this.w.globals,d=s.chart.type==="boxPlot"||s.series[i].type==="boxPlot",A=0;A<e[i].data.length;A++)if(e[i].data[A][1]!==void 0&&(Array.isArray(e[i].data[A][1])&&e[i].data[A][1].length===4&&!d?this.twoDSeries.push(ni.parseNumber(e[i].data[A][1][3])):e[i].data[A].length>=5?this.twoDSeries.push(ni.parseNumber(e[i].data[A][4])):this.twoDSeries.push(ni.parseNumber(e[i].data[A][1])),c.dataFormatXNumeric=!0),s.xaxis.type==="datetime"){var r=new Date(e[i].data[A][0]);r=new Date(r).getTime(),this.twoDSeriesX.push(r)}else this.twoDSeriesX.push(e[i].data[A][0]);for(var y=0;y<e[i].data.length;y++)e[i].data[y][2]!==void 0&&(this.threeDSeries.push(e[i].data[y][2]),c.isDataXYZ=!0)}},{key:"handleFormatXY",value:function(e,i){var s=this.w.config,c=this.w.globals,d=new Pc(this.ctx),A=i;c.collapsedSeriesIndices.indexOf(i)>-1&&(A=this.activeSeriesIndex);for(var r=0;r<e[i].data.length;r++)e[i].data[r].y!==void 0&&(Array.isArray(e[i].data[r].y)?this.twoDSeries.push(ni.parseNumber(e[i].data[r].y[e[i].data[r].y.length-1])):this.twoDSeries.push(ni.parseNumber(e[i].data[r].y))),e[i].data[r].goals!==void 0&&Array.isArray(e[i].data[r].goals)?(this.seriesGoals[i]===void 0&&(this.seriesGoals[i]=[]),this.seriesGoals[i].push(e[i].data[r].goals)):(this.seriesGoals[i]===void 0&&(this.seriesGoals[i]=[]),this.seriesGoals[i].push(null));for(var y=0;y<e[A].data.length;y++){var b=typeof e[A].data[y].x=="string",x=Array.isArray(e[A].data[y].x),B=!x&&!!d.isValidDate(e[A].data[y].x);if(b||B)if(b||s.xaxis.convertedCatToNumeric){var T=c.isBarHorizontal&&c.isRangeData;s.xaxis.type!=="datetime"||T?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[A].data[y].x),isNaN(e[A].data[y].x)||this.w.config.xaxis.type==="category"||typeof e[A].data[y].x=="string"||(c.isXNumeric=!0)):this.twoDSeriesX.push(d.parseDate(e[A].data[y].x))}else s.xaxis.type==="datetime"?this.twoDSeriesX.push(d.parseDate(e[A].data[y].x.toString())):(c.dataFormatXNumeric=!0,c.isXNumeric=!0,this.twoDSeriesX.push(parseFloat(e[A].data[y].x)));else x?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[A].data[y].x)):(c.isXNumeric=!0,c.dataFormatXNumeric=!0,this.twoDSeriesX.push(e[A].data[y].x))}if(e[i].data[0]&&e[i].data[0].z!==void 0){for(var E=0;E<e[i].data.length;E++)this.threeDSeries.push(e[i].data[E].z);c.isDataXYZ=!0}}},{key:"handleRangeData",value:function(e,i){var s=this.w.globals,c={};return this.isFormat2DArray()?c=this.handleRangeDataFormat("array",e,i):this.isFormatXY()&&(c=this.handleRangeDataFormat("xy",e,i)),s.seriesRangeStart[i]=c.start===void 0?[]:c.start,s.seriesRangeEnd[i]=c.end===void 0?[]:c.end,s.seriesRange[i]=c.rangeUniques,s.seriesRange.forEach(function(d,A){d&&d.forEach(function(r,y){r.y.forEach(function(b,x){for(var B=0;B<r.y.length;B++)if(x!==B){var T=b.y1,E=b.y2,R=r.y[B].y1;T<=r.y[B].y2&&R<=E&&(r.overlaps.indexOf(b.rangeName)<0&&r.overlaps.push(b.rangeName),r.overlaps.indexOf(r.y[B].rangeName)<0&&r.overlaps.push(r.y[B].rangeName))}})})}),c}},{key:"handleCandleStickBoxData",value:function(e,i){var s=this.w.globals,c={};return this.isFormat2DArray()?c=this.handleCandleStickBoxDataFormat("array",e,i):this.isFormatXY()&&(c=this.handleCandleStickBoxDataFormat("xy",e,i)),s.seriesCandleO[i]=c.o,s.seriesCandleH[i]=c.h,s.seriesCandleM[i]=c.m,s.seriesCandleL[i]=c.l,s.seriesCandleC[i]=c.c,c}},{key:"handleRangeDataFormat",value:function(e,i,s){var c=[],d=[],A=i[s].data.filter(function(x,B,T){return B===T.findIndex(function(E){return E.x===x.x})}).map(function(x,B){return{x:x.x,overlaps:[],y:[]}});if(e==="array")for(var r=0;r<i[s].data.length;r++)Array.isArray(i[s].data[r])?(c.push(i[s].data[r][1][0]),d.push(i[s].data[r][1][1])):(c.push(i[s].data[r]),d.push(i[s].data[r]));else if(e==="xy")for(var y=function(x){var B=Array.isArray(i[s].data[x].y),T=ni.randomId(),E=i[s].data[x].x,R={y1:B?i[s].data[x].y[0]:i[s].data[x].y,y2:B?i[s].data[x].y[1]:i[s].data[x].y,rangeName:T};i[s].data[x].rangeName=T;var P=A.findIndex(function(G){return G.x===E});A[P].y.push(R),c.push(R.y1),d.push(R.y2)},b=0;b<i[s].data.length;b++)y(b);return{start:c,end:d,rangeUniques:A}}},{key:"handleCandleStickBoxDataFormat",value:function(e,i,s){var c=this.w,d=c.config.chart.type==="boxPlot"||c.config.series[s].type==="boxPlot",A=[],r=[],y=[],b=[],x=[];if(e==="array")if(d&&i[s].data[0].length===6||!d&&i[s].data[0].length===5)for(var B=0;B<i[s].data.length;B++)A.push(i[s].data[B][1]),r.push(i[s].data[B][2]),d?(y.push(i[s].data[B][3]),b.push(i[s].data[B][4]),x.push(i[s].data[B][5])):(b.push(i[s].data[B][3]),x.push(i[s].data[B][4]));else for(var T=0;T<i[s].data.length;T++)Array.isArray(i[s].data[T][1])&&(A.push(i[s].data[T][1][0]),r.push(i[s].data[T][1][1]),d?(y.push(i[s].data[T][1][2]),b.push(i[s].data[T][1][3]),x.push(i[s].data[T][1][4])):(b.push(i[s].data[T][1][2]),x.push(i[s].data[T][1][3])));else if(e==="xy")for(var E=0;E<i[s].data.length;E++)Array.isArray(i[s].data[E].y)&&(A.push(i[s].data[E].y[0]),r.push(i[s].data[E].y[1]),d?(y.push(i[s].data[E].y[2]),b.push(i[s].data[E].y[3]),x.push(i[s].data[E].y[4])):(b.push(i[s].data[E].y[2]),x.push(i[s].data[E].y[3])));return{o:A,h:r,m:y,l:b,c:x}}},{key:"parseDataAxisCharts",value:function(e){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.ctx,c=this.w.config,d=this.w.globals,A=new Pc(s),r=c.labels.length>0?c.labels.slice():c.xaxis.categories.slice();d.isRangeBar=c.chart.type==="rangeBar"&&d.isBarHorizontal,d.hasXaxisGroups=c.xaxis.type==="category"&&c.xaxis.group.groups.length>0,d.hasXaxisGroups&&(d.groups=c.xaxis.group.groups),e.forEach(function(E,R){E.name!==void 0?d.seriesNames.push(E.name):d.seriesNames.push("series-"+parseInt(R+1,10))}),this.coreUtils.setSeriesYAxisMappings();var y=[],b=Kl(new Set(c.series.map(function(E){return E.group})));c.series.forEach(function(E,R){var P=b.indexOf(E.group);y[P]||(y[P]=[]),y[P].push(d.seriesNames[R])}),d.seriesGroups=y;for(var x=function(){for(var E=0;E<r.length;E++)if(typeof r[E]=="string"){if(!A.isValidDate(r[E]))throw new Error("You have provided invalid Date format. Please provide a valid JavaScript Date");i.twoDSeriesX.push(A.parseDate(r[E]))}else i.twoDSeriesX.push(r[E])},B=0;B<e.length;B++){if(this.twoDSeries=[],this.twoDSeriesX=[],this.threeDSeries=[],e[B].data===void 0)return void console.error("It is a possibility that you may have not included 'data' property in series.");if(c.chart.type!=="rangeBar"&&c.chart.type!=="rangeArea"&&e[B].type!=="rangeBar"&&e[B].type!=="rangeArea"||(d.isRangeData=!0,this.handleRangeData(e,B)),this.isMultiFormat())this.isFormat2DArray()?this.handleFormat2DArray(e,B):this.isFormatXY()&&this.handleFormatXY(e,B),c.chart.type!=="candlestick"&&e[B].type!=="candlestick"&&c.chart.type!=="boxPlot"&&e[B].type!=="boxPlot"||this.handleCandleStickBoxData(e,B),d.series.push(this.twoDSeries),d.labels.push(this.twoDSeriesX),d.seriesX.push(this.twoDSeriesX),d.seriesGoals=this.seriesGoals,B!==this.activeSeriesIndex||this.fallbackToCategory||(d.isXNumeric=!0);else{c.xaxis.type==="datetime"?(d.isXNumeric=!0,x(),d.seriesX.push(this.twoDSeriesX)):c.xaxis.type==="numeric"&&(d.isXNumeric=!0,r.length>0&&(this.twoDSeriesX=r,d.seriesX.push(this.twoDSeriesX))),d.labels.push(this.twoDSeriesX);var T=e[B].data.map(function(E){return ni.parseNumber(E)});d.series.push(T)}d.seriesZ.push(this.threeDSeries),e[B].color!==void 0?d.seriesColors.push(e[B].color):d.seriesColors.push(void 0)}return this.w}},{key:"parseDataNonAxisCharts",value:function(e){var i=this.w.globals,s=this.w.config;i.series=e.slice(),i.seriesNames=s.labels.slice();for(var c=0;c<i.series.length;c++)i.seriesNames[c]===void 0&&i.seriesNames.push("series-"+(c+1));return this.w}},{key:"handleExternalLabelsData",value:function(e){var i=this.w.config,s=this.w.globals;i.xaxis.categories.length>0?s.labels=i.xaxis.categories:i.labels.length>0?s.labels=i.labels.slice():this.fallbackToCategory?(s.labels=s.labels[0],s.seriesRange.length&&(s.seriesRange.map(function(c){c.forEach(function(d){s.labels.indexOf(d.x)<0&&d.x&&s.labels.push(d.x)})}),s.labels=Array.from(new Set(s.labels.map(JSON.stringify)),JSON.parse)),i.xaxis.convertedCatToNumeric&&(new Dy(i).convertCatToNumericXaxis(i,this.ctx,s.seriesX[0]),this._generateExternalLabels(e))):this._generateExternalLabels(e)}},{key:"_generateExternalLabels",value:function(e){var i=this.w.globals,s=this.w.config,c=[];if(i.axisCharts){if(i.series.length>0)if(this.isFormatXY())for(var d=s.series.map(function(B,T){return B.data.filter(function(E,R,P){return P.findIndex(function(G){return G.x===E.x})===R})}),A=d.reduce(function(B,T,E,R){return R[B].length>T.length?B:E},0),r=0;r<d[A].length;r++)c.push(r+1);else for(var y=0;y<i.series[i.maxValsInArrayIndex].length;y++)c.push(y+1);i.seriesX=[];for(var b=0;b<e.length;b++)i.seriesX.push(c);this.w.globals.isBarHorizontal||(i.isXNumeric=!0)}if(c.length===0){c=i.axisCharts?[]:i.series.map(function(B,T){return T+1});for(var x=0;x<e.length;x++)i.seriesX.push(c)}i.labels=c,s.xaxis.convertedCatToNumeric&&(i.categoryLabels=c.map(function(B){return s.xaxis.labels.formatter(B)})),i.noLabelsProvided=!0}},{key:"parseData",value:function(e){var i=this.w,s=i.config,c=i.globals;if(this.excludeCollapsedSeriesInYAxis(),this.fallbackToCategory=!1,this.ctx.core.resetGlobals(),this.ctx.core.isMultipleY(),c.axisCharts?(this.parseDataAxisCharts(e),this.coreUtils.getLargestSeries()):this.parseDataNonAxisCharts(e),s.chart.stacked){var d=new od(this.ctx);c.series=d.setNullSeriesToZeroValues(c.series)}this.coreUtils.getSeriesTotals(),c.axisCharts&&(c.stackedSeriesTotals=this.coreUtils.getStackedSeriesTotals(),c.stackedSeriesTotalsByGroups=this.coreUtils.getStackedSeriesTotalsByGroups()),this.coreUtils.getPercentSeries(),c.dataFormatXNumeric||c.isXNumeric&&(s.xaxis.type!=="numeric"||s.labels.length!==0||s.xaxis.categories.length!==0)||this.handleExternalLabelsData(e);for(var A=this.coreUtils.getCategoryLabels(c.labels),r=0;r<A.length;r++)if(Array.isArray(A[r])){c.isMultiLineX=!0;break}}},{key:"excludeCollapsedSeriesInYAxis",value:function(){var e=this.w,i=[];e.globals.seriesYAxisMap.forEach(function(s,c){var d=0;s.forEach(function(A){e.globals.collapsedSeriesIndices.indexOf(A)!==-1&&d++}),d>0&&d==s.length&&i.push(c)}),e.globals.ignoreYAxisIndexes=i.map(function(s){return s})}}]),a}(),vy=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"svgStringToNode",value:function(e){return new DOMParser().parseFromString(e,"image/svg+xml").documentElement}},{key:"scaleSvgNode",value:function(e,i){var s=parseFloat(e.getAttributeNS(null,"width")),c=parseFloat(e.getAttributeNS(null,"height"));e.setAttributeNS(null,"width",s*i),e.setAttributeNS(null,"height",c*i),e.setAttributeNS(null,"viewBox","0 0 "+s+" "+c)}},{key:"getSvgString",value:function(e){var i=this;return new Promise(function(s){var c=i.w,d=e||c.config.chart.toolbar.export.scale||c.config.chart.toolbar.export.width/c.globals.svgWidth;d||(d=1);var A=c.globals.svgWidth*d,r=c.globals.svgHeight*d,y=c.globals.dom.elWrap.cloneNode(!0);y.style.width=A+"px",y.style.height=r+"px";var b=new XMLSerializer().serializeToString(y),x=`
        <svg xmlns="http://www.w3.org/2000/svg"
          version="1.1"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          class="apexcharts-svg"
          xmlns:data="ApexChartsNS"
          transform="translate(0, 0)"
          width="`.concat(c.globals.svgWidth,'px" height="').concat(c.globals.svgHeight,`px">
          <foreignObject width="100%" height="100%">
            <div xmlns="http://www.w3.org/1999/xhtml" style="width:`).concat(A,"px; height:").concat(r,`px;">
            <style type="text/css">
              .apexcharts-tooltip, .apexcharts-toolbar, .apexcharts-xaxistooltip, .apexcharts-yaxistooltip, .apexcharts-xcrosshairs, .apexcharts-ycrosshairs, .apexcharts-zoom-rect, .apexcharts-selection-rect {
                display: none;
              }
            </style>
              `).concat(b,`
            </div>
          </foreignObject>
        </svg>
      `),B=i.svgStringToNode(x);d!==1&&i.scaleSvgNode(B,d),i.convertImagesToBase64(B).then(function(){x=new XMLSerializer().serializeToString(B),s(x.replace(/&nbsp;/g,"&#160;"))})})}},{key:"convertImagesToBase64",value:function(e){var i=this,s=e.getElementsByTagName("image"),c=Array.from(s).map(function(d){var A=d.getAttributeNS("http://www.w3.org/1999/xlink","href");return A&&!A.startsWith("data:")?i.getBase64FromUrl(A).then(function(r){d.setAttributeNS("http://www.w3.org/1999/xlink","href",r)}).catch(function(r){console.error("Error converting image to base64:",r)}):Promise.resolve()});return Promise.all(c)}},{key:"getBase64FromUrl",value:function(e){return new Promise(function(i,s){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var d=document.createElement("canvas");d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0),i(d.toDataURL())},c.onerror=s,c.src=e})}},{key:"svgUrl",value:function(){var e=this;return new Promise(function(i){e.getSvgString().then(function(s){var c=new Blob([s],{type:"image/svg+xml;charset=utf-8"});i(URL.createObjectURL(c))})})}},{key:"dataURI",value:function(e){var i=this;return new Promise(function(s){var c=i.w,d=e?e.scale||e.width/c.globals.svgWidth:1,A=document.createElement("canvas");A.width=c.globals.svgWidth*d,A.height=parseInt(c.globals.dom.elWrap.style.height,10)*d;var r=c.config.chart.background!=="transparent"&&c.config.chart.background?c.config.chart.background:"#fff",y=A.getContext("2d");y.fillStyle=r,y.fillRect(0,0,A.width*d,A.height*d),i.getSvgString(d).then(function(b){var x="data:image/svg+xml,"+encodeURIComponent(b),B=new Image;B.crossOrigin="anonymous",B.onload=function(){if(y.drawImage(B,0,0),A.msToBlob){var T=A.msToBlob();s({blob:T})}else{var E=A.toDataURL("image/png");s({imgURI:E})}},B.src=x})})}},{key:"exportToSVG",value:function(){var e=this;this.svgUrl().then(function(i){e.triggerDownload(i,e.w.config.chart.toolbar.export.svg.filename,".svg")})}},{key:"exportToPng",value:function(){var e=this,i=this.w.config.chart.toolbar.export.scale,s=this.w.config.chart.toolbar.export.width,c=i?{scale:i}:s?{width:s}:void 0;this.dataURI(c).then(function(d){var A=d.imgURI,r=d.blob;r?navigator.msSaveOrOpenBlob(r,e.w.globals.chartID+".png"):e.triggerDownload(A,e.w.config.chart.toolbar.export.png.filename,".png")})}},{key:"exportToCSV",value:function(e){var i=this,s=e.series,c=e.fileName,d=e.columnDelimiter,A=d===void 0?",":d,r=e.lineDelimiter,y=r===void 0?`
`:r,b=this.w;s||(s=b.config.series);var x=[],B=[],T="",E=b.globals.series.map(function(re,pe){return b.globals.collapsedSeriesIndices.indexOf(pe)===-1?re:[]}),R=function(re){return typeof b.config.chart.toolbar.export.csv.categoryFormatter=="function"?b.config.chart.toolbar.export.csv.categoryFormatter(re):b.config.xaxis.type==="datetime"&&String(re).length>=10?new Date(re).toDateString():ni.isNumber(re)?re:re.split(A).join("")},P=function(re){return typeof b.config.chart.toolbar.export.csv.valueFormatter=="function"?b.config.chart.toolbar.export.csv.valueFormatter(re):re},G=Math.max.apply(Math,Kl(s.map(function(re){return re.data?re.data.length:0}))),U=new J1(this.ctx),Q=new Bp(this.ctx),q=function(re){var pe="";if(b.globals.axisCharts){if(b.config.xaxis.type==="category"||b.config.xaxis.convertedCatToNumeric)if(b.globals.isBarHorizontal){var fe=b.globals.yLabelFormatters[0],he=new od(i.ctx).getActiveConfigSeriesIndex();pe=fe(b.globals.labels[re],{seriesIndex:he,dataPointIndex:re,w:b})}else pe=Q.getLabel(b.globals.labels,b.globals.timescaleLabels,0,re).text;b.config.xaxis.type==="datetime"&&(b.config.xaxis.categories.length?pe=b.config.xaxis.categories[re]:b.config.labels.length&&(pe=b.config.labels[re]))}else pe=b.config.labels[re];return pe===null?"nullvalue":(Array.isArray(pe)&&(pe=pe.join(" ")),ni.isNumber(pe)?pe:pe.split(A).join(""))},ne=function(re,pe){if(x.length&&pe===0&&B.push(x.join(A)),re.data){re.data=re.data.length&&re.data||Kl(Array(G)).map(function(){return""});for(var fe=0;fe<re.data.length;fe++){x=[];var he=q(fe);if(he!=="nullvalue"){if(he||(U.isFormatXY()?he=s[pe].data[fe].x:U.isFormat2DArray()&&(he=s[pe].data[fe]?s[pe].data[fe][0]:"")),pe===0){x.push(R(he));for(var be=0;be<b.globals.series.length;be++){var Se,oe=U.isFormatXY()?(Se=s[be].data[fe])===null||Se===void 0?void 0:Se.y:E[be][fe];x.push(P(oe))}}(b.config.chart.type==="candlestick"||re.type&&re.type==="candlestick")&&(x.pop(),x.push(b.globals.seriesCandleO[pe][fe]),x.push(b.globals.seriesCandleH[pe][fe]),x.push(b.globals.seriesCandleL[pe][fe]),x.push(b.globals.seriesCandleC[pe][fe])),(b.config.chart.type==="boxPlot"||re.type&&re.type==="boxPlot")&&(x.pop(),x.push(b.globals.seriesCandleO[pe][fe]),x.push(b.globals.seriesCandleH[pe][fe]),x.push(b.globals.seriesCandleM[pe][fe]),x.push(b.globals.seriesCandleL[pe][fe]),x.push(b.globals.seriesCandleC[pe][fe])),b.config.chart.type==="rangeBar"&&(x.pop(),x.push(b.globals.seriesRangeStart[pe][fe]),x.push(b.globals.seriesRangeEnd[pe][fe])),x.length&&B.push(x.join(A))}}}};x.push(b.config.chart.toolbar.export.csv.headerCategory),b.config.chart.type==="boxPlot"?(x.push("minimum"),x.push("q1"),x.push("median"),x.push("q3"),x.push("maximum")):b.config.chart.type==="candlestick"?(x.push("open"),x.push("high"),x.push("low"),x.push("close")):b.config.chart.type==="rangeBar"?(x.push("minimum"),x.push("maximum")):s.map(function(re,pe){var fe=(re.name?re.name:"series-".concat(pe))+"";b.globals.axisCharts&&x.push(fe.split(A).join("")?fe.split(A).join(""):"series-".concat(pe))}),b.globals.axisCharts||(x.push(b.config.chart.toolbar.export.csv.headerValue),B.push(x.join(A))),b.globals.allSeriesHasEqualX||!b.globals.axisCharts||b.config.xaxis.categories.length||b.config.labels.length?s.map(function(re,pe){b.globals.axisCharts?ne(re,pe):((x=[]).push(R(b.globals.labels[pe])),x.push(P(E[pe])),B.push(x.join(A)))}):function(){var re=new Set,pe={};s.forEach(function(fe,he){fe==null||fe.data.forEach(function(be){var Se,oe;if(U.isFormatXY())Se=be.x,oe=be.y;else{if(!U.isFormat2DArray())return;Se=be[0],oe=be[1]}pe[Se]||(pe[Se]=Array(s.length).fill("")),pe[Se][he]=P(oe),re.add(Se)})}),x.length&&B.push(x.join(A)),Array.from(re).sort().forEach(function(fe){B.push([R(fe),pe[fe].join(A)])})}(),T+=B.join(y),this.triggerDownload("data:text/csv; charset=utf-8,"+encodeURIComponent("\uFEFF"+T),c||b.config.chart.toolbar.export.csv.filename,".csv")}},{key:"triggerDownload",value:function(e,i,s){var c=document.createElement("a");c.href=e,c.download=(i||this.w.globals.chartID)+s,document.body.appendChild(c),c.click(),document.body.removeChild(c)}}]),a}(),Uy=function(){function a(e,i){en(this,a),this.ctx=e,this.elgrid=i,this.w=e.w;var s=this.w;this.axesUtils=new Bp(e),this.xaxisLabels=s.globals.labels.slice(),s.globals.timescaleLabels.length>0&&!s.globals.isBarHorizontal&&(this.xaxisLabels=s.globals.timescaleLabels.slice()),s.config.xaxis.overwriteCategories&&(this.xaxisLabels=s.config.xaxis.overwriteCategories),this.drawnLabels=[],this.drawnLabelsRects=[],s.config.xaxis.position==="top"?this.offY=0:this.offY=s.globals.gridHeight,this.offY=this.offY+s.config.xaxis.axisBorder.offsetY,this.isCategoryBarHorizontal=s.config.chart.type==="bar"&&s.config.plotOptions.bar.horizontal,this.xaxisFontSize=s.config.xaxis.labels.style.fontSize,this.xaxisFontFamily=s.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=s.config.xaxis.labels.style.colors,this.xaxisBorderWidth=s.config.xaxis.axisBorder.width,this.isCategoryBarHorizontal&&(this.xaxisBorderWidth=s.config.yaxis[0].axisBorder.width.toString()),this.xaxisBorderWidth.indexOf("%")>-1?this.xaxisBorderWidth=s.globals.gridWidth*parseInt(this.xaxisBorderWidth,10)/100:this.xaxisBorderWidth=parseInt(this.xaxisBorderWidth,10),this.xaxisBorderHeight=s.config.xaxis.axisBorder.height,this.yaxis=s.config.yaxis[0]}return tn(a,[{key:"drawXaxis",value:function(){var e=this.w,i=new ur(this.ctx),s=i.group({class:"apexcharts-xaxis",transform:"translate(".concat(e.config.xaxis.offsetX,", ").concat(e.config.xaxis.offsetY,")")}),c=i.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(e.globals.translateXAxisX,", ").concat(e.globals.translateXAxisY,")")});s.add(c);for(var d=[],A=0;A<this.xaxisLabels.length;A++)d.push(this.xaxisLabels[A]);if(this.drawXAxisLabelAndGroup(!0,i,c,d,e.globals.isXNumeric,function(R,P){return P}),e.globals.hasXaxisGroups){var r=e.globals.groups;d=[];for(var y=0;y<r.length;y++)d.push(r[y].title);var b={};e.config.xaxis.group.style&&(b.xaxisFontSize=e.config.xaxis.group.style.fontSize,b.xaxisFontFamily=e.config.xaxis.group.style.fontFamily,b.xaxisForeColors=e.config.xaxis.group.style.colors,b.fontWeight=e.config.xaxis.group.style.fontWeight,b.cssClass=e.config.xaxis.group.style.cssClass),this.drawXAxisLabelAndGroup(!1,i,c,d,!1,function(R,P){return r[R].cols*P},b)}if(e.config.xaxis.title.text!==void 0){var x=i.group({class:"apexcharts-xaxis-title"}),B=i.drawText({x:e.globals.gridWidth/2+e.config.xaxis.title.offsetX,y:this.offY+parseFloat(this.xaxisFontSize)+(e.config.xaxis.position==="bottom"?e.globals.xAxisLabelsHeight:-e.globals.xAxisLabelsHeight-10)+e.config.xaxis.title.offsetY,text:e.config.xaxis.title.text,textAnchor:"middle",fontSize:e.config.xaxis.title.style.fontSize,fontFamily:e.config.xaxis.title.style.fontFamily,fontWeight:e.config.xaxis.title.style.fontWeight,foreColor:e.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+e.config.xaxis.title.style.cssClass});x.add(B),s.add(x)}if(e.config.xaxis.axisBorder.show){var T=e.globals.barPadForNumericAxis,E=i.drawLine(e.globals.padHorizontal+e.config.xaxis.axisBorder.offsetX-T,this.offY,this.xaxisBorderWidth+T,this.offY,e.config.xaxis.axisBorder.color,0,this.xaxisBorderHeight);this.elgrid&&this.elgrid.elGridBorders&&e.config.grid.show?this.elgrid.elGridBorders.add(E):s.add(E)}return s}},{key:"drawXAxisLabelAndGroup",value:function(e,i,s,c,d,A){var r,y=this,b=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},x=[],B=[],T=this.w,E=b.xaxisFontSize||this.xaxisFontSize,R=b.xaxisFontFamily||this.xaxisFontFamily,P=b.xaxisForeColors||this.xaxisForeColors,G=b.fontWeight||T.config.xaxis.labels.style.fontWeight,U=b.cssClass||T.config.xaxis.labels.style.cssClass,Q=T.globals.padHorizontal,q=c.length,ne=T.config.xaxis.type==="category"?T.globals.dataPoints:q;if(ne===0&&q>ne&&(ne=q),d){var re=Math.max(Number(T.config.xaxis.tickAmount)||1,ne>1?ne-1:ne);r=T.globals.gridWidth/Math.min(re,q-1),Q=Q+A(0,r)/2+T.config.xaxis.labels.offsetX}else r=T.globals.gridWidth/ne,Q=Q+A(0,r)+T.config.xaxis.labels.offsetX;for(var pe=function(he){var be=Q-A(he,r)/2+T.config.xaxis.labels.offsetX;he===0&&q===1&&r/2===Q&&ne===1&&(be=T.globals.gridWidth/2);var Se=y.axesUtils.getLabel(c,T.globals.timescaleLabels,be,he,x,E,e),oe=28;if(T.globals.rotateXLabels&&e&&(oe=22),T.config.xaxis.title.text&&T.config.xaxis.position==="top"&&(oe+=parseFloat(T.config.xaxis.title.style.fontSize)+2),e||(oe=oe+parseFloat(E)+(T.globals.xAxisLabelsHeight-T.globals.xAxisGroupLabelsHeight)+(T.globals.rotateXLabels?10:0)),Se=T.config.xaxis.tickAmount!==void 0&&T.config.xaxis.tickAmount!=="dataPoints"&&T.config.xaxis.type!=="datetime"?y.axesUtils.checkLabelBasedOnTickamount(he,Se,q):y.axesUtils.checkForOverflowingLabels(he,Se,q,x,B),T.config.xaxis.labels.show){var ye=i.drawText({x:Se.x,y:y.offY+T.config.xaxis.labels.offsetY+oe-(T.config.xaxis.position==="top"?T.globals.xAxisHeight+T.config.xaxis.axisTicks.height-2:0),text:Se.text,textAnchor:"middle",fontWeight:Se.isBold?600:G,fontSize:E,fontFamily:R,foreColor:Array.isArray(P)?e&&T.config.xaxis.convertedCatToNumeric?P[T.globals.minX+he-1]:P[he]:P,isPlainText:!1,cssClass:(e?"apexcharts-xaxis-label ":"apexcharts-xaxis-group-label ")+U});if(s.add(ye),ye.on("click",function(Be){if(typeof T.config.chart.events.xAxisLabelClick=="function"){var Pe=Object.assign({},T,{labelIndex:he});T.config.chart.events.xAxisLabelClick(Be,y.ctx,Pe)}}),e){var Me=document.createElementNS(T.globals.SVGNS,"title");Me.textContent=Array.isArray(Se.text)?Se.text.join(" "):Se.text,ye.node.appendChild(Me),Se.text!==""&&(x.push(Se.text),B.push(Se))}}he<q-1&&(Q+=A(he+1,r))},fe=0;fe<=q-1;fe++)pe(fe)}},{key:"drawXaxisInversed",value:function(e){var i,s,c=this,d=this.w,A=new ur(this.ctx),r=d.config.yaxis[0].opposite?d.globals.translateYAxisX[e]:0,y=A.group({class:"apexcharts-yaxis apexcharts-xaxis-inversed",rel:e}),b=A.group({class:"apexcharts-yaxis-texts-g apexcharts-xaxis-inversed-texts-g",transform:"translate("+r+", 0)"});y.add(b);var x=[];if(d.config.yaxis[e].show)for(var B=0;B<this.xaxisLabels.length;B++)x.push(this.xaxisLabels[B]);i=d.globals.gridHeight/x.length,s=-i/2.2;var T=d.globals.yLabelFormatters[0],E=d.config.yaxis[0].labels;if(E.show)for(var R=function(re){var pe=x[re]===void 0?"":x[re];pe=T(pe,{seriesIndex:e,dataPointIndex:re,w:d});var fe=c.axesUtils.getYAxisForeColor(E.style.colors,e),he=0;Array.isArray(pe)&&(he=pe.length/2*parseInt(E.style.fontSize,10));var be=E.offsetX-15,Se="end";c.yaxis.opposite&&(Se="start"),d.config.yaxis[0].labels.align==="left"?(be=E.offsetX,Se="start"):d.config.yaxis[0].labels.align==="center"?(be=E.offsetX,Se="middle"):d.config.yaxis[0].labels.align==="right"&&(Se="end");var oe=A.drawText({x:be,y:s+i+E.offsetY-he,text:pe,textAnchor:Se,foreColor:Array.isArray(fe)?fe[re]:fe,fontSize:E.style.fontSize,fontFamily:E.style.fontFamily,fontWeight:E.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+E.style.cssClass,maxWidth:E.maxWidth});b.add(oe),oe.on("click",function(Be){if(typeof d.config.chart.events.xAxisLabelClick=="function"){var Pe=Object.assign({},d,{labelIndex:re});d.config.chart.events.xAxisLabelClick(Be,c.ctx,Pe)}});var ye=document.createElementNS(d.globals.SVGNS,"title");if(ye.textContent=Array.isArray(pe)?pe.join(" "):pe,oe.node.appendChild(ye),d.config.yaxis[e].labels.rotate!==0){var Me=A.rotateAroundCenter(oe.node);oe.node.setAttribute("transform","rotate(".concat(d.config.yaxis[e].labels.rotate," 0 ").concat(Me.y,")"))}s+=i},P=0;P<=x.length-1;P++)R(P);if(d.config.yaxis[0].title.text!==void 0){var G=A.group({class:"apexcharts-yaxis-title apexcharts-xaxis-title-inversed",transform:"translate("+r+", 0)"}),U=A.drawText({x:d.config.yaxis[0].title.offsetX,y:d.globals.gridHeight/2+d.config.yaxis[0].title.offsetY,text:d.config.yaxis[0].title.text,textAnchor:"middle",foreColor:d.config.yaxis[0].title.style.color,fontSize:d.config.yaxis[0].title.style.fontSize,fontWeight:d.config.yaxis[0].title.style.fontWeight,fontFamily:d.config.yaxis[0].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+d.config.yaxis[0].title.style.cssClass});G.add(U),y.add(G)}var Q=0;this.isCategoryBarHorizontal&&d.config.yaxis[0].opposite&&(Q=d.globals.gridWidth);var q=d.config.xaxis.axisBorder;if(q.show){var ne=A.drawLine(d.globals.padHorizontal+q.offsetX+Q,1+q.offsetY,d.globals.padHorizontal+q.offsetX+Q,d.globals.gridHeight+q.offsetY,q.color,0);this.elgrid&&this.elgrid.elGridBorders&&d.config.grid.show?this.elgrid.elGridBorders.add(ne):y.add(ne)}return d.config.yaxis[0].axisTicks.show&&this.axesUtils.drawYAxisTicks(Q,x.length,d.config.yaxis[0].axisBorder,d.config.yaxis[0].axisTicks,0,i,y),y}},{key:"drawXaxisTicks",value:function(e,i,s){var c=this.w,d=e;if(!(e<0||e-2>c.globals.gridWidth)){var A=this.offY+c.config.xaxis.axisTicks.offsetY;if(i=i+A+c.config.xaxis.axisTicks.height,c.config.xaxis.position==="top"&&(i=A-c.config.xaxis.axisTicks.height),c.config.xaxis.axisTicks.show){var r=new ur(this.ctx).drawLine(e+c.config.xaxis.axisTicks.offsetX,A+c.config.xaxis.offsetY,d+c.config.xaxis.axisTicks.offsetX,i+c.config.xaxis.offsetY,c.config.xaxis.axisTicks.color);s.add(r),r.node.classList.add("apexcharts-xaxis-tick")}}}},{key:"getXAxisTicksPositions",value:function(){var e=this.w,i=[],s=this.xaxisLabels.length,c=e.globals.padHorizontal;if(e.globals.timescaleLabels.length>0)for(var d=0;d<s;d++)c=this.xaxisLabels[d].position,i.push(c);else for(var A=s,r=0;r<A;r++){var y=A;e.globals.isXNumeric&&e.config.chart.type!=="bar"&&(y-=1),c+=e.globals.gridWidth/y,i.push(c)}return i}},{key:"xAxisLabelCorrections",value:function(){var e=this.w,i=new ur(this.ctx),s=e.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g"),c=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-texts-g text:not(.apexcharts-xaxis-group-label)"),d=e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-inversed text"),A=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-inversed-texts-g text tspan");if(e.globals.rotateXLabels||e.config.xaxis.labels.rotateAlways)for(var r=0;r<c.length;r++){var y=i.rotateAroundCenter(c[r]);y.y=y.y-1,y.x=y.x+1,c[r].setAttribute("transform","rotate(".concat(e.config.xaxis.labels.rotate," ").concat(y.x," ").concat(y.y,")")),c[r].setAttribute("text-anchor","end"),s.setAttribute("transform","translate(0, ".concat(-10,")"));var b=c[r].childNodes;e.config.xaxis.labels.trim&&Array.prototype.forEach.call(b,function(E){i.placeTextWithEllipsis(E,E.textContent,e.globals.xAxisLabelsHeight-(e.config.legend.position==="bottom"?20:10))})}else(function(){for(var E=e.globals.gridWidth/(e.globals.labels.length+1),R=0;R<c.length;R++){var P=c[R].childNodes;e.config.xaxis.labels.trim&&e.config.xaxis.type!=="datetime"&&Array.prototype.forEach.call(P,function(G){i.placeTextWithEllipsis(G,G.textContent,E)})}})();if(d.length>0){var x=d[d.length-1].getBBox(),B=d[0].getBBox();x.x<-20&&d[d.length-1].parentNode.removeChild(d[d.length-1]),B.x+B.width>e.globals.gridWidth&&!e.globals.isBarHorizontal&&d[0].parentNode.removeChild(d[0]);for(var T=0;T<A.length;T++)i.placeTextWithEllipsis(A[T],A[T].textContent,e.config.yaxis[0].labels.maxWidth-(e.config.yaxis[0].title.text?2*parseFloat(e.config.yaxis[0].title.style.fontSize):0)-15)}}}]),a}(),GT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var i=this.w;this.xaxisLabels=i.globals.labels.slice(),this.axesUtils=new Bp(e),this.isRangeBar=i.globals.seriesRange.length&&i.globals.isBarHorizontal,i.globals.timescaleLabels.length>0&&(this.xaxisLabels=i.globals.timescaleLabels.slice())}return tn(a,[{key:"drawGridArea",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.w,s=new ur(this.ctx);e||(e=s.group({class:"apexcharts-grid"}));var c=s.drawLine(i.globals.padHorizontal,1,i.globals.padHorizontal,i.globals.gridHeight,"transparent"),d=s.drawLine(i.globals.padHorizontal,i.globals.gridHeight,i.globals.gridWidth,i.globals.gridHeight,"transparent");return e.add(d),e.add(c),e}},{key:"drawGrid",value:function(){if(this.w.globals.axisCharts){var e=this.renderGrid();return this.drawGridArea(e.el),e}return null}},{key:"createGridMask",value:function(){var e=this.w,i=e.globals,s=new ur(this.ctx),c=Array.isArray(e.config.stroke.width)?Math.max.apply(Math,Kl(e.config.stroke.width)):e.config.stroke.width,d=function(x){var B=document.createElementNS(i.SVGNS,"clipPath");return B.setAttribute("id",x),B};i.dom.elGridRectMask=d("gridRectMask".concat(i.cuid)),i.dom.elGridRectBarMask=d("gridRectBarMask".concat(i.cuid)),i.dom.elGridRectMarkerMask=d("gridRectMarkerMask".concat(i.cuid)),i.dom.elForecastMask=d("forecastMask".concat(i.cuid)),i.dom.elNonForecastMask=d("nonForecastMask".concat(i.cuid));var A=0,r=0;(["bar","rangeBar","candlestick","boxPlot"].includes(e.config.chart.type)||e.globals.comboBarCount>0)&&e.globals.isXNumeric&&!e.globals.isBarHorizontal&&(A=Math.max(e.config.grid.padding.left,i.barPadForNumericAxis),r=Math.max(e.config.grid.padding.right,i.barPadForNumericAxis)),i.dom.elGridRect=s.drawRect(-c/2-2,-c/2-2,i.gridWidth+c+4,i.gridHeight+c+4,0,"#fff"),i.dom.elGridRectBar=s.drawRect(-c/2-A-2,-c/2-2,i.gridWidth+c+r+A+4,i.gridHeight+c+4,0,"#fff");var y=e.globals.markers.largestSize;i.dom.elGridRectMarker=s.drawRect(-y,-y,i.gridWidth+2*y,i.gridHeight+2*y,0,"#fff"),i.dom.elGridRectMask.appendChild(i.dom.elGridRect.node),i.dom.elGridRectBarMask.appendChild(i.dom.elGridRectBar.node),i.dom.elGridRectMarkerMask.appendChild(i.dom.elGridRectMarker.node);var b=i.dom.baseEl.querySelector("defs");b.appendChild(i.dom.elGridRectMask),b.appendChild(i.dom.elGridRectBarMask),b.appendChild(i.dom.elGridRectMarkerMask),b.appendChild(i.dom.elForecastMask),b.appendChild(i.dom.elNonForecastMask)}},{key:"_drawGridLines",value:function(e){var i=e.i,s=e.x1,c=e.y1,d=e.x2,A=e.y2,r=e.xCount,y=e.parent,b=this.w;if(!(i===0&&b.globals.skipFirstTimelinelabel||i===r-1&&b.globals.skipLastTimelinelabel&&!b.config.xaxis.labels.formatter||b.config.chart.type==="radar")){b.config.grid.xaxis.lines.show&&this._drawGridLine({i,x1:s,y1:c,x2:d,y2:A,xCount:r,parent:y});var x=0;if(b.globals.hasXaxisGroups&&b.config.xaxis.tickPlacement==="between"){var B=b.globals.groups;if(B){for(var T=0,E=0;T<i&&E<B.length;E++)T+=B[E].cols;T===i&&(x=.6*b.globals.xAxisLabelsHeight)}}new Uy(this.ctx).drawXaxisTicks(s,x,b.globals.dom.elGraphical)}}},{key:"_drawGridLine",value:function(e){var i=e.i,s=e.x1,c=e.y1,d=e.x2,A=e.y2,r=e.xCount,y=e.parent,b=this.w,x=y.node.classList.contains("apexcharts-gridlines-horizontal"),B=b.globals.barPadForNumericAxis,T=c===0&&A===0||s===0&&d===0||c===b.globals.gridHeight&&A===b.globals.gridHeight||b.globals.isBarHorizontal&&(i===0||i===r-1),E=new ur(this).drawLine(s-(x?B:0),c,d+(x?B:0),A,b.config.grid.borderColor,b.config.grid.strokeDashArray);E.node.classList.add("apexcharts-gridline"),T&&b.config.grid.show?this.elGridBorders.add(E):y.add(E)}},{key:"_drawGridBandRect",value:function(e){var i=e.c,s=e.x1,c=e.y1,d=e.x2,A=e.y2,r=e.type,y=this.w,b=new ur(this.ctx),x=y.globals.barPadForNumericAxis,B=y.config.grid[r].colors[i],T=b.drawRect(s-(r==="row"?x:0),c,d+(r==="row"?2*x:0),A,0,B,y.config.grid[r].opacity);this.elg.add(T),T.attr("clip-path","url(#gridRectMask".concat(y.globals.cuid,")")),T.node.classList.add("apexcharts-grid-".concat(r))}},{key:"_drawXYLines",value:function(e){var i=this,s=e.xCount,c=e.tickAmount,d=this.w;if(d.config.grid.xaxis.lines.show||d.config.xaxis.axisTicks.show){var A,r=d.globals.padHorizontal,y=d.globals.gridHeight;d.globals.timescaleLabels.length?function(R){for(var P=R.xC,G=R.x1,U=R.y1,Q=R.x2,q=R.y2,ne=0;ne<P;ne++)G=i.xaxisLabels[ne].position,Q=i.xaxisLabels[ne].position,i._drawGridLines({i:ne,x1:G,y1:U,x2:Q,y2:q,xCount:s,parent:i.elgridLinesV})}({xC:s,x1:r,y1:0,x2:A,y2:y}):(d.globals.isXNumeric&&(s=d.globals.xAxisScale.result.length),function(R){for(var P=R.xC,G=R.x1,U=R.y1,Q=R.x2,q=R.y2,ne=0;ne<P+(d.globals.isXNumeric?0:1);ne++)ne===0&&P===1&&d.globals.dataPoints===1&&(Q=G=d.globals.gridWidth/2),i._drawGridLines({i:ne,x1:G,y1:U,x2:Q,y2:q,xCount:s,parent:i.elgridLinesV}),Q=G+=d.globals.gridWidth/(d.globals.isXNumeric?P-1:P)}({xC:s,x1:r,y1:0,x2:A,y2:y}))}if(d.config.grid.yaxis.lines.show){var b=0,x=0,B=d.globals.gridWidth,T=c+1;this.isRangeBar&&(T=d.globals.labels.length);for(var E=0;E<T+(this.isRangeBar?1:0);E++)this._drawGridLine({i:E,xCount:T+(this.isRangeBar?1:0),x1:0,y1:b,x2:B,y2:x,parent:this.elgridLinesH}),x=b+=d.globals.gridHeight/(this.isRangeBar?T:c)}}},{key:"_drawInvertedXYLines",value:function(e){var i=e.xCount,s=this.w;if(s.config.grid.xaxis.lines.show||s.config.xaxis.axisTicks.show)for(var c,d=s.globals.padHorizontal,A=s.globals.gridHeight,r=0;r<i+1;r++)s.config.grid.xaxis.lines.show&&this._drawGridLine({i:r,xCount:i+1,x1:d,y1:0,x2:c,y2:A,parent:this.elgridLinesV}),new Uy(this.ctx).drawXaxisTicks(d,0,s.globals.dom.elGraphical),c=d+=s.globals.gridWidth/i;if(s.config.grid.yaxis.lines.show)for(var y=0,b=0,x=s.globals.gridWidth,B=0;B<s.globals.dataPoints+1;B++)this._drawGridLine({i:B,xCount:s.globals.dataPoints+1,x1:0,y1:y,x2:x,y2:b,parent:this.elgridLinesH}),b=y+=s.globals.gridHeight/s.globals.dataPoints}},{key:"renderGrid",value:function(){var e=this.w,i=e.globals,s=new ur(this.ctx);this.elg=s.group({class:"apexcharts-grid"}),this.elgridLinesH=s.group({class:"apexcharts-gridlines-horizontal"}),this.elgridLinesV=s.group({class:"apexcharts-gridlines-vertical"}),this.elGridBorders=s.group({class:"apexcharts-grid-borders"}),this.elg.add(this.elgridLinesH),this.elg.add(this.elgridLinesV),e.config.grid.show||(this.elgridLinesV.hide(),this.elgridLinesH.hide(),this.elGridBorders.hide());for(var c=0;c<i.seriesYAxisMap.length&&i.ignoreYAxisIndexes.includes(c);)c++;c===i.seriesYAxisMap.length&&(c=0);var d,A=i.yAxisScale[c].result.length-1;if(!i.isBarHorizontal||this.isRangeBar){var r,y,b;d=this.xaxisLabels.length,this.isRangeBar&&(A=i.labels.length,e.config.xaxis.tickAmount&&e.config.xaxis.labels.formatter&&(d=e.config.xaxis.tickAmount),((r=i.yAxisScale)===null||r===void 0||(y=r[c])===null||y===void 0||(b=y.result)===null||b===void 0?void 0:b.length)>0&&e.config.xaxis.type!=="datetime"&&(d=i.yAxisScale[c].result.length-1)),this._drawXYLines({xCount:d,tickAmount:A})}else d=A,A=i.xTickAmount,this._drawInvertedXYLines({xCount:d,tickAmount:A});return this.drawGridBands(d,A),{el:this.elg,elGridBorders:this.elGridBorders,xAxisTickWidth:i.gridWidth/d}}},{key:"drawGridBands",value:function(e,i){var s,c,d=this,A=this.w;if(((s=A.config.grid.row.colors)===null||s===void 0?void 0:s.length)>0&&function(R,P,G,U,Q,q){for(var ne=0,re=0;ne<P;ne++,re++)re>=A.config.grid[R].colors.length&&(re=0),d._drawGridBandRect({c:re,x1:G,y1:U,x2:Q,y2:q,type:R}),U+=A.globals.gridHeight/i}("row",i,0,0,A.globals.gridWidth,A.globals.gridHeight/i),((c=A.config.grid.column.colors)===null||c===void 0?void 0:c.length)>0){var r=A.globals.isBarHorizontal||A.config.xaxis.tickPlacement!=="on"||A.config.xaxis.type!=="category"&&!A.config.xaxis.convertedCatToNumeric?e:e-1;A.globals.isXNumeric&&(r=A.globals.xAxisScale.result.length-1);for(var y=A.globals.padHorizontal,b=A.globals.padHorizontal+A.globals.gridWidth/r,x=A.globals.gridHeight,B=0,T=0;B<e;B++,T++){var E;T>=A.config.grid.column.colors.length&&(T=0),A.config.xaxis.type==="datetime"&&(y=this.xaxisLabels[B].position,b=(((E=this.xaxisLabels[B+1])===null||E===void 0?void 0:E.position)||A.globals.gridWidth)-this.xaxisLabels[B].position),this._drawGridBandRect({c:T,x1:y,y1:0,x2:b,y2:x,type:"column"}),y+=A.globals.gridWidth/r}}}}]),a}(),WT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.coreUtils=new nl(this.ctx)}return tn(a,[{key:"niceScale",value:function(e,i){var s,c,d,A,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=1e-11,b=this.w,x=b.globals;x.isBarHorizontal?(s=b.config.xaxis,c=Math.max((x.svgWidth-100)/25,2)):(s=b.config.yaxis[r],c=Math.max((x.svgHeight-100)/15,2)),ni.isNumber(c)||(c=10),d=s.min!==void 0&&s.min!==null,A=s.max!==void 0&&s.min!==null;var B=s.stepSize!==void 0&&s.stepSize!==null,T=s.tickAmount!==void 0&&s.tickAmount!==null,E=T?s.tickAmount:x.niceScaleDefaultTicks[Math.min(Math.round(c/2),x.niceScaleDefaultTicks.length-1)];if(x.isMultipleYAxis&&!T&&x.multiAxisTickAmount>0&&(E=x.multiAxisTickAmount,T=!0),E=E==="dataPoints"?x.dataPoints-1:Math.abs(Math.round(E)),(e===Number.MIN_VALUE&&i===0||!ni.isNumber(e)&&!ni.isNumber(i)||e===Number.MIN_VALUE&&i===-Number.MAX_VALUE)&&(e=ni.isNumber(s.min)?s.min:0,i=ni.isNumber(s.max)?s.max:e+E,x.allSeriesCollapsed=!1),e>i){console.warn("axis.min cannot be greater than axis.max: swapping min and max");var R=i;i=e,e=R}else e===i&&(e=e===0?0:e-1,i=i===0?2:i+1);var P=[];E<1&&(E=1);var G=E,U=Math.abs(i-e);!d&&e>0&&e/U<.15&&(e=0,d=!0),!A&&i<0&&-i/U<.15&&(i=0,A=!0);var Q=(U=Math.abs(i-e))/G,q=Q,ne=Math.floor(Math.log10(q)),re=Math.pow(10,ne),pe=Math.ceil(q/re);if(Q=q=(pe=x.niceScaleAllowedMagMsd[x.yValueDecimal===0?0:1][pe])*re,x.isBarHorizontal&&s.stepSize&&s.type!=="datetime"?(Q=s.stepSize,B=!0):B&&(Q=s.stepSize),B&&s.forceNiceScale){var fe=Math.floor(Math.log10(Q));Q*=Math.pow(10,ne-fe)}if(d&&A){var he=U/G;if(T)if(B)if(ni.mod(U,Q)!=0){var be=ni.getGCD(Q,he);Q=he/be<10?be:he}else ni.mod(Q,he)==0?Q=he:(he=Q,T=!1);else Q=he;else if(B)ni.mod(U,Q)==0?he=Q:Q=he;else if(ni.mod(U,Q)==0)he=Q;else{he=U/(G=Math.ceil(U/Q));var Se=ni.getGCD(U,Q);U/Se<c&&(he=Se),Q=he}G=Math.round(U/Q)}else{if(d||A){if(A)if(T)e=i-Q*G;else{var oe=e;e=Q*Math.floor(e/Q),Math.abs(i-e)/ni.getGCD(U,Q)>c&&(e=i-Q*E,e+=Q*Math.floor((oe-e)/Q))}else if(d)if(T)i=e+Q*G;else{var ye=i;i=Q*Math.ceil(i/Q),Math.abs(i-e)/ni.getGCD(U,Q)>c&&(i=e+Q*E,i+=Q*Math.ceil((ye-i)/Q))}}else if(x.isMultipleYAxis&&T){var Me=Q*Math.floor(e/Q),Be=Me+Q*G;Be<i&&(Q*=2),Be=i,i=(e=Me)+Q*G,U=Math.abs(i-e),e>0&&e<Math.abs(Be-i)&&(e=0,i=Q*G),i<0&&-i<Math.abs(Me-e)&&(i=0,e=-Q*G)}else e=Q*Math.floor(e/Q),i=Q*Math.ceil(i/Q);U=Math.abs(i-e),Q=ni.getGCD(U,Q),G=Math.round(U/Q)}if(T||d||A||(G=Math.ceil((U-y)/(Q+y)))>16&&ni.getPrimeFactors(G).length<2&&G++,!T&&s.forceNiceScale&&x.yValueDecimal===0&&G>U&&(G=U,Q=Math.round(U/G)),G>c&&(!T&&!B||s.forceNiceScale)){var Pe=ni.getPrimeFactors(G),De=Pe.length-1,et=G;e:for(var Ye=0;Ye<De;Ye++)for(var bt=0;bt<=De-Ye;bt++){for(var pt=Math.min(bt+Ye,De),Qt=et,Ie=1,ot=bt;ot<=pt;ot++)Ie*=Pe[ot];if((Qt/=Ie)<c){et=Qt;break e}}Q=et===G?U:U/et,G=Math.round(U/Q)}x.isMultipleYAxis&&x.multiAxisTickAmount==0&&x.ignoreYAxisIndexes.indexOf(r)<0&&(x.multiAxisTickAmount=G);var ut=e-Q,mt=Q*y;do ut+=Q,P.push(ni.stripNumber(ut,7));while(i-ut>mt);return{result:P,niceMin:P[0],niceMax:P[P.length-1]}}},{key:"linearScale",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,A=Math.abs(i-e),r=[];if(e===i)return{result:r=[e],niceMin:r[0],niceMax:r[r.length-1]};(s=this._adjustTicksForSmallRange(s,c,A))==="dataPoints"&&(s=this.w.globals.dataPoints-1),d||(d=A/s),d=Math.round(100*(d+Number.EPSILON))/100,s===Number.MAX_VALUE&&(s=5,d=1);for(var y=e;s>=0;)r.push(y),y=ni.preciseAddition(y,d),s-=1;return{result:r,niceMin:r[0],niceMax:r[r.length-1]}}},{key:"logarithmicScaleNice",value:function(e,i,s){i<=0&&(i=Math.max(e,s)),e<=0&&(e=Math.min(i,s));for(var c=[],d=Math.ceil(Math.log(i)/Math.log(s)+1),A=Math.floor(Math.log(e)/Math.log(s));A<d;A++)c.push(Math.pow(s,A));return{result:c,niceMin:c[0],niceMax:c[c.length-1]}}},{key:"logarithmicScale",value:function(e,i,s){i<=0&&(i=Math.max(e,s)),e<=0&&(e=Math.min(i,s));for(var c=[],d=Math.log(i)/Math.log(s),A=Math.log(e)/Math.log(s),r=d-A,y=Math.round(r),b=r/y,x=0,B=A;x<y;x++,B+=b)c.push(Math.pow(s,B));return c.push(Math.pow(s,d)),{result:c,niceMin:e,niceMax:i}}},{key:"_adjustTicksForSmallRange",value:function(e,i,s){var c=e;if(i!==void 0&&this.w.config.yaxis[i].labels.formatter&&this.w.config.yaxis[i].tickAmount===void 0){var d=Number(this.w.config.yaxis[i].labels.formatter(1));ni.isNumber(d)&&this.w.globals.yValueDecimal===0&&(c=Math.ceil(s))}return c<e?c:e}},{key:"setYScaleForIndex",value:function(e,i,s){var c=this.w.globals,d=this.w.config,A=c.isBarHorizontal?d.xaxis:d.yaxis[e];c.yAxisScale[e]===void 0&&(c.yAxisScale[e]=[]);var r=Math.abs(s-i);A.logarithmic&&r<=5&&(c.invalidLogScale=!0),A.logarithmic&&r>5?(c.allSeriesCollapsed=!1,c.yAxisScale[e]=A.forceNiceScale?this.logarithmicScaleNice(i,s,A.logBase):this.logarithmicScale(i,s,A.logBase)):s!==-Number.MAX_VALUE&&ni.isNumber(s)&&i!==Number.MAX_VALUE&&ni.isNumber(i)?(c.allSeriesCollapsed=!1,c.yAxisScale[e]=this.niceScale(i,s,e)):c.yAxisScale[e]=this.niceScale(Number.MIN_VALUE,0,e)}},{key:"setXScale",value:function(e,i){var s=this.w,c=s.globals;if(i!==-Number.MAX_VALUE&&ni.isNumber(i)){var d=c.xTickAmount;c.xAxisScale=this.linearScale(e,i,d,0,s.config.xaxis.stepSize)}else c.xAxisScale=this.linearScale(0,10,10);return c.xAxisScale}},{key:"scaleMultipleYAxes",value:function(){var e=this,i=this.w.config,s=this.w.globals;this.coreUtils.setSeriesYAxisMappings();var c=s.seriesYAxisMap,d=s.minYArr,A=s.maxYArr;s.allSeriesCollapsed=!0,s.barGroups=[],c.forEach(function(r,y){var b=[];r.forEach(function(x){var B,T=(B=i.series[x])===null||B===void 0?void 0:B.group;b.indexOf(T)<0&&b.push(T)}),r.length>0?function(){var x,B,T=Number.MAX_VALUE,E=-Number.MAX_VALUE,R=T,P=E;if(i.chart.stacked)(function(){var Q=new Array(s.dataPoints).fill(0),q=[],ne=[],re=[];b.forEach(function(){q.push(Q.map(function(){return Number.MIN_VALUE})),ne.push(Q.map(function(){return Number.MIN_VALUE})),re.push(Q.map(function(){return Number.MIN_VALUE}))});for(var pe=function(he){!x&&i.series[r[he]].type&&(x=i.series[r[he]].type);var be=r[he];B=i.series[be].group?i.series[be].group:"axis-".concat(y),!(s.collapsedSeriesIndices.indexOf(be)<0&&s.ancillaryCollapsedSeriesIndices.indexOf(be)<0)||(s.allSeriesCollapsed=!1,b.forEach(function(Se,oe){if(i.series[be].group===Se)for(var ye=0;ye<s.series[be].length;ye++){var Me=s.series[be][ye];Me>=0?ne[oe][ye]+=Me:re[oe][ye]+=Me,q[oe][ye]+=Me,R=Math.min(R,Me),P=Math.max(P,Me)}})),x!=="bar"&&x!=="column"||s.barGroups.push(B)},fe=0;fe<r.length;fe++)pe(fe);x||(x=i.chart.type),x==="bar"||x==="column"?b.forEach(function(he,be){T=Math.min(T,Math.min.apply(null,re[be])),E=Math.max(E,Math.max.apply(null,ne[be]))}):(b.forEach(function(he,be){R=Math.min(R,Math.min.apply(null,q[be])),P=Math.max(P,Math.max.apply(null,q[be]))}),T=R,E=P),T===Number.MIN_VALUE&&E===Number.MIN_VALUE&&(E=-Number.MAX_VALUE)})();else for(var G=0;G<r.length;G++){var U=r[G];T=Math.min(T,d[U]),E=Math.max(E,A[U]),!(s.collapsedSeriesIndices.indexOf(U)<0&&s.ancillaryCollapsedSeriesIndices.indexOf(U)<0)||(s.allSeriesCollapsed=!1)}i.yaxis[y].min!==void 0&&(T=typeof i.yaxis[y].min=="function"?i.yaxis[y].min(T):i.yaxis[y].min),i.yaxis[y].max!==void 0&&(E=typeof i.yaxis[y].max=="function"?i.yaxis[y].max(E):i.yaxis[y].max),s.barGroups=s.barGroups.filter(function(Q,q,ne){return ne.indexOf(Q)===q}),e.setYScaleForIndex(y,T,E),r.forEach(function(Q){d[Q]=s.yAxisScale[y].niceMin,A[Q]=s.yAxisScale[y].niceMax})}():e.setYScaleForIndex(y,0,-Number.MAX_VALUE)})}}]),a}(),Kb=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.scales=new WT(e)}return tn(a,[{key:"init",value:function(){this.setYRange(),this.setXRange(),this.setZRange()}},{key:"getMinYMaxY",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-Number.MAX_VALUE,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,d=this.w.config,A=this.w.globals,r=-Number.MAX_VALUE,y=Number.MIN_VALUE;c===null&&(c=e+1);var b=A.series,x=b,B=b;d.chart.type==="candlestick"?(x=A.seriesCandleL,B=A.seriesCandleH):d.chart.type==="boxPlot"?(x=A.seriesCandleO,B=A.seriesCandleC):A.isRangeData&&(x=A.seriesRangeStart,B=A.seriesRangeEnd);var T=!1;if(A.seriesX.length>=c){var E,R=(E=A.brushSource)===null||E===void 0?void 0:E.w.config.chart.brush;(d.chart.zoom.enabled&&d.chart.zoom.autoScaleYaxis||R!=null&&R.enabled&&R!=null&&R.autoScaleYaxis)&&(T=!0)}for(var P=e;P<c;P++){A.dataPoints=Math.max(A.dataPoints,b[P].length);var G=d.series[P].type;A.categoryLabels.length&&(A.dataPoints=A.categoryLabels.filter(function(be){return be!==void 0}).length),A.labels.length&&d.xaxis.type!=="datetime"&&A.series.reduce(function(be,Se){return be+Se.length},0)!==0&&(A.dataPoints=Math.max(A.dataPoints,A.labels.length));var U=0,Q=b[P].length-1;if(T){if(d.xaxis.min)for(;U<Q&&A.seriesX[P][U]<d.xaxis.min;U++);if(d.xaxis.max)for(;Q>U&&A.seriesX[P][Q]>d.xaxis.max;Q--);}for(var q=U;q<=Q&&q<A.series[P].length;q++){var ne=b[P][q];if(ne!==null&&ni.isNumber(ne)){var re,pe,fe,he;switch(((re=B[P])===null||re===void 0?void 0:re[q])!==void 0&&(r=Math.max(r,B[P][q]),i=Math.min(i,B[P][q])),((pe=x[P])===null||pe===void 0?void 0:pe[q])!==void 0&&(i=Math.min(i,x[P][q]),s=Math.max(s,x[P][q])),G){case"candlestick":A.seriesCandleC[P][q]!==void 0&&(r=Math.max(r,A.seriesCandleH[P][q]),i=Math.min(i,A.seriesCandleL[P][q]));break;case"boxPlot":A.seriesCandleC[P][q]!==void 0&&(r=Math.max(r,A.seriesCandleC[P][q]),i=Math.min(i,A.seriesCandleO[P][q]))}G&&G!=="candlestick"&&G!=="boxPlot"&&G!=="rangeArea"&&G!=="rangeBar"&&(r=Math.max(r,A.series[P][q]),i=Math.min(i,A.series[P][q])),A.seriesGoals[P]&&A.seriesGoals[P][q]&&Array.isArray(A.seriesGoals[P][q])&&A.seriesGoals[P][q].forEach(function(be){r=Math.max(r,be.value),i=Math.min(i,be.value)}),s=r,ne=ni.noExponents(ne),ni.isFloat(ne)&&(A.yValueDecimal=Math.max(A.yValueDecimal,ne.toString().split(".")[1].length)),y>((fe=x[P])===null||fe===void 0?void 0:fe[q])&&((he=x[P])===null||he===void 0?void 0:he[q])<0&&(y=x[P][q])}else A.hasNullValues=!0}G!=="bar"&&G!=="column"||(y<0&&r<0&&(r=0,s=Math.max(s,0)),y===Number.MIN_VALUE&&(y=0,i=Math.min(i,0)))}return d.chart.type==="rangeBar"&&A.seriesRangeStart.length&&A.isBarHorizontal&&(y=i),d.chart.type==="bar"&&(y<0&&r<0&&(r=0),y===Number.MIN_VALUE&&(y=0)),{minY:y,maxY:r,lowestY:i,highestY:s}}},{key:"setYRange",value:function(){var e=this.w.globals,i=this.w.config;e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE;var s,c=Number.MAX_VALUE;if(e.isMultipleYAxis){c=Number.MAX_VALUE;for(var d=0;d<e.series.length;d++)s=this.getMinYMaxY(d),e.minYArr[d]=s.lowestY,e.maxYArr[d]=s.highestY,c=Math.min(c,s.lowestY)}return s=this.getMinYMaxY(0,c,null,e.series.length),i.chart.type==="bar"?(e.minY=s.minY,e.maxY=s.maxY):(e.minY=s.lowestY,e.maxY=s.highestY),c=s.lowestY,i.chart.stacked&&this._setStackedMinMax(),i.chart.type==="line"||i.chart.type==="area"||i.chart.type==="scatter"||i.chart.type==="candlestick"||i.chart.type==="boxPlot"||i.chart.type==="rangeBar"&&!e.isBarHorizontal?e.minY===Number.MIN_VALUE&&c!==-Number.MAX_VALUE&&c!==e.maxY&&(e.minY=c):e.minY=e.minY!==Number.MIN_VALUE?Math.min(s.minY,e.minY):s.minY,i.yaxis.forEach(function(A,r){A.max!==void 0&&(typeof A.max=="number"?e.maxYArr[r]=A.max:typeof A.max=="function"&&(e.maxYArr[r]=A.max(e.isMultipleYAxis?e.maxYArr[r]:e.maxY)),e.maxY=e.maxYArr[r]),A.min!==void 0&&(typeof A.min=="number"?e.minYArr[r]=A.min:typeof A.min=="function"&&(e.minYArr[r]=A.min(e.isMultipleYAxis?e.minYArr[r]===Number.MIN_VALUE?0:e.minYArr[r]:e.minY)),e.minY=e.minYArr[r])}),e.isBarHorizontal&&["min","max"].forEach(function(A){i.xaxis[A]!==void 0&&typeof i.xaxis[A]=="number"&&(A==="min"?e.minY=i.xaxis[A]:e.maxY=i.xaxis[A])}),e.isMultipleYAxis?(this.scales.scaleMultipleYAxes(),e.minY=c):(this.scales.setYScaleForIndex(0,e.minY,e.maxY),e.minY=e.yAxisScale[0].niceMin,e.maxY=e.yAxisScale[0].niceMax,e.minYArr[0]=e.minY,e.maxYArr[0]=e.maxY),e.barGroups=[],e.lineGroups=[],e.areaGroups=[],i.series.forEach(function(A){switch(A.type||i.chart.type){case"bar":case"column":e.barGroups.push(A.group);break;case"line":e.lineGroups.push(A.group);break;case"area":e.areaGroups.push(A.group)}}),e.barGroups=e.barGroups.filter(function(A,r,y){return y.indexOf(A)===r}),e.lineGroups=e.lineGroups.filter(function(A,r,y){return y.indexOf(A)===r}),e.areaGroups=e.areaGroups.filter(function(A,r,y){return y.indexOf(A)===r}),{minY:e.minY,maxY:e.maxY,minYArr:e.minYArr,maxYArr:e.maxYArr,yAxisScale:e.yAxisScale}}},{key:"setXRange",value:function(){var e=this.w.globals,i=this.w.config,s=i.xaxis.type==="numeric"||i.xaxis.type==="datetime"||i.xaxis.type==="category"&&!e.noLabelsProvided||e.noLabelsProvided||e.isXNumeric;if(e.isXNumeric&&function(){for(var y=0;y<e.series.length;y++)if(e.labels[y])for(var b=0;b<e.labels[y].length;b++)e.labels[y][b]!==null&&ni.isNumber(e.labels[y][b])&&(e.maxX=Math.max(e.maxX,e.labels[y][b]),e.initialMaxX=Math.max(e.maxX,e.labels[y][b]),e.minX=Math.min(e.minX,e.labels[y][b]),e.initialMinX=Math.min(e.minX,e.labels[y][b]))}(),e.noLabelsProvided&&i.xaxis.categories.length===0&&(e.maxX=e.labels[e.labels.length-1],e.initialMaxX=e.labels[e.labels.length-1],e.minX=1,e.initialMinX=1),e.isXNumeric||e.noLabelsProvided||e.dataFormatXNumeric){var c=10;if(i.xaxis.tickAmount===void 0)c=Math.round(e.svgWidth/150),i.xaxis.type==="numeric"&&e.dataPoints<30&&(c=e.dataPoints-1),c>e.dataPoints&&e.dataPoints!==0&&(c=e.dataPoints-1);else if(i.xaxis.tickAmount==="dataPoints"){if(e.series.length>1&&(c=e.series[e.maxValsInArrayIndex].length-1),e.isXNumeric){var d=Math.round(e.maxX-e.minX);d<30&&(c=d-1)}}else c=i.xaxis.tickAmount;if(e.xTickAmount=c,i.xaxis.max!==void 0&&typeof i.xaxis.max=="number"&&(e.maxX=i.xaxis.max),i.xaxis.min!==void 0&&typeof i.xaxis.min=="number"&&(e.minX=i.xaxis.min),i.xaxis.range!==void 0&&(e.minX=e.maxX-i.xaxis.range),e.minX!==Number.MAX_VALUE&&e.maxX!==-Number.MAX_VALUE)if(i.xaxis.convertedCatToNumeric&&!e.dataFormatXNumeric){for(var A=[],r=e.minX-1;r<e.maxX;r++)A.push(r+1);e.xAxisScale={result:A,niceMin:A[0],niceMax:A[A.length-1]}}else e.xAxisScale=this.scales.setXScale(e.minX,e.maxX);else e.xAxisScale=this.scales.linearScale(0,c,c,0,i.xaxis.stepSize),e.noLabelsProvided&&e.labels.length>0&&(e.xAxisScale=this.scales.linearScale(1,e.labels.length,c-1,0,i.xaxis.stepSize),e.seriesX=e.labels.slice());s&&(e.labels=e.xAxisScale.result.slice())}return e.isBarHorizontal&&e.labels.length&&(e.xTickAmount=e.labels.length),this._handleSingleDataPoint(),this._getMinXDiff(),{minX:e.minX,maxX:e.maxX}}},{key:"setZRange",value:function(){var e=this.w.globals;if(e.isDataXYZ){for(var i=0;i<e.series.length;i++)if(e.seriesZ[i]!==void 0)for(var s=0;s<e.seriesZ[i].length;s++)e.seriesZ[i][s]!==null&&ni.isNumber(e.seriesZ[i][s])&&(e.maxZ=Math.max(e.maxZ,e.seriesZ[i][s]),e.minZ=Math.min(e.minZ,e.seriesZ[i][s]))}}},{key:"_handleSingleDataPoint",value:function(){var e=this.w.globals,i=this.w.config;if(e.minX===e.maxX){var s=new Pc(this.ctx);if(i.xaxis.type==="datetime"){var c=s.getDate(e.minX);i.xaxis.labels.datetimeUTC?c.setUTCDate(c.getUTCDate()-2):c.setDate(c.getDate()-2),e.minX=new Date(c).getTime();var d=s.getDate(e.maxX);i.xaxis.labels.datetimeUTC?d.setUTCDate(d.getUTCDate()+2):d.setDate(d.getDate()+2),e.maxX=new Date(d).getTime()}else(i.xaxis.type==="numeric"||i.xaxis.type==="category"&&!e.noLabelsProvided)&&(e.minX=e.minX-2,e.initialMinX=e.minX,e.maxX=e.maxX+2,e.initialMaxX=e.maxX)}}},{key:"_getMinXDiff",value:function(){var e=this.w.globals;e.isXNumeric&&e.seriesX.forEach(function(i,s){if(i.length){i.length===1&&i.push(e.seriesX[e.maxValsInArrayIndex][e.seriesX[e.maxValsInArrayIndex].length-1]);var c=i.slice();c.sort(function(d,A){return d-A}),c.forEach(function(d,A){if(A>0){var r=d-c[A-1];r>0&&(e.minXDiff=Math.min(r,e.minXDiff))}}),e.dataPoints!==1&&e.minXDiff!==Number.MAX_VALUE||(e.minXDiff=.5)}})}},{key:"_setStackedMinMax",value:function(){var e=this,i=this.w.globals;if(i.series.length){var s=i.seriesGroups;s.length||(s=[this.w.globals.seriesNames.map(function(A){return A})]);var c={},d={};s.forEach(function(A){c[A]=[],d[A]=[],e.w.config.series.map(function(r,y){return A.indexOf(i.seriesNames[y])>-1?y:null}).filter(function(r){return r!==null}).forEach(function(r){for(var y=0;y<i.series[i.maxValsInArrayIndex].length;y++){var b,x,B,T;c[A][y]===void 0&&(c[A][y]=0,d[A][y]=0),(e.w.config.chart.stacked&&!i.comboCharts||e.w.config.chart.stacked&&i.comboCharts&&(!e.w.config.chart.stackOnlyBar||((b=e.w.config.series)===null||b===void 0||(x=b[r])===null||x===void 0?void 0:x.type)==="bar"||((B=e.w.config.series)===null||B===void 0||(T=B[r])===null||T===void 0?void 0:T.type)==="column"))&&i.series[r][y]!==null&&ni.isNumber(i.series[r][y])&&(i.series[r][y]>0?c[A][y]+=parseFloat(i.series[r][y])+1e-4:d[A][y]+=parseFloat(i.series[r][y]))}})}),Object.entries(c).forEach(function(A){var r=hT(A,1)[0];c[r].forEach(function(y,b){i.maxY=Math.max(i.maxY,c[r][b]),i.minY=Math.min(i.minY,d[r][b])})})}}}]),a}(),ew=function(){function a(e,i){en(this,a),this.ctx=e,this.elgrid=i,this.w=e.w;var s=this.w;this.xaxisFontSize=s.config.xaxis.labels.style.fontSize,this.axisFontFamily=s.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=s.config.xaxis.labels.style.colors,this.isCategoryBarHorizontal=s.config.chart.type==="bar"&&s.config.plotOptions.bar.horizontal,this.xAxisoffX=s.config.xaxis.position==="bottom"?s.globals.gridHeight:0,this.drawnLabels=[],this.axesUtils=new Bp(e)}return tn(a,[{key:"drawYaxis",value:function(e){var i=this.w,s=new ur(this.ctx),c=i.config.yaxis[e].labels.style,d=c.fontSize,A=c.fontFamily,r=c.fontWeight,y=s.group({class:"apexcharts-yaxis",rel:e,transform:"translate(".concat(i.globals.translateYAxisX[e],", 0)")});if(this.axesUtils.isYAxisHidden(e))return y;var b=s.group({class:"apexcharts-yaxis-texts-g"});y.add(b);var x=i.globals.yAxisScale[e].result.length-1,B=i.globals.gridHeight/x,T=i.globals.yLabelFormatters[e],E=this.axesUtils.checkForReversedLabels(e,i.globals.yAxisScale[e].result.slice());if(i.config.yaxis[e].labels.show){var R=i.globals.translateY+i.config.yaxis[e].labels.offsetY;i.globals.isBarHorizontal?R=0:i.config.chart.type==="heatmap"&&(R-=B/2),R+=parseInt(d,10)/3;for(var P=x;P>=0;P--){var G=T(E[P],P,i),U=i.config.yaxis[e].labels.padding;i.config.yaxis[e].opposite&&i.config.yaxis.length!==0&&(U*=-1);var Q=this.getTextAnchor(i.config.yaxis[e].labels.align,i.config.yaxis[e].opposite),q=this.axesUtils.getYAxisForeColor(c.colors,e),ne=Array.isArray(q)?q[P]:q,re=ni.listToArray(i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-label tspan"))).map(function(fe){return fe.textContent}),pe=s.drawText({x:U,y:R,text:re.includes(G)&&!i.config.yaxis[e].labels.showDuplicates?"":G,textAnchor:Q,fontSize:d,fontFamily:A,fontWeight:r,maxWidth:i.config.yaxis[e].labels.maxWidth,foreColor:ne,isPlainText:!1,cssClass:"apexcharts-yaxis-label ".concat(c.cssClass)});b.add(pe),this.addTooltip(pe,G),i.config.yaxis[e].labels.rotate!==0&&this.rotateLabel(s,pe,firstLabel,i.config.yaxis[e].labels.rotate),R+=B}}return this.addYAxisTitle(s,y,e),this.addAxisBorder(s,y,e,x,B),y}},{key:"getTextAnchor",value:function(e,i){return e==="left"?"start":e==="center"?"middle":e==="right"?"end":i?"start":"end"}},{key:"addTooltip",value:function(e,i){var s=document.createElementNS(this.w.globals.SVGNS,"title");s.textContent=Array.isArray(i)?i.join(" "):i,e.node.appendChild(s)}},{key:"rotateLabel",value:function(e,i,s,c){var d=e.rotateAroundCenter(s.node),A=e.rotateAroundCenter(i.node);i.node.setAttribute("transform","rotate(".concat(c," ").concat(d.x," ").concat(A.y,")"))}},{key:"addYAxisTitle",value:function(e,i,s){var c=this.w;if(c.config.yaxis[s].title.text!==void 0){var d=e.group({class:"apexcharts-yaxis-title"}),A=c.config.yaxis[s].opposite?c.globals.translateYAxisX[s]:0,r=e.drawText({x:A,y:c.globals.gridHeight/2+c.globals.translateY+c.config.yaxis[s].title.offsetY,text:c.config.yaxis[s].title.text,textAnchor:"end",foreColor:c.config.yaxis[s].title.style.color,fontSize:c.config.yaxis[s].title.style.fontSize,fontWeight:c.config.yaxis[s].title.style.fontWeight,fontFamily:c.config.yaxis[s].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text ".concat(c.config.yaxis[s].title.style.cssClass)});d.add(r),i.add(d)}}},{key:"addAxisBorder",value:function(e,i,s,c,d){var A=this.w,r=A.config.yaxis[s].axisBorder,y=31+r.offsetX;if(A.config.yaxis[s].opposite&&(y=-31-r.offsetX),r.show){var b=e.drawLine(y,A.globals.translateY+r.offsetY-2,y,A.globals.gridHeight+A.globals.translateY+r.offsetY+2,r.color,0,r.width);i.add(b)}A.config.yaxis[s].axisTicks.show&&this.axesUtils.drawYAxisTicks(y,c,r,A.config.yaxis[s].axisTicks,s,d,i)}},{key:"drawYaxisInversed",value:function(e){var i=this.w,s=new ur(this.ctx),c=s.group({class:"apexcharts-xaxis apexcharts-yaxis-inversed"}),d=s.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(i.globals.translateXAxisX,", ").concat(i.globals.translateXAxisY,")")});c.add(d);var A=i.globals.yAxisScale[e].result.length-1,r=i.globals.gridWidth/A+.1,y=r+i.config.xaxis.labels.offsetX,b=i.globals.xLabelFormatter,x=this.axesUtils.checkForReversedLabels(e,i.globals.yAxisScale[e].result.slice()),B=i.globals.timescaleLabels;if(B.length>0&&(this.xaxisLabels=B.slice(),A=(x=B.slice()).length),i.config.xaxis.labels.show)for(var T=B.length?0:A;B.length?T<B.length:T>=0;B.length?T++:T--){var E=b(x[T],T,i),R=i.globals.gridWidth+i.globals.padHorizontal-(y-r+i.config.xaxis.labels.offsetX);if(B.length){var P=this.axesUtils.getLabel(x,B,R,T,this.drawnLabels,this.xaxisFontSize);R=P.x,E=P.text,this.drawnLabels.push(P.text),T===0&&i.globals.skipFirstTimelinelabel&&(E=""),T===x.length-1&&i.globals.skipLastTimelinelabel&&(E="")}var G=s.drawText({x:R,y:this.xAxisoffX+i.config.xaxis.labels.offsetY+30-(i.config.xaxis.position==="top"?i.globals.xAxisHeight+i.config.xaxis.axisTicks.height-2:0),text:E,textAnchor:"middle",foreColor:Array.isArray(this.xaxisForeColors)?this.xaxisForeColors[e]:this.xaxisForeColors,fontSize:this.xaxisFontSize,fontFamily:this.xaxisFontFamily,fontWeight:i.config.xaxis.labels.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-xaxis-label ".concat(i.config.xaxis.labels.style.cssClass)});d.add(G),G.tspan(E),this.addTooltip(G,E),y+=r}return this.inversedYAxisTitleText(c),this.inversedYAxisBorder(c),c}},{key:"inversedYAxisBorder",value:function(e){var i=this.w,s=new ur(this.ctx),c=i.config.xaxis.axisBorder;if(c.show){var d=0;i.config.chart.type==="bar"&&i.globals.isXNumeric&&(d-=15);var A=s.drawLine(i.globals.padHorizontal+d+c.offsetX,this.xAxisoffX,i.globals.gridWidth,this.xAxisoffX,c.color,0,c.height);this.elgrid&&this.elgrid.elGridBorders&&i.config.grid.show?this.elgrid.elGridBorders.add(A):e.add(A)}}},{key:"inversedYAxisTitleText",value:function(e){var i=this.w,s=new ur(this.ctx);if(i.config.xaxis.title.text!==void 0){var c=s.group({class:"apexcharts-xaxis-title apexcharts-yaxis-title-inversed"}),d=s.drawText({x:i.globals.gridWidth/2+i.config.xaxis.title.offsetX,y:this.xAxisoffX+parseFloat(this.xaxisFontSize)+parseFloat(i.config.xaxis.title.style.fontSize)+i.config.xaxis.title.offsetY+20,text:i.config.xaxis.title.text,textAnchor:"middle",fontSize:i.config.xaxis.title.style.fontSize,fontFamily:i.config.xaxis.title.style.fontFamily,fontWeight:i.config.xaxis.title.style.fontWeight,foreColor:i.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text ".concat(i.config.xaxis.title.style.cssClass)});c.add(d),e.add(c)}}},{key:"yAxisTitleRotate",value:function(e,i){var s=this.w,c=new ur(this.ctx),d=s.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-texts-g")),A=d?d.getBoundingClientRect():{width:0,height:0},r=s.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-title text")),y=r?r.getBoundingClientRect():{width:0,height:0};if(r){var b=this.xPaddingForYAxisTitle(e,A,y,i);r.setAttribute("x",b.xPos-(i?10:0));var x=c.rotateAroundCenter(r);r.setAttribute("transform","rotate(".concat(i?-1*s.config.yaxis[e].title.rotate:s.config.yaxis[e].title.rotate," ").concat(x.x," ").concat(x.y,")"))}}},{key:"xPaddingForYAxisTitle",value:function(e,i,s,c){var d=this.w,A=0,r=10;return d.config.yaxis[e].title.text===void 0||e<0?{xPos:A,padd:0}:(c?A=i.width+d.config.yaxis[e].title.offsetX+s.width/2+r/2:(A=-1*i.width+d.config.yaxis[e].title.offsetX+r/2+s.width/2,d.globals.isBarHorizontal&&(r=25,A=-1*i.width-d.config.yaxis[e].title.offsetX-r)),{xPos:A,padd:r})}},{key:"setYAxisXPosition",value:function(e,i){var s=this.w,c=0,d=0,A=18,r=1;s.config.yaxis.length>1&&(this.multipleYs=!0),s.config.yaxis.forEach(function(y,b){var x=s.globals.ignoreYAxisIndexes.includes(b)||!y.show||y.floating||e[b].width===0,B=e[b].width+i[b].width;y.opposite?s.globals.isBarHorizontal?(d=s.globals.gridWidth+s.globals.translateX-1,s.globals.translateYAxisX[b]=d-y.labels.offsetX):(d=s.globals.gridWidth+s.globals.translateX+r,x||(r+=B+20),s.globals.translateYAxisX[b]=d-y.labels.offsetX+20):(c=s.globals.translateX-A,x||(A+=B+20),s.globals.translateYAxisX[b]=c+y.labels.offsetX)})}},{key:"setYAxisTextAlignments",value:function(){var e=this.w;ni.listToArray(e.globals.dom.baseEl.getElementsByClassName("apexcharts-yaxis")).forEach(function(i,s){var c=e.config.yaxis[s];if(c&&!c.floating&&c.labels.align!==void 0){var d=e.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(s,"'] .apexcharts-yaxis-texts-g")),A=ni.listToArray(e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(s,"'] .apexcharts-yaxis-label"))),r=d.getBoundingClientRect();A.forEach(function(y){y.setAttribute("text-anchor",c.labels.align)}),c.labels.align!=="left"||c.opposite?c.labels.align==="center"?d.setAttribute("transform","translate(".concat(r.width/2*(c.opposite?1:-1),", 0)")):c.labels.align==="right"&&c.opposite&&d.setAttribute("transform","translate(".concat(r.width,", 0)")):d.setAttribute("transform","translate(-".concat(r.width,", 0)"))}})}}]),a}(),HR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.documentEvent=ni.bind(this.documentEvent,this)}return tn(a,[{key:"addEventListener",value:function(e,i){var s=this.w;s.globals.events.hasOwnProperty(e)?s.globals.events[e].push(i):s.globals.events[e]=[i]}},{key:"removeEventListener",value:function(e,i){var s=this.w;if(s.globals.events.hasOwnProperty(e)){var c=s.globals.events[e].indexOf(i);c!==-1&&s.globals.events[e].splice(c,1)}}},{key:"fireEvent",value:function(e,i){var s=this.w;if(s.globals.events.hasOwnProperty(e)){i&&i.length||(i=[]);for(var c=s.globals.events[e],d=c.length,A=0;A<d;A++)c[A].apply(null,i)}}},{key:"setupEventHandlers",value:function(){var e=this,i=this.w,s=this.ctx,c=i.globals.dom.baseEl.querySelector(i.globals.chartClass);this.ctx.eventList.forEach(function(d){c.addEventListener(d,function(A){var r=A.target.getAttribute("i")===null&&i.globals.capturedSeriesIndex!==-1?i.globals.capturedSeriesIndex:A.target.getAttribute("i"),y=A.target.getAttribute("j")===null&&i.globals.capturedDataPointIndex!==-1?i.globals.capturedDataPointIndex:A.target.getAttribute("j"),b=Object.assign({},i,{seriesIndex:i.globals.axisCharts?r:0,dataPointIndex:y});A.type==="mousemove"||A.type==="touchmove"?typeof i.config.chart.events.mouseMove=="function"&&i.config.chart.events.mouseMove(A,s,b):A.type==="mouseleave"||A.type==="touchleave"?typeof i.config.chart.events.mouseLeave=="function"&&i.config.chart.events.mouseLeave(A,s,b):(A.type==="mouseup"&&A.which===1||A.type==="touchend")&&(typeof i.config.chart.events.click=="function"&&i.config.chart.events.click(A,s,b),s.ctx.events.fireEvent("click",[A,s,b]))},{capture:!1,passive:!0})}),this.ctx.eventList.forEach(function(d){i.globals.dom.baseEl.addEventListener(d,e.documentEvent,{passive:!0})}),this.ctx.core.setupBrushHandler()}},{key:"documentEvent",value:function(e){var i=this.w,s=e.target.className;if(e.type==="click"){var c=i.globals.dom.baseEl.querySelector(".apexcharts-menu");c&&c.classList.contains("apexcharts-menu-open")&&s!=="apexcharts-menu-icon"&&c.classList.remove("apexcharts-menu-open")}i.globals.clientX=e.type==="touchmove"?e.touches[0].clientX:e.clientX,i.globals.clientY=e.type==="touchmove"?e.touches[0].clientY:e.clientY}}]),a}(),QR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"setCurrentLocaleValues",value:function(e){var i=this.w.config.chart.locales;window.Apex.chart&&window.Apex.chart.locales&&window.Apex.chart.locales.length>0&&(i=this.w.config.chart.locales.concat(window.Apex.chart.locales));var s=i.filter(function(d){return d.name===e})[0];if(!s)throw new Error("Wrong locale name provided. Please make sure you set the correct locale name in options");var c=ni.extend(HT,s);this.w.globals.locale=c.options}}]),a}(),VR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawAxis",value:function(e,i){var s,c,d=this,A=this.w.globals,r=this.w.config,y=new Uy(this.ctx,i),b=new ew(this.ctx,i);A.axisCharts&&e!=="radar"&&(A.isBarHorizontal?(c=b.drawYaxisInversed(0),s=y.drawXaxisInversed(0),A.dom.elGraphical.add(s),A.dom.elGraphical.add(c)):(s=y.drawXaxis(),A.dom.elGraphical.add(s),r.yaxis.map(function(x,B){if(A.ignoreYAxisIndexes.indexOf(B)===-1&&(c=b.drawYaxis(B),A.dom.Paper.add(c),d.w.config.grid.position==="back")){var T=A.dom.Paper.children()[1];T.remove(),A.dom.Paper.add(T)}})))}}]),a}(),qb=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawXCrosshairs",value:function(){var e=this.w,i=new ur(this.ctx),s=new Rc(this.ctx),c=e.config.xaxis.crosshairs.fill.gradient,d=e.config.xaxis.crosshairs.dropShadow,A=e.config.xaxis.crosshairs.fill.type,r=c.colorFrom,y=c.colorTo,b=c.opacityFrom,x=c.opacityTo,B=c.stops,T=d.enabled,E=d.left,R=d.top,P=d.blur,G=d.color,U=d.opacity,Q=e.config.xaxis.crosshairs.fill.color;if(e.config.xaxis.crosshairs.show){A==="gradient"&&(Q=i.drawGradient("vertical",r,y,b,x,null,B,null));var q=i.drawRect();e.config.xaxis.crosshairs.width===1&&(q=i.drawLine());var ne=e.globals.gridHeight;(!ni.isNumber(ne)||ne<0)&&(ne=0);var re=e.config.xaxis.crosshairs.width;(!ni.isNumber(re)||re<0)&&(re=0),q.attr({class:"apexcharts-xcrosshairs",x:0,y:0,y2:ne,width:re,height:ne,fill:Q,filter:"none","fill-opacity":e.config.xaxis.crosshairs.opacity,stroke:e.config.xaxis.crosshairs.stroke.color,"stroke-width":e.config.xaxis.crosshairs.stroke.width,"stroke-dasharray":e.config.xaxis.crosshairs.stroke.dashArray}),T&&(q=s.dropShadow(q,{left:E,top:R,blur:P,color:G,opacity:U})),e.globals.dom.elGraphical.add(q)}}},{key:"drawYCrosshairs",value:function(){var e=this.w,i=new ur(this.ctx),s=e.config.yaxis[0].crosshairs,c=e.globals.barPadForNumericAxis;if(e.config.yaxis[0].crosshairs.show){var d=i.drawLine(-c,0,e.globals.gridWidth+c,0,s.stroke.color,s.stroke.dashArray,s.stroke.width);d.attr({class:"apexcharts-ycrosshairs"}),e.globals.dom.elGraphical.add(d)}var A=i.drawLine(-c,0,e.globals.gridWidth+c,0,s.stroke.color,0,0);A.attr({class:"apexcharts-ycrosshairs-hidden"}),e.globals.dom.elGraphical.add(A)}}]),a}(),GR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"checkResponsiveConfig",value:function(e){var i=this,s=this.w,c=s.config;if(c.responsive.length!==0){var d=c.responsive.slice();d.sort(function(b,x){return b.breakpoint>x.breakpoint?1:x.breakpoint>b.breakpoint?-1:0}).reverse();var A=new Oy({}),r=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},x=d[0].breakpoint,B=window.innerWidth>0?window.innerWidth:screen.width;if(B>x){var T=ni.clone(s.globals.initialConfig);T.series=ni.clone(s.config.series);var E=nl.extendArrayProps(A,T,s);b=ni.extend(E,b),b=ni.extend(s.config,b),i.overrideResponsiveOptions(b)}else for(var R=0;R<d.length;R++)B<d[R].breakpoint&&(b=nl.extendArrayProps(A,d[R].options,s),b=ni.extend(s.config,b),i.overrideResponsiveOptions(b))};if(e){var y=nl.extendArrayProps(A,e,s);y=ni.extend(s.config,y),r(y=ni.extend(y,e))}else r({})}}},{key:"overrideResponsiveOptions",value:function(e){var i=new Oy(e).init({responsiveOverride:!0});this.w.config=i}}]),a}(),WR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.colors=[],this.isColorFn=!1,this.isHeatmapDistributed=this.checkHeatmapDistributed(),this.isBarDistributed=this.checkBarDistributed()}return tn(a,[{key:"checkHeatmapDistributed",value:function(){var e=this.w.config,i=e.chart,s=e.plotOptions;return i.type==="treemap"&&s.treemap&&s.treemap.distributed||i.type==="heatmap"&&s.heatmap&&s.heatmap.distributed}},{key:"checkBarDistributed",value:function(){var e=this.w.config,i=e.chart,s=e.plotOptions;return s.bar&&s.bar.distributed&&(i.type==="bar"||i.type==="rangeBar")}},{key:"init",value:function(){this.setDefaultColors()}},{key:"setDefaultColors",value:function(){var e=this.w,i=new ni;e.globals.dom.elWrap.classList.add("apexcharts-theme-".concat(e.config.theme.mode||"light"));var s=Kl(e.config.colors||e.config.fill.colors||[]);e.globals.colors=this.getColors(s),this.applySeriesColors(e.globals.seriesColors,e.globals.colors),e.config.theme.monochrome.enabled&&(e.globals.colors=this.getMonochromeColors(e.config.theme.monochrome,e.globals.series,i));var c=e.globals.colors.slice();this.pushExtraColors(e.globals.colors),this.applyColorTypes(["fill","stroke"],c),this.applyDataLabelsColors(c),this.applyRadarPolygonsColors(),this.applyMarkersColors(c)}},{key:"getColors",value:function(e){var i=this,s=this.w;return e&&e.length!==0?Array.isArray(e)&&e.length>0&&typeof e[0]=="function"?(this.isColorFn=!0,s.config.series.map(function(c,d){var A=e[d]||e[0];return typeof A=="function"?A({value:s.globals.axisCharts?s.globals.series[d][0]||0:s.globals.series[d],seriesIndex:d,dataPointIndex:d,w:i.w}):A})):e:this.predefined()}},{key:"applySeriesColors",value:function(e,i){e.forEach(function(s,c){s&&(i[c]=s)})}},{key:"getMonochromeColors",value:function(e,i,s){var c=e.color,d=e.shadeIntensity,A=e.shadeTo,r=this.isBarDistributed||this.isHeatmapDistributed?i[0].length*i.length:i.length,y=1/(r/d),b=0;return Array.from({length:r},function(){var x=A==="dark"?s.shadeColor(-1*b,c):s.shadeColor(b,c);return b+=y,x})}},{key:"applyColorTypes",value:function(e,i){var s=this,c=this.w;e.forEach(function(d){c.globals[d].colors=c.config[d].colors===void 0?s.isColorFn?c.config.colors:i:c.config[d].colors.slice(),s.pushExtraColors(c.globals[d].colors)})}},{key:"applyDataLabelsColors",value:function(e){var i=this.w;i.globals.dataLabels.style.colors=i.config.dataLabels.style.colors===void 0?e:i.config.dataLabels.style.colors.slice(),this.pushExtraColors(i.globals.dataLabels.style.colors,50)}},{key:"applyRadarPolygonsColors",value:function(){var e=this.w;e.globals.radarPolygons.fill.colors=e.config.plotOptions.radar.polygons.fill.colors===void 0?[e.config.theme.mode==="dark"?"#343A3F":"none"]:e.config.plotOptions.radar.polygons.fill.colors.slice(),this.pushExtraColors(e.globals.radarPolygons.fill.colors,20)}},{key:"applyMarkersColors",value:function(e){var i=this.w;i.globals.markers.colors=i.config.markers.colors===void 0?e:i.config.markers.colors.slice(),this.pushExtraColors(i.globals.markers.colors)}},{key:"pushExtraColors",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=this.w,d=i||c.globals.series.length;if(s===null&&(s=this.isBarDistributed||this.isHeatmapDistributed||c.config.chart.type==="heatmap"&&c.config.plotOptions.heatmap&&c.config.plotOptions.heatmap.colorScale.inverse),s&&c.globals.series.length&&(d=c.globals.series[c.globals.maxValsInArrayIndex].length*c.globals.series.length),e.length<d)for(var A=d-e.length,r=0;r<A;r++)e.push(e[r])}},{key:"updateThemeOptions",value:function(e){e.chart=e.chart||{},e.tooltip=e.tooltip||{};var i=e.theme.mode,s=i==="dark"?"palette4":i==="light"?"palette1":e.theme.palette||"palette1",c=i==="dark"?"#f6f7f8":i==="light"?"#373d3f":e.chart.foreColor||"#373d3f";return e.tooltip.theme=i||"light",e.chart.foreColor=c,e.theme.palette=s,e}},{key:"predefined",value:function(){var e={palette1:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"],palette2:["#3f51b5","#03a9f4","#4caf50","#f9ce1d","#FF9800"],palette3:["#33b2df","#546E7A","#d4526e","#13d8aa","#A5978B"],palette4:["#4ecdc4","#c7f464","#81D4FA","#fd6a6a","#546E7A"],palette5:["#2b908f","#f9a3a4","#90ee7e","#fa4443","#69d2e7"],palette6:["#449DD1","#F86624","#EA3546","#662E9B","#C5D86D"],palette7:["#D7263D","#1B998B","#2E294E","#F46036","#E2C044"],palette8:["#662E9B","#F86624","#F9C80E","#EA3546","#43BCCD"],palette9:["#5C4742","#A5978B","#8D5B4C","#5A2A27","#C4BBAF"],palette10:["#A300D6","#7D02EB","#5653FE","#2983FF","#00B1F2"],default:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"]};return e[this.w.config.theme.palette]||e.default}}]),a}(),XR=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"draw",value:function(){this.drawTitleSubtitle("title"),this.drawTitleSubtitle("subtitle")}},{key:"drawTitleSubtitle",value:function(e){var i=this.w,s=e==="title"?i.config.title:i.config.subtitle,c=i.globals.svgWidth/2,d=s.offsetY,A="middle";if(s.align==="left"?(c=10,A="start"):s.align==="right"&&(c=i.globals.svgWidth-10,A="end"),c+=s.offsetX,d=d+parseInt(s.style.fontSize,10)+s.margin/2,s.text!==void 0){var r=new ur(this.ctx).drawText({x:c,y:d,text:s.text,textAnchor:A,fontSize:s.style.fontSize,fontFamily:s.style.fontFamily,fontWeight:s.style.fontWeight,foreColor:s.style.color,opacity:1});r.node.setAttribute("class","apexcharts-".concat(e,"-text")),i.globals.dom.Paper.add(r)}}}]),a}(),YR=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getTitleSubtitleCoords",value:function(e){var i=this.w,s=0,c=0,d=e==="title"?i.config.title.floating:i.config.subtitle.floating,A=i.globals.dom.baseEl.querySelector(".apexcharts-".concat(e,"-text"));if(A!==null&&!d){var r=A.getBoundingClientRect();s=r.width,c=i.globals.axisCharts?r.height+5:r.height}return{width:s,height:c}}},{key:"getLegendsRect",value:function(){var e=this.w,i=e.globals.dom.elLegendWrap;e.config.legend.height||e.config.legend.position!=="top"&&e.config.legend.position!=="bottom"||(i.style.maxHeight=e.globals.svgHeight/2+"px");var s=Object.assign({},ni.getBoundingClientRect(i));return i!==null&&!e.config.legend.floating&&e.config.legend.show?this.dCtx.lgRect={x:s.x,y:s.y,height:s.height,width:s.height===0?0:s.width}:this.dCtx.lgRect={x:0,y:0,height:0,width:0},e.config.legend.position!=="left"&&e.config.legend.position!=="right"||1.5*this.dCtx.lgRect.width>e.globals.svgWidth&&(this.dCtx.lgRect.width=e.globals.svgWidth/1.5),this.dCtx.lgRect}},{key:"getDatalabelsRect",value:function(){var e=this,i=this.w,s=[];i.config.series.forEach(function(y,b){y.data.forEach(function(x,B){var T;T=i.globals.series[b][B],c=i.config.dataLabels.formatter(T,{ctx:e.dCtx.ctx,seriesIndex:b,dataPointIndex:B,w:i}),s.push(c)})});var c=ni.getLargestStringFromArr(s),d=new ur(this.dCtx.ctx),A=i.config.dataLabels.style,r=d.getTextRects(c,parseInt(A.fontSize),A.fontFamily);return{width:1.05*r.width,height:r.height}}},{key:"getLargestStringFromMultiArr",value:function(e,i){var s=e;if(this.w.globals.isMultiLineX){var c=i.map(function(A,r){return Array.isArray(A)?A.length:1}),d=Math.max.apply(Math,Kl(c));s=i[c.indexOf(d)]}return s}}]),a}(),KR=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getxAxisLabelsCoords",value:function(){var e,i=this.w,s=i.globals.labels.slice();if(i.config.xaxis.convertedCatToNumeric&&s.length===0&&(s=i.globals.categoryLabels),i.globals.timescaleLabels.length>0){var c=this.getxAxisTimeScaleLabelsCoords();e={width:c.width,height:c.height},i.globals.rotateXLabels=!1}else{this.dCtx.lgWidthForSideLegends=i.config.legend.position!=="left"&&i.config.legend.position!=="right"||i.config.legend.floating?0:this.dCtx.lgRect.width;var d=i.globals.xLabelFormatter,A=ni.getLargestStringFromArr(s),r=this.dCtx.dimHelpers.getLargestStringFromMultiArr(A,s);i.globals.isBarHorizontal&&(r=A=i.globals.yAxisScale[0].result.reduce(function(R,P){return R.length>P.length?R:P},0));var y=new Zy(this.dCtx.ctx),b=A;A=y.xLabelFormat(d,A,b,{i:void 0,dateFormatter:new Pc(this.dCtx.ctx).formatDate,w:i}),r=y.xLabelFormat(d,r,b,{i:void 0,dateFormatter:new Pc(this.dCtx.ctx).formatDate,w:i}),(i.config.xaxis.convertedCatToNumeric&&A===void 0||String(A).trim()==="")&&(r=A="1");var x=new ur(this.dCtx.ctx),B=x.getTextRects(A,i.config.xaxis.labels.style.fontSize),T=B;if(A!==r&&(T=x.getTextRects(r,i.config.xaxis.labels.style.fontSize)),(e={width:B.width>=T.width?B.width:T.width,height:B.height>=T.height?B.height:T.height}).width*s.length>i.globals.svgWidth-this.dCtx.lgWidthForSideLegends-this.dCtx.yAxisWidth-this.dCtx.gridPad.left-this.dCtx.gridPad.right&&i.config.xaxis.labels.rotate!==0||i.config.xaxis.labels.rotateAlways){if(!i.globals.isBarHorizontal){i.globals.rotateXLabels=!0;var E=function(R){return x.getTextRects(R,i.config.xaxis.labels.style.fontSize,i.config.xaxis.labels.style.fontFamily,"rotate(".concat(i.config.xaxis.labels.rotate," 0 0)"),!1)};B=E(A),A!==r&&(T=E(r)),e.height=(B.height>T.height?B.height:T.height)/1.5,e.width=B.width>T.width?B.width:T.width}}else i.globals.rotateXLabels=!1}return i.config.xaxis.labels.show||(e={width:0,height:0}),{width:e.width,height:e.height}}},{key:"getxAxisGroupLabelsCoords",value:function(){var e,i=this.w;if(!i.globals.hasXaxisGroups)return{width:0,height:0};var s,c=((e=i.config.xaxis.group.style)===null||e===void 0?void 0:e.fontSize)||i.config.xaxis.labels.style.fontSize,d=i.globals.groups.map(function(B){return B.title}),A=ni.getLargestStringFromArr(d),r=this.dCtx.dimHelpers.getLargestStringFromMultiArr(A,d),y=new ur(this.dCtx.ctx),b=y.getTextRects(A,c),x=b;return A!==r&&(x=y.getTextRects(r,c)),s={width:b.width>=x.width?b.width:x.width,height:b.height>=x.height?b.height:x.height},i.config.xaxis.labels.show||(s={width:0,height:0}),{width:s.width,height:s.height}}},{key:"getxAxisTitleCoords",value:function(){var e=this.w,i=0,s=0;if(e.config.xaxis.title.text!==void 0){var c=new ur(this.dCtx.ctx).getTextRects(e.config.xaxis.title.text,e.config.xaxis.title.style.fontSize);i=c.width,s=c.height}return{width:i,height:s}}},{key:"getxAxisTimeScaleLabelsCoords",value:function(){var e,i=this.w;this.dCtx.timescaleLabels=i.globals.timescaleLabels.slice();var s=this.dCtx.timescaleLabels.map(function(d){return d.value}),c=s.reduce(function(d,A){return d===void 0?(console.error("You have possibly supplied invalid Date format. Please supply a valid JavaScript Date"),0):d.length>A.length?d:A},0);return 1.05*(e=new ur(this.dCtx.ctx).getTextRects(c,i.config.xaxis.labels.style.fontSize)).width*s.length>i.globals.gridWidth&&i.config.xaxis.labels.rotate!==0&&(i.globals.overlappingXLabels=!0),e}},{key:"additionalPaddingXLabels",value:function(e){var i=this,s=this.w,c=s.globals,d=s.config,A=d.xaxis.type,r=e.width;c.skipLastTimelinelabel=!1,c.skipFirstTimelinelabel=!1;var y=s.config.yaxis[0].opposite&&s.globals.isBarHorizontal,b=function(x,B){d.yaxis.length>1&&function(T){return c.collapsedSeriesIndices.indexOf(T)!==-1}(B)||function(T){if(i.dCtx.timescaleLabels&&i.dCtx.timescaleLabels.length){var E=i.dCtx.timescaleLabels[0],R=i.dCtx.timescaleLabels[i.dCtx.timescaleLabels.length-1].position+r/1.75-i.dCtx.yAxisWidthRight,P=E.position-r/1.75+i.dCtx.yAxisWidthLeft,G=s.config.legend.position==="right"&&i.dCtx.lgRect.width>0?i.dCtx.lgRect.width:0;R>c.svgWidth-c.translateX-G&&(c.skipLastTimelinelabel=!0),P<-(T.show&&!T.floating||d.chart.type!=="bar"&&d.chart.type!=="candlestick"&&d.chart.type!=="rangeBar"&&d.chart.type!=="boxPlot"?10:r/1.75)&&(c.skipFirstTimelinelabel=!0)}else A==="datetime"?i.dCtx.gridPad.right<r&&!c.rotateXLabels&&(c.skipLastTimelinelabel=!0):A!=="datetime"&&i.dCtx.gridPad.right<r/2-i.dCtx.yAxisWidthRight&&!c.rotateXLabels&&!s.config.xaxis.labels.trim&&(i.dCtx.xPadRight=r/2+1)}(x)};d.yaxis.forEach(function(x,B){y?(i.dCtx.gridPad.left<r&&(i.dCtx.xPadLeft=r/2+1),i.dCtx.xPadRight=r/2+1):b(x,B)})}}]),a}(),qR=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getyAxisLabelsCoords",value:function(){var e=this,i=this.w,s=[],c=10,d=new Bp(this.dCtx.ctx);return i.config.yaxis.map(function(A,r){var y={seriesIndex:r,dataPointIndex:-1,w:i},b=i.globals.yAxisScale[r],x=0;if(!d.isYAxisHidden(r)&&A.labels.show&&A.labels.minWidth!==void 0&&(x=A.labels.minWidth),!d.isYAxisHidden(r)&&A.labels.show&&b.result.length){var B=i.globals.yLabelFormatters[r],T=b.niceMin===Number.MIN_VALUE?0:b.niceMin,E=b.result.reduce(function(ne,re){var pe,fe;return((pe=String(B(ne,y)))===null||pe===void 0?void 0:pe.length)>((fe=String(B(re,y)))===null||fe===void 0?void 0:fe.length)?ne:re},T),R=E=B(E,y);if(E!==void 0&&E.length!==0||(E=b.niceMax),i.globals.isBarHorizontal){c=0;var P=i.globals.labels.slice();E=ni.getLargestStringFromArr(P),E=B(E,{seriesIndex:r,dataPointIndex:-1,w:i}),R=e.dCtx.dimHelpers.getLargestStringFromMultiArr(E,P)}var G=new ur(e.dCtx.ctx),U="rotate(".concat(A.labels.rotate," 0 0)"),Q=G.getTextRects(E,A.labels.style.fontSize,A.labels.style.fontFamily,U,!1),q=Q;E!==R&&(q=G.getTextRects(R,A.labels.style.fontSize,A.labels.style.fontFamily,U,!1)),s.push({width:(x>q.width||x>Q.width?x:q.width>Q.width?q.width:Q.width)+c,height:q.height>Q.height?q.height:Q.height})}else s.push({width:0,height:0})}),s}},{key:"getyAxisTitleCoords",value:function(){var e=this,i=this.w,s=[];return i.config.yaxis.map(function(c,d){if(c.show&&c.title.text!==void 0){var A=new ur(e.dCtx.ctx),r="rotate(".concat(c.title.rotate," 0 0)"),y=A.getTextRects(c.title.text,c.title.style.fontSize,c.title.style.fontFamily,r,!1);s.push({width:y.width,height:y.height})}else s.push({width:0,height:0})}),s}},{key:"getTotalYAxisWidth",value:function(){var e=this.w,i=0,s=0,c=0,d=e.globals.yAxisScale.length>1?10:0,A=new Bp(this.dCtx.ctx),r=function(y,b){var x=e.config.yaxis[b].floating,B=0;y.width>0&&!x?(B=y.width+d,function(T){return e.globals.ignoreYAxisIndexes.indexOf(T)>-1}(b)&&(B=B-y.width-d)):B=x||A.isYAxisHidden(b)?0:5,e.config.yaxis[b].opposite?c+=B:s+=B,i+=B};return e.globals.yLabelsCoords.map(function(y,b){r(y,b)}),e.globals.yTitleCoords.map(function(y,b){r(y,b)}),e.globals.isBarHorizontal&&!e.config.yaxis[0].floating&&(i=e.globals.yLabelsCoords[0].width+e.globals.yTitleCoords[0].width+15),this.dCtx.yAxisWidthLeft=s,this.dCtx.yAxisWidthRight=c,i}}]),a}(),$R=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"gridPadForColumnsInNumericAxis",value:function(e){var i=this.w,s=i.config,c=i.globals;if(c.noData||c.collapsedSeries.length+c.ancillaryCollapsedSeries.length===s.series.length)return 0;var d=function(E){return["bar","rangeBar","candlestick","boxPlot"].includes(E)},A=s.chart.type,r=0,y=d(A)?s.series.length:1;c.comboBarCount>0&&(y=c.comboBarCount),c.collapsedSeries.forEach(function(E){d(E.type)&&(y-=1)}),s.chart.stacked&&(y=1);var b=d(A)||c.comboBarCount>0,x=Math.abs(c.initialMaxX-c.initialMinX);if(b&&c.isXNumeric&&!c.isBarHorizontal&&y>0&&x!==0){x<=3&&(x=c.dataPoints);var B=x/e,T=c.minXDiff&&c.minXDiff/B>0?c.minXDiff/B:0;T>e/2&&(T/=2),(r=T*parseInt(s.plotOptions.bar.columnWidth,10)/100)<1&&(r=1),c.barPadForNumericAxis=r}return r}},{key:"gridPadFortitleSubtitle",value:function(){var e=this,i=this.w,s=i.globals,c=this.dCtx.isSparkline||!s.axisCharts?0:10;["title","subtitle"].forEach(function(r){i.config[r].text!==void 0?c+=i.config[r].margin:c+=e.dCtx.isSparkline||!s.axisCharts?0:5}),!i.config.legend.show||i.config.legend.position!=="bottom"||i.config.legend.floating||s.axisCharts||(c+=10);var d=this.dCtx.dimHelpers.getTitleSubtitleCoords("title"),A=this.dCtx.dimHelpers.getTitleSubtitleCoords("subtitle");s.gridHeight-=d.height+A.height+c,s.translateY+=d.height+A.height+c}},{key:"setGridXPosForDualYAxis",value:function(e,i){var s=this.w,c=new Bp(this.dCtx.ctx);s.config.yaxis.forEach(function(d,A){s.globals.ignoreYAxisIndexes.indexOf(A)!==-1||d.floating||c.isYAxisHidden(A)||(d.opposite&&(s.globals.translateX-=i[A].width+e[A].width+parseInt(d.labels.style.fontSize,10)/1.2+12),s.globals.translateX<2&&(s.globals.translateX=2))})}}]),a}(),zv=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.lgRect={},this.yAxisWidth=0,this.yAxisWidthLeft=0,this.yAxisWidthRight=0,this.xAxisHeight=0,this.isSparkline=this.w.config.chart.sparkline.enabled,this.dimHelpers=new YR(this),this.dimYAxis=new qR(this),this.dimXAxis=new KR(this),this.dimGrid=new $R(this),this.lgWidthForSideLegends=0,this.gridPad=this.w.config.grid.padding,this.xPadRight=0,this.xPadLeft=0}return tn(a,[{key:"plotCoords",value:function(){var e=this,i=this.w,s=i.globals;this.lgRect=this.dimHelpers.getLegendsRect(),this.datalabelsCoords={width:0,height:0};var c=Array.isArray(i.config.stroke.width)?Math.max.apply(Math,Kl(i.config.stroke.width)):i.config.stroke.width;this.isSparkline&&((i.config.markers.discrete.length>0||i.config.markers.size>0)&&Object.entries(this.gridPad).forEach(function(A){var r=hT(A,2),y=r[0],b=r[1];e.gridPad[y]=Math.max(b,e.w.globals.markers.largestSize/1.5)}),this.gridPad.top=Math.max(c/2,this.gridPad.top),this.gridPad.bottom=Math.max(c/2,this.gridPad.bottom)),s.axisCharts?this.setDimensionsForAxisCharts():this.setDimensionsForNonAxisCharts(),this.dimGrid.gridPadFortitleSubtitle(),s.gridHeight=s.gridHeight-this.gridPad.top-this.gridPad.bottom,s.gridWidth=s.gridWidth-this.gridPad.left-this.gridPad.right-this.xPadRight-this.xPadLeft;var d=this.dimGrid.gridPadForColumnsInNumericAxis(s.gridWidth);s.gridWidth=s.gridWidth-2*d,s.translateX=s.translateX+this.gridPad.left+this.xPadLeft+(d>0?d:0),s.translateY=s.translateY+this.gridPad.top}},{key:"setDimensionsForAxisCharts",value:function(){var e=this,i=this.w,s=i.globals,c=this.dimYAxis.getyAxisLabelsCoords(),d=this.dimYAxis.getyAxisTitleCoords();s.isSlopeChart&&(this.datalabelsCoords=this.dimHelpers.getDatalabelsRect()),i.globals.yLabelsCoords=[],i.globals.yTitleCoords=[],i.config.yaxis.map(function(E,R){i.globals.yLabelsCoords.push({width:c[R].width,index:R}),i.globals.yTitleCoords.push({width:d[R].width,index:R})}),this.yAxisWidth=this.dimYAxis.getTotalYAxisWidth();var A=this.dimXAxis.getxAxisLabelsCoords(),r=this.dimXAxis.getxAxisGroupLabelsCoords(),y=this.dimXAxis.getxAxisTitleCoords();this.conditionalChecksForAxisCoords(A,y,r),s.translateXAxisY=i.globals.rotateXLabels?this.xAxisHeight/8:-4,s.translateXAxisX=i.globals.rotateXLabels&&i.globals.isXNumeric&&i.config.xaxis.labels.rotate<=-45?-this.xAxisWidth/4:0,i.globals.isBarHorizontal&&(s.rotateXLabels=!1,s.translateXAxisY=parseInt(i.config.xaxis.labels.style.fontSize,10)/1.5*-1),s.translateXAxisY=s.translateXAxisY+i.config.xaxis.labels.offsetY,s.translateXAxisX=s.translateXAxisX+i.config.xaxis.labels.offsetX;var b=this.yAxisWidth,x=this.xAxisHeight;s.xAxisLabelsHeight=this.xAxisHeight-y.height,s.xAxisGroupLabelsHeight=s.xAxisLabelsHeight-A.height,s.xAxisLabelsWidth=this.xAxisWidth,s.xAxisHeight=this.xAxisHeight;var B=10;(i.config.chart.type==="radar"||this.isSparkline)&&(b=0,x=0),this.isSparkline&&(this.lgRect={height:0,width:0}),(this.isSparkline||i.config.chart.type==="treemap")&&(b=0,x=0,B=0),this.isSparkline||i.config.chart.type==="treemap"||this.dimXAxis.additionalPaddingXLabels(A);var T=function(){s.translateX=b+e.datalabelsCoords.width,s.gridHeight=s.svgHeight-e.lgRect.height-x-(e.isSparkline||i.config.chart.type==="treemap"?0:i.globals.rotateXLabels?10:15),s.gridWidth=s.svgWidth-b-2*e.datalabelsCoords.width};switch(i.config.xaxis.position==="top"&&(B=s.xAxisHeight-i.config.xaxis.axisTicks.height-5),i.config.legend.position){case"bottom":s.translateY=B,T();break;case"top":s.translateY=this.lgRect.height+B,T();break;case"left":s.translateY=B,s.translateX=this.lgRect.width+b+this.datalabelsCoords.width,s.gridHeight=s.svgHeight-x-12,s.gridWidth=s.svgWidth-this.lgRect.width-b-2*this.datalabelsCoords.width;break;case"right":s.translateY=B,s.translateX=b+this.datalabelsCoords.width,s.gridHeight=s.svgHeight-x-12,s.gridWidth=s.svgWidth-this.lgRect.width-b-2*this.datalabelsCoords.width-5;break;default:throw new Error("Legend position not supported")}this.dimGrid.setGridXPosForDualYAxis(d,c),new ew(this.ctx).setYAxisXPosition(c,d)}},{key:"setDimensionsForNonAxisCharts",value:function(){var e=this.w,i=e.globals,s=e.config,c=0;e.config.legend.show&&!e.config.legend.floating&&(c=20);var d=s.chart.type==="pie"||s.chart.type==="polarArea"||s.chart.type==="donut"?"pie":"radialBar",A=s.plotOptions[d].offsetY,r=s.plotOptions[d].offsetX;if(!s.legend.show||s.legend.floating){i.gridHeight=i.svgHeight;var y=i.dom.elWrap.getBoundingClientRect().width;return i.gridWidth=Math.min(y,i.gridHeight),i.translateY=A,void(i.translateX=r+(i.svgWidth-i.gridWidth)/2)}switch(s.legend.position){case"bottom":i.gridHeight=i.svgHeight-this.lgRect.height,i.gridWidth=i.svgWidth,i.translateY=A-10,i.translateX=r+(i.svgWidth-i.gridWidth)/2;break;case"top":i.gridHeight=i.svgHeight-this.lgRect.height,i.gridWidth=i.svgWidth,i.translateY=this.lgRect.height+A+10,i.translateX=r+(i.svgWidth-i.gridWidth)/2;break;case"left":i.gridWidth=i.svgWidth-this.lgRect.width-c,i.gridHeight=s.chart.height!=="auto"?i.svgHeight:i.gridWidth,i.translateY=A,i.translateX=r+this.lgRect.width+c;break;case"right":i.gridWidth=i.svgWidth-this.lgRect.width-c-5,i.gridHeight=s.chart.height!=="auto"?i.svgHeight:i.gridWidth,i.translateY=A,i.translateX=r+10;break;default:throw new Error("Legend position not supported")}}},{key:"conditionalChecksForAxisCoords",value:function(e,i,s){var c=this.w,d=c.globals.hasXaxisGroups?2:1,A=s.height+e.height+i.height,r=c.globals.isMultiLineX?1.2:c.globals.LINE_HEIGHT_RATIO,y=c.globals.rotateXLabels?22:10,b=c.globals.rotateXLabels&&c.config.legend.position==="bottom"?10:0;this.xAxisHeight=A*r+d*y+b,this.xAxisWidth=e.width,this.xAxisHeight-i.height>c.config.xaxis.labels.maxHeight&&(this.xAxisHeight=c.config.xaxis.labels.maxHeight),c.config.xaxis.labels.minHeight&&this.xAxisHeight<c.config.xaxis.labels.minHeight&&(this.xAxisHeight=c.config.xaxis.labels.minHeight),c.config.xaxis.floating&&(this.xAxisHeight=0);var x=0,B=0;c.config.yaxis.forEach(function(T){x+=T.labels.minWidth,B+=T.labels.maxWidth}),this.yAxisWidth<x&&(this.yAxisWidth=x),this.yAxisWidth>B&&(this.yAxisWidth=B)}}]),a}(),ZR=function(){function a(e){en(this,a),this.w=e.w,this.lgCtx=e}return tn(a,[{key:"getLegendStyles",value:function(){var e,i,s,c=document.createElement("style");c.setAttribute("type","text/css");var d=((e=this.lgCtx.ctx)===null||e===void 0||(i=e.opts)===null||i===void 0||(s=i.chart)===null||s===void 0?void 0:s.nonce)||this.w.config.chart.nonce;d&&c.setAttribute("nonce",d);var A=document.createTextNode(`
      .apexcharts-flip-y {
        transform: scaleY(-1) translateY(-100%);
        transform-origin: top;
        transform-box: fill-box;
      }
      .apexcharts-flip-x {
        transform: scaleX(-1);
        transform-origin: center;
        transform-box: fill-box;
      }
      .apexcharts-legend {
        display: flex;
        overflow: auto;
        padding: 0 10px;
      }
      .apexcharts-legend.apexcharts-legend-group-horizontal {
        flex-direction: column;
      }
      .apexcharts-legend-group {
        display: flex;
      }
      .apexcharts-legend-group-vertical {
        flex-direction: column-reverse;
      }
      .apexcharts-legend.apx-legend-position-bottom, .apexcharts-legend.apx-legend-position-top {
        flex-wrap: wrap
      }
      .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {
        flex-direction: column;
        bottom: 0;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-left, .apexcharts-legend.apx-legend-position-top.apexcharts-align-left, .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {
        justify-content: flex-start;
        align-items: flex-start;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-center, .apexcharts-legend.apx-legend-position-top.apexcharts-align-center {
        justify-content: center;
        align-items: center;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-right, .apexcharts-legend.apx-legend-position-top.apexcharts-align-right {
        justify-content: flex-end;
        align-items: flex-end;
      }
      .apexcharts-legend-series {
        cursor: pointer;
        line-height: normal;
        display: flex;
        align-items: center;
      }
      .apexcharts-legend-text {
        position: relative;
        font-size: 14px;
      }
      .apexcharts-legend-text *, .apexcharts-legend-marker * {
        pointer-events: none;
      }
      .apexcharts-legend-marker {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-right: 1px;
      }

      .apexcharts-legend-series.apexcharts-no-click {
        cursor: auto;
      }
      .apexcharts-legend .apexcharts-hidden-zero-series, .apexcharts-legend .apexcharts-hidden-null-series {
        display: none !important;
      }
      .apexcharts-inactive-legend {
        opacity: 0.45;
      }

    `);return c.appendChild(A),c}},{key:"getLegendDimensions",value:function(){var e=this.w.globals.dom.baseEl.querySelector(".apexcharts-legend").getBoundingClientRect(),i=e.width;return{clwh:e.height,clww:i}}},{key:"appendToForeignObject",value:function(){this.w.globals.dom.elLegendForeign.appendChild(this.getLegendStyles())}},{key:"toggleDataSeries",value:function(e,i){var s=this,c=this.w;if(c.globals.axisCharts||c.config.chart.type==="radialBar"){c.globals.resized=!0;var d=null,A=null;c.globals.risingSeries=[],c.globals.axisCharts?(d=c.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(e,"']")),A=parseInt(d.getAttribute("data:realIndex"),10)):(d=c.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(e+1,"']")),A=parseInt(d.getAttribute("rel"),10)-1),i?[{cs:c.globals.collapsedSeries,csi:c.globals.collapsedSeriesIndices},{cs:c.globals.ancillaryCollapsedSeries,csi:c.globals.ancillaryCollapsedSeriesIndices}].forEach(function(x){s.riseCollapsedSeries(x.cs,x.csi,A)}):this.hideSeries({seriesEl:d,realIndex:A})}else{var r=c.globals.dom.Paper.findOne(" .apexcharts-series[rel='".concat(e+1,"'] path")),y=c.config.chart.type;if(y==="pie"||y==="polarArea"||y==="donut"){var b=c.config.plotOptions.pie.donut.labels;new ur(this.lgCtx.ctx).pathMouseDown(r,null),this.lgCtx.ctx.pie.printDataLabelsInner(r.node,b)}r.fire("click")}}},{key:"getSeriesAfterCollapsing",value:function(e){var i=e.realIndex,s=this.w,c=s.globals,d=ni.clone(s.config.series);if(c.axisCharts){var A=s.config.yaxis[c.seriesYAxisReverseMap[i]],r={index:i,data:d[i].data.slice(),type:d[i].type||s.config.chart.type};if(A&&A.show&&A.showAlways)c.ancillaryCollapsedSeriesIndices.indexOf(i)<0&&(c.ancillaryCollapsedSeries.push(r),c.ancillaryCollapsedSeriesIndices.push(i));else if(c.collapsedSeriesIndices.indexOf(i)<0){c.collapsedSeries.push(r),c.collapsedSeriesIndices.push(i);var y=c.risingSeries.indexOf(i);c.risingSeries.splice(y,1)}}else c.collapsedSeries.push({index:i,data:d[i]}),c.collapsedSeriesIndices.push(i);return c.allSeriesCollapsed=c.collapsedSeries.length+c.ancillaryCollapsedSeries.length===s.config.series.length,this._getSeriesBasedOnCollapsedState(d)}},{key:"hideSeries",value:function(e){for(var i=e.seriesEl,s=e.realIndex,c=this.w,d=this.getSeriesAfterCollapsing({realIndex:s}),A=i.childNodes,r=0;r<A.length;r++)A[r].classList.contains("apexcharts-series-markers-wrap")&&(A[r].classList.contains("apexcharts-hide")?A[r].classList.remove("apexcharts-hide"):A[r].classList.add("apexcharts-hide"));this.lgCtx.ctx.updateHelpers._updateSeries(d,c.config.chart.animations.dynamicAnimation.enabled)}},{key:"riseCollapsedSeries",value:function(e,i,s){var c=this.w,d=ni.clone(c.config.series);if(e.length>0){for(var A=0;A<e.length;A++)e[A].index===s&&(c.globals.axisCharts?d[s].data=e[A].data.slice():d[s]=e[A].data,typeof d[s]!="number"&&(d[s].hidden=!1),e.splice(A,1),i.splice(A,1),c.globals.risingSeries.push(s));d=this._getSeriesBasedOnCollapsedState(d),this.lgCtx.ctx.updateHelpers._updateSeries(d,c.config.chart.animations.dynamicAnimation.enabled)}}},{key:"_getSeriesBasedOnCollapsedState",value:function(e){var i=this.w,s=0;return i.globals.axisCharts?e.forEach(function(c,d){i.globals.collapsedSeriesIndices.indexOf(d)<0&&i.globals.ancillaryCollapsedSeriesIndices.indexOf(d)<0||(e[d].data=[],s++)}):e.forEach(function(c,d){!i.globals.collapsedSeriesIndices.indexOf(d)<0&&(e[d]=0,s++)}),i.globals.allSeriesCollapsed=s===e.length,e}}]),a}(),XT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.onLegendClick=this.onLegendClick.bind(this),this.onLegendHovered=this.onLegendHovered.bind(this),this.isBarsDistributed=this.w.config.chart.type==="bar"&&this.w.config.plotOptions.bar.distributed&&this.w.config.series.length===1,this.legendHelpers=new ZR(this)}return tn(a,[{key:"init",value:function(){var e=this.w,i=e.globals,s=e.config,c=s.legend.showForSingleSeries&&i.series.length===1||this.isBarsDistributed||i.series.length>1;if(this.legendHelpers.appendToForeignObject(),(c||!i.axisCharts)&&s.legend.show){for(;i.dom.elLegendWrap.firstChild;)i.dom.elLegendWrap.removeChild(i.dom.elLegendWrap.firstChild);this.drawLegends(),s.legend.position==="bottom"||s.legend.position==="top"?this.legendAlignHorizontal():s.legend.position!=="right"&&s.legend.position!=="left"||this.legendAlignVertical()}}},{key:"createLegendMarker",value:function(e){var i=e.i,s=e.fillcolor,c=this.w,d=document.createElement("span");d.classList.add("apexcharts-legend-marker");var A=c.config.legend.markers.shape||c.config.markers.shape,r=A;Array.isArray(A)&&(r=A[i]);var y=Array.isArray(c.config.legend.markers.size)?parseFloat(c.config.legend.markers.size[i]):parseFloat(c.config.legend.markers.size),b=Array.isArray(c.config.legend.markers.offsetX)?parseFloat(c.config.legend.markers.offsetX[i]):parseFloat(c.config.legend.markers.offsetX),x=Array.isArray(c.config.legend.markers.offsetY)?parseFloat(c.config.legend.markers.offsetY[i]):parseFloat(c.config.legend.markers.offsetY),B=Array.isArray(c.config.legend.markers.strokeWidth)?parseFloat(c.config.legend.markers.strokeWidth[i]):parseFloat(c.config.legend.markers.strokeWidth),T=d.style;if(T.height=2*(y+B)+"px",T.width=2*(y+B)+"px",T.left=b+"px",T.top=x+"px",c.config.legend.markers.customHTML)T.background="transparent",T.color=s[i],Array.isArray(c.config.legend.markers.customHTML)?c.config.legend.markers.customHTML[i]&&(d.innerHTML=c.config.legend.markers.customHTML[i]()):d.innerHTML=c.config.legend.markers.customHTML();else{var E=new Am(this.ctx).getMarkerConfig({cssClass:"apexcharts-legend-marker apexcharts-marker apexcharts-marker-".concat(r),seriesIndex:i,strokeWidth:B,size:y}),R=window.SVG().addTo(d).size("100%","100%"),P=new ur(this.ctx).drawMarker(0,0,Tr(Tr({},E),{},{pointFillColor:Array.isArray(s)?s[i]:E.pointFillColor,shape:r}));c.globals.dom.Paper.find(".apexcharts-legend-marker.apexcharts-marker").forEach(function(G){G.node.classList.contains("apexcharts-marker-triangle")?G.node.style.transform="translate(50%, 45%)":G.node.style.transform="translate(50%, 50%)"}),R.add(P)}return d}},{key:"drawLegends",value:function(){var e=this,i=this,s=this.w,c=s.config.legend.fontFamily,d=s.globals.seriesNames,A=s.config.legend.markers.fillColors?s.config.legend.markers.fillColors.slice():s.globals.colors.slice();if(s.config.chart.type==="heatmap"){var r=s.config.plotOptions.heatmap.colorScale.ranges;d=r.map(function(E){return E.name?E.name:E.from+" - "+E.to}),A=r.map(function(E){return E.color})}else this.isBarsDistributed&&(d=s.globals.labels.slice());s.config.legend.customLegendItems.length&&(d=s.config.legend.customLegendItems);var y=s.globals.legendFormatter,b=s.config.legend.inverseOrder,x=[];s.globals.seriesGroups.length>1&&s.config.legend.clusterGroupedSeries&&s.globals.seriesGroups.forEach(function(E,R){x[R]=document.createElement("div"),x[R].classList.add("apexcharts-legend-group","apexcharts-legend-group-".concat(R)),s.config.legend.clusterGroupedSeriesOrientation==="horizontal"?s.globals.dom.elLegendWrap.classList.add("apexcharts-legend-group-horizontal"):x[R].classList.add("apexcharts-legend-group-vertical")});for(var B=function(E){var R,P=y(d[E],{seriesIndex:E,w:s}),G=!1,U=!1;if(s.globals.collapsedSeries.length>0)for(var Q=0;Q<s.globals.collapsedSeries.length;Q++)s.globals.collapsedSeries[Q].index===E&&(G=!0);if(s.globals.ancillaryCollapsedSeriesIndices.length>0)for(var q=0;q<s.globals.ancillaryCollapsedSeriesIndices.length;q++)s.globals.ancillaryCollapsedSeriesIndices[q]===E&&(U=!0);var ne=e.createLegendMarker({i:E,fillcolor:A});ur.setAttrs(ne,{rel:E+1,"data:collapsed":G||U}),(G||U)&&ne.classList.add("apexcharts-inactive-legend");var re=document.createElement("div"),pe=document.createElement("span");pe.classList.add("apexcharts-legend-text"),pe.innerHTML=Array.isArray(P)?P.join(" "):P;var fe=s.config.legend.labels.useSeriesColors?s.globals.colors[E]:Array.isArray(s.config.legend.labels.colors)?(R=s.config.legend.labels.colors)===null||R===void 0?void 0:R[E]:s.config.legend.labels.colors;fe||(fe=s.config.chart.foreColor),pe.style.color=fe,pe.style.fontSize=parseFloat(s.config.legend.fontSize)+"px",pe.style.fontWeight=s.config.legend.fontWeight,pe.style.fontFamily=c||s.config.chart.fontFamily,ur.setAttrs(pe,{rel:E+1,i:E,"data:default-text":encodeURIComponent(P),"data:collapsed":G||U}),re.appendChild(ne),re.appendChild(pe);var he=new nl(e.ctx);s.config.legend.showForZeroSeries||he.getSeriesTotalByIndex(E)===0&&he.seriesHaveSameValues(E)&&!he.isSeriesNull(E)&&s.globals.collapsedSeriesIndices.indexOf(E)===-1&&s.globals.ancillaryCollapsedSeriesIndices.indexOf(E)===-1&&re.classList.add("apexcharts-hidden-zero-series"),s.config.legend.showForNullSeries||he.isSeriesNull(E)&&s.globals.collapsedSeriesIndices.indexOf(E)===-1&&s.globals.ancillaryCollapsedSeriesIndices.indexOf(E)===-1&&re.classList.add("apexcharts-hidden-null-series"),x.length?s.globals.seriesGroups.forEach(function(be,Se){var oe;be.includes((oe=s.config.series[E])===null||oe===void 0?void 0:oe.name)&&(s.globals.dom.elLegendWrap.appendChild(x[Se]),x[Se].appendChild(re))}):s.globals.dom.elLegendWrap.appendChild(re),s.globals.dom.elLegendWrap.classList.add("apexcharts-align-".concat(s.config.legend.horizontalAlign)),s.globals.dom.elLegendWrap.classList.add("apx-legend-position-"+s.config.legend.position),re.classList.add("apexcharts-legend-series"),re.style.margin="".concat(s.config.legend.itemMargin.vertical,"px ").concat(s.config.legend.itemMargin.horizontal,"px"),s.globals.dom.elLegendWrap.style.width=s.config.legend.width?s.config.legend.width+"px":"",s.globals.dom.elLegendWrap.style.height=s.config.legend.height?s.config.legend.height+"px":"",ur.setAttrs(re,{rel:E+1,seriesName:ni.escapeString(d[E]),"data:collapsed":G||U}),(G||U)&&re.classList.add("apexcharts-inactive-legend"),s.config.legend.onItemClick.toggleDataSeries||re.classList.add("apexcharts-no-click")},T=b?d.length-1:0;b?T>=0:T<=d.length-1;b?T--:T++)B(T);s.globals.dom.elWrap.addEventListener("click",i.onLegendClick,!0),s.config.legend.onItemHover.highlightDataSeries&&s.config.legend.customLegendItems.length===0&&(s.globals.dom.elWrap.addEventListener("mousemove",i.onLegendHovered,!0),s.globals.dom.elWrap.addEventListener("mouseout",i.onLegendHovered,!0))}},{key:"setLegendWrapXY",value:function(e,i){var s=this.w,c=s.globals.dom.elLegendWrap,d=c.clientHeight,A=0,r=0;if(s.config.legend.position==="bottom")r=s.globals.svgHeight-Math.min(d,s.globals.svgHeight/2)-5;else if(s.config.legend.position==="top"){var y=new zv(this.ctx),b=y.dimHelpers.getTitleSubtitleCoords("title").height,x=y.dimHelpers.getTitleSubtitleCoords("subtitle").height;r=(b>0?b-10:0)+(x>0?x-10:0)}c.style.position="absolute",A=A+e+s.config.legend.offsetX,r=r+i+s.config.legend.offsetY,c.style.left=A+"px",c.style.top=r+"px",s.config.legend.position==="right"&&(c.style.left="auto",c.style.right=25+s.config.legend.offsetX+"px"),["width","height"].forEach(function(B){c.style[B]&&(c.style[B]=parseInt(s.config.legend[B],10)+"px")})}},{key:"legendAlignHorizontal",value:function(){var e=this.w;e.globals.dom.elLegendWrap.style.right=0;var i=new zv(this.ctx),s=i.dimHelpers.getTitleSubtitleCoords("title"),c=i.dimHelpers.getTitleSubtitleCoords("subtitle"),d=0;e.config.legend.position==="top"&&(d=s.height+c.height+e.config.title.margin+e.config.subtitle.margin-10),this.setLegendWrapXY(20,d)}},{key:"legendAlignVertical",value:function(){var e=this.w,i=this.legendHelpers.getLegendDimensions(),s=0;e.config.legend.position==="left"&&(s=20),e.config.legend.position==="right"&&(s=e.globals.svgWidth-i.clww-10),this.setLegendWrapXY(s,20)}},{key:"onLegendHovered",value:function(e){var i=this.w,s=e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker");if(i.config.chart.type==="heatmap"||this.isBarsDistributed){if(s){var c=parseInt(e.target.getAttribute("rel"),10)-1;this.ctx.events.fireEvent("legendHover",[this.ctx,c,this.w]),new od(this.ctx).highlightRangeInSeries(e,e.target)}}else!e.target.classList.contains("apexcharts-inactive-legend")&&s&&new od(this.ctx).toggleSeriesOnHover(e,e.target)}},{key:"onLegendClick",value:function(e){var i=this.w;if(!i.config.legend.customLegendItems.length&&(e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker"))){var s=parseInt(e.target.getAttribute("rel"),10)-1,c=e.target.getAttribute("data:collapsed")==="true",d=this.w.config.chart.events.legendClick;typeof d=="function"&&d(this.ctx,s,this.w),this.ctx.events.fireEvent("legendClick",[this.ctx,s,this.w]);var A=this.w.config.legend.markers.onClick;typeof A=="function"&&e.target.classList.contains("apexcharts-legend-marker")&&(A(this.ctx,s,this.w),this.ctx.events.fireEvent("legendMarkerClick",[this.ctx,s,this.w])),i.config.chart.type!=="treemap"&&i.config.chart.type!=="heatmap"&&!this.isBarsDistributed&&i.config.legend.onItemClick.toggleDataSeries&&this.legendHelpers.toggleDataSeries(s,c)}}}]),a}(),YT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var i=this.w;this.ev=this.w.config.chart.events,this.selectedClass="apexcharts-selected",this.localeValues=this.w.globals.locale.toolbar,this.minX=i.globals.minX,this.maxX=i.globals.maxX}return tn(a,[{key:"createToolbar",value:function(){var e=this,i=this.w,s=function(){return document.createElement("div")},c=s();if(c.setAttribute("class","apexcharts-toolbar"),c.style.top=i.config.chart.toolbar.offsetY+"px",c.style.right=3-i.config.chart.toolbar.offsetX+"px",i.globals.dom.elWrap.appendChild(c),this.elZoom=s(),this.elZoomIn=s(),this.elZoomOut=s(),this.elPan=s(),this.elSelection=s(),this.elZoomReset=s(),this.elMenuIcon=s(),this.elMenu=s(),this.elCustomIcons=[],this.t=i.config.chart.toolbar.tools,Array.isArray(this.t.customIcons))for(var d=0;d<this.t.customIcons.length;d++)this.elCustomIcons.push(s());var A=[],r=function(B,T,E){var R=B.toLowerCase();e.t[R]&&i.config.chart.zoom.enabled&&A.push({el:T,icon:typeof e.t[R]=="string"?e.t[R]:E,title:e.localeValues[B],class:"apexcharts-".concat(R,"-icon")})};r("zoomIn",this.elZoomIn,`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
</svg>
`),r("zoomOut",this.elZoomOut,`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
</svg>
`);var y=function(B){e.t[B]&&i.config.chart[B].enabled&&A.push({el:B==="zoom"?e.elZoom:e.elSelection,icon:typeof e.t[B]=="string"?e.t[B]:B==="zoom"?`<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="24" viewBox="0 0 24 24" width="24">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>
</svg>`:`<svg fill="#6E8192" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/>
</svg>`,title:e.localeValues[B==="zoom"?"selectionZoom":"selection"],class:i.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-".concat(B,"-icon")})};y("zoom"),y("selection"),this.t.pan&&i.config.chart.zoom.enabled&&A.push({el:this.elPan,icon:typeof this.t.pan=="string"?this.t.pan:`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="24" viewBox="0 0 24 24" width="24">
    <defs>
        <path d="M0 0h24v24H0z" id="a"/>
    </defs>
    <clipPath id="b">
        <use overflow="visible" xlink:href="#a"/>
    </clipPath>
    <path clip-path="url(#b)" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/>
</svg>`,title:this.localeValues.pan,class:i.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-pan-icon"}),r("reset",this.elZoomReset,`<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`),this.t.download&&A.push({el:this.elMenuIcon,icon:typeof this.t.download=="string"?this.t.download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>',title:this.localeValues.menu,class:"apexcharts-menu-icon"});for(var b=0;b<this.elCustomIcons.length;b++)A.push({el:this.elCustomIcons[b],icon:this.t.customIcons[b].icon,title:this.t.customIcons[b].title,index:this.t.customIcons[b].index,class:"apexcharts-toolbar-custom-icon "+this.t.customIcons[b].class});A.forEach(function(B,T){B.index&&ni.moveIndexInArray(A,T,B.index)});for(var x=0;x<A.length;x++)ur.setAttrs(A[x].el,{class:A[x].class,title:A[x].title}),A[x].el.innerHTML=A[x].icon,c.appendChild(A[x].el);this._createHamburgerMenu(c),i.globals.zoomEnabled?this.elZoom.classList.add(this.selectedClass):i.globals.panEnabled?this.elPan.classList.add(this.selectedClass):i.globals.selectionEnabled&&this.elSelection.classList.add(this.selectedClass),this.addToolbarEventListeners()}},{key:"_createHamburgerMenu",value:function(e){this.elMenuItems=[],e.appendChild(this.elMenu),ur.setAttrs(this.elMenu,{class:"apexcharts-menu"});for(var i=[{name:"exportSVG",title:this.localeValues.exportToSVG},{name:"exportPNG",title:this.localeValues.exportToPNG},{name:"exportCSV",title:this.localeValues.exportToCSV}],s=0;s<i.length;s++)this.elMenuItems.push(document.createElement("div")),this.elMenuItems[s].innerHTML=i[s].title,ur.setAttrs(this.elMenuItems[s],{class:"apexcharts-menu-item ".concat(i[s].name),title:i[s].title}),this.elMenu.appendChild(this.elMenuItems[s])}},{key:"addToolbarEventListeners",value:function(){var e=this;this.elZoomReset.addEventListener("click",this.handleZoomReset.bind(this)),this.elSelection.addEventListener("click",this.toggleZoomSelection.bind(this,"selection")),this.elZoom.addEventListener("click",this.toggleZoomSelection.bind(this,"zoom")),this.elZoomIn.addEventListener("click",this.handleZoomIn.bind(this)),this.elZoomOut.addEventListener("click",this.handleZoomOut.bind(this)),this.elPan.addEventListener("click",this.togglePanning.bind(this)),this.elMenuIcon.addEventListener("click",this.toggleMenu.bind(this)),this.elMenuItems.forEach(function(s){s.classList.contains("exportSVG")?s.addEventListener("click",e.handleDownload.bind(e,"svg")):s.classList.contains("exportPNG")?s.addEventListener("click",e.handleDownload.bind(e,"png")):s.classList.contains("exportCSV")&&s.addEventListener("click",e.handleDownload.bind(e,"csv"))});for(var i=0;i<this.t.customIcons.length;i++)this.elCustomIcons[i].addEventListener("click",this.t.customIcons[i].click.bind(this,this.ctx,this.ctx.w))}},{key:"toggleZoomSelection",value:function(e){this.ctx.getSyncedCharts().forEach(function(i){i.ctx.toolbar.toggleOtherControls();var s=e==="selection"?i.ctx.toolbar.elSelection:i.ctx.toolbar.elZoom,c=e==="selection"?"selectionEnabled":"zoomEnabled";i.w.globals[c]=!i.w.globals[c],s.classList.contains(i.ctx.toolbar.selectedClass)?s.classList.remove(i.ctx.toolbar.selectedClass):s.classList.add(i.ctx.toolbar.selectedClass)})}},{key:"getToolbarIconsReference",value:function(){var e=this.w;this.elZoom||(this.elZoom=e.globals.dom.baseEl.querySelector(".apexcharts-zoom-icon")),this.elPan||(this.elPan=e.globals.dom.baseEl.querySelector(".apexcharts-pan-icon")),this.elSelection||(this.elSelection=e.globals.dom.baseEl.querySelector(".apexcharts-selection-icon"))}},{key:"enableZoomPanFromToolbar",value:function(e){this.toggleOtherControls(),e==="pan"?this.w.globals.panEnabled=!0:this.w.globals.zoomEnabled=!0;var i=e==="pan"?this.elPan:this.elZoom,s=e==="pan"?this.elZoom:this.elPan;i&&i.classList.add(this.selectedClass),s&&s.classList.remove(this.selectedClass)}},{key:"togglePanning",value:function(){this.ctx.getSyncedCharts().forEach(function(e){e.ctx.toolbar.toggleOtherControls(),e.w.globals.panEnabled=!e.w.globals.panEnabled,e.ctx.toolbar.elPan.classList.contains(e.ctx.toolbar.selectedClass)?e.ctx.toolbar.elPan.classList.remove(e.ctx.toolbar.selectedClass):e.ctx.toolbar.elPan.classList.add(e.ctx.toolbar.selectedClass)})}},{key:"toggleOtherControls",value:function(){var e=this,i=this.w;i.globals.panEnabled=!1,i.globals.zoomEnabled=!1,i.globals.selectionEnabled=!1,this.getToolbarIconsReference(),[this.elPan,this.elSelection,this.elZoom].forEach(function(s){s&&s.classList.remove(e.selectedClass)})}},{key:"handleZoomIn",value:function(){var e=this.w;e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY);var i=(this.minX+this.maxX)/2,s=(this.minX+i)/2,c=(this.maxX+i)/2,d=this._getNewMinXMaxX(s,c);e.globals.disableZoomIn||this.zoomUpdateOptions(d.minX,d.maxX)}},{key:"handleZoomOut",value:function(){var e=this.w;if(e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY),!(e.config.xaxis.type==="datetime"&&new Date(this.minX).getUTCFullYear()<1e3)){var i=(this.minX+this.maxX)/2,s=this.minX-(i-this.minX),c=this.maxX-(i-this.maxX),d=this._getNewMinXMaxX(s,c);e.globals.disableZoomOut||this.zoomUpdateOptions(d.minX,d.maxX)}}},{key:"_getNewMinXMaxX",value:function(e,i){var s=this.w.config.xaxis.convertedCatToNumeric;return{minX:s?Math.floor(e):e,maxX:s?Math.floor(i):i}}},{key:"zoomUpdateOptions",value:function(e,i){var s=this.w;if(e!==void 0||i!==void 0){if(!(s.config.xaxis.convertedCatToNumeric&&(e<1&&(e=1,i=s.globals.dataPoints),i-e<2))){var c={min:e,max:i},d=this.getBeforeZoomRange(c);d&&(c=d.xaxis);var A={xaxis:c},r=ni.clone(s.globals.initialConfig.yaxis);s.config.chart.group||(A.yaxis=r),this.w.globals.zoomed=!0,this.ctx.updateHelpers._updateOptions(A,!1,this.w.config.chart.animations.dynamicAnimation.enabled),this.zoomCallback(c,r)}}else this.handleZoomReset()}},{key:"zoomCallback",value:function(e,i){typeof this.ev.zoomed=="function"&&(this.ev.zoomed(this.ctx,{xaxis:e,yaxis:i}),this.ctx.events.fireEvent("zoomed",{xaxis:e,yaxis:i}))}},{key:"getBeforeZoomRange",value:function(e,i){var s=null;return typeof this.ev.beforeZoom=="function"&&(s=this.ev.beforeZoom(this,{xaxis:e,yaxis:i})),s}},{key:"toggleMenu",value:function(){var e=this;window.setTimeout(function(){e.elMenu.classList.contains("apexcharts-menu-open")?e.elMenu.classList.remove("apexcharts-menu-open"):e.elMenu.classList.add("apexcharts-menu-open")},0)}},{key:"handleDownload",value:function(e){var i=this.w,s=new vy(this.ctx);switch(e){case"svg":s.exportToSVG(this.ctx);break;case"png":s.exportToPng(this.ctx);break;case"csv":s.exportToCSV({series:i.config.series,columnDelimiter:i.config.chart.toolbar.export.csv.columnDelimiter})}}},{key:"handleZoomReset",value:function(e){this.ctx.getSyncedCharts().forEach(function(i){var s=i.w;if(s.globals.lastXAxis.min=s.globals.initialConfig.xaxis.min,s.globals.lastXAxis.max=s.globals.initialConfig.xaxis.max,i.updateHelpers.revertDefaultAxisMinMax(),typeof s.config.chart.events.beforeResetZoom=="function"){var c=s.config.chart.events.beforeResetZoom(i,s);c&&i.updateHelpers.revertDefaultAxisMinMax(c)}typeof s.config.chart.events.zoomed=="function"&&i.ctx.toolbar.zoomCallback({min:s.config.xaxis.min,max:s.config.xaxis.max}),s.globals.zoomed=!1;var d=i.ctx.series.emptyCollapsedSeries(ni.clone(s.globals.initialSeries));i.updateHelpers._updateSeries(d,s.config.chart.animations.dynamicAnimation.enabled)})}},{key:"destroy",value:function(){this.elZoom=null,this.elZoomIn=null,this.elZoomOut=null,this.elPan=null,this.elSelection=null,this.elZoomReset=null,this.elMenuIcon=null}}]),a}(),JR=function(a){Yy(i,YT);var e=Xy(i);function i(s){var c;return en(this,i),(c=e.call(this,s)).ctx=s,c.w=s.w,c.dragged=!1,c.graphics=new ur(c.ctx),c.eventList=["mousedown","mouseleave","mousemove","touchstart","touchmove","mouseup","touchend","wheel"],c.clientX=0,c.clientY=0,c.startX=0,c.endX=0,c.dragX=0,c.startY=0,c.endY=0,c.dragY=0,c.moveDirection="none",c.debounceTimer=null,c.debounceDelay=100,c.wheelDelay=400,c}return tn(i,[{key:"init",value:function(s){var c=this,d=s.xyRatios,A=this.w,r=this;this.xyRatios=d,this.zoomRect=this.graphics.drawRect(0,0,0,0),this.selectionRect=this.graphics.drawRect(0,0,0,0),this.gridRect=A.globals.dom.baseEl.querySelector(".apexcharts-grid"),this.constraints=new Ac(0,0,A.globals.gridWidth,A.globals.gridHeight),this.zoomRect.node.classList.add("apexcharts-zoom-rect"),this.selectionRect.node.classList.add("apexcharts-selection-rect"),A.globals.dom.Paper.add(this.zoomRect),A.globals.dom.Paper.add(this.selectionRect),A.config.chart.selection.type==="x"?this.slDraggableRect=this.selectionRect.draggable({minX:0,minY:0,maxX:A.globals.gridWidth,maxY:A.globals.gridHeight}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):A.config.chart.selection.type==="y"?this.slDraggableRect=this.selectionRect.draggable({minX:0,maxX:A.globals.gridWidth}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):this.slDraggableRect=this.selectionRect.draggable().on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")),this.preselectedSelection(),this.hoverArea=A.globals.dom.baseEl.querySelector("".concat(A.globals.chartClass," .apexcharts-svg")),this.hoverArea.classList.add("apexcharts-zoomable"),this.eventList.forEach(function(y){c.hoverArea.addEventListener(y,r.svgMouseEvents.bind(r,d),{capture:!1,passive:!0})}),A.config.chart.zoom.enabled&&A.config.chart.zoom.allowMouseWheelZoom&&this.hoverArea.addEventListener("wheel",r.mouseWheelEvent.bind(r),{capture:!1,passive:!1})}},{key:"destroy",value:function(){this.slDraggableRect&&(this.slDraggableRect.draggable(!1),this.slDraggableRect.off(),this.selectionRect.off()),this.selectionRect=null,this.zoomRect=null,this.gridRect=null}},{key:"svgMouseEvents",value:function(s,c){var d=this.w,A=this.ctx.toolbar,r=d.globals.zoomEnabled?d.config.chart.zoom.type:d.config.chart.selection.type,y=d.config.chart.toolbar.autoSelected;if(c.shiftKey?(this.shiftWasPressed=!0,A.enableZoomPanFromToolbar(y==="pan"?"zoom":"pan")):this.shiftWasPressed&&(A.enableZoomPanFromToolbar(y),this.shiftWasPressed=!1),c.target){var b,x=c.target.classList;if(c.target.parentNode&&c.target.parentNode!==null&&(b=c.target.parentNode.classList),!(x.contains("apexcharts-legend-marker")||x.contains("apexcharts-legend-text")||b&&b.contains("apexcharts-toolbar"))){if(this.clientX=c.type==="touchmove"||c.type==="touchstart"?c.touches[0].clientX:c.type==="touchend"?c.changedTouches[0].clientX:c.clientX,this.clientY=c.type==="touchmove"||c.type==="touchstart"?c.touches[0].clientY:c.type==="touchend"?c.changedTouches[0].clientY:c.clientY,c.type==="mousedown"&&c.which===1||c.type==="touchstart"){var B=this.gridRect.getBoundingClientRect();this.startX=this.clientX-B.left-d.globals.barPadForNumericAxis,this.startY=this.clientY-B.top,this.dragged=!1,this.w.globals.mousedown=!0}(c.type==="mousemove"&&c.which===1||c.type==="touchmove")&&(this.dragged=!0,d.globals.panEnabled?(d.globals.selection=null,this.w.globals.mousedown&&this.panDragging({context:this,zoomtype:r,xyRatios:s})):(this.w.globals.mousedown&&d.globals.zoomEnabled||this.w.globals.mousedown&&d.globals.selectionEnabled)&&(this.selection=this.selectionDrawing({context:this,zoomtype:r}))),c.type!=="mouseup"&&c.type!=="touchend"&&c.type!=="mouseleave"||this.handleMouseUp({zoomtype:r}),this.makeSelectionRectDraggable()}}}},{key:"handleMouseUp",value:function(s){var c,d=s.zoomtype,A=s.isResized,r=this.w,y=(c=this.gridRect)===null||c===void 0?void 0:c.getBoundingClientRect();y&&(this.w.globals.mousedown||A)&&(this.endX=this.clientX-y.left-r.globals.barPadForNumericAxis,this.endY=this.clientY-y.top,this.dragX=Math.abs(this.endX-this.startX),this.dragY=Math.abs(this.endY-this.startY),(r.globals.zoomEnabled||r.globals.selectionEnabled)&&this.selectionDrawn({context:this,zoomtype:d})),r.globals.zoomEnabled&&this.hideSelectionRect(this.selectionRect),this.dragged=!1,this.w.globals.mousedown=!1}},{key:"mouseWheelEvent",value:function(s){var c=this,d=this.w;s.preventDefault();var A=Date.now();A-d.globals.lastWheelExecution>this.wheelDelay&&(this.executeMouseWheelZoom(s),d.globals.lastWheelExecution=A),this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){A-d.globals.lastWheelExecution>c.wheelDelay&&(c.executeMouseWheelZoom(s),d.globals.lastWheelExecution=A)},this.debounceDelay)}},{key:"executeMouseWheelZoom",value:function(s){var c,d=this.w;this.minX=d.globals.isRangeBar?d.globals.minY:d.globals.minX,this.maxX=d.globals.isRangeBar?d.globals.maxY:d.globals.maxX;var A=(c=this.gridRect)===null||c===void 0?void 0:c.getBoundingClientRect();if(A){var r,y,b,x=(s.clientX-A.left)/A.width,B=this.minX,T=this.maxX,E=T-B;if(s.deltaY<0){var R=B+x*E;y=R-(r=.5*E)/2,b=R+r/2}else y=B-(r=1.5*E)/2,b=T+r/2;if(!d.globals.isRangeBar){y=Math.max(y,d.globals.initialMinX),b=Math.min(b,d.globals.initialMaxX);var P=.01*(d.globals.initialMaxX-d.globals.initialMinX);if(b-y<P){var G=(y+b)/2;y=G-P/2,b=G+P/2}}var U=this._getNewMinXMaxX(y,b);isNaN(U.minX)||isNaN(U.maxX)||this.zoomUpdateOptions(U.minX,U.maxX)}}},{key:"makeSelectionRectDraggable",value:function(){var s=this,c=this.w;if(this.selectionRect){var d=this.selectionRect.node.getBoundingClientRect();d.width>0&&d.height>0&&(this.selectionRect.select(!1).resize(!1),this.selectionRect.select({createRot:function(){},updateRot:function(){},createHandle:function(A,r,y,b,x){return x==="l"||x==="r"?A.circle(8).css({"stroke-width":1,stroke:"#333",fill:"#fff"}):A.circle(0)},updateHandle:function(A,r){return A.center(r[0],r[1])}}).resize().on("resize",function(){var A=c.globals.zoomEnabled?c.config.chart.zoom.type:c.config.chart.selection.type;s.handleMouseUp({zoomtype:A,isResized:!0})}))}}},{key:"preselectedSelection",value:function(){var s=this.w,c=this.xyRatios;if(!s.globals.zoomEnabled){if(s.globals.selection!==void 0&&s.globals.selection!==null)this.drawSelectionRect(Tr(Tr({},s.globals.selection),{},{translateX:s.globals.translateX,translateY:s.globals.translateY}));else if(s.config.chart.selection.xaxis.min!==void 0&&s.config.chart.selection.xaxis.max!==void 0){var d=(s.config.chart.selection.xaxis.min-s.globals.minX)/c.xRatio,A=s.globals.gridWidth-(s.globals.maxX-s.config.chart.selection.xaxis.max)/c.xRatio-d;s.globals.isRangeBar&&(d=(s.config.chart.selection.xaxis.min-s.globals.yAxisScale[0].niceMin)/c.invertedYRatio,A=(s.config.chart.selection.xaxis.max-s.config.chart.selection.xaxis.min)/c.invertedYRatio);var r={x:d,y:0,width:A,height:s.globals.gridHeight,translateX:s.globals.translateX,translateY:s.globals.translateY,selectionEnabled:!0};this.drawSelectionRect(r),this.makeSelectionRectDraggable(),typeof s.config.chart.events.selection=="function"&&s.config.chart.events.selection(this.ctx,{xaxis:{min:s.config.chart.selection.xaxis.min,max:s.config.chart.selection.xaxis.max},yaxis:{}})}}}},{key:"drawSelectionRect",value:function(s){var c=s.x,d=s.y,A=s.width,r=s.height,y=s.translateX,b=y===void 0?0:y,x=s.translateY,B=x===void 0?0:x,T=this.w,E=this.zoomRect,R=this.selectionRect;if(this.dragged||T.globals.selection!==null){var P={transform:"translate("+b+", "+B+")"};T.globals.zoomEnabled&&this.dragged&&(A<0&&(A=1),E.attr({x:c,y:d,width:A,height:r,fill:T.config.chart.zoom.zoomedArea.fill.color,"fill-opacity":T.config.chart.zoom.zoomedArea.fill.opacity,stroke:T.config.chart.zoom.zoomedArea.stroke.color,"stroke-width":T.config.chart.zoom.zoomedArea.stroke.width,"stroke-opacity":T.config.chart.zoom.zoomedArea.stroke.opacity}),ur.setAttrs(E.node,P)),T.globals.selectionEnabled&&(R.attr({x:c,y:d,width:A>0?A:0,height:r>0?r:0,fill:T.config.chart.selection.fill.color,"fill-opacity":T.config.chart.selection.fill.opacity,stroke:T.config.chart.selection.stroke.color,"stroke-width":T.config.chart.selection.stroke.width,"stroke-dasharray":T.config.chart.selection.stroke.dashArray,"stroke-opacity":T.config.chart.selection.stroke.opacity}),ur.setAttrs(R.node,P))}}},{key:"hideSelectionRect",value:function(s){s&&s.attr({x:0,y:0,width:0,height:0})}},{key:"selectionDrawing",value:function(s){var c=s.context,d=s.zoomtype,A=this.w,r=c,y=this.gridRect.getBoundingClientRect(),b=r.startX-1,x=r.startY,B=!1,T=!1,E=r.clientX-y.left-A.globals.barPadForNumericAxis,R=r.clientY-y.top,P=E-b,G=R-x,U={translateX:A.globals.translateX,translateY:A.globals.translateY};return Math.abs(P+b)>A.globals.gridWidth?P=A.globals.gridWidth-b:E<0&&(P=b),b>E&&(B=!0,P=Math.abs(P)),x>R&&(T=!0,G=Math.abs(G)),U=Tr(Tr({},U=d==="x"?{x:B?b-P:b,y:0,width:P,height:A.globals.gridHeight}:d==="y"?{x:0,y:T?x-G:x,width:A.globals.gridWidth,height:G}:{x:B?b-P:b,y:T?x-G:x,width:P,height:G}),{},{translateX:A.globals.translateX,translateY:A.globals.translateY}),r.drawSelectionRect(U),r.selectionDragging("resizing"),U}},{key:"selectionDragging",value:function(s,c){var d=this,A=this.w;if(c){c.preventDefault();var r=c.detail,y=r.handler,b=r.box,x=b.x,B=b.y;x<this.constraints.x&&(x=this.constraints.x),B<this.constraints.y&&(B=this.constraints.y),b.x2>this.constraints.x2&&(x=this.constraints.x2-b.w),b.y2>this.constraints.y2&&(B=this.constraints.y2-b.h),y.move(x,B);var T=this.xyRatios,E=this.selectionRect,R=0;s==="resizing"&&(R=30);var P=function(U){return parseFloat(E.node.getAttribute(U))},G={x:P("x"),y:P("y"),width:P("width"),height:P("height")};A.globals.selection=G,typeof A.config.chart.events.selection=="function"&&A.globals.selectionEnabled&&(clearTimeout(this.w.globals.selectionResizeTimer),this.w.globals.selectionResizeTimer=window.setTimeout(function(){var U,Q,q,ne,re=d.gridRect.getBoundingClientRect(),pe=E.node.getBoundingClientRect();A.globals.isRangeBar?(U=A.globals.yAxisScale[0].niceMin+(pe.left-re.left)*T.invertedYRatio,Q=A.globals.yAxisScale[0].niceMin+(pe.right-re.left)*T.invertedYRatio,q=0,ne=1):(U=A.globals.xAxisScale.niceMin+(pe.left-re.left)*T.xRatio,Q=A.globals.xAxisScale.niceMin+(pe.right-re.left)*T.xRatio,q=A.globals.yAxisScale[0].niceMin+(re.bottom-pe.bottom)*T.yRatio[0],ne=A.globals.yAxisScale[0].niceMax-(pe.top-re.top)*T.yRatio[0]);var fe={xaxis:{min:U,max:Q},yaxis:{min:q,max:ne}};A.config.chart.events.selection(d.ctx,fe),A.config.chart.brush.enabled&&A.config.chart.events.brushScrolled!==void 0&&A.config.chart.events.brushScrolled(d.ctx,fe)},R))}}},{key:"selectionDrawn",value:function(s){var c,d,A=s.context,r=s.zoomtype,y=this.w,b=A,x=this.xyRatios,B=this.ctx.toolbar,T=y.globals.zoomEnabled?b.zoomRect.node.getBoundingClientRect():b.selectionRect.node.getBoundingClientRect(),E=b.gridRect.getBoundingClientRect(),R=T.left-E.left-y.globals.barPadForNumericAxis,P=T.right-E.left-y.globals.barPadForNumericAxis,G=T.top-E.top,U=T.bottom-E.top;y.globals.isRangeBar?(c=y.globals.yAxisScale[0].niceMin+R*x.invertedYRatio,d=y.globals.yAxisScale[0].niceMin+P*x.invertedYRatio):(c=y.globals.xAxisScale.niceMin+R*x.xRatio,d=y.globals.xAxisScale.niceMin+P*x.xRatio);var Q=[],q=[];if(y.config.yaxis.forEach(function(Se,oe){var ye=y.globals.seriesYAxisMap[oe][0],Me=y.globals.yAxisScale[oe].niceMax-x.yRatio[ye]*G,Be=y.globals.yAxisScale[oe].niceMax-x.yRatio[ye]*U;Q.push(Me),q.push(Be)}),b.dragged&&(b.dragX>10||b.dragY>10)&&c!==d){if(y.globals.zoomEnabled){var ne=ni.clone(y.globals.initialConfig.yaxis),re=ni.clone(y.globals.initialConfig.xaxis);if(y.globals.zoomed=!0,y.config.xaxis.convertedCatToNumeric&&(c=Math.floor(c),d=Math.floor(d),c<1&&(c=1,d=y.globals.dataPoints),d-c<2&&(d=c+1)),r!=="xy"&&r!=="x"||(re={min:c,max:d}),r!=="xy"&&r!=="y"||ne.forEach(function(Se,oe){ne[oe].min=q[oe],ne[oe].max=Q[oe]}),B){var pe=B.getBeforeZoomRange(re,ne);pe&&(re=pe.xaxis?pe.xaxis:re,ne=pe.yaxis?pe.yaxis:ne)}var fe={xaxis:re};y.config.chart.group||(fe.yaxis=ne),b.ctx.updateHelpers._updateOptions(fe,!1,b.w.config.chart.animations.dynamicAnimation.enabled),typeof y.config.chart.events.zoomed=="function"&&B.zoomCallback(re,ne)}else if(y.globals.selectionEnabled){var he,be=null;he={min:c,max:d},r!=="xy"&&r!=="y"||(be=ni.clone(y.config.yaxis)).forEach(function(Se,oe){be[oe].min=q[oe],be[oe].max=Q[oe]}),y.globals.selection=b.selection,typeof y.config.chart.events.selection=="function"&&y.config.chart.events.selection(b.ctx,{xaxis:he,yaxis:be})}}}},{key:"panDragging",value:function(s){var c=s.context,d=this.w,A=c;if(d.globals.lastClientPosition.x!==void 0){var r=d.globals.lastClientPosition.x-A.clientX,y=d.globals.lastClientPosition.y-A.clientY;Math.abs(r)>Math.abs(y)&&r>0?this.moveDirection="left":Math.abs(r)>Math.abs(y)&&r<0?this.moveDirection="right":Math.abs(y)>Math.abs(r)&&y>0?this.moveDirection="up":Math.abs(y)>Math.abs(r)&&y<0&&(this.moveDirection="down")}d.globals.lastClientPosition={x:A.clientX,y:A.clientY};var b=d.globals.isRangeBar?d.globals.minY:d.globals.minX,x=d.globals.isRangeBar?d.globals.maxY:d.globals.maxX;A.panScrolled(b,x)}},{key:"panScrolled",value:function(s,c){var d=this.w,A=this.xyRatios,r=ni.clone(d.globals.initialConfig.yaxis),y=A.xRatio,b=d.globals.minX,x=d.globals.maxX;d.globals.isRangeBar&&(y=A.invertedYRatio,b=d.globals.minY,x=d.globals.maxY),this.moveDirection==="left"?(s=b+d.globals.gridWidth/15*y,c=x+d.globals.gridWidth/15*y):this.moveDirection==="right"&&(s=b-d.globals.gridWidth/15*y,c=x-d.globals.gridWidth/15*y),d.globals.isRangeBar||(s<d.globals.initialMinX||c>d.globals.initialMaxX)&&(s=b,c=x);var B={xaxis:{min:s,max:c}};d.config.chart.group||(B.yaxis=r),this.updateScrolledChart(B,s,c)}},{key:"updateScrolledChart",value:function(s,c,d){var A=this.w;if(this.ctx.updateHelpers._updateOptions(s,!1,!1),typeof A.config.chart.events.scrolled=="function"){var r={xaxis:{min:c,max:d}};A.config.chart.events.scrolled(this.ctx,r),this.ctx.events.fireEvent("scrolled",r)}}}]),i}(),KT=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e,this.ctx=e.ctx}return tn(a,[{key:"getNearestValues",value:function(e){var i=e.hoverArea,s=e.elGrid,c=e.clientX,d=e.clientY,A=this.w,r=s.getBoundingClientRect(),y=r.width,b=r.height,x=y/(A.globals.dataPoints-1),B=b/A.globals.dataPoints,T=this.hasBars();!A.globals.comboCharts&&!T||A.config.xaxis.convertedCatToNumeric||(x=y/A.globals.dataPoints);var E=c-r.left-A.globals.barPadForNumericAxis,R=d-r.top;E<0||R<0||E>y||R>b?(i.classList.remove("hovering-zoom"),i.classList.remove("hovering-pan")):A.globals.zoomEnabled?(i.classList.remove("hovering-pan"),i.classList.add("hovering-zoom")):A.globals.panEnabled&&(i.classList.remove("hovering-zoom"),i.classList.add("hovering-pan"));var P=Math.round(E/x),G=Math.floor(R/B);T&&!A.config.xaxis.convertedCatToNumeric&&(P=Math.ceil(E/x),P-=1);var U=null,Q=null,q=A.globals.seriesXvalues.map(function(he){return he.filter(function(be){return ni.isNumber(be)})}),ne=A.globals.seriesYvalues.map(function(he){return he.filter(function(be){return ni.isNumber(be)})});if(A.globals.isXNumeric){var re=this.ttCtx.getElGrid().getBoundingClientRect(),pe=E*(re.width/y),fe=R*(re.height/b);U=(Q=this.closestInMultiArray(pe,fe,q,ne)).index,P=Q.j,U!==null&&A.globals.hasNullValues&&(q=A.globals.seriesXvalues[U],P=(Q=this.closestInArray(pe,q)).j)}return A.globals.capturedSeriesIndex=U===null?-1:U,(!P||P<1)&&(P=0),A.globals.isBarHorizontal?A.globals.capturedDataPointIndex=G:A.globals.capturedDataPointIndex=P,{capturedSeries:U,j:A.globals.isBarHorizontal?G:P,hoverX:E,hoverY:R}}},{key:"getFirstActiveXArray",value:function(e){for(var i=this.w,s=0,c=e.map(function(A,r){return A.length>0?r:-1}),d=0;d<c.length;d++)if(c[d]!==-1&&i.globals.collapsedSeriesIndices.indexOf(d)===-1&&i.globals.ancillaryCollapsedSeriesIndices.indexOf(d)===-1){s=c[d];break}return s}},{key:"closestInMultiArray",value:function(e,i,s,c){for(var d,A=this.w,r=1/0,y=null,b=null,x=0;x<s.length;x++)if(d=x,A.globals.collapsedSeriesIndices.indexOf(d)===-1&&A.globals.ancillaryCollapsedSeriesIndices.indexOf(d)===-1)for(var B=s[x],T=c[x],E=Math.min(B.length,T.length),R=0;R<E;R++){var P=e-B[R],G=Math.sqrt(P*P);if(!A.globals.allSeriesHasEqualX){var U=i-T[R];G=Math.sqrt(P*P+U*U)}G<r&&(r=G,y=x,b=R)}return{index:y,j:b}}},{key:"closestInArray",value:function(e,i){for(var s=i[0],c=null,d=Math.abs(e-s),A=0;A<i.length;A++){var r=Math.abs(e-i[A]);r<d&&(d=r,c=A)}return{j:c}}},{key:"isXoverlap",value:function(e){var i=[],s=this.w.globals.seriesX.filter(function(d){return d[0]!==void 0});if(s.length>0)for(var c=0;c<s.length-1;c++)s[c][e]!==void 0&&s[c+1][e]!==void 0&&s[c][e]!==s[c+1][e]&&i.push("unEqual");return i.length===0}},{key:"isInitialSeriesSameLen",value:function(){for(var e=!0,i=this.w.globals.initialSeries,s=0;s<i.length-1;s++)if(i[s].data.length!==i[s+1].data.length){e=!1;break}return e}},{key:"getBarsHeight",value:function(e){return Kl(e).reduce(function(i,s){return i+s.getBBox().height},0)}},{key:"getElMarkers",value:function(e){return typeof e=="number"?this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-series-markers-wrap > *")):this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap > *")}},{key:"getAllMarkers",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");s=Kl(s),i&&(s=s.filter(function(d){var A=Number(d.getAttribute("data:realIndex"));return e.w.globals.collapsedSeriesIndices.indexOf(A)===-1})),s.sort(function(d,A){var r=Number(d.getAttribute("data:realIndex")),y=Number(A.getAttribute("data:realIndex"));return y<r?1:y>r?-1:0});var c=[];return s.forEach(function(d){c.push(d.querySelector(".apexcharts-marker"))}),c}},{key:"hasMarkers",value:function(e){return this.getElMarkers(e).length>0}},{key:"getPathFromPoint",value:function(e,i){var s=Number(e.getAttribute("cx")),c=Number(e.getAttribute("cy")),d=e.getAttribute("shape");return new ur(this.ctx).getMarkerPath(s,c,d,i)}},{key:"getElBars",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}},{key:"hasBars",value:function(){return this.getElBars().length>0}},{key:"getHoverMarkerSize",value:function(e){var i=this.w,s=i.config.markers.hover.size;return s===void 0&&(s=i.globals.markers.size[e]+i.config.markers.hover.sizeOffset),s}},{key:"toggleAllTooltipSeriesGroups",value:function(e){var i=this.w,s=this.ttCtx;s.allTooltipSeriesGroups.length===0&&(s.allTooltipSeriesGroups=i.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));for(var c=s.allTooltipSeriesGroups,d=0;d<c.length;d++)e==="enable"?(c[d].classList.add("apexcharts-active"),c[d].style.display=i.config.tooltip.items.display):(c[d].classList.remove("apexcharts-active"),c[d].style.display="none")}}]),a}(),eD=function(){function a(e){en(this,a),this.w=e.w,this.ctx=e.ctx,this.ttCtx=e,this.tooltipUtil=new KT(e)}return tn(a,[{key:"drawSeriesTexts",value:function(e){var i=e.shared,s=i===void 0||i,c=e.ttItems,d=e.i,A=d===void 0?0:d,r=e.j,y=r===void 0?null:r,b=e.y1,x=e.y2,B=e.e,T=this.w;T.config.tooltip.custom!==void 0?this.handleCustomTooltip({i:A,j:y,y1:b,y2:x,w:T}):this.toggleActiveInactiveSeries(s,A);var E=this.getValuesToPrint({i:A,j:y});this.printLabels({i:A,j:y,values:E,ttItems:c,shared:s,e:B});var R=this.ttCtx.getElTooltip();this.ttCtx.tooltipRect.ttWidth=R.getBoundingClientRect().width,this.ttCtx.tooltipRect.ttHeight=R.getBoundingClientRect().height}},{key:"printLabels",value:function(e){var i,s=this,c=e.i,d=e.j,A=e.values,r=e.ttItems,y=e.shared,b=e.e,x=this.w,B=[],T=function(re){return x.globals.seriesGoals[re]&&x.globals.seriesGoals[re][d]&&Array.isArray(x.globals.seriesGoals[re][d])},E=A.xVal,R=A.zVal,P=A.xAxisTTVal,G="",U=x.globals.colors[c];d!==null&&x.config.plotOptions.bar.distributed&&(U=x.globals.colors[d]);for(var Q=function(re,pe){var fe=s.getFormatters(c);G=s.getSeriesName({fn:fe.yLbTitleFormatter,index:c,seriesIndex:c,j:d}),x.config.chart.type==="treemap"&&(G=fe.yLbTitleFormatter(String(x.config.series[c].data[d].x),{series:x.globals.series,seriesIndex:c,dataPointIndex:d,w:x}));var he=x.config.tooltip.inverseOrder?pe:re;if(x.globals.axisCharts){var be=function(ye){var Me,Be,Pe,De;return x.globals.isRangeData?fe.yLbFormatter((Me=x.globals.seriesRangeStart)===null||Me===void 0||(Be=Me[ye])===null||Be===void 0?void 0:Be[d],{series:x.globals.seriesRangeStart,seriesIndex:ye,dataPointIndex:d,w:x})+" - "+fe.yLbFormatter((Pe=x.globals.seriesRangeEnd)===null||Pe===void 0||(De=Pe[ye])===null||De===void 0?void 0:De[d],{series:x.globals.seriesRangeEnd,seriesIndex:ye,dataPointIndex:d,w:x}):fe.yLbFormatter(x.globals.series[ye][d],{series:x.globals.series,seriesIndex:ye,dataPointIndex:d,w:x})};if(y)fe=s.getFormatters(he),G=s.getSeriesName({fn:fe.yLbTitleFormatter,index:he,seriesIndex:c,j:d}),U=x.globals.colors[he],i=be(he),T(he)&&(B=x.globals.seriesGoals[he][d].map(function(ye){return{attrs:ye,val:fe.yLbFormatter(ye.value,{seriesIndex:he,dataPointIndex:d,w:x})}}));else{var Se,oe=b==null||(Se=b.target)===null||Se===void 0?void 0:Se.getAttribute("fill");oe&&(oe.indexOf("url")!==-1?oe.indexOf("Pattern")!==-1&&(U=x.globals.dom.baseEl.querySelector(oe.substr(4).slice(0,-1)).childNodes[0].getAttribute("stroke")):U=oe),i=be(c),T(c)&&Array.isArray(x.globals.seriesGoals[c][d])&&(B=x.globals.seriesGoals[c][d].map(function(ye){return{attrs:ye,val:fe.yLbFormatter(ye.value,{seriesIndex:c,dataPointIndex:d,w:x})}}))}}d===null&&(i=fe.yLbFormatter(x.globals.series[c],Tr(Tr({},x),{},{seriesIndex:c,dataPointIndex:c}))),s.DOMHandling({i:c,t:he,j:d,ttItems:r,values:{val:i,goalVals:B,xVal:E,xAxisTTVal:P,zVal:R},seriesName:G,shared:y,pColor:U})},q=0,ne=x.globals.series.length-1;q<x.globals.series.length;q++,ne--)Q(q,ne)}},{key:"getFormatters",value:function(e){var i,s=this.w,c=s.globals.yLabelFormatters[e];return s.globals.ttVal!==void 0?Array.isArray(s.globals.ttVal)?(c=s.globals.ttVal[e]&&s.globals.ttVal[e].formatter,i=s.globals.ttVal[e]&&s.globals.ttVal[e].title&&s.globals.ttVal[e].title.formatter):(c=s.globals.ttVal.formatter,typeof s.globals.ttVal.title.formatter=="function"&&(i=s.globals.ttVal.title.formatter)):i=s.config.tooltip.y.title.formatter,typeof c!="function"&&(c=s.globals.yLabelFormatters[0]?s.globals.yLabelFormatters[0]:function(d){return d}),typeof i!="function"&&(i=function(d){return d?d+": ":""}),{yLbFormatter:c,yLbTitleFormatter:i}}},{key:"getSeriesName",value:function(e){var i=e.fn,s=e.index,c=e.seriesIndex,d=e.j,A=this.w;return i(String(A.globals.seriesNames[s]),{series:A.globals.series,seriesIndex:c,dataPointIndex:d,w:A})}},{key:"DOMHandling",value:function(e){e.i;var i=e.t,s=e.j,c=e.ttItems,d=e.values,A=e.seriesName,r=e.shared,y=e.pColor,b=this.w,x=this.ttCtx,B=d.val,T=d.goalVals,E=d.xVal,R=d.xAxisTTVal,P=d.zVal,G=null;G=c[i].children,b.config.tooltip.fillSeriesColor&&(c[i].style.backgroundColor=y,G[0].style.display="none"),x.showTooltipTitle&&(x.tooltipTitle===null&&(x.tooltipTitle=b.globals.dom.baseEl.querySelector(".apexcharts-tooltip-title")),x.tooltipTitle.innerHTML=E),x.isXAxisTooltipEnabled&&(x.xaxisTooltipText.innerHTML=R!==""?R:E);var U=c[i].querySelector(".apexcharts-tooltip-text-y-label");U&&(U.innerHTML=A||"");var Q=c[i].querySelector(".apexcharts-tooltip-text-y-value");Q&&(Q.innerHTML=B!==void 0?B:""),G[0]&&G[0].classList.contains("apexcharts-tooltip-marker")&&(b.config.tooltip.marker.fillColors&&Array.isArray(b.config.tooltip.marker.fillColors)&&(y=b.config.tooltip.marker.fillColors[i]),b.config.tooltip.fillSeriesColor?G[0].style.backgroundColor=y:G[0].style.color=y),b.config.tooltip.marker.show||(G[0].style.display="none");var q=c[i].querySelector(".apexcharts-tooltip-text-goals-label"),ne=c[i].querySelector(".apexcharts-tooltip-text-goals-value");if(T.length&&b.globals.seriesGoals[i]){var re=function(){var he="<div>",be="<div>";T.forEach(function(Se,oe){he+=' <div style="display: flex"><span class="apexcharts-tooltip-marker" style="background-color: '.concat(Se.attrs.strokeColor,'; height: 3px; border-radius: 0; top: 5px;"></span> ').concat(Se.attrs.name,"</div>"),be+="<div>".concat(Se.val,"</div>")}),q.innerHTML=he+"</div>",ne.innerHTML=be+"</div>"};r?b.globals.seriesGoals[i][s]&&Array.isArray(b.globals.seriesGoals[i][s])?re():(q.innerHTML="",ne.innerHTML=""):re()}else q.innerHTML="",ne.innerHTML="";if(P!==null&&(c[i].querySelector(".apexcharts-tooltip-text-z-label").innerHTML=b.config.tooltip.z.title,c[i].querySelector(".apexcharts-tooltip-text-z-value").innerHTML=P!==void 0?P:""),r&&G[0]){if(b.config.tooltip.hideEmptySeries){var pe=c[i].querySelector(".apexcharts-tooltip-marker"),fe=c[i].querySelector(".apexcharts-tooltip-text");parseFloat(B)==0?(pe.style.display="none",fe.style.display="none"):(pe.style.display="block",fe.style.display="block")}B==null||b.globals.ancillaryCollapsedSeriesIndices.indexOf(i)>-1||b.globals.collapsedSeriesIndices.indexOf(i)>-1||Array.isArray(x.tConfig.enabledOnSeries)&&x.tConfig.enabledOnSeries.indexOf(i)===-1?G[0].parentNode.style.display="none":G[0].parentNode.style.display=b.config.tooltip.items.display}else Array.isArray(x.tConfig.enabledOnSeries)&&x.tConfig.enabledOnSeries.indexOf(i)===-1&&(G[0].parentNode.style.display="none")}},{key:"toggleActiveInactiveSeries",value:function(e,i){var s=this.w;if(e)this.tooltipUtil.toggleAllTooltipSeriesGroups("enable");else{this.tooltipUtil.toggleAllTooltipSeriesGroups("disable");var c=s.globals.dom.baseEl.querySelector(".apexcharts-tooltip-series-group-".concat(i));c&&(c.classList.add("apexcharts-active"),c.style.display=s.config.tooltip.items.display)}}},{key:"getValuesToPrint",value:function(e){var i=e.i,s=e.j,c=this.w,d=this.ctx.series.filteredSeriesX(),A="",r="",y=null,b=null,x={series:c.globals.series,seriesIndex:i,dataPointIndex:s,w:c},B=c.globals.ttZFormatter;s===null?b=c.globals.series[i]:c.globals.isXNumeric&&c.config.chart.type!=="treemap"?(A=d[i][s],d[i].length===0&&(A=d[this.tooltipUtil.getFirstActiveXArray(d)][s])):A=new J1(this.ctx).isFormatXY()?c.config.series[i].data[s]!==void 0?c.config.series[i].data[s].x:"":c.globals.labels[s]!==void 0?c.globals.labels[s]:"";var T=A;return c.globals.isXNumeric&&c.config.xaxis.type==="datetime"?A=new Zy(this.ctx).xLabelFormat(c.globals.ttKeyFormatter,T,T,{i:void 0,dateFormatter:new Pc(this.ctx).formatDate,w:this.w}):A=c.globals.isBarHorizontal?c.globals.yLabelFormatters[0](T,x):c.globals.xLabelFormatter(T,x),c.config.tooltip.x.formatter!==void 0&&(A=c.globals.ttKeyFormatter(T,x)),c.globals.seriesZ.length>0&&c.globals.seriesZ[i].length>0&&(y=B(c.globals.seriesZ[i][s],c)),r=typeof c.config.xaxis.tooltip.formatter=="function"?c.globals.xaxisTooltipFormatter(T,x):A,{val:Array.isArray(b)?b.join(" "):b,xVal:Array.isArray(A)?A.join(" "):A,xAxisTTVal:Array.isArray(r)?r.join(" "):r,zVal:y}}},{key:"handleCustomTooltip",value:function(e){var i=e.i,s=e.j,c=e.y1,d=e.y2,A=e.w,r=this.ttCtx.getElTooltip(),y=A.config.tooltip.custom;Array.isArray(y)&&y[i]&&(y=y[i]);var b=y({ctx:this.ctx,series:A.globals.series,seriesIndex:i,dataPointIndex:s,y1:c,y2:d,w:A});typeof b=="string"||typeof b=="number"?r.innerHTML=b:(b instanceof Element||typeof b.nodeName=="string")&&(r.innerHTML="",r.appendChild(b.cloneNode(!0)))}}]),a}(),qT=function(){function a(e){en(this,a),this.ttCtx=e,this.ctx=e.ctx,this.w=e.w}return tn(a,[{key:"moveXCrosshairs",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.ttCtx,c=this.w,d=s.getElXCrosshairs(),A=e-s.xcrosshairsWidth/2,r=c.globals.labels.slice().length;if(i!==null&&(A=c.globals.gridWidth/r*i),d===null||c.globals.isBarHorizontal||(d.setAttribute("x",A),d.setAttribute("x1",A),d.setAttribute("x2",A),d.setAttribute("y2",c.globals.gridHeight),d.classList.add("apexcharts-active")),A<0&&(A=0),A>c.globals.gridWidth&&(A=c.globals.gridWidth),s.isXAxisTooltipEnabled){var y=A;c.config.xaxis.crosshairs.width!=="tickWidth"&&c.config.xaxis.crosshairs.width!=="barWidth"||(y=A+s.xcrosshairsWidth/2),this.moveXAxisTooltip(y)}}},{key:"moveYCrosshairs",value:function(e){var i=this.ttCtx;i.ycrosshairs!==null&&ur.setAttrs(i.ycrosshairs,{y1:e,y2:e}),i.ycrosshairsHidden!==null&&ur.setAttrs(i.ycrosshairsHidden,{y1:e,y2:e})}},{key:"moveXAxisTooltip",value:function(e){var i=this.w,s=this.ttCtx;if(s.xaxisTooltip!==null&&s.xcrosshairsWidth!==0){s.xaxisTooltip.classList.add("apexcharts-active");var c=s.xaxisOffY+i.config.xaxis.tooltip.offsetY+i.globals.translateY+1+i.config.xaxis.offsetY;if(e-=s.xaxisTooltip.getBoundingClientRect().width/2,!isNaN(e)){e+=i.globals.translateX;var d;d=new ur(this.ctx).getTextRects(s.xaxisTooltipText.innerHTML),s.xaxisTooltipText.style.minWidth=d.width+"px",s.xaxisTooltip.style.left=e+"px",s.xaxisTooltip.style.top=c+"px"}}}},{key:"moveYAxisTooltip",value:function(e){var i=this.w,s=this.ttCtx;s.yaxisTTEls===null&&(s.yaxisTTEls=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));var c=parseInt(s.ycrosshairsHidden.getAttribute("y1"),10),d=i.globals.translateY+c,A=s.yaxisTTEls[e].getBoundingClientRect(),r=A.height,y=i.globals.translateYAxisX[e]-2;i.config.yaxis[e].opposite&&(y-=A.width),d-=r/2,i.globals.ignoreYAxisIndexes.indexOf(e)===-1&&d>0&&d<i.globals.gridHeight?(s.yaxisTTEls[e].classList.add("apexcharts-active"),s.yaxisTTEls[e].style.top=d+"px",s.yaxisTTEls[e].style.left=y+i.config.yaxis[e].tooltip.offsetX+"px"):s.yaxisTTEls[e].classList.remove("apexcharts-active")}},{key:"moveTooltip",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=this.w,d=this.ttCtx,A=d.getElTooltip(),r=d.tooltipRect,y=s!==null?parseFloat(s):1,b=parseFloat(e)+y+5,x=parseFloat(i)+y/2;if(b>c.globals.gridWidth/2&&(b=b-r.ttWidth-y-10),b>c.globals.gridWidth-r.ttWidth-10&&(b=c.globals.gridWidth-r.ttWidth),b<-20&&(b=-20),c.config.tooltip.followCursor){var B=d.getElGrid().getBoundingClientRect();(b=d.e.clientX-B.left)>c.globals.gridWidth/2&&(b-=d.tooltipRect.ttWidth),(x=d.e.clientY+c.globals.translateY-B.top)>c.globals.gridHeight/2&&(x-=d.tooltipRect.ttHeight)}else c.globals.isBarHorizontal||r.ttHeight/2+x>c.globals.gridHeight&&(x=c.globals.gridHeight-r.ttHeight+c.globals.translateY);isNaN(b)||(b+=c.globals.translateX,A.style.left=b+"px",A.style.top=x+"px")}},{key:"moveMarkers",value:function(e,i){var s=this.w,c=this.ttCtx;if(s.globals.markers.size[e]>0)for(var d=s.globals.dom.baseEl.querySelectorAll(" .apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-marker")),A=0;A<d.length;A++)parseInt(d[A].getAttribute("rel"),10)===i&&(c.marker.resetPointsSize(),c.marker.enlargeCurrentPoint(i,d[A]));else c.marker.resetPointsSize(),this.moveDynamicPointOnHover(i,e)}},{key:"moveDynamicPointOnHover",value:function(e,i){var s,c,d,A,r=this.w,y=this.ttCtx,b=new ur(this.ctx),x=r.globals.pointsArray,B=y.tooltipUtil.getHoverMarkerSize(i),T=r.config.series[i].type;if(!T||T!=="column"&&T!=="candlestick"&&T!=="boxPlot"){d=(s=x[i][e])===null||s===void 0?void 0:s[0],A=((c=x[i][e])===null||c===void 0?void 0:c[1])||0;var E=r.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(i,"'] .apexcharts-series-markers path"));if(E&&A<r.globals.gridHeight&&A>0){var R=E.getAttribute("shape"),P=b.getMarkerPath(d,A,R,1.5*B);E.setAttribute("d",P)}this.moveXCrosshairs(d),y.fixedTooltip||this.moveTooltip(d,A,B)}}},{key:"moveDynamicPointsOnHover",value:function(e){var i,s=this.ttCtx,c=s.w,d=0,A=0,r=c.globals.pointsArray,y=new od(this.ctx),b=new ur(this.ctx);i=y.getActiveConfigSeriesIndex("asc",["line","area","scatter","bubble"]);var x=s.tooltipUtil.getHoverMarkerSize(i);if(r[i]&&(d=r[i][e][0],A=r[i][e][1]),!isNaN(d)){var B=s.tooltipUtil.getAllMarkers();if(B.length)for(var T=0;T<c.globals.series.length;T++){var E=r[T];if(c.globals.comboCharts&&E===void 0&&B.splice(T,0,null),E&&E.length){var R=r[T][e][1],P=void 0;B[T].setAttribute("cx",d);var G=B[T].getAttribute("shape");if(c.config.chart.type==="rangeArea"&&!c.globals.comboCharts){var U=e+c.globals.series[T].length;P=r[T][U][1],R-=Math.abs(R-P)/2}if(R!==null&&!isNaN(R)&&R<c.globals.gridHeight+x&&R+x>0){var Q=b.getMarkerPath(d,R,G,x);B[T].setAttribute("d",Q)}else B[T].setAttribute("d","")}}this.moveXCrosshairs(d),s.fixedTooltip||this.moveTooltip(d,A||c.globals.gridHeight,x)}}},{key:"moveStickyTooltipOverBars",value:function(e,i){var s=this.w,c=this.ttCtx,d=s.globals.columnSeries?s.globals.columnSeries.length:s.globals.series.length;s.config.chart.stacked&&(d=s.globals.barGroups.length);var A=d>=2&&d%2==0?Math.floor(d/2):Math.floor(d/2)+1;s.globals.isBarHorizontal&&(A=new od(this.ctx).getActiveConfigSeriesIndex("desc")+1);var r=s.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[rel='".concat(A,"'] path[j='").concat(e,"'], .apexcharts-candlestick-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"'], .apexcharts-boxPlot-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"'], .apexcharts-rangebar-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"']"));r||typeof i!="number"||(r=s.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[data\\:realIndex='".concat(i,"'] path[j='").concat(e,`'],
        .apexcharts-candlestick-series .apexcharts-series[data\\:realIndex='`).concat(i,"'] path[j='").concat(e,`'],
        .apexcharts-boxPlot-series .apexcharts-series[data\\:realIndex='`).concat(i,"'] path[j='").concat(e,`'],
        .apexcharts-rangebar-series .apexcharts-series[data\\:realIndex='`).concat(i,"'] path[j='").concat(e,"']")));var y=r?parseFloat(r.getAttribute("cx")):0,b=r?parseFloat(r.getAttribute("cy")):0,x=r?parseFloat(r.getAttribute("barWidth")):0,B=c.getElGrid().getBoundingClientRect(),T=r&&(r.classList.contains("apexcharts-candlestick-area")||r.classList.contains("apexcharts-boxPlot-area"));s.globals.isXNumeric?(r&&!T&&(y-=d%2!=0?x/2:0),r&&T&&(y-=x/2)):s.globals.isBarHorizontal||(y=c.xAxisTicksPositions[e-1]+c.dataPointsDividedWidth/2,isNaN(y)&&(y=c.xAxisTicksPositions[e]-c.dataPointsDividedWidth/2)),s.globals.isBarHorizontal?b-=c.tooltipRect.ttHeight:s.config.tooltip.followCursor?b=c.e.clientY-B.top-c.tooltipRect.ttHeight/2:b+c.tooltipRect.ttHeight+15>s.globals.gridHeight&&(b=s.globals.gridHeight),s.globals.isBarHorizontal||this.moveXCrosshairs(y),c.fixedTooltip||this.moveTooltip(y,b||s.globals.gridHeight)}}]),a}(),tD=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e,this.ctx=e.ctx,this.tooltipPosition=new qT(e)}return tn(a,[{key:"drawDynamicPoints",value:function(){var e=this.w,i=new ur(this.ctx),s=new Am(this.ctx),c=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");c=Kl(c),e.config.chart.stacked&&c.sort(function(B,T){return parseFloat(B.getAttribute("data:realIndex"))-parseFloat(T.getAttribute("data:realIndex"))});for(var d=0;d<c.length;d++){var A=c[d].querySelector(".apexcharts-series-markers-wrap");if(A!==null){var r=void 0,y="apexcharts-marker w".concat((Math.random()+1).toString(36).substring(4));e.config.chart.type!=="line"&&e.config.chart.type!=="area"||e.globals.comboCharts||e.config.tooltip.intersect||(y+=" no-pointer-events");var b=s.getMarkerConfig({cssClass:y,seriesIndex:Number(A.getAttribute("data:realIndex"))});(r=i.drawMarker(0,0,b)).node.setAttribute("default-marker-size",0);var x=document.createElementNS(e.globals.SVGNS,"g");x.classList.add("apexcharts-series-markers"),x.appendChild(r.node),A.appendChild(x)}}}},{key:"enlargeCurrentPoint",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,d=this.w;d.config.chart.type!=="bubble"&&this.newPointSize(e,i);var A=i.getAttribute("cx"),r=i.getAttribute("cy");if(s!==null&&c!==null&&(A=s,r=c),this.tooltipPosition.moveXCrosshairs(A),!this.fixedTooltip){if(d.config.chart.type==="radar"){var y=this.ttCtx.getElGrid().getBoundingClientRect();A=this.ttCtx.e.clientX-y.left}this.tooltipPosition.moveTooltip(A,r,d.config.markers.hover.size)}}},{key:"enlargePoints",value:function(e){for(var i=this.w,s=this,c=this.ttCtx,d=e,A=i.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),r=i.config.markers.hover.size,y=0;y<A.length;y++){var b=A[y].getAttribute("rel"),x=A[y].getAttribute("index");if(r===void 0&&(r=i.globals.markers.size[x]+i.config.markers.hover.sizeOffset),d===parseInt(b,10)){s.newPointSize(d,A[y]);var B=A[y].getAttribute("cx"),T=A[y].getAttribute("cy");s.tooltipPosition.moveXCrosshairs(B),c.fixedTooltip||s.tooltipPosition.moveTooltip(B,T,r)}else s.oldPointSize(A[y])}}},{key:"newPointSize",value:function(e,i){var s=this.w,c=s.config.markers.hover.size,d=e===0?i.parentNode.firstChild:i.parentNode.lastChild;if(d.getAttribute("default-marker-size")!=="0"){var A=parseInt(d.getAttribute("index"),10);c===void 0&&(c=s.globals.markers.size[A]+s.config.markers.hover.sizeOffset),c<0&&(c=0);var r=this.ttCtx.tooltipUtil.getPathFromPoint(i,c);i.setAttribute("d",r)}}},{key:"oldPointSize",value:function(e){var i=parseFloat(e.getAttribute("default-marker-size")),s=this.ttCtx.tooltipUtil.getPathFromPoint(e,i);e.setAttribute("d",s)}},{key:"resetPointsSize",value:function(){for(var e=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),i=0;i<e.length;i++){var s=parseFloat(e[i].getAttribute("default-marker-size"));if(ni.isNumber(s)&&s>0){var c=this.ttCtx.tooltipUtil.getPathFromPoint(e[i],s);e[i].setAttribute("d",c)}else e[i].setAttribute("d","M0,0")}}}]),a}(),iD=function(){function a(e){en(this,a),this.w=e.w;var i=this.w;this.ttCtx=e,this.isVerticalGroupedRangeBar=!i.globals.isBarHorizontal&&i.config.chart.type==="rangeBar"&&i.config.plotOptions.bar.rangeBarGroupRows}return tn(a,[{key:"getAttr",value:function(e,i){return parseFloat(e.target.getAttribute(i))}},{key:"handleHeatTreeTooltip",value:function(e){var i=e.e,s=e.opt,c=e.x,d=e.y,A=e.type,r=this.ttCtx,y=this.w;if(i.target.classList.contains("apexcharts-".concat(A,"-rect"))){var b=this.getAttr(i,"i"),x=this.getAttr(i,"j"),B=this.getAttr(i,"cx"),T=this.getAttr(i,"cy"),E=this.getAttr(i,"width"),R=this.getAttr(i,"height");if(r.tooltipLabels.drawSeriesTexts({ttItems:s.ttItems,i:b,j:x,shared:!1,e:i}),y.globals.capturedSeriesIndex=b,y.globals.capturedDataPointIndex=x,c=B+r.tooltipRect.ttWidth/2+E,d=T+r.tooltipRect.ttHeight/2-R/2,r.tooltipPosition.moveXCrosshairs(B+E/2),c>y.globals.gridWidth/2&&(c=B-r.tooltipRect.ttWidth/2+E),r.w.config.tooltip.followCursor){var P=y.globals.dom.elWrap.getBoundingClientRect();c=y.globals.clientX-P.left-(c>y.globals.gridWidth/2?r.tooltipRect.ttWidth:0),d=y.globals.clientY-P.top-(d>y.globals.gridHeight/2?r.tooltipRect.ttHeight:0)}}return{x:c,y:d}}},{key:"handleMarkerTooltip",value:function(e){var i,s,c=e.e,d=e.opt,A=e.x,r=e.y,y=this.w,b=this.ttCtx;if(c.target.classList.contains("apexcharts-marker")){var x=parseInt(d.paths.getAttribute("cx"),10),B=parseInt(d.paths.getAttribute("cy"),10),T=parseFloat(d.paths.getAttribute("val"));if(s=parseInt(d.paths.getAttribute("rel"),10),i=parseInt(d.paths.parentNode.parentNode.parentNode.getAttribute("rel"),10)-1,b.intersect){var E=ni.findAncestor(d.paths,"apexcharts-series");E&&(i=parseInt(E.getAttribute("data:realIndex"),10))}if(b.tooltipLabels.drawSeriesTexts({ttItems:d.ttItems,i,j:s,shared:!b.showOnIntersect&&y.config.tooltip.shared,e:c}),c.type==="mouseup"&&b.markerClick(c,i,s),y.globals.capturedSeriesIndex=i,y.globals.capturedDataPointIndex=s,A=x,r=B+y.globals.translateY-1.4*b.tooltipRect.ttHeight,b.w.config.tooltip.followCursor){var R=b.getElGrid().getBoundingClientRect();r=b.e.clientY+y.globals.translateY-R.top}T<0&&(r=B),b.marker.enlargeCurrentPoint(s,d.paths,A,r)}return{x:A,y:r}}},{key:"handleBarTooltip",value:function(e){var i,s,c=e.e,d=e.opt,A=this.w,r=this.ttCtx,y=r.getElTooltip(),b=0,x=0,B=0,T=this.getBarTooltipXY({e:c,opt:d});if(T.j!==null||T.barHeight!==0||T.barWidth!==0){i=T.i;var E=T.j;if(A.globals.capturedSeriesIndex=i,A.globals.capturedDataPointIndex=E,A.globals.isBarHorizontal&&r.tooltipUtil.hasBars()||!A.config.tooltip.shared?(x=T.x,B=T.y,s=Array.isArray(A.config.stroke.width)?A.config.stroke.width[i]:A.config.stroke.width,b=x):A.globals.comboCharts||A.config.tooltip.shared||(b/=2),isNaN(B)&&(B=A.globals.svgHeight-r.tooltipRect.ttHeight),parseInt(d.paths.parentNode.getAttribute("data:realIndex"),10),x+r.tooltipRect.ttWidth>A.globals.gridWidth?x-=r.tooltipRect.ttWidth:x<0&&(x=0),r.w.config.tooltip.followCursor){var R=r.getElGrid().getBoundingClientRect();B=r.e.clientY-R.top}r.tooltip===null&&(r.tooltip=A.globals.dom.baseEl.querySelector(".apexcharts-tooltip")),A.config.tooltip.shared||(A.globals.comboBarCount>0?r.tooltipPosition.moveXCrosshairs(b+s/2):r.tooltipPosition.moveXCrosshairs(b)),!r.fixedTooltip&&(!A.config.tooltip.shared||A.globals.isBarHorizontal&&r.tooltipUtil.hasBars())&&(B=B+A.globals.translateY-r.tooltipRect.ttHeight/2,y.style.left=x+A.globals.translateX+"px",y.style.top=B+"px")}}},{key:"getBarTooltipXY",value:function(e){var i=this,s=e.e,c=e.opt,d=this.w,A=null,r=this.ttCtx,y=0,b=0,x=0,B=0,T=0,E=s.target.classList;if(E.contains("apexcharts-bar-area")||E.contains("apexcharts-candlestick-area")||E.contains("apexcharts-boxPlot-area")||E.contains("apexcharts-rangebar-area")){var R=s.target,P=R.getBoundingClientRect(),G=c.elGrid.getBoundingClientRect(),U=P.height;T=P.height;var Q=P.width,q=parseInt(R.getAttribute("cx"),10),ne=parseInt(R.getAttribute("cy"),10);B=parseFloat(R.getAttribute("barWidth"));var re=s.type==="touchmove"?s.touches[0].clientX:s.clientX;A=parseInt(R.getAttribute("j"),10),y=parseInt(R.parentNode.getAttribute("rel"),10)-1;var pe=R.getAttribute("data-range-y1"),fe=R.getAttribute("data-range-y2");d.globals.comboCharts&&(y=parseInt(R.parentNode.getAttribute("data:realIndex"),10));var he=function(Se){return d.globals.isXNumeric?q-Q/2:i.isVerticalGroupedRangeBar?q+Q/2:q-r.dataPointsDividedWidth+Q/2},be=function(){return ne-r.dataPointsDividedHeight+U/2-r.tooltipRect.ttHeight/2};r.tooltipLabels.drawSeriesTexts({ttItems:c.ttItems,i:y,j:A,y1:pe?parseInt(pe,10):null,y2:fe?parseInt(fe,10):null,shared:!r.showOnIntersect&&d.config.tooltip.shared,e:s}),d.config.tooltip.followCursor?d.globals.isBarHorizontal?(b=re-G.left+15,x=be()):(b=he(),x=s.clientY-G.top-r.tooltipRect.ttHeight/2-15):d.globals.isBarHorizontal?((b=q)<r.xyRatios.baseLineInvertedY&&(b=q-r.tooltipRect.ttWidth),x=be()):(b=he(),x=ne)}return{x:b,y:x,barHeight:T,barWidth:B,i:y,j:A}}}]),a}(),rD=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e}return tn(a,[{key:"drawXaxisTooltip",value:function(){var e=this.w,i=this.ttCtx,s=e.config.xaxis.position==="bottom";i.xaxisOffY=s?e.globals.gridHeight+1:-e.globals.xAxisHeight-e.config.xaxis.axisTicks.height+3;var c=s?"apexcharts-xaxistooltip apexcharts-xaxistooltip-bottom":"apexcharts-xaxistooltip apexcharts-xaxistooltip-top",d=e.globals.dom.elWrap;i.isXAxisTooltipEnabled&&e.globals.dom.baseEl.querySelector(".apexcharts-xaxistooltip")===null&&(i.xaxisTooltip=document.createElement("div"),i.xaxisTooltip.setAttribute("class",c+" apexcharts-theme-"+e.config.tooltip.theme),d.appendChild(i.xaxisTooltip),i.xaxisTooltipText=document.createElement("div"),i.xaxisTooltipText.classList.add("apexcharts-xaxistooltip-text"),i.xaxisTooltipText.style.fontFamily=e.config.xaxis.tooltip.style.fontFamily||e.config.chart.fontFamily,i.xaxisTooltipText.style.fontSize=e.config.xaxis.tooltip.style.fontSize,i.xaxisTooltip.appendChild(i.xaxisTooltipText))}},{key:"drawYaxisTooltip",value:function(){for(var e=this.w,i=this.ttCtx,s=0;s<e.config.yaxis.length;s++){var c=e.config.yaxis[s].opposite||e.config.yaxis[s].crosshairs.opposite;i.yaxisOffX=c?e.globals.gridWidth+1:1;var d="apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(s,c?" apexcharts-yaxistooltip-right":" apexcharts-yaxistooltip-left"),A=e.globals.dom.elWrap;e.globals.dom.baseEl.querySelector(".apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(s))===null&&(i.yaxisTooltip=document.createElement("div"),i.yaxisTooltip.setAttribute("class",d+" apexcharts-theme-"+e.config.tooltip.theme),A.appendChild(i.yaxisTooltip),s===0&&(i.yaxisTooltipText=[]),i.yaxisTooltipText[s]=document.createElement("div"),i.yaxisTooltipText[s].classList.add("apexcharts-yaxistooltip-text"),i.yaxisTooltip.appendChild(i.yaxisTooltipText[s]))}}},{key:"setXCrosshairWidth",value:function(){var e=this.w,i=this.ttCtx,s=i.getElXCrosshairs();if(i.xcrosshairsWidth=parseInt(e.config.xaxis.crosshairs.width,10),e.globals.comboCharts){var c=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(c!==null&&e.config.xaxis.crosshairs.width==="barWidth"){var d=parseFloat(c.getAttribute("barWidth"));i.xcrosshairsWidth=d}else if(e.config.xaxis.crosshairs.width==="tickWidth"){var A=e.globals.labels.length;i.xcrosshairsWidth=e.globals.gridWidth/A}}else if(e.config.xaxis.crosshairs.width==="tickWidth"){var r=e.globals.labels.length;i.xcrosshairsWidth=e.globals.gridWidth/r}else if(e.config.xaxis.crosshairs.width==="barWidth"){var y=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(y!==null){var b=parseFloat(y.getAttribute("barWidth"));i.xcrosshairsWidth=b}else i.xcrosshairsWidth=1}e.globals.isBarHorizontal&&(i.xcrosshairsWidth=0),s!==null&&i.xcrosshairsWidth>0&&s.setAttribute("width",i.xcrosshairsWidth)}},{key:"handleYCrosshair",value:function(){var e=this.w,i=this.ttCtx;i.ycrosshairs=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs"),i.ycrosshairsHidden=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs-hidden")}},{key:"drawYaxisTooltipText",value:function(e,i,s){var c=this.ttCtx,d=this.w,A=d.globals,r=A.seriesYAxisMap[e];if(c.yaxisTooltips[e]&&r.length>0){var y=A.yLabelFormatters[e],b=c.getElGrid().getBoundingClientRect(),x=r[0],B=0;s.yRatio.length>1&&(B=x);var T=(i-b.top)*s.yRatio[B],E=A.maxYArr[x]-A.minYArr[x],R=A.minYArr[x]+(E-T);d.config.yaxis[e].reversed&&(R=A.maxYArr[x]-(E-T)),c.tooltipPosition.moveYCrosshairs(i-b.top),c.yaxisTooltipText[e].innerHTML=y(R),c.tooltipPosition.moveYAxisTooltip(e)}}}]),a}(),eE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var i=this.w;this.tConfig=i.config.tooltip,this.tooltipUtil=new KT(this),this.tooltipLabels=new eD(this),this.tooltipPosition=new qT(this),this.marker=new tD(this),this.intersect=new iD(this),this.axesTooltip=new rD(this),this.showOnIntersect=this.tConfig.intersect,this.showTooltipTitle=this.tConfig.x.show,this.fixedTooltip=this.tConfig.fixed.enabled,this.xaxisTooltip=null,this.yaxisTTEls=null,this.isBarShared=!i.globals.isBarHorizontal&&this.tConfig.shared,this.lastHoverTime=Date.now()}return tn(a,[{key:"getElTooltip",value:function(e){return e||(e=this),e.w.globals.dom.baseEl?e.w.globals.dom.baseEl.querySelector(".apexcharts-tooltip"):null}},{key:"getElXCrosshairs",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-xcrosshairs")}},{key:"getElGrid",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-grid")}},{key:"drawTooltip",value:function(e){var i=this.w;this.xyRatios=e,this.isXAxisTooltipEnabled=i.config.xaxis.tooltip.enabled&&i.globals.axisCharts,this.yaxisTooltips=i.config.yaxis.map(function(A,r){return!!(A.show&&A.tooltip.enabled&&i.globals.axisCharts)}),this.allTooltipSeriesGroups=[],i.globals.axisCharts||(this.showTooltipTitle=!1);var s=document.createElement("div");if(s.classList.add("apexcharts-tooltip"),i.config.tooltip.cssClass&&s.classList.add(i.config.tooltip.cssClass),s.classList.add("apexcharts-theme-".concat(this.tConfig.theme||"light")),i.globals.dom.elWrap.appendChild(s),i.globals.axisCharts){this.axesTooltip.drawXaxisTooltip(),this.axesTooltip.drawYaxisTooltip(),this.axesTooltip.setXCrosshairWidth(),this.axesTooltip.handleYCrosshair();var c=new Uy(this.ctx);this.xAxisTicksPositions=c.getXAxisTicksPositions()}if(!i.globals.comboCharts&&!this.tConfig.intersect&&i.config.chart.type!=="rangeBar"||this.tConfig.shared||(this.showOnIntersect=!0),i.config.markers.size!==0&&i.globals.markers.largestSize!==0||this.marker.drawDynamicPoints(this),i.globals.collapsedSeries.length!==i.globals.series.length){this.dataPointsDividedHeight=i.globals.gridHeight/i.globals.dataPoints,this.dataPointsDividedWidth=i.globals.gridWidth/i.globals.dataPoints,this.showTooltipTitle&&(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.classList.add("apexcharts-tooltip-title"),this.tooltipTitle.style.fontFamily=this.tConfig.style.fontFamily||i.config.chart.fontFamily,this.tooltipTitle.style.fontSize=this.tConfig.style.fontSize,s.appendChild(this.tooltipTitle));var d=i.globals.series.length;(i.globals.xyCharts||i.globals.comboCharts)&&this.tConfig.shared&&(d=this.showOnIntersect?1:i.globals.series.length),this.legendLabels=i.globals.dom.baseEl.querySelectorAll(".apexcharts-legend-text"),this.ttItems=this.createTTElements(d),this.addSVGEvents()}}},{key:"createTTElements",value:function(e){for(var i=this,s=this.w,c=[],d=this.getElTooltip(),A=function(y){var b=document.createElement("div");b.classList.add("apexcharts-tooltip-series-group","apexcharts-tooltip-series-group-".concat(y)),b.style.order=s.config.tooltip.inverseOrder?e-y:y+1;var x=document.createElement("span");x.classList.add("apexcharts-tooltip-marker"),s.config.tooltip.fillSeriesColor?x.style.backgroundColor=s.globals.colors[y]:x.style.color=s.globals.colors[y];var B=s.config.markers.shape,T=B;Array.isArray(B)&&(T=B[y]),x.setAttribute("shape",T),b.appendChild(x);var E=document.createElement("div");E.classList.add("apexcharts-tooltip-text"),E.style.fontFamily=i.tConfig.style.fontFamily||s.config.chart.fontFamily,E.style.fontSize=i.tConfig.style.fontSize,["y","goals","z"].forEach(function(R){var P=document.createElement("div");P.classList.add("apexcharts-tooltip-".concat(R,"-group"));var G=document.createElement("span");G.classList.add("apexcharts-tooltip-text-".concat(R,"-label")),P.appendChild(G);var U=document.createElement("span");U.classList.add("apexcharts-tooltip-text-".concat(R,"-value")),P.appendChild(U),E.appendChild(P)}),b.appendChild(E),d.appendChild(b),c.push(b)},r=0;r<e;r++)A(r);return c}},{key:"addSVGEvents",value:function(){var e=this.w,i=e.config.chart.type,s=this.getElTooltip(),c=!(i!=="bar"&&i!=="candlestick"&&i!=="boxPlot"&&i!=="rangeBar"),d=i==="area"||i==="line"||i==="scatter"||i==="bubble"||i==="radar",A=e.globals.dom.Paper.node,r=this.getElGrid();r&&(this.seriesBound=r.getBoundingClientRect());var y,b=[],x=[],B={hoverArea:A,elGrid:r,tooltipEl:s,tooltipY:b,tooltipX:x,ttItems:this.ttItems};if(e.globals.axisCharts&&(d?y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:longestSeries='true'] .apexcharts-marker"):c?y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-bar-area, .apexcharts-series .apexcharts-candlestick-area, .apexcharts-series .apexcharts-boxPlot-area, .apexcharts-series .apexcharts-rangebar-area"):i!=="heatmap"&&i!=="treemap"||(y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-heatmap, .apexcharts-series .apexcharts-treemap")),y&&y.length))for(var T=0;T<y.length;T++)b.push(y[T].getAttribute("cy")),x.push(y[T].getAttribute("cx"));if(e.globals.xyCharts&&!this.showOnIntersect||e.globals.comboCharts&&!this.showOnIntersect||c&&this.tooltipUtil.hasBars()&&this.tConfig.shared)this.addPathsEventListeners([A],B);else if(c&&!e.globals.comboCharts||d&&this.showOnIntersect)this.addDatapointEventsListeners(B);else if(!e.globals.axisCharts||i==="heatmap"||i==="treemap"){var E=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");this.addPathsEventListeners(E,B)}if(this.showOnIntersect){var R=e.globals.dom.baseEl.querySelectorAll(".apexcharts-line-series .apexcharts-marker, .apexcharts-area-series .apexcharts-marker");R.length>0&&this.addPathsEventListeners(R,B),this.tooltipUtil.hasBars()&&!this.tConfig.shared&&this.addDatapointEventsListeners(B)}}},{key:"drawFixedTooltipRect",value:function(){var e=this.w,i=this.getElTooltip(),s=i.getBoundingClientRect(),c=s.width+10,d=s.height+10,A=this.tConfig.fixed.offsetX,r=this.tConfig.fixed.offsetY,y=this.tConfig.fixed.position.toLowerCase();return y.indexOf("right")>-1&&(A=A+e.globals.svgWidth-c+10),y.indexOf("bottom")>-1&&(r=r+e.globals.svgHeight-d-10),i.style.left=A+"px",i.style.top=r+"px",{x:A,y:r,ttWidth:c,ttHeight:d}}},{key:"addDatapointEventsListeners",value:function(e){var i=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers .apexcharts-marker, .apexcharts-bar-area, .apexcharts-candlestick-area, .apexcharts-boxPlot-area, .apexcharts-rangebar-area");this.addPathsEventListeners(i,e)}},{key:"addPathsEventListeners",value:function(e,i){for(var s=this,c=function(A){var r={paths:e[A],tooltipEl:i.tooltipEl,tooltipY:i.tooltipY,tooltipX:i.tooltipX,elGrid:i.elGrid,hoverArea:i.hoverArea,ttItems:i.ttItems};["mousemove","mouseup","touchmove","mouseout","touchend"].map(function(y){return e[A].addEventListener(y,s.onSeriesHover.bind(s,r),{capture:!1,passive:!0})})},d=0;d<e.length;d++)c(d)}},{key:"onSeriesHover",value:function(e,i){var s=this,c=Date.now()-this.lastHoverTime;c>=20?this.seriesHover(e,i):(clearTimeout(this.seriesHoverTimeout),this.seriesHoverTimeout=setTimeout(function(){s.seriesHover(e,i)},20-c))}},{key:"seriesHover",value:function(e,i){var s=this;this.lastHoverTime=Date.now();var c=[],d=this.w;d.config.chart.group&&(c=this.ctx.getGroupedCharts()),d.globals.axisCharts&&(d.globals.minX===-1/0&&d.globals.maxX===1/0||d.globals.dataPoints===0)||(c.length?c.forEach(function(A){var r=s.getElTooltip(A),y={paths:e.paths,tooltipEl:r,tooltipY:e.tooltipY,tooltipX:e.tooltipX,elGrid:e.elGrid,hoverArea:e.hoverArea,ttItems:A.w.globals.tooltip.ttItems};A.w.globals.minX===s.w.globals.minX&&A.w.globals.maxX===s.w.globals.maxX&&A.w.globals.tooltip.seriesHoverByContext({chartCtx:A,ttCtx:A.w.globals.tooltip,opt:y,e:i})}):this.seriesHoverByContext({chartCtx:this.ctx,ttCtx:this.w.globals.tooltip,opt:e,e:i}))}},{key:"seriesHoverByContext",value:function(e){var i=e.chartCtx,s=e.ttCtx,c=e.opt,d=e.e,A=i.w,r=this.getElTooltip(i);r&&(s.tooltipRect={x:0,y:0,ttWidth:r.getBoundingClientRect().width,ttHeight:r.getBoundingClientRect().height},s.e=d,s.tooltipUtil.hasBars()&&!A.globals.comboCharts&&!s.isBarShared&&this.tConfig.onDatasetHover.highlightDataSeries&&new od(i).toggleSeriesOnHover(d,d.target.parentNode),A.globals.axisCharts?s.axisChartsTooltips({e:d,opt:c,tooltipRect:s.tooltipRect}):s.nonAxisChartsTooltips({e:d,opt:c,tooltipRect:s.tooltipRect}),s.fixedTooltip&&s.drawFixedTooltipRect())}},{key:"axisChartsTooltips",value:function(e){var i,s,c=e.e,d=e.opt,A=this.w,r=d.elGrid.getBoundingClientRect(),y=c.type==="touchmove"?c.touches[0].clientX:c.clientX,b=c.type==="touchmove"?c.touches[0].clientY:c.clientY;if(this.clientY=b,this.clientX=y,A.globals.capturedSeriesIndex=-1,A.globals.capturedDataPointIndex=-1,b<r.top||b>r.top+r.height)this.handleMouseOut(d);else{if(Array.isArray(this.tConfig.enabledOnSeries)&&!A.config.tooltip.shared){var x=parseInt(d.paths.getAttribute("index"),10);if(this.tConfig.enabledOnSeries.indexOf(x)<0)return void this.handleMouseOut(d)}var B=this.getElTooltip(),T=this.getElXCrosshairs(),E=[];A.config.chart.group&&(E=this.ctx.getSyncedCharts());var R=A.globals.xyCharts||A.config.chart.type==="bar"&&!A.globals.isBarHorizontal&&this.tooltipUtil.hasBars()&&this.tConfig.shared||A.globals.comboCharts&&this.tooltipUtil.hasBars();if(c.type==="mousemove"||c.type==="touchmove"||c.type==="mouseup"){if(A.globals.collapsedSeries.length+A.globals.ancillaryCollapsedSeries.length===A.globals.series.length)return;T!==null&&T.classList.add("apexcharts-active");var P=this.yaxisTooltips.filter(function(Q){return Q===!0});if(this.ycrosshairs!==null&&P.length&&this.ycrosshairs.classList.add("apexcharts-active"),R&&!this.showOnIntersect||E.length>1)this.handleStickyTooltip(c,y,b,d);else if(A.config.chart.type==="heatmap"||A.config.chart.type==="treemap"){var G=this.intersect.handleHeatTreeTooltip({e:c,opt:d,x:i,y:s,type:A.config.chart.type});i=G.x,s=G.y,B.style.left=i+"px",B.style.top=s+"px"}else this.tooltipUtil.hasBars()&&this.intersect.handleBarTooltip({e:c,opt:d}),this.tooltipUtil.hasMarkers()&&this.intersect.handleMarkerTooltip({e:c,opt:d,x:i,y:s});if(this.yaxisTooltips.length)for(var U=0;U<A.config.yaxis.length;U++)this.axesTooltip.drawYaxisTooltipText(U,b,this.xyRatios);A.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),d.tooltipEl.classList.add("apexcharts-active")}else c.type!=="mouseout"&&c.type!=="touchend"||this.handleMouseOut(d)}}},{key:"nonAxisChartsTooltips",value:function(e){var i=e.e,s=e.opt,c=e.tooltipRect,d=this.w,A=s.paths.getAttribute("rel"),r=this.getElTooltip(),y=d.globals.dom.elWrap.getBoundingClientRect();if(i.type==="mousemove"||i.type==="touchmove"){d.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),r.classList.add("apexcharts-active"),this.tooltipLabels.drawSeriesTexts({ttItems:s.ttItems,i:parseInt(A,10)-1,shared:!1});var b=d.globals.clientX-y.left-c.ttWidth/2,x=d.globals.clientY-y.top-c.ttHeight-10;if(r.style.left=b+"px",r.style.top=x+"px",d.config.legend.tooltipHoverFormatter){var B=A-1,T=(0,d.config.legend.tooltipHoverFormatter)(this.legendLabels[B].getAttribute("data:default-text"),{seriesIndex:B,dataPointIndex:B,w:d});this.legendLabels[B].innerHTML=T}}else i.type!=="mouseout"&&i.type!=="touchend"||(r.classList.remove("apexcharts-active"),d.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),d.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(E){var R=E.getAttribute("data:default-text");E.innerHTML=decodeURIComponent(R)}))}},{key:"handleStickyTooltip",value:function(e,i,s,c){var d=this.w,A=this.tooltipUtil.getNearestValues({context:this,hoverArea:c.hoverArea,elGrid:c.elGrid,clientX:i,clientY:s}),r=A.j,y=A.capturedSeries;d.globals.collapsedSeriesIndices.includes(y)&&(y=null);var b=c.elGrid.getBoundingClientRect();if(A.hoverX<0||A.hoverX>b.width)this.handleMouseOut(c);else if(y!==null)this.handleStickyCapturedSeries(e,y,c,r);else if(this.tooltipUtil.isXoverlap(r)||d.globals.isBarHorizontal){var x=d.globals.series.findIndex(function(B,T){return!d.globals.collapsedSeriesIndices.includes(T)});this.create(e,this,x,r,c.ttItems)}}},{key:"handleStickyCapturedSeries",value:function(e,i,s,c){var d=this.w;if(!this.tConfig.shared&&d.globals.series[i][c]===null)return void this.handleMouseOut(s);if(d.globals.series[i][c]!==void 0)this.tConfig.shared&&this.tooltipUtil.isXoverlap(c)&&this.tooltipUtil.isInitialSeriesSameLen()?this.create(e,this,i,c,s.ttItems):this.create(e,this,i,c,s.ttItems,!1);else if(this.tooltipUtil.isXoverlap(c)){var A=d.globals.series.findIndex(function(r,y){return!d.globals.collapsedSeriesIndices.includes(y)});this.create(e,this,A,c,s.ttItems)}}},{key:"deactivateHoverFilter",value:function(){for(var e=this.w,i=new ur(this.ctx),s=e.globals.dom.Paper.find(".apexcharts-bar-area"),c=0;c<s.length;c++)i.pathMouseLeave(s[c])}},{key:"handleMouseOut",value:function(e){var i=this.w,s=this.getElXCrosshairs();if(i.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),e.tooltipEl.classList.remove("apexcharts-active"),this.deactivateHoverFilter(),i.config.chart.type!=="bubble"&&this.marker.resetPointsSize(),s!==null&&s.classList.remove("apexcharts-active"),this.ycrosshairs!==null&&this.ycrosshairs.classList.remove("apexcharts-active"),this.isXAxisTooltipEnabled&&this.xaxisTooltip.classList.remove("apexcharts-active"),this.yaxisTooltips.length){this.yaxisTTEls===null&&(this.yaxisTTEls=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));for(var c=0;c<this.yaxisTTEls.length;c++)this.yaxisTTEls[c].classList.remove("apexcharts-active")}i.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(d){var A=d.getAttribute("data:default-text");d.innerHTML=decodeURIComponent(A)})}},{key:"markerClick",value:function(e,i,s){var c=this.w;typeof c.config.chart.events.markerClick=="function"&&c.config.chart.events.markerClick(e,this.ctx,{seriesIndex:i,dataPointIndex:s,w:c}),this.ctx.events.fireEvent("markerClick",[e,this.ctx,{seriesIndex:i,dataPointIndex:s,w:c}])}},{key:"create",value:function(e,i,s,c,d){var A,r,y,b,x,B,T,E,R,P,G,U,Q,q,ne,re,pe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,fe=this.w,he=i;e.type==="mouseup"&&this.markerClick(e,s,c),pe===null&&(pe=this.tConfig.shared);var be=this.tooltipUtil.hasMarkers(s),Se=this.tooltipUtil.getElBars(),oe=function(){fe.globals.markers.largestSize>0?he.marker.enlargePoints(c):he.tooltipPosition.moveDynamicPointsOnHover(c)};if(fe.config.legend.tooltipHoverFormatter){var ye=fe.config.legend.tooltipHoverFormatter,Me=Array.from(this.legendLabels);Me.forEach(function(ot){var ut=ot.getAttribute("data:default-text");ot.innerHTML=decodeURIComponent(ut)});for(var Be=0;Be<Me.length;Be++){var Pe=Me[Be],De=parseInt(Pe.getAttribute("i"),10),et=decodeURIComponent(Pe.getAttribute("data:default-text")),Ye=ye(et,{seriesIndex:pe?De:s,dataPointIndex:c,w:fe});if(pe)Pe.innerHTML=fe.globals.collapsedSeriesIndices.indexOf(De)<0?Ye:et;else if(Pe.innerHTML=De===s?Ye:et,s===De)break}}var bt=Tr(Tr({ttItems:d,i:s,j:c},((A=fe.globals.seriesRange)===null||A===void 0||(r=A[s])===null||r===void 0||(y=r[c])===null||y===void 0||(b=y.y[0])===null||b===void 0?void 0:b.y1)!==void 0&&{y1:(x=fe.globals.seriesRange)===null||x===void 0||(B=x[s])===null||B===void 0||(T=B[c])===null||T===void 0||(E=T.y[0])===null||E===void 0?void 0:E.y1}),((R=fe.globals.seriesRange)===null||R===void 0||(P=R[s])===null||P===void 0||(G=P[c])===null||G===void 0||(U=G.y[0])===null||U===void 0?void 0:U.y2)!==void 0&&{y2:(Q=fe.globals.seriesRange)===null||Q===void 0||(q=Q[s])===null||q===void 0||(ne=q[c])===null||ne===void 0||(re=ne.y[0])===null||re===void 0?void 0:re.y2});if(pe){if(he.tooltipLabels.drawSeriesTexts(Tr(Tr({},bt),{},{shared:!this.showOnIntersect&&this.tConfig.shared})),be)oe();else if(this.tooltipUtil.hasBars()&&(this.barSeriesHeight=this.tooltipUtil.getBarsHeight(Se),this.barSeriesHeight>0)){var pt=new ur(this.ctx),Qt=fe.globals.dom.Paper.find(".apexcharts-bar-area[j='".concat(c,"']"));this.deactivateHoverFilter(),he.tooltipUtil.getAllMarkers(!0).length&&!this.barSeriesHeight&&oe(),he.tooltipPosition.moveStickyTooltipOverBars(c,s);for(var Ie=0;Ie<Qt.length;Ie++)pt.pathMouseEnter(Qt[Ie])}}else he.tooltipLabels.drawSeriesTexts(Tr({shared:!1},bt)),this.tooltipUtil.hasBars()&&he.tooltipPosition.moveStickyTooltipOverBars(c,s),be&&he.tooltipPosition.moveMarkers(s,c)}}]),a}(),nD=function(){function a(e){en(this,a),this.w=e.w,this.barCtx=e,this.totalFormatter=this.w.config.plotOptions.bar.dataLabels.total.formatter,this.totalFormatter||(this.totalFormatter=this.w.config.dataLabels.formatter)}return tn(a,[{key:"handleBarDataLabels",value:function(e){var i,s,c=e.x,d=e.y,A=e.y1,r=e.y2,y=e.i,b=e.j,x=e.realIndex,B=e.columnGroupIndex,T=e.series,E=e.barHeight,R=e.barWidth,P=e.barXPosition,G=e.barYPosition,U=e.visibleSeries,Q=this.w,q=new ur(this.barCtx.ctx),ne=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[x]:this.barCtx.strokeWidth;Q.globals.isXNumeric&&!Q.globals.isBarHorizontal?(i=c+parseFloat(R*(U+1)),s=d+parseFloat(E*(U+1))-ne):(i=c+parseFloat(R*U),s=d+parseFloat(E*U));var re,pe=null,fe=c,he=d,be={},Se=Q.config.dataLabels,oe=this.barCtx.barOptions.dataLabels,ye=this.barCtx.barOptions.dataLabels.total;G!==void 0&&this.barCtx.isRangeBar&&(s=G,he=G),P!==void 0&&this.barCtx.isVerticalGroupedRangeBar&&(i=P,fe=P);var Me=Se.offsetX,Be=Se.offsetY,Pe={width:0,height:0};if(Q.config.dataLabels.enabled){var De=Q.globals.series[y][b];Pe=q.getTextRects(Q.config.dataLabels.formatter?Q.config.dataLabels.formatter(De,Tr(Tr({},Q),{},{seriesIndex:y,dataPointIndex:b,w:Q})):Q.globals.yLabelFormatters[0](De),parseFloat(Se.style.fontSize))}var et={x:c,y:d,i:y,j:b,realIndex:x,columnGroupIndex:B,bcx:i,bcy:s,barHeight:E,barWidth:R,textRects:Pe,strokeWidth:ne,dataLabelsX:fe,dataLabelsY:he,dataLabelsConfig:Se,barDataLabelsConfig:oe,barTotalDataLabelsConfig:ye,offX:Me,offY:Be};return be=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(et):this.calculateColumnsDataLabelsPosition(et),re=this.drawCalculatedDataLabels({x:be.dataLabelsX,y:be.dataLabelsY,val:this.barCtx.isRangeBar?[A,r]:Q.config.chart.stackType==="100%"?T[x][b]:Q.globals.series[x][b],i:x,j:b,barWidth:R,barHeight:E,textRects:Pe,dataLabelsConfig:Se}),Q.config.chart.stacked&&ye.enabled&&(pe=this.drawTotalDataLabels({x:be.totalDataLabelsX,y:be.totalDataLabelsY,barWidth:R,barHeight:E,realIndex:x,textAnchor:be.totalDataLabelsAnchor,val:this.getStackedTotalDataLabel({realIndex:x,j:b}),dataLabelsConfig:Se,barTotalDataLabelsConfig:ye})),{dataLabelsPos:be,dataLabels:re,totalDataLabels:pe}}},{key:"getStackedTotalDataLabel",value:function(e){var i=e.realIndex,s=e.j,c=this.w,d=this.barCtx.stackedSeriesTotals[s];return this.totalFormatter&&(d=this.totalFormatter(d,Tr(Tr({},c),{},{seriesIndex:i,dataPointIndex:s,w:c}))),d}},{key:"calculateColumnsDataLabelsPosition",value:function(e){var i=this,s=this.w,c=e.i,d=e.j,A=e.realIndex;e.columnGroupIndex;var r,y,b=e.y,x=e.bcx,B=e.barWidth,T=e.barHeight,E=e.textRects,R=e.dataLabelsX,P=e.dataLabelsY,G=e.dataLabelsConfig,U=e.barDataLabelsConfig,Q=e.barTotalDataLabelsConfig,q=e.strokeWidth,ne=e.offX,re=e.offY,pe=x;T=Math.abs(T);var fe=s.config.plotOptions.bar.dataLabels.orientation==="vertical",he=this.barCtx.barHelpers.getZeroValueEncounters({i:c,j:d}).zeroEncounters;x-=q/2;var be=s.globals.gridWidth/s.globals.dataPoints;this.barCtx.isVerticalGroupedRangeBar?R+=B/2:(R=s.globals.isXNumeric?x-B/2+ne:x-be+B/2+ne,!s.config.chart.stacked&&he>0&&s.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(R-=B*he)),fe&&(R=R+E.height/2-q/2-2);var Se=s.globals.series[c][d]<0,oe=b;switch(this.barCtx.isReversed&&(oe=b+(Se?T:-T)),U.position){case"center":P=fe?Se?oe-T/2+re:oe+T/2-re:Se?oe-T/2+E.height/2+re:oe+T/2+E.height/2-re;break;case"bottom":P=fe?Se?oe-T+re:oe+T-re:Se?oe-T+E.height+q+re:oe+T-E.height/2+q-re;break;case"top":P=fe?Se?oe+re:oe-re:Se?oe-E.height/2-re:oe+E.height+re}var ye=oe;if(s.globals.seriesGroups.forEach(function(Pe){var De;(De=i.barCtx[Pe.join(",")])===null||De===void 0||De.prevY.forEach(function(et){ye=Se?Math.max(et[d],ye):Math.min(et[d],ye)})}),this.barCtx.lastActiveBarSerieIndex===A&&Q.enabled){var Me=new ur(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:A,j:d}),G.fontSize);r=Se?ye-Me.height/2-re-Q.offsetY+18:ye+Me.height+re+Q.offsetY-18;var Be=be;y=pe+(s.globals.isXNumeric?-B*s.globals.barGroups.length/2:s.globals.barGroups.length*B/2-(s.globals.barGroups.length-1)*B-Be)+Q.offsetX}return s.config.chart.stacked||(P<0?P=0+q:P+E.height/3>s.globals.gridHeight&&(P=s.globals.gridHeight-q)),{bcx:x,bcy:b,dataLabelsX:R,dataLabelsY:P,totalDataLabelsX:y,totalDataLabelsY:r,totalDataLabelsAnchor:"middle"}}},{key:"calculateBarsDataLabelsPosition",value:function(e){var i=this,s=this.w,c=e.x,d=e.i,A=e.j,r=e.realIndex,y=e.bcy,b=e.barHeight,x=e.barWidth,B=e.textRects,T=e.dataLabelsX,E=e.strokeWidth,R=e.dataLabelsConfig,P=e.barDataLabelsConfig,G=e.barTotalDataLabelsConfig,U=e.offX,Q=e.offY,q=s.globals.gridHeight/s.globals.dataPoints,ne=this.barCtx.barHelpers.getZeroValueEncounters({i:d,j:A}).zeroEncounters;x=Math.abs(x);var re,pe,fe=y-(this.barCtx.isRangeBar?0:q)+b/2+B.height/2+Q-3;!s.config.chart.stacked&&ne>0&&s.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(fe-=b*ne);var he="start",be=s.globals.series[d][A]<0,Se=c;switch(this.barCtx.isReversed&&(Se=c+(be?-x:x),he=be?"start":"end"),P.position){case"center":T=be?Se+x/2-U:Math.max(B.width/2,Se-x/2)+U;break;case"bottom":T=be?Se+x-E-U:Se-x+E+U;break;case"top":T=be?Se-E-U:Se-E+U}var oe=Se;if(s.globals.seriesGroups.forEach(function(Me){var Be;(Be=i.barCtx[Me.join(",")])===null||Be===void 0||Be.prevX.forEach(function(Pe){oe=be?Math.min(Pe[A],oe):Math.max(Pe[A],oe)})}),this.barCtx.lastActiveBarSerieIndex===r&&G.enabled){var ye=new ur(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:r,j:A}),R.fontSize);be?(re=oe-E-U-G.offsetX,he="end"):re=oe+U+G.offsetX+(this.barCtx.isReversed?-(x+E):E),pe=fe-B.height/2+ye.height/2+G.offsetY+E,s.globals.barGroups.length>1&&(pe-=s.globals.barGroups.length/2*(b/2))}return s.config.chart.stacked||(R.textAnchor==="start"?T-B.width<0?T=be?B.width+E:E:T+B.width>s.globals.gridWidth&&(T=be?s.globals.gridWidth-E:s.globals.gridWidth-B.width-E):R.textAnchor==="middle"?T-B.width/2<0?T=B.width/2+E:T+B.width/2>s.globals.gridWidth&&(T=s.globals.gridWidth-B.width/2-E):R.textAnchor==="end"&&(T<1?T=B.width+E:T+1>s.globals.gridWidth&&(T=s.globals.gridWidth-B.width-E))),{bcx:c,bcy:y,dataLabelsX:T,dataLabelsY:fe,totalDataLabelsX:re,totalDataLabelsY:pe,totalDataLabelsAnchor:he}}},{key:"drawCalculatedDataLabels",value:function(e){var i=e.x,s=e.y,c=e.val,d=e.i,A=e.j,r=e.textRects,y=e.barHeight,b=e.barWidth,x=e.dataLabelsConfig,B=this.w,T="rotate(0)";B.config.plotOptions.bar.dataLabels.orientation==="vertical"&&(T="rotate(-90, ".concat(i,", ").concat(s,")"));var E=new am(this.barCtx.ctx),R=new ur(this.barCtx.ctx),P=x.formatter,G=null,U=B.globals.collapsedSeriesIndices.indexOf(d)>-1;if(x.enabled&&!U){G=R.group({class:"apexcharts-data-labels",transform:T});var Q="";c!==void 0&&(Q=P(c,Tr(Tr({},B),{},{seriesIndex:d,dataPointIndex:A,w:B}))),!c&&B.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(Q="");var q=B.globals.series[d][A]<0,ne=B.config.plotOptions.bar.dataLabels.position;B.config.plotOptions.bar.dataLabels.orientation==="vertical"&&(ne==="top"&&(x.textAnchor=q?"end":"start"),ne==="center"&&(x.textAnchor="middle"),ne==="bottom"&&(x.textAnchor=q?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&b<R.getTextRects(Q,parseFloat(x.style.fontSize)).width&&(Q=""),B.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?r.width/1.6>Math.abs(b)&&(Q=""):r.height/1.6>Math.abs(y)&&(Q=""));var re=Tr({},x);this.barCtx.isHorizontal&&c<0&&(x.textAnchor==="start"?re.textAnchor="end":x.textAnchor==="end"&&(re.textAnchor="start")),E.plotDataLabelsText({x:i,y:s,text:Q,i:d,j:A,parent:G,dataLabelsConfig:re,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return G}},{key:"drawTotalDataLabels",value:function(e){var i=e.x,s=e.y,c=e.val,d=e.realIndex,A=e.textAnchor,r=e.barTotalDataLabelsConfig;this.w;var y,b=new ur(this.barCtx.ctx);return r.enabled&&i!==void 0&&s!==void 0&&this.barCtx.lastActiveBarSerieIndex===d&&(y=b.drawText({x:i,y:s,foreColor:r.style.color,text:c,textAnchor:A,fontFamily:r.style.fontFamily,fontSize:r.style.fontSize,fontWeight:r.style.fontWeight})),y}}]),a}(),sD=function(){function a(e){en(this,a),this.w=e.w,this.barCtx=e}return tn(a,[{key:"initVariables",value:function(e){var i=this.w;this.barCtx.series=e,this.barCtx.totalItems=0,this.barCtx.seriesLen=0,this.barCtx.visibleI=-1,this.barCtx.visibleItems=1;for(var s=0;s<e.length;s++)if(e[s].length>0&&(this.barCtx.seriesLen=this.barCtx.seriesLen+1,this.barCtx.totalItems+=e[s].length),i.globals.isXNumeric)for(var c=0;c<e[s].length;c++)i.globals.seriesX[s][c]>i.globals.minX&&i.globals.seriesX[s][c]<i.globals.maxX&&this.barCtx.visibleItems++;else this.barCtx.visibleItems=i.globals.dataPoints;this.arrBorderRadius=this.createBorderRadiusArr(i.globals.series),ni.isSafari()&&(this.arrBorderRadius=this.arrBorderRadius.map(function(d){return d.map(function(A){return"none"})})),this.barCtx.seriesLen===0&&(this.barCtx.seriesLen=1),this.barCtx.zeroSerieses=[],i.globals.comboCharts||this.checkZeroSeries({series:e})}},{key:"initialPositions",value:function(e){var i,s,c,d,A,r,y,b,x=this.w,B=x.globals.dataPoints;this.barCtx.isRangeBar&&(B=x.globals.labels.length);var T=this.barCtx.seriesLen;if(x.config.plotOptions.bar.rangeBarGroupRows&&(T=1),this.barCtx.isHorizontal)A=(c=x.globals.gridHeight/B)/T,x.globals.isXNumeric&&(A=(c=x.globals.gridHeight/this.barCtx.totalItems)/this.barCtx.seriesLen),A=A*parseInt(this.barCtx.barOptions.barHeight,10)/100,String(this.barCtx.barOptions.barHeight).indexOf("%")===-1&&(A=parseInt(this.barCtx.barOptions.barHeight,10)),b=this.barCtx.baseLineInvertedY+x.globals.padHorizontal+(this.barCtx.isReversed?x.globals.gridWidth:0)-(this.barCtx.isReversed?2*this.barCtx.baseLineInvertedY:0),this.barCtx.isFunnel&&(b=x.globals.gridWidth/2),s=(c-A*this.barCtx.seriesLen)/2;else{if(d=x.globals.gridWidth/this.barCtx.visibleItems,x.config.xaxis.convertedCatToNumeric&&(d=x.globals.gridWidth/x.globals.dataPoints),r=d/T*parseInt(this.barCtx.barOptions.columnWidth,10)/100,x.globals.isXNumeric){var E=this.barCtx.xRatio;x.globals.minXDiff&&x.globals.minXDiff!==.5&&x.globals.minXDiff/E>0&&(d=x.globals.minXDiff/E),(r=d/T*parseInt(this.barCtx.barOptions.columnWidth,10)/100)<1&&(r=1)}String(this.barCtx.barOptions.columnWidth).indexOf("%")===-1&&(r=parseInt(this.barCtx.barOptions.columnWidth,10)),y=x.globals.gridHeight-this.barCtx.baseLineY[this.barCtx.translationsIndex]-(this.barCtx.isReversed?x.globals.gridHeight:0)+(this.barCtx.isReversed?2*this.barCtx.baseLineY[this.barCtx.translationsIndex]:0),x.globals.isXNumeric?i=this.barCtx.getBarXForNumericXAxis({x:i,j:0,realIndex:e,barWidth:r}).x:i=x.globals.padHorizontal+ni.noExponents(d-r*this.barCtx.seriesLen)/2}return x.globals.barHeight=A,x.globals.barWidth=r,{x:i,y:s,yDivision:c,xDivision:d,barHeight:A,barWidth:r,zeroH:y,zeroW:b}}},{key:"initializeStackedPrevVars",value:function(e){e.w.globals.seriesGroups.forEach(function(i){e[i]||(e[i]={}),e[i].prevY=[],e[i].prevX=[],e[i].prevYF=[],e[i].prevXF=[],e[i].prevYVal=[],e[i].prevXVal=[]})}},{key:"initializeStackedXYVars",value:function(e){e.w.globals.seriesGroups.forEach(function(i){e[i]||(e[i]={}),e[i].xArrj=[],e[i].xArrjF=[],e[i].xArrjVal=[],e[i].yArrj=[],e[i].yArrjF=[],e[i].yArrjVal=[]})}},{key:"getPathFillColor",value:function(e,i,s,c){var d,A,r,y,b=this.w,x=this.barCtx.ctx.fill,B=null,T=this.barCtx.barOptions.distributed?s:i,E=!1;return this.barCtx.barOptions.colors.ranges.length>0&&this.barCtx.barOptions.colors.ranges.map(function(R){e[i][s]>=R.from&&e[i][s]<=R.to&&(B=R.color,E=!0)}),{color:x.fillPath({seriesNumber:this.barCtx.barOptions.distributed?T:c,dataPointIndex:s,color:B,value:e[i][s],fillConfig:(d=b.config.series[i].data[s])===null||d===void 0?void 0:d.fill,fillType:(A=b.config.series[i].data[s])!==null&&A!==void 0&&(r=A.fill)!==null&&r!==void 0&&r.type?(y=b.config.series[i].data[s])===null||y===void 0?void 0:y.fill.type:Array.isArray(b.config.fill.type)?b.config.fill.type[c]:b.config.fill.type}),useRangeColor:E}}},{key:"getStrokeWidth",value:function(e,i,s){var c=0,d=this.w;return this.barCtx.series[e][i]===void 0||this.barCtx.series[e][i]===null?this.barCtx.isNullValue=!0:this.barCtx.isNullValue=!1,d.config.stroke.show&&(this.barCtx.isNullValue||(c=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[s]:this.barCtx.strokeWidth)),c}},{key:"createBorderRadiusArr",value:function(e){var i,s=this.w,c=!this.w.config.chart.stacked||s.config.plotOptions.bar.borderRadius<=0,d=e.length,A=0|((i=e[0])===null||i===void 0?void 0:i.length),r=Array.from({length:d},function(){return Array(A).fill(c?"top":"none")});if(c)return r;for(var y=0;y<A;y++){for(var b=[],x=[],B=0,T=0;T<d;T++){var E=e[T][y];E>0?(b.push(T),B++):E<0&&(x.push(T),B++)}if(b.length>0&&x.length===0)if(b.length===1)r[b[0]][y]="both";else{var R,P=b[0],G=b[b.length-1],U=ly(b);try{for(U.s();!(R=U.n()).done;){var Q=R.value;r[Q][y]=Q===P?"bottom":Q===G?"top":"none"}}catch(De){U.e(De)}finally{U.f()}}else if(x.length>0&&b.length===0)if(x.length===1)r[x[0]][y]="both";else{var q,ne=Math.max.apply(Math,x),re=Math.min.apply(Math,x),pe=ly(x);try{for(pe.s();!(q=pe.n()).done;){var fe=q.value;r[fe][y]=fe===ne?"bottom":fe===re?"top":"none"}}catch(De){pe.e(De)}finally{pe.f()}}else if(b.length>0&&x.length>0){var he,be=b[b.length-1],Se=ly(b);try{for(Se.s();!(he=Se.n()).done;){var oe=he.value;r[oe][y]=oe===be?"top":"none"}}catch(De){Se.e(De)}finally{Se.f()}var ye,Me=Math.max.apply(Math,x),Be=ly(x);try{for(Be.s();!(ye=Be.n()).done;){var Pe=ye.value;r[Pe][y]=Pe===Me?"bottom":"none"}}catch(De){Be.e(De)}finally{Be.f()}}else B===1&&(r[b[0]||x[0]][y]="both")}return r}},{key:"barBackground",value:function(e){var i=e.j,s=e.i,c=e.x1,d=e.x2,A=e.y1,r=e.y2,y=e.elSeries,b=this.w,x=new ur(this.barCtx.ctx),B=new od(this.barCtx.ctx).getActiveConfigSeriesIndex();if(this.barCtx.barOptions.colors.backgroundBarColors.length>0&&B===s){i>=this.barCtx.barOptions.colors.backgroundBarColors.length&&(i%=this.barCtx.barOptions.colors.backgroundBarColors.length);var T=this.barCtx.barOptions.colors.backgroundBarColors[i],E=x.drawRect(c!==void 0?c:0,A!==void 0?A:0,d!==void 0?d:b.globals.gridWidth,r!==void 0?r:b.globals.gridHeight,this.barCtx.barOptions.colors.backgroundBarRadius,T,this.barCtx.barOptions.colors.backgroundBarOpacity);y.add(E),E.node.classList.add("apexcharts-backgroundBar")}}},{key:"getColumnPaths",value:function(e){var i,s=e.barWidth,c=e.barXPosition,d=e.y1,A=e.y2,r=e.strokeWidth,y=e.isReversed,b=e.series,x=e.seriesGroup,B=e.realIndex,T=e.i,E=e.j,R=e.w,P=new ur(this.barCtx.ctx);(r=Array.isArray(r)?r[B]:r)||(r=0);var G=s,U=c;(i=R.config.series[B].data[E])!==null&&i!==void 0&&i.columnWidthOffset&&(U=c-R.config.series[B].data[E].columnWidthOffset/2,G=s+R.config.series[B].data[E].columnWidthOffset);var Q=r/2,q=U+Q,ne=U+G-Q,re=(b[T][E]>=0?1:-1)*(y?-1:1);d+=.001-Q*re,A+=.001+Q*re;var pe=P.move(q,d),fe=P.move(q,d),he=P.line(ne,d);if(R.globals.previousPaths.length>0&&(fe=this.barCtx.getPreviousPath(B,E,!1)),pe=pe+P.line(q,A)+P.line(ne,A)+he+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),fe=fe+P.line(q,d)+he+he+he+he+he+P.line(q,d)+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),this.arrBorderRadius[B][E]!=="none"&&(pe=P.roundPathCorners(pe,R.config.plotOptions.bar.borderRadius)),R.config.chart.stacked){var be=this.barCtx;(be=this.barCtx[x]).yArrj.push(A-Q*re),be.yArrjF.push(Math.abs(d-A+r*re)),be.yArrjVal.push(this.barCtx.series[T][E])}return{pathTo:pe,pathFrom:fe}}},{key:"getBarpaths",value:function(e){var i,s=e.barYPosition,c=e.barHeight,d=e.x1,A=e.x2,r=e.strokeWidth,y=e.isReversed,b=e.series,x=e.seriesGroup,B=e.realIndex,T=e.i,E=e.j,R=e.w,P=new ur(this.barCtx.ctx);(r=Array.isArray(r)?r[B]:r)||(r=0);var G=s,U=c;(i=R.config.series[B].data[E])!==null&&i!==void 0&&i.barHeightOffset&&(G=s-R.config.series[B].data[E].barHeightOffset/2,U=c+R.config.series[B].data[E].barHeightOffset);var Q=r/2,q=G+Q,ne=G+U-Q,re=(b[T][E]>=0?1:-1)*(y?-1:1);d+=.001+Q*re,A+=.001-Q*re;var pe=P.move(d,q),fe=P.move(d,q);R.globals.previousPaths.length>0&&(fe=this.barCtx.getPreviousPath(B,E,!1));var he=P.line(d,ne);if(pe=pe+P.line(A,q)+P.line(A,ne)+he+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),fe=fe+P.line(d,q)+he+he+he+he+he+P.line(d,q)+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),this.arrBorderRadius[B][E]!=="none"&&(pe=P.roundPathCorners(pe,R.config.plotOptions.bar.borderRadius)),R.config.chart.stacked){var be=this.barCtx;(be=this.barCtx[x]).xArrj.push(A+Q*re),be.xArrjF.push(Math.abs(d-A-r*re)),be.xArrjVal.push(this.barCtx.series[T][E])}return{pathTo:pe,pathFrom:fe}}},{key:"checkZeroSeries",value:function(e){for(var i=e.series,s=this.w,c=0;c<i.length;c++){for(var d=0,A=0;A<i[s.globals.maxValsInArrayIndex].length;A++)d+=i[c][A];d===0&&this.barCtx.zeroSerieses.push(c)}}},{key:"getXForValue",value:function(e,i){var s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2]?i:null;return e!=null&&(s=i+e/this.barCtx.invertedYRatio-2*(this.barCtx.isReversed?e/this.barCtx.invertedYRatio:0)),s}},{key:"getYForValue",value:function(e,i,s){var c=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3]?i:null;return e!=null&&(c=i-e/this.barCtx.yRatio[s]+2*(this.barCtx.isReversed?e/this.barCtx.yRatio[s]:0)),c}},{key:"getGoalValues",value:function(e,i,s,c,d,A){var r=this,y=this.w,b=[],x=function(E,R){var P;b.push((Rv(P={},e,e==="x"?r.getXForValue(E,i,!1):r.getYForValue(E,s,A,!1)),Rv(P,"attrs",R),P))};if(y.globals.seriesGoals[c]&&y.globals.seriesGoals[c][d]&&Array.isArray(y.globals.seriesGoals[c][d])&&y.globals.seriesGoals[c][d].forEach(function(E){x(E.value,E)}),this.barCtx.barOptions.isDumbbell&&y.globals.seriesRange.length){var B=this.barCtx.barOptions.dumbbellColors?this.barCtx.barOptions.dumbbellColors:y.globals.colors,T={strokeHeight:e==="x"?0:y.globals.markers.size[c],strokeWidth:e==="x"?y.globals.markers.size[c]:0,strokeDashArray:0,strokeLineCap:"round",strokeColor:Array.isArray(B[c])?B[c][0]:B[c]};x(y.globals.seriesRangeStart[c][d],T),x(y.globals.seriesRangeEnd[c][d],Tr(Tr({},T),{},{strokeColor:Array.isArray(B[c])?B[c][1]:B[c]}))}return b}},{key:"drawGoalLine",value:function(e){var i=e.barXPosition,s=e.barYPosition,c=e.goalX,d=e.goalY,A=e.barWidth,r=e.barHeight,y=new ur(this.barCtx.ctx),b=y.group({className:"apexcharts-bar-goals-groups"});b.node.classList.add("apexcharts-element-hidden"),this.barCtx.w.globals.delayedElements.push({el:b.node}),b.attr("clip-path","url(#gridRectMarkerMask".concat(this.barCtx.w.globals.cuid,")"));var x=null;return this.barCtx.isHorizontal?Array.isArray(c)&&c.forEach(function(B){if(B.x>=-1&&B.x<=y.w.globals.gridWidth+1){var T=B.attrs.strokeHeight!==void 0?B.attrs.strokeHeight:r/2,E=s+T+r/2;x=y.drawLine(B.x,E-2*T,B.x,E,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeWidth?B.attrs.strokeWidth:2,B.attrs.strokeLineCap),b.add(x)}}):Array.isArray(d)&&d.forEach(function(B){if(B.y>=-1&&B.y<=y.w.globals.gridHeight+1){var T=B.attrs.strokeWidth!==void 0?B.attrs.strokeWidth:A/2,E=i+T+A/2;x=y.drawLine(E-2*T,B.y,E,B.y,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeHeight?B.attrs.strokeHeight:2,B.attrs.strokeLineCap),b.add(x)}}),b}},{key:"drawBarShadow",value:function(e){var i=e.prevPaths,s=e.currPaths,c=e.color,d=this.w,A=i.x,r=i.x1,y=i.barYPosition,b=s.x,x=s.x1,B=s.barYPosition,T=y+s.barHeight,E=new ur(this.barCtx.ctx),R=new ni,P=E.move(r,T)+E.line(A,T)+E.line(b,B)+E.line(x,B)+E.line(r,T)+(d.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[realIndex][j]==="both"?" Z":" z");return E.drawPath({d:P,fill:R.shadeColor(.5,ni.rgb2hex(c)),stroke:"none",strokeWidth:0,fillOpacity:1,classes:"apexcharts-bar-shadow apexcharts-decoration-element"})}},{key:"getZeroValueEncounters",value:function(e){var i,s=e.i,c=e.j,d=this.w,A=0,r=0;return(d.config.plotOptions.bar.horizontal?d.globals.series.map(function(y,b){return b}):((i=d.globals.columnSeries)===null||i===void 0?void 0:i.i.map(function(y){return y}))||[]).forEach(function(y){var b=d.globals.seriesPercent[y][c];b&&A++,y<s&&b===0&&r++}),{nonZeroColumns:A,zeroEncounters:r}}},{key:"getGroupIndex",value:function(e){var i=this.w,s=i.globals.seriesGroups.findIndex(function(A){return A.indexOf(i.globals.seriesNames[e])>-1}),c=this.barCtx.columnGroupIndices,d=c.indexOf(s);return d<0&&(c.push(s),d=c.length-1),{groupIndex:s,columnGroupIndex:d}}}]),a}(),lm=function(){function a(e,i){en(this,a),this.ctx=e,this.w=e.w;var s=this.w;this.barOptions=s.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=s.config.stroke.width,this.isNullValue=!1,this.isRangeBar=s.globals.seriesRange.length&&this.isHorizontal,this.isVerticalGroupedRangeBar=!s.globals.isBarHorizontal&&s.globals.seriesRange.length&&s.config.plotOptions.bar.rangeBarGroupRows,this.isFunnel=this.barOptions.isFunnel,this.xyRatios=i,this.xyRatios!==null&&(this.xRatio=i.xRatio,this.yRatio=i.yRatio,this.invertedXRatio=i.invertedXRatio,this.invertedYRatio=i.invertedYRatio,this.baseLineY=i.baseLineY,this.baseLineInvertedY=i.baseLineInvertedY),this.yaxisIndex=0,this.translationsIndex=0,this.seriesLen=0,this.pathArr=[];var c=new od(this.ctx);this.lastActiveBarSerieIndex=c.getActiveConfigSeriesIndex("desc",["bar","column"]),this.columnGroupIndices=[];var d=c.getBarSeriesIndices(),A=new nl(this.ctx);this.stackedSeriesTotals=A.getStackedSeriesTotals(this.w.config.series.map(function(r,y){return d.indexOf(y)===-1?y:-1}).filter(function(r){return r!==-1})),this.barHelpers=new sD(this)}return tn(a,[{key:"draw",value:function(e,i){var s=this.w,c=new ur(this.ctx),d=new nl(this.ctx,s);e=d.getLogSeries(e),this.series=e,this.yRatio=d.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e);var A=c.group({class:"apexcharts-bar-series apexcharts-plot-series"});s.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering - ApexCharts");for(var r=0,y=0;r<e.length;r++,y++){var b,x,B,T,E=void 0,R=void 0,P=[],G=[],U=s.globals.comboCharts?i[r]:r,Q=this.barHelpers.getGroupIndex(U).columnGroupIndex,q=c.group({class:"apexcharts-series",rel:r+1,seriesName:ni.escapeString(s.globals.seriesNames[U]),"data:realIndex":U});this.ctx.series.addCollapsedClassToSeries(q,U),e[r].length>0&&(this.visibleI=this.visibleI+1);var ne=0,re=0;this.yRatio.length>1&&(this.yaxisIndex=s.globals.seriesYAxisReverseMap[U],this.translationsIndex=U);var pe=this.translationsIndex;this.isReversed=s.config.yaxis[this.yaxisIndex]&&s.config.yaxis[this.yaxisIndex].reversed;var fe=this.barHelpers.initialPositions(U);R=fe.y,ne=fe.barHeight,x=fe.yDivision,T=fe.zeroW,E=fe.x,re=fe.barWidth,b=fe.xDivision,B=fe.zeroH,this.isHorizontal||G.push(E+re/2);var he=c.group({class:"apexcharts-datalabels","data:realIndex":U});s.globals.delayedElements.push({el:he.node}),he.node.classList.add("apexcharts-element-hidden");var be=c.group({class:"apexcharts-bar-goals-markers"}),Se=c.group({class:"apexcharts-bar-shadows"});s.globals.delayedElements.push({el:Se.node}),Se.node.classList.add("apexcharts-element-hidden");for(var oe=0;oe<e[r].length;oe++){var ye=this.barHelpers.getStrokeWidth(r,oe,U),Me=null,Be={indexes:{i:r,j:oe,realIndex:U,translationsIndex:pe,bc:y},x:E,y:R,strokeWidth:ye,elSeries:q};this.isHorizontal?(Me=this.drawBarPaths(Tr(Tr({},Be),{},{barHeight:ne,zeroW:T,yDivision:x})),re=this.series[r][oe]/this.invertedYRatio):(Me=this.drawColumnPaths(Tr(Tr({},Be),{},{xDivision:b,barWidth:re,zeroH:B})),ne=this.series[r][oe]/this.yRatio[pe]);var Pe=this.barHelpers.getPathFillColor(e,r,oe,U);if(this.isFunnel&&this.barOptions.isFunnel3d&&this.pathArr.length&&oe>0){var De,et=this.barHelpers.drawBarShadow({color:typeof Pe.color=="string"&&((De=Pe.color)===null||De===void 0?void 0:De.indexOf("url"))===-1?Pe.color:ni.hexToRgba(s.globals.colors[r]),prevPaths:this.pathArr[this.pathArr.length-1],currPaths:Me});Se.add(et),s.config.chart.dropShadow.enabled&&new Rc(this.ctx).dropShadow(et,s.config.chart.dropShadow,U)}this.pathArr.push(Me);var Ye=this.barHelpers.drawGoalLine({barXPosition:Me.barXPosition,barYPosition:Me.barYPosition,goalX:Me.goalX,goalY:Me.goalY,barHeight:ne,barWidth:re});Ye&&be.add(Ye),R=Me.y,E=Me.x,oe>0&&G.push(E+re/2),P.push(R),this.renderSeries(Tr(Tr({realIndex:U,pathFill:Pe.color},Pe.useRangeColor?{lineFill:Pe.color}:{}),{},{j:oe,i:r,columnGroupIndex:Q,pathFrom:Me.pathFrom,pathTo:Me.pathTo,strokeWidth:ye,elSeries:q,x:E,y:R,series:e,barHeight:Math.abs(Me.barHeight?Me.barHeight:ne),barWidth:Math.abs(Me.barWidth?Me.barWidth:re),elDataLabelsWrap:he,elGoalsMarkers:be,elBarShadows:Se,visibleSeries:this.visibleI,type:"bar"}))}s.globals.seriesXvalues[U]=G,s.globals.seriesYvalues[U]=P,A.add(q)}return A}},{key:"renderSeries",value:function(e){var i=e.realIndex,s=e.pathFill,c=e.lineFill,d=e.j,A=e.i,r=e.columnGroupIndex,y=e.pathFrom,b=e.pathTo,x=e.strokeWidth,B=e.elSeries,T=e.x,E=e.y,R=e.y1,P=e.y2,G=e.series,U=e.barHeight,Q=e.barWidth,q=e.barXPosition,ne=e.barYPosition,re=e.elDataLabelsWrap,pe=e.elGoalsMarkers,fe=e.elBarShadows,he=e.visibleSeries,be=e.type,Se=e.classes,oe=this.w,ye=new ur(this.ctx),Me=!1;if(!c){var Be=typeof oe.globals.stroke.colors[i]=="function"?function(bt){var pt,Qt=oe.config.stroke.colors;return Array.isArray(Qt)&&Qt.length>0&&((pt=Qt[bt])||(pt=""),typeof pt=="function")?pt({value:oe.globals.series[bt][d],dataPointIndex:d,w:oe}):pt}(i):oe.globals.stroke.colors[i];c=this.barOptions.distributed?oe.globals.stroke.colors[d]:Be}var Pe=new nD(this).handleBarDataLabels({x:T,y:E,y1:R,y2:P,i:A,j:d,series:G,realIndex:i,columnGroupIndex:r,barHeight:U,barWidth:Q,barXPosition:q,barYPosition:ne,visibleSeries:he});oe.globals.isBarHorizontal||(Pe.dataLabelsPos.dataLabelsX+Q<0||Pe.dataLabelsPos.dataLabelsX-Q>oe.globals.gridWidth)&&(Me=!0),oe.config.series[A].data[d]&&oe.config.series[A].data[d].strokeColor&&(c=oe.config.series[A].data[d].strokeColor),this.isNullValue&&(s="none");var De=d/oe.config.chart.animations.animateGradually.delay*(oe.config.chart.animations.speed/oe.globals.dataPoints)/2.4;if(!Me){var et=ye.renderPaths({i:A,j:d,realIndex:i,pathFrom:y,pathTo:b,stroke:c,strokeWidth:x,strokeLineCap:oe.config.stroke.lineCap,fill:s,animationDelay:De,initialSpeed:oe.config.chart.animations.speed,dataChangeSpeed:oe.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(be,"-area ").concat(Se),chartType:be});et.attr("clip-path","url(#gridRectBarMask".concat(oe.globals.cuid,")"));var Ye=oe.config.forecastDataPoints;Ye.count>0&&d>=oe.globals.dataPoints-Ye.count&&(et.node.setAttribute("stroke-dasharray",Ye.dashArray),et.node.setAttribute("stroke-width",Ye.strokeWidth),et.node.setAttribute("fill-opacity",Ye.fillOpacity)),R!==void 0&&P!==void 0&&(et.attr("data-range-y1",R),et.attr("data-range-y2",P)),new Rc(this.ctx).setSelectionFilter(et,i,d),B.add(et),et.attr({cy:Pe.dataLabelsPos.bcy,cx:Pe.dataLabelsPos.bcx,j:d,val:oe.globals.series[A][d],barHeight:U,barWidth:Q}),Pe.dataLabels!==null&&re.add(Pe.dataLabels),Pe.totalDataLabels&&re.add(Pe.totalDataLabels),B.add(re),pe&&B.add(pe),fe&&B.add(fe)}return B}},{key:"drawBarPaths",value:function(e){var i,s=e.indexes,c=e.barHeight,d=e.strokeWidth,A=e.zeroW,r=e.x,y=e.y,b=e.yDivision,x=e.elSeries,B=this.w,T=s.i,E=s.j;if(B.globals.isXNumeric)i=(y=(B.globals.seriesX[T][E]-B.globals.minX)/this.invertedXRatio-c)+c*this.visibleI;else if(B.config.plotOptions.bar.hideZeroBarsWhenGrouped){var R=this.barHelpers.getZeroValueEncounters({i:T,j:E}),P=R.nonZeroColumns,G=R.zeroEncounters;P>0&&(c=this.seriesLen*c/P),i=y+c*this.visibleI,i-=c*G}else i=y+c*this.visibleI;this.isFunnel&&(A-=(this.barHelpers.getXForValue(this.series[T][E],A)-A)/2),r=this.barHelpers.getXForValue(this.series[T][E],A);var U=this.barHelpers.getBarpaths({barYPosition:i,barHeight:c,x1:A,x2:r,strokeWidth:d,isReversed:this.isReversed,series:this.series,realIndex:s.realIndex,i:T,j:E,w:B});return B.globals.isXNumeric||(y+=b),this.barHelpers.barBackground({j:E,i:T,y1:i-c*this.visibleI,y2:c*this.seriesLen,elSeries:x}),{pathTo:U.pathTo,pathFrom:U.pathFrom,x1:A,x:r,y,goalX:this.barHelpers.getGoalValues("x",A,null,T,E),barYPosition:i,barHeight:c}}},{key:"drawColumnPaths",value:function(e){var i,s=e.indexes,c=e.x,d=e.y,A=e.xDivision,r=e.barWidth,y=e.zeroH,b=e.strokeWidth,x=e.elSeries,B=this.w,T=s.realIndex,E=s.translationsIndex,R=s.i,P=s.j,G=s.bc;if(B.globals.isXNumeric){var U=this.getBarXForNumericXAxis({x:c,j:P,realIndex:T,barWidth:r});c=U.x,i=U.barXPosition}else if(B.config.plotOptions.bar.hideZeroBarsWhenGrouped){var Q=this.barHelpers.getZeroValueEncounters({i:R,j:P}),q=Q.nonZeroColumns,ne=Q.zeroEncounters;q>0&&(r=this.seriesLen*r/q),i=c+r*this.visibleI,i-=r*ne}else i=c+r*this.visibleI;d=this.barHelpers.getYForValue(this.series[R][P],y,E);var re=this.barHelpers.getColumnPaths({barXPosition:i,barWidth:r,y1:y,y2:d,strokeWidth:b,isReversed:this.isReversed,series:this.series,realIndex:T,i:R,j:P,w:B});return B.globals.isXNumeric||(c+=A),this.barHelpers.barBackground({bc:G,j:P,i:R,x1:i-b/2-r*this.visibleI,x2:r*this.seriesLen+b/2,elSeries:x}),{pathTo:re.pathTo,pathFrom:re.pathFrom,x:c,y:d,goalY:this.barHelpers.getGoalValues("y",null,y,R,P,E),barXPosition:i,barWidth:r}}},{key:"getBarXForNumericXAxis",value:function(e){var i=e.x,s=e.barWidth,c=e.realIndex,d=e.j,A=this.w,r=c;return A.globals.seriesX[c].length||(r=A.globals.maxValsInArrayIndex),ni.isNumber(A.globals.seriesX[r][d])&&(i=(A.globals.seriesX[r][d]-A.globals.minX)/this.xRatio-s*this.seriesLen/2),{barXPosition:i+s*this.visibleI,x:i}}},{key:"getPreviousPath",value:function(e,i){for(var s=this.w,c="M 0 0",d=0;d<s.globals.previousPaths.length;d++){var A=s.globals.previousPaths[d];A.paths&&A.paths.length>0&&parseInt(A.realIndex,10)===parseInt(e,10)&&s.globals.previousPaths[d].paths[i]!==void 0&&(c=s.globals.previousPaths[d].paths[i].d)}return c}}]),a}(),tE=function(a){Yy(i,lm);var e=Xy(i);function i(){return en(this,i),e.apply(this,arguments)}return tn(i,[{key:"draw",value:function(s,c){var d=this,A=this.w;this.graphics=new ur(this.ctx),this.bar=new lm(this.ctx,this.xyRatios);var r=new nl(this.ctx,A);s=r.getLogSeries(s),this.yRatio=r.getLogYRatios(this.yRatio),this.barHelpers.initVariables(s),A.config.chart.stackType==="100%"&&(s=A.globals.comboCharts?c.map(function(R){return A.globals.seriesPercent[R]}):A.globals.seriesPercent.slice()),this.series=s,this.barHelpers.initializeStackedPrevVars(this);for(var y=this.graphics.group({class:"apexcharts-bar-series apexcharts-plot-series"}),b=0,x=0,B=function(R,P){var G=void 0,U=void 0,Q=void 0,q=void 0,ne=A.globals.comboCharts?c[R]:R,re=d.barHelpers.getGroupIndex(ne),pe=re.groupIndex,fe=re.columnGroupIndex;d.groupCtx=d[A.globals.seriesGroups[pe]];var he=[],be=[],Se=0;d.yRatio.length>1&&(d.yaxisIndex=A.globals.seriesYAxisReverseMap[ne][0],Se=ne),d.isReversed=A.config.yaxis[d.yaxisIndex]&&A.config.yaxis[d.yaxisIndex].reversed;var oe=d.graphics.group({class:"apexcharts-series",seriesName:ni.escapeString(A.globals.seriesNames[ne]),rel:R+1,"data:realIndex":ne});d.ctx.series.addCollapsedClassToSeries(oe,ne);var ye=d.graphics.group({class:"apexcharts-datalabels","data:realIndex":ne}),Me=d.graphics.group({class:"apexcharts-bar-goals-markers"}),Be=0,Pe=0,De=d.initialPositions(b,x,G,U,Q,q,Se);x=De.y,Be=De.barHeight,U=De.yDivision,q=De.zeroW,b=De.x,Pe=De.barWidth,G=De.xDivision,Q=De.zeroH,A.globals.barHeight=Be,A.globals.barWidth=Pe,d.barHelpers.initializeStackedXYVars(d),d.groupCtx.prevY.length===1&&d.groupCtx.prevY[0].every(function(mt){return isNaN(mt)})&&(d.groupCtx.prevY[0]=d.groupCtx.prevY[0].map(function(){return Q}),d.groupCtx.prevYF[0]=d.groupCtx.prevYF[0].map(function(){return 0}));for(var et=0;et<A.globals.dataPoints;et++){var Ye=d.barHelpers.getStrokeWidth(R,et,ne),bt={indexes:{i:R,j:et,realIndex:ne,translationsIndex:Se,bc:P},strokeWidth:Ye,x:b,y:x,elSeries:oe,columnGroupIndex:fe,seriesGroup:A.globals.seriesGroups[pe]},pt=null;d.isHorizontal?(pt=d.drawStackedBarPaths(Tr(Tr({},bt),{},{zeroW:q,barHeight:Be,yDivision:U})),Pe=d.series[R][et]/d.invertedYRatio):(pt=d.drawStackedColumnPaths(Tr(Tr({},bt),{},{xDivision:G,barWidth:Pe,zeroH:Q})),Be=d.series[R][et]/d.yRatio[Se]);var Qt=d.barHelpers.drawGoalLine({barXPosition:pt.barXPosition,barYPosition:pt.barYPosition,goalX:pt.goalX,goalY:pt.goalY,barHeight:Be,barWidth:Pe});Qt&&Me.add(Qt),x=pt.y,b=pt.x,he.push(b),be.push(x);var Ie=d.barHelpers.getPathFillColor(s,R,et,ne),ot="",ut=A.globals.isBarHorizontal?"apexcharts-flip-x":"apexcharts-flip-y";(d.barHelpers.arrBorderRadius[ne][et]==="bottom"&&A.globals.series[ne][et]>0||d.barHelpers.arrBorderRadius[ne][et]==="top"&&A.globals.series[ne][et]<0)&&(ot=ut),oe=d.renderSeries(Tr(Tr({realIndex:ne,pathFill:Ie.color},Ie.useRangeColor?{lineFill:Ie.color}:{}),{},{j:et,i:R,columnGroupIndex:fe,pathFrom:pt.pathFrom,pathTo:pt.pathTo,strokeWidth:Ye,elSeries:oe,x:b,y:x,series:s,barHeight:Be,barWidth:Pe,elDataLabelsWrap:ye,elGoalsMarkers:Me,type:"bar",visibleSeries:fe,classes:ot}))}A.globals.seriesXvalues[ne]=he,A.globals.seriesYvalues[ne]=be,d.groupCtx.prevY.push(d.groupCtx.yArrj),d.groupCtx.prevYF.push(d.groupCtx.yArrjF),d.groupCtx.prevYVal.push(d.groupCtx.yArrjVal),d.groupCtx.prevX.push(d.groupCtx.xArrj),d.groupCtx.prevXF.push(d.groupCtx.xArrjF),d.groupCtx.prevXVal.push(d.groupCtx.xArrjVal),y.add(oe)},T=0,E=0;T<s.length;T++,E++)B(T,E);return y}},{key:"initialPositions",value:function(s,c,d,A,r,y,b){var x,B,T=this.w;if(this.isHorizontal){A=T.globals.gridHeight/T.globals.dataPoints;var E=T.config.plotOptions.bar.barHeight;x=String(E).indexOf("%")===-1?parseInt(E,10):A*parseInt(E,10)/100,y=T.globals.padHorizontal+(this.isReversed?T.globals.gridWidth-this.baseLineInvertedY:this.baseLineInvertedY),c=(A-x)/2}else{B=d=T.globals.gridWidth/T.globals.dataPoints;var R=T.config.plotOptions.bar.columnWidth;T.globals.isXNumeric&&T.globals.dataPoints>1?B=(d=T.globals.minXDiff/this.xRatio)*parseInt(this.barOptions.columnWidth,10)/100:String(R).indexOf("%")===-1?B=parseInt(R,10):B*=parseInt(R,10)/100,r=this.isReversed?this.baseLineY[b]:T.globals.gridHeight-this.baseLineY[b],s=T.globals.padHorizontal+(d-B)/2}var P=T.globals.barGroups.length||1;return{x:s,y:c,yDivision:A,xDivision:d,barHeight:x/P,barWidth:B/P,zeroH:r,zeroW:y}}},{key:"drawStackedBarPaths",value:function(s){for(var c,d=s.indexes,A=s.barHeight,r=s.strokeWidth,y=s.zeroW,b=s.x,x=s.y,B=s.columnGroupIndex,T=s.seriesGroup,E=s.yDivision,R=s.elSeries,P=this.w,G=x+B*A,U=d.i,Q=d.j,q=d.realIndex,ne=d.translationsIndex,re=0,pe=0;pe<this.groupCtx.prevXF.length;pe++)re+=this.groupCtx.prevXF[pe][Q];var fe=U;if(P.config.series[q].name&&(fe=T.indexOf(P.config.series[q].name)),fe>0){var he=y;this.groupCtx.prevXVal[fe-1][Q]<0?he=this.series[U][Q]>=0?this.groupCtx.prevX[fe-1][Q]+re-2*(this.isReversed?re:0):this.groupCtx.prevX[fe-1][Q]:this.groupCtx.prevXVal[fe-1][Q]>=0&&(he=this.series[U][Q]>=0?this.groupCtx.prevX[fe-1][Q]:this.groupCtx.prevX[fe-1][Q]-re+2*(this.isReversed?re:0)),c=he}else c=y;b=this.series[U][Q]===null?c:c+this.series[U][Q]/this.invertedYRatio-2*(this.isReversed?this.series[U][Q]/this.invertedYRatio:0);var be=this.barHelpers.getBarpaths({barYPosition:G,barHeight:A,x1:c,x2:b,strokeWidth:r,isReversed:this.isReversed,series:this.series,realIndex:d.realIndex,seriesGroup:T,i:U,j:Q,w:P});return this.barHelpers.barBackground({j:Q,i:U,y1:G,y2:A,elSeries:R}),x+=E,{pathTo:be.pathTo,pathFrom:be.pathFrom,goalX:this.barHelpers.getGoalValues("x",y,null,U,Q,ne),barXPosition:c,barYPosition:G,x:b,y:x}}},{key:"drawStackedColumnPaths",value:function(s){var c=s.indexes,d=s.x,A=s.y,r=s.xDivision,y=s.barWidth,b=s.zeroH,x=s.columnGroupIndex,B=s.seriesGroup,T=s.elSeries,E=this.w,R=c.i,P=c.j,G=c.bc,U=c.realIndex,Q=c.translationsIndex;if(E.globals.isXNumeric){var q=E.globals.seriesX[U][P];q||(q=0),d=(q-E.globals.minX)/this.xRatio-y/2*E.globals.barGroups.length}for(var ne,re=d+x*y,pe=0,fe=0;fe<this.groupCtx.prevYF.length;fe++)pe+=isNaN(this.groupCtx.prevYF[fe][P])?0:this.groupCtx.prevYF[fe][P];var he=R;if(B&&(he=B.indexOf(E.globals.seriesNames[U])),he>0&&!E.globals.isXNumeric||he>0&&E.globals.isXNumeric&&E.globals.seriesX[U-1][P]===E.globals.seriesX[U][P]){var be,Se,oe,ye=Math.min(this.yRatio.length+1,U+1);if(this.groupCtx.prevY[he-1]!==void 0&&this.groupCtx.prevY[he-1].length)for(var Me=1;Me<ye;Me++){var Be;if(!isNaN((Be=this.groupCtx.prevY[he-Me])===null||Be===void 0?void 0:Be[P])){oe=this.groupCtx.prevY[he-Me][P];break}}for(var Pe=1;Pe<ye;Pe++){var De,et;if(((De=this.groupCtx.prevYVal[he-Pe])===null||De===void 0?void 0:De[P])<0){Se=this.series[R][P]>=0?oe-pe+2*(this.isReversed?pe:0):oe;break}if(((et=this.groupCtx.prevYVal[he-Pe])===null||et===void 0?void 0:et[P])>=0){Se=this.series[R][P]>=0?oe:oe+pe-2*(this.isReversed?pe:0);break}}Se===void 0&&(Se=E.globals.gridHeight),ne=(be=this.groupCtx.prevYF[0])!==null&&be!==void 0&&be.every(function(bt){return bt===0})&&this.groupCtx.prevYF.slice(1,he).every(function(bt){return bt.every(function(pt){return isNaN(pt)})})?b:Se}else ne=b;A=this.series[R][P]?ne-this.series[R][P]/this.yRatio[Q]+2*(this.isReversed?this.series[R][P]/this.yRatio[Q]:0):ne;var Ye=this.barHelpers.getColumnPaths({barXPosition:re,barWidth:y,y1:ne,y2:A,yRatio:this.yRatio[Q],strokeWidth:this.strokeWidth,isReversed:this.isReversed,series:this.series,seriesGroup:B,realIndex:c.realIndex,i:R,j:P,w:E});return this.barHelpers.barBackground({bc:G,j:P,i:R,x1:re,x2:y,elSeries:T}),{pathTo:Ye.pathTo,pathFrom:Ye.pathFrom,goalY:this.barHelpers.getGoalValues("y",null,b,R,P),barXPosition:re,x:E.globals.isXNumeric?d:d+r,y:A}}}]),i}(),ob=function(a){Yy(i,lm);var e=Xy(i);function i(){return en(this,i),e.apply(this,arguments)}return tn(i,[{key:"draw",value:function(s,c,d){var A=this,r=this.w,y=new ur(this.ctx),b=r.globals.comboCharts?c:r.config.chart.type,x=new Yd(this.ctx);this.candlestickOptions=this.w.config.plotOptions.candlestick,this.boxOptions=this.w.config.plotOptions.boxPlot,this.isHorizontal=r.config.plotOptions.bar.horizontal,this.isOHLC=this.candlestickOptions&&this.candlestickOptions.type==="ohlc";var B=new nl(this.ctx,r);s=B.getLogSeries(s),this.series=s,this.yRatio=B.getLogYRatios(this.yRatio),this.barHelpers.initVariables(s);for(var T=y.group({class:"apexcharts-".concat(b,"-series apexcharts-plot-series")}),E=function(P){A.isBoxPlot=r.config.chart.type==="boxPlot"||r.config.series[P].type==="boxPlot";var G,U,Q,q,ne=void 0,re=void 0,pe=[],fe=[],he=r.globals.comboCharts?d[P]:P,be=A.barHelpers.getGroupIndex(he).columnGroupIndex,Se=y.group({class:"apexcharts-series",seriesName:ni.escapeString(r.globals.seriesNames[he]),rel:P+1,"data:realIndex":he});A.ctx.series.addCollapsedClassToSeries(Se,he),s[P].length>0&&(A.visibleI=A.visibleI+1);var oe,ye,Me=0;A.yRatio.length>1&&(A.yaxisIndex=r.globals.seriesYAxisReverseMap[he][0],Me=he);var Be=A.barHelpers.initialPositions(he);re=Be.y,oe=Be.barHeight,U=Be.yDivision,q=Be.zeroW,ne=Be.x,ye=Be.barWidth,G=Be.xDivision,Q=Be.zeroH,fe.push(ne+ye/2);for(var Pe=y.group({class:"apexcharts-datalabels","data:realIndex":he}),De=y.group({class:"apexcharts-bar-goals-markers"}),et=function(bt){var pt=A.barHelpers.getStrokeWidth(P,bt,he),Qt=null,Ie={indexes:{i:P,j:bt,realIndex:he,translationsIndex:Me},x:ne,y:re,strokeWidth:pt,elSeries:Se};Qt=A.isHorizontal?A.drawHorizontalBoxPaths(Tr(Tr({},Ie),{},{yDivision:U,barHeight:oe,zeroW:q})):A.drawVerticalBoxPaths(Tr(Tr({},Ie),{},{xDivision:G,barWidth:ye,zeroH:Q})),re=Qt.y,ne=Qt.x;var ot=A.barHelpers.drawGoalLine({barXPosition:Qt.barXPosition,barYPosition:Qt.barYPosition,goalX:Qt.goalX,goalY:Qt.goalY,barHeight:oe,barWidth:ye});ot&&De.add(ot),bt>0&&fe.push(ne+ye/2),pe.push(re),Qt.pathTo.forEach(function(ut,mt){var Ct=!A.isBoxPlot&&A.candlestickOptions.wick.useFillColor?Qt.color[mt]:r.globals.stroke.colors[P],rt=x.fillPath({seriesNumber:he,dataPointIndex:bt,color:Qt.color[mt],value:s[P][bt]});A.renderSeries({realIndex:he,pathFill:rt,lineFill:Ct,j:bt,i:P,pathFrom:Qt.pathFrom,pathTo:ut,strokeWidth:pt,elSeries:Se,x:ne,y:re,series:s,columnGroupIndex:be,barHeight:oe,barWidth:ye,elDataLabelsWrap:Pe,elGoalsMarkers:De,visibleSeries:A.visibleI,type:r.config.chart.type})})},Ye=0;Ye<r.globals.dataPoints;Ye++)et(Ye);r.globals.seriesXvalues[he]=fe,r.globals.seriesYvalues[he]=pe,T.add(Se)},R=0;R<s.length;R++)E(R);return T}},{key:"drawVerticalBoxPaths",value:function(s){var c=s.indexes,d=s.x;s.y;var A=s.xDivision,r=s.barWidth,y=s.zeroH,b=s.strokeWidth,x=this.w,B=new ur(this.ctx),T=c.i,E=c.j,R=x.config.plotOptions.candlestick.colors,P=this.boxOptions.colors,G=c.realIndex,U=function(Ye){return Array.isArray(Ye)?Ye[G]:Ye},Q=U(R.upward),q=U(R.downward),ne=this.yRatio[c.translationsIndex],re=this.getOHLCValue(G,E),pe=y,fe=y,he=re.o<re.c?[Q]:[q];this.isBoxPlot&&(he=[U(P.lower),U(P.upper)]);var be=Math.min(re.o,re.c),Se=Math.max(re.o,re.c),oe=re.m;x.globals.isXNumeric&&(d=(x.globals.seriesX[G][E]-x.globals.minX)/this.xRatio-r/2);var ye=d+r*this.visibleI;this.series[T][E]===void 0||this.series[T][E]===null?(be=y,Se=y):(be=y-be/ne,Se=y-Se/ne,pe=y-re.h/ne,fe=y-re.l/ne,oe=y-re.m/ne);var Me=B.move(ye,y),Be=B.move(ye+r/2,be);if(x.globals.previousPaths.length>0&&(Be=this.getPreviousPath(G,E,!0)),this.isOHLC){var Pe=ye+r/2,De=y-re.o/ne,et=y-re.c/ne;Me=[B.move(Pe,pe)+B.line(Pe,fe)+B.move(Pe,De)+B.line(ye,De)+B.move(Pe,et)+B.line(ye+r,et)]}else Me=this.isBoxPlot?[B.move(ye,be)+B.line(ye+r/2,be)+B.line(ye+r/2,pe)+B.line(ye+r/4,pe)+B.line(ye+r-r/4,pe)+B.line(ye+r/2,pe)+B.line(ye+r/2,be)+B.line(ye+r,be)+B.line(ye+r,oe)+B.line(ye,oe)+B.line(ye,be+b/2),B.move(ye,oe)+B.line(ye+r,oe)+B.line(ye+r,Se)+B.line(ye+r/2,Se)+B.line(ye+r/2,fe)+B.line(ye+r-r/4,fe)+B.line(ye+r/4,fe)+B.line(ye+r/2,fe)+B.line(ye+r/2,Se)+B.line(ye,Se)+B.line(ye,oe)+"z"]:[B.move(ye,Se)+B.line(ye+r/2,Se)+B.line(ye+r/2,pe)+B.line(ye+r/2,Se)+B.line(ye+r,Se)+B.line(ye+r,be)+B.line(ye+r/2,be)+B.line(ye+r/2,fe)+B.line(ye+r/2,be)+B.line(ye,be)+B.line(ye,Se-b/2)];return Be+=B.move(ye,be),x.globals.isXNumeric||(d+=A),{pathTo:Me,pathFrom:Be,x:d,y:Se,goalY:this.barHelpers.getGoalValues("y",null,y,T,E,c.translationsIndex),barXPosition:ye,color:he}}},{key:"drawHorizontalBoxPaths",value:function(s){var c=s.indexes;s.x;var d=s.y,A=s.yDivision,r=s.barHeight,y=s.zeroW,b=s.strokeWidth,x=this.w,B=new ur(this.ctx),T=c.i,E=c.j,R=this.boxOptions.colors.lower;this.isBoxPlot&&(R=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var P=this.invertedYRatio,G=c.realIndex,U=this.getOHLCValue(G,E),Q=y,q=y,ne=Math.min(U.o,U.c),re=Math.max(U.o,U.c),pe=U.m;x.globals.isXNumeric&&(d=(x.globals.seriesX[G][E]-x.globals.minX)/this.invertedXRatio-r/2);var fe=d+r*this.visibleI;this.series[T][E]===void 0||this.series[T][E]===null?(ne=y,re=y):(ne=y+ne/P,re=y+re/P,Q=y+U.h/P,q=y+U.l/P,pe=y+U.m/P);var he=B.move(y,fe),be=B.move(ne,fe+r/2);return x.globals.previousPaths.length>0&&(be=this.getPreviousPath(G,E,!0)),he=[B.move(ne,fe)+B.line(ne,fe+r/2)+B.line(Q,fe+r/2)+B.line(Q,fe+r/2-r/4)+B.line(Q,fe+r/2+r/4)+B.line(Q,fe+r/2)+B.line(ne,fe+r/2)+B.line(ne,fe+r)+B.line(pe,fe+r)+B.line(pe,fe)+B.line(ne+b/2,fe),B.move(pe,fe)+B.line(pe,fe+r)+B.line(re,fe+r)+B.line(re,fe+r/2)+B.line(q,fe+r/2)+B.line(q,fe+r-r/4)+B.line(q,fe+r/4)+B.line(q,fe+r/2)+B.line(re,fe+r/2)+B.line(re,fe)+B.line(pe,fe)+"z"],be+=B.move(ne,fe),x.globals.isXNumeric||(d+=A),{pathTo:he,pathFrom:be,x:re,y:d,goalX:this.barHelpers.getGoalValues("x",y,null,T,E),barYPosition:fe,color:R}}},{key:"getOHLCValue",value:function(s,c){var d=this.w,A=new nl(this.ctx,d),r=A.getLogValAtSeriesIndex(d.globals.seriesCandleH[s][c],s),y=A.getLogValAtSeriesIndex(d.globals.seriesCandleO[s][c],s),b=A.getLogValAtSeriesIndex(d.globals.seriesCandleM[s][c],s),x=A.getLogValAtSeriesIndex(d.globals.seriesCandleC[s][c],s),B=A.getLogValAtSeriesIndex(d.globals.seriesCandleL[s][c],s);return{o:this.isBoxPlot?r:y,h:this.isBoxPlot?y:r,m:b,l:this.isBoxPlot?x:B,c:this.isBoxPlot?B:x}}}]),i}(),$T=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"checkColorRange",value:function(){var e=this.w,i=!1,s=e.config.plotOptions[e.config.chart.type];return s.colorScale.ranges.length>0&&s.colorScale.ranges.map(function(c,d){c.from<=0&&(i=!0)}),i}},{key:"getShadeColor",value:function(e,i,s,c){var d=this.w,A=1,r=d.config.plotOptions[e].shadeIntensity,y=this.determineColor(e,i,s);d.globals.hasNegs||c?A=d.config.plotOptions[e].reverseNegativeShade?y.percent<0?y.percent/100*(1.25*r):(1-y.percent/100)*(1.25*r):y.percent<=0?1-(1+y.percent/100)*r:(1-y.percent/100)*r:(A=1-y.percent/100,e==="treemap"&&(A=(1-y.percent/100)*(1.25*r)));var b=y.color,x=new ni;if(d.config.plotOptions[e].enableShades)if(this.w.config.theme.mode==="dark"){var B=x.shadeColor(-1*A,y.color);b=ni.hexToRgba(ni.isColorHex(B)?B:ni.rgb2hex(B),d.config.fill.opacity)}else{var T=x.shadeColor(A,y.color);b=ni.hexToRgba(ni.isColorHex(T)?T:ni.rgb2hex(T),d.config.fill.opacity)}return{color:b,colorProps:y}}},{key:"determineColor",value:function(e,i,s){var c=this.w,d=c.globals.series[i][s],A=c.config.plotOptions[e],r=A.colorScale.inverse?s:i;A.distributed&&c.config.chart.type==="treemap"&&(r=s);var y=c.globals.colors[r],b=null,x=Math.min.apply(Math,Kl(c.globals.series[i])),B=Math.max.apply(Math,Kl(c.globals.series[i]));A.distributed||e!=="heatmap"||(x=c.globals.minY,B=c.globals.maxY),A.colorScale.min!==void 0&&(x=A.colorScale.min<c.globals.minY?A.colorScale.min:c.globals.minY,B=A.colorScale.max>c.globals.maxY?A.colorScale.max:c.globals.maxY);var T=Math.abs(B)+Math.abs(x),E=100*d/(T===0?T-1e-6:T);return A.colorScale.ranges.length>0&&A.colorScale.ranges.map(function(R,P){if(d>=R.from&&d<=R.to){y=R.color,b=R.foreColor?R.foreColor:null,x=R.from,B=R.to;var G=Math.abs(B)+Math.abs(x);E=100*d/(G===0?G-1e-6:G)}}),{color:y,foreColor:b,percent:E}}},{key:"calculateDataLabels",value:function(e){var i=e.text,s=e.x,c=e.y,d=e.i,A=e.j,r=e.colorProps,y=e.fontSize,b=this.w.config.dataLabels,x=new ur(this.ctx),B=new am(this.ctx),T=null;if(b.enabled){T=x.group({class:"apexcharts-data-labels"});var E=b.offsetX,R=b.offsetY,P=s+E,G=c+parseFloat(b.style.fontSize)/3+R;B.plotDataLabelsText({x:P,y:G,text:i,i:d,j:A,color:r.foreColor,parent:T,fontSize:y,dataLabelsConfig:b})}return T}},{key:"addListeners",value:function(e){var i=new ur(this.ctx);e.node.addEventListener("mouseenter",i.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",i.pathMouseLeave.bind(this,e)),e.node.addEventListener("mousedown",i.pathMouseDown.bind(this,e))}}]),a}(),oD=function(){function a(e,i){en(this,a),this.ctx=e,this.w=e.w,this.xRatio=i.xRatio,this.yRatio=i.yRatio,this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.helpers=new $T(e),this.rectRadius=this.w.config.plotOptions.heatmap.radius,this.strokeWidth=this.w.config.stroke.show?this.w.config.stroke.width:0}return tn(a,[{key:"draw",value:function(e){var i=this.w,s=new ur(this.ctx),c=s.group({class:"apexcharts-heatmap"});c.attr("clip-path","url(#gridRectMask".concat(i.globals.cuid,")"));var d=i.globals.gridWidth/i.globals.dataPoints,A=i.globals.gridHeight/i.globals.series.length,r=0,y=!1;this.negRange=this.helpers.checkColorRange();var b=e.slice();i.config.yaxis[0].reversed&&(y=!0,b.reverse());for(var x=y?0:b.length-1;y?x<b.length:x>=0;y?x++:x--){var B=s.group({class:"apexcharts-series apexcharts-heatmap-series",seriesName:ni.escapeString(i.globals.seriesNames[x]),rel:x+1,"data:realIndex":x});if(this.ctx.series.addCollapsedClassToSeries(B,x),i.config.chart.dropShadow.enabled){var T=i.config.chart.dropShadow;new Rc(this.ctx).dropShadow(B,T,x)}for(var E=0,R=i.config.plotOptions.heatmap.shadeIntensity,P=0,G=0;G<i.globals.dataPoints;G++)if(i.globals.seriesX.length&&!i.globals.allSeriesHasEqualX&&i.globals.minX+i.globals.minXDiff*G<i.globals.seriesX[x][P])E+=d;else{if(P>=b[x].length)break;var U=this.helpers.getShadeColor(i.config.chart.type,x,P,this.negRange),Q=U.color,q=U.colorProps;i.config.fill.type==="image"&&(Q=new Yd(this.ctx).fillPath({seriesNumber:x,dataPointIndex:P,opacity:i.globals.hasNegs?q.percent<0?1-(1+q.percent/100):R+q.percent/100:q.percent/100,patternID:ni.randomId(),width:i.config.fill.image.width?i.config.fill.image.width:d,height:i.config.fill.image.height?i.config.fill.image.height:A}));var ne=this.rectRadius,re=s.drawRect(E,r,d,A,ne);if(re.attr({cx:E,cy:r}),re.node.classList.add("apexcharts-heatmap-rect"),B.add(re),re.attr({fill:Q,i:x,index:x,j:P,val:e[x][P],"stroke-width":this.strokeWidth,stroke:i.config.plotOptions.heatmap.useFillColorAsStroke?Q:i.globals.stroke.colors[0],color:Q}),this.helpers.addListeners(re),i.config.chart.animations.enabled&&!i.globals.dataChanged){var pe=1;i.globals.resized||(pe=i.config.chart.animations.speed),this.animateHeatMap(re,E,r,d,A,pe)}if(i.globals.dataChanged){var fe=1;if(this.dynamicAnim.enabled&&i.globals.shouldAnimate){fe=this.dynamicAnim.speed;var he=i.globals.previousPaths[x]&&i.globals.previousPaths[x][P]&&i.globals.previousPaths[x][P].color;he||(he="rgba(255, 255, 255, 0)"),this.animateHeatColor(re,ni.isColorHex(he)?he:ni.rgb2hex(he),ni.isColorHex(Q)?Q:ni.rgb2hex(Q),fe)}}var be=(0,i.config.dataLabels.formatter)(i.globals.series[x][P],{value:i.globals.series[x][P],seriesIndex:x,dataPointIndex:P,w:i}),Se=this.helpers.calculateDataLabels({text:be,x:E+d/2,y:r+A/2,i:x,j:P,colorProps:q,series:b});Se!==null&&B.add(Se),E+=d,P++}r+=A,c.add(B)}var oe=i.globals.yAxisScale[0].result.slice();return i.config.yaxis[0].reversed?oe.unshift(""):oe.push(""),i.globals.yAxisScale[0].result=oe,c}},{key:"animateHeatMap",value:function(e,i,s,c,d,A){var r=new cm(this.ctx);r.animateRect(e,{x:i+c/2,y:s+d/2,width:0,height:0},{x:i,y:s,width:c,height:d},A,function(){r.animationCompleted(e)})}},{key:"animateHeatColor",value:function(e,i,s,c){e.attr({fill:i}).animate(c).attr({fill:s})}}]),a}(),ZT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawYAxisTexts",value:function(e,i,s,c){var d=this.w,A=d.config.yaxis[0],r=d.globals.yLabelFormatters[0];return new ur(this.ctx).drawText({x:e+A.labels.offsetX,y:i+A.labels.offsetY,text:r(c,s),textAnchor:"middle",fontSize:A.labels.style.fontSize,fontFamily:A.labels.style.fontFamily,foreColor:Array.isArray(A.labels.style.colors)?A.labels.style.colors[s]:A.labels.style.colors})}}]),a}(),JT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var i=this.w;this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animBeginArr=[0],this.animDur=0,this.donutDataLabels=this.w.config.plotOptions.pie.donut.labels,this.lineColorArr=i.globals.stroke.colors!==void 0?i.globals.stroke.colors:i.globals.colors,this.defaultSize=Math.min(i.globals.gridWidth,i.globals.gridHeight),this.centerY=this.defaultSize/2,this.centerX=i.globals.gridWidth/2,i.config.chart.type==="radialBar"?this.fullAngle=360:this.fullAngle=Math.abs(i.config.plotOptions.pie.endAngle-i.config.plotOptions.pie.startAngle),this.initialAngle=i.config.plotOptions.pie.startAngle%this.fullAngle,i.globals.radialSize=this.defaultSize/2.05-i.config.stroke.width-(i.config.chart.sparkline.enabled?0:i.config.chart.dropShadow.blur),this.donutSize=i.globals.radialSize*parseInt(i.config.plotOptions.pie.donut.size,10)/100;var s=i.config.plotOptions.pie.customScale,c=i.globals.gridWidth/2,d=i.globals.gridHeight/2;this.translateX=c-c*s,this.translateY=d-d*s,this.dataLabelsGroup=new ur(this.ctx).group({class:"apexcharts-datalabels-group",transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(s,")")}),this.maxY=0,this.sliceLabels=[],this.sliceSizes=[],this.prevSectorAngleArr=[]}return tn(a,[{key:"draw",value:function(e){var i=this,s=this.w,c=new ur(this.ctx),d=c.group({class:"apexcharts-pie"});if(s.globals.noData)return d;for(var A=0,r=0;r<e.length;r++)A+=ni.negToZero(e[r]);var y=[],b=c.group();A===0&&(A=1e-5),e.forEach(function(q){i.maxY=Math.max(i.maxY,q)}),s.config.yaxis[0].max&&(this.maxY=s.config.yaxis[0].max),s.config.grid.position==="back"&&this.chartType==="polarArea"&&this.drawPolarElements(d);for(var x=0;x<e.length;x++){var B=this.fullAngle*ni.negToZero(e[x])/A;y.push(B),this.chartType==="polarArea"?(y[x]=this.fullAngle/e.length,this.sliceSizes.push(s.globals.radialSize*e[x]/this.maxY)):this.sliceSizes.push(s.globals.radialSize)}if(s.globals.dataChanged){for(var T,E=0,R=0;R<s.globals.previousPaths.length;R++)E+=ni.negToZero(s.globals.previousPaths[R]);for(var P=0;P<s.globals.previousPaths.length;P++)T=this.fullAngle*ni.negToZero(s.globals.previousPaths[P])/E,this.prevSectorAngleArr.push(T)}if(this.donutSize<0&&(this.donutSize=0),this.chartType==="donut"){var G=c.drawCircle(this.donutSize);G.attr({cx:this.centerX,cy:this.centerY,fill:s.config.plotOptions.pie.donut.background?s.config.plotOptions.pie.donut.background:"transparent"}),b.add(G)}var U=this.drawArcs(y,e);if(this.sliceLabels.forEach(function(q){U.add(q)}),b.attr({transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(s.config.plotOptions.pie.customScale,")")}),b.add(U),d.add(b),this.donutDataLabels.show){var Q=this.renderInnerDataLabels(this.dataLabelsGroup,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});d.add(Q)}return s.config.grid.position==="front"&&this.chartType==="polarArea"&&this.drawPolarElements(d),d}},{key:"drawArcs",value:function(e,i){var s=this.w,c=new Rc(this.ctx),d=new ur(this.ctx),A=new Yd(this.ctx),r=d.group({class:"apexcharts-slices"}),y=this.initialAngle,b=this.initialAngle,x=this.initialAngle,B=this.initialAngle;this.strokeWidth=s.config.stroke.show?s.config.stroke.width:0;for(var T=0;T<e.length;T++){var E=d.group({class:"apexcharts-series apexcharts-pie-series",seriesName:ni.escapeString(s.globals.seriesNames[T]),rel:T+1,"data:realIndex":T});r.add(E),b=B,x=(y=x)+e[T],B=b+this.prevSectorAngleArr[T];var R=x<y?this.fullAngle+x-y:x-y,P=A.fillPath({seriesNumber:T,size:this.sliceSizes[T],value:i[T]}),G=this.getChangedPath(b,B),U=d.drawPath({d:G,stroke:Array.isArray(this.lineColorArr)?this.lineColorArr[T]:this.lineColorArr,strokeWidth:0,fill:P,fillOpacity:s.config.fill.opacity,classes:"apexcharts-pie-area apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(T)});if(U.attr({index:0,j:T}),c.setSelectionFilter(U,0,T),s.config.chart.dropShadow.enabled){var Q=s.config.chart.dropShadow;c.dropShadow(U,Q,T)}this.addListeners(U,this.donutDataLabels),ur.setAttrs(U.node,{"data:angle":R,"data:startAngle":y,"data:strokeWidth":this.strokeWidth,"data:value":i[T]});var q={x:0,y:0};this.chartType==="pie"||this.chartType==="polarArea"?q=ni.polarToCartesian(this.centerX,this.centerY,s.globals.radialSize/1.25+s.config.plotOptions.pie.dataLabels.offset,(y+R/2)%this.fullAngle):this.chartType==="donut"&&(q=ni.polarToCartesian(this.centerX,this.centerY,(s.globals.radialSize+this.donutSize)/2+s.config.plotOptions.pie.dataLabels.offset,(y+R/2)%this.fullAngle)),E.add(U);var ne=0;if(!this.initialAnim||s.globals.resized||s.globals.dataChanged?this.animBeginArr.push(0):((ne=R/this.fullAngle*s.config.chart.animations.speed)===0&&(ne=1),this.animDur=ne+this.animDur,this.animBeginArr.push(this.animDur)),this.dynamicAnim&&s.globals.dataChanged?this.animatePaths(U,{size:this.sliceSizes[T],endAngle:x,startAngle:y,prevStartAngle:b,prevEndAngle:B,animateStartingPos:!0,i:T,animBeginArr:this.animBeginArr,shouldSetPrevPaths:!0,dur:s.config.chart.animations.dynamicAnimation.speed}):this.animatePaths(U,{size:this.sliceSizes[T],endAngle:x,startAngle:y,i:T,totalItems:e.length-1,animBeginArr:this.animBeginArr,dur:ne}),s.config.plotOptions.pie.expandOnClick&&this.chartType!=="polarArea"&&U.node.addEventListener("mouseup",this.pieClicked.bind(this,T)),s.globals.selectedDataPoints[0]!==void 0&&s.globals.selectedDataPoints[0].indexOf(T)>-1&&this.pieClicked(T),s.config.dataLabels.enabled){var re=q.x,pe=q.y,fe=100*R/this.fullAngle+"%";if(R!==0&&s.config.plotOptions.pie.dataLabels.minAngleToShowLabel<e[T]){var he=s.config.dataLabels.formatter;he!==void 0&&(fe=he(s.globals.seriesPercent[T][0],{seriesIndex:T,w:s}));var be=s.globals.dataLabels.style.colors[T],Se=d.group({class:"apexcharts-datalabels"}),oe=d.drawText({x:re,y:pe,text:fe,textAnchor:"middle",fontSize:s.config.dataLabels.style.fontSize,fontFamily:s.config.dataLabels.style.fontFamily,fontWeight:s.config.dataLabels.style.fontWeight,foreColor:be});if(Se.add(oe),s.config.dataLabels.dropShadow.enabled){var ye=s.config.dataLabels.dropShadow;c.dropShadow(oe,ye)}oe.node.classList.add("apexcharts-pie-label"),s.config.chart.animations.animate&&s.globals.resized===!1&&(oe.node.classList.add("apexcharts-pie-label-delay"),oe.node.style.animationDelay=s.config.chart.animations.speed/940+"s"),this.sliceLabels.push(Se)}}}return r}},{key:"addListeners",value:function(e,i){var s=new ur(this.ctx);e.node.addEventListener("mouseenter",s.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",s.pathMouseLeave.bind(this,e)),e.node.addEventListener("mouseleave",this.revertDataLabelsInner.bind(this,e.node,i)),e.node.addEventListener("mousedown",s.pathMouseDown.bind(this,e)),this.donutDataLabels.total.showAlways||(e.node.addEventListener("mouseenter",this.printDataLabelsInner.bind(this,e.node,i)),e.node.addEventListener("mousedown",this.printDataLabelsInner.bind(this,e.node,i)))}},{key:"animatePaths",value:function(e,i){var s=this.w,c=i.endAngle<i.startAngle?this.fullAngle+i.endAngle-i.startAngle:i.endAngle-i.startAngle,d=c,A=i.startAngle,r=i.startAngle;i.prevStartAngle!==void 0&&i.prevEndAngle!==void 0&&(A=i.prevEndAngle,d=i.prevEndAngle<i.prevStartAngle?this.fullAngle+i.prevEndAngle-i.prevStartAngle:i.prevEndAngle-i.prevStartAngle),i.i===s.config.series.length-1&&(c+r>this.fullAngle?i.endAngle=i.endAngle-(c+r):c+r<this.fullAngle&&(i.endAngle=i.endAngle+(this.fullAngle-(c+r)))),c===this.fullAngle&&(c=this.fullAngle-.01),this.animateArc(e,A,r,c,d,i)}},{key:"animateArc",value:function(e,i,s,c,d,A){var r,y=this,b=this.w,x=new cm(this.ctx),B=A.size;(isNaN(i)||isNaN(d))&&(i=s,d=c,A.dur=0);var T=c,E=s,R=i<s?this.fullAngle+i-s:i-s;b.globals.dataChanged&&A.shouldSetPrevPaths&&A.prevEndAngle&&(r=y.getPiePath({me:y,startAngle:A.prevStartAngle,angle:A.prevEndAngle<A.prevStartAngle?this.fullAngle+A.prevEndAngle-A.prevStartAngle:A.prevEndAngle-A.prevStartAngle,size:B}),e.attr({d:r})),A.dur!==0?e.animate(A.dur,A.animBeginArr[A.i]).after(function(){y.chartType!=="pie"&&y.chartType!=="donut"&&y.chartType!=="polarArea"||this.animate(b.config.chart.animations.dynamicAnimation.speed).attr({"stroke-width":y.strokeWidth}),A.i===b.config.series.length-1&&x.animationCompleted(e)}).during(function(P){T=R+(c-R)*P,A.animateStartingPos&&(T=d+(c-d)*P,E=i-d+(s-(i-d))*P),r=y.getPiePath({me:y,startAngle:E,angle:T,size:B}),e.node.setAttribute("data:pathOrig",r),e.attr({d:r})}):(r=y.getPiePath({me:y,startAngle:E,angle:c,size:B}),A.isTrack||(b.globals.animationEnded=!0),e.node.setAttribute("data:pathOrig",r),e.attr({d:r,"stroke-width":y.strokeWidth}))}},{key:"pieClicked",value:function(e){var i,s=this.w,c=this,d=c.sliceSizes[e]+(s.config.plotOptions.pie.expandOnClick?4:0),A=s.globals.dom.Paper.findOne(".apexcharts-".concat(c.chartType.toLowerCase(),"-slice-").concat(e));if(A.attr("data:pieClicked")!=="true"){var r=s.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area");Array.prototype.forEach.call(r,function(B){B.setAttribute("data:pieClicked","false");var T=B.getAttribute("data:pathOrig");T&&B.setAttribute("d",T)}),s.globals.capturedDataPointIndex=e,A.attr("data:pieClicked","true");var y=parseInt(A.attr("data:startAngle"),10),b=parseInt(A.attr("data:angle"),10);i=c.getPiePath({me:c,startAngle:y,angle:b,size:d}),b!==360&&A.plot(i)}else{A.attr({"data:pieClicked":"false"}),this.revertDataLabelsInner(A.node,this.donutDataLabels);var x=A.attr("data:pathOrig");A.attr({d:x})}}},{key:"getChangedPath",value:function(e,i){var s="";return this.dynamicAnim&&this.w.globals.dataChanged&&(s=this.getPiePath({me:this,startAngle:e,angle:i-e,size:this.size})),s}},{key:"getPiePath",value:function(e){var i,s=e.me,c=e.startAngle,d=e.angle,A=e.size,r=new ur(this.ctx),y=c,b=Math.PI*(y-90)/180,x=d+c;Math.ceil(x)>=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle&&(x=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle-.01),Math.ceil(x)>this.fullAngle&&(x-=this.fullAngle);var B=Math.PI*(x-90)/180,T=s.centerX+A*Math.cos(b),E=s.centerY+A*Math.sin(b),R=s.centerX+A*Math.cos(B),P=s.centerY+A*Math.sin(B),G=ni.polarToCartesian(s.centerX,s.centerY,s.donutSize,x),U=ni.polarToCartesian(s.centerX,s.centerY,s.donutSize,y),Q=d>180?1:0,q=["M",T,E,"A",A,A,0,Q,1,R,P];return i=s.chartType==="donut"?[].concat(q,["L",G.x,G.y,"A",s.donutSize,s.donutSize,0,Q,0,U.x,U.y,"L",T,E,"z"]).join(" "):s.chartType==="pie"||s.chartType==="polarArea"?[].concat(q,["L",s.centerX,s.centerY,"L",T,E]).join(" "):[].concat(q).join(" "),r.roundPathCorners(i,2*this.strokeWidth)}},{key:"drawPolarElements",value:function(e){var i=this.w,s=new WT(this.ctx),c=new ur(this.ctx),d=new ZT(this.ctx),A=c.group(),r=c.group(),y=s.niceScale(0,Math.ceil(this.maxY),0),b=y.result.reverse(),x=y.result.length;this.maxY=y.niceMax;for(var B=i.globals.radialSize,T=B/(x-1),E=0;E<x-1;E++){var R=c.drawCircle(B);if(R.attr({cx:this.centerX,cy:this.centerY,fill:"none","stroke-width":i.config.plotOptions.polarArea.rings.strokeWidth,stroke:i.config.plotOptions.polarArea.rings.strokeColor}),i.config.yaxis[0].show){var P=d.drawYAxisTexts(this.centerX,this.centerY-B+parseInt(i.config.yaxis[0].labels.style.fontSize,10)/2,E,b[E]);r.add(P)}A.add(R),B-=T}this.drawSpokes(e),e.add(A),e.add(r)}},{key:"renderInnerDataLabels",value:function(e,i,s){var c=this.w,d=new ur(this.ctx),A=i.total.show;e.node.innerHTML="",e.node.style.opacity=s.opacity;var r,y,b=s.centerX,x=this.donutDataLabels.total.label?s.centerY:s.centerY-s.centerY/6;r=i.name.color===void 0?c.globals.colors[0]:i.name.color;var B=i.name.fontSize,T=i.name.fontFamily,E=i.name.fontWeight;y=i.value.color===void 0?c.config.chart.foreColor:i.value.color;var R=i.value.formatter,P="",G="";if(A?(r=i.total.color,B=i.total.fontSize,T=i.total.fontFamily,E=i.total.fontWeight,G=this.donutDataLabels.total.label?i.total.label:"",P=i.total.formatter(c)):c.globals.series.length===1&&(P=R(c.globals.series[0],c),G=c.globals.seriesNames[0]),G&&(G=i.name.formatter(G,i.total.show,c)),i.name.show){var U=d.drawText({x:b,y:x+parseFloat(i.name.offsetY),text:G,textAnchor:"middle",foreColor:r,fontSize:B,fontWeight:E,fontFamily:T});U.node.classList.add("apexcharts-datalabel-label"),e.add(U)}if(i.value.show){var Q=i.name.show?parseFloat(i.value.offsetY)+16:i.value.offsetY,q=d.drawText({x:b,y:x+Q,text:P,textAnchor:"middle",foreColor:y,fontWeight:i.value.fontWeight,fontSize:i.value.fontSize,fontFamily:i.value.fontFamily});q.node.classList.add("apexcharts-datalabel-value"),e.add(q)}return e}},{key:"printInnerLabels",value:function(e,i,s,c){var d,A=this.w;c?d=e.name.color===void 0?A.globals.colors[parseInt(c.parentNode.getAttribute("rel"),10)-1]:e.name.color:A.globals.series.length>1&&e.total.show&&(d=e.total.color);var r=A.globals.dom.baseEl.querySelector(".apexcharts-datalabel-label"),y=A.globals.dom.baseEl.querySelector(".apexcharts-datalabel-value");s=(0,e.value.formatter)(s,A),c||typeof e.total.formatter!="function"||(s=e.total.formatter(A));var b=i===e.total.label;i=this.donutDataLabels.total.label?e.name.formatter(i,b,A):"",r!==null&&(r.textContent=i),y!==null&&(y.textContent=s),r!==null&&(r.style.fill=d)}},{key:"printDataLabelsInner",value:function(e,i){var s=this.w,c=e.getAttribute("data:value"),d=s.globals.seriesNames[parseInt(e.parentNode.getAttribute("rel"),10)-1];s.globals.series.length>1&&this.printInnerLabels(i,d,c,e);var A=s.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group");A!==null&&(A.style.opacity=1)}},{key:"drawSpokes",value:function(e){var i=this,s=this.w,c=new ur(this.ctx),d=s.config.plotOptions.polarArea.spokes;if(d.strokeWidth!==0){for(var A=[],r=360/s.globals.series.length,y=0;y<s.globals.series.length;y++)A.push(ni.polarToCartesian(this.centerX,this.centerY,s.globals.radialSize,s.config.plotOptions.pie.startAngle+r*y));A.forEach(function(b,x){var B=c.drawLine(b.x,b.y,i.centerX,i.centerY,Array.isArray(d.connectorColors)?d.connectorColors[x]:d.connectorColors);e.add(B)})}}},{key:"revertDataLabelsInner",value:function(){var e=this.w;if(this.donutDataLabels.show){var i=e.globals.dom.Paper.findOne(".apexcharts-datalabels-group"),s=this.renderInnerDataLabels(i,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});e.globals.dom.Paper.findOne(".apexcharts-radialbar, .apexcharts-pie").add(s)}}}]),a}(),aD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animDur=0;var i=this.w;this.graphics=new ur(this.ctx),this.lineColorArr=i.globals.stroke.colors!==void 0?i.globals.stroke.colors:i.globals.colors,this.defaultSize=i.globals.svgHeight<i.globals.svgWidth?i.globals.gridHeight:i.globals.gridWidth,this.isLog=i.config.yaxis[0].logarithmic,this.logBase=i.config.yaxis[0].logBase,this.coreUtils=new nl(this.ctx),this.maxValue=this.isLog?this.coreUtils.getLogVal(this.logBase,i.globals.maxY,0):i.globals.maxY,this.minValue=this.isLog?this.coreUtils.getLogVal(this.logBase,this.w.globals.minY,0):i.globals.minY,this.polygons=i.config.plotOptions.radar.polygons,this.strokeWidth=i.config.stroke.show?i.config.stroke.width:0,this.size=this.defaultSize/2.1-this.strokeWidth-i.config.chart.dropShadow.blur,i.config.xaxis.labels.show&&(this.size=this.size-i.globals.xAxisLabelsWidth/1.75),i.config.plotOptions.radar.size!==void 0&&(this.size=i.config.plotOptions.radar.size),this.dataRadiusOfPercent=[],this.dataRadius=[],this.angleArr=[],this.yaxisLabelsTextsPos=[]}return tn(a,[{key:"draw",value:function(e){var i=this,s=this.w,c=new Yd(this.ctx),d=[],A=new am(this.ctx);e.length&&(this.dataPointsLen=e[s.globals.maxValsInArrayIndex].length),this.disAngle=2*Math.PI/this.dataPointsLen;var r=s.globals.gridWidth/2,y=s.globals.gridHeight/2,b=r+s.config.plotOptions.radar.offsetX,x=y+s.config.plotOptions.radar.offsetY,B=this.graphics.group({class:"apexcharts-radar-series apexcharts-plot-series",transform:"translate(".concat(b||0,", ").concat(x||0,")")}),T=[],E=null,R=null;if(this.yaxisLabels=this.graphics.group({class:"apexcharts-yaxis"}),e.forEach(function(G,U){var Q=G.length===s.globals.dataPoints,q=i.graphics.group().attr({class:"apexcharts-series","data:longestSeries":Q,seriesName:ni.escapeString(s.globals.seriesNames[U]),rel:U+1,"data:realIndex":U});i.dataRadiusOfPercent[U]=[],i.dataRadius[U]=[],i.angleArr[U]=[],G.forEach(function(Me,Be){var Pe=Math.abs(i.maxValue-i.minValue);Me-=i.minValue,i.isLog&&(Me=i.coreUtils.getLogVal(i.logBase,Me,0)),i.dataRadiusOfPercent[U][Be]=Me/Pe,i.dataRadius[U][Be]=i.dataRadiusOfPercent[U][Be]*i.size,i.angleArr[U][Be]=Be*i.disAngle}),T=i.getDataPointsPos(i.dataRadius[U],i.angleArr[U]);var ne=i.createPaths(T,{x:0,y:0});E=i.graphics.group({class:"apexcharts-series-markers-wrap apexcharts-element-hidden"}),R=i.graphics.group({class:"apexcharts-datalabels","data:realIndex":U}),s.globals.delayedElements.push({el:E.node,index:U});var re={i:U,realIndex:U,animationDelay:U,initialSpeed:s.config.chart.animations.speed,dataChangeSpeed:s.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-radar",shouldClipToGrid:!1,bindEventsOnPaths:!1,stroke:s.globals.stroke.colors[U],strokeLineCap:s.config.stroke.lineCap},pe=null;s.globals.previousPaths.length>0&&(pe=i.getPreviousPath(U));for(var fe=0;fe<ne.linePathsTo.length;fe++){var he=i.graphics.renderPaths(Tr(Tr({},re),{},{pathFrom:pe===null?ne.linePathsFrom[fe]:pe,pathTo:ne.linePathsTo[fe],strokeWidth:Array.isArray(i.strokeWidth)?i.strokeWidth[U]:i.strokeWidth,fill:"none",drawShadow:!1}));q.add(he);var be=c.fillPath({seriesNumber:U}),Se=i.graphics.renderPaths(Tr(Tr({},re),{},{pathFrom:pe===null?ne.areaPathsFrom[fe]:pe,pathTo:ne.areaPathsTo[fe],strokeWidth:0,fill:be,drawShadow:!1}));if(s.config.chart.dropShadow.enabled){var oe=new Rc(i.ctx),ye=s.config.chart.dropShadow;oe.dropShadow(Se,Object.assign({},ye,{noUserSpaceOnUse:!0}),U)}q.add(Se)}G.forEach(function(Me,Be){var Pe=new Am(i.ctx).getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:U,dataPointIndex:Be}),De=i.graphics.drawMarker(T[Be].x,T[Be].y,Pe);De.attr("rel",Be),De.attr("j",Be),De.attr("index",U),De.node.setAttribute("default-marker-size",Pe.pSize);var et=i.graphics.group({class:"apexcharts-series-markers"});et&&et.add(De),E.add(et),q.add(E);var Ye=s.config.dataLabels;if(Ye.enabled){var bt=Ye.formatter(s.globals.series[U][Be],{seriesIndex:U,dataPointIndex:Be,w:s});A.plotDataLabelsText({x:T[Be].x,y:T[Be].y,text:bt,textAnchor:"middle",i:U,j:U,parent:R,offsetCorrection:!1,dataLabelsConfig:Tr({},Ye)})}q.add(R)}),d.push(q)}),this.drawPolygons({parent:B}),s.config.xaxis.labels.show){var P=this.drawXAxisTexts();B.add(P)}return d.forEach(function(G){B.add(G)}),B.add(this.yaxisLabels),B}},{key:"drawPolygons",value:function(e){for(var i=this,s=this.w,c=e.parent,d=new ZT(this.ctx),A=s.globals.yAxisScale[0].result.reverse(),r=A.length,y=[],b=this.size/(r-1),x=0;x<r;x++)y[x]=b*x;y.reverse();var B=[],T=[];y.forEach(function(E,R){var P=ni.getPolygonPos(E,i.dataPointsLen),G="";P.forEach(function(U,Q){if(R===0){var q=i.graphics.drawLine(U.x,U.y,0,0,Array.isArray(i.polygons.connectorColors)?i.polygons.connectorColors[Q]:i.polygons.connectorColors);T.push(q)}Q===0&&i.yaxisLabelsTextsPos.push({x:U.x,y:U.y}),G+=U.x+","+U.y+" "}),B.push(G)}),B.forEach(function(E,R){var P=i.polygons.strokeColors,G=i.polygons.strokeWidth,U=i.graphics.drawPolygon(E,Array.isArray(P)?P[R]:P,Array.isArray(G)?G[R]:G,s.globals.radarPolygons.fill.colors[R]);c.add(U)}),T.forEach(function(E){c.add(E)}),s.config.yaxis[0].show&&this.yaxisLabelsTextsPos.forEach(function(E,R){var P=d.drawYAxisTexts(E.x,E.y,R,A[R]);i.yaxisLabels.add(P)})}},{key:"drawXAxisTexts",value:function(){var e=this,i=this.w,s=i.config.xaxis.labels,c=this.graphics.group({class:"apexcharts-xaxis"}),d=ni.getPolygonPos(this.size,this.dataPointsLen);return i.globals.labels.forEach(function(A,r){var y=i.config.xaxis.labels.formatter,b=new am(e.ctx);if(d[r]){var x=e.getTextPos(d[r],e.size),B=y(A,{seriesIndex:-1,dataPointIndex:r,w:i});b.plotDataLabelsText({x:x.newX,y:x.newY,text:B,textAnchor:x.textAnchor,i:r,j:r,parent:c,className:"apexcharts-xaxis-label",color:Array.isArray(s.style.colors)&&s.style.colors[r]?s.style.colors[r]:"#a8a8a8",dataLabelsConfig:Tr({textAnchor:x.textAnchor,dropShadow:{enabled:!1}},s),offsetCorrection:!1}).on("click",function(T){if(typeof i.config.chart.events.xAxisLabelClick=="function"){var E=Object.assign({},i,{labelIndex:r});i.config.chart.events.xAxisLabelClick(T,e.ctx,E)}})}}),c}},{key:"createPaths",value:function(e,i){var s=this,c=[],d=[],A=[],r=[];if(e.length){d=[this.graphics.move(i.x,i.y)],r=[this.graphics.move(i.x,i.y)];var y=this.graphics.move(e[0].x,e[0].y),b=this.graphics.move(e[0].x,e[0].y);e.forEach(function(x,B){y+=s.graphics.line(x.x,x.y),b+=s.graphics.line(x.x,x.y),B===e.length-1&&(y+="Z",b+="Z")}),c.push(y),A.push(b)}return{linePathsFrom:d,linePathsTo:c,areaPathsFrom:r,areaPathsTo:A}}},{key:"getTextPos",value:function(e,i){var s="middle",c=e.x,d=e.y;return Math.abs(e.x)>=10?e.x>0?(s="start",c+=10):e.x<0&&(s="end",c-=10):s="middle",Math.abs(e.y)>=i-10&&(e.y<0?d-=10:e.y>0&&(d+=10)),{textAnchor:s,newX:c,newY:d}}},{key:"getPreviousPath",value:function(e){for(var i=this.w,s=null,c=0;c<i.globals.previousPaths.length;c++){var d=i.globals.previousPaths[c];d.paths.length>0&&parseInt(d.realIndex,10)===parseInt(e,10)&&i.globals.previousPaths[c].paths[0]!==void 0&&(s=i.globals.previousPaths[c].paths[0].d)}return s}},{key:"getDataPointsPos",value:function(e,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.dataPointsLen;e=e||[],i=i||[];for(var c=[],d=0;d<s;d++){var A={};A.x=e[d]*Math.sin(i[d]),A.y=-e[d]*Math.cos(i[d]),c.push(A)}return c}}]),a}(),lD=function(a){Yy(i,JT);var e=Xy(i);function i(s){var c;en(this,i),(c=e.call(this,s)).ctx=s,c.w=s.w,c.animBeginArr=[0],c.animDur=0;var d=c.w;return c.startAngle=d.config.plotOptions.radialBar.startAngle,c.endAngle=d.config.plotOptions.radialBar.endAngle,c.totalAngle=Math.abs(d.config.plotOptions.radialBar.endAngle-d.config.plotOptions.radialBar.startAngle),c.trackStartAngle=d.config.plotOptions.radialBar.track.startAngle,c.trackEndAngle=d.config.plotOptions.radialBar.track.endAngle,c.barLabels=c.w.config.plotOptions.radialBar.barLabels,c.donutDataLabels=c.w.config.plotOptions.radialBar.dataLabels,c.radialDataLabels=c.donutDataLabels,c.trackStartAngle||(c.trackStartAngle=c.startAngle),c.trackEndAngle||(c.trackEndAngle=c.endAngle),c.endAngle===360&&(c.endAngle=359.99),c.margin=parseInt(d.config.plotOptions.radialBar.track.margin,10),c.onBarLabelClick=c.onBarLabelClick.bind(cT(c)),c}return tn(i,[{key:"draw",value:function(s){var c=this.w,d=new ur(this.ctx),A=d.group({class:"apexcharts-radialbar"});if(c.globals.noData)return A;var r=d.group(),y=this.defaultSize/2,b=c.globals.gridWidth/2,x=this.defaultSize/2.05;c.config.chart.sparkline.enabled||(x=x-c.config.stroke.width-c.config.chart.dropShadow.blur);var B=c.globals.fill.colors;if(c.config.plotOptions.radialBar.track.show){var T=this.drawTracks({size:x,centerX:b,centerY:y,colorArr:B,series:s});r.add(T)}var E=this.drawArcs({size:x,centerX:b,centerY:y,colorArr:B,series:s}),R=360;c.config.plotOptions.radialBar.startAngle<0&&(R=this.totalAngle);var P=(360-R)/360;if(c.globals.radialSize=x-x*P,this.radialDataLabels.value.show){var G=Math.max(this.radialDataLabels.value.offsetY,this.radialDataLabels.name.offsetY);c.globals.radialSize+=G*P}return r.add(E.g),c.config.plotOptions.radialBar.hollow.position==="front"&&(E.g.add(E.elHollow),E.dataLabels&&E.g.add(E.dataLabels)),A.add(r),A}},{key:"drawTracks",value:function(s){var c=this.w,d=new ur(this.ctx),A=d.group({class:"apexcharts-tracks"}),r=new Rc(this.ctx),y=new Yd(this.ctx),b=this.getStrokeWidth(s);s.size=s.size-b/2;for(var x=0;x<s.series.length;x++){var B=d.group({class:"apexcharts-radialbar-track apexcharts-track"});A.add(B),B.attr({rel:x+1}),s.size=s.size-b-this.margin;var T=c.config.plotOptions.radialBar.track,E=y.fillPath({seriesNumber:0,size:s.size,fillColors:Array.isArray(T.background)?T.background[x]:T.background,solid:!0}),R=this.trackStartAngle,P=this.trackEndAngle;Math.abs(P)+Math.abs(R)>=360&&(P=360-Math.abs(this.startAngle)-.1);var G=d.drawPath({d:"",stroke:E,strokeWidth:b*parseInt(T.strokeWidth,10)/100,fill:"none",strokeOpacity:T.opacity,classes:"apexcharts-radialbar-area"});if(T.dropShadow.enabled){var U=T.dropShadow;r.dropShadow(G,U)}B.add(G),G.attr("id","apexcharts-radialbarTrack-"+x),this.animatePaths(G,{centerX:s.centerX,centerY:s.centerY,endAngle:P,startAngle:R,size:s.size,i:x,totalItems:2,animBeginArr:0,dur:0,isTrack:!0})}return A}},{key:"drawArcs",value:function(s){var c=this.w,d=new ur(this.ctx),A=new Yd(this.ctx),r=new Rc(this.ctx),y=d.group(),b=this.getStrokeWidth(s);s.size=s.size-b/2;var x=c.config.plotOptions.radialBar.hollow.background,B=s.size-b*s.series.length-this.margin*s.series.length-b*parseInt(c.config.plotOptions.radialBar.track.strokeWidth,10)/100/2,T=B-c.config.plotOptions.radialBar.hollow.margin;c.config.plotOptions.radialBar.hollow.image!==void 0&&(x=this.drawHollowImage(s,y,B,x));var E=this.drawHollow({size:T,centerX:s.centerX,centerY:s.centerY,fill:x||"transparent"});if(c.config.plotOptions.radialBar.hollow.dropShadow.enabled){var R=c.config.plotOptions.radialBar.hollow.dropShadow;r.dropShadow(E,R)}var P=1;!this.radialDataLabels.total.show&&c.globals.series.length>1&&(P=0);var G=null;if(this.radialDataLabels.show){var U=c.globals.dom.Paper.findOne(".apexcharts-datalabels-group");G=this.renderInnerDataLabels(U,this.radialDataLabels,{hollowSize:B,centerX:s.centerX,centerY:s.centerY,opacity:P})}c.config.plotOptions.radialBar.hollow.position==="back"&&(y.add(E),G&&y.add(G));var Q=!1;c.config.plotOptions.radialBar.inverseOrder&&(Q=!0);for(var q=Q?s.series.length-1:0;Q?q>=0:q<s.series.length;Q?q--:q++){var ne=d.group({class:"apexcharts-series apexcharts-radial-series",seriesName:ni.escapeString(c.globals.seriesNames[q])});y.add(ne),ne.attr({rel:q+1,"data:realIndex":q}),this.ctx.series.addCollapsedClassToSeries(ne,q),s.size=s.size-b-this.margin;var re=A.fillPath({seriesNumber:q,size:s.size,value:s.series[q]}),pe=this.startAngle,fe=void 0,he=ni.negToZero(s.series[q]>100?100:s.series[q])/100,be=Math.round(this.totalAngle*he)+this.startAngle,Se=void 0;c.globals.dataChanged&&(fe=this.startAngle,Se=Math.round(this.totalAngle*ni.negToZero(c.globals.previousPaths[q])/100)+fe),Math.abs(be)+Math.abs(pe)>360&&(be-=.01),Math.abs(Se)+Math.abs(fe)>360&&(Se-=.01);var oe=be-pe,ye=Array.isArray(c.config.stroke.dashArray)?c.config.stroke.dashArray[q]:c.config.stroke.dashArray,Me=d.drawPath({d:"",stroke:re,strokeWidth:b,fill:"none",fillOpacity:c.config.fill.opacity,classes:"apexcharts-radialbar-area apexcharts-radialbar-slice-"+q,strokeDashArray:ye});if(ur.setAttrs(Me.node,{"data:angle":oe,"data:value":s.series[q]}),c.config.chart.dropShadow.enabled){var Be=c.config.chart.dropShadow;r.dropShadow(Me,Be,q)}if(r.setSelectionFilter(Me,0,q),this.addListeners(Me,this.radialDataLabels),ne.add(Me),Me.attr({index:0,j:q}),this.barLabels.enabled){var Pe=ni.polarToCartesian(s.centerX,s.centerY,s.size,pe),De=this.barLabels.formatter(c.globals.seriesNames[q],{seriesIndex:q,w:c}),et=["apexcharts-radialbar-label"];this.barLabels.onClick||et.push("apexcharts-no-click");var Ye=this.barLabels.useSeriesColors?c.globals.colors[q]:c.config.chart.foreColor;Ye||(Ye=c.config.chart.foreColor);var bt=Pe.x+this.barLabels.offsetX,pt=Pe.y+this.barLabels.offsetY,Qt=d.drawText({x:bt,y:pt,text:De,textAnchor:"end",dominantBaseline:"middle",fontFamily:this.barLabels.fontFamily,fontWeight:this.barLabels.fontWeight,fontSize:this.barLabels.fontSize,foreColor:Ye,cssClass:et.join(" ")});Qt.on("click",this.onBarLabelClick),Qt.attr({rel:q+1}),pe!==0&&Qt.attr({"transform-origin":"".concat(bt," ").concat(pt),transform:"rotate(".concat(pe," 0 0)")}),ne.add(Qt)}var Ie=0;!this.initialAnim||c.globals.resized||c.globals.dataChanged||(Ie=c.config.chart.animations.speed),c.globals.dataChanged&&(Ie=c.config.chart.animations.dynamicAnimation.speed),this.animDur=Ie/(1.2*s.series.length)+this.animDur,this.animBeginArr.push(this.animDur),this.animatePaths(Me,{centerX:s.centerX,centerY:s.centerY,endAngle:be,startAngle:pe,prevEndAngle:Se,prevStartAngle:fe,size:s.size,i:q,totalItems:2,animBeginArr:this.animBeginArr,dur:Ie,shouldSetPrevPaths:!0})}return{g:y,elHollow:E,dataLabels:G}}},{key:"drawHollow",value:function(s){var c=new ur(this.ctx).drawCircle(2*s.size);return c.attr({class:"apexcharts-radialbar-hollow",cx:s.centerX,cy:s.centerY,r:s.size,fill:s.fill}),c}},{key:"drawHollowImage",value:function(s,c,d,A){var r=this.w,y=new Yd(this.ctx),b=ni.randomId(),x=r.config.plotOptions.radialBar.hollow.image;if(r.config.plotOptions.radialBar.hollow.imageClipped)y.clippedImgArea({width:d,height:d,image:x,patternID:"pattern".concat(r.globals.cuid).concat(b)}),A="url(#pattern".concat(r.globals.cuid).concat(b,")");else{var B=r.config.plotOptions.radialBar.hollow.imageWidth,T=r.config.plotOptions.radialBar.hollow.imageHeight;if(B===void 0&&T===void 0){var E=r.globals.dom.Paper.image(x,function(P){this.move(s.centerX-P.width/2+r.config.plotOptions.radialBar.hollow.imageOffsetX,s.centerY-P.height/2+r.config.plotOptions.radialBar.hollow.imageOffsetY)});c.add(E)}else{var R=r.globals.dom.Paper.image(x,function(P){this.move(s.centerX-B/2+r.config.plotOptions.radialBar.hollow.imageOffsetX,s.centerY-T/2+r.config.plotOptions.radialBar.hollow.imageOffsetY),this.size(B,T)});c.add(R)}}return A}},{key:"getStrokeWidth",value:function(s){var c=this.w;return s.size*(100-parseInt(c.config.plotOptions.radialBar.hollow.size,10))/100/(s.series.length+1)-this.margin}},{key:"onBarLabelClick",value:function(s){var c=parseInt(s.target.getAttribute("rel"),10)-1,d=this.barLabels.onClick,A=this.w;d&&d(A.globals.seriesNames[c],{w:A,seriesIndex:c})}}]),i}(),cD=function(a){Yy(i,lm);var e=Xy(i);function i(){return en(this,i),e.apply(this,arguments)}return tn(i,[{key:"draw",value:function(s,c){var d=this.w,A=new ur(this.ctx);this.rangeBarOptions=this.w.config.plotOptions.rangeBar,this.series=s,this.seriesRangeStart=d.globals.seriesRangeStart,this.seriesRangeEnd=d.globals.seriesRangeEnd,this.barHelpers.initVariables(s);for(var r=A.group({class:"apexcharts-rangebar-series apexcharts-plot-series"}),y=0;y<s.length;y++){var b,x,B,T,E=void 0,R=void 0,P=d.globals.comboCharts?c[y]:y,G=this.barHelpers.getGroupIndex(P).columnGroupIndex,U=A.group({class:"apexcharts-series",seriesName:ni.escapeString(d.globals.seriesNames[P]),rel:y+1,"data:realIndex":P});this.ctx.series.addCollapsedClassToSeries(U,P),s[y].length>0&&(this.visibleI=this.visibleI+1);var Q=0,q=0,ne=0;this.yRatio.length>1&&(this.yaxisIndex=d.globals.seriesYAxisReverseMap[P][0],ne=P);var re=this.barHelpers.initialPositions(P);R=re.y,T=re.zeroW,E=re.x,q=re.barWidth,Q=re.barHeight,b=re.xDivision,x=re.yDivision,B=re.zeroH;for(var pe=A.group({class:"apexcharts-datalabels","data:realIndex":P}),fe=A.group({class:"apexcharts-rangebar-goals-markers"}),he=0;he<d.globals.dataPoints;he++){var be=this.barHelpers.getStrokeWidth(y,he,P),Se=this.seriesRangeStart[y][he],oe=this.seriesRangeEnd[y][he],ye=null,Me=null,Be=null,Pe={x:E,y:R,strokeWidth:be,elSeries:U},De=this.seriesLen;if(d.config.plotOptions.bar.rangeBarGroupRows&&(De=1),d.config.series[y].data[he]===void 0)break;if(this.isHorizontal){Be=R+Q*this.visibleI;var et=(x-Q*De)/2;if(d.config.series[y].data[he].x){var Ye=this.detectOverlappingBars({i:y,j:he,barYPosition:Be,srty:et,barHeight:Q,yDivision:x,initPositions:re});Q=Ye.barHeight,Be=Ye.barYPosition}q=(ye=this.drawRangeBarPaths(Tr({indexes:{i:y,j:he,realIndex:P},barHeight:Q,barYPosition:Be,zeroW:T,yDivision:x,y1:Se,y2:oe},Pe))).barWidth}else{d.globals.isXNumeric&&(E=(d.globals.seriesX[y][he]-d.globals.minX)/this.xRatio-q/2),Me=E+q*this.visibleI;var bt=(b-q*De)/2;if(d.config.series[y].data[he].x){var pt=this.detectOverlappingBars({i:y,j:he,barXPosition:Me,srtx:bt,barWidth:q,xDivision:b,initPositions:re});q=pt.barWidth,Me=pt.barXPosition}Q=(ye=this.drawRangeColumnPaths(Tr({indexes:{i:y,j:he,realIndex:P,translationsIndex:ne},barWidth:q,barXPosition:Me,zeroH:B,xDivision:b},Pe))).barHeight}var Qt=this.barHelpers.drawGoalLine({barXPosition:ye.barXPosition,barYPosition:Be,goalX:ye.goalX,goalY:ye.goalY,barHeight:Q,barWidth:q});Qt&&fe.add(Qt),R=ye.y,E=ye.x;var Ie=this.barHelpers.getPathFillColor(s,y,he,P);this.renderSeries({realIndex:P,pathFill:Ie.color,lineFill:Ie.useRangeColor?Ie.color:d.globals.stroke.colors[P],j:he,i:y,x:E,y:R,y1:Se,y2:oe,pathFrom:ye.pathFrom,pathTo:ye.pathTo,strokeWidth:be,elSeries:U,series:s,barHeight:Q,barWidth:q,barXPosition:Me,barYPosition:Be,columnGroupIndex:G,elDataLabelsWrap:pe,elGoalsMarkers:fe,visibleSeries:this.visibleI,type:"rangebar"})}r.add(U)}return r}},{key:"detectOverlappingBars",value:function(s){var c=s.i,d=s.j,A=s.barYPosition,r=s.barXPosition,y=s.srty,b=s.srtx,x=s.barHeight,B=s.barWidth,T=s.yDivision,E=s.xDivision,R=s.initPositions,P=this.w,G=[],U=P.config.series[c].data[d].rangeName,Q=P.config.series[c].data[d].x,q=Array.isArray(Q)?Q.join(" "):Q,ne=P.globals.labels.map(function(pe){return Array.isArray(pe)?pe.join(" "):pe}).indexOf(q),re=P.globals.seriesRange[c].findIndex(function(pe){return pe.x===q&&pe.overlaps.length>0});return this.isHorizontal?(A=P.config.plotOptions.bar.rangeBarGroupRows?y+T*ne:y+x*this.visibleI+T*ne,re>-1&&!P.config.plotOptions.bar.rangeBarOverlap&&(G=P.globals.seriesRange[c][re].overlaps).indexOf(U)>-1&&(A=(x=R.barHeight/G.length)*this.visibleI+T*(100-parseInt(this.barOptions.barHeight,10))/100/2+x*(this.visibleI+G.indexOf(U))+T*ne)):(ne>-1&&!P.globals.timescaleLabels.length&&(r=P.config.plotOptions.bar.rangeBarGroupRows?b+E*ne:b+B*this.visibleI+E*ne),re>-1&&!P.config.plotOptions.bar.rangeBarOverlap&&(G=P.globals.seriesRange[c][re].overlaps).indexOf(U)>-1&&(r=(B=R.barWidth/G.length)*this.visibleI+E*(100-parseInt(this.barOptions.barWidth,10))/100/2+B*(this.visibleI+G.indexOf(U))+E*ne)),{barYPosition:A,barXPosition:r,barHeight:x,barWidth:B}}},{key:"drawRangeColumnPaths",value:function(s){var c=s.indexes,d=s.x,A=s.xDivision,r=s.barWidth,y=s.barXPosition,b=s.zeroH,x=this.w,B=c.i,T=c.j,E=c.realIndex,R=c.translationsIndex,P=this.yRatio[R],G=this.getRangeValue(E,T),U=Math.min(G.start,G.end),Q=Math.max(G.start,G.end);this.series[B][T]===void 0||this.series[B][T]===null?U=b:(U=b-U/P,Q=b-Q/P);var q=Math.abs(Q-U),ne=this.barHelpers.getColumnPaths({barXPosition:y,barWidth:r,y1:U,y2:Q,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,realIndex:E,i:E,j:T,w:x});if(x.globals.isXNumeric){var re=this.getBarXForNumericXAxis({x:d,j:T,realIndex:E,barWidth:r});d=re.x,y=re.barXPosition}else d+=A;return{pathTo:ne.pathTo,pathFrom:ne.pathFrom,barHeight:q,x:d,y:G.start<0&&G.end<0?U:Q,goalY:this.barHelpers.getGoalValues("y",null,b,B,T,R),barXPosition:y}}},{key:"preventBarOverflow",value:function(s){var c=this.w;return s<0&&(s=0),s>c.globals.gridWidth&&(s=c.globals.gridWidth),s}},{key:"drawRangeBarPaths",value:function(s){var c=s.indexes,d=s.y,A=s.y1,r=s.y2,y=s.yDivision,b=s.barHeight,x=s.barYPosition,B=s.zeroW,T=this.w,E=c.realIndex,R=c.j,P=this.preventBarOverflow(B+A/this.invertedYRatio),G=this.preventBarOverflow(B+r/this.invertedYRatio),U=this.getRangeValue(E,R),Q=Math.abs(G-P),q=this.barHelpers.getBarpaths({barYPosition:x,barHeight:b,x1:P,x2:G,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,i:E,realIndex:E,j:R,w:T});return T.globals.isXNumeric||(d+=y),{pathTo:q.pathTo,pathFrom:q.pathFrom,barWidth:Q,x:U.start<0&&U.end<0?P:G,goalX:this.barHelpers.getGoalValues("x",B,null,E,R),y:d}}},{key:"getRangeValue",value:function(s,c){var d=this.w;return{start:d.globals.seriesRangeStart[s][c],end:d.globals.seriesRangeEnd[s][c]}}}]),i}(),uD=function(){function a(e){en(this,a),this.w=e.w,this.lineCtx=e}return tn(a,[{key:"sameValueSeriesFix",value:function(e,i){var s=this.w;if((s.config.fill.type==="gradient"||s.config.fill.type[e]==="gradient")&&new nl(this.lineCtx.ctx,s).seriesHaveSameValues(e)){var c=i[e].slice();c[c.length-1]=c[c.length-1]+1e-6,i[e]=c}return i}},{key:"calculatePoints",value:function(e){var i=e.series,s=e.realIndex,c=e.x,d=e.y,A=e.i,r=e.j,y=e.prevY,b=this.w,x=[],B=[],T=this.lineCtx.categoryAxisCorrection+b.config.markers.offsetX;return b.globals.isXNumeric&&(T=(b.globals.seriesX[s][0]-b.globals.minX)/this.lineCtx.xRatio+b.config.markers.offsetX),r===0&&(x.push(T),B.push(ni.isNumber(i[A][0])?y+b.config.markers.offsetY:null)),x.push(c+b.config.markers.offsetX),B.push(ni.isNumber(i[A][r+1])?d+b.config.markers.offsetY:null),{x,y:B}}},{key:"checkPreviousPaths",value:function(e){for(var i=e.pathFromLine,s=e.pathFromArea,c=e.realIndex,d=this.w,A=0;A<d.globals.previousPaths.length;A++){var r=d.globals.previousPaths[A];(r.type==="line"||r.type==="area")&&r.paths.length>0&&parseInt(r.realIndex,10)===parseInt(c,10)&&(r.type==="line"?(this.lineCtx.appendPathFrom=!1,i=d.globals.previousPaths[A].paths[0].d):r.type==="area"&&(this.lineCtx.appendPathFrom=!1,s=d.globals.previousPaths[A].paths[0].d,d.config.stroke.show&&d.globals.previousPaths[A].paths[1]&&(i=d.globals.previousPaths[A].paths[1].d)))}return{pathFromLine:i,pathFromArea:s}}},{key:"determineFirstPrevY",value:function(e){var i,s,c,d=e.i,A=e.realIndex,r=e.series,y=e.prevY,b=e.lineYPosition,x=e.translationsIndex,B=this.w,T=B.config.chart.stacked&&!B.globals.comboCharts||B.config.chart.stacked&&B.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||((i=this.w.config.series[A])===null||i===void 0?void 0:i.type)==="bar"||((s=this.w.config.series[A])===null||s===void 0?void 0:s.type)==="column");if(((c=r[d])===null||c===void 0?void 0:c[0])!==void 0)y=(b=T&&d>0?this.lineCtx.prevSeriesY[d-1][0]:this.lineCtx.zeroY)-r[d][0]/this.lineCtx.yRatio[x]+2*(this.lineCtx.isReversed?r[d][0]/this.lineCtx.yRatio[x]:0);else if(T&&d>0&&r[d][0]===void 0){for(var E=d-1;E>=0;E--)if(r[E][0]!==null&&r[E][0]!==void 0){y=b=this.lineCtx.prevSeriesY[E][0];break}}return{prevY:y,lineYPosition:b}}}]),a}(),hD=function(a){for(var e,i,s,c,d=function(x){for(var B=[],T=x[0],E=x[1],R=B[0]=ab(T,E),P=1,G=x.length-1;P<G;P++)T=E,E=x[P+1],B[P]=.5*(R+(R=ab(T,E)));return B[P]=R,B}(a),A=a.length-1,r=[],y=0;y<A;y++)s=ab(a[y],a[y+1]),Math.abs(s)<1e-6?d[y]=d[y+1]=0:(c=(e=d[y]/s)*e+(i=d[y+1]/s)*i)>9&&(c=3*s/Math.sqrt(c),d[y]=c*e,d[y+1]=c*i);for(var b=0;b<=A;b++)c=(a[Math.min(A,b+1)][0]-a[Math.max(0,b-1)][0])/(6*(1+d[b]*d[b])),r.push([c||0,d[b]*c||0]);return r},dD=function(a){var e=hD(a),i=a[1],s=a[0],c=[],d=e[1],A=e[0];c.push(s,[s[0]+A[0],s[1]+A[1],i[0]-d[0],i[1]-d[1],i[0],i[1]]);for(var r=2,y=e.length;r<y;r++){var b=a[r],x=e[r];c.push([b[0]-x[0],b[1]-x[1],b[0],b[1]])}return c},AD=function(a,e,i){var s=a.slice(e,i);if(e){if(i-e>1&&s[1].length<6){var c=s[0].length;s[1]=[2*s[0][c-2]-s[0][c-4],2*s[0][c-1]-s[0][c-3]].concat(s[1])}s[0]=s[0].slice(-2)}return s};function ab(a,e){return(e[1]-a[1])/(e[0]-a[0])}var lb=function(){function a(e,i,s){en(this,a),this.ctx=e,this.w=e.w,this.xyRatios=i,this.pointsChart=!(this.w.config.chart.type!=="bubble"&&this.w.config.chart.type!=="scatter")||s,this.scatter=new VT(this.ctx),this.noNegatives=this.w.globals.minX===Number.MAX_VALUE,this.lineHelpers=new uD(this),this.markers=new Am(this.ctx),this.prevSeriesY=[],this.categoryAxisCorrection=0,this.yaxisIndex=0}return tn(a,[{key:"draw",value:function(e,i,s,c){var d,A=this.w,r=new ur(this.ctx),y=A.globals.comboCharts?i:A.config.chart.type,b=r.group({class:"apexcharts-".concat(y,"-series apexcharts-plot-series")}),x=new nl(this.ctx,A);this.yRatio=this.xyRatios.yRatio,this.zRatio=this.xyRatios.zRatio,this.xRatio=this.xyRatios.xRatio,this.baseLineY=this.xyRatios.baseLineY,e=x.getLogSeries(e),this.yRatio=x.getLogYRatios(this.yRatio),this.prevSeriesY=[];for(var B=[],T=0;T<e.length;T++){e=this.lineHelpers.sameValueSeriesFix(T,e);var E=A.globals.comboCharts?s[T]:T,R=this.yRatio.length>1?E:0;this._initSerieVariables(e,T,E);var P=[],G=[],U=[],Q=A.globals.padHorizontal+this.categoryAxisCorrection;this.ctx.series.addCollapsedClassToSeries(this.elSeries,E),A.globals.isXNumeric&&A.globals.seriesX.length>0&&(Q=(A.globals.seriesX[E][0]-A.globals.minX)/this.xRatio),U.push(Q);var q,ne=Q,re=void 0,pe=ne,fe=this.zeroY,he=this.zeroY;fe=this.lineHelpers.determineFirstPrevY({i:T,realIndex:E,series:e,prevY:fe,lineYPosition:0,translationsIndex:R}).prevY,A.config.stroke.curve==="monotoneCubic"&&e[T][0]===null?P.push(null):P.push(fe),q=fe,y==="rangeArea"&&(re=he=this.lineHelpers.determineFirstPrevY({i:T,realIndex:E,series:c,prevY:he,lineYPosition:0,translationsIndex:R}).prevY,G.push(P[0]!==null?he:null));var be=this._calculatePathsFrom({type:y,series:e,i:T,realIndex:E,translationsIndex:R,prevX:pe,prevY:fe,prevY2:he}),Se=[P[0]],oe=[G[0]],ye={type:y,series:e,realIndex:E,translationsIndex:R,i:T,x:Q,y:1,pX:ne,pY:q,pathsFrom:be,linePaths:[],areaPaths:[],seriesIndex:s,lineYPosition:0,xArrj:U,yArrj:P,y2Arrj:G,seriesRangeEnd:c},Me=this._iterateOverDataPoints(Tr(Tr({},ye),{},{iterations:y==="rangeArea"?e[T].length-1:void 0,isRangeStart:!0}));if(y==="rangeArea"){for(var Be=this._calculatePathsFrom({series:c,i:T,realIndex:E,prevX:pe,prevY:he}),Pe=this._iterateOverDataPoints(Tr(Tr({},ye),{},{series:c,xArrj:[Q],yArrj:Se,y2Arrj:oe,pY:re,areaPaths:Me.areaPaths,pathsFrom:Be,iterations:c[T].length-1,isRangeStart:!1})),De=Me.linePaths.length/2,et=0;et<De;et++)Me.linePaths[et]=Pe.linePaths[et+De]+Me.linePaths[et];Me.linePaths.splice(De),Me.pathFromLine=Pe.pathFromLine+Me.pathFromLine}else Me.pathFromArea+="z";this._handlePaths({type:y,realIndex:E,i:T,paths:Me}),this.elSeries.add(this.elPointsMain),this.elSeries.add(this.elDataLabelsWrap),B.push(this.elSeries)}if(((d=A.config.series[0])===null||d===void 0?void 0:d.zIndex)!==void 0&&B.sort(function(pt,Qt){return Number(pt.node.getAttribute("zIndex"))-Number(Qt.node.getAttribute("zIndex"))}),A.config.chart.stacked)for(var Ye=B.length-1;Ye>=0;Ye--)b.add(B[Ye]);else for(var bt=0;bt<B.length;bt++)b.add(B[bt]);return b}},{key:"_initSerieVariables",value:function(e,i,s){var c=this.w,d=new ur(this.ctx);this.xDivision=c.globals.gridWidth/(c.globals.dataPoints-(c.config.xaxis.tickPlacement==="on"?1:0)),this.strokeWidth=Array.isArray(c.config.stroke.width)?c.config.stroke.width[s]:c.config.stroke.width;var A=0;if(this.yRatio.length>1&&(this.yaxisIndex=c.globals.seriesYAxisReverseMap[s],A=s),this.isReversed=c.config.yaxis[this.yaxisIndex]&&c.config.yaxis[this.yaxisIndex].reversed,this.zeroY=c.globals.gridHeight-this.baseLineY[A]-(this.isReversed?c.globals.gridHeight:0)+(this.isReversed?2*this.baseLineY[A]:0),this.areaBottomY=this.zeroY,(this.zeroY>c.globals.gridHeight||c.config.plotOptions.area.fillTo==="end")&&(this.areaBottomY=c.globals.gridHeight),this.categoryAxisCorrection=this.xDivision/2,this.elSeries=d.group({class:"apexcharts-series",zIndex:c.config.series[s].zIndex!==void 0?c.config.series[s].zIndex:s,seriesName:ni.escapeString(c.globals.seriesNames[s])}),this.elPointsMain=d.group({class:"apexcharts-series-markers-wrap","data:realIndex":s}),c.globals.hasNullValues){var r=this.markers.plotChartMarkers({pointsPos:{x:[0],y:[c.globals.gridHeight+c.globals.markers.largestSize]},seriesIndex:i,j:0,pSize:.1,alwaysDrawMarker:!0,isVirtualPoint:!0});r!==null&&this.elPointsMain.add(r)}this.elDataLabelsWrap=d.group({class:"apexcharts-datalabels","data:realIndex":s});var y=e[i].length===c.globals.dataPoints;this.elSeries.attr({"data:longestSeries":y,rel:i+1,"data:realIndex":s}),this.appendPathFrom=!0}},{key:"_calculatePathsFrom",value:function(e){var i,s,c,d,A=e.type,r=e.series,y=e.i,b=e.realIndex,x=e.translationsIndex,B=e.prevX,T=e.prevY,E=e.prevY2,R=this.w,P=new ur(this.ctx);if(r[y][0]===null){for(var G=0;G<r[y].length;G++)if(r[y][G]!==null){B=this.xDivision*G,T=this.zeroY-r[y][G]/this.yRatio[x],i=P.move(B,T),s=P.move(B,this.areaBottomY);break}}else i=P.move(B,T),A==="rangeArea"&&(i=P.move(B,E)+P.line(B,T)),s=P.move(B,this.areaBottomY)+P.line(B,T);if(c=P.move(0,this.areaBottomY)+P.line(0,this.areaBottomY),d=P.move(0,this.areaBottomY)+P.line(0,this.areaBottomY),R.globals.previousPaths.length>0){var U=this.lineHelpers.checkPreviousPaths({pathFromLine:c,pathFromArea:d,realIndex:b});c=U.pathFromLine,d=U.pathFromArea}return{prevX:B,prevY:T,linePath:i,areaPath:s,pathFromLine:c,pathFromArea:d}}},{key:"_handlePaths",value:function(e){var i=e.type,s=e.realIndex,c=e.i,d=e.paths,A=this.w,r=new ur(this.ctx),y=new Yd(this.ctx);this.prevSeriesY.push(d.yArrj),A.globals.seriesXvalues[s]=d.xArrj,A.globals.seriesYvalues[s]=d.yArrj;var b=A.config.forecastDataPoints;if(b.count>0&&i!=="rangeArea"){var x=A.globals.seriesXvalues[s][A.globals.seriesXvalues[s].length-b.count-1],B=r.drawRect(x,0,A.globals.gridWidth,A.globals.gridHeight,0);A.globals.dom.elForecastMask.appendChild(B.node);var T=r.drawRect(0,0,x,A.globals.gridHeight,0);A.globals.dom.elNonForecastMask.appendChild(T.node)}this.pointsChart||A.globals.delayedElements.push({el:this.elPointsMain.node,index:s});var E={i:c,realIndex:s,animationDelay:c,initialSpeed:A.config.chart.animations.speed,dataChangeSpeed:A.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(i)};if(i==="area")for(var R=y.fillPath({seriesNumber:s}),P=0;P<d.areaPaths.length;P++){var G=r.renderPaths(Tr(Tr({},E),{},{pathFrom:d.pathFromArea,pathTo:d.areaPaths[P],stroke:"none",strokeWidth:0,strokeLineCap:null,fill:R}));this.elSeries.add(G)}if(A.config.stroke.show&&!this.pointsChart){var U=null;if(i==="line")U=y.fillPath({seriesNumber:s,i:c});else if(A.config.stroke.fill.type==="solid")U=A.globals.stroke.colors[s];else{var Q=A.config.fill;A.config.fill=A.config.stroke.fill,U=y.fillPath({seriesNumber:s,i:c}),A.config.fill=Q}for(var q=0;q<d.linePaths.length;q++){var ne=U;i==="rangeArea"&&(ne=y.fillPath({seriesNumber:s}));var re=Tr(Tr({},E),{},{pathFrom:d.pathFromLine,pathTo:d.linePaths[q],stroke:U,strokeWidth:this.strokeWidth,strokeLineCap:A.config.stroke.lineCap,fill:i==="rangeArea"?ne:"none"}),pe=r.renderPaths(re);if(this.elSeries.add(pe),pe.attr("fill-rule","evenodd"),b.count>0&&i!=="rangeArea"){var fe=r.renderPaths(re);fe.node.setAttribute("stroke-dasharray",b.dashArray),b.strokeWidth&&fe.node.setAttribute("stroke-width",b.strokeWidth),this.elSeries.add(fe),fe.attr("clip-path","url(#forecastMask".concat(A.globals.cuid,")")),pe.attr("clip-path","url(#nonForecastMask".concat(A.globals.cuid,")"))}}}}},{key:"_iterateOverDataPoints",value:function(e){var i,s,c=this,d=e.type,A=e.series,r=e.iterations,y=e.realIndex,b=e.translationsIndex,x=e.i,B=e.x,T=e.y,E=e.pX,R=e.pY,P=e.pathsFrom,G=e.linePaths,U=e.areaPaths,Q=e.seriesIndex,q=e.lineYPosition,ne=e.xArrj,re=e.yArrj,pe=e.y2Arrj,fe=e.isRangeStart,he=e.seriesRangeEnd,be=this.w,Se=new ur(this.ctx),oe=this.yRatio,ye=P.prevY,Me=P.linePath,Be=P.areaPath,Pe=P.pathFromLine,De=P.pathFromArea,et=ni.isNumber(be.globals.minYArr[y])?be.globals.minYArr[y]:be.globals.minY;r||(r=be.globals.dataPoints>1?be.globals.dataPoints-1:be.globals.dataPoints);var Ye=function(tt,Ut){return Ut-tt/oe[b]+2*(c.isReversed?tt/oe[b]:0)},bt=T,pt=be.config.chart.stacked&&!be.globals.comboCharts||be.config.chart.stacked&&be.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||((i=this.w.config.series[y])===null||i===void 0?void 0:i.type)==="bar"||((s=this.w.config.series[y])===null||s===void 0?void 0:s.type)==="column"),Qt=be.config.stroke.curve;Array.isArray(Qt)&&(Qt=Array.isArray(Q)?Qt[Q[x]]:Qt[x]);for(var Ie,ot=0,ut=0;ut<r&&A[x].length!==0;ut++){var mt=A[x][ut+1]===void 0||A[x][ut+1]===null;if(be.globals.isXNumeric){var Ct=be.globals.seriesX[y][ut+1];be.globals.seriesX[y][ut+1]===void 0&&(Ct=be.globals.seriesX[y][r-1]),B=(Ct-be.globals.minX)/this.xRatio}else B+=this.xDivision;pt?x>0&&be.globals.collapsedSeries.length<be.config.series.length-1?q=this.prevSeriesY[function(tt){for(var Ut=tt;Ut>0;Ut--){if(!(be.globals.collapsedSeriesIndices.indexOf((Q==null?void 0:Q[Ut])||Ut)>-1))return Ut;Ut--}return 0}(x-1)][ut+1]:q=this.zeroY:q=this.zeroY,mt?T=Ye(et,q):(T=Ye(A[x][ut+1],q),d==="rangeArea"&&(bt=Ye(he[x][ut+1],q))),ne.push(A[x][ut+1]===null?null:B),!mt||be.config.stroke.curve!=="smooth"&&be.config.stroke.curve!=="monotoneCubic"?(re.push(T),pe.push(bt)):(re.push(null),pe.push(null));var rt=this.lineHelpers.calculatePoints({series:A,x:B,y:T,realIndex:y,i:x,j:ut,prevY:ye}),Bt=this._createPaths({type:d,series:A,i:x,realIndex:y,j:ut,x:B,y:T,y2:bt,xArrj:ne,yArrj:re,y2Arrj:pe,pX:E,pY:R,pathState:ot,segmentStartX:Ie,linePath:Me,areaPath:Be,linePaths:G,areaPaths:U,curve:Qt,isRangeStart:fe});U=Bt.areaPaths,G=Bt.linePaths,E=Bt.pX,R=Bt.pY,ot=Bt.pathState,Ie=Bt.segmentStartX,Be=Bt.areaPath,Me=Bt.linePath,!this.appendPathFrom||be.globals.hasNullValues||Qt==="monotoneCubic"&&d==="rangeArea"||(Pe+=Se.line(B,this.areaBottomY),De+=Se.line(B,this.areaBottomY)),this.handleNullDataPoints(A,rt,x,ut,y),this._handleMarkersAndLabels({type:d,pointsPos:rt,i:x,j:ut,realIndex:y,isRangeStart:fe})}return{yArrj:re,xArrj:ne,pathFromArea:De,areaPaths:U,pathFromLine:Pe,linePaths:G,linePath:Me,areaPath:Be}}},{key:"_handleMarkersAndLabels",value:function(e){var i=e.type,s=e.pointsPos,c=e.isRangeStart,d=e.i,A=e.j,r=e.realIndex,y=this.w,b=new am(this.ctx);if(this.pointsChart)this.scatter.draw(this.elSeries,A,{realIndex:r,pointsPos:s,zRatio:this.zRatio,elParent:this.elPointsMain});else{y.globals.series[d].length>1&&this.elPointsMain.node.classList.add("apexcharts-element-hidden");var x=this.markers.plotChartMarkers({pointsPos:s,seriesIndex:r,j:A+1});x!==null&&this.elPointsMain.add(x)}var B=b.drawDataLabel({type:i,isRangeStart:c,pos:s,i:r,j:A+1});B!==null&&this.elDataLabelsWrap.add(B)}},{key:"_createPaths",value:function(e){var i=e.type,s=e.series,c=e.i;e.realIndex;var d,A=e.j,r=e.x,y=e.y,b=e.xArrj,x=e.yArrj,B=e.y2,T=e.y2Arrj,E=e.pX,R=e.pY,P=e.pathState,G=e.segmentStartX,U=e.linePath,Q=e.areaPath,q=e.linePaths,ne=e.areaPaths,re=e.curve,pe=e.isRangeStart,fe=new ur(this.ctx),he=this.areaBottomY,be=i==="rangeArea",Se=i==="rangeArea"&&pe;switch(re){case"monotoneCubic":var oe=pe?x:T;switch(P){case 0:if(oe[A+1]===null)break;P=1;case 1:if(!(be?b.length===s[c].length:A===s[c].length-2))break;case 2:var ye=pe?b:b.slice().reverse(),Me=pe?oe:oe.slice().reverse(),Be=(d=Me,ye.map(function(Ct,rt){return[Ct,d[rt]]}).filter(function(Ct){return Ct[1]!==null})),Pe=Be.length>1?dD(Be):Be,De=[];be&&(Se?ne=Be:De=ne.reverse());var et=0,Ye=0;if(function(Ct,rt){for(var Bt=function(qe){var Ke=[],Pt=0;return qe.forEach(function(It){It!==null?Pt++:Pt>0&&(Ke.push(Pt),Pt=0)}),Pt>0&&Ke.push(Pt),Ke}(Ct),tt=[],Ut=0,Ai=0;Ut<Bt.length;Ai+=Bt[Ut++])tt[Ut]=AD(rt,Ai,Ai+Bt[Ut]);return tt}(Me,Pe).forEach(function(Ct){et++;var rt=function(Ut){for(var Ai="",qe=0;qe<Ut.length;qe++){var Ke=Ut[qe],Pt=Ke.length;Pt>4?(Ai+="C".concat(Ke[0],", ").concat(Ke[1]),Ai+=", ".concat(Ke[2],", ").concat(Ke[3]),Ai+=", ".concat(Ke[4],", ").concat(Ke[5])):Pt>2&&(Ai+="S".concat(Ke[0],", ").concat(Ke[1]),Ai+=", ".concat(Ke[2],", ").concat(Ke[3]))}return Ai}(Ct),Bt=Ye,tt=(Ye+=Ct.length)-1;Se?U=fe.move(Be[Bt][0],Be[Bt][1])+rt:be?U=fe.move(De[Bt][0],De[Bt][1])+fe.line(Be[Bt][0],Be[Bt][1])+rt+fe.line(De[tt][0],De[tt][1]):(U=fe.move(Be[Bt][0],Be[Bt][1])+rt,Q=U+fe.line(Be[tt][0],he)+fe.line(Be[Bt][0],he)+"z",ne.push(Q)),q.push(U)}),be&&et>1&&!Se){var bt=q.slice(et).reverse();q.splice(et),bt.forEach(function(Ct){return q.push(Ct)})}P=0}break;case"smooth":var pt=.35*(r-E);if(s[c][A]===null)P=0;else switch(P){case 0:if(G=E,U=Se?fe.move(E,T[A])+fe.line(E,R):fe.move(E,R),Q=fe.move(E,R),s[c][A+1]===null||s[c][A+1]===void 0){q.push(U),ne.push(Q);break}if(P=1,A<s[c].length-2){var Qt=fe.curve(E+pt,R,r-pt,y,r,y);U+=Qt,Q+=Qt;break}case 1:if(s[c][A+1]===null)U+=Se?fe.line(E,B):fe.move(E,R),Q+=fe.line(E,he)+fe.line(G,he)+"z",q.push(U),ne.push(Q),P=-1;else{var Ie=fe.curve(E+pt,R,r-pt,y,r,y);U+=Ie,Q+=Ie,A>=s[c].length-2&&(Se&&(U+=fe.curve(r,y,r,y,r,B)+fe.move(r,B)),Q+=fe.curve(r,y,r,y,r,he)+fe.line(G,he)+"z",q.push(U),ne.push(Q),P=-1)}}E=r,R=y;break;default:var ot=function(Ct,rt,Bt){var tt=[];switch(Ct){case"stepline":tt=fe.line(rt,null,"H")+fe.line(null,Bt,"V");break;case"linestep":tt=fe.line(null,Bt,"V")+fe.line(rt,null,"H");break;case"straight":tt=fe.line(rt,Bt)}return tt};if(s[c][A]===null)P=0;else switch(P){case 0:if(G=E,U=Se?fe.move(E,T[A])+fe.line(E,R):fe.move(E,R),Q=fe.move(E,R),s[c][A+1]===null||s[c][A+1]===void 0){q.push(U),ne.push(Q);break}if(P=1,A<s[c].length-2){var ut=ot(re,r,y);U+=ut,Q+=ut;break}case 1:if(s[c][A+1]===null)U+=Se?fe.line(E,B):fe.move(E,R),Q+=fe.line(E,he)+fe.line(G,he)+"z",q.push(U),ne.push(Q),P=-1;else{var mt=ot(re,r,y);U+=mt,Q+=mt,A>=s[c].length-2&&(Se&&(U+=fe.line(r,B)),Q+=fe.line(r,he)+fe.line(G,he)+"z",q.push(U),ne.push(Q),P=-1)}}E=r,R=y}return{linePaths:q,areaPaths:ne,pX:E,pY:R,pathState:P,segmentStartX:G,linePath:U,areaPath:Q}}},{key:"handleNullDataPoints",value:function(e,i,s,c,d){var A=this.w;if(e[s][c]===null&&A.config.markers.showNullDataPoints||e[s].length===1){var r=this.strokeWidth-A.config.markers.strokeWidth/2;r>0||(r=0);var y=this.markers.plotChartMarkers({pointsPos:i,seriesIndex:d,j:c+1,pSize:r,alwaysDrawMarker:!0});y!==null&&this.elPointsMain.add(y)}}}]),a}();window.TreemapSquared={},window.TreemapSquared.generate=function(){function a(r,y,b,x){this.xoffset=r,this.yoffset=y,this.height=x,this.width=b,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(B){var T,E=[],R=this.xoffset,P=this.yoffset,G=d(B)/this.height,U=d(B)/this.width;if(this.width>=this.height)for(T=0;T<B.length;T++)E.push([R,P,R+G,P+B[T]/G]),P+=B[T]/G;else for(T=0;T<B.length;T++)E.push([R,P,R+B[T]/U,P+U]),R+=B[T]/U;return E},this.cutArea=function(B){var T;if(this.width>=this.height){var E=B/this.height,R=this.width-E;T=new a(this.xoffset+E,this.yoffset,R,this.height)}else{var P=B/this.width,G=this.height-P;T=new a(this.xoffset,this.yoffset+P,this.width,G)}return T}}function e(r,y,b,x,B){x=x===void 0?0:x,B=B===void 0?0:B;var T=i(function(E,R){var P,G=[],U=R/d(E);for(P=0;P<E.length;P++)G[P]=E[P]*U;return G}(r,y*b),[],new a(x,B,y,b),[]);return function(E){var R,P,G=[];for(R=0;R<E.length;R++)for(P=0;P<E[R].length;P++)G.push(E[R][P]);return G}(T)}function i(r,y,b,x){var B,T,E;if(r.length!==0)return B=b.shortestEdge(),function(R,P,G){var U;if(R.length===0)return!0;(U=R.slice()).push(P);var Q=s(R,G),q=s(U,G);return Q>=q}(y,T=r[0],B)?(y.push(T),i(r.slice(1),y,b,x)):(E=b.cutArea(d(y),x),x.push(b.getCoordinates(y)),i(r,[],E,x)),x;x.push(b.getCoordinates(y))}function s(r,y){var b=Math.min.apply(Math,r),x=Math.max.apply(Math,r),B=d(r);return Math.max(Math.pow(y,2)*x/Math.pow(B,2),Math.pow(B,2)/(Math.pow(y,2)*b))}function c(r){return r&&r.constructor===Array}function d(r){var y,b=0;for(y=0;y<r.length;y++)b+=r[y];return b}function A(r){var y,b=0;if(c(r[0]))for(y=0;y<r.length;y++)b+=A(r[y]);else b=d(r);return b}return function r(y,b,x,B,T){B=B===void 0?0:B,T=T===void 0?0:T;var E,R,P=[],G=[];if(c(y[0])){for(R=0;R<y.length;R++)P[R]=A(y[R]);for(E=e(P,b,x,B,T),R=0;R<y.length;R++)G.push(r(y[R],E[R][2]-E[R][0],E[R][3]-E[R][1],E[R][0],E[R][1]))}else G=e(y,b,x,B,T);return G}}();var fD=function(){function a(e,i){en(this,a),this.ctx=e,this.w=e.w,this.strokeWidth=this.w.config.stroke.width,this.helpers=new $T(e),this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.labels=[]}return tn(a,[{key:"draw",value:function(e){var i=this,s=this.w,c=new ur(this.ctx),d=new Yd(this.ctx),A=c.group({class:"apexcharts-treemap"});if(s.globals.noData)return A;var r=[];return e.forEach(function(y){var b=y.map(function(x){return Math.abs(x)});r.push(b)}),this.negRange=this.helpers.checkColorRange(),s.config.series.forEach(function(y,b){y.data.forEach(function(x){Array.isArray(i.labels[b])||(i.labels[b]=[]),i.labels[b].push(x.x)})}),window.TreemapSquared.generate(r,s.globals.gridWidth,s.globals.gridHeight).forEach(function(y,b){var x=c.group({class:"apexcharts-series apexcharts-treemap-series",seriesName:ni.escapeString(s.globals.seriesNames[b]),rel:b+1,"data:realIndex":b});if(s.config.chart.dropShadow.enabled){var B=s.config.chart.dropShadow;new Rc(i.ctx).dropShadow(A,B,b)}var T=c.group({class:"apexcharts-data-labels"}),E={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0};y.forEach(function(Pe,De){var et=Pe[0],Ye=Pe[1],bt=Pe[2],pt=Pe[3];E.xMin=Math.min(E.xMin,et),E.yMin=Math.min(E.yMin,Ye),E.xMax=Math.max(E.xMax,bt),E.yMax=Math.max(E.yMax,pt);var Qt=i.helpers.getShadeColor(s.config.chart.type,b,De,i.negRange),Ie=Qt.color,ot=d.fillPath({color:Ie,seriesNumber:b,dataPointIndex:De}),ut=c.drawRect(et,Ye,bt-et,pt-Ye,s.config.plotOptions.treemap.borderRadius,"#fff",1,i.strokeWidth,s.config.plotOptions.treemap.useFillColorAsStroke?Ie:s.globals.stroke.colors[b]);ut.attr({cx:et,cy:Ye,index:b,i:b,j:De,width:bt-et,height:pt-Ye,fill:ot}),ut.node.classList.add("apexcharts-treemap-rect"),i.helpers.addListeners(ut);var mt={x:et+(bt-et)/2,y:Ye+(pt-Ye)/2,width:0,height:0},Ct={x:et,y:Ye,width:bt-et,height:pt-Ye};if(s.config.chart.animations.enabled&&!s.globals.dataChanged){var rt=1;s.globals.resized||(rt=s.config.chart.animations.speed),i.animateTreemap(ut,mt,Ct,rt)}if(s.globals.dataChanged){var Bt=1;i.dynamicAnim.enabled&&s.globals.shouldAnimate&&(Bt=i.dynamicAnim.speed,s.globals.previousPaths[b]&&s.globals.previousPaths[b][De]&&s.globals.previousPaths[b][De].rect&&(mt=s.globals.previousPaths[b][De].rect),i.animateTreemap(ut,mt,Ct,Bt))}var tt=i.getFontSize(Pe),Ut=s.config.dataLabels.formatter(i.labels[b][De],{value:s.globals.series[b][De],seriesIndex:b,dataPointIndex:De,w:s});s.config.plotOptions.treemap.dataLabels.format==="truncate"&&(tt=parseInt(s.config.dataLabels.style.fontSize,10),Ut=i.truncateLabels(Ut,tt,et,Ye,bt,pt));var Ai=null;s.globals.series[b][De]&&(Ai=i.helpers.calculateDataLabels({text:Ut,x:(et+bt)/2,y:(Ye+pt)/2+i.strokeWidth/2+tt/3,i:b,j:De,colorProps:Qt,fontSize:tt,series:e})),s.config.dataLabels.enabled&&Ai&&i.rotateToFitLabel(Ai,tt,Ut,et,Ye,bt,pt),x.add(ut),Ai!==null&&x.add(Ai)});var R=s.config.plotOptions.treemap.seriesTitle;if(s.config.series.length>1&&R&&R.show){var P=s.config.series[b].name||"";if(P&&E.xMin<1/0&&E.yMin<1/0){var G=R.offsetX,U=R.offsetY,Q=R.borderColor,q=R.borderWidth,ne=R.borderRadius,re=R.style,pe=re.color||s.config.chart.foreColor,fe={left:re.padding.left,right:re.padding.right,top:re.padding.top,bottom:re.padding.bottom},he=c.getTextRects(P,re.fontSize,re.fontFamily),be=he.width+fe.left+fe.right,Se=he.height+fe.top+fe.bottom,oe=E.xMin+(G||0),ye=E.yMin+(U||0),Me=c.drawRect(oe,ye,be,Se,ne,re.background,1,q,Q),Be=c.drawText({x:oe+fe.left,y:ye+fe.top+.75*he.height,text:P,fontSize:re.fontSize,fontFamily:re.fontFamily,fontWeight:re.fontWeight,foreColor:pe,cssClass:re.cssClass||""});x.add(Me),x.add(Be)}}x.add(T),A.add(x)}),A}},{key:"getFontSize",value:function(e){var i=this.w,s=function c(d){var A,r=0;if(Array.isArray(d[0]))for(A=0;A<d.length;A++)r+=c(d[A]);else for(A=0;A<d.length;A++)r+=d[A].length;return r}(this.labels)/function c(d){var A,r=0;if(Array.isArray(d[0]))for(A=0;A<d.length;A++)r+=c(d[A]);else for(A=0;A<d.length;A++)r+=1;return r}(this.labels);return function(c,d){var A=c*d,r=Math.pow(A,.5);return Math.min(r/s,parseInt(i.config.dataLabels.style.fontSize,10))}(e[2]-e[0],e[3]-e[1])}},{key:"rotateToFitLabel",value:function(e,i,s,c,d,A,r){var y=new ur(this.ctx),b=y.getTextRects(s,i);if(b.width+this.w.config.stroke.width+5>A-c&&b.width<=r-d){var x=y.rotateAroundCenter(e.node);e.node.setAttribute("transform","rotate(-90 ".concat(x.x," ").concat(x.y,") translate(").concat(b.height/3,")"))}}},{key:"truncateLabels",value:function(e,i,s,c,d,A){var r=new ur(this.ctx),y=r.getTextRects(e,i).width+this.w.config.stroke.width+5>d-s&&A-c>d-s?A-c:d-s,b=r.getTextBasedOnMaxWidth({text:e,maxWidth:y,fontSize:i});return e.length!==b.length&&y/i<5?"":b}},{key:"animateTreemap",value:function(e,i,s,c){var d=new cm(this.ctx);d.animateRect(e,i,s,c,function(){d.animationCompleted(e)})}}]),a}(),eI=86400,pD=10/eI,gD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.timeScaleArray=[],this.utc=this.w.config.xaxis.labels.datetimeUTC}return tn(a,[{key:"calculateTimeScaleTicks",value:function(e,i){var s=this,c=this.w;if(c.globals.allSeriesCollapsed)return c.globals.labels=[],c.globals.timescaleLabels=[],[];var d=new Pc(this.ctx),A=(i-e)/864e5;this.determineInterval(A),c.globals.disableZoomIn=!1,c.globals.disableZoomOut=!1,A<pD?c.globals.disableZoomIn=!0:A>5e4&&(c.globals.disableZoomOut=!0);var r=d.getTimeUnitsfromTimestamp(e,i,this.utc),y=c.globals.gridWidth/A,b=y/24,x=b/60,B=x/60,T=Math.floor(24*A),E=Math.floor(1440*A),R=Math.floor(A*eI),P=Math.floor(A),G=Math.floor(A/30),U=Math.floor(A/365),Q={minMillisecond:r.minMillisecond,minSecond:r.minSecond,minMinute:r.minMinute,minHour:r.minHour,minDate:r.minDate,minMonth:r.minMonth,minYear:r.minYear},q={firstVal:Q,currentMillisecond:Q.minMillisecond,currentSecond:Q.minSecond,currentMinute:Q.minMinute,currentHour:Q.minHour,currentMonthDate:Q.minDate,currentDate:Q.minDate,currentMonth:Q.minMonth,currentYear:Q.minYear,daysWidthOnXAxis:y,hoursWidthOnXAxis:b,minutesWidthOnXAxis:x,secondsWidthOnXAxis:B,numberOfSeconds:R,numberOfMinutes:E,numberOfHours:T,numberOfDays:P,numberOfMonths:G,numberOfYears:U};switch(this.tickInterval){case"years":this.generateYearScale(q);break;case"months":case"half_year":this.generateMonthScale(q);break;case"months_days":case"months_fortnight":case"days":case"week_days":this.generateDayScale(q);break;case"hours":this.generateHourScale(q);break;case"minutes_fives":case"minutes":this.generateMinuteScale(q);break;case"seconds_tens":case"seconds_fives":case"seconds":this.generateSecondScale(q)}var ne=this.timeScaleArray.map(function(re){var pe={position:re.position,unit:re.unit,year:re.year,day:re.day?re.day:1,hour:re.hour?re.hour:0,month:re.month+1};return re.unit==="month"?Tr(Tr({},pe),{},{day:1,value:re.value+1}):re.unit==="day"||re.unit==="hour"?Tr(Tr({},pe),{},{value:re.value}):re.unit==="minute"?Tr(Tr({},pe),{},{value:re.value,minute:re.value}):re.unit==="second"?Tr(Tr({},pe),{},{value:re.value,minute:re.minute,second:re.second}):re});return ne.filter(function(re){var pe=1,fe=Math.ceil(c.globals.gridWidth/120),he=re.value;c.config.xaxis.tickAmount!==void 0&&(fe=c.config.xaxis.tickAmount),ne.length>fe&&(pe=Math.floor(ne.length/fe));var be=!1,Se=!1;switch(s.tickInterval){case"years":re.unit==="year"&&(be=!0);break;case"half_year":pe=7,re.unit==="year"&&(be=!0);break;case"months":pe=1,re.unit==="year"&&(be=!0);break;case"months_fortnight":pe=15,re.unit!=="year"&&re.unit!=="month"||(be=!0),he===30&&(Se=!0);break;case"months_days":pe=10,re.unit==="month"&&(be=!0),he===30&&(Se=!0);break;case"week_days":pe=8,re.unit==="month"&&(be=!0);break;case"days":pe=1,re.unit==="month"&&(be=!0);break;case"hours":re.unit==="day"&&(be=!0);break;case"minutes_fives":case"seconds_fives":he%5!=0&&(Se=!0);break;case"seconds_tens":he%10!=0&&(Se=!0)}if(s.tickInterval==="hours"||s.tickInterval==="minutes_fives"||s.tickInterval==="seconds_tens"||s.tickInterval==="seconds_fives"){if(!Se)return!0}else if((he%pe==0||be)&&!Se)return!0})}},{key:"recalcDimensionsBasedOnFormat",value:function(e,i){var s=this.w,c=this.formatDates(e),d=this.removeOverlappingTS(c);s.globals.timescaleLabels=d.slice(),new zv(this.ctx).plotCoords()}},{key:"determineInterval",value:function(e){var i=24*e,s=60*i;switch(!0){case e/365>5:this.tickInterval="years";break;case e>800:this.tickInterval="half_year";break;case e>180:this.tickInterval="months";break;case e>90:this.tickInterval="months_fortnight";break;case e>60:this.tickInterval="months_days";break;case e>30:this.tickInterval="week_days";break;case e>2:this.tickInterval="days";break;case i>2.4:this.tickInterval="hours";break;case s>15:this.tickInterval="minutes_fives";break;case s>5:this.tickInterval="minutes";break;case s>1:this.tickInterval="seconds_tens";break;case 60*s>20:this.tickInterval="seconds_fives";break;default:this.tickInterval="seconds"}}},{key:"generateYearScale",value:function(e){var i=e.firstVal,s=e.currentMonth,c=e.currentYear,d=e.daysWidthOnXAxis,A=e.numberOfYears,r=i.minYear,y=0,b=new Pc(this.ctx),x="year";if(i.minDate>1||i.minMonth>0){var B=b.determineRemainingDaysOfYear(i.minYear,i.minMonth,i.minDate);y=(b.determineDaysOfYear(i.minYear)-B+1)*d,r=i.minYear+1,this.timeScaleArray.push({position:y,value:r,unit:x,year:r,month:ni.monthMod(s+1)})}else i.minDate===1&&i.minMonth===0&&this.timeScaleArray.push({position:y,value:r,unit:x,year:c,month:ni.monthMod(s+1)});for(var T=r,E=y,R=0;R<A;R++)T++,E=b.determineDaysOfYear(T-1)*d+E,this.timeScaleArray.push({position:E,value:T,unit:x,year:T,month:1})}},{key:"generateMonthScale",value:function(e){var i=e.firstVal,s=e.currentMonthDate,c=e.currentMonth,d=e.currentYear,A=e.daysWidthOnXAxis,r=e.numberOfMonths,y=c,b=0,x=new Pc(this.ctx),B="month",T=0;if(i.minDate>1){b=(x.determineDaysOfMonths(c+1,i.minYear)-s+1)*A,y=ni.monthMod(c+1);var E=d+T,R=ni.monthMod(y),P=y;y===0&&(B="year",P=E,R=1,E+=T+=1),this.timeScaleArray.push({position:b,value:P,unit:B,year:E,month:R})}else this.timeScaleArray.push({position:b,value:y,unit:B,year:d,month:ni.monthMod(c)});for(var G=y+1,U=b,Q=0,q=1;Q<r;Q++,q++){(G=ni.monthMod(G))===0?(B="year",T+=1):B="month";var ne=this._getYear(d,G,T);U=x.determineDaysOfMonths(G,ne)*A+U;var re=G===0?ne:G;this.timeScaleArray.push({position:U,value:re,unit:B,year:ne,month:G===0?1:G}),G++}}},{key:"generateDayScale",value:function(e){var i=e.firstVal,s=e.currentMonth,c=e.currentYear,d=e.hoursWidthOnXAxis,A=e.numberOfDays,r=new Pc(this.ctx),y="day",b=i.minDate+1,x=b,B=function(q,ne,re){return q>r.determineDaysOfMonths(ne+1,re)&&(x=1,y="month",E=ne+=1),ne},T=(24-i.minHour)*d,E=b,R=B(x,s,c);i.minHour===0&&i.minDate===1?(T=0,E=ni.monthMod(i.minMonth),y="month",x=i.minDate):i.minDate!==1&&i.minHour===0&&i.minMinute===0&&(T=0,b=i.minDate,E=b,R=B(x=b,s,c),E!==1&&(y="day")),this.timeScaleArray.push({position:T,value:E,unit:y,year:this._getYear(c,R,0),month:ni.monthMod(R),day:x});for(var P=T,G=0;G<A;G++){y="day",R=B(x+=1,R,this._getYear(c,R,0));var U=this._getYear(c,R,0);P=24*d+P;var Q=x===1?ni.monthMod(R):x;this.timeScaleArray.push({position:P,value:Q,unit:y,year:U,month:ni.monthMod(R),day:Q})}}},{key:"generateHourScale",value:function(e){var i=e.firstVal,s=e.currentDate,c=e.currentMonth,d=e.currentYear,A=e.minutesWidthOnXAxis,r=e.numberOfHours,y=new Pc(this.ctx),b="hour",x=function(pe,fe){return pe>y.determineDaysOfMonths(fe+1,d)&&(G=1,fe+=1),{month:fe,date:G}},B=function(pe,fe){return pe>y.determineDaysOfMonths(fe+1,d)?fe+=1:fe},T=60-(i.minMinute+i.minSecond/60),E=T*A,R=i.minHour+1,P=R;T===60&&(E=0,P=R=i.minHour);var G=s;P>=24&&(P=0,b="day",R=G+=1);var U=x(G,c).month;U=B(G,U),R>31&&(R=G=1),this.timeScaleArray.push({position:E,value:R,unit:b,day:G,hour:P,year:d,month:ni.monthMod(U)}),P++;for(var Q=E,q=0;q<r;q++){b="hour",P>=24&&(P=0,b="day",U=x(G+=1,U).month,U=B(G,U));var ne=this._getYear(d,U,0);Q=60*A+Q;var re=P===0?G:P;this.timeScaleArray.push({position:Q,value:re,unit:b,hour:P,day:G,year:ne,month:ni.monthMod(U)}),P++}}},{key:"generateMinuteScale",value:function(e){for(var i=e.currentMillisecond,s=e.currentSecond,c=e.currentMinute,d=e.currentHour,A=e.currentDate,r=e.currentMonth,y=e.currentYear,b=e.minutesWidthOnXAxis,x=e.secondsWidthOnXAxis,B=e.numberOfMinutes,T=c+1,E=A,R=r,P=y,G=d,U=(60-s-i/1e3)*x,Q=0;Q<B;Q++)T>=60&&(T=0,(G+=1)===24&&(G=0)),this.timeScaleArray.push({position:U,value:T,unit:"minute",hour:G,minute:T,day:E,year:this._getYear(P,R,0),month:ni.monthMod(R)}),U+=b,T++}},{key:"generateSecondScale",value:function(e){for(var i=e.currentMillisecond,s=e.currentSecond,c=e.currentMinute,d=e.currentHour,A=e.currentDate,r=e.currentMonth,y=e.currentYear,b=e.secondsWidthOnXAxis,x=e.numberOfSeconds,B=s+1,T=c,E=A,R=r,P=y,G=d,U=(1e3-i)/1e3*b,Q=0;Q<x;Q++)B>=60&&(B=0,++T>=60&&(T=0,++G===24&&(G=0))),this.timeScaleArray.push({position:U,value:B,unit:"second",hour:G,minute:T,second:B,day:E,year:this._getYear(P,R,0),month:ni.monthMod(R)}),U+=b,B++}},{key:"createRawDateString",value:function(e,i){var s=e.year;return e.month===0&&(e.month=1),s+="-"+("0"+e.month.toString()).slice(-2),e.unit==="day"?s+=e.unit==="day"?"-"+("0"+i).slice(-2):"-01":s+="-"+("0"+(e.day?e.day:"1")).slice(-2),e.unit==="hour"?s+=e.unit==="hour"?"T"+("0"+i).slice(-2):"T00":s+="T"+("0"+(e.hour?e.hour:"0")).slice(-2),e.unit==="minute"?s+=":"+("0"+i).slice(-2):s+=":"+(e.minute?("0"+e.minute).slice(-2):"00"),e.unit==="second"?s+=":"+("0"+i).slice(-2):s+=":00",this.utc&&(s+=".000Z"),s}},{key:"formatDates",value:function(e){var i=this,s=this.w;return e.map(function(c){var d=c.value.toString(),A=new Pc(i.ctx),r=i.createRawDateString(c,d),y=A.getDate(A.parseDate(r));if(i.utc||(y=A.getDate(A.parseDateWithTimezone(r))),s.config.xaxis.labels.format===void 0){var b="dd MMM",x=s.config.xaxis.labels.datetimeFormatter;c.unit==="year"&&(b=x.year),c.unit==="month"&&(b=x.month),c.unit==="day"&&(b=x.day),c.unit==="hour"&&(b=x.hour),c.unit==="minute"&&(b=x.minute),c.unit==="second"&&(b=x.second),d=A.formatDate(y,b)}else d=A.formatDate(y,s.config.xaxis.labels.format);return{dateString:r,position:c.position,value:d,unit:c.unit,year:c.year,month:c.month}})}},{key:"removeOverlappingTS",value:function(e){var i,s=this,c=new ur(this.ctx),d=!1;e.length>0&&e[0].value&&e.every(function(y){return y.value.length===e[0].value.length})&&(d=!0,i=c.getTextRects(e[0].value).width);var A=0,r=e.map(function(y,b){if(b>0&&s.w.config.xaxis.labels.hideOverlappingLabels){var x=d?i:c.getTextRects(e[A].value).width,B=e[A].position;return y.position>B+x+10?(A=b,y):null}return y});return r=r.filter(function(y){return y!==null})}},{key:"_getYear",value:function(e,i,s){return e+Math.floor(i/12)+s}}]),a}(),mD=function(){function a(e,i){en(this,a),this.ctx=i,this.w=i.w,this.el=e}return tn(a,[{key:"setupElements",value:function(){var e=this.w,i=e.globals,s=e.config,c=s.chart.type;i.axisCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].includes(c),i.xyCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble"].includes(c),i.isBarHorizontal=["bar","rangeBar","boxPlot"].includes(c)&&s.plotOptions.bar.horizontal,i.chartClass=".apexcharts".concat(i.chartID),i.dom.baseEl=this.el,i.dom.elWrap=document.createElement("div"),ur.setAttrs(i.dom.elWrap,{id:i.chartClass.substring(1),class:"apexcharts-canvas ".concat(i.chartClass.substring(1))}),this.el.appendChild(i.dom.elWrap),i.dom.Paper=window.SVG().addTo(i.dom.elWrap),i.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:"translate(".concat(s.chart.offsetX,", ").concat(s.chart.offsetY,")")}),i.dom.Paper.node.style.background=s.theme.mode!=="dark"||s.chart.background?s.theme.mode!=="light"||s.chart.background?s.chart.background:"#fff":"#343A3F",this.setSVGDimensions(),i.dom.elLegendForeign=document.createElementNS(i.SVGNS,"foreignObject"),ur.setAttrs(i.dom.elLegendForeign,{x:0,y:0,width:i.svgWidth,height:i.svgHeight}),i.dom.elLegendWrap=document.createElement("div"),i.dom.elLegendWrap.classList.add("apexcharts-legend"),i.dom.elWrap.appendChild(i.dom.elLegendWrap),i.dom.Paper.node.appendChild(i.dom.elLegendForeign),i.dom.elGraphical=i.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),i.dom.elDefs=i.dom.Paper.defs(),i.dom.Paper.add(i.dom.elGraphical),i.dom.elGraphical.add(i.dom.elDefs)}},{key:"plotChartType",value:function(e,i){var s=this.w,c=this.ctx,d=s.config,A=s.globals,r={line:{series:[],i:[]},area:{series:[],i:[]},scatter:{series:[],i:[]},bubble:{series:[],i:[]},bar:{series:[],i:[]},candlestick:{series:[],i:[]},boxPlot:{series:[],i:[]},rangeBar:{series:[],i:[]},rangeArea:{series:[],seriesRangeEnd:[],i:[]}},y=d.chart.type||"line",b=null,x=0;A.series.forEach(function(pe,fe){var he=e[fe].type==="column"?"bar":e[fe].type||(y==="column"?"bar":y);r[he]?(he==="rangeArea"?(r[he].series.push(A.seriesRangeStart[fe]),r[he].seriesRangeEnd.push(A.seriesRangeEnd[fe])):r[he].series.push(pe),r[he].i.push(fe),he==="bar"&&(s.globals.columnSeries=r.bar)):["heatmap","treemap","pie","donut","polarArea","radialBar","radar"].includes(he)?b=he:console.warn("You have specified an unrecognized series type (".concat(he,").")),y!==he&&he!=="scatter"&&x++}),x>0&&(b&&console.warn("Chart or series type ".concat(b," cannot appear with other chart or series types.")),r.bar.series.length>0&&d.plotOptions.bar.horizontal&&(x-=r.bar.series.length,r.bar={series:[],i:[]},s.globals.columnSeries={series:[],i:[]},console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"))),A.comboCharts||(A.comboCharts=x>0);var B=new lb(c,i),T=new ob(c,i);c.pie=new JT(c);var E=new lD(c);c.rangeBar=new cD(c,i);var R=new aD(c),P=[];if(A.comboCharts){var G,U,Q=new nl(c);if(r.area.series.length>0&&(G=P).push.apply(G,Kl(Q.drawSeriesByGroup(r.area,A.areaGroups,"area",B))),r.bar.series.length>0)if(d.chart.stacked){var q=new tE(c,i);P.push(q.draw(r.bar.series,r.bar.i))}else c.bar=new lm(c,i),P.push(c.bar.draw(r.bar.series,r.bar.i));if(r.rangeArea.series.length>0&&P.push(B.draw(r.rangeArea.series,"rangeArea",r.rangeArea.i,r.rangeArea.seriesRangeEnd)),r.line.series.length>0&&(U=P).push.apply(U,Kl(Q.drawSeriesByGroup(r.line,A.lineGroups,"line",B))),r.candlestick.series.length>0&&P.push(T.draw(r.candlestick.series,"candlestick",r.candlestick.i)),r.boxPlot.series.length>0&&P.push(T.draw(r.boxPlot.series,"boxPlot",r.boxPlot.i)),r.rangeBar.series.length>0&&P.push(c.rangeBar.draw(r.rangeBar.series,r.rangeBar.i)),r.scatter.series.length>0){var ne=new lb(c,i,!0);P.push(ne.draw(r.scatter.series,"scatter",r.scatter.i))}if(r.bubble.series.length>0){var re=new lb(c,i,!0);P.push(re.draw(r.bubble.series,"bubble",r.bubble.i))}}else switch(d.chart.type){case"line":P=B.draw(A.series,"line");break;case"area":P=B.draw(A.series,"area");break;case"bar":d.chart.stacked?P=new tE(c,i).draw(A.series):(c.bar=new lm(c,i),P=c.bar.draw(A.series));break;case"candlestick":P=new ob(c,i).draw(A.series,"candlestick");break;case"boxPlot":P=new ob(c,i).draw(A.series,d.chart.type);break;case"rangeBar":P=c.rangeBar.draw(A.series);break;case"rangeArea":P=B.draw(A.seriesRangeStart,"rangeArea",void 0,A.seriesRangeEnd);break;case"heatmap":P=new oD(c,i).draw(A.series);break;case"treemap":P=new fD(c,i).draw(A.series);break;case"pie":case"donut":case"polarArea":P=c.pie.draw(A.series);break;case"radialBar":P=E.draw(A.series);break;case"radar":P=R.draw(A.series);break;default:P=B.draw(A.series)}return P}},{key:"setSVGDimensions",value:function(){var e=this.w,i=e.globals,s=e.config;s.chart.width=s.chart.width||"100%",s.chart.height=s.chart.height||"auto",i.svgWidth=s.chart.width,i.svgHeight=s.chart.height;var c=ni.getDimensions(this.el),d=s.chart.width.toString().split(/[0-9]+/g).pop();d==="%"?ni.isNumber(c[0])&&(c[0].width===0&&(c=ni.getDimensions(this.el.parentNode)),i.svgWidth=c[0]*parseInt(s.chart.width,10)/100):d!=="px"&&d!==""||(i.svgWidth=parseInt(s.chart.width,10));var A=String(s.chart.height).toString().split(/[0-9]+/g).pop();if(i.svgHeight!=="auto"&&i.svgHeight!=="")if(A==="%"){var r=ni.getDimensions(this.el.parentNode);i.svgHeight=r[1]*parseInt(s.chart.height,10)/100}else i.svgHeight=parseInt(s.chart.height,10);else i.svgHeight=i.axisCharts?i.svgWidth/1.61:i.svgWidth/1.2;if(i.svgWidth=Math.max(i.svgWidth,0),i.svgHeight=Math.max(i.svgHeight,0),ur.setAttrs(i.dom.Paper.node,{width:i.svgWidth,height:i.svgHeight}),A!=="%"){var y=s.chart.sparkline.enabled?0:i.axisCharts?s.chart.parentHeightOffset:0;i.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(i.svgHeight+y,"px")}i.dom.elWrap.style.width="".concat(i.svgWidth,"px"),i.dom.elWrap.style.height="".concat(i.svgHeight,"px")}},{key:"shiftGraphPosition",value:function(){var e=this.w.globals,i=e.translateY,s=e.translateX;ur.setAttrs(e.dom.elGraphical.node,{transform:"translate(".concat(s,", ").concat(i,")")})}},{key:"resizeNonAxisCharts",value:function(){var e=this.w,i=e.globals,s=0,c=e.config.chart.sparkline.enabled?1:15;c+=e.config.grid.padding.bottom,["top","bottom"].includes(e.config.legend.position)&&e.config.legend.show&&!e.config.legend.floating&&(s=new XT(this.ctx).legendHelpers.getLegendDimensions().clwh+7);var d=e.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),A=2.05*e.globals.radialSize;if(d&&!e.config.chart.sparkline.enabled&&e.config.plotOptions.radialBar.startAngle!==0){var r=ni.getBoundingClientRect(d);A=r.bottom;var y=r.bottom-r.top;A=Math.max(2.05*e.globals.radialSize,y)}var b=Math.ceil(A+i.translateY+s+c);i.dom.elLegendForeign&&i.dom.elLegendForeign.setAttribute("height",b),e.config.chart.height&&String(e.config.chart.height).includes("%")||(i.dom.elWrap.style.height="".concat(b,"px"),ur.setAttrs(i.dom.Paper.node,{height:b}),i.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(b,"px"))}},{key:"coreCalculations",value:function(){new Kb(this.ctx).init()}},{key:"resetGlobals",value:function(){var e=this,i=function(){return e.w.config.series.map(function(){return[]})},s=new QT,c=this.w.globals;s.initGlobalVars(c),c.seriesXvalues=i(),c.seriesYvalues=i()}},{key:"isMultipleY",value:function(){return!!(Array.isArray(this.w.config.yaxis)&&this.w.config.yaxis.length>1)&&(this.w.globals.isMultipleYAxis=!0,!0)}},{key:"xySettings",value:function(){var e=this.w,i=null;if(e.globals.axisCharts){if(e.config.xaxis.crosshairs.position==="back"&&new qb(this.ctx).drawXCrosshairs(),e.config.yaxis[0].crosshairs.position==="back"&&new qb(this.ctx).drawYCrosshairs(),e.config.xaxis.type==="datetime"&&e.config.xaxis.labels.formatter===void 0){this.ctx.timeScale=new gD(this.ctx);var s=[];isFinite(e.globals.minX)&&isFinite(e.globals.maxX)&&!e.globals.isBarHorizontal?s=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minX,e.globals.maxX):e.globals.isBarHorizontal&&(s=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minY,e.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(s)}i=new nl(this.ctx).getCalculatedRatios()}return i}},{key:"updateSourceChart",value:function(e){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:e.w.globals.minX,max:e.w.globals.maxX}}}},!1,!1)}},{key:"setupBrushHandler",value:function(){var e=this,i=this.ctx,s=this.w;if(s.config.chart.brush.enabled&&typeof s.config.chart.events.selection!="function"){var c=Array.isArray(s.config.chart.brush.targets)?s.config.chart.brush.targets:[s.config.chart.brush.target];c.forEach(function(d){var A=i.constructor.getChartByID(d);A.w.globals.brushSource=e.ctx,typeof A.w.config.chart.events.zoomed!="function"&&(A.w.config.chart.events.zoomed=function(){return e.updateSourceChart(A)}),typeof A.w.config.chart.events.scrolled!="function"&&(A.w.config.chart.events.scrolled=function(){return e.updateSourceChart(A)})}),s.config.chart.events.selection=function(d,A){c.forEach(function(r){i.constructor.getChartByID(r).ctx.updateHelpers._updateOptions({xaxis:{min:A.xaxis.min,max:A.xaxis.max}},!1,!1,!1,!1)})}}}}]),a}(),yD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"_updateOptions",value:function(e){var i=this,s=arguments.length>1&&arguments[1]!==void 0&&arguments[1],c=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],d=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],A=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return new Promise(function(r){var y=[i.ctx];d&&(y=i.ctx.getSyncedCharts()),i.ctx.w.globals.isExecCalled&&(y=[i.ctx],i.ctx.w.globals.isExecCalled=!1),y.forEach(function(b,x){var B=b.w;if(B.globals.shouldAnimate=c,s||(B.globals.resized=!0,B.globals.dataChanged=!0,c&&b.series.getPreviousPaths()),e&&sm(e)==="object"&&(b.config=new Oy(e),e=nl.extendArrayProps(b.config,e,B),b.w.globals.chartID!==i.ctx.w.globals.chartID&&delete e.series,B.config=ni.extend(B.config,e),A&&(B.globals.lastXAxis=e.xaxis?ni.clone(e.xaxis):[],B.globals.lastYAxis=e.yaxis?ni.clone(e.yaxis):[],B.globals.initialConfig=ni.extend({},B.config),B.globals.initialSeries=ni.clone(B.config.series),e.series))){for(var T=0;T<B.globals.collapsedSeriesIndices.length;T++){var E=B.config.series[B.globals.collapsedSeriesIndices[T]];B.globals.collapsedSeries[T].data=B.globals.axisCharts?E.data.slice():E}for(var R=0;R<B.globals.ancillaryCollapsedSeriesIndices.length;R++){var P=B.config.series[B.globals.ancillaryCollapsedSeriesIndices[R]];B.globals.ancillaryCollapsedSeries[R].data=B.globals.axisCharts?P.data.slice():P}b.series.emptyCollapsedSeries(B.config.series)}return b.update(e).then(function(){x===y.length-1&&r(b)})})})}},{key:"_updateSeries",value:function(e,i){var s=this,c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return new Promise(function(d){var A,r=s.w;return r.globals.shouldAnimate=i,r.globals.dataChanged=!0,i&&s.ctx.series.getPreviousPaths(),r.globals.axisCharts?((A=e.map(function(y,b){return s._extendSeries(y,b)})).length===0&&(A=[{data:[]}]),r.config.series=A):r.config.series=e.slice(),c&&(r.globals.initialConfig.series=ni.clone(r.config.series),r.globals.initialSeries=ni.clone(r.config.series)),s.ctx.update().then(function(){d(s.ctx)})})}},{key:"_extendSeries",value:function(e,i){var s=this.w,c=s.config.series[i];return Tr(Tr({},s.config.series[i]),{},{name:e.name?e.name:c==null?void 0:c.name,color:e.color?e.color:c==null?void 0:c.color,type:e.type?e.type:c==null?void 0:c.type,group:e.group?e.group:c==null?void 0:c.group,hidden:e.hidden!==void 0?e.hidden:c==null?void 0:c.hidden,data:e.data?e.data:c==null?void 0:c.data,zIndex:e.zIndex!==void 0?e.zIndex:i})}},{key:"toggleDataPointSelection",value:function(e,i){var s=this.w,c=null,d=".apexcharts-series[data\\:realIndex='".concat(e,"']");return s.globals.axisCharts?c=s.globals.dom.Paper.findOne("".concat(d," path[j='").concat(i,"'], ").concat(d," circle[j='").concat(i,"'], ").concat(d," rect[j='").concat(i,"']")):i===void 0&&(c=s.globals.dom.Paper.findOne("".concat(d," path[j='").concat(e,"']")),s.config.chart.type!=="pie"&&s.config.chart.type!=="polarArea"&&s.config.chart.type!=="donut"||this.ctx.pie.pieClicked(e)),c?(new ur(this.ctx).pathMouseDown(c,null),c.node?c.node:null):(console.warn("toggleDataPointSelection: Element not found"),null)}},{key:"forceXAxisUpdate",value:function(e){var i=this.w;if(["min","max"].forEach(function(c){e.xaxis[c]!==void 0&&(i.config.xaxis[c]=e.xaxis[c],i.globals.lastXAxis[c]=e.xaxis[c])}),e.xaxis.categories&&e.xaxis.categories.length&&(i.config.xaxis.categories=e.xaxis.categories),i.config.xaxis.convertedCatToNumeric){var s=new Dy(e);e=s.convertCatToNumericXaxis(e,this.ctx)}return e}},{key:"forceYAxisUpdate",value:function(e){return e.chart&&e.chart.stacked&&e.chart.stackType==="100%"&&(Array.isArray(e.yaxis)?e.yaxis.forEach(function(i,s){e.yaxis[s].min=0,e.yaxis[s].max=100}):(e.yaxis.min=0,e.yaxis.max=100)),e}},{key:"revertDefaultAxisMinMax",value:function(e){var i=this,s=this.w,c=s.globals.lastXAxis,d=s.globals.lastYAxis;e&&e.xaxis&&(c=e.xaxis),e&&e.yaxis&&(d=e.yaxis),s.config.xaxis.min=c.min,s.config.xaxis.max=c.max;var A=function(r){d[r]!==void 0&&(s.config.yaxis[r].min=d[r].min,s.config.yaxis[r].max=d[r].max)};s.config.yaxis.map(function(r,y){s.globals.zoomed||d[y]!==void 0?A(y):i.ctx.opts.yaxis[y]!==void 0&&(r.min=i.ctx.opts.yaxis[y].min,r.max=i.ctx.opts.yaxis[y].max)})}}]),a}();(function(){function a(){for(var d=arguments.length>0&&arguments[0]!==B?arguments[0]:[],A=arguments.length>1?arguments[1]:B,r=arguments.length>2?arguments[2]:B,y=arguments.length>3?arguments[3]:B,b=arguments.length>4?arguments[4]:B,x=arguments.length>5?arguments[5]:B,B=arguments.length>6?arguments[6]:B,T=d.slice(A,r||B),E=y.slice(b,x||B),R=0,P={pos:[0,0],start:[0,0]},G={pos:[0,0],start:[0,0]};T[R]=e.call(P,T[R]),E[R]=e.call(G,E[R]),T[R][0]!=E[R][0]||T[R][0]=="M"||T[R][0]=="A"&&(T[R][4]!=E[R][4]||T[R][5]!=E[R][5])?(Array.prototype.splice.apply(T,[R,1].concat(s.call(P,T[R]))),Array.prototype.splice.apply(E,[R,1].concat(s.call(G,E[R])))):(T[R]=i.call(P,T[R]),E[R]=i.call(G,E[R])),!(++R==T.length&&R==E.length);)R==T.length&&T.push(["C",P.pos[0],P.pos[1],P.pos[0],P.pos[1],P.pos[0],P.pos[1]]),R==E.length&&E.push(["C",G.pos[0],G.pos[1],G.pos[0],G.pos[1],G.pos[0],G.pos[1]]);return{start:T,dest:E}}function e(d){switch(d[0]){case"z":case"Z":d[0]="L",d[1]=this.start[0],d[2]=this.start[1];break;case"H":d[0]="L",d[2]=this.pos[1];break;case"V":d[0]="L",d[2]=d[1],d[1]=this.pos[0];break;case"T":d[0]="Q",d[3]=d[1],d[4]=d[2],d[1]=this.reflection[1],d[2]=this.reflection[0];break;case"S":d[0]="C",d[6]=d[4],d[5]=d[3],d[4]=d[2],d[3]=d[1],d[2]=this.reflection[1],d[1]=this.reflection[0]}return d}function i(d){var A=d.length;return this.pos=[d[A-2],d[A-1]],"SCQT".indexOf(d[0])!=-1&&(this.reflection=[2*this.pos[0]-d[A-4],2*this.pos[1]-d[A-3]]),d}function s(d){var A=[d];switch(d[0]){case"M":return this.pos=this.start=[d[1],d[2]],A;case"L":d[5]=d[3]=d[1],d[6]=d[4]=d[2],d[1]=this.pos[0],d[2]=this.pos[1];break;case"Q":d[6]=d[4],d[5]=d[3],d[4]=1*d[4]/3+2*d[2]/3,d[3]=1*d[3]/3+2*d[1]/3,d[2]=1*this.pos[1]/3+2*d[2]/3,d[1]=1*this.pos[0]/3+2*d[1]/3;break;case"A":A=function(r,y){var b,x,B,T,E,R,P,G,U,Q,q,ne,re,pe,fe,he,be,Se,oe,ye,Me,Be,Pe,De,et,Ye,bt=Math.abs(y[1]),pt=Math.abs(y[2]),Qt=y[3]%360,Ie=y[4],ot=y[5],ut=y[6],mt=y[7],Ct=new Vo(r),rt=new Vo(ut,mt),Bt=[];if(bt===0||pt===0||Ct.x===rt.x&&Ct.y===rt.y)return[["C",Ct.x,Ct.y,rt.x,rt.y,rt.x,rt.y]];for(b=new Vo((Ct.x-rt.x)/2,(Ct.y-rt.y)/2).transform(new Ks().rotate(Qt)),x=b.x*b.x/(bt*bt)+b.y*b.y/(pt*pt),x>1&&(bt*=x=Math.sqrt(x),pt*=x),B=new Ks().rotate(Qt).scale(1/bt,1/pt).rotate(-Qt),Ct=Ct.transform(B),rt=rt.transform(B),T=[rt.x-Ct.x,rt.y-Ct.y],R=T[0]*T[0]+T[1]*T[1],E=Math.sqrt(R),T[0]/=E,T[1]/=E,P=R<4?Math.sqrt(1-R/4):0,Ie===ot&&(P*=-1),G=new Vo((rt.x+Ct.x)/2+P*-T[1],(rt.y+Ct.y)/2+P*T[0]),U=new Vo(Ct.x-G.x,Ct.y-G.y),Q=new Vo(rt.x-G.x,rt.y-G.y),q=Math.acos(U.x/Math.sqrt(U.x*U.x+U.y*U.y)),U.y<0&&(q*=-1),ne=Math.acos(Q.x/Math.sqrt(Q.x*Q.x+Q.y*Q.y)),Q.y<0&&(ne*=-1),ot&&q>ne&&(ne+=2*Math.PI),!ot&&q<ne&&(ne-=2*Math.PI),pe=Math.ceil(2*Math.abs(q-ne)/Math.PI),he=[],be=q,re=(ne-q)/pe,fe=4*Math.tan(re/4)/3,Me=0;Me<=pe;Me++)oe=Math.cos(be),Se=Math.sin(be),ye=new Vo(G.x+oe,G.y+Se),he[Me]=[new Vo(ye.x+fe*Se,ye.y-fe*oe),ye,new Vo(ye.x-fe*Se,ye.y+fe*oe)],be+=re;for(he[0][0]=he[0][1].clone(),he[he.length-1][2]=he[he.length-1][1].clone(),B=new Ks().rotate(Qt).scale(bt,pt).rotate(-Qt),Me=0,Be=he.length;Me<Be;Me++)he[Me][0]=he[Me][0].transform(B),he[Me][1]=he[Me][1].transform(B),he[Me][2]=he[Me][2].transform(B);for(Me=1,Be=he.length;Me<Be;Me++)Pe=(ye=he[Me-1][2]).x,De=ye.y,et=(ye=he[Me][0]).x,Ye=ye.y,ut=(ye=he[Me][1]).x,mt=ye.y,Bt.push(["C",Pe,De,et,Ye,ut,mt]);return Bt}(this.pos,d),d=A[0]}return d[0]="C",this.pos=[d[5],d[6]],this.reflection=[2*d[5]-d[3],2*d[6]-d[4]],A}function c(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],A=arguments.length>1?arguments[1]:void 0;if(A===!1)return!1;for(var r=A,y=d.length;r<y;++r)if(d[r][0]=="M")return r;return!1}jn(Vd,{morph:function(d,A,r,y,b){for(var x=this.parse(d),B=this.parse(A),T=0,E=0,R=!1,P=!1;T!==!1||E!==!1;){var G;R=c(x,T!==!1&&T+1),P=c(B,E!==!1&&E+1),T===!1&&(T=(G=new Vd(U.start).bbox()).height==0||G.width==0?x.push(x[0])-1:x.push(["M",G.x+G.width/2,G.y+G.height/2])-1),E===!1&&(E=(G=new Vd(U.dest).bbox()).height==0||G.width==0?B.push(B[0])-1:B.push(["M",G.x+G.width/2,G.y+G.height/2])-1);var U=a(x,T,R,B,E,P);x=x.slice(0,T).concat(U.start,R===!1?[]:x.slice(R)),B=B.slice(0,E).concat(U.dest,P===!1?[]:B.slice(P)),T=R!==!1&&T+U.start.length,E=P!==!1&&E+U.dest.length}this._array=x,this.destination=new Vd,this.destination._array=B;var Q=this.fromArray(x.map(function(q,ne){var re=B[ne].map(function(pe,fe){return fe===0?pe:y.step(q[fe],B[ne][fe],r,b[ne],b)});return re}));return Q}})})();const iE=a=>(a.changedTouches&&(a=a.changedTouches[0]),{x:a.clientX,y:a.clientY});class vD{constructor(e){e.remember("_draggable",this),this.el=e,this.drag=this.drag.bind(this),this.startDrag=this.startDrag.bind(this),this.endDrag=this.endDrag.bind(this)}init(e){e?(this.el.on("mousedown.drag",this.startDrag),this.el.on("touchstart.drag",this.startDrag,{passive:!1})):(this.el.off("mousedown.drag"),this.el.off("touchstart.drag"))}startDrag(e){const i=!e.type.indexOf("mouse");if(i&&e.which!==1&&e.buttons!==0||this.el.dispatch("beforedrag",{event:e,handler:this}).defaultPrevented)return;e.preventDefault(),e.stopPropagation(),this.init(!1),this.box=this.el.bbox(),this.lastClick=this.el.point(iE(e));const s=(i?"mouseup":"touchend")+".drag";bf(window,(i?"mousemove":"touchmove")+".drag",this.drag,this,{passive:!1}),bf(window,s,this.endDrag,this,{passive:!1}),this.el.fire("dragstart",{event:e,handler:this,box:this.box})}drag(e){const{box:i,lastClick:s}=this,c=this.el.point(iE(e)),d=c.x-s.x,A=c.y-s.y;if(!d&&!A)return i;const r=i.x+d,y=i.y+A;this.box=new Ac(r,y,i.w,i.h),this.lastClick=c,this.el.dispatch("dragmove",{event:e,handler:this,box:this.box}).defaultPrevented||this.move(r,y)}move(e,i){this.el.type==="svg"?gp.prototype.move.call(this.el,e,i):this.el.move(e,i)}endDrag(e){this.drag(e),this.el.fire("dragend",{event:e,handler:this,box:this.box}),nd(window,"mousemove.drag"),nd(window,"touchmove.drag"),nd(window,"mouseup.drag"),nd(window,"touchend.drag"),this.init(!0)}}/*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function $b(a,e,i,s=null){return function(c){c.preventDefault(),c.stopPropagation();var d=c.pageX||c.touches[0].pageX,A=c.pageY||c.touches[0].pageY;e.fire(a,{x:d,y:A,event:c,index:s,points:i})}}function Zb([a,e],{a:i,b:s,c,d,e:A,f:r}){return[a*i+e*c+A,a*s+e*d+r]}jn(Oc,{draggable(a=!0){return(this.remember("_draggable")||new vD(this)).init(a),this}});let tI=class{constructor(a){this.el=a,a.remember("_selectHandler",this),this.selection=new gp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=Ky();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.createRot=a.createRot||this.createRotFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.updateRot=a.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((a,e,i)=>{const s=this.order[e];this.createHandle.call(this,this.selection,a,e,i,s),this.selection.get(e+1).addClass("svg_select_handle svg_select_handle_"+s).on("mousedown.selection touchstart.selection",$b(s,this.el,this.handlePoints,e))})}createHandleFn(a){a.polyline()}updateHandleFn(a,e,i,s){const c=s.at(i-1),d=s[(i+1)%s.length],A=e,r=[A[0]-c[0],A[1]-c[1]],y=[A[0]-d[0],A[1]-d[1]],b=Math.sqrt(r[0]*r[0]+r[1]*r[1]),x=Math.sqrt(y[0]*y[0]+y[1]*y[1]),B=[r[0]/b,r[1]/b],T=[y[0]/x,y[1]/x],E=[A[0]-10*B[0],A[1]-10*B[1]],R=[A[0]-10*T[0],A[1]-10*T[1]];a.plot([E,A,R])}updateResizeHandles(){this.handlePoints.forEach((a,e,i)=>{const s=this.order[e];this.updateHandle.call(this,this.selection.get(e+1),a,e,i,s)})}createRotFn(a){a.line(),a.circle(5)}getPoint(a){return this.handlePoints[this.order.indexOf(a)]}getPointHandle(a){return this.selection.get(this.order.indexOf(a)+1)}updateRotFn(a,e){const i=this.getPoint("t");a.get(0).plot(i[0],i[1],e[0],e[1]),a.get(1).center(e[0],e[1])}createRotationHandle(){const a=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",$b("rot",this.el,this.handlePoints));this.createRot.call(this,a)}updateRotationHandle(){const a=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(a,this.rotationPoint,this.handlePoints)}updatePoints(){const a=this.el.bbox(),e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(a).map(i=>Zb(i,e)),this.rotationPoint=Zb(this.getRotationPoint(a),e)}getHandlePoints({x:a,x2:e,y:i,y2:s,cx:c,cy:d}=this.el.bbox()){return[[a,i],[c,i],[e,i],[e,d],[e,s],[c,s],[a,s],[a,d]]}getRotationPoint({y:a,cx:e}=this.el.bbox()){return[e,a-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}};const rE=a=>function(e=!0,i={}){typeof e=="object"&&(i=e,e=!0);let s=this.remember("_"+a.name);return s||(e.prototype instanceof tI?(s=new e(this),e=!0):s=new a(this),this.remember("_"+a.name,s)),s.active(e,i),this};/*!
* @svgdotjs/svg.resize.js - An extension for svg.js which allows to resize elements which are selected
* @version 2.0.4
* https://github.com/svgdotjs/svg.resize.js
*
* @copyright [object Object]
* @license MIT
*
* BUILT: Fri Sep 13 2024 12:43:14 GMT+0200 (Central European Summer Time)
*//*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function Jb(a,e,i,s=null){return function(c){c.preventDefault(),c.stopPropagation();var d=c.pageX||c.touches[0].pageX,A=c.pageY||c.touches[0].pageY;e.fire(a,{x:d,y:A,event:c,index:s,points:i})}}function e1([a,e],{a:i,b:s,c,d,e:A,f:r}){return[a*i+e*c+A,a*s+e*d+r]}jn(Oc,{select:rE(tI)}),jn([rg,ng,ig],{pointSelect:rE(class{constructor(a){this.el=a,a.remember("_pointSelectHandler",this),this.selection=new gp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=Ky();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((a,e,i)=>{this.createHandle.call(this,this.selection,a,e,i),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",$b("point",this.el,this.points,e))})}createHandleFn(a){a.circle(5)}updateHandleFn(a,e){a.center(e[0],e[1])}updatePointHandles(){this.points.forEach((a,e,i)=>{this.updateHandle.call(this,this.selection.get(e+1),a,e,i)})}updatePoints(){const a=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>Zb(e,a))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});class iI{constructor(e){this.el=e,e.remember("_selectHandler",this),this.selection=new gp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const i=Ky();this.observer=new i.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.createRot=e.createRot||this.createRotFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.updateRot=e.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(e,i){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(i)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((e,i,s)=>{const c=this.order[i];this.createHandle.call(this,this.selection,e,i,s,c),this.selection.get(i+1).addClass("svg_select_handle svg_select_handle_"+c).on("mousedown.selection touchstart.selection",Jb(c,this.el,this.handlePoints,i))})}createHandleFn(e){e.polyline()}updateHandleFn(e,i,s,c){const d=c.at(s-1),A=c[(s+1)%c.length],r=i,y=[r[0]-d[0],r[1]-d[1]],b=[r[0]-A[0],r[1]-A[1]],x=Math.sqrt(y[0]*y[0]+y[1]*y[1]),B=Math.sqrt(b[0]*b[0]+b[1]*b[1]),T=[y[0]/x,y[1]/x],E=[b[0]/B,b[1]/B],R=[r[0]-10*T[0],r[1]-10*T[1]],P=[r[0]-10*E[0],r[1]-10*E[1]];e.plot([R,r,P])}updateResizeHandles(){this.handlePoints.forEach((e,i,s)=>{const c=this.order[i];this.updateHandle.call(this,this.selection.get(i+1),e,i,s,c)})}createRotFn(e){e.line(),e.circle(5)}getPoint(e){return this.handlePoints[this.order.indexOf(e)]}getPointHandle(e){return this.selection.get(this.order.indexOf(e)+1)}updateRotFn(e,i){const s=this.getPoint("t");e.get(0).plot(s[0],s[1],i[0],i[1]),e.get(1).center(i[0],i[1])}createRotationHandle(){const e=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",Jb("rot",this.el,this.handlePoints));this.createRot.call(this,e)}updateRotationHandle(){const e=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(e,this.rotationPoint,this.handlePoints)}updatePoints(){const e=this.el.bbox(),i=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(e).map(s=>e1(s,i)),this.rotationPoint=e1(this.getRotationPoint(e),i)}getHandlePoints({x:e,x2:i,y:s,y2:c,cx:d,cy:A}=this.el.bbox()){return[[e,s],[d,s],[i,s],[i,A],[i,c],[d,c],[e,c],[e,A]]}getRotationPoint({y:e,cx:i}=this.el.bbox()){return[i,e-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}}const nE=a=>function(e=!0,i={}){typeof e=="object"&&(i=e,e=!0);let s=this.remember("_"+a.name);return s||(e.prototype instanceof iI?(s=new e(this),e=!0):s=new a(this),this.remember("_"+a.name,s)),s.active(e,i),this};jn(Oc,{select:nE(iI)}),jn([rg,ng,ig],{pointSelect:nE(class{constructor(a){this.el=a,a.remember("_pointSelectHandler",this),this.selection=new gp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=Ky();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((a,e,i)=>{this.createHandle.call(this,this.selection,a,e,i),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",Jb("point",this.el,this.points,e))})}createHandleFn(a){a.circle(5)}updateHandleFn(a,e){a.center(e[0],e[1])}updatePointHandles(){this.points.forEach((a,e,i)=>{this.updateHandle.call(this,this.selection.get(e+1),a,e,i)})}updatePoints(){const a=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>e1(e,a))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});const tv=a=>(a.changedTouches&&(a=a.changedTouches[0]),{x:a.clientX,y:a.clientY}),sE=a=>{let e=1/0,i=1/0,s=-1/0,c=-1/0;for(let d=0;d<a.length;d++){const A=a[d];e=Math.min(e,A[0]),i=Math.min(i,A[1]),s=Math.max(s,A[0]),c=Math.max(c,A[1])}return new Ac(e,i,s-e,c-i)};class oE{constructor(e){this.el=e,e.remember("_ResizeHandler",this),this.lastCoordinates=null,this.eventType="",this.lastEvent=null,this.handleResize=this.handleResize.bind(this),this.resize=this.resize.bind(this),this.endResize=this.endResize.bind(this),this.rotate=this.rotate.bind(this),this.movePoint=this.movePoint.bind(this)}active(e,i){this.preserveAspectRatio=i.preserveAspectRatio??!1,this.aroundCenter=i.aroundCenter??!1,this.grid=i.grid??0,this.degree=i.degree??0,this.el.off(".resize"),e&&(this.el.on(["lt.resize","rt.resize","rb.resize","lb.resize","t.resize","r.resize","b.resize","l.resize","rot.resize","point.resize"],this.handleResize),this.lastEvent&&(this.eventType==="rot"?this.rotate(this.lastEvent):this.eventType==="point"?this.movePoint(this.lastEvent):this.resize(this.lastEvent)))}handleResize(e){this.eventType=e.type;const{event:i,index:s,points:c}=e.detail,d=!i.type.indexOf("mouse");if(d&&(i.which||i.buttons)!==1||this.el.dispatch("beforeresize",{event:e,handler:this}).defaultPrevented)return;this.box=this.el.bbox(),this.startPoint=this.el.point(tv(i)),this.index=s,this.points=c.slice();const A=(d?"mousemove":"touchmove")+".resize",r=(d?"mouseup":"touchcancel.resize touchend")+".resize";e.type==="point"?bf(window,A,this.movePoint):e.type==="rot"?bf(window,A,this.rotate):bf(window,A,this.resize),bf(window,r,this.endResize)}resize(e){this.lastEvent=e;const i=this.snapToGrid(this.el.point(tv(e)));let s=i.x-this.startPoint.x,c=i.y-this.startPoint.y;this.preserveAspectRatio&&this.aroundCenter&&(s*=2,c*=2);const d=this.box.x+s,A=this.box.y+c,r=this.box.x2+s,y=this.box.y2+c;let b=new Ac(this.box);if(this.eventType.includes("l")&&(b.x=Math.min(d,this.box.x2),b.x2=Math.max(d,this.box.x2)),this.eventType.includes("r")&&(b.x=Math.min(r,this.box.x),b.x2=Math.max(r,this.box.x)),this.eventType.includes("t")&&(b.y=Math.min(A,this.box.y2),b.y2=Math.max(A,this.box.y2)),this.eventType.includes("b")&&(b.y=Math.min(y,this.box.y),b.y2=Math.max(y,this.box.y)),b.width=b.x2-b.x,b.height=b.y2-b.y,this.preserveAspectRatio){const x=b.width/this.box.width,B=b.height/this.box.height,T=["lt","t","rt","r","rb","b","lb","l"],E=(T.indexOf(this.eventType)+4)%T.length,R=this.aroundCenter?[this.box.cx,this.box.cy]:this.points[E];let P=this.eventType.includes("t")||this.eventType.includes("b")?B:x;P=this.eventType.length===2?Math.max(x,B):P,b=function(G,U,Q){const q=[[G.x,G.y],[G.x+G.width,G.y],[G.x+G.width,G.y+G.height],[G.x,G.y+G.height]].map(([ne,re])=>{const pe=ne-U[0],fe=(re-U[1])*Q;return[pe*Q+U[0],fe+U[1]]});return sE(q)}(this.box,R,P)}this.el.dispatch("resize",{box:new Ac(b),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.size(b.width,b.height).move(b.x,b.y)}movePoint(e){this.lastEvent=e;const{x:i,y:s}=this.snapToGrid(this.el.point(tv(e))),c=this.el.array().slice();c[this.index]=[i,s],this.el.dispatch("resize",{box:sE(c),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.plot(c)}rotate(e){this.lastEvent=e;const i=this.startPoint,s=this.el.point(tv(e)),{cx:c,cy:d}=this.box,A=i.x-c,r=i.y-d,y=s.x-c,b=s.y-d,x=Math.sqrt(A*A+r*r)*Math.sqrt(y*y+b*b);if(x===0)return;let B=Math.acos((A*y+r*b)/x)/Math.PI*180;if(!B)return;s.x<i.x&&(B=-B);const T=new Ks(this.el),{x:E,y:R}=new Vo(c,d).transformO(T),{rotate:P}=T.decompose(),G=this.snapToAngle(P+B)-P;this.el.dispatch("resize",{box:this.box,angle:G,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.transform(T.rotateO(G,E,R))}endResize(e){this.eventType!=="rot"&&this.eventType!=="point"&&this.resize(e),this.lastEvent=null,this.eventType="",nd(window,"mousemove.resize touchmove.resize"),nd(window,"mouseup.resize touchend.resize")}snapToGrid(e){return this.grid&&(e.x=Math.round(e.x/this.grid)*this.grid,e.y=Math.round(e.y/this.grid)*this.grid),e}snapToAngle(e){return this.degree&&(e=Math.round(e/this.degree)*this.degree),e}}jn(Oc,{resize:function(a=!0,e={}){typeof a=="object"&&(e=a,a=!0);let i=this.remember("_ResizeHandler");return i||(a.prototype instanceof oE?(i=new a(this),a=!0):i=new oE(this),this.remember("_resizeHandler",i)),i.active(a,e),this}}),window.SVG===void 0&&(window.SVG=kR),window.Apex===void 0&&(window.Apex={});var aE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"initModules",value:function(){this.ctx.publicMethods=["updateOptions","updateSeries","appendData","appendSeries","isSeriesHidden","highlightSeries","toggleSeries","showSeries","hideSeries","setLocale","resetSeries","zoomX","toggleDataPointSelection","dataURI","exportToCSV","addXaxisAnnotation","addYaxisAnnotation","addPointAnnotation","clearAnnotations","removeAnnotation","paper","destroy"],this.ctx.eventList=["click","mousedown","mousemove","mouseleave","touchstart","touchmove","touchleave","mouseup","touchend"],this.ctx.animations=new cm(this.ctx),this.ctx.axes=new VR(this.ctx),this.ctx.core=new mD(this.ctx.el,this.ctx),this.ctx.config=new Oy({}),this.ctx.data=new J1(this.ctx),this.ctx.grid=new GT(this.ctx),this.ctx.graphics=new ur(this.ctx),this.ctx.coreUtils=new nl(this.ctx),this.ctx.crosshairs=new qb(this.ctx),this.ctx.events=new HR(this.ctx),this.ctx.exports=new vy(this.ctx),this.ctx.fill=new Yd(this.ctx),this.ctx.localization=new QR(this.ctx),this.ctx.options=new eg,this.ctx.responsive=new GR(this.ctx),this.ctx.series=new od(this.ctx),this.ctx.theme=new WR(this.ctx),this.ctx.formatters=new Zy(this.ctx),this.ctx.titleSubtitle=new XR(this.ctx),this.ctx.legend=new XT(this.ctx),this.ctx.toolbar=new YT(this.ctx),this.ctx.tooltip=new eE(this.ctx),this.ctx.dimensions=new zv(this.ctx),this.ctx.updateHelpers=new yD(this.ctx),this.ctx.zoomPanSelection=new JR(this.ctx),this.ctx.w.globals.tooltip=new eE(this.ctx)}}]),a}(),lE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"clear",value:function(e){var i=e.isUpdating;this.ctx.zoomPanSelection&&this.ctx.zoomPanSelection.destroy(),this.ctx.toolbar&&this.ctx.toolbar.destroy(),this.ctx.animations=null,this.ctx.axes=null,this.ctx.annotations=null,this.ctx.core=null,this.ctx.data=null,this.ctx.grid=null,this.ctx.series=null,this.ctx.responsive=null,this.ctx.theme=null,this.ctx.formatters=null,this.ctx.titleSubtitle=null,this.ctx.legend=null,this.ctx.dimensions=null,this.ctx.options=null,this.ctx.crosshairs=null,this.ctx.zoomPanSelection=null,this.ctx.updateHelpers=null,this.ctx.toolbar=null,this.ctx.localization=null,this.ctx.w.globals.tooltip=null,this.clearDomElements({isUpdating:i})}},{key:"killSVG",value:function(e){e.each(function(){this.removeClass("*"),this.off()},!0),e.clear()}},{key:"clearDomElements",value:function(e){var i=this,s=e.isUpdating,c=this.w.globals.dom.Paper.node;c.parentNode&&c.parentNode.parentNode&&!s&&(c.parentNode.parentNode.style.minHeight="unset");var d=this.w.globals.dom.baseEl;d&&this.ctx.eventList.forEach(function(r){d.removeEventListener(r,i.ctx.events.documentEvent)});var A=this.w.globals.dom;if(this.ctx.el!==null)for(;this.ctx.el.firstChild;)this.ctx.el.removeChild(this.ctx.el.firstChild);this.killSVG(A.Paper),A.Paper.remove(),A.elWrap=null,A.elGraphical=null,A.elLegendWrap=null,A.elLegendForeign=null,A.baseEl=null,A.elGridRect=null,A.elGridRectMask=null,A.elGridRectBarMask=null,A.elGridRectMarkerMask=null,A.elForecastMask=null,A.elNonForecastMask=null,A.elDefs=null}}]),a}(),cb=new WeakMap,cE=function(){function a(e,i){en(this,a),this.opts=i,this.ctx=this,this.w=new jR(i).init(),this.el=e,this.w.globals.cuid=ni.randomId(),this.w.globals.chartID=this.w.config.chart.id?ni.escapeString(this.w.config.chart.id):this.w.globals.cuid,new aE(this).initModules(),this.lastUpdateOptions=null,this.create=ni.bind(this.create,this),this.windowResizeHandler=this._windowResizeHandler.bind(this),this.parentResizeHandler=this._parentResizeCallback.bind(this)}return tn(a,[{key:"render",value:function(){var e=this;return new Promise(function(i,s){if(ni.elementExists(e.el)){Apex._chartInstances===void 0&&(Apex._chartInstances=[]),e.w.config.chart.id&&Apex._chartInstances.push({id:e.w.globals.chartID,group:e.w.config.chart.group,chart:e}),e.setLocale(e.w.config.chart.defaultLocale);var c=e.w.config.chart.events.beforeMount;typeof c=="function"&&c(e,e.w),e.events.fireEvent("beforeMount",[e,e.w]),window.addEventListener("resize",e.windowResizeHandler),function(T,E){var R=!1;if(T.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){var P=T.getBoundingClientRect();T.style.display!=="none"&&P.width!==0||(R=!0)}var G=new ResizeObserver(function(U){R&&E.call(T,U),R=!0});T.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(T.children).forEach(function(U){return G.observe(U)}):G.observe(T),cb.set(E,G)}(e.el.parentNode,e.parentResizeHandler);var d=e.el.getRootNode&&e.el.getRootNode(),A=ni.is("ShadowRoot",d),r=e.el.ownerDocument,y=A?d.getElementById("apexcharts-css"):r.getElementById("apexcharts-css");if(!y){var b;(y=document.createElement("style")).id="apexcharts-css",y.textContent=`@keyframes opaque {
  0% {
    opacity: 0
  }

  to {
    opacity: 1
  }
}

@keyframes resizeanim {

  0%,
  to {
    opacity: 0
  }
}

.apexcharts-canvas {
  position: relative;
  direction: ltr !important;
  user-select: none
}

.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5)
}

.apexcharts-inner {
  position: relative
}

.apexcharts-text tspan {
  font-family: inherit
}

rect.legend-mouseover-inactive,
.legend-mouseover-inactive rect,
.legend-mouseover-inactive path,
.legend-mouseover-inactive circle,
.legend-mouseover-inactive line,
.legend-mouseover-inactive text.apexcharts-yaxis-title-text,
.legend-mouseover-inactive text.apexcharts-yaxis-label {
  transition: .15s ease all;
  opacity: .2
}

.apexcharts-legend-text {
  padding-left: 15px;
  margin-left: -15px;
}

.apexcharts-series-collapsed {
  opacity: 0
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: .15s ease all
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, .96)
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, .8)
}

.apexcharts-tooltip * {
  font-family: inherit
}

.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #eceff1;
  border-bottom: 1px solid #ddd
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, .7);
  border-bottom: 1px solid #333
}

.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  margin-left: 5px;
  font-weight: 600
}

.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-z-value:empty,
.apexcharts-tooltip-title:empty {
  display: none
}

.apexcharts-tooltip-text-goals-label,
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px
}

.apexcharts-tooltip-goals-group,
.apexcharts-tooltip-text-goals-label,
.apexcharts-tooltip-text-goals-value {
  display: flex
}

.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px
}

.apexcharts-tooltip-marker {
  display: inline-block;
  position: relative;
  width: 16px;
  height: 16px;
  font-size: 16px;
  line-height: 16px;
  margin-right: 4px;
  text-align: center;
  vertical-align: middle;
  color: inherit;
}

.apexcharts-tooltip-marker::before {
  content: "";
  display: inline-block;
  width: 100%;
  text-align: center;
  color: currentcolor;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  font-size: 26px;
  font-family: Arial, Helvetica, sans-serif;
  line-height: 14px;
  font-weight: 900;
}

.apexcharts-tooltip-marker[shape="circle"]::before {
  content: "\\25CF";
}

.apexcharts-tooltip-marker[shape="square"]::before,
.apexcharts-tooltip-marker[shape="rect"]::before {
  content: "\\25A0";
  transform: translate(-1px, -2px);
}

.apexcharts-tooltip-marker[shape="line"]::before {
  content: "\\2500";
}

.apexcharts-tooltip-marker[shape="diamond"]::before {
  content: "\\25C6";
  font-size: 28px;
}

.apexcharts-tooltip-marker[shape="triangle"]::before {
  content: "\\25B2";
  font-size: 22px;
}

.apexcharts-tooltip-marker[shape="cross"]::before {
  content: "\\2715";
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="plus"]::before {
  content: "\\2715";
  transform: rotate(45deg) translate(-1px, -1px);
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="star"]::before {
  content: "\\2605";
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="sparkle"]::before {
  content: "\\2726";
  font-size: 20px;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px
}

.apexcharts-custom-tooltip,
.apexcharts-tooltip-box {
  padding: 4px 8px
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse
}

.apexcharts-tooltip-box>div {
  margin: 4px 0
}

.apexcharts-tooltip-box span.value {
  font-weight: 700
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: 700;
  display: block;
  margin-bottom: 5px
}

.apexcharts-xaxistooltip,
.apexcharts-yaxistooltip {
  opacity: 0;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #eceff1;
  border: 1px solid #90a4ae
}

.apexcharts-xaxistooltip {
  padding: 9px 10px;
  transition: .15s ease all
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, .7);
  border: 1px solid rgba(0, 0, 0, .5);
  color: #fff
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none
}

.apexcharts-xaxistooltip:after {
  border-color: transparent;
  border-width: 6px;
  margin-left: -6px
}

.apexcharts-xaxistooltip:before {
  border-color: transparent;
  border-width: 7px;
  margin-left: -7px
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #eceff1
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90a4ae
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after,
.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, .5)
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #eceff1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90a4ae
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after,
.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, .5)
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-yaxistooltip {
  padding: 4px 10px
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, .7);
  border: 1px solid rgba(0, 0, 0, .5);
  color: #fff
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none
}

.apexcharts-yaxistooltip:after {
  border-color: transparent;
  border-width: 6px;
  margin-top: -6px
}

.apexcharts-yaxistooltip:before {
  border-color: transparent;
  border-width: 7px;
  margin-top: -7px
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #eceff1
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90a4ae
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after,
.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, .5)
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #eceff1
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90a4ae
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after,
.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, .5)
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1
}

.apexcharts-yaxistooltip-hidden {
  display: none
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: .15s ease all
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0
}

.apexcharts-selection-rect {
  cursor: move
}

.svg_select_shape {
  stroke-width: 1;
  stroke-dasharray: 10 10;
  stroke: black;
  stroke-opacity: 0.1;
  pointer-events: none;
  fill: none;
}

.svg_select_handle {
  stroke-width: 3;
  stroke: black;
  fill: none;
}

.svg_select_handle_r {
  cursor: e-resize;
}

.svg_select_handle_l {
  cursor: w-resize;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-menu-icon,
.apexcharts-pan-icon,
.apexcharts-reset-icon,
.apexcharts-selection-icon,
.apexcharts-toolbar-custom-icon,
.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6e8192;
  text-align: center
}

.apexcharts-menu-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg {
  fill: #6e8192
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(.76)
}

.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg,
.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg {
  fill: #f3f4f5
}

.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg {
  fill: #008ffb
}

.apexcharts-theme-light .apexcharts-menu-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg {
  fill: #333
}

.apexcharts-menu-icon,
.apexcharts-selection-icon {
  position: relative
}

.apexcharts-reset-icon {
  margin-left: 5px
}

.apexcharts-menu-icon,
.apexcharts-reset-icon,
.apexcharts-zoom-icon {
  transform: scale(.85)
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px
}

.apexcharts-pan-icon {
  transform: scale(.62);
  position: relative;
  left: 1px;
  top: 0
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6e8192;
  stroke-width: 2
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008ffb
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0 6px 2px;
  display: flex;
  justify-content: space-between;
  align-items: center
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: .15s ease all;
  pointer-events: none
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: .15s ease all
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, .7);
  color: #fff
}

@media screen and (min-width:768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1
  }
}

.apexcharts-canvas .apexcharts-element-hidden,
.apexcharts-datalabel.apexcharts-element-hidden,
.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-hidden-element-shown {
  opacity: 1;
  transition: 0.25s ease all;
}

.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value,
.apexcharts-datalabels,
.apexcharts-pie-label {
  cursor: default;
  pointer-events: none
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: .3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease
}

.apexcharts-radialbar-label {
  cursor: pointer;
}

.apexcharts-annotation-rect,
.apexcharts-area-series .apexcharts-area,
.apexcharts-gridline,
.apexcharts-line,
.apexcharts-point-annotation-label,
.apexcharts-radar-series path:not(.apexcharts-marker),
.apexcharts-radar-series polygon,
.apexcharts-toolbar svg,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-xaxis-annotation-label,
.apexcharts-yaxis-annotation-label,
.apexcharts-zoom-rect,
.no-pointer-events {
  pointer-events: none
}

.apexcharts-tooltip-active .apexcharts-marker {
  transition: .15s ease all
}

.apexcharts-radar-series .apexcharts-yaxis {
  pointer-events: none;
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
  height: 100%;
  width: 100%;
  overflow: hidden
}

.contract-trigger:before,
.resize-triggers,
.resize-triggers>div {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0
}

.resize-triggers>div {
  height: 100%;
  width: 100%;
  background: #eee;
  overflow: auto
}

.contract-trigger:before {
  overflow: hidden;
  width: 200%;
  height: 200%
}

.apexcharts-bar-goals-markers {
  pointer-events: none
}

.apexcharts-bar-shadows {
  pointer-events: none
}

.apexcharts-rangebar-goals-markers {
  pointer-events: none
}

.apexcharts-disable-transitions * {
  transition: none !important;
}`;var x=((b=e.opts.chart)===null||b===void 0?void 0:b.nonce)||e.w.config.chart.nonce;x&&y.setAttribute("nonce",x),A?d.prepend(y):r.head.appendChild(y)}var B=e.create(e.w.config.series,{});if(!B)return i(e);e.mount(B).then(function(){typeof e.w.config.chart.events.mounted=="function"&&e.w.config.chart.events.mounted(e,e.w),e.events.fireEvent("mounted",[e,e.w]),i(B)}).catch(function(T){s(T)})}else s(new Error("Element not found"))})}},{key:"create",value:function(e,i){var s=this,c=this.w;new aE(this).initModules();var d=this.w.globals;if(d.noData=!1,d.animationEnded=!1,!ni.elementExists(this.el)||(this.responsive.checkResponsiveConfig(i),c.config.xaxis.convertedCatToNumeric&&new Dy(c.config).convertCatToNumericXaxis(c.config,this.ctx),this.core.setupElements(),c.config.chart.type==="treemap"&&(c.config.grid.show=!1,c.config.yaxis[0].show=!1),d.svgWidth===0))return d.animationEnded=!0,null;var A=e;e.forEach(function(T,E){T.hidden&&(A=s.legend.legendHelpers.getSeriesAfterCollapsing({realIndex:E}))});var r=nl.checkComboSeries(A,c.config.chart.type);d.comboCharts=r.comboCharts,d.comboBarCount=r.comboBarCount;var y=A.every(function(T){return T.data&&T.data.length===0});(A.length===0||y&&d.collapsedSeries.length<1)&&this.series.handleNoData(),this.events.setupEventHandlers(),this.data.parseData(A),this.theme.init(),new Am(this).setGlobalMarkerSize(),this.formatters.setLabelFormatters(),this.titleSubtitle.draw(),d.noData&&d.collapsedSeries.length!==d.series.length&&!c.config.legend.showForSingleSeries||this.legend.init(),this.series.hasAllSeriesEqualX(),d.axisCharts&&(this.core.coreCalculations(),c.config.xaxis.type!=="category"&&this.formatters.setLabelFormatters(),this.ctx.toolbar.minX=c.globals.minX,this.ctx.toolbar.maxX=c.globals.maxX),this.formatters.heatmapLabelFormatters(),new nl(this).getLargestMarkerSize(),this.dimensions.plotCoords();var b=this.core.xySettings();this.grid.createGridMask();var x=this.core.plotChartType(A,b),B=new am(this);return B.bringForward(),c.config.dataLabels.background.enabled&&B.dataLabelsBackground(),this.core.shiftGraphPosition(),c.globals.dataPoints>50&&c.globals.dom.elWrap.classList.add("apexcharts-disable-transitions"),{elGraph:x,xyRatios:b,dimensions:{plot:{left:c.globals.translateX,top:c.globals.translateY,width:c.globals.gridWidth,height:c.globals.gridHeight}}}}},{key:"mount",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=this,c=s.w;return new Promise(function(d,A){if(s.el===null)return A(new Error("Not enough data to display or target element not found"));(i===null||c.globals.allSeriesCollapsed)&&s.series.handleNoData(),s.grid=new GT(s);var r,y,b=s.grid.drawGrid();if(s.annotations=new NR(s),s.annotations.drawImageAnnos(),s.annotations.drawTextAnnos(),c.config.grid.position==="back"&&(b&&c.globals.dom.elGraphical.add(b.el),b!=null&&(r=b.elGridBorders)!==null&&r!==void 0&&r.node&&c.globals.dom.elGraphical.add(b.elGridBorders)),Array.isArray(i.elGraph))for(var x=0;x<i.elGraph.length;x++)c.globals.dom.elGraphical.add(i.elGraph[x]);else c.globals.dom.elGraphical.add(i.elGraph);c.config.grid.position==="front"&&(b&&c.globals.dom.elGraphical.add(b.el),b!=null&&(y=b.elGridBorders)!==null&&y!==void 0&&y.node&&c.globals.dom.elGraphical.add(b.elGridBorders)),c.config.xaxis.crosshairs.position==="front"&&s.crosshairs.drawXCrosshairs(),c.config.yaxis[0].crosshairs.position==="front"&&s.crosshairs.drawYCrosshairs(),c.config.chart.type!=="treemap"&&s.axes.drawAxis(c.config.chart.type,b);var B=new Uy(e.ctx,b),T=new ew(e.ctx,b);if(b!==null&&(B.xAxisLabelCorrections(b.xAxisTickWidth),T.setYAxisTextAlignments(),c.config.yaxis.map(function(R,P){c.globals.ignoreYAxisIndexes.indexOf(P)===-1&&T.yAxisTitleRotate(P,R.opposite)})),s.annotations.drawAxesAnnotations(),!c.globals.noData){if(c.config.tooltip.enabled&&!c.globals.noData&&s.w.globals.tooltip.drawTooltip(i.xyRatios),c.globals.axisCharts&&(c.globals.isXNumeric||c.config.xaxis.convertedCatToNumeric||c.globals.isRangeBar))(c.config.chart.zoom.enabled||c.config.chart.selection&&c.config.chart.selection.enabled||c.config.chart.pan&&c.config.chart.pan.enabled)&&s.zoomPanSelection.init({xyRatios:i.xyRatios});else{var E=c.config.chart.toolbar.tools;["zoom","zoomin","zoomout","selection","pan","reset"].forEach(function(R){E[R]=!1})}c.config.chart.toolbar.show&&!c.globals.allSeriesCollapsed&&s.toolbar.createToolbar()}c.globals.memory.methodsToExec.length>0&&c.globals.memory.methodsToExec.forEach(function(R){R.method(R.params,!1,R.context)}),c.globals.axisCharts||c.globals.noData||s.core.resizeNonAxisCharts(),d(s)})}},{key:"destroy",value:function(){window.removeEventListener("resize",this.windowResizeHandler),function(i,s){var c=cb.get(s);c&&(c.disconnect(),cb.delete(s))}(this.el.parentNode,this.parentResizeHandler);var e=this.w.config.chart.id;e&&Apex._chartInstances.forEach(function(i,s){i.id===ni.escapeString(e)&&Apex._chartInstances.splice(s,1)}),new lE(this.ctx).clear({isUpdating:!1})}},{key:"updateOptions",value:function(e){var i=this,s=arguments.length>1&&arguments[1]!==void 0&&arguments[1],c=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],d=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],r=this.w;return r.globals.selection=void 0,this.lastUpdateOptions&&JSON.stringify(this.lastUpdateOptions)===JSON.stringify(e)?this:(this.lastUpdateOptions=ni.clone(e),e.series&&(this.series.resetSeries(!1,!0,!1),e.series.length&&e.series[0].data&&(e.series=e.series.map(function(y,b){return i.updateHelpers._extendSeries(y,b)})),this.updateHelpers.revertDefaultAxisMinMax()),e.xaxis&&(e=this.updateHelpers.forceXAxisUpdate(e)),e.yaxis&&(e=this.updateHelpers.forceYAxisUpdate(e)),r.globals.collapsedSeriesIndices.length>0&&this.series.clearPreviousPaths(),e.theme&&(e=this.theme.updateThemeOptions(e)),this.updateHelpers._updateOptions(e,s,c,d,A))}},{key:"updateSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];return this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(e,i,s)}},{key:"appendSeries",value:function(e){var i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],c=this.w.config.series.slice();return c.push(e),this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(c,i,s)}},{key:"appendData",value:function(e){var i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this;s.w.globals.dataChanged=!0,s.series.getPreviousPaths();for(var c=s.w.config.series.slice(),d=0;d<c.length;d++)if(e[d]!==null&&e[d]!==void 0)for(var A=0;A<e[d].data.length;A++)c[d].data.push(e[d].data[A]);return s.w.config.series=c,i&&(s.w.globals.initialSeries=ni.clone(s.w.config.series)),this.update()}},{key:"update",value:function(e){var i=this;return new Promise(function(s,c){if(i.lastUpdateOptions&&JSON.stringify(i.lastUpdateOptions)===JSON.stringify(e))return s(i);i.lastUpdateOptions=ni.clone(e),new lE(i.ctx).clear({isUpdating:!0});var d=i.create(i.w.config.series,e);if(!d)return s(i);i.mount(d).then(function(){typeof i.w.config.chart.events.updated=="function"&&i.w.config.chart.events.updated(i,i.w),i.events.fireEvent("updated",[i,i.w]),i.w.globals.isDirty=!0,s(i)}).catch(function(A){c(A)})})}},{key:"getSyncedCharts",value:function(){var e=this.getGroupedCharts(),i=[this];return e.length&&(i=[],e.forEach(function(s){i.push(s)})),i}},{key:"getGroupedCharts",value:function(){var e=this;return Apex._chartInstances.filter(function(i){if(i.group)return!0}).map(function(i){return e.w.config.chart.group===i.group?i.chart:e})}},{key:"toggleSeries",value:function(e){return this.series.toggleSeries(e)}},{key:"highlightSeriesOnLegendHover",value:function(e,i){return this.series.toggleSeriesOnHover(e,i)}},{key:"showSeries",value:function(e){this.series.showSeries(e)}},{key:"hideSeries",value:function(e){this.series.hideSeries(e)}},{key:"highlightSeries",value:function(e){this.series.highlightSeries(e)}},{key:"isSeriesHidden",value:function(e){this.series.isSeriesHidden(e)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.series.resetSeries(e,i)}},{key:"addEventListener",value:function(e,i){this.events.addEventListener(e,i)}},{key:"removeEventListener",value:function(e,i){this.events.removeEventListener(e,i)}},{key:"addXaxisAnnotation",value:function(e){var i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addXaxisAnnotationExternal(e,i,c)}},{key:"addYaxisAnnotation",value:function(e){var i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addYaxisAnnotationExternal(e,i,c)}},{key:"addPointAnnotation",value:function(e){var i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addPointAnnotationExternal(e,i,c)}},{key:"clearAnnotations",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,i=this;e&&(i=e),i.annotations.clearAnnotations(i)}},{key:"removeAnnotation",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=this;i&&(s=i),s.annotations.removeAnnotation(s,e)}},{key:"getChartArea",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner")}},{key:"getSeriesTotalXRange",value:function(e,i){return this.coreUtils.getSeriesTotalsXRange(e,i)}},{key:"getHighestValueInSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Kb(this.ctx).getMinYMaxY(e).highestY}},{key:"getLowestValueInSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Kb(this.ctx).getMinYMaxY(e).lowestY}},{key:"getSeriesTotal",value:function(){return this.w.globals.seriesTotals}},{key:"toggleDataPointSelection",value:function(e,i){return this.updateHelpers.toggleDataPointSelection(e,i)}},{key:"zoomX",value:function(e,i){this.ctx.toolbar.zoomUpdateOptions(e,i)}},{key:"setLocale",value:function(e){this.localization.setCurrentLocaleValues(e)}},{key:"dataURI",value:function(e){return new vy(this.ctx).dataURI(e)}},{key:"getSvgString",value:function(e){return new vy(this.ctx).getSvgString(e)}},{key:"exportToCSV",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new vy(this.ctx).exportToCSV(e)}},{key:"paper",value:function(){return this.w.globals.dom.Paper}},{key:"_parentResizeCallback",value:function(){this.w.globals.animationEnded&&this.w.config.chart.redrawOnParentResize&&this._windowResize()}},{key:"_windowResize",value:function(){var e=this;clearTimeout(this.w.globals.resizeTimer),this.w.globals.resizeTimer=window.setTimeout(function(){e.w.globals.resized=!0,e.w.globals.dataChanged=!1,e.ctx.update()},150)}},{key:"_windowResizeHandler",value:function(){var e=this.w.config.chart.redrawOnWindowResize;typeof e=="function"&&(e=e()),e&&this._windowResize()}}],[{key:"getChartByID",value:function(e){var i=ni.escapeString(e);if(Apex._chartInstances){var s=Apex._chartInstances.filter(function(c){return c.id===i})[0];return s&&s.chart}}},{key:"initOnLoad",value:function(){for(var e=document.querySelectorAll("[data-apexcharts]"),i=0;i<e.length;i++)new a(e[i],JSON.parse(e[i].getAttribute("data-options"))).render()}},{key:"exec",value:function(e,i){var s=this.getChartByID(e);if(s){s.w.globals.isExecCalled=!0;var c=null;if(s.publicMethods.indexOf(i)!==-1){for(var d=arguments.length,A=new Array(d>2?d-2:0),r=2;r<d;r++)A[r-2]=arguments[r];c=s[i].apply(s,A)}return c}}},{key:"merge",value:function(e,i){return ni.extend(e,i)}}]),a}();const uE=["animationEnd","beforeMount","mounted","updated","click","mouseMove","mouseLeave","legendClick","markerClick","selection","dataPointSelection","dataPointMouseEnter","dataPointMouseLeave","beforeZoom","beforeResetZoom","zoomed","scrolled","brushScrolled"],Ka=P1({name:"apexchart",props:{options:{type:Object},type:{type:String},series:{type:Array,required:!0},width:{default:"100%"},height:{default:"auto"}},emits:uE,setup(a,{emit:e}){const i=fr(null),s=fr(null),c=oe=>oe&&typeof oe=="object"&&!Array.isArray(oe)&&oe!=null,d=(oe,ye)=>{typeof Object.assign!="function"&&function(){Object.assign=function(Be){if(Be==null)throw new TypeError("Cannot convert undefined or null to object");let Pe=Object(Be);for(let De=1;De<arguments.length;De++){let et=arguments[De];if(et!=null)for(let Ye in et)et.hasOwnProperty(Ye)&&(Pe[Ye]=et[Ye])}return Pe}}();let Me=Object.assign({},oe);return c(oe)&&c(ye)&&Object.keys(ye).forEach(Be=>{c(ye[Be])?Be in oe?Me[Be]=d(oe[Be],ye[Be]):Object.assign(Me,{[Be]:ye[Be]}):Object.assign(Me,{[Be]:ye[Be]})}),Me},A=async()=>{if(await $v(),s.value)return;const oe={chart:{type:a.type||a.options.chart.type||"line",height:a.height,width:a.width,events:{}},series:a.series},ye=a.options.chart?a.options.chart.events:null;uE.forEach(Be=>{let Pe=(...De)=>e(Be,...De);oe.chart.events[Be]=(...De)=>{Pe(...De),ye&&ye.hasOwnProperty(Be)&&ye[Be](...De)}});const Me=d(a.options,oe);return s.value=new cE(i.value,Me),s.value.render()},r=()=>(y(),A()),y=()=>{s.value.destroy(),s.value=null},b=(oe,ye)=>s.value.updateSeries(oe,ye),x=(oe,ye,Me,Be)=>s.value.updateOptions(oe,ye,Me,Be),B=oe=>s.value.toggleSeries(oe),T=oe=>{s.value.showSeries(oe)},E=oe=>{s.value.hideSeries(oe)},R=(oe,ye)=>s.value.appendSeries(oe,ye),P=()=>{s.value.resetSeries()},G=(oe,ye)=>{s.value.toggleDataPointSelection(oe,ye)},U=oe=>s.value.appendData(oe),Q=(oe,ye)=>s.value.zoomX(oe,ye),q=oe=>s.value.dataURI(oe),ne=oe=>s.value.setLocale(oe),re=(oe,ye)=>{s.value.addXaxisAnnotation(oe,ye)},pe=(oe,ye)=>{s.value.addYaxisAnnotation(oe,ye)},fe=(oe,ye)=>{s.value.addPointAnnotation(oe,ye)},he=(oe,ye)=>{s.value.removeAnnotation(oe,ye)},be=()=>{s.value.clearAnnotations()};S5(()=>{window.ApexCharts=cE}),_p(()=>{i.value=JP().proxy.$el,A()}),E5(()=>{s.value&&y()});const Se=X3(a);return xf(Se.options,()=>{!s.value&&a.options?A():s.value.updateOptions(a.options)}),xf(Se.series,()=>{!s.value&&a.series?A():s.value.updateSeries(a.series)},{deep:!0}),xf(Se.type,()=>{r()}),xf(Se.width,()=>{r()}),xf(Se.height,()=>{r()}),{chart:s,init:A,refresh:r,destroy:y,updateOptions:x,updateSeries:b,toggleSeries:B,showSeries:T,hideSeries:E,resetSeries:P,zoomX:Q,toggleDataPointSelection:G,appendData:U,appendSeries:R,addXaxisAnnotation:re,addYaxisAnnotation:pe,addPointAnnotation:fe,removeAnnotation:he,clearAnnotations:be,setLocale:ne,dataURI:q}},render(){return O1("div",{class:"vue-apexcharts"})}}),_D=a=>{a.component(Ka.name,Ka)};Ka.install=_D;const xD={class:"picklist"},bD={key:0},wD=["modelValue"],BD=["value"],CD={__name:"Picklist",props:{modelValue:[String,Number],label:String,options:{type:Array,required:!0}},emits:["update:modelValue"],setup(a){return(e,i)=>(os(),Hs("div",xD,[a.label?(os(),Hs("label",bD,$s(a.label),1)):t_("",!0),Tt("select",{modelValue:a.modelValue,onChange:i[0]||(i[0]=s=>e.$emit("update:modelValue",s.target.value))},[(os(!0),Hs(Mc,null,xp(a.options,s=>(os(),Hs("option",{key:s.value,value:s.value},$s(s.label),9,BD))),128))],40,wD)]))}},sg=Uc(CD,[["__scopeId","data-v-85b96b99"]]),SD={class:"dashboard-tiempo-real"},ED={class:"header"},TD={class:"kpi-container"},ID={class:"value"},FD={class:"charts-section"},LD={class:"chart-item"},MD={class:"chart-item"},PD={class:"custom-charts-section"},kD={class:"custom-charts-header"},RD={class:"custom-controls"},DD={class:"custom-charts-container"},OD={class:"chart-item custom-chart"},UD={class:"chart-item custom-chart"},zD={class:"custom-charts-container"},ND={class:"chart-item custom-chart"},jD={class:"chart-item custom-chart"},HD={__name:"EnergiaChart",setup(a){const e=fr([{label:"Energa Total (kWh)",value:0},{label:"Potencia Instantnea (kW)",value:0},{label:"Frecuencia (Hz)",value:0}]),i=fr([{name:"Consumo",data:[]}]),s=fr({chart:{id:"realtime-consumo",animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:1e3}}},xaxis:{type:"datetime"},yaxis:{title:{text:"kWh"}},title:{text:"Consumo Energtico"}}),c=fr([{name:"Potencia",data:[]}]),d=fr({chart:{id:"realtime-potencia",animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:1e3}}},xaxis:{type:"datetime"},yaxis:{title:{text:"kW"}},title:{text:"Potencia Activa"}});let A=null;function r(){const he=new Date().getTime(),be=+(Math.random()*10+40).toFixed(2),Se=+(Math.random()*5+20).toFixed(2),oe=+(Math.random()*.2+49.8).toFixed(2);i.value[0].data.push({x:he,y:be}),c.value[0].data.push({x:he,y:Se}),i.value[0].data.length>20&&i.value[0].data.shift(),c.value[0].data.length>20&&c.value[0].data.shift(),e.value[0].value=be,e.value[1].value=Se,e.value[2].value=oe}_p(()=>{r(),A=setInterval(r,2e3)}),Ty(()=>{clearInterval(A)});const y=[{value:"energia",label:"Energa (kWh)"},{value:"potencia",label:"Potencia (kW)"},{value:"voltaje",label:"Voltaje (V)"},{value:"corriente",label:"Corriente (A)"},{value:"voltaje_conjunto",label:"Conjunto Voltaje"},{value:"corriente_conjunto",label:"Conjunto Corriente"},{value:"potencia_conjunto",label:"Conjunto Potencia"}],b=fr("energia"),x=fr("potencia"),B=fr("voltaje_conjunto"),T=fr("corriente_conjunto"),E=fr([{name:"",data:[]}]),R=fr({chart:{id:"custom-chart-1",height:300},xaxis:{type:"datetime"},title:{text:"Grfico de Energa (kWh)"}}),P=fr([{name:"",data:[]}]),G=fr({chart:{id:"custom-chart-2",height:300},xaxis:{type:"datetime"},title:{text:"Grfico de Potencia (kW)"}}),U=fr([{name:"",data:[]}]),Q=fr({chart:{id:"custom-chart-3",height:300},xaxis:{type:"datetime"},title:{text:"Grfico de Conjunto Voltaje"}}),q=fr([{name:"",data:[]}]),ne=fr({chart:{id:"custom-chart-4",height:300},xaxis:{type:"datetime"},title:{text:"Grfico de Conjunto Corriente"}});function re(){const he=y.find(ye=>ye.value===b.value),be=y.find(ye=>ye.value===x.value),Se=y.find(ye=>ye.value===B.value),oe=y.find(ye=>ye.value===T.value);E.value=[{name:he.label,data:[]}],P.value=[{name:be.label,data:[]}],U.value=[{name:Se.label,data:[]}],q.value=[{name:oe.label,data:[]}],R.value={chart:{id:"custom-chart-1",height:300},xaxis:{type:"datetime"},title:{text:`Grfico de ${he.label}`}},G.value={chart:{id:"custom-chart-2",height:300},xaxis:{type:"datetime"},title:{text:`Grfico de ${be.label}`}},Q.value={chart:{id:"custom-chart-3",height:300},xaxis:{type:"datetime"},title:{text:`Grfico de ${Se.label}`}},ne.value={chart:{id:"custom-chart-4",height:300},xaxis:{type:"datetime"},title:{text:`Grfico de ${oe.label}`}}}function pe(){const he=new Date().getTime();function be(Ye){switch(Ye){case"energia":return 100;case"potencia":return 50;case"voltaje":return 220;case"corriente":return 30;case"voltaje_conjunto":return 210;case"corriente_conjunto":return 28;case"potencia_conjunto":return 55;default:return 0}}const Se=be(b.value),oe=+(Se+(Math.random()*Se*.2-Se*.1)).toFixed(1);E.value[0].data.push({x:he,y:oe}),E.value[0].data.length>20&&E.value[0].data.shift();const ye=be(x.value),Me=+(ye+(Math.random()*ye*.2-ye*.1)).toFixed(1);P.value[0].data.push({x:he,y:Me}),P.value[0].data.length>20&&P.value[0].data.shift();const Be=be(B.value),Pe=+(Be+(Math.random()*Be*.2-Be*.1)).toFixed(1);U.value[0].data.push({x:he,y:Pe}),U.value[0].data.length>20&&U.value[0].data.shift();const De=be(T.value),et=+(De+(Math.random()*De*.2-De*.1)).toFixed(1);q.value[0].data.push({x:he,y:et}),q.value[0].data.length>20&&q.value[0].data.shift()}let fe=null;return _p(()=>{fe=setInterval(pe,2e3)}),Ty(()=>{clearInterval(fe)}),re(),(he,be)=>(os(),Hs("div",SD,[Tt("header",ED,[be[4]||(be[4]=Tt("h2",null,"Dashboard de Tiempo Real  Nivel God",-1)),Tt("div",TD,[(os(!0),Hs(Mc,null,xp(e.value,(Se,oe)=>(os(),Hs("div",{class:"kpi-card",key:oe},[Tt("h3",null,$s(Se.label),1),Tt("p",ID,$s(Se.value),1)]))),128))])]),Tt("section",FD,[Tt("div",LD,[be[5]||(be[5]=Tt("h3",null,"Consumo Energtico en Tiempo Real",-1)),$n(Aa(Ka),{type:"line",height:"300",options:s.value,series:i.value},null,8,["options","series"])]),Tt("div",MD,[be[6]||(be[6]=Tt("h3",null,"Potencia Activa en Tiempo Real",-1)),$n(Aa(Ka),{type:"line",height:"300",options:d.value,series:c.value},null,8,["options","series"])])]),Tt("section",PD,[Tt("header",kD,[be[7]||(be[7]=Tt("h3",null,"Visualizacin Personalizada de Parmetros en Tiempo Real",-1)),Tt("div",RD,[$n(sg,{modelValue:b.value,"onUpdate:modelValue":be[0]||(be[0]=Se=>b.value=Se),options:y,label:"Parmetro Grfico 1"},null,8,["modelValue"]),$n(sg,{modelValue:x.value,"onUpdate:modelValue":be[1]||(be[1]=Se=>x.value=Se),options:y,label:"Parmetro Grfico 2"},null,8,["modelValue"]),$n(sg,{modelValue:B.value,"onUpdate:modelValue":be[2]||(be[2]=Se=>B.value=Se),options:y,label:"Parmetro Grfico 3 (Conjunto)"},null,8,["modelValue"]),$n(sg,{modelValue:T.value,"onUpdate:modelValue":be[3]||(be[3]=Se=>T.value=Se),options:y,label:"Parmetro Grfico 4 (Conjunto)"},null,8,["modelValue"]),Tt("button",{onClick:re},"Actualizar Grficos")])]),Tt("div",DD,[Tt("div",OD,[(os(),tg(Aa(Ka),{key:"custom-chart-1-"+b.value.value,type:"line",height:"300",options:R.value,series:E.value},null,8,["options","series"]))]),Tt("div",UD,[(os(),tg(Aa(Ka),{key:"custom-chart-2-"+x.value.value,type:"line",height:"300",options:G.value,series:P.value},null,8,["options","series"]))])]),Tt("div",zD,[Tt("div",ND,[(os(),tg(Aa(Ka),{key:"custom-chart-3-"+B.value.value,type:"line",height:"300",options:Q.value,series:U.value},null,8,["options","series"]))]),Tt("div",jD,[(os(),tg(Aa(Ka),{key:"custom-chart-4-"+T.value.value,type:"line",height:"300",options:ne.value,series:q.value},null,8,["options","series"]))])])])]))}},QD=Uc(HD,[["__scopeId","data-v-3b390790"]]),VD={__name:"Dashboard",setup(a){return(e,i)=>(os(),tg(QD))}},GD={class:"reportes"},WD={class:"filtros"},XD={__name:"Reportes",setup(a){const e=fr(""),i=fr(""),s=fr("");function c(){console.log("Descargando CSV",{desde:e.value,hasta:i.value,dispositivo:s.value})}return(d,A)=>(os(),Hs("div",GD,[A[6]||(A[6]=Tt("h2",null,"Generador de Reportes",-1)),Tt("div",WD,[A[4]||(A[4]=Tt("label",null,"Desde:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":A[0]||(A[0]=r=>e.value=r)},null,512),[[Yl,e.value]]),A[5]||(A[5]=Tt("label",null,"Hasta:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":A[1]||(A[1]=r=>i.value=r)},null,512),[[Yl,i.value]]),fa(Tt("select",{"onUpdate:modelValue":A[2]||(A[2]=r=>s.value=r)},A[3]||(A[3]=[Tt("option",{value:""},"Todos los dispositivos",-1),Tt("option",{value:"medidor1"},"Medidor 1",-1),Tt("option",{value:"medidor2"},"Medidor 2",-1)]),512),[[r_,s.value]]),Tt("button",{onClick:c},"Descargar CSV")])]))}},YD=Uc(XD,[["__scopeId","data-v-0e39b692"]]),KD={};function qD(a,e){return os(),Hs("div",null,e[0]||(e[0]=[Tt("h2",null,"Configuracin",-1),Tt("p",null,"Ajustes y configuraciones del sistema.",-1)]))}const $D=Uc(KD,[["render",qD]]),ZD={class:"tendencias-dashboard"},JD={class:"barra-superior"},eO={class:"filtros"},tO={class:"fechas"},iO={class:"selector-intervalo"},rO={class:"grafico-linea"},nO={class:"grafico-heatmap"},sO={__name:"Tendencias",setup(a){const e=fr("energia"),i=fr("todos"),s=fr(Mo().subtract(7,"day").format("YYYY-MM-DD")),c=fr(Mo().format("YYYY-MM-DD")),d=fr([{name:"Actual",type:"line",data:[]},{name:"Histrico Promedio",type:"area",data:[]}]),A=fr({chart:{id:"tendencias-linea",toolbar:{tools:{zoom:!0,reset:!0,pan:!0}},zoom:{enabled:!0,type:"x"}},colors:["#007bff","#b0c4de"],stroke:{curve:"smooth"},xaxis:{type:"datetime"},fill:{type:"area",gradient:{opacityFrom:.2,opacityTo:0}},tooltip:{x:{format:"yyyy-MM-dd"}}}),r=fr([]),y=fr({chart:{id:"tendencias-heatmap"},dataLabels:{enabled:!1},xaxis:{type:"category",categories:Array.from({length:24},(E,R)=>`${R.toString().padStart(2,"0")}h`)},colors:["#e0f3f8","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],plotOptions:{heatmap:{shadeIntensity:.5,radius:4,useFillColorAsStroke:!1}}});function b(){const E=Mo(s.value),R=Mo(c.value).diff(E,"day")+1,P=[],G=[];for(let U=0;U<R;U++){const Q=E.add(U,"day").valueOf();P.push({x:Q,y:+(Math.random()*30+20).toFixed(2)}),G.push({x:Q,y:+(Math.random()*10+25).toFixed(2)})}d.value[0].data=P,d.value[1].data=G}function x(){const E=[];for(let R=1;R<=7;R++){const P=`Da ${R}`,G=[];for(let U=0;U<24;U++)G.push({x:`${U.toString().padStart(2,"0")}h`,y:+(Math.random()*8+2).toFixed(1)});E.push({name:P,data:G})}r.value=E}function B(){b(),x()}function T(E){s.value=Mo().subtract(E,"day").format("YYYY-MM-DD"),c.value=Mo().format("YYYY-MM-DD"),B()}return _p(()=>{B()}),(E,R)=>{const P=Gy("ApexChart");return os(),Hs("div",ZD,[Tt("header",JD,[R[9]||(R[9]=Tt("h2",null,"Tendencias histricas",-1)),Tt("div",eO,[$n(sg,{modelValue:e.value,"onUpdate:modelValue":R[0]||(R[0]=G=>e.value=G),label:"Variable",options:[{value:"energia",label:"Energa activa (kWh)"},{value:"potencia",label:"Potencia (kW)"}]},null,8,["modelValue"]),$n(sg,{modelValue:i.value,"onUpdate:modelValue":R[1]||(R[1]=G=>i.value=G),label:"Dispositivo",options:[{value:"todos",label:"Todos"},{value:"medidor1",label:"Medidor 1"},{value:"medidor2",label:"Medidor 2"}]},null,8,["modelValue"]),Tt("div",tO,[R[7]||(R[7]=Tt("label",null,"Desde",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":R[2]||(R[2]=G=>s.value=G)},null,512),[[Yl,s.value]]),R[8]||(R[8]=Tt("label",null,"Hasta",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":R[3]||(R[3]=G=>c.value=G)},null,512),[[Yl,c.value]])]),Tt("button",{onClick:B},"Filtrar")])]),Tt("section",iO,[Tt("button",{onClick:R[4]||(R[4]=G=>T(7))},"ltimos 7 das"),Tt("button",{onClick:R[5]||(R[5]=G=>T(15))},"ltimos 15 das"),Tt("button",{onClick:R[6]||(R[6]=G=>T(30))},"ltimos 30 das")]),Tt("section",rO,[R[10]||(R[10]=Tt("h3",null,"Comportamiento por fecha",-1)),$n(P,{type:"line",height:"320",options:A.value,series:d.value},null,8,["options","series"])]),Tt("section",nO,[R[11]||(R[11]=Tt("h3",null,"Mapa de consumo horario",-1)),$n(P,{type:"heatmap",height:"320",options:y.value,series:r.value},null,8,["options","series"])])])}}},oO=Uc(sO,[["__scopeId","data-v-0e162564"]]),aO={class:"dashboard-anomalias"},lO={class:"header"},cO={class:"controls"},uO={class:"fecha-control"},hO={class:"umbrales"},dO={class:"metrics"},AO={class:"card"},fO={class:"value"},pO={class:"card"},gO={class:"value"},mO={class:"card"},yO={class:"value"},vO={class:"card"},_O={class:"value"},xO={class:"trend-chart"},bO={class:"incidents-table"},wO={class:"heatmap-chart"},BO={__name:"Anomalias",setup(a){const e=fr("energia"),i=fr(Mo().subtract(7,"day").format("YYYY-MM-DD")),s=fr(Mo().format("YYYY-MM-DD")),c=fr(30),d=fr(70),A=fr(0),r=fr(0),y=fr(0),b=fr(0),x=fr([]),B=fr({chart:{id:"trend-anomalias"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},markers:{size:6,strokeWidth:2,strokeColors:"#fff"},title:{text:"Tendencia del Parmetro con Anomalas"}}),T=fr([]),E=fr([]),R=fr({chart:{id:"heatmap-anomalias"},plotOptions:{heatmap:{shadeIntensity:.5,radius:4}},dataLabels:{enabled:!1},xaxis:{type:"category",categories:Array.from({length:24},(G,U)=>`${U}h`)},title:{text:"Distribucin Horaria de Anomalas"}});function P(){T.value=[];const G=[];let U=0,Q=0,q=0,ne=0;const re=Mo(i.value),fe=Mo(s.value).diff(re,"day")+1;for(let Se=0;Se<fe;Se++){const oe=re.add(Se,"day"),ye=50,Me=Math.random()*20-10,Be=+(ye+Me).toFixed(1);if(G.push({x:oe.valueOf(),y:Be}),Be<c.value||Be>d.value){let Pe=0,De="";Be<c.value?(Pe=+((c.value-Be)/c.value*100).toFixed(1),De="Baja"):Be>d.value&&(Pe=+((Be-d.value)/d.value*100).toFixed(1),De="Alta");const et=Math.floor(Math.random()*60)+1;T.value.push({fecha:oe.format("YYYY-MM-DD"),valor:Be,umbral:Be<c.value?c.value:d.value,desviacion:Pe,duracion:et,tipo:De}),U+=Pe,Q+=et,q++,Pe>ne&&(ne=Pe)}}A.value=q,q>0?(r.value=+(U/q).toFixed(1),b.value=Math.floor(Q/q),y.value=ne):(r.value=0,b.value=0,y.value=0),x.value=[{name:e.value,data:G.map(Se=>{const oe=Se.y<c.value||Se.y>d.value;return{x:Se.x,y:Se.y,marker:oe?{fillColor:"#FF0000",size:8}:{}}})}];const he=[],be=Math.min(fe,7);for(let Se=0;Se<be;Se++){const oe=[];for(let ye=0;ye<24;ye++)oe.push({x:`${ye}h`,y:Math.floor(Math.random()*6)});he.push({name:`Da ${Se+1}`,data:oe})}E.value=he}return P(),(G,U)=>(os(),Hs("div",aO,[Tt("header",lO,[U[11]||(U[11]=Tt("h2",null,"Dashboard de Anomalas",-1)),Tt("div",cO,[U[10]||(U[10]=Tt("label",null,"Parmetro:",-1)),fa(Tt("select",{"onUpdate:modelValue":U[0]||(U[0]=Q=>e.value=Q)},U[5]||(U[5]=[Tt("option",{value:"energia"},"Energa (kWh)",-1),Tt("option",{value:"potencia"},"Potencia (kW)",-1),Tt("option",{value:"voltaje"},"Voltaje (V)",-1)]),512),[[r_,e.value]]),Tt("div",uO,[U[6]||(U[6]=Tt("label",null,"Desde:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":U[1]||(U[1]=Q=>i.value=Q)},null,512),[[Yl,i.value]]),U[7]||(U[7]=Tt("label",null,"Hasta:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":U[2]||(U[2]=Q=>s.value=Q)},null,512),[[Yl,s.value]])]),Tt("div",hO,[U[8]||(U[8]=Tt("label",null,"Umbral Inferior:",-1)),fa(Tt("input",{type:"number","onUpdate:modelValue":U[3]||(U[3]=Q=>c.value=Q),placeholder:"Valor inferior"},null,512),[[Yl,c.value]]),U[9]||(U[9]=Tt("label",null,"Umbral Superior:",-1)),fa(Tt("input",{type:"number","onUpdate:modelValue":U[4]||(U[4]=Q=>d.value=Q),placeholder:"Valor superior"},null,512),[[Yl,d.value]])]),Tt("button",{onClick:P},"Analizar")])]),Tt("section",dO,[Tt("div",AO,[U[12]||(U[12]=Tt("h3",null,"Total de Anomalas",-1)),Tt("p",fO,$s(A.value),1)]),Tt("div",pO,[U[13]||(U[13]=Tt("h3",null,"Desviacin Promedio",-1)),Tt("p",gO,$s(r.value)+"%",1)]),Tt("div",mO,[U[14]||(U[14]=Tt("h3",null,"Mxima Desviacin",-1)),Tt("p",yO,$s(y.value)+"%",1)]),Tt("div",vO,[U[15]||(U[15]=Tt("h3",null,"Duracin Promedio",-1)),Tt("p",_O,$s(b.value)+" min",1)])]),Tt("section",xO,[U[16]||(U[16]=Tt("h3",null,"Tendencia del Parmetro con Anomalas",-1)),$n(Aa(Ka),{type:"line",height:"300",options:B.value,series:x.value},null,8,["options","series"])]),Tt("section",bO,[U[18]||(U[18]=Tt("h3",null,"Tabla de Incidentes",-1)),Tt("table",null,[U[17]||(U[17]=Tt("thead",null,[Tt("tr",null,[Tt("th",null,"Fecha y Hora"),Tt("th",null,"Valor Medido"),Tt("th",null,"Umbral"),Tt("th",null,"Desviacin (%)"),Tt("th",null,"Tipo")])],-1)),Tt("tbody",null,[(os(!0),Hs(Mc,null,xp(T.value,(Q,q)=>(os(),Hs("tr",{key:q},[Tt("td",null,$s(Q.fecha),1),Tt("td",null,$s(Q.valor),1),Tt("td",null,$s(Q.umbral),1),Tt("td",null,$s(Q.desviacion)+"%",1),Tt("td",null,$s(Q.tipo),1)]))),128))])])]),Tt("section",wO,[U[19]||(U[19]=Tt("h3",null,"Distribucin Horaria de Anomalas",-1)),$n(Aa(Ka),{type:"heatmap",height:"300",options:R.value,series:E.value},null,8,["options","series"])])]))}},CO=Uc(BO,[["__scopeId","data-v-27bca5b5"]]);var ub={exports:{}};const SO="modulepreload",EO=function(a){return"/"+a},hE={},t1=function(e,i,s){let c=Promise.resolve();if(i&&i.length>0){let A=function(b){return Promise.all(b.map(x=>Promise.resolve(x).then(B=>({status:"fulfilled",value:B}),B=>({status:"rejected",reason:B}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),y=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));c=A(i.map(b=>{if(b=EO(b),b in hE)return;hE[b]=!0;const x=b.endsWith(".css"),B=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${B}`))return;const T=document.createElement("link");if(T.rel=x?"stylesheet":SO,x||(T.as="script"),T.crossOrigin="",T.href=b,y&&T.setAttribute("nonce",y),document.head.appendChild(T),x)return new Promise((E,R)=>{T.addEventListener("load",E),T.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${b}`)))})}))}function d(A){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=A,window.dispatchEvent(r),!r.defaultPrevented)throw A}return c.then(A=>{for(const r of A||[])r.status==="rejected"&&d(r.reason);return e().catch(d)})};function Go(a){"@babel/helpers - typeof";return Go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Go(a)}var ou=Uint8Array,Uh=Uint16Array,tw=Int32Array,l_=new ou([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c_=new ou([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i1=new ou([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rI=function(a,e){for(var i=new Uh(31),s=0;s<31;++s)i[s]=e+=1<<a[s-1];for(var c=new tw(i[30]),s=1;s<30;++s)for(var d=i[s];d<i[s+1];++d)c[d]=d-i[s]<<5|s;return{b:i,r:c}},nI=rI(l_,2),sI=nI.b,r1=nI.r;sI[28]=258,r1[258]=28;var oI=rI(c_,0),TO=oI.b,dE=oI.r,n1=new Uh(32768);for(var Ea=0;Ea<32768;++Ea){var ap=(Ea&43690)>>1|(Ea&21845)<<1;ap=(ap&52428)>>2|(ap&13107)<<2,ap=(ap&61680)>>4|(ap&3855)<<4,n1[Ea]=((ap&65280)>>8|(ap&255)<<8)>>1}var HA=function(a,e,i){for(var s=a.length,c=0,d=new Uh(e);c<s;++c)a[c]&&++d[a[c]-1];var A=new Uh(e);for(c=1;c<e;++c)A[c]=A[c-1]+d[c-1]<<1;var r;if(i){r=new Uh(1<<e);var y=15-e;for(c=0;c<s;++c)if(a[c])for(var b=c<<4|a[c],x=e-a[c],B=A[a[c]-1]++<<x,T=B|(1<<x)-1;B<=T;++B)r[n1[B]>>y]=b}else for(r=new Uh(s),c=0;c<s;++c)a[c]&&(r[c]=n1[A[a[c]-1]++]>>15-a[c]);return r},Cp=new ou(288);for(var Ea=0;Ea<144;++Ea)Cp[Ea]=8;for(var Ea=144;Ea<256;++Ea)Cp[Ea]=9;for(var Ea=256;Ea<280;++Ea)Cp[Ea]=7;for(var Ea=280;Ea<288;++Ea)Cp[Ea]=8;var zy=new ou(32);for(var Ea=0;Ea<32;++Ea)zy[Ea]=5;var IO=HA(Cp,9,0),FO=HA(Cp,9,1),LO=HA(zy,5,0),MO=HA(zy,5,1),hb=function(a){for(var e=a[0],i=1;i<a.length;++i)a[i]>e&&(e=a[i]);return e},Nd=function(a,e,i){var s=e/8|0;return(a[s]|a[s+1]<<8)>>(e&7)&i},db=function(a,e){var i=e/8|0;return(a[i]|a[i+1]<<8|a[i+2]<<16)>>(e&7)},iw=function(a){return(a+7)/8|0},aI=function(a,e,i){return(i==null||i>a.length)&&(i=a.length),new ou(a.subarray(e,i))},PO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qd=function(a,e,i){var s=new Error(e||PO[a]);if(s.code=a,Error.captureStackTrace&&Error.captureStackTrace(s,Qd),!i)throw s;return s},kO=function(a,e,i,s){var c=a.length,d=0;if(!c||e.f&&!e.l)return i||new ou(0);var A=!i,r=A||e.i!=2,y=e.i;A&&(i=new ou(c*3));var b=function(Ai){var qe=i.length;if(Ai>qe){var Ke=new ou(Math.max(qe*2,Ai));Ke.set(i),i=Ke}},x=e.f||0,B=e.p||0,T=e.b||0,E=e.l,R=e.d,P=e.m,G=e.n,U=c*8;do{if(!E){x=Nd(a,B,1);var Q=Nd(a,B+1,3);if(B+=3,Q)if(Q==1)E=FO,R=MO,P=9,G=5;else if(Q==2){var pe=Nd(a,B,31)+257,fe=Nd(a,B+10,15)+4,he=pe+Nd(a,B+5,31)+1;B+=14;for(var be=new ou(he),Se=new ou(19),oe=0;oe<fe;++oe)Se[i1[oe]]=Nd(a,B+oe*3,7);B+=fe*3;for(var ye=hb(Se),Me=(1<<ye)-1,Be=HA(Se,ye,1),oe=0;oe<he;){var Pe=Be[Nd(a,B,Me)];B+=Pe&15;var q=Pe>>4;if(q<16)be[oe++]=q;else{var De=0,et=0;for(q==16?(et=3+Nd(a,B,3),B+=2,De=be[oe-1]):q==17?(et=3+Nd(a,B,7),B+=3):q==18&&(et=11+Nd(a,B,127),B+=7);et--;)be[oe++]=De}}var Ye=be.subarray(0,pe),bt=be.subarray(pe);P=hb(Ye),G=hb(bt),E=HA(Ye,P,1),R=HA(bt,G,1)}else Qd(1);else{var q=iw(B)+4,ne=a[q-4]|a[q-3]<<8,re=q+ne;if(re>c){y&&Qd(0);break}r&&b(T+ne),i.set(a.subarray(q,re),T),e.b=T+=ne,e.p=B=re*8,e.f=x;continue}if(B>U){y&&Qd(0);break}}r&&b(T+131072);for(var pt=(1<<P)-1,Qt=(1<<G)-1,Ie=B;;Ie=B){var De=E[db(a,B)&pt],ot=De>>4;if(B+=De&15,B>U){y&&Qd(0);break}if(De||Qd(2),ot<256)i[T++]=ot;else if(ot==256){Ie=B,E=null;break}else{var ut=ot-254;if(ot>264){var oe=ot-257,mt=l_[oe];ut=Nd(a,B,(1<<mt)-1)+sI[oe],B+=mt}var Ct=R[db(a,B)&Qt],rt=Ct>>4;Ct||Qd(3),B+=Ct&15;var bt=TO[rt];if(rt>3){var mt=c_[rt];bt+=db(a,B)&(1<<mt)-1,B+=mt}if(B>U){y&&Qd(0);break}r&&b(T+131072);var Bt=T+ut;if(T<bt){var tt=d-bt,Ut=Math.min(bt,Bt);for(tt+T<0&&Qd(3);T<Ut;++T)i[T]=s[tt+T]}for(;T<Bt;++T)i[T]=i[T-bt]}}e.l=E,e.p=Ie,e.b=T,e.f=x,E&&(x=1,e.m=P,e.d=R,e.n=G)}while(!x);return T!=i.length&&A?aI(i,0,T):i.subarray(0,T)},mf=function(a,e,i){i<<=e&7;var s=e/8|0;a[s]|=i,a[s+1]|=i>>8},ry=function(a,e,i){i<<=e&7;var s=e/8|0;a[s]|=i,a[s+1]|=i>>8,a[s+2]|=i>>16},Ab=function(a,e){for(var i=[],s=0;s<a.length;++s)a[s]&&i.push({s,f:a[s]});var c=i.length,d=i.slice();if(!c)return{t:cI,l:0};if(c==1){var A=new ou(i[0].s+1);return A[i[0].s]=1,{t:A,l:1}}i.sort(function(re,pe){return re.f-pe.f}),i.push({s:-1,f:25001});var r=i[0],y=i[1],b=0,x=1,B=2;for(i[0]={s:-1,f:r.f+y.f,l:r,r:y};x!=c-1;)r=i[i[b].f<i[B].f?b++:B++],y=i[b!=x&&i[b].f<i[B].f?b++:B++],i[x++]={s:-1,f:r.f+y.f,l:r,r:y};for(var T=d[0].s,s=1;s<c;++s)d[s].s>T&&(T=d[s].s);var E=new Uh(T+1),R=s1(i[x-1],E,0);if(R>e){var s=0,P=0,G=R-e,U=1<<G;for(d.sort(function(pe,fe){return E[fe.s]-E[pe.s]||pe.f-fe.f});s<c;++s){var Q=d[s].s;if(E[Q]>e)P+=U-(1<<R-E[Q]),E[Q]=e;else break}for(P>>=G;P>0;){var q=d[s].s;E[q]<e?P-=1<<e-E[q]++-1:++s}for(;s>=0&&P;--s){var ne=d[s].s;E[ne]==e&&(--E[ne],++P)}R=e}return{t:new ou(E),l:R}},s1=function(a,e,i){return a.s==-1?Math.max(s1(a.l,e,i+1),s1(a.r,e,i+1)):e[a.s]=i},AE=function(a){for(var e=a.length;e&&!a[--e];);for(var i=new Uh(++e),s=0,c=a[0],d=1,A=function(y){i[s++]=y},r=1;r<=e;++r)if(a[r]==c&&r!=e)++d;else{if(!c&&d>2){for(;d>138;d-=138)A(32754);d>2&&(A(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(A(c),--d;d>6;d-=6)A(8304);d>2&&(A(d-3<<5|8208),d=0)}for(;d--;)A(c);d=1,c=a[r]}return{c:i.subarray(0,s),n:e}},ny=function(a,e){for(var i=0,s=0;s<e.length;++s)i+=a[s]*e[s];return i},lI=function(a,e,i){var s=i.length,c=iw(e+2);a[c]=s&255,a[c+1]=s>>8,a[c+2]=a[c]^255,a[c+3]=a[c+1]^255;for(var d=0;d<s;++d)a[c+d+4]=i[d];return(c+4+s)*8},fE=function(a,e,i,s,c,d,A,r,y,b,x){mf(e,x++,i),++c[256];for(var B=Ab(c,15),T=B.t,E=B.l,R=Ab(d,15),P=R.t,G=R.l,U=AE(T),Q=U.c,q=U.n,ne=AE(P),re=ne.c,pe=ne.n,fe=new Uh(19),he=0;he<Q.length;++he)++fe[Q[he]&31];for(var he=0;he<re.length;++he)++fe[re[he]&31];for(var be=Ab(fe,7),Se=be.t,oe=be.l,ye=19;ye>4&&!Se[i1[ye-1]];--ye);var Me=b+5<<3,Be=ny(c,Cp)+ny(d,zy)+A,Pe=ny(c,T)+ny(d,P)+A+14+3*ye+ny(fe,Se)+2*fe[16]+3*fe[17]+7*fe[18];if(y>=0&&Me<=Be&&Me<=Pe)return lI(e,x,a.subarray(y,y+b));var De,et,Ye,bt;if(mf(e,x,1+(Pe<Be)),x+=2,Pe<Be){De=HA(T,E,0),et=T,Ye=HA(P,G,0),bt=P;var pt=HA(Se,oe,0);mf(e,x,q-257),mf(e,x+5,pe-1),mf(e,x+10,ye-4),x+=14;for(var he=0;he<ye;++he)mf(e,x+3*he,Se[i1[he]]);x+=3*ye;for(var Qt=[Q,re],Ie=0;Ie<2;++Ie)for(var ot=Qt[Ie],he=0;he<ot.length;++he){var ut=ot[he]&31;mf(e,x,pt[ut]),x+=Se[ut],ut>15&&(mf(e,x,ot[he]>>5&127),x+=ot[he]>>12)}}else De=IO,et=Cp,Ye=LO,bt=zy;for(var he=0;he<r;++he){var mt=s[he];if(mt>255){var ut=mt>>18&31;ry(e,x,De[ut+257]),x+=et[ut+257],ut>7&&(mf(e,x,mt>>23&31),x+=l_[ut]);var Ct=mt&31;ry(e,x,Ye[Ct]),x+=bt[Ct],Ct>3&&(ry(e,x,mt>>5&8191),x+=c_[Ct])}else ry(e,x,De[mt]),x+=et[mt]}return ry(e,x,De[256]),x+et[256]},RO=new tw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cI=new ou(0),DO=function(a,e,i,s,c,d){var A=d.z||a.length,r=new ou(s+A+5*(1+Math.ceil(A/7e3))+c),y=r.subarray(s,r.length-c),b=d.l,x=(d.r||0)&7;if(e){x&&(y[0]=d.r>>3);for(var B=RO[e-1],T=B>>13,E=B&8191,R=(1<<i)-1,P=d.p||new Uh(32768),G=d.h||new Uh(R+1),U=Math.ceil(i/3),Q=2*U,q=function(Pt){return(a[Pt]^a[Pt+1]<<U^a[Pt+2]<<Q)&R},ne=new tw(25e3),re=new Uh(288),pe=new Uh(32),fe=0,he=0,be=d.i||0,Se=0,oe=d.w||0,ye=0;be+2<A;++be){var Me=q(be),Be=be&32767,Pe=G[Me];if(P[Be]=Pe,G[Me]=Be,oe<=be){var De=A-be;if((fe>7e3||Se>24576)&&(De>423||!b)){x=fE(a,y,0,ne,re,pe,he,Se,ye,be-ye,x),Se=fe=he=0,ye=be;for(var et=0;et<286;++et)re[et]=0;for(var et=0;et<30;++et)pe[et]=0}var Ye=2,bt=0,pt=E,Qt=Be-Pe&32767;if(De>2&&Me==q(be-Qt))for(var Ie=Math.min(T,De)-1,ot=Math.min(32767,be),ut=Math.min(258,De);Qt<=ot&&--pt&&Be!=Pe;){if(a[be+Ye]==a[be+Ye-Qt]){for(var mt=0;mt<ut&&a[be+mt]==a[be+mt-Qt];++mt);if(mt>Ye){if(Ye=mt,bt=Qt,mt>Ie)break;for(var Ct=Math.min(Qt,mt-2),rt=0,et=0;et<Ct;++et){var Bt=be-Qt+et&32767,tt=P[Bt],Ut=Bt-tt&32767;Ut>rt&&(rt=Ut,Pe=Bt)}}}Be=Pe,Pe=P[Be],Qt+=Be-Pe&32767}if(bt){ne[Se++]=268435456|r1[Ye]<<18|dE[bt];var Ai=r1[Ye]&31,qe=dE[bt]&31;he+=l_[Ai]+c_[qe],++re[257+Ai],++pe[qe],oe=be+Ye,++fe}else ne[Se++]=a[be],++re[a[be]]}}for(be=Math.max(be,oe);be<A;++be)ne[Se++]=a[be],++re[a[be]];x=fE(a,y,b,ne,re,pe,he,Se,ye,be-ye,x),b||(d.r=x&7|y[x/8|0]<<3,x-=7,d.h=G,d.p=P,d.i=be,d.w=oe)}else{for(var be=d.w||0;be<A+b;be+=65535){var Ke=be+65535;Ke>=A&&(y[x/8|0]=b,Ke=A),x=lI(y,x+1,a.subarray(be,Ke))}d.i=A}return aI(r,0,s+iw(x)+c)},uI=function(){var a=1,e=0;return{p:function(i){for(var s=a,c=e,d=i.length|0,A=0;A!=d;){for(var r=Math.min(A+2655,d);A<r;++A)c+=s+=i[A];s=(s&65535)+15*(s>>16),c=(c&65535)+15*(c>>16)}a=s,e=c},d:function(){return a%=65521,e%=65521,(a&255)<<24|(a&65280)<<8|(e&255)<<8|e>>8}}},OO=function(a,e,i,s,c){if(!c&&(c={l:1},e.dictionary)){var d=e.dictionary.subarray(-32768),A=new ou(d.length+a.length);A.set(d),A.set(a,d.length),a=A,c.w=d.length}return DO(a,e.level==null?6:e.level,e.mem==null?c.l?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):20:12+e.mem,i,s,c)},hI=function(a,e,i){for(;i;++e)a[e]=i,i>>>=8},UO=function(a,e){var i=e.level,s=i==0?0:i<6?1:i==9?3:2;if(a[0]=120,a[1]=s<<6|(e.dictionary&&32),a[1]|=31-(a[0]<<8|a[1])%31,e.dictionary){var c=uI();c.p(e.dictionary),hI(a,2,c.d())}},zO=function(a,e){return((a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31)&&Qd(6,"invalid zlib data"),(a[1]>>5&1)==1&&Qd(6,"invalid zlib data: "+(a[1]&32?"need":"unexpected")+" dictionary"),(a[1]>>3&4)+2};function o1(a,e){e||(e={});var i=uI();i.p(a);var s=OO(a,e,e.dictionary?6:2,4);return UO(s,e),hI(s,s.length-4,i.d()),s}function NO(a,e){return kO(a.subarray(zO(a),-4),{i:2},e,e)}var jO=typeof TextDecoder<"u"&&new TextDecoder,HO=0;try{jO.decode(cI,{stream:!0}),HO=1}catch{}var qn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function fb(){qn.console&&typeof qn.console.log=="function"&&qn.console.log.apply(qn.console,arguments)}var ha={log:fb,warn:function(a){qn.console&&(typeof qn.console.warn=="function"?qn.console.warn.apply(qn.console,arguments):fb.call(null,arguments))},error:function(a){qn.console&&(typeof qn.console.error=="function"?qn.console.error.apply(qn.console,arguments):fb(a))}};function pb(a,e,i){var s=new XMLHttpRequest;s.open("GET",a),s.responseType="blob",s.onload=function(){Zp(s.response,e,i)},s.onerror=function(){ha.error("could not download file")},s.send()}function pE(a){var e=new XMLHttpRequest;e.open("HEAD",a,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function iv(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(e)}}var _y,a1,Zp=qn.saveAs||((typeof window>"u"?"undefined":Go(window))!=="object"||window!==qn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(a,e,i){var s=qn.URL||qn.webkitURL,c=document.createElement("a");e=e||a.name||"download",c.download=e,c.rel="noopener",typeof a=="string"?(c.href=a,c.origin!==location.origin?pE(c.href)?pb(a,e,i):iv(c,c.target="_blank"):iv(c)):(c.href=s.createObjectURL(a),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){iv(c)},0))}:"msSaveOrOpenBlob"in navigator?function(a,e,i){if(e=e||a.name||"download",typeof a=="string")if(pE(a))pb(a,e,i);else{var s=document.createElement("a");s.href=a,s.target="_blank",setTimeout(function(){iv(s)})}else navigator.msSaveOrOpenBlob(function(c,d){return d===void 0?d={autoBom:!1}:Go(d)!=="object"&&(ha.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}(a,i),e)}:function(a,e,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof a=="string")return pb(a,e,i);var c=a.type==="application/octet-stream",d=/constructor/i.test(qn.HTMLElement)||qn.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||c&&d)&&(typeof FileReader>"u"?"undefined":Go(FileReader))==="object"){var r=new FileReader;r.onloadend=function(){var x=r.result;x=A?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=x:location=x,s=null},r.readAsDataURL(a)}else{var y=qn.URL||qn.webkitURL,b=y.createObjectURL(a);s?s.location=b:location.href=b,s=null,setTimeout(function(){y.revokeObjectURL(b)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function dI(a){var e;a=a||"",this.ok=!1,a.charAt(0)=="#"&&(a=a.substr(1,6)),a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[a=(a=a.replace(/ /g,"")).toLowerCase()]||a;for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(r){return[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(r){return[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(r){return[parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16)]}}],s=0;s<i.length;s++){var c=i[s].re,d=i[s].process,A=c.exec(a);A&&(e=d(A),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var r=this.r.toString(16),y=this.g.toString(16),b=this.b.toString(16);return r.length==1&&(r="0"+r),y.length==1&&(y="0"+y),b.length==1&&(b="0"+b),"#"+r+y+b}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function gb(a,e){var i=a[0],s=a[1],c=a[2],d=a[3];i=tu(i,s,c,d,e[0],7,-680876936),d=tu(d,i,s,c,e[1],12,-389564586),c=tu(c,d,i,s,e[2],17,606105819),s=tu(s,c,d,i,e[3],22,-1044525330),i=tu(i,s,c,d,e[4],7,-176418897),d=tu(d,i,s,c,e[5],12,1200080426),c=tu(c,d,i,s,e[6],17,-1473231341),s=tu(s,c,d,i,e[7],22,-45705983),i=tu(i,s,c,d,e[8],7,1770035416),d=tu(d,i,s,c,e[9],12,-1958414417),c=tu(c,d,i,s,e[10],17,-42063),s=tu(s,c,d,i,e[11],22,-1990404162),i=tu(i,s,c,d,e[12],7,1804603682),d=tu(d,i,s,c,e[13],12,-40341101),c=tu(c,d,i,s,e[14],17,-1502002290),i=iu(i,s=tu(s,c,d,i,e[15],22,1236535329),c,d,e[1],5,-165796510),d=iu(d,i,s,c,e[6],9,-1069501632),c=iu(c,d,i,s,e[11],14,643717713),s=iu(s,c,d,i,e[0],20,-373897302),i=iu(i,s,c,d,e[5],5,-701558691),d=iu(d,i,s,c,e[10],9,38016083),c=iu(c,d,i,s,e[15],14,-660478335),s=iu(s,c,d,i,e[4],20,-405537848),i=iu(i,s,c,d,e[9],5,568446438),d=iu(d,i,s,c,e[14],9,-1019803690),c=iu(c,d,i,s,e[3],14,-187363961),s=iu(s,c,d,i,e[8],20,1163531501),i=iu(i,s,c,d,e[13],5,-1444681467),d=iu(d,i,s,c,e[2],9,-51403784),c=iu(c,d,i,s,e[7],14,1735328473),i=ru(i,s=iu(s,c,d,i,e[12],20,-1926607734),c,d,e[5],4,-378558),d=ru(d,i,s,c,e[8],11,-2022574463),c=ru(c,d,i,s,e[11],16,1839030562),s=ru(s,c,d,i,e[14],23,-35309556),i=ru(i,s,c,d,e[1],4,-1530992060),d=ru(d,i,s,c,e[4],11,1272893353),c=ru(c,d,i,s,e[7],16,-155497632),s=ru(s,c,d,i,e[10],23,-1094730640),i=ru(i,s,c,d,e[13],4,681279174),d=ru(d,i,s,c,e[0],11,-358537222),c=ru(c,d,i,s,e[3],16,-722521979),s=ru(s,c,d,i,e[6],23,76029189),i=ru(i,s,c,d,e[9],4,-640364487),d=ru(d,i,s,c,e[12],11,-421815835),c=ru(c,d,i,s,e[15],16,530742520),i=nu(i,s=ru(s,c,d,i,e[2],23,-995338651),c,d,e[0],6,-198630844),d=nu(d,i,s,c,e[7],10,1126891415),c=nu(c,d,i,s,e[14],15,-1416354905),s=nu(s,c,d,i,e[5],21,-57434055),i=nu(i,s,c,d,e[12],6,1700485571),d=nu(d,i,s,c,e[3],10,-1894986606),c=nu(c,d,i,s,e[10],15,-1051523),s=nu(s,c,d,i,e[1],21,-2054922799),i=nu(i,s,c,d,e[8],6,1873313359),d=nu(d,i,s,c,e[15],10,-30611744),c=nu(c,d,i,s,e[6],15,-1560198380),s=nu(s,c,d,i,e[13],21,1309151649),i=nu(i,s,c,d,e[4],6,-145523070),d=nu(d,i,s,c,e[11],10,-1120210379),c=nu(c,d,i,s,e[2],15,718787259),s=nu(s,c,d,i,e[9],21,-343485551),a[0]=fp(i,a[0]),a[1]=fp(s,a[1]),a[2]=fp(c,a[2]),a[3]=fp(d,a[3])}function u_(a,e,i,s,c,d){return e=fp(fp(e,a),fp(s,d)),fp(e<<c|e>>>32-c,i)}function tu(a,e,i,s,c,d,A){return u_(e&i|~e&s,a,e,c,d,A)}function iu(a,e,i,s,c,d,A){return u_(e&s|i&~s,a,e,c,d,A)}function ru(a,e,i,s,c,d,A){return u_(e^i^s,a,e,c,d,A)}function nu(a,e,i,s,c,d,A){return u_(i^(e|~s),a,e,c,d,A)}function AI(a){var e,i=a.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=a.length;e+=64)gb(s,QO(a.substring(e-64,e)));a=a.substring(e-64);var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<a.length;e++)c[e>>2]|=a.charCodeAt(e)<<(e%4<<3);if(c[e>>2]|=128<<(e%4<<3),e>55)for(gb(s,c),e=0;e<16;e++)c[e]=0;return c[14]=8*i,gb(s,c),s}function QO(a){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=a.charCodeAt(e)+(a.charCodeAt(e+1)<<8)+(a.charCodeAt(e+2)<<16)+(a.charCodeAt(e+3)<<24);return i}_y=qn.atob.bind(qn),a1=qn.btoa.bind(qn);var gE="0123456789abcdef".split("");function VO(a){for(var e="",i=0;i<4;i++)e+=gE[a>>8*i+4&15]+gE[a>>8*i&15];return e}function GO(a){return String.fromCharCode((255&a)>>0,(65280&a)>>8,(16711680&a)>>16,(4278190080&a)>>24)}function l1(a){return AI(a).map(GO).join("")}var WO=function(a){for(var e=0;e<a.length;e++)a[e]=VO(a[e]);return a.join("")}(AI("hello"))!="5d41402abc4b2a76b9719d911017c592";function fp(a,e){if(WO){var i=(65535&a)+(65535&e);return(a>>16)+(e>>16)+(i>>16)<<16|65535&i}return a+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function c1(a,e){var i,s,c,d;if(a!==i){for(var A=(c=a,d=1+(256/a.length>>0),new Array(d+1).join(c)),r=[],y=0;y<256;y++)r[y]=y;var b=0;for(y=0;y<256;y++){var x=r[y];b=(b+x+A.charCodeAt(y))%256,r[y]=r[b],r[b]=x}i=a,s=r}else r=s;var B=e.length,T=0,E=0,R="";for(y=0;y<B;y++)E=(E+(x=r[T=(T+1)%256]))%256,r[T]=r[E],r[E]=x,A=r[(r[T]+r[E])%256],R+=String.fromCharCode(e.charCodeAt(y)^A);return R}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var mE={print:4,modify:8,copy:16,"annot-forms":32};function Wg(a,e,i,s){this.v=1,this.r=2;var c=192;a.forEach(function(r){if(mE.perm!==void 0)throw new Error("Invalid permission: "+r);c+=mE[r]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var d=(e+this.padding).substr(0,32),A=(i+this.padding).substr(0,32);this.O=this.processOwnerPassword(d,A),this.P=-(1+(255^c)),this.encryptionKey=l1(d+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=c1(this.encryptionKey,this.padding)}function Xg(a){if(/[^\u0000-\u00ff]/.test(a))throw new Error("Invalid PDF Name Object: "+a+", Only accept ASCII characters.");for(var e="",i=a.length,s=0;s<i;s++){var c=a.charCodeAt(s);c<33||c===35||c===37||c===40||c===41||c===47||c===60||c===62||c===91||c===93||c===123||c===125||c>126?e+="#"+("0"+c.toString(16)).slice(-2):e+=a[s]}return e}function yE(a){if(Go(a)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(i,s,c){if(c=c||!1,typeof i!="string"||typeof s!="function"||typeof c!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(i)||(e[i]={});var d=Math.random().toString(35);return e[i][d]=[s,!!c],d},this.unsubscribe=function(i){for(var s in e)if(e[s][i])return delete e[s][i],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(i){if(e.hasOwnProperty(i)){var s=Array.prototype.slice.call(arguments,1),c=[];for(var d in e[i]){var A=e[i][d];try{A[0].apply(a,s)}catch(r){qn.console&&ha.error("jsPDF PubSub Error",r.message,r)}A[1]&&c.push(d)}c.length&&c.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ny(a){if(!(this instanceof Ny))return new Ny(a);var e="opacity,stroke-opacity".split(",");for(var i in a)a.hasOwnProperty(i)&&e.indexOf(i)>=0&&(this[i]=a[i]);this.id="",this.objectNumber=-1}function fI(a,e){this.gState=a,this.matrix=e,this.id="",this.objectNumber=-1}function Ap(a,e,i,s,c){if(!(this instanceof Ap))return new Ap(a,e,i,s,c);this.type=a==="axial"?2:3,this.coords=e,this.colors=i,fI.call(this,s,c)}function og(a,e,i,s,c){if(!(this instanceof og))return new og(a,e,i,s,c);this.boundingBox=a,this.xStep=e,this.yStep=i,this.stream="",this.cloneIndex=0,fI.call(this,s,c)}function Qn(a){var e,i=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],c=arguments[2],d=arguments[3],A=[],r=1,y=16,b="S",x=null;Go(a=a||{})==="object"&&(i=a.orientation,s=a.unit||s,c=a.format||c,d=a.compress||a.compressPdf||d,(x=a.encryption||null)!==null&&(x.userPassword=x.userPassword||"",x.ownerPassword=x.ownerPassword||"",x.userPermissions=x.userPermissions||[]),r=typeof a.userUnit=="number"?Math.abs(a.userUnit):1,a.precision!==void 0&&(e=a.precision),a.floatPrecision!==void 0&&(y=a.floatPrecision),b=a.defaultPathOperation||"S"),A=a.filters||(d===!0?["FlateEncode"]:A),s=s||"mm",i=(""+(i||"P")).toLowerCase();var B=a.putOnlyUsedFonts||!1,T={},E={internal:{},__private__:{}};E.__private__.PubSub=yE;var R="1.3",P=E.__private__.getPdfVersion=function(){return R};E.__private__.setPdfVersion=function(ie){R=ie};var G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};E.__private__.getPageFormats=function(){return G};var U=E.__private__.getPageFormat=function(ie){return G[ie]};c=c||"a4";var Q={COMPAT:"compat",ADVANCED:"advanced"},q=Q.COMPAT;function ne(){this.saveGraphicsState(),Ze(new St(li,0,0,-li,0,na()*li).toString()+" cm"),this.setFontSize(this.getFontSize()/li),b="n",q=Q.ADVANCED}function re(){this.restoreGraphicsState(),b="S",q=Q.COMPAT}var pe=E.__private__.combineFontStyleAndFontWeight=function(ie,Ue){if(ie=="bold"&&Ue=="normal"||ie=="bold"&&Ue==400||ie=="normal"&&Ue=="italic"||ie=="bold"&&Ue=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ue&&(ie=Ue==400||Ue==="normal"?ie==="italic"?"italic":"normal":Ue!=700&&Ue!=="bold"||ie!=="normal"?(Ue==700?"bold":Ue)+""+ie:"bold"),ie};E.advancedAPI=function(ie){var Ue=q===Q.COMPAT;return Ue&&ne.call(this),typeof ie!="function"||(ie(this),Ue&&re.call(this)),this},E.compatAPI=function(ie){var Ue=q===Q.ADVANCED;return Ue&&re.call(this),typeof ie!="function"||(ie(this),Ue&&ne.call(this)),this},E.isAdvancedAPI=function(){return q===Q.ADVANCED};var fe,he=function(ie){if(q!==Q.ADVANCED)throw new Error(ie+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},be=E.roundToPrecision=E.__private__.roundToPrecision=function(ie,Ue){var Et=e||Ue;if(isNaN(ie)||isNaN(Et))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ie.toFixed(Et).replace(/0+$/,"")};fe=E.hpf=E.__private__.hpf=typeof y=="number"?function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,y)}:y==="smart"?function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,ie>-1&&ie<1?16:5)}:function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,16)};var Se=E.f2=E.__private__.f2=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.f2");return be(ie,2)},oe=E.__private__.f3=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.f3");return be(ie,3)},ye=E.scale=E.__private__.scale=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.scale");return q===Q.COMPAT?ie*li:q===Q.ADVANCED?ie:void 0},Me=function(ie){return q===Q.COMPAT?na()-ie:q===Q.ADVANCED?ie:void 0},Be=function(ie){return ye(Me(ie))};E.__private__.setPrecision=E.setPrecision=function(ie){typeof parseInt(ie,10)=="number"&&(e=parseInt(ie,10))};var Pe,De="00000000000000000000000000000000",et=E.__private__.getFileId=function(){return De},Ye=E.__private__.setFileId=function(ie){return De=ie!==void 0&&/^[a-fA-F0-9]{32}$/.test(ie)?ie.toUpperCase():De.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),x!==null&&(Wo=new Wg(x.userPermissions,x.userPassword,x.ownerPassword,De)),De};E.setFileId=function(ie){return Ye(ie),this},E.getFileId=function(){return et()};var bt=E.__private__.convertDateToPDFDate=function(ie){var Ue=ie.getTimezoneOffset(),Et=Ue<0?"+":"-",jt=Math.floor(Math.abs(Ue/60)),hi=Math.abs(Ue%60),Ti=[Et,ut(jt),"'",ut(hi),"'"].join("");return["D:",ie.getFullYear(),ut(ie.getMonth()+1),ut(ie.getDate()),ut(ie.getHours()),ut(ie.getMinutes()),ut(ie.getSeconds()),Ti].join("")},pt=E.__private__.convertPDFDateToDate=function(ie){var Ue=parseInt(ie.substr(2,4),10),Et=parseInt(ie.substr(6,2),10)-1,jt=parseInt(ie.substr(8,2),10),hi=parseInt(ie.substr(10,2),10),Ti=parseInt(ie.substr(12,2),10),mr=parseInt(ie.substr(14,2),10);return new Date(Ue,Et,jt,hi,Ti,mr,0)},Qt=E.__private__.setCreationDate=function(ie){var Ue;if(ie===void 0&&(ie=new Date),ie instanceof Date)Ue=bt(ie);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ie))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ue=ie}return Pe=Ue},Ie=E.__private__.getCreationDate=function(ie){var Ue=Pe;return ie==="jsDate"&&(Ue=pt(Pe)),Ue};E.setCreationDate=function(ie){return Qt(ie),this},E.getCreationDate=function(ie){return Ie(ie)};var ot,ut=E.__private__.padd2=function(ie){return("0"+parseInt(ie)).slice(-2)},mt=E.__private__.padd2Hex=function(ie){return("00"+(ie=ie.toString())).substr(ie.length)},Ct=0,rt=[],Bt=[],tt=0,Ut=[],Ai=[],qe=!1,Ke=Bt,Pt=function(){Ct=0,tt=0,Bt=[],rt=[],Ut=[],_t=Ge(),Ot=Ge()};E.__private__.setCustomOutputDestination=function(ie){qe=!0,Ke=ie};var It=function(ie){qe||(Ke=ie)};E.__private__.resetCustomOutputDestination=function(){qe=!1,Ke=Bt};var Ze=E.__private__.out=function(ie){return ie=ie.toString(),tt+=ie.length+1,Ke.push(ie),Ke},yi=E.__private__.write=function(ie){return Ze(arguments.length===1?ie.toString():Array.prototype.join.call(arguments," "))},bi=E.__private__.getArrayBuffer=function(ie){for(var Ue=ie.length,Et=new ArrayBuffer(Ue),jt=new Uint8Array(Et);Ue--;)jt[Ue]=ie.charCodeAt(Ue);return Et},Kt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];E.__private__.getStandardFonts=function(){return Kt};var di=a.fontSize||16;E.__private__.setFontSize=E.setFontSize=function(ie){return di=q===Q.ADVANCED?ie/li:ie,this};var pi,Ri=E.__private__.getFontSize=E.getFontSize=function(){return q===Q.COMPAT?di:di*li},Oi=a.R2L||!1;E.__private__.setR2L=E.setR2L=function(ie){return Oi=ie,this},E.__private__.getR2L=E.getR2L=function(){return Oi};var Ji,ar=E.__private__.setZoomMode=function(ie){var Ue=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ie))pi=ie;else if(isNaN(ie)){if(Ue.indexOf(ie)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ie+'" is not recognized.');pi=ie}else pi=parseInt(ie,10)};E.__private__.getZoomMode=function(){return pi};var br,Dr=E.__private__.setPageMode=function(ie){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ie)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ie+'" is not recognized.');Ji=ie};E.__private__.getPageMode=function(){return Ji};var Fr=E.__private__.setLayoutMode=function(ie){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ie)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ie+'" is not recognized.');br=ie};E.__private__.getLayoutMode=function(){return br},E.__private__.setDisplayMode=E.setDisplayMode=function(ie,Ue,Et){return ar(ie),Fr(Ue),Dr(Et),this};var Qr={title:"",subject:"",author:"",keywords:"",creator:""};E.__private__.getDocumentProperty=function(ie){if(Object.keys(Qr).indexOf(ie)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Qr[ie]},E.__private__.getDocumentProperties=function(){return Qr},E.__private__.setDocumentProperties=E.setProperties=E.setDocumentProperties=function(ie){for(var Ue in Qr)Qr.hasOwnProperty(Ue)&&ie[Ue]&&(Qr[Ue]=ie[Ue]);return this},E.__private__.setDocumentProperty=function(ie,Ue){if(Object.keys(Qr).indexOf(ie)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Qr[ie]=Ue};var ui,li,Vi,rr,qr,_r={},Zr={},io=[],Ur={},ta={},As={},ro={},zn=null,Lr=0,yr=[],qt=new yE(E),Nn=a.hotfixes||[],vs={},ia={},dn=[],St=function ie(Ue,Et,jt,hi,Ti,mr){if(!(this instanceof ie))return new ie(Ue,Et,jt,hi,Ti,mr);isNaN(Ue)&&(Ue=1),isNaN(Et)&&(Et=0),isNaN(jt)&&(jt=0),isNaN(hi)&&(hi=1),isNaN(Ti)&&(Ti=0),isNaN(mr)&&(mr=0),this._matrix=[Ue,Et,jt,hi,Ti,mr]};Object.defineProperty(St.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ie){this._matrix[0]=ie}}),Object.defineProperty(St.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ie){this._matrix[1]=ie}}),Object.defineProperty(St.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ie){this._matrix[2]=ie}}),Object.defineProperty(St.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ie){this._matrix[3]=ie}}),Object.defineProperty(St.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ie){this._matrix[4]=ie}}),Object.defineProperty(St.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ie){this._matrix[5]=ie}}),Object.defineProperty(St.prototype,"a",{get:function(){return this._matrix[0]},set:function(ie){this._matrix[0]=ie}}),Object.defineProperty(St.prototype,"b",{get:function(){return this._matrix[1]},set:function(ie){this._matrix[1]=ie}}),Object.defineProperty(St.prototype,"c",{get:function(){return this._matrix[2]},set:function(ie){this._matrix[2]=ie}}),Object.defineProperty(St.prototype,"d",{get:function(){return this._matrix[3]},set:function(ie){this._matrix[3]=ie}}),Object.defineProperty(St.prototype,"e",{get:function(){return this._matrix[4]},set:function(ie){this._matrix[4]=ie}}),Object.defineProperty(St.prototype,"f",{get:function(){return this._matrix[5]},set:function(ie){this._matrix[5]=ie}}),Object.defineProperty(St.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(St.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(St.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(St.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),St.prototype.join=function(ie){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(fe).join(ie)},St.prototype.multiply=function(ie){var Ue=ie.sx*this.sx+ie.shy*this.shx,Et=ie.sx*this.shy+ie.shy*this.sy,jt=ie.shx*this.sx+ie.sy*this.shx,hi=ie.shx*this.shy+ie.sy*this.sy,Ti=ie.tx*this.sx+ie.ty*this.shx+this.tx,mr=ie.tx*this.shy+ie.ty*this.sy+this.ty;return new St(Ue,Et,jt,hi,Ti,mr)},St.prototype.decompose=function(){var ie=this.sx,Ue=this.shy,Et=this.shx,jt=this.sy,hi=this.tx,Ti=this.ty,mr=Math.sqrt(ie*ie+Ue*Ue),Vr=(ie/=mr)*Et+(Ue/=mr)*jt;Et-=ie*Vr,jt-=Ue*Vr;var cn=Math.sqrt(Et*Et+jt*jt);return Vr/=cn,ie*(jt/=cn)<Ue*(Et/=cn)&&(ie=-ie,Ue=-Ue,Vr=-Vr,mr=-mr),{scale:new St(mr,0,0,cn,0,0),translate:new St(1,0,0,1,hi,Ti),rotate:new St(ie,Ue,-Ue,ie,0,0),skew:new St(1,0,Vr,1,0,0)}},St.prototype.toString=function(ie){return this.join(" ")},St.prototype.inversed=function(){var ie=this.sx,Ue=this.shy,Et=this.shx,jt=this.sy,hi=this.tx,Ti=this.ty,mr=1/(ie*jt-Ue*Et),Vr=jt*mr,cn=-Ue*mr,Pn=-Et*mr,kn=ie*mr;return new St(Vr,cn,Pn,kn,-Vr*hi-Pn*Ti,-cn*hi-kn*Ti)},St.prototype.applyToPoint=function(ie){var Ue=ie.x*this.sx+ie.y*this.shx+this.tx,Et=ie.x*this.shy+ie.y*this.sy+this.ty;return new Vc(Ue,Et)},St.prototype.applyToRectangle=function(ie){var Ue=this.applyToPoint(ie),Et=this.applyToPoint(new Vc(ie.x+ie.w,ie.y+ie.h));return new _c(Ue.x,Ue.y,Et.x-Ue.x,Et.y-Ue.y)},St.prototype.clone=function(){var ie=this.sx,Ue=this.shy,Et=this.shx,jt=this.sy,hi=this.tx,Ti=this.ty;return new St(ie,Ue,Et,jt,hi,Ti)},E.Matrix=St;var me=E.matrixMult=function(ie,Ue){return Ue.multiply(ie)},Ce=new St(1,0,0,1,0,0);E.unitMatrix=E.identityMatrix=Ce;var je=function(ie,Ue){if(!ta[ie]){var Et=(Ue instanceof Ap?"Sh":"P")+(Object.keys(Ur).length+1).toString(10);Ue.id=Et,ta[ie]=Et,Ur[Et]=Ue,qt.publish("addPattern",Ue)}};E.ShadingPattern=Ap,E.TilingPattern=og,E.addShadingPattern=function(ie,Ue){return he("addShadingPattern()"),je(ie,Ue),this},E.beginTilingPattern=function(ie){he("beginTilingPattern()"),Qh(ie.boundingBox[0],ie.boundingBox[1],ie.boundingBox[2]-ie.boundingBox[0],ie.boundingBox[3]-ie.boundingBox[1],ie.matrix)},E.endTilingPattern=function(ie,Ue){he("endTilingPattern()"),Ue.stream=Ai[ot].join(`
`),je(ie,Ue),qt.publish("endTilingPattern",Ue),dn.pop().restore()};var Je=E.__private__.newObject=function(){var ie=Ge();return vt(ie,!0),ie},Ge=E.__private__.newObjectDeferred=function(){return Ct++,rt[Ct]=function(){return tt},Ct},vt=function(ie,Ue){return Ue=typeof Ue=="boolean"&&Ue,rt[ie]=tt,Ue&&Ze(ie+" 0 obj"),ie},Rt=E.__private__.newAdditionalObject=function(){var ie={objId:Ge(),content:""};return Ut.push(ie),ie},_t=Ge(),Ot=Ge(),ii=E.__private__.decodeColorString=function(ie){var Ue=ie.split(" ");if(Ue.length!==2||Ue[1]!=="g"&&Ue[1]!=="G")Ue.length===5&&(Ue[4]==="k"||Ue[4]==="K")&&(Ue=[(1-Ue[0])*(1-Ue[3]),(1-Ue[1])*(1-Ue[3]),(1-Ue[2])*(1-Ue[3]),"r"]);else{var Et=parseFloat(Ue[0]);Ue=[Et,Et,Et,"r"]}for(var jt="#",hi=0;hi<3;hi++)jt+=("0"+Math.floor(255*parseFloat(Ue[hi])).toString(16)).slice(-2);return jt},Nt=E.__private__.encodeColorString=function(ie){var Ue;typeof ie=="string"&&(ie={ch1:ie});var Et=ie.ch1,jt=ie.ch2,hi=ie.ch3,Ti=ie.ch4,mr=ie.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Et=="string"&&Et.charAt(0)!=="#"){var Vr=new dI(Et);if(Vr.ok)Et=Vr.toHex();else if(!/^\d*\.?\d*$/.test(Et))throw new Error('Invalid color "'+Et+'" passed to jsPDF.encodeColorString.')}if(typeof Et=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Et)&&(Et="#"+Et[1]+Et[1]+Et[2]+Et[2]+Et[3]+Et[3]),typeof Et=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Et)){var cn=parseInt(Et.substr(1),16);Et=cn>>16&255,jt=cn>>8&255,hi=255&cn}if(jt===void 0||Ti===void 0&&Et===jt&&jt===hi)if(typeof Et=="string")Ue=Et+" "+mr[0];else switch(ie.precision){case 2:Ue=Se(Et/255)+" "+mr[0];break;case 3:default:Ue=oe(Et/255)+" "+mr[0]}else if(Ti===void 0||Go(Ti)==="object"){if(Ti&&!isNaN(Ti.a)&&Ti.a===0)return Ue=["1.","1.","1.",mr[1]].join(" ");if(typeof Et=="string")Ue=[Et,jt,hi,mr[1]].join(" ");else switch(ie.precision){case 2:Ue=[Se(Et/255),Se(jt/255),Se(hi/255),mr[1]].join(" ");break;default:case 3:Ue=[oe(Et/255),oe(jt/255),oe(hi/255),mr[1]].join(" ")}}else if(typeof Et=="string")Ue=[Et,jt,hi,Ti,mr[2]].join(" ");else switch(ie.precision){case 2:Ue=[Se(Et),Se(jt),Se(hi),Se(Ti),mr[2]].join(" ");break;case 3:default:Ue=[oe(Et),oe(jt),oe(hi),oe(Ti),mr[2]].join(" ")}return Ue},Fi=E.__private__.getFilters=function(){return A},er=E.__private__.putStream=function(ie){var Ue=(ie=ie||{}).data||"",Et=ie.filters||Fi(),jt=ie.alreadyAppliedFilters||[],hi=ie.addLength1||!1,Ti=Ue.length,mr=ie.objectId,Vr=function(Js){return Js};if(x!==null&&mr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");x!==null&&(Vr=Wo.encryptor(mr,0));var cn={};Et===!0&&(Et=["FlateEncode"]);var Pn=ie.additionalKeyValues||[],kn=(cn=Qn.API.processDataByFilters!==void 0?Qn.API.processDataByFilters(Ue,Et):{data:Ue,reverseChain:[]}).reverseChain+(Array.isArray(jt)?jt.join(" "):jt.toString());if(cn.data.length!==0&&(Pn.push({key:"Length",value:cn.data.length}),hi===!0&&Pn.push({key:"Length1",value:Ti})),kn.length!=0)if(kn.split("/").length-1==1)Pn.push({key:"Filter",value:kn});else{Pn.push({key:"Filter",value:"["+kn+"]"});for(var hs=0;hs<Pn.length;hs+=1)if(Pn[hs].key==="DecodeParms"){for(var Zs=[],Zn=0;Zn<cn.reverseChain.split("/").length-1;Zn+=1)Zs.push("null");Zs.push(Pn[hs].value),Pn[hs].value="["+Zs.join(" ")+"]"}}Ze("<<");for(var xn=0;xn<Pn.length;xn++)Ze("/"+Pn[xn].key+" "+Pn[xn].value);Ze(">>"),cn.data.length!==0&&(Ze("stream"),Ze(Vr(cn.data)),Ze("endstream"))},nr=E.__private__.putPage=function(ie){var Ue=ie.number,Et=ie.data,jt=ie.objId,hi=ie.contentsObjId;vt(jt,!0),Ze("<</Type /Page"),Ze("/Parent "+ie.rootDictionaryObjId+" 0 R"),Ze("/Resources "+ie.resourceDictionaryObjId+" 0 R"),Ze("/MediaBox ["+parseFloat(fe(ie.mediaBox.bottomLeftX))+" "+parseFloat(fe(ie.mediaBox.bottomLeftY))+" "+fe(ie.mediaBox.topRightX)+" "+fe(ie.mediaBox.topRightY)+"]"),ie.cropBox!==null&&Ze("/CropBox ["+fe(ie.cropBox.bottomLeftX)+" "+fe(ie.cropBox.bottomLeftY)+" "+fe(ie.cropBox.topRightX)+" "+fe(ie.cropBox.topRightY)+"]"),ie.bleedBox!==null&&Ze("/BleedBox ["+fe(ie.bleedBox.bottomLeftX)+" "+fe(ie.bleedBox.bottomLeftY)+" "+fe(ie.bleedBox.topRightX)+" "+fe(ie.bleedBox.topRightY)+"]"),ie.trimBox!==null&&Ze("/TrimBox ["+fe(ie.trimBox.bottomLeftX)+" "+fe(ie.trimBox.bottomLeftY)+" "+fe(ie.trimBox.topRightX)+" "+fe(ie.trimBox.topRightY)+"]"),ie.artBox!==null&&Ze("/ArtBox ["+fe(ie.artBox.bottomLeftX)+" "+fe(ie.artBox.bottomLeftY)+" "+fe(ie.artBox.topRightX)+" "+fe(ie.artBox.topRightY)+"]"),typeof ie.userUnit=="number"&&ie.userUnit!==1&&Ze("/UserUnit "+ie.userUnit),qt.publish("putPage",{objId:jt,pageContext:yr[Ue],pageNumber:Ue,page:Et}),Ze("/Contents "+hi+" 0 R"),Ze(">>"),Ze("endobj");var Ti=Et.join(`
`);return q===Q.ADVANCED&&(Ti+=`
Q`),vt(hi,!0),er({data:Ti,filters:Fi(),objectId:hi}),Ze("endobj"),jt},Sr=E.__private__.putPages=function(){var ie,Ue,Et=[];for(ie=1;ie<=Lr;ie++)yr[ie].objId=Ge(),yr[ie].contentsObjId=Ge();for(ie=1;ie<=Lr;ie++)Et.push(nr({number:ie,data:Ai[ie],objId:yr[ie].objId,contentsObjId:yr[ie].contentsObjId,mediaBox:yr[ie].mediaBox,cropBox:yr[ie].cropBox,bleedBox:yr[ie].bleedBox,trimBox:yr[ie].trimBox,artBox:yr[ie].artBox,userUnit:yr[ie].userUnit,rootDictionaryObjId:_t,resourceDictionaryObjId:Ot}));vt(_t,!0),Ze("<</Type /Pages");var jt="/Kids [";for(Ue=0;Ue<Lr;Ue++)jt+=Et[Ue]+" 0 R ";Ze(jt+"]"),Ze("/Count "+Lr),Ze(">>"),Ze("endobj"),qt.publish("postPutPages")},Mr=function(ie){qt.publish("putFont",{font:ie,out:Ze,newObject:Je,putStream:er}),ie.isAlreadyPutted!==!0&&(ie.objectNumber=Je(),Ze("<<"),Ze("/Type /Font"),Ze("/BaseFont /"+Xg(ie.postScriptName)),Ze("/Subtype /Type1"),typeof ie.encoding=="string"&&Ze("/Encoding /"+ie.encoding),Ze("/FirstChar 32"),Ze("/LastChar 255"),Ze(">>"),Ze("endobj"))},jr=function(){for(var ie in _r)_r.hasOwnProperty(ie)&&(B===!1||B===!0&&T.hasOwnProperty(ie))&&Mr(_r[ie])},nn=function(ie){ie.objectNumber=Je();var Ue=[];Ue.push({key:"Type",value:"/XObject"}),Ue.push({key:"Subtype",value:"/Form"}),Ue.push({key:"BBox",value:"["+[fe(ie.x),fe(ie.y),fe(ie.x+ie.width),fe(ie.y+ie.height)].join(" ")+"]"}),Ue.push({key:"Matrix",value:"["+ie.matrix.toString()+"]"});var Et=ie.pages[1].join(`
`);er({data:Et,additionalKeyValues:Ue,objectId:ie.objectNumber}),Ze("endobj")},Yr=function(){for(var ie in vs)vs.hasOwnProperty(ie)&&nn(vs[ie])},Wn=function(ie,Ue){var Et,jt=[],hi=1/(Ue-1);for(Et=0;Et<1;Et+=hi)jt.push(Et);if(jt.push(1),ie[0].offset!=0){var Ti={offset:0,color:ie[0].color};ie.unshift(Ti)}if(ie[ie.length-1].offset!=1){var mr={offset:1,color:ie[ie.length-1].color};ie.push(mr)}for(var Vr="",cn=0,Pn=0;Pn<jt.length;Pn++){for(Et=jt[Pn];Et>ie[cn+1].offset;)cn++;var kn=ie[cn].offset,hs=(Et-kn)/(ie[cn+1].offset-kn),Zs=ie[cn].color,Zn=ie[cn+1].color;Vr+=mt(Math.round((1-hs)*Zs[0]+hs*Zn[0]).toString(16))+mt(Math.round((1-hs)*Zs[1]+hs*Zn[1]).toString(16))+mt(Math.round((1-hs)*Zs[2]+hs*Zn[2]).toString(16))}return Vr.trim()},fs=function(ie,Ue){Ue||(Ue=21);var Et=Je(),jt=Wn(ie.colors,Ue),hi=[];hi.push({key:"FunctionType",value:"0"}),hi.push({key:"Domain",value:"[0.0 1.0]"}),hi.push({key:"Size",value:"["+Ue+"]"}),hi.push({key:"BitsPerSample",value:"8"}),hi.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),hi.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),er({data:jt,additionalKeyValues:hi,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Et}),Ze("endobj"),ie.objectNumber=Je(),Ze("<< /ShadingType "+ie.type),Ze("/ColorSpace /DeviceRGB");var Ti="/Coords ["+fe(parseFloat(ie.coords[0]))+" "+fe(parseFloat(ie.coords[1]))+" ";ie.type===2?Ti+=fe(parseFloat(ie.coords[2]))+" "+fe(parseFloat(ie.coords[3])):Ti+=fe(parseFloat(ie.coords[2]))+" "+fe(parseFloat(ie.coords[3]))+" "+fe(parseFloat(ie.coords[4]))+" "+fe(parseFloat(ie.coords[5])),Ze(Ti+="]"),ie.matrix&&Ze("/Matrix ["+ie.matrix.toString()+"]"),Ze("/Function "+Et+" 0 R"),Ze("/Extend [true true]"),Ze(">>"),Ze("endobj")},ps=function(ie,Ue){var Et=Ge(),jt=Je();Ue.push({resourcesOid:Et,objectOid:jt}),ie.objectNumber=jt;var hi=[];hi.push({key:"Type",value:"/Pattern"}),hi.push({key:"PatternType",value:"1"}),hi.push({key:"PaintType",value:"1"}),hi.push({key:"TilingType",value:"1"}),hi.push({key:"BBox",value:"["+ie.boundingBox.map(fe).join(" ")+"]"}),hi.push({key:"XStep",value:fe(ie.xStep)}),hi.push({key:"YStep",value:fe(ie.yStep)}),hi.push({key:"Resources",value:Et+" 0 R"}),ie.matrix&&hi.push({key:"Matrix",value:"["+ie.matrix.toString()+"]"}),er({data:ie.stream,additionalKeyValues:hi,objectId:ie.objectNumber}),Ze("endobj")},Sn=function(ie){var Ue;for(Ue in Ur)Ur.hasOwnProperty(Ue)&&(Ur[Ue]instanceof Ap?fs(Ur[Ue]):Ur[Ue]instanceof og&&ps(Ur[Ue],ie))},En=function(ie){for(var Ue in ie.objectNumber=Je(),Ze("<<"),ie)switch(Ue){case"opacity":Ze("/ca "+Se(ie[Ue]));break;case"stroke-opacity":Ze("/CA "+Se(ie[Ue]))}Ze(">>"),Ze("endobj")},Is=function(){var ie;for(ie in As)As.hasOwnProperty(ie)&&En(As[ie])},_s=function(){for(var ie in Ze("/XObject <<"),vs)vs.hasOwnProperty(ie)&&vs[ie].objectNumber>=0&&Ze("/"+ie+" "+vs[ie].objectNumber+" 0 R");qt.publish("putXobjectDict"),Ze(">>")},cs=function(){Wo.oid=Je(),Ze("<<"),Ze("/Filter /Standard"),Ze("/V "+Wo.v),Ze("/R "+Wo.r),Ze("/U <"+Wo.toHexString(Wo.U)+">"),Ze("/O <"+Wo.toHexString(Wo.O)+">"),Ze("/P "+Wo.P),Ze(">>"),Ze("endobj")},Oo=function(){for(var ie in Ze("/Font <<"),_r)_r.hasOwnProperty(ie)&&(B===!1||B===!0&&T.hasOwnProperty(ie))&&Ze("/"+ie+" "+_r[ie].objectNumber+" 0 R");Ze(">>")},Ra=function(){if(Object.keys(Ur).length>0){for(var ie in Ze("/Shading <<"),Ur)Ur.hasOwnProperty(ie)&&Ur[ie]instanceof Ap&&Ur[ie].objectNumber>=0&&Ze("/"+ie+" "+Ur[ie].objectNumber+" 0 R");qt.publish("putShadingPatternDict"),Ze(">>")}},Bo=function(ie){if(Object.keys(Ur).length>0){for(var Ue in Ze("/Pattern <<"),Ur)Ur.hasOwnProperty(Ue)&&Ur[Ue]instanceof E.TilingPattern&&Ur[Ue].objectNumber>=0&&Ur[Ue].objectNumber<ie&&Ze("/"+Ue+" "+Ur[Ue].objectNumber+" 0 R");qt.publish("putTilingPatternDict"),Ze(">>")}},fc=function(){if(Object.keys(As).length>0){var ie;for(ie in Ze("/ExtGState <<"),As)As.hasOwnProperty(ie)&&As[ie].objectNumber>=0&&Ze("/"+ie+" "+As[ie].objectNumber+" 0 R");qt.publish("putGStateDict"),Ze(">>")}},us=function(ie){vt(ie.resourcesOid,!0),Ze("<<"),Ze("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Oo(),Ra(),Bo(ie.objectOid),fc(),_s(),Ze(">>"),Ze("endobj")},pc=function(){var ie=[];jr(),Is(),Yr(),Sn(ie),qt.publish("putResources"),ie.forEach(us),us({resourcesOid:Ot,objectOid:Number.MAX_SAFE_INTEGER}),qt.publish("postPutResources")},lh=function(){qt.publish("putAdditionalObjects");for(var ie=0;ie<Ut.length;ie++){var Ue=Ut[ie];vt(Ue.objId,!0),Ze(Ue.content),Ze("endobj")}qt.publish("postPutAdditionalObjects")},gc=function(ie){Zr[ie.fontName]=Zr[ie.fontName]||{},Zr[ie.fontName][ie.fontStyle]=ie.id},ql=function(ie,Ue,Et,jt,hi){var Ti={id:"F"+(Object.keys(_r).length+1).toString(10),postScriptName:ie,fontName:Ue,fontStyle:Et,encoding:jt,isStandardFont:hi||!1,metadata:{}};return qt.publish("addFont",{font:Ti,instance:this}),_r[Ti.id]=Ti,gc(Ti),Ti.id},zc=function(ie){for(var Ue=0,Et=Kt.length;Ue<Et;Ue++){var jt=ql.call(this,ie[Ue][0],ie[Ue][1],ie[Ue][2],Kt[Ue][3],!0);B===!1&&(T[jt]=!0);var hi=ie[Ue][0].split("-");gc({id:jt,fontName:hi[0],fontStyle:hi[1]||""})}qt.publish("addFonts",{fonts:_r,dictionary:Zr})},fl=function(ie){return ie.foo=function(){try{return ie.apply(this,arguments)}catch(jt){var Ue=jt.stack||"";~Ue.indexOf(" at ")&&(Ue=Ue.split(" at ")[1]);var Et="Error in function "+Ue.split(`
`)[0].split("<")[0]+": "+jt.message;if(!qn.console)throw new Error(Et);qn.console.error(Et,jt),qn.alert&&alert(Et)}},ie.foo.bar=ie,ie.foo},Co=function(ie,Ue){var Et,jt,hi,Ti,mr,Vr,cn,Pn,kn;if(hi=(Ue=Ue||{}).sourceEncoding||"Unicode",mr=Ue.outputEncoding,(Ue.autoencode||mr)&&_r[ui].metadata&&_r[ui].metadata[hi]&&_r[ui].metadata[hi].encoding&&(Ti=_r[ui].metadata[hi].encoding,!mr&&_r[ui].encoding&&(mr=_r[ui].encoding),!mr&&Ti.codePages&&(mr=Ti.codePages[0]),typeof mr=="string"&&(mr=Ti[mr]),mr)){for(cn=!1,Vr=[],Et=0,jt=ie.length;Et<jt;Et++)(Pn=mr[ie.charCodeAt(Et)])?Vr.push(String.fromCharCode(Pn)):Vr.push(ie[Et]),Vr[Et].charCodeAt(0)>>8&&(cn=!0);ie=Vr.join("")}for(Et=ie.length;cn===void 0&&Et!==0;)ie.charCodeAt(Et-1)>>8&&(cn=!0),Et--;if(!cn)return ie;for(Vr=Ue.noBOM?[]:[254,255],Et=0,jt=ie.length;Et<jt;Et++){if((kn=(Pn=ie.charCodeAt(Et))>>8)>>8)throw new Error("Character at position "+Et+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Vr.push(kn),Vr.push(Pn-(kn<<8))}return String.fromCharCode.apply(void 0,Vr)},Ta=E.__private__.pdfEscape=E.pdfEscape=function(ie,Ue){return Co(ie,Ue).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ku=E.__private__.beginPage=function(ie){Ai[++Lr]=[],yr[Lr]={objId:0,contentsObjId:0,userUnit:Number(r),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ie[0]),topRightY:Number(ie[1])}},ol(Lr),It(Ai[ot])},pl=function(ie,Ue){var Et,jt,hi;switch(i=Ue||i,typeof ie=="string"&&(Et=U(ie.toLowerCase()),Array.isArray(Et)&&(jt=Et[0],hi=Et[1])),Array.isArray(ie)&&(jt=ie[0]*li,hi=ie[1]*li),isNaN(jt)&&(jt=c[0],hi=c[1]),(jt>14400||hi>14400)&&(ha.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),jt=Math.min(14400,jt),hi=Math.min(14400,hi)),c=[jt,hi],i.substr(0,1)){case"l":hi>jt&&(c=[hi,jt]);break;case"p":jt>hi&&(c=[hi,jt])}ku(c),_l(fu),Ze($a),mu!==0&&Ze(mu+" J"),Er!==0&&Ze(Er+" j"),qt.publish("addPage",{pageNumber:Lr})},sl=function(ie){ie>0&&ie<=Lr&&(Ai.splice(ie,1),yr.splice(ie,1),Lr--,ot>Lr&&(ot=Lr),this.setPage(ot))},ol=function(ie){ie>0&&ie<=Lr&&(ot=ie)},mc=E.__private__.getNumberOfPages=E.getNumberOfPages=function(){return Ai.length-1},gl=function(ie,Ue,Et){var jt,hi=void 0;return Et=Et||{},ie=ie!==void 0?ie:_r[ui].fontName,Ue=Ue!==void 0?Ue:_r[ui].fontStyle,jt=ie.toLowerCase(),Zr[jt]!==void 0&&Zr[jt][Ue]!==void 0?hi=Zr[jt][Ue]:Zr[ie]!==void 0&&Zr[ie][Ue]!==void 0?hi=Zr[ie][Ue]:Et.disableWarning===!1&&ha.warn("Unable to look up font label for font '"+ie+"', '"+Ue+"'. Refer to getFontList() for available fonts."),hi||Et.noFallback||(hi=Zr.times[Ue])==null&&(hi=Zr.times.normal),hi},yc=E.__private__.putInfo=function(){var ie=Je(),Ue=function(jt){return jt};for(var Et in x!==null&&(Ue=Wo.encryptor(ie,0)),Ze("<<"),Ze("/Producer ("+Ta(Ue("jsPDF "+Qn.version))+")"),Qr)Qr.hasOwnProperty(Et)&&Qr[Et]&&Ze("/"+Et.substr(0,1).toUpperCase()+Et.substr(1)+" ("+Ta(Ue(Qr[Et]))+")");Ze("/CreationDate ("+Ta(Ue(Pe))+")"),Ze(">>"),Ze("endobj")},$l=E.__private__.putCatalog=function(ie){var Ue=(ie=ie||{}).rootDictionaryObjId||_t;switch(Je(),Ze("<<"),Ze("/Type /Catalog"),Ze("/Pages "+Ue+" 0 R"),pi||(pi="fullwidth"),pi){case"fullwidth":Ze("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ze("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ze("/OpenAction [3 0 R /Fit]");break;case"original":Ze("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Et=""+pi;Et.substr(Et.length-1)==="%"&&(pi=parseInt(pi)/100),typeof pi=="number"&&Ze("/OpenAction [3 0 R /XYZ null null "+Se(pi)+"]")}switch(br||(br="continuous"),br){case"continuous":Ze("/PageLayout /OneColumn");break;case"single":Ze("/PageLayout /SinglePage");break;case"two":case"twoleft":Ze("/PageLayout /TwoColumnLeft");break;case"tworight":Ze("/PageLayout /TwoColumnRight")}Ji&&Ze("/PageMode /"+Ji),qt.publish("putCatalog"),Ze(">>"),Ze("endobj")},Zl=E.__private__.putTrailer=function(){Ze("trailer"),Ze("<<"),Ze("/Size "+(Ct+1)),Ze("/Root "+Ct+" 0 R"),Ze("/Info "+(Ct-1)+" 0 R"),x!==null&&Ze("/Encrypt "+Wo.oid+" 0 R"),Ze("/ID [ <"+De+"> <"+De+"> ]"),Ze(">>")},Ru=E.__private__.putHeader=function(){Ze("%PDF-"+R),Ze("%")},cu=E.__private__.putXRef=function(){var ie="0000000000";Ze("xref"),Ze("0 "+(Ct+1)),Ze("0000000000 65535 f ");for(var Ue=1;Ue<=Ct;Ue++)typeof rt[Ue]=="function"?Ze((ie+rt[Ue]()).slice(-10)+" 00000 n "):rt[Ue]!==void 0?Ze((ie+rt[Ue]).slice(-10)+" 00000 n "):Ze("0000000000 00000 n ")},ml=E.__private__.buildDocument=function(){Pt(),It(Bt),qt.publish("buildDocument"),Ru(),Sr(),lh(),pc(),x!==null&&cs(),yc(),$l();var ie=tt;return cu(),Zl(),Ze("startxref"),Ze(""+ie),Ze("%%EOF"),It(Ai[ot]),Bt.join(`
`)},uu=E.__private__.getBlob=function(ie){return new Blob([bi(ie)],{type:"application/pdf"})},Nc=E.output=E.__private__.output=fl(function(ie,Ue){switch(typeof(Ue=Ue||{})=="string"?Ue={filename:Ue}:Ue.filename=Ue.filename||"generated.pdf",ie){case void 0:return ml();case"save":E.save(Ue.filename);break;case"arraybuffer":return bi(ml());case"blob":return uu(ml());case"bloburi":case"bloburl":if(qn.URL!==void 0&&typeof qn.URL.createObjectURL=="function")return qn.URL&&qn.URL.createObjectURL(uu(ml()))||void 0;ha.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Et="",jt=ml();try{Et=a1(jt)}catch{Et=a1(unescape(encodeURIComponent(jt)))}return"data:application/pdf;filename="+Ue.filename+";base64,"+Et;case"pdfobjectnewwindow":if(Object.prototype.toString.call(qn)==="[object Window]"){var hi="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ti=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ue.pdfObjectUrl&&(hi=Ue.pdfObjectUrl,Ti="");var mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+hi+'"'+Ti+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ue)+");<\/script></body></html>",Vr=qn.open();return Vr!==null&&Vr.document.write(mr),Vr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(qn)==="[object Window]"){var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ue.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ue.filename+'" width="500px" height="400px" /></body></html>',Pn=qn.open();if(Pn!==null){Pn.document.write(cn);var kn=this;Pn.document.documentElement.querySelector("#pdfViewer").onload=function(){Pn.document.title=Ue.filename,Pn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(kn.output("bloburl"))}}return Pn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(qn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var hs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ue)+'"></iframe></body></html>',Zs=qn.open();if(Zs!==null&&(Zs.document.write(hs),Zs.document.title=Ue.filename),Zs||typeof safari>"u")return Zs;break;case"datauri":case"dataurl":return qn.document.location.href=this.output("datauristring",Ue);default:return null}}),Po=function(ie){return Array.isArray(Nn)===!0&&Nn.indexOf(ie)>-1};switch(s){case"pt":li=1;break;case"mm":li=72/25.4;break;case"cm":li=72/2.54;break;case"in":li=72;break;case"px":li=Po("px_scaling")==1?.75:96/72;break;case"pc":case"em":li=12;break;case"ex":li=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);li=s}var Wo=null;Qt(),Ye();var ch=function(ie){return x!==null?Wo.encryptor(ie,0):function(Ue){return Ue}},hu=E.__private__.getPageInfo=E.getPageInfo=function(ie){if(isNaN(ie)||ie%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:yr[ie].objId,pageNumber:ie,pageContext:yr[ie]}},Tn=E.__private__.getPageInfoByObjId=function(ie){if(isNaN(ie)||ie%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ue in yr)if(yr[Ue].objId===ie)break;return hu(Ue)},Jd=E.__private__.getCurrentPageInfo=E.getCurrentPageInfo=function(){return{objId:yr[ot].objId,pageNumber:ot,pageContext:yr[ot]}};E.addPage=function(){return pl.apply(this,arguments),this},E.setPage=function(){return ol.apply(this,arguments),It.call(this,Ai[ot]),this},E.insertPage=function(ie){return this.addPage(),this.movePage(ot,ie),this},E.movePage=function(ie,Ue){var Et,jt;if(ie>Ue){Et=Ai[ie],jt=yr[ie];for(var hi=ie;hi>Ue;hi--)Ai[hi]=Ai[hi-1],yr[hi]=yr[hi-1];Ai[Ue]=Et,yr[Ue]=jt,this.setPage(Ue)}else if(ie<Ue){Et=Ai[ie],jt=yr[ie];for(var Ti=ie;Ti<Ue;Ti++)Ai[Ti]=Ai[Ti+1],yr[Ti]=yr[Ti+1];Ai[Ue]=Et,yr[Ue]=jt,this.setPage(Ue)}return this},E.deletePage=function(){return sl.apply(this,arguments),this},E.__private__.text=E.text=function(ie,Ue,Et,jt,hi){var Ti,mr,Vr,cn,Pn,kn,hs,Zs,Zn,xn=(jt=jt||{}).scope||this;if(typeof ie=="number"&&typeof Ue=="number"&&(typeof Et=="string"||Array.isArray(Et))){var Js=Et;Et=Ue,Ue=ie,ie=Js}if(arguments[3]instanceof St?(he("The transform parameter of text() with a Matrix value"),Zn=hi):(Vr=arguments[4],cn=arguments[5],Go(hs=arguments[3])==="object"&&hs!==null||(typeof Vr=="string"&&(cn=Vr,Vr=null),typeof hs=="string"&&(cn=hs,hs=null),typeof hs=="number"&&(Vr=hs,hs=null),jt={flags:hs,angle:Vr,align:cn})),isNaN(Ue)||isNaN(Et)||ie==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ie.length===0)return xn;var yo="",Wr=!1,ji=typeof jt.lineHeightFactor=="number"?jt.lineHeightFactor:qa,eo=xn.internal.scaleFactor;function Pr(wi){return wi=wi.split("	").join(Array(jt.TabLen||9).join(" ")),Ta(wi,hs)}function Cs(wi){for(var no,xo=wi.concat(),fo=[],jl=xo.length;jl--;)typeof(no=xo.shift())=="string"?fo.push(no):Array.isArray(wi)&&(no.length===1||no[1]===void 0&&no[2]===void 0)?fo.push(no[0]):fo.push([no[0],no[1],no[2]]);return fo}function ao(wi,no){var xo;if(typeof wi=="string")xo=no(wi)[0];else if(Array.isArray(wi)){for(var fo,jl,bu=wi.concat(),za=[],fh=bu.length;fh--;)typeof(fo=bu.shift())=="string"?za.push(no(fo)[0]):Array.isArray(fo)&&typeof fo[0]=="string"&&(jl=no(fo[0],fo[1],fo[2]),za.push([jl[0],jl[1],jl[2]]));xo=za}return xo}var wr=!1,vo=!0;if(typeof ie=="string")wr=!0;else if(Array.isArray(ie)){var ic=ie.concat();mr=[];for(var pa,Xo=ic.length;Xo--;)(typeof(pa=ic.shift())!="string"||Array.isArray(pa)&&typeof pa[0]!="string")&&(vo=!1);wr=vo}if(wr===!1)throw new Error('Type of text must be string or Array. "'+ie+'" is not recognized.');typeof ie=="string"&&(ie=ie.match(/[\r?\n]/)?ie.split(/\r\n|\r|\n/g):[ie]);var Jn=di/xn.internal.scaleFactor,Yo=Jn*(ji-1);switch(jt.baseline){case"bottom":Et-=Yo;break;case"top":Et+=Jn-Yo;break;case"hanging":Et+=Jn-2*Yo;break;case"middle":Et+=Jn/2-Yo}if((kn=jt.maxWidth||0)>0&&(typeof ie=="string"?ie=xn.splitTextToSize(ie,kn):Object.prototype.toString.call(ie)==="[object Array]"&&(ie=ie.reduce(function(wi,no){return wi.concat(xn.splitTextToSize(no,kn))},[]))),Ti={text:ie,x:Ue,y:Et,options:jt,mutex:{pdfEscape:Ta,activeFontKey:ui,fonts:_r,activeFontSize:di}},qt.publish("preProcessText",Ti),ie=Ti.text,Vr=(jt=Ti.options).angle,!(Zn instanceof St)&&Vr&&typeof Vr=="number"){Vr*=Math.PI/180,jt.rotationDirection===0&&(Vr=-Vr),q===Q.ADVANCED&&(Vr=-Vr);var xc=Math.cos(Vr),So=Math.sin(Vr);Zn=new St(xc,So,-So,xc,0,0)}else Vr&&Vr instanceof St&&(Zn=Vr);q!==Q.ADVANCED||Zn||(Zn=Ce),(Pn=jt.charSpace||zo)!==void 0&&(yo+=fe(ye(Pn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Zs=jt.horizontalScale)!==void 0&&(yo+=fe(100*Zs)+` Tz
`),jt.lang;var Oa=-1,al=jt.renderingMode!==void 0?jt.renderingMode:jt.stroke,Ko=xn.internal.getCurrentPageInfo().pageContext;switch(al){case 0:case!1:case"fill":Oa=0;break;case 1:case!0:case"stroke":Oa=1;break;case 2:case"fillThenStroke":Oa=2;break;case 3:case"invisible":Oa=3;break;case 4:case"fillAndAddForClipping":Oa=4;break;case 5:case"strokeAndAddPathForClipping":Oa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Oa=6;break;case 7:case"addToPathForClipping":Oa=7}var yu=Ko.usedRenderingMode!==void 0?Ko.usedRenderingMode:-1;Oa!==-1?yo+=Oa+` Tr
`:yu!==-1&&(yo+=`0 Tr
`),Oa!==-1&&(Ko.usedRenderingMode=Oa),cn=jt.align||"left";var No,Rl=di*ji,Ia=xn.internal.pageSize.getWidth(),_o=_r[ui];Pn=jt.charSpace||zo,kn=jt.maxWidth||0,hs=Object.assign({autoencode:!0,noBOM:!0},jt.flags);var sa=[],Dl=function(wi){return xn.getStringUnitWidth(wi,{font:_o,charSpace:Pn,fontSize:di,doKerning:!1})*di/eo};if(Object.prototype.toString.call(ie)==="[object Array]"){var Za;mr=Cs(ie),cn!=="left"&&(No=mr.map(Dl));var ga,bc=0;if(cn==="right"){Ue-=No[0],ie=[],Xo=mr.length;for(var Ua=0;Ua<Xo;Ua++)Ua===0?(ga=ec(Ue),Za=tc(Et)):(ga=ye(bc-No[Ua]),Za=-Rl),ie.push([mr[Ua],ga,Za]),bc=No[Ua]}else if(cn==="center"){Ue-=No[0]/2,ie=[],Xo=mr.length;for(var Ol=0;Ol<Xo;Ol++)Ol===0?(ga=ec(Ue),Za=tc(Et)):(ga=ye((bc-No[Ol])/2),Za=-Rl),ie.push([mr[Ol],ga,Za]),bc=No[Ol]}else if(cn==="left"){ie=[],Xo=mr.length;for(var bl=0;bl<Xo;bl++)ie.push(mr[bl])}else if(cn==="justify"&&_o.encoding==="Identity-H"){ie=[],Xo=mr.length,kn=kn!==0?kn:Ia;for(var Gc=0,qo=0;qo<Xo;qo++)if(Za=qo===0?tc(Et):-Rl,ga=qo===0?ec(Ue):Gc,qo<Xo-1){var wl=ye((kn-No[qo])/(mr[qo].split(" ").length-1)),Fa=mr[qo].split(" ");ie.push([Fa[0]+" ",ga,Za]),Gc=0;for(var Ul=1;Ul<Fa.length;Ul++){var vu=(Dl(Fa[Ul-1]+" "+Fa[Ul])-Dl(Fa[Ul]))*eo+wl;Ul==Fa.length-1?ie.push([Fa[Ul],vu,0]):ie.push([Fa[Ul]+" ",vu,0]),Gc-=vu}}else ie.push([mr[qo],ga,Za]);ie.push(["",Gc,0])}else{if(cn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ie=[],Xo=mr.length,kn=kn!==0?kn:Ia,qo=0;qo<Xo;qo++)Za=qo===0?tc(Et):-Rl,ga=qo===0?ec(Ue):0,qo<Xo-1?sa.push(fe(ye((kn-No[qo])/(mr[qo].split(" ").length-1)))):sa.push(0),ie.push([mr[qo],ga,Za])}}var Ja=typeof jt.R2L=="boolean"?jt.R2L:Oi;Ja===!0&&(ie=ao(ie,function(wi,no,xo){return[wi.split("").reverse().join(""),no,xo]})),Ti={text:ie,x:Ue,y:Et,options:jt,mutex:{pdfEscape:Ta,activeFontKey:ui,fonts:_r,activeFontSize:di}},qt.publish("postProcessText",Ti),ie=Ti.text,Wr=Ti.mutex.isHex||!1;var Uu=_r[ui].encoding;Uu!=="WinAnsiEncoding"&&Uu!=="StandardEncoding"||(ie=ao(ie,function(wi,no,xo){return[Pr(wi),no,xo]})),mr=Cs(ie),ie=[];for(var jo,wc,zl,_u=0,rc=1,Nl=Array.isArray(mr[0])?rc:_u,Bc="",xu=function(wi,no,xo){var fo="";return xo instanceof St?(xo=typeof jt.angle=="number"?me(xo,new St(1,0,0,1,wi,no)):me(new St(1,0,0,1,wi,no),xo),q===Q.ADVANCED&&(xo=me(new St(1,0,0,-1,0,0),xo)),fo=xo.join(" ")+` Tm
`):fo=fe(wi)+" "+fe(no)+` Td
`,fo},Eo=0;Eo<mr.length;Eo++){switch(Bc="",Nl){case rc:zl=(Wr?"<":"(")+mr[Eo][0]+(Wr?">":")"),jo=parseFloat(mr[Eo][1]),wc=parseFloat(mr[Eo][2]);break;case _u:zl=(Wr?"<":"(")+mr[Eo]+(Wr?">":")"),jo=ec(Ue),wc=tc(Et)}sa!==void 0&&sa[Eo]!==void 0&&(Bc=sa[Eo]+` Tw
`),Eo===0?ie.push(Bc+xu(jo,wc,Zn)+zl):Nl===_u?ie.push(Bc+zl):Nl===rc&&ie.push(Bc+xu(jo,wc,Zn)+zl)}ie=Nl===_u?ie.join(` Tj
T* `):ie.join(` Tj
`),ie+=` Tj
`;var el=`BT
/`;return el+=ui+" "+di+` Tf
`,el+=fe(di*ji)+` TL
`,el+=xl+`
`,el+=yo,el+=ie,Ze(el+="ET"),T[ui]=!0,xn};var uh=E.__private__.clip=E.clip=function(ie){return Ze(ie==="evenodd"?"W*":"W"),this};E.clipEvenOdd=function(){return uh("evenodd")},E.__private__.discardPath=E.discardPath=function(){return Ze("n"),this};var pn=E.__private__.isValidStyle=function(ie){var Ue=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ie)!==-1&&(Ue=!0),Ue};E.__private__.setDefaultPathOperation=E.setDefaultPathOperation=function(ie){return pn(ie)&&(b=ie),this};var hh=E.__private__.getStyle=E.getStyle=function(ie){var Ue=b;switch(ie){case"D":case"S":Ue="S";break;case"F":Ue="f";break;case"FD":case"DF":Ue="B";break;case"f":case"f*":case"B":case"B*":Ue=ie}return Ue},du=E.close=function(){return Ze("h"),this};E.stroke=function(){return Ze("S"),this},E.fill=function(ie){return jc("f",ie),this},E.fillEvenOdd=function(ie){return jc("f*",ie),this},E.fillStroke=function(ie){return jc("B",ie),this},E.fillStrokeEvenOdd=function(ie){return jc("B*",ie),this};var jc=function(ie,Ue){Go(Ue)==="object"?Hc(Ue,ie):Ze(ie)},yl=function(ie){ie===null||q===Q.ADVANCED&&ie===void 0||(ie=hh(ie),Ze(ie))};function Du(ie,Ue,Et,jt,hi){var Ti=new og(Ue||this.boundingBox,Et||this.xStep,jt||this.yStep,this.gState,hi||this.matrix);Ti.stream=this.stream;var mr=ie+"$$"+this.cloneIndex+++"$$";return je(mr,Ti),Ti}var Hc=function(ie,Ue){var Et=ta[ie.key],jt=Ur[Et];if(jt instanceof Ap)Ze("q"),Ze(vc(Ue)),jt.gState&&E.setGState(jt.gState),Ze(ie.matrix.toString()+" cm"),Ze("/"+Et+" sh"),Ze("Q");else if(jt instanceof og){var hi=new St(1,0,0,-1,0,na());ie.matrix&&(hi=hi.multiply(ie.matrix||Ce),Et=Du.call(jt,ie.key,ie.boundingBox,ie.xStep,ie.yStep,hi).id),Ze("q"),Ze("/Pattern cs"),Ze("/"+Et+" scn"),jt.gState&&E.setGState(jt.gState),Ze(Ue),Ze("Q")}},vc=function(ie){switch(ie){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},dh=E.moveTo=function(ie,Ue){return Ze(fe(ye(ie))+" "+fe(Be(Ue))+" m"),this},Au=E.lineTo=function(ie,Ue){return Ze(fe(ye(ie))+" "+fe(Be(Ue))+" l"),this},vl=E.curveTo=function(ie,Ue,Et,jt,hi,Ti){return Ze([fe(ye(ie)),fe(Be(Ue)),fe(ye(Et)),fe(Be(jt)),fe(ye(hi)),fe(Be(Ti)),"c"].join(" ")),this};E.__private__.line=E.line=function(ie,Ue,Et,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.line");return q===Q.COMPAT?this.lines([[Et-ie,jt-Ue]],ie,Ue,[1,1],hi||"S"):this.lines([[Et-ie,jt-Ue]],ie,Ue,[1,1]).stroke()},E.__private__.lines=E.lines=function(ie,Ue,Et,jt,hi,Ti){var mr,Vr,cn,Pn,kn,hs,Zs,Zn,xn,Js,yo,Wr;if(typeof ie=="number"&&(Wr=Et,Et=Ue,Ue=ie,ie=Wr),jt=jt||[1,1],Ti=Ti||!1,isNaN(Ue)||isNaN(Et)||!Array.isArray(ie)||!Array.isArray(jt)||!pn(hi)||typeof Ti!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(dh(Ue,Et),mr=jt[0],Vr=jt[1],Pn=ie.length,Js=Ue,yo=Et,cn=0;cn<Pn;cn++)(kn=ie[cn]).length===2?(Js=kn[0]*mr+Js,yo=kn[1]*Vr+yo,Au(Js,yo)):(hs=kn[0]*mr+Js,Zs=kn[1]*Vr+yo,Zn=kn[2]*mr+Js,xn=kn[3]*Vr+yo,Js=kn[4]*mr+Js,yo=kn[5]*Vr+yo,vl(hs,Zs,Zn,xn,Js,yo));return Ti&&du(),yl(hi),this},E.path=function(ie){for(var Ue=0;Ue<ie.length;Ue++){var Et=ie[Ue],jt=Et.c;switch(Et.op){case"m":dh(jt[0],jt[1]);break;case"l":Au(jt[0],jt[1]);break;case"c":vl.apply(this,jt);break;case"h":du()}}return this},E.__private__.rect=E.rect=function(ie,Ue,Et,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.rect");return q===Q.COMPAT&&(jt=-jt),Ze([fe(ye(ie)),fe(Be(Ue)),fe(ye(Et)),fe(ye(jt)),"re"].join(" ")),yl(hi),this},E.__private__.triangle=E.triangle=function(ie,Ue,Et,jt,hi,Ti,mr){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||isNaN(jt)||isNaN(hi)||isNaN(Ti)||!pn(mr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Et-ie,jt-Ue],[hi-Et,Ti-jt],[ie-hi,Ue-Ti]],ie,Ue,[1,1],mr,!0),this},E.__private__.roundedRect=E.roundedRect=function(ie,Ue,Et,jt,hi,Ti,mr){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||isNaN(jt)||isNaN(hi)||isNaN(Ti)||!pn(mr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Vr=4/3*(Math.SQRT2-1);return hi=Math.min(hi,.5*Et),Ti=Math.min(Ti,.5*jt),this.lines([[Et-2*hi,0],[hi*Vr,0,hi,Ti-Ti*Vr,hi,Ti],[0,jt-2*Ti],[0,Ti*Vr,-hi*Vr,Ti,-hi,Ti],[2*hi-Et,0],[-hi*Vr,0,-hi,-Ti*Vr,-hi,-Ti],[0,2*Ti-jt],[0,-Ti*Vr,hi*Vr,-Ti,hi,-Ti]],ie+hi,Ue,[1,1],mr,!0),this},E.__private__.ellipse=E.ellipse=function(ie,Ue,Et,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ti=4/3*(Math.SQRT2-1)*Et,mr=4/3*(Math.SQRT2-1)*jt;return dh(ie+Et,Ue),vl(ie+Et,Ue-mr,ie+Ti,Ue-jt,ie,Ue-jt),vl(ie-Ti,Ue-jt,ie-Et,Ue-mr,ie-Et,Ue),vl(ie-Et,Ue+mr,ie-Ti,Ue+jt,ie,Ue+jt),vl(ie+Ti,Ue+jt,ie+Et,Ue+mr,ie+Et,Ue),yl(hi),this},E.__private__.circle=E.circle=function(ie,Ue,Et,jt){if(isNaN(ie)||isNaN(Ue)||isNaN(Et)||!pn(jt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ie,Ue,Et,Et,jt)},E.setFont=function(ie,Ue,Et){return Et&&(Ue=pe(Ue,Et)),ui=gl(ie,Ue,{disableWarning:!1}),this};var ld=E.__private__.getFont=E.getFont=function(){return _r[gl.apply(E,arguments)]};E.__private__.getFontList=E.getFontList=function(){var ie,Ue,Et={};for(ie in Zr)if(Zr.hasOwnProperty(ie))for(Ue in Et[ie]=[],Zr[ie])Zr[ie].hasOwnProperty(Ue)&&Et[ie].push(Ue);return Et},E.addFont=function(ie,Ue,Et,jt,hi){var Ti=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ti.indexOf(arguments[3])!==-1?hi=arguments[3]:arguments[3]&&Ti.indexOf(arguments[3])==-1&&(Et=pe(Et,jt)),hi=hi||"Identity-H",ql.call(this,ie,Ue,Et,hi)};var qa,fu=a.lineWidth||.200025,pu=E.__private__.getLineWidth=E.getLineWidth=function(){return fu},_l=E.__private__.setLineWidth=E.setLineWidth=function(ie){return fu=ie,Ze(fe(ye(ie))+" w"),this};E.__private__.setLineDash=Qn.API.setLineDash=Qn.API.setLineDashPattern=function(ie,Ue){if(ie=ie||[],Ue=Ue||0,isNaN(Ue)||!Array.isArray(ie))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ie=ie.map(function(Et){return fe(ye(Et))}).join(" "),Ue=fe(ye(Ue)),Ze("["+ie+"] "+Ue+" d"),this};var Uo=E.__private__.getLineHeight=E.getLineHeight=function(){return di*qa};E.__private__.getLineHeight=E.getLineHeight=function(){return di*qa};var Qc=E.__private__.setLineHeightFactor=E.setLineHeightFactor=function(ie){return typeof(ie=ie||1.15)=="number"&&(qa=ie),this},Jl=E.__private__.getLineHeightFactor=E.getLineHeightFactor=function(){return qa};Qc(a.lineHeight);var ec=E.__private__.getHorizontalCoordinate=function(ie){return ye(ie)},tc=E.__private__.getVerticalCoordinate=function(ie){return q===Q.ADVANCED?ie:yr[ot].mediaBox.topRightY-yr[ot].mediaBox.bottomLeftY-ye(ie)},gu=E.__private__.getHorizontalCoordinateString=E.getHorizontalCoordinateString=function(ie){return fe(ec(ie))},ra=E.__private__.getVerticalCoordinateString=E.getVerticalCoordinateString=function(ie){return fe(tc(ie))},$a=a.strokeColor||"0 G";E.__private__.getStrokeColor=E.getDrawColor=function(){return ii($a)},E.__private__.setStrokeColor=E.setDrawColor=function(ie,Ue,Et,jt){return $a=Nt({ch1:ie,ch2:Ue,ch3:Et,ch4:jt,pdfColorType:"draw",precision:2}),Ze($a),this};var Pl=a.fillColor||"0 g";E.__private__.getFillColor=E.getFillColor=function(){return ii(Pl)},E.__private__.setFillColor=E.setFillColor=function(ie,Ue,Et,jt){return Pl=Nt({ch1:ie,ch2:Ue,ch3:Et,ch4:jt,pdfColorType:"fill",precision:2}),Ze(Pl),this};var xl=a.textColor||"0 g",Un=E.__private__.getTextColor=E.getTextColor=function(){return ii(xl)};E.__private__.setTextColor=E.setTextColor=function(ie,Ue,Et,jt){return xl=Nt({ch1:ie,ch2:Ue,ch3:Et,ch4:jt,pdfColorType:"text",precision:3}),this};var zo=a.charSpace,Hh=E.__private__.getCharSpace=E.getCharSpace=function(){return parseFloat(zo||0)};E.__private__.setCharSpace=E.setCharSpace=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return zo=ie,this};var mu=0;E.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},E.__private__.setLineCap=E.setLineCap=function(ie){var Ue=E.CapJoinStyles[ie];if(Ue===void 0)throw new Error("Line cap style of '"+ie+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mu=Ue,Ze(Ue+" J"),this};var Er=0;E.__private__.setLineJoin=E.setLineJoin=function(ie){var Ue=E.CapJoinStyles[ie];if(Ue===void 0)throw new Error("Line join style of '"+ie+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Er=Ue,Ze(Ue+" j"),this},E.__private__.setLineMiterLimit=E.__private__.setMiterLimit=E.setLineMiterLimit=E.setMiterLimit=function(ie){if(ie=ie||0,isNaN(ie))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ze(fe(ye(ie))+" M"),this},E.GState=Ny,E.setGState=function(ie){(ie=typeof ie=="string"?As[ro[ie]]:Ah(null,ie)).equals(zn)||(Ze("/"+ie.id+" gs"),zn=ie)};var Ah=function(ie,Ue){if(!ie||!ro[ie]){var Et=!1;for(var jt in As)if(As.hasOwnProperty(jt)&&As[jt].equals(Ue)){Et=!0;break}if(Et)Ue=As[jt];else{var hi="GS"+(Object.keys(As).length+1).toString(10);As[hi]=Ue,Ue.id=hi}return ie&&(ro[ie]=Ue.id),qt.publish("addGState",Ue),Ue}};E.addGState=function(ie,Ue){return Ah(ie,Ue),this},E.saveGraphicsState=function(){return Ze("q"),io.push({key:ui,size:di,color:xl}),this},E.restoreGraphicsState=function(){Ze("Q");var ie=io.pop();return ui=ie.key,di=ie.size,xl=ie.color,zn=null,this},E.setCurrentTransformationMatrix=function(ie){return Ze(ie.toString()+" cm"),this},E.comment=function(ie){return Ze("#"+ie),this};var Vc=function(ie,Ue){var Et=ie||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Et},set:function(Ti){isNaN(Ti)||(Et=parseFloat(Ti))}});var jt=Ue||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return jt},set:function(Ti){isNaN(Ti)||(jt=parseFloat(Ti))}});var hi="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return hi},set:function(Ti){hi=Ti.toString()}}),this},_c=function(ie,Ue,Et,jt){Vc.call(this,ie,Ue),this.type="rect";var hi=Et||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return hi},set:function(mr){isNaN(mr)||(hi=parseFloat(mr))}});var Ti=jt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ti},set:function(mr){isNaN(mr)||(Ti=parseFloat(mr))}}),this},Da=function(){this.page=Lr,this.currentPage=ot,this.pages=Ai.slice(0),this.pagesContext=yr.slice(0),this.x=Vi,this.y=rr,this.matrix=qr,this.width=Mn(ot),this.height=na(ot),this.outputDestination=Ke,this.id="",this.objectNumber=-1};Da.prototype.restore=function(){Lr=this.page,ot=this.currentPage,yr=this.pagesContext,Ai=this.pages,Vi=this.x,rr=this.y,qr=this.matrix,In(ot,this.width),kl(ot,this.height),Ke=this.outputDestination};var Qh=function(ie,Ue,Et,jt,hi){dn.push(new Da),Lr=ot=0,Ai=[],Vi=ie,rr=Ue,qr=hi,ku([Et,jt])},Ou=function(ie){if(ia[ie])dn.pop().restore();else{var Ue=new Da,Et="Xo"+(Object.keys(vs).length+1).toString(10);Ue.id=Et,ia[ie]=Et,vs[Et]=Ue,qt.publish("addFormObject",Ue),dn.pop().restore()}};for(var hr in E.beginFormObject=function(ie,Ue,Et,jt,hi){return Qh(ie,Ue,Et,jt,hi),this},E.endFormObject=function(ie){return Ou(ie),this},E.doFormObject=function(ie,Ue){var Et=vs[ia[ie]];return Ze("q"),Ze(Ue.toString()+" cm"),Ze("/"+Et.id+" Do"),Ze("Q"),this},E.getFormObject=function(ie){var Ue=vs[ia[ie]];return{x:Ue.x,y:Ue.y,width:Ue.width,height:Ue.height,matrix:Ue.matrix}},E.save=function(ie,Ue){return ie=ie||"generated.pdf",(Ue=Ue||{}).returnPromise=Ue.returnPromise||!1,Ue.returnPromise===!1?(Zp(uu(ml()),ie),typeof Zp.unload=="function"&&qn.setTimeout&&setTimeout(Zp.unload,911),this):new Promise(function(Et,jt){try{var hi=Zp(uu(ml()),ie);typeof Zp.unload=="function"&&qn.setTimeout&&setTimeout(Zp.unload,911),Et(hi)}catch(Ti){jt(Ti.message)}})},Qn.API)Qn.API.hasOwnProperty(hr)&&(hr==="events"&&Qn.API.events.length?function(ie,Ue){var Et,jt,hi;for(hi=Ue.length-1;hi!==-1;hi--)Et=Ue[hi][0],jt=Ue[hi][1],ie.subscribe.apply(ie,[Et].concat(typeof jt=="function"?[jt]:jt))}(qt,Qn.API.events):E[hr]=Qn.API[hr]);var Mn=E.getPageWidth=function(ie){return(yr[ie=ie||ot].mediaBox.topRightX-yr[ie].mediaBox.bottomLeftX)/li},In=E.setPageWidth=function(ie,Ue){yr[ie].mediaBox.topRightX=Ue*li+yr[ie].mediaBox.bottomLeftX},na=E.getPageHeight=function(ie){return(yr[ie=ie||ot].mediaBox.topRightY-yr[ie].mediaBox.bottomLeftY)/li},kl=E.setPageHeight=function(ie,Ue){yr[ie].mediaBox.topRightY=Ue*li+yr[ie].mediaBox.bottomLeftY};return E.internal={pdfEscape:Ta,getStyle:hh,getFont:ld,getFontSize:Ri,getCharSpace:Hh,getTextColor:Un,getLineHeight:Uo,getLineHeightFactor:Jl,getLineWidth:pu,write:yi,getHorizontalCoordinate:ec,getVerticalCoordinate:tc,getCoordinateString:gu,getVerticalCoordinateString:ra,collections:{},newObject:Je,newAdditionalObject:Rt,newObjectDeferred:Ge,newObjectDeferredBegin:vt,getFilters:Fi,putStream:er,events:qt,scaleFactor:li,pageSize:{getWidth:function(){return Mn(ot)},setWidth:function(ie){In(ot,ie)},getHeight:function(){return na(ot)},setHeight:function(ie){kl(ot,ie)}},encryptionOptions:x,encryption:Wo,getEncryptor:ch,output:Nc,getNumberOfPages:mc,pages:Ai,out:Ze,f2:Se,f3:oe,getPageInfo:hu,getPageInfoByObjId:Tn,getCurrentPageInfo:Jd,getPDFVersion:P,Point:Vc,Rectangle:_c,Matrix:St,hasHotfix:Po},Object.defineProperty(E.internal.pageSize,"width",{get:function(){return Mn(ot)},set:function(ie){In(ot,ie)},enumerable:!0,configurable:!0}),Object.defineProperty(E.internal.pageSize,"height",{get:function(){return na(ot)},set:function(ie){kl(ot,ie)},enumerable:!0,configurable:!0}),zc.call(E,Kt),ui="F1",pl(c,i),qt.publish("initialized"),E}Wg.prototype.lsbFirstWord=function(a){return String.fromCharCode(a>>0&255,a>>8&255,a>>16&255,a>>24&255)},Wg.prototype.toHexString=function(a){return a.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Wg.prototype.hexToBytes=function(a){for(var e=[],i=0;i<a.length;i+=2)e.push(String.fromCharCode(parseInt(a.substr(i,2),16)));return e.join("")},Wg.prototype.processOwnerPassword=function(a,e){return c1(l1(e).substr(0,5),a)},Wg.prototype.encryptor=function(a,e){var i=l1(this.encryptionKey+String.fromCharCode(255&a,a>>8&255,a>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return c1(i,s)}},Ny.prototype.equals=function(a){var e,i="id,objectNumber,equals";if(!a||Go(a)!==Go(this))return!1;var s=0;for(e in this)if(!(i.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!a.hasOwnProperty(e)||this[e]!==a[e])return!1;s++}for(e in a)a.hasOwnProperty(e)&&i.indexOf(e)<0&&s--;return s===0},Qn.API={events:[]},Qn.version="3.0.1";var rl=Qn.API,rw=1,_g=function(a){return a.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Hg=function(a){return a.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ys=function(a){return a.toFixed(2)},lp=function(a){return a.toFixed(5)};rl.__acroform__={};var ah=function(a,e){a.prototype=Object.create(e.prototype),a.prototype.constructor=a},vE=function(a){return a*rw},OA=function(a){var e=new gI,i=mn.internal.getHeight(a)||0,s=mn.internal.getWidth(a)||0;return e.BBox=[0,0,Number(ys(s)),Number(ys(i))],e},XO=rl.__acroform__.setBit=function(a,e){if(a=a||0,e=e||0,isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return a|=1<<e},YO=rl.__acroform__.clearBit=function(a,e){if(a=a||0,e=e||0,isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return a&=~(1<<e)},KO=rl.__acroform__.getBit=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(a&1<<e)==0?0:1},hl=rl.__acroform__.getBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return KO(a,e-1)},dl=rl.__acroform__.setBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return XO(a,e-1)},Al=rl.__acroform__.clearBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return YO(a,e-1)},qO=rl.__acroform__.calculateCoordinates=function(a,e){var i=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,c=a[0],d=a[1],A=a[2],r=a[3],y={};return y.lowerLeft_X=i(c)||0,y.lowerLeft_Y=s(d+r)||0,y.upperRight_X=i(c+A)||0,y.upperRight_Y=s(d)||0,[Number(ys(y.lowerLeft_X)),Number(ys(y.lowerLeft_Y)),Number(ys(y.upperRight_X)),Number(ys(y.upperRight_Y))]},$O=function(a){if(a.appearanceStreamContent)return a.appearanceStreamContent;if(a.V||a.DV){var e=[],i=a._V||a.DV,s=u1(a,i),c=a.scope.internal.getFont(a.fontName,a.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(a.scope.__private__.encodeColorString(a.color)),e.push("/"+c+" "+ys(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var d=OA(a);return d.scope=a.scope,d.stream=e.join(`
`),d}},u1=function(a,e){var i=a.fontSize===0?a.maxFontSize:a.fontSize,s={text:"",fontSize:""},c=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");c=a.multiline?c.map(function(oe){return oe.split(`
`)}):c.map(function(oe){return[oe]});var d=i,A=mn.internal.getHeight(a)||0;A=A<0?-A:A;var r=mn.internal.getWidth(a)||0;r=r<0?-r:r;var y=function(oe,ye,Me){if(oe+1<c.length){var Be=ye+" "+c[oe+1][0];return rv(Be,a,Me).width<=r-4}return!1};d++;e:for(;d>0;){e="",d--;var b,x,B=rv("3",a,d).height,T=a.multiline?A-d:(A-B)/2,E=T+=2,R=0,P=0,G=0;if(d<=0){e=`(...) Tj
`,e+="% Width of Text: "+rv(e,a,d=12).width+", FieldWidth:"+r+`
`;break}for(var U="",Q=0,q=0;q<c.length;q++)if(c.hasOwnProperty(q)){var ne=!1;if(c[q].length!==1&&G!==c[q].length-1){if((B+2)*(Q+2)+2>A)continue e;U+=c[q][G],ne=!0,P=q,q--}else{U=(U+=c[q][G]+" ").substr(U.length-1)==" "?U.substr(0,U.length-1):U;var re=parseInt(q),pe=y(re,U,d),fe=q>=c.length-1;if(pe&&!fe){U+=" ",G=0;continue}if(pe||fe){if(fe)P=re;else if(a.multiline&&(B+2)*(Q+2)+2>A)continue e}else{if(!a.multiline||(B+2)*(Q+2)+2>A)continue e;P=re}}for(var he="",be=R;be<=P;be++){var Se=c[be];if(a.multiline){if(be===P){he+=Se[G]+" ",G=(G+1)%Se.length;continue}if(be===R){he+=Se[Se.length-1]+" ";continue}}he+=Se[0]+" "}switch(he=he.substr(he.length-1)==" "?he.substr(0,he.length-1):he,x=rv(he,a,d).width,a.textAlign){case"right":b=r-x-2;break;case"center":b=(r-x)/2;break;case"left":default:b=2}e+=ys(b)+" "+ys(E)+` Td
`,e+="("+_g(he)+`) Tj
`,e+=-ys(b)+` 0 Td
`,E=-(d+2),x=0,R=ne?P:P+1,Q++,U=""}break}return s.text=e,s.fontSize=d,s},rv=function(a,e,i){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),c=e.scope.getStringUnitWidth(a,{font:s,fontSize:parseFloat(i),charSpace:0})*parseFloat(i);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(i),charSpace:0})*parseFloat(i)*1.5,width:c}},ZO={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},JO=function(a,e){var i={type:"reference",object:a};e.internal.getPageInfo(a.page).pageContext.annotations.find(function(s){return s.type===i.type&&s.object===i.object})===void 0&&e.internal.getPageInfo(a.page).pageContext.annotations.push(i)},eU=function(a,e){for(var i in a)if(a.hasOwnProperty(i)){var s=i,c=a[i];e.internal.newObjectDeferredBegin(c.objId,!0),Go(c)==="object"&&typeof c.putStream=="function"&&c.putStream(),delete a[s]}},tU=function(a,e){if(e.scope=a,a.internal!==void 0&&(a.internal.acroformPlugin===void 0||a.internal.acroformPlugin.isInitialized===!1)){if(qd.FieldNum=0,a.internal.acroformPlugin=JSON.parse(JSON.stringify(ZO)),a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");rw=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new mI,a.internal.acroformPlugin.acroFormDictionaryRoot.scope=a,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",function(){(function(i){i.internal.events.unsubscribe(i.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete i.internal.acroformPlugin.acroFormDictionaryRoot._eventID,i.internal.acroformPlugin.printedOut=!0})(a)}),a.internal.events.subscribe("buildDocument",function(){(function(i){i.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=i.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var c in s)if(s.hasOwnProperty(c)){var d=s[c];d.objId=void 0,d.hasAnnotation&&JO(d,i)}})(a)}),a.internal.events.subscribe("putCatalog",function(){(function(i){if(i.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");i.internal.write("/AcroForm "+i.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(a)}),a.internal.events.subscribe("postPutPages",function(i){(function(s,c){var d=!s;for(var A in s||(c.internal.newObjectDeferredBegin(c.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),c.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||c.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(A)){var r=s[A],y=[],b=r.Rect;if(r.Rect&&(r.Rect=qO(r.Rect,c)),c.internal.newObjectDeferredBegin(r.objId,!0),r.DA=mn.createDefaultAppearanceStream(r),Go(r)==="object"&&typeof r.getKeyValueListForStream=="function"&&(y=r.getKeyValueListForStream()),r.Rect=b,r.hasAppearanceStream&&!r.appearanceStreamContent){var x=$O(r);y.push({key:"AP",value:"<</N "+x+">>"}),c.internal.acroformPlugin.xForms.push(x)}if(r.appearanceStreamContent){var B="";for(var T in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(T)){var E=r.appearanceStreamContent[T];if(B+="/"+T+" ",B+="<<",Object.keys(E).length>=1||Array.isArray(E)){for(var A in E)if(E.hasOwnProperty(A)){var R=E[A];typeof R=="function"&&(R=R.call(c,r)),B+="/"+A+" "+R+" ",c.internal.acroformPlugin.xForms.indexOf(R)>=0||c.internal.acroformPlugin.xForms.push(R)}}else typeof(R=E)=="function"&&(R=R.call(c,r)),B+="/"+A+" "+R,c.internal.acroformPlugin.xForms.indexOf(R)>=0||c.internal.acroformPlugin.xForms.push(R);B+=">>"}y.push({key:"AP",value:`<<
`+B+">>"})}c.internal.putStream({additionalKeyValues:y,objectId:r.objId}),c.internal.out("endobj")}d&&eU(c.internal.acroformPlugin.xForms,c)})(i,a)}),a.internal.acroformPlugin.isInitialized=!0}},pI=rl.__acroform__.arrayToPdfArray=function(a,e,i){var s=function(A){return A};if(Array.isArray(a)){for(var c="[",d=0;d<a.length;d++)switch(d!==0&&(c+=" "),Go(a[d])){case"boolean":case"number":case"object":c+=a[d].toString();break;case"string":a[d].substr(0,1)!=="/"?(e!==void 0&&i&&(s=i.internal.getEncryptor(e)),c+="("+_g(s(a[d].toString()))+")"):c+=a[d].toString()}return c+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},mb=function(a,e,i){var s=function(c){return c};return e!==void 0&&i&&(s=i.internal.getEncryptor(e)),(a=a||"").toString(),a="("+_g(s(a))+")"},NA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(a){this._objId=a}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};NA.prototype.toString=function(){return this.objId+" 0 R"},NA.prototype.putStream=function(){var a=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:a,objectId:this.objId}),this.scope.internal.out("endobj")},NA.prototype.getKeyValueListForStream=function(){var a=[],e=Object.getOwnPropertyNames(this).filter(function(d){return d!="content"&&d!="appearanceStreamContent"&&d!="scope"&&d!="objId"&&d.substring(0,1)!="_"});for(var i in e)if(Object.getOwnPropertyDescriptor(this,e[i]).configurable===!1){var s=e[i],c=this[s];c&&(Array.isArray(c)?a.push({key:s,value:pI(c,this.objId,this.scope)}):c instanceof NA?(c.scope=this.scope,a.push({key:s,value:c.objId+" 0 R"})):typeof c!="function"&&a.push({key:s,value:c}))}return a};var gI=function(){NA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var a,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(i){a=i.trim()},get:function(){return a||null}})};ah(gI,NA);var mI=function(){NA.call(this);var a,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(a){var i=function(s){return s};return this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),"("+_g(i(a))+")"}},set:function(i){a=i}})};ah(mI,NA);var qd=function a(){NA.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute F supplied.');e=U}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!hl(e,3)},set:function(U){U?this.F=dl(e,3):this.F=Al(e,3)}});var i=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return i},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute Ff supplied.');i=U}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(U){s=U!==void 0?U:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(U){s[0]=U}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(U){s[1]=U}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(U){s[2]=U}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(U){s[3]=U}});var c="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return c},set:function(U){switch(U){case"/Btn":case"/Tx":case"/Ch":case"/Sig":c=U;break;default:throw new Error('Invalid value "'+U+'" for attribute FT supplied.')}}});var d=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!d||d.length<1){if(this instanceof Nv)return;d="FieldObject"+a.FieldNum++}var U=function(Q){return Q};return this.scope&&(U=this.scope.internal.getEncryptor(this.objId)),"("+_g(U(d))+")"},set:function(U){d=U.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return d},set:function(U){d=U}});var A="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return A},set:function(U){A=U}});var r="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return r},set:function(U){r=U}});var y=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return y},set:function(U){y=U}});var b=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return b===void 0?50/rw:b},set:function(U){b=U}});var x="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return x},set:function(U){x=U}});var B="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!B||this instanceof Nv||this instanceof mp))return mb(B,this.objId,this.scope)},set:function(U){U=U.toString(),B=U}});var T=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(T)return this instanceof Xl?T:mb(T,this.objId,this.scope)},set:function(U){U=U.toString(),T=this instanceof Xl?U:U.substr(0,1)==="("?Hg(U.substr(1,U.length-2)):Hg(U)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xl?Hg(T.substr(1,T.length-1)):T},set:function(U){U=U.toString(),T=this instanceof Xl?"/"+U:U}});var E=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(E)return E},set:function(U){this.V=U}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof Xl?E:mb(E,this.objId,this.scope)},set:function(U){U=U.toString(),E=this instanceof Xl?U:U.substr(0,1)==="("?Hg(U.substr(1,U.length-2)):Hg(U)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xl?Hg(E.substr(1,E.length-1)):E},set:function(U){U=U.toString(),E=this instanceof Xl?"/"+U:U}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var R,P=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return P},set:function(U){U=!!U,P=U}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(R)return R},set:function(U){R=U}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,1)},set:function(U){U?this.Ff=dl(this.Ff,1):this.Ff=Al(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,2)},set:function(U){U?this.Ff=dl(this.Ff,2):this.Ff=Al(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,3)},set:function(U){U?this.Ff=dl(this.Ff,3):this.Ff=Al(this.Ff,3)}});var G=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(G!==null)return G},set:function(U){if([0,1,2].indexOf(U)===-1)throw new Error('Invalid value "'+U+'" for attribute Q supplied.');G=U}}),Object.defineProperty(this,"textAlign",{get:function(){var U;switch(G){case 0:default:U="left";break;case 1:U="center";break;case 2:U="right"}return U},configurable:!0,enumerable:!0,set:function(U){switch(U){case"right":case 2:G=2;break;case"center":case 1:G=1;break;case"left":case 0:default:G=0}}})};ah(qd,NA);var ug=function(){qd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var a=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return a},set:function(i){a=i}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return a},set:function(i){a=i}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return pI(e,this.objId,this.scope)},set:function(i){var s,c;c=[],typeof(s=i)=="string"&&(c=function(d,A,r){r||(r=1);for(var y,b=[];y=A.exec(d);)b.push(y[r]);return b}(s,/\((.*?)\)/g)),e=c}}),this.getOptions=function(){return e},this.setOptions=function(i){e=i,this.sort&&e.sort()},this.addOption=function(i){i=(i=i||"").toString(),e.push(i),this.sort&&e.sort()},this.removeOption=function(i,s){for(s=s||!1,i=(i=i||"").toString();e.indexOf(i)!==-1&&(e.splice(e.indexOf(i),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,18)},set:function(i){i?this.Ff=dl(this.Ff,18):this.Ff=Al(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,19)},set:function(i){this.combo===!0&&(i?this.Ff=dl(this.Ff,19):this.Ff=Al(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,20)},set:function(i){i?(this.Ff=dl(this.Ff,20),e.sort()):this.Ff=Al(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,22)},set:function(i){i?this.Ff=dl(this.Ff,22):this.Ff=Al(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,23)},set:function(i){i?this.Ff=dl(this.Ff,23):this.Ff=Al(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,27)},set:function(i){i?this.Ff=dl(this.Ff,27):this.Ff=Al(this.Ff,27)}}),this.hasAppearanceStream=!1};ah(ug,qd);var hg=function(){ug.call(this),this.fontName="helvetica",this.combo=!1};ah(hg,ug);var dg=function(){hg.call(this),this.combo=!0};ah(dg,hg);var xy=function(){dg.call(this),this.edit=!0};ah(xy,dg);var Xl=function(){qd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,15)},set:function(i){i?this.Ff=dl(this.Ff,15):this.Ff=Al(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,16)},set:function(i){i?this.Ff=dl(this.Ff,16):this.Ff=Al(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,17)},set:function(i){i?this.Ff=dl(this.Ff,17):this.Ff=Al(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,26)},set:function(i){i?this.Ff=dl(this.Ff,26):this.Ff=Al(this.Ff,26)}});var a,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(d){return d};if(this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,c=[];for(s in c.push("<<"),e)c.push("/"+s+" ("+_g(i(e[s]))+")");return c.push(">>"),c.join(`
`)}},set:function(i){Go(i)==="object"&&(e=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(i){typeof i=="string"&&(e.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(i){a=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(i){a="/"+i}})};ah(Xl,qd);var by=function(){Xl.call(this),this.pushButton=!0};ah(by,Xl);var Ag=function(){Xl.call(this),this.radio=!0,this.pushButton=!1;var a=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){a=e!==void 0?e:[]}})};ah(Ag,Xl);var Nv=function(){var a,e;qd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return a},set:function(c){a=c}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(c){e=c}});var i,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var c=function(r){return r};this.scope&&(c=this.scope.internal.getEncryptor(this.objId));var d,A=[];for(d in A.push("<<"),s)A.push("/"+d+" ("+_g(c(s[d]))+")");return A.push(">>"),A.join(`
`)},set:function(c){Go(c)==="object"&&(s=c)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(c){typeof c=="string"&&(s.CA=c)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(c){i=c}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(c){i="/"+c}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=mn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ah(Nv,qd),Ag.prototype.setAppearance=function(a){if(!("createAppearanceStream"in a)||!("getCA"in a))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var i=this.Kids[e];i.appearanceStreamContent=a.createAppearanceStream(i.optionName),i.caption=a.getCA()}},Ag.prototype.createOption=function(a){var e=new Nv;return e.Parent=this,e.optionName=a,this.Kids.push(e),iU.call(this.scope,e),e};var wy=function(){Xl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=mn.CheckBox.createAppearanceStream()};ah(wy,Xl);var mp=function(){qd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,13)},set:function(e){e?this.Ff=dl(this.Ff,13):this.Ff=Al(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,21)},set:function(e){e?this.Ff=dl(this.Ff,21):this.Ff=Al(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,23)},set:function(e){e?this.Ff=dl(this.Ff,23):this.Ff=Al(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,24)},set:function(e){e?this.Ff=dl(this.Ff,24):this.Ff=Al(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,25)},set:function(e){e?this.Ff=dl(this.Ff,25):this.Ff=Al(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,26)},set:function(e){e?this.Ff=dl(this.Ff,26):this.Ff=Al(this.Ff,26)}});var a=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){Number.isInteger(e)&&(a=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ah(mp,qd);var By=function(){mp.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!hl(this.Ff,14)},set:function(a){a?this.Ff=dl(this.Ff,14):this.Ff=Al(this.Ff,14)}}),this.password=!0};ah(By,mp);var mn={CheckBox:{createAppearanceStream:function(){return{N:{On:mn.CheckBox.YesNormal},D:{On:mn.CheckBox.YesPushDown,Off:mn.CheckBox.OffPushDown}}},YesPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=[],s=a.scope.internal.getFont(a.fontName,a.fontStyle).id,c=a.scope.__private__.encodeColorString(a.color),d=u1(a,a.caption);return i.push("0.749023 g"),i.push("0 0 "+ys(mn.internal.getWidth(a))+" "+ys(mn.internal.getHeight(a))+" re"),i.push("f"),i.push("BMC"),i.push("q"),i.push("0 0 1 rg"),i.push("/"+s+" "+ys(d.fontSize)+" Tf "+c),i.push("BT"),i.push(d.text),i.push("ET"),i.push("Q"),i.push("EMC"),e.stream=i.join(`
`),e},YesNormal:function(a){var e=OA(a);e.scope=a.scope;var i=a.scope.internal.getFont(a.fontName,a.fontStyle).id,s=a.scope.__private__.encodeColorString(a.color),c=[],d=mn.internal.getHeight(a),A=mn.internal.getWidth(a),r=u1(a,a.caption);return c.push("1 g"),c.push("0 0 "+ys(A)+" "+ys(d)+" re"),c.push("f"),c.push("q"),c.push("0 0 1 rg"),c.push("0 0 "+ys(A-1)+" "+ys(d-1)+" re"),c.push("W"),c.push("n"),c.push("0 g"),c.push("BT"),c.push("/"+i+" "+ys(r.fontSize)+" Tf "+s),c.push(r.text),c.push("ET"),c.push("Q"),e.stream=c.join(`
`),e},OffPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+ys(mn.internal.getWidth(a))+" "+ys(mn.internal.getHeight(a))+" re"),i.push("f"),e.stream=i.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(a){var e={D:{Off:mn.RadioButton.Circle.OffPushDown},N:{}};return e.N[a]=mn.RadioButton.Circle.YesNormal,e.D[a]=mn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(a){var e=OA(a);e.scope=a.scope;var i=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=mn.internal.Bezier_C,d=Number((s*c).toFixed(5));return i.push("q"),i.push("1 0 0 1 "+lp(mn.internal.getWidth(a)/2)+" "+lp(mn.internal.getHeight(a)/2)+" cm"),i.push(s+" 0 m"),i.push(s+" "+d+" "+d+" "+s+" 0 "+s+" c"),i.push("-"+d+" "+s+" -"+s+" "+d+" -"+s+" 0 c"),i.push("-"+s+" -"+d+" -"+d+" -"+s+" 0 -"+s+" c"),i.push(d+" -"+s+" "+s+" -"+d+" "+s+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e},YesPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),d=Number((c*mn.internal.Bezier_C).toFixed(5)),A=Number((s*mn.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+lp(mn.internal.getWidth(a)/2)+" "+lp(mn.internal.getHeight(a)/2)+" cm"),i.push(c+" 0 m"),i.push(c+" "+d+" "+d+" "+c+" 0 "+c+" c"),i.push("-"+d+" "+c+" -"+c+" "+d+" -"+c+" 0 c"),i.push("-"+c+" -"+d+" -"+d+" -"+c+" 0 -"+c+" c"),i.push(d+" -"+c+" "+c+" -"+d+" "+c+" 0 c"),i.push("f"),i.push("Q"),i.push("0 g"),i.push("q"),i.push("1 0 0 1 "+lp(mn.internal.getWidth(a)/2)+" "+lp(mn.internal.getHeight(a)/2)+" cm"),i.push(s+" 0 m"),i.push(s+" "+A+" "+A+" "+s+" 0 "+s+" c"),i.push("-"+A+" "+s+" -"+s+" "+A+" -"+s+" 0 c"),i.push("-"+s+" -"+A+" -"+A+" -"+s+" 0 -"+s+" c"),i.push(A+" -"+s+" "+s+" -"+A+" "+s+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),d=Number((c*mn.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+lp(mn.internal.getWidth(a)/2)+" "+lp(mn.internal.getHeight(a)/2)+" cm"),i.push(c+" 0 m"),i.push(c+" "+d+" "+d+" "+c+" 0 "+c+" c"),i.push("-"+d+" "+c+" -"+c+" "+d+" -"+c+" 0 c"),i.push("-"+c+" -"+d+" -"+d+" -"+c+" 0 -"+c+" c"),i.push(d+" -"+c+" "+c+" -"+d+" "+c+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join(`
`),e}},Cross:{createAppearanceStream:function(a){var e={D:{Off:mn.RadioButton.Cross.OffPushDown},N:{}};return e.N[a]=mn.RadioButton.Cross.YesNormal,e.D[a]=mn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(a){var e=OA(a);e.scope=a.scope;var i=[],s=mn.internal.calculateCross(a);return i.push("q"),i.push("1 1 "+ys(mn.internal.getWidth(a)-2)+" "+ys(mn.internal.getHeight(a)-2)+" re"),i.push("W"),i.push("n"),i.push(ys(s.x1.x)+" "+ys(s.x1.y)+" m"),i.push(ys(s.x2.x)+" "+ys(s.x2.y)+" l"),i.push(ys(s.x4.x)+" "+ys(s.x4.y)+" m"),i.push(ys(s.x3.x)+" "+ys(s.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},YesPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=mn.internal.calculateCross(a),s=[];return s.push("0.749023 g"),s.push("0 0 "+ys(mn.internal.getWidth(a))+" "+ys(mn.internal.getHeight(a))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+ys(mn.internal.getWidth(a)-2)+" "+ys(mn.internal.getHeight(a)-2)+" re"),s.push("W"),s.push("n"),s.push(ys(i.x1.x)+" "+ys(i.x1.y)+" m"),s.push(ys(i.x2.x)+" "+ys(i.x2.y)+" l"),s.push(ys(i.x4.x)+" "+ys(i.x4.y)+" m"),s.push(ys(i.x3.x)+" "+ys(i.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(a){var e=OA(a);e.scope=a.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+ys(mn.internal.getWidth(a))+" "+ys(mn.internal.getHeight(a))+" re"),i.push("f"),e.stream=i.join(`
`),e}}},createDefaultAppearanceStream:function(a){var e=a.scope.internal.getFont(a.fontName,a.fontStyle).id,i=a.scope.__private__.encodeColorString(a.color);return"/"+e+" "+a.fontSize+" Tf "+i}};mn.internal={Bezier_C:.551915024494,calculateCross:function(a){var e=mn.internal.getWidth(a),i=mn.internal.getHeight(a),s=Math.min(e,i);return{x1:{x:(e-s)/2,y:(i-s)/2+s},x2:{x:(e-s)/2+s,y:(i-s)/2},x3:{x:(e-s)/2,y:(i-s)/2},x4:{x:(e-s)/2+s,y:(i-s)/2+s}}}},mn.internal.getWidth=function(a){var e=0;return Go(a)==="object"&&(e=vE(a.Rect[2])),e},mn.internal.getHeight=function(a){var e=0;return Go(a)==="object"&&(e=vE(a.Rect[3])),e};var iU=rl.addField=function(a){if(tU(this,a),!(a instanceof qd))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=a).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),a.page=a.scope.internal.getCurrentPageInfo().pageNumber,this};rl.AcroFormChoiceField=ug,rl.AcroFormListBox=hg,rl.AcroFormComboBox=dg,rl.AcroFormEditBox=xy,rl.AcroFormButton=Xl,rl.AcroFormPushButton=by,rl.AcroFormRadioButton=Ag,rl.AcroFormCheckBox=wy,rl.AcroFormTextField=mp,rl.AcroFormPasswordField=By,rl.AcroFormAppearance=mn,rl.AcroForm={ChoiceField:ug,ListBox:hg,ComboBox:dg,EditBox:xy,Button:Xl,PushButton:by,RadioButton:Ag,CheckBox:wy,TextField:mp,PasswordField:By,Appearance:mn},Qn.AcroForm={ChoiceField:ug,ListBox:hg,ComboBox:dg,EditBox:xy,Button:Xl,PushButton:by,RadioButton:Ag,CheckBox:wy,TextField:mp,PasswordField:By,Appearance:mn};var rU=Qn.AcroForm;function yI(a){return a.reduce(function(e,i,s){return e[i]=s,e},{})}(function(a){a.__addimage__={};var e="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=a.__addimage__.getImageFileTypeByImageData=function(oe,ye){var Me,Be,Pe,De,et,Ye=e;if((ye=ye||e)==="RGBA"||oe.data!==void 0&&oe.data instanceof Uint8ClampedArray&&"height"in oe&&"width"in oe)return"RGBA";if(pe(oe))for(et in i)for(Pe=i[et],Me=0;Me<Pe.length;Me+=1){for(De=!0,Be=0;Be<Pe[Me].length;Be+=1)if(Pe[Me][Be]!==void 0&&Pe[Me][Be]!==oe[Be]){De=!1;break}if(De===!0){Ye=et;break}}else for(et in i)for(Pe=i[et],Me=0;Me<Pe.length;Me+=1){for(De=!0,Be=0;Be<Pe[Me].length;Be+=1)if(Pe[Me][Be]!==void 0&&Pe[Me][Be]!==oe.charCodeAt(Be)){De=!1;break}if(De===!0){Ye=et;break}}return Ye===e&&ye!==e&&(Ye=ye),Ye},c=function oe(ye){for(var Me=this.internal.write,Be=this.internal.putStream,Pe=(0,this.internal.getFilters)();Pe.indexOf("FlateEncode")!==-1;)Pe.splice(Pe.indexOf("FlateEncode"),1);ye.objectId=this.internal.newObject();var De=[];if(De.push({key:"Type",value:"/XObject"}),De.push({key:"Subtype",value:"/Image"}),De.push({key:"Width",value:ye.width}),De.push({key:"Height",value:ye.height}),ye.colorSpace===G.INDEXED?De.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ye.palette.length/3-1)+" "+("sMask"in ye&&ye.sMask!==void 0?ye.objectId+2:ye.objectId+1)+" 0 R]"}):(De.push({key:"ColorSpace",value:"/"+ye.colorSpace}),ye.colorSpace===G.DEVICE_CMYK&&De.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),De.push({key:"BitsPerComponent",value:ye.bitsPerComponent}),"decodeParameters"in ye&&ye.decodeParameters!==void 0&&De.push({key:"DecodeParms",value:"<<"+ye.decodeParameters+">>"}),"transparency"in ye&&Array.isArray(ye.transparency)){for(var et="",Ye=0,bt=ye.transparency.length;Ye<bt;Ye++)et+=ye.transparency[Ye]+" "+ye.transparency[Ye]+" ";De.push({key:"Mask",value:"["+et+"]"})}ye.sMask!==void 0&&De.push({key:"SMask",value:ye.objectId+1+" 0 R"});var pt=ye.filter!==void 0?["/"+ye.filter]:void 0;if(Be({data:ye.data,additionalKeyValues:De,alreadyAppliedFilters:pt,objectId:ye.objectId}),Me("endobj"),"sMask"in ye&&ye.sMask!==void 0){var Qt="/Predictor "+ye.predictor+" /Colors 1 /BitsPerComponent "+ye.bitsPerComponent+" /Columns "+ye.width,Ie={width:ye.width,height:ye.height,colorSpace:"DeviceGray",bitsPerComponent:ye.bitsPerComponent,decodeParameters:Qt,data:ye.sMask};"filter"in ye&&(Ie.filter=ye.filter),oe.call(this,Ie)}if(ye.colorSpace===G.INDEXED){var ot=this.internal.newObject();Be({data:he(new Uint8Array(ye.palette)),objectId:ot}),Me("endobj")}},d=function(){var oe=this.internal.collections.addImage_images;for(var ye in oe)c.call(this,oe[ye])},A=function(){var oe,ye=this.internal.collections.addImage_images,Me=this.internal.write;for(var Be in ye)Me("/I"+(oe=ye[Be]).index,oe.objectId,"0","R")},r=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",d),this.internal.events.subscribe("putXobjectDict",A))},y=function(){var oe=this.internal.collections.addImage_images;return r.call(this),oe},b=function(){return Object.keys(this.internal.collections.addImage_images).length},x=function(oe){return typeof a["process"+oe.toUpperCase()]=="function"},B=function(oe){return Go(oe)==="object"&&oe.nodeType===1},T=function(oe,ye){if(oe.nodeName==="IMG"&&oe.hasAttribute("src")){var Me=""+oe.getAttribute("src");if(Me.indexOf("data:image/")===0)return _y(unescape(Me).split("base64,").pop());var Be=a.loadFile(Me,!0);if(Be!==void 0)return Be}if(oe.nodeName==="CANVAS"){if(oe.width===0||oe.height===0)throw new Error("Given canvas must have data. Canvas width: "+oe.width+", height: "+oe.height);var Pe;switch(ye){case"PNG":Pe="image/png";break;case"WEBP":Pe="image/webp";break;case"JPEG":case"JPG":default:Pe="image/jpeg"}return _y(oe.toDataURL(Pe,1).split("base64,").pop())}},E=function(oe){var ye=this.internal.collections.addImage_images;if(ye){for(var Me in ye)if(oe===ye[Me].alias)return ye[Me]}},R=function(oe,ye,Me){return oe||ye||(oe=-96,ye=-96),oe<0&&(oe=-1*Me.width*72/oe/this.internal.scaleFactor),ye<0&&(ye=-1*Me.height*72/ye/this.internal.scaleFactor),oe===0&&(oe=ye*Me.width/Me.height),ye===0&&(ye=oe*Me.height/Me.width),[oe,ye]},P=function(oe,ye,Me,Be,Pe,De){var et=R.call(this,Me,Be,Pe),Ye=this.internal.getCoordinateString,bt=this.internal.getVerticalCoordinateString,pt=y.call(this);if(Me=et[0],Be=et[1],pt[Pe.index]=Pe,De){De*=Math.PI/180;var Qt=Math.cos(De),Ie=Math.sin(De),ot=function(mt){return mt.toFixed(4)},ut=[ot(Qt),ot(Ie),ot(-1*Ie),ot(Qt),0,0,"cm"]}this.internal.write("q"),De?(this.internal.write([1,"0","0",1,Ye(oe),bt(ye+Be),"cm"].join(" ")),this.internal.write(ut.join(" ")),this.internal.write([Ye(Me),"0","0",Ye(Be),"0","0","cm"].join(" "))):this.internal.write([Ye(Me),"0","0",Ye(Be),Ye(oe),bt(ye+Be),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Pe.index+" Do"),this.internal.write("Q")},G=a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var U=a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Q=a.__addimage__.sHashCode=function(oe){var ye,Me,Be=0;if(typeof oe=="string")for(Me=oe.length,ye=0;ye<Me;ye++)Be=(Be<<5)-Be+oe.charCodeAt(ye),Be|=0;else if(pe(oe))for(Me=oe.byteLength/2,ye=0;ye<Me;ye++)Be=(Be<<5)-Be+oe[ye],Be|=0;return Be},q=a.__addimage__.validateStringAsBase64=function(oe){(oe=oe||"").toString().trim();var ye=!0;return oe.length===0&&(ye=!1),oe.length%4!=0&&(ye=!1),/^[A-Za-z0-9+/]+$/.test(oe.substr(0,oe.length-2))===!1&&(ye=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(oe.substr(-2))===!1&&(ye=!1),ye},ne=a.__addimage__.extractImageFromDataUrl=function(oe){if(oe==null||!(oe=oe.trim()).startsWith("data:"))return null;var ye=oe.indexOf(",");return ye<0?null:oe.substring(0,ye).trim().endsWith("base64")?oe.substring(ye+1):null},re=a.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};a.__addimage__.isArrayBuffer=function(oe){return re()&&oe instanceof ArrayBuffer};var pe=a.__addimage__.isArrayBufferView=function(oe){return re()&&typeof Uint32Array<"u"&&(oe instanceof Int8Array||oe instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&oe instanceof Uint8ClampedArray||oe instanceof Int16Array||oe instanceof Uint16Array||oe instanceof Int32Array||oe instanceof Uint32Array||oe instanceof Float32Array||oe instanceof Float64Array)},fe=a.__addimage__.binaryStringToUint8Array=function(oe){for(var ye=oe.length,Me=new Uint8Array(ye),Be=0;Be<ye;Be++)Me[Be]=oe.charCodeAt(Be);return Me},he=a.__addimage__.arrayBufferToBinaryString=function(oe){for(var ye="",Me=pe(oe)?oe:new Uint8Array(oe),Be=0;Be<Me.length;Be+=8192)ye+=String.fromCharCode.apply(null,Me.subarray(Be,Be+8192));return ye};a.addImage=function(){var oe,ye,Me,Be,Pe,De,et,Ye,bt;if(typeof arguments[1]=="number"?(ye=e,Me=arguments[1],Be=arguments[2],Pe=arguments[3],De=arguments[4],et=arguments[5],Ye=arguments[6],bt=arguments[7]):(ye=arguments[1],Me=arguments[2],Be=arguments[3],Pe=arguments[4],De=arguments[5],et=arguments[6],Ye=arguments[7],bt=arguments[8]),Go(oe=arguments[0])==="object"&&!B(oe)&&"imageData"in oe){var pt=oe;oe=pt.imageData,ye=pt.format||ye||e,Me=pt.x||Me||0,Be=pt.y||Be||0,Pe=pt.w||pt.width||Pe,De=pt.h||pt.height||De,et=pt.alias||et,Ye=pt.compression||Ye,bt=pt.rotation||pt.angle||bt}var Qt=this.internal.getFilters();if(Ye===void 0&&Qt.indexOf("FlateEncode")!==-1&&(Ye="SLOW"),isNaN(Me)||isNaN(Be))throw new Error("Invalid coordinates passed to jsPDF.addImage");r.call(this);var Ie=be.call(this,oe,ye,et,Ye);return P.call(this,Me,Be,Pe,De,Ie,bt),this};var be=function(oe,ye,Me,Be){var Pe,De,et;if(typeof oe=="string"&&s(oe)===e){oe=unescape(oe);var Ye=Se(oe,!1);(Ye!==""||(Ye=a.loadFile(oe,!0))!==void 0)&&(oe=Ye)}if(B(oe)&&(oe=T(oe,ye)),ye=s(oe,ye),!x(ye))throw new Error("addImage does not support files of type '"+ye+"', please ensure that a plugin for '"+ye+"' support is added.");if(((et=Me)==null||et.length===0)&&(Me=function(bt){return typeof bt=="string"||pe(bt)?Q(bt):pe(bt.data)?Q(bt.data):null}(oe)),(Pe=E.call(this,Me))||(re()&&(oe instanceof Uint8Array||ye==="RGBA"||(De=oe,oe=fe(oe))),Pe=this["process"+ye.toUpperCase()](oe,b.call(this),Me,function(bt){return bt&&typeof bt=="string"&&(bt=bt.toUpperCase()),bt in a.image_compression?bt:U.NONE}(Be),De)),!Pe)throw new Error("An unknown error occurred whilst processing the image.");return Pe},Se=a.__addimage__.convertBase64ToBinaryString=function(oe,ye){ye=typeof ye!="boolean"||ye;var Me,Be="";if(typeof oe=="string"){var Pe;Me=(Pe=ne(oe))!==null&&Pe!==void 0?Pe:oe;try{Be=_y(Me)}catch(De){if(ye)throw q(Me)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+De.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Be};a.getImageProperties=function(oe){var ye,Me,Be="";if(B(oe)&&(oe=T(oe)),typeof oe=="string"&&s(oe)===e&&((Be=Se(oe,!1))===""&&(Be=a.loadFile(oe)||""),oe=Be),Me=s(oe),!x(Me))throw new Error("addImage does not support files of type '"+Me+"', please ensure that a plugin for '"+Me+"' support is added.");if(!re()||oe instanceof Uint8Array||(oe=fe(oe)),!(ye=this["process"+Me.toUpperCase()](oe)))throw new Error("An unknown error occurred whilst processing the image");return ye.fileType=Me,ye}})(Qn.API),function(a){var e=function(i){if(i!==void 0&&i!="")return!0};Qn.API.events.push(["addPage",function(i){this.internal.getPageInfo(i.pageNumber).pageContext.annotations=[]}]),a.events.push(["putPage",function(i){for(var s,c,d,A=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,y=this.internal.getPageInfoByObjId(i.objId),b=i.pageContext.annotations,x=!1,B=0;B<b.length&&!x;B++)switch((s=b[B]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(x=!0);break;case"reference":case"text":case"freetext":x=!0}if(x!=0){this.internal.write("/Annots [");for(var T=0;T<b.length;T++){s=b[T];var E=this.internal.pdfEscape,R=this.internal.getEncryptor(i.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var P=this.internal.newAdditionalObject(),G=this.internal.newAdditionalObject(),U=this.internal.getEncryptor(P.objId),Q=s.title||"Note";d="<</Type /Annot /Subtype /Text "+(c="/Rect ["+A(s.bounds.x)+" "+r(s.bounds.y+s.bounds.h)+" "+A(s.bounds.x+s.bounds.w)+" "+r(s.bounds.y)+"] ")+"/Contents ("+E(U(s.contents))+")",d+=" /Popup "+G.objId+" 0 R",d+=" /P "+y.objId+" 0 R",d+=" /T ("+E(U(Q))+") >>",P.content=d;var q=P.objId+" 0 R";d="<</Type /Annot /Subtype /Popup "+(c="/Rect ["+A(s.bounds.x+30)+" "+r(s.bounds.y+s.bounds.h)+" "+A(s.bounds.x+s.bounds.w+30)+" "+r(s.bounds.y)+"] ")+" /Parent "+q,s.open&&(d+=" /Open true"),d+=" >>",G.content=d,this.internal.write(P.objId,"0 R",G.objId,"0 R");break;case"freetext":c="/Rect ["+A(s.bounds.x)+" "+r(s.bounds.y)+" "+A(s.bounds.x+s.bounds.w)+" "+r(s.bounds.y+s.bounds.h)+"] ";var ne=s.color||"#000000";d="<</Type /Annot /Subtype /FreeText "+c+"/Contents ("+E(R(s.contents))+")",d+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+ne+")",d+=" /Border [0 0 0]",d+=" >>",this.internal.write(d);break;case"link":if(s.options.name){var re=this.annotations._nameMap[s.options.name];s.options.pageNumber=re.page,s.options.top=re.y}else s.options.top||(s.options.top=0);if(c="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",d="",s.options.url)d="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /A <</S /URI /URI ("+E(R(s.options.url))+") >>";else if(s.options.pageNumber)switch(d="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":d+=" /Fit]";break;case"FitH":d+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,d+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var pe=r(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),d+=" /XYZ "+s.options.left+" "+pe+" "+s.options.zoom+"]"}d!=""&&(d+=" >>",this.internal.write(d))}}this.internal.write("]")}}]),a.createAnnotation=function(i){var s=this.internal.getCurrentPageInfo();switch(i.type){case"link":this.link(i.bounds.x,i.bounds.y,i.bounds.w,i.bounds.h,i);break;case"text":case"freetext":s.pageContext.annotations.push(i)}},a.link=function(i,s,c,d,A){var r=this.internal.getCurrentPageInfo(),y=this.internal.getCoordinateString,b=this.internal.getVerticalCoordinateString;r.pageContext.annotations.push({finalBounds:{x:y(i),y:b(s),w:y(i+c),h:b(s+d)},options:A,type:"link"})},a.textWithLink=function(i,s,c,d){var A,r,y=this.getTextWidth(i),b=this.internal.getLineHeight()/this.internal.scaleFactor;if(d.maxWidth!==void 0){r=d.maxWidth;var x=this.splitTextToSize(i,r).length;A=Math.ceil(b*x)}else r=y,A=b;return this.text(i,s,c,d),c+=.2*b,d.align==="center"&&(s-=y/2),d.align==="right"&&(s-=y),this.link(s,c-b,r,A,d),y},a.getTextWidth=function(i){var s=this.internal.getFontSize();return this.getStringUnitWidth(i)*s/this.internal.scaleFactor}}(Qn.API),function(a){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},i={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},c=[1570,1571,1573,1575];a.__arabicParser__={};var d=a.__arabicParser__.isInArabicSubstitutionA=function(P){return e[P.charCodeAt(0)]!==void 0},A=a.__arabicParser__.isArabicLetter=function(P){return typeof P=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(P)},r=a.__arabicParser__.isArabicEndLetter=function(P){return A(P)&&d(P)&&e[P.charCodeAt(0)].length<=2},y=a.__arabicParser__.isArabicAlfLetter=function(P){return A(P)&&c.indexOf(P.charCodeAt(0))>=0};a.__arabicParser__.arabicLetterHasIsolatedForm=function(P){return A(P)&&d(P)&&e[P.charCodeAt(0)].length>=1};var b=a.__arabicParser__.arabicLetterHasFinalForm=function(P){return A(P)&&d(P)&&e[P.charCodeAt(0)].length>=2};a.__arabicParser__.arabicLetterHasInitialForm=function(P){return A(P)&&d(P)&&e[P.charCodeAt(0)].length>=3};var x=a.__arabicParser__.arabicLetterHasMedialForm=function(P){return A(P)&&d(P)&&e[P.charCodeAt(0)].length==4},B=a.__arabicParser__.resolveLigatures=function(P){var G=0,U=i,Q="",q=0;for(G=0;G<P.length;G+=1)U[P.charCodeAt(G)]!==void 0?(q++,typeof(U=U[P.charCodeAt(G)])=="number"&&(Q+=String.fromCharCode(U),U=i,q=0),G===P.length-1&&(U=i,Q+=P.charAt(G-(q-1)),G-=q-1,q=0)):(U=i,Q+=P.charAt(G-q),G-=q,q=0);return Q};a.__arabicParser__.isArabicDiacritic=function(P){return P!==void 0&&s[P.charCodeAt(0)]!==void 0};var T=a.__arabicParser__.getCorrectForm=function(P,G,U){return A(P)?d(P)===!1?-1:!b(P)||!A(G)&&!A(U)||!A(U)&&r(G)||r(P)&&!A(G)||r(P)&&y(G)||r(P)&&r(G)?0:x(P)&&A(G)&&!r(G)&&A(U)&&b(U)?3:r(P)||!A(U)?1:2:-1},E=function(P){var G=0,U=0,Q=0,q="",ne="",re="",pe=(P=P||"").split("\\s+"),fe=[];for(G=0;G<pe.length;G+=1){for(fe.push(""),U=0;U<pe[G].length;U+=1)q=pe[G][U],ne=pe[G][U-1],re=pe[G][U+1],A(q)?(Q=T(q,ne,re),fe[G]+=Q!==-1?String.fromCharCode(e[q.charCodeAt(0)][Q]):q):fe[G]+=q;fe[G]=B(fe[G])}return fe.join(" ")},R=a.__arabicParser__.processArabic=a.processArabic=function(){var P,G=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,U=[];if(Array.isArray(G)){var Q=0;for(U=[],Q=0;Q<G.length;Q+=1)Array.isArray(G[Q])?U.push([E(G[Q][0]),G[Q][1],G[Q][2]]):U.push([E(G[Q])]);P=U}else P=E(G);return typeof arguments[0]=="string"?P:(arguments[0].text=P,arguments[0])};a.events.push(["preProcessText",R])}(Qn.API),Qn.API.autoPrint=function(a){var e;switch((a=a||{}).variant=a.variant||"non-conform",a.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(a){var e=function(){var i=void 0;Object.defineProperty(this,"pdf",{get:function(){return i},set:function(r){i=r}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(r){s=isNaN(r)||Number.isInteger(r)===!1||r<0?150:r,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var c=300;Object.defineProperty(this,"height",{get:function(){return c},set:function(r){c=isNaN(r)||Number.isInteger(r)===!1||r<0?300:r,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=c+1)}});var d=[];Object.defineProperty(this,"childNodes",{get:function(){return d},set:function(r){d=r}});var A={};Object.defineProperty(this,"style",{get:function(){return A},set:function(r){A=r}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(i,s){var c;if((i=i||"2d")!=="2d")return null;for(c in s)this.pdf.context2d.hasOwnProperty(c)&&(this.pdf.context2d[c]=s[c]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},a.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Qn.API),function(a){var e={left:0,top:0,bottom:0,right:0},i=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),c.call(this))},c=function(){this.internal.__cell__.lastCell=new d,this.internal.__cell__.pages=1},d=function(){var y=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return y},set:function(P){y=P}});var b=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return b},set:function(P){b=P}});var x=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return x},set:function(P){x=P}});var B=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return B},set:function(P){B=P}});var T=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return T},set:function(P){T=P}});var E=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return E},set:function(P){E=P}});var R=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return R},set:function(P){R=P}}),this};d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},d.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},a.setHeaderFunction=function(y){return s.call(this),this.internal.__cell__.headerFunction=typeof y=="function"?y:void 0,this},a.getTextDimensions=function(y,b){s.call(this);var x=(b=b||{}).fontSize||this.getFontSize(),B=b.font||this.getFont(),T=b.scaleFactor||this.internal.scaleFactor,E=0,R=0,P=0,G=this;if(!Array.isArray(y)&&typeof y!="string"){if(typeof y!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");y=String(y)}var U=b.maxWidth;U>0?typeof y=="string"?y=this.splitTextToSize(y,U):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(q,ne){return q.concat(G.splitTextToSize(ne,U))},[])):y=Array.isArray(y)?y:[y];for(var Q=0;Q<y.length;Q++)E<(P=this.getStringUnitWidth(y[Q],{font:B})*x)&&(E=P);return E!==0&&(R=y.length),{w:E/=T,h:Math.max((R*x*this.getLineHeightFactor()-x*(this.getLineHeightFactor()-1))/T,0)}},a.cellAddPage=function(){s.call(this),this.addPage();var y=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new d(y.left,y.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var A=a.cell=function(){var y;y=arguments[0]instanceof d?arguments[0]:new d(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var b=this.internal.__cell__.lastCell,x=this.internal.__cell__.padding,B=this.internal.__cell__.margins||e,T=this.internal.__cell__.tableHeaderRow,E=this.internal.__cell__.printHeaders;return b.lineNumber!==void 0&&(b.lineNumber===y.lineNumber?(y.x=(b.x||0)+(b.width||0),y.y=b.y||0):b.y+b.height+y.height+B.bottom>this.getPageHeight()?(this.cellAddPage(),y.y=B.top,E&&T&&(this.printHeaderRow(y.lineNumber,!0),y.y+=T[0].height)):y.y=b.y+b.height||y.y),y.text[0]!==void 0&&(this.rect(y.x,y.y,y.width,y.height,i===!0?"FD":void 0),y.align==="right"?this.text(y.text,y.x+y.width-x,y.y+x,{align:"right",baseline:"top"}):y.align==="center"?this.text(y.text,y.x+y.width/2,y.y+x,{align:"center",baseline:"top",maxWidth:y.width-x-x}):this.text(y.text,y.x+x,y.y+x,{align:"left",baseline:"top",maxWidth:y.width-x-x})),this.internal.__cell__.lastCell=y,this};a.table=function(y,b,x,B,T){if(s.call(this),!x)throw new Error("No data for PDF table.");var E,R,P,G,U=[],Q=[],q=[],ne={},re={},pe=[],fe=[],he=(T=T||{}).autoSize||!1,be=T.printHeaders!==!1,Se=T.css&&T.css["font-size"]!==void 0?16*T.css["font-size"]:T.fontSize||12,oe=T.margins||Object.assign({width:this.getPageWidth()},e),ye=typeof T.padding=="number"?T.padding:3,Me=T.headerBackgroundColor||"#c8c8c8",Be=T.headerTextColor||"#000";if(c.call(this),this.internal.__cell__.printHeaders=be,this.internal.__cell__.margins=oe,this.internal.__cell__.table_font_size=Se,this.internal.__cell__.padding=ye,this.internal.__cell__.headerBackgroundColor=Me,this.internal.__cell__.headerTextColor=Be,this.setFontSize(Se),B==null)Q=U=Object.keys(x[0]),q=U.map(function(){return"left"});else if(Array.isArray(B)&&Go(B[0])==="object")for(U=B.map(function(pt){return pt.name}),Q=B.map(function(pt){return pt.prompt||pt.name||""}),q=B.map(function(pt){return pt.align||"left"}),E=0;E<B.length;E+=1)re[B[E].name]=B[E].width*(19.049976/25.4);else Array.isArray(B)&&typeof B[0]=="string"&&(Q=U=B,q=U.map(function(){return"left"}));if(he||Array.isArray(B)&&typeof B[0]=="string")for(E=0;E<U.length;E+=1){for(ne[G=U[E]]=x.map(function(pt){return pt[G]}),this.setFont(void 0,"bold"),pe.push(this.getTextDimensions(Q[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),R=ne[G],this.setFont(void 0,"normal"),P=0;P<R.length;P+=1)pe.push(this.getTextDimensions(R[P],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);re[G]=Math.max.apply(null,pe)+ye+ye,pe=[]}if(be){var Pe={};for(E=0;E<U.length;E+=1)Pe[U[E]]={},Pe[U[E]].text=Q[E],Pe[U[E]].align=q[E];var De=r.call(this,Pe,re);fe=U.map(function(pt){return new d(y,b,re[pt],De,Pe[pt].text,void 0,Pe[pt].align)}),this.setTableHeaderRow(fe),this.printHeaderRow(1,!1)}var et=B.reduce(function(pt,Qt){return pt[Qt.name]=Qt.align,pt},{});for(E=0;E<x.length;E+=1){"rowStart"in T&&T.rowStart instanceof Function&&T.rowStart({row:E,data:x[E]},this);var Ye=r.call(this,x[E],re);for(P=0;P<U.length;P+=1){var bt=x[E][U[P]];"cellStart"in T&&T.cellStart instanceof Function&&T.cellStart({row:E,col:P,data:bt},this),A.call(this,new d(y,b,re[U[P]],Ye,bt,E+2,et[U[P]]))}}return this.internal.__cell__.table_x=y,this.internal.__cell__.table_y=b,this};var r=function(y,b){var x=this.internal.__cell__.padding,B=this.internal.__cell__.table_font_size,T=this.internal.scaleFactor;return Object.keys(y).map(function(E){var R=y[E];return this.splitTextToSize(R.hasOwnProperty("text")?R.text:R,b[E]-x-x)},this).map(function(E){return this.getLineHeightFactor()*E.length*B/T+x+x},this).reduce(function(E,R){return Math.max(E,R)},0)};a.setTableHeaderRow=function(y){s.call(this),this.internal.__cell__.tableHeaderRow=y},a.printHeaderRow=function(y,b){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var x;if(i=!0,typeof this.internal.__cell__.headerFunction=="function"){var B=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new d(B[0],B[1],B[2],B[3],void 0,-1)}this.setFont(void 0,"bold");for(var T=[],E=0;E<this.internal.__cell__.tableHeaderRow.length;E+=1){x=this.internal.__cell__.tableHeaderRow[E].clone(),b&&(x.y=this.internal.__cell__.margins.top||0,T.push(x)),x.lineNumber=y;var R=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),A.call(this,x),this.setTextColor(R)}T.length>0&&this.setTableHeaderRow(T),this.setFont(void 0,"normal"),i=!1}}(Qn.API);var vI={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_I=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],h1=yI(_I),xI=[100,200,300,400,500,600,700,800,900],nU=yI(xI);function d1(a){var e=a.family.replace(/"|'/g,"").toLowerCase(),i=function(d){return vI[d=d||"normal"]?d:"normal"}(a.style),s=function(d){if(!d)return 400;if(typeof d=="number")return d>=100&&d<=900&&d%100==0?d:400;if(/^\d00$/.test(d))return parseInt(d);switch(d){case"bold":return 700;case"normal":default:return 400}}(a.weight),c=function(d){return typeof h1[d=d||"normal"]=="number"?d:"normal"}(a.stretch);return{family:e,style:i,weight:s,stretch:c,src:a.src||[],ref:a.ref||{name:e,style:[c,i,s].join(" ")}}}function _E(a,e,i,s){var c;for(c=i;c>=0&&c<e.length;c+=s)if(a[e[c]])return a[e[c]];for(c=i;c>=0&&c<e.length;c-=s)if(a[e[c]])return a[e[c]]}var sU={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},xE={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function bE(a){return[a.stretch,a.style,a.weight,a.family].join(" ")}function oU(a,e,i){for(var s=(i=i||{}).defaultFontFamily||"times",c=Object.assign({},sU,i.genericFontFamilies||{}),d=null,A=null,r=0;r<e.length;++r)if(c[(d=d1(e[r])).family]&&(d.family=c[d.family]),a.hasOwnProperty(d.family)){A=a[d.family];break}if(!(A=A||a[s]))throw new Error("Could not find a font-family for the rule '"+bE(d)+"' and default family '"+s+"'.");if(A=function(y,b){if(b[y])return b[y];var x=h1[y],B=x<=h1.normal?-1:1,T=_E(b,_I,x,B);if(!T)throw new Error("Could not find a matching font-stretch value for "+y);return T}(d.stretch,A),A=function(y,b){if(b[y])return b[y];for(var x=vI[y],B=0;B<x.length;++B)if(b[x[B]])return b[x[B]];throw new Error("Could not find a matching font-style for "+y)}(d.style,A),!(A=function(y,b){if(b[y])return b[y];if(y===400&&b[500])return b[500];if(y===500&&b[400])return b[400];var x=nU[y],B=_E(b,xI,x,y<400?-1:1);if(!B)throw new Error("Could not find a matching font-weight for value "+y);return B}(d.weight,A)))throw new Error("Failed to resolve a font for the rule '"+bE(d)+"'.");return A}function wE(a){return a.trimLeft()}function aU(a,e){for(var i=0;i<a.length;){if(a.charAt(i)===e)return[a.substring(0,i),a.substring(i+1)];i+=1}return null}function lU(a){var e=a.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],a.substring(e[0].length)]}var nv,BE,CE,yb=["times"];(function(a){var e,i,s,c,d,A,r,y,b,x=function(Ie){return Ie=Ie||{},this.isStrokeTransparent=Ie.isStrokeTransparent||!1,this.strokeOpacity=Ie.strokeOpacity||1,this.strokeStyle=Ie.strokeStyle||"#000000",this.fillStyle=Ie.fillStyle||"#000000",this.isFillTransparent=Ie.isFillTransparent||!1,this.fillOpacity=Ie.fillOpacity||1,this.font=Ie.font||"10px sans-serif",this.textBaseline=Ie.textBaseline||"alphabetic",this.textAlign=Ie.textAlign||"left",this.lineWidth=Ie.lineWidth||1,this.lineJoin=Ie.lineJoin||"miter",this.lineCap=Ie.lineCap||"butt",this.path=Ie.path||[],this.transform=Ie.transform!==void 0?Ie.transform.clone():new y,this.globalCompositeOperation=Ie.globalCompositeOperation||"normal",this.globalAlpha=Ie.globalAlpha||1,this.clip_path=Ie.clip_path||[],this.currentPoint=Ie.currentPoint||new A,this.miterLimit=Ie.miterLimit||10,this.lastPoint=Ie.lastPoint||new A,this.lineDashOffset=Ie.lineDashOffset||0,this.lineDash=Ie.lineDash||[],this.margin=Ie.margin||[0,0,0,0],this.prevPageLastElemOffset=Ie.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Ie.ignoreClearRect!="boolean"||Ie.ignoreClearRect,this};a.events.push(["initialized",function(){this.context2d=new B(this),e=this.internal.f2,i=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,c=this.internal.getHorizontalCoordinate,d=this.internal.getVerticalCoordinate,A=this.internal.Point,r=this.internal.Rectangle,y=this.internal.Matrix,b=new x}]);var B=function(Ie){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ot=Ie;Object.defineProperty(this,"pdf",{get:function(){return ot}});var ut=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ut},set:function(It){ut=!!It}});var mt=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return mt},set:function(It){mt=!!It}});var Ct=0;Object.defineProperty(this,"posX",{get:function(){return Ct},set:function(It){isNaN(It)||(Ct=It)}});var rt=0;Object.defineProperty(this,"posY",{get:function(){return rt},set:function(It){isNaN(It)||(rt=It)}}),Object.defineProperty(this,"margin",{get:function(){return b.margin},set:function(It){var Ze;typeof It=="number"?Ze=[It,It,It,It]:((Ze=new Array(4))[0]=It[0],Ze[1]=It.length>=2?It[1]:Ze[0],Ze[2]=It.length>=3?It[2]:Ze[0],Ze[3]=It.length>=4?It[3]:Ze[1]),b.margin=Ze}});var Bt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Bt},set:function(It){Bt=It}});var tt=0;Object.defineProperty(this,"lastBreak",{get:function(){return tt},set:function(It){tt=It}});var Ut=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ut},set:function(It){Ut=It}}),Object.defineProperty(this,"ctx",{get:function(){return b},set:function(It){It instanceof x&&(b=It)}}),Object.defineProperty(this,"path",{get:function(){return b.path},set:function(It){b.path=It}});var Ai=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ai},set:function(It){Ai=It}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(It){var Ze;Ze=T(It),this.ctx.fillStyle=Ze.style,this.ctx.isFillTransparent=Ze.a===0,this.ctx.fillOpacity=Ze.a,this.pdf.setFillColor(Ze.r,Ze.g,Ze.b,{a:Ze.a}),this.pdf.setTextColor(Ze.r,Ze.g,Ze.b,{a:Ze.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(It){var Ze=T(It);this.ctx.strokeStyle=Ze.style,this.ctx.isStrokeTransparent=Ze.a===0,this.ctx.strokeOpacity=Ze.a,Ze.a===0?this.pdf.setDrawColor(255,255,255):(Ze.a,this.pdf.setDrawColor(Ze.r,Ze.g,Ze.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(It){["butt","round","square"].indexOf(It)!==-1&&(this.ctx.lineCap=It,this.pdf.setLineCap(It))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(It){isNaN(It)||(this.ctx.lineWidth=It,this.pdf.setLineWidth(It))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(It){["bevel","round","miter"].indexOf(It)!==-1&&(this.ctx.lineJoin=It,this.pdf.setLineJoin(It))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(It){isNaN(It)||(this.ctx.miterLimit=It,this.pdf.setMiterLimit(It))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(It){this.ctx.textBaseline=It}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(It){["right","end","center","left","start"].indexOf(It)!==-1&&(this.ctx.textAlign=It)}});var qe=null;function Ke(It,Ze){if(qe===null){var yi=function(bi){var Kt=[];return Object.keys(bi).forEach(function(di){bi[di].forEach(function(pi){var Ri=null;switch(pi){case"bold":Ri={family:di,weight:"bold"};break;case"italic":Ri={family:di,style:"italic"};break;case"bolditalic":Ri={family:di,weight:"bold",style:"italic"};break;case"":case"normal":Ri={family:di}}Ri!==null&&(Ri.ref={name:di,style:pi},Kt.push(Ri))})}),Kt}(It.getFontList());qe=function(bi){for(var Kt={},di=0;di<bi.length;++di){var pi=d1(bi[di]),Ri=pi.family,Oi=pi.stretch,Ji=pi.style,ar=pi.weight;Kt[Ri]=Kt[Ri]||{},Kt[Ri][Oi]=Kt[Ri][Oi]||{},Kt[Ri][Oi][Ji]=Kt[Ri][Oi][Ji]||{},Kt[Ri][Oi][Ji][ar]=pi}return Kt}(yi.concat(Ze))}return qe}var Pt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Pt},set:function(It){qe=null,Pt=It}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(It){var Ze;if(this.ctx.font=It,(Ze=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(It))!==null){var yi=Ze[1];Ze[2];var bi=Ze[3],Kt=Ze[4];Ze[5];var di=Ze[6],pi=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Kt)[2];Kt=Math.floor(pi==="px"?parseFloat(Kt)*this.pdf.internal.scaleFactor:pi==="em"?parseFloat(Kt)*this.pdf.getFontSize():parseFloat(Kt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Kt);var Ri=function(Qr){var ui,li,Vi=[],rr=Qr.trim();if(rr==="")return yb;if(rr in xE)return[xE[rr]];for(;rr!=="";){switch(li=null,ui=(rr=wE(rr)).charAt(0)){case'"':case"'":li=aU(rr.substring(1),ui);break;default:li=lU(rr)}if(li===null||(Vi.push(li[0]),(rr=wE(li[1]))!==""&&rr.charAt(0)!==","))return yb;rr=rr.replace(/^,/,"")}return Vi}(di);if(this.fontFaces){var Oi=oU(Ke(this.pdf,this.fontFaces),Ri.map(function(Qr){return{family:Qr,stretch:"normal",weight:bi,style:yi}}));this.pdf.setFont(Oi.ref.name,Oi.ref.style)}else{var Ji="";(bi==="bold"||parseInt(bi,10)>=700||yi==="bold")&&(Ji="bold"),yi==="italic"&&(Ji+="italic"),Ji.length===0&&(Ji="normal");for(var ar="",br={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dr=0;Dr<Ri.length;Dr++){if(this.pdf.internal.getFont(Ri[Dr],Ji,{noFallback:!0,disableWarning:!0})!==void 0){ar=Ri[Dr];break}if(Ji==="bolditalic"&&this.pdf.internal.getFont(Ri[Dr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ar=Ri[Dr],Ji="bold";else if(this.pdf.internal.getFont(Ri[Dr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ar=Ri[Dr],Ji="normal";break}}if(ar===""){for(var Fr=0;Fr<Ri.length;Fr++)if(br[Ri[Fr]]){ar=br[Ri[Fr]];break}}ar=ar===""?"Times":ar,this.pdf.setFont(ar,Ji)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(It){this.ctx.globalCompositeOperation=It}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(It){this.ctx.globalAlpha=It}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(It){this.ctx.lineDashOffset=It,Qt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(It){this.ctx.lineDash=It,Qt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(It){this.ctx.ignoreClearRect=!!It}})};B.prototype.setLineDash=function(Ie){this.lineDash=Ie},B.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},B.prototype.fill=function(){ne.call(this,"fill",!1)},B.prototype.stroke=function(){ne.call(this,"stroke",!1)},B.prototype.beginPath=function(){this.path=[{type:"begin"}]},B.prototype.moveTo=function(Ie,ot){if(isNaN(Ie)||isNaN(ot))throw ha.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ut=this.ctx.transform.applyToPoint(new A(Ie,ot));this.path.push({type:"mt",x:ut.x,y:ut.y}),this.ctx.lastPoint=new A(Ie,ot)},B.prototype.closePath=function(){var Ie=new A(0,0),ot=0;for(ot=this.path.length-1;ot!==-1;ot--)if(this.path[ot].type==="begin"&&Go(this.path[ot+1])==="object"&&typeof this.path[ot+1].x=="number"){Ie=new A(this.path[ot+1].x,this.path[ot+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new A(Ie.x,Ie.y)},B.prototype.lineTo=function(Ie,ot){if(isNaN(Ie)||isNaN(ot))throw ha.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ut=this.ctx.transform.applyToPoint(new A(Ie,ot));this.path.push({type:"lt",x:ut.x,y:ut.y}),this.ctx.lastPoint=new A(ut.x,ut.y)},B.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),ne.call(this,null,!0)},B.prototype.quadraticCurveTo=function(Ie,ot,ut,mt){if(isNaN(ut)||isNaN(mt)||isNaN(Ie)||isNaN(ot))throw ha.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ct=this.ctx.transform.applyToPoint(new A(ut,mt)),rt=this.ctx.transform.applyToPoint(new A(Ie,ot));this.path.push({type:"qct",x1:rt.x,y1:rt.y,x:Ct.x,y:Ct.y}),this.ctx.lastPoint=new A(Ct.x,Ct.y)},B.prototype.bezierCurveTo=function(Ie,ot,ut,mt,Ct,rt){if(isNaN(Ct)||isNaN(rt)||isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt))throw ha.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Bt=this.ctx.transform.applyToPoint(new A(Ct,rt)),tt=this.ctx.transform.applyToPoint(new A(Ie,ot)),Ut=this.ctx.transform.applyToPoint(new A(ut,mt));this.path.push({type:"bct",x1:tt.x,y1:tt.y,x2:Ut.x,y2:Ut.y,x:Bt.x,y:Bt.y}),this.ctx.lastPoint=new A(Bt.x,Bt.y)},B.prototype.arc=function(Ie,ot,ut,mt,Ct,rt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt)||isNaN(Ct))throw ha.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(rt=!!rt,!this.ctx.transform.isIdentity){var Bt=this.ctx.transform.applyToPoint(new A(Ie,ot));Ie=Bt.x,ot=Bt.y;var tt=this.ctx.transform.applyToPoint(new A(0,ut)),Ut=this.ctx.transform.applyToPoint(new A(0,0));ut=Math.sqrt(Math.pow(tt.x-Ut.x,2)+Math.pow(tt.y-Ut.y,2))}Math.abs(Ct-mt)>=2*Math.PI&&(mt=0,Ct=2*Math.PI),this.path.push({type:"arc",x:Ie,y:ot,radius:ut,startAngle:mt,endAngle:Ct,counterclockwise:rt})},B.prototype.arcTo=function(Ie,ot,ut,mt,Ct){throw new Error("arcTo not implemented.")},B.prototype.rect=function(Ie,ot,ut,mt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt))throw ha.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Ie,ot),this.lineTo(Ie+ut,ot),this.lineTo(Ie+ut,ot+mt),this.lineTo(Ie,ot+mt),this.lineTo(Ie,ot),this.lineTo(Ie+ut,ot),this.lineTo(Ie,ot)},B.prototype.fillRect=function(Ie,ot,ut,mt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt))throw ha.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!E.call(this)){var Ct={};this.lineCap!=="butt"&&(Ct.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ct.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Ie,ot,ut,mt),this.fill(),Ct.hasOwnProperty("lineCap")&&(this.lineCap=Ct.lineCap),Ct.hasOwnProperty("lineJoin")&&(this.lineJoin=Ct.lineJoin)}},B.prototype.strokeRect=function(Ie,ot,ut,mt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt))throw ha.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");R.call(this)||(this.beginPath(),this.rect(Ie,ot,ut,mt),this.stroke())},B.prototype.clearRect=function(Ie,ot,ut,mt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt))throw ha.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Ie,ot,ut,mt))},B.prototype.save=function(Ie){Ie=typeof Ie!="boolean"||Ie;for(var ot=this.pdf.internal.getCurrentPageInfo().pageNumber,ut=0;ut<this.pdf.internal.getNumberOfPages();ut++)this.pdf.setPage(ut+1),this.pdf.internal.out("q");if(this.pdf.setPage(ot),Ie){this.ctx.fontSize=this.pdf.internal.getFontSize();var mt=new x(this.ctx);this.ctxStack.push(this.ctx),this.ctx=mt}},B.prototype.restore=function(Ie){Ie=typeof Ie!="boolean"||Ie;for(var ot=this.pdf.internal.getCurrentPageInfo().pageNumber,ut=0;ut<this.pdf.internal.getNumberOfPages();ut++)this.pdf.setPage(ut+1),this.pdf.internal.out("Q");this.pdf.setPage(ot),Ie&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},B.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var T=function(Ie){var ot,ut,mt,Ct;if(Ie.isCanvasGradient===!0&&(Ie=Ie.getColor()),!Ie)return{r:0,g:0,b:0,a:0,style:Ie};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Ie))ot=0,ut=0,mt=0,Ct=0;else{var rt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Ie);if(rt!==null)ot=parseInt(rt[1]),ut=parseInt(rt[2]),mt=parseInt(rt[3]),Ct=1;else if((rt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Ie))!==null)ot=parseInt(rt[1]),ut=parseInt(rt[2]),mt=parseInt(rt[3]),Ct=parseFloat(rt[4]);else{if(Ct=1,typeof Ie=="string"&&Ie.charAt(0)!=="#"){var Bt=new dI(Ie);Ie=Bt.ok?Bt.toHex():"#000000"}Ie.length===4?(ot=Ie.substring(1,2),ot+=ot,ut=Ie.substring(2,3),ut+=ut,mt=Ie.substring(3,4),mt+=mt):(ot=Ie.substring(1,3),ut=Ie.substring(3,5),mt=Ie.substring(5,7)),ot=parseInt(ot,16),ut=parseInt(ut,16),mt=parseInt(mt,16)}}return{r:ot,g:ut,b:mt,a:Ct,style:Ie}},E=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},R=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};B.prototype.fillText=function(Ie,ot,ut,mt){if(isNaN(ot)||isNaN(ut)||typeof Ie!="string")throw ha.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(mt=isNaN(mt)?void 0:mt,!E.call(this)){var Ct=Ye(this.ctx.transform.rotation),rt=this.ctx.transform.scaleX;ye.call(this,{text:Ie,x:ot,y:ut,scale:rt,angle:Ct,align:this.textAlign,maxWidth:mt})}},B.prototype.strokeText=function(Ie,ot,ut,mt){if(isNaN(ot)||isNaN(ut)||typeof Ie!="string")throw ha.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!R.call(this)){mt=isNaN(mt)?void 0:mt;var Ct=Ye(this.ctx.transform.rotation),rt=this.ctx.transform.scaleX;ye.call(this,{text:Ie,x:ot,y:ut,scale:rt,renderingMode:"stroke",angle:Ct,align:this.textAlign,maxWidth:mt})}},B.prototype.measureText=function(Ie){if(typeof Ie!="string")throw ha.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ot=this.pdf,ut=this.pdf.internal.scaleFactor,mt=ot.internal.getFontSize(),Ct=ot.getStringUnitWidth(Ie)*mt/ot.internal.scaleFactor,rt=function(Bt){var tt=(Bt=Bt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return tt}}),this};return new rt({width:Ct*=Math.round(96*ut/72*1e4)/1e4})},B.prototype.scale=function(Ie,ot){if(isNaN(Ie)||isNaN(ot))throw ha.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ut=new y(Ie,0,0,ot,0,0);this.ctx.transform=this.ctx.transform.multiply(ut)},B.prototype.rotate=function(Ie){if(isNaN(Ie))throw ha.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ot=new y(Math.cos(Ie),Math.sin(Ie),-Math.sin(Ie),Math.cos(Ie),0,0);this.ctx.transform=this.ctx.transform.multiply(ot)},B.prototype.translate=function(Ie,ot){if(isNaN(Ie)||isNaN(ot))throw ha.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ut=new y(1,0,0,1,Ie,ot);this.ctx.transform=this.ctx.transform.multiply(ut)},B.prototype.transform=function(Ie,ot,ut,mt,Ct,rt){if(isNaN(Ie)||isNaN(ot)||isNaN(ut)||isNaN(mt)||isNaN(Ct)||isNaN(rt))throw ha.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Bt=new y(Ie,ot,ut,mt,Ct,rt);this.ctx.transform=this.ctx.transform.multiply(Bt)},B.prototype.setTransform=function(Ie,ot,ut,mt,Ct,rt){Ie=isNaN(Ie)?1:Ie,ot=isNaN(ot)?0:ot,ut=isNaN(ut)?0:ut,mt=isNaN(mt)?1:mt,Ct=isNaN(Ct)?0:Ct,rt=isNaN(rt)?0:rt,this.ctx.transform=new y(Ie,ot,ut,mt,Ct,rt)};var P=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};B.prototype.drawImage=function(Ie,ot,ut,mt,Ct,rt,Bt,tt,Ut){var Ai=this.pdf.getImageProperties(Ie),qe=1,Ke=1,Pt=1,It=1;mt!==void 0&&tt!==void 0&&(Pt=tt/mt,It=Ut/Ct,qe=Ai.width/mt*tt/mt,Ke=Ai.height/Ct*Ut/Ct),rt===void 0&&(rt=ot,Bt=ut,ot=0,ut=0),mt!==void 0&&tt===void 0&&(tt=mt,Ut=Ct),mt===void 0&&tt===void 0&&(tt=Ai.width,Ut=Ai.height);for(var Ze,yi=this.ctx.transform.decompose(),bi=Ye(yi.rotate.shx),Kt=new y,di=(Kt=(Kt=(Kt=Kt.multiply(yi.translate)).multiply(yi.skew)).multiply(yi.scale)).applyToRectangle(new r(rt-ot*Pt,Bt-ut*It,mt*qe,Ct*Ke)),pi=G.call(this,di),Ri=[],Oi=0;Oi<pi.length;Oi+=1)Ri.indexOf(pi[Oi])===-1&&Ri.push(pi[Oi]);if(q(Ri),this.autoPaging)for(var Ji=Ri[0],ar=Ri[Ri.length-1],br=Ji;br<ar+1;br++){this.pdf.setPage(br);var Dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fr=br===1?this.posY+this.margin[0]:this.margin[0],Qr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ui=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],li=br===1?0:Qr+(br-2)*ui;if(this.ctx.clip_path.length!==0){var Vi=this.path;Ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(Ze,this.posX+this.margin[3],-li+Fr+this.ctx.prevPageLastElemOffset),re.call(this,"fill",!0),this.path=Vi}var rr=JSON.parse(JSON.stringify(di));rr=Q([rr],this.posX+this.margin[3],-li+Fr+this.ctx.prevPageLastElemOffset)[0];var qr=(br>Ji||br<ar)&&P.call(this);qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dr,ui,null).clip().discardPath()),this.pdf.addImage(Ie,"JPEG",rr.x,rr.y,rr.w,rr.h,null,null,bi),qr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Ie,"JPEG",di.x,di.y,di.w,di.h,null,null,bi)};var G=function(Ie,ot,ut){var mt=[];ot=ot||this.pdf.internal.pageSize.width,ut=ut||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ct=this.posY+this.ctx.prevPageLastElemOffset;switch(Ie.type){default:case"mt":case"lt":mt.push(Math.floor((Ie.y+Ct)/ut)+1);break;case"arc":mt.push(Math.floor((Ie.y+Ct-Ie.radius)/ut)+1),mt.push(Math.floor((Ie.y+Ct+Ie.radius)/ut)+1);break;case"qct":var rt=bt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ie.x1,Ie.y1,Ie.x,Ie.y);mt.push(Math.floor((rt.y+Ct)/ut)+1),mt.push(Math.floor((rt.y+rt.h+Ct)/ut)+1);break;case"bct":var Bt=pt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ie.x1,Ie.y1,Ie.x2,Ie.y2,Ie.x,Ie.y);mt.push(Math.floor((Bt.y+Ct)/ut)+1),mt.push(Math.floor((Bt.y+Bt.h+Ct)/ut)+1);break;case"rect":mt.push(Math.floor((Ie.y+Ct)/ut)+1),mt.push(Math.floor((Ie.y+Ie.h+Ct)/ut)+1)}for(var tt=0;tt<mt.length;tt+=1)for(;this.pdf.internal.getNumberOfPages()<mt[tt];)U.call(this);return mt},U=function(){var Ie=this.fillStyle,ot=this.strokeStyle,ut=this.font,mt=this.lineCap,Ct=this.lineWidth,rt=this.lineJoin;this.pdf.addPage(),this.fillStyle=Ie,this.strokeStyle=ot,this.font=ut,this.lineCap=mt,this.lineWidth=Ct,this.lineJoin=rt},Q=function(Ie,ot,ut){for(var mt=0;mt<Ie.length;mt++)switch(Ie[mt].type){case"bct":Ie[mt].x2+=ot,Ie[mt].y2+=ut;case"qct":Ie[mt].x1+=ot,Ie[mt].y1+=ut;case"mt":case"lt":case"arc":default:Ie[mt].x+=ot,Ie[mt].y+=ut}return Ie},q=function(Ie){return Ie.sort(function(ot,ut){return ot-ut})},ne=function(Ie,ot){for(var ut,mt,Ct=this.fillStyle,rt=this.strokeStyle,Bt=this.lineCap,tt=this.lineWidth,Ut=Math.abs(tt*this.ctx.transform.scaleX),Ai=this.lineJoin,qe=JSON.parse(JSON.stringify(this.path)),Ke=JSON.parse(JSON.stringify(this.path)),Pt=[],It=0;It<Ke.length;It++)if(Ke[It].x!==void 0)for(var Ze=G.call(this,Ke[It]),yi=0;yi<Ze.length;yi+=1)Pt.indexOf(Ze[yi])===-1&&Pt.push(Ze[yi]);for(var bi=0;bi<Pt.length;bi++)for(;this.pdf.internal.getNumberOfPages()<Pt[bi];)U.call(this);if(q(Pt),this.autoPaging)for(var Kt=Pt[0],di=Pt[Pt.length-1],pi=Kt;pi<di+1;pi++){this.pdf.setPage(pi),this.fillStyle=Ct,this.strokeStyle=rt,this.lineCap=Bt,this.lineWidth=Ut,this.lineJoin=Ai;var Ri=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Oi=pi===1?this.posY+this.margin[0]:this.margin[0],Ji=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ar=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],br=pi===1?0:Ji+(pi-2)*ar;if(this.ctx.clip_path.length!==0){var Dr=this.path;ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(ut,this.posX+this.margin[3],-br+Oi+this.ctx.prevPageLastElemOffset),re.call(this,Ie,!0),this.path=Dr}if(mt=JSON.parse(JSON.stringify(qe)),this.path=Q(mt,this.posX+this.margin[3],-br+Oi+this.ctx.prevPageLastElemOffset),ot===!1||pi===0){var Fr=(pi>Kt||pi<di)&&P.call(this);Fr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ri,ar,null).clip().discardPath()),re.call(this,Ie,ot),Fr&&this.pdf.restoreGraphicsState()}this.lineWidth=tt}else this.lineWidth=Ut,re.call(this,Ie,ot),this.lineWidth=tt;this.path=qe},re=function(Ie,ot){if((Ie!=="stroke"||ot||!R.call(this))&&(Ie==="stroke"||ot||!E.call(this))){for(var ut,mt,Ct=[],rt=this.path,Bt=0;Bt<rt.length;Bt++){var tt=rt[Bt];switch(tt.type){case"begin":Ct.push({begin:!0});break;case"close":Ct.push({close:!0});break;case"mt":Ct.push({start:tt,deltas:[],abs:[]});break;case"lt":var Ut=Ct.length;if(rt[Bt-1]&&!isNaN(rt[Bt-1].x)&&(ut=[tt.x-rt[Bt-1].x,tt.y-rt[Bt-1].y],Ut>0)){for(;Ut>=0;Ut--)if(Ct[Ut-1].close!==!0&&Ct[Ut-1].begin!==!0){Ct[Ut-1].deltas.push(ut),Ct[Ut-1].abs.push(tt);break}}break;case"bct":ut=[tt.x1-rt[Bt-1].x,tt.y1-rt[Bt-1].y,tt.x2-rt[Bt-1].x,tt.y2-rt[Bt-1].y,tt.x-rt[Bt-1].x,tt.y-rt[Bt-1].y],Ct[Ct.length-1].deltas.push(ut);break;case"qct":var Ai=rt[Bt-1].x+2/3*(tt.x1-rt[Bt-1].x),qe=rt[Bt-1].y+2/3*(tt.y1-rt[Bt-1].y),Ke=tt.x+2/3*(tt.x1-tt.x),Pt=tt.y+2/3*(tt.y1-tt.y),It=tt.x,Ze=tt.y;ut=[Ai-rt[Bt-1].x,qe-rt[Bt-1].y,Ke-rt[Bt-1].x,Pt-rt[Bt-1].y,It-rt[Bt-1].x,Ze-rt[Bt-1].y],Ct[Ct.length-1].deltas.push(ut);break;case"arc":Ct.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ct[Ct.length-1].abs)&&Ct[Ct.length-1].abs.push(tt)}}mt=ot?null:Ie==="stroke"?"stroke":"fill";for(var yi=!1,bi=0;bi<Ct.length;bi++)if(Ct[bi].arc)for(var Kt=Ct[bi].abs,di=0;di<Kt.length;di++){var pi=Kt[di];pi.type==="arc"?he.call(this,pi.x,pi.y,pi.radius,pi.startAngle,pi.endAngle,pi.counterclockwise,void 0,ot,!yi):Me.call(this,pi.x,pi.y),yi=!0}else if(Ct[bi].close===!0)this.pdf.internal.out("h"),yi=!1;else if(Ct[bi].begin!==!0){var Ri=Ct[bi].start.x,Oi=Ct[bi].start.y;Be.call(this,Ct[bi].deltas,Ri,Oi),yi=!0}mt&&be.call(this,mt),ot&&Se.call(this)}},pe=function(Ie){var ot=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ut=ot*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Ie-ut;case"top":return Ie+ot-ut;case"hanging":return Ie+ot-2*ut;case"middle":return Ie+ot/2-ut;case"ideographic":return Ie;case"alphabetic":default:return Ie}},fe=function(Ie){return Ie+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};B.prototype.createLinearGradient=function(){var Ie=function(){};return Ie.colorStops=[],Ie.addColorStop=function(ot,ut){this.colorStops.push([ot,ut])},Ie.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Ie.isCanvasGradient=!0,Ie},B.prototype.createPattern=function(){return this.createLinearGradient()},B.prototype.createRadialGradient=function(){return this.createLinearGradient()};var he=function(Ie,ot,ut,mt,Ct,rt,Bt,tt,Ut){for(var Ai=De.call(this,ut,mt,Ct,rt),qe=0;qe<Ai.length;qe++){var Ke=Ai[qe];qe===0&&(Ut?oe.call(this,Ke.x1+Ie,Ke.y1+ot):Me.call(this,Ke.x1+Ie,Ke.y1+ot)),Pe.call(this,Ie,ot,Ke.x2,Ke.y2,Ke.x3,Ke.y3,Ke.x4,Ke.y4)}tt?Se.call(this):be.call(this,Bt)},be=function(Ie){switch(Ie){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Se=function(){this.pdf.clip(),this.pdf.discardPath()},oe=function(Ie,ot){this.pdf.internal.out(i(Ie)+" "+s(ot)+" m")},ye=function(Ie){var ot;switch(Ie.align){case"right":case"end":ot="right";break;case"center":ot="center";break;case"left":case"start":default:ot="left"}var ut=this.pdf.getTextDimensions(Ie.text),mt=pe.call(this,Ie.y),Ct=fe.call(this,mt)-ut.h,rt=this.ctx.transform.applyToPoint(new A(Ie.x,mt)),Bt=this.ctx.transform.decompose(),tt=new y;tt=(tt=(tt=tt.multiply(Bt.translate)).multiply(Bt.skew)).multiply(Bt.scale);for(var Ut,Ai,qe,Ke=this.ctx.transform.applyToRectangle(new r(Ie.x,mt,ut.w,ut.h)),Pt=tt.applyToRectangle(new r(Ie.x,Ct,ut.w,ut.h)),It=G.call(this,Pt),Ze=[],yi=0;yi<It.length;yi+=1)Ze.indexOf(It[yi])===-1&&Ze.push(It[yi]);if(q(Ze),this.autoPaging)for(var bi=Ze[0],Kt=Ze[Ze.length-1],di=bi;di<Kt+1;di++){this.pdf.setPage(di);var pi=di===1?this.posY+this.margin[0]:this.margin[0],Ri=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Oi=this.pdf.internal.pageSize.height-this.margin[2],Ji=Oi-this.margin[0],ar=this.pdf.internal.pageSize.width-this.margin[1],br=ar-this.margin[3],Dr=di===1?0:Ri+(di-2)*Ji;if(this.ctx.clip_path.length!==0){var Fr=this.path;Ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(Ut,this.posX+this.margin[3],-1*Dr+pi),re.call(this,"fill",!0),this.path=Fr}var Qr=Q([JSON.parse(JSON.stringify(Pt))],this.posX+this.margin[3],-Dr+pi+this.ctx.prevPageLastElemOffset)[0];Ie.scale>=.01&&(Ai=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ai*Ie.scale),qe=this.lineWidth,this.lineWidth=qe*Ie.scale);var ui=this.autoPaging!=="text";if(ui||Qr.y+Qr.h<=Oi){if(ui||Qr.y>=pi&&Qr.x<=ar){var li=ui?Ie.text:this.pdf.splitTextToSize(Ie.text,Ie.maxWidth||ar-Qr.x)[0],Vi=Q([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Dr+pi+this.ctx.prevPageLastElemOffset)[0],rr=ui&&(di>bi||di<Kt)&&P.call(this);rr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],br,Ji,null).clip().discardPath()),this.pdf.text(li,Vi.x,Vi.y,{angle:Ie.angle,align:ot,renderingMode:Ie.renderingMode}),rr&&this.pdf.restoreGraphicsState()}}else Qr.y<Oi&&(this.ctx.prevPageLastElemOffset+=Oi-Qr.y);Ie.scale>=.01&&(this.pdf.setFontSize(Ai),this.lineWidth=qe)}else Ie.scale>=.01&&(Ai=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ai*Ie.scale),qe=this.lineWidth,this.lineWidth=qe*Ie.scale),this.pdf.text(Ie.text,rt.x+this.posX,rt.y+this.posY,{angle:Ie.angle,align:ot,renderingMode:Ie.renderingMode,maxWidth:Ie.maxWidth}),Ie.scale>=.01&&(this.pdf.setFontSize(Ai),this.lineWidth=qe)},Me=function(Ie,ot,ut,mt){ut=ut||0,mt=mt||0,this.pdf.internal.out(i(Ie+ut)+" "+s(ot+mt)+" l")},Be=function(Ie,ot,ut){return this.pdf.lines(Ie,ot,ut,null,null)},Pe=function(Ie,ot,ut,mt,Ct,rt,Bt,tt){this.pdf.internal.out([e(c(ut+Ie)),e(d(mt+ot)),e(c(Ct+Ie)),e(d(rt+ot)),e(c(Bt+Ie)),e(d(tt+ot)),"c"].join(" "))},De=function(Ie,ot,ut,mt){for(var Ct=2*Math.PI,rt=Math.PI/2;ot>ut;)ot-=Ct;var Bt=Math.abs(ut-ot);Bt<Ct&&mt&&(Bt=Ct-Bt);for(var tt=[],Ut=mt?-1:1,Ai=ot;Bt>1e-5;){var qe=Ai+Ut*Math.min(Bt,rt);tt.push(et.call(this,Ie,Ai,qe)),Bt-=Math.abs(qe-Ai),Ai=qe}return tt},et=function(Ie,ot,ut){var mt=(ut-ot)/2,Ct=Ie*Math.cos(mt),rt=Ie*Math.sin(mt),Bt=Ct,tt=-rt,Ut=Bt*Bt+tt*tt,Ai=Ut+Bt*Ct+tt*rt,qe=4/3*(Math.sqrt(2*Ut*Ai)-Ai)/(Bt*rt-tt*Ct),Ke=Bt-qe*tt,Pt=tt+qe*Bt,It=Ke,Ze=-Pt,yi=mt+ot,bi=Math.cos(yi),Kt=Math.sin(yi);return{x1:Ie*Math.cos(ot),y1:Ie*Math.sin(ot),x2:Ke*bi-Pt*Kt,y2:Ke*Kt+Pt*bi,x3:It*bi-Ze*Kt,y3:It*Kt+Ze*bi,x4:Ie*Math.cos(ut),y4:Ie*Math.sin(ut)}},Ye=function(Ie){return 180*Ie/Math.PI},bt=function(Ie,ot,ut,mt,Ct,rt){var Bt=Ie+.5*(ut-Ie),tt=ot+.5*(mt-ot),Ut=Ct+.5*(ut-Ct),Ai=rt+.5*(mt-rt),qe=Math.min(Ie,Ct,Bt,Ut),Ke=Math.max(Ie,Ct,Bt,Ut),Pt=Math.min(ot,rt,tt,Ai),It=Math.max(ot,rt,tt,Ai);return new r(qe,Pt,Ke-qe,It-Pt)},pt=function(Ie,ot,ut,mt,Ct,rt,Bt,tt){var Ut,Ai,qe,Ke,Pt,It,Ze,yi,bi,Kt,di,pi,Ri,Oi,Ji=ut-Ie,ar=mt-ot,br=Ct-ut,Dr=rt-mt,Fr=Bt-Ct,Qr=tt-rt;for(Ai=0;Ai<41;Ai++)bi=(Ze=(qe=Ie+(Ut=Ai/40)*Ji)+Ut*((Pt=ut+Ut*br)-qe))+Ut*(Pt+Ut*(Ct+Ut*Fr-Pt)-Ze),Kt=(yi=(Ke=ot+Ut*ar)+Ut*((It=mt+Ut*Dr)-Ke))+Ut*(It+Ut*(rt+Ut*Qr-It)-yi),Ai==0?(di=bi,pi=Kt,Ri=bi,Oi=Kt):(di=Math.min(di,bi),pi=Math.min(pi,Kt),Ri=Math.max(Ri,bi),Oi=Math.max(Oi,Kt));return new r(Math.round(di),Math.round(pi),Math.round(Ri-di),Math.round(Oi-pi))},Qt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Ie,ot,ut=(Ie=this.ctx.lineDash,ot=this.ctx.lineDashOffset,JSON.stringify({lineDash:Ie,lineDashOffset:ot}));this.prevLineDash!==ut&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ut)}}})(Qn.API),function(a){var e=function(d){var A,r,y,b,x,B,T,E,R,P;for(r=[],y=0,b=(d+=A="\0\0\0\0".slice(d.length%4||4)).length;b>y;y+=4)(x=(d.charCodeAt(y)<<24)+(d.charCodeAt(y+1)<<16)+(d.charCodeAt(y+2)<<8)+d.charCodeAt(y+3))!==0?(B=(x=((x=((x=((x=(x-(P=x%85))/85)-(R=x%85))/85)-(E=x%85))/85)-(T=x%85))/85)%85,r.push(B+33,T+33,E+33,R+33,P+33)):r.push(122);return function(G,U){for(var Q=U;Q>0;Q--)G.pop()}(r,A.length),String.fromCharCode.apply(String,r)+"~>"},i=function(d){var A,r,y,b,x,B=String,T="length",E=255,R="charCodeAt",P="slice",G="replace";for(d[P](-2),d=d[P](0,-2)[G](/\s/g,"")[G]("z","!!!!!"),y=[],b=0,x=(d+=A="uuuuu"[P](d[T]%5||5))[T];x>b;b+=5)r=52200625*(d[R](b)-33)+614125*(d[R](b+1)-33)+7225*(d[R](b+2)-33)+85*(d[R](b+3)-33)+(d[R](b+4)-33),y.push(E&r>>24,E&r>>16,E&r>>8,E&r);return function(U,Q){for(var q=Q;q>0;q--)U.pop()}(y,A[T]),B.fromCharCode.apply(B,y)},s=function(d){var A=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((d=d.replace(/\s/g,"")).indexOf(">")!==-1&&(d=d.substr(0,d.indexOf(">"))),d.length%2&&(d+="0"),A.test(d)===!1)return"";for(var r="",y=0;y<d.length;y+=2)r+=String.fromCharCode("0x"+(d[y]+d[y+1]));return r},c=function(d){for(var A=new Uint8Array(d.length),r=d.length;r--;)A[r]=d.charCodeAt(r);return d=(A=o1(A)).reduce(function(y,b){return y+String.fromCharCode(b)},"")};a.processDataByFilters=function(d,A){var r=0,y=d||"",b=[];for(typeof(A=A||[])=="string"&&(A=[A]),r=0;r<A.length;r+=1)switch(A[r]){case"ASCII85Decode":case"/ASCII85Decode":y=i(y),b.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":y=e(y),b.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":y=s(y),b.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":y=y.split("").map(function(x){return("0"+x.charCodeAt().toString(16)).slice(-2)}).join("")+">",b.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":y=c(y),b.push("/FlateDecode");break;default:throw new Error('The filter: "'+A[r]+'" is not implemented')}return{data:y,reverseChain:b.reverse().join(" ")}}}(Qn.API),function(a){a.loadFile=function(e,i,s){return function(c,d,A){d=d!==!1,A=typeof A=="function"?A:function(){};var r=void 0;try{r=function(y,b,x){var B=new XMLHttpRequest,T=0,E=function(R){var P=R.length,G=[],U=String.fromCharCode;for(T=0;T<P;T+=1)G.push(U(255&R.charCodeAt(T)));return G.join("")};if(B.open("GET",y,!b),B.overrideMimeType("text/plain; charset=x-user-defined"),b===!1&&(B.onload=function(){B.status===200?x(E(this.responseText)):x(void 0)}),B.send(null),b&&B.status===200)return E(B.responseText)}(c,d,A)}catch{}return r}(e,i,s)},a.loadImageFile=a.loadFile}(Qn.API),function(a){function e(){return(qn.html2canvas?Promise.resolve(qn.html2canvas):t1(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load html2canvas: "+A))}).then(function(A){return A.default?A.default:A})}function i(){return(qn.DOMPurify?Promise.resolve(qn.DOMPurify):t1(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load dompurify: "+A))}).then(function(A){return A.default?A.default:A})}var s=function(A){var r=Go(A);return r==="undefined"?"undefined":r==="string"||A instanceof String?"string":r==="number"||A instanceof Number?"number":r==="function"||A instanceof Function?"function":A&&A.constructor===Array?"array":A&&A.nodeType===1?"element":r==="object"?"object":"unknown"},c=function(A,r){var y=document.createElement(A);for(var b in r.className&&(y.className=r.className),r.innerHTML&&r.dompurify&&(y.innerHTML=r.dompurify.sanitize(r.innerHTML)),r.style)y.style[b]=r.style[b];return y},d=function A(r){var y=Object.assign(A.convert(Promise.resolve()),JSON.parse(JSON.stringify(A.template))),b=A.convert(Promise.resolve(),y);return b=(b=b.setProgress(1,A,1,[A])).set(r)};(d.prototype=Object.create(Promise.prototype)).constructor=d,d.convert=function(A,r){return A.__proto__=r||d.prototype,A},d.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},d.prototype.from=function(A,r){return this.then(function(){switch(r=r||function(y){switch(s(y)){case"string":return"string";case"element":return y.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(A)){case"string":return this.then(i).then(function(y){return this.set({src:c("div",{innerHTML:A,dompurify:y})})});case"element":return this.set({src:A});case"canvas":return this.set({canvas:A});case"img":return this.set({img:A});default:return this.error("Unknown source type.")}})},d.prototype.to=function(A){switch(A){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},d.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var A={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},r=function y(b,x){for(var B=b.nodeType===3?document.createTextNode(b.nodeValue):b.cloneNode(!1),T=b.firstChild;T;T=T.nextSibling)x!==!0&&T.nodeType===1&&T.nodeName==="SCRIPT"||B.appendChild(y(T,x));return b.nodeType===1&&(b.nodeName==="CANVAS"?(B.width=b.width,B.height=b.height,B.getContext("2d").drawImage(b,0,0)):b.nodeName!=="TEXTAREA"&&b.nodeName!=="SELECT"||(B.value=b.value),B.addEventListener("load",function(){B.scrollTop=b.scrollTop,B.scrollLeft=b.scrollLeft},!0)),B}(this.prop.src,this.opt.html2canvas.javascriptEnabled);r.tagName==="BODY"&&(A.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=c("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=c("div",{className:"html2pdf__container",style:A}),this.prop.container.appendChild(r),this.prop.container.firstChild.appendChild(c("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},d.prototype.toCanvas=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(r){var y=Object.assign({},this.opt.html2canvas);return delete y.onrendered,r(this.prop.container,y)}).then(function(r){(this.opt.html2canvas.onrendered||function(){})(r),this.prop.canvas=r,document.body.removeChild(this.prop.overlay)})},d.prototype.toContext2d=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(r){var y=this.opt.jsPDF,b=this.opt.fontFaces,x=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,B=Object.assign({async:!0,allowTaint:!0,scale:x,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete B.onrendered,y.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,y.context2d.posX=this.opt.x,y.context2d.posY=this.opt.y,y.context2d.margin=this.opt.margin,y.context2d.fontFaces=b,b)for(var T=0;T<b.length;++T){var E=b[T],R=E.src.find(function(P){return P.format==="truetype"});R&&y.addFont(R.url,E.ref.name,E.ref.style)}return B.windowHeight=B.windowHeight||0,B.windowHeight=B.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):B.windowHeight,y.context2d.save(!0),r(this.prop.container,B)}).then(function(r){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(r),this.prop.canvas=r,document.body.removeChild(this.prop.overlay)})},d.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var A=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=A})},d.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},d.prototype.output=function(A,r,y){return(y=y||"pdf").toLowerCase()==="img"||y.toLowerCase()==="image"?this.outputImg(A,r):this.outputPdf(A,r)},d.prototype.outputPdf=function(A,r){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(A,r)})},d.prototype.outputImg=function(A){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(A){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+A+'" is not supported.'}})},d.prototype.save=function(A){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(A?{filename:A}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},d.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},d.prototype.set=function(A){if(s(A)!=="object")return this;var r=Object.keys(A||{}).map(function(y){if(y in d.template.prop)return function(){this.prop[y]=A[y]};switch(y){case"margin":return this.setMargin.bind(this,A.margin);case"jsPDF":return function(){return this.opt.jsPDF=A.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,A.pageSize);default:return function(){this.opt[y]=A[y]}}},this);return this.then(function(){return this.thenList(r)})},d.prototype.get=function(A,r){return this.then(function(){var y=A in d.template.prop?this.prop[A]:this.opt[A];return r?r(y):y})},d.prototype.setMargin=function(A){return this.then(function(){switch(s(A)){case"number":A=[A,A,A,A];case"array":if(A.length===2&&(A=[A[0],A[1],A[0],A[1]]),A.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=A}).then(this.setPageSize)},d.prototype.setPageSize=function(A){function r(y,b){return Math.floor(y*b/72*96)}return this.then(function(){(A=A||Qn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(A.inner={width:A.width-this.opt.margin[1]-this.opt.margin[3],height:A.height-this.opt.margin[0]-this.opt.margin[2]},A.inner.px={width:r(A.inner.width,A.k),height:r(A.inner.height,A.k)},A.inner.ratio=A.inner.height/A.inner.width),this.prop.pageSize=A})},d.prototype.setProgress=function(A,r,y,b){return A!=null&&(this.progress.val=A),r!=null&&(this.progress.state=r),y!=null&&(this.progress.n=y),b!=null&&(this.progress.stack=b),this.progress.ratio=this.progress.val/this.progress.state,this},d.prototype.updateProgress=function(A,r,y,b){return this.setProgress(A?this.progress.val+A:null,r||null,y?this.progress.n+y:null,b?this.progress.stack.concat(b):null)},d.prototype.then=function(A,r){var y=this;return this.thenCore(A,r,function(b,x){return y.updateProgress(null,null,1,[b]),Promise.prototype.then.call(this,function(B){return y.updateProgress(null,b),B}).then(b,x).then(function(B){return y.updateProgress(1),B})})},d.prototype.thenCore=function(A,r,y){y=y||Promise.prototype.then,A&&(A=A.bind(this)),r&&(r=r.bind(this));var b=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:d.convert(Object.assign({},this),Promise.prototype),x=y.call(b,A,r);return d.convert(x,this.__proto__)},d.prototype.thenExternal=function(A,r){return Promise.prototype.then.call(this,A,r)},d.prototype.thenList=function(A){var r=this;return A.forEach(function(y){r=r.thenCore(y)}),r},d.prototype.catch=function(A){A&&(A=A.bind(this));var r=Promise.prototype.catch.call(this,A);return d.convert(r,this)},d.prototype.catchExternal=function(A){return Promise.prototype.catch.call(this,A)},d.prototype.error=function(A){return this.then(function(){throw new Error(A)})},d.prototype.using=d.prototype.set,d.prototype.saveAs=d.prototype.save,d.prototype.export=d.prototype.output,d.prototype.run=d.prototype.then,Qn.getPageSize=function(A,r,y){if(Go(A)==="object"){var b=A;A=b.orientation,r=b.unit||r,y=b.format||y}r=r||"mm",y=y||"a4",A=(""+(A||"P")).toLowerCase();var x,B=(""+y).toLowerCase(),T={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(r){case"pt":x=1;break;case"mm":x=72/25.4;break;case"cm":x=72/2.54;break;case"in":x=72;break;case"px":x=.75;break;case"pc":case"em":x=12;break;case"ex":x=6;break;default:throw"Invalid unit: "+r}var E,R=0,P=0;if(T.hasOwnProperty(B))R=T[B][1]/x,P=T[B][0]/x;else try{R=y[1],P=y[0]}catch{throw new Error("Invalid format: "+y)}if(A==="p"||A==="portrait")A="p",P>R&&(E=P,P=R,R=E);else{if(A!=="l"&&A!=="landscape")throw"Invalid orientation: "+A;A="l",R>P&&(E=P,P=R,R=E)}return{width:P,height:R,unit:r,k:x,orientation:A}},a.html=function(A,r){(r=r||{}).callback=r.callback||function(){},r.html2canvas=r.html2canvas||{},r.html2canvas.canvas=r.html2canvas.canvas||this.canvas,r.jsPDF=r.jsPDF||this,r.fontFaces=r.fontFaces?r.fontFaces.map(d1):null;var y=new d(r);return r.worker?y:y.from(A).doCallback()}}(Qn.API),Qn.API.addJS=function(a){return CE=a,this.internal.events.subscribe("postPutResources",function(){nv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(nv+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),BE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+CE+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){nv!==void 0&&BE!==void 0&&this.internal.out("/Names <</JavaScript "+nv+" 0 R>>")}),this},function(a){var e;a.events.push(["postPutResources",function(){var i=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var c=i.outline.render().split(/\r\n/),d=0;d<c.length;d++){var A=c[d],r=s.exec(A);if(r!=null){var y=r[1];i.internal.newObjectDeferredBegin(y,!1)}i.internal.write(A)}if(this.outline.createNamedDestinations){var b=this.internal.pages.length,x=[];for(d=0;d<b;d++){var B=i.internal.newObject();x.push(B);var T=i.internal.getPageInfo(d+1);i.internal.write("<< /D["+T.objId+" 0 R /XYZ null null null]>> endobj")}var E=i.internal.newObject();for(i.internal.write("<< /Names [ "),d=0;d<x.length;d++)i.internal.write("(page_"+(d+1)+")"+x[d]+" 0 R");i.internal.write(" ] >>","endobj"),e=i.internal.newObject(),i.internal.write("<< /Dests "+E+" 0 R"),i.internal.write(">>","endobj")}}]),a.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),a.events.push(["initialized",function(){var i=this;i.outline={createNamedDestinations:!1,root:{children:[]}},i.outline.add=function(s,c,d){var A={title:c,options:d,children:[]};return s==null&&(s=this.root),s.children.push(A),A},i.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=i,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},i.outline.genIds_r=function(s){s.id=i.internal.newObjectDeferred();for(var c=0;c<s.children.length;c++)this.genIds_r(s.children[c])},i.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},i.outline.renderItems=function(s){for(var c=this.ctx.pdf.internal.getVerticalCoordinateString,d=0;d<s.children.length;d++){var A=s.children[d];this.objStart(A),this.line("/Title "+this.makeString(A.title)),this.line("/Parent "+this.makeRef(s)),d>0&&this.line("/Prev "+this.makeRef(s.children[d-1])),d<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[d+1])),A.children.length>0&&(this.line("/First "+this.makeRef(A.children[0])),this.line("/Last "+this.makeRef(A.children[A.children.length-1])));var r=this.count=this.count_r({count:0},A);if(r>0&&this.line("/Count "+r),A.options&&A.options.pageNumber){var y=i.internal.getPageInfo(A.options.pageNumber);this.line("/Dest ["+y.objId+" 0 R /XYZ 0 "+c(0)+" 0]")}this.objEnd()}for(var b=0;b<s.children.length;b++)this.renderItems(s.children[b])},i.outline.line=function(s){this.ctx.val+=s+`\r
`},i.outline.makeRef=function(s){return s.id+" 0 R"},i.outline.makeString=function(s){return"("+i.internal.pdfEscape(s)+")"},i.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},i.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},i.outline.count_r=function(s,c){for(var d=0;d<c.children.length;d++)s.count++,this.count_r(s,c.children[d]);return s.count}}])}(Qn.API),function(a){var e=[192,193,194,195,196,197,198,199];a.processJPEG=function(i,s,c,d,A,r){var y,b=this.decode.DCT_DECODE,x=null;if(typeof i=="string"||this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i)){switch(i=A||i,i=this.__addimage__.isArrayBuffer(i)?new Uint8Array(i):i,(y=function(B){for(var T,E=256*B.charCodeAt(4)+B.charCodeAt(5),R=B.length,P={width:0,height:0,numcomponents:1},G=4;G<R;G+=2){if(G+=E,e.indexOf(B.charCodeAt(G+1))!==-1){T=256*B.charCodeAt(G+5)+B.charCodeAt(G+6),P={width:256*B.charCodeAt(G+7)+B.charCodeAt(G+8),height:T,numcomponents:B.charCodeAt(G+9)};break}E=256*B.charCodeAt(G+2)+B.charCodeAt(G+3)}return P}(i=this.__addimage__.isArrayBufferView(i)?this.__addimage__.arrayBufferToBinaryString(i):i)).numcomponents){case 1:r=this.color_spaces.DEVICE_GRAY;break;case 4:r=this.color_spaces.DEVICE_CMYK;break;case 3:r=this.color_spaces.DEVICE_RGB}x={data:i,width:y.width,height:y.height,colorSpace:r,bitsPerComponent:8,filter:b,index:s,alias:c}}return x}}(Qn.API);var Qg,sv,SE,EE,TE,cU=function(){var a,e,i;function s(d){var A,r,y,b,x,B,T,E,R,P,G,U,Q,q;for(this.data=d,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},B=null;;){switch(A=this.readUInt32(),R=(function(){var ne,re;for(re=[],ne=0;ne<4;++ne)re.push(String.fromCharCode(this.data[this.pos++]));return re}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(A);break;case"fcTL":B&&this.animation.frames.push(B),this.pos+=4,B={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},x=this.readUInt16(),b=this.readUInt16()||100,B.delay=1e3*x/b,B.disposeOp=this.data[this.pos++],B.blendOp=this.data[this.pos++],B.data=[];break;case"IDAT":case"fdAT":for(R==="fdAT"&&(this.pos+=4,A-=4),d=(B!=null?B.data:void 0)||this.imgData,U=0;0<=A?U<A:U>A;0<=A?++U:--U)d.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(y=this.palette.length/3,this.transparency.indexed=this.read(A),this.transparency.indexed.length>y)throw new Error("More transparent colors than palette size");if((P=y-this.transparency.indexed.length)>0)for(Q=0;0<=P?Q<P:Q>P;0<=P?++Q:--Q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case"tEXt":T=(G=this.read(A)).indexOf(0),E=String.fromCharCode.apply(String,G.slice(0,T)),this.text[E]=String.fromCharCode.apply(String,G.slice(T+1));break;case"IEND":return B&&this.animation.frames.push(B),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(q=this.colorType)===4||q===6,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=A}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(d){var A,r;for(r=[],A=0;0<=d?A<d:A>d;0<=d?++A:--A)r.push(this.data[this.pos++]);return r},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(d){var A=this.pixelBitlength/8,r=new Uint8Array(this.width*this.height*A),y=0,b=this;if(d==null&&(d=this.imgData),d.length===0)return new Uint8Array(0);function x(B,T,E,R){var P,G,U,Q,q,ne,re,pe,fe,he,be,Se,oe,ye,Me,Be,Pe,De,et,Ye,bt,pt=Math.ceil((b.width-B)/E),Qt=Math.ceil((b.height-T)/R),Ie=b.width==pt&&b.height==Qt;for(ye=A*pt,Se=Ie?r:new Uint8Array(ye*Qt),ne=d.length,oe=0,G=0;oe<Qt&&y<ne;){switch(d[y++]){case 0:for(Q=Pe=0;Pe<ye;Q=Pe+=1)Se[G++]=d[y++];break;case 1:for(Q=De=0;De<ye;Q=De+=1)P=d[y++],q=Q<A?0:Se[G-A],Se[G++]=(P+q)%256;break;case 2:for(Q=et=0;et<ye;Q=et+=1)P=d[y++],U=(Q-Q%A)/A,Me=oe&&Se[(oe-1)*ye+U*A+Q%A],Se[G++]=(Me+P)%256;break;case 3:for(Q=Ye=0;Ye<ye;Q=Ye+=1)P=d[y++],U=(Q-Q%A)/A,q=Q<A?0:Se[G-A],Me=oe&&Se[(oe-1)*ye+U*A+Q%A],Se[G++]=(P+Math.floor((q+Me)/2))%256;break;case 4:for(Q=bt=0;bt<ye;Q=bt+=1)P=d[y++],U=(Q-Q%A)/A,q=Q<A?0:Se[G-A],oe===0?Me=Be=0:(Me=Se[(oe-1)*ye+U*A+Q%A],Be=U&&Se[(oe-1)*ye+(U-1)*A+Q%A]),re=q+Me-Be,pe=Math.abs(re-q),he=Math.abs(re-Me),be=Math.abs(re-Be),fe=pe<=he&&pe<=be?q:he<=be?Me:Be,Se[G++]=(P+fe)%256;break;default:throw new Error("Invalid filter algorithm: "+d[y-1])}if(!Ie){var ot=((T+oe*R)*b.width+B)*A,ut=oe*ye;for(Q=0;Q<pt;Q+=1){for(var mt=0;mt<A;mt+=1)r[ot++]=Se[ut++];ot+=(E-1)*A}}oe++}}return d=NO(d),b.interlaceMethod==1?(x(0,0,8,8),x(4,0,8,8),x(0,4,4,8),x(2,0,4,4),x(0,2,2,4),x(1,0,2,2),x(0,1,1,2)):x(0,0,1,1),r},s.prototype.decodePalette=function(){var d,A,r,y,b,x,B,T,E;for(r=this.palette,x=this.transparency.indexed||[],b=new Uint8Array((x.length||0)+r.length),y=0,d=0,A=B=0,T=r.length;B<T;A=B+=3)b[y++]=r[A],b[y++]=r[A+1],b[y++]=r[A+2],b[y++]=(E=x[d++])!=null?E:255;return b},s.prototype.copyToImageData=function(d,A){var r,y,b,x,B,T,E,R,P,G,U;if(y=this.colors,P=null,r=this.hasAlphaChannel,this.palette.length&&(P=(U=this._decodedPalette)!=null?U:this._decodedPalette=this.decodePalette(),y=4,r=!0),R=(b=d.data||d).length,B=P||A,x=T=0,y===1)for(;x<R;)E=P?4*A[x/4]:T,G=B[E++],b[x++]=G,b[x++]=G,b[x++]=G,b[x++]=r?B[E++]:255,T=E;else for(;x<R;)E=P?4*A[x/4]:T,b[x++]=B[E++],b[x++]=B[E++],b[x++]=B[E++],b[x++]=r?B[E++]:255,T=E},s.prototype.decode=function(){var d;return d=new Uint8Array(this.width*this.height*4),this.copyToImageData(d,this.decodePixels()),d};var c=function(){if(Object.prototype.toString.call(qn)==="[object Window]"){try{e=qn.document.createElement("canvas"),i=e.getContext("2d")}catch{return!1}return!0}return!1};return c(),a=function(d){var A;if(c()===!0)return i.width=d.width,i.height=d.height,i.clearRect(0,0,d.width,d.height),i.putImageData(d,0,0),(A=new Image).src=e.toDataURL(),A;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(d){var A,r,y,b,x,B,T,E;if(this.animation){for(E=[],r=x=0,B=(T=this.animation.frames).length;x<B;r=++x)A=T[r],y=d.createImageData(A.width,A.height),b=this.decodePixels(new Uint8Array(A.data)),this.copyToImageData(y,b),A.imageData=y,E.push(A.image=a(y));return E}},s.prototype.renderFrame=function(d,A){var r,y,b;return r=(y=this.animation.frames)[A],b=y[A-1],A===0&&d.clearRect(0,0,this.width,this.height),(b!=null?b.disposeOp:void 0)===1?d.clearRect(b.xOffset,b.yOffset,b.width,b.height):(b!=null?b.disposeOp:void 0)===2&&d.putImageData(b.imageData,b.xOffset,b.yOffset),r.blendOp===0&&d.clearRect(r.xOffset,r.yOffset,r.width,r.height),d.drawImage(r.image,r.xOffset,r.yOffset)},s.prototype.animate=function(d){var A,r,y,b,x,B,T=this;return r=0,B=this.animation,b=B.numFrames,y=B.frames,x=B.numPlays,(A=function(){var E,R;if(E=r++%b,R=y[E],T.renderFrame(d,E),b>1&&r/b<x)return T.animation._timeout=setTimeout(A,R.delay)})()},s.prototype.stopAnimation=function(){var d;return clearTimeout((d=this.animation)!=null?d._timeout:void 0)},s.prototype.render=function(d){var A,r;return d._png&&d._png.stopAnimation(),d._png=this,d.width=this.width,d.height=this.height,A=d.getContext("2d"),this.animation?(this.decodeFrames(A),this.animate(A)):(r=A.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),A.putImageData(r,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function uU(a){var e=0;if(a[e++]!==71||a[e++]!==73||a[e++]!==70||a[e++]!==56||(a[e++]+1&253)!=56||a[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var i=a[e++]|a[e++]<<8,s=a[e++]|a[e++]<<8,c=a[e++],d=c>>7,A=1<<(7&c)+1;a[e++],a[e++];var r=null,y=null;d&&(r=e,y=A,e+=3*A);var b=!0,x=[],B=0,T=null,E=0,R=null;for(this.width=i,this.height=s;b&&e<a.length;)switch(a[e++]){case 33:switch(a[e++]){case 255:if(a[e]!==11||a[e+1]==78&&a[e+2]==69&&a[e+3]==84&&a[e+4]==83&&a[e+5]==67&&a[e+6]==65&&a[e+7]==80&&a[e+8]==69&&a[e+9]==50&&a[e+10]==46&&a[e+11]==48&&a[e+12]==3&&a[e+13]==1&&a[e+16]==0)e+=14,R=a[e++]|a[e++]<<8,e++;else for(e+=12;;){if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;case 249:if(a[e++]!==4||a[e+4]!==0)throw new Error("Invalid graphics extension block.");var P=a[e++];B=a[e++]|a[e++]<<8,T=a[e++],(1&P)==0&&(T=null),E=P>>2&7,e++;break;case 254:for(;;){if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;default:throw new Error("Unknown graphic control label: 0x"+a[e-1].toString(16))}break;case 44:var G=a[e++]|a[e++]<<8,U=a[e++]|a[e++]<<8,Q=a[e++]|a[e++]<<8,q=a[e++]|a[e++]<<8,ne=a[e++],re=ne>>6&1,pe=1<<(7&ne)+1,fe=r,he=y,be=!1;ne>>7&&(be=!0,fe=e,he=pe,e+=3*pe);var Se=e;for(e++;;){var oe;if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}x.push({x:G,y:U,width:Q,height:q,has_local_palette:be,palette_offset:fe,palette_size:he,data_offset:Se,data_length:e-Se,transparent_index:T,interlaced:!!re,delay:B,disposal:E});break;case 59:b=!1;break;default:throw new Error("Unknown gif block: 0x"+a[e-1].toString(16))}this.numFrames=function(){return x.length},this.loopCount=function(){return R},this.frameInfo=function(ye){if(ye<0||ye>=x.length)throw new Error("Frame index out of range.");return x[ye]},this.decodeAndBlitFrameBGRA=function(ye,Me){var Be=this.frameInfo(ye),Pe=Be.width*Be.height,De=new Uint8Array(Pe);IE(a,Be.data_offset,De,Pe);var et=Be.palette_offset,Ye=Be.transparent_index;Ye===null&&(Ye=256);var bt=Be.width,pt=i-bt,Qt=bt,Ie=4*(Be.y*i+Be.x),ot=4*((Be.y+Be.height)*i+Be.x),ut=Ie,mt=4*pt;Be.interlaced===!0&&(mt+=4*i*7);for(var Ct=8,rt=0,Bt=De.length;rt<Bt;++rt){var tt=De[rt];if(Qt===0&&(Qt=bt,(ut+=mt)>=ot&&(mt=4*pt+4*i*(Ct-1),ut=Ie+(bt+pt)*(Ct<<1),Ct>>=1)),tt===Ye)ut+=4;else{var Ut=a[et+3*tt],Ai=a[et+3*tt+1],qe=a[et+3*tt+2];Me[ut++]=qe,Me[ut++]=Ai,Me[ut++]=Ut,Me[ut++]=255}--Qt}},this.decodeAndBlitFrameRGBA=function(ye,Me){var Be=this.frameInfo(ye),Pe=Be.width*Be.height,De=new Uint8Array(Pe);IE(a,Be.data_offset,De,Pe);var et=Be.palette_offset,Ye=Be.transparent_index;Ye===null&&(Ye=256);var bt=Be.width,pt=i-bt,Qt=bt,Ie=4*(Be.y*i+Be.x),ot=4*((Be.y+Be.height)*i+Be.x),ut=Ie,mt=4*pt;Be.interlaced===!0&&(mt+=4*i*7);for(var Ct=8,rt=0,Bt=De.length;rt<Bt;++rt){var tt=De[rt];if(Qt===0&&(Qt=bt,(ut+=mt)>=ot&&(mt=4*pt+4*i*(Ct-1),ut=Ie+(bt+pt)*(Ct<<1),Ct>>=1)),tt===Ye)ut+=4;else{var Ut=a[et+3*tt],Ai=a[et+3*tt+1],qe=a[et+3*tt+2];Me[ut++]=Ut,Me[ut++]=Ai,Me[ut++]=qe,Me[ut++]=255}--Qt}}}function IE(a,e,i,s){for(var c=a[e++],d=1<<c,A=d+1,r=A+1,y=c+1,b=(1<<y)-1,x=0,B=0,T=0,E=a[e++],R=new Int32Array(4096),P=null;;){for(;x<16&&E!==0;)B|=a[e++]<<x,x+=8,E===1?E=a[e++]:--E;if(x<y)break;var G=B&b;if(B>>=y,x-=y,G!==d){if(G===A)break;for(var U=G<r?G:P,Q=0,q=U;q>d;)q=R[q]>>8,++Q;var ne=q;if(T+Q+(U!==G?1:0)>s)return void ha.log("Warning, gif stream longer than expected.");i[T++]=ne;var re=T+=Q;for(U!==G&&(i[T++]=ne),q=U;Q--;)q=R[q],i[--re]=255&q,q>>=8;P!==null&&r<4096&&(R[r++]=P<<8|ne,r>=b+1&&y<12&&(++y,b=b<<1|1)),P=G}else r=A+1,b=(1<<(y=c+1))-1,P=null}return T!==s&&ha.log("Warning, gif stream shorter than expected."),i}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function vb(a){var e,i,s,c,d,A=Math.floor,r=new Array(64),y=new Array(64),b=new Array(64),x=new Array(64),B=new Array(65535),T=new Array(65535),E=new Array(64),R=new Array(64),P=[],G=0,U=7,Q=new Array(64),q=new Array(64),ne=new Array(64),re=new Array(256),pe=new Array(2048),fe=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],he=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],be=[0,1,2,3,4,5,6,7,8,9,10,11],Se=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],oe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ye=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Me=[0,1,2,3,4,5,6,7,8,9,10,11],Be=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Pe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function De(Ie,ot){for(var ut=0,mt=0,Ct=new Array,rt=1;rt<=16;rt++){for(var Bt=1;Bt<=Ie[rt];Bt++)Ct[ot[mt]]=[],Ct[ot[mt]][0]=ut,Ct[ot[mt]][1]=rt,mt++,ut++;ut*=2}return Ct}function et(Ie){for(var ot=Ie[0],ut=Ie[1]-1;ut>=0;)ot&1<<ut&&(G|=1<<U),ut--,--U<0&&(G==255?(Ye(255),Ye(0)):Ye(G),U=7,G=0)}function Ye(Ie){P.push(Ie)}function bt(Ie){Ye(Ie>>8&255),Ye(255&Ie)}function pt(Ie,ot,ut,mt,Ct){for(var rt,Bt=Ct[0],tt=Ct[240],Ut=function(Kt,di){var pi,Ri,Oi,Ji,ar,br,Dr,Fr,Qr,ui,li=0;for(Qr=0;Qr<8;++Qr){pi=Kt[li],Ri=Kt[li+1],Oi=Kt[li+2],Ji=Kt[li+3],ar=Kt[li+4],br=Kt[li+5],Dr=Kt[li+6];var Vi=pi+(Fr=Kt[li+7]),rr=pi-Fr,qr=Ri+Dr,_r=Ri-Dr,Zr=Oi+br,io=Oi-br,Ur=Ji+ar,ta=Ji-ar,As=Vi+Ur,ro=Vi-Ur,zn=qr+Zr,Lr=qr-Zr;Kt[li]=As+zn,Kt[li+4]=As-zn;var yr=.707106781*(Lr+ro);Kt[li+2]=ro+yr,Kt[li+6]=ro-yr;var qt=.382683433*((As=ta+io)-(Lr=_r+rr)),Nn=.5411961*As+qt,vs=1.306562965*Lr+qt,ia=.707106781*(zn=io+_r),dn=rr+ia,St=rr-ia;Kt[li+5]=St+Nn,Kt[li+3]=St-Nn,Kt[li+1]=dn+vs,Kt[li+7]=dn-vs,li+=8}for(li=0,Qr=0;Qr<8;++Qr){pi=Kt[li],Ri=Kt[li+8],Oi=Kt[li+16],Ji=Kt[li+24],ar=Kt[li+32],br=Kt[li+40],Dr=Kt[li+48];var me=pi+(Fr=Kt[li+56]),Ce=pi-Fr,je=Ri+Dr,Je=Ri-Dr,Ge=Oi+br,vt=Oi-br,Rt=Ji+ar,_t=Ji-ar,Ot=me+Rt,ii=me-Rt,Nt=je+Ge,Fi=je-Ge;Kt[li]=Ot+Nt,Kt[li+32]=Ot-Nt;var er=.707106781*(Fi+ii);Kt[li+16]=ii+er,Kt[li+48]=ii-er;var nr=.382683433*((Ot=_t+vt)-(Fi=Je+Ce)),Sr=.5411961*Ot+nr,Mr=1.306562965*Fi+nr,jr=.707106781*(Nt=vt+Je),nn=Ce+jr,Yr=Ce-jr;Kt[li+40]=Yr+Sr,Kt[li+24]=Yr-Sr,Kt[li+8]=nn+Mr,Kt[li+56]=nn-Mr,li++}for(Qr=0;Qr<64;++Qr)ui=Kt[Qr]*di[Qr],E[Qr]=ui>0?ui+.5|0:ui-.5|0;return E}(Ie,ot),Ai=0;Ai<64;++Ai)R[fe[Ai]]=Ut[Ai];var qe=R[0]-ut;ut=R[0],qe==0?et(mt[0]):(et(mt[T[rt=32767+qe]]),et(B[rt]));for(var Ke=63;Ke>0&&R[Ke]==0;)Ke--;if(Ke==0)return et(Bt),ut;for(var Pt,It=1;It<=Ke;){for(var Ze=It;R[It]==0&&It<=Ke;)++It;var yi=It-Ze;if(yi>=16){Pt=yi>>4;for(var bi=1;bi<=Pt;++bi)et(tt);yi&=15}rt=32767+R[It],et(Ct[(yi<<4)+T[rt]]),et(B[rt]),It++}return Ke!=63&&et(Bt),ut}function Qt(Ie){Ie=Math.min(Math.max(Ie,1),100),d!=Ie&&(function(ot){for(var ut=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],mt=0;mt<64;mt++){var Ct=A((ut[mt]*ot+50)/100);Ct=Math.min(Math.max(Ct,1),255),r[fe[mt]]=Ct}for(var rt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Bt=0;Bt<64;Bt++){var tt=A((rt[Bt]*ot+50)/100);tt=Math.min(Math.max(tt,1),255),y[fe[Bt]]=tt}for(var Ut=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ai=0,qe=0;qe<8;qe++)for(var Ke=0;Ke<8;Ke++)b[Ai]=1/(r[fe[Ai]]*Ut[qe]*Ut[Ke]*8),x[Ai]=1/(y[fe[Ai]]*Ut[qe]*Ut[Ke]*8),Ai++}(Ie<50?Math.floor(5e3/Ie):Math.floor(200-2*Ie)),d=Ie)}this.encode=function(Ie,ot){ot&&Qt(ot),P=new Array,G=0,U=7,bt(65496),bt(65504),bt(16),Ye(74),Ye(70),Ye(73),Ye(70),Ye(0),Ye(1),Ye(1),Ye(0),bt(1),bt(1),Ye(0),Ye(0),function(){bt(65499),bt(132),Ye(0);for(var Ri=0;Ri<64;Ri++)Ye(r[Ri]);Ye(1);for(var Oi=0;Oi<64;Oi++)Ye(y[Oi])}(),function(Ri,Oi){bt(65472),bt(17),Ye(8),bt(Oi),bt(Ri),Ye(3),Ye(1),Ye(17),Ye(0),Ye(2),Ye(17),Ye(1),Ye(3),Ye(17),Ye(1)}(Ie.width,Ie.height),function(){bt(65476),bt(418),Ye(0);for(var Ri=0;Ri<16;Ri++)Ye(he[Ri+1]);for(var Oi=0;Oi<=11;Oi++)Ye(be[Oi]);Ye(16);for(var Ji=0;Ji<16;Ji++)Ye(Se[Ji+1]);for(var ar=0;ar<=161;ar++)Ye(oe[ar]);Ye(1);for(var br=0;br<16;br++)Ye(ye[br+1]);for(var Dr=0;Dr<=11;Dr++)Ye(Me[Dr]);Ye(17);for(var Fr=0;Fr<16;Fr++)Ye(Be[Fr+1]);for(var Qr=0;Qr<=161;Qr++)Ye(Pe[Qr])}(),bt(65498),bt(12),Ye(3),Ye(1),Ye(0),Ye(2),Ye(17),Ye(3),Ye(17),Ye(0),Ye(63),Ye(0);var ut=0,mt=0,Ct=0;G=0,U=7,this.encode.displayName="_encode_";for(var rt,Bt,tt,Ut,Ai,qe,Ke,Pt,It,Ze=Ie.data,yi=Ie.width,bi=Ie.height,Kt=4*yi,di=0;di<bi;){for(rt=0;rt<Kt;){for(Ai=Kt*di+rt,Ke=-1,Pt=0,It=0;It<64;It++)qe=Ai+(Pt=It>>3)*Kt+(Ke=4*(7&It)),di+Pt>=bi&&(qe-=Kt*(di+1+Pt-bi)),rt+Ke>=Kt&&(qe-=rt+Ke-Kt+4),Bt=Ze[qe++],tt=Ze[qe++],Ut=Ze[qe++],Q[It]=(pe[Bt]+pe[tt+256>>0]+pe[Ut+512>>0]>>16)-128,q[It]=(pe[Bt+768>>0]+pe[tt+1024>>0]+pe[Ut+1280>>0]>>16)-128,ne[It]=(pe[Bt+1280>>0]+pe[tt+1536>>0]+pe[Ut+1792>>0]>>16)-128;ut=pt(Q,b,ut,e,s),mt=pt(q,x,mt,i,c),Ct=pt(ne,x,Ct,i,c),rt+=32}di+=8}if(U>=0){var pi=[];pi[1]=U+1,pi[0]=(1<<U+1)-1,et(pi)}return bt(65497),new Uint8Array(P)},a=a||50,function(){for(var Ie=String.fromCharCode,ot=0;ot<256;ot++)re[ot]=Ie(ot)}(),e=De(he,be),i=De(ye,Me),s=De(Se,oe),c=De(Be,Pe),function(){for(var Ie=1,ot=2,ut=1;ut<=15;ut++){for(var mt=Ie;mt<ot;mt++)T[32767+mt]=ut,B[32767+mt]=[],B[32767+mt][1]=ut,B[32767+mt][0]=mt;for(var Ct=-(ot-1);Ct<=-Ie;Ct++)T[32767+Ct]=ut,B[32767+Ct]=[],B[32767+Ct][1]=ut,B[32767+Ct][0]=ot-1+Ct;Ie<<=1,ot<<=1}}(),function(){for(var Ie=0;Ie<256;Ie++)pe[Ie]=19595*Ie,pe[Ie+256>>0]=38470*Ie,pe[Ie+512>>0]=7471*Ie+32768,pe[Ie+768>>0]=-11059*Ie,pe[Ie+1024>>0]=-21709*Ie,pe[Ie+1280>>0]=32768*Ie+8421375,pe[Ie+1536>>0]=-27439*Ie,pe[Ie+1792>>0]=-5329*Ie}(),Qt(a)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function jd(a,e){if(this.pos=0,this.buffer=a,this.datav=new DataView(a.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function FE(a){function e(he){if(!he)throw Error("assert :P")}function i(he,be,Se){for(var oe=0;4>oe;oe++)if(he[be+oe]!=Se.charCodeAt(oe))return!0;return!1}function s(he,be,Se,oe,ye){for(var Me=0;Me<ye;Me++)he[be+Me]=Se[oe+Me]}function c(he,be,Se,oe){for(var ye=0;ye<oe;ye++)he[be+ye]=Se}function d(he){return new Int32Array(he)}function A(he,be){for(var Se=[],oe=0;oe<he;oe++)Se.push(new be);return Se}function r(he,be){var Se=[];return function oe(ye,Me,Be){for(var Pe=Be[Me],De=0;De<Pe&&(ye.push(Be.length>Me+1?[]:new be),!(Be.length<Me+1));De++)oe(ye[De],Me+1,Be)}(Se,0,he),Se}var y=function(){var he=this;function be(D,K){for(var se=1<<K-1>>>0;D&se;)se>>>=1;return se?(D&se-1)+se:D}function Se(D,K,se,xe,Oe){e(!(xe%se));do D[K+(xe-=se)]=Oe;while(0<xe)}function oe(D,K,se,xe,Oe){if(e(2328>=Oe),512>=Oe)var We=d(512);else if((We=d(Oe))==null)return 0;return function($e,nt,ct,xt,Xt,xi){var Bi,ci,Hi=nt,Ni=1<<ct,Zt=d(16),ei=d(16);for(e(Xt!=0),e(xt!=null),e($e!=null),e(0<ct),ci=0;ci<Xt;++ci){if(15<xt[ci])return 0;++Zt[xt[ci]]}if(Zt[0]==Xt)return 0;for(ei[1]=0,Bi=1;15>Bi;++Bi){if(Zt[Bi]>1<<Bi)return 0;ei[Bi+1]=ei[Bi]+Zt[Bi]}for(ci=0;ci<Xt;++ci)Bi=xt[ci],0<xt[ci]&&(xi[ei[Bi]++]=ci);if(ei[15]==1)return(xt=new ye).g=0,xt.value=xi[0],Se($e,Hi,1,Ni,xt),Ni;var qi,lr=-1,$i=Ni-1,Xr=0,Ir=1,bn=1,zr=1<<ct;for(ci=0,Bi=1,Xt=2;Bi<=ct;++Bi,Xt<<=1){if(Ir+=bn<<=1,0>(bn-=Zt[Bi]))return 0;for(;0<Zt[Bi];--Zt[Bi])(xt=new ye).g=Bi,xt.value=xi[ci++],Se($e,Hi+Xr,Xt,zr,xt),Xr=be(Xr,Bi)}for(Bi=ct+1,Xt=2;15>=Bi;++Bi,Xt<<=1){if(Ir+=bn<<=1,0>(bn-=Zt[Bi]))return 0;for(;0<Zt[Bi];--Zt[Bi]){if(xt=new ye,(Xr&$i)!=lr){for(Hi+=zr,qi=1<<(lr=Bi)-ct;15>lr&&!(0>=(qi-=Zt[lr]));)++lr,qi<<=1;Ni+=zr=1<<(qi=lr-ct),$e[nt+(lr=Xr&$i)].g=qi+ct,$e[nt+lr].value=Hi-nt-lr}xt.g=Bi-ct,xt.value=xi[ci++],Se($e,Hi+(Xr>>ct),Xt,zr,xt),Xr=be(Xr,Bi)}}return Ir!=2*ei[15]-1?0:Ni}(D,K,se,xe,Oe,We)}function ye(){this.value=this.g=0}function Me(){this.value=this.g=0}function Be(){this.G=A(5,ye),this.H=d(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=A(Xo,Me)}function Pe(D,K,se,xe){e(D!=null),e(K!=null),e(2147483648>xe),D.Ca=254,D.I=0,D.b=-8,D.Ka=0,D.oa=K,D.pa=se,D.Jd=K,D.Yc=se+xe,D.Zc=4<=xe?se+xe-4+1:se,rt(D)}function De(D,K){for(var se=0;0<K--;)se|=tt(D,128)<<K;return se}function et(D,K){var se=De(D,K);return Bt(D)?-se:se}function Ye(D,K,se,xe){var Oe,We=0;for(e(D!=null),e(K!=null),e(4294967288>xe),D.Sb=xe,D.Ra=0,D.u=0,D.h=0,4<xe&&(xe=4),Oe=0;Oe<xe;++Oe)We+=K[se+Oe]<<8*Oe;D.Ra=We,D.bb=xe,D.oa=K,D.pa=se}function bt(D){for(;8<=D.u&&D.bb<D.Sb;)D.Ra>>>=8,D.Ra+=D.oa[D.pa+D.bb]<<xc-8>>>0,++D.bb,D.u-=8;ut(D)&&(D.h=1,D.u=0)}function pt(D,K){if(e(0<=K),!D.h&&K<=Yo){var se=ot(D)&Jn[K];return D.u+=K,bt(D),se}return D.h=1,D.u=0}function Qt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ie(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ot(D){return D.Ra>>>(D.u&xc-1)>>>0}function ut(D){return e(D.bb<=D.Sb),D.h||D.bb==D.Sb&&D.u>xc}function mt(D,K){D.u=K,D.h=ut(D)}function Ct(D){D.u>=So&&(e(D.u>=So),bt(D))}function rt(D){e(D!=null&&D.oa!=null),D.pa<D.Zc?(D.I=(D.oa[D.pa++]|D.I<<8)>>>0,D.b+=8):(e(D!=null&&D.oa!=null),D.pa<D.Yc?(D.b+=8,D.I=D.oa[D.pa++]|D.I<<8):D.Ka?D.b=0:(D.I<<=8,D.b+=8,D.Ka=1))}function Bt(D){return De(D,1)}function tt(D,K){var se=D.Ca;0>D.b&&rt(D);var xe=D.b,Oe=se*K>>>8,We=(D.I>>>xe>Oe)+0;for(We?(se-=Oe,D.I-=Oe+1<<xe>>>0):se=Oe+1,xe=se,Oe=0;256<=xe;)Oe+=8,xe>>=8;return xe=7^Oe+Oa[xe],D.b-=xe,D.Ca=(se<<xe)-1,We}function Ut(D,K,se){D[K+0]=se>>24&255,D[K+1]=se>>16&255,D[K+2]=se>>8&255,D[K+3]=se>>0&255}function Ai(D,K){return D[K+0]<<0|D[K+1]<<8}function qe(D,K){return Ai(D,K)|D[K+2]<<16}function Ke(D,K){return Ai(D,K)|Ai(D,K+2)<<16}function Pt(D,K){var se=1<<K;return e(D!=null),e(0<K),D.X=d(se),D.X==null?0:(D.Mb=32-K,D.Xa=K,1)}function It(D,K){e(D!=null),e(K!=null),e(D.Xa==K.Xa),s(K.X,0,D.X,0,1<<K.Xa)}function Ze(){this.X=[],this.Xa=this.Mb=0}function yi(D,K,se,xe){e(se!=null),e(xe!=null);var Oe=se[0],We=xe[0];return Oe==0&&(Oe=(D*We+K/2)/K),We==0&&(We=(K*Oe+D/2)/D),0>=Oe||0>=We?0:(se[0]=Oe,xe[0]=We,1)}function bi(D,K){return D+(1<<K)-1>>>K}function Kt(D,K){return((4278255360&D)+(4278255360&K)>>>0&4278255360)+((16711935&D)+(16711935&K)>>>0&16711935)>>>0}function di(D,K){he[K]=function(se,xe,Oe,We,$e,nt,ct){var xt;for(xt=0;xt<$e;++xt){var Xt=he[D](nt[ct+xt-1],Oe,We+xt);nt[ct+xt]=Kt(se[xe+xt],Xt)}}}function pi(){this.ud=this.hd=this.jd=0}function Ri(D,K){return((4278124286&(D^K))>>>1)+(D&K)>>>0}function Oi(D){return 0<=D&&256>D?D:0>D?0:255<D?255:void 0}function Ji(D,K){return Oi(D+(D-K+.5>>1))}function ar(D,K,se){return Math.abs(K-se)-Math.abs(D-se)}function br(D,K,se,xe,Oe,We,$e){for(xe=We[$e-1],se=0;se<Oe;++se)We[$e+se]=xe=Kt(D[K+se],xe)}function Dr(D,K,se,xe,Oe){var We;for(We=0;We<se;++We){var $e=D[K+We],nt=$e>>8&255,ct=16711935&(ct=(ct=16711935&$e)+((nt<<16)+nt));xe[Oe+We]=(4278255360&$e)+ct>>>0}}function Fr(D,K){K.jd=D>>0&255,K.hd=D>>8&255,K.ud=D>>16&255}function Qr(D,K,se,xe,Oe,We){var $e;for($e=0;$e<xe;++$e){var nt=K[se+$e],ct=nt>>>8,xt=nt,Xt=255&(Xt=(Xt=nt>>>16)+((D.jd<<24>>24)*(ct<<24>>24)>>>5));xt=255&(xt=(xt=xt+((D.hd<<24>>24)*(ct<<24>>24)>>>5))+((D.ud<<24>>24)*(Xt<<24>>24)>>>5)),Oe[We+$e]=(4278255360&nt)+(Xt<<16)+xt}}function ui(D,K,se,xe,Oe){he[K]=function(We,$e,nt,ct,xt,Xt,xi,Bi,ci){for(ct=xi;ct<Bi;++ct)for(xi=0;xi<ci;++xi)xt[Xt++]=Oe(nt[xe(We[$e++])])},he[D]=function(We,$e,nt,ct,xt,Xt,xi){var Bi=8>>We.b,ci=We.Ea,Hi=We.K[0],Ni=We.w;if(8>Bi)for(We=(1<<We.b)-1,Ni=(1<<Bi)-1;$e<nt;++$e){var Zt,ei=0;for(Zt=0;Zt<ci;++Zt)Zt&We||(ei=xe(ct[xt++])),Xt[xi++]=Oe(Hi[ei&Ni]),ei>>=Bi}else he["VP8LMapColor"+se](ct,xt,Hi,Ni,Xt,xi,$e,nt,ci)}}function li(D,K,se,xe,Oe){for(se=K+se;K<se;){var We=D[K++];xe[Oe++]=We>>16&255,xe[Oe++]=We>>8&255,xe[Oe++]=We>>0&255}}function Vi(D,K,se,xe,Oe){for(se=K+se;K<se;){var We=D[K++];xe[Oe++]=We>>16&255,xe[Oe++]=We>>8&255,xe[Oe++]=We>>0&255,xe[Oe++]=We>>24&255}}function rr(D,K,se,xe,Oe){for(se=K+se;K<se;){var We=($e=D[K++])>>16&240|$e>>12&15,$e=$e>>0&240|$e>>28&15;xe[Oe++]=We,xe[Oe++]=$e}}function qr(D,K,se,xe,Oe){for(se=K+se;K<se;){var We=($e=D[K++])>>16&248|$e>>13&7,$e=$e>>5&224|$e>>3&31;xe[Oe++]=We,xe[Oe++]=$e}}function _r(D,K,se,xe,Oe){for(se=K+se;K<se;){var We=D[K++];xe[Oe++]=We>>0&255,xe[Oe++]=We>>8&255,xe[Oe++]=We>>16&255}}function Zr(D,K,se,xe,Oe,We){if(We==0)for(se=K+se;K<se;)Ut(xe,((We=D[K++])[0]>>24|We[1]>>8&65280|We[2]<<8&16711680|We[3]<<24)>>>0),Oe+=32;else s(xe,Oe,D,K,se)}function io(D,K){he[K][0]=he[D+"0"],he[K][1]=he[D+"1"],he[K][2]=he[D+"2"],he[K][3]=he[D+"3"],he[K][4]=he[D+"4"],he[K][5]=he[D+"5"],he[K][6]=he[D+"6"],he[K][7]=he[D+"7"],he[K][8]=he[D+"8"],he[K][9]=he[D+"9"],he[K][10]=he[D+"10"],he[K][11]=he[D+"11"],he[K][12]=he[D+"12"],he[K][13]=he[D+"13"],he[K][14]=he[D+"0"],he[K][15]=he[D+"0"]}function Ur(D){return D==XA||D==YA||D==tA||D==mh}function ta(){this.eb=[],this.size=this.A=this.fb=0}function As(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ro(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ta,this.f.kb=new As,this.sd=null}function zn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function yr(D){return alert("todo:WebPSamplerProcessPlane"),D.T}function qt(D,K){var se=D.T,xe=K.ba.f.RGBA,Oe=xe.eb,We=xe.fb+D.ka*xe.A,$e=Ba[K.ba.S],nt=D.y,ct=D.O,xt=D.f,Xt=D.N,xi=D.ea,Bi=D.W,ci=K.cc,Hi=K.dc,Ni=K.Mc,Zt=K.Nc,ei=D.ka,qi=D.ka+D.T,lr=D.U,$i=lr+1>>1;for(ei==0?$e(nt,ct,null,null,xt,Xt,xi,Bi,xt,Xt,xi,Bi,Oe,We,null,null,lr):($e(K.ec,K.fc,nt,ct,ci,Hi,Ni,Zt,xt,Xt,xi,Bi,Oe,We-xe.A,Oe,We,lr),++se);ei+2<qi;ei+=2)ci=xt,Hi=Xt,Ni=xi,Zt=Bi,Xt+=D.Rc,Bi+=D.Rc,We+=2*xe.A,$e(nt,(ct+=2*D.fa)-D.fa,nt,ct,ci,Hi,Ni,Zt,xt,Xt,xi,Bi,Oe,We-xe.A,Oe,We,lr);return ct+=D.fa,D.j+qi<D.o?(s(K.ec,K.fc,nt,ct,lr),s(K.cc,K.dc,xt,Xt,$i),s(K.Mc,K.Nc,xi,Bi,$i),se--):1&qi||$e(nt,ct,null,null,xt,Xt,xi,Bi,xt,Xt,xi,Bi,Oe,We+xe.A,null,null,lr),se}function Nn(D,K,se){var xe=D.F,Oe=[D.J];if(xe!=null){var We=D.U,$e=K.ba.S,nt=$e==cd||$e==tA;K=K.ba.f.RGBA;var ct=[0],xt=D.ka;ct[0]=D.T,D.Kb&&(xt==0?--ct[0]:(--xt,Oe[0]-=D.width),D.j+D.ka+D.T==D.o&&(ct[0]=D.o-D.j-xt));var Xt=K.eb;xt=K.fb+xt*K.A,D=no(xe,Oe[0],D.width,We,ct,Xt,xt+(nt?0:3),K.A),e(se==ct),D&&Ur($e)&&el(Xt,xt,nt,We,ct,K.A)}return 0}function vs(D){var K=D.ma,se=K.ba.S,xe=11>se,Oe=se==ph||se==Ss||se==cd||se==zu||se==12||Ur(se);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!vo(K.Oa,D,Oe?11:12))return 0;if(Oe&&Ur(se)&&mr(),D.da)alert("todo:use_scaling");else{if(xe){if(K.Ib=yr,D.Kb){if(se=D.U+1>>1,K.memory=d(D.U+2*se),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+D.U,K.Mc=K.cc,K.Nc=K.dc+se,K.Ib=qt,mr()}}else alert("todo:EmitYUV");Oe&&(K.Jb=Nn,xe&&hi())}if(xe&&!Hu){for(D=0;256>D;++D)Rf[D]=89858*(D-128)+Xh>>Cc,dd[D]=-22014*(D-128)+Xh,uA[D]=-45773*(D-128),Hl[D]=113618*(D-128)+Xh>>Cc;for(D=Yc;D<$A;++D)K=76283*(D-16)+Xh>>Cc,hA[D-Yc]=ji(K,255),ZA[D-Yc]=ji(K+8>>4,15);Hu=1}return 1}function ia(D){var K=D.ma,se=D.U,xe=D.T;return e(!(1&D.ka)),0>=se||0>=xe?0:(se=K.Ib(D,K),K.Jb!=null&&K.Jb(D,K,se),K.Dc+=se,1)}function dn(D){D.ma.memory=null}function St(D,K,se,xe){return pt(D,8)!=47?0:(K[0]=pt(D,14)+1,se[0]=pt(D,14)+1,xe[0]=pt(D,1),pt(D,3)!=0?0:!D.h)}function me(D,K){if(4>D)return D+1;var se=D-2>>1;return(2+(1&D)<<se)+pt(K,se)+1}function Ce(D,K){return 120<K?K-120:1<=(se=((se=rA[K-1])>>4)*D+(8-(15&se)))?se:1;var se}function je(D,K,se){var xe=ot(se),Oe=D[K+=255&xe].g-8;return 0<Oe&&(mt(se,se.u+8),xe=ot(se),K+=D[K].value,K+=xe&(1<<Oe)-1),mt(se,se.u+D[K].g),D[K].value}function Je(D,K,se){return se.g+=D.g,se.value+=D.value<<K>>>0,e(8>=se.g),D.g}function Ge(D,K,se){var xe=D.xc;return e((K=xe==0?0:D.vc[D.md*(se>>xe)+(K>>xe)])<D.Wb),D.Ya[K]}function vt(D,K,se,xe){var Oe=D.ab,We=D.c*K,$e=D.C;K=$e+K;var nt=se,ct=xe;for(xe=D.Ta,se=D.Ua;0<Oe--;){var xt=D.gc[Oe],Xt=$e,xi=K,Bi=nt,ci=ct,Hi=(ct=xe,nt=se,xt.Ea);switch(e(Xt<xi),e(xi<=xt.nc),xt.hc){case 2:yu(Bi,ci,(xi-Xt)*Hi,ct,nt);break;case 0:var Ni=Xt,Zt=xi,ei=ct,qi=nt,lr=(zr=xt).Ea;Ni==0&&(al(Bi,ci,null,null,1,ei,qi),br(Bi,ci+1,0,0,lr-1,ei,qi+1),ci+=lr,qi+=lr,++Ni);for(var $i=1<<zr.b,Xr=$i-1,Ir=bi(lr,zr.b),bn=zr.K,zr=zr.w+(Ni>>zr.b)*Ir;Ni<Zt;){var Fs=bn,Qs=zr,Ls=1;for(Ko(Bi,ci,ei,qi-lr,1,ei,qi);Ls<lr;){var dr=(Ls&~Xr)+$i;dr>lr&&(dr=lr),(0,sa[Fs[Qs++]>>8&15])(Bi,ci+ +Ls,ei,qi+Ls-lr,dr-Ls,ei,qi+Ls),Ls=dr}ci+=lr,qi+=lr,++Ni&Xr||(zr+=Ir)}xi!=xt.nc&&s(ct,nt-Hi,ct,nt+(xi-Xt-1)*Hi,Hi);break;case 1:for(Hi=Bi,Zt=ci,lr=(Bi=xt.Ea)-(qi=Bi&~(ei=(ci=1<<xt.b)-1)),Ni=bi(Bi,xt.b),$i=xt.K,xt=xt.w+(Xt>>xt.b)*Ni;Xt<xi;){for(Xr=$i,Ir=xt,bn=new pi,zr=Zt+qi,Fs=Zt+Bi;Zt<zr;)Fr(Xr[Ir++],bn),Dl(bn,Hi,Zt,ci,ct,nt),Zt+=ci,nt+=ci;Zt<Fs&&(Fr(Xr[Ir++],bn),Dl(bn,Hi,Zt,lr,ct,nt),Zt+=lr,nt+=lr),++Xt&ei||(xt+=Ni)}break;case 3:if(Bi==ct&&ci==nt&&0<xt.b){for(Zt=ct,Bi=Hi=nt+(xi-Xt)*Hi-(qi=(xi-Xt)*bi(xt.Ea,xt.b)),ci=ct,ei=nt,Ni=[],qi=(lr=qi)-1;0<=qi;--qi)Ni[qi]=ci[ei+qi];for(qi=lr-1;0<=qi;--qi)Zt[Bi+qi]=Ni[qi];No(xt,Xt,xi,ct,Hi,ct,nt)}else No(xt,Xt,xi,Bi,ci,ct,nt)}nt=xe,ct=se}ct!=se&&s(xe,se,nt,ct,We)}function Rt(D,K){var se=D.V,xe=D.Ba+D.c*D.C,Oe=K-D.C;if(e(K<=D.l.o),e(16>=Oe),0<Oe){var We=D.l,$e=D.Ta,nt=D.Ua,ct=We.width;if(vt(D,Oe,se,xe),Oe=nt=[nt],e((se=D.C)<(xe=K)),e(We.v<We.va),xe>We.o&&(xe=We.o),se<We.j){var xt=We.j-se;se=We.j,Oe[0]+=xt*ct}if(se>=xe?se=0:(Oe[0]+=4*We.v,We.ka=se-We.j,We.U=We.va-We.v,We.T=xe-se,se=1),se){if(nt=nt[0],11>(se=D.ca).S){var Xt=se.f.RGBA,xi=(xe=se.S,Oe=We.U,We=We.T,xt=Xt.eb,Xt.A),Bi=We;for(Xt=Xt.fb+D.Ma*Xt.A;0<Bi--;){var ci=$e,Hi=nt,Ni=Oe,Zt=xt,ei=Xt;switch(xe){case eA:Za(ci,Hi,Ni,Zt,ei);break;case ph:ga(ci,Hi,Ni,Zt,ei);break;case XA:ga(ci,Hi,Ni,Zt,ei),el(Zt,ei,0,Ni,1,0);break;case gh:Ol(ci,Hi,Ni,Zt,ei);break;case Ss:Zr(ci,Hi,Ni,Zt,ei,1);break;case YA:Zr(ci,Hi,Ni,Zt,ei,1),el(Zt,ei,0,Ni,1,0);break;case cd:Zr(ci,Hi,Ni,Zt,ei,0);break;case tA:Zr(ci,Hi,Ni,Zt,ei,0),el(Zt,ei,1,Ni,1,0);break;case zu:bc(ci,Hi,Ni,Zt,ei);break;case mh:bc(ci,Hi,Ni,Zt,ei),wi(Zt,ei,Ni,1,0);break;case Ef:Ua(ci,Hi,Ni,Zt,ei);break;default:e(0)}nt+=ct,Xt+=xi}D.Ma+=We}else alert("todo:EmitRescaledRowsYUVA");e(D.Ma<=se.height)}}D.C=K,e(D.C<=D.i)}function _t(D){var K;if(0<D.ua)return 0;for(K=0;K<D.Wb;++K){var se=D.Ya[K].G,xe=D.Ya[K].H;if(0<se[1][xe[1]+0].g||0<se[2][xe[2]+0].g||0<se[3][xe[3]+0].g)return 0}return 1}function Ot(D,K,se,xe,Oe,We){if(D.Z!=0){var $e=D.qd,nt=D.rd;for(e(Xc[D.Z]!=null);K<se;++K)Xc[D.Z]($e,nt,xe,Oe,xe,Oe,We),$e=xe,nt=Oe,Oe+=We;D.qd=$e,D.rd=nt}}function ii(D,K){var se=D.l.ma,xe=se.Z==0||se.Z==1?D.l.j:D.C;if(xe=D.C<xe?xe:D.C,e(K<=D.l.o),K>xe){var Oe=D.l.width,We=se.ca,$e=se.tb+Oe*xe,nt=D.V,ct=D.Ba+D.c*xe,xt=D.gc;e(D.ab==1),e(xt[0].hc==3),Ia(xt[0],xe,K,nt,ct,We,$e),Ot(se,xe,K,We,$e,Oe)}D.C=D.Ma=K}function Nt(D,K,se,xe,Oe,We,$e){var nt=D.$/xe,ct=D.$%xe,xt=D.m,Xt=D.s,xi=se+D.$,Bi=xi;Oe=se+xe*Oe;var ci=se+xe*We,Hi=280+Xt.ua,Ni=D.Pb?nt:16777216,Zt=0<Xt.ua?Xt.Wa:null,ei=Xt.wc,qi=xi<ci?Ge(Xt,ct,nt):null;e(D.C<We),e(ci<=Oe);var lr=!1;e:for(;;){for(;lr||xi<ci;){var $i=0;if(nt>=Ni){var Xr=xi-se;e((Ni=D).Pb),Ni.wd=Ni.m,Ni.xd=Xr,0<Ni.s.ua&&It(Ni.s.Wa,Ni.s.vb),Ni=nt+yh}if(ct&ei||(qi=Ge(Xt,ct,nt)),e(qi!=null),qi.Qb&&(K[xi]=qi.qb,lr=!0),!lr)if(Ct(xt),qi.jc){$i=xt,Xr=K;var Ir=xi,bn=qi.pd[ot($i)&Xo-1];e(qi.jc),256>bn.g?(mt($i,$i.u+bn.g),Xr[Ir]=bn.value,$i=0):(mt($i,$i.u+bn.g-256),e(256<=bn.value),$i=bn.value),$i==0&&(lr=!0)}else $i=je(qi.G[0],qi.H[0],xt);if(xt.h)break;if(lr||256>$i){if(!lr)if(qi.nd)K[xi]=(qi.qb|$i<<8)>>>0;else{if(Ct(xt),lr=je(qi.G[1],qi.H[1],xt),Ct(xt),Xr=je(qi.G[2],qi.H[2],xt),Ir=je(qi.G[3],qi.H[3],xt),xt.h)break;K[xi]=(Ir<<24|lr<<16|$i<<8|Xr)>>>0}if(lr=!1,++xi,++ct>=xe&&(ct=0,++nt,$e!=null&&nt<=We&&!(nt%16)&&$e(D,nt),Zt!=null))for(;Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i}else if(280>$i){if($i=me($i-256,xt),Xr=je(qi.G[4],qi.H[4],xt),Ct(xt),Xr=Ce(xe,Xr=me(Xr,xt)),xt.h)break;if(xi-se<Xr||Oe-xi<$i)break e;for(Ir=0;Ir<$i;++Ir)K[xi+Ir]=K[xi+Ir-Xr];for(xi+=$i,ct+=$i;ct>=xe;)ct-=xe,++nt,$e!=null&&nt<=We&&!(nt%16)&&$e(D,nt);if(e(xi<=Oe),ct&ei&&(qi=Ge(Xt,ct,nt)),Zt!=null)for(;Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i}else{if(!($i<Hi))break e;for(lr=$i-280,e(Zt!=null);Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i;$i=xi,e(!(lr>>>(Xr=Zt).Xa)),K[$i]=Xr.X[lr],lr=!0}lr||e(xt.h==ut(xt))}if(D.Pb&&xt.h&&xi<Oe)e(D.m.h),D.a=5,D.m=D.wd,D.$=D.xd,0<D.s.ua&&It(D.s.vb,D.s.Wa);else{if(xt.h)break e;$e!=null&&$e(D,nt>We?We:nt),D.a=0,D.$=xi-se}return 1}return D.a=3,0}function Fi(D){e(D!=null),D.vc=null,D.yc=null,D.Ya=null;var K=D.Wa;K!=null&&(K.X=null),D.vb=null,e(D!=null)}function er(){var D=new Ou;return D==null?null:(D.a=0,D.xb=qA,io("Predictor","VP8LPredictors"),io("Predictor","VP8LPredictors_C"),io("PredictorAdd","VP8LPredictorsAdd"),io("PredictorAdd","VP8LPredictorsAdd_C"),yu=Dr,Dl=Qr,Za=li,ga=Vi,bc=rr,Ua=qr,Ol=_r,he.VP8LMapColor32b=Rl,he.VP8LMapColor8b=_o,D)}function nr(D,K,se,xe,Oe){var We=1,$e=[D],nt=[K],ct=xe.m,xt=xe.s,Xt=null,xi=0;e:for(;;){if(se)for(;We&&pt(ct,1);){var Bi=$e,ci=nt,Hi=xe,Ni=1,Zt=Hi.m,ei=Hi.gc[Hi.ab],qi=pt(Zt,2);if(Hi.Oc&1<<qi)We=0;else{switch(Hi.Oc|=1<<qi,ei.hc=qi,ei.Ea=Bi[0],ei.nc=ci[0],ei.K=[null],++Hi.ab,e(4>=Hi.ab),qi){case 0:case 1:ei.b=pt(Zt,3)+2,Ni=nr(bi(ei.Ea,ei.b),bi(ei.nc,ei.b),0,Hi,ei.K),ei.K=ei.K[0];break;case 3:var lr,$i=pt(Zt,8)+1,Xr=16<$i?0:4<$i?1:2<$i?2:3;if(Bi[0]=bi(ei.Ea,Xr),ei.b=Xr,lr=Ni=nr($i,1,0,Hi,ei.K)){var Ir,bn=$i,zr=ei,Fs=1<<(8>>zr.b),Qs=d(Fs);if(Qs==null)lr=0;else{var Ls=zr.K[0],dr=zr.w;for(Qs[0]=zr.K[0][0],Ir=1;Ir<1*bn;++Ir)Qs[Ir]=Kt(Ls[dr+Ir],Qs[Ir-1]);for(;Ir<4*Fs;++Ir)Qs[Ir]=0;zr.K[0]=null,zr.K[0]=Qs,lr=1}}Ni=lr;break;case 2:break;default:e(0)}We=Ni}}if($e=$e[0],nt=nt[0],We&&pt(ct,1)&&!(We=1<=(xi=pt(ct,4))&&11>=xi)){xe.a=3;break e}var gs;if(gs=We)t:{var lo,Vn,qs,Cl=xe,bo=$e,oa=nt,as=xi,Na=se,ja=Cl.m,Ca=Cl.s,co=[null],$o=1,Ha=0,sc=KA[as];i:for(;;){if(Na&&pt(ja,1)){var aa=pt(ja,3)+2,Qa=bi(bo,aa),Va=bi(oa,aa),Zi=Qa*Va;if(!nr(Qa,Va,0,Cl,co))break i;for(co=co[0],Ca.xc=aa,lo=0;lo<Zi;++lo){var Bu=co[lo]>>8&65535;co[lo]=Bu,Bu>=$o&&($o=Bu+1)}}if(ja.h)break i;for(Vn=0;5>Vn;++Vn){var Ho=Tf[Vn];!Vn&&0<as&&(Ho+=1<<as),Ha<Ho&&(Ha=Ho)}var Kc=A($o*sc,ye),Cu=$o,Br=A(Cu,Be);if(Br==null)var Qu=null;else e(65536>=Cu),Qu=Br;var fd=d(Ha);if(Qu==null||fd==null||Kc==null){Cl.a=1;break i}var pd=Kc;for(lo=qs=0;lo<$o;++lo){var Ql=Qu[lo],bh=Ql.G,Yh=Ql.H,fA=0,pA=1,gd=0;for(Vn=0;5>Vn;++Vn){Ho=Tf[Vn],bh[Vn]=pd,Yh[Vn]=qs,!Vn&&0<as&&(Ho+=1<<as);n:{var Ga,wh=Ho,la=Cl,Sl=fd,Vu=pd,gA=qs,Bh=0,cl=la.m,mA=pt(cl,1);if(c(Sl,0,0,wh),mA){var qc=pt(cl,1)+1,Xn=pt(cl,1),Ch=pt(cl,Xn==0?1:8);Sl[Ch]=1,qc==2&&(Sl[Ch=pt(cl,8)]=1);var oc=1}else{var md=d(19),JA=pt(cl,4)+4;if(19<JA){la.a=3;var yd=0;break n}for(Ga=0;Ga<JA;++Ga)md[Vh[Ga]]=pt(cl,3);var ef=void 0,ca=void 0,$c=la,Ei=md,Gi=wh,Gu=Sl,Us=0,Ft=$c.m,ac=8,vd=A(128,ye);r:for(;oe(vd,0,7,Ei,19);){if(pt(Ft,1)){var yA=2+2*pt(Ft,3);if((ef=2+pt(Ft,yA))>Gi)break r}else ef=Gi;for(ca=0;ca<Gi&&ef--;){Ct(Ft);var vA=vd[0+(127&ot(Ft))];mt(Ft,Ft.u+vA.g);var Wu=vA.value;if(16>Wu)Gu[ca++]=Wu,Wu!=0&&(ac=Wu);else{var Df=Wu==16,Su=Wu-16,Of=iA[Su],Ma=pt(Ft,Ep[Su])+Of;if(ca+Ma>Gi)break r;for(var Kh=Df?ac:0;0<Ma--;)Gu[ca++]=Kh}}Us=1;break r}Us||($c.a=3),oc=Us}(oc=oc&&!cl.h)&&(Bh=oe(Vu,gA,8,Sl,wh)),oc&&Bh!=0?yd=Bh:(la.a=3,yd=0)}if(yd==0)break i;if(pA&&If[Vn]==1&&(pA=pd[qs].g==0),fA+=pd[qs].g,qs+=yd,3>=Vn){var Xu,_d=fd[0];for(Xu=1;Xu<Ho;++Xu)fd[Xu]>_d&&(_d=fd[Xu]);gd+=_d}}if(Ql.nd=pA,Ql.Qb=0,pA&&(Ql.qb=(bh[3][Yh[3]+0].value<<24|bh[1][Yh[1]+0].value<<16|bh[2][Yh[2]+0].value)>>>0,fA==0&&256>bh[0][Yh[0]+0].value&&(Ql.Qb=1,Ql.qb+=bh[0][Yh[0]+0].value<<8)),Ql.jc=!Ql.Qb&&6>gd,Ql.jc){var Sh,lc=Ql;for(Sh=0;Sh<Xo;++Sh){var Sc=Sh,cc=lc.pd[Sc],Zc=lc.G[0][lc.H[0]+Sc];256<=Zc.value?(cc.g=Zc.g+256,cc.value=Zc.value):(cc.g=0,cc.value=0,Sc>>=Je(Zc,8,cc),Sc>>=Je(lc.G[1][lc.H[1]+Sc],16,cc),Sc>>=Je(lc.G[2][lc.H[2]+Sc],0,cc),Je(lc.G[3][lc.H[3]+Sc],24,cc))}}}Ca.vc=co,Ca.Wb=$o,Ca.Ya=Qu,Ca.yc=Kc,gs=1;break t}gs=0}if(!(We=gs)){xe.a=3;break e}if(0<xi){if(xt.ua=1<<xi,!Pt(xt.Wa,xi)){xe.a=1,We=0;break e}}else xt.ua=0;var xd=xe,Eu=$e,Wa=nt,tf=xd.s,Eh=tf.xc;if(xd.c=Eu,xd.i=Wa,tf.md=bi(Eu,Eh),tf.wc=Eh==0?-1:(1<<Eh)-1,se){xe.xb=Mf;break e}if((Xt=d($e*nt))==null){xe.a=1,We=0;break e}We=(We=Nt(xe,Xt,0,$e,nt,nt,null))&&!ct.h;break e}return We?(Oe!=null?Oe[0]=Xt:(e(Xt==null),e(se)),xe.$=0,se||Fi(xt)):Fi(xt),We}function Sr(D,K){var se=D.c*D.i,xe=se+K+16*K;return e(D.c<=K),D.V=d(xe),D.V==null?(D.Ta=null,D.Ua=0,D.a=1,0):(D.Ta=D.V,D.Ua=D.Ba+se+K,1)}function Mr(D,K){var se=D.C,xe=K-se,Oe=D.V,We=D.Ba+D.c*se;for(e(K<=D.l.o);0<xe;){var $e=16<xe?16:xe,nt=D.l.ma,ct=D.l.width,xt=ct*$e,Xt=nt.ca,xi=nt.tb+ct*se,Bi=D.Ta,ci=D.Ua;vt(D,$e,Oe,We),xo(Bi,ci,Xt,xi,xt),Ot(nt,se,se+$e,Xt,xi,ct),xe-=$e,Oe+=$e*D.c,se+=$e}e(se==K),D.C=D.Ma=K}function jr(){this.ub=this.yd=this.td=this.Rb=0}function nn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Yr(){this.Fb=this.Bb=this.Cb=0,this.Zb=d(4),this.Lb=d(4)}function Wn(){this.Yb=function(){var D=[];return function K(se,xe,Oe){for(var We=Oe[xe],$e=0;$e<We&&(se.push(Oe.length>xe+1?[]:0),!(Oe.length<xe+1));$e++)K(se[$e],xe+1,Oe)}(D,0,[3,11]),D}()}function fs(){this.jb=d(3),this.Wc=r([4,8],Wn),this.Xc=r([4,17],Wn)}function ps(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new d(4),this.od=new d(4)}function Sn(){this.ld=this.La=this.dd=this.tc=0}function En(){this.Na=this.la=0}function Is(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function _s(){this.ad=d(384),this.Za=0,this.Ob=d(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function cs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sn),this.Y=0,this.ya=Array(new _s),this.aa=0,this.l=new Bo}function Oo(){this.y=d(16),this.f=d(8),this.ea=d(8)}function Ra(){this.cb=this.a=0,this.sc="",this.m=new Qt,this.Od=new jr,this.Kc=new nn,this.ed=new ps,this.Qa=new Yr,this.Ic=this.$c=this.Aa=0,this.D=new cs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=A(8,Qt),this.ia=0,this.pb=A(4,Is),this.Pa=new fs,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Oo),this.Hd=0,this.rb=Array(new En),this.sb=0,this.wa=Array(new Sn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new _s),this.L=this.aa=0,this.gd=r([4,2],Sn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Bo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function fc(){var D=new Ra;return D!=null&&(D.a=0,D.sc="OK",D.cb=0,D.Xb=0,ju||(ju=gc)),D}function us(D,K,se){return D.a==0&&(D.a=K,D.sc=se,D.cb=0),0}function pc(D,K,se){return 3<=se&&D[K+0]==157&&D[K+1]==1&&D[K+2]==42}function lh(D,K){if(D==null)return 0;if(D.a=0,D.sc="OK",K==null)return us(D,2,"null VP8Io passed to VP8GetHeaders()");var se=K.data,xe=K.w,Oe=K.ha;if(4>Oe)return us(D,7,"Truncated header.");var We=se[xe+0]|se[xe+1]<<8|se[xe+2]<<16,$e=D.Od;if($e.Rb=!(1&We),$e.td=We>>1&7,$e.yd=We>>4&1,$e.ub=We>>5,3<$e.td)return us(D,3,"Incorrect keyframe parameters.");if(!$e.yd)return us(D,4,"Frame not displayable.");xe+=3,Oe-=3;var nt=D.Kc;if($e.Rb){if(7>Oe)return us(D,7,"cannot parse picture header");if(!pc(se,xe,Oe))return us(D,3,"Bad code word");nt.c=16383&(se[xe+4]<<8|se[xe+3]),nt.Td=se[xe+4]>>6,nt.i=16383&(se[xe+6]<<8|se[xe+5]),nt.Ud=se[xe+6]>>6,xe+=7,Oe-=7,D.za=nt.c+15>>4,D.Ub=nt.i+15>>4,K.width=nt.c,K.height=nt.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,c((We=D.Pa).jb,0,255,We.jb.length),e((We=D.Qa)!=null),We.Cb=0,We.Bb=0,We.Fb=1,c(We.Zb,0,0,We.Zb.length),c(We.Lb,0,0,We.Lb)}if($e.ub>Oe)return us(D,7,"bad partition length");Pe(We=D.m,se,xe,$e.ub),xe+=$e.ub,Oe-=$e.ub,$e.Rb&&(nt.Ld=Bt(We),nt.Kd=Bt(We)),nt=D.Qa;var ct,xt=D.Pa;if(e(We!=null),e(nt!=null),nt.Cb=Bt(We),nt.Cb){if(nt.Bb=Bt(We),Bt(We)){for(nt.Fb=Bt(We),ct=0;4>ct;++ct)nt.Zb[ct]=Bt(We)?et(We,7):0;for(ct=0;4>ct;++ct)nt.Lb[ct]=Bt(We)?et(We,6):0}if(nt.Bb)for(ct=0;3>ct;++ct)xt.jb[ct]=Bt(We)?De(We,8):255}else nt.Bb=0;if(We.Ka)return us(D,3,"cannot parse segment header");if((nt=D.ed).zd=Bt(We),nt.Tb=De(We,6),nt.wb=De(We,3),nt.Pc=Bt(We),nt.Pc&&Bt(We)){for(xt=0;4>xt;++xt)Bt(We)&&(nt.vd[xt]=et(We,6));for(xt=0;4>xt;++xt)Bt(We)&&(nt.od[xt]=et(We,6))}if(D.L=nt.Tb==0?0:nt.zd?1:2,We.Ka)return us(D,3,"cannot parse filter header");var Xt=Oe;if(Oe=ct=xe,xe=ct+Xt,nt=Xt,D.Xb=(1<<De(D.m,2))-1,Xt<3*(xt=D.Xb))se=7;else{for(ct+=3*xt,nt-=3*xt,Xt=0;Xt<xt;++Xt){var xi=se[Oe+0]|se[Oe+1]<<8|se[Oe+2]<<16;xi>nt&&(xi=nt),Pe(D.Jc[+Xt],se,ct,xi),ct+=xi,nt-=xi,Oe+=3}Pe(D.Jc[+xt],se,ct,nt),se=ct<xe?0:5}if(se!=0)return us(D,se,"cannot parse partitions");for(se=De(ct=D.m,7),Oe=Bt(ct)?et(ct,4):0,xe=Bt(ct)?et(ct,4):0,nt=Bt(ct)?et(ct,4):0,xt=Bt(ct)?et(ct,4):0,ct=Bt(ct)?et(ct,4):0,Xt=D.Qa,xi=0;4>xi;++xi){if(Xt.Cb){var Bi=Xt.Zb[xi];Xt.Fb||(Bi+=se)}else{if(0<xi){D.pb[xi]=D.pb[0];continue}Bi=se}var ci=D.pb[xi];ci.Sc[0]=Nu[ji(Bi+Oe,127)],ci.Sc[1]=wu[ji(Bi+0,127)],ci.Eb[0]=2*Nu[ji(Bi+xe,127)],ci.Eb[1]=101581*wu[ji(Bi+nt,127)]>>16,8>ci.Eb[1]&&(ci.Eb[1]=8),ci.Qc[0]=Nu[ji(Bi+xt,117)],ci.Qc[1]=wu[ji(Bi+ct,127)],ci.lc=Bi+ct}if(!$e.Rb)return us(D,4,"Not a key frame.");for(Bt(We),$e=D.Pa,se=0;4>se;++se){for(Oe=0;8>Oe;++Oe)for(xe=0;3>xe;++xe)for(nt=0;11>nt;++nt)xt=tt(We,sA[se][Oe][xe][nt])?De(We,8):Lf[se][Oe][xe][nt],$e.Wc[se][Oe].Yb[xe][nt]=xt;for(Oe=0;17>Oe;++Oe)$e.Xc[se][Oe]=$e.Wc[se][oA[Oe]]}return D.kc=Bt(We),D.kc&&(D.Bd=De(We,8)),D.cb=1}function gc(D,K,se,xe,Oe,We,$e){var nt=K[Oe].Yb[se];for(se=0;16>Oe;++Oe){if(!tt(D,nt[se+0]))return Oe;for(;!tt(D,nt[se+1]);)if(nt=K[++Oe].Yb[0],se=0,Oe==16)return 16;var ct=K[Oe+1].Yb;if(tt(D,nt[se+2])){var xt=D,Xt=0;if(tt(xt,(Bi=nt)[(xi=se)+3]))if(tt(xt,Bi[xi+6])){for(nt=0,xi=2*(Xt=tt(xt,Bi[xi+8]))+(Bi=tt(xt,Bi[xi+9+Xt])),Xt=0,Bi=Gh[xi];Bi[nt];++nt)Xt+=Xt+tt(xt,Bi[nt]);Xt+=3+(8<<xi)}else tt(xt,Bi[xi+7])?(Xt=7+2*tt(xt,165),Xt+=tt(xt,145)):Xt=5+tt(xt,159);else Xt=tt(xt,Bi[xi+4])?3+tt(xt,Bi[xi+5]):2;nt=ct[2]}else Xt=1,nt=ct[1];ct=$e+Ff[Oe],0>(xt=D).b&&rt(xt);var xi,Bi=xt.b,ci=(xi=xt.Ca>>1)-(xt.I>>Bi)>>31;--xt.b,xt.Ca+=ci,xt.Ca|=1,xt.I-=(xi+1&ci)<<Bi,We[ct]=((Xt^ci)-ci)*xe[(0<Oe)+0]}return 16}function ql(D){var K=D.rb[D.sb-1];K.la=0,K.Na=0,c(D.zc,0,0,D.zc.length),D.ja=0}function zc(D,K){if(D==null)return 0;if(K==null)return us(D,2,"NULL VP8Io parameter in VP8Decode().");if(!D.cb&&!lh(D,K))return 0;if(e(D.cb),K.ac==null||K.ac(K)){K.ob&&(D.L=0);var se=_h[D.L];if(D.L==2?(D.yb=0,D.zb=0):(D.yb=K.v-se>>4,D.zb=K.j-se>>4,0>D.yb&&(D.yb=0),0>D.zb&&(D.zb=0)),D.Va=K.o+15+se>>4,D.Hb=K.va+15+se>>4,D.Hb>D.za&&(D.Hb=D.za),D.Va>D.Ub&&(D.Va=D.Ub),0<D.L){var xe=D.ed;for(se=0;4>se;++se){var Oe;if(D.Qa.Cb){var We=D.Qa.Lb[se];D.Qa.Fb||(We+=xe.Tb)}else We=xe.Tb;for(Oe=0;1>=Oe;++Oe){var $e=D.gd[se][Oe],nt=We;if(xe.Pc&&(nt+=xe.vd[0],Oe&&(nt+=xe.od[0])),0<(nt=0>nt?0:63<nt?63:nt)){var ct=nt;0<xe.wb&&(ct=4<xe.wb?ct>>2:ct>>1)>9-xe.wb&&(ct=9-xe.wb),1>ct&&(ct=1),$e.dd=ct,$e.tc=2*nt+ct,$e.ld=40<=nt?2:15<=nt?1:0}else $e.tc=0;$e.La=Oe}}}se=0}else us(D,6,"Frame setup failed"),se=D.a;if(se=se==0){if(se){D.$c=0,0<D.Aa||(D.Ic=xh);e:{se=D.Ic,xe=4*(ct=D.za);var xt=32*ct,Xt=ct+1,xi=0<D.L?ct*(0<D.Aa?2:1):0,Bi=(D.Aa==2?2:1)*ct;if(($e=xe+832+(Oe=3*(16*se+_h[D.L])/2*xt)+(We=D.Fa!=null&&0<D.Fa.length?D.Kc.c*D.Kc.i:0))!=$e)se=0;else{if($e>D.Vb){if(D.Vb=0,D.Ec=d($e),D.Fc=0,D.Ec==null){se=us(D,1,"no memory during frame initialization.");break e}D.Vb=$e}$e=D.Ec,nt=D.Fc,D.Ac=$e,D.Bc=nt,nt+=xe,D.Gd=A(xt,Oo),D.Hd=0,D.rb=A(Xt+1,En),D.sb=1,D.wa=xi?A(xi,Sn):null,D.Y=0,D.D.Nb=0,D.D.wa=D.wa,D.D.Y=D.Y,0<D.Aa&&(D.D.Y+=ct),e(!0),D.oc=$e,D.pc=nt,nt+=832,D.ya=A(Bi,_s),D.aa=0,D.D.ya=D.ya,D.D.aa=D.aa,D.Aa==2&&(D.D.aa+=ct),D.R=16*ct,D.B=8*ct,ct=(xt=_h[D.L])*D.R,xt=xt/2*D.B,D.sa=$e,D.ta=nt+ct,D.qa=D.sa,D.ra=D.ta+16*se*D.R+xt,D.Ha=D.qa,D.Ia=D.ra+8*se*D.B+xt,D.$c=0,nt+=Oe,D.mb=We?$e:null,D.nb=We?nt:null,e(nt+We<=D.Fc+D.Vb),ql(D),c(D.Ac,D.Bc,0,xe),se=1}}if(se){if(K.ka=0,K.y=D.sa,K.O=D.ta,K.f=D.qa,K.N=D.ra,K.ea=D.Ha,K.Vd=D.Ia,K.fa=D.R,K.Rc=D.B,K.F=null,K.J=0,!fh){for(se=-255;255>=se;++se)fo[255+se]=0>se?-se:se;for(se=-1020;1020>=se;++se)jl[1020+se]=-128>se?-128:127<se?127:se;for(se=-112;112>=se;++se)bu[112+se]=-16>se?-16:15<se?15:se;for(se=-255;510>=se;++se)za[255+se]=0>se?0:255<se?255:se;fh=1}bl=yc,Gc=sl,wl=ol,Fa=mc,Ul=gl,qo=pl,vu=Pl,Ja=xl,Uu=Hh,jo=mu,wc=Un,zl=zo,_u=Er,rc=Ah,Nl=Jl,Bc=ec,xu=tc,Eo=gu,Bl[0]=pn,Bl[1]=Zl,Bl[2]=Jd,Bl[3]=uh,Bl[4]=hh,Bl[5]=jc,Bl[6]=du,Bl[7]=yl,Bl[8]=Hc,Bl[9]=Du,Wc[0]=Po,Wc[1]=cu,Wc[2]=ml,Wc[3]=uu,Wc[4]=Wo,Wc[5]=ch,Wc[6]=hu,tl[0]=vl,tl[1]=Ru,tl[2]=vc,tl[3]=dh,tl[4]=qa,tl[5]=ld,tl[6]=fu,se=1}else se=0}se&&(se=function(ci,Hi){for(ci.M=0;ci.M<ci.Va;++ci.M){var Ni,Zt=ci.Jc[ci.M&ci.Xb],ei=ci.m,qi=ci;for(Ni=0;Ni<qi.za;++Ni){var lr=ei,$i=qi,Xr=$i.Ac,Ir=$i.Bc+4*Ni,bn=$i.zc,zr=$i.ya[$i.aa+Ni];if($i.Qa.Bb?zr.$b=tt(lr,$i.Pa.jb[0])?2+tt(lr,$i.Pa.jb[2]):tt(lr,$i.Pa.jb[1]):zr.$b=0,$i.kc&&(zr.Ad=tt(lr,$i.Bd)),zr.Za=!tt(lr,145)+0,zr.Za){var Fs=zr.Ob,Qs=0;for($i=0;4>$i;++$i){var Ls,dr=bn[0+$i];for(Ls=0;4>Ls;++Ls){dr=Wh[Xr[Ir+Ls]][dr];for(var gs=nA[tt(lr,dr[0])];0<gs;)gs=nA[2*gs+tt(lr,dr[gs])];dr=-gs,Xr[Ir+Ls]=dr}s(Fs,Qs,Xr,Ir,4),Qs+=4,bn[0+$i]=dr}}else dr=tt(lr,156)?tt(lr,128)?1:3:tt(lr,163)?2:0,zr.Ob[0]=dr,c(Xr,Ir,dr,4),c(bn,0,dr,4);zr.Dd=tt(lr,142)?tt(lr,114)?tt(lr,183)?1:3:2:0}if(qi.m.Ka)return us(ci,7,"Premature end-of-partition0 encountered.");for(;ci.ja<ci.za;++ci.ja){if(qi=Zt,lr=(ei=ci).rb[ei.sb-1],Xr=ei.rb[ei.sb+ei.ja],Ni=ei.ya[ei.aa+ei.ja],Ir=ei.kc?Ni.Ad:0)lr.la=Xr.la=0,Ni.Za||(lr.Na=Xr.Na=0),Ni.Hc=0,Ni.Gc=0,Ni.ia=0;else{var lo,Vn;if(lr=Xr,Xr=qi,Ir=ei.Pa.Xc,bn=ei.ya[ei.aa+ei.ja],zr=ei.pb[bn.$b],$i=bn.ad,Fs=0,Qs=ei.rb[ei.sb-1],dr=Ls=0,c($i,Fs,0,384),bn.Za)var qs=0,Cl=Ir[3];else{gs=d(16);var bo=lr.Na+Qs.Na;if(bo=ju(Xr,Ir[1],bo,zr.Eb,0,gs,0),lr.Na=Qs.Na=(0<bo)+0,1<bo)bl(gs,0,$i,Fs);else{var oa=gs[0]+3>>3;for(gs=0;256>gs;gs+=16)$i[Fs+gs]=oa}qs=1,Cl=Ir[0]}var as=15&lr.la,Na=15&Qs.la;for(gs=0;4>gs;++gs){var ja=1&Na;for(oa=Vn=0;4>oa;++oa)as=as>>1|(ja=(bo=ju(Xr,Cl,bo=ja+(1&as),zr.Sc,qs,$i,Fs))>qs)<<7,Vn=Vn<<2|(3<bo?3:1<bo?2:$i[Fs+0]!=0),Fs+=16;as>>=4,Na=Na>>1|ja<<7,Ls=(Ls<<8|Vn)>>>0}for(Cl=as,qs=Na>>4,lo=0;4>lo;lo+=2){for(Vn=0,as=lr.la>>4+lo,Na=Qs.la>>4+lo,gs=0;2>gs;++gs){for(ja=1&Na,oa=0;2>oa;++oa)bo=ja+(1&as),as=as>>1|(ja=0<(bo=ju(Xr,Ir[2],bo,zr.Qc,0,$i,Fs)))<<3,Vn=Vn<<2|(3<bo?3:1<bo?2:$i[Fs+0]!=0),Fs+=16;as>>=2,Na=Na>>1|ja<<5}dr|=Vn<<4*lo,Cl|=as<<4<<lo,qs|=(240&Na)<<lo}lr.la=Cl,Qs.la=qs,bn.Hc=Ls,bn.Gc=dr,bn.ia=43690&dr?0:zr.ia,Ir=!(Ls|dr)}if(0<ei.L&&(ei.wa[ei.Y+ei.ja]=ei.gd[Ni.$b][Ni.Za],ei.wa[ei.Y+ei.ja].La|=!Ir),qi.Ka)return us(ci,7,"Premature end-of-file encountered.")}if(ql(ci),ei=Hi,qi=1,Ni=(Zt=ci).D,lr=0<Zt.L&&Zt.M>=Zt.zb&&Zt.M<=Zt.Va,Zt.Aa==0)e:{if(Ni.M=Zt.M,Ni.uc=lr,ao(Zt,Ni),qi=1,Ni=(Vn=Zt.D).Nb,lr=(dr=_h[Zt.L])*Zt.R,Xr=dr/2*Zt.B,gs=16*Ni*Zt.R,oa=8*Ni*Zt.B,Ir=Zt.sa,bn=Zt.ta-lr+gs,zr=Zt.qa,$i=Zt.ra-Xr+oa,Fs=Zt.Ha,Qs=Zt.Ia-Xr+oa,Na=(as=Vn.M)==0,Ls=as>=Zt.Va-1,Zt.Aa==2&&ao(Zt,Vn),Vn.uc)for(ja=(bo=Zt).D.M,e(bo.D.uc),Vn=bo.yb;Vn<bo.Hb;++Vn){qs=Vn,Cl=ja;var Ca=(co=(Ho=bo).D).Nb;lo=Ho.R;var co=co.wa[co.Y+qs],$o=Ho.sa,Ha=Ho.ta+16*Ca*lo+16*qs,sc=co.dd,aa=co.tc;if(aa!=0)if(e(3<=aa),Ho.L==1)0<qs&&Bc($o,Ha,lo,aa+4),co.La&&Eo($o,Ha,lo,aa),0<Cl&&Nl($o,Ha,lo,aa+4),co.La&&xu($o,Ha,lo,aa);else{var Qa=Ho.B,Va=Ho.qa,Zi=Ho.ra+8*Ca*Qa+8*qs,Bu=Ho.Ha,Ho=Ho.Ia+8*Ca*Qa+8*qs;Ca=co.ld,0<qs&&(Ja($o,Ha,lo,aa+4,sc,Ca),jo(Va,Zi,Bu,Ho,Qa,aa+4,sc,Ca)),co.La&&(zl($o,Ha,lo,aa,sc,Ca),rc(Va,Zi,Bu,Ho,Qa,aa,sc,Ca)),0<Cl&&(vu($o,Ha,lo,aa+4,sc,Ca),Uu(Va,Zi,Bu,Ho,Qa,aa+4,sc,Ca)),co.La&&(wc($o,Ha,lo,aa,sc,Ca),_u(Va,Zi,Bu,Ho,Qa,aa,sc,Ca))}}if(Zt.ia&&alert("todo:DitherRow"),ei.put!=null){if(Vn=16*as,as=16*(as+1),Na?(ei.y=Zt.sa,ei.O=Zt.ta+gs,ei.f=Zt.qa,ei.N=Zt.ra+oa,ei.ea=Zt.Ha,ei.W=Zt.Ia+oa):(Vn-=dr,ei.y=Ir,ei.O=bn,ei.f=zr,ei.N=$i,ei.ea=Fs,ei.W=Qs),Ls||(as-=dr),as>ei.o&&(as=ei.o),ei.F=null,ei.J=null,Zt.Fa!=null&&0<Zt.Fa.length&&Vn<as&&(ei.J=kl(Zt,ei,Vn,as-Vn),ei.F=Zt.mb,ei.F==null&&ei.F.length==0)){qi=us(Zt,3,"Could not decode alpha data.");break e}Vn<ei.j&&(dr=ei.j-Vn,Vn=ei.j,e(!(1&dr)),ei.O+=Zt.R*dr,ei.N+=Zt.B*(dr>>1),ei.W+=Zt.B*(dr>>1),ei.F!=null&&(ei.J+=ei.width*dr)),Vn<as&&(ei.O+=ei.v,ei.N+=ei.v>>1,ei.W+=ei.v>>1,ei.F!=null&&(ei.J+=ei.v),ei.ka=Vn-ei.j,ei.U=ei.va-ei.v,ei.T=as-Vn,qi=ei.put(ei))}Ni+1!=Zt.Ic||Ls||(s(Zt.sa,Zt.ta-lr,Ir,bn+16*Zt.R,lr),s(Zt.qa,Zt.ra-Xr,zr,$i+8*Zt.B,Xr),s(Zt.Ha,Zt.Ia-Xr,Fs,Qs+8*Zt.B,Xr))}if(!qi)return us(ci,6,"Output aborted.")}return 1}(D,K)),K.bc!=null&&K.bc(K),se&=1}return se?(D.cb=0,se):0}function fl(D,K,se,xe,Oe){Oe=D[K+se+32*xe]+(Oe>>3),D[K+se+32*xe]=-256&Oe?0>Oe?0:255:Oe}function Co(D,K,se,xe,Oe,We){fl(D,K,0,se,xe+Oe),fl(D,K,1,se,xe+We),fl(D,K,2,se,xe-We),fl(D,K,3,se,xe-Oe)}function Ta(D){return(20091*D>>16)+D}function ku(D,K,se,xe){var Oe,We=0,$e=d(16);for(Oe=0;4>Oe;++Oe){var nt=D[K+0]+D[K+8],ct=D[K+0]-D[K+8],xt=(35468*D[K+4]>>16)-Ta(D[K+12]),Xt=Ta(D[K+4])+(35468*D[K+12]>>16);$e[We+0]=nt+Xt,$e[We+1]=ct+xt,$e[We+2]=ct-xt,$e[We+3]=nt-Xt,We+=4,K++}for(Oe=We=0;4>Oe;++Oe)nt=(D=$e[We+0]+4)+$e[We+8],ct=D-$e[We+8],xt=(35468*$e[We+4]>>16)-Ta($e[We+12]),fl(se,xe,0,0,nt+(Xt=Ta($e[We+4])+(35468*$e[We+12]>>16))),fl(se,xe,1,0,ct+xt),fl(se,xe,2,0,ct-xt),fl(se,xe,3,0,nt-Xt),We++,xe+=32}function pl(D,K,se,xe){var Oe=D[K+0]+4,We=35468*D[K+4]>>16,$e=Ta(D[K+4]),nt=35468*D[K+1]>>16;Co(se,xe,0,Oe+$e,D=Ta(D[K+1]),nt),Co(se,xe,1,Oe+We,D,nt),Co(se,xe,2,Oe-We,D,nt),Co(se,xe,3,Oe-$e,D,nt)}function sl(D,K,se,xe,Oe){ku(D,K,se,xe),Oe&&ku(D,K+16,se,xe+4)}function ol(D,K,se,xe){Gc(D,K+0,se,xe,1),Gc(D,K+32,se,xe+128,1)}function mc(D,K,se,xe){var Oe;for(D=D[K+0]+4,Oe=0;4>Oe;++Oe)for(K=0;4>K;++K)fl(se,xe,K,Oe,D)}function gl(D,K,se,xe){D[K+0]&&Fa(D,K+0,se,xe),D[K+16]&&Fa(D,K+16,se,xe+4),D[K+32]&&Fa(D,K+32,se,xe+128),D[K+48]&&Fa(D,K+48,se,xe+128+4)}function yc(D,K,se,xe){var Oe,We=d(16);for(Oe=0;4>Oe;++Oe){var $e=D[K+0+Oe]+D[K+12+Oe],nt=D[K+4+Oe]+D[K+8+Oe],ct=D[K+4+Oe]-D[K+8+Oe],xt=D[K+0+Oe]-D[K+12+Oe];We[0+Oe]=$e+nt,We[8+Oe]=$e-nt,We[4+Oe]=xt+ct,We[12+Oe]=xt-ct}for(Oe=0;4>Oe;++Oe)$e=(D=We[0+4*Oe]+3)+We[3+4*Oe],nt=We[1+4*Oe]+We[2+4*Oe],ct=We[1+4*Oe]-We[2+4*Oe],xt=D-We[3+4*Oe],se[xe+0]=$e+nt>>3,se[xe+16]=xt+ct>>3,se[xe+32]=$e-nt>>3,se[xe+48]=xt-ct>>3,xe+=64}function $l(D,K,se){var xe,Oe=K-32,We=La,$e=255-D[Oe-1];for(xe=0;xe<se;++xe){var nt,ct=We,xt=$e+D[K-1];for(nt=0;nt<se;++nt)D[K+nt]=ct[xt+D[Oe+nt]];K+=32}}function Zl(D,K){$l(D,K,4)}function Ru(D,K){$l(D,K,8)}function cu(D,K){$l(D,K,16)}function ml(D,K){var se;for(se=0;16>se;++se)s(D,K+32*se,D,K-32,16)}function uu(D,K){var se;for(se=16;0<se;--se)c(D,K,D[K-1],16),K+=32}function Nc(D,K,se){var xe;for(xe=0;16>xe;++xe)c(K,se+32*xe,D,16)}function Po(D,K){var se,xe=16;for(se=0;16>se;++se)xe+=D[K-1+32*se]+D[K+se-32];Nc(xe>>5,D,K)}function Wo(D,K){var se,xe=8;for(se=0;16>se;++se)xe+=D[K-1+32*se];Nc(xe>>4,D,K)}function ch(D,K){var se,xe=8;for(se=0;16>se;++se)xe+=D[K+se-32];Nc(xe>>4,D,K)}function hu(D,K){Nc(128,D,K)}function Tn(D,K,se){return D+2*K+se+2>>2}function Jd(D,K){var se,xe=K-32;for(xe=new Uint8Array([Tn(D[xe-1],D[xe+0],D[xe+1]),Tn(D[xe+0],D[xe+1],D[xe+2]),Tn(D[xe+1],D[xe+2],D[xe+3]),Tn(D[xe+2],D[xe+3],D[xe+4])]),se=0;4>se;++se)s(D,K+32*se,xe,0,xe.length)}function uh(D,K){var se=D[K-1],xe=D[K-1+32],Oe=D[K-1+64],We=D[K-1+96];Ut(D,K+0,16843009*Tn(D[K-1-32],se,xe)),Ut(D,K+32,16843009*Tn(se,xe,Oe)),Ut(D,K+64,16843009*Tn(xe,Oe,We)),Ut(D,K+96,16843009*Tn(Oe,We,We))}function pn(D,K){var se,xe=4;for(se=0;4>se;++se)xe+=D[K+se-32]+D[K-1+32*se];for(xe>>=3,se=0;4>se;++se)c(D,K+32*se,xe,4)}function hh(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],We=D[K-1-32],$e=D[K+0-32],nt=D[K+1-32],ct=D[K+2-32],xt=D[K+3-32];D[K+0+96]=Tn(xe,Oe,D[K-1+96]),D[K+1+96]=D[K+0+64]=Tn(se,xe,Oe),D[K+2+96]=D[K+1+64]=D[K+0+32]=Tn(We,se,xe),D[K+3+96]=D[K+2+64]=D[K+1+32]=D[K+0+0]=Tn($e,We,se),D[K+3+64]=D[K+2+32]=D[K+1+0]=Tn(nt,$e,We),D[K+3+32]=D[K+2+0]=Tn(ct,nt,$e),D[K+3+0]=Tn(xt,ct,nt)}function du(D,K){var se=D[K+1-32],xe=D[K+2-32],Oe=D[K+3-32],We=D[K+4-32],$e=D[K+5-32],nt=D[K+6-32],ct=D[K+7-32];D[K+0+0]=Tn(D[K+0-32],se,xe),D[K+1+0]=D[K+0+32]=Tn(se,xe,Oe),D[K+2+0]=D[K+1+32]=D[K+0+64]=Tn(xe,Oe,We),D[K+3+0]=D[K+2+32]=D[K+1+64]=D[K+0+96]=Tn(Oe,We,$e),D[K+3+32]=D[K+2+64]=D[K+1+96]=Tn(We,$e,nt),D[K+3+64]=D[K+2+96]=Tn($e,nt,ct),D[K+3+96]=Tn(nt,ct,ct)}function jc(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],We=D[K-1-32],$e=D[K+0-32],nt=D[K+1-32],ct=D[K+2-32],xt=D[K+3-32];D[K+0+0]=D[K+1+64]=We+$e+1>>1,D[K+1+0]=D[K+2+64]=$e+nt+1>>1,D[K+2+0]=D[K+3+64]=nt+ct+1>>1,D[K+3+0]=ct+xt+1>>1,D[K+0+96]=Tn(Oe,xe,se),D[K+0+64]=Tn(xe,se,We),D[K+0+32]=D[K+1+96]=Tn(se,We,$e),D[K+1+32]=D[K+2+96]=Tn(We,$e,nt),D[K+2+32]=D[K+3+96]=Tn($e,nt,ct),D[K+3+32]=Tn(nt,ct,xt)}function yl(D,K){var se=D[K+0-32],xe=D[K+1-32],Oe=D[K+2-32],We=D[K+3-32],$e=D[K+4-32],nt=D[K+5-32],ct=D[K+6-32],xt=D[K+7-32];D[K+0+0]=se+xe+1>>1,D[K+1+0]=D[K+0+64]=xe+Oe+1>>1,D[K+2+0]=D[K+1+64]=Oe+We+1>>1,D[K+3+0]=D[K+2+64]=We+$e+1>>1,D[K+0+32]=Tn(se,xe,Oe),D[K+1+32]=D[K+0+96]=Tn(xe,Oe,We),D[K+2+32]=D[K+1+96]=Tn(Oe,We,$e),D[K+3+32]=D[K+2+96]=Tn(We,$e,nt),D[K+3+64]=Tn($e,nt,ct),D[K+3+96]=Tn(nt,ct,xt)}function Du(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],We=D[K-1+96];D[K+0+0]=se+xe+1>>1,D[K+2+0]=D[K+0+32]=xe+Oe+1>>1,D[K+2+32]=D[K+0+64]=Oe+We+1>>1,D[K+1+0]=Tn(se,xe,Oe),D[K+3+0]=D[K+1+32]=Tn(xe,Oe,We),D[K+3+32]=D[K+1+64]=Tn(Oe,We,We),D[K+3+64]=D[K+2+64]=D[K+0+96]=D[K+1+96]=D[K+2+96]=D[K+3+96]=We}function Hc(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],We=D[K-1+96],$e=D[K-1-32],nt=D[K+0-32],ct=D[K+1-32],xt=D[K+2-32];D[K+0+0]=D[K+2+32]=se+$e+1>>1,D[K+0+32]=D[K+2+64]=xe+se+1>>1,D[K+0+64]=D[K+2+96]=Oe+xe+1>>1,D[K+0+96]=We+Oe+1>>1,D[K+3+0]=Tn(nt,ct,xt),D[K+2+0]=Tn($e,nt,ct),D[K+1+0]=D[K+3+32]=Tn(se,$e,nt),D[K+1+32]=D[K+3+64]=Tn(xe,se,$e),D[K+1+64]=D[K+3+96]=Tn(Oe,xe,se),D[K+1+96]=Tn(We,Oe,xe)}function vc(D,K){var se;for(se=0;8>se;++se)s(D,K+32*se,D,K-32,8)}function dh(D,K){var se;for(se=0;8>se;++se)c(D,K,D[K-1],8),K+=32}function Au(D,K,se){var xe;for(xe=0;8>xe;++xe)c(K,se+32*xe,D,8)}function vl(D,K){var se,xe=8;for(se=0;8>se;++se)xe+=D[K+se-32]+D[K-1+32*se];Au(xe>>4,D,K)}function ld(D,K){var se,xe=4;for(se=0;8>se;++se)xe+=D[K+se-32];Au(xe>>3,D,K)}function qa(D,K){var se,xe=4;for(se=0;8>se;++se)xe+=D[K-1+32*se];Au(xe>>3,D,K)}function fu(D,K){Au(128,D,K)}function pu(D,K,se){var xe=D[K-se],Oe=D[K+0],We=3*(Oe-xe)+ll[1020+D[K-2*se]-D[K+se]],$e=gn[112+(We+4>>3)];D[K-se]=La[255+xe+gn[112+(We+3>>3)]],D[K+0]=La[255+Oe-$e]}function _l(D,K,se,xe){var Oe=D[K+0],We=D[K+se];return nc[255+D[K-2*se]-D[K-se]]>xe||nc[255+We-Oe]>xe}function Uo(D,K,se,xe){return 4*nc[255+D[K-se]-D[K+0]]+nc[255+D[K-2*se]-D[K+se]]<=xe}function Qc(D,K,se,xe,Oe){var We=D[K-3*se],$e=D[K-2*se],nt=D[K-se],ct=D[K+0],xt=D[K+se],Xt=D[K+2*se],xi=D[K+3*se];return 4*nc[255+nt-ct]+nc[255+$e-xt]>xe?0:nc[255+D[K-4*se]-We]<=Oe&&nc[255+We-$e]<=Oe&&nc[255+$e-nt]<=Oe&&nc[255+xi-Xt]<=Oe&&nc[255+Xt-xt]<=Oe&&nc[255+xt-ct]<=Oe}function Jl(D,K,se,xe){var Oe=2*xe+1;for(xe=0;16>xe;++xe)Uo(D,K+xe,se,Oe)&&pu(D,K+xe,se)}function ec(D,K,se,xe){var Oe=2*xe+1;for(xe=0;16>xe;++xe)Uo(D,K+xe*se,1,Oe)&&pu(D,K+xe*se,1)}function tc(D,K,se,xe){var Oe;for(Oe=3;0<Oe;--Oe)Jl(D,K+=4*se,se,xe)}function gu(D,K,se,xe){var Oe;for(Oe=3;0<Oe;--Oe)ec(D,K+=4,se,xe)}function ra(D,K,se,xe,Oe,We,$e,nt){for(We=2*We+1;0<Oe--;){if(Qc(D,K,se,We,$e))if(_l(D,K,se,nt))pu(D,K,se);else{var ct=D,xt=K,Xt=se,xi=ct[xt-2*Xt],Bi=ct[xt-Xt],ci=ct[xt+0],Hi=ct[xt+Xt],Ni=ct[xt+2*Xt],Zt=27*(qi=ll[1020+3*(ci-Bi)+ll[1020+xi-Hi]])+63>>7,ei=18*qi+63>>7,qi=9*qi+63>>7;ct[xt-3*Xt]=La[255+ct[xt-3*Xt]+qi],ct[xt-2*Xt]=La[255+xi+ei],ct[xt-Xt]=La[255+Bi+Zt],ct[xt+0]=La[255+ci-Zt],ct[xt+Xt]=La[255+Hi-ei],ct[xt+2*Xt]=La[255+Ni-qi]}K+=xe}}function $a(D,K,se,xe,Oe,We,$e,nt){for(We=2*We+1;0<Oe--;){if(Qc(D,K,se,We,$e))if(_l(D,K,se,nt))pu(D,K,se);else{var ct=D,xt=K,Xt=se,xi=ct[xt-Xt],Bi=ct[xt+0],ci=ct[xt+Xt],Hi=gn[112+((Ni=3*(Bi-xi))+4>>3)],Ni=gn[112+(Ni+3>>3)],Zt=Hi+1>>1;ct[xt-2*Xt]=La[255+ct[xt-2*Xt]+Zt],ct[xt-Xt]=La[255+xi+Ni],ct[xt+0]=La[255+Bi-Hi],ct[xt+Xt]=La[255+ci-Zt]}K+=xe}}function Pl(D,K,se,xe,Oe,We){ra(D,K,se,1,16,xe,Oe,We)}function xl(D,K,se,xe,Oe,We){ra(D,K,1,se,16,xe,Oe,We)}function Un(D,K,se,xe,Oe,We){var $e;for($e=3;0<$e;--$e)$a(D,K+=4*se,se,1,16,xe,Oe,We)}function zo(D,K,se,xe,Oe,We){var $e;for($e=3;0<$e;--$e)$a(D,K+=4,1,se,16,xe,Oe,We)}function Hh(D,K,se,xe,Oe,We,$e,nt){ra(D,K,Oe,1,8,We,$e,nt),ra(se,xe,Oe,1,8,We,$e,nt)}function mu(D,K,se,xe,Oe,We,$e,nt){ra(D,K,1,Oe,8,We,$e,nt),ra(se,xe,1,Oe,8,We,$e,nt)}function Er(D,K,se,xe,Oe,We,$e,nt){$a(D,K+4*Oe,Oe,1,8,We,$e,nt),$a(se,xe+4*Oe,Oe,1,8,We,$e,nt)}function Ah(D,K,se,xe,Oe,We,$e,nt){$a(D,K+4,1,Oe,8,We,$e,nt),$a(se,xe+4,1,Oe,8,We,$e,nt)}function Vc(){this.ba=new ro,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _c(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Da(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Qh(){this.ua=0,this.Wa=new Ze,this.vb=new Ze,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Be,this.yc=new ye}function Ou(){this.xb=this.a=0,this.l=new Bo,this.ca=new ro,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ie,this.Pb=0,this.wd=new Ie,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Qh,this.ab=0,this.gc=A(4,Da),this.Oc=0}function hr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Bo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Mn(D,K,se,xe,Oe,We,$e){for(D=D==null?0:D[K+0],K=0;K<$e;++K)Oe[We+K]=D+se[xe+K]&255,D=Oe[We+K]}function In(D,K,se,xe,Oe,We,$e){var nt;if(D==null)Mn(null,null,se,xe,Oe,We,$e);else for(nt=0;nt<$e;++nt)Oe[We+nt]=D[K+nt]+se[xe+nt]&255}function na(D,K,se,xe,Oe,We,$e){if(D==null)Mn(null,null,se,xe,Oe,We,$e);else{var nt,ct=D[K+0],xt=ct,Xt=ct;for(nt=0;nt<$e;++nt)xt=Xt+(ct=D[K+nt])-xt,Xt=se[xe+nt]+(-256&xt?0>xt?0:255:xt)&255,xt=ct,Oe[We+nt]=Xt}}function kl(D,K,se,xe){var Oe=K.width,We=K.o;if(e(D!=null&&K!=null),0>se||0>=xe||se+xe>We)return null;if(!D.Cc){if(D.ga==null){var $e;if(D.ga=new hr,($e=D.ga==null)||($e=K.width*K.o,e(D.Gb.length==0),D.Gb=d($e),D.Uc=0,D.Gb==null?$e=0:(D.mb=D.Gb,D.nb=D.Uc,D.rc=null,$e=1),$e=!$e),!$e){$e=D.ga;var nt=D.Fa,ct=D.P,xt=D.qc,Xt=D.mb,xi=D.nb,Bi=ct+1,ci=xt-1,Hi=$e.l;if(e(nt!=null&&Xt!=null&&K!=null),Xc[0]=null,Xc[1]=Mn,Xc[2]=In,Xc[3]=na,$e.ca=Xt,$e.tb=xi,$e.c=K.width,$e.i=K.height,e(0<$e.c&&0<$e.i),1>=xt)K=0;else if($e.$a=nt[ct+0]>>0&3,$e.Z=nt[ct+0]>>2&3,$e.Lc=nt[ct+0]>>4&3,ct=nt[ct+0]>>6&3,0>$e.$a||1<$e.$a||4<=$e.Z||1<$e.Lc||ct)K=0;else if(Hi.put=ia,Hi.ac=vs,Hi.bc=dn,Hi.ma=$e,Hi.width=K.width,Hi.height=K.height,Hi.Da=K.Da,Hi.v=K.v,Hi.va=K.va,Hi.j=K.j,Hi.o=K.o,$e.$a)e:{e($e.$a==1),K=er();t:for(;;){if(K==null){K=0;break e}if(e($e!=null),$e.mc=K,K.c=$e.c,K.i=$e.i,K.l=$e.l,K.l.ma=$e,K.l.width=$e.c,K.l.height=$e.i,K.a=0,Ye(K.m,nt,Bi,ci),!nr($e.c,$e.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&_t(K.s)?($e.ic=1,nt=K.c*K.i,K.Ta=null,K.Ua=0,K.V=d(nt),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):($e.ic=0,K=Sr(K,$e.c)),!K))break t;K=1;break e}$e.mc=null,K=0}else K=ci>=$e.c*$e.i;$e=!K}if($e)return null;D.ga.Lc!=1?D.Ga=0:xe=We-se}e(D.ga!=null),e(se+xe<=We);e:{if(K=(nt=D.ga).c,We=nt.l.o,nt.$a==0){if(Bi=D.rc,ci=D.Vc,Hi=D.Fa,ct=D.P+1+se*K,xt=D.mb,Xt=D.nb+se*K,e(ct<=D.P+D.qc),nt.Z!=0)for(e(Xc[nt.Z]!=null),$e=0;$e<xe;++$e)Xc[nt.Z](Bi,ci,Hi,ct,xt,Xt,K),Bi=xt,ci=Xt,Xt+=K,ct+=K;else for($e=0;$e<xe;++$e)s(xt,Xt,Hi,ct,K),Bi=xt,ci=Xt,Xt+=K,ct+=K;D.rc=Bi,D.Vc=ci}else{if(e(nt.mc!=null),K=se+xe,e(($e=nt.mc)!=null),e(K<=$e.i),$e.C>=K)K=1;else if(nt.ic||hi(),nt.ic){nt=$e.V,Bi=$e.Ba,ci=$e.c;var Ni=$e.i,Zt=(Hi=1,ct=$e.$/ci,xt=$e.$%ci,Xt=$e.m,xi=$e.s,$e.$),ei=ci*Ni,qi=ci*K,lr=xi.wc,$i=Zt<qi?Ge(xi,xt,ct):null;e(Zt<=ei),e(K<=Ni),e(_t(xi));t:for(;;){for(;!Xt.h&&Zt<qi;){if(xt&lr||($i=Ge(xi,xt,ct)),e($i!=null),Ct(Xt),256>(Ni=je($i.G[0],$i.H[0],Xt)))nt[Bi+Zt]=Ni,++Zt,++xt>=ci&&(xt=0,++ct<=K&&!(ct%16)&&ii($e,ct));else{if(!(280>Ni)){Hi=0;break t}Ni=me(Ni-256,Xt);var Xr,Ir=je($i.G[4],$i.H[4],Xt);if(Ct(Xt),!(Zt>=(Ir=Ce(ci,Ir=me(Ir,Xt)))&&ei-Zt>=Ni)){Hi=0;break t}for(Xr=0;Xr<Ni;++Xr)nt[Bi+Zt+Xr]=nt[Bi+Zt+Xr-Ir];for(Zt+=Ni,xt+=Ni;xt>=ci;)xt-=ci,++ct<=K&&!(ct%16)&&ii($e,ct);Zt<qi&&xt&lr&&($i=Ge(xi,xt,ct))}e(Xt.h==ut(Xt))}ii($e,ct>K?K:ct);break t}!Hi||Xt.h&&Zt<ei?(Hi=0,$e.a=Xt.h?5:3):$e.$=Zt,K=Hi}else K=Nt($e,$e.V,$e.Ba,$e.c,$e.i,K,Mr);if(!K){xe=0;break e}}se+xe>=We&&(D.Cc=1),xe=1}if(!xe)return null;if(D.Cc&&((xe=D.ga)!=null&&(xe.mc=null),D.ga=null,0<D.Ga))return alert("todo:WebPDequantizeLevels"),null}return D.nb+se*Oe}function ie(D,K,se,xe,Oe,We){for(;0<Oe--;){var $e,nt=D,ct=K+(se?1:0),xt=D,Xt=K+(se?0:3);for($e=0;$e<xe;++$e){var xi=xt[Xt+4*$e];xi!=255&&(xi*=32897,nt[ct+4*$e+0]=nt[ct+4*$e+0]*xi>>23,nt[ct+4*$e+1]=nt[ct+4*$e+1]*xi>>23,nt[ct+4*$e+2]=nt[ct+4*$e+2]*xi>>23)}K+=We}}function Ue(D,K,se,xe,Oe){for(;0<xe--;){var We;for(We=0;We<se;++We){var $e=D[K+2*We+0],nt=15&(xt=D[K+2*We+1]),ct=4369*nt,xt=(240&xt|xt>>4)*ct>>16;D[K+2*We+0]=(240&$e|$e>>4)*ct>>16&240|(15&$e|$e<<4)*ct>>16>>4&15,D[K+2*We+1]=240&xt|nt}K+=Oe}}function Et(D,K,se,xe,Oe,We,$e,nt){var ct,xt,Xt=255;for(xt=0;xt<Oe;++xt){for(ct=0;ct<xe;++ct){var xi=D[K+ct];We[$e+4*ct]=xi,Xt&=xi}K+=se,$e+=nt}return Xt!=255}function jt(D,K,se,xe,Oe){var We;for(We=0;We<Oe;++We)se[xe+We]=D[K+We]>>8}function hi(){el=ie,wi=Ue,no=Et,xo=jt}function Ti(D,K,se){he[D]=function(xe,Oe,We,$e,nt,ct,xt,Xt,xi,Bi,ci,Hi,Ni,Zt,ei,qi,lr){var $i,Xr=lr-1>>1,Ir=nt[ct+0]|xt[Xt+0]<<16,bn=xi[Bi+0]|ci[Hi+0]<<16;e(xe!=null);var zr=3*Ir+bn+131074>>2;for(K(xe[Oe+0],255&zr,zr>>16,Ni,Zt),We!=null&&(zr=3*bn+Ir+131074>>2,K(We[$e+0],255&zr,zr>>16,ei,qi)),$i=1;$i<=Xr;++$i){var Fs=nt[ct+$i]|xt[Xt+$i]<<16,Qs=xi[Bi+$i]|ci[Hi+$i]<<16,Ls=Ir+Fs+bn+Qs+524296,dr=Ls+2*(Fs+bn)>>3;zr=dr+Ir>>1,Ir=(Ls=Ls+2*(Ir+Qs)>>3)+Fs>>1,K(xe[Oe+2*$i-1],255&zr,zr>>16,Ni,Zt+(2*$i-1)*se),K(xe[Oe+2*$i-0],255&Ir,Ir>>16,Ni,Zt+(2*$i-0)*se),We!=null&&(zr=Ls+bn>>1,Ir=dr+Qs>>1,K(We[$e+2*$i-1],255&zr,zr>>16,ei,qi+(2*$i-1)*se),K(We[$e+2*$i+0],255&Ir,Ir>>16,ei,qi+(2*$i+0)*se)),Ir=Fs,bn=Qs}1&lr||(zr=3*Ir+bn+131074>>2,K(xe[Oe+lr-1],255&zr,zr>>16,Ni,Zt+(lr-1)*se),We!=null&&(zr=3*bn+Ir+131074>>2,K(We[$e+lr-1],255&zr,zr>>16,ei,qi+(lr-1)*se)))}}function mr(){Ba[eA]=Pf,Ba[ph]=ud,Ba[gh]=aA,Ba[Ss]=kf,Ba[cd]=lA,Ba[zu]=hd,Ba[Ef]=cA,Ba[XA]=ud,Ba[YA]=kf,Ba[tA]=lA,Ba[mh]=hd}function Vr(D){return D&-16384?0>D?0:255:D>>vh}function cn(D,K){return Vr((19077*D>>8)+(26149*K>>8)-14234)}function Pn(D,K,se){return Vr((19077*D>>8)-(6419*K>>8)-(13320*se>>8)+8708)}function kn(D,K){return Vr((19077*D>>8)+(33050*K>>8)-17685)}function hs(D,K,se,xe,Oe){xe[Oe+0]=cn(D,se),xe[Oe+1]=Pn(D,K,se),xe[Oe+2]=kn(D,K)}function Zs(D,K,se,xe,Oe){xe[Oe+0]=kn(D,K),xe[Oe+1]=Pn(D,K,se),xe[Oe+2]=cn(D,se)}function Zn(D,K,se,xe,Oe){var We=Pn(D,K,se);K=We<<3&224|kn(D,K)>>3,xe[Oe+0]=248&cn(D,se)|We>>5,xe[Oe+1]=K}function xn(D,K,se,xe,Oe){var We=240&kn(D,K)|15;xe[Oe+0]=240&cn(D,se)|Pn(D,K,se)>>4,xe[Oe+1]=We}function Js(D,K,se,xe,Oe){xe[Oe+0]=255,hs(D,K,se,xe,Oe+1)}function yo(D,K,se,xe,Oe){Zs(D,K,se,xe,Oe),xe[Oe+3]=255}function Wr(D,K,se,xe,Oe){hs(D,K,se,xe,Oe),xe[Oe+3]=255}function ji(D,K){return 0>D?0:D>K?K:D}function eo(D,K,se){he[D]=function(xe,Oe,We,$e,nt,ct,xt,Xt,xi){for(var Bi=Xt+(-2&xi)*se;Xt!=Bi;)K(xe[Oe+0],We[$e+0],nt[ct+0],xt,Xt),K(xe[Oe+1],We[$e+0],nt[ct+0],xt,Xt+se),Oe+=2,++$e,++ct,Xt+=2*se;1&xi&&K(xe[Oe+0],We[$e+0],nt[ct+0],xt,Xt)}}function Pr(D,K,se){return se==0?D==0?K==0?6:5:K==0?4:0:se}function Cs(D,K,se,xe,Oe){switch(D>>>30){case 3:Gc(K,se,xe,Oe,0);break;case 2:qo(K,se,xe,Oe);break;case 1:Fa(K,se,xe,Oe)}}function ao(D,K){var se,xe,Oe=K.M,We=K.Nb,$e=D.oc,nt=D.pc+40,ct=D.oc,xt=D.pc+584,Xt=D.oc,xi=D.pc+600;for(se=0;16>se;++se)$e[nt+32*se-1]=129;for(se=0;8>se;++se)ct[xt+32*se-1]=129,Xt[xi+32*se-1]=129;for(0<Oe?$e[nt-1-32]=ct[xt-1-32]=Xt[xi-1-32]=129:(c($e,nt-32-1,127,21),c(ct,xt-32-1,127,9),c(Xt,xi-32-1,127,9)),xe=0;xe<D.za;++xe){var Bi=K.ya[K.aa+xe];if(0<xe){for(se=-1;16>se;++se)s($e,nt+32*se-4,$e,nt+32*se+12,4);for(se=-1;8>se;++se)s(ct,xt+32*se-4,ct,xt+32*se+4,4),s(Xt,xi+32*se-4,Xt,xi+32*se+4,4)}var ci=D.Gd,Hi=D.Hd+xe,Ni=Bi.ad,Zt=Bi.Hc;if(0<Oe&&(s($e,nt-32,ci[Hi].y,0,16),s(ct,xt-32,ci[Hi].f,0,8),s(Xt,xi-32,ci[Hi].ea,0,8)),Bi.Za){var ei=$e,qi=nt-32+16;for(0<Oe&&(xe>=D.za-1?c(ei,qi,ci[Hi].y[15],4):s(ei,qi,ci[Hi+1].y,0,4)),se=0;4>se;se++)ei[qi+128+se]=ei[qi+256+se]=ei[qi+384+se]=ei[qi+0+se];for(se=0;16>se;++se,Zt<<=2)ei=$e,qi=nt+dA[se],Bl[Bi.Ob[se]](ei,qi),Cs(Zt,Ni,16*+se,ei,qi)}else if(ei=Pr(xe,Oe,Bi.Ob[0]),Wc[ei]($e,nt),Zt!=0)for(se=0;16>se;++se,Zt<<=2)Cs(Zt,Ni,16*+se,$e,nt+dA[se]);for(se=Bi.Gc,ei=Pr(xe,Oe,Bi.Dd),tl[ei](ct,xt),tl[ei](Xt,xi),Zt=Ni,ei=ct,qi=xt,255&(Bi=se>>0)&&(170&Bi?wl(Zt,256,ei,qi):Ul(Zt,256,ei,qi)),Bi=Xt,Zt=xi,255&(se>>=8)&&(170&se?wl(Ni,320,Bi,Zt):Ul(Ni,320,Bi,Zt)),Oe<D.Ub-1&&(s(ci[Hi].y,0,$e,nt+480,16),s(ci[Hi].f,0,ct,xt+224,8),s(ci[Hi].ea,0,Xt,xi+224,8)),se=8*We*D.B,ci=D.sa,Hi=D.ta+16*xe+16*We*D.R,Ni=D.qa,Bi=D.ra+8*xe+se,Zt=D.Ha,ei=D.Ia+8*xe+se,se=0;16>se;++se)s(ci,Hi+se*D.R,$e,nt+32*se,16);for(se=0;8>se;++se)s(Ni,Bi+se*D.B,ct,xt+32*se,8),s(Zt,ei+se*D.B,Xt,xi+32*se,8)}}function wr(D,K,se,xe,Oe,We,$e,nt,ct){var xt=[0],Xt=[0],xi=0,Bi=ct!=null?ct.kd:0,ci=ct??new _c;if(D==null||12>se)return 7;ci.data=D,ci.w=K,ci.ha=se,K=[K],se=[se],ci.gb=[ci.gb];e:{var Hi=K,Ni=se,Zt=ci.gb;if(e(D!=null),e(Ni!=null),e(Zt!=null),Zt[0]=0,12<=Ni[0]&&!i(D,Hi[0],"RIFF")){if(i(D,Hi[0]+8,"WEBP")){Zt=3;break e}var ei=Ke(D,Hi[0]+4);if(12>ei||4294967286<ei){Zt=3;break e}if(Bi&&ei>Ni[0]-8){Zt=7;break e}Zt[0]=ei,Hi[0]+=12,Ni[0]-=12}Zt=0}if(Zt!=0)return Zt;for(ei=0<ci.gb[0],se=se[0];;){e:{var qi=D;Ni=K,Zt=se;var lr=xt,$i=Xt,Xr=Hi=[0];if((zr=xi=[xi])[0]=0,8>Zt[0])Zt=7;else{if(!i(qi,Ni[0],"VP8X")){if(Ke(qi,Ni[0]+4)!=10){Zt=3;break e}if(18>Zt[0]){Zt=7;break e}var Ir=Ke(qi,Ni[0]+8),bn=1+qe(qi,Ni[0]+12);if(2147483648<=bn*(qi=1+qe(qi,Ni[0]+15))){Zt=3;break e}Xr!=null&&(Xr[0]=Ir),lr!=null&&(lr[0]=bn),$i!=null&&($i[0]=qi),Ni[0]+=18,Zt[0]-=18,zr[0]=1}Zt=0}}if(xi=xi[0],Hi=Hi[0],Zt!=0)return Zt;if(Ni=!!(2&Hi),!ei&&xi)return 3;if(We!=null&&(We[0]=!!(16&Hi)),$e!=null&&($e[0]=Ni),nt!=null&&(nt[0]=0),$e=xt[0],Hi=Xt[0],xi&&Ni&&ct==null){Zt=0;break}if(4>se){Zt=7;break}if(ei&&xi||!ei&&!xi&&!i(D,K[0],"ALPH")){se=[se],ci.na=[ci.na],ci.P=[ci.P],ci.Sa=[ci.Sa];e:{Ir=D,Zt=K,ei=se;var zr=ci.gb;lr=ci.na,$i=ci.P,Xr=ci.Sa,bn=22,e(Ir!=null),e(ei!=null),qi=Zt[0];var Fs=ei[0];for(e(lr!=null),e(Xr!=null),lr[0]=null,$i[0]=null,Xr[0]=0;;){if(Zt[0]=qi,ei[0]=Fs,8>Fs){Zt=7;break e}var Qs=Ke(Ir,qi+4);if(4294967286<Qs){Zt=3;break e}var Ls=8+Qs+1&-2;if(bn+=Ls,0<zr&&bn>zr){Zt=3;break e}if(!i(Ir,qi,"VP8 ")||!i(Ir,qi,"VP8L")){Zt=0;break e}if(Fs[0]<Ls){Zt=7;break e}i(Ir,qi,"ALPH")||(lr[0]=Ir,$i[0]=qi+8,Xr[0]=Qs),qi+=Ls,Fs-=Ls}}if(se=se[0],ci.na=ci.na[0],ci.P=ci.P[0],ci.Sa=ci.Sa[0],Zt!=0)break}se=[se],ci.Ja=[ci.Ja],ci.xa=[ci.xa];e:if(zr=D,Zt=K,ei=se,lr=ci.gb[0],$i=ci.Ja,Xr=ci.xa,Ir=Zt[0],qi=!i(zr,Ir,"VP8 "),bn=!i(zr,Ir,"VP8L"),e(zr!=null),e(ei!=null),e($i!=null),e(Xr!=null),8>ei[0])Zt=7;else{if(qi||bn){if(zr=Ke(zr,Ir+4),12<=lr&&zr>lr-12){Zt=3;break e}if(Bi&&zr>ei[0]-8){Zt=7;break e}$i[0]=zr,Zt[0]+=8,ei[0]-=8,Xr[0]=bn}else Xr[0]=5<=ei[0]&&zr[Ir+0]==47&&!(zr[Ir+4]>>5),$i[0]=ei[0];Zt=0}if(se=se[0],ci.Ja=ci.Ja[0],ci.xa=ci.xa[0],K=K[0],Zt!=0)break;if(4294967286<ci.Ja)return 3;if(nt==null||Ni||(nt[0]=ci.xa?2:1),$e=[$e],Hi=[Hi],ci.xa){if(5>se){Zt=7;break}nt=$e,Bi=Hi,Ni=We,D==null||5>se?D=0:5<=se&&D[K+0]==47&&!(D[K+4]>>5)?(ei=[0],zr=[0],lr=[0],Ye($i=new Ie,D,K,se),St($i,ei,zr,lr)?(nt!=null&&(nt[0]=ei[0]),Bi!=null&&(Bi[0]=zr[0]),Ni!=null&&(Ni[0]=lr[0]),D=1):D=0):D=0}else{if(10>se){Zt=7;break}nt=Hi,D==null||10>se||!pc(D,K+3,se-3)?D=0:(Bi=D[K+0]|D[K+1]<<8|D[K+2]<<16,Ni=16383&(D[K+7]<<8|D[K+6]),D=16383&(D[K+9]<<8|D[K+8]),1&Bi||3<(Bi>>1&7)||!(Bi>>4&1)||Bi>>5>=ci.Ja||!Ni||!D?D=0:($e&&($e[0]=Ni),nt&&(nt[0]=D),D=1))}if(!D||($e=$e[0],Hi=Hi[0],xi&&(xt[0]!=$e||Xt[0]!=Hi)))return 3;ct!=null&&(ct[0]=ci,ct.offset=K-ct.w,e(4294967286>K-ct.w),e(ct.offset==ct.ha-se));break}return Zt==0||Zt==7&&xi&&ct==null?(We!=null&&(We[0]|=ci.na!=null&&0<ci.na.length),xe!=null&&(xe[0]=$e),Oe!=null&&(Oe[0]=Hi),0):Zt}function vo(D,K,se){var xe=K.width,Oe=K.height,We=0,$e=0,nt=xe,ct=Oe;if(K.Da=D!=null&&0<D.Da,K.Da&&(nt=D.cd,ct=D.bd,We=D.v,$e=D.j,11>se||(We&=-2,$e&=-2),0>We||0>$e||0>=nt||0>=ct||We+nt>xe||$e+ct>Oe))return 0;if(K.v=We,K.j=$e,K.va=We+nt,K.o=$e+ct,K.U=nt,K.T=ct,K.da=D!=null&&0<D.da,K.da){if(!yi(nt,ct,se=[D.ib],We=[D.hb]))return 0;K.ib=se[0],K.hb=We[0]}return K.ob=D!=null&&D.ob,K.Kb=D==null||!D.Sd,K.da&&(K.ob=K.ib<3*xe/4&&K.hb<3*Oe/4,K.Kb=0),1}function ic(D){if(D==null)return 2;if(11>D.S){var K=D.f.RGBA;K.fb+=(D.height-1)*K.A,K.A=-K.A}else K=D.f.kb,D=D.height,K.O+=(D-1)*K.fa,K.fa=-K.fa,K.N+=(D-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(D-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(D-1)*K.lb,K.lb=-K.lb);return 0}function pa(D,K,se,xe){if(xe==null||0>=D||0>=K)return 2;if(se!=null){if(se.Da){var Oe=se.cd,We=se.bd,$e=-2&se.v,nt=-2&se.j;if(0>$e||0>nt||0>=Oe||0>=We||$e+Oe>D||nt+We>K)return 2;D=Oe,K=We}if(se.da){if(!yi(D,K,Oe=[se.ib],We=[se.hb]))return 2;D=Oe[0],K=We[0]}}xe.width=D,xe.height=K;e:{var ct=xe.width,xt=xe.height;if(D=xe.S,0>=ct||0>=xt||!(D>=eA&&13>D))D=2;else{if(0>=xe.Rd&&xe.sd==null){$e=We=Oe=K=0;var Xt=(nt=ct*AA[D])*xt;if(11>D||(We=(xt+1)/2*(K=(ct+1)/2),D==12&&($e=(Oe=ct)*xt)),(xt=d(Xt+2*We+$e))==null){D=1;break e}xe.sd=xt,11>D?((ct=xe.f.RGBA).eb=xt,ct.fb=0,ct.A=nt,ct.size=Xt):((ct=xe.f.kb).y=xt,ct.O=0,ct.fa=nt,ct.Fd=Xt,ct.f=xt,ct.N=0+Xt,ct.Ab=K,ct.Cd=We,ct.ea=xt,ct.W=0+Xt+We,ct.Db=K,ct.Ed=We,D==12&&(ct.F=xt,ct.J=0+Xt+2*We),ct.Tc=$e,ct.lb=Oe)}if(K=1,Oe=xe.S,We=xe.width,$e=xe.height,Oe>=eA&&13>Oe)if(11>Oe)D=xe.f.RGBA,K&=(nt=Math.abs(D.A))*($e-1)+We<=D.size,K&=nt>=We*AA[Oe],K&=D.eb!=null;else{D=xe.f.kb,nt=(We+1)/2,Xt=($e+1)/2,ct=Math.abs(D.fa),xt=Math.abs(D.Ab);var xi=Math.abs(D.Db),Bi=Math.abs(D.lb),ci=Bi*($e-1)+We;K&=ct*($e-1)+We<=D.Fd,K&=xt*(Xt-1)+nt<=D.Cd,K=(K&=xi*(Xt-1)+nt<=D.Ed)&ct>=We&xt>=nt&xi>=nt,K&=D.y!=null,K&=D.f!=null,K&=D.ea!=null,Oe==12&&(K&=Bi>=We,K&=ci<=D.Tc,K&=D.F!=null)}else K=0;D=K?0:2}}return D!=0||se!=null&&se.fd&&(D=ic(xe)),D}var Xo=64,Jn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Yo=24,xc=32,So=8,Oa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];di("Predictor0","PredictorAdd0"),he.Predictor0=function(){return 4278190080},he.Predictor1=function(D){return D},he.Predictor2=function(D,K,se){return K[se+0]},he.Predictor3=function(D,K,se){return K[se+1]},he.Predictor4=function(D,K,se){return K[se-1]},he.Predictor5=function(D,K,se){return Ri(Ri(D,K[se+1]),K[se+0])},he.Predictor6=function(D,K,se){return Ri(D,K[se-1])},he.Predictor7=function(D,K,se){return Ri(D,K[se+0])},he.Predictor8=function(D,K,se){return Ri(K[se-1],K[se+0])},he.Predictor9=function(D,K,se){return Ri(K[se+0],K[se+1])},he.Predictor10=function(D,K,se){return Ri(Ri(D,K[se-1]),Ri(K[se+0],K[se+1]))},he.Predictor11=function(D,K,se){var xe=K[se+0];return 0>=ar(xe>>24&255,D>>24&255,(K=K[se-1])>>24&255)+ar(xe>>16&255,D>>16&255,K>>16&255)+ar(xe>>8&255,D>>8&255,K>>8&255)+ar(255&xe,255&D,255&K)?xe:D},he.Predictor12=function(D,K,se){var xe=K[se+0];return(Oi((D>>24&255)+(xe>>24&255)-((K=K[se-1])>>24&255))<<24|Oi((D>>16&255)+(xe>>16&255)-(K>>16&255))<<16|Oi((D>>8&255)+(xe>>8&255)-(K>>8&255))<<8|Oi((255&D)+(255&xe)-(255&K)))>>>0},he.Predictor13=function(D,K,se){var xe=K[se-1];return(Ji((D=Ri(D,K[se+0]))>>24&255,xe>>24&255)<<24|Ji(D>>16&255,xe>>16&255)<<16|Ji(D>>8&255,xe>>8&255)<<8|Ji(D>>0&255,xe>>0&255))>>>0};var al=he.PredictorAdd0;he.PredictorAdd1=br,di("Predictor2","PredictorAdd2"),di("Predictor3","PredictorAdd3"),di("Predictor4","PredictorAdd4"),di("Predictor5","PredictorAdd5"),di("Predictor6","PredictorAdd6"),di("Predictor7","PredictorAdd7"),di("Predictor8","PredictorAdd8"),di("Predictor9","PredictorAdd9"),di("Predictor10","PredictorAdd10"),di("Predictor11","PredictorAdd11"),di("Predictor12","PredictorAdd12"),di("Predictor13","PredictorAdd13");var Ko=he.PredictorAdd2;ui("ColorIndexInverseTransform","MapARGB","32b",function(D){return D>>8&255},function(D){return D}),ui("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(D){return D},function(D){return D>>8&255});var yu,No=he.ColorIndexInverseTransform,Rl=he.MapARGB,Ia=he.VP8LColorIndexInverseTransformAlpha,_o=he.MapAlpha,sa=he.VP8LPredictorsAdd=[];sa.length=16,(he.VP8LPredictors=[]).length=16,(he.VP8LPredictorsAdd_C=[]).length=16,(he.VP8LPredictors_C=[]).length=16;var Dl,Za,ga,bc,Ua,Ol,bl,Gc,qo,wl,Fa,Ul,vu,Ja,Uu,jo,wc,zl,_u,rc,Nl,Bc,xu,Eo,el,wi,no,xo,fo=d(511),jl=d(2041),bu=d(225),za=d(767),fh=0,ll=jl,gn=bu,La=za,nc=fo,eA=0,ph=1,gh=2,Ss=3,cd=4,zu=5,Ef=6,XA=7,YA=8,tA=9,mh=10,Ep=[2,3,7],iA=[3,3,11],Tf=[280,256,256,256,40],If=[0,1,1,1,0],Vh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],rA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],KA=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],yh=8,Nu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],wu=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ju=null,Gh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ff=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nA=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Lf=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Wh=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],sA=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],oA=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Wc=[],Bl=[],tl=[],Mf=1,qA=2,Xc=[],Ba=[];Ti("UpsampleRgbLinePair",hs,3),Ti("UpsampleBgrLinePair",Zs,3),Ti("UpsampleRgbaLinePair",Wr,4),Ti("UpsampleBgraLinePair",yo,4),Ti("UpsampleArgbLinePair",Js,4),Ti("UpsampleRgba4444LinePair",xn,2),Ti("UpsampleRgb565LinePair",Zn,2);var Pf=he.UpsampleRgbLinePair,aA=he.UpsampleBgrLinePair,ud=he.UpsampleRgbaLinePair,kf=he.UpsampleBgraLinePair,lA=he.UpsampleArgbLinePair,hd=he.UpsampleRgba4444LinePair,cA=he.UpsampleRgb565LinePair,Cc=16,Xh=1<<Cc-1,Yc=-227,$A=482,vh=6,Hu=0,Rf=d(256),Hl=d(256),uA=d(256),dd=d(256),hA=d($A-Yc),ZA=d($A-Yc);eo("YuvToRgbRow",hs,3),eo("YuvToBgrRow",Zs,3),eo("YuvToRgbaRow",Wr,4),eo("YuvToBgraRow",yo,4),eo("YuvToArgbRow",Js,4),eo("YuvToRgba4444Row",xn,2),eo("YuvToRgb565Row",Zn,2);var dA=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_h=[0,2,8],Ad=[8,7,6,4,4,2,2,2,1,1,1,1],xh=1;this.WebPDecodeRGBA=function(D,K,se,xe,Oe){var We=ph,$e=new Vc,nt=new ro;$e.ba=nt,nt.S=We,nt.width=[nt.width],nt.height=[nt.height];var ct=nt.width,xt=nt.height,Xt=new zn;if(Xt==null||D==null)var xi=2;else e(Xt!=null),xi=wr(D,K,se,Xt.width,Xt.height,Xt.Pd,Xt.Qd,Xt.format,null);if(xi!=0?ct=0:(ct!=null&&(ct[0]=Xt.width[0]),xt!=null&&(xt[0]=Xt.height[0]),ct=1),ct){nt.width=nt.width[0],nt.height=nt.height[0],xe!=null&&(xe[0]=nt.width),Oe!=null&&(Oe[0]=nt.height);e:{if(xe=new Bo,(Oe=new _c).data=D,Oe.w=K,Oe.ha=se,Oe.kd=1,K=[0],e(Oe!=null),((D=wr(Oe.data,Oe.w,Oe.ha,null,null,null,K,null,Oe))==0||D==7)&&K[0]&&(D=4),(K=D)==0){if(e($e!=null),xe.data=Oe.data,xe.w=Oe.w+Oe.offset,xe.ha=Oe.ha-Oe.offset,xe.put=ia,xe.ac=vs,xe.bc=dn,xe.ma=$e,Oe.xa){if((D=er())==null){$e=1;break e}if(function(Bi,ci){var Hi=[0],Ni=[0],Zt=[0];t:for(;;){if(Bi==null)return 0;if(ci==null)return Bi.a=2,0;if(Bi.l=ci,Bi.a=0,Ye(Bi.m,ci.data,ci.w,ci.ha),!St(Bi.m,Hi,Ni,Zt)){Bi.a=3;break t}if(Bi.xb=qA,ci.width=Hi[0],ci.height=Ni[0],!nr(Hi[0],Ni[0],1,Bi,null))break t;return 1}return e(Bi.a!=0),0}(D,xe)){if(xe=(K=pa(xe.width,xe.height,$e.Oa,$e.ba))==0){t:{xe=D;i:for(;;){if(xe==null){xe=0;break t}if(e(xe.s.yc!=null),e(xe.s.Ya!=null),e(0<xe.s.Wb),e((se=xe.l)!=null),e((Oe=se.ma)!=null),xe.xb!=0){if(xe.ca=Oe.ba,xe.tb=Oe.tb,e(xe.ca!=null),!vo(Oe.Oa,se,Ss)){xe.a=2;break i}if(!Sr(xe,se.width)||se.da)break i;if((se.da||Ur(xe.ca.S))&&hi(),11>xe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),xe.ca.f.kb.F!=null&&hi()),xe.Pb&&0<xe.s.ua&&xe.s.vb.X==null&&!Pt(xe.s.vb,xe.s.Wa.Xa)){xe.a=1;break i}xe.xb=0}if(!Nt(xe,xe.V,xe.Ba,xe.c,xe.i,se.o,Rt))break i;Oe.Dc=xe.Ma,xe=1;break t}e(xe.a!=0),xe=0}xe=!xe}xe&&(K=D.a)}else K=D.a}else{if((D=new fc)==null){$e=1;break e}if(D.Fa=Oe.na,D.P=Oe.P,D.qc=Oe.Sa,lh(D,xe)){if((K=pa(xe.width,xe.height,$e.Oa,$e.ba))==0){if(D.Aa=0,se=$e.Oa,e((Oe=D)!=null),se!=null){if(0<(ct=0>(ct=se.Md)?0:100<ct?255:255*ct/100)){for(xt=Xt=0;4>xt;++xt)12>(xi=Oe.pb[xt]).lc&&(xi.ia=ct*Ad[0>xi.lc?0:xi.lc]>>3),Xt|=xi.ia;Xt&&(alert("todo:VP8InitRandom"),Oe.ia=1)}Oe.Ga=se.Id,100<Oe.Ga?Oe.Ga=100:0>Oe.Ga&&(Oe.Ga=0)}zc(D,xe)||(K=D.a)}}else K=D.a}K==0&&$e.Oa!=null&&$e.Oa.fd&&(K=ic($e.ba))}$e=K}We=$e!=0?null:11>We?nt.f.RGBA.eb:nt.f.kb.y}else We=null;return We};var AA=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function b(he,be){for(var Se="",oe=0;oe<4;oe++)Se+=String.fromCharCode(he[be++]);return Se}function x(he,be){return(he[be+0]<<0|he[be+1]<<8|he[be+2]<<16)>>>0}function B(he,be){return(he[be+0]<<0|he[be+1]<<8|he[be+2]<<16|he[be+3]<<24)>>>0}new y;var T=[0],E=[0],R=[],P=new y,G=a,U=function(he,be){var Se={},oe=0,ye=!1,Me=0,Be=0;if(Se.frames=[],!function(ot,ut,mt,Ct){for(var rt=0;rt<Ct;rt++)if(ot[ut+rt]!=mt.charCodeAt(rt))return!0;return!1}(he,be,"RIFF",4)){for(B(he,be+=4),be+=8;be<he.length;){var Pe=b(he,be),De=B(he,be+=4);be+=4;var et=De+(1&De);switch(Pe){case"VP8 ":case"VP8L":Se.frames[oe]===void 0&&(Se.frames[oe]={}),(pt=Se.frames[oe]).src_off=ye?Be:be-8,pt.src_size=Me+De+8,oe++,ye&&(ye=!1,Me=0,Be=0);break;case"VP8X":(pt=Se.header={}).feature_flags=he[be];var Ye=be+4;pt.canvas_width=1+x(he,Ye),Ye+=3,pt.canvas_height=1+x(he,Ye),Ye+=3;break;case"ALPH":ye=!0,Me=et+8,Be=be-8;break;case"ANIM":(pt=Se.header).bgcolor=B(he,be),Ye=be+4,pt.loop_count=(Qt=he)[(Ie=Ye)+0]<<0|Qt[Ie+1]<<8,Ye+=2;break;case"ANMF":var bt,pt;(pt=Se.frames[oe]={}).offset_x=2*x(he,be),be+=3,pt.offset_y=2*x(he,be),be+=3,pt.width=1+x(he,be),be+=3,pt.height=1+x(he,be),be+=3,pt.duration=x(he,be),be+=3,bt=he[be++],pt.dispose=1&bt,pt.blend=bt>>1&1}Pe!="ANMF"&&(be+=et)}var Qt,Ie;return Se}}(G,0);U.response=G,U.rgbaoutput=!0,U.dataurl=!1;var Q=U.header?U.header:null,q=U.frames?U.frames:null;if(Q){Q.loop_counter=Q.loop_count,T=[Q.canvas_height],E=[Q.canvas_width];for(var ne=0;ne<q.length&&q[ne].blend!=0;ne++);}var re=q[0],pe=P.WebPDecodeRGBA(G,re.src_off,re.src_size,E,T);re.rgba=pe,re.imgwidth=E[0],re.imgheight=T[0];for(var fe=0;fe<E[0]*T[0]*4;fe++)R[fe]=pe[fe];return this.width=E,this.height=T,this.data=R,this}(function(a){var e=function(){return typeof o1=="function"},i=function(T,E,R,P){var G=4,U=A;switch(P){case a.image_compression.FAST:G=1,U=d;break;case a.image_compression.MEDIUM:G=6,U=r;break;case a.image_compression.SLOW:G=9,U=y}T=s(T,E,R,U);var Q=o1(T,{level:G});return a.__addimage__.arrayBufferToBinaryString(Q)},s=function(T,E,R,P){for(var G,U,Q,q=T.length/E,ne=new Uint8Array(T.length+q),re=x(),pe=0;pe<q;pe+=1){if(Q=pe*E,G=T.subarray(Q,Q+E),P)ne.set(P(G,R,U),Q+pe);else{for(var fe,he=re.length,be=[];fe<he;fe+=1)be[fe]=re[fe](G,R,U);var Se=B(be.concat());ne.set(be[Se],Q+pe)}U=G}return ne},c=function(T){var E=Array.apply([],T);return E.unshift(0),E},d=function(T,E){var R,P=[],G=T.length;P[0]=1;for(var U=0;U<G;U+=1)R=T[U-E]||0,P[U+1]=T[U]-R+256&255;return P},A=function(T,E,R){var P,G=[],U=T.length;G[0]=2;for(var Q=0;Q<U;Q+=1)P=R&&R[Q]||0,G[Q+1]=T[Q]-P+256&255;return G},r=function(T,E,R){var P,G,U=[],Q=T.length;U[0]=3;for(var q=0;q<Q;q+=1)P=T[q-E]||0,G=R&&R[q]||0,U[q+1]=T[q]+256-(P+G>>>1)&255;return U},y=function(T,E,R){var P,G,U,Q,q=[],ne=T.length;q[0]=4;for(var re=0;re<ne;re+=1)P=T[re-E]||0,G=R&&R[re]||0,U=R&&R[re-E]||0,Q=b(P,G,U),q[re+1]=T[re]-Q+256&255;return q},b=function(T,E,R){if(T===E&&E===R)return T;var P=Math.abs(E-R),G=Math.abs(T-R),U=Math.abs(T+E-R-R);return P<=G&&P<=U?T:G<=U?E:R},x=function(){return[c,d,A,r,y]},B=function(T){var E=T.map(function(R){return R.reduce(function(P,G){return P+Math.abs(G)},0)});return E.indexOf(Math.min.apply(null,E))};a.processPNG=function(T,E,R,P){var G,U,Q,q,ne,re,pe,fe,he,be,Se,oe,ye,Me,Be,Pe=this.decode.FLATE_DECODE,De="";if(this.__addimage__.isArrayBuffer(T)&&(T=new Uint8Array(T)),this.__addimage__.isArrayBufferView(T)){if(T=(Q=new cU(T)).imgData,U=Q.bits,G=Q.colorSpace,ne=Q.colors,[4,6].indexOf(Q.colorType)!==-1){if(Q.bits===8){he=(fe=Q.pixelBitlength==32?new Uint32Array(Q.decodePixels().buffer):Q.pixelBitlength==16?new Uint16Array(Q.decodePixels().buffer):new Uint8Array(Q.decodePixels().buffer)).length,Se=new Uint8Array(he*Q.colors),be=new Uint8Array(he);var et,Ye=Q.pixelBitlength-Q.bits;for(Me=0,Be=0;Me<he;Me++){for(ye=fe[Me],et=0;et<Ye;)Se[Be++]=ye>>>et&255,et+=Q.bits;be[Me]=ye>>>et&255}}if(Q.bits===16){he=(fe=new Uint32Array(Q.decodePixels().buffer)).length,Se=new Uint8Array(he*(32/Q.pixelBitlength)*Q.colors),be=new Uint8Array(he*(32/Q.pixelBitlength)),oe=Q.colors>1,Me=0,Be=0;for(var bt=0;Me<he;)ye=fe[Me++],Se[Be++]=ye>>>0&255,oe&&(Se[Be++]=ye>>>16&255,ye=fe[Me++],Se[Be++]=ye>>>0&255),be[bt++]=ye>>>16&255;U=8}P!==a.image_compression.NONE&&e()?(T=i(Se,Q.width*Q.colors,Q.colors,P),pe=i(be,Q.width,1,P)):(T=Se,pe=be,Pe=void 0)}if(Q.colorType===3&&(G=this.color_spaces.INDEXED,re=Q.palette,Q.transparency.indexed)){var pt=Q.transparency.indexed,Qt=0;for(Me=0,he=pt.length;Me<he;++Me)Qt+=pt[Me];if((Qt/=255)===he-1&&pt.indexOf(0)!==-1)q=[pt.indexOf(0)];else if(Qt!==he){for(fe=Q.decodePixels(),be=new Uint8Array(fe.length),Me=0,he=fe.length;Me<he;Me++)be[Me]=pt[fe[Me]];pe=i(be,Q.width,1)}}var Ie=function(ot){var ut;switch(ot){case a.image_compression.FAST:ut=11;break;case a.image_compression.MEDIUM:ut=13;break;case a.image_compression.SLOW:ut=14;break;default:ut=12}return ut}(P);return Pe===this.decode.FLATE_DECODE&&(De="/Predictor "+Ie+" "),De+="/Colors "+ne+" /BitsPerComponent "+U+" /Columns "+Q.width,(this.__addimage__.isArrayBuffer(T)||this.__addimage__.isArrayBufferView(T))&&(T=this.__addimage__.arrayBufferToBinaryString(T)),(pe&&this.__addimage__.isArrayBuffer(pe)||this.__addimage__.isArrayBufferView(pe))&&(pe=this.__addimage__.arrayBufferToBinaryString(pe)),{alias:R,data:T,index:E,filter:Pe,decodeParameters:De,transparency:q,palette:re,sMask:pe,predictor:Ie,width:Q.width,height:Q.height,bitsPerComponent:U,colorSpace:G}}}})(Qn.API),function(a){a.processGIF89A=function(e,i,s,c){var d=new uU(e),A=d.width,r=d.height,y=[];d.decodeAndBlitFrameRGBA(0,y);var b={data:y,width:A,height:r},x=new vb(100).encode(b,100);return a.processJPEG.call(this,x,i,s,c)},a.processGIF87A=a.processGIF89A}(Qn.API),jd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var a=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(a);for(var e=0;e<a;e++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:c,green:s,blue:i,quad:d}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},jd.prototype.parseBGR=function(){this.pos=this.offset;try{var a="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[a]()}catch(i){ha.log("bit decode error:"+i)}},jd.prototype.bit1=function(){var a,e=Math.ceil(this.width/8),i=e%4;for(a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,c=0;c<e;c++)for(var d=this.datav.getUint8(this.pos++,!0),A=s*this.width*4+8*c*4,r=0;r<8&&8*c+r<this.width;r++){var y=this.palette[d>>7-r&1];this.data[A+4*r]=y.blue,this.data[A+4*r+1]=y.green,this.data[A+4*r+2]=y.red,this.data[A+4*r+3]=255}i!==0&&(this.pos+=4-i)}},jd.prototype.bit4=function(){for(var a=Math.ceil(this.width/2),e=a%4,i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,c=0;c<a;c++){var d=this.datav.getUint8(this.pos++,!0),A=s*this.width*4+2*c*4,r=d>>4,y=15&d,b=this.palette[r];if(this.data[A]=b.blue,this.data[A+1]=b.green,this.data[A+2]=b.red,this.data[A+3]=255,2*c+1>=this.width)break;b=this.palette[y],this.data[A+4]=b.blue,this.data[A+4+1]=b.green,this.data[A+4+2]=b.red,this.data[A+4+3]=255}e!==0&&(this.pos+=4-e)}},jd.prototype.bit8=function(){for(var a=this.width%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var c=this.datav.getUint8(this.pos++,!0),d=i*this.width*4+4*s;if(c<this.palette.length){var A=this.palette[c];this.data[d]=A.red,this.data[d+1]=A.green,this.data[d+2]=A.blue,this.data[d+3]=255}else this.data[d]=255,this.data[d+1]=255,this.data[d+2]=255,this.data[d+3]=255}a!==0&&(this.pos+=4-a)}},jd.prototype.bit15=function(){for(var a=this.width%3,e=parseInt("11111",2),i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,c=0;c<this.width;c++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var A=(d&e)/e*255|0,r=(d>>5&e)/e*255|0,y=(d>>10&e)/e*255|0,b=d>>15?255:0,x=s*this.width*4+4*c;this.data[x]=y,this.data[x+1]=r,this.data[x+2]=A,this.data[x+3]=b}this.pos+=a}},jd.prototype.bit16=function(){for(var a=this.width%3,e=parseInt("11111",2),i=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var c=this.bottom_up?s:this.height-1-s,d=0;d<this.width;d++){var A=this.datav.getUint16(this.pos,!0);this.pos+=2;var r=(A&e)/e*255|0,y=(A>>5&i)/i*255|0,b=(A>>11)/e*255|0,x=c*this.width*4+4*d;this.data[x]=b,this.data[x+1]=y,this.data[x+2]=r,this.data[x+3]=255}this.pos+=a}},jd.prototype.bit24=function(){for(var a=this.height-1;a>=0;a--){for(var e=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),A=e*this.width*4+4*i;this.data[A]=d,this.data[A+1]=c,this.data[A+2]=s,this.data[A+3]=255}this.pos+=this.width%4}},jd.prototype.bit32=function(){for(var a=this.height-1;a>=0;a--)for(var e=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),r=e*this.width*4+4*i;this.data[r]=d,this.data[r+1]=c,this.data[r+2]=s,this.data[r+3]=A}},jd.prototype.getData=function(){return this.data},function(a){a.processBMP=function(e,i,s,c){var d=new jd(e,!1),A=d.width,r=d.height,y={data:d.getData(),width:A,height:r},b=new vb(100).encode(y,100);return a.processJPEG.call(this,b,i,s,c)}}(Qn.API),FE.prototype.getData=function(){return this.data},function(a){a.processWEBP=function(e,i,s,c){var d=new FE(e),A=d.width,r=d.height,y={data:d.getData(),width:A,height:r},b=new vb(100).encode(y,100);return a.processJPEG.call(this,b,i,s,c)}}(Qn.API),Qn.API.processRGBA=function(a,e,i){for(var s=a.data,c=s.length,d=new Uint8Array(c/4*3),A=new Uint8Array(c/4),r=0,y=0,b=0;b<c;b+=4){var x=s[b],B=s[b+1],T=s[b+2],E=s[b+3];d[r++]=x,d[r++]=B,d[r++]=T,A[y++]=E}var R=this.__addimage__.arrayBufferToBinaryString(d);return{alpha:this.__addimage__.arrayBufferToBinaryString(A),data:R,index:e,alias:i,colorSpace:"DeviceRGB",bitsPerComponent:8,width:a.width,height:a.height}},Qn.API.setLanguage=function(a){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[a]!==void 0&&(this.internal.languageSettings.languageCode=a,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Qg=Qn.API,sv=Qg.getCharWidthsArray=function(a,e){var i,s,c=(e=e||{}).font||this.internal.getFont(),d=e.fontSize||this.internal.getFontSize(),A=e.charSpace||this.internal.getCharSpace(),r=e.widths?e.widths:c.metadata.Unicode.widths,y=r.fof?r.fof:1,b=e.kerning?e.kerning:c.metadata.Unicode.kerning,x=b.fof?b.fof:1,B=e.doKerning!==!1,T=0,E=a.length,R=0,P=r[0]||y,G=[];for(i=0;i<E;i++)s=a.charCodeAt(i),typeof c.metadata.widthOfString=="function"?G.push((c.metadata.widthOfGlyph(c.metadata.characterToGlyph(s))+A*(1e3/d)||0)/1e3):(T=B&&Go(b[s])==="object"&&!isNaN(parseInt(b[s][R],10))?b[s][R]/x:0,G.push((r[s]||P)/y+T)),R=s;return G},SE=Qg.getStringUnitWidth=function(a,e){var i=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),c=e.charSpace||this.internal.getCharSpace();return Qg.processArabic&&(a=Qg.processArabic(a)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(a,i,c)/i:sv.apply(this,arguments).reduce(function(d,A){return d+A},0)},EE=function(a,e,i,s){for(var c=[],d=0,A=a.length,r=0;d!==A&&r+e[d]<i;)r+=e[d],d++;c.push(a.slice(0,d));var y=d;for(r=0;d!==A;)r+e[d]>s&&(c.push(a.slice(y,d)),r=0,y=d),r+=e[d],d++;return y!==d&&c.push(a.slice(y,d)),c},TE=function(a,e,i){i||(i={});var s,c,d,A,r,y,b,x=[],B=[x],T=i.textIndent||0,E=0,R=0,P=a.split(" "),G=sv.apply(this,[" ",i])[0];if(y=i.lineIndent===-1?P[0].length+2:i.lineIndent||0){var U=Array(y).join(" "),Q=[];P.map(function(ne){(ne=ne.split(/\s*\n/)).length>1?Q=Q.concat(ne.map(function(re,pe){return(pe&&re.length?`
`:"")+re})):Q.push(ne[0])}),P=Q,y=SE.apply(this,[U,i])}for(d=0,A=P.length;d<A;d++){var q=0;if(s=P[d],y&&s[0]==`
`&&(s=s.substr(1),q=1),T+E+(R=(c=sv.apply(this,[s,i])).reduce(function(ne,re){return ne+re},0))>e||q){if(R>e){for(r=EE.apply(this,[s,c,e-(T+E),e]),x.push(r.shift()),x=[r.pop()];r.length;)B.push([r.shift()]);R=c.slice(s.length-(x[0]?x[0].length:0)).reduce(function(ne,re){return ne+re},0)}else x=[s];B.push(x),T=R+y,E=G}else x.push(s),T+=E+R,E=G}return b=y?function(ne,re){return(re?U:"")+ne.join(" ")}:function(ne){return ne.join(" ")},B.map(b)},Qg.splitTextToSize=function(a,e,i){var s,c=(i=i||{}).fontSize||this.internal.getFontSize(),d=(function(x){if(x.widths&&x.kerning)return{widths:x.widths,kerning:x.kerning};var B=this.internal.getFont(x.fontName,x.fontStyle);return B.metadata.Unicode?{widths:B.metadata.Unicode.widths||{0:1},kerning:B.metadata.Unicode.kerning||{}}:{font:B.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,i);s=Array.isArray(a)?a:String(a).split(/\r?\n/);var A=1*this.internal.scaleFactor*e/c;d.textIndent=i.textIndent?1*i.textIndent*this.internal.scaleFactor/c:0,d.lineIndent=i.lineIndent;var r,y,b=[];for(r=0,y=s.length;r<y;r++)b=b.concat(TE.apply(this,[s[r],A,d]));return b},function(a){a.__fontmetrics__=a.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",i={},s={},c=0;c<e.length;c++)i[e[c]]="0123456789abcdef"[c],s["0123456789abcdef"[c]]=e[c];var d=function(B){return"0x"+parseInt(B,10).toString(16)},A=a.__fontmetrics__.compress=function(B){var T,E,R,P,G=["{"];for(var U in B){if(T=B[U],isNaN(parseInt(U,10))?E="'"+U+"'":(U=parseInt(U,10),E=(E=d(U).slice(2)).slice(0,-1)+s[E.slice(-1)]),typeof T=="number")T<0?(R=d(T).slice(3),P="-"):(R=d(T).slice(2),P=""),R=P+R.slice(0,-1)+s[R.slice(-1)];else{if(Go(T)!=="object")throw new Error("Don't know what to do with value type "+Go(T)+".");R=A(T)}G.push(E+R)}return G.push("}"),G.join("")},r=a.__fontmetrics__.uncompress=function(B){if(typeof B!="string")throw new Error("Invalid argument passed to uncompress.");for(var T,E,R,P,G={},U=1,Q=G,q=[],ne="",re="",pe=B.length-1,fe=1;fe<pe;fe+=1)(P=B[fe])=="'"?T?(R=T.join(""),T=void 0):T=[]:T?T.push(P):P=="{"?(q.push([Q,R]),Q={},R=void 0):P=="}"?((E=q.pop())[0][E[1]]=Q,R=void 0,Q=E[0]):P=="-"?U=-1:R===void 0?i.hasOwnProperty(P)?(ne+=i[P],R=parseInt(ne,16)*U,U=1,ne=""):ne+=P:i.hasOwnProperty(P)?(re+=i[P],Q[R]=parseInt(re,16)*U,U=1,R=void 0,re=""):re+=P;return G},y={codePages:["WinAnsiEncoding"],WinAnsiEncoding:r("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},b={Unicode:{Courier:y,"Courier-Bold":y,"Courier-BoldOblique":y,"Courier-Oblique":y,Helvetica:y,"Helvetica-Bold":y,"Helvetica-BoldOblique":y,"Helvetica-Oblique":y,"Times-Roman":y,"Times-Bold":y,"Times-BoldItalic":y,"Times-Italic":y}},x={Unicode:{"Courier-Oblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":r("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":r("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:r("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:r("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":r("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":r("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};a.events.push(["addFont",function(B){var T=B.font,E=x.Unicode[T.postScriptName];E&&(T.metadata.Unicode={},T.metadata.Unicode.widths=E.widths,T.metadata.Unicode.kerning=E.kerning);var R=b.Unicode[T.postScriptName];R&&(T.metadata.Unicode.encoding=R,T.encoding=R.codePages[0])}])}(Qn.API),function(a){var e=function(i){for(var s=i.length,c=new Uint8Array(s),d=0;d<s;d++)c[d]=i.charCodeAt(d);return c};a.API.events.push(["addFont",function(i){var s=void 0,c=i.font,d=i.instance;if(!c.isStandardFont){if(d===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");if(typeof(s=d.existsFileInVFS(c.postScriptName)===!1?d.loadFile(c.postScriptName):d.getFileFromVFS(c.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");(function(A,r){r=/^\x00\x01\x00\x00/.test(r)?e(r):e(_y(r)),A.metadata=a.API.TTFFont.open(r),A.metadata.Unicode=A.metadata.Unicode||{encoding:{},kerning:{},widths:[]},A.metadata.glyIdsUsed=[0]})(c,s)}}])}(Qn),function(a){function e(){return(qn.canvg?Promise.resolve(qn.canvg):t1(()=>import("./index.es-C2Bt9BMS.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load canvg: "+i))}).then(function(i){return i.default?i.default:i})}Qn.API.addSvgAsImage=function(i,s,c,d,A,r,y,b){if(isNaN(s)||isNaN(c))throw ha.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(d)||isNaN(A))throw ha.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var x=document.createElement("canvas");x.width=d,x.height=A;var B=x.getContext("2d");B.fillStyle="#fff",B.fillRect(0,0,x.width,x.height);var T={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},E=this;return e().then(function(R){return R.fromString(B,i,T)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(T)}).then(function(){E.addImage(x.toDataURL("image/jpeg",1),s,c,d,A,y,b)})}}(),Qn.API.putTotalPages=function(a){var e,i=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(a,"g"),i=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(a,this.internal.getFont()),"g"),i=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var c=0;c<this.internal.pages[s].length;c++)this.internal.pages[s][c]=this.internal.pages[s][c].replace(e,i);return this},Qn.API.viewerPreferences=function(a,e){var i;a=a||{},e=e||!1;var s,c,d,A={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},r=Object.keys(A),y=[],b=0,x=0,B=0;function T(R,P){var G,U=!1;for(G=0;G<R.length;G+=1)R[G]===P&&(U=!0);return U}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(A)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,a==="reset"||e===!0){var E=r.length;for(B=0;B<E;B+=1)i[r[B]].value=i[r[B]].defaultValue,i[r[B]].explicitSet=!1}if(Go(a)==="object"){for(c in a)if(d=a[c],T(r,c)&&d!==void 0){if(i[c].type==="boolean"&&typeof d=="boolean")i[c].value=d;else if(i[c].type==="name"&&T(i[c].valueSet,d))i[c].value=d;else if(i[c].type==="integer"&&Number.isInteger(d))i[c].value=d;else if(i[c].type==="array"){for(b=0;b<d.length;b+=1)if(s=!0,d[b].length===1&&typeof d[b][0]=="number")y.push(String(d[b]-1));else if(d[b].length>1){for(x=0;x<d[b].length;x+=1)typeof d[b][x]!="number"&&(s=!1);s===!0&&y.push([d[b][0]-1,d[b][1]-1].join(" "))}i[c].value="["+y.join(" ")+"]"}else i[c].value=i[c].defaultValue;i[c].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var R,P=[];for(R in i)i[R].explicitSet===!0&&(i[R].type==="name"?P.push("/"+R+" /"+i[R].value):P.push("/"+R+" "+i[R].value));P.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+P.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},function(a){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',c=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),d=unescape(encodeURIComponent(s)),A=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),y=unescape(encodeURIComponent("</x:xmpmeta>")),b=d.length+A.length+r.length+c.length+y.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+b+" >>"),this.internal.write("stream"),this.internal.write(c+d+A+r+y),this.internal.write("endstream"),this.internal.write("endobj")},i=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};a.addMetadata=function(s,c){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:c||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",i),this.internal.events.subscribe("postPutResources",e)),this}}(Qn.API),function(a){var e=a.API,i=e.pdfEscape16=function(d,A){for(var r,y=A.metadata.Unicode.widths,b=["","0","00","000","0000"],x=[""],B=0,T=d.length;B<T;++B){if(r=A.metadata.characterToGlyph(d.charCodeAt(B)),A.metadata.glyIdsUsed.push(r),A.metadata.toUnicode[r]=d.charCodeAt(B),y.indexOf(r)==-1&&(y.push(r),y.push([parseInt(A.metadata.widthOfGlyph(r),10)])),r=="0")return x.join("");r=r.toString(16),x.push(b[4-r.length],r)}return x.join("")},s=function(d){var A,r,y,b,x,B,T;for(x=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,y=[],B=0,T=(r=Object.keys(d).sort(function(E,R){return E-R})).length;B<T;B++)A=r[B],y.length>=100&&(x+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar`,y=[]),d[A]!==void 0&&d[A]!==null&&typeof d[A].toString=="function"&&(b=("0000"+d[A].toString(16)).slice(-4),A=("0000"+(+A).toString(16)).slice(-4),y.push("<"+A+"><"+b+">"));return y.length&&(x+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar
`),x+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(d){(function(A){var r=A.font,y=A.out,b=A.newObject,x=A.putStream;if(r.metadata instanceof a.API.TTFFont&&r.encoding==="Identity-H"){for(var B=r.metadata.Unicode.widths,T=r.metadata.subset.encode(r.metadata.glyIdsUsed,1),E="",R=0;R<T.length;R++)E+=String.fromCharCode(T[R]);var P=b();x({data:E,addLength1:!0,objectId:P}),y("endobj");var G=b();x({data:s(r.metadata.toUnicode),addLength1:!0,objectId:G}),y("endobj");var U=b();y("<<"),y("/Type /FontDescriptor"),y("/FontName /"+Xg(r.fontName)),y("/FontFile2 "+P+" 0 R"),y("/FontBBox "+a.API.PDFObject.convert(r.metadata.bbox)),y("/Flags "+r.metadata.flags),y("/StemV "+r.metadata.stemV),y("/ItalicAngle "+r.metadata.italicAngle),y("/Ascent "+r.metadata.ascender),y("/Descent "+r.metadata.decender),y("/CapHeight "+r.metadata.capHeight),y(">>"),y("endobj");var Q=b();y("<<"),y("/Type /Font"),y("/BaseFont /"+Xg(r.fontName)),y("/FontDescriptor "+U+" 0 R"),y("/W "+a.API.PDFObject.convert(B)),y("/CIDToGIDMap /Identity"),y("/DW 1000"),y("/Subtype /CIDFontType2"),y("/CIDSystemInfo"),y("<<"),y("/Supplement 0"),y("/Registry (Adobe)"),y("/Ordering ("+r.encoding+")"),y(">>"),y(">>"),y("endobj"),r.objectNumber=b(),y("<<"),y("/Type /Font"),y("/Subtype /Type0"),y("/ToUnicode "+G+" 0 R"),y("/BaseFont /"+Xg(r.fontName)),y("/Encoding /"+r.encoding),y("/DescendantFonts ["+Q+" 0 R]"),y(">>"),y("endobj"),r.isAlreadyPutted=!0}})(d)}]),e.events.push(["putFont",function(d){(function(A){var r=A.font,y=A.out,b=A.newObject,x=A.putStream;if(r.metadata instanceof a.API.TTFFont&&r.encoding==="WinAnsiEncoding"){for(var B=r.metadata.rawData,T="",E=0;E<B.length;E++)T+=String.fromCharCode(B[E]);var R=b();x({data:T,addLength1:!0,objectId:R}),y("endobj");var P=b();x({data:s(r.metadata.toUnicode),addLength1:!0,objectId:P}),y("endobj");var G=b();y("<<"),y("/Descent "+r.metadata.decender),y("/CapHeight "+r.metadata.capHeight),y("/StemV "+r.metadata.stemV),y("/Type /FontDescriptor"),y("/FontFile2 "+R+" 0 R"),y("/Flags 96"),y("/FontBBox "+a.API.PDFObject.convert(r.metadata.bbox)),y("/FontName /"+Xg(r.fontName)),y("/ItalicAngle "+r.metadata.italicAngle),y("/Ascent "+r.metadata.ascender),y(">>"),y("endobj"),r.objectNumber=b();for(var U=0;U<r.metadata.hmtx.widths.length;U++)r.metadata.hmtx.widths[U]=parseInt(r.metadata.hmtx.widths[U]*(1e3/r.metadata.head.unitsPerEm));y("<</Subtype/TrueType/Type/Font/ToUnicode "+P+" 0 R/BaseFont/"+Xg(r.fontName)+"/FontDescriptor "+G+" 0 R/Encoding/"+r.encoding+" /FirstChar 29 /LastChar 255 /Widths "+a.API.PDFObject.convert(r.metadata.hmtx.widths)+">>"),y("endobj"),r.isAlreadyPutted=!0}})(d)}]);var c=function(d){var A,r=d.text||"",y=d.x,b=d.y,x=d.options||{},B=d.mutex||{},T=B.pdfEscape,E=B.activeFontKey,R=B.fonts,P=E,G="",U=0,Q="",q=R[P].encoding;if(R[P].encoding!=="Identity-H")return{text:r,x:y,y:b,options:x,mutex:B};for(Q=r,P=E,Array.isArray(r)&&(Q=r[0]),U=0;U<Q.length;U+=1)R[P].metadata.hasOwnProperty("cmap")&&(A=R[P].metadata.cmap.unicode.codeMap[Q[U].charCodeAt(0)]),A||Q[U].charCodeAt(0)<256&&R[P].metadata.hasOwnProperty("Unicode")?G+=Q[U]:G+="";var ne="";return parseInt(P.slice(1))<14||q==="WinAnsiEncoding"?ne=T(G,P).split("").map(function(re){return re.charCodeAt(0).toString(16)}).join(""):q==="Identity-H"&&(ne=i(G,R[P])),B.isHex=!0,{text:ne,x:y,y:b,options:x,mutex:B}};e.events.push(["postProcessText",function(d){var A=d.text||"",r=[],y={text:A,x:d.x,y:d.y,options:d.options,mutex:d.mutex};if(Array.isArray(A)){var b=0;for(b=0;b<A.length;b+=1)Array.isArray(A[b])&&A[b].length===3?r.push([c(Object.assign({},y,{text:A[b][0]})).text,A[b][1],A[b][2]]):r.push(c(Object.assign({},y,{text:A[b]})).text);d.text=r}else d.text=c(Object.assign({},y,{text:A})).text}])}(Qn),function(a){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};a.existsFileInVFS=function(i){return e.call(this),this.internal.vFS[i]!==void 0},a.addFileToVFS=function(i,s){return e.call(this),this.internal.vFS[i]=s,this},a.getFileFromVFS=function(i){return e.call(this),this.internal.vFS[i]!==void 0?this.internal.vFS[i]:null}}(Qn.API),function(a){a.__bidiEngine__=a.prototype.__bidiEngine__=function(s){var c,d,A,r,y,b,x,B=e,T=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],E=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],R={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},P={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},G=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],U=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Q=!1,q=0;this.__bidiEngine__={};var ne=function(oe){var ye=oe.charCodeAt(),Me=ye>>8,Be=P[Me];return Be!==void 0?B[256*Be+(255&ye)]:Me===252||Me===253?"AL":U.test(Me)?"L":Me===8?"R":"N"},re=function(oe){for(var ye,Me=0;Me<oe.length;Me++){if((ye=ne(oe.charAt(Me)))==="L")return!1;if(ye==="R")return!0}return!1},pe=function(oe,ye,Me,Be){var Pe,De,et,Ye,bt=ye[Be];switch(bt){case"L":case"R":Q=!1;break;case"N":case"AN":break;case"EN":Q&&(bt="AN");break;case"AL":Q=!0,bt="R";break;case"WS":bt="N";break;case"CS":Be<1||Be+1>=ye.length||(Pe=Me[Be-1])!=="EN"&&Pe!=="AN"||(De=ye[Be+1])!=="EN"&&De!=="AN"?bt="N":Q&&(De="AN"),bt=De===Pe?De:"N";break;case"ES":bt=(Pe=Be>0?Me[Be-1]:"B")==="EN"&&Be+1<ye.length&&ye[Be+1]==="EN"?"EN":"N";break;case"ET":if(Be>0&&Me[Be-1]==="EN"){bt="EN";break}if(Q){bt="N";break}for(et=Be+1,Ye=ye.length;et<Ye&&ye[et]==="ET";)et++;bt=et<Ye&&ye[et]==="EN"?"EN":"N";break;case"NSM":if(A&&!r){for(Ye=ye.length,et=Be+1;et<Ye&&ye[et]==="NSM";)et++;if(et<Ye){var pt=oe[Be],Qt=pt>=1425&&pt<=2303||pt===64286;if(Pe=ye[et],Qt&&(Pe==="R"||Pe==="AL")){bt="R";break}}}bt=Be<1||(Pe=ye[Be-1])==="B"?"N":Me[Be-1];break;case"B":Q=!1,c=!0,bt=q;break;case"S":d=!0,bt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Q=!1;break;case"BN":bt="N"}return bt},fe=function(oe,ye,Me){var Be=oe.split("");return Me&&he(Be,Me,{hiLevel:q}),Be.reverse(),ye&&ye.reverse(),Be.join("")},he=function(oe,ye,Me){var Be,Pe,De,et,Ye,bt=-1,pt=oe.length,Qt=0,Ie=[],ot=q?E:T,ut=[];for(Q=!1,c=!1,d=!1,Pe=0;Pe<pt;Pe++)ut[Pe]=ne(oe[Pe]);for(De=0;De<pt;De++){if(Ye=Qt,Ie[De]=pe(oe,ut,Ie,De),Be=240&(Qt=ot[Ye][R[Ie[De]]]),Qt&=15,ye[De]=et=ot[Qt][5],Be>0)if(Be===16){for(Pe=bt;Pe<De;Pe++)ye[Pe]=1;bt=-1}else bt=-1;if(ot[Qt][6])bt===-1&&(bt=De);else if(bt>-1){for(Pe=bt;Pe<De;Pe++)ye[Pe]=et;bt=-1}ut[De]==="B"&&(ye[De]=0),Me.hiLevel|=et}d&&function(mt,Ct,rt){for(var Bt=0;Bt<rt;Bt++)if(mt[Bt]==="S"){Ct[Bt]=q;for(var tt=Bt-1;tt>=0&&mt[tt]==="WS";tt--)Ct[tt]=q}}(ut,ye,pt)},be=function(oe,ye,Me,Be,Pe){if(!(Pe.hiLevel<oe)){if(oe===1&&q===1&&!c)return ye.reverse(),void(Me&&Me.reverse());for(var De,et,Ye,bt,pt=ye.length,Qt=0;Qt<pt;){if(Be[Qt]>=oe){for(Ye=Qt+1;Ye<pt&&Be[Ye]>=oe;)Ye++;for(bt=Qt,et=Ye-1;bt<et;bt++,et--)De=ye[bt],ye[bt]=ye[et],ye[et]=De,Me&&(De=Me[bt],Me[bt]=Me[et],Me[et]=De);Qt=Ye}Qt++}}},Se=function(oe,ye,Me){var Be=oe.split(""),Pe={hiLevel:q};return Me||(Me=[]),he(Be,Me,Pe),function(De,et,Ye){if(Ye.hiLevel!==0&&x)for(var bt,pt=0;pt<De.length;pt++)et[pt]===1&&(bt=G.indexOf(De[pt]))>=0&&(De[pt]=G[bt+1])}(Be,Me,Pe),be(2,Be,ye,Me,Pe),be(1,Be,ye,Me,Pe),Be.join("")};return this.__bidiEngine__.doBidiReorder=function(oe,ye,Me){if(function(Pe,De){if(De)for(var et=0;et<Pe.length;et++)De[et]=et;r===void 0&&(r=re(Pe)),b===void 0&&(b=re(Pe))}(oe,ye),A||!y||b)if(A&&y&&r^b)q=r?1:0,oe=fe(oe,ye,Me);else if(!A&&y&&b)q=r?1:0,oe=Se(oe,ye,Me),oe=fe(oe,ye);else if(!A||r||y||b){if(A&&!y&&r^b)oe=fe(oe,ye),r?(q=0,oe=Se(oe,ye,Me)):(q=1,oe=Se(oe,ye,Me),oe=fe(oe,ye));else if(A&&r&&!y&&b)q=1,oe=Se(oe,ye,Me),oe=fe(oe,ye);else if(!A&&!y&&r^b){var Be=x;r?(q=1,oe=Se(oe,ye,Me),q=0,x=!1,oe=Se(oe,ye,Me),x=Be):(q=0,oe=Se(oe,ye,Me),oe=fe(oe,ye),q=1,x=!1,oe=Se(oe,ye,Me),x=Be,oe=fe(oe,ye))}}else q=0,oe=Se(oe,ye,Me);else q=r?1:0,oe=Se(oe,ye,Me);return oe},this.__bidiEngine__.setOptions=function(oe){oe&&(A=oe.isInputVisual,y=oe.isOutputVisual,r=oe.isInputRtl,b=oe.isOutputRtl,x=oe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],i=new a.__bidiEngine__({isInputVisual:!0});a.API.events.push(["postProcessText",function(s){var c=s.text;s.x,s.y;var d=s.options||{};s.mutex,d.lang;var A=[];if(d.isInputVisual=typeof d.isInputVisual!="boolean"||d.isInputVisual,i.setOptions(d),Object.prototype.toString.call(c)==="[object Array]"){var r=0;for(A=[],r=0;r<c.length;r+=1)Object.prototype.toString.call(c[r])==="[object Array]"?A.push([i.doBidiReorder(c[r][0]),c[r][1],c[r][2]]):A.push([i.doBidiReorder(c[r])]);s.text=A}else s.text=i.doBidiReorder(c);i.setOptions({isInputVisual:!0})}])}(Qn),Qn.API.TTFFont=function(){function a(e){var i;if(this.rawData=e,i=this.contents=new Sp(e),this.contents.pos=4,i.readString(4)==="ttcf")throw new Error("TTCF not supported.");i.pos=0,this.parse(),this.subset=new CU(this),this.registerTTF()}return a.open=function(e){return new a(e)},a.prototype.parse=function(){return this.directory=new hU(this.contents),this.head=new AU(this),this.name=new yU(this),this.cmap=new bI(this),this.toUnicode={},this.hhea=new fU(this),this.maxp=new vU(this),this.hmtx=new _U(this),this.post=new gU(this),this.os2=new pU(this),this.loca=new BU(this),this.glyf=new xU(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},a.prototype.registerTTF=function(){var e,i,s,c,d;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var A,r,y,b;for(b=[],A=0,r=(y=this.bbox).length;A<r;A++)e=y[A],b.push(Math.round(e*this.scaleFactor));return b}).call(this),this.stemV=0,this.post.exists?(s=255&(c=this.post.italic_angle),(32768&(i=c>>16))!=0&&(i=-(1+(65535^i))),this.italicAngle=+(i+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(d=this.familyClass)===1||d===2||d===3||d===4||d===5||d===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},a.prototype.characterToGlyph=function(e){var i;return((i=this.cmap.unicode)!=null?i.codeMap[e]:void 0)||0},a.prototype.widthOfGlyph=function(e){var i;return i=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*i},a.prototype.widthOfString=function(e,i,s){var c,d,A,r;for(A=0,d=0,r=(e=""+e).length;0<=r?d<r:d>r;d=0<=r?++d:--d)c=e.charCodeAt(d),A+=this.widthOfGlyph(this.characterToGlyph(c))+s*(1e3/i)||0;return A*(i/1e3)},a.prototype.lineHeight=function(e,i){var s;return i==null&&(i=!1),s=i?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},a}();var $d,Sp=function(){function a(e){this.data=e??[],this.pos=0,this.length=this.data.length}return a.prototype.readByte=function(){return this.data[this.pos++]},a.prototype.writeByte=function(e){return this.data[this.pos++]=e},a.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},a.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},a.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},a.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},a.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},a.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},a.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},a.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},a.prototype.readString=function(e){var i,s;for(s=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)s[i]=String.fromCharCode(this.readByte());return s.join("")},a.prototype.writeString=function(e){var i,s,c;for(c=[],i=0,s=e.length;0<=s?i<s:i>s;i=0<=s?++i:--i)c.push(this.writeByte(e.charCodeAt(i)));return c},a.prototype.readShort=function(){return this.readInt16()},a.prototype.writeShort=function(e){return this.writeInt16(e)},a.prototype.readLongLong=function(){var e,i,s,c,d,A,r,y;return e=this.readByte(),i=this.readByte(),s=this.readByte(),c=this.readByte(),d=this.readByte(),A=this.readByte(),r=this.readByte(),y=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^i)+1099511627776*(255^s)+4294967296*(255^c)+16777216*(255^d)+65536*(255^A)+256*(255^r)+(255^y)+1):72057594037927940*e+281474976710656*i+1099511627776*s+4294967296*c+16777216*d+65536*A+256*r+y},a.prototype.writeLongLong=function(e){var i,s;return i=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},a.prototype.readInt=function(){return this.readInt32()},a.prototype.writeInt=function(e){return this.writeInt32(e)},a.prototype.read=function(e){var i,s;for(i=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)i.push(this.readByte());return i},a.prototype.write=function(e){var i,s,c,d;for(d=[],s=0,c=e.length;s<c;s++)i=e[s],d.push(this.writeByte(i));return d},a}(),hU=function(){var a;function e(i){var s,c,d;for(this.scalarType=i.readInt(),this.tableCount=i.readShort(),this.searchRange=i.readShort(),this.entrySelector=i.readShort(),this.rangeShift=i.readShort(),this.tables={},c=0,d=this.tableCount;0<=d?c<d:c>d;c=0<=d?++c:--c)s={tag:i.readString(4),checksum:i.readInt(),offset:i.readInt(),length:i.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(i){var s,c,d,A,r,y,b,x,B,T,E,R,P;for(P in E=Object.keys(i).length,y=Math.log(2),B=16*Math.floor(Math.log(E)/y),A=Math.floor(B/y),x=16*E-B,(c=new Sp).writeInt(this.scalarType),c.writeShort(E),c.writeShort(B),c.writeShort(A),c.writeShort(x),d=16*E,b=c.pos+d,r=null,R=[],i)for(T=i[P],c.writeString(P),c.writeInt(a(T)),c.writeInt(b),c.writeInt(T.length),R=R.concat(T),P==="head"&&(r=b),b+=T.length;b%4;)R.push(0),b++;return c.write(R),s=2981146554-a(c.data),c.pos=r+8,c.writeUInt32(s),c.data},a=function(i){var s,c,d,A;for(i=wI.call(i);i.length%4;)i.push(0);for(d=new Sp(i),c=0,s=0,A=i.length;s<A;s=s+=4)c+=d.readUInt32();return 4294967295&c},e}(),dU={}.hasOwnProperty,WA=function(a,e){for(var i in e)dU.call(e,i)&&(a[i]=e[i]);function s(){this.constructor=a}return s.prototype=e.prototype,a.prototype=new s,a.__super__=e.prototype,a};$d=function(){function a(e){var i;this.file=e,i=this.file.directory.tables[this.tag],this.exists=!!i,i&&(this.offset=i.offset,this.length=i.length,this.parse(this.file.contents))}return a.prototype.parse=function(){},a.prototype.encode=function(){},a.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},a}();var AU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="head",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.revision=i.readInt(),this.checkSumAdjustment=i.readInt(),this.magicNumber=i.readInt(),this.flags=i.readShort(),this.unitsPerEm=i.readShort(),this.created=i.readLongLong(),this.modified=i.readLongLong(),this.xMin=i.readShort(),this.yMin=i.readShort(),this.xMax=i.readShort(),this.yMax=i.readShort(),this.macStyle=i.readShort(),this.lowestRecPPEM=i.readShort(),this.fontDirectionHint=i.readShort(),this.indexToLocFormat=i.readShort(),this.glyphDataFormat=i.readShort()},e.prototype.encode=function(i){var s;return(s=new Sp).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(i),s.writeShort(this.glyphDataFormat),s.data},e}(),LE=function(){function a(e,i){var s,c,d,A,r,y,b,x,B,T,E,R,P,G,U,Q,q;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=i+e.readInt(),B=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(y=0;y<256;++y)this.codeMap[y]=e.readByte();break;case 4:for(E=e.readUInt16(),T=E/2,e.pos+=6,d=function(){var ne,re;for(re=[],y=ne=0;0<=T?ne<T:ne>T;y=0<=T?++ne:--ne)re.push(e.readUInt16());return re}(),e.pos+=2,P=function(){var ne,re;for(re=[],y=ne=0;0<=T?ne<T:ne>T;y=0<=T?++ne:--ne)re.push(e.readUInt16());return re}(),b=function(){var ne,re;for(re=[],y=ne=0;0<=T?ne<T:ne>T;y=0<=T?++ne:--ne)re.push(e.readUInt16());return re}(),x=function(){var ne,re;for(re=[],y=ne=0;0<=T?ne<T:ne>T;y=0<=T?++ne:--ne)re.push(e.readUInt16());return re}(),c=(this.length-e.pos+this.offset)/2,r=function(){var ne,re;for(re=[],y=ne=0;0<=c?ne<c:ne>c;y=0<=c?++ne:--ne)re.push(e.readUInt16());return re}(),y=U=0,q=d.length;U<q;y=++U)for(G=d[y],s=Q=R=P[y];R<=G?Q<=G:Q>=G;s=R<=G?++Q:--Q)x[y]===0?A=s+b[y]:(A=r[x[y]/2+(s-R)-(T-y)]||0)!==0&&(A+=b[y]),this.codeMap[s]=65535&A}e.pos=B}return a.encode=function(e,i){var s,c,d,A,r,y,b,x,B,T,E,R,P,G,U,Q,q,ne,re,pe,fe,he,be,Se,oe,ye,Me,Be,Pe,De,et,Ye,bt,pt,Qt,Ie,ot,ut,mt,Ct,rt,Bt,tt,Ut,Ai,qe;switch(Be=new Sp,A=Object.keys(e).sort(function(Ke,Pt){return Ke-Pt}),i){case"macroman":for(P=0,G=function(){var Ke=[];for(R=0;R<256;++R)Ke.push(0);return Ke}(),Q={0:0},d={},Pe=0,bt=A.length;Pe<bt;Pe++)Q[tt=e[c=A[Pe]]]==null&&(Q[tt]=++P),d[c]={old:e[c],new:Q[e[c]]},G[c]=Q[e[c]];return Be.writeUInt16(1),Be.writeUInt16(0),Be.writeUInt32(12),Be.writeUInt16(0),Be.writeUInt16(262),Be.writeUInt16(0),Be.write(G),{charMap:d,subtable:Be.data,maxGlyphID:P+1};case"unicode":for(ye=[],B=[],q=0,Q={},s={},U=b=null,De=0,pt=A.length;De<pt;De++)Q[re=e[c=A[De]]]==null&&(Q[re]=++q),s[c]={old:re,new:Q[re]},r=Q[re]-c,U!=null&&r===b||(U&&B.push(U),ye.push(c),b=r),U=c;for(U&&B.push(U),B.push(65535),ye.push(65535),Se=2*(be=ye.length),he=2*Math.pow(Math.log(be)/Math.LN2,2),T=Math.log(he/2)/Math.LN2,fe=2*be-he,y=[],pe=[],E=[],R=et=0,Qt=ye.length;et<Qt;R=++et){if(oe=ye[R],x=B[R],oe===65535){y.push(0),pe.push(0);break}if(oe-(Me=s[oe].new)>=32768)for(y.push(0),pe.push(2*(E.length+be-R)),c=Ye=oe;oe<=x?Ye<=x:Ye>=x;c=oe<=x?++Ye:--Ye)E.push(s[c].new);else y.push(Me-oe),pe.push(0)}for(Be.writeUInt16(3),Be.writeUInt16(1),Be.writeUInt32(12),Be.writeUInt16(4),Be.writeUInt16(16+8*be+2*E.length),Be.writeUInt16(0),Be.writeUInt16(Se),Be.writeUInt16(he),Be.writeUInt16(T),Be.writeUInt16(fe),rt=0,Ie=B.length;rt<Ie;rt++)c=B[rt],Be.writeUInt16(c);for(Be.writeUInt16(0),Bt=0,ot=ye.length;Bt<ot;Bt++)c=ye[Bt],Be.writeUInt16(c);for(Ut=0,ut=y.length;Ut<ut;Ut++)r=y[Ut],Be.writeUInt16(r);for(Ai=0,mt=pe.length;Ai<mt;Ai++)ne=pe[Ai],Be.writeUInt16(ne);for(qe=0,Ct=E.length;qe<Ct;qe++)P=E[qe],Be.writeUInt16(P);return{charMap:s,subtable:Be.data,maxGlyphID:q+1}}},a}(),bI=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="cmap",e.prototype.parse=function(i){var s,c,d;for(i.pos=this.offset,this.version=i.readUInt16(),d=i.readUInt16(),this.tables=[],this.unicode=null,c=0;0<=d?c<d:c>d;c=0<=d?++c:--c)s=new LE(i,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(i,s){var c,d;return s==null&&(s="macroman"),c=LE.encode(i,s),(d=new Sp).writeUInt16(0),d.writeUInt16(1),c.table=d.data.concat(c.subtable),c},e}(),fU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="hhea",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.ascender=i.readShort(),this.decender=i.readShort(),this.lineGap=i.readShort(),this.advanceWidthMax=i.readShort(),this.minLeftSideBearing=i.readShort(),this.minRightSideBearing=i.readShort(),this.xMaxExtent=i.readShort(),this.caretSlopeRise=i.readShort(),this.caretSlopeRun=i.readShort(),this.caretOffset=i.readShort(),i.pos+=8,this.metricDataFormat=i.readShort(),this.numberOfMetrics=i.readUInt16()},e}(),pU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="OS/2",e.prototype.parse=function(i){if(i.pos=this.offset,this.version=i.readUInt16(),this.averageCharWidth=i.readShort(),this.weightClass=i.readUInt16(),this.widthClass=i.readUInt16(),this.type=i.readShort(),this.ySubscriptXSize=i.readShort(),this.ySubscriptYSize=i.readShort(),this.ySubscriptXOffset=i.readShort(),this.ySubscriptYOffset=i.readShort(),this.ySuperscriptXSize=i.readShort(),this.ySuperscriptYSize=i.readShort(),this.ySuperscriptXOffset=i.readShort(),this.ySuperscriptYOffset=i.readShort(),this.yStrikeoutSize=i.readShort(),this.yStrikeoutPosition=i.readShort(),this.familyClass=i.readShort(),this.panose=function(){var s,c;for(c=[],s=0;s<10;++s)c.push(i.readByte());return c}(),this.charRange=function(){var s,c;for(c=[],s=0;s<4;++s)c.push(i.readInt());return c}(),this.vendorID=i.readString(4),this.selection=i.readShort(),this.firstCharIndex=i.readShort(),this.lastCharIndex=i.readShort(),this.version>0&&(this.ascent=i.readShort(),this.descent=i.readShort(),this.lineGap=i.readShort(),this.winAscent=i.readShort(),this.winDescent=i.readShort(),this.codePageRange=function(){var s,c;for(c=[],s=0;s<2;s=++s)c.push(i.readInt());return c}(),this.version>1))return this.xHeight=i.readShort(),this.capHeight=i.readShort(),this.defaultChar=i.readShort(),this.breakChar=i.readShort(),this.maxContext=i.readShort()},e}(),gU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="post",e.prototype.parse=function(i){var s,c,d;switch(i.pos=this.offset,this.format=i.readInt(),this.italicAngle=i.readInt(),this.underlinePosition=i.readShort(),this.underlineThickness=i.readShort(),this.isFixedPitch=i.readInt(),this.minMemType42=i.readInt(),this.maxMemType42=i.readInt(),this.minMemType1=i.readInt(),this.maxMemType1=i.readInt(),this.format){case 65536:break;case 131072:var A;for(c=i.readUInt16(),this.glyphNameIndex=[],A=0;0<=c?A<c:A>c;A=0<=c?++A:--A)this.glyphNameIndex.push(i.readUInt16());for(this.names=[],d=[];i.pos<this.offset+this.length;)s=i.readByte(),d.push(this.names.push(i.readString(s)));return d;case 151552:return c=i.readUInt16(),this.offsets=i.read(c);case 196608:break;case 262144:return this.map=(function(){var r,y,b;for(b=[],A=r=0,y=this.file.maxp.numGlyphs;0<=y?r<y:r>y;A=0<=y?++r:--r)b.push(i.readUInt32());return b}).call(this)}},e}(),mU=function(a,e){this.raw=a,this.length=a.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},yU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="name",e.prototype.parse=function(i){var s,c,d,A,r,y,b,x,B,T,E;for(i.pos=this.offset,i.readShort(),s=i.readShort(),y=i.readShort(),c=[],A=0;0<=s?A<s:A>s;A=0<=s?++A:--A)c.push({platformID:i.readShort(),encodingID:i.readShort(),languageID:i.readShort(),nameID:i.readShort(),length:i.readShort(),offset:this.offset+y+i.readShort()});for(b={},A=B=0,T=c.length;B<T;A=++B)d=c[A],i.pos=d.offset,x=i.readString(d.length),r=new mU(x,d),b[E=d.nameID]==null&&(b[E]=[]),b[d.nameID].push(r);this.strings=b,this.copyright=b[0],this.fontFamily=b[1],this.fontSubfamily=b[2],this.uniqueSubfamily=b[3],this.fontName=b[4],this.version=b[5];try{this.postscriptName=b[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=b[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=b[7],this.manufacturer=b[8],this.designer=b[9],this.description=b[10],this.vendorUrl=b[11],this.designerUrl=b[12],this.license=b[13],this.licenseUrl=b[14],this.preferredFamily=b[15],this.preferredSubfamily=b[17],this.compatibleFull=b[18],this.sampleText=b[19]},e}(),vU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="maxp",e.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.numGlyphs=i.readUInt16(),this.maxPoints=i.readUInt16(),this.maxContours=i.readUInt16(),this.maxCompositePoints=i.readUInt16(),this.maxComponentContours=i.readUInt16(),this.maxZones=i.readUInt16(),this.maxTwilightPoints=i.readUInt16(),this.maxStorage=i.readUInt16(),this.maxFunctionDefs=i.readUInt16(),this.maxInstructionDefs=i.readUInt16(),this.maxStackElements=i.readUInt16(),this.maxSizeOfInstructions=i.readUInt16(),this.maxComponentElements=i.readUInt16(),this.maxComponentDepth=i.readUInt16()},e}(),_U=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="hmtx",e.prototype.parse=function(i){var s,c,d,A,r,y,b;for(i.pos=this.offset,this.metrics=[],s=0,y=this.file.hhea.numberOfMetrics;0<=y?s<y:s>y;s=0<=y?++s:--s)this.metrics.push({advance:i.readUInt16(),lsb:i.readInt16()});for(d=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var x,B;for(B=[],s=x=0;0<=d?x<d:x>d;s=0<=d?++x:--x)B.push(i.readInt16());return B}(),this.widths=(function(){var x,B,T,E;for(E=[],x=0,B=(T=this.metrics).length;x<B;x++)A=T[x],E.push(A.advance);return E}).call(this),c=this.widths[this.widths.length-1],b=[],s=r=0;0<=d?r<d:r>d;s=0<=d?++r:--r)b.push(this.widths.push(c));return b},e.prototype.forGlyph=function(i){return i in this.metrics?this.metrics[i]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[i-this.metrics.length]}},e}(),wI=[].slice,xU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(i){var s,c,d,A,r,y,b,x,B,T;return i in this.cache?this.cache[i]:(A=this.file.loca,s=this.file.contents,c=A.indexOf(i),(d=A.lengthOf(i))===0?this.cache[i]=null:(s.pos=this.offset+c,r=(y=new Sp(s.read(d))).readShort(),x=y.readShort(),T=y.readShort(),b=y.readShort(),B=y.readShort(),this.cache[i]=r===-1?new wU(y,x,T,b,B):new bU(y,r,x,T,b,B),this.cache[i]))},e.prototype.encode=function(i,s,c){var d,A,r,y,b;for(r=[],A=[],y=0,b=s.length;y<b;y++)d=i[s[y]],A.push(r.length),d&&(r=r.concat(d.encode(c)));return A.push(r.length),{table:r,offsets:A}},e}(),bU=function(){function a(e,i,s,c,d,A){this.raw=e,this.numberOfContours=i,this.xMin=s,this.yMin=c,this.xMax=d,this.yMax=A,this.compound=!1}return a.prototype.encode=function(){return this.raw.data},a}(),wU=function(){function a(e,i,s,c,d){var A,r;for(this.raw=e,this.xMin=i,this.yMin=s,this.xMax=c,this.yMax=d,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],A=this.raw;r=A.readShort(),this.glyphOffsets.push(A.pos),this.glyphIDs.push(A.readUInt16()),32&r;)A.pos+=1&r?4:2,128&r?A.pos+=8:64&r?A.pos+=4:8&r&&(A.pos+=2)}return a.prototype.encode=function(){var e,i,s;for(i=new Sp(wI.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)i.pos=this.glyphOffsets[e];return i.data},a}(),BU=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return WA(e,$d),e.prototype.tag="loca",e.prototype.parse=function(i){var s,c;return i.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?(function(){var d,A;for(A=[],c=0,d=this.length;c<d;c+=2)A.push(2*i.readUInt16());return A}).call(this):(function(){var d,A;for(A=[],c=0,d=this.length;c<d;c+=4)A.push(i.readUInt32());return A}).call(this)},e.prototype.indexOf=function(i){return this.offsets[i]},e.prototype.lengthOf=function(i){return this.offsets[i+1]-this.offsets[i]},e.prototype.encode=function(i,s){for(var c=new Uint32Array(this.offsets.length),d=0,A=0,r=0;r<c.length;++r)if(c[r]=d,A<s.length&&s[A]==r){++A,c[r]=d;var y=this.offsets[r],b=this.offsets[r+1]-y;b>0&&(d+=b)}for(var x=new Array(4*c.length),B=0;B<c.length;++B)x[4*B+3]=255&c[B],x[4*B+2]=(65280&c[B])>>8,x[4*B+1]=(16711680&c[B])>>16,x[4*B]=(4278190080&c[B])>>24;return x},e}(),CU=function(){function a(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return a.prototype.generateCmap=function(){var e,i,s,c,d;for(i in c=this.font.cmap.tables[0].codeMap,e={},d=this.subset)s=d[i],e[i]=c[s];return e},a.prototype.glyphsFor=function(e){var i,s,c,d,A,r,y;for(c={},A=0,r=e.length;A<r;A++)c[d=e[A]]=this.font.glyf.glyphFor(d);for(d in i=[],c)(s=c[d])!=null&&s.compound&&i.push.apply(i,s.glyphIDs);if(i.length>0)for(d in y=this.glyphsFor(i))s=y[d],c[d]=s;return c},a.prototype.encode=function(e,i){var s,c,d,A,r,y,b,x,B,T,E,R,P,G,U;for(c in s=bI.encode(this.generateCmap(),"unicode"),A=this.glyphsFor(e),E={0:0},U=s.charMap)E[(y=U[c]).old]=y.new;for(R in T=s.maxGlyphID,A)R in E||(E[R]=T++);return x=function(Q){var q,ne;for(q in ne={},Q)ne[Q[q]]=q;return ne}(E),B=Object.keys(x).sort(function(Q,q){return Q-q}),P=function(){var Q,q,ne;for(ne=[],Q=0,q=B.length;Q<q;Q++)r=B[Q],ne.push(x[r]);return ne}(),d=this.font.glyf.encode(A,P,E),b=this.font.loca.encode(d.offsets,P),G={cmap:this.font.cmap.raw(),glyf:d.table,loca:b,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(i)},this.font.os2.exists&&(G["OS/2"]=this.font.os2.raw()),this.font.directory.encode(G)},a}();Qn.API.PDFObject=function(){var a;function e(){}return a=function(i,s){return(Array(s+1).join("0")+i).slice(-s)},e.convert=function(i){var s,c,d,A;if(Array.isArray(i))return"["+function(){var r,y,b;for(b=[],r=0,y=i.length;r<y;r++)s=i[r],b.push(e.convert(s));return b}().join(" ")+"]";if(typeof i=="string")return"/"+i;if(i!=null&&i.isString)return"("+i+")";if(i instanceof Date)return"(D:"+a(i.getUTCFullYear(),4)+a(i.getUTCMonth(),2)+a(i.getUTCDate(),2)+a(i.getUTCHours(),2)+a(i.getUTCMinutes(),2)+a(i.getUTCSeconds(),2)+"Z)";if({}.toString.call(i)==="[object Object]"){for(c in d=["<<"],i)A=i[c],d.push("/"+c+" "+e.convert(A));return d.push(">>"),d.join(`
`)}return""+i},e}();const SU=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:rU,AcroFormAppearance:mn,AcroFormButton:Xl,AcroFormCheckBox:wy,AcroFormChoiceField:ug,AcroFormComboBox:dg,AcroFormEditBox:xy,AcroFormListBox:hg,AcroFormPasswordField:By,AcroFormPushButton:by,AcroFormRadioButton:Ag,AcroFormTextField:mp,GState:Ny,ShadingPattern:Ap,TilingPattern:og,default:Qn,jsPDF:Qn},Symbol.toStringTag,{value:"Module"})),EU=tR(SU);var mv={exports:{}};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */var TU=mv.exports,ME;function IU(){return ME||(ME=1,function(a,e){(function(i,s){a.exports=s()})(TU,function(){/*! *****************************************************************************
		    Copyright (c) Microsoft Corporation.

		    Permission to use, copy, modify, and/or distribute this software for any
		    purpose with or without fee is hereby granted.

		    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		    PERFORMANCE OF THIS SOFTWARE.
		    ***************************************************************************** */var i=function(N,O){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,W){X.__proto__=W}||function(X,W){for(var le in W)Object.prototype.hasOwnProperty.call(W,le)&&(X[le]=W[le])},i(N,O)};function s(N,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");i(N,O);function X(){this.constructor=N}N.prototype=O===null?Object.create(O):(X.prototype=O.prototype,new X)}var c=function(){return c=Object.assign||function(O){for(var X,W=1,le=arguments.length;W<le;W++){X=arguments[W];for(var we in X)Object.prototype.hasOwnProperty.call(X,we)&&(O[we]=X[we])}return O},c.apply(this,arguments)};function d(N,O,X,W){function le(we){return we instanceof X?we:new X(function(Re){Re(we)})}return new(X||(X=Promise))(function(we,Re){function ft(si){try{Ht(W.next(si))}catch(gi){Re(gi)}}function At(si){try{Ht(W.throw(si))}catch(gi){Re(gi)}}function Ht(si){si.done?we(si.value):le(si.value).then(ft,At)}Ht((W=W.apply(N,[])).next())})}function A(N,O){var X={label:0,sent:function(){if(we[0]&1)throw we[1];return we[1]},trys:[],ops:[]},W,le,we,Re;return Re={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(Re[Symbol.iterator]=function(){return this}),Re;function ft(Ht){return function(si){return At([Ht,si])}}function At(Ht){if(W)throw new TypeError("Generator is already executing.");for(;X;)try{if(W=1,le&&(we=Ht[0]&2?le.return:Ht[0]?le.throw||((we=le.return)&&we.call(le),0):le.next)&&!(we=we.call(le,Ht[1])).done)return we;switch(le=0,we&&(Ht=[Ht[0]&2,we.value]),Ht[0]){case 0:case 1:we=Ht;break;case 4:return X.label++,{value:Ht[1],done:!1};case 5:X.label++,le=Ht[1],Ht=[0];continue;case 7:Ht=X.ops.pop(),X.trys.pop();continue;default:if(we=X.trys,!(we=we.length>0&&we[we.length-1])&&(Ht[0]===6||Ht[0]===2)){X=0;continue}if(Ht[0]===3&&(!we||Ht[1]>we[0]&&Ht[1]<we[3])){X.label=Ht[1];break}if(Ht[0]===6&&X.label<we[1]){X.label=we[1],we=Ht;break}if(we&&X.label<we[2]){X.label=we[2],X.ops.push(Ht);break}we[2]&&X.ops.pop(),X.trys.pop();continue}Ht=O.call(N,X)}catch(si){Ht=[6,si],le=0}finally{W=we=0}if(Ht[0]&5)throw Ht[1];return{value:Ht[0]?Ht[1]:void 0,done:!0}}}function r(N,O,X){if(arguments.length===2)for(var W=0,le=O.length,we;W<le;W++)(we||!(W in O))&&(we||(we=Array.prototype.slice.call(O,0,W)),we[W]=O[W]);return N.concat(we||O)}for(var y=function(){function N(O,X,W,le){this.left=O,this.top=X,this.width=W,this.height=le}return N.prototype.add=function(O,X,W,le){return new N(this.left+O,this.top+X,this.width+W,this.height+le)},N.fromClientRect=function(O,X){return new N(X.left+O.windowBounds.left,X.top+O.windowBounds.top,X.width,X.height)},N.fromDOMRectList=function(O,X){var W=Array.from(X).find(function(le){return le.width!==0});return W?new N(W.left+O.windowBounds.left,W.top+O.windowBounds.top,W.width,W.height):N.EMPTY},N.EMPTY=new N(0,0,0,0),N}(),b=function(N,O){return y.fromClientRect(N,O.getBoundingClientRect())},x=function(N){var O=N.body,X=N.documentElement;if(!O||!X)throw new Error("Unable to get document size");var W=Math.max(Math.max(O.scrollWidth,X.scrollWidth),Math.max(O.offsetWidth,X.offsetWidth),Math.max(O.clientWidth,X.clientWidth)),le=Math.max(Math.max(O.scrollHeight,X.scrollHeight),Math.max(O.offsetHeight,X.offsetHeight),Math.max(O.clientHeight,X.clientHeight));return new y(0,0,W,le)},B=function(N){for(var O=[],X=0,W=N.length;X<W;){var le=N.charCodeAt(X++);if(le>=55296&&le<=56319&&X<W){var we=N.charCodeAt(X++);(we&64512)===56320?O.push(((le&1023)<<10)+(we&1023)+65536):(O.push(le),X--)}else O.push(le)}return O},T=function(){for(var N=[],O=0;O<arguments.length;O++)N[O]=arguments[O];if(String.fromCodePoint)return String.fromCodePoint.apply(String,N);var X=N.length;if(!X)return"";for(var W=[],le=-1,we="";++le<X;){var Re=N[le];Re<=65535?W.push(Re):(Re-=65536,W.push((Re>>10)+55296,Re%1024+56320)),(le+1===X||W.length>16384)&&(we+=String.fromCharCode.apply(String,W),W.length=0)}return we},E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=typeof Uint8Array>"u"?[]:new Uint8Array(256),P=0;P<E.length;P++)R[E.charCodeAt(P)]=P;for(var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",U=typeof Uint8Array>"u"?[]:new Uint8Array(256),Q=0;Q<G.length;Q++)U[G.charCodeAt(Q)]=Q;for(var q=function(N){var O=N.length*.75,X=N.length,W,le=0,we,Re,ft,At;N[N.length-1]==="="&&(O--,N[N.length-2]==="="&&O--);var Ht=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(O):new Array(O),si=Array.isArray(Ht)?Ht:new Uint8Array(Ht);for(W=0;W<X;W+=4)we=U[N.charCodeAt(W)],Re=U[N.charCodeAt(W+1)],ft=U[N.charCodeAt(W+2)],At=U[N.charCodeAt(W+3)],si[le++]=we<<2|Re>>4,si[le++]=(Re&15)<<4|ft>>2,si[le++]=(ft&3)<<6|At&63;return Ht},ne=function(N){for(var O=N.length,X=[],W=0;W<O;W+=2)X.push(N[W+1]<<8|N[W]);return X},re=function(N){for(var O=N.length,X=[],W=0;W<O;W+=4)X.push(N[W+3]<<24|N[W+2]<<16|N[W+1]<<8|N[W]);return X},pe=5,fe=11,he=2,be=fe-pe,Se=65536>>pe,oe=1<<pe,ye=oe-1,Me=1024>>pe,Be=Se+Me,Pe=Be,De=32,et=Pe+De,Ye=65536>>fe,bt=1<<be,pt=bt-1,Qt=function(N,O,X){return N.slice?N.slice(O,X):new Uint16Array(Array.prototype.slice.call(N,O,X))},Ie=function(N,O,X){return N.slice?N.slice(O,X):new Uint32Array(Array.prototype.slice.call(N,O,X))},ot=function(N,O){var X=q(N),W=Array.isArray(X)?re(X):new Uint32Array(X),le=Array.isArray(X)?ne(X):new Uint16Array(X),we=24,Re=Qt(le,we/2,W[4]/2),ft=W[5]===2?Qt(le,(we+W[4])/2):Ie(W,Math.ceil((we+W[4])/4));return new ut(W[0],W[1],W[2],W[3],Re,ft)},ut=function(){function N(O,X,W,le,we,Re){this.initialValue=O,this.errorValue=X,this.highStart=W,this.highValueIndex=le,this.index=we,this.data=Re}return N.prototype.get=function(O){var X;if(O>=0){if(O<55296||O>56319&&O<=65535)return X=this.index[O>>pe],X=(X<<he)+(O&ye),this.data[X];if(O<=65535)return X=this.index[Se+(O-55296>>pe)],X=(X<<he)+(O&ye),this.data[X];if(O<this.highStart)return X=et-Ye+(O>>fe),X=this.index[X],X+=O>>pe&pt,X=this.index[X],X=(X<<he)+(O&ye),this.data[X];if(O<=1114111)return this.data[this.highValueIndex]}return this.errorValue},N}(),mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ct=typeof Uint8Array>"u"?[]:new Uint8Array(256),rt=0;rt<mt.length;rt++)Ct[mt.charCodeAt(rt)]=rt;var Bt="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",tt=50,Ut=1,Ai=2,qe=3,Ke=4,Pt=5,It=7,Ze=8,yi=9,bi=10,Kt=11,di=12,pi=13,Ri=14,Oi=15,Ji=16,ar=17,br=18,Dr=19,Fr=20,Qr=21,ui=22,li=23,Vi=24,rr=25,qr=26,_r=27,Zr=28,io=29,Ur=30,ta=31,As=32,ro=33,zn=34,Lr=35,yr=36,qt=37,Nn=38,vs=39,ia=40,dn=41,St=42,me=43,Ce=[9001,65288],je="!",Je="",Ge="",vt=ot(Bt),Rt=[Ur,yr],_t=[Ut,Ai,qe,Pt],Ot=[bi,Ze],ii=[_r,qr],Nt=_t.concat(Ot),Fi=[Nn,vs,ia,zn,Lr],er=[Oi,pi],nr=function(N,O){O===void 0&&(O="strict");var X=[],W=[],le=[];return N.forEach(function(we,Re){var ft=vt.get(we);if(ft>tt?(le.push(!0),ft-=tt):le.push(!1),["normal","auto","loose"].indexOf(O)!==-1&&[8208,8211,12316,12448].indexOf(we)!==-1)return W.push(Re),X.push(Ji);if(ft===Ke||ft===Kt){if(Re===0)return W.push(Re),X.push(Ur);var At=X[Re-1];return Nt.indexOf(At)===-1?(W.push(W[Re-1]),X.push(At)):(W.push(Re),X.push(Ur))}if(W.push(Re),ft===ta)return X.push(O==="strict"?Qr:qt);if(ft===St||ft===io)return X.push(Ur);if(ft===me)return we>=131072&&we<=196605||we>=196608&&we<=262141?X.push(qt):X.push(Ur);X.push(ft)}),[W,X,le]},Sr=function(N,O,X,W){var le=W[X];if(Array.isArray(N)?N.indexOf(le)!==-1:N===le)for(var we=X;we<=W.length;){we++;var Re=W[we];if(Re===O)return!0;if(Re!==bi)break}if(le===bi)for(var we=X;we>0;){we--;var ft=W[we];if(Array.isArray(N)?N.indexOf(ft)!==-1:N===ft)for(var At=X;At<=W.length;){At++;var Re=W[At];if(Re===O)return!0;if(Re!==bi)break}if(ft!==bi)break}return!1},Mr=function(N,O){for(var X=N;X>=0;){var W=O[X];if(W===bi)X--;else return W}return 0},jr=function(N,O,X,W,le){if(X[W]===0)return Je;var we=W-1;if(Array.isArray(le)&&le[we]===!0)return Je;var Re=we-1,ft=we+1,At=O[we],Ht=Re>=0?O[Re]:0,si=O[ft];if(At===Ai&&si===qe)return Je;if(_t.indexOf(At)!==-1)return je;if(_t.indexOf(si)!==-1||Ot.indexOf(si)!==-1)return Je;if(Mr(we,O)===Ze)return Ge;if(vt.get(N[we])===Kt||(At===As||At===ro)&&vt.get(N[ft])===Kt||At===It||si===It||At===yi||[bi,pi,Oi].indexOf(At)===-1&&si===yi||[ar,br,Dr,Vi,Zr].indexOf(si)!==-1||Mr(we,O)===ui||Sr(li,ui,we,O)||Sr([ar,br],Qr,we,O)||Sr(di,di,we,O))return Je;if(At===bi)return Ge;if(At===li||si===li)return Je;if(si===Ji||At===Ji)return Ge;if([pi,Oi,Qr].indexOf(si)!==-1||At===Ri||Ht===yr&&er.indexOf(At)!==-1||At===Zr&&si===yr||si===Fr||Rt.indexOf(si)!==-1&&At===rr||Rt.indexOf(At)!==-1&&si===rr||At===_r&&[qt,As,ro].indexOf(si)!==-1||[qt,As,ro].indexOf(At)!==-1&&si===qr||Rt.indexOf(At)!==-1&&ii.indexOf(si)!==-1||ii.indexOf(At)!==-1&&Rt.indexOf(si)!==-1||[_r,qr].indexOf(At)!==-1&&(si===rr||[ui,Oi].indexOf(si)!==-1&&O[ft+1]===rr)||[ui,Oi].indexOf(At)!==-1&&si===rr||At===rr&&[rr,Zr,Vi].indexOf(si)!==-1)return Je;if([rr,Zr,Vi,ar,br].indexOf(si)!==-1)for(var gi=we;gi>=0;){var Ui=O[gi];if(Ui===rr)return Je;if([Zr,Vi].indexOf(Ui)!==-1)gi--;else break}if([_r,qr].indexOf(si)!==-1)for(var gi=[ar,br].indexOf(At)!==-1?Re:we;gi>=0;){var Ui=O[gi];if(Ui===rr)return Je;if([Zr,Vi].indexOf(Ui)!==-1)gi--;else break}if(Nn===At&&[Nn,vs,zn,Lr].indexOf(si)!==-1||[vs,zn].indexOf(At)!==-1&&[vs,ia].indexOf(si)!==-1||[ia,Lr].indexOf(At)!==-1&&si===ia||Fi.indexOf(At)!==-1&&[Fr,qr].indexOf(si)!==-1||Fi.indexOf(si)!==-1&&At===_r||Rt.indexOf(At)!==-1&&Rt.indexOf(si)!==-1||At===Vi&&Rt.indexOf(si)!==-1||Rt.concat(rr).indexOf(At)!==-1&&si===ui&&Ce.indexOf(N[ft])===-1||Rt.concat(rr).indexOf(si)!==-1&&At===br)return Je;if(At===dn&&si===dn){for(var Gr=X[we],vr=1;Gr>0&&(Gr--,O[Gr]===dn);)vr++;if(vr%2!==0)return Je}return At===As&&si===ro?Je:Ge},nn=function(N,O){O||(O={lineBreak:"normal",wordBreak:"normal"});var X=nr(N,O.lineBreak),W=X[0],le=X[1],we=X[2];(O.wordBreak==="break-all"||O.wordBreak==="break-word")&&(le=le.map(function(ft){return[rr,Ur,St].indexOf(ft)!==-1?qt:ft}));var Re=O.wordBreak==="keep-all"?we.map(function(ft,At){return ft&&N[At]>=19968&&N[At]<=40959}):void 0;return[W,le,Re]},Yr=function(){function N(O,X,W,le){this.codePoints=O,this.required=X===je,this.start=W,this.end=le}return N.prototype.slice=function(){return T.apply(void 0,this.codePoints.slice(this.start,this.end))},N}(),Wn=function(N,O){var X=B(N),W=nn(X,O),le=W[0],we=W[1],Re=W[2],ft=X.length,At=0,Ht=0;return{next:function(){if(Ht>=ft)return{done:!0,value:null};for(var si=Je;Ht<ft&&(si=jr(X,we,le,++Ht,Re))===Je;);if(si!==Je||Ht===ft){var gi=new Yr(X,si,At,Ht);return At=Ht,{value:gi,done:!1}}return{done:!0,value:null}}}},fs=1,ps=2,Sn=4,En=8,Is=10,_s=47,cs=92,Oo=9,Ra=32,Bo=34,fc=61,us=35,pc=36,lh=37,gc=39,ql=40,zc=41,fl=95,Co=45,Ta=33,ku=60,pl=62,sl=64,ol=91,mc=93,gl=61,yc=123,$l=63,Zl=125,Ru=124,cu=126,ml=128,uu=65533,Nc=42,Po=43,Wo=44,ch=58,hu=59,Tn=46,Jd=0,uh=8,pn=11,hh=14,du=31,jc=127,yl=-1,Du=48,Hc=97,vc=101,dh=102,Au=117,vl=122,ld=65,qa=69,fu=70,pu=85,_l=90,Uo=function(N){return N>=Du&&N<=57},Qc=function(N){return N>=55296&&N<=57343},Jl=function(N){return Uo(N)||N>=ld&&N<=fu||N>=Hc&&N<=dh},ec=function(N){return N>=Hc&&N<=vl},tc=function(N){return N>=ld&&N<=_l},gu=function(N){return ec(N)||tc(N)},ra=function(N){return N>=ml},$a=function(N){return N===Is||N===Oo||N===Ra},Pl=function(N){return gu(N)||ra(N)||N===fl},xl=function(N){return Pl(N)||Uo(N)||N===Co},Un=function(N){return N>=Jd&&N<=uh||N===pn||N>=hh&&N<=du||N===jc},zo=function(N,O){return N!==cs?!1:O!==Is},Hh=function(N,O,X){return N===Co?Pl(O)||zo(O,X):Pl(N)?!0:!!(N===cs&&zo(N,O))},mu=function(N,O,X){return N===Po||N===Co?Uo(O)?!0:O===Tn&&Uo(X):Uo(N===Tn?O:N)},Er=function(N){var O=0,X=1;(N[O]===Po||N[O]===Co)&&(N[O]===Co&&(X=-1),O++);for(var W=[];Uo(N[O]);)W.push(N[O++]);var le=W.length?parseInt(T.apply(void 0,W),10):0;N[O]===Tn&&O++;for(var we=[];Uo(N[O]);)we.push(N[O++]);var Re=we.length,ft=Re?parseInt(T.apply(void 0,we),10):0;(N[O]===qa||N[O]===vc)&&O++;var At=1;(N[O]===Po||N[O]===Co)&&(N[O]===Co&&(At=-1),O++);for(var Ht=[];Uo(N[O]);)Ht.push(N[O++]);var si=Ht.length?parseInt(T.apply(void 0,Ht),10):0;return X*(le+ft*Math.pow(10,-Re))*Math.pow(10,At*si)},Ah={type:2},Vc={type:3},_c={type:4},Da={type:13},Qh={type:8},Ou={type:21},hr={type:9},Mn={type:10},In={type:11},na={type:12},kl={type:14},ie={type:23},Ue={type:1},Et={type:25},jt={type:24},hi={type:26},Ti={type:27},mr={type:28},Vr={type:29},cn={type:31},Pn={type:32},kn=function(){function N(){this._value=[]}return N.prototype.write=function(O){this._value=this._value.concat(B(O))},N.prototype.read=function(){for(var O=[],X=this.consumeToken();X!==Pn;)O.push(X),X=this.consumeToken();return O},N.prototype.consumeToken=function(){var O=this.consumeCodePoint();switch(O){case Bo:return this.consumeStringToken(Bo);case us:var X=this.peekCodePoint(0),W=this.peekCodePoint(1),le=this.peekCodePoint(2);if(xl(X)||zo(W,le)){var we=Hh(X,W,le)?ps:fs,Re=this.consumeName();return{type:5,value:Re,flags:we}}break;case pc:if(this.peekCodePoint(0)===fc)return this.consumeCodePoint(),Da;break;case gc:return this.consumeStringToken(gc);case ql:return Ah;case zc:return Vc;case Nc:if(this.peekCodePoint(0)===fc)return this.consumeCodePoint(),kl;break;case Po:if(mu(O,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(O),this.consumeNumericToken();break;case Wo:return _c;case Co:var ft=O,At=this.peekCodePoint(0),Ht=this.peekCodePoint(1);if(mu(ft,At,Ht))return this.reconsumeCodePoint(O),this.consumeNumericToken();if(Hh(ft,At,Ht))return this.reconsumeCodePoint(O),this.consumeIdentLikeToken();if(At===Co&&Ht===pl)return this.consumeCodePoint(),this.consumeCodePoint(),jt;break;case Tn:if(mu(O,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(O),this.consumeNumericToken();break;case _s:if(this.peekCodePoint(0)===Nc)for(this.consumeCodePoint();;){var si=this.consumeCodePoint();if(si===Nc&&(si=this.consumeCodePoint(),si===_s))return this.consumeToken();if(si===yl)return this.consumeToken()}break;case ch:return hi;case hu:return Ti;case ku:if(this.peekCodePoint(0)===Ta&&this.peekCodePoint(1)===Co&&this.peekCodePoint(2)===Co)return this.consumeCodePoint(),this.consumeCodePoint(),Et;break;case sl:var gi=this.peekCodePoint(0),Ui=this.peekCodePoint(1),Gr=this.peekCodePoint(2);if(Hh(gi,Ui,Gr)){var Re=this.consumeName();return{type:7,value:Re}}break;case ol:return mr;case cs:if(zo(O,this.peekCodePoint(0)))return this.reconsumeCodePoint(O),this.consumeIdentLikeToken();break;case mc:return Vr;case gl:if(this.peekCodePoint(0)===fc)return this.consumeCodePoint(),Qh;break;case yc:return In;case Zl:return na;case Au:case pu:var vr=this.peekCodePoint(0),Rr=this.peekCodePoint(1);return vr===Po&&(Jl(Rr)||Rr===$l)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(O),this.consumeIdentLikeToken();case Ru:if(this.peekCodePoint(0)===fc)return this.consumeCodePoint(),hr;if(this.peekCodePoint(0)===Ru)return this.consumeCodePoint(),Ou;break;case cu:if(this.peekCodePoint(0)===fc)return this.consumeCodePoint(),Mn;break;case yl:return Pn}return $a(O)?(this.consumeWhiteSpace(),cn):Uo(O)?(this.reconsumeCodePoint(O),this.consumeNumericToken()):Pl(O)?(this.reconsumeCodePoint(O),this.consumeIdentLikeToken()):{type:6,value:T(O)}},N.prototype.consumeCodePoint=function(){var O=this._value.shift();return typeof O>"u"?-1:O},N.prototype.reconsumeCodePoint=function(O){this._value.unshift(O)},N.prototype.peekCodePoint=function(O){return O>=this._value.length?-1:this._value[O]},N.prototype.consumeUnicodeRangeToken=function(){for(var O=[],X=this.consumeCodePoint();Jl(X)&&O.length<6;)O.push(X),X=this.consumeCodePoint();for(var W=!1;X===$l&&O.length<6;)O.push(X),X=this.consumeCodePoint(),W=!0;if(W){var le=parseInt(T.apply(void 0,O.map(function(At){return At===$l?Du:At})),16),we=parseInt(T.apply(void 0,O.map(function(At){return At===$l?fu:At})),16);return{type:30,start:le,end:we}}var Re=parseInt(T.apply(void 0,O),16);if(this.peekCodePoint(0)===Co&&Jl(this.peekCodePoint(1))){this.consumeCodePoint(),X=this.consumeCodePoint();for(var ft=[];Jl(X)&&ft.length<6;)ft.push(X),X=this.consumeCodePoint();var we=parseInt(T.apply(void 0,ft),16);return{type:30,start:Re,end:we}}else return{type:30,start:Re,end:Re}},N.prototype.consumeIdentLikeToken=function(){var O=this.consumeName();return O.toLowerCase()==="url"&&this.peekCodePoint(0)===ql?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===ql?(this.consumeCodePoint(),{type:19,value:O}):{type:20,value:O}},N.prototype.consumeUrlToken=function(){var O=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===yl)return{type:22,value:""};var X=this.peekCodePoint(0);if(X===gc||X===Bo){var W=this.consumeStringToken(this.consumeCodePoint());return W.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===yl||this.peekCodePoint(0)===zc)?(this.consumeCodePoint(),{type:22,value:W.value}):(this.consumeBadUrlRemnants(),ie)}for(;;){var le=this.consumeCodePoint();if(le===yl||le===zc)return{type:22,value:T.apply(void 0,O)};if($a(le))return this.consumeWhiteSpace(),this.peekCodePoint(0)===yl||this.peekCodePoint(0)===zc?(this.consumeCodePoint(),{type:22,value:T.apply(void 0,O)}):(this.consumeBadUrlRemnants(),ie);if(le===Bo||le===gc||le===ql||Un(le))return this.consumeBadUrlRemnants(),ie;if(le===cs)if(zo(le,this.peekCodePoint(0)))O.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ie;else O.push(le)}},N.prototype.consumeWhiteSpace=function(){for(;$a(this.peekCodePoint(0));)this.consumeCodePoint()},N.prototype.consumeBadUrlRemnants=function(){for(;;){var O=this.consumeCodePoint();if(O===zc||O===yl)return;zo(O,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},N.prototype.consumeStringSlice=function(O){for(var X=5e4,W="";O>0;){var le=Math.min(X,O);W+=T.apply(void 0,this._value.splice(0,le)),O-=le}return this._value.shift(),W},N.prototype.consumeStringToken=function(O){var X="",W=0;do{var le=this._value[W];if(le===yl||le===void 0||le===O)return X+=this.consumeStringSlice(W),{type:0,value:X};if(le===Is)return this._value.splice(0,W),Ue;if(le===cs){var we=this._value[W+1];we!==yl&&we!==void 0&&(we===Is?(X+=this.consumeStringSlice(W),W=-1,this._value.shift()):zo(le,we)&&(X+=this.consumeStringSlice(W),X+=T(this.consumeEscapedCodePoint()),W=-1))}W++}while(!0)},N.prototype.consumeNumber=function(){var O=[],X=Sn,W=this.peekCodePoint(0);for((W===Po||W===Co)&&O.push(this.consumeCodePoint());Uo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());W=this.peekCodePoint(0);var le=this.peekCodePoint(1);if(W===Tn&&Uo(le))for(O.push(this.consumeCodePoint(),this.consumeCodePoint()),X=En;Uo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());W=this.peekCodePoint(0),le=this.peekCodePoint(1);var we=this.peekCodePoint(2);if((W===qa||W===vc)&&((le===Po||le===Co)&&Uo(we)||Uo(le)))for(O.push(this.consumeCodePoint(),this.consumeCodePoint()),X=En;Uo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());return[Er(O),X]},N.prototype.consumeNumericToken=function(){var O=this.consumeNumber(),X=O[0],W=O[1],le=this.peekCodePoint(0),we=this.peekCodePoint(1),Re=this.peekCodePoint(2);if(Hh(le,we,Re)){var ft=this.consumeName();return{type:15,number:X,flags:W,unit:ft}}return le===lh?(this.consumeCodePoint(),{type:16,number:X,flags:W}):{type:17,number:X,flags:W}},N.prototype.consumeEscapedCodePoint=function(){var O=this.consumeCodePoint();if(Jl(O)){for(var X=T(O);Jl(this.peekCodePoint(0))&&X.length<6;)X+=T(this.consumeCodePoint());$a(this.peekCodePoint(0))&&this.consumeCodePoint();var W=parseInt(X,16);return W===0||Qc(W)||W>1114111?uu:W}return O===yl?uu:O},N.prototype.consumeName=function(){for(var O="";;){var X=this.consumeCodePoint();if(xl(X))O+=T(X);else if(zo(X,this.peekCodePoint(0)))O+=T(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(X),O}},N}(),hs=function(){function N(O){this._tokens=O}return N.create=function(O){var X=new kn;return X.write(O),new N(X.read())},N.parseValue=function(O){return N.create(O).parseComponentValue()},N.parseValues=function(O){return N.create(O).parseComponentValues()},N.prototype.parseComponentValue=function(){for(var O=this.consumeToken();O.type===31;)O=this.consumeToken();if(O.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(O);var X=this.consumeComponentValue();do O=this.consumeToken();while(O.type===31);if(O.type===32)return X;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},N.prototype.parseComponentValues=function(){for(var O=[];;){var X=this.consumeComponentValue();if(X.type===32)return O;O.push(X),O.push()}},N.prototype.consumeComponentValue=function(){var O=this.consumeToken();switch(O.type){case 11:case 28:case 2:return this.consumeSimpleBlock(O.type);case 19:return this.consumeFunction(O)}return O},N.prototype.consumeSimpleBlock=function(O){for(var X={type:O,values:[]},W=this.consumeToken();;){if(W.type===32||Pr(W,O))return X;this.reconsumeToken(W),X.values.push(this.consumeComponentValue()),W=this.consumeToken()}},N.prototype.consumeFunction=function(O){for(var X={name:O.value,values:[],type:18};;){var W=this.consumeToken();if(W.type===32||W.type===3)return X;this.reconsumeToken(W),X.values.push(this.consumeComponentValue())}},N.prototype.consumeToken=function(){var O=this._tokens.shift();return typeof O>"u"?Pn:O},N.prototype.reconsumeToken=function(O){this._tokens.unshift(O)},N}(),Zs=function(N){return N.type===15},Zn=function(N){return N.type===17},xn=function(N){return N.type===20},Js=function(N){return N.type===0},yo=function(N,O){return xn(N)&&N.value===O},Wr=function(N){return N.type!==31},ji=function(N){return N.type!==31&&N.type!==4},eo=function(N){var O=[],X=[];return N.forEach(function(W){if(W.type===4){if(X.length===0)throw new Error("Error parsing function args, zero tokens for arg");O.push(X),X=[];return}W.type!==31&&X.push(W)}),X.length&&O.push(X),O},Pr=function(N,O){return O===11&&N.type===12||O===28&&N.type===29?!0:O===2&&N.type===3},Cs=function(N){return N.type===17||N.type===15},ao=function(N){return N.type===16||Cs(N)},wr=function(N){return N.length>1?[N[0],N[1]]:[N[0]]},vo={type:17,number:0,flags:Sn},ic={type:16,number:50,flags:Sn},pa={type:16,number:100,flags:Sn},Xo=function(N,O,X){var W=N[0],le=N[1];return[Jn(W,O),Jn(typeof le<"u"?le:W,X)]},Jn=function(N,O){if(N.type===16)return N.number/100*O;if(Zs(N))switch(N.unit){case"rem":case"em":return 16*N.number;case"px":default:return N.number}return N.number},Yo="deg",xc="grad",So="rad",Oa="turn",al={name:"angle",parse:function(N,O){if(O.type===15)switch(O.unit){case Yo:return Math.PI*O.number/180;case xc:return Math.PI/200*O.number;case So:return O.number;case Oa:return Math.PI*2*O.number}throw new Error("Unsupported angle type")}},Ko=function(N){return N.type===15&&(N.unit===Yo||N.unit===xc||N.unit===So||N.unit===Oa)},yu=function(N){var O=N.filter(xn).map(function(X){return X.value}).join(" ");switch(O){case"to bottom right":case"to right bottom":case"left top":case"top left":return[vo,vo];case"to top":case"bottom":return No(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[vo,pa];case"to right":case"left":return No(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[pa,pa];case"to bottom":case"top":return No(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[pa,vo];case"to left":case"right":return No(270)}return 0},No=function(N){return Math.PI*N/180},Rl={name:"color",parse:function(N,O){if(O.type===18){var X=Ua[O.name];if(typeof X>"u")throw new Error('Attempting to parse an unsupported color function "'+O.name+'"');return X(N,O.values)}if(O.type===5){if(O.value.length===3){var W=O.value.substring(0,1),le=O.value.substring(1,2),we=O.value.substring(2,3);return sa(parseInt(W+W,16),parseInt(le+le,16),parseInt(we+we,16),1)}if(O.value.length===4){var W=O.value.substring(0,1),le=O.value.substring(1,2),we=O.value.substring(2,3),Re=O.value.substring(3,4);return sa(parseInt(W+W,16),parseInt(le+le,16),parseInt(we+we,16),parseInt(Re+Re,16)/255)}if(O.value.length===6){var W=O.value.substring(0,2),le=O.value.substring(2,4),we=O.value.substring(4,6);return sa(parseInt(W,16),parseInt(le,16),parseInt(we,16),1)}if(O.value.length===8){var W=O.value.substring(0,2),le=O.value.substring(2,4),we=O.value.substring(4,6),Re=O.value.substring(6,8);return sa(parseInt(W,16),parseInt(le,16),parseInt(we,16),parseInt(Re,16)/255)}}if(O.type===20){var ft=bl[O.value.toUpperCase()];if(typeof ft<"u")return ft}return bl.TRANSPARENT}},Ia=function(N){return(255&N)===0},_o=function(N){var O=255&N,X=255&N>>8,W=255&N>>16,le=255&N>>24;return O<255?"rgba("+le+","+W+","+X+","+O/255+")":"rgb("+le+","+W+","+X+")"},sa=function(N,O,X,W){return(N<<24|O<<16|X<<8|Math.round(W*255)<<0)>>>0},Dl=function(N,O){if(N.type===17)return N.number;if(N.type===16){var X=O===3?1:255;return O===3?N.number/100*X:Math.round(N.number/100*X)}return 0},Za=function(N,O){var X=O.filter(ji);if(X.length===3){var W=X.map(Dl),le=W[0],we=W[1],Re=W[2];return sa(le,we,Re,1)}if(X.length===4){var ft=X.map(Dl),le=ft[0],we=ft[1],Re=ft[2],At=ft[3];return sa(le,we,Re,At)}return 0};function ga(N,O,X){return X<0&&(X+=1),X>=1&&(X-=1),X<1/6?(O-N)*X*6+N:X<1/2?O:X<2/3?(O-N)*6*(2/3-X)+N:N}var bc=function(N,O){var X=O.filter(ji),W=X[0],le=X[1],we=X[2],Re=X[3],ft=(W.type===17?No(W.number):al.parse(N,W))/(Math.PI*2),At=ao(le)?le.number/100:0,Ht=ao(we)?we.number/100:0,si=typeof Re<"u"&&ao(Re)?Jn(Re,1):1;if(At===0)return sa(Ht*255,Ht*255,Ht*255,1);var gi=Ht<=.5?Ht*(At+1):Ht+At-Ht*At,Ui=Ht*2-gi,Gr=ga(Ui,gi,ft+1/3),vr=ga(Ui,gi,ft),Rr=ga(Ui,gi,ft-1/3);return sa(Gr*255,vr*255,Rr*255,si)},Ua={hsl:bc,hsla:bc,rgb:Za,rgba:Za},Ol=function(N,O){return Rl.parse(N,hs.create(O).parseComponentValue())},bl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Gc={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(N,O){return O.map(function(X){if(xn(X))switch(X.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},qo={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},wl=function(N,O){var X=Rl.parse(N,O[0]),W=O[1];return W&&ao(W)?{color:X,stop:W}:{color:X,stop:null}},Fa=function(N,O){var X=N[0],W=N[N.length-1];X.stop===null&&(X.stop=vo),W.stop===null&&(W.stop=pa);for(var le=[],we=0,Re=0;Re<N.length;Re++){var ft=N[Re].stop;if(ft!==null){var At=Jn(ft,O);At>we?le.push(At):le.push(we),we=At}else le.push(null)}for(var Ht=null,Re=0;Re<le.length;Re++){var si=le[Re];if(si===null)Ht===null&&(Ht=Re);else if(Ht!==null){for(var gi=Re-Ht,Ui=le[Ht-1],Gr=(si-Ui)/(gi+1),vr=1;vr<=gi;vr++)le[Ht+vr-1]=Gr*vr;Ht=null}}return N.map(function(Rr,Kn){var An=Rr.color;return{color:An,stop:Math.max(Math.min(1,le[Kn]/O),0)}})},Ul=function(N,O,X){var W=O/2,le=X/2,we=Jn(N[0],O)-W,Re=le-Jn(N[1],X);return(Math.atan2(Re,we)+Math.PI*2)%(Math.PI*2)},vu=function(N,O,X){var W=typeof N=="number"?N:Ul(N,O,X),le=Math.abs(O*Math.sin(W))+Math.abs(X*Math.cos(W)),we=O/2,Re=X/2,ft=le/2,At=Math.sin(W-Math.PI/2)*ft,Ht=Math.cos(W-Math.PI/2)*ft;return[le,we-Ht,we+Ht,Re-At,Re+At]},Ja=function(N,O){return Math.sqrt(N*N+O*O)},Uu=function(N,O,X,W,le){var we=[[0,0],[0,O],[N,0],[N,O]];return we.reduce(function(Re,ft){var At=ft[0],Ht=ft[1],si=Ja(X-At,W-Ht);return(le?si<Re.optimumDistance:si>Re.optimumDistance)?{optimumCorner:ft,optimumDistance:si}:Re},{optimumDistance:le?1/0:-1/0,optimumCorner:null}).optimumCorner},jo=function(N,O,X,W,le){var we=0,Re=0;switch(N.size){case 0:N.shape===0?we=Re=Math.min(Math.abs(O),Math.abs(O-W),Math.abs(X),Math.abs(X-le)):N.shape===1&&(we=Math.min(Math.abs(O),Math.abs(O-W)),Re=Math.min(Math.abs(X),Math.abs(X-le)));break;case 2:if(N.shape===0)we=Re=Math.min(Ja(O,X),Ja(O,X-le),Ja(O-W,X),Ja(O-W,X-le));else if(N.shape===1){var ft=Math.min(Math.abs(X),Math.abs(X-le))/Math.min(Math.abs(O),Math.abs(O-W)),At=Uu(W,le,O,X,!0),Ht=At[0],si=At[1];we=Ja(Ht-O,(si-X)/ft),Re=ft*we}break;case 1:N.shape===0?we=Re=Math.max(Math.abs(O),Math.abs(O-W),Math.abs(X),Math.abs(X-le)):N.shape===1&&(we=Math.max(Math.abs(O),Math.abs(O-W)),Re=Math.max(Math.abs(X),Math.abs(X-le)));break;case 3:if(N.shape===0)we=Re=Math.max(Ja(O,X),Ja(O,X-le),Ja(O-W,X),Ja(O-W,X-le));else if(N.shape===1){var ft=Math.max(Math.abs(X),Math.abs(X-le))/Math.max(Math.abs(O),Math.abs(O-W)),gi=Uu(W,le,O,X,!1),Ht=gi[0],si=gi[1];we=Ja(Ht-O,(si-X)/ft),Re=ft*we}break}return Array.isArray(N.size)&&(we=Jn(N.size[0],W),Re=N.size.length===2?Jn(N.size[1],le):we),[we,Re]},wc=function(N,O){var X=No(180),W=[];return eo(O).forEach(function(le,we){if(we===0){var Re=le[0];if(Re.type===20&&Re.value==="to"){X=yu(le);return}else if(Ko(Re)){X=al.parse(N,Re);return}}var ft=wl(N,le);W.push(ft)}),{angle:X,stops:W,type:1}},zl=function(N,O){var X=No(180),W=[];return eo(O).forEach(function(le,we){if(we===0){var Re=le[0];if(Re.type===20&&["top","left","right","bottom"].indexOf(Re.value)!==-1){X=yu(le);return}else if(Ko(Re)){X=(al.parse(N,Re)+No(270))%No(360);return}}var ft=wl(N,le);W.push(ft)}),{angle:X,stops:W,type:1}},_u=function(N,O){var X=No(180),W=[],le=1,we=0,Re=3,ft=[];return eo(O).forEach(function(At,Ht){var si=At[0];if(Ht===0){if(xn(si)&&si.value==="linear"){le=1;return}else if(xn(si)&&si.value==="radial"){le=2;return}}if(si.type===18){if(si.name==="from"){var gi=Rl.parse(N,si.values[0]);W.push({stop:vo,color:gi})}else if(si.name==="to"){var gi=Rl.parse(N,si.values[0]);W.push({stop:pa,color:gi})}else if(si.name==="color-stop"){var Ui=si.values.filter(ji);if(Ui.length===2){var gi=Rl.parse(N,Ui[1]),Gr=Ui[0];Zn(Gr)&&W.push({stop:{type:16,number:Gr.number*100,flags:Gr.flags},color:gi})}}}}),le===1?{angle:(X+No(180))%No(360),stops:W,type:le}:{size:Re,shape:we,stops:W,position:ft,type:le}},rc="closest-side",Nl="farthest-side",Bc="closest-corner",xu="farthest-corner",Eo="circle",el="ellipse",wi="cover",no="contain",xo=function(N,O){var X=0,W=3,le=[],we=[];return eo(O).forEach(function(Re,ft){var At=!0;if(ft===0){var Ht=!1;At=Re.reduce(function(gi,Ui){if(Ht)if(xn(Ui))switch(Ui.value){case"center":return we.push(ic),gi;case"top":case"left":return we.push(vo),gi;case"right":case"bottom":return we.push(pa),gi}else(ao(Ui)||Cs(Ui))&&we.push(Ui);else if(xn(Ui))switch(Ui.value){case Eo:return X=0,!1;case el:return X=1,!1;case"at":return Ht=!0,!1;case rc:return W=0,!1;case wi:case Nl:return W=1,!1;case no:case Bc:return W=2,!1;case xu:return W=3,!1}else if(Cs(Ui)||ao(Ui))return Array.isArray(W)||(W=[]),W.push(Ui),!1;return gi},At)}if(At){var si=wl(N,Re);le.push(si)}}),{size:W,shape:X,stops:le,position:we,type:2}},fo=function(N,O){var X=0,W=3,le=[],we=[];return eo(O).forEach(function(Re,ft){var At=!0;if(ft===0?At=Re.reduce(function(si,gi){if(xn(gi))switch(gi.value){case"center":return we.push(ic),!1;case"top":case"left":return we.push(vo),!1;case"right":case"bottom":return we.push(pa),!1}else if(ao(gi)||Cs(gi))return we.push(gi),!1;return si},At):ft===1&&(At=Re.reduce(function(si,gi){if(xn(gi))switch(gi.value){case Eo:return X=0,!1;case el:return X=1,!1;case no:case rc:return W=0,!1;case Nl:return W=1,!1;case Bc:return W=2,!1;case wi:case xu:return W=3,!1}else if(Cs(gi)||ao(gi))return Array.isArray(W)||(W=[]),W.push(gi),!1;return si},At)),At){var Ht=wl(N,Re);le.push(Ht)}}),{size:W,shape:X,stops:le,position:we,type:2}},jl=function(N){return N.type===1},bu=function(N){return N.type===2},za={name:"image",parse:function(N,O){if(O.type===22){var X={url:O.value,type:0};return N.cache.addImage(O.value),X}if(O.type===18){var W=ll[O.name];if(typeof W>"u")throw new Error('Attempting to parse an unsupported image function "'+O.name+'"');return W(N,O.values)}throw new Error("Unsupported image type "+O.type)}};function fh(N){return!(N.type===20&&N.value==="none")&&(N.type!==18||!!ll[N.name])}var ll={"linear-gradient":wc,"-moz-linear-gradient":zl,"-ms-linear-gradient":zl,"-o-linear-gradient":zl,"-webkit-linear-gradient":zl,"radial-gradient":xo,"-moz-radial-gradient":fo,"-ms-radial-gradient":fo,"-o-radial-gradient":fo,"-webkit-radial-gradient":fo,"-webkit-gradient":_u},gn={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(N,O){if(O.length===0)return[];var X=O[0];return X.type===20&&X.value==="none"?[]:O.filter(function(W){return ji(W)&&fh(W)}).map(function(W){return za.parse(N,W)})}},La={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(N,O){return O.map(function(X){if(xn(X))switch(X.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nc={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(N,O){return eo(O).map(function(X){return X.filter(ao)}).map(wr)}},eA={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(N,O){return eo(O).map(function(X){return X.filter(xn).map(function(W){return W.value}).join(" ")}).map(ph)}},ph=function(N){switch(N){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},gh;(function(N){N.AUTO="auto",N.CONTAIN="contain",N.COVER="cover"})(gh||(gh={}));var Ss={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(N,O){return eo(O).map(function(X){return X.filter(cd)})}},cd=function(N){return xn(N)||ao(N)},zu=function(N){return{name:"border-"+N+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Ef=zu("top"),XA=zu("right"),YA=zu("bottom"),tA=zu("left"),mh=function(N){return{name:"border-radius-"+N,initialValue:"0 0",prefix:!1,type:1,parse:function(O,X){return wr(X.filter(ao))}}},Ep=mh("top-left"),iA=mh("top-right"),Tf=mh("bottom-right"),If=mh("bottom-left"),Vh=function(N){return{name:"border-"+N+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(O,X){switch(X){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},rA=Vh("top"),KA=Vh("right"),yh=Vh("bottom"),Nu=Vh("left"),wu=function(N){return{name:"border-"+N+"-width",initialValue:"0",type:0,prefix:!1,parse:function(O,X){return Zs(X)?X.number:0}}},ju=wu("top"),Gh=wu("right"),Ff=wu("bottom"),nA=wu("left"),Lf={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Wh={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(N,O){switch(O){case"rtl":return 1;case"ltr":default:return 0}}},sA={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(N,O){return O.filter(xn).reduce(function(X,W){return X|oA(W.value)},0)}},oA=function(N){switch(N){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Wc={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Bl={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(N,O){return O.type===20&&O.value==="normal"?0:O.type===17||O.type===15?O.number:0}},tl;(function(N){N.NORMAL="normal",N.STRICT="strict"})(tl||(tl={}));var Mf={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"strict":return tl.STRICT;case"normal":default:return tl.NORMAL}}},qA={name:"line-height",initialValue:"normal",prefix:!1,type:4},Xc=function(N,O){return xn(N)&&N.value==="normal"?1.2*O:N.type===17?O*N.number:ao(N)?Jn(N,O):O},Ba={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(N,O){return O.type===20&&O.value==="none"?null:za.parse(N,O)}},Pf={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(N,O){switch(O){case"inside":return 0;case"outside":default:return 1}}},aA={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},ud=function(N){return{name:"margin-"+N,initialValue:"0",prefix:!1,type:4}},kf=ud("top"),lA=ud("right"),hd=ud("bottom"),cA=ud("left"),Cc={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(N,O){return O.filter(xn).map(function(X){switch(X.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Xh={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"break-word":return"break-word";case"normal":default:return"normal"}}},Yc=function(N){return{name:"padding-"+N,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},$A=Yc("top"),vh=Yc("right"),Hu=Yc("bottom"),Rf=Yc("left"),Hl={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(N,O){switch(O){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},uA={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(N,O){switch(O){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},dd={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.length===1&&yo(O[0],"none")?[]:eo(O).map(function(X){for(var W={color:bl.TRANSPARENT,offsetX:vo,offsetY:vo,blur:vo},le=0,we=0;we<X.length;we++){var Re=X[we];Cs(Re)?(le===0?W.offsetX=Re:le===1?W.offsetY=Re:W.blur=Re,le++):W.color=Rl.parse(N,Re)}return W})}},hA={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ZA={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(N,O){if(O.type===20&&O.value==="none")return null;if(O.type===18){var X=Ad[O.name];if(typeof X>"u")throw new Error('Attempting to parse an unsupported transform function "'+O.name+'"');return X(O.values)}return null}},dA=function(N){var O=N.filter(function(X){return X.type===17}).map(function(X){return X.number});return O.length===6?O:null},_h=function(N){var O=N.filter(function(At){return At.type===17}).map(function(At){return At.number}),X=O[0],W=O[1];O[2],O[3];var le=O[4],we=O[5];O[6],O[7],O[8],O[9],O[10],O[11];var Re=O[12],ft=O[13];return O[14],O[15],O.length===16?[X,W,le,we,Re,ft]:null},Ad={matrix:dA,matrix3d:_h},xh={type:16,number:50,flags:Sn},AA=[xh,xh],D={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(N,O){var X=O.filter(ao);return X.length!==2?AA:[X[0],X[1]]}},K={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},se;(function(N){N.NORMAL="normal",N.BREAK_ALL="break-all",N.KEEP_ALL="keep-all"})(se||(se={}));for(var xe={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"break-all":return se.BREAK_ALL;case"keep-all":return se.KEEP_ALL;case"normal":default:return se.NORMAL}}},Oe={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(N,O){if(O.type===20)return{auto:!0,order:0};if(Zn(O))return{auto:!1,order:O.number};throw new Error("Invalid z-index number parsed")}},We={name:"time",parse:function(N,O){if(O.type===15)switch(O.unit.toLowerCase()){case"s":return 1e3*O.number;case"ms":return O.number}throw new Error("Unsupported time type")}},$e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(N,O){return Zn(O)?O.number:1}},nt={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ct={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(N,O){return O.filter(xn).map(function(X){switch(X.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(X){return X!==0})}},xt={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(N,O){var X=[],W=[];return O.forEach(function(le){switch(le.type){case 20:case 0:X.push(le.value);break;case 17:X.push(le.number.toString());break;case 4:W.push(X.join(" ")),X.length=0;break}}),X.length&&W.push(X.join(" ")),W.map(function(le){return le.indexOf(" ")===-1?le:"'"+le+"'"})}},Xt={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},xi={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(N,O){if(Zn(O))return O.number;if(xn(O))switch(O.value){case"bold":return 700;case"normal":default:return 400}return 400}},Bi={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.filter(xn).map(function(X){return X.value})}},ci={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Hi=function(N,O){return(N&O)!==0},Ni={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(N,O){if(O.length===0)return[];var X=O[0];return X.type===20&&X.value==="none"?[]:O}},Zt={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return null;var X=O[0];if(X.type===20&&X.value==="none")return null;for(var W=[],le=O.filter(Wr),we=0;we<le.length;we++){var Re=le[we],ft=le[we+1];if(Re.type===20){var At=ft&&Zn(ft)?ft.number:1;W.push({counter:Re.value,increment:At})}}return W}},ei={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return[];for(var X=[],W=O.filter(Wr),le=0;le<W.length;le++){var we=W[le],Re=W[le+1];if(xn(we)&&we.value!=="none"){var ft=Re&&Zn(Re)?Re.number:0;X.push({counter:we.value,reset:ft})}}return X}},qi={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(N,O){return O.filter(Zs).map(function(X){return We.parse(N,X)})}},lr={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return null;var X=O[0];if(X.type===20&&X.value==="none")return null;var W=[],le=O.filter(Js);if(le.length%2!==0)return null;for(var we=0;we<le.length;we+=2){var Re=le[we].value,ft=le[we+1].value;W.push({open:Re,close:ft})}return W}},$i=function(N,O,X){if(!N)return"";var W=N[Math.min(O,N.length-1)];return W?X?W.open:W.close:""},Xr={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.length===1&&yo(O[0],"none")?[]:eo(O).map(function(X){for(var W={color:255,offsetX:vo,offsetY:vo,blur:vo,spread:vo,inset:!1},le=0,we=0;we<X.length;we++){var Re=X[we];yo(Re,"inset")?W.inset=!0:Cs(Re)?(le===0?W.offsetX=Re:le===1?W.offsetY=Re:le===2?W.blur=Re:W.spread=Re,le++):W.color=Rl.parse(N,Re)}return W})}},Ir={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(N,O){var X=[0,1,2],W=[];return O.filter(xn).forEach(function(le){switch(le.value){case"stroke":W.push(1);break;case"fill":W.push(0);break;case"markers":W.push(2);break}}),X.forEach(function(le){W.indexOf(le)===-1&&W.push(le)}),W}},bn={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},zr={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(N,O){return Zs(O)?O.number:0}},Fs=function(){function N(O,X){var W,le;this.animationDuration=dr(O,qi,X.animationDuration),this.backgroundClip=dr(O,Gc,X.backgroundClip),this.backgroundColor=dr(O,qo,X.backgroundColor),this.backgroundImage=dr(O,gn,X.backgroundImage),this.backgroundOrigin=dr(O,La,X.backgroundOrigin),this.backgroundPosition=dr(O,nc,X.backgroundPosition),this.backgroundRepeat=dr(O,eA,X.backgroundRepeat),this.backgroundSize=dr(O,Ss,X.backgroundSize),this.borderTopColor=dr(O,Ef,X.borderTopColor),this.borderRightColor=dr(O,XA,X.borderRightColor),this.borderBottomColor=dr(O,YA,X.borderBottomColor),this.borderLeftColor=dr(O,tA,X.borderLeftColor),this.borderTopLeftRadius=dr(O,Ep,X.borderTopLeftRadius),this.borderTopRightRadius=dr(O,iA,X.borderTopRightRadius),this.borderBottomRightRadius=dr(O,Tf,X.borderBottomRightRadius),this.borderBottomLeftRadius=dr(O,If,X.borderBottomLeftRadius),this.borderTopStyle=dr(O,rA,X.borderTopStyle),this.borderRightStyle=dr(O,KA,X.borderRightStyle),this.borderBottomStyle=dr(O,yh,X.borderBottomStyle),this.borderLeftStyle=dr(O,Nu,X.borderLeftStyle),this.borderTopWidth=dr(O,ju,X.borderTopWidth),this.borderRightWidth=dr(O,Gh,X.borderRightWidth),this.borderBottomWidth=dr(O,Ff,X.borderBottomWidth),this.borderLeftWidth=dr(O,nA,X.borderLeftWidth),this.boxShadow=dr(O,Xr,X.boxShadow),this.color=dr(O,Lf,X.color),this.direction=dr(O,Wh,X.direction),this.display=dr(O,sA,X.display),this.float=dr(O,Wc,X.cssFloat),this.fontFamily=dr(O,xt,X.fontFamily),this.fontSize=dr(O,Xt,X.fontSize),this.fontStyle=dr(O,ci,X.fontStyle),this.fontVariant=dr(O,Bi,X.fontVariant),this.fontWeight=dr(O,xi,X.fontWeight),this.letterSpacing=dr(O,Bl,X.letterSpacing),this.lineBreak=dr(O,Mf,X.lineBreak),this.lineHeight=dr(O,qA,X.lineHeight),this.listStyleImage=dr(O,Ba,X.listStyleImage),this.listStylePosition=dr(O,Pf,X.listStylePosition),this.listStyleType=dr(O,aA,X.listStyleType),this.marginTop=dr(O,kf,X.marginTop),this.marginRight=dr(O,lA,X.marginRight),this.marginBottom=dr(O,hd,X.marginBottom),this.marginLeft=dr(O,cA,X.marginLeft),this.opacity=dr(O,$e,X.opacity);var we=dr(O,Cc,X.overflow);this.overflowX=we[0],this.overflowY=we[we.length>1?1:0],this.overflowWrap=dr(O,Xh,X.overflowWrap),this.paddingTop=dr(O,$A,X.paddingTop),this.paddingRight=dr(O,vh,X.paddingRight),this.paddingBottom=dr(O,Hu,X.paddingBottom),this.paddingLeft=dr(O,Rf,X.paddingLeft),this.paintOrder=dr(O,Ir,X.paintOrder),this.position=dr(O,uA,X.position),this.textAlign=dr(O,Hl,X.textAlign),this.textDecorationColor=dr(O,nt,(W=X.textDecorationColor)!==null&&W!==void 0?W:X.color),this.textDecorationLine=dr(O,ct,(le=X.textDecorationLine)!==null&&le!==void 0?le:X.textDecoration),this.textShadow=dr(O,dd,X.textShadow),this.textTransform=dr(O,hA,X.textTransform),this.transform=dr(O,ZA,X.transform),this.transformOrigin=dr(O,D,X.transformOrigin),this.visibility=dr(O,K,X.visibility),this.webkitTextStrokeColor=dr(O,bn,X.webkitTextStrokeColor),this.webkitTextStrokeWidth=dr(O,zr,X.webkitTextStrokeWidth),this.wordBreak=dr(O,xe,X.wordBreak),this.zIndex=dr(O,Oe,X.zIndex)}return N.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},N.prototype.isTransparent=function(){return Ia(this.backgroundColor)},N.prototype.isTransformed=function(){return this.transform!==null},N.prototype.isPositioned=function(){return this.position!==0},N.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},N.prototype.isFloating=function(){return this.float!==0},N.prototype.isInlineLevel=function(){return Hi(this.display,4)||Hi(this.display,33554432)||Hi(this.display,268435456)||Hi(this.display,536870912)||Hi(this.display,67108864)||Hi(this.display,134217728)},N}(),Qs=function(){function N(O,X){this.content=dr(O,Ni,X.content),this.quotes=dr(O,lr,X.quotes)}return N}(),Ls=function(){function N(O,X){this.counterIncrement=dr(O,Zt,X.counterIncrement),this.counterReset=dr(O,ei,X.counterReset)}return N}(),dr=function(N,O,X){var W=new kn,le=X!==null&&typeof X<"u"?X.toString():O.initialValue;W.write(le);var we=new hs(W.read());switch(O.type){case 2:var Re=we.parseComponentValue();return O.parse(N,xn(Re)?Re.value:O.initialValue);case 0:return O.parse(N,we.parseComponentValue());case 1:return O.parse(N,we.parseComponentValues());case 4:return we.parseComponentValue();case 3:switch(O.format){case"angle":return al.parse(N,we.parseComponentValue());case"color":return Rl.parse(N,we.parseComponentValue());case"image":return za.parse(N,we.parseComponentValue());case"length":var ft=we.parseComponentValue();return Cs(ft)?ft:vo;case"length-percentage":var At=we.parseComponentValue();return ao(At)?At:vo;case"time":return We.parse(N,we.parseComponentValue())}break}},gs="data-html2canvas-debug",lo=function(N){var O=N.getAttribute(gs);switch(O){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Vn=function(N,O){var X=lo(N);return X===1||O===X},qs=function(){function N(O,X){if(this.context=O,this.textNodes=[],this.elements=[],this.flags=0,Vn(X,3))debugger;this.styles=new Fs(O,window.getComputedStyle(X,null)),Sd(X)&&(this.styles.animationDuration.some(function(W){return W>0})&&(X.style.animationDuration="0s"),this.styles.transform!==null&&(X.style.transform="none")),this.bounds=b(this.context,X),Vn(X,4)&&(this.flags|=16)}return N}(),Cl="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",bo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oa=typeof Uint8Array>"u"?[]:new Uint8Array(256),as=0;as<bo.length;as++)oa[bo.charCodeAt(as)]=as;for(var Na=function(N){var O=N.length*.75,X=N.length,W,le=0,we,Re,ft,At;N[N.length-1]==="="&&(O--,N[N.length-2]==="="&&O--);var Ht=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(O):new Array(O),si=Array.isArray(Ht)?Ht:new Uint8Array(Ht);for(W=0;W<X;W+=4)we=oa[N.charCodeAt(W)],Re=oa[N.charCodeAt(W+1)],ft=oa[N.charCodeAt(W+2)],At=oa[N.charCodeAt(W+3)],si[le++]=we<<2|Re>>4,si[le++]=(Re&15)<<4|ft>>2,si[le++]=(ft&3)<<6|At&63;return Ht},ja=function(N){for(var O=N.length,X=[],W=0;W<O;W+=2)X.push(N[W+1]<<8|N[W]);return X},Ca=function(N){for(var O=N.length,X=[],W=0;W<O;W+=4)X.push(N[W+3]<<24|N[W+2]<<16|N[W+1]<<8|N[W]);return X},co=5,$o=11,Ha=2,sc=$o-co,aa=65536>>co,Qa=1<<co,Va=Qa-1,Zi=1024>>co,Bu=aa+Zi,Ho=Bu,Kc=32,Cu=Ho+Kc,Br=65536>>$o,Qu=1<<sc,fd=Qu-1,pd=function(N,O,X){return N.slice?N.slice(O,X):new Uint16Array(Array.prototype.slice.call(N,O,X))},Ql=function(N,O,X){return N.slice?N.slice(O,X):new Uint32Array(Array.prototype.slice.call(N,O,X))},bh=function(N,O){var X=Na(N),W=Array.isArray(X)?Ca(X):new Uint32Array(X),le=Array.isArray(X)?ja(X):new Uint16Array(X),we=24,Re=pd(le,we/2,W[4]/2),ft=W[5]===2?pd(le,(we+W[4])/2):Ql(W,Math.ceil((we+W[4])/4));return new Yh(W[0],W[1],W[2],W[3],Re,ft)},Yh=function(){function N(O,X,W,le,we,Re){this.initialValue=O,this.errorValue=X,this.highStart=W,this.highValueIndex=le,this.index=we,this.data=Re}return N.prototype.get=function(O){var X;if(O>=0){if(O<55296||O>56319&&O<=65535)return X=this.index[O>>co],X=(X<<Ha)+(O&Va),this.data[X];if(O<=65535)return X=this.index[aa+(O-55296>>co)],X=(X<<Ha)+(O&Va),this.data[X];if(O<this.highStart)return X=Cu-Br+(O>>$o),X=this.index[X],X+=O>>co&fd,X=this.index[X],X=(X<<Ha)+(O&Va),this.data[X];if(O<=1114111)return this.data[this.highValueIndex]}return this.errorValue},N}(),fA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pA=typeof Uint8Array>"u"?[]:new Uint8Array(256),gd=0;gd<fA.length;gd++)pA[fA.charCodeAt(gd)]=gd;var Ga=1,wh=2,la=3,Sl=4,Vu=5,gA=7,Bh=8,cl=9,mA=10,qc=11,Xn=12,Ch=13,oc=14,md=15,JA=function(N){for(var O=[],X=0,W=N.length;X<W;){var le=N.charCodeAt(X++);if(le>=55296&&le<=56319&&X<W){var we=N.charCodeAt(X++);(we&64512)===56320?O.push(((le&1023)<<10)+(we&1023)+65536):(O.push(le),X--)}else O.push(le)}return O},yd=function(){for(var N=[],O=0;O<arguments.length;O++)N[O]=arguments[O];if(String.fromCodePoint)return String.fromCodePoint.apply(String,N);var X=N.length;if(!X)return"";for(var W=[],le=-1,we="";++le<X;){var Re=N[le];Re<=65535?W.push(Re):(Re-=65536,W.push((Re>>10)+55296,Re%1024+56320)),(le+1===X||W.length>16384)&&(we+=String.fromCharCode.apply(String,W),W.length=0)}return we},ef=bh(Cl),ca="",$c="",Ei=function(N){return ef.get(N)},Gi=function(N,O,X){var W=X-2,le=O[W],we=O[X-1],Re=O[X];if(we===wh&&Re===la)return ca;if(we===wh||we===la||we===Sl||Re===wh||Re===la||Re===Sl)return $c;if(we===Bh&&[Bh,cl,qc,Xn].indexOf(Re)!==-1||(we===qc||we===cl)&&(Re===cl||Re===mA)||(we===Xn||we===mA)&&Re===mA||Re===Ch||Re===Vu||Re===gA||we===Ga)return ca;if(we===Ch&&Re===oc){for(;le===Vu;)le=O[--W];if(le===oc)return ca}if(we===md&&Re===md){for(var ft=0;le===md;)ft++,le=O[--W];if(ft%2===0)return ca}return $c},Gu=function(N){var O=JA(N),X=O.length,W=0,le=0,we=O.map(Ei);return{next:function(){if(W>=X)return{done:!0,value:null};for(var Re=ca;W<X&&(Re=Gi(O,we,++W))===ca;);if(Re!==ca||W===X){var ft=yd.apply(null,O.slice(le,W));return le=W,{value:ft,done:!1}}return{done:!0,value:null}}}},Us=function(N){for(var O=Gu(N),X=[],W;!(W=O.next()).done;)W.value&&X.push(W.value.slice());return X},Ft=function(N){var O=123;if(N.createRange){var X=N.createRange();if(X.getBoundingClientRect){var W=N.createElement("boundtest");W.style.height=O+"px",W.style.display="block",N.body.appendChild(W),X.selectNode(W);var le=X.getBoundingClientRect(),we=Math.round(le.height);if(N.body.removeChild(W),we===O)return!0}}return!1},ac=function(N){var O=N.createElement("boundtest");O.style.width="50px",O.style.display="block",O.style.fontSize="12px",O.style.letterSpacing="0px",O.style.wordSpacing="0px",N.body.appendChild(O);var X=N.createRange();O.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var W=O.firstChild,le=B(W.data).map(function(At){return T(At)}),we=0,Re={},ft=le.every(function(At,Ht){X.setStart(W,we),X.setEnd(W,we+At.length);var si=X.getBoundingClientRect();we+=At.length;var gi=si.x>Re.x||si.y>Re.y;return Re=si,Ht===0?!0:gi});return N.body.removeChild(O),ft},vd=function(){return typeof new Image().crossOrigin<"u"},yA=function(){return typeof new XMLHttpRequest().responseType=="string"},vA=function(N){var O=new Image,X=N.createElement("canvas"),W=X.getContext("2d");if(!W)return!1;O.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{W.drawImage(O,0,0),X.toDataURL()}catch{return!1}return!0},Wu=function(N){return N[0]===0&&N[1]===255&&N[2]===0&&N[3]===255},Df=function(N){var O=N.createElement("canvas"),X=100;O.width=X,O.height=X;var W=O.getContext("2d");if(!W)return Promise.reject(!1);W.fillStyle="rgb(0, 255, 0)",W.fillRect(0,0,X,X);var le=new Image,we=O.toDataURL();le.src=we;var Re=Su(X,X,0,0,le);return W.fillStyle="red",W.fillRect(0,0,X,X),Of(Re).then(function(ft){W.drawImage(ft,0,0);var At=W.getImageData(0,0,X,X).data;W.fillStyle="red",W.fillRect(0,0,X,X);var Ht=N.createElement("div");return Ht.style.backgroundImage="url("+we+")",Ht.style.height=X+"px",Wu(At)?Of(Su(X,X,0,0,Ht)):Promise.reject(!1)}).then(function(ft){return W.drawImage(ft,0,0),Wu(W.getImageData(0,0,X,X).data)}).catch(function(){return!1})},Su=function(N,O,X,W,le){var we="http://www.w3.org/2000/svg",Re=document.createElementNS(we,"svg"),ft=document.createElementNS(we,"foreignObject");return Re.setAttributeNS(null,"width",N.toString()),Re.setAttributeNS(null,"height",O.toString()),ft.setAttributeNS(null,"width","100%"),ft.setAttributeNS(null,"height","100%"),ft.setAttributeNS(null,"x",X.toString()),ft.setAttributeNS(null,"y",W.toString()),ft.setAttributeNS(null,"externalResourcesRequired","true"),Re.appendChild(ft),ft.appendChild(le),Re},Of=function(N){return new Promise(function(O,X){var W=new Image;W.onload=function(){return O(W)},W.onerror=X,W.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(N))})},Ma={get SUPPORT_RANGE_BOUNDS(){var N=Ft(document);return Object.defineProperty(Ma,"SUPPORT_RANGE_BOUNDS",{value:N}),N},get SUPPORT_WORD_BREAKING(){var N=Ma.SUPPORT_RANGE_BOUNDS&&ac(document);return Object.defineProperty(Ma,"SUPPORT_WORD_BREAKING",{value:N}),N},get SUPPORT_SVG_DRAWING(){var N=vA(document);return Object.defineProperty(Ma,"SUPPORT_SVG_DRAWING",{value:N}),N},get SUPPORT_FOREIGNOBJECT_DRAWING(){var N=typeof Array.from=="function"&&typeof window.fetch=="function"?Df(document):Promise.resolve(!1);return Object.defineProperty(Ma,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:N}),N},get SUPPORT_CORS_IMAGES(){var N=vd();return Object.defineProperty(Ma,"SUPPORT_CORS_IMAGES",{value:N}),N},get SUPPORT_RESPONSE_TYPE(){var N=yA();return Object.defineProperty(Ma,"SUPPORT_RESPONSE_TYPE",{value:N}),N},get SUPPORT_CORS_XHR(){var N="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ma,"SUPPORT_CORS_XHR",{value:N}),N},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var N=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ma,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:N}),N}},Kh=function(){function N(O,X){this.text=O,this.bounds=X}return N}(),Xu=function(N,O,X,W){var le=cc(O,X),we=[],Re=0;return le.forEach(function(ft){if(X.textDecorationLine.length||ft.trim().length>0)if(Ma.SUPPORT_RANGE_BOUNDS){var At=Sh(W,Re,ft.length).getClientRects();if(At.length>1){var Ht=lc(ft),si=0;Ht.forEach(function(Ui){we.push(new Kh(Ui,y.fromDOMRectList(N,Sh(W,si+Re,Ui.length).getClientRects()))),si+=Ui.length})}else we.push(new Kh(ft,y.fromDOMRectList(N,At)))}else{var gi=W.splitText(ft.length);we.push(new Kh(ft,_d(N,W))),W=gi}else Ma.SUPPORT_RANGE_BOUNDS||(W=W.splitText(ft.length));Re+=ft.length}),we},_d=function(N,O){var X=O.ownerDocument;if(X){var W=X.createElement("html2canvaswrapper");W.appendChild(O.cloneNode(!0));var le=O.parentNode;if(le){le.replaceChild(W,O);var we=b(N,W);return W.firstChild&&le.replaceChild(W.firstChild,W),we}}return y.EMPTY},Sh=function(N,O,X){var W=N.ownerDocument;if(!W)throw new Error("Node has no owner document");var le=W.createRange();return le.setStart(N,O),le.setEnd(N,O+X),le},lc=function(N){if(Ma.SUPPORT_NATIVE_TEXT_SEGMENTATION){var O=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(O.segment(N)).map(function(X){return X.segment})}return Us(N)},Sc=function(N,O){if(Ma.SUPPORT_NATIVE_TEXT_SEGMENTATION){var X=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(X.segment(N)).map(function(W){return W.segment})}return xd(N,O)},cc=function(N,O){return O.letterSpacing!==0?lc(N):Sc(N,O)},Zc=[32,160,4961,65792,65793,4153,4241],xd=function(N,O){for(var X=Wn(N,{lineBreak:O.lineBreak,wordBreak:O.overflowWrap==="break-word"?"break-word":O.wordBreak}),W=[],le,we=function(){if(le.value){var Re=le.value.slice(),ft=B(Re),At="";ft.forEach(function(Ht){Zc.indexOf(Ht)===-1?At+=T(Ht):(At.length&&W.push(At),W.push(T(Ht)),At="")}),At.length&&W.push(At)}};!(le=X.next()).done;)we();return W},Eu=function(){function N(O,X,W){this.text=Wa(X.data,W.textTransform),this.textBounds=Xu(O,this.text,W,X)}return N}(),Wa=function(N,O){switch(O){case 1:return N.toLowerCase();case 3:return N.replace(tf,Eh);case 2:return N.toUpperCase();default:return N}},tf=/(^|\s|:|-|\(|\))([a-z])/g,Eh=function(N,O,X){return N.length>0?O+X.toUpperCase():N},Ms=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.src=W.currentSrc||W.src,le.intrinsicWidth=W.naturalWidth,le.intrinsicHeight=W.naturalHeight,le.context.cache.addImage(le.src),le}return O}(qs),Rn=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.canvas=W,le.intrinsicWidth=W.width,le.intrinsicHeight=W.height,le}return O}(qs),Uf=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this,we=new XMLSerializer,Re=b(X,W);return W.setAttribute("width",Re.width+"px"),W.setAttribute("height",Re.height+"px"),le.svg="data:image/svg+xml,"+encodeURIComponent(we.serializeToString(W)),le.intrinsicWidth=W.width.baseVal.value,le.intrinsicHeight=W.height.baseVal.value,le.context.cache.addImage(le.svg),le}return O}(qs),Yu=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.value=W.value,le}return O}(qs),bd=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.start=W.start,le.reversed=typeof W.reversed=="boolean"&&W.reversed===!0,le}return O}(qs),_A=[{type:15,flags:0,unit:"px",number:3}],qh=[{type:16,flags:0,number:50}],Tp=function(N){return N.width>N.height?new y(N.left+(N.width-N.height)/2,N.top,N.height,N.height):N.width<N.height?new y(N.left,N.top+(N.height-N.width)/2,N.width,N.width):N},zf=function(N){var O=N.type===Ku?new Array(N.value.length+1).join(""):N.value;return O.length===0?N.placeholder||"":O},Th="checkbox",xA="radio",Ku="password",Ih=707406591,wd=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;switch(le.type=W.type.toLowerCase(),le.checked=W.checked,le.value=zf(W),(le.type===Th||le.type===xA)&&(le.styles.backgroundColor=3739148031,le.styles.borderTopColor=le.styles.borderRightColor=le.styles.borderBottomColor=le.styles.borderLeftColor=2779096575,le.styles.borderTopWidth=le.styles.borderRightWidth=le.styles.borderBottomWidth=le.styles.borderLeftWidth=1,le.styles.borderTopStyle=le.styles.borderRightStyle=le.styles.borderBottomStyle=le.styles.borderLeftStyle=1,le.styles.backgroundClip=[0],le.styles.backgroundOrigin=[0],le.bounds=Tp(le.bounds)),le.type){case Th:le.styles.borderTopRightRadius=le.styles.borderTopLeftRadius=le.styles.borderBottomRightRadius=le.styles.borderBottomLeftRadius=_A;break;case xA:le.styles.borderTopRightRadius=le.styles.borderTopLeftRadius=le.styles.borderBottomRightRadius=le.styles.borderBottomLeftRadius=qh;break}return le}return O}(qs),rf=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this,we=W.options[W.selectedIndex||0];return le.value=we&&we.text||"",le}return O}(qs),Bd=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.value=W.value,le}return O}(qs),Cd=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;le.src=W.src,le.width=parseInt(W.width,10)||0,le.height=parseInt(W.height,10)||0,le.backgroundColor=le.styles.backgroundColor;try{if(W.contentWindow&&W.contentWindow.document&&W.contentWindow.document.documentElement){le.tree=Nf(X,W.contentWindow.document.documentElement);var we=W.contentWindow.document.documentElement?Ol(X,getComputedStyle(W.contentWindow.document.documentElement).backgroundColor):bl.TRANSPARENT,Re=W.contentWindow.document.body?Ol(X,getComputedStyle(W.contentWindow.document.body).backgroundColor):bl.TRANSPARENT;le.backgroundColor=Ia(we)?Ia(Re)?le.styles.backgroundColor:Re:we}}catch{}return le}return O}(qs),Xa=["OL","UL","MENU"],Fh=function(N,O,X,W){for(var le=O.firstChild,we=void 0;le;le=we)if(we=le.nextSibling,bA(le)&&le.data.trim().length>0)X.textNodes.push(new Eu(N,le,X.styles));else if(Zo(le))if(Mp(le)&&le.assignedNodes)le.assignedNodes().forEach(function(ft){return Fh(N,ft,X,W)});else{var Re=Lh(N,le);Re.styles.isVisible()&&(jf(le,Re,W)?Re.flags|=4:Ip(Re.styles)&&(Re.flags|=2),Xa.indexOf(le.tagName)!==-1&&(Re.flags|=8),X.elements.push(Re),le.slot,le.shadowRoot?Fh(N,le.shadowRoot,Re,W):!of(le)&&!sf(le)&&!Ed(le)&&Fh(N,le,Re,W))}},Lh=function(N,O){return Zh(O)?new Ms(N,O):Hf(O)?new Rn(N,O):sf(O)?new Uf(N,O):Fp(O)?new Yu(N,O):$h(O)?new bd(N,O):nf(O)?new wd(N,O):Ed(O)?new rf(N,O):of(O)?new Bd(N,O):CA(O)?new Cd(N,O):new qs(N,O)},Nf=function(N,O){var X=Lh(N,O);return X.flags|=4,Fh(N,O,X,X),X},jf=function(N,O,X){return O.styles.isPositionedWithZIndex()||O.styles.opacity<1||O.styles.isTransformed()||Mh(N)&&X.styles.isTransparent()},Ip=function(N){return N.isPositioned()||N.isFloating()},bA=function(N){return N.nodeType===Node.TEXT_NODE},Zo=function(N){return N.nodeType===Node.ELEMENT_NODE},Sd=function(N){return Zo(N)&&typeof N.style<"u"&&!wA(N)},wA=function(N){return typeof N.className=="object"},Fp=function(N){return N.tagName==="LI"},$h=function(N){return N.tagName==="OL"},nf=function(N){return N.tagName==="INPUT"},Lp=function(N){return N.tagName==="HTML"},sf=function(N){return N.tagName==="svg"},Mh=function(N){return N.tagName==="BODY"},Hf=function(N){return N.tagName==="CANVAS"},BA=function(N){return N.tagName==="VIDEO"},Zh=function(N){return N.tagName==="IMG"},CA=function(N){return N.tagName==="IFRAME"},Qf=function(N){return N.tagName==="STYLE"},Vf=function(N){return N.tagName==="SCRIPT"},of=function(N){return N.tagName==="TEXTAREA"},Ed=function(N){return N.tagName==="SELECT"},Mp=function(N){return N.tagName==="SLOT"},Pp=function(N){return N.tagName.indexOf("-")>0},xg=function(){function N(){this.counters={}}return N.prototype.getCounterValue=function(O){var X=this.counters[O];return X&&X.length?X[X.length-1]:1},N.prototype.getCounterValues=function(O){var X=this.counters[O];return X||[]},N.prototype.pop=function(O){var X=this;O.forEach(function(W){return X.counters[W].pop()})},N.prototype.parse=function(O){var X=this,W=O.counterIncrement,le=O.counterReset,we=!0;W!==null&&W.forEach(function(ft){var At=X.counters[ft.counter];At&&ft.increment!==0&&(we=!1,At.length||At.push(1),At[Math.max(0,At.length-1)]+=ft.increment)});var Re=[];return we&&le.forEach(function(ft){var At=X.counters[ft.counter];Re.push(ft.counter),At||(At=X.counters[ft.counter]=[]),At.push(ft.reset)}),Re},N}(),kp={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Gf={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},bg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},wg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Td=function(N,O,X,W,le,we){return N<O||N>X?Fd(N,le,we.length>0):W.integers.reduce(function(Re,ft,At){for(;N>=ft;)N-=ft,Re+=W.values[At];return Re},"")+we},Rp=function(N,O,X,W){var le="";do X||N--,le=W(N)+le,N/=O;while(N*O>=O);return le},ma=function(N,O,X,W,le){var we=X-O+1;return(N<0?"-":"")+(Rp(Math.abs(N),we,W,function(Re){return T(Math.floor(Re%we)+O)})+le)},Jh=function(N,O,X){X===void 0&&(X=". ");var W=O.length;return Rp(Math.abs(N),W,!1,function(le){return O[Math.floor(le%W)]})+X},SA=1,ed=2,Tu=4,Vs=8,qu=function(N,O,X,W,le,we){if(N<-9999||N>9999)return Fd(N,4,le.length>0);var Re=Math.abs(N),ft=le;if(Re===0)return O[0]+ft;for(var At=0;Re>0&&At<=4;At++){var Ht=Re%10;Ht===0&&Hi(we,SA)&&ft!==""?ft=O[Ht]+ft:Ht>1||Ht===1&&At===0||Ht===1&&At===1&&Hi(we,ed)||Ht===1&&At===1&&Hi(we,Tu)&&N>100||Ht===1&&At>1&&Hi(we,Vs)?ft=O[Ht]+(At>0?X[At-1]:"")+ft:Ht===1&&At>0&&(ft=X[At-1]+ft),Re=Math.floor(Re/10)}return(N<0?W:"")+ft},af="",Wf="",Dp="",Id="",Fd=function(N,O,X){var W=X?". ":"",le=X?"":"",we=X?", ":"",Re=X?" ":"";switch(O){case 0:return""+Re;case 1:return""+Re;case 2:return""+Re;case 5:var ft=ma(N,48,57,!0,W);return ft.length<4?"0"+ft:ft;case 4:return Jh(N,"",le);case 6:return Td(N,1,3999,kp,3,W).toLowerCase();case 7:return Td(N,1,3999,kp,3,W);case 8:return ma(N,945,969,!1,W);case 9:return ma(N,97,122,!1,W);case 10:return ma(N,65,90,!1,W);case 11:return ma(N,1632,1641,!0,W);case 12:case 49:return Td(N,1,9999,Gf,3,W);case 35:return Td(N,1,9999,Gf,3,W).toLowerCase();case 13:return ma(N,2534,2543,!0,W);case 14:case 30:return ma(N,6112,6121,!0,W);case 15:return Jh(N,"",le);case 16:return Jh(N,"",le);case 17:case 48:return qu(N,"",af,"",le,ed|Tu|Vs);case 47:return qu(N,"",Wf,"",le,SA|ed|Tu|Vs);case 42:return qu(N,"",af,"",le,ed|Tu|Vs);case 41:return qu(N,"",Wf,"",le,SA|ed|Tu|Vs);case 26:return qu(N,"","",Dp,le,0);case 25:return qu(N,"","",Dp,le,SA|ed|Tu);case 31:return qu(N,"","",Id,we,SA|ed|Tu);case 33:return qu(N,"","",Id,we,0);case 32:return qu(N,"","",Id,we,SA|ed|Tu);case 18:return ma(N,2406,2415,!0,W);case 20:return Td(N,1,19999,wg,3,W);case 21:return ma(N,2790,2799,!0,W);case 22:return ma(N,2662,2671,!0,W);case 22:return Td(N,1,10999,bg,3,W);case 23:return Jh(N,"");case 24:return Jh(N,"");case 27:return ma(N,3302,3311,!0,W);case 28:return Jh(N,"",le);case 29:return Jh(N,"",le);case 34:return ma(N,3792,3801,!0,W);case 37:return ma(N,6160,6169,!0,W);case 38:return ma(N,4160,4169,!0,W);case 39:return ma(N,2918,2927,!0,W);case 40:return ma(N,1776,1785,!0,W);case 43:return ma(N,3046,3055,!0,W);case 44:return ma(N,3174,3183,!0,W);case 45:return ma(N,3664,3673,!0,W);case 46:return ma(N,3872,3881,!0,W);case 3:default:return ma(N,48,57,!0,W)}},lf="data-html2canvas-ignore",EA=function(){function N(O,X,W){if(this.context=O,this.options=W,this.scrolledElements=[],this.referenceElement=X,this.counters=new xg,this.quoteDepth=0,!X.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(X.ownerDocument.documentElement,!1)}return N.prototype.toIFrame=function(O,X){var W=this,le=Xf(O,X);if(!le.contentWindow)return Promise.reject("Unable to find iframe window");var we=O.defaultView.pageXOffset,Re=O.defaultView.pageYOffset,ft=le.contentWindow,At=ft.document,Ht=cf(le).then(function(){return d(W,void 0,void 0,function(){var si,gi;return A(this,function(Ui){switch(Ui.label){case 0:return this.scrolledElements.forEach(Op),ft&&(ft.scrollTo(X.left,X.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(ft.scrollY!==X.top||ft.scrollX!==X.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(ft.scrollX-X.left,ft.scrollY-X.top,0,0))),si=this.options.onclone,gi=this.clonedReferenceElement,typeof gi>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:At.fonts&&At.fonts.ready?[4,At.fonts.ready]:[3,2];case 1:Ui.sent(),Ui.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,$u(At)]:[3,4];case 3:Ui.sent(),Ui.label=4;case 4:return typeof si=="function"?[2,Promise.resolve().then(function(){return si(At,gi)}).then(function(){return le})]:[2,le]}})})});return At.open(),At.write(gm(document.doctype)+"<html></html>"),TA(this.referenceElement.ownerDocument,we,Re),At.replaceChild(At.adoptNode(this.documentElement),At.documentElement),At.close(),Ht},N.prototype.createElementClone=function(O){if(Vn(O,2))debugger;if(Hf(O))return this.createCanvasClone(O);if(BA(O))return this.createVideoClone(O);if(Qf(O))return this.createStyleClone(O);var X=O.cloneNode(!1);return Zh(X)&&(Zh(O)&&O.currentSrc&&O.currentSrc!==O.src&&(X.src=O.currentSrc,X.srcset=""),X.loading==="lazy"&&(X.loading="eager")),Pp(X)?this.createCustomElementClone(X):X},N.prototype.createCustomElementClone=function(O){var X=document.createElement("html2canvascustomelement");return Kf(O.style,X),X},N.prototype.createStyleClone=function(O){try{var X=O.sheet;if(X&&X.cssRules){var W=[].slice.call(X.cssRules,0).reduce(function(we,Re){return Re&&typeof Re.cssText=="string"?we+Re.cssText:we},""),le=O.cloneNode(!1);return le.textContent=W,le}}catch(we){if(this.context.logger.error("Unable to access cssRules property",we),we.name!=="SecurityError")throw we}return O.cloneNode(!1)},N.prototype.createCanvasClone=function(O){var X;if(this.options.inlineImages&&O.ownerDocument){var W=O.ownerDocument.createElement("img");try{return W.src=O.toDataURL(),W}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",O)}}var le=O.cloneNode(!1);try{le.width=O.width,le.height=O.height;var we=O.getContext("2d"),Re=le.getContext("2d");if(Re)if(!this.options.allowTaint&&we)Re.putImageData(we.getImageData(0,0,O.width,O.height),0,0);else{var ft=(X=O.getContext("webgl2"))!==null&&X!==void 0?X:O.getContext("webgl");if(ft){var At=ft.getContextAttributes();(At==null?void 0:At.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",O)}Re.drawImage(O,0,0)}return le}catch{this.context.logger.info("Unable to clone canvas as it is tainted",O)}return le},N.prototype.createVideoClone=function(O){var X=O.ownerDocument.createElement("canvas");X.width=O.offsetWidth,X.height=O.offsetHeight;var W=X.getContext("2d");try{return W&&(W.drawImage(O,0,0,X.width,X.height),this.options.allowTaint||W.getImageData(0,0,X.width,X.height)),X}catch{this.context.logger.info("Unable to clone video as it is tainted",O)}var le=O.ownerDocument.createElement("canvas");return le.width=O.offsetWidth,le.height=O.offsetHeight,le},N.prototype.appendChildNode=function(O,X,W){(!Zo(X)||!Vf(X)&&!X.hasAttribute(lf)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(X)))&&(!this.options.copyStyles||!Zo(X)||!Qf(X))&&O.appendChild(this.cloneNode(X,W))},N.prototype.cloneChildNodes=function(O,X,W){for(var le=this,we=O.shadowRoot?O.shadowRoot.firstChild:O.firstChild;we;we=we.nextSibling)if(Zo(we)&&Mp(we)&&typeof we.assignedNodes=="function"){var Re=we.assignedNodes();Re.length&&Re.forEach(function(ft){return le.appendChildNode(X,ft,W)})}else this.appendChildNode(X,we,W)},N.prototype.cloneNode=function(O,X){if(bA(O))return document.createTextNode(O.data);if(!O.ownerDocument)return O.cloneNode(!1);var W=O.ownerDocument.defaultView;if(W&&Zo(O)&&(Sd(O)||wA(O))){var le=this.createElementClone(O);le.style.transitionProperty="none";var we=W.getComputedStyle(O),Re=W.getComputedStyle(O,":before"),ft=W.getComputedStyle(O,":after");this.referenceElement===O&&Sd(le)&&(this.clonedReferenceElement=le),Mh(le)&&Ph(le);var At=this.counters.parse(new Ls(this.context,we)),Ht=this.resolvePseudoContent(O,le,Re,Ec.BEFORE);Pp(O)&&(X=!0),BA(O)||this.cloneChildNodes(O,le,X),Ht&&le.insertBefore(Ht,le.firstChild);var si=this.resolvePseudoContent(O,le,ft,Ec.AFTER);return si&&le.appendChild(si),this.counters.pop(At),(we&&(this.options.copyStyles||wA(O))&&!CA(O)||X)&&Kf(we,le),(O.scrollTop!==0||O.scrollLeft!==0)&&this.scrolledElements.push([le,O.scrollLeft,O.scrollTop]),(of(O)||Ed(O))&&(of(le)||Ed(le))&&(le.value=O.value),le}return O.cloneNode(!1)},N.prototype.resolvePseudoContent=function(O,X,W,le){var we=this;if(W){var Re=W.content,ft=X.ownerDocument;if(!(!ft||!Re||Re==="none"||Re==="-moz-alt-content"||W.display==="none")){this.counters.parse(new Ls(this.context,W));var At=new Qs(this.context,W),Ht=ft.createElement("html2canvaspseudoelement");Kf(W,Ht),At.content.forEach(function(gi){if(gi.type===0)Ht.appendChild(ft.createTextNode(gi.value));else if(gi.type===22){var Ui=ft.createElement("img");Ui.src=gi.value,Ui.style.opacity="1",Ht.appendChild(Ui)}else if(gi.type===18){if(gi.name==="attr"){var Gr=gi.values.filter(xn);Gr.length&&Ht.appendChild(ft.createTextNode(O.getAttribute(Gr[0].value)||""))}else if(gi.name==="counter"){var vr=gi.values.filter(ji),Rr=vr[0],Kn=vr[1];if(Rr&&xn(Rr)){var An=we.counters.getCounterValue(Rr.value),rn=Kn&&xn(Kn)?aA.parse(we.context,Kn.value):3;Ht.appendChild(ft.createTextNode(Fd(An,rn,!1)))}}else if(gi.name==="counters"){var Xs=gi.values.filter(ji),Rr=Xs[0],ts=Xs[1],Kn=Xs[2];if(Rr&&xn(Rr)){var Dn=we.counters.getCounterValues(Rr.value),Kr=Kn&&xn(Kn)?aA.parse(we.context,Kn.value):3,rs=ts&&ts.type===0?ts.value:"",bs=Dn.map(function(uc){return Fd(uc,Kr,!1)}).join(rs);Ht.appendChild(ft.createTextNode(bs))}}}else if(gi.type===20)switch(gi.value){case"open-quote":Ht.appendChild(ft.createTextNode($i(At.quotes,we.quoteDepth++,!0)));break;case"close-quote":Ht.appendChild(ft.createTextNode($i(At.quotes,--we.quoteDepth,!1)));break;default:Ht.appendChild(ft.createTextNode(gi.value))}}),Ht.className=hf+" "+Ld;var si=le===Ec.BEFORE?" "+hf:" "+Ld;return wA(X)?X.className.baseValue+=si:X.className+=si,Ht}}},N.destroy=function(O){return O.parentNode?(O.parentNode.removeChild(O),!0):!1},N}(),Ec;(function(N){N[N.BEFORE=0]="BEFORE",N[N.AFTER=1]="AFTER"})(Ec||(Ec={}));var Xf=function(N,O){var X=N.createElement("iframe");return X.className="html2canvas-container",X.style.visibility="hidden",X.style.position="fixed",X.style.left="-10000px",X.style.top="0px",X.style.border="0",X.width=O.width.toString(),X.height=O.height.toString(),X.scrolling="no",X.setAttribute(lf,"true"),N.body.appendChild(X),X},To=function(N){return new Promise(function(O){if(N.complete){O();return}if(!N.src){O();return}N.onload=O,N.onerror=O})},$u=function(N){return Promise.all([].slice.call(N.images,0).map(To))},cf=function(N){return new Promise(function(O,X){var W=N.contentWindow;if(!W)return X("No window assigned for iframe");var le=W.document;W.onload=N.onload=function(){W.onload=N.onload=null;var we=setInterval(function(){le.body.childNodes.length>0&&le.readyState==="complete"&&(clearInterval(we),O(N))},50)}})},Yf=["all","d","content"],Kf=function(N,O){for(var X=N.length-1;X>=0;X--){var W=N.item(X);Yf.indexOf(W)===-1&&O.style.setProperty(W,N.getPropertyValue(W))}return O},gm=function(N){var O="";return N&&(O+="<!DOCTYPE ",N.name&&(O+=N.name),N.internalSubset&&(O+=N.internalSubset),N.publicId&&(O+='"'+N.publicId+'"'),N.systemId&&(O+='"'+N.systemId+'"'),O+=">"),O},TA=function(N,O,X){N&&N.defaultView&&(O!==N.defaultView.pageXOffset||X!==N.defaultView.pageYOffset)&&N.defaultView.scrollTo(O,X)},Op=function(N){var O=N[0],X=N[1],W=N[2];O.scrollLeft=X,O.scrollTop=W},Zu=":before",uf=":after",hf="___html2canvas___pseudoelement_before",Ld="___html2canvas___pseudoelement_after",Md=`{
    content: "" !important;
    display: none !important;
}`,Ph=function(N){Iu(N,"."+hf+Zu+Md+`
         .`+Ld+uf+Md)},Iu=function(N,O){var X=N.ownerDocument;if(X){var W=X.createElement("style");W.textContent=O,N.appendChild(W)}},Tc=function(){function N(){}return N.getOrigin=function(O){var X=N._link;return X?(X.href=O,X.href=X.href,X.protocol+X.hostname+X.port):"about:blank"},N.isSameOrigin=function(O){return N.getOrigin(O)===N._origin},N.setContext=function(O){N._link=O.document.createElement("a"),N._origin=N.getOrigin(O.location.href)},N._origin="about:blank",N}(),IA=function(){function N(O,X){this.context=O,this._options=X,this._cache={}}return N.prototype.addImage=function(O){var X=Promise.resolve();return this.has(O)||(S(O)||g(O))&&(this._cache[O]=this.loadImage(O)).catch(function(){}),X},N.prototype.match=function(O){return this._cache[O]},N.prototype.loadImage=function(O){return d(this,void 0,void 0,function(){var X,W,le,we,Re=this;return A(this,function(ft){switch(ft.label){case 0:return X=Tc.isSameOrigin(O),W=!_(O)&&this._options.useCORS===!0&&Ma.SUPPORT_CORS_IMAGES&&!X,le=!_(O)&&!X&&!S(O)&&typeof this._options.proxy=="string"&&Ma.SUPPORT_CORS_XHR&&!W,!X&&this._options.allowTaint===!1&&!_(O)&&!S(O)&&!le&&!W?[2]:(we=O,le?[4,this.proxy(we)]:[3,2]);case 1:we=ft.sent(),ft.label=2;case 2:return this.context.logger.debug("Added image "+O.substring(0,256)),[4,new Promise(function(At,Ht){var si=new Image;si.onload=function(){return At(si)},si.onerror=Ht,(w(we)||W)&&(si.crossOrigin="anonymous"),si.src=we,si.complete===!0&&setTimeout(function(){return At(si)},500),Re._options.imageTimeout>0&&setTimeout(function(){return Ht("Timed out ("+Re._options.imageTimeout+"ms) loading image")},Re._options.imageTimeout)})];case 3:return[2,ft.sent()]}})})},N.prototype.has=function(O){return typeof this._cache[O]<"u"},N.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},N.prototype.proxy=function(O){var X=this,W=this._options.proxy;if(!W)throw new Error("No proxy defined");var le=O.substring(0,256);return new Promise(function(we,Re){var ft=Ma.SUPPORT_RESPONSE_TYPE?"blob":"text",At=new XMLHttpRequest;At.onload=function(){if(At.status===200)if(ft==="text")we(At.response);else{var gi=new FileReader;gi.addEventListener("load",function(){return we(gi.result)},!1),gi.addEventListener("error",function(Ui){return Re(Ui)},!1),gi.readAsDataURL(At.response)}else Re("Failed to proxy resource "+le+" with status code "+At.status)},At.onerror=Re;var Ht=W.indexOf("?")>-1?"&":"?";if(At.open("GET",""+W+Ht+"url="+encodeURIComponent(O)+"&responseType="+ft),ft!=="text"&&At instanceof XMLHttpRequest&&(At.responseType=ft),X._options.imageTimeout){var si=X._options.imageTimeout;At.timeout=si,At.ontimeout=function(){return Re("Timed out ("+si+"ms) proxying "+le)}}At.send()})},N}(),p=/^data:image\/svg\+xml/i,n=/^data:image\/.*;base64,/i,u=/^data:image\/.*/i,g=function(N){return Ma.SUPPORT_SVG_DRAWING||!L(N)},_=function(N){return u.test(N)},w=function(N){return n.test(N)},S=function(N){return N.substr(0,4)==="blob"},L=function(N){return N.substr(-3).toLowerCase()==="svg"||p.test(N)},M=function(){function N(O,X){this.type=0,this.x=O,this.y=X}return N.prototype.add=function(O,X){return new N(this.x+O,this.y+X)},N}(),V=function(N,O,X){return new M(N.x+(O.x-N.x)*X,N.y+(O.y-N.y)*X)},Y=function(){function N(O,X,W,le){this.type=1,this.start=O,this.startControl=X,this.endControl=W,this.end=le}return N.prototype.subdivide=function(O,X){var W=V(this.start,this.startControl,O),le=V(this.startControl,this.endControl,O),we=V(this.endControl,this.end,O),Re=V(W,le,O),ft=V(le,we,O),At=V(Re,ft,O);return X?new N(this.start,W,Re,At):new N(At,ft,we,this.end)},N.prototype.add=function(O,X){return new N(this.start.add(O,X),this.startControl.add(O,X),this.endControl.add(O,X),this.end.add(O,X))},N.prototype.reverse=function(){return new N(this.end,this.endControl,this.startControl,this.start)},N}(),J=function(N){return N.type===1},Z=function(){function N(O){var X=O.styles,W=O.bounds,le=Xo(X.borderTopLeftRadius,W.width,W.height),we=le[0],Re=le[1],ft=Xo(X.borderTopRightRadius,W.width,W.height),At=ft[0],Ht=ft[1],si=Xo(X.borderBottomRightRadius,W.width,W.height),gi=si[0],Ui=si[1],Gr=Xo(X.borderBottomLeftRadius,W.width,W.height),vr=Gr[0],Rr=Gr[1],Kn=[];Kn.push((we+At)/W.width),Kn.push((vr+gi)/W.width),Kn.push((Re+Rr)/W.height),Kn.push((Ht+Ui)/W.height);var An=Math.max.apply(Math,Kn);An>1&&(we/=An,Re/=An,At/=An,Ht/=An,gi/=An,Ui/=An,vr/=An,Rr/=An);var rn=W.width-At,Xs=W.height-Ui,ts=W.width-gi,Dn=W.height-Rr,Kr=X.borderTopWidth,rs=X.borderRightWidth,bs=X.borderBottomWidth,Ln=X.borderLeftWidth,Fo=Jn(X.paddingTop,O.bounds.width),uc=Jn(X.paddingRight,O.bounds.width),El=Jn(X.paddingBottom,O.bounds.width),po=Jn(X.paddingLeft,O.bounds.width);this.topLeftBorderDoubleOuterBox=we>0||Re>0?de(W.left+Ln/3,W.top+Kr/3,we-Ln/3,Re-Kr/3,te.TOP_LEFT):new M(W.left+Ln/3,W.top+Kr/3),this.topRightBorderDoubleOuterBox=we>0||Re>0?de(W.left+rn,W.top+Kr/3,At-rs/3,Ht-Kr/3,te.TOP_RIGHT):new M(W.left+W.width-rs/3,W.top+Kr/3),this.bottomRightBorderDoubleOuterBox=gi>0||Ui>0?de(W.left+ts,W.top+Xs,gi-rs/3,Ui-bs/3,te.BOTTOM_RIGHT):new M(W.left+W.width-rs/3,W.top+W.height-bs/3),this.bottomLeftBorderDoubleOuterBox=vr>0||Rr>0?de(W.left+Ln/3,W.top+Dn,vr-Ln/3,Rr-bs/3,te.BOTTOM_LEFT):new M(W.left+Ln/3,W.top+W.height-bs/3),this.topLeftBorderDoubleInnerBox=we>0||Re>0?de(W.left+Ln*2/3,W.top+Kr*2/3,we-Ln*2/3,Re-Kr*2/3,te.TOP_LEFT):new M(W.left+Ln*2/3,W.top+Kr*2/3),this.topRightBorderDoubleInnerBox=we>0||Re>0?de(W.left+rn,W.top+Kr*2/3,At-rs*2/3,Ht-Kr*2/3,te.TOP_RIGHT):new M(W.left+W.width-rs*2/3,W.top+Kr*2/3),this.bottomRightBorderDoubleInnerBox=gi>0||Ui>0?de(W.left+ts,W.top+Xs,gi-rs*2/3,Ui-bs*2/3,te.BOTTOM_RIGHT):new M(W.left+W.width-rs*2/3,W.top+W.height-bs*2/3),this.bottomLeftBorderDoubleInnerBox=vr>0||Rr>0?de(W.left+Ln*2/3,W.top+Dn,vr-Ln*2/3,Rr-bs*2/3,te.BOTTOM_LEFT):new M(W.left+Ln*2/3,W.top+W.height-bs*2/3),this.topLeftBorderStroke=we>0||Re>0?de(W.left+Ln/2,W.top+Kr/2,we-Ln/2,Re-Kr/2,te.TOP_LEFT):new M(W.left+Ln/2,W.top+Kr/2),this.topRightBorderStroke=we>0||Re>0?de(W.left+rn,W.top+Kr/2,At-rs/2,Ht-Kr/2,te.TOP_RIGHT):new M(W.left+W.width-rs/2,W.top+Kr/2),this.bottomRightBorderStroke=gi>0||Ui>0?de(W.left+ts,W.top+Xs,gi-rs/2,Ui-bs/2,te.BOTTOM_RIGHT):new M(W.left+W.width-rs/2,W.top+W.height-bs/2),this.bottomLeftBorderStroke=vr>0||Rr>0?de(W.left+Ln/2,W.top+Dn,vr-Ln/2,Rr-bs/2,te.BOTTOM_LEFT):new M(W.left+Ln/2,W.top+W.height-bs/2),this.topLeftBorderBox=we>0||Re>0?de(W.left,W.top,we,Re,te.TOP_LEFT):new M(W.left,W.top),this.topRightBorderBox=At>0||Ht>0?de(W.left+rn,W.top,At,Ht,te.TOP_RIGHT):new M(W.left+W.width,W.top),this.bottomRightBorderBox=gi>0||Ui>0?de(W.left+ts,W.top+Xs,gi,Ui,te.BOTTOM_RIGHT):new M(W.left+W.width,W.top+W.height),this.bottomLeftBorderBox=vr>0||Rr>0?de(W.left,W.top+Dn,vr,Rr,te.BOTTOM_LEFT):new M(W.left,W.top+W.height),this.topLeftPaddingBox=we>0||Re>0?de(W.left+Ln,W.top+Kr,Math.max(0,we-Ln),Math.max(0,Re-Kr),te.TOP_LEFT):new M(W.left+Ln,W.top+Kr),this.topRightPaddingBox=At>0||Ht>0?de(W.left+Math.min(rn,W.width-rs),W.top+Kr,rn>W.width+rs?0:Math.max(0,At-rs),Math.max(0,Ht-Kr),te.TOP_RIGHT):new M(W.left+W.width-rs,W.top+Kr),this.bottomRightPaddingBox=gi>0||Ui>0?de(W.left+Math.min(ts,W.width-Ln),W.top+Math.min(Xs,W.height-bs),Math.max(0,gi-rs),Math.max(0,Ui-bs),te.BOTTOM_RIGHT):new M(W.left+W.width-rs,W.top+W.height-bs),this.bottomLeftPaddingBox=vr>0||Rr>0?de(W.left+Ln,W.top+Math.min(Dn,W.height-bs),Math.max(0,vr-Ln),Math.max(0,Rr-bs),te.BOTTOM_LEFT):new M(W.left+Ln,W.top+W.height-bs),this.topLeftContentBox=we>0||Re>0?de(W.left+Ln+po,W.top+Kr+Fo,Math.max(0,we-(Ln+po)),Math.max(0,Re-(Kr+Fo)),te.TOP_LEFT):new M(W.left+Ln+po,W.top+Kr+Fo),this.topRightContentBox=At>0||Ht>0?de(W.left+Math.min(rn,W.width+Ln+po),W.top+Kr+Fo,rn>W.width+Ln+po?0:At-Ln+po,Ht-(Kr+Fo),te.TOP_RIGHT):new M(W.left+W.width-(rs+uc),W.top+Kr+Fo),this.bottomRightContentBox=gi>0||Ui>0?de(W.left+Math.min(ts,W.width-(Ln+po)),W.top+Math.min(Xs,W.height+Kr+Fo),Math.max(0,gi-(rs+uc)),Ui-(bs+El),te.BOTTOM_RIGHT):new M(W.left+W.width-(rs+uc),W.top+W.height-(bs+El)),this.bottomLeftContentBox=vr>0||Rr>0?de(W.left+Ln+po,W.top+Dn,Math.max(0,vr-(Ln+po)),Rr-(bs+El),te.BOTTOM_LEFT):new M(W.left+Ln+po,W.top+W.height-(bs+El))}return N}(),te;(function(N){N[N.TOP_LEFT=0]="TOP_LEFT",N[N.TOP_RIGHT=1]="TOP_RIGHT",N[N.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",N[N.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(te||(te={}));var de=function(N,O,X,W,le){var we=4*((Math.sqrt(2)-1)/3),Re=X*we,ft=W*we,At=N+X,Ht=O+W;switch(le){case te.TOP_LEFT:return new Y(new M(N,Ht),new M(N,Ht-ft),new M(At-Re,O),new M(At,O));case te.TOP_RIGHT:return new Y(new M(N,O),new M(N+Re,O),new M(At,Ht-ft),new M(At,Ht));case te.BOTTOM_RIGHT:return new Y(new M(At,O),new M(At,O+ft),new M(N+Re,Ht),new M(N,Ht));case te.BOTTOM_LEFT:default:return new Y(new M(At,Ht),new M(At-Re,Ht),new M(N,O+ft),new M(N,O))}},ue=function(N){return[N.topLeftBorderBox,N.topRightBorderBox,N.bottomRightBorderBox,N.bottomLeftBorderBox]},ge=function(N){return[N.topLeftContentBox,N.topRightContentBox,N.bottomRightContentBox,N.bottomLeftContentBox]},_e=function(N){return[N.topLeftPaddingBox,N.topRightPaddingBox,N.bottomRightPaddingBox,N.bottomLeftPaddingBox]},Te=function(){function N(O,X,W){this.offsetX=O,this.offsetY=X,this.matrix=W,this.type=0,this.target=6}return N}(),Ne=function(){function N(O,X){this.path=O,this.target=X,this.type=1}return N}(),Qe=function(){function N(O){this.opacity=O,this.type=2,this.target=6}return N}(),at=function(N){return N.type===0},st=function(N){return N.type===1},it=function(N){return N.type===2},Xe=function(N,O){return N.length===O.length?N.some(function(X,W){return X===O[W]}):!1},lt=function(N,O,X,W,le){return N.map(function(we,Re){switch(Re){case 0:return we.add(O,X);case 1:return we.add(O+W,X);case 2:return we.add(O+W,X+le);case 3:return we.add(O,X+le)}return we})},dt=function(){function N(O){this.element=O,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return N}(),kt=function(){function N(O,X){if(this.container=O,this.parent=X,this.effects=[],this.curves=new Z(this.container),this.container.styles.opacity<1&&this.effects.push(new Qe(this.container.styles.opacity)),this.container.styles.transform!==null){var W=this.container.bounds.left+this.container.styles.transformOrigin[0].number,le=this.container.bounds.top+this.container.styles.transformOrigin[1].number,we=this.container.styles.transform;this.effects.push(new Te(W,le,we))}if(this.container.styles.overflowX!==0){var Re=ue(this.curves),ft=_e(this.curves);Xe(Re,ft)?this.effects.push(new Ne(Re,6)):(this.effects.push(new Ne(Re,2)),this.effects.push(new Ne(ft,4)))}}return N.prototype.getEffects=function(O){for(var X=[2,3].indexOf(this.container.styles.position)===-1,W=this.parent,le=this.effects.slice(0);W;){var we=W.effects.filter(function(At){return!st(At)});if(X||W.container.styles.position!==0||!W.parent){if(le.unshift.apply(le,we),X=[2,3].indexOf(W.container.styles.position)===-1,W.container.styles.overflowX!==0){var Re=ue(W.curves),ft=_e(W.curves);Xe(Re,ft)||le.unshift(new Ne(ft,6))}}else le.unshift.apply(le,we);W=W.parent}return le.filter(function(At){return Hi(At.target,O)})},N}(),Dt=function(N,O,X,W){N.container.elements.forEach(function(le){var we=Hi(le.flags,4),Re=Hi(le.flags,2),ft=new kt(le,N);Hi(le.styles.display,2048)&&W.push(ft);var At=Hi(le.flags,8)?[]:W;if(we||Re){var Ht=we||le.styles.isPositioned()?X:O,si=new dt(ft);if(le.styles.isPositioned()||le.styles.opacity<1||le.styles.isTransformed()){var gi=le.styles.zIndex.order;if(gi<0){var Ui=0;Ht.negativeZIndex.some(function(vr,Rr){return gi>vr.element.container.styles.zIndex.order?(Ui=Rr,!1):Ui>0}),Ht.negativeZIndex.splice(Ui,0,si)}else if(gi>0){var Gr=0;Ht.positiveZIndex.some(function(vr,Rr){return gi>=vr.element.container.styles.zIndex.order?(Gr=Rr+1,!1):Gr>0}),Ht.positiveZIndex.splice(Gr,0,si)}else Ht.zeroOrAutoZIndexOrTransformedOrOpacity.push(si)}else le.styles.isFloating()?Ht.nonPositionedFloats.push(si):Ht.nonPositionedInlineLevel.push(si);Dt(ft,si,we?si:X,At)}else le.styles.isInlineLevel()?O.inlineLevel.push(ft):O.nonInlineLevel.push(ft),Dt(ft,O,X,At);Hi(le.flags,8)&&ti(le,At)})},ti=function(N,O){for(var X=N instanceof bd?N.start:1,W=N instanceof bd?N.reversed:!1,le=0;le<O.length;le++){var we=O[le];we.container instanceof Yu&&typeof we.container.value=="number"&&we.container.value!==0&&(X=we.container.value),we.listValue=Fd(X,we.container.styles.listStyleType,!0),X+=W?-1:1}},ri=function(N){var O=new kt(N,null),X=new dt(O),W=[];return Dt(O,X,X,W),ti(O.container,W),X},vi=function(N,O){switch(O){case 0:return zt(N.topLeftBorderBox,N.topLeftPaddingBox,N.topRightBorderBox,N.topRightPaddingBox);case 1:return zt(N.topRightBorderBox,N.topRightPaddingBox,N.bottomRightBorderBox,N.bottomRightPaddingBox);case 2:return zt(N.bottomRightBorderBox,N.bottomRightPaddingBox,N.bottomLeftBorderBox,N.bottomLeftPaddingBox);case 3:default:return zt(N.bottomLeftBorderBox,N.bottomLeftPaddingBox,N.topLeftBorderBox,N.topLeftPaddingBox)}},Mt=function(N,O){switch(O){case 0:return zt(N.topLeftBorderBox,N.topLeftBorderDoubleOuterBox,N.topRightBorderBox,N.topRightBorderDoubleOuterBox);case 1:return zt(N.topRightBorderBox,N.topRightBorderDoubleOuterBox,N.bottomRightBorderBox,N.bottomRightBorderDoubleOuterBox);case 2:return zt(N.bottomRightBorderBox,N.bottomRightBorderDoubleOuterBox,N.bottomLeftBorderBox,N.bottomLeftBorderDoubleOuterBox);case 3:default:return zt(N.bottomLeftBorderBox,N.bottomLeftBorderDoubleOuterBox,N.topLeftBorderBox,N.topLeftBorderDoubleOuterBox)}},Vt=function(N,O){switch(O){case 0:return zt(N.topLeftBorderDoubleInnerBox,N.topLeftPaddingBox,N.topRightBorderDoubleInnerBox,N.topRightPaddingBox);case 1:return zt(N.topRightBorderDoubleInnerBox,N.topRightPaddingBox,N.bottomRightBorderDoubleInnerBox,N.bottomRightPaddingBox);case 2:return zt(N.bottomRightBorderDoubleInnerBox,N.bottomRightPaddingBox,N.bottomLeftBorderDoubleInnerBox,N.bottomLeftPaddingBox);case 3:default:return zt(N.bottomLeftBorderDoubleInnerBox,N.bottomLeftPaddingBox,N.topLeftBorderDoubleInnerBox,N.topLeftPaddingBox)}},wt=function(N,O){switch(O){case 0:return oi(N.topLeftBorderStroke,N.topRightBorderStroke);case 1:return oi(N.topRightBorderStroke,N.bottomRightBorderStroke);case 2:return oi(N.bottomRightBorderStroke,N.bottomLeftBorderStroke);case 3:default:return oi(N.bottomLeftBorderStroke,N.topLeftBorderStroke)}},oi=function(N,O){var X=[];return J(N)?X.push(N.subdivide(.5,!1)):X.push(N),J(O)?X.push(O.subdivide(.5,!0)):X.push(O),X},zt=function(N,O,X,W){var le=[];return J(N)?le.push(N.subdivide(.5,!1)):le.push(N),J(X)?le.push(X.subdivide(.5,!0)):le.push(X),J(W)?le.push(W.subdivide(.5,!0).reverse()):le.push(W),J(O)?le.push(O.subdivide(.5,!1).reverse()):le.push(O),le},mi=function(N){var O=N.bounds,X=N.styles;return O.add(X.borderLeftWidth,X.borderTopWidth,-(X.borderRightWidth+X.borderLeftWidth),-(X.borderTopWidth+X.borderBottomWidth))},Li=function(N){var O=N.styles,X=N.bounds,W=Jn(O.paddingLeft,X.width),le=Jn(O.paddingRight,X.width),we=Jn(O.paddingTop,X.width),Re=Jn(O.paddingBottom,X.width);return X.add(W+O.borderLeftWidth,we+O.borderTopWidth,-(O.borderRightWidth+O.borderLeftWidth+W+le),-(O.borderTopWidth+O.borderBottomWidth+we+Re))},ai=function(N,O){return N===0?O.bounds:N===2?Li(O):mi(O)},Mi=function(N,O){return N===0?O.bounds:N===2?Li(O):mi(O)},ir=function(N,O,X){var W=ai(gr(N.styles.backgroundOrigin,O),N),le=Mi(gr(N.styles.backgroundClip,O),N),we=pr(gr(N.styles.backgroundSize,O),X,W),Re=we[0],ft=we[1],At=Xo(gr(N.styles.backgroundPosition,O),W.width-Re,W.height-ft),Ht=Cr(gr(N.styles.backgroundRepeat,O),At,we,W,le),si=Math.round(W.left+At[0]),gi=Math.round(W.top+At[1]);return[Ht,si,gi,Re,ft]},tr=function(N){return xn(N)&&N.value===gh.AUTO},Ki=function(N){return typeof N=="number"},pr=function(N,O,X){var W=O[0],le=O[1],we=O[2],Re=N[0],ft=N[1];if(!Re)return[0,0];if(ao(Re)&&ft&&ao(ft))return[Jn(Re,X.width),Jn(ft,X.height)];var At=Ki(we);if(xn(Re)&&(Re.value===gh.CONTAIN||Re.value===gh.COVER)){if(Ki(we)){var Ht=X.width/X.height;return Ht<we!=(Re.value===gh.COVER)?[X.width,X.width/we]:[X.height*we,X.height]}return[X.width,X.height]}var si=Ki(W),gi=Ki(le),Ui=si||gi;if(tr(Re)&&(!ft||tr(ft))){if(si&&gi)return[W,le];if(!At&&!Ui)return[X.width,X.height];if(Ui&&At){var Gr=si?W:le*we,vr=gi?le:W/we;return[Gr,vr]}var Rr=si?W:X.width,Kn=gi?le:X.height;return[Rr,Kn]}if(At){var An=0,rn=0;return ao(Re)?An=Jn(Re,X.width):ao(ft)&&(rn=Jn(ft,X.height)),tr(Re)?An=rn*we:(!ft||tr(ft))&&(rn=An/we),[An,rn]}var Xs=null,ts=null;if(ao(Re)?Xs=Jn(Re,X.width):ft&&ao(ft)&&(ts=Jn(ft,X.height)),Xs!==null&&(!ft||tr(ft))&&(ts=si&&gi?Xs/W*le:X.height),ts!==null&&tr(Re)&&(Xs=si&&gi?ts/le*W:X.width),Xs!==null&&ts!==null)return[Xs,ts];throw new Error("Unable to calculate background-size for element")},gr=function(N,O){var X=N[O];return typeof X>"u"?N[0]:X},Cr=function(N,O,X,W,le){var we=O[0],Re=O[1],ft=X[0],At=X[1];switch(N){case 2:return[new M(Math.round(W.left),Math.round(W.top+Re)),new M(Math.round(W.left+W.width),Math.round(W.top+Re)),new M(Math.round(W.left+W.width),Math.round(At+W.top+Re)),new M(Math.round(W.left),Math.round(At+W.top+Re))];case 3:return[new M(Math.round(W.left+we),Math.round(W.top)),new M(Math.round(W.left+we+ft),Math.round(W.top)),new M(Math.round(W.left+we+ft),Math.round(W.height+W.top)),new M(Math.round(W.left+we),Math.round(W.height+W.top))];case 1:return[new M(Math.round(W.left+we),Math.round(W.top+Re)),new M(Math.round(W.left+we+ft),Math.round(W.top+Re)),new M(Math.round(W.left+we+ft),Math.round(W.top+Re+At)),new M(Math.round(W.left+we),Math.round(W.top+Re+At))];default:return[new M(Math.round(le.left),Math.round(le.top)),new M(Math.round(le.left+le.width),Math.round(le.top)),new M(Math.round(le.left+le.width),Math.round(le.height+le.top)),new M(Math.round(le.left),Math.round(le.height+le.top))]}},Hr="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",sn="Hidden Text",Yn=function(){function N(O){this._data={},this._document=O}return N.prototype.parseMetrics=function(O,X){var W=this._document.createElement("div"),le=this._document.createElement("img"),we=this._document.createElement("span"),Re=this._document.body;W.style.visibility="hidden",W.style.fontFamily=O,W.style.fontSize=X,W.style.margin="0",W.style.padding="0",W.style.whiteSpace="nowrap",Re.appendChild(W),le.src=Hr,le.width=1,le.height=1,le.style.margin="0",le.style.padding="0",le.style.verticalAlign="baseline",we.style.fontFamily=O,we.style.fontSize=X,we.style.margin="0",we.style.padding="0",we.appendChild(this._document.createTextNode(sn)),W.appendChild(we),W.appendChild(le);var ft=le.offsetTop-we.offsetTop+2;W.removeChild(we),W.appendChild(this._document.createTextNode(sn)),W.style.lineHeight="normal",le.style.verticalAlign="super";var At=le.offsetTop-W.offsetTop+2;return Re.removeChild(W),{baseline:ft,middle:At}},N.prototype.getMetrics=function(O,X){var W=O+" "+X;return typeof this._data[W]>"u"&&(this._data[W]=this.parseMetrics(O,X)),this._data[W]},N}(),xs=function(){function N(O,X){this.context=O,this.options=X}return N}(),es=1e4,is=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le._activeEffects=[],le.canvas=W.canvas?W.canvas:document.createElement("canvas"),le.ctx=le.canvas.getContext("2d"),W.canvas||(le.canvas.width=Math.floor(W.width*W.scale),le.canvas.height=Math.floor(W.height*W.scale),le.canvas.style.width=W.width+"px",le.canvas.style.height=W.height+"px"),le.fontMetrics=new Yn(document),le.ctx.scale(le.options.scale,le.options.scale),le.ctx.translate(-W.x,-W.y),le.ctx.textBaseline="bottom",le._activeEffects=[],le.context.logger.debug("Canvas renderer initialized ("+W.width+"x"+W.height+") with scale "+W.scale),le}return O.prototype.applyEffects=function(X){for(var W=this;this._activeEffects.length;)this.popEffect();X.forEach(function(le){return W.applyEffect(le)})},O.prototype.applyEffect=function(X){this.ctx.save(),it(X)&&(this.ctx.globalAlpha=X.opacity),at(X)&&(this.ctx.translate(X.offsetX,X.offsetY),this.ctx.transform(X.matrix[0],X.matrix[1],X.matrix[2],X.matrix[3],X.matrix[4],X.matrix[5]),this.ctx.translate(-X.offsetX,-X.offsetY)),st(X)&&(this.path(X.path),this.ctx.clip()),this._activeEffects.push(X)},O.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},O.prototype.renderStack=function(X){return d(this,void 0,void 0,function(){var W;return A(this,function(le){switch(le.label){case 0:return W=X.element.container.styles,W.isVisible()?[4,this.renderStackContent(X)]:[3,2];case 1:le.sent(),le.label=2;case 2:return[2]}})})},O.prototype.renderNode=function(X){return d(this,void 0,void 0,function(){return A(this,function(W){switch(W.label){case 0:if(Hi(X.container.flags,16))debugger;return X.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(X)]:[3,3];case 1:return W.sent(),[4,this.renderNodeContent(X)];case 2:W.sent(),W.label=3;case 3:return[2]}})})},O.prototype.renderTextWithLetterSpacing=function(X,W,le){var we=this;if(W===0)this.ctx.fillText(X.text,X.bounds.left,X.bounds.top+le);else{var Re=lc(X.text);Re.reduce(function(ft,At){return we.ctx.fillText(At,ft,X.bounds.top+le),ft+we.ctx.measureText(At).width},X.bounds.left)}},O.prototype.createFontStyle=function(X){var W=X.fontVariant.filter(function(Re){return Re==="normal"||Re==="small-caps"}).join(""),le=Ps(X.fontFamily).join(", "),we=Zs(X.fontSize)?""+X.fontSize.number+X.fontSize.unit:X.fontSize.number+"px";return[[X.fontStyle,W,X.fontWeight,we,le].join(" "),le,we]},O.prototype.renderTextNode=function(X,W){return d(this,void 0,void 0,function(){var le,we,Re,ft,At,Ht,si,gi,Ui=this;return A(this,function(Gr){return le=this.createFontStyle(W),we=le[0],Re=le[1],ft=le[2],this.ctx.font=we,this.ctx.direction=W.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",At=this.fontMetrics.getMetrics(Re,ft),Ht=At.baseline,si=At.middle,gi=W.paintOrder,X.textBounds.forEach(function(vr){gi.forEach(function(Rr){switch(Rr){case 0:Ui.ctx.fillStyle=_o(W.color),Ui.renderTextWithLetterSpacing(vr,W.letterSpacing,Ht);var Kn=W.textShadow;Kn.length&&vr.text.trim().length&&(Kn.slice(0).reverse().forEach(function(An){Ui.ctx.shadowColor=_o(An.color),Ui.ctx.shadowOffsetX=An.offsetX.number*Ui.options.scale,Ui.ctx.shadowOffsetY=An.offsetY.number*Ui.options.scale,Ui.ctx.shadowBlur=An.blur.number,Ui.renderTextWithLetterSpacing(vr,W.letterSpacing,Ht)}),Ui.ctx.shadowColor="",Ui.ctx.shadowOffsetX=0,Ui.ctx.shadowOffsetY=0,Ui.ctx.shadowBlur=0),W.textDecorationLine.length&&(Ui.ctx.fillStyle=_o(W.textDecorationColor||W.color),W.textDecorationLine.forEach(function(An){switch(An){case 1:Ui.ctx.fillRect(vr.bounds.left,Math.round(vr.bounds.top+Ht),vr.bounds.width,1);break;case 2:Ui.ctx.fillRect(vr.bounds.left,Math.round(vr.bounds.top),vr.bounds.width,1);break;case 3:Ui.ctx.fillRect(vr.bounds.left,Math.ceil(vr.bounds.top+si),vr.bounds.width,1);break}}));break;case 1:W.webkitTextStrokeWidth&&vr.text.trim().length&&(Ui.ctx.strokeStyle=_o(W.webkitTextStrokeColor),Ui.ctx.lineWidth=W.webkitTextStrokeWidth,Ui.ctx.lineJoin=window.chrome?"miter":"round",Ui.ctx.strokeText(vr.text,vr.bounds.left,vr.bounds.top+Ht)),Ui.ctx.strokeStyle="",Ui.ctx.lineWidth=0,Ui.ctx.lineJoin="miter";break}})}),[2]})})},O.prototype.renderReplacedElement=function(X,W,le){if(le&&X.intrinsicWidth>0&&X.intrinsicHeight>0){var we=Li(X),Re=_e(W);this.path(Re),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(le,0,0,X.intrinsicWidth,X.intrinsicHeight,we.left,we.top,we.width,we.height),this.ctx.restore()}},O.prototype.renderNodeContent=function(X){return d(this,void 0,void 0,function(){var W,le,we,Re,ft,At,rn,rn,Ht,si,gi,Ui,ts,Gr,vr,Dn,Rr,Kn,An,rn,Xs,ts,Dn;return A(this,function(Kr){switch(Kr.label){case 0:this.applyEffects(X.getEffects(4)),W=X.container,le=X.curves,we=W.styles,Re=0,ft=W.textNodes,Kr.label=1;case 1:return Re<ft.length?(At=ft[Re],[4,this.renderTextNode(At,we)]):[3,4];case 2:Kr.sent(),Kr.label=3;case 3:return Re++,[3,1];case 4:if(!(W instanceof Ms))return[3,8];Kr.label=5;case 5:return Kr.trys.push([5,7,,8]),[4,this.context.cache.match(W.src)];case 6:return rn=Kr.sent(),this.renderReplacedElement(W,le,rn),[3,8];case 7:return Kr.sent(),this.context.logger.error("Error loading image "+W.src),[3,8];case 8:if(W instanceof Rn&&this.renderReplacedElement(W,le,W.canvas),!(W instanceof Uf))return[3,12];Kr.label=9;case 9:return Kr.trys.push([9,11,,12]),[4,this.context.cache.match(W.svg)];case 10:return rn=Kr.sent(),this.renderReplacedElement(W,le,rn),[3,12];case 11:return Kr.sent(),this.context.logger.error("Error loading svg "+W.svg.substring(0,255)),[3,12];case 12:return W instanceof Cd&&W.tree?(Ht=new O(this.context,{scale:this.options.scale,backgroundColor:W.backgroundColor,x:0,y:0,width:W.width,height:W.height}),[4,Ht.render(W.tree)]):[3,14];case 13:si=Kr.sent(),W.width&&W.height&&this.ctx.drawImage(si,0,0,W.width,W.height,W.bounds.left,W.bounds.top,W.bounds.width,W.bounds.height),Kr.label=14;case 14:if(W instanceof wd&&(gi=Math.min(W.bounds.width,W.bounds.height),W.type===Th?W.checked&&(this.ctx.save(),this.path([new M(W.bounds.left+gi*.39363,W.bounds.top+gi*.79),new M(W.bounds.left+gi*.16,W.bounds.top+gi*.5549),new M(W.bounds.left+gi*.27347,W.bounds.top+gi*.44071),new M(W.bounds.left+gi*.39694,W.bounds.top+gi*.5649),new M(W.bounds.left+gi*.72983,W.bounds.top+gi*.23),new M(W.bounds.left+gi*.84,W.bounds.top+gi*.34085),new M(W.bounds.left+gi*.39363,W.bounds.top+gi*.79)]),this.ctx.fillStyle=_o(Ih),this.ctx.fill(),this.ctx.restore()):W.type===xA&&W.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(W.bounds.left+gi/2,W.bounds.top+gi/2,gi/4,0,Math.PI*2,!0),this.ctx.fillStyle=_o(Ih),this.ctx.fill(),this.ctx.restore())),uo(W)&&W.value.length){switch(Ui=this.createFontStyle(we),ts=Ui[0],Gr=Ui[1],vr=this.fontMetrics.getMetrics(ts,Gr).baseline,this.ctx.font=ts,this.ctx.fillStyle=_o(we.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ln(W.styles.textAlign),Dn=Li(W),Rr=0,W.styles.textAlign){case 1:Rr+=Dn.width/2;break;case 2:Rr+=Dn.width;break}Kn=Dn.add(Rr,0,0,-Dn.height/2+1),this.ctx.save(),this.path([new M(Dn.left,Dn.top),new M(Dn.left+Dn.width,Dn.top),new M(Dn.left+Dn.width,Dn.top+Dn.height),new M(Dn.left,Dn.top+Dn.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Kh(W.value,Kn),we.letterSpacing,vr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Hi(W.styles.display,2048))return[3,20];if(W.styles.listStyleImage===null)return[3,19];if(An=W.styles.listStyleImage,An.type!==0)return[3,18];rn=void 0,Xs=An.url,Kr.label=15;case 15:return Kr.trys.push([15,17,,18]),[4,this.context.cache.match(Xs)];case 16:return rn=Kr.sent(),this.ctx.drawImage(rn,W.bounds.left-(rn.width+10),W.bounds.top),[3,18];case 17:return Kr.sent(),this.context.logger.error("Error loading list-style-image "+Xs),[3,18];case 18:return[3,20];case 19:X.listValue&&W.styles.listStyleType!==-1&&(ts=this.createFontStyle(we)[0],this.ctx.font=ts,this.ctx.fillStyle=_o(we.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Dn=new y(W.bounds.left,W.bounds.top+Jn(W.styles.paddingTop,W.bounds.width),W.bounds.width,Xc(we.lineHeight,we.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Kh(X.listValue,Dn),we.letterSpacing,Xc(we.lineHeight,we.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Kr.label=20;case 20:return[2]}})})},O.prototype.renderStackContent=function(X){return d(this,void 0,void 0,function(){var W,le,An,we,Re,An,ft,At,An,Ht,si,An,gi,Ui,An,Gr,vr,An,Rr,Kn,An;return A(this,function(rn){switch(rn.label){case 0:if(Hi(X.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(X.element)];case 1:rn.sent(),W=0,le=X.negativeZIndex,rn.label=2;case 2:return W<le.length?(An=le[W],[4,this.renderStack(An)]):[3,5];case 3:rn.sent(),rn.label=4;case 4:return W++,[3,2];case 5:return[4,this.renderNodeContent(X.element)];case 6:rn.sent(),we=0,Re=X.nonInlineLevel,rn.label=7;case 7:return we<Re.length?(An=Re[we],[4,this.renderNode(An)]):[3,10];case 8:rn.sent(),rn.label=9;case 9:return we++,[3,7];case 10:ft=0,At=X.nonPositionedFloats,rn.label=11;case 11:return ft<At.length?(An=At[ft],[4,this.renderStack(An)]):[3,14];case 12:rn.sent(),rn.label=13;case 13:return ft++,[3,11];case 14:Ht=0,si=X.nonPositionedInlineLevel,rn.label=15;case 15:return Ht<si.length?(An=si[Ht],[4,this.renderStack(An)]):[3,18];case 16:rn.sent(),rn.label=17;case 17:return Ht++,[3,15];case 18:gi=0,Ui=X.inlineLevel,rn.label=19;case 19:return gi<Ui.length?(An=Ui[gi],[4,this.renderNode(An)]):[3,22];case 20:rn.sent(),rn.label=21;case 21:return gi++,[3,19];case 22:Gr=0,vr=X.zeroOrAutoZIndexOrTransformedOrOpacity,rn.label=23;case 23:return Gr<vr.length?(An=vr[Gr],[4,this.renderStack(An)]):[3,26];case 24:rn.sent(),rn.label=25;case 25:return Gr++,[3,23];case 26:Rr=0,Kn=X.positiveZIndex,rn.label=27;case 27:return Rr<Kn.length?(An=Kn[Rr],[4,this.renderStack(An)]):[3,30];case 28:rn.sent(),rn.label=29;case 29:return Rr++,[3,27];case 30:return[2]}})})},O.prototype.mask=function(X){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(X.slice(0).reverse()),this.ctx.closePath()},O.prototype.path=function(X){this.ctx.beginPath(),this.formatPath(X),this.ctx.closePath()},O.prototype.formatPath=function(X){var W=this;X.forEach(function(le,we){var Re=J(le)?le.start:le;we===0?W.ctx.moveTo(Re.x,Re.y):W.ctx.lineTo(Re.x,Re.y),J(le)&&W.ctx.bezierCurveTo(le.startControl.x,le.startControl.y,le.endControl.x,le.endControl.y,le.end.x,le.end.y)})},O.prototype.renderRepeat=function(X,W,le,we){this.path(X),this.ctx.fillStyle=W,this.ctx.translate(le,we),this.ctx.fill(),this.ctx.translate(-le,-we)},O.prototype.resizeImage=function(X,W,le){var we;if(X.width===W&&X.height===le)return X;var Re=(we=this.canvas.ownerDocument)!==null&&we!==void 0?we:document,ft=Re.createElement("canvas");ft.width=Math.max(1,W),ft.height=Math.max(1,le);var At=ft.getContext("2d");return At.drawImage(X,0,0,X.width,X.height,0,0,W,le),ft},O.prototype.renderBackgroundImage=function(X){return d(this,void 0,void 0,function(){var W,le,we,Re,ft,At;return A(this,function(Ht){switch(Ht.label){case 0:W=X.styles.backgroundImage.length-1,le=function(si){var gi,Ui,Gr,Fo,Ic,Fc,po,Tl,bs,vr,Fo,Ic,Fc,po,Tl,Rr,Kn,An,rn,Xs,ts,Dn,Kr,rs,bs,Ln,Fo,uc,El,po,Tl,Pd,Ic,Fc,FA,hc,kd,ya,Ju,Rd,df,eh;return A(this,function(qf){switch(qf.label){case 0:if(si.type!==0)return[3,5];gi=void 0,Ui=si.url,qf.label=1;case 1:return qf.trys.push([1,3,,4]),[4,we.context.cache.match(Ui)];case 2:return gi=qf.sent(),[3,4];case 3:return qf.sent(),we.context.logger.error("Error loading background-image "+Ui),[3,4];case 4:return gi&&(Gr=ir(X,W,[gi.width,gi.height,gi.width/gi.height]),Fo=Gr[0],Ic=Gr[1],Fc=Gr[2],po=Gr[3],Tl=Gr[4],bs=we.ctx.createPattern(we.resizeImage(gi,po,Tl),"repeat"),we.renderRepeat(Fo,bs,Ic,Fc)),[3,6];case 5:jl(si)?(vr=ir(X,W,[null,null,null]),Fo=vr[0],Ic=vr[1],Fc=vr[2],po=vr[3],Tl=vr[4],Rr=vu(si.angle,po,Tl),Kn=Rr[0],An=Rr[1],rn=Rr[2],Xs=Rr[3],ts=Rr[4],Dn=document.createElement("canvas"),Dn.width=po,Dn.height=Tl,Kr=Dn.getContext("2d"),rs=Kr.createLinearGradient(An,Xs,rn,ts),Fa(si.stops,Kn).forEach(function($f){return rs.addColorStop($f.stop,_o($f.color))}),Kr.fillStyle=rs,Kr.fillRect(0,0,po,Tl),po>0&&Tl>0&&(bs=we.ctx.createPattern(Dn,"repeat"),we.renderRepeat(Fo,bs,Ic,Fc))):bu(si)&&(Ln=ir(X,W,[null,null,null]),Fo=Ln[0],uc=Ln[1],El=Ln[2],po=Ln[3],Tl=Ln[4],Pd=si.position.length===0?[ic]:si.position,Ic=Jn(Pd[0],po),Fc=Jn(Pd[Pd.length-1],Tl),FA=jo(si,Ic,Fc,po,Tl),hc=FA[0],kd=FA[1],hc>0&&kd>0&&(ya=we.ctx.createRadialGradient(uc+Ic,El+Fc,0,uc+Ic,El+Fc,hc),Fa(si.stops,hc*2).forEach(function($f){return ya.addColorStop($f.stop,_o($f.color))}),we.path(Fo),we.ctx.fillStyle=ya,hc!==kd?(Ju=X.bounds.left+.5*X.bounds.width,Rd=X.bounds.top+.5*X.bounds.height,df=kd/hc,eh=1/df,we.ctx.save(),we.ctx.translate(Ju,Rd),we.ctx.transform(1,0,0,df,0,0),we.ctx.translate(-Ju,-Rd),we.ctx.fillRect(uc,eh*(El-Rd)+Rd,po,Tl*eh),we.ctx.restore()):we.ctx.fill())),qf.label=6;case 6:return W--,[2]}})},we=this,Re=0,ft=X.styles.backgroundImage.slice(0).reverse(),Ht.label=1;case 1:return Re<ft.length?(At=ft[Re],[5,le(At)]):[3,4];case 2:Ht.sent(),Ht.label=3;case 3:return Re++,[3,1];case 4:return[2]}})})},O.prototype.renderSolidBorder=function(X,W,le){return d(this,void 0,void 0,function(){return A(this,function(we){return this.path(vi(le,W)),this.ctx.fillStyle=_o(X),this.ctx.fill(),[2]})})},O.prototype.renderDoubleBorder=function(X,W,le,we){return d(this,void 0,void 0,function(){var Re,ft;return A(this,function(At){switch(At.label){case 0:return W<3?[4,this.renderSolidBorder(X,le,we)]:[3,2];case 1:return At.sent(),[2];case 2:return Re=Mt(we,le),this.path(Re),this.ctx.fillStyle=_o(X),this.ctx.fill(),ft=Vt(we,le),this.path(ft),this.ctx.fill(),[2]}})})},O.prototype.renderNodeBackgroundAndBorders=function(X){return d(this,void 0,void 0,function(){var W,le,we,Re,ft,At,Ht,si,gi=this;return A(this,function(Ui){switch(Ui.label){case 0:return this.applyEffects(X.getEffects(2)),W=X.container.styles,le=!Ia(W.backgroundColor)||W.backgroundImage.length,we=[{style:W.borderTopStyle,color:W.borderTopColor,width:W.borderTopWidth},{style:W.borderRightStyle,color:W.borderRightColor,width:W.borderRightWidth},{style:W.borderBottomStyle,color:W.borderBottomColor,width:W.borderBottomWidth},{style:W.borderLeftStyle,color:W.borderLeftColor,width:W.borderLeftWidth}],Re=Jr(gr(W.backgroundClip,0),X.curves),le||W.boxShadow.length?(this.ctx.save(),this.path(Re),this.ctx.clip(),Ia(W.backgroundColor)||(this.ctx.fillStyle=_o(W.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(X.container)]):[3,2];case 1:Ui.sent(),this.ctx.restore(),W.boxShadow.slice(0).reverse().forEach(function(Gr){gi.ctx.save();var vr=ue(X.curves),Rr=Gr.inset?0:es,Kn=lt(vr,-Rr+(Gr.inset?1:-1)*Gr.spread.number,(Gr.inset?1:-1)*Gr.spread.number,Gr.spread.number*(Gr.inset?-2:2),Gr.spread.number*(Gr.inset?-2:2));Gr.inset?(gi.path(vr),gi.ctx.clip(),gi.mask(Kn)):(gi.mask(vr),gi.ctx.clip(),gi.path(Kn)),gi.ctx.shadowOffsetX=Gr.offsetX.number+Rr,gi.ctx.shadowOffsetY=Gr.offsetY.number,gi.ctx.shadowColor=_o(Gr.color),gi.ctx.shadowBlur=Gr.blur.number,gi.ctx.fillStyle=Gr.inset?_o(Gr.color):"rgba(0,0,0,1)",gi.ctx.fill(),gi.ctx.restore()}),Ui.label=2;case 2:ft=0,At=0,Ht=we,Ui.label=3;case 3:return At<Ht.length?(si=Ht[At],si.style!==0&&!Ia(si.color)&&si.width>0?si.style!==2?[3,5]:[4,this.renderDashedDottedBorder(si.color,si.width,ft,X.curves,2)]:[3,11]):[3,13];case 4:return Ui.sent(),[3,11];case 5:return si.style!==3?[3,7]:[4,this.renderDashedDottedBorder(si.color,si.width,ft,X.curves,3)];case 6:return Ui.sent(),[3,11];case 7:return si.style!==4?[3,9]:[4,this.renderDoubleBorder(si.color,si.width,ft,X.curves)];case 8:return Ui.sent(),[3,11];case 9:return[4,this.renderSolidBorder(si.color,ft,X.curves)];case 10:Ui.sent(),Ui.label=11;case 11:ft++,Ui.label=12;case 12:return At++,[3,3];case 13:return[2]}})})},O.prototype.renderDashedDottedBorder=function(X,W,le,we,Re){return d(this,void 0,void 0,function(){var ft,At,Ht,si,gi,Ui,Gr,vr,Rr,Kn,An,rn,Xs,ts,Dn,Kr,Dn,Kr;return A(this,function(rs){return this.ctx.save(),ft=wt(we,le),At=vi(we,le),Re===2&&(this.path(At),this.ctx.clip()),J(At[0])?(Ht=At[0].start.x,si=At[0].start.y):(Ht=At[0].x,si=At[0].y),J(At[1])?(gi=At[1].end.x,Ui=At[1].end.y):(gi=At[1].x,Ui=At[1].y),le===0||le===2?Gr=Math.abs(Ht-gi):Gr=Math.abs(si-Ui),this.ctx.beginPath(),Re===3?this.formatPath(ft):this.formatPath(At.slice(0,2)),vr=W<3?W*3:W*2,Rr=W<3?W*2:W,Re===3&&(vr=W,Rr=W),Kn=!0,Gr<=vr*2?Kn=!1:Gr<=vr*2+Rr?(An=Gr/(2*vr+Rr),vr*=An,Rr*=An):(rn=Math.floor((Gr+Rr)/(vr+Rr)),Xs=(Gr-rn*vr)/(rn-1),ts=(Gr-(rn+1)*vr)/rn,Rr=ts<=0||Math.abs(Rr-Xs)<Math.abs(Rr-ts)?Xs:ts),Kn&&(Re===3?this.ctx.setLineDash([0,vr+Rr]):this.ctx.setLineDash([vr,Rr])),Re===3?(this.ctx.lineCap="round",this.ctx.lineWidth=W):this.ctx.lineWidth=W*2+1.1,this.ctx.strokeStyle=_o(X),this.ctx.stroke(),this.ctx.setLineDash([]),Re===2&&(J(At[0])&&(Dn=At[3],Kr=At[0],this.ctx.beginPath(),this.formatPath([new M(Dn.end.x,Dn.end.y),new M(Kr.start.x,Kr.start.y)]),this.ctx.stroke()),J(At[1])&&(Dn=At[1],Kr=At[2],this.ctx.beginPath(),this.formatPath([new M(Dn.end.x,Dn.end.y),new M(Kr.start.x,Kr.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},O.prototype.render=function(X){return d(this,void 0,void 0,function(){var W;return A(this,function(le){switch(le.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=_o(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),W=ri(X),[4,this.renderStack(W)];case 1:return le.sent(),this.applyEffects([]),[2,this.canvas]}})})},O}(xs),uo=function(N){return N instanceof Bd||N instanceof rf?!0:N instanceof wd&&N.type!==xA&&N.type!==Th},Jr=function(N,O){switch(N){case 0:return ue(O);case 2:return ge(O);case 1:default:return _e(O)}},ln=function(N){switch(N){case 1:return"center";case 2:return"right";case 0:default:return"left"}},yn=["-apple-system","system-ui"],Ps=function(N){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?N.filter(function(O){return yn.indexOf(O)===-1}):N},Qo=function(N){s(O,N);function O(X,W){var le=N.call(this,X,W)||this;return le.canvas=W.canvas?W.canvas:document.createElement("canvas"),le.ctx=le.canvas.getContext("2d"),le.options=W,le.canvas.width=Math.floor(W.width*W.scale),le.canvas.height=Math.floor(W.height*W.scale),le.canvas.style.width=W.width+"px",le.canvas.style.height=W.height+"px",le.ctx.scale(le.options.scale,le.options.scale),le.ctx.translate(-W.x,-W.y),le.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+W.width+"x"+W.height+" at "+W.x+","+W.y+") with scale "+W.scale),le}return O.prototype.render=function(X){return d(this,void 0,void 0,function(){var W,le;return A(this,function(we){switch(we.label){case 0:return W=Su(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,X),[4,Es(W)];case 1:return le=we.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=_o(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(le,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},O}(xs),Es=function(N){return new Promise(function(O,X){var W=new Image;W.onload=function(){O(W)},W.onerror=X,W.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(N))})},Hn=function(){function N(O){var X=O.id,W=O.enabled;this.id=X,this.enabled=W,this.start=Date.now()}return N.prototype.debug=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.prototype.getTime=function(){return Date.now()-this.start},N.prototype.info=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,r([this.id,this.getTime()+"ms"],O))},N.prototype.warn=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.prototype.error=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.instances={},N}(),to=function(){function N(O,X){var W;this.windowBounds=X,this.instanceName="#"+N.instanceCount++,this.logger=new Hn({id:this.instanceName,enabled:O.logging}),this.cache=(W=O.cache)!==null&&W!==void 0?W:new IA(this,O)}return N.instanceCount=1,N}(),Fn=function(N,O){return O===void 0&&(O={}),Io(N,O)};typeof window<"u"&&Tc.setContext(window);var Io=function(N,O){return d(void 0,void 0,void 0,function(){var X,W,le,we,Re,ft,At,Ht,si,gi,Ui,Gr,vr,Rr,Kn,An,rn,Xs,ts,Dn,rs,Kr,rs,bs,Ln,Fo,uc,El,po,Tl,Pd,Ic,Fc,FA,hc,kd,ya,Ju,Rd,df;return A(this,function(eh){switch(eh.label){case 0:if(!N||typeof N!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(X=N.ownerDocument,!X)throw new Error("Element is not attached to a Document");if(W=X.defaultView,!W)throw new Error("Document is not attached to a Window");return le={allowTaint:(bs=O.allowTaint)!==null&&bs!==void 0?bs:!1,imageTimeout:(Ln=O.imageTimeout)!==null&&Ln!==void 0?Ln:15e3,proxy:O.proxy,useCORS:(Fo=O.useCORS)!==null&&Fo!==void 0?Fo:!1},we=c({logging:(uc=O.logging)!==null&&uc!==void 0?uc:!0,cache:O.cache},le),Re={windowWidth:(El=O.windowWidth)!==null&&El!==void 0?El:W.innerWidth,windowHeight:(po=O.windowHeight)!==null&&po!==void 0?po:W.innerHeight,scrollX:(Tl=O.scrollX)!==null&&Tl!==void 0?Tl:W.pageXOffset,scrollY:(Pd=O.scrollY)!==null&&Pd!==void 0?Pd:W.pageYOffset},ft=new y(Re.scrollX,Re.scrollY,Re.windowWidth,Re.windowHeight),At=new to(we,ft),Ht=(Ic=O.foreignObjectRendering)!==null&&Ic!==void 0?Ic:!1,si={allowTaint:(Fc=O.allowTaint)!==null&&Fc!==void 0?Fc:!1,onclone:O.onclone,ignoreElements:O.ignoreElements,inlineImages:Ht,copyStyles:Ht},At.logger.debug("Starting document clone with size "+ft.width+"x"+ft.height+" scrolled to "+-ft.left+","+-ft.top),gi=new EA(At,N,si),Ui=gi.clonedReferenceElement,Ui?[4,gi.toIFrame(X,ft)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Gr=eh.sent(),vr=Mh(Ui)||Lp(Ui)?x(Ui.ownerDocument):b(At,Ui),Rr=vr.width,Kn=vr.height,An=vr.left,rn=vr.top,Xs=ks(At,Ui,O.backgroundColor),ts={canvas:O.canvas,backgroundColor:Xs,scale:(hc=(FA=O.scale)!==null&&FA!==void 0?FA:W.devicePixelRatio)!==null&&hc!==void 0?hc:1,x:((kd=O.x)!==null&&kd!==void 0?kd:0)+An,y:((ya=O.y)!==null&&ya!==void 0?ya:0)+rn,width:(Ju=O.width)!==null&&Ju!==void 0?Ju:Math.ceil(Rr),height:(Rd=O.height)!==null&&Rd!==void 0?Rd:Math.ceil(Kn)},Ht?(At.logger.debug("Document cloned, using foreign object rendering"),rs=new Qo(At,ts),[4,rs.render(Ui)]):[3,3];case 2:return Dn=eh.sent(),[3,5];case 3:return At.logger.debug("Document cloned, element located at "+An+","+rn+" with size "+Rr+"x"+Kn+" using computed rendering"),At.logger.debug("Starting DOM parsing"),Kr=Nf(At,Ui),Xs===Kr.styles.backgroundColor&&(Kr.styles.backgroundColor=bl.TRANSPARENT),At.logger.debug("Starting renderer for element at "+ts.x+","+ts.y+" with size "+ts.width+"x"+ts.height),rs=new is(At,ts),[4,rs.render(Kr)];case 4:Dn=eh.sent(),eh.label=5;case 5:return(!((df=O.removeContainer)!==null&&df!==void 0)||df)&&(EA.destroy(Gr)||At.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),At.logger.debug("Finished rendering"),[2,Dn]}})})},ks=function(N,O,X){var W=O.ownerDocument,le=W.documentElement?Ol(N,getComputedStyle(W.documentElement).backgroundColor):bl.TRANSPARENT,we=W.body?Ol(N,getComputedStyle(W.body).backgroundColor):bl.TRANSPARENT,Re=typeof X=="string"?Ol(N,X):X===null?bl.TRANSPARENT:4294967295;return O===W.documentElement?Ia(le)?Ia(we)?Re:we:le:Re};return Fn})}(mv)),mv.exports}/*!
 * html2pdf.js v0.10.3
 * Copyright (c) 2025 Erik Koopmans
 * Released under the MIT License.
 */var PE;function FU(){return PE||(PE=1,function(a,e){(function(s,c){a.exports=c(EU,IU())})(self,function(i,s){return function(){var c={"./src/plugin/hyperlinks.js":function(y,b,x){x.r(b),x("./node_modules/core-js/modules/web.dom-collections.for-each.js"),x("./node_modules/core-js/modules/es.string.link.js");var B=x("./src/worker.js"),T=x("./src/utils.js"),E=[],R={toContainer:B.default.prototype.toContainer,toPdf:B.default.prototype.toPdf};B.default.prototype.toContainer=function(){return R.toContainer.call(this).then(function(){if(this.opt.enableLinks){var U=this.prop.container,Q=U.querySelectorAll("a"),q=(0,T.unitConvert)(U.getBoundingClientRect(),this.prop.pageSize.k);E=[],Array.prototype.forEach.call(Q,function(ne){for(var re=ne.getClientRects(),pe=0;pe<re.length;pe++){var fe=(0,T.unitConvert)(re[pe],this.prop.pageSize.k);fe.left-=q.left,fe.top-=q.top;var he=Math.floor(fe.top/this.prop.pageSize.inner.height)+1,be=this.opt.margin[0]+fe.top%this.prop.pageSize.inner.height,Se=this.opt.margin[1]+fe.left;E.push({page:he,top:be,left:Se,clientRect:fe,link:ne})}},this)}})},B.default.prototype.toPdf=function(){return R.toPdf.call(this).then(function(){if(this.opt.enableLinks){E.forEach(function(Q){this.prop.pdf.setPage(Q.page),this.prop.pdf.link(Q.left,Q.top,Q.clientRect.width,Q.clientRect.height,{url:Q.link.href})},this);var U=this.prop.pdf.internal.getNumberOfPages();this.prop.pdf.setPage(U)}})}},"./src/plugin/jspdf-plugin.js":function(y,b,x){x.r(b),x("./node_modules/core-js/modules/es.symbol.js"),x("./node_modules/core-js/modules/es.symbol.description.js"),x("./node_modules/core-js/modules/es.object.to-string.js"),x("./node_modules/core-js/modules/es.symbol.iterator.js"),x("./node_modules/core-js/modules/es.array.iterator.js"),x("./node_modules/core-js/modules/es.string.iterator.js"),x("./node_modules/core-js/modules/web.dom-collections.iterator.js");var B=x("jspdf");function T(E){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(P){return typeof P}:T=function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},T(E)}B.jsPDF.getPageSize=function(E,R,P){if(T(E)==="object"){var G=E;E=G.orientation,R=G.unit||R,P=G.format||P}R=R||"mm",P=P||"a4",E=(""+(E||"P")).toLowerCase();var U=(""+P).toLowerCase(),Q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(R){case"pt":var q=1;break;case"mm":var q=72/25.4;break;case"cm":var q=72/2.54;break;case"in":var q=72;break;case"px":var q=72/96;break;case"pc":var q=12;break;case"em":var q=12;break;case"ex":var q=6;break;default:throw"Invalid unit: "+R}if(Q.hasOwnProperty(U))var ne=Q[U][1]/q,re=Q[U][0]/q;else try{var ne=P[1],re=P[0]}catch{throw new Error("Invalid format: "+P)}if(E==="p"||E==="portrait"){if(E="p",re>ne){var pe=re;re=ne,ne=pe}}else if(E==="l"||E==="landscape"){if(E="l",ne>re){var pe=re;re=ne,ne=pe}}else throw"Invalid orientation: "+E;var fe={width:re,height:ne,unit:R,k:q};return fe},b.default=B.jsPDF},"./src/plugin/pagebreaks.js":function(y,b,x){x.r(b),x("./node_modules/core-js/modules/es.array.concat.js"),x("./node_modules/core-js/modules/es.array.slice.js"),x("./node_modules/core-js/modules/es.array.join.js"),x("./node_modules/core-js/modules/web.dom-collections.for-each.js"),x("./node_modules/core-js/modules/es.object.keys.js");var B=x("./src/worker.js"),T=x("./src/utils.js"),E={toContainer:B.default.prototype.toContainer};B.default.template.opt.pagebreak={mode:["css","legacy"],before:[],after:[],avoid:[]},B.default.prototype.toContainer=function(){return E.toContainer.call(this).then(function(){var G=this.prop.container,U=this.prop.pageSize.inner.px.height,Q=[].concat(this.opt.pagebreak.mode),q={avoidAll:Q.indexOf("avoid-all")!==-1,css:Q.indexOf("css")!==-1,legacy:Q.indexOf("legacy")!==-1},ne={},re=this;["before","after","avoid"].forEach(function(he){var be=q.avoidAll&&he==="avoid";ne[he]=be?[]:[].concat(re.opt.pagebreak[he]||[]),ne[he].length>0&&(ne[he]=Array.prototype.slice.call(G.querySelectorAll(ne[he].join(", "))))});var pe=G.querySelectorAll(".html2pdf__page-break");pe=Array.prototype.slice.call(pe);var fe=G.querySelectorAll("*");Array.prototype.forEach.call(fe,function(be){var Se={before:!1,after:q.legacy&&pe.indexOf(be)!==-1,avoid:q.avoidAll};if(q.css){var oe=window.getComputedStyle(be),ye=["always","page","left","right"],Me=["avoid","avoid-page"];Se={before:Se.before||ye.indexOf(oe.breakBefore||oe.pageBreakBefore)!==-1,after:Se.after||ye.indexOf(oe.breakAfter||oe.pageBreakAfter)!==-1,avoid:Se.avoid||Me.indexOf(oe.breakInside||oe.pageBreakInside)!==-1}}Object.keys(Se).forEach(function(bt){Se[bt]=Se[bt]||ne[bt].indexOf(be)!==-1});var Be=be.getBoundingClientRect();if(Se.avoid&&!Se.before){var Pe=Math.floor(Be.top/U),De=Math.floor(Be.bottom/U),et=Math.abs(Be.bottom-Be.top)/U;De!==Pe&&et<=1&&(Se.before=!0)}if(Se.before){var Ye=(0,T.createElement)("div",{style:{display:"block",height:U-Be.top%U+"px"}});be.parentNode.insertBefore(Ye,be)}if(Se.after){var Ye=(0,T.createElement)("div",{style:{display:"block",height:U-Be.bottom%U+"px"}});be.parentNode.insertBefore(Ye,be.nextSibling)}})})}},"./src/utils.js":function(y,b,x){x.r(b),x.d(b,{objType:function(){return T},createElement:function(){return E},cloneNode:function(){return R},unitConvert:function(){return P},toPx:function(){return G}}),x("./node_modules/core-js/modules/es.number.constructor.js"),x("./node_modules/core-js/modules/es.symbol.js"),x("./node_modules/core-js/modules/es.symbol.description.js"),x("./node_modules/core-js/modules/es.object.to-string.js"),x("./node_modules/core-js/modules/es.symbol.iterator.js"),x("./node_modules/core-js/modules/es.array.iterator.js"),x("./node_modules/core-js/modules/es.string.iterator.js"),x("./node_modules/core-js/modules/web.dom-collections.iterator.js");function B(U){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(q){return typeof q}:B=function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},B(U)}var T=function(Q){var q=B(Q);return q==="undefined"?"undefined":q==="string"||Q instanceof String?"string":q==="number"||Q instanceof Number?"number":q==="function"||Q instanceof Function?"function":Q&&Q.constructor===Array?"array":Q&&Q.nodeType===1?"element":q==="object"?"object":"unknown"},E=function(Q,q){var ne=document.createElement(Q);if(q.className&&(ne.className=q.className),q.innerHTML){ne.innerHTML=q.innerHTML;for(var re=ne.getElementsByTagName("script"),pe=re.length;pe-- >0;null)re[pe].parentNode.removeChild(re[pe])}for(var fe in q.style)ne.style[fe]=q.style[fe];return ne},R=function U(Q,q){for(var ne=Q.nodeType===3?document.createTextNode(Q.nodeValue):Q.cloneNode(!1),re=Q.firstChild;re;re=re.nextSibling)(q===!0||re.nodeType!==1||re.nodeName!=="SCRIPT")&&ne.appendChild(U(re,q));return Q.nodeType===1&&(Q.nodeName==="CANVAS"?(ne.width=Q.width,ne.height=Q.height,ne.getContext("2d").drawImage(Q,0,0)):(Q.nodeName==="TEXTAREA"||Q.nodeName==="SELECT")&&(ne.value=Q.value),ne.addEventListener("load",function(){ne.scrollTop=Q.scrollTop,ne.scrollLeft=Q.scrollLeft},!0)),ne},P=function(Q,q){if(T(Q)==="number")return Q*72/96/q;var ne={};for(var re in Q)ne[re]=Q[re]*72/96/q;return ne},G=function(Q,q){return Math.floor(Q*q/72*96)}},"./src/worker.js":function(y,b,x){x.r(b),x("./node_modules/core-js/modules/es.object.assign.js"),x("./node_modules/core-js/modules/es.array.map.js"),x("./node_modules/core-js/modules/es.object.keys.js"),x("./node_modules/core-js/modules/es.array.concat.js"),x("./node_modules/core-js/modules/es.object.to-string.js"),x("./node_modules/core-js/modules/es.regexp.to-string.js"),x("./node_modules/core-js/modules/es.function.name.js"),x("./node_modules/core-js/modules/web.dom-collections.for-each.js");var B=x("jspdf"),T=x("html2canvas"),E=x("./src/utils.js"),R=x("./node_modules/es6-promise/dist/es6-promise.js"),P=x.n(R),G=P().Promise,U=function Q(q){var ne=Object.assign(Q.convert(G.resolve()),JSON.parse(JSON.stringify(Q.template))),re=Q.convert(G.resolve(),ne);return re=re.setProgress(1,Q,1,[Q]),re=re.set(q),re};U.prototype=Object.create(G.prototype),U.prototype.constructor=U,U.convert=function(q,ne){return q.__proto__=ne||U.prototype,q},U.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],image:{type:"jpeg",quality:.95},enableLinks:!0,html2canvas:{},jsPDF:{}}},U.prototype.from=function(q,ne){function re(pe){switch((0,E.objType)(pe)){case"string":return"string";case"element":return pe.nodeName.toLowerCase&&pe.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}return this.then(function(){switch(ne=ne||re(q),ne){case"string":return this.set({src:(0,E.createElement)("div",{innerHTML:q})});case"element":return this.set({src:q});case"canvas":return this.set({canvas:q});case"img":return this.set({img:q});default:return this.error("Unknown source type.")}})},U.prototype.to=function(q){switch(q){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},U.prototype.toContainer=function(){var q=[function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(q).then(function(){var re={position:"fixed",overflow:"hidden",zIndex:1e3,left:0,right:0,bottom:0,top:0,backgroundColor:"rgba(0,0,0,0.8)"},pe={position:"absolute",width:this.prop.pageSize.inner.width+this.prop.pageSize.unit,left:0,right:0,top:0,height:"auto",margin:"auto",backgroundColor:"white"};re.opacity=0;var fe=(0,E.cloneNode)(this.prop.src,this.opt.html2canvas.javascriptEnabled);this.prop.overlay=(0,E.createElement)("div",{className:"html2pdf__overlay",style:re}),this.prop.container=(0,E.createElement)("div",{className:"html2pdf__container",style:pe}),this.prop.container.appendChild(fe),this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay)})},U.prototype.toCanvas=function(){var q=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(q).then(function(){var re=Object.assign({},this.opt.html2canvas);return delete re.onrendered,T(this.prop.container,re)}).then(function(re){var pe=this.opt.html2canvas.onrendered||function(){};pe(re),this.prop.canvas=re,document.body.removeChild(this.prop.overlay)})},U.prototype.toImg=function(){var q=[function(){return this.prop.canvas||this.toCanvas()}];return this.thenList(q).then(function(){var re=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=re})},U.prototype.toPdf=function(){var q=[function(){return this.prop.canvas||this.toCanvas()},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(q).then(function(){var re=this.prop.canvas,pe=this.opt,fe=re.height,he=Math.floor(re.width*this.prop.pageSize.inner.ratio),be=Math.ceil(fe/he),Se=this.prop.pageSize.inner.height,oe=document.createElement("canvas"),ye=oe.getContext("2d");oe.width=re.width,oe.height=he,this.prop.pdf=this.prop.pdf||new B.jsPDF(pe.jsPDF);for(var Me=0;Me<be;Me++){Me===be-1&&fe%he!==0&&(oe.height=fe%he,Se=oe.height*this.prop.pageSize.inner.width/oe.width);var Be=oe.width,Pe=oe.height;ye.fillStyle="white",ye.fillRect(0,0,Be,Pe),ye.drawImage(re,0,Me*he,Be,Pe,0,0,Be,Pe),Me&&this.prop.pdf.addPage();var De=oe.toDataURL("image/"+pe.image.type,pe.image.quality);this.prop.pdf.addImage(De,pe.image.type,pe.margin[1],pe.margin[0],this.prop.pageSize.inner.width,Se)}})},U.prototype.output=function(q,ne,re){return re=re||"pdf",re.toLowerCase()==="img"||re.toLowerCase()==="image"?this.outputImg(q,ne):this.outputPdf(q,ne)},U.prototype.outputPdf=function(q,ne){var re=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(re).then(function(){return this.prop.pdf.output(q,ne)})},U.prototype.outputImg=function(q,ne){var re=[function(){return this.prop.img||this.toImg()}];return this.thenList(re).then(function(){switch(q){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+q+'" is not supported.'}})},U.prototype.save=function(q){var ne=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(ne).set(q?{filename:q}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},U.prototype.set=function(q){if((0,E.objType)(q)!=="object")return this;var ne=Object.keys(q||{}).map(function(re){switch(re){case"margin":return this.setMargin.bind(this,q.margin);case"jsPDF":return function(){return this.opt.jsPDF=q.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,q.pageSize);default:return re in U.template.prop?function(){this.prop[re]=q[re]}:function(){this.opt[re]=q[re]}}},this);return this.then(function(){return this.thenList(ne)})},U.prototype.get=function(q,ne){return this.then(function(){var pe=q in U.template.prop?this.prop[q]:this.opt[q];return ne?ne(pe):pe})},U.prototype.setMargin=function(q){return this.then(function(){switch((0,E.objType)(q)){case"number":q=[q,q,q,q];case"array":if(q.length===2&&(q=[q[0],q[1],q[0],q[1]]),q.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=q}).then(this.setPageSize)},U.prototype.setPageSize=function(q){return this.then(function(){q=q||B.jsPDF.getPageSize(this.opt.jsPDF),q.hasOwnProperty("inner")||(q.inner={width:q.width-this.opt.margin[1]-this.opt.margin[3],height:q.height-this.opt.margin[0]-this.opt.margin[2]},q.inner.px={width:(0,E.toPx)(q.inner.width,q.k),height:(0,E.toPx)(q.inner.height,q.k)},q.inner.ratio=q.inner.height/q.inner.width),this.prop.pageSize=q})},U.prototype.setProgress=function(q,ne,re,pe){return q!=null&&(this.progress.val=q),ne!=null&&(this.progress.state=ne),re!=null&&(this.progress.n=re),pe!=null&&(this.progress.stack=pe),this.progress.ratio=this.progress.val/this.progress.state,this},U.prototype.updateProgress=function(q,ne,re,pe){return this.setProgress(q?this.progress.val+q:null,ne||null,re?this.progress.n+re:null,pe?this.progress.stack.concat(pe):null)},U.prototype.then=function(q,ne){var re=this;return this.thenCore(q,ne,function(fe,he){return re.updateProgress(null,null,1,[fe]),G.prototype.then.call(this,function(Se){return re.updateProgress(null,fe),Se}).then(fe,he).then(function(Se){return re.updateProgress(1),Se})})},U.prototype.thenCore=function(q,ne,re){re=re||G.prototype.then;var pe=this;q&&(q=q.bind(pe)),ne&&(ne=ne.bind(pe));var fe=G.toString().indexOf("[native code]")!==-1&&G.name==="Promise",he=fe?pe:U.convert(Object.assign({},pe),G.prototype),be=re.call(he,q,ne);return U.convert(be,pe.__proto__)},U.prototype.thenExternal=function(q,ne){return G.prototype.then.call(this,q,ne)},U.prototype.thenList=function(q){var ne=this;return q.forEach(function(pe){ne=ne.thenCore(pe)}),ne},U.prototype.catch=function(Q){Q&&(Q=Q.bind(this));var q=G.prototype.catch.call(this,Q);return U.convert(q,this)},U.prototype.catchExternal=function(q){return G.prototype.catch.call(this,q)},U.prototype.error=function(q){return this.then(function(){throw new Error(q)})},U.prototype.using=U.prototype.set,U.prototype.saveAs=U.prototype.save,U.prototype.export=U.prototype.output,U.prototype.run=U.prototype.then,b.default=U},"./node_modules/core-js/internals/a-function.js":function(y){y.exports=function(b){if(typeof b!="function")throw TypeError(String(b)+" is not a function");return b}},"./node_modules/core-js/internals/a-possible-prototype.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js");y.exports=function(T){if(!B(T)&&T!==null)throw TypeError("Can't set "+String(T)+" as a prototype");return T}},"./node_modules/core-js/internals/add-to-unscopables.js":function(y,b,x){var B=x("./node_modules/core-js/internals/well-known-symbol.js"),T=x("./node_modules/core-js/internals/object-create.js"),E=x("./node_modules/core-js/internals/object-define-property.js"),R=B("unscopables"),P=Array.prototype;P[R]==null&&E.f(P,R,{configurable:!0,value:T(null)}),y.exports=function(G){P[R][G]=!0}},"./node_modules/core-js/internals/an-object.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js");y.exports=function(T){if(!B(T))throw TypeError(String(T)+" is not an object");return T}},"./node_modules/core-js/internals/array-for-each.js":function(y,b,x){var B=x("./node_modules/core-js/internals/array-iteration.js").forEach,T=x("./node_modules/core-js/internals/array-method-is-strict.js"),E=T("forEach");y.exports=E?[].forEach:function(P){return B(this,P,arguments.length>1?arguments[1]:void 0)}},"./node_modules/core-js/internals/array-includes.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-indexed-object.js"),T=x("./node_modules/core-js/internals/to-length.js"),E=x("./node_modules/core-js/internals/to-absolute-index.js"),R=function(P){return function(G,U,Q){var q=B(G),ne=T(q.length),re=E(Q,ne),pe;if(P&&U!=U){for(;ne>re;)if(pe=q[re++],pe!=pe)return!0}else for(;ne>re;re++)if((P||re in q)&&q[re]===U)return P||re||0;return!P&&-1}};y.exports={includes:R(!0),indexOf:R(!1)}},"./node_modules/core-js/internals/array-iteration.js":function(y,b,x){var B=x("./node_modules/core-js/internals/function-bind-context.js"),T=x("./node_modules/core-js/internals/indexed-object.js"),E=x("./node_modules/core-js/internals/to-object.js"),R=x("./node_modules/core-js/internals/to-length.js"),P=x("./node_modules/core-js/internals/array-species-create.js"),G=[].push,U=function(Q){var q=Q==1,ne=Q==2,re=Q==3,pe=Q==4,fe=Q==6,he=Q==7,be=Q==5||fe;return function(Se,oe,ye,Me){for(var Be=E(Se),Pe=T(Be),De=B(oe,ye,3),et=R(Pe.length),Ye=0,bt=Me||P,pt=q?bt(Se,et):ne||he?bt(Se,0):void 0,Qt,Ie;et>Ye;Ye++)if((be||Ye in Pe)&&(Qt=Pe[Ye],Ie=De(Qt,Ye,Be),Q))if(q)pt[Ye]=Ie;else if(Ie)switch(Q){case 3:return!0;case 5:return Qt;case 6:return Ye;case 2:G.call(pt,Qt)}else switch(Q){case 4:return!1;case 7:G.call(pt,Qt)}return fe?-1:re||pe?pe:pt}};y.exports={forEach:U(0),map:U(1),filter:U(2),some:U(3),every:U(4),find:U(5),findIndex:U(6),filterReject:U(7)}},"./node_modules/core-js/internals/array-method-has-species-support.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js"),T=x("./node_modules/core-js/internals/well-known-symbol.js"),E=x("./node_modules/core-js/internals/engine-v8-version.js"),R=T("species");y.exports=function(P){return E>=51||!B(function(){var G=[],U=G.constructor={};return U[R]=function(){return{foo:1}},G[P](Boolean).foo!==1})}},"./node_modules/core-js/internals/array-method-is-strict.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js");y.exports=function(T,E){var R=[][T];return!!R&&B(function(){R.call(null,E||function(){throw 1},1)})}},"./node_modules/core-js/internals/array-species-constructor.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js"),T=x("./node_modules/core-js/internals/is-array.js"),E=x("./node_modules/core-js/internals/well-known-symbol.js"),R=E("species");y.exports=function(P){var G;return T(P)&&(G=P.constructor,typeof G=="function"&&(G===Array||T(G.prototype))?G=void 0:B(G)&&(G=G[R],G===null&&(G=void 0))),G===void 0?Array:G}},"./node_modules/core-js/internals/array-species-create.js":function(y,b,x){var B=x("./node_modules/core-js/internals/array-species-constructor.js");y.exports=function(T,E){return new(B(T))(E===0?0:E)}},"./node_modules/core-js/internals/classof-raw.js":function(y){var b={}.toString;y.exports=function(x){return b.call(x).slice(8,-1)}},"./node_modules/core-js/internals/classof.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-string-tag-support.js"),T=x("./node_modules/core-js/internals/classof-raw.js"),E=x("./node_modules/core-js/internals/well-known-symbol.js"),R=E("toStringTag"),P=T(function(){return arguments}())=="Arguments",G=function(U,Q){try{return U[Q]}catch{}};y.exports=B?T:function(U){var Q,q,ne;return U===void 0?"Undefined":U===null?"Null":typeof(q=G(Q=Object(U),R))=="string"?q:P?T(Q):(ne=T(Q))=="Object"&&typeof Q.callee=="function"?"Arguments":ne}},"./node_modules/core-js/internals/copy-constructor-properties.js":function(y,b,x){var B=x("./node_modules/core-js/internals/has.js"),T=x("./node_modules/core-js/internals/own-keys.js"),E=x("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),R=x("./node_modules/core-js/internals/object-define-property.js");y.exports=function(P,G){for(var U=T(G),Q=R.f,q=E.f,ne=0;ne<U.length;ne++){var re=U[ne];B(P,re)||Q(P,re,q(G,re))}}},"./node_modules/core-js/internals/correct-prototype-getter.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js");y.exports=!B(function(){function T(){}return T.prototype.constructor=null,Object.getPrototypeOf(new T)!==T.prototype})},"./node_modules/core-js/internals/create-html.js":function(y,b,x){var B=x("./node_modules/core-js/internals/require-object-coercible.js"),T=x("./node_modules/core-js/internals/to-string.js"),E=/"/g;y.exports=function(R,P,G,U){var Q=T(B(R)),q="<"+P;return G!==""&&(q+=" "+G+'="'+T(U).replace(E,"&quot;")+'"'),q+">"+Q+"</"+P+">"}},"./node_modules/core-js/internals/create-iterator-constructor.js":function(y,b,x){var B=x("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,T=x("./node_modules/core-js/internals/object-create.js"),E=x("./node_modules/core-js/internals/create-property-descriptor.js"),R=x("./node_modules/core-js/internals/set-to-string-tag.js"),P=x("./node_modules/core-js/internals/iterators.js"),G=function(){return this};y.exports=function(U,Q,q){var ne=Q+" Iterator";return U.prototype=T(B,{next:E(1,q)}),R(U,ne,!1,!0),P[ne]=G,U}},"./node_modules/core-js/internals/create-non-enumerable-property.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/object-define-property.js"),E=x("./node_modules/core-js/internals/create-property-descriptor.js");y.exports=B?function(R,P,G){return T.f(R,P,E(1,G))}:function(R,P,G){return R[P]=G,R}},"./node_modules/core-js/internals/create-property-descriptor.js":function(y){y.exports=function(b,x){return{enumerable:!(b&1),configurable:!(b&2),writable:!(b&4),value:x}}},"./node_modules/core-js/internals/create-property.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-property-key.js"),T=x("./node_modules/core-js/internals/object-define-property.js"),E=x("./node_modules/core-js/internals/create-property-descriptor.js");y.exports=function(R,P,G){var U=B(P);U in R?T.f(R,U,E(0,G)):R[U]=G}},"./node_modules/core-js/internals/define-iterator.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/create-iterator-constructor.js"),E=x("./node_modules/core-js/internals/object-get-prototype-of.js"),R=x("./node_modules/core-js/internals/object-set-prototype-of.js"),P=x("./node_modules/core-js/internals/set-to-string-tag.js"),G=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),U=x("./node_modules/core-js/internals/redefine.js"),Q=x("./node_modules/core-js/internals/well-known-symbol.js"),q=x("./node_modules/core-js/internals/is-pure.js"),ne=x("./node_modules/core-js/internals/iterators.js"),re=x("./node_modules/core-js/internals/iterators-core.js"),pe=re.IteratorPrototype,fe=re.BUGGY_SAFARI_ITERATORS,he=Q("iterator"),be="keys",Se="values",oe="entries",ye=function(){return this};y.exports=function(Me,Be,Pe,De,et,Ye,bt){T(Pe,Be,De);var pt=function(Ut){if(Ut===et&&mt)return mt;if(!fe&&Ut in ot)return ot[Ut];switch(Ut){case be:return function(){return new Pe(this,Ut)};case Se:return function(){return new Pe(this,Ut)};case oe:return function(){return new Pe(this,Ut)}}return function(){return new Pe(this)}},Qt=Be+" Iterator",Ie=!1,ot=Me.prototype,ut=ot[he]||ot["@@iterator"]||et&&ot[et],mt=!fe&&ut||pt(et),Ct=Be=="Array"&&ot.entries||ut,rt,Bt,tt;if(Ct&&(rt=E(Ct.call(new Me)),pe!==Object.prototype&&rt.next&&(!q&&E(rt)!==pe&&(R?R(rt,pe):typeof rt[he]!="function"&&G(rt,he,ye)),P(rt,Qt,!0,!0),q&&(ne[Qt]=ye))),et==Se&&ut&&ut.name!==Se&&(Ie=!0,mt=function(){return ut.call(this)}),(!q||bt)&&ot[he]!==mt&&G(ot,he,mt),ne[Be]=mt,et)if(Bt={values:pt(Se),keys:Ye?mt:pt(be),entries:pt(oe)},bt)for(tt in Bt)(fe||Ie||!(tt in ot))&&U(ot,tt,Bt[tt]);else B({target:Be,proto:!0,forced:fe||Ie},Bt);return Bt}},"./node_modules/core-js/internals/define-well-known-symbol.js":function(y,b,x){var B=x("./node_modules/core-js/internals/path.js"),T=x("./node_modules/core-js/internals/has.js"),E=x("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),R=x("./node_modules/core-js/internals/object-define-property.js").f;y.exports=function(P){var G=B.Symbol||(B.Symbol={});T(G,P)||R(G,P,{value:E.f(P)})}},"./node_modules/core-js/internals/descriptors.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js");y.exports=!B(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},"./node_modules/core-js/internals/document-create-element.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/is-object.js"),E=B.document,R=T(E)&&T(E.createElement);y.exports=function(P){return R?E.createElement(P):{}}},"./node_modules/core-js/internals/dom-iterables.js":function(y){y.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},"./node_modules/core-js/internals/engine-user-agent.js":function(y,b,x){var B=x("./node_modules/core-js/internals/get-built-in.js");y.exports=B("navigator","userAgent")||""},"./node_modules/core-js/internals/engine-v8-version.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/engine-user-agent.js"),E=B.process,R=B.Deno,P=E&&E.versions||R&&R.version,G=P&&P.v8,U,Q;G?(U=G.split("."),Q=U[0]<4?1:U[0]+U[1]):T&&(U=T.match(/Edge\/(\d+)/),(!U||U[1]>=74)&&(U=T.match(/Chrome\/(\d+)/),U&&(Q=U[1]))),y.exports=Q&&+Q},"./node_modules/core-js/internals/enum-bug-keys.js":function(y){y.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"./node_modules/core-js/internals/export.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,E=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),R=x("./node_modules/core-js/internals/redefine.js"),P=x("./node_modules/core-js/internals/set-global.js"),G=x("./node_modules/core-js/internals/copy-constructor-properties.js"),U=x("./node_modules/core-js/internals/is-forced.js");y.exports=function(Q,q){var ne=Q.target,re=Q.global,pe=Q.stat,fe,he,be,Se,oe,ye;if(re?he=B:pe?he=B[ne]||P(ne,{}):he=(B[ne]||{}).prototype,he)for(be in q){if(oe=q[be],Q.noTargetGet?(ye=T(he,be),Se=ye&&ye.value):Se=he[be],fe=U(re?be:ne+(pe?".":"#")+be,Q.forced),!fe&&Se!==void 0){if(typeof oe==typeof Se)continue;G(oe,Se)}(Q.sham||Se&&Se.sham)&&E(oe,"sham",!0),R(he,be,oe,Q)}}},"./node_modules/core-js/internals/fails.js":function(y){y.exports=function(b){try{return!!b()}catch{return!0}}},"./node_modules/core-js/internals/function-bind-context.js":function(y,b,x){var B=x("./node_modules/core-js/internals/a-function.js");y.exports=function(T,E,R){if(B(T),E===void 0)return T;switch(R){case 0:return function(){return T.call(E)};case 1:return function(P){return T.call(E,P)};case 2:return function(P,G){return T.call(E,P,G)};case 3:return function(P,G,U){return T.call(E,P,G,U)}}return function(){return T.apply(E,arguments)}}},"./node_modules/core-js/internals/get-built-in.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=function(E){return typeof E=="function"?E:void 0};y.exports=function(E,R){return arguments.length<2?T(B[E]):B[E]&&B[E][R]}},"./node_modules/core-js/internals/global.js":function(y){var b=function(x){return x&&x.Math==Math&&x};y.exports=b(typeof globalThis=="object"&&globalThis)||b(typeof window=="object"&&window)||b(typeof self=="object"&&self)||b(typeof J0=="object"&&J0)||function(){return this}()||Function("return this")()},"./node_modules/core-js/internals/has.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-object.js"),T={}.hasOwnProperty;y.exports=Object.hasOwn||function(R,P){return T.call(B(R),P)}},"./node_modules/core-js/internals/hidden-keys.js":function(y){y.exports={}},"./node_modules/core-js/internals/html.js":function(y,b,x){var B=x("./node_modules/core-js/internals/get-built-in.js");y.exports=B("document","documentElement")},"./node_modules/core-js/internals/ie8-dom-define.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/fails.js"),E=x("./node_modules/core-js/internals/document-create-element.js");y.exports=!B&&!T(function(){return Object.defineProperty(E("div"),"a",{get:function(){return 7}}).a!=7})},"./node_modules/core-js/internals/indexed-object.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js"),T=x("./node_modules/core-js/internals/classof-raw.js"),E="".split;y.exports=B(function(){return!Object("z").propertyIsEnumerable(0)})?function(R){return T(R)=="String"?E.call(R,""):Object(R)}:Object},"./node_modules/core-js/internals/inherit-if-required.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js"),T=x("./node_modules/core-js/internals/object-set-prototype-of.js");y.exports=function(E,R,P){var G,U;return T&&typeof(G=R.constructor)=="function"&&G!==P&&B(U=G.prototype)&&U!==P.prototype&&T(E,U),E}},"./node_modules/core-js/internals/inspect-source.js":function(y,b,x){var B=x("./node_modules/core-js/internals/shared-store.js"),T=Function.toString;typeof B.inspectSource!="function"&&(B.inspectSource=function(E){return T.call(E)}),y.exports=B.inspectSource},"./node_modules/core-js/internals/internal-state.js":function(y,b,x){var B=x("./node_modules/core-js/internals/native-weak-map.js"),T=x("./node_modules/core-js/internals/global.js"),E=x("./node_modules/core-js/internals/is-object.js"),R=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),P=x("./node_modules/core-js/internals/has.js"),G=x("./node_modules/core-js/internals/shared-store.js"),U=x("./node_modules/core-js/internals/shared-key.js"),Q=x("./node_modules/core-js/internals/hidden-keys.js"),q="Object already initialized",ne=T.WeakMap,re,pe,fe,he=function(Pe){return fe(Pe)?pe(Pe):re(Pe,{})},be=function(Pe){return function(De){var et;if(!E(De)||(et=pe(De)).type!==Pe)throw TypeError("Incompatible receiver, "+Pe+" required");return et}};if(B||G.state){var Se=G.state||(G.state=new ne),oe=Se.get,ye=Se.has,Me=Se.set;re=function(Pe,De){if(ye.call(Se,Pe))throw new TypeError(q);return De.facade=Pe,Me.call(Se,Pe,De),De},pe=function(Pe){return oe.call(Se,Pe)||{}},fe=function(Pe){return ye.call(Se,Pe)}}else{var Be=U("state");Q[Be]=!0,re=function(Pe,De){if(P(Pe,Be))throw new TypeError(q);return De.facade=Pe,R(Pe,Be,De),De},pe=function(Pe){return P(Pe,Be)?Pe[Be]:{}},fe=function(Pe){return P(Pe,Be)}}y.exports={set:re,get:pe,has:fe,enforce:he,getterFor:be}},"./node_modules/core-js/internals/is-array.js":function(y,b,x){var B=x("./node_modules/core-js/internals/classof-raw.js");y.exports=Array.isArray||function(E){return B(E)=="Array"}},"./node_modules/core-js/internals/is-forced.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js"),T=/#|\.prototype\./,E=function(Q,q){var ne=P[R(Q)];return ne==U?!0:ne==G?!1:typeof q=="function"?B(q):!!q},R=E.normalize=function(Q){return String(Q).replace(T,".").toLowerCase()},P=E.data={},G=E.NATIVE="N",U=E.POLYFILL="P";y.exports=E},"./node_modules/core-js/internals/is-object.js":function(y){y.exports=function(b){return typeof b=="object"?b!==null:typeof b=="function"}},"./node_modules/core-js/internals/is-pure.js":function(y){y.exports=!1},"./node_modules/core-js/internals/is-symbol.js":function(y,b,x){var B=x("./node_modules/core-js/internals/get-built-in.js"),T=x("./node_modules/core-js/internals/use-symbol-as-uid.js");y.exports=T?function(E){return typeof E=="symbol"}:function(E){var R=B("Symbol");return typeof R=="function"&&Object(E)instanceof R}},"./node_modules/core-js/internals/iterators-core.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js"),T=x("./node_modules/core-js/internals/object-get-prototype-of.js"),E=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),R=x("./node_modules/core-js/internals/has.js"),P=x("./node_modules/core-js/internals/well-known-symbol.js"),G=x("./node_modules/core-js/internals/is-pure.js"),U=P("iterator"),Q=!1,q=function(){return this},ne,re,pe;[].keys&&(pe=[].keys(),"next"in pe?(re=T(T(pe)),re!==Object.prototype&&(ne=re)):Q=!0);var fe=ne==null||B(function(){var he={};return ne[U].call(he)!==he});fe&&(ne={}),(!G||fe)&&!R(ne,U)&&E(ne,U,q),y.exports={IteratorPrototype:ne,BUGGY_SAFARI_ITERATORS:Q}},"./node_modules/core-js/internals/iterators.js":function(y){y.exports={}},"./node_modules/core-js/internals/native-symbol.js":function(y,b,x){var B=x("./node_modules/core-js/internals/engine-v8-version.js"),T=x("./node_modules/core-js/internals/fails.js");y.exports=!!Object.getOwnPropertySymbols&&!T(function(){var E=Symbol();return!String(E)||!(Object(E)instanceof Symbol)||!Symbol.sham&&B&&B<41})},"./node_modules/core-js/internals/native-weak-map.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/inspect-source.js"),E=B.WeakMap;y.exports=typeof E=="function"&&/native code/.test(T(E))},"./node_modules/core-js/internals/object-assign.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/fails.js"),E=x("./node_modules/core-js/internals/object-keys.js"),R=x("./node_modules/core-js/internals/object-get-own-property-symbols.js"),P=x("./node_modules/core-js/internals/object-property-is-enumerable.js"),G=x("./node_modules/core-js/internals/to-object.js"),U=x("./node_modules/core-js/internals/indexed-object.js"),Q=Object.assign,q=Object.defineProperty;y.exports=!Q||T(function(){if(B&&Q({b:1},Q(q({},"a",{enumerable:!0,get:function(){q(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var ne={},re={},pe=Symbol(),fe="abcdefghijklmnopqrst";return ne[pe]=7,fe.split("").forEach(function(he){re[he]=he}),Q({},ne)[pe]!=7||E(Q({},re)).join("")!=fe})?function(re,pe){for(var fe=G(re),he=arguments.length,be=1,Se=R.f,oe=P.f;he>be;)for(var ye=U(arguments[be++]),Me=Se?E(ye).concat(Se(ye)):E(ye),Be=Me.length,Pe=0,De;Be>Pe;)De=Me[Pe++],(!B||oe.call(ye,De))&&(fe[De]=ye[De]);return fe}:Q},"./node_modules/core-js/internals/object-create.js":function(y,b,x){var B=x("./node_modules/core-js/internals/an-object.js"),T=x("./node_modules/core-js/internals/object-define-properties.js"),E=x("./node_modules/core-js/internals/enum-bug-keys.js"),R=x("./node_modules/core-js/internals/hidden-keys.js"),P=x("./node_modules/core-js/internals/html.js"),G=x("./node_modules/core-js/internals/document-create-element.js"),U=x("./node_modules/core-js/internals/shared-key.js"),Q=">",q="<",ne="prototype",re="script",pe=U("IE_PROTO"),fe=function(){},he=function(Me){return q+re+Q+Me+q+"/"+re+Q},be=function(Me){Me.write(he("")),Me.close();var Be=Me.parentWindow.Object;return Me=null,Be},Se=function(){var Me=G("iframe"),Be="java"+re+":",Pe;if(Me.style)return Me.style.display="none",P.appendChild(Me),Me.src=String(Be),Pe=Me.contentWindow.document,Pe.open(),Pe.write(he("document.F=Object")),Pe.close(),Pe.F},oe,ye=function(){try{oe=new ActiveXObject("htmlfile")}catch{}ye=document.domain&&oe?be(oe):Se()||be(oe);for(var Me=E.length;Me--;)delete ye[ne][E[Me]];return ye()};R[pe]=!0,y.exports=Object.create||function(Be,Pe){var De;return Be!==null?(fe[ne]=B(Be),De=new fe,fe[ne]=null,De[pe]=Be):De=ye(),Pe===void 0?De:T(De,Pe)}},"./node_modules/core-js/internals/object-define-properties.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/object-define-property.js"),E=x("./node_modules/core-js/internals/an-object.js"),R=x("./node_modules/core-js/internals/object-keys.js");y.exports=B?Object.defineProperties:function(G,U){E(G);for(var Q=R(U),q=Q.length,ne=0,re;q>ne;)T.f(G,re=Q[ne++],U[re]);return G}},"./node_modules/core-js/internals/object-define-property.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/ie8-dom-define.js"),E=x("./node_modules/core-js/internals/an-object.js"),R=x("./node_modules/core-js/internals/to-property-key.js"),P=Object.defineProperty;b.f=B?P:function(U,Q,q){if(E(U),Q=R(Q),E(q),T)try{return P(U,Q,q)}catch{}if("get"in q||"set"in q)throw TypeError("Accessors not supported");return"value"in q&&(U[Q]=q.value),U}},"./node_modules/core-js/internals/object-get-own-property-descriptor.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/object-property-is-enumerable.js"),E=x("./node_modules/core-js/internals/create-property-descriptor.js"),R=x("./node_modules/core-js/internals/to-indexed-object.js"),P=x("./node_modules/core-js/internals/to-property-key.js"),G=x("./node_modules/core-js/internals/has.js"),U=x("./node_modules/core-js/internals/ie8-dom-define.js"),Q=Object.getOwnPropertyDescriptor;b.f=B?Q:function(ne,re){if(ne=R(ne),re=P(re),U)try{return Q(ne,re)}catch{}if(G(ne,re))return E(!T.f.call(ne,re),ne[re])}},"./node_modules/core-js/internals/object-get-own-property-names-external.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-indexed-object.js"),T=x("./node_modules/core-js/internals/object-get-own-property-names.js").f,E={}.toString,R=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],P=function(G){try{return T(G)}catch{return R.slice()}};y.exports.f=function(U){return R&&E.call(U)=="[object Window]"?P(U):T(B(U))}},"./node_modules/core-js/internals/object-get-own-property-names.js":function(y,b,x){var B=x("./node_modules/core-js/internals/object-keys-internal.js"),T=x("./node_modules/core-js/internals/enum-bug-keys.js"),E=T.concat("length","prototype");b.f=Object.getOwnPropertyNames||function(P){return B(P,E)}},"./node_modules/core-js/internals/object-get-own-property-symbols.js":function(y,b){b.f=Object.getOwnPropertySymbols},"./node_modules/core-js/internals/object-get-prototype-of.js":function(y,b,x){var B=x("./node_modules/core-js/internals/has.js"),T=x("./node_modules/core-js/internals/to-object.js"),E=x("./node_modules/core-js/internals/shared-key.js"),R=x("./node_modules/core-js/internals/correct-prototype-getter.js"),P=E("IE_PROTO"),G=Object.prototype;y.exports=R?Object.getPrototypeOf:function(U){return U=T(U),B(U,P)?U[P]:typeof U.constructor=="function"&&U instanceof U.constructor?U.constructor.prototype:U instanceof Object?G:null}},"./node_modules/core-js/internals/object-keys-internal.js":function(y,b,x){var B=x("./node_modules/core-js/internals/has.js"),T=x("./node_modules/core-js/internals/to-indexed-object.js"),E=x("./node_modules/core-js/internals/array-includes.js").indexOf,R=x("./node_modules/core-js/internals/hidden-keys.js");y.exports=function(P,G){var U=T(P),Q=0,q=[],ne;for(ne in U)!B(R,ne)&&B(U,ne)&&q.push(ne);for(;G.length>Q;)B(U,ne=G[Q++])&&(~E(q,ne)||q.push(ne));return q}},"./node_modules/core-js/internals/object-keys.js":function(y,b,x){var B=x("./node_modules/core-js/internals/object-keys-internal.js"),T=x("./node_modules/core-js/internals/enum-bug-keys.js");y.exports=Object.keys||function(R){return B(R,T)}},"./node_modules/core-js/internals/object-property-is-enumerable.js":function(y,b){var x={}.propertyIsEnumerable,B=Object.getOwnPropertyDescriptor,T=B&&!x.call({1:2},1);b.f=T?function(R){var P=B(this,R);return!!P&&P.enumerable}:x},"./node_modules/core-js/internals/object-set-prototype-of.js":function(y,b,x){var B=x("./node_modules/core-js/internals/an-object.js"),T=x("./node_modules/core-js/internals/a-possible-prototype.js");y.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var E=!1,R={},P;try{P=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,P.call(R,[]),E=R instanceof Array}catch{}return function(U,Q){return B(U),T(Q),E?P.call(U,Q):U.__proto__=Q,U}}():void 0)},"./node_modules/core-js/internals/object-to-string.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-string-tag-support.js"),T=x("./node_modules/core-js/internals/classof.js");y.exports=B?{}.toString:function(){return"[object "+T(this)+"]"}},"./node_modules/core-js/internals/ordinary-to-primitive.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js");y.exports=function(T,E){var R,P;if(E==="string"&&typeof(R=T.toString)=="function"&&!B(P=R.call(T))||typeof(R=T.valueOf)=="function"&&!B(P=R.call(T))||E!=="string"&&typeof(R=T.toString)=="function"&&!B(P=R.call(T)))return P;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/internals/own-keys.js":function(y,b,x){var B=x("./node_modules/core-js/internals/get-built-in.js"),T=x("./node_modules/core-js/internals/object-get-own-property-names.js"),E=x("./node_modules/core-js/internals/object-get-own-property-symbols.js"),R=x("./node_modules/core-js/internals/an-object.js");y.exports=B("Reflect","ownKeys")||function(G){var U=T.f(R(G)),Q=E.f;return Q?U.concat(Q(G)):U}},"./node_modules/core-js/internals/path.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js");y.exports=B},"./node_modules/core-js/internals/redefine.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),E=x("./node_modules/core-js/internals/has.js"),R=x("./node_modules/core-js/internals/set-global.js"),P=x("./node_modules/core-js/internals/inspect-source.js"),G=x("./node_modules/core-js/internals/internal-state.js"),U=G.get,Q=G.enforce,q=String(String).split("String");(y.exports=function(ne,re,pe,fe){var he=fe?!!fe.unsafe:!1,be=fe?!!fe.enumerable:!1,Se=fe?!!fe.noTargetGet:!1,oe;if(typeof pe=="function"&&(typeof re=="string"&&!E(pe,"name")&&T(pe,"name",re),oe=Q(pe),oe.source||(oe.source=q.join(typeof re=="string"?re:""))),ne===B){be?ne[re]=pe:R(re,pe);return}else he?!Se&&ne[re]&&(be=!0):delete ne[re];be?ne[re]=pe:T(ne,re,pe)})(Function.prototype,"toString",function(){return typeof this=="function"&&U(this).source||P(this)})},"./node_modules/core-js/internals/regexp-flags.js":function(y,b,x){var B=x("./node_modules/core-js/internals/an-object.js");y.exports=function(){var T=B(this),E="";return T.global&&(E+="g"),T.ignoreCase&&(E+="i"),T.multiline&&(E+="m"),T.dotAll&&(E+="s"),T.unicode&&(E+="u"),T.sticky&&(E+="y"),E}},"./node_modules/core-js/internals/require-object-coercible.js":function(y){y.exports=function(b){if(b==null)throw TypeError("Can't call method on "+b);return b}},"./node_modules/core-js/internals/set-global.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js");y.exports=function(T,E){try{Object.defineProperty(B,T,{value:E,configurable:!0,writable:!0})}catch{B[T]=E}return E}},"./node_modules/core-js/internals/set-to-string-tag.js":function(y,b,x){var B=x("./node_modules/core-js/internals/object-define-property.js").f,T=x("./node_modules/core-js/internals/has.js"),E=x("./node_modules/core-js/internals/well-known-symbol.js"),R=E("toStringTag");y.exports=function(P,G,U){P&&!T(P=U?P:P.prototype,R)&&B(P,R,{configurable:!0,value:G})}},"./node_modules/core-js/internals/shared-key.js":function(y,b,x){var B=x("./node_modules/core-js/internals/shared.js"),T=x("./node_modules/core-js/internals/uid.js"),E=B("keys");y.exports=function(R){return E[R]||(E[R]=T(R))}},"./node_modules/core-js/internals/shared-store.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/set-global.js"),E="__core-js_shared__",R=B[E]||T(E,{});y.exports=R},"./node_modules/core-js/internals/shared.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-pure.js"),T=x("./node_modules/core-js/internals/shared-store.js");(y.exports=function(E,R){return T[E]||(T[E]=R!==void 0?R:{})})("versions",[]).push({version:"3.16.0",mode:B?"pure":"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/internals/string-html-forced.js":function(y,b,x){var B=x("./node_modules/core-js/internals/fails.js");y.exports=function(T){return B(function(){var E=""[T]('"');return E!==E.toLowerCase()||E.split('"').length>3})}},"./node_modules/core-js/internals/string-multibyte.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-integer.js"),T=x("./node_modules/core-js/internals/to-string.js"),E=x("./node_modules/core-js/internals/require-object-coercible.js"),R=function(P){return function(G,U){var Q=T(E(G)),q=B(U),ne=Q.length,re,pe;return q<0||q>=ne?P?"":void 0:(re=Q.charCodeAt(q),re<55296||re>56319||q+1===ne||(pe=Q.charCodeAt(q+1))<56320||pe>57343?P?Q.charAt(q):re:P?Q.slice(q,q+2):(re-55296<<10)+(pe-56320)+65536)}};y.exports={codeAt:R(!1),charAt:R(!0)}},"./node_modules/core-js/internals/string-trim.js":function(y,b,x){var B=x("./node_modules/core-js/internals/require-object-coercible.js"),T=x("./node_modules/core-js/internals/to-string.js"),E=x("./node_modules/core-js/internals/whitespaces.js"),R="["+E+"]",P=RegExp("^"+R+R+"*"),G=RegExp(R+R+"*$"),U=function(Q){return function(q){var ne=T(B(q));return Q&1&&(ne=ne.replace(P,"")),Q&2&&(ne=ne.replace(G,"")),ne}};y.exports={start:U(1),end:U(2),trim:U(3)}},"./node_modules/core-js/internals/to-absolute-index.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-integer.js"),T=Math.max,E=Math.min;y.exports=function(R,P){var G=B(R);return G<0?T(G+P,0):E(G,P)}},"./node_modules/core-js/internals/to-indexed-object.js":function(y,b,x){var B=x("./node_modules/core-js/internals/indexed-object.js"),T=x("./node_modules/core-js/internals/require-object-coercible.js");y.exports=function(E){return B(T(E))}},"./node_modules/core-js/internals/to-integer.js":function(y){var b=Math.ceil,x=Math.floor;y.exports=function(B){return isNaN(B=+B)?0:(B>0?x:b)(B)}},"./node_modules/core-js/internals/to-length.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-integer.js"),T=Math.min;y.exports=function(E){return E>0?T(B(E),9007199254740991):0}},"./node_modules/core-js/internals/to-object.js":function(y,b,x){var B=x("./node_modules/core-js/internals/require-object-coercible.js");y.exports=function(T){return Object(B(T))}},"./node_modules/core-js/internals/to-primitive.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-object.js"),T=x("./node_modules/core-js/internals/is-symbol.js"),E=x("./node_modules/core-js/internals/ordinary-to-primitive.js"),R=x("./node_modules/core-js/internals/well-known-symbol.js"),P=R("toPrimitive");y.exports=function(G,U){if(!B(G)||T(G))return G;var Q=G[P],q;if(Q!==void 0){if(U===void 0&&(U="default"),q=Q.call(G,U),!B(q)||T(q))return q;throw TypeError("Can't convert object to primitive value")}return U===void 0&&(U="number"),E(G,U)}},"./node_modules/core-js/internals/to-property-key.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-primitive.js"),T=x("./node_modules/core-js/internals/is-symbol.js");y.exports=function(E){var R=B(E,"string");return T(R)?R:String(R)}},"./node_modules/core-js/internals/to-string-tag-support.js":function(y,b,x){var B=x("./node_modules/core-js/internals/well-known-symbol.js"),T=B("toStringTag"),E={};E[T]="z",y.exports=String(E)==="[object z]"},"./node_modules/core-js/internals/to-string.js":function(y,b,x){var B=x("./node_modules/core-js/internals/is-symbol.js");y.exports=function(T){if(B(T))throw TypeError("Cannot convert a Symbol value to a string");return String(T)}},"./node_modules/core-js/internals/uid.js":function(y){var b=0,x=Math.random();y.exports=function(B){return"Symbol("+String(B===void 0?"":B)+")_"+(++b+x).toString(36)}},"./node_modules/core-js/internals/use-symbol-as-uid.js":function(y,b,x){var B=x("./node_modules/core-js/internals/native-symbol.js");y.exports=B&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},"./node_modules/core-js/internals/well-known-symbol-wrapped.js":function(y,b,x){var B=x("./node_modules/core-js/internals/well-known-symbol.js");b.f=B},"./node_modules/core-js/internals/well-known-symbol.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/shared.js"),E=x("./node_modules/core-js/internals/has.js"),R=x("./node_modules/core-js/internals/uid.js"),P=x("./node_modules/core-js/internals/native-symbol.js"),G=x("./node_modules/core-js/internals/use-symbol-as-uid.js"),U=T("wks"),Q=B.Symbol,q=G?Q:Q&&Q.withoutSetter||R;y.exports=function(ne){return(!E(U,ne)||!(P||typeof U[ne]=="string"))&&(P&&E(Q,ne)?U[ne]=Q[ne]:U[ne]=q("Symbol."+ne)),U[ne]}},"./node_modules/core-js/internals/whitespaces.js":function(y){y.exports=`	
\v\f\r \u2028\u2029\uFEFF`},"./node_modules/core-js/modules/es.array.concat.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/fails.js"),E=x("./node_modules/core-js/internals/is-array.js"),R=x("./node_modules/core-js/internals/is-object.js"),P=x("./node_modules/core-js/internals/to-object.js"),G=x("./node_modules/core-js/internals/to-length.js"),U=x("./node_modules/core-js/internals/create-property.js"),Q=x("./node_modules/core-js/internals/array-species-create.js"),q=x("./node_modules/core-js/internals/array-method-has-species-support.js"),ne=x("./node_modules/core-js/internals/well-known-symbol.js"),re=x("./node_modules/core-js/internals/engine-v8-version.js"),pe=ne("isConcatSpreadable"),fe=9007199254740991,he="Maximum allowed index exceeded",be=re>=51||!T(function(){var Me=[];return Me[pe]=!1,Me.concat()[0]!==Me}),Se=q("concat"),oe=function(Me){if(!R(Me))return!1;var Be=Me[pe];return Be!==void 0?!!Be:E(Me)},ye=!be||!Se;B({target:"Array",proto:!0,forced:ye},{concat:function(Be){var Pe=P(this),De=Q(Pe,0),et=0,Ye,bt,pt,Qt,Ie;for(Ye=-1,pt=arguments.length;Ye<pt;Ye++)if(Ie=Ye===-1?Pe:arguments[Ye],oe(Ie)){if(Qt=G(Ie.length),et+Qt>fe)throw TypeError(he);for(bt=0;bt<Qt;bt++,et++)bt in Ie&&U(De,et,Ie[bt])}else{if(et>=fe)throw TypeError(he);U(De,et++,Ie)}return De.length=et,De}})},"./node_modules/core-js/modules/es.array.iterator.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-indexed-object.js"),T=x("./node_modules/core-js/internals/add-to-unscopables.js"),E=x("./node_modules/core-js/internals/iterators.js"),R=x("./node_modules/core-js/internals/internal-state.js"),P=x("./node_modules/core-js/internals/define-iterator.js"),G="Array Iterator",U=R.set,Q=R.getterFor(G);y.exports=P(Array,"Array",function(q,ne){U(this,{type:G,target:B(q),index:0,kind:ne})},function(){var q=Q(this),ne=q.target,re=q.kind,pe=q.index++;return!ne||pe>=ne.length?(q.target=void 0,{value:void 0,done:!0}):re=="keys"?{value:pe,done:!1}:re=="values"?{value:ne[pe],done:!1}:{value:[pe,ne[pe]],done:!1}},"values"),E.Arguments=E.Array,T("keys"),T("values"),T("entries")},"./node_modules/core-js/modules/es.array.join.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/indexed-object.js"),E=x("./node_modules/core-js/internals/to-indexed-object.js"),R=x("./node_modules/core-js/internals/array-method-is-strict.js"),P=[].join,G=T!=Object,U=R("join",",");B({target:"Array",proto:!0,forced:G||!U},{join:function(q){return P.call(E(this),q===void 0?",":q)}})},"./node_modules/core-js/modules/es.array.map.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/array-iteration.js").map,E=x("./node_modules/core-js/internals/array-method-has-species-support.js"),R=E("map");B({target:"Array",proto:!0,forced:!R},{map:function(G){return T(this,G,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.slice.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/is-object.js"),E=x("./node_modules/core-js/internals/is-array.js"),R=x("./node_modules/core-js/internals/to-absolute-index.js"),P=x("./node_modules/core-js/internals/to-length.js"),G=x("./node_modules/core-js/internals/to-indexed-object.js"),U=x("./node_modules/core-js/internals/create-property.js"),Q=x("./node_modules/core-js/internals/well-known-symbol.js"),q=x("./node_modules/core-js/internals/array-method-has-species-support.js"),ne=q("slice"),re=Q("species"),pe=[].slice,fe=Math.max;B({target:"Array",proto:!0,forced:!ne},{slice:function(be,Se){var oe=G(this),ye=P(oe.length),Me=R(be,ye),Be=R(Se===void 0?ye:Se,ye),Pe,De,et;if(E(oe)&&(Pe=oe.constructor,typeof Pe=="function"&&(Pe===Array||E(Pe.prototype))?Pe=void 0:T(Pe)&&(Pe=Pe[re],Pe===null&&(Pe=void 0)),Pe===Array||Pe===void 0))return pe.call(oe,Me,Be);for(De=new(Pe===void 0?Array:Pe)(fe(Be-Me,0)),et=0;Me<Be;Me++,et++)Me in oe&&U(De,et,oe[Me]);return De.length=et,De}})},"./node_modules/core-js/modules/es.function.name.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/object-define-property.js").f,E=Function.prototype,R=E.toString,P=/^\s*function ([^ (]*)/,G="name";B&&!(G in E)&&T(E,G,{configurable:!0,get:function(){try{return R.call(this).match(P)[1]}catch{return""}}})},"./node_modules/core-js/modules/es.number.constructor.js":function(y,b,x){var B=x("./node_modules/core-js/internals/descriptors.js"),T=x("./node_modules/core-js/internals/global.js"),E=x("./node_modules/core-js/internals/is-forced.js"),R=x("./node_modules/core-js/internals/redefine.js"),P=x("./node_modules/core-js/internals/has.js"),G=x("./node_modules/core-js/internals/classof-raw.js"),U=x("./node_modules/core-js/internals/inherit-if-required.js"),Q=x("./node_modules/core-js/internals/is-symbol.js"),q=x("./node_modules/core-js/internals/to-primitive.js"),ne=x("./node_modules/core-js/internals/fails.js"),re=x("./node_modules/core-js/internals/object-create.js"),pe=x("./node_modules/core-js/internals/object-get-own-property-names.js").f,fe=x("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,he=x("./node_modules/core-js/internals/object-define-property.js").f,be=x("./node_modules/core-js/internals/string-trim.js").trim,Se="Number",oe=T[Se],ye=oe.prototype,Me=G(re(ye))==Se,Be=function(bt){if(Q(bt))throw TypeError("Cannot convert a Symbol value to a number");var pt=q(bt,"number"),Qt,Ie,ot,ut,mt,Ct,rt,Bt;if(typeof pt=="string"&&pt.length>2){if(pt=be(pt),Qt=pt.charCodeAt(0),Qt===43||Qt===45){if(Ie=pt.charCodeAt(2),Ie===88||Ie===120)return NaN}else if(Qt===48){switch(pt.charCodeAt(1)){case 66:case 98:ot=2,ut=49;break;case 79:case 111:ot=8,ut=55;break;default:return+pt}for(mt=pt.slice(2),Ct=mt.length,rt=0;rt<Ct;rt++)if(Bt=mt.charCodeAt(rt),Bt<48||Bt>ut)return NaN;return parseInt(mt,ot)}}return+pt};if(E(Se,!oe(" 0o1")||!oe("0b1")||oe("+0x1"))){for(var Pe=function(pt){var Qt=arguments.length<1?0:pt,Ie=this;return Ie instanceof Pe&&(Me?ne(function(){ye.valueOf.call(Ie)}):G(Ie)!=Se)?U(new oe(Be(Qt)),Ie,Pe):Be(Qt)},De=B?pe(oe):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),et=0,Ye;De.length>et;et++)P(oe,Ye=De[et])&&!P(Pe,Ye)&&he(Pe,Ye,fe(oe,Ye));Pe.prototype=ye,ye.constructor=Pe,R(T,Se,Pe)}},"./node_modules/core-js/modules/es.object.assign.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/object-assign.js");B({target:"Object",stat:!0,forced:Object.assign!==T},{assign:T})},"./node_modules/core-js/modules/es.object.keys.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/to-object.js"),E=x("./node_modules/core-js/internals/object-keys.js"),R=x("./node_modules/core-js/internals/fails.js"),P=R(function(){E(1)});B({target:"Object",stat:!0,forced:P},{keys:function(U){return E(T(U))}})},"./node_modules/core-js/modules/es.object.to-string.js":function(y,b,x){var B=x("./node_modules/core-js/internals/to-string-tag-support.js"),T=x("./node_modules/core-js/internals/redefine.js"),E=x("./node_modules/core-js/internals/object-to-string.js");B||T(Object.prototype,"toString",E,{unsafe:!0})},"./node_modules/core-js/modules/es.regexp.to-string.js":function(y,b,x){var B=x("./node_modules/core-js/internals/redefine.js"),T=x("./node_modules/core-js/internals/an-object.js"),E=x("./node_modules/core-js/internals/to-string.js"),R=x("./node_modules/core-js/internals/fails.js"),P=x("./node_modules/core-js/internals/regexp-flags.js"),G="toString",U=RegExp.prototype,Q=U[G],q=R(function(){return Q.call({source:"a",flags:"b"})!="/a/b"}),ne=Q.name!=G;(q||ne)&&B(RegExp.prototype,G,function(){var pe=T(this),fe=E(pe.source),he=pe.flags,be=E(he===void 0&&pe instanceof RegExp&&!("flags"in U)?P.call(pe):he);return"/"+fe+"/"+be},{unsafe:!0})},"./node_modules/core-js/modules/es.string.iterator.js":function(y,b,x){var B=x("./node_modules/core-js/internals/string-multibyte.js").charAt,T=x("./node_modules/core-js/internals/to-string.js"),E=x("./node_modules/core-js/internals/internal-state.js"),R=x("./node_modules/core-js/internals/define-iterator.js"),P="String Iterator",G=E.set,U=E.getterFor(P);R(String,"String",function(Q){G(this,{type:P,string:T(Q),index:0})},function(){var q=U(this),ne=q.string,re=q.index,pe;return re>=ne.length?{value:void 0,done:!0}:(pe=B(ne,re),q.index+=pe.length,{value:pe,done:!1})})},"./node_modules/core-js/modules/es.string.link.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/create-html.js"),E=x("./node_modules/core-js/internals/string-html-forced.js");B({target:"String",proto:!0,forced:E("link")},{link:function(P){return T(this,"a","href",P)}})},"./node_modules/core-js/modules/es.symbol.description.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/descriptors.js"),E=x("./node_modules/core-js/internals/global.js"),R=x("./node_modules/core-js/internals/has.js"),P=x("./node_modules/core-js/internals/is-object.js"),G=x("./node_modules/core-js/internals/object-define-property.js").f,U=x("./node_modules/core-js/internals/copy-constructor-properties.js"),Q=E.Symbol;if(T&&typeof Q=="function"&&(!("description"in Q.prototype)||Q().description!==void 0)){var q={},ne=function(){var Se=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),oe=this instanceof ne?new Q(Se):Se===void 0?Q():Q(Se);return Se===""&&(q[oe]=!0),oe};U(ne,Q);var re=ne.prototype=Q.prototype;re.constructor=ne;var pe=re.toString,fe=String(Q("test"))=="Symbol(test)",he=/^Symbol\((.*)\)[^)]+$/;G(re,"description",{configurable:!0,get:function(){var Se=P(this)?this.valueOf():this,oe=pe.call(Se);if(R(q,Se))return"";var ye=fe?oe.slice(7,-1):oe.replace(he,"$1");return ye===""?void 0:ye}}),B({global:!0,forced:!0},{Symbol:ne})}},"./node_modules/core-js/modules/es.symbol.iterator.js":function(y,b,x){var B=x("./node_modules/core-js/internals/define-well-known-symbol.js");B("iterator")},"./node_modules/core-js/modules/es.symbol.js":function(y,b,x){var B=x("./node_modules/core-js/internals/export.js"),T=x("./node_modules/core-js/internals/global.js"),E=x("./node_modules/core-js/internals/get-built-in.js"),R=x("./node_modules/core-js/internals/is-pure.js"),P=x("./node_modules/core-js/internals/descriptors.js"),G=x("./node_modules/core-js/internals/native-symbol.js"),U=x("./node_modules/core-js/internals/fails.js"),Q=x("./node_modules/core-js/internals/has.js"),q=x("./node_modules/core-js/internals/is-array.js"),ne=x("./node_modules/core-js/internals/is-object.js"),re=x("./node_modules/core-js/internals/is-symbol.js"),pe=x("./node_modules/core-js/internals/an-object.js"),fe=x("./node_modules/core-js/internals/to-object.js"),he=x("./node_modules/core-js/internals/to-indexed-object.js"),be=x("./node_modules/core-js/internals/to-property-key.js"),Se=x("./node_modules/core-js/internals/to-string.js"),oe=x("./node_modules/core-js/internals/create-property-descriptor.js"),ye=x("./node_modules/core-js/internals/object-create.js"),Me=x("./node_modules/core-js/internals/object-keys.js"),Be=x("./node_modules/core-js/internals/object-get-own-property-names.js"),Pe=x("./node_modules/core-js/internals/object-get-own-property-names-external.js"),De=x("./node_modules/core-js/internals/object-get-own-property-symbols.js"),et=x("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),Ye=x("./node_modules/core-js/internals/object-define-property.js"),bt=x("./node_modules/core-js/internals/object-property-is-enumerable.js"),pt=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),Qt=x("./node_modules/core-js/internals/redefine.js"),Ie=x("./node_modules/core-js/internals/shared.js"),ot=x("./node_modules/core-js/internals/shared-key.js"),ut=x("./node_modules/core-js/internals/hidden-keys.js"),mt=x("./node_modules/core-js/internals/uid.js"),Ct=x("./node_modules/core-js/internals/well-known-symbol.js"),rt=x("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),Bt=x("./node_modules/core-js/internals/define-well-known-symbol.js"),tt=x("./node_modules/core-js/internals/set-to-string-tag.js"),Ut=x("./node_modules/core-js/internals/internal-state.js"),Ai=x("./node_modules/core-js/internals/array-iteration.js").forEach,qe=ot("hidden"),Ke="Symbol",Pt="prototype",It=Ct("toPrimitive"),Ze=Ut.set,yi=Ut.getterFor(Ke),bi=Object[Pt],Kt=T.Symbol,di=E("JSON","stringify"),pi=et.f,Ri=Ye.f,Oi=Pe.f,Ji=bt.f,ar=Ie("symbols"),br=Ie("op-symbols"),Dr=Ie("string-to-symbol-registry"),Fr=Ie("symbol-to-string-registry"),Qr=Ie("wks"),ui=T.QObject,li=!ui||!ui[Pt]||!ui[Pt].findChild,Vi=P&&U(function(){return ye(Ri({},"a",{get:function(){return Ri(this,"a",{value:7}).a}})).a!=7})?function(zn,Lr,yr){var qt=pi(bi,Lr);qt&&delete bi[Lr],Ri(zn,Lr,yr),qt&&zn!==bi&&Ri(bi,Lr,qt)}:Ri,rr=function(zn,Lr){var yr=ar[zn]=ye(Kt[Pt]);return Ze(yr,{type:Ke,tag:zn,description:Lr}),P||(yr.description=Lr),yr},qr=function(Lr,yr,qt){Lr===bi&&qr(br,yr,qt),pe(Lr);var Nn=be(yr);return pe(qt),Q(ar,Nn)?(qt.enumerable?(Q(Lr,qe)&&Lr[qe][Nn]&&(Lr[qe][Nn]=!1),qt=ye(qt,{enumerable:oe(0,!1)})):(Q(Lr,qe)||Ri(Lr,qe,oe(1,{})),Lr[qe][Nn]=!0),Vi(Lr,Nn,qt)):Ri(Lr,Nn,qt)},_r=function(Lr,yr){pe(Lr);var qt=he(yr),Nn=Me(qt).concat(As(qt));return Ai(Nn,function(vs){(!P||io.call(qt,vs))&&qr(Lr,vs,qt[vs])}),Lr},Zr=function(Lr,yr){return yr===void 0?ye(Lr):_r(ye(Lr),yr)},io=function(Lr){var yr=be(Lr),qt=Ji.call(this,yr);return this===bi&&Q(ar,yr)&&!Q(br,yr)?!1:qt||!Q(this,yr)||!Q(ar,yr)||Q(this,qe)&&this[qe][yr]?qt:!0},Ur=function(Lr,yr){var qt=he(Lr),Nn=be(yr);if(!(qt===bi&&Q(ar,Nn)&&!Q(br,Nn))){var vs=pi(qt,Nn);return vs&&Q(ar,Nn)&&!(Q(qt,qe)&&qt[qe][Nn])&&(vs.enumerable=!0),vs}},ta=function(Lr){var yr=Oi(he(Lr)),qt=[];return Ai(yr,function(Nn){!Q(ar,Nn)&&!Q(ut,Nn)&&qt.push(Nn)}),qt},As=function(Lr){var yr=Lr===bi,qt=Oi(yr?br:he(Lr)),Nn=[];return Ai(qt,function(vs){Q(ar,vs)&&(!yr||Q(bi,vs))&&Nn.push(ar[vs])}),Nn};if(G||(Kt=function(){if(this instanceof Kt)throw TypeError("Symbol is not a constructor");var Lr=!arguments.length||arguments[0]===void 0?void 0:Se(arguments[0]),yr=mt(Lr),qt=function(Nn){this===bi&&qt.call(br,Nn),Q(this,qe)&&Q(this[qe],yr)&&(this[qe][yr]=!1),Vi(this,yr,oe(1,Nn))};return P&&li&&Vi(bi,yr,{configurable:!0,set:qt}),rr(yr,Lr)},Qt(Kt[Pt],"toString",function(){return yi(this).tag}),Qt(Kt,"withoutSetter",function(zn){return rr(mt(zn),zn)}),bt.f=io,Ye.f=qr,et.f=Ur,Be.f=Pe.f=ta,De.f=As,rt.f=function(zn){return rr(Ct(zn),zn)},P&&(Ri(Kt[Pt],"description",{configurable:!0,get:function(){return yi(this).description}}),R||Qt(bi,"propertyIsEnumerable",io,{unsafe:!0}))),B({global:!0,wrap:!0,forced:!G,sham:!G},{Symbol:Kt}),Ai(Me(Qr),function(zn){Bt(zn)}),B({target:Ke,stat:!0,forced:!G},{for:function(zn){var Lr=Se(zn);if(Q(Dr,Lr))return Dr[Lr];var yr=Kt(Lr);return Dr[Lr]=yr,Fr[yr]=Lr,yr},keyFor:function(Lr){if(!re(Lr))throw TypeError(Lr+" is not a symbol");if(Q(Fr,Lr))return Fr[Lr]},useSetter:function(){li=!0},useSimple:function(){li=!1}}),B({target:"Object",stat:!0,forced:!G,sham:!P},{create:Zr,defineProperty:qr,defineProperties:_r,getOwnPropertyDescriptor:Ur}),B({target:"Object",stat:!0,forced:!G},{getOwnPropertyNames:ta,getOwnPropertySymbols:As}),B({target:"Object",stat:!0,forced:U(function(){De.f(1)})},{getOwnPropertySymbols:function(Lr){return De.f(fe(Lr))}}),di){var ro=!G||U(function(){var zn=Kt();return di([zn])!="[null]"||di({a:zn})!="{}"||di(Object(zn))!="{}"});B({target:"JSON",stat:!0,forced:ro},{stringify:function(Lr,yr,qt){for(var Nn=[Lr],vs=1,ia;arguments.length>vs;)Nn.push(arguments[vs++]);if(ia=yr,!(!ne(yr)&&Lr===void 0||re(Lr)))return q(yr)||(yr=function(dn,St){if(typeof ia=="function"&&(St=ia.call(this,dn,St)),!re(St))return St}),Nn[1]=yr,di.apply(null,Nn)}})}Kt[Pt][It]||pt(Kt[Pt],It,Kt[Pt].valueOf),tt(Kt,Ke),ut[qe]=!0},"./node_modules/core-js/modules/web.dom-collections.for-each.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/dom-iterables.js"),E=x("./node_modules/core-js/internals/array-for-each.js"),R=x("./node_modules/core-js/internals/create-non-enumerable-property.js");for(var P in T){var G=B[P],U=G&&G.prototype;if(U&&U.forEach!==E)try{R(U,"forEach",E)}catch{U.forEach=E}}},"./node_modules/core-js/modules/web.dom-collections.iterator.js":function(y,b,x){var B=x("./node_modules/core-js/internals/global.js"),T=x("./node_modules/core-js/internals/dom-iterables.js"),E=x("./node_modules/core-js/modules/es.array.iterator.js"),R=x("./node_modules/core-js/internals/create-non-enumerable-property.js"),P=x("./node_modules/core-js/internals/well-known-symbol.js"),G=P("iterator"),U=P("toStringTag"),Q=E.values;for(var q in T){var ne=B[q],re=ne&&ne.prototype;if(re){if(re[G]!==Q)try{R(re,G,Q)}catch{re[G]=Q}if(re[U]||R(re,U,q),T[q]){for(var pe in E)if(re[pe]!==E[pe])try{R(re,pe,E[pe])}catch{re[pe]=E[pe]}}}}},"./node_modules/es6-promise/dist/es6-promise.js":function(y){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(b,x){y.exports=x()})(this,function(){function b(ui){var li=typeof ui;return ui!==null&&(li==="object"||li==="function")}function x(ui){return typeof ui=="function"}var B=void 0;Array.isArray?B=Array.isArray:B=function(ui){return Object.prototype.toString.call(ui)==="[object Array]"};var T=B,E=0,R=void 0,P=void 0,G=function(li,Vi){Me[E]=li,Me[E+1]=Vi,E+=2,E===2&&(P?P(Be):De())};function U(ui){P=ui}function Q(ui){G=ui}var q=typeof window<"u"?window:void 0,ne=q||{},re=ne.MutationObserver||ne.WebKitMutationObserver,pe=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",fe=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function he(){return function(){return process.nextTick(Be)}}function be(){return typeof R<"u"?function(){R(Be)}:ye()}function Se(){var ui=0,li=new re(Be),Vi=document.createTextNode("");return li.observe(Vi,{characterData:!0}),function(){Vi.data=ui=++ui%2}}function oe(){var ui=new MessageChannel;return ui.port1.onmessage=Be,function(){return ui.port2.postMessage(0)}}function ye(){var ui=setTimeout;return function(){return ui(Be,1)}}var Me=new Array(1e3);function Be(){for(var ui=0;ui<E;ui+=2){var li=Me[ui],Vi=Me[ui+1];li(Vi),Me[ui]=void 0,Me[ui+1]=void 0}E=0}function Pe(){try{var ui=Function("return this")().require("vertx");return R=ui.runOnLoop||ui.runOnContext,be()}catch{return ye()}}var De=void 0;pe?De=he():re?De=Se():fe?De=oe():q===void 0?De=Pe():De=ye();function et(ui,li){var Vi=this,rr=new this.constructor(pt);rr[bt]===void 0&&di(rr);var qr=Vi._state;if(qr){var _r=arguments[qr-1];G(function(){return Ze(qr,rr,_r,Vi._result)})}else Pt(Vi,rr,ui,li);return rr}function Ye(ui){var li=this;if(ui&&typeof ui=="object"&&ui.constructor===li)return ui;var Vi=new li(pt);return Ut(Vi,ui),Vi}var bt=Math.random().toString(36).substring(2);function pt(){}var Qt=void 0,Ie=1,ot=2;function ut(){return new TypeError("You cannot resolve a promise with itself")}function mt(){return new TypeError("A promises callback cannot return that same promise.")}function Ct(ui,li,Vi,rr){try{ui.call(li,Vi,rr)}catch(qr){return qr}}function rt(ui,li,Vi){G(function(rr){var qr=!1,_r=Ct(Vi,li,function(Zr){qr||(qr=!0,li!==Zr?Ut(rr,Zr):qe(rr,Zr))},function(Zr){qr||(qr=!0,Ke(rr,Zr))},"Settle: "+(rr._label||" unknown promise"));!qr&&_r&&(qr=!0,Ke(rr,_r))},ui)}function Bt(ui,li){li._state===Ie?qe(ui,li._result):li._state===ot?Ke(ui,li._result):Pt(li,void 0,function(Vi){return Ut(ui,Vi)},function(Vi){return Ke(ui,Vi)})}function tt(ui,li,Vi){li.constructor===ui.constructor&&Vi===et&&li.constructor.resolve===Ye?Bt(ui,li):Vi===void 0?qe(ui,li):x(Vi)?rt(ui,li,Vi):qe(ui,li)}function Ut(ui,li){if(ui===li)Ke(ui,ut());else if(b(li)){var Vi=void 0;try{Vi=li.then}catch(rr){Ke(ui,rr);return}tt(ui,li,Vi)}else qe(ui,li)}function Ai(ui){ui._onerror&&ui._onerror(ui._result),It(ui)}function qe(ui,li){ui._state===Qt&&(ui._result=li,ui._state=Ie,ui._subscribers.length!==0&&G(It,ui))}function Ke(ui,li){ui._state===Qt&&(ui._state=ot,ui._result=li,G(Ai,ui))}function Pt(ui,li,Vi,rr){var qr=ui._subscribers,_r=qr.length;ui._onerror=null,qr[_r]=li,qr[_r+Ie]=Vi,qr[_r+ot]=rr,_r===0&&ui._state&&G(It,ui)}function It(ui){var li=ui._subscribers,Vi=ui._state;if(li.length!==0){for(var rr=void 0,qr=void 0,_r=ui._result,Zr=0;Zr<li.length;Zr+=3)rr=li[Zr],qr=li[Zr+Vi],rr?Ze(Vi,rr,qr,_r):qr(_r);ui._subscribers.length=0}}function Ze(ui,li,Vi,rr){var qr=x(Vi),_r=void 0,Zr=void 0,io=!0;if(qr){try{_r=Vi(rr)}catch(Ur){io=!1,Zr=Ur}if(li===_r){Ke(li,mt());return}}else _r=rr;li._state!==Qt||(qr&&io?Ut(li,_r):io===!1?Ke(li,Zr):ui===Ie?qe(li,_r):ui===ot&&Ke(li,_r))}function yi(ui,li){try{li(function(rr){Ut(ui,rr)},function(rr){Ke(ui,rr)})}catch(Vi){Ke(ui,Vi)}}var bi=0;function Kt(){return bi++}function di(ui){ui[bt]=bi++,ui._state=void 0,ui._result=void 0,ui._subscribers=[]}function pi(){return new Error("Array Methods must be provided an Array")}var Ri=function(){function ui(li,Vi){this._instanceConstructor=li,this.promise=new li(pt),this.promise[bt]||di(this.promise),T(Vi)?(this.length=Vi.length,this._remaining=Vi.length,this._result=new Array(this.length),this.length===0?qe(this.promise,this._result):(this.length=this.length||0,this._enumerate(Vi),this._remaining===0&&qe(this.promise,this._result))):Ke(this.promise,pi())}return ui.prototype._enumerate=function(Vi){for(var rr=0;this._state===Qt&&rr<Vi.length;rr++)this._eachEntry(Vi[rr],rr)},ui.prototype._eachEntry=function(Vi,rr){var qr=this._instanceConstructor,_r=qr.resolve;if(_r===Ye){var Zr=void 0,io=void 0,Ur=!1;try{Zr=Vi.then}catch(As){Ur=!0,io=As}if(Zr===et&&Vi._state!==Qt)this._settledAt(Vi._state,rr,Vi._result);else if(typeof Zr!="function")this._remaining--,this._result[rr]=Vi;else if(qr===Fr){var ta=new qr(pt);Ur?Ke(ta,io):tt(ta,Vi,Zr),this._willSettleAt(ta,rr)}else this._willSettleAt(new qr(function(As){return As(Vi)}),rr)}else this._willSettleAt(_r(Vi),rr)},ui.prototype._settledAt=function(Vi,rr,qr){var _r=this.promise;_r._state===Qt&&(this._remaining--,Vi===ot?Ke(_r,qr):this._result[rr]=qr),this._remaining===0&&qe(_r,this._result)},ui.prototype._willSettleAt=function(Vi,rr){var qr=this;Pt(Vi,void 0,function(_r){return qr._settledAt(Ie,rr,_r)},function(_r){return qr._settledAt(ot,rr,_r)})},ui}();function Oi(ui){return new Ri(this,ui).promise}function Ji(ui){var li=this;return T(ui)?new li(function(Vi,rr){for(var qr=ui.length,_r=0;_r<qr;_r++)li.resolve(ui[_r]).then(Vi,rr)}):new li(function(Vi,rr){return rr(new TypeError("You must pass an array to race."))})}function ar(ui){var li=this,Vi=new li(pt);return Ke(Vi,ui),Vi}function br(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Dr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Fr=function(){function ui(li){this[bt]=Kt(),this._result=this._state=void 0,this._subscribers=[],pt!==li&&(typeof li!="function"&&br(),this instanceof ui?yi(this,li):Dr())}return ui.prototype.catch=function(Vi){return this.then(null,Vi)},ui.prototype.finally=function(Vi){var rr=this,qr=rr.constructor;return x(Vi)?rr.then(function(_r){return qr.resolve(Vi()).then(function(){return _r})},function(_r){return qr.resolve(Vi()).then(function(){throw _r})}):rr.then(Vi,Vi)},ui}();Fr.prototype.then=et,Fr.all=Oi,Fr.race=Ji,Fr.resolve=Ye,Fr.reject=ar,Fr._setScheduler=U,Fr._setAsap=Q,Fr._asap=G;function Qr(){var ui=void 0;if(typeof J0<"u")ui=J0;else if(typeof self<"u")ui=self;else try{ui=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var li=ui.Promise;if(li){var Vi=null;try{Vi=Object.prototype.toString.call(li.resolve())}catch{}if(Vi==="[object Promise]"&&!li.cast)return}ui.Promise=Fr}return Fr.polyfill=Qr,Fr.Promise=Fr,Fr})},html2canvas:function(y){y.exports=s},jspdf:function(y){y.exports=i}},d={};function A(y){var b=d[y];if(b!==void 0)return b.exports;var x=d[y]={exports:{}};return c[y].call(x.exports,x,x.exports,A),x.exports}(function(){A.n=function(y){var b=y&&y.__esModule?function(){return y.default}:function(){return y};return A.d(b,{a:b}),b}})(),function(){A.d=function(y,b){for(var x in b)A.o(b,x)&&!A.o(y,x)&&Object.defineProperty(y,x,{enumerable:!0,get:b[x]})}}(),function(){A.o=function(y,b){return Object.prototype.hasOwnProperty.call(y,b)}}(),function(){A.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})}}();var r={};return function(){/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/A.r(r);var y=A("./src/worker.js");A("./src/plugin/jspdf-plugin.js"),A("./src/plugin/pagebreaks.js"),A("./src/plugin/hyperlinks.js");var b=function x(B,T){var E=new x.Worker(T);return B?E.from(B).save():E};b.Worker=y.default,r.default=b}(),r=r.default,r}()})}(ub)),ub.exports}var LU=FU();const MU=N1(LU),PU={class:"estadisticas-dashboard"},kU={class:"barra-controles"},RU={class:"controles"},DU={class:"rango-fechas"},OU={class:"kpi-grid"},UU={class:"valor"},zU={class:"descripcion"},NU={class:"graficos"},jU={__name:"Estadisticas",setup(a){const e=fr("energia"),i=fr(Mo().subtract(7,"day").format("YYYY-MM-DD")),s=fr(Mo().format("YYYY-MM-DD")),c=[{value:"energia",label:"Energa activa (kWh)",unidad:"kWh"},{value:"voltajeA",label:"Voltaje A (V)",unidad:"V"},{value:"corrienteB",label:"Corriente B (A)",unidad:"A"},{value:"potenciaTotal",label:"Potencia activa total (kW)",unidad:"kW"}],d=fr("kWh"),A=fr({}),r=fr({options:{},series:[]}),y=fr({options:{},series:[]}),b=fr({options:{},series:[]}),x=fr({options:{},series:[]}),B=fr({options:{},series:[]}),T=fr({options:{},series:[]});function E(){const U=[["Mtrica","Valor"]];for(const pe in A.value)U.push([A.value[pe].desc,A.value[pe].label]);const Q=U.map(pe=>pe.join(",")).join(`
`),q=new Blob([Q],{type:"text/csv"}),ne=URL.createObjectURL(q),re=document.createElement("a");re.href=ne,re.download=`estadisticas_${e.value}.csv`,re.click(),URL.revokeObjectURL(ne)}function R(){const U=document.querySelector(".estadisticas-dashboard");MU().set({margin:.5,filename:`estadisticas_${e.value}.pdf`,html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).from(U).save()}function P(){var ne,re,pe,fe;const U=parseFloat(((ne=A.value.p95)==null?void 0:ne.label)||0),Q=parseFloat(((re=A.value.prom)==null?void 0:re.label)||0),q=parseFloat(((fe=(pe=A.value.factorCarga)==null?void 0:pe.label)==null?void 0:fe.replace("%",""))||0);U>Q*1.5?alert(" Advertencia: el parmetro muestra picos estadsticos elevados. Verifica anomalas o sobrecargas."):q<40?alert(" Bajo factor de carga: podras optimizar la distribucin del consumo."):alert(" El comportamiento estadstico del parmetro es estable.")}function G(){const U=c.find(be=>be.value===e.value);d.value=U.unidad;const Q=Array.from({length:100},()=>+(Math.random()*40+10).toFixed(1)).sort((be,Se)=>be-Se),q=Q.reduce((be,Se)=>be+Se,0),ne=+(q/Q.length).toFixed(1),re=Q[0],pe=Q[Q.length-1],fe=Q[Math.floor(.05*Q.length)],he=Q[Math.floor(.95*Q.length)];A.value={min:{label:`${re}`,desc:"Mnimo observado"},max:{label:`${pe}`,desc:"Mximo observado"},prom:{label:`${ne}`,desc:"Promedio del periodo"},p95:{label:`${he}`,desc:"Percentil 95"},p5:{label:`${fe}`,desc:"Percentil 5"},total:{label:`${+q.toFixed(1)}`,desc:"Total del periodo"},pico:{label:`${pe}`,desc:`Pico simulado a las ${Math.floor(Math.random()*24)}:00`},cargaBase:{label:`${fe}`,desc:"Carga base estimada"},factorCarga:{label:`${+(ne/pe*100).toFixed(0)}%`,desc:"Factor carga estimado"}},r.value={options:{chart:{id:"histograma"},xaxis:{categories:Q.slice(0,20).map((be,Se)=>`Val ${Se}`)},title:{text:"Distribucin de frecuencias"}},series:[{name:"Frecuencia",data:Q.slice(0,20)}]},y.value={options:{chart:{id:"gauss"},title:{text:"Distribucin tipo Gauss simulada"},xaxis:{type:"numeric"}},series:[{name:"Probabilidad",data:Q.map((be,Se)=>[Se,be])}]},b.value={options:{chart:{stacked:!0},title:{text:"Consumo por dispositivo simulado"},xaxis:{categories:["Zona A","Zona B","Zona C"]}},series:[{name:"Medidor 1",data:[20,35,40]},{name:"Medidor 2",data:[25,30,28]}]},x.value={options:{labels:["Eficiencia"],title:{text:"Cumplimiento"}},series:[+(ne/60*100).toFixed(0)]},B.value={options:{chart:{type:"bar"},title:{text:"Valor vs Meta (Bullet)"},xaxis:{categories:["Objetivo"]}},series:[{name:"Actual",data:[ne]}]},T.value={options:{chart:{type:"line"},xaxis:{categories:Array.from({length:24},(be,Se)=>`${Se}h`)},title:{text:"Distribucin horaria simulada"}},series:[{name:U.label,data:Array.from({length:24},()=>+(Math.random()*20+10).toFixed(1))}]}}return G(),(U,Q)=>{const q=Gy("ApexChart");return os(),Hs("div",PU,[Tt("header",kU,[Q[5]||(Q[5]=Tt("h2",null,"Estadsticas energticas",-1)),Tt("div",RU,[$n(sg,{modelValue:e.value,"onUpdate:modelValue":Q[0]||(Q[0]=ne=>e.value=ne),label:"Parmetro",options:c},null,8,["modelValue"]),Tt("div",DU,[Q[3]||(Q[3]=Tt("label",null,"Desde",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":Q[1]||(Q[1]=ne=>i.value=ne)},null,512),[[Yl,i.value]]),Q[4]||(Q[4]=Tt("label",null,"Hasta",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":Q[2]||(Q[2]=ne=>s.value=ne)},null,512),[[Yl,s.value]])]),Tt("button",{onClick:G},"Analizar"),Tt("button",{onClick:E},"Exportar CSV"),Tt("button",{onClick:R},"Exportar PDF"),Tt("button",{onClick:P},"Ver recomendaciones")])]),Tt("section",OU,[(os(!0),Hs(Mc,null,xp(A.value,(ne,re)=>(os(),Hs("div",{class:"kpi",key:re},[Tt("div",UU,$s(ne.label),1),Tt("div",zU,$s(ne.desc),1)]))),128))]),Tt("section",NU,[$n(q,{type:"bar",height:"300",options:r.value.options,series:r.value.series},null,8,["options","series"]),$n(q,{type:"area",height:"300",options:y.value.options,series:y.value.series},null,8,["options","series"]),$n(q,{type:"bar",height:"300",options:b.value.options,series:b.value.series},null,8,["options","series"]),$n(q,{type:"radialBar",height:"300",options:x.value.options,series:x.value.series},null,8,["options","series"]),$n(q,{type:"bullet",height:"100",options:B.value.options,series:B.value.series},null,8,["options","series"]),$n(q,{type:"line",height:"300",options:T.value.options,series:T.value.series},null,8,["options","series"])])])}}},HU=Uc(jU,[["__scopeId","data-v-22de458d"]]),QU={class:"dashboard-factor-carga"},VU={class:"header"},GU={class:"controls"},WU={class:"trend-chart"},XU={class:"metrics-table"},YU={class:"factor-carga"},KU={__name:"FactorCarga",setup(a){const e=fr(Mo().subtract(7,"day").format("YYYY-MM-DD")),i=fr(Mo().format("YYYY-MM-DD")),s=fr(0),c=fr(0),d=fr(0),A=fr(0),r=fr([]),y=fr({chart:{id:"trend-factor-carga"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},yaxis:{title:{text:"Factor de Carga (%)"},min:0,max:100},title:{text:"Tendencia del Factor de Carga"}});function b(){const x=Mo(e.value),T=Mo(i.value).diff(x,"day")+1;s.value=+(Math.random()*1e3+500).toFixed(1),c.value=+(Math.random()*30+20).toFixed(1),d.value=+(Math.random()*15+10).toFixed(1),A.value=+(d.value/c.value*100).toFixed(0);const E=[];for(let R=0;R<T;R++){const P=x.add(R,"day"),G=+(Math.random()*50+50).toFixed(0);E.push({x:P.valueOf(),y:G})}r.value=[{name:"Factor de Carga",data:E}]}return b(),(x,B)=>{const T=Gy("ApexChart");return os(),Hs("div",QU,[Tt("header",VU,[B[4]||(B[4]=Tt("h2",null,"Dashboard de Factor de Carga",-1)),Tt("div",GU,[B[2]||(B[2]=Tt("label",null,"Desde:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":B[0]||(B[0]=E=>e.value=E)},null,512),[[Yl,e.value]]),B[3]||(B[3]=Tt("label",null,"Hasta:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":B[1]||(B[1]=E=>i.value=E)},null,512),[[Yl,i.value]]),Tt("button",{onClick:b},"Analizar")])]),Tt("section",WU,[B[5]||(B[5]=Tt("h3",null,"Tendencia del Factor de Carga",-1)),$n(T,{type:"line",height:"300",options:y.value,series:r.value},null,8,["options","series"])]),Tt("section",XU,[B[11]||(B[11]=Tt("h3",null,"Mtricas del Periodo",-1)),Tt("table",null,[B[10]||(B[10]=Tt("thead",null,[Tt("tr",null,[Tt("th",null,"Mtrica"),Tt("th",null,"Valor")])],-1)),Tt("tbody",null,[Tt("tr",null,[B[6]||(B[6]=Tt("td",null,"Total de Energa Consumida",-1)),Tt("td",null,$s(s.value)+" kWh",1)]),Tt("tr",null,[B[7]||(B[7]=Tt("td",null,"Demanda Mxima",-1)),Tt("td",null,$s(c.value)+" kW",1)]),Tt("tr",null,[B[8]||(B[8]=Tt("td",null,"Demanda Promedio",-1)),Tt("td",null,$s(d.value)+" kW",1)]),Tt("tr",null,[B[9]||(B[9]=Tt("td",null,"Factor de Carga",-1)),Tt("td",YU,$s(A.value)+"%",1)])])])])])}}},qU=Uc(KU,[["__scopeId","data-v-44ac7c83"]]),$U={class:"dashboard-patrones"},ZU={class:"header"},JU={class:"controls"},ez={class:"section-chart"},tz={class:"section-chart"},iz={class:"section-chart"},rz={class:"section-chart"},nz={class:"insights"},sz={__name:"Patrones",setup(a){const e=fr("energia"),i=fr(Mo().subtract(30,"day").format("YYYY-MM-DD")),s=fr(Mo().format("YYYY-MM-DD")),c=Dh(()=>{switch(e.value){case"energia":return"Energa";case"potencia":return"Potencia";case"voltaje":return"Voltaje";case"corriente":return"Corriente";default:return e.value}});let d=[];function A(){const ne=Mo(i.value),pe=Mo(s.value).diff(ne,"day")+1;d=[];for(let fe=0;fe<pe;fe++){const he=e.value==="energia"?100:e.value==="potencia"?50:e.value==="voltaje"?220:e.value==="corriente"?30:0,be=Math.random()*he*.2-he*.1,Se=+(he+be).toFixed(1),oe=ne.add(fe,"day").valueOf();d.push({timestamp:oe,value:Se})}}A();const r=fr([{name:c.value,data:d.map(ne=>({x:ne.timestamp,y:ne.value}))}]),y=fr({chart:{id:"historical-trend"},xaxis:{type:"datetime"},title:{text:`Tendencia Histrica de ${c.value}`}}),b=fr([{name:"Trend",data:d.map(ne=>({x:ne.timestamp,y:+(ne.value*.9).toFixed(1)}))},{name:"Seasonal",data:d.map((ne,re)=>({x:ne.timestamp,y:+(10*Math.sin(re)).toFixed(1)}))},{name:"Residual",data:d.map((ne,re)=>({x:ne.timestamp,y:+(ne.value-ne.value*.9-10*Math.sin(re)).toFixed(1)}))}]),x=fr({chart:{id:"decomposition-chart"},xaxis:{type:"datetime"},title:{text:"Descomposicin Temporal"}}),B=[[1,.8,.5,.3],[.8,1,.4,.35],[.5,.4,1,.6],[.3,.35,.6,1]],T=["Energa","Potencia","Voltaje","Corriente"],E=fr(T.map((ne,re)=>({name:ne,data:B[re].map((pe,fe)=>({x:T[fe],y:pe}))}))),R=fr({chart:{id:"correlation-heatmap"},title:{text:"Matriz de Correlacin"},plotOptions:{heatmap:{shadeIntensity:.5,colorScale:{ranges:[{from:0,to:.4,color:"#FF3333"},{from:.4,to:.7,color:"#FFCC33"},{from:.7,to:1,color:"#00E396"}]}}},dataLabels:{enabled:!0}}),P=fr([{name:"Forecast",data:[]}]),G=fr({chart:{id:"forecast-chart"},xaxis:{type:"datetime"},title:{text:`Prediccin Avanzada de ${c.value}`}});function U(){const ne=d[d.length-1].timestamp,re=[];for(let pe=1;pe<=7;pe++){const fe=+(d.reduce((he,be)=>he+be.value,0)/d.length*(1+Math.random()*.1-.05)).toFixed(1);re.push({x:Mo(ne).add(pe,"day").valueOf(),y:fe})}P.value=[{name:"Forecast",data:re}]}U();const Q=fr([{titulo:"Tendencia Creciente",descripcion:`El ${c.value} muestra un crecimiento sostenido durante el periodo analizado.`},{titulo:"Patrn Estacional",descripcion:"Se observa un patrn estacional con fl uctuaciones regulares cada semana."},{titulo:"Anomala Detectada",descripcion:`Un pico atpico se registr el da ${Mo(d[Math.floor(d.length/2)].timestamp).format("YYYY-MM-DD")}.`},{titulo:"Buena Correlacin",descripcion:`El ${c.value} presenta alta correlacin con Potencia (coeficiente 0.8).`}]);function q(){A(),r.value=[{name:c.value,data:d.map(ne=>({x:ne.timestamp,y:ne.value}))}],y.value.title.text=`Tendencia Histrica de ${c.value}`,b.value=[{name:"Trend",data:d.map(ne=>({x:ne.timestamp,y:+(ne.value*.9).toFixed(1)}))},{name:"Seasonal",data:d.map((ne,re)=>({x:ne.timestamp,y:+(10*Math.sin(re)).toFixed(1)}))},{name:"Residual",data:d.map((ne,re)=>({x:ne.timestamp,y:+(ne.value-ne.value*.9-10*Math.sin(re)).toFixed(1)}))}],U(),Q.value=[{titulo:"Tendencia Creciente",descripcion:`El ${c.value} muestra un crecimiento sostenido durante el periodo.`},{titulo:"Patrn Estacional",descripcion:"Se observa un patrn estacional con fl uctuaciones regulares cada semana."},{titulo:"Anomala Detectada",descripcion:`Pico atpico registrado el da ${Mo(d[Math.floor(d.length/2)].timestamp).format("YYYY-MM-DD")}.`},{titulo:"Buena Correlacin",descripcion:`${c.value} presenta alta correlacin con Potencia (coeficiente 0.8).`}]}return(ne,re)=>(os(),Hs("div",$U,[Tt("header",ZU,[re[7]||(re[7]=Tt("h2",null,"Dashboard Histricos de Anlisis de Patrones de Parmetros",-1)),Tt("div",JU,[re[4]||(re[4]=Tt("label",null,"Parmetro:",-1)),fa(Tt("select",{"onUpdate:modelValue":re[0]||(re[0]=pe=>e.value=pe)},re[3]||(re[3]=[Tt("option",{value:"energia"},"Energa (kWh)",-1),Tt("option",{value:"potencia"},"Potencia (kW)",-1),Tt("option",{value:"voltaje"},"Voltaje (V)",-1),Tt("option",{value:"corriente"},"Corriente (A)",-1)]),512),[[r_,e.value]]),re[5]||(re[5]=Tt("label",null,"Desde:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":re[1]||(re[1]=pe=>i.value=pe)},null,512),[[Yl,i.value]]),re[6]||(re[6]=Tt("label",null,"Hasta:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":re[2]||(re[2]=pe=>s.value=pe)},null,512),[[Yl,s.value]]),Tt("button",{onClick:q},"Analizar")])]),Tt("section",ez,[Tt("h3",null,"Tendencia Histrica del "+$s(c.value),1),$n(Aa(Ka),{type:"line",height:"300",options:y.value,series:r.value},null,8,["options","series"])]),Tt("section",tz,[re[8]||(re[8]=Tt("h3",null,"Descomposicin de Series Temporales",-1)),$n(Aa(Ka),{type:"line",height:"300",options:x.value,series:b.value},null,8,["options","series"])]),Tt("section",iz,[re[9]||(re[9]=Tt("h3",null,"Anlisis de Correlacin de Parmetros",-1)),$n(Aa(Ka),{type:"heatmap",height:"300",options:R.value,series:E.value},null,8,["options","series"])]),Tt("section",rz,[Tt("h3",null,"Prediccin AI Avanzada del "+$s(c.value),1),$n(Aa(Ka),{type:"area",height:"300",options:G.value,series:P.value},null,8,["options","series"])]),Tt("section",nz,[re[11]||(re[11]=Tt("h3",null,"Insights Generados por AI",-1)),Tt("table",null,[re[10]||(re[10]=Tt("thead",null,[Tt("tr",null,[Tt("th",null,"Insight"),Tt("th",null,"Descripcin")])],-1)),Tt("tbody",null,[(os(!0),Hs(Mc,null,xp(Q.value,(pe,fe)=>(os(),Hs("tr",{key:fe},[Tt("td",null,$s(pe.titulo),1),Tt("td",null,$s(pe.descripcion),1)]))),128))])])])]))}},oz=Uc(sz,[["__scopeId","data-v-ba059950"]]),az={class:"dashboard-consumo-avanzado"},lz={class:"header"},cz={class:"controls"},uz={class:"kpi-panel"},hz={class:"card"},dz={class:"value"},Az={class:"card"},fz={class:"value"},pz={class:"card"},gz={class:"value"},mz={class:"card"},yz={class:"value"},vz={class:"card"},_z={class:"value"},xz={class:"card"},bz={class:"value"},wz={class:"charts"},Bz={class:"chart-item"},Cz={class:"chart-item"},Sz={class:"chart-item"},Ez={class:"chart-item"},Tz={class:"chart-item"},Iz={class:"chart-item"},Fz={class:"chart-item"},Lz={__name:"ConsumoEnergetico",setup(a){const e=fr(Mo().subtract(7,"day").format("YYYY-MM-DD")),i=fr(Mo().format("YYYY-MM-DD")),s=fr(0),c=fr(0),d=fr(0),A=fr(0),r=fr(0),y=fr(0),b=fr([]),x=fr({chart:{id:"trend-chart"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},title:{text:"Tendencia de Consumo (EMA)"}}),B=fr([]),T=fr({chart:{id:"hist-chart"},xaxis:{categories:[]},title:{text:"Histograma del Consumo"}}),E=fr([]),R=fr({chart:{id:"forecast-chart"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},title:{text:"Forecast para Prximas 24 Horas"}}),P=fr([]),G=fr({chart:{id:"boxplot-chart"},title:{text:"Box Plot Diario"}}),U=fr([]),Q=fr({chart:{id:"heatmap-chart"},plotOptions:{heatmap:{shadeIntensity:.5,radius:4}},dataLabels:{enabled:!1},xaxis:{type:"category",categories:Array.from({length:24},(he,be)=>`${be}h`)},title:{text:"Heatmap de Consumo por Hora"}}),q=fr([]),ne=fr({chart:{id:"scatter-chart"},xaxis:{title:{text:"Tiempo"}},yaxis:{title:{text:"Consumo (kWh)"}},title:{text:"Scatter de Outliers"}}),re=fr([]),pe=fr({chart:{id:"daily-bar-chart",type:"bar"},xaxis:{categories:[]},title:{text:"Consumo Diario (kWh)"}});function fe(){const he=Mo(e.value),Se=Mo(i.value).diff(he,"day")+1,oe=[];for(let tt=0;tt<Se;tt++)for(let Ut=0;Ut<24;Ut++){const Ai=he.add(tt,"day").hour(Ut).minute(0).second(0).valueOf(),qe=+(50+(Math.random()*30-15)).toFixed(1);oe.push({timestamp:Ai,value:qe})}s.value=oe.reduce((tt,Ut)=>tt+Ut.value,0).toFixed(1),c.value=(s.value/oe.length).toFixed(1),d.value=Math.max(...oe.map(tt=>tt.value)).toFixed(1);const ye=c.value,Me=oe.reduce((tt,Ut)=>tt+Math.pow(Ut.value-ye,2),0)/oe.length;A.value=Math.sqrt(Me).toFixed(1),r.value=(A.value/c.value*100).toFixed(1),y.value=(c.value*1.1).toFixed(1);const Be=oe.map(tt=>({x:tt.timestamp,y:tt.value}));let Pe=[];const et=2/(12+1);let Ye=Be[0].y;Pe.push({x:Be[0].x,y:Ye});for(let tt=1;tt<Be.length;tt++){const Ut=et*Be[tt].y+(1-et)*Ye;Pe.push({x:Be[tt].x,y:+Ut.toFixed(1)}),Ye=Ut}b.value=[{name:"Consumo Real",data:Be},{name:"EMA",data:Pe}];const bt={};oe.forEach(tt=>{const Ut=Math.floor(tt.value/5)*5;bt[Ut]=(bt[Ut]||0)+1});const pt=Object.keys(bt).sort((tt,Ut)=>tt-Ut),Qt=pt.map(tt=>bt[tt]);T.value.xaxis.categories=pt.map(tt=>`${tt}-${+tt+5}`),B.value=[{name:"Frecuencia",data:Qt}];const Ie=[],ot=oe[oe.length-1].timestamp;for(let tt=1;tt<=24;tt++)Ie.push({x:ot+tt*36e5,y:+y.value});E.value=[{name:"Forecast",data:Ie}];const ut=[];for(let tt=0;tt<Se;tt++){const Ut=oe.filter(Ai=>Mo(Ai.timestamp).isSame(he.add(tt,"day"),"day")).map(Ai=>Ai.value);ut.push(Ut)}P.value=ut.map((tt,Ut)=>{tt.sort((Ze,yi)=>Ze-yi);const Ai=tt[Math.floor(tt.length*.25)],qe=tt[Math.floor(tt.length*.5)],Ke=tt[Math.floor(tt.length*.75)],Pt=tt[0],It=tt[tt.length-1];return{x:he.add(Ut,"day").format("YYYY-MM-DD"),y:[Pt,Ai,qe,Ke,It]}});const mt=[],Ct=Math.min(Se,7);for(let tt=0;tt<Ct;tt++){const Ut=[];for(let Ai=0;Ai<24;Ai++){const qe=oe.filter(Ke=>Mo(Ke.timestamp).isSame(he.add(tt,"day"),"day")&&Mo(Ke.timestamp).hour()===Ai&&Ke.value>60).length;Ut.push({x:`${Ai}h`,y:qe})}mt.push({name:`Da ${tt+1}`,data:Ut})}U.value=mt;const rt=oe.filter(tt=>tt.value>ye+2*A.value||tt.value<ye-2*A.value).map(tt=>({x:tt.timestamp,y:tt.value}));q.value=[{name:"Outliers",data:rt}];const Bt=[];for(let tt=0;tt<Se;tt++){const Ut=oe.filter(Ai=>Mo(Ai.timestamp).isSame(he.add(tt,"day"),"day")).reduce((Ai,qe)=>Ai+qe.value,0);Bt.push(+Ut.toFixed(1))}re.value=[{name:"Consumo Diario",data:Bt}],pe.value.xaxis.categories=Array.from({length:Se},(tt,Ut)=>he.add(Ut,"day").format("YYYY-MM-DD"))}return fe(),(he,be)=>(os(),Hs("div",az,[Tt("header",lz,[be[4]||(be[4]=Tt("h2",null,"Dashboard de Consumo de Energa Avanzado",-1)),Tt("div",cz,[be[2]||(be[2]=Tt("label",null,"Desde:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":be[0]||(be[0]=Se=>e.value=Se)},null,512),[[Yl,e.value]]),be[3]||(be[3]=Tt("label",null,"Hasta:",-1)),fa(Tt("input",{type:"date","onUpdate:modelValue":be[1]||(be[1]=Se=>i.value=Se)},null,512),[[Yl,i.value]]),Tt("button",{onClick:fe},"Analizar")])]),Tt("section",uz,[Tt("div",hz,[be[5]||(be[5]=Tt("h3",null,"Total de Consumo",-1)),Tt("p",dz,$s(s.value)+" kWh",1)]),Tt("div",Az,[be[6]||(be[6]=Tt("h3",null,"Consumo Promedio",-1)),Tt("p",fz,$s(c.value)+" kWh",1)]),Tt("div",pz,[be[7]||(be[7]=Tt("h3",null,"Consumo Mximo",-1)),Tt("p",gz,$s(d.value)+" kW",1)]),Tt("div",mz,[be[8]||(be[8]=Tt("h3",null,"Desviacin Estndar",-1)),Tt("p",yz,$s(A.value)+" kWh",1)]),Tt("div",vz,[be[9]||(be[9]=Tt("h3",null,"Coeficiente de Variacin",-1)),Tt("p",_z,$s(r.value)+"%",1)]),Tt("div",xz,[be[10]||(be[10]=Tt("h3",null,"Prediccin Siguiente Da",-1)),Tt("p",bz,$s(y.value)+" kWh",1)])]),Tt("section",wz,[Tt("div",Bz,[be[11]||(be[11]=Tt("h3",null,"Tendencia con EMA",-1)),$n(Aa(Ka),{type:"line",height:"300",options:x.value,series:b.value},null,8,["options","series"])]),Tt("div",Cz,[be[12]||(be[12]=Tt("h3",null,"Histograma de Consumo",-1)),$n(Aa(Ka),{type:"bar",height:"300",options:T.value,series:B.value},null,8,["options","series"])]),Tt("div",Sz,[be[13]||(be[13]=Tt("h3",null,"Forecast 24h",-1)),$n(Aa(Ka),{type:"area",height:"300",options:R.value,series:E.value},null,8,["options","series"])]),Tt("div",Ez,[be[14]||(be[14]=Tt("h3",null,"Consumo Diario (kWh)",-1)),$n(Aa(Ka),{type:"bar",height:"300",options:pe.value,series:re.value},null,8,["options","series"])]),Tt("div",Tz,[be[15]||(be[15]=Tt("h3",null,"Box Plot Diario",-1)),$n(Aa(Ka),{type:"boxPlot",height:"300",options:G.value,series:P.value},null,8,["options","series"])]),Tt("div",Iz,[be[16]||(be[16]=Tt("h3",null,"Heatmap de Consumo por Hora",-1)),$n(Aa(Ka),{type:"heatmap",height:"300",options:Q.value,series:U.value},null,8,["options","series"])]),Tt("div",Fz,[be[17]||(be[17]=Tt("h3",null,"Scatter de Outliers",-1)),$n(Aa(Ka),{type:"scatter",height:"300",options:ne.value,series:q.value},null,8,["options","series"])])])]))}},Mz=Uc(Lz,[["__scopeId","data-v-b662e8ef"]]),Pz={class:"sidebar-header"},kz={class:"meter-list"},Rz=["onClick"],Dz={__name:"FleetSidebar",props:{meters:Array,role:String,open:Boolean},emits:["add-meter"],setup(a,{emit:e}){const i=a,s=e,c=Jk(),d=y=>{c.push(`/meter/${y}`)},A=Dh(()=>["admin","engineer"].includes(i.role)),r=()=>s("add-meter");return(y,b)=>(os(),Hs("aside",{class:yp(["sidebar",{open:a.open}])},[Tt("header",Pz,[b[0]||(b[0]=Tt("h3",null,"Mis Medidores",-1)),A.value?(os(),Hs("button",{key:0,onClick:r}," Nuevo")):t_("",!0)]),Tt("ul",kz,[(os(!0),Hs(Mc,null,xp(a.meters,x=>(os(),Hs("li",{key:x.id,onClick:B=>d(x.id),class:"meter-item"},[Tt("span",{class:yp({active:x.status==="activo"})},"",2),Fv(" "+$s(x.name),1)],8,Rz))),128))])],2))}},Oz=Uc(Dz,[["__scopeId","data-v-4cb41933"]]);var yv={exports:{}},Uz=yv.exports,kE;function zz(){return kE||(kE=1,function(a,e){(function(i,s){a.exports=s()})(Uz,function(){var i,s,c;function d(r,y){if(!i)i=y;else if(!s)s=y;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",x={};i(x),c=y(x),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}d(["exports"],function(r){var y=1e-6,b=typeof Float32Array<"u"?Float32Array:Array;function x(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=o*m-f*h;return v?(l[0]=m*(v=1/v),l[1]=-h*v,l[2]=-f*v,l[3]=o*v,l):null}function B(){var l=new b(9);return b!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function T(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=t[4],C=t[5],I=t[6],F=t[7],k=t[8];return l[0]=v*k-C*F,l[1]=f*F-h*k,l[2]=h*C-f*v,l[3]=C*I-m*k,l[4]=o*k-f*I,l[5]=f*m-o*C,l[6]=m*F-v*I,l[7]=h*I-o*F,l[8]=o*v-h*m,l}function E(l,t,o){var h=t[0],f=t[1],m=t[2],v=t[3],C=t[4],I=t[5],F=t[6],k=t[7],z=t[8],H=o[0],$=o[1],ee=o[2],ae=o[3],Ae=o[4],ve=o[5],Fe=o[6],Le=o[7],ce=o[8];return l[0]=H*h+$*v+ee*F,l[1]=H*f+$*C+ee*k,l[2]=H*m+$*I+ee*z,l[3]=ae*h+Ae*v+ve*F,l[4]=ae*f+Ae*C+ve*k,l[5]=ae*m+Ae*I+ve*z,l[6]=Fe*h+Le*v+ce*F,l[7]=Fe*f+Le*C+ce*k,l[8]=Fe*m+Le*I+ce*z,l}function R(){var l=new b(16);return b!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l}function P(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function G(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=t[4],C=t[5],I=t[6],F=t[7],k=t[8],z=t[9],H=t[10],$=t[11],ee=t[12],ae=t[13],Ae=t[14],ve=t[15],Fe=o*C-h*v,Le=o*I-f*v,ce=o*F-m*v,Ee=h*I-f*C,ke=h*F-m*C,He=f*F-m*I,gt=k*ae-z*ee,ht=k*Ae-H*ee,yt=k*ve-$*ee,Lt=z*Ae-H*ae,Wt=z*ve-$*ae,Si=H*ve-$*Ae,fi=Fe*Si-Le*Wt+ce*Lt+Ee*yt-ke*ht+He*gt;return fi?(l[0]=(C*Si-I*Wt+F*Lt)*(fi=1/fi),l[1]=(f*Wt-h*Si-m*Lt)*fi,l[2]=(ae*He-Ae*ke+ve*Ee)*fi,l[3]=(H*ke-z*He-$*Ee)*fi,l[4]=(I*yt-v*Si-F*ht)*fi,l[5]=(o*Si-f*yt+m*ht)*fi,l[6]=(Ae*ce-ee*He-ve*Le)*fi,l[7]=(k*He-H*ce+$*Le)*fi,l[8]=(v*Wt-C*yt+F*gt)*fi,l[9]=(h*yt-o*Wt-m*gt)*fi,l[10]=(ee*ke-ae*ce+ve*Fe)*fi,l[11]=(z*ce-k*ke-$*Fe)*fi,l[12]=(C*ht-v*Lt-I*gt)*fi,l[13]=(o*Lt-h*ht+f*gt)*fi,l[14]=(ae*Le-ee*Ee-Ae*Fe)*fi,l[15]=(k*Ee-z*Le+H*Fe)*fi,l):null}function U(l,t,o){var h=t[0],f=t[1],m=t[2],v=t[3],C=t[4],I=t[5],F=t[6],k=t[7],z=t[8],H=t[9],$=t[10],ee=t[11],ae=t[12],Ae=t[13],ve=t[14],Fe=t[15],Le=o[0],ce=o[1],Ee=o[2],ke=o[3];return l[0]=Le*h+ce*C+Ee*z+ke*ae,l[1]=Le*f+ce*I+Ee*H+ke*Ae,l[2]=Le*m+ce*F+Ee*$+ke*ve,l[3]=Le*v+ce*k+Ee*ee+ke*Fe,l[4]=(Le=o[4])*h+(ce=o[5])*C+(Ee=o[6])*z+(ke=o[7])*ae,l[5]=Le*f+ce*I+Ee*H+ke*Ae,l[6]=Le*m+ce*F+Ee*$+ke*ve,l[7]=Le*v+ce*k+Ee*ee+ke*Fe,l[8]=(Le=o[8])*h+(ce=o[9])*C+(Ee=o[10])*z+(ke=o[11])*ae,l[9]=Le*f+ce*I+Ee*H+ke*Ae,l[10]=Le*m+ce*F+Ee*$+ke*ve,l[11]=Le*v+ce*k+Ee*ee+ke*Fe,l[12]=(Le=o[12])*h+(ce=o[13])*C+(Ee=o[14])*z+(ke=o[15])*ae,l[13]=Le*f+ce*I+Ee*H+ke*Ae,l[14]=Le*m+ce*F+Ee*$+ke*ve,l[15]=Le*v+ce*k+Ee*ee+ke*Fe,l}function Q(l,t,o){var h,f,m,v,C,I,F,k,z,H,$,ee,ae=o[0],Ae=o[1],ve=o[2];return t===l?(l[12]=t[0]*ae+t[4]*Ae+t[8]*ve+t[12],l[13]=t[1]*ae+t[5]*Ae+t[9]*ve+t[13],l[14]=t[2]*ae+t[6]*Ae+t[10]*ve+t[14],l[15]=t[3]*ae+t[7]*Ae+t[11]*ve+t[15]):(f=t[1],m=t[2],v=t[3],C=t[4],I=t[5],F=t[6],k=t[7],z=t[8],H=t[9],$=t[10],ee=t[11],l[0]=h=t[0],l[1]=f,l[2]=m,l[3]=v,l[4]=C,l[5]=I,l[6]=F,l[7]=k,l[8]=z,l[9]=H,l[10]=$,l[11]=ee,l[12]=h*ae+C*Ae+z*ve+t[12],l[13]=f*ae+I*Ae+H*ve+t[13],l[14]=m*ae+F*Ae+$*ve+t[14],l[15]=v*ae+k*Ae+ee*ve+t[15]),l}function q(l,t,o){var h=o[0],f=o[1],m=o[2];return l[0]=t[0]*h,l[1]=t[1]*h,l[2]=t[2]*h,l[3]=t[3]*h,l[4]=t[4]*f,l[5]=t[5]*f,l[6]=t[6]*f,l[7]=t[7]*f,l[8]=t[8]*m,l[9]=t[9]*m,l[10]=t[10]*m,l[11]=t[11]*m,l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l}function ne(l,t,o){var h=Math.sin(o),f=Math.cos(o),m=t[4],v=t[5],C=t[6],I=t[7],F=t[8],k=t[9],z=t[10],H=t[11];return t!==l&&(l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[4]=m*f+F*h,l[5]=v*f+k*h,l[6]=C*f+z*h,l[7]=I*f+H*h,l[8]=F*f-m*h,l[9]=k*f-v*h,l[10]=z*f-C*h,l[11]=H*f-I*h,l}function re(l,t,o){var h=Math.sin(o),f=Math.cos(o),m=t[0],v=t[1],C=t[2],I=t[3],F=t[8],k=t[9],z=t[10],H=t[11];return t!==l&&(l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=m*f-F*h,l[1]=v*f-k*h,l[2]=C*f-z*h,l[3]=I*f-H*h,l[8]=m*h+F*f,l[9]=v*h+k*f,l[10]=C*h+z*f,l[11]=I*h+H*f,l}function pe(l,t,o){var h=Math.sin(o),f=Math.cos(o),m=t[0],v=t[1],C=t[2],I=t[3],F=t[4],k=t[5],z=t[6],H=t[7];return t!==l&&(l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=m*f+F*h,l[1]=v*f+k*h,l[2]=C*f+z*h,l[3]=I*f+H*h,l[4]=F*f-m*h,l[5]=k*f-v*h,l[6]=z*f-C*h,l[7]=H*f-I*h,l}function fe(l,t){return l[0]=t[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=t[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=t[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function he(l,t,o){var h,f,m,v=o[0],C=o[1],I=o[2],F=Math.hypot(v,C,I);return F<y?null:(v*=F=1/F,C*=F,I*=F,h=Math.sin(t),f=Math.cos(t),l[0]=v*v*(m=1-f)+f,l[1]=C*v*m+I*h,l[2]=I*v*m-C*h,l[3]=0,l[4]=v*C*m-I*h,l[5]=C*C*m+f,l[6]=I*C*m+v*h,l[7]=0,l[8]=v*I*m+C*h,l[9]=C*I*m-v*h,l[10]=I*I*m+f,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}function be(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=o+o,C=h+h,I=f+f,F=o*v,k=h*v,z=h*C,H=f*v,$=f*C,ee=f*I,ae=m*v,Ae=m*C,ve=m*I;return l[0]=1-z-ee,l[1]=k+ve,l[2]=H-Ae,l[3]=0,l[4]=k-ve,l[5]=1-F-ee,l[6]=$+ae,l[7]=0,l[8]=H+Ae,l[9]=$-ae,l[10]=1-F-z,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}Math.hypot||(Math.hypot=function(){for(var l=0,t=arguments.length;t--;)l+=arguments[t]*arguments[t];return Math.sqrt(l)});var Se=U;function oe(){var l=new b(3);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function ye(l){var t=new b(3);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t}function Me(l){return Math.hypot(l[0],l[1],l[2])}function Be(l,t,o){var h=new b(3);return h[0]=l,h[1]=t,h[2]=o,h}function Pe(l,t,o){return l[0]=t[0]+o[0],l[1]=t[1]+o[1],l[2]=t[2]+o[2],l}function De(l,t,o){return l[0]=t[0]-o[0],l[1]=t[1]-o[1],l[2]=t[2]-o[2],l}function et(l,t,o){return l[0]=t[0]*o[0],l[1]=t[1]*o[1],l[2]=t[2]*o[2],l}function Ye(l,t,o){return l[0]=Math.min(t[0],o[0]),l[1]=Math.min(t[1],o[1]),l[2]=Math.min(t[2],o[2]),l}function bt(l,t,o){return l[0]=Math.max(t[0],o[0]),l[1]=Math.max(t[1],o[1]),l[2]=Math.max(t[2],o[2]),l}function pt(l,t,o){return l[0]=t[0]*o,l[1]=t[1]*o,l[2]=t[2]*o,l}function Qt(l,t,o,h){return l[0]=t[0]+o[0]*h,l[1]=t[1]+o[1]*h,l[2]=t[2]+o[2]*h,l}function Ie(l,t){var o=t[0]-l[0],h=t[1]-l[1],f=t[2]-l[2];return o*o+h*h+f*f}function ot(l){var t=l[0],o=l[1],h=l[2];return t*t+o*o+h*h}function ut(l,t){return l[0]=-t[0],l[1]=-t[1],l[2]=-t[2],l}function mt(l,t){var o=t[0],h=t[1],f=t[2],m=o*o+h*h+f*f;return m>0&&(m=1/Math.sqrt(m)),l[0]=t[0]*m,l[1]=t[1]*m,l[2]=t[2]*m,l}function Ct(l,t){return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]}function rt(l,t,o){var h=t[0],f=t[1],m=t[2],v=o[0],C=o[1],I=o[2];return l[0]=f*I-m*C,l[1]=m*v-h*I,l[2]=h*C-f*v,l}function Bt(l,t,o,h){var f=t[0],m=t[1],v=t[2];return l[0]=f+h*(o[0]-f),l[1]=m+h*(o[1]-m),l[2]=v+h*(o[2]-v),l}function tt(l,t,o){var h=t[0],f=t[1],m=t[2],v=o[3]*h+o[7]*f+o[11]*m+o[15];return l[0]=(o[0]*h+o[4]*f+o[8]*m+o[12])/(v=v||1),l[1]=(o[1]*h+o[5]*f+o[9]*m+o[13])/v,l[2]=(o[2]*h+o[6]*f+o[10]*m+o[14])/v,l}function Ut(l,t,o){var h=t[0],f=t[1],m=t[2];return l[0]=h*o[0]+f*o[3]+m*o[6],l[1]=h*o[1]+f*o[4]+m*o[7],l[2]=h*o[2]+f*o[5]+m*o[8],l}function Ai(l,t,o){var h=o[0],f=o[1],m=o[2],v=t[0],C=t[1],I=t[2],F=f*I-m*C,k=m*v-h*I,z=h*C-f*v,H=f*z-m*k,$=m*F-h*z,ee=h*k-f*F,ae=2*o[3];return k*=ae,z*=ae,$*=2,ee*=2,l[0]=v+(F*=ae)+(H*=2),l[1]=C+k+$,l[2]=I+z+ee,l}function qe(l,t){return l[0]===t[0]&&l[1]===t[1]&&l[2]===t[2]}var Ke=De,Pt=et,It=Me;function Ze(){var l=new b(4);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0),l}function yi(l,t,o){return l[0]=t[0]*o,l[1]=t[1]*o,l[2]=t[2]*o,l[3]=t[3]*o,l}function bi(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=o*o+h*h+f*f+m*m;return v>0&&(v=1/Math.sqrt(v)),l[0]=o*v,l[1]=h*v,l[2]=f*v,l[3]=m*v,l}function Kt(l,t,o){var h=t[0],f=t[1],m=t[2],v=t[3];return l[0]=o[0]*h+o[4]*f+o[8]*m+o[12]*v,l[1]=o[1]*h+o[5]*f+o[9]*m+o[13]*v,l[2]=o[2]*h+o[6]*f+o[10]*m+o[14]*v,l[3]=o[3]*h+o[7]*f+o[11]*m+o[15]*v,l}function di(){var l=new b(4);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function pi(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function Ri(l,t,o){o*=.5;var h=t[0],f=t[1],m=t[2],v=t[3],C=Math.sin(o),I=Math.cos(o);return l[0]=h*I+v*C,l[1]=f*I+m*C,l[2]=m*I-f*C,l[3]=v*I-h*C,l}function Oi(l,t,o){o*=.5;var h=t[0],f=t[1],m=t[2],v=t[3],C=Math.sin(o),I=Math.cos(o);return l[0]=h*I-m*C,l[1]=f*I+v*C,l[2]=m*I+h*C,l[3]=v*I-f*C,l}oe(),Ze();var Ji,ar,br,Dr,Fr,Qr=bi,ui=(Ji=oe(),ar=Be(1,0,0),br=Be(0,1,0),function(l,t,o){var h=Ct(t,o);return h<-.999999?(rt(Ji,ar,t),It(Ji)<1e-6&&rt(Ji,br,t),mt(Ji,Ji),function(f,m,v){v*=.5;var C=Math.sin(v);f[0]=C*m[0],f[1]=C*m[1],f[2]=C*m[2],f[3]=Math.cos(v)}(l,Ji,Math.PI),l):h>.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(rt(Ji,t,o),l[0]=Ji[0],l[1]=Ji[1],l[2]=Ji[2],l[3]=1+h,Qr(l,l))});function li(){var l=new b(2);return b!=Float32Array&&(l[0]=0,l[1]=0),l}function Vi(l,t){var o=new b(2);return o[0]=l,o[1]=t,o}function rr(l,t,o){return l[0]=t[0]+o[0],l[1]=t[1]+o[1],l}function qr(l,t,o){return l[0]=t[0]-o[0],l[1]=t[1]-o[1],l}function _r(l,t,o){return l[0]=t[0]*o,l[1]=t[1]*o,l}function Zr(l){return Math.hypot(l[0],l[1])}function io(l,t){var o=t[0],h=t[1],f=o*o+h*h;return f>0&&(f=1/Math.sqrt(f)),l[0]=t[0]*f,l[1]=t[1]*f,l}function Ur(l,t){return l[0]*t[0]+l[1]*t[1]}function ta(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}di(),di(),B(),li();var As,ro,zn=function(){if(Fr)return Dr;function l(t,o,h,f){this.cx=3*t,this.bx=3*(h-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=h,this.p2y=f}return Fr=1,Dr=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,o){if(o===void 0&&(o=1e-6),t<0)return 0;if(t>1)return 1;for(var h=t,f=0;f<8;f++){var m=this.sampleCurveX(h)-t;if(Math.abs(m)<o)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=m/v}var C=0,I=1;for(h=t,f=0;f<20&&(m=this.sampleCurveX(h),!(Math.abs(m-t)<o));f++)t>m?C=h:I=h,h=.5*(I-C)+C;return h},solve:function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))}},Dr}(),Lr=ta(zn);function yr(){if(ro)return As;function l(t,o){this.x=t,this.y=o}return ro=1,As=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,o){return this.clone()._rotateAround(t,o)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var o=t.x-this.x,h=t.y-this.y;return o*o+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,o){return Math.atan2(this.x*o-this.y*t,this.x*t+this.y*o)},_matMult:function(t){var o=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=o,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var o=Math.cos(t),h=Math.sin(t),f=h*this.x+o*this.y;return this.x=o*this.x-h*this.y,this.y=f,this},_rotateAround:function(t,o){var h=Math.cos(t),f=Math.sin(t),m=o.y+f*(this.x-o.x)+h*(this.y-o.y);return this.x=o.x+h*(this.x-o.x)-f*(this.y-o.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t},As}var qt=ta(yr());function Nn(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(!Nn(l[o],t[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const o in l)if(!Nn(l[o],t[o]))return!1;return!0}return l===t}const vs=Math.PI/180,ia=180/Math.PI;function dn(l){return l*vs}function St(l){return l*ia}const me=[[0,0],[1,0],[1,1],[0,1]];function Ce(l){if(l<=0)return 0;if(l>=1)return 1;const t=l*l,o=t*l;return 4*(l<.5?o:3*(l-t)+o-.75)}function je(l,t,o,h){const f=new Lr(l,t,o,h);return function(m){return f.solve(m)}}const Je=je(.25,.1,.25,1);function Ge(l,t,o){return Math.min(o,Math.max(t,l))}function vt(l,t,o){return(o=Ge((o-l)/(t-l),0,1))*o*(3-2*o)}function Rt(l,t,o){const h=o-t,f=((l-t)%h+h)%h+t;return f===t?o:f}function _t(l,t,o){if(!l.length)return o(null,[]);let h=l.length;const f=new Array(l.length);let m=null;l.forEach((v,C)=>{t(v,(I,F)=>{I&&(m=I),f[C]=F,--h==0&&o(m,f)})})}function Ot(l,...t){for(const o of t)for(const h in o)l[h]=o[h];return l}let ii=1;function Nt(){return ii++}function Fi(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function er(l,t){l.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function nr(l,t,o){const h={};for(const f in l)h[f]=t.call(this,l[f],f,l);return h}function Sr(l,t,o){const h={};for(const f in l)t.call(this,l[f],f,l)&&(h[f]=l[f]);return h}function Mr(l){return Array.isArray(l)?l.map(Mr):typeof l=="object"&&l?nr(l,Mr):l}function jr(l,t){for(let o=0;o<l.length;o++)if(t.indexOf(l[o])>=0)return!0;return!1}const nn={};function Yr(l){nn[l]||(typeof console<"u"&&console.warn(l),nn[l]=!0)}function Wn(l,t,o){return(o.y-l.y)*(t.x-l.x)>(t.y-l.y)*(o.x-l.x)}function fs(l){let t=0;for(let o,h,f=0,m=l.length,v=m-1;f<m;v=f++)o=l[f],h=l[v],t+=(h.x-o.x)*(o.y+h.y);return t}function ps([l,t,o]){const h=dn(t+90),f=dn(o);return{x:l*Math.cos(h)*Math.sin(f),y:l*Math.sin(h)*Math.sin(f),z:l*Math.cos(f),azimuthal:t,polar:o}}function Sn(l){return(typeof self<"u"||l!==void 0)&&typeof WorkerGlobalScope<"u"&&(l!==void 0?l:self)instanceof WorkerGlobalScope}function En(l){const t={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,h,f,m)=>{const v=f||m;return t[h]=!v||v.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let Is=null;function _s(l,t){return[l[4*t],l[4*t+1],l[4*t+2],l[4*t+3]]}function cs(l,t,o,h){for(;t<o;){const f=t+o>>1;l[f]<h?t=f+1:o=f}return t}function Oo(l,t,o,h){for(;t<o;){const f=t+o>>1;l[f]<=h?t=f+1:o=f}return t}function Ra(l){return l>0?1/(1.001-l):1+l}function Bo(l){return l>0?1-1/(1.001-l):-l}function fc(l,t,o){return(l-t.min)*(o.max-o.min)/(t.max-t.min)+o.min}const us={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!us.API_URL)return null;try{const l=new URL(us.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v0.3.0.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function pc(l){return us.API_URL_REGEX.test(l)}function lh(l){return us.API_SPRITE_REGEX.test(l)}let gc,ql,zc,fl,Co,Ta;function ku(){return gc==null&&(gc=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),gc}const pl={now:()=>fl!==void 0?fl:performance.now(),setNow(l){fl=l},restoreNow(){fl=void 0},frame(l){const t=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(l,t=0){const{width:o,height:h}=l;Co||(Co=document.createElement("canvas"));const f=Co.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>Co.width||h>Co.height)&&(Co.width=o,Co.height=h),f.clearRect(-t,-t,o+2*t,h+2*t),f.drawImage(l,0,0,o,h),f.getImageData(-t,-t,o+2*t,h+2*t)},resolveURL:l=>(ql||(ql=document.createElement("a")),ql.href=l,ql.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(zc==null&&(zc=window.matchMedia("(prefers-reduced-motion: reduce)")),zc.matches)},hasCanvasFingerprintNoise(){if(Ta!==void 0)return Ta;if(!ku())return Ta=!1,!1;const l=new OffscreenCanvas(85,1),t=l.getContext("2d",{willReadFrequently:!0});let o=0;for(let f=0;f<l.width;++f)t.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,t.fillRect(f,0,1,1);const h=t.getImageData(0,0,l.width,l.height);o=0;for(let f=0;f<h.data.length;++f)if(f%4!=3&&o++!==h.data[f])return Ta=!0,!0;return Ta=!1,!1}};function sl(l,t){const o=l.indexOf("?");if(o<0)return`${l}?${new URLSearchParams(t).toString()}`;const h=new URLSearchParams(l.slice(o));for(const f in t)h.set(f,t[f]);return`${l.slice(0,o)}?${h.toString()}`}function ol(l,t={persistentParams:[]}){const o=l.indexOf("?");if(o<0)return l;const h=new URLSearchParams,f=new URLSearchParams(l.slice(o));for(const v of t.persistentParams){const C=f.get(v);C&&h.set(v,C)}const m=h.toString();return`${l.slice(0,o)}${m.length>0?`?${m}`:""}`}const mc="mapbox-tiles";let gl=500,yc=50;const $l=["language","worldview","jobid"];let Zl,Ru;function cu(){try{return caches}catch{}}function ml(){const l=cu();l&&Zl==null&&(Zl=l.open(mc))}let uu=1/0;const Nc={supported:!1,testSupport:function(l){!ch&&Wo&&(hu?Jd(l):Po=l)}};let Po,Wo,ch=!1,hu=!1;const Tn=typeof self<"u"?self:{};function Jd(l){const t=l.createTexture();l.bindTexture(l.TEXTURE_2D,t);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Wo),l.isContextLost())return;Nc.supported=!0}catch{}l.deleteTexture(t),ch=!0}Tn.document&&(Wo=Tn.document.createElement("img"),Wo.onload=function(){Po&&Jd(Po),Po=null,hu=!0},Wo.onerror=function(){ch=!0,Po=null},Wo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const uh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(uh);class pn extends Error{constructor(t,o,h){o===401&&pc(h)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const hh=Sn()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,du=function(l,t){if(!(/^file:/.test(o=l.url)||/^file:/.test(hh())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,f){const m=new AbortController,v=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:hh(),referrerPolicy:h.referrerPolicy,signal:m.signal});let C=!1,I=!1;const F=(k=v.url).indexOf("sku=")>0&&pc(k);var k;h.type==="json"&&v.headers.set("Accept","application/json");const z=($,ee,ae)=>{if(I)return;if($&&$.message!=="SecurityError"&&Yr($.toString()),ee&&ae)return H(ee);const Ae=Date.now();fetch(v).then(ve=>{if(ve.ok){const Fe=F?ve.clone():null;return H(ve,Fe,Ae)}return f(new pn(ve.statusText,ve.status,h.url))}).catch(ve=>{ve.name!=="AbortError"&&f(new Error(`${ve.message} ${h.url}`))})},H=($,ee,ae)=>{(h.type==="arrayBuffer"?$.arrayBuffer():h.type==="json"?$.json():$.text()).then(Ae=>{I||(ee&&ae&&function(ve,Fe,Le){if(ml(),Zl==null)return;const ce=En(Fe.headers.get("Cache-Control")||"");if(ce["no-store"])return;const Ee={status:Fe.status,statusText:Fe.statusText,headers:new Headers};Fe.headers.forEach((gt,ht)=>Ee.headers.set(ht,gt)),ce["max-age"]&&Ee.headers.set("Expires",new Date(Le+1e3*ce["max-age"]).toUTCString());const ke=Ee.headers.get("Expires");if(!ke||new Date(ke).getTime()-Le<42e4)return;let He=ol(ve.url,{persistentParams:$l});if(Fe.status===206){const gt=ve.headers.get("Range");if(!gt)return;Ee.status=200,He=sl(He,{range:gt})}(function(gt,ht){if(Ru===void 0)try{new Response(new ReadableStream),Ru=!0}catch{Ru=!1}Ru?ht(gt.body):gt.blob().then(ht).catch(yt=>Yr(yt.message))})(Fe,gt=>{const ht=new Response((yt=Fe.status)!==200&&yt!==404&&[101,103,204,205,304].includes(yt)?null:gt,Ee);var yt;ml(),Zl!=null&&Zl.then(Lt=>Lt.put(He,ht)).catch(Lt=>Yr(Lt.message))})}(v,ee,ae),C=!0,f(null,Ae,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(Ae=>{I||f(new Error(Ae.message))})};return F?function($,ee){if(ml(),Zl==null)return ee(null);Zl.then(ae=>{let Ae=ol($.url,{persistentParams:$l});const ve=$.headers.get("Range");ve&&(Ae=sl(Ae,{range:ve})),ae.match(Ae).then(Fe=>{const Le=function(ce){if(!ce)return!1;const Ee=new Date(ce.headers.get("Expires")||0),ke=En(ce.headers.get("Cache-Control")||"");return Number(Ee)>Date.now()&&!ke["no-cache"]}(Fe);ae.delete(Ae).catch(ee),Le&&ae.put(Ae,Fe.clone()).catch(ee),ee(null,Fe,Le)}).catch(ee)}).catch(ee)}(v,z):z(null,null),{cancel:()=>{I=!0,C||m.abort()}}}(l,t);if(Sn(self)&&self.worker.actor)return self.worker.actor.send("getResource",l,t,void 0,!0)}var o;return function(h,f){const m=new XMLHttpRequest;m.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const v in h.headers)m.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=h.credentials==="include",m.onerror=()=>{f(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let v=m.response;if(h.type==="json")try{v=JSON.parse(m.response)}catch(C){return f(C)}f(null,v,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new pn(m.statusText,m.status,h.url))},m.send(h.body),{cancel:()=>m.abort()}}(l,t)},jc=function(l,t){return du(Ot(l,{type:"arrayBuffer"}),t)};function yl(l){const t=document.createElement("a");return t.href=l,t.protocol===location.protocol&&t.host===location.host}const Du="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Hc,vc;Hc=[],vc=0;const dh=function(l,t){if(Nc.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),vc>=us.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:l,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Hc.push(m),m}vc++;let o=!1;const h=()=>{if(!o)for(o=!0,vc--;Hc.length&&vc<us.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Hc.shift(),{requestParameters:v,callback:C,cancelled:I}=m;I||(m.cancel=dh(v,C).cancel)}},f=jc(l,(m,v,C,I)=>{h(),m?t(m):v&&(self.createImageBitmap?function(F,k){const z=new Blob([new Uint8Array(F)],{type:"image/png"});createImageBitmap(z).then(H=>{k(null,H)}).catch(H=>{k(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(F,k)=>t(F,k,C,I)):function(F,k){const z=new Image;z.onload=()=>{k(null,z),URL.revokeObjectURL(z.src),z.onload=null,requestAnimationFrame(()=>{z.src=Du})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new Blob([new Uint8Array(F)],{type:"image/png"});z.src=F.byteLength?URL.createObjectURL(H):Du}(v,(F,k)=>t(F,k,C,I)))});return{cancel:()=>{f.cancel(),h()}}};var Au,vl,ld,qa={exports:{}},fu={exports:{}},pu={exports:{}},_l=function(){if(ld)return qa.exports;ld=1;var l=(Au||(Au=1,fu.exports=function(o,h){var f,m,v,C,I,F,k,z;for(m=o.length-(f=3&o.length),v=h,I=3432918353,F=461845907,z=0;z<m;)k=255&o.charCodeAt(z)|(255&o.charCodeAt(++z))<<8|(255&o.charCodeAt(++z))<<16|(255&o.charCodeAt(++z))<<24,++z,v=27492+(65535&(C=5*(65535&(v=(v^=k=(65535&(k=(k=(65535&k)*I+(((k>>>16)*I&65535)<<16)&4294967295)<<15|k>>>17))*F+(((k>>>16)*F&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(k=0,f){case 3:k^=(255&o.charCodeAt(z+2))<<16;case 2:k^=(255&o.charCodeAt(z+1))<<8;case 1:v^=k=(65535&(k=(k=(65535&(k^=255&o.charCodeAt(z)))*I+(((k>>>16)*I&65535)<<16)&4294967295)<<15|k>>>17))*F+(((k>>>16)*F&65535)<<16)&4294967295}return v^=o.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),fu.exports),t=(vl||(vl=1,pu.exports=function(o,h){for(var f,m=o.length,v=h^m,C=0;m>=4;)f=1540483477*(65535&(f=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24))+((1540483477*(f>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),m-=4,++C;switch(m){case 3:v^=(255&o.charCodeAt(C+2))<<16;case 2:v^=(255&o.charCodeAt(C+1))<<8;case 1:v=1540483477*(65535&(v^=255&o.charCodeAt(C)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),pu.exports);return qa.exports=l,qa.exports.murmur3=l,qa.exports.murmur2=t,qa.exports}(),Uo=ta(_l);class Qc{constructor(t,...o){Ot(this,o[0]||{}),this.type=t}}class Jl extends Qc{constructor(t,o={}){super("error",Ot({error:t},o))}}function ec(l,t,o){o[l]&&o[l].indexOf(t)!==-1||(o[l]=o[l]||[],o[l].push(t))}function tc(l,t,o){if(o&&o[l]){const h=o[l].indexOf(t);h!==-1&&o[l].splice(h,1)}}class gu{on(t,o){return this._listeners=this._listeners||{},ec(t,o,this._listeners),this}off(t,o){return tc(t,o,this._listeners),tc(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},ec(t,o,this._oneTimeListeners),this):new Promise(h=>{this.once(t,h)})}fire(t,o){const h=typeof t=="string"?new Qc(t,o):t,f=h.type;if(this.listens(f)){h.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const I of m)I.call(this,h);const v=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const I of v)tc(f,I,this._oneTimeListeners),I.call(this,h);const C=this._eventedParent;C&&(Ot(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(h))}else h instanceof Jl&&console.error(h.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}class ra{constructor(t){typeof t=="string"?this.name=t:(this.name=t.name,this.iconsetId=t.iconsetId)}static from(t){return new ra(t)}static toString(t){return t.iconsetId?`${t.name}${t.iconsetId}`:t.name}static parse(t){const[o,h]=t.split("");return new ra({name:o,iconsetId:h})}static isEqual(t,o){return t.name===o.name&&t.iconsetId===o.iconsetId}toString(){return ra.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var $a,Pl={},xl=function(){if($a)return Pl;$a=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(m){return(m=Math.round(m))<0?0:m>255?255:m}function o(m){return t(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function h(m){return(v=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:v>1?1:v;var v}function f(m,v,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?m+(v-m)*C*6:2*C<1?v:3*C<2?m+(v-m)*(2/3-C)*6:m}try{Pl.parseCSSColor=function(m){var v,C=m.replace(/ /g,"").toLowerCase();if(C in l)return l[C].slice();if(C[0]==="#")return C.length===4?(v=parseInt(C.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:C.length===7&&(v=parseInt(C.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var I=C.indexOf("("),F=C.indexOf(")");if(I!==-1&&F+1===C.length){var k=C.substr(0,I),z=C.substr(I+1,F-(I+1)).split(","),H=1;switch(k){case"rgba":if(z.length!==4)return null;H=h(z.pop());case"rgb":return z.length!==3?null:[o(z[0]),o(z[1]),o(z[2]),H];case"hsla":if(z.length!==4)return null;H=h(z.pop());case"hsl":if(z.length!==3)return null;var $=(parseFloat(z[0])%360+360)%360/360,ee=h(z[1]),ae=h(z[2]),Ae=ae<=.5?ae*(ee+1):ae+ee-ae*ee,ve=2*ae-Ae;return[t(255*f(ve,Ae,$+1/3)),t(255*f(ve,Ae,$)),t(255*f(ve,Ae,$-1/3)),H];default:return null}}return null}}catch{}return Pl}();class Un{constructor(t,o,h,f=1){this.r=t,this.g=o,this.b=h,this.a=f}static parse(t){if(!t)return;if(t instanceof Un)return t;if(typeof t!="string")return;const o=xl.parseCSSColor(t);return o?new Un(o[0]/255,o[1]/255,o[2]/255,o[3]):void 0}toString(){const[t,o,h,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*t)},${Math.round(255*o)},${Math.round(255*h)},${f})`}toNonPremultipliedRenderColor(t){const{r:o,g:h,b:f,a:m}=this;return new Hh(t,o,h,f,m)}toPremultipliedRenderColor(t){const{r:o,g:h,b:f,a:m}=this;return new mu(t,o*m,h*m,f*m,m)}clone(){return new Un(this.r,this.g,this.b,this.a)}}class zo{constructor(t,o,h,f,m,v=!1){if(this.premultiplied=!1,this.premultiplied=v,t){const C=t.image.height,I=C*C;this.premultiplied?(o=m===0?0:o/m*(C-1),h=m===0?0:h/m*(C-1),f=m===0?0:f/m*(C-1)):(o*=C-1,h*=C-1,f*=C-1);const F=Math.floor(o),k=Math.floor(h),z=Math.floor(f),H=Math.ceil(o),$=Math.ceil(h),ee=Math.ceil(f),ae=o-F,Ae=h-k,ve=f-z,Fe=t.image.data,Le=4*(F+k*I+z*C),ce=4*(F+k*I+ee*C),Ee=4*(F+$*I+z*C),ke=4*(F+$*I+ee*C),He=4*(H+k*I+z*C),gt=4*(H+k*I+ee*C),ht=4*(H+$*I+z*C),yt=4*(H+$*I+ee*C);if(Le<0||yt>=Fe.length)throw new Error("out of range");this.r=Er(Er(Er(Fe[Le],Fe[ce],ve),Er(Fe[Ee],Fe[ke],ve),Ae),Er(Er(Fe[He],Fe[gt],ve),Er(Fe[ht],Fe[yt],ve),Ae),ae)/255*(this.premultiplied?m:1),this.g=Er(Er(Er(Fe[Le+1],Fe[ce+1],ve),Er(Fe[Ee+1],Fe[ke+1],ve),Ae),Er(Er(Fe[He+1],Fe[gt+1],ve),Er(Fe[ht+1],Fe[yt+1],ve),Ae),ae)/255*(this.premultiplied?m:1),this.b=Er(Er(Er(Fe[Le+2],Fe[ce+2],ve),Er(Fe[Ee+2],Fe[ke+2],ve),Ae),Er(Er(Fe[He+2],Fe[gt+2],ve),Er(Fe[ht+2],Fe[yt+2],ve),Ae),ae)/255*(this.premultiplied?m:1),this.a=m}else this.r=o,this.g=h,this.b=f,this.a=m}toArray(){const{r:t,g:o,b:h,a:f}=this;return[255*t,255*o,255*h,f]}toHslaArray(){let{r:t,g:o,b:h,a:f}=this;if(this.premultiplied){if(f===0)return[0,0,0,0];t/=f,o/=f,h/=f}const m=Math.min(Math.max(t,0),1),v=Math.min(Math.max(o,0),1),C=Math.min(Math.max(h,0),1),I=Math.min(m,v,C),F=Math.max(m,v,C),k=(I+F)/2;if(I===F)return[0,0,100*k,f];const z=F-I,H=k>.5?z/(2-F-I):z/(F+I);let $=0;return F===m?$=(v-C)/z+(v<C?6:0):F===v?$=(C-m)/z+2:F===C&&($=(m-v)/z+4),$*=60,[Math.min(Math.max($,0),360),Math.min(Math.max(100*H,0),100),Math.min(Math.max(100*k,0),100),f]}toArray01(){const{r:t,g:o,b:h,a:f}=this;return[t,o,h,f]}toArray01Scaled(t){const{r:o,g:h,b:f}=this;return[o*t,h*t,f*t]}toArray01Linear(){const{r:t,g:o,b:h,a:f}=this;return[Math.pow(t,2.2),Math.pow(o,2.2),Math.pow(h,2.2),f]}}class Hh extends zo{constructor(t,o,h,f,m){super(t,o,h,f,m,!1)}}class mu extends zo{constructor(t,o,h,f,m){super(t,o,h,f,m,!0)}}function Er(l,t,o){return l*(1-o)+t*o}function Ah(l,t,o){return l.map((h,f)=>Er(h,t[f],o))}Un.black=new Un(0,0,0,1),Un.white=new Un(1,1,1,1),Un.transparent=new Un(0,0,0,0),Un.red=new Un(1,0,0,1),Un.blue=new Un(0,0,1,1);var Vc=Object.freeze({__proto__:null,array:Ah,color:function(l,t,o){return new Un(Er(l.r,t.r,o),Er(l.g,t.g,o),Er(l.b,t.b,o),Er(l.a,t.a,o))},number:Er});function _c(l,...t){for(const o of t)for(const h in o)l[h]=o[h];return l}class Da extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class Qh{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[h,f]of o)this.bindings[h]=f}concat(t){return new Qh(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Ou={kind:"null"},hr={kind:"number"},Mn={kind:"string"},In={kind:"boolean"},na={kind:"color"},kl={kind:"object"},ie={kind:"value"},Ue={kind:"collator"},Et={kind:"formatted"},jt={kind:"resolvedImage"};function hi(l,t){return{kind:"array",itemType:l,N:t}}function Ti(l){if(l.kind==="array"){const t=Ti(l.itemType);return typeof l.N=="number"?`array<${t}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${t}>`}return l.kind}const mr=[Ou,hr,Mn,In,na,Et,kl,hi(ie),jt];function Vr(l,t){if(t.kind==="error")return null;if(l.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Vr(l.itemType,t.itemType))&&(typeof l.N!="number"||l.N===t.N))return null}else{if(l.kind===t.kind)return null;if(l.kind==="value"){for(const o of mr)if(!Vr(o,t))return null}}return`Expected ${Ti(l)} but found ${Ti(t)} instead.`}function cn(l,t){return t.some(o=>o.kind===l.kind)}function Pn(l,t){return t.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}function kn(l,t){return l.kind==="array"&&t.kind==="array"?l.N===t.N&&kn(l.itemType,t.itemType):l.kind===t.kind}class hs{constructor(t,o,h){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zs{constructor(t,o,h,f,m){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=h,this.fontStack=f,this.textColor=m}}class Zn{constructor(t){this.sections=t}static fromString(t){return new Zn([new Zs(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||!!t.image&&t.image.hasPrimary())}static factory(t){return t instanceof Zn?t:Zn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){const f=o.image.getPrimary().id.toString();t.push(["image",f]);continue}t.push(o.text);const h={};o.fontStack&&(h["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(h["font-scale"]=o.scale),o.textColor&&(h["text-color"]=["rgba"].concat(o.textColor.toNonPremultipliedRenderColor(null).toArray())),t.push(h)}return t}}class xn{constructor(t,o={}){if(this.id=ra.from(t),this.options=Object.assign({},o),o.transform){const{a:h,b:f,c:m,d:v,e:C,f:I}=o.transform;this.options.transform=new DOMMatrix([h,f,m,v,C,I])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:t,b:o,c:h,d:f,e:m,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:t,b:o,c:h,d:f,e:m,f:v}})}static parse(t){let o,h,f,m;try{({name:o,iconsetId:h,params:f,transform:m}=JSON.parse(t)||{})}catch{return null}if(!o)return null;const{a:v,b:C,c:I,d:F,e:k,f:z}=m||{};return new xn({name:o,iconsetId:h},{params:f,transform:new DOMMatrix([v,C,I,F,k,z])})}scaleSelf(t,o){return this.options.transform.scaleSelf(t,o),this}}class Js{constructor(t,o,h,f,m=!1){this.primaryId=ra.from(t),this.primaryOptions=o,h&&(this.secondaryId=ra.from(h)),this.secondaryOptions=f,this.available=m}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new xn(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new xn(this.secondaryId,this.secondaryOptions):null}static from(t){return typeof t=="string"?Js.build({name:t}):t}static build(t,o,h,f){return!t||typeof t=="object"&&!("name"in t)?null:new Js(t,h,o,f)}}function yo(l,t,o,h){return typeof l=="number"&&l>=0&&l<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[l,t,o,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[l,t,o,h]:[l,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wr(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Un||l instanceof hs||l instanceof Zn||l instanceof Js)return!0;if(Array.isArray(l)){for(const t of l)if(!Wr(t))return!1;return!0}if(typeof l=="object"){for(const t in l)if(!Wr(l[t]))return!1;return!0}return!1}function ji(l){if(l===null)return Ou;if(typeof l=="string")return Mn;if(typeof l=="boolean")return In;if(typeof l=="number")return hr;if(l instanceof Un)return na;if(l instanceof hs)return Ue;if(l instanceof Zn)return Et;if(l instanceof Js)return jt;if(Array.isArray(l)){const t=l.length;let o;for(const h of l){const f=ji(h);if(o){if(o===f)continue;o=ie;break}o=f}return hi(o||ie,t)}return kl}function eo(l){const t=typeof l;return l===null?"":t==="string"||t==="number"||t==="boolean"?String(l):l instanceof Zn||l instanceof Js||l instanceof Un?l.toString():JSON.stringify(l)}class Pr{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Wr(t[1]))return o.error("invalid value");const h=t[1];let f=ji(h);const m=o.expectedType;return f.kind!=="array"||f.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(f=m),new Pr(f,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Un?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof Zn?this.value.serialize():this.value}}class Cs{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ao={string:Mn,number:hr,boolean:In,object:kl};class wr{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let h,f=1;const m=t[0];if(m==="array"){let C,I;if(t.length>2){const F=t[1];if(typeof F!="string"||!(F in ao)||F==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);C=ao[F],f++}else C=ie;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);I=t[2],f++}h=hi(C,I)}else h=ao[m];const v=[];for(;f<t.length;f++){const C=o.parse(t[f],f,ie);if(!C)return null;v.push(C)}return new wr(h,v)}evaluate(t){for(let o=0;o<this.args.length;o++){const h=this.args[o].evaluate(t);if(!Vr(this.type,ji(h)))return h;if(o===this.args.length-1)throw new Cs(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${Ti(ji(h))} but was expected to be of type ${Ti(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const h=t.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){o.push(h.kind);const f=t.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(h=>h.serialize()))}}class vo{constructor(t){this.type=Et,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return o.error("First argument must be an image or text section.");const f=[];let m=!1;for(let v=1;v<=t.length-1;++v){const C=t[v];if(m&&typeof C=="object"&&!Array.isArray(C)){m=!1;let I=null;if(C["font-scale"]&&(I=o.parseObjectValue(C["font-scale"],v,"font-scale",hr),!I))return null;let F=null;if(C["text-font"]&&(F=o.parseObjectValue(C["text-font"],v,"text-font",hi(Mn)),!F))return null;let k=null;if(C["text-color"]&&(k=o.parseObjectValue(C["text-color"],v,"text-color",na),!k))return null;const z=f[f.length-1];z.scale=I,z.font=F,z.textColor=k}else{const I=o.parse(t[v],v,ie);if(!I)return null;const F=I.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,f.push({content:I,scale:null,font:null,textColor:null})}}return new vo(f)}evaluate(t){return new Zn(this.sections.map(o=>{const h=o.content.evaluate(t);return kn(ji(h),jt)?new Zs("",h,null,null,null):new Zs(eo(h),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const h={};o.scale&&(h["font-scale"]=o.scale.serialize()),o.font&&(h["text-font"]=o.font.serialize()),o.textColor&&(h["text-color"]=o.textColor.serialize()),t.push(h)}return t}}class ic{constructor(t,o,h,f){this._imageWarnHistory={},this.type=jt,this.namePrimary=t,this.nameSecondary=o,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),f&&(this.paramsSecondary=f.params,this.iconsetIdSecondary=f.iconset?f.iconset.id:void 0)}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");let h=1;const f=[];function m(){if(h<t.length){const C=o.parse(t[h],h++,Mn);return C?(f.push({image:C,options:{}}),!0):(o.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(h<t.length){const I=t[h];if((C=I)===null||typeof C!="object"||Array.isArray(C))return!0;const F=I.params,k=I.iconset,z=o.concat(h);if(!F&&!k)return h++,!0;if(F){if(typeof F!="object"||F.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const H={},$=z.concat(void 0,"params");for(const ee in F){if(!ee)return $.error("Image parameter name should be non-empty"),!1;const ae=$.concat(void 0,ee).parse(F[ee],void 0,na,void 0,{typeAnnotation:"coerce"});if(!ae)return!1;H[ee]=ae}f[f.length-1].options.params=H}if(k){if(typeof k!="object"||k.constructor!==Object)return z.error('Image options "iconset" should be an object'),!1;if(!k.id)return z.error('Image options "iconset" should have an "id" property'),!1;f[f.length-1].options.iconset=k}return h++,!0}var C;return!0}for(let C=0;C<2;C++)if(!m()||!v())return;return new ic(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(t,o){const h={};if(o){for(const f in o)if(o[f])try{h[f]=o[f].evaluate(t)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(t){const o={name:this.namePrimary.evaluate(t),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(t),iconsetId:this.iconsetIdSecondary}:void 0,f=Js.build(o,h,this.paramsPrimary?this.evaluateParams(t,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(t,this.paramsSecondary):void 0);if(f&&t.availableImages){const m=f.getPrimary().id;if(f.available=t.availableImages.some(v=>ra.isEqual(v,m)),f.available){const v=f.getSecondary()?f.getSecondary().id:null;v&&(f.available=t.availableImages.some(C=>ra.isEqual(C,v)))}}return f}eachChild(t){if(t(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&t(this.paramsPrimary[o]);if(this.nameSecondary&&(t(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&t(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(t,o){const h={};if(o&&(h.iconset={id:o}),t){h.params={};for(const f in t)t[f]&&(h.params[f]=t[f].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const t=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&t.push(o)}if(this.nameSecondary&&(t.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&t.push(o)}return t}}function pa(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const Xo={"to-boolean":In,"to-color":na,"to-number":hr,"to-string":Mn};class Jn{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const h=t[0],f=[];let m=Ou;if(h==="to-array"){if(!Array.isArray(t[1]))return null;const v=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);m=hi(o.expectedType.itemType,v)}else{if(!(v>0&&Wr(t[1][0])))return null;m=hi(ji(t[1][0]),v)}for(let C=0;C<v;C++){const I=t[1][C];let F;if(pa(I)==="array")F=o.parse(I,void 0,m.itemType);else{const k=pa(I);if(k!==m.itemType.kind)return o.error(`Expected ${m.itemType.kind} but found ${k}.`);F=o.registry.literal.parse(["literal",I===void 0?null:I],o)}if(!F)return null;f.push(F)}}else{if((h==="to-boolean"||h==="to-string")&&t.length!==2)return o.error("Expected one argument.");m=Xo[h];for(let v=1;v<t.length;v++){const C=o.parse(t[v],v,ie);if(!C)return null;f.push(C)}}return new Jn(m,f)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,h;for(const f of this.args){if(o=f.evaluate(t),h=null,o instanceof Un)return o;if(typeof o=="string"){const m=t.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(h=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:yo(o[0],o[1],o[2],o[3]),!h))return new Un(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Cs(h||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const h of this.args){if(o=h.evaluate(t),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Cs(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Zn.fromString(eo(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Js.build(eo(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(o=>o.evaluate(t)):eo(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new vo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ic(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{t.push(o.serialize())}),t}}const Yo=["Unknown","Point","LineString","Polygon"];class xc{constructor(t,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:h,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*o-t[0])+this.featureDistanceData.bearing[1]*(f*o-t[1])}return 0}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Un.parse(t)),o}getConfig(t){return this.options?this.options.get(t):null}}class So{constructor(t,o,h,f,m){this.name=t,this.type=o,this._evaluate=h,this.args=f,this._overloadIndex=m}evaluate(t){if(!this._evaluate){const o=So.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,o){const h=t[0],f=So.definitions[h];if(!f)return o.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,C=[];let I=null,F=-1;for(const[k,z]of v){if(Array.isArray(k)&&k.length!==t.length-1)continue;C.push(k),F++,I=new oA(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const H=[];let $=!1;for(let ee=1;ee<t.length;ee++){const ae=t[ee],Ae=Array.isArray(k)?k[ee-1]:k.type,ve=I.parse(ae,1+H.length,Ae);if(!ve){$=!0;break}H.push(ve)}if(!$)if(Array.isArray(k)&&k.length!==H.length)I.error(`Expected ${k.length} arguments, but found ${H.length} instead.`);else{for(let ee=0;ee<H.length;ee++){const ae=Array.isArray(k)?k[ee]:k.type,Ae=H[ee];I.concat(ee+1).checkSubtype(ae,Ae.type)}if(I.errors.length===0)return new So(h,m,z,H,F)}}if(C.length===1)o.errors.push(...I.errors);else{const k=(C.length?C:v.map(([H])=>H)).map(Oa).join(" | "),z=[];for(let H=1;H<t.length;H++){const $=o.parse(t[H],1+z.length);if(!$)return null;z.push(Ti($.type))}o.error(`Expected arguments of type ${k}, but found (${z.join(", ")}) instead.`)}return null}static register(t,o){So.definitions=o;for(const h in o)t[h]=So}}function Oa(l){return Array.isArray(l)?`(${l.map(Ti).join(", ")})`:`(${Ti(l.type)}...)`}class al{constructor(t,o,h){this.type=Ue,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return o.error("Collator options argument must be an object.");const f=h["case-sensitive"]===void 0?o.parse(!1,1,In):o.parseObjectValue(h["case-sensitive"],1,"case-sensitive",In);if(!f)return null;const m=h["diacritic-sensitive"]===void 0?o.parse(!1,1,In):o.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",In);if(!m)return null;let v=null;return h.locale&&(v=o.parseObjectValue(h.locale,1,"locale",Mn),!v)?null:new al(f,m,v)}evaluate(t){return new hs(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function Ko(l,t,o=0,h=l.length-1,f=No){for(;h>o;){if(h-o>600){const I=h-o+1,F=t-o+1,k=Math.log(I),z=.5*Math.exp(2*k/3),H=.5*Math.sqrt(k*z*(I-z)/I)*(F-I/2<0?-1:1);Ko(l,t,Math.max(o,Math.floor(t-F*z/I+H)),Math.min(h,Math.floor(t+(I-F)*z/I+H)),f)}const m=l[t];let v=o,C=h;for(yu(l,o,t),f(l[h],m)>0&&yu(l,o,h);v<C;){for(yu(l,v,C),v++,C--;f(l[v],m)<0;)v++;for(;f(l[C],m)>0;)C--}f(l[o],m)===0?yu(l,o,C):(C++,yu(l,C,h)),C<=t&&(o=C+1),t<=C&&(h=C-1)}}function yu(l,t,o){const h=l[t];l[t]=l[o],l[o]=h}function No(l,t){return l<t?-1:l>t?1:0}function Rl(l){let t=0;for(let o,h,f=0,m=l.length,v=m-1;f<m;v=f++)o=l[f],h=l[v],t+=(h.x-o.x)*(o.y+h.y);return t}function Ia(l,t){l[0]=Math.min(l[0],t[0]),l[1]=Math.min(l[1],t[1]),l[2]=Math.max(l[2],t[0]),l[3]=Math.max(l[3],t[1])}function _o(l,t){return!(l[0]<=t[0]||l[2]>=t[2]||l[1]<=t[1]||l[3]>=t[3])}function sa(l,t,o){const h=l[0]-t[0],f=l[1]-t[1],m=l[0]-o[0],v=l[1]-o[1];return h*v-m*f==0&&h*m<=0&&f*v<=0}function Dl(l,t,o=!1){let h=!1;for(let C=0,I=t.length;C<I;C++){const F=t[C];for(let k=0,z=F.length,H=z-1;k<z;H=k++){const $=F[H],ee=F[k];if(sa(l,$,ee))return o;(m=$)[1]>(f=l)[1]!=(v=ee)[1]>f[1]&&f[0]<(v[0]-m[0])*(f[1]-m[1])/(v[1]-m[1])+m[0]&&(h=!h)}}var f,m,v;return h}function Za(l,t,o,h){const f=h[0]-o[0],m=h[1]-o[1],v=(l[0]-o[0])*m-f*(l[1]-o[1]),C=(t[0]-o[0])*m-f*(t[1]-o[1]);return v>0&&C<0||v<0&&C>0}function ga(l,t,o,h){return(f=[h[0]-o[0],h[1]-o[1]])[0]*(m=[t[0]-l[0],t[1]-l[1]])[1]-f[1]*m[0]!=0&&!(!Za(l,t,o,h)||!Za(o,h,l,t));var f,m}function bc(l){const t=new qt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new qt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of l[0])t.x>h.x&&(t.x=h.x),t.y>h.y&&(t.y=h.y),o.x<h.x&&(o.x=h.x),o.y<h.y&&(o.y=h.y);return{min:t,max:o}}const Ua=8192;function Ol(l,t){const o=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(o*f*Ua),Math.round(h*f*Ua)]}function bl(l,t){for(let o=0;o<t.length;o++)if(Dl(l,t[o]))return!0;return!1}function Gc(l,t,o){for(const h of o)for(let f=0,m=h.length,v=m-1;f<m;v=f++)if(ga(l,t,h[v],h[f]))return!0;return!1}function qo(l,t){for(let o=0;o<l.length;++o)if(!Dl(l[o],t))return!1;for(let o=0;o<l.length-1;++o)if(Gc(l[o],l[o+1],t))return!1;return!0}function wl(l,t){for(let o=0;o<t.length;o++)if(qo(l,t[o]))return!0;return!1}function Fa(l,t,o){const h=[];for(let f=0;f<l.length;f++){const m=[];for(let v=0;v<l[f].length;v++){const C=Ol(l[f][v],o);Ia(t,C),m.push(C)}h.push(m)}return h}function Ul(l,t,o){const h=[];for(let f=0;f<l.length;f++){const m=Fa(l[f],t,o);h.push(m)}return h}function vu(l,t,o,h){if(l[0]<o[0]||l[0]>o[2]){const f=.5*h;let m=l[0]-o[0]>f?-h:o[0]-l[0]>f?h:0;m===0&&(m=l[0]-o[2]>f?-h:o[2]-l[0]>f?h:0),l[0]+=m}Ia(t,l)}function Ja(l,t,o,h){const f=Math.pow(2,h.z)*Ua,m=[h.x*Ua,h.y*Ua],v=[];if(!l)return v;for(const C of l)for(const I of C){const F=[I.x+m[0],I.y+m[1]];vu(F,t,o,f),v.push(F)}return v}function Uu(l,t,o,h){const f=Math.pow(2,h.z)*Ua,m=[h.x*Ua,h.y*Ua],v=[];if(!l)return v;for(const I of l){const F=[];for(const k of I){const z=[k.x+m[0],k.y+m[1]];Ia(t,z),F.push(z)}v.push(F)}if(t[2]-t[0]<=f/2){(C=t)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of v)for(const F of I)vu(F,t,o,f)}var C;return v}class jo{constructor(t,o){this.type=In,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Wr(t[1])){const h=t[1];if(h.type==="FeatureCollection")for(let f=0;f<h.features.length;++f){const m=h.features[f].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new jo(h,h.features[f].geometry)}else if(h.type==="Feature"){const f=h.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new jo(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new jo(h,h)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,h){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const C=Fa(h.coordinates,m,v),I=Ja(o.geometry(),f,m,v);if(!_o(f,m))return!1;for(const F of I)if(!Dl(F,C))return!1}if(h.type==="MultiPolygon"){const C=Ul(h.coordinates,m,v),I=Ja(o.geometry(),f,m,v);if(!_o(f,m))return!1;for(const F of I)if(!bl(F,C))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,h){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const C=Fa(h.coordinates,m,v),I=Uu(o.geometry(),f,m,v);if(!_o(f,m))return!1;for(const F of I)if(!qo(F,C))return!1}if(h.type==="MultiPolygon"){const C=Ul(h.coordinates,m,v),I=Uu(o.geometry(),f,m,v);if(!_o(f,m))return!1;for(const F of I)if(!wl(F,C))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const wc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},zl=1/298.257223563,_u=zl*(2-zl),rc=Math.PI/180;class Nl{static fromTile(t,o,h){const f=Math.PI*(1-2*(t+.5)/Math.pow(2,o)),m=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/rc;return new Nl(m,h)}static get units(){return wc}constructor(t,o){if(t===void 0)throw new Error("No latitude given.");if(o&&!wc[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(wc).join(", ")}`);const h=6378.137*rc*(o?wc[o]:1),f=Math.cos(t*rc),m=1/(1-_u*(1-f*f)),v=Math.sqrt(m);this.kx=h*v*f,this.ky=h*v*m*(1-_u)}distance(t,o){const h=Eo(t[0]-o[0])*this.kx,f=(t[1]-o[1])*this.ky;return Math.sqrt(h*h+f*f)}bearing(t,o){const h=Eo(o[0]-t[0])*this.kx;return Math.atan2(h,(o[1]-t[1])*this.ky)/rc}destination(t,o,h){const f=h*rc;return this.offset(t,Math.sin(f)*o,Math.cos(f)*o)}offset(t,o,h){return[t[0]+o/this.kx,t[1]+h/this.ky]}lineDistance(t){let o=0;for(let h=0;h<t.length-1;h++)o+=this.distance(t[h],t[h+1]);return o}area(t){let o=0;for(let h=0;h<t.length;h++){const f=t[h];for(let m=0,v=f.length,C=v-1;m<v;C=m++)o+=Eo(f[m][0]-f[C][0])*(f[m][1]+f[C][1])*(h?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(t,o){let h=0;if(o<=0)return t[0];for(let f=0;f<t.length-1;f++){const m=t[f],v=t[f+1],C=this.distance(m,v);if(h+=C,h>o)return xu(m,v,(o-(h-C))/C)}return t[t.length-1]}pointToSegmentDistance(t,o,h){let[f,m]=o,v=Eo(h[0]-f)*this.kx,C=(h[1]-m)*this.ky;if(v!==0||C!==0){const I=(Eo(t[0]-f)*this.kx*v+(t[1]-m)*this.ky*C)/(v*v+C*C);I>1?(f=h[0],m=h[1]):I>0&&(f+=v/this.kx*I,m+=C/this.ky*I)}return v=Eo(t[0]-f)*this.kx,C=(t[1]-m)*this.ky,Math.sqrt(v*v+C*C)}pointOnLine(t,o){let h=1/0,f=t[0][0],m=t[0][1],v=0,C=0;for(let I=0;I<t.length-1;I++){let F=t[I][0],k=t[I][1],z=Eo(t[I+1][0]-F)*this.kx,H=(t[I+1][1]-k)*this.ky,$=0;z===0&&H===0||($=(Eo(o[0]-F)*this.kx*z+(o[1]-k)*this.ky*H)/(z*z+H*H),$>1?(F=t[I+1][0],k=t[I+1][1]):$>0&&(F+=z/this.kx*$,k+=H/this.ky*$)),z=Eo(o[0]-F)*this.kx,H=(o[1]-k)*this.ky;const ee=z*z+H*H;ee<h&&(h=ee,f=F,m=k,v=I,C=$)}return{point:[f,m],index:v,t:Math.max(0,Math.min(1,C))}}lineSlice(t,o,h){let f=this.pointOnLine(h,t),m=this.pointOnLine(h,o);if(f.index>m.index||f.index===m.index&&f.t>m.t){const F=f;f=m,m=F}const v=[f.point],C=f.index+1,I=m.index;!Bc(h[C],v[0])&&C<=I&&v.push(h[C]);for(let F=C+1;F<=I;F++)v.push(h[F]);return Bc(h[I],m.point)||v.push(m.point),v}lineSliceAlong(t,o,h){let f=0;const m=[];for(let v=0;v<h.length-1;v++){const C=h[v],I=h[v+1],F=this.distance(C,I);if(f+=F,f>t&&m.length===0&&m.push(xu(C,I,(t-(f-F))/F)),f>=o)return m.push(xu(C,I,(o-(f-F))/F)),m;f>t&&m.push(I)}return m}bufferPoint(t,o){const h=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-h,t[0]+f,t[1]+h]}bufferBBox(t,o){const h=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-h,t[2]+f,t[3]+h]}insideBBox(t,o){return Eo(t[0]-o[0])>=0&&Eo(t[0]-o[2])<=0&&t[1]>=o[1]&&t[1]<=o[3]}}function Bc(l,t){return l[0]===t[0]&&l[1]===t[1]}function xu(l,t,o){const h=Eo(t[0]-l[0]);return[l[0]+h*o,l[1]+(t[1]-l[1])*o]}function Eo(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class el{constructor(t=[],o=(h,f)=>h<f?-1:h>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:h}=this,f=o[t];for(;t>0;){const m=t-1>>1,v=o[m];if(h(f,v)>=0)break;o[t]=v,t=m}o[t]=f}_down(t){const{data:o,compare:h}=this,f=this.length>>1,m=o[t];for(;t<f;){let v=1+(t<<1);const C=v+1;if(C<this.length&&h(o[C],o[v])<0&&(v=C),h(o[v],m)>=0)break;o[t]=o[v],t=v}o[t]=m}}var wi=8192;function no(l,t){return t.dist-l.dist}const xo=100,fo=50;function jl(l){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==l.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==l[o])return!1;return!0}function bu(l){return l[1]-l[0]+1}function za(l,t){const o=l[1]>=l[0]&&l[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function fh(l,t){if(l[0]>l[1])return[null,null];const o=bu(l);if(t){if(o===2)return[l,null];const h=Math.floor(o/2);return[[l[0],l[0]+h],[l[0]+h,l[1]]]}{if(o===1)return[l,null];const h=Math.floor(o/2)-1;return[[l[0],l[0]+h],[l[0]+h+1,l[1]]]}}function ll(l,t){const o=[1/0,1/0,-1/0,-1/0];if(!za(t,l.length))return o;for(let h=t[0];h<=t[1];++h)Ia(o,l[h]);return o}function gn(l){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<l.length;++o)for(let h=0;h<l[o].length;++h)Ia(t,l[o][h]);return t}function La(l,t,o){if(jl(l)||jl(t))return NaN;let h=0,f=0;return l[2]<t[0]&&(h=t[0]-l[2]),l[0]>t[2]&&(h=l[0]-t[2]),l[1]>t[3]&&(f=l[1]-t[3]),l[3]<t[1]&&(f=t[1]-l[3]),o.distance([0,0],[h,f])}function nc(l){return 360*l-180}function eA(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function ph(l,t){const o=Math.pow(2,t.z),h=(l.y/wi+t.y)/o;return[nc((l.x/wi+t.x)/o),eA(h)]}function gh(l,t){const o=[];for(let h=0;h<l.length;++h)o.push(ph(l[h],t));return o}function Ss(l,t,o){const h=o.pointOnLine(t,l).point;return o.distance(l,h)}function cd(l,t,o,h,f){const m=o.slice(h[0],h[1]+1);let v=1/0;for(let C=t[0];C<=t[1];++C)if((v=Math.min(v,Ss(l[C],m,f)))===0)return 0;return v}function zu(l,t,o,h,f){const m=Math.min(f.pointToSegmentDistance(l,o,h),f.pointToSegmentDistance(t,o,h)),v=Math.min(f.pointToSegmentDistance(o,l,t),f.pointToSegmentDistance(h,l,t));return Math.min(m,v)}function Ef(l,t,o,h,f){if(!za(t,l.length)||!za(h,o.length))return NaN;let m=1/0;for(let v=t[0];v<t[1];++v)for(let C=h[0];C<h[1];++C){if(ga(l[v],l[v+1],o[C],o[C+1]))return 0;m=Math.min(m,zu(l[v],l[v+1],o[C],o[C+1],f))}return m}function XA(l,t,o,h,f){if(!za(t,l.length)||!za(h,o.length))return NaN;let m=1/0;for(let v=t[0];v<=t[1];++v)for(let C=h[0];C<=h[1];++C)if((m=Math.min(m,f.distance(l[v],o[C])))===0)return m;return m}function YA(l,t,o){if(Dl(l,t,!0))return 0;let h=1/0;for(const f of t){const m=f.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[m-1]&&(h=Math.min(h,o.pointToSegmentDistance(l,f[m-1],f[0])))===0||(h=Math.min(h,Ss(l,f,o)))===0)return h}return h}function tA(l,t,o,h){if(!za(t,l.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Dl(l[m],o,!0))return 0;let f=1/0;for(let m=t[0];m<t[1];++m)for(const v of o)for(let C=0,I=v.length,F=I-1;C<I;F=C++){if(ga(l[m],l[m+1],v[F],v[C]))return 0;f=Math.min(f,zu(l[m],l[m+1],v[F],v[C],h))}return f}function mh(l,t){for(const o of l)for(let h=0;h<=o.length-1;++h)if(Dl(o[h],t,!0))return!0;return!1}function Ep(l,t,o,h=1/0){const f=gn(l),m=gn(t);if(h!==1/0&&La(f,m,o)>=h)return h;if(_o(f,m)){if(mh(l,t))return 0}else if(mh(t,l))return 0;let v=h;for(const C of l)for(let I=0,F=C.length,k=F-1;I<F;k=I++)for(const z of t)for(let H=0,$=z.length,ee=$-1;H<$;ee=H++){if(ga(C[k],C[I],z[ee],z[H]))return 0;v=Math.min(v,zu(C[k],C[I],z[ee],z[H],o))}return v}function iA(l,t,o,h,f,m,v){if(m===null||v===null)return;const C=La(ll(h,m),ll(f,v),o);C<t&&l.push({dist:C,range1:m,range2:v})}function Tf(l,t,o,h,f=1/0){let m=Math.min(h.distance(l[0],o[0][0]),f);if(m===0)return m;const v=new el([{dist:0,range1:[0,l.length-1],range2:[0,0]}],no),C=t?fo:xo,I=gn(o);for(;v.length;){const F=v.pop();if(F.dist>=m)continue;const k=F.range1;if(bu(k)<=C){if(!za(k,l.length))return NaN;if(t){const z=tA(l,k,o,h);if((m=Math.min(m,z))===0)return m}else for(let z=k[0];z<=k[1];++z){const H=YA(l[z],o,h);if((m=Math.min(m,H))===0)return m}}else{const z=fh(k,t);if(z[0]!==null){const H=La(ll(l,z[0]),I,h);H<m&&v.push({dist:H,range1:z[0],range2:[0,0]})}if(z[1]!==null){const H=La(ll(l,z[1]),I,h);H<m&&v.push({dist:H,range1:z[1],range2:[0,0]})}}}return m}function If(l,t,o,h,f,m=1/0){let v=Math.min(m,f.distance(l[0],o[0]));if(v===0)return v;const C=new el([{dist:0,range1:[0,l.length-1],range2:[0,o.length-1]}],no),I=t?fo:xo,F=h?fo:xo;for(;C.length;){const k=C.pop();if(k.dist>=v)continue;const z=k.range1,H=k.range2;if(bu(z)<=I&&bu(H)<=F){if(!za(z,l.length)||!za(H,o.length))return NaN;if(t&&h?v=Math.min(v,Ef(l,z,o,H,f)):t||h?t&&!h?v=Math.min(v,cd(o,H,l,z,f)):!t&&h&&(v=Math.min(v,cd(l,z,o,H,f))):v=Math.min(v,XA(l,z,o,H,f)),v===0)return v}else{const $=fh(z,t),ee=fh(H,h);iA(C,v,f,l,o,$[0],ee[0]),iA(C,v,f,l,o,$[0],ee[1]),iA(C,v,f,l,o,$[1],ee[0]),iA(C,v,f,l,o,$[1],ee[1])}}return v}function Vh(l,t,o,h,f=1/0){let m=f;const v=ll(l,[0,l.length-1]);for(const C of o)if(!(m!==1/0&&La(v,ll(C,[0,C.length-1]),h)>=m)&&(m=Math.min(m,If(l,t,C,!0,h,m)),m===0))return m;return m}function rA(l,t,o,h,f=1/0){let m=f;const v=ll(l,[0,l.length-1]);for(const C of o){if(m!==1/0&&La(v,gn(C),h)>=m)continue;const I=Tf(l,t,C,h,m);if(isNaN(I))return I;if((m=Math.min(m,I))===0)return m}return m}function KA(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class yh{constructor(t,o){this.type=hr,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Wr(t[1])){const h=t[1];if(h.type==="FeatureCollection"){for(let f=0;f<h.features.length;++f)if(KA(h.features[f].geometry.type))return new yh(h,h.features[f].geometry)}else if(h.type==="Feature"){if(KA(h.geometry.type))return new yh(h,h.geometry)}else if(KA(h.type))return new yh(h,h)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),h=t.canonicalID();if(o!=null&&h!=null){if(t.geometryType()==="Point")return function(f,m,v){const C=[];for(const F of f)for(const k of F)C.push(ph(k,m));const I=new Nl(C[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?If(C,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",I):v.type==="MultiLineString"?Vh(C,!1,v.coordinates,I):v.type==="Polygon"||v.type==="MultiPolygon"?rA(C,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,I):null}(o,h,this.geometries);if(t.geometryType()==="LineString")return function(f,m,v){const C=[];for(const F of f){const k=[];for(const z of F)k.push(ph(z,m));C.push(k)}const I=new Nl(C[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Vh(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,I);if(v.type==="MultiLineString"){let F=1/0;for(let k=0;k<v.coordinates.length;k++){const z=Vh(v.coordinates[k],!0,C,I,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}if(v.type==="Polygon"||v.type==="MultiPolygon"){let F=1/0;for(let k=0;k<C.length;k++){const z=rA(C[k],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,I,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}return null}(o,h,this.geometries);if(t.geometryType()==="Polygon")return function(f,m,v){const C=[];for(const F of function(k,z){const H=k.length;if(H<=1)return[k];const $=[];let ee,ae;for(let Ae=0;Ae<H;Ae++){const ve=Rl(k[Ae]);ve!==0&&(k[Ae].area=Math.abs(ve),ae===void 0&&(ae=ve<0),ae===ve<0?(ee&&$.push(ee),ee=[k[Ae]]):ee.push(k[Ae]))}return ee&&$.push(ee),$}(f)){const k=[];for(let z=0;z<F.length;++z)k.push(gh(F[z],m));C.push(k)}const I=new Nl(C[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return rA(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,I);if(v.type==="MultiLineString"){let F=1/0;for(let k=0;k<v.coordinates.length;k++){const z=rA(v.coordinates[k],!0,C,I,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}return v.type==="Polygon"||v.type==="MultiPolygon"?function(F,k,z){let H=1/0;for(const $ of F)for(const ee of k){const ae=Ep($,ee,z,H);if(isNaN(ae))return ae;if((H=Math.min(H,ae))===0)return H}return H}(v.type==="Polygon"?[v.coordinates]:v.coordinates,C,I):null}(o,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Nu(l){if(l instanceof So&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof jo||l instanceof yh)return!1;if(l instanceof Wh)return l.featureConstant;let t=!0;return l.eachChild(o=>{t&&!Nu(o)&&(t=!1)}),t}function wu(l){if(l instanceof So&&l.name==="feature-state")return!1;let t=!0;return l.eachChild(o=>{t&&!wu(o)&&(t=!1)}),t}function ju(l){if(l instanceof Wh)return new Set([l.key]);let t=new Set;return l.eachChild(o=>{t=new Set([...t,...ju(o)])}),t}function Gh(l,t){if(l instanceof So&&t.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(h=>{o&&!Gh(h,t)&&(o=!1)}),o}function Ff(l,t,o){return[l,t,o].filter(Boolean).join("")}function nA(l,t){switch(l){case"string":return eo(t);case"number":return+t;case"boolean":return!!t;case"color":return Un.parse(t);case"formatted":return Zn.fromString(eo(t));case"resolvedImage":return Js.build(eo(t))}return t}function Lf(l,t,o,h){return h!==void 0&&(l=h*Math.round(l/h)),t!==void 0&&l<t&&(l=t),o!==void 0&&l>o&&(l=o),l}class Wh{constructor(t,o,h,f=!1){this.type=t,this.key=o,this.scope=h,this.featureConstant=f}static parse(t,o){let h=o.expectedType;if(h==null&&(h=ie),t.length<2||t.length>3)return o.error("Invalid number of arguments for 'config' expression.");const f=o.parse(t[1],1);if(!(f instanceof Pr))return o.error("Key name of 'config' expression must be a string literal.");let m,v=!0;const C=eo(f.value);if(t.length>=3){const I=o.parse(t[2],2);if(!(I instanceof Pr))return o.error("Scope of 'config' expression must be a string literal.");m=eo(I.value)}if(o.options){const I=Ff(C,m,o._scope),F=o.options.get(I);F&&(v=Nu(F.value||F.default))}return new Wh(h,C,m,v)}evaluate(t){const o=Ff(this.key,this.scope,t.scope),h=t.getConfig(o);if(!h)return null;const{type:f,value:m,values:v,minValue:C,maxValue:I,stepValue:F}=h,k=h.default.evaluate(t);let z=k;if(m){const H=t.scope;t.scope=(H||"").split("").slice(1).join(""),z=m.evaluate(t),t.scope=H}return f&&(z=nA(f,z)),z===void 0||C===void 0&&I===void 0&&F===void 0||(typeof z=="number"?z=Lf(z,C,I,F):Array.isArray(z)&&(z=z.map(H=>typeof H=="number"?Lf(H,C,I,F):H))),m!==void 0&&z!==void 0&&v&&!v.includes(z)&&(z=k,f&&(z=nA(f,z))),(f&&f!==this.type||z!==void 0&&!kn(ji(z),this.type))&&(z=nA(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.scope),t}}class sA{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const h=t[1];return o.scope.has(h)?new sA(h,o.scope.get(h)):o.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class oA{constructor(t,o=[],h,f=new Qh,m=[],v,C){this.registry=t,this.path=o,this.key=o.map(I=>typeof I=="string"?`['${I}']`:`[${I}]`).join(""),this.scope=f,this.errors=m,this.expectedType=h,this._scope=v,this.options=C}parse(t,o,h,f,m={}){return o||h?this.concat(o,null,h,f)._parse(t,m):this._parse(t,m)}parseObjectValue(t,o,h,f,m,v={}){return this.concat(o,h,f,m)._parse(t,v)}_parse(t,o){function h(f,m,v){return v==="assert"?new wr(m,[f]):v==="coerce"?new Jn(m,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(f){let m=f.parse(t,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,C=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||C.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(v,C))return null}else m=h(m,v,o.typeAnnotation||"coerce");else m=h(m,v,o.typeAnnotation||"assert")}if(!(m instanceof Pr)&&m.type.kind!=="resolvedImage"&&Wc(m)){const v=new xc(this._scope,this.options);try{m=new Pr(m.type,m.evaluate(v))}catch(C){return this.error(C.message),null}}return m}return Jn.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,h,f){let m=typeof t=="number"?this.path.concat(t):this.path;m=typeof o=="string"?m.concat(o):m;const v=f?this.scope.concat(f):this.scope;return new oA(this.registry,m,h||null,v,this.errors,this._scope,this.options)}error(t,...o){const h=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new Da(h,t))}checkSubtype(t,o){const h=Vr(t,o);return h&&this.error(h),h}}function Wc(l){if(l instanceof sA)return Wc(l.boundExpression);if(l instanceof So&&l.name==="error"||l instanceof al||l instanceof jo||l instanceof yh||l instanceof Wh)return!1;const t=l instanceof Jn||l instanceof wr;let o=!0;return l.eachChild(h=>{o=t?o&&Wc(h):o&&h instanceof Pr}),!!o&&Nu(l)&&Gh(l,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Bl(l,t){const o=l.length-1;let h,f,m=0,v=o,C=0;for(;m<=v;)if(C=Math.floor((m+v)/2),h=l[C],f=l[C+1],h<=t){if(C===o||t<f)return C;m=C+1}else{if(!(h>t))throw new Cs("Input is not a number.");v=C-1}return 0}class tl{constructor(t,o,h){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[f,m]of h)this.labels.push(f),this.outputs.push(m)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const h=o.parse(t[1],1,hr);if(!h)return null;const f=[];let m=null;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);for(let v=1;v<t.length;v+=2){const C=v===1?-1/0:t[v],I=t[v+1],F=v,k=v+1;if(typeof C!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(f.length&&f[f.length-1][0]>=C)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const z=o.parse(I,k,m);if(!z)return null;m=m||z.type,f.push([C,z])}return new tl(m,h,f)}evaluate(t){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return h[0].evaluate(t);const m=o.length;return f>=o[m-1]?h[m-1].evaluate(t):h[Bl(o,f)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}const Mf=.95047,qA=1.08883,Xc=4/29,Ba=6/29,Pf=3*Ba*Ba,aA=Ba*Ba*Ba,ud=Math.PI/180,kf=180/Math.PI;function lA(l){return l>aA?Math.pow(l,1/3):l/Pf+Xc}function hd(l){return l>Ba?l*l*l:Pf*(l-Xc)}function cA(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Cc(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Xh(l){const t=Cc(l.r),o=Cc(l.g),h=Cc(l.b),f=lA((.4124564*t+.3575761*o+.1804375*h)/Mf),m=lA((.2126729*t+.7151522*o+.072175*h)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-lA((.0193339*t+.119192*o+.9503041*h)/qA)),alpha:l.a}}function Yc(l){let t=(l.l+16)/116,o=isNaN(l.a)?t:t+l.a/500,h=isNaN(l.b)?t:t-l.b/200;return t=1*hd(t),o=Mf*hd(o),h=qA*hd(h),new Un(cA(3.2404542*o-1.5371385*t-.4985314*h),cA(-.969266*o+1.8760108*t+.041556*h),cA(.0556434*o-.2040259*t+1.0572252*h),l.alpha)}function $A(l,t,o){const h=t-l;return l+o*(h>180||h<-180?h-360*Math.round(h/360):h)}const vh={forward:Xh,reverse:Yc,interpolate:function(l,t,o){return{l:Er(l.l,t.l,o),a:Er(l.a,t.a,o),b:Er(l.b,t.b,o),alpha:Er(l.alpha,t.alpha,o)}}},Hu={forward:function(l){const{l:t,a:o,b:h}=Xh(l),f=Math.atan2(h,o)*kf;return{h:f<0?f+360:f,c:Math.sqrt(o*o+h*h),l:t,alpha:l.a}},reverse:function(l){const t=l.h*ud,o=l.c;return Yc({l:l.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:l.alpha})},interpolate:function(l,t,o){return{h:$A(l.h,t.h,o),c:Er(l.c,t.c,o),l:Er(l.l,t.l,o),alpha:Er(l.alpha,t.alpha,o)}}};var Rf=Object.freeze({__proto__:null,hcl:Hu,lab:vh});class Hl{constructor(t,o,h,f,m){this.type=t,this.operator=o,this.interpolation=h,this.input=f,this.labels=[],this.outputs=[];for(const[v,C]of m)this.labels.push(v),this.outputs.push(C)}static interpolationFactor(t,o,h,f){let m=0;if(t.name==="exponential")m=uA(o,t.base,h,f);else if(t.name==="linear")m=uA(o,1,h,f);else if(t.name==="cubic-bezier"){const v=t.controlPoints;m=new Lr(v[0],v[1],v[2],v[3]).solve(uA(o,1,h,f))}return m}static parse(t,o){let[h,f,m,...v]=t;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const F=f[1];if(typeof F!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:F}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const F=f.slice(1);if(F.length!==4||F.some(k=>typeof k!="number"||k<0||k>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:F}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length-1>3&&(t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,hr),!m)return null;const C=[];let I=null;h==="interpolate-hcl"||h==="interpolate-lab"?I=na:o.expectedType&&o.expectedType.kind!=="value"&&(I=o.expectedType);for(let F=0;F<v.length;F+=2){const k=v[F],z=v[F+1],H=F+3,$=F+4;if(typeof k!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(C.length&&C[C.length-1][0]>=k)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const ee=o.parse(z,$,I);if(!ee)return null;I=I||ee.type,C.push([k,ee])}return I.kind==="number"||I.kind==="color"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new Hl(I,h,f,m,C):o.error(`Type ${Ti(I)} is not interpolatable.`)}evaluate(t){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return h[0].evaluate(t);const m=o.length;if(f>=o[m-1])return h[m-1].evaluate(t);const v=Bl(o,f),C=Hl.interpolationFactor(this.interpolation,f,o[v],o[v+1]),I=h[v].evaluate(t),F=h[v+1].evaluate(t);return this.operator==="interpolate"?Vc[this.type.kind.toLowerCase()](I,F,C):this.operator==="interpolate-hcl"?Hu.reverse(Hu.interpolate(Hu.forward(I),Hu.forward(F),C)):vh.reverse(vh.interpolate(vh.forward(I),vh.forward(F),C))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,t,this.input.serialize()];for(let h=0;h<this.labels.length;h++)o.push(this.labels[h],this.outputs[h].serialize());return o}}function uA(l,t,o,h){const f=h-o,m=l-o;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}class dd{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let h=null;const f=o.expectedType;f&&f.kind!=="value"&&(h=f);const m=[];for(const C of t.slice(1)){const I=o.parse(C,1+m.length,h,void 0,{typeAnnotation:"omit"});if(!I)return null;h=h||I.type,m.push(I)}const v=f&&m.some(C=>Vr(f,C.type));return new dd(v?ie:h,m)}evaluate(t){let o,h=null,f=0;for(const m of this.args){if(f++,h=m.evaluate(t),h&&h instanceof Js&&!h.available&&(o||(o=h),h=null,f===this.args.length))return o;if(h!==null)break}return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class hA{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let m=1;m<t.length-1;m+=2){const v=t[m];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,m);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const C=o.parse(t[m+1],m+1);if(!C)return null;h.push([v,C])}const f=o.parse(t[t.length-1],t.length-1,o.expectedType,h);return f?new hA(h,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,h]of this.bindings)t.push(o,h.serialize());return t.push(this.result.serialize()),t}}class ZA{constructor(t,o,h){this.type=t,this.index=o,this.input=h}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,hr),f=o.parse(t[2],2,hi(o.expectedType||ie));return h&&f?new ZA(f.type.itemType,h,f):null}evaluate(t){const o=this.index.evaluate(t),h=this.input.evaluate(t);if(o<0)throw new Cs(`Array index out of bounds: ${o} < 0.`);if(o>=h.length)throw new Cs(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o!==Math.floor(o))throw new Cs(`Array index must be an integer, but found ${o} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class dA{constructor(t,o,h){this.type=t,this.index=o,this.input=h}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,hr),f=o.parse(t[2],2,hi(o.expectedType||ie));return h&&f?new dA(f.type.itemType,h,f):null}evaluate(t){const o=this.index.evaluate(t),h=this.input.evaluate(t);if(o<0)throw new Cs(`Array index out of bounds: ${o} < 0.`);if(o>h.length-1)throw new Cs(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o===Math.floor(o))return h[o];const f=Math.floor(o),m=Math.ceil(o),v=h[f],C=h[m];if(typeof v!="number"||typeof C!="number")throw new Cs(`Cannot interpolate between non-number values at index ${o}.`);const I=o-f;return v*(1-I)+C*I}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class _h{constructor(t,o){this.type=In,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,ie),f=o.parse(t[2],2,ie);return h&&f?cn(h.type,[In,Mn,hr,Ou,ie])?new _h(h,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(h.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(h==null)return!1;if(!Pn(o,["boolean","string","number","null"]))throw new Cs(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(ji(o))} instead.`);if(!Pn(h,["string","array"]))throw new Cs(`Expected second argument to be of type array or string, but found ${Ti(ji(h))} instead.`);return h.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ad{constructor(t,o,h){this.type=hr,this.needle=t,this.haystack=o,this.fromIndex=h}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,ie),f=o.parse(t[2],2,ie);if(!h||!f)return null;if(!cn(h.type,[In,Mn,hr,Ou,ie]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(h.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,hr);return m?new Ad(h,f,m):null}return new Ad(h,f)}evaluate(t){const o=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!Pn(o,["boolean","string","number","null"]))throw new Cs(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(ji(o))} instead.`);if(!Pn(h,["string","array"]))throw new Cs(`Expected second argument to be of type array or string, but found ${Ti(ji(h))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return h.indexOf(o,f)}return h.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class xh{constructor(t,o,h,f,m,v){this.inputType=t,this.type=o,this.input=h,this.cases=f,this.outputs=m,this.otherwise=v}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let h,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const m={},v=[];for(let F=2;F<t.length-1;F+=2){let k=t[F];const z=t[F+1];Array.isArray(k)||(k=[k]);const H=o.concat(F);if(k.length===0)return H.error("Expected at least one branch label.");for(const ee of k){if(typeof ee!="number"&&typeof ee!="string")return H.error("Branch labels must be numbers or strings.");if(typeof ee=="number"&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ee=="number"&&Math.floor(ee)!==ee)return H.error("Numeric branch labels must be integer values.");if(h){if(H.checkSubtype(h,ji(ee)))return null}else h=ji(ee);if(m[String(ee)]!==void 0)return H.error("Branch labels must be unique.");m[String(ee)]=v.length}const $=o.parse(z,F,f);if(!$)return null;f=f||$.type,v.push($)}const C=o.parse(t[1],1,ie);if(!C)return null;const I=o.parse(t[t.length-1],t.length-1,f);return I?C.type.kind!=="value"&&o.concat(1).checkSubtype(h,C.type)?null:new xh(h,f,C,m,v,I):null}evaluate(t){const o=this.input.evaluate(t);return(kn(ji(o),this.inputType)&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),h=[],f={};for(const v of o){const C=f[this.cases[v]];C===void 0?(f[this.cases[v]]=h.length,h.push([this.cases[v],[v]])):h[C][1].push(v)}const m=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,C]of h)t.push(C.length===1?m(C[0]):C.map(m)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}class AA{constructor(t,o,h){this.type=t,this.branches=o,this.otherwise=h}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const f=[];for(let v=1;v<t.length-1;v+=2){const C=o.parse(t[v],v,In);if(!C)return null;const I=o.parse(t[v+1],v+1,h);if(!I)return null;f.push([C,I]),h=h||I.type}const m=o.parse(t[t.length-1],t.length-1,h);return m?new AA(h,f,m):null}evaluate(t){for(const[o,h]of this.branches)if(o.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,h]of this.branches)t(o),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class D{constructor(t,o,h,f){this.type=t,this.input=o,this.beginIndex=h,this.endIndex=f}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,ie),f=o.parse(t[2],2,hr);if(!h||!f)return null;if(!cn(h.type,[hi(ie),Mn,ie]))return o.error(`Expected first argument to be of type array or string, but found ${Ti(h.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,hr);return m?new D(h.type,h,f,m):null}return new D(h.type,h,f)}evaluate(t){const o=this.input.evaluate(t),h=this.beginIndex.evaluate(t);if(!Pn(o,["string","array"]))throw new Cs(`Expected first argument to be of type array or string, but found ${Ti(ji(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return o.slice(h,f)}return o.slice(h)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function K(l,t){return l==="=="||l==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function se(l,t,o,h){return h.compare(t,o)===0}function xe(l,t,o){const h=l!=="=="&&l!=="!=";return class BI{constructor(m,v,C){this.type=In,this.lhs=m,this.rhs=v,this.collator=C,this.hasUntypedArgument=m.type.kind==="value"||v.type.kind==="value"}static parse(m,v){if(m.length!==3&&m.length!==4)return v.error("Expected two or three arguments.");const C=m[0];let I=v.parse(m[1],1,ie);if(!I)return null;if(!K(C,I.type))return v.concat(1).error(`"${C}" comparisons are not supported for type '${Ti(I.type)}'.`);let F=v.parse(m[2],2,ie);if(!F)return null;if(!K(C,F.type))return v.concat(2).error(`"${C}" comparisons are not supported for type '${Ti(F.type)}'.`);if(I.type.kind!==F.type.kind&&I.type.kind!=="value"&&F.type.kind!=="value")return v.error(`Cannot compare types '${Ti(I.type)}' and '${Ti(F.type)}'.`);h&&(I.type.kind==="value"&&F.type.kind!=="value"?I=new wr(F.type,[I]):I.type.kind!=="value"&&F.type.kind==="value"&&(F=new wr(I.type,[F])));let k=null;if(m.length===4){if(I.type.kind!=="string"&&F.type.kind!=="string"&&I.type.kind!=="value"&&F.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(k=v.parse(m[3],3,Ue),!k)return null}return new BI(I,F,k)}evaluate(m){const v=this.lhs.evaluate(m),C=this.rhs.evaluate(m);if(h&&this.hasUntypedArgument){const I=ji(v),F=ji(C);if(I.kind!==F.kind||I.kind!=="string"&&I.kind!=="number")throw new Cs(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${I.kind}, ${F.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const I=ji(v),F=ji(C);if(I.kind!=="string"||F.kind!=="string")return t(m,v,C)}return this.collator?o(m,v,C,this.collator.evaluate(m)):t(m,v,C)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[l];return this.eachChild(v=>{m.push(v.serialize())}),m}}}const Oe=xe("==",function(l,t,o){return t===o},se),We=xe("!=",function(l,t,o){return t!==o},function(l,t,o,h){return!se(0,t,o,h)}),$e=xe("<",function(l,t,o){return t<o},function(l,t,o,h){return h.compare(t,o)<0}),nt=xe(">",function(l,t,o){return t>o},function(l,t,o,h){return h.compare(t,o)>0}),ct=xe("<=",function(l,t,o){return t<=o},function(l,t,o,h){return h.compare(t,o)<=0}),xt=xe(">=",function(l,t,o){return t>=o},function(l,t,o,h){return h.compare(t,o)>=0});class Xt{constructor(t,o,h,f,m,v){this.type=Mn,this.number=t,this.locale=o,this.currency=h,this.unit=f,this.minFractionDigits=m,this.maxFractionDigits=v}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const h=o.parse(t[1],1,hr);if(!h)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let m=null;if(f.locale&&(m=o.parseObjectValue(f.locale,2,"locale",Mn),!m))return null;let v=null;if(f.currency&&(v=o.parseObjectValue(f.currency,2,"currency",Mn),!v))return null;let C=null;if(f.unit&&(C=o.parseObjectValue(f.unit,2,"unit",Mn),!C))return null;let I=null;if(f["min-fraction-digits"]&&(I=o.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",hr),!I))return null;let F=null;return f["max-fraction-digits"]&&(F=o.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",hr),!F)?null:new Xt(h,m,v,C,I,F)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class xi{constructor(t){this.type=hr,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=o.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Ti(h.type)} instead.`):new xi(h):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Cs(`Expected value to be of type string or array, but found ${Ti(ji(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(o=>{t.push(o.serialize())}),t}}function Bi(l){return function(){l=1831565813+(l|=0)|0;let t=Math.imul(l^l>>>15,1|l);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const ci={"==":Oe,"!=":We,">":nt,"<":$e,">=":xt,"<=":ct,array:wr,at:ZA,"at-interpolated":dA,boolean:wr,case:AA,coalesce:dd,collator:al,format:vo,image:ic,in:_h,"index-of":Ad,interpolate:Hl,"interpolate-hcl":Hl,"interpolate-lab":Hl,length:xi,let:hA,literal:Pr,match:xh,number:wr,"number-format":Xt,object:wr,slice:D,step:tl,string:wr,"to-boolean":Jn,"to-color":Jn,"to-number":Jn,"to-string":Jn,var:sA,within:jo,distance:yh,config:Wh};function Hi(l,[t,o,h,f]){t=t.evaluate(l),o=o.evaluate(l),h=h.evaluate(l);const m=f?f.evaluate(l):1,v=yo(t,o,h,m);if(v)throw new Cs(v);return new Un(t/255,o/255,h/255,m)}function Ni(l,[t,o,h,f]){t=t.evaluate(l),o=o.evaluate(l),h=h.evaluate(l);const m=f?f.evaluate(l):1,v=function(F,k,z,H){return typeof F=="number"&&F>=0&&F<=360?typeof k=="number"&&k>=0&&k<=100&&typeof z=="number"&&z>=0&&z<=100?H===void 0||typeof H=="number"&&H>=0&&H<=1?null:`Invalid hsla value [${[F,k,z,H].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof H=="number"?[F,k,z,H]:[F,k,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof H=="number"?[F,k,z,H]:[F,k,z]).join(", ")}]: 'h' must be between 0 and 360.`}(t,o,h,m);if(v)throw new Cs(v);const C=`hsla(${t}, ${o}%, ${h}%, ${m})`,I=Un.parse(C);if(!I)throw new Cs(`Failed to parse HSLA color: ${C}`);return I}function Zt(l,t){return l in t}function ei(l,t){const o=t[l];return o===void 0?null:o}function qi(l){return{type:l}}function lr(l){return{result:"success",value:l}}function $i(l){return{result:"error",value:l}}function Xr(l,t){return!!l&&!!l.parameters&&l.parameters.indexOf(t)>-1}function Ir(l){return l["property-type"]==="data-driven"}function bn(l){return Xr(l.expression,"measure-light")}function zr(l){return Xr(l.expression,"zoom")}function Fs(l){return!!l.expression&&l.expression.interpolated}function Qs(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function Ls(l){return l}function dr(l,t){const o=t.type==="color",h=l.stops&&typeof l.stops[0][0]=="object",f=h||!(h||l.property!==void 0),m=l.type||(Fs(t)?"exponential":"interval");if(o&&((l=_c({},l)).stops&&(l.stops=l.stops.map(F=>[F[0],Un.parse(F[1])])),l.default=Un.parse(l.default?l.default:t.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Rf[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let v,C,I;if(m==="exponential")v=qs;else if(m==="interval")v=Vn;else if(m==="categorical"){v=lo,C=Object.create(null);for(const F of l.stops)C[F[0]]=F[1];I=typeof l.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=Cl}if(h){const F={},k=[];for(let $=0;$<l.stops.length;$++){const ee=l.stops[$],ae=ee[0].zoom;F[ae]===void 0&&(F[ae]={zoom:ae,type:l.type,property:l.property,default:l.default,stops:[]},k.push(ae)),F[ae].stops.push([ee[0].value,ee[1]])}const z=[];for(const $ of k)z.push([F[$].zoom,dr(F[$],t)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Hl.interpolationFactor.bind(void 0,H),zoomStops:z.map($=>$[0]),evaluate:({zoom:$},ee)=>qs({stops:z,base:l.base},t,$).evaluate($,ee)}}if(f){const F=m==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Hl.interpolationFactor.bind(void 0,F),zoomStops:l.stops.map(k=>k[0]),evaluate:({zoom:k})=>v(l,t,k,C,I)}}return{kind:"source",evaluate(F,k){const z=k&&k.properties?k.properties[l.property]:void 0;return z===void 0?gs(l.default,t.default):v(l,t,z,C,I)}}}function gs(l,t,o){return l!==void 0?l:t!==void 0?t:o!==void 0?o:void 0}function lo(l,t,o,h,f){return gs(typeof o===f?h[o]:void 0,l.default,t.default)}function Vn(l,t,o){if(pa(o)!=="number")return gs(l.default,t.default);const h=l.stops.length;if(h===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[h-1][0])return l.stops[h-1][1];const f=Bl(l.stops.map(m=>m[0]),o);return l.stops[f][1]}function qs(l,t,o){const h=l.base!==void 0?l.base:1;if(pa(o)!=="number")return gs(l.default,t.default);const f=l.stops.length;if(f===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[f-1][0])return l.stops[f-1][1];const m=Bl(l.stops.map(k=>k[0]),o),v=function(k,z,H,$){const ee=$-H,ae=k-H;return ee===0?0:z===1?ae/ee:(Math.pow(z,ae)-1)/(Math.pow(z,ee)-1)}(o,h,l.stops[m][0],l.stops[m+1][0]),C=l.stops[m][1],I=l.stops[m+1][1];let F=Vc[t.type]||Ls;if(l.colorSpace&&l.colorSpace!=="rgb"){const k=Rf[l.colorSpace];F=(z,H)=>k.reverse(k.interpolate(k.forward(z),k.forward(H),v))}return typeof C.evaluate=="function"?{evaluate(...k){const z=C.evaluate.apply(void 0,k),H=I.evaluate.apply(void 0,k);if(z!==void 0&&H!==void 0)return F(z,H,v)}}:F(C,I,v)}function Cl(l,t,o){return t.type==="color"?o=Un.parse(o):t.type==="formatted"?o=Zn.fromString(o.toString()):t.type==="resolvedImage"?o=Js.build(o.toString()):pa(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),gs(o,l.default,t.default)}So.register(ci,{error:[{kind:"error"},[Mn],(l,[t])=>{throw new Cs(t.evaluate(l))}],typeof:[Mn,[ie],(l,[t])=>Ti(ji(t.evaluate(l)))],"to-rgba":[hi(hr,4),[na],(l,[t])=>t.evaluate(l).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[hi(hr,4),[na],(l,[t])=>t.evaluate(l).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[na,[hr,hr,hr],Hi],rgba:[na,[hr,hr,hr,hr],Hi],hsl:[na,[hr,hr,hr],Ni],hsla:[na,[hr,hr,hr,hr],Ni],has:{type:In,overloads:[[[Mn],(l,[t])=>Zt(t.evaluate(l),l.properties())],[[Mn,kl],(l,[t,o])=>Zt(t.evaluate(l),o.evaluate(l))]]},get:{type:ie,overloads:[[[Mn],(l,[t])=>ei(t.evaluate(l),l.properties())],[[Mn,kl],(l,[t,o])=>ei(t.evaluate(l),o.evaluate(l))]]},"feature-state":[ie,[Mn],(l,[t])=>ei(t.evaluate(l),l.featureState||{})],properties:[kl,[],l=>l.properties()],"geometry-type":[Mn,[],l=>l.geometryType()],worldview:[Mn,[],l=>l.globals.worldview||""],id:[ie,[],l=>l.id()],zoom:[hr,[],l=>l.globals.zoom],pitch:[hr,[],l=>l.globals.pitch||0],"distance-from-center":[hr,[],l=>l.distanceFromCenter()],"measure-light":[hr,[Mn],(l,[t])=>l.measureLight(t.evaluate(l))],"heatmap-density":[hr,[],l=>l.globals.heatmapDensity||0],"line-progress":[hr,[],l=>l.globals.lineProgress||0],"raster-value":[hr,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[hr,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[hr,[],l=>l.globals.skyRadialProgress||0],accumulated:[ie,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[hr,qi(hr),(l,t)=>{let o=0;for(const h of t)o+=h.evaluate(l);return o}],"*":[hr,qi(hr),(l,t)=>{let o=1;for(const h of t)o*=h.evaluate(l);return o}],"-":{type:hr,overloads:[[[hr,hr],(l,[t,o])=>t.evaluate(l)-o.evaluate(l)],[[hr],(l,[t])=>-t.evaluate(l)]]},"/":[hr,[hr,hr],(l,[t,o])=>t.evaluate(l)/o.evaluate(l)],"%":[hr,[hr,hr],(l,[t,o])=>t.evaluate(l)%o.evaluate(l)],ln2:[hr,[],()=>Math.LN2],pi:[hr,[],()=>Math.PI],e:[hr,[],()=>Math.E],"^":[hr,[hr,hr],(l,[t,o])=>Math.pow(t.evaluate(l),o.evaluate(l))],sqrt:[hr,[hr],(l,[t])=>Math.sqrt(t.evaluate(l))],log10:[hr,[hr],(l,[t])=>Math.log(t.evaluate(l))/Math.LN10],ln:[hr,[hr],(l,[t])=>Math.log(t.evaluate(l))],log2:[hr,[hr],(l,[t])=>Math.log(t.evaluate(l))/Math.LN2],sin:[hr,[hr],(l,[t])=>Math.sin(t.evaluate(l))],cos:[hr,[hr],(l,[t])=>Math.cos(t.evaluate(l))],tan:[hr,[hr],(l,[t])=>Math.tan(t.evaluate(l))],asin:[hr,[hr],(l,[t])=>Math.asin(t.evaluate(l))],acos:[hr,[hr],(l,[t])=>Math.acos(t.evaluate(l))],atan:[hr,[hr],(l,[t])=>Math.atan(t.evaluate(l))],min:[hr,qi(hr),(l,t)=>Math.min(...t.map(o=>o.evaluate(l)))],max:[hr,qi(hr),(l,t)=>Math.max(...t.map(o=>o.evaluate(l)))],abs:[hr,[hr],(l,[t])=>Math.abs(t.evaluate(l))],round:[hr,[hr],(l,[t])=>{const o=t.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[hr,[hr],(l,[t])=>Math.floor(t.evaluate(l))],ceil:[hr,[hr],(l,[t])=>Math.ceil(t.evaluate(l))],"filter-==":[In,[Mn,ie],(l,[t,o])=>l.properties()[t.value]===o.value],"filter-id-==":[In,[ie],(l,[t])=>l.id()===t.value],"filter-type-==":[In,[Mn],(l,[t])=>l.geometryType()===t.value],"filter-<":[In,[Mn,ie],(l,[t,o])=>{const h=l.properties()[t.value],f=o.value;return typeof h==typeof f&&h<f}],"filter-id-<":[In,[ie],(l,[t])=>{const o=l.id(),h=t.value;return typeof o==typeof h&&o<h}],"filter->":[In,[Mn,ie],(l,[t,o])=>{const h=l.properties()[t.value],f=o.value;return typeof h==typeof f&&h>f}],"filter-id->":[In,[ie],(l,[t])=>{const o=l.id(),h=t.value;return typeof o==typeof h&&o>h}],"filter-<=":[In,[Mn,ie],(l,[t,o])=>{const h=l.properties()[t.value],f=o.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[In,[ie],(l,[t])=>{const o=l.id(),h=t.value;return typeof o==typeof h&&o<=h}],"filter->=":[In,[Mn,ie],(l,[t,o])=>{const h=l.properties()[t.value],f=o.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[In,[ie],(l,[t])=>{const o=l.id(),h=t.value;return typeof o==typeof h&&o>=h}],"filter-has":[In,[ie],(l,[t])=>t.value in l.properties()],"filter-has-id":[In,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[In,[hi(Mn)],(l,[t])=>t.value.indexOf(l.geometryType())>=0],"filter-id-in":[In,[hi(ie)],(l,[t])=>t.value.indexOf(l.id())>=0],"filter-in-small":[In,[Mn,hi(ie)],(l,[t,o])=>o.value.indexOf(l.properties()[t.value])>=0],"filter-in-large":[In,[Mn,hi(ie)],(l,[t,o])=>function(h,f,m,v){for(;m<=v;){const C=m+v>>1;if(f[C]===h)return!0;f[C]>h?v=C-1:m=C+1}return!1}(l.properties()[t.value],o.value,0,o.value.length-1)],all:{type:In,overloads:[[[In,In],(l,[t,o])=>t.evaluate(l)&&o.evaluate(l)],[qi(In),(l,t)=>{for(const o of t)if(!o.evaluate(l))return!1;return!0}]]},any:{type:In,overloads:[[[In,In],(l,[t,o])=>t.evaluate(l)||o.evaluate(l)],[qi(In),(l,t)=>{for(const o of t)if(o.evaluate(l))return!0;return!1}]]},"!":[In,[In],(l,[t])=>!t.evaluate(l)],"is-supported-script":[In,[Mn],(l,[t])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(t.evaluate(l))}],upcase:[Mn,[Mn],(l,[t])=>t.evaluate(l).toUpperCase()],downcase:[Mn,[Mn],(l,[t])=>t.evaluate(l).toLowerCase()],concat:[Mn,qi(ie),(l,t)=>t.map(o=>eo(o.evaluate(l))).join("")],"resolved-locale":[Mn,[Ue],(l,[t])=>t.evaluate(l).resolvedLocale()],random:[hr,[hr,hr,ie],(l,t)=>{const[o,h,f]=t.map(v=>v.evaluate(l));if(o>h||o===h)return o;let m;if(typeof f=="string")m=function(v){let C=0;if(v.length===0)return C;for(let I=0;I<v.length;I++)C=(C<<5)-C+v.charCodeAt(I),C|=0;return C}(f);else{if(typeof f!="number")throw new Cs(`Invalid seed input: ${f}`);m=f}return o+Bi(m)()*(h-o)}]});class bo{constructor(t,o,h,f){this.expression=t,this._warningHistory={},this._evaluator=new xc(h,f),this._defaultValue=o?function(m){return m.type==="color"&&(Qs(m.default)||Array.isArray(m.default))?new Un(0,0,0,0):m.type==="color"?Un.parse(m.default)||null:m.default===void 0?null:m.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=ju(t)}evaluateWithoutErrorHandling(t,o,h,f,m,v,C,I){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=h,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,h,f,m,v,C,I){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=h||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Cs(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${F.message}`)),this._defaultValue}}}function oa(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in ci}function as(l,t,o,h){const f=new oA(ci,[],t?function(v){const C={color:na,string:Mn,number:hr,enum:Mn,boolean:In,formatted:Et,resolvedImage:jt};return v.type==="array"?hi(C[v.value]||ie,v.length):C[v.type]}(t):void 0,void 0,void 0,o,h),m=f.parse(l,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?lr(new bo(m,t,o,h)):$i(f.errors)}class Na{constructor(t,o,h,f){this.kind=t,this._styleExpression=o,this.isLightConstant=h,this.isLineProgressConstant=f,this.isStateDependent=t!=="constant"&&!wu(o.expression),this.configDependencies=ju(o.expression)}evaluateWithoutErrorHandling(t,o,h,f,m,v){return this._styleExpression.evaluateWithoutErrorHandling(t,o,h,f,m,v)}evaluate(t,o,h,f,m,v){return this._styleExpression.evaluate(t,o,h,f,m,v)}}class ja{constructor(t,o,h,f,m,v){this.kind=t,this.zoomStops=h,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!wu(o.expression),this.isLightConstant=m,this.isLineProgressConstant=v,this.configDependencies=ju(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,o,h,f,m,v){return this._styleExpression.evaluateWithoutErrorHandling(t,o,h,f,m,v)}evaluate(t,o,h,f,m,v){return this._styleExpression.evaluate(t,o,h,f,m,v)}interpolationFactor(t,o,h){return this.interpolationType?Hl.interpolationFactor(this.interpolationType,t,o,h):0}}function Ca(l,t,o,h){if((l=as(l,t,o,h)).result==="error")return l;const f=l.value.expression,m=Nu(f);if(!m&&!Ir(t))return $i([new Da("","data expressions not supported")]);const v=Gh(f,["zoom","pitch","distance-from-center"]);if(!v&&!zr(t))return $i([new Da("","zoom expressions not supported")]);const C=Gh(f,["measure-light"]);if(!C&&!bn(t))return $i([new Da("","measure-light expression not supported")]);const I=Gh(f,["line-progress"]);if(!I&&!function(z){return Xr(z.expression,"line-progress")}(t))return $i([new Da("","line-progress expression not supported")]);const F=t.expression&&t.expression.relaxZoomRestriction,k=$o(f);return k||v||F?k instanceof Da?$i([k]):k instanceof Hl&&!Fs(t)?$i([new Da("",'"interpolate" expressions cannot be used with this property')]):lr(k?new ja(m&&I?"camera":"composite",l.value,k.labels,k instanceof Hl?k.interpolation:void 0,C,I):new Na(m&&I?"constant":"source",l.value,C,I)):$i([new Da("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class co{constructor(t,o){this._parameters=t,this._specification=o,_c(this,dr(this._parameters,this._specification))}static deserialize(t){return new co(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function $o(l){let t=null;if(l instanceof hA)t=$o(l.result);else if(l instanceof dd){for(const o of l.args)if(t=$o(o),t)break}else(l instanceof tl||l instanceof Hl)&&l.input instanceof So&&l.input.name==="zoom"&&(t=l);return t instanceof Da||l.eachChild(o=>{const h=$o(o);h instanceof Da?t=h:t&&h&&t!==h&&(t=new Da("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}var Ha,sc,aa=function(){if(sc)return Ha;sc=1,Ha=t;var l=3;function t(o,h,f){var m=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var v=new Int32Array(this.arrayBuffer);o=v[0],this.d=(h=v[1])+2*(f=v[2]);for(var C=0;C<this.d*this.d;C++){var I=v[l+C],F=v[l+C+1];m.push(I===F?null:v.subarray(I,F))}var k=v[l+m.length+1];this.keys=v.subarray(v[l+m.length],k),this.bboxes=v.subarray(k),this.insert=this._insertReadonly}else{this.d=h+2*f;for(var z=0;z<this.d*this.d;z++)m.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=o,this.padding=f,this.scale=h/o,this.uid=0;var H=f/h*o;this.min=-H,this.max=o+H}return t.prototype.insert=function(o,h,f,m,v){this._forEachCell(h,f,m,v,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(v)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(o,h,f,m,v,C){this.cells[v].push(C)},t.prototype.query=function(o,h,f,m,v){var C=this.min,I=this.max;if(o<=C&&h<=C&&I<=f&&I<=m&&!v)return Array.prototype.slice.call(this.keys);var F=[];return this._forEachCell(o,h,f,m,this._queryCell,F,{},v),F},t.prototype._queryCell=function(o,h,f,m,v,C,I,F){var k=this.cells[v];if(k!==null)for(var z=this.keys,H=this.bboxes,$=0;$<k.length;$++){var ee=k[$];if(I[ee]===void 0){var ae=4*ee;(F?F(H[ae+0],H[ae+1],H[ae+2],H[ae+3]):o<=H[ae+2]&&h<=H[ae+3]&&f>=H[ae+0]&&m>=H[ae+1])?(I[ee]=!0,C.push(z[ee])):I[ee]=!1}}},t.prototype._forEachCell=function(o,h,f,m,v,C,I,F){for(var k=this._convertToCellCoord(o),z=this._convertToCellCoord(h),H=this._convertToCellCoord(f),$=this._convertToCellCoord(m),ee=k;ee<=H;ee++)for(var ae=z;ae<=$;ae++){var Ae=this.d*ae+ee;if((!F||F(this._convertFromCellCoord(ee),this._convertFromCellCoord(ae),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(ae+1)))&&v.call(this,o,h,f,m,Ae,C,I,F))return}},t.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},t.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,h=l+this.cells.length+1+1,f=0,m=0;m<this.cells.length;m++)f+=this.cells[m].length;var v=new Int32Array(h+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var C=h,I=0;I<o.length;I++){var F=o[I];v[l+I]=C,v.set(F,C),C+=F.length}return v[l+o.length]=C,v.set(this.keys,C),v[l+o.length+1]=C+=this.keys.length,v.set(this.bboxes,C),C+=this.bboxes.length,v.buffer},Ha}(),Qa=ta(aa);const Va={};function Zi(l,t,o={}){Object.defineProperty(l,"_classRegistryKey",{value:t,writable:!1}),Va[t]={klass:l,omit:o.omit||[]}}Zi(Object,"Object"),Qa.serialize=function(l,t){const o=l.toArrayBuffer();return t&&t.add(o),{buffer:o}},Qa.deserialize=function(l){return new Qa(l.buffer)},Object.defineProperty(Qa,"name",{value:"Grid"}),Zi(Qa,"Grid"),typeof DOMMatrix<"u"&&Zi(DOMMatrix,"DOMMatrix"),Zi(Un,"Color"),Zi(Error,"Error"),Zi(Zn,"Formatted"),Zi(Zs,"FormattedSection"),Zi(pn,"AJAXError"),Zi(Js,"ResolvedImage"),Zi(co,"StylePropertyFunction"),Zi(bo,"StyleExpression",{omit:["_evaluator"]}),Zi(ra,"ImageId"),Zi(xn,"ImageVariant"),Zi(ja,"ZoomDependentExpression"),Zi(Na,"ZoomConstantExpression"),Zi(So,"CompoundExpression",{omit:["_evaluate"]});for(const l in ci)Va[ci[l]._classRegistryKey]||Zi(ci[l],`Expression${l}`);function Bu(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Ho(l){return self.ImageBitmap&&l instanceof ImageBitmap}function Kc(l,t){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(Bu(l)||Ho(l))return t&&t.add(l),l;if(ArrayBuffer.isView(l))return t&&t.add(l.buffer),l;if(l instanceof ImageData)return t&&t.add(l.data.buffer),l;if(Array.isArray(l)){const o=[];for(const h of l)o.push(Kc(h,t));return o}if(l instanceof Map){const o={$name:"Map",entries:[]};for(const[h,f]of l.entries())o.entries.push(Kc(h),Kc(f,t));return o}if(l instanceof Set){const o={$name:"Set"};let h=0;for(const f of l.values())o[++h]=Kc(f);return o}if(l instanceof DOMMatrix){const o={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const f of h)o[f]=l[f];return o}if(typeof l=="bigint")return{$name:"BigInt",value:l.toString()};if(typeof l=="object"){const o=l.constructor,h=o._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const f=o.serialize?o.serialize(l,t):{};if(!o.serialize){for(const m in l)l.hasOwnProperty(m)&&(Va[h].omit.indexOf(m)>=0||(f[m]=Kc(l[m],t)));l instanceof Error&&(f.message=l.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(f.$name=h),f}throw new Error("can't serialize object of type "+typeof l)}function Cu(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Bu(l)||Ho(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(Cu);if(typeof l=="object"){const t=l.$name||"Object";if(t==="Map"){const f=l.entries||[],m=new Map;for(let v=0;v<f.length;v+=2)m.set(Cu(f[v]),Cu(f[v+1]));return m}if(t==="Set"){const f=new Set;for(const m of Object.keys(l))m!=="$name"&&f.add(Cu(l[m]));return f}if(t==="DOMMatrix"){let f;return f=l.is2D?[l.a,l.b,l.c,l.d,l.e,l.f]:[l.m11,l.m12,l.m13,l.m14,l.m21,l.m22,l.m23,l.m24,l.m31,l.m32,l.m33,l.m34,l.m41,l.m42,l.m43,l.m44],new DOMMatrix(f)}if(t==="BigInt")return BigInt(l.value);const{klass:o}=Va[t];if(!o)throw new Error(`Can't deserialize unregistered class "${t}".`);if(o.deserialize)return o.deserialize(l);const h=Object.create(o.prototype);for(const f of Object.keys(l))f!=="$name"&&(h[f]=Cu(l[f]));return h}throw new Error("can't deserialize object of type "+typeof l)}const Br={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function Qu(l){for(const t of l)if(Ql(t.charCodeAt(0)))return!0;return!1}function fd(l){for(const t of l)if(!pd(t.charCodeAt(0)))return!1;return!0}function pd(l){return!(Br.Arabic(l)||Br["Arabic Supplement"](l)||Br["Arabic Extended-A"](l)||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l))}function Ql(l){return!(l!==746&&l!==747&&(l<4352||!(Br["Bopomofo Extended"](l)||Br.Bopomofo(l)||Br["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Br["CJK Compatibility Ideographs"](l)||Br["CJK Compatibility"](l)||Br["CJK Radicals Supplement"](l)||Br["CJK Strokes"](l)||!(!Br["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Br["CJK Unified Ideographs Extension A"](l)||Br["CJK Unified Ideographs"](l)||Br["Enclosed CJK Letters and Months"](l)||Br["Hangul Compatibility Jamo"](l)||Br["Hangul Jamo Extended-A"](l)||Br["Hangul Jamo Extended-B"](l)||Br["Hangul Jamo"](l)||Br["Hangul Syllables"](l)||Br.Hiragana(l)||Br["Ideographic Description Characters"](l)||Br.Kanbun(l)||Br["Kangxi Radicals"](l)||Br["Katakana Phonetic Extensions"](l)||Br.Katakana(l)&&l!==12540||!(!Br["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Br["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Br["Unified Canadian Aboriginal Syllabics"](l)||Br["Unified Canadian Aboriginal Syllabics Extended"](l)||Br["Vertical Forms"](l)||Br["Yijing Hexagram Symbols"](l)||Br["Yi Syllables"](l)||Br["Yi Radicals"](l))))}function bh(l){return!(Ql(l)||function(t){return!!(Br["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Br["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Br["Letterlike Symbols"](t)||Br["Number Forms"](t)||Br["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Br["Control Pictures"](t)&&t!==9251||Br["Optical Character Recognition"](t)||Br["Enclosed Alphanumerics"](t)||Br["Geometric Shapes"](t)||Br["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Br["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Br["CJK Symbols and Punctuation"](t)||Br.Katakana(t)||Br["Private Use Area"](t)||Br["CJK Compatibility Forms"](t)||Br["Small Form Variants"](t)||Br["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(l))}function Yh(l){return Br.Arabic(l)||Br["Arabic Supplement"](l)||Br["Arabic Extended-A"](l)||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l)}function fA(l){return l>=1424&&l<=2303||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l)}function pA(l,t){return!(!t&&fA(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Br.Khmer(l))}function gd(l){for(const t of l)if(fA(t.charCodeAt(0)))return!0;return!1}const Ga={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let wh=null,la=Ga.unavailable,Sl=null;const Vu=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(la=Ga.error),wh&&wh(l)};function gA(){Bh.fire(new Qc("pluginStateChange",{pluginStatus:la,pluginURL:Sl}))}const Bh=new gu,cl=function(){return la},mA=function(){if(la!==Ga.deferred||!Sl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");la=Ga.loading,gA(),Sl&&jc({url:Sl},l=>{l?Vu(l):(la=Ga.loaded,gA())})},qc={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>la===Ga.loaded||qc.applyArabicShaping!=null,isLoading:()=>la===Ga.loading,setState(l){la=l.pluginStatus,Sl=l.pluginURL},isParsing:()=>la===Ga.parsing,isParsed:()=>la===Ga.parsed,getPluginURL:()=>Sl};class Xn{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness,this.worldview=o.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(o,h){for(const f of o)if(!pA(f.charCodeAt(0),h))return!1;return!0}(t,qc.isLoaded())}}class Ch{constructor(t,o,h,f){this.property=t,this.value=o,this.expression=function(m,v,C,I){if(Qs(m))return new co(m,v);if(oa(m)||Array.isArray(m)&&m.length>0){const F=Ca(m,v,C,I);if(F.result==="error")throw new Error(F.value.map(k=>`${k.key}: ${k.message}`).join(", "));return F.value}{let F=m;return typeof m=="string"&&v.type==="color"&&(F=Un.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>F}}}(o===void 0?t.specification.default:o,t.specification,h,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,h){return this.property.possiblyEvaluate(this,t,o,h)}}class oc{constructor(t,o,h){this.property=t,this.value=new Ch(t,void 0,o,h)}transitioned(t,o){return new JA(this.property,this.value,o,Ot({},t.transition,this.transition),t.now)}untransitioned(){return new JA(this.property,this.value,null,{},0)}}class md{constructor(t,o,h){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=o,this._options=h,this.configDependencies=new Set}getValue(t){return Mr(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new oc(this._values[t].property,this._scope,this._options)),this._values[t].value=new Ch(this._values[t].property,o===null?void 0:Mr(o),this._scope,this._options),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,o){o&&(this._options=o);const h=this._properties.properties;if(t)for(const f in t){const m=t[f];if(f.endsWith("-transition")){const v=f.slice(0,-11);h[v]&&this.setTransition(v,m)}else h.hasOwnProperty(f)&&this.setValue(f,m)}}getTransition(t){return Mr(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new oc(this._values[t].property)),this._values[t].transition=Mr(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(t[o]=h);const f=this.getTransition(o);f!==void 0&&(t[`${o}-transition`]=f)}return t}transitioned(t,o){const h=new yd(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].transitioned(t,o._values[f]);return h}untransitioned(){const t=new yd(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class JA{constructor(t,o,h,f,m){const v=f.delay||0,C=f.duration||0;m=m||0,this.property=t,this.value=o,this.begin=m+v,this.end=this.begin+C,t.specification.transition&&(f.delay||f.duration)&&(this.prior=h)}possiblyEvaluate(t,o,h){const f=t.now||0,m=this.value.possiblyEvaluate(t,o,h),v=this.prior;if(v){if(f>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(f<this.begin)return v.possiblyEvaluate(t,o,h);{const C=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,o,h),m,Ce(C))}}return m}}class yd{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,h){const f=new $c(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(t,o,h);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ef{constructor(t,o,h){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=o,this._options=h,this.configDependencies=new Set}getValue(t){return Mr(this._values[t].value)}setValue(t,o){this._values[t]=new Ch(this._values[t].property,o===null?void 0:Mr(o),this._scope,this._options),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(t[o]=h)}return t}possiblyEvaluate(t,o,h){const f=new $c(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(t,o,h);return f}}class ca{constructor(t,o,h){this.property=t,this.value=o,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,h,f){return this.property.evaluate(this.value,this.parameters,t,o,h,f)}}class $c{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ei{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,h){const f=Vc[this.specification.type];return f?f(t,o,h):t}}class Gi{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,h,f){return new ca(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},h,f)}:t.expression,o)}interpolate(t,o,h){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ca(this,{kind:"constant",value:void 0},t.parameters);const f=Vc[this.specification.type];return f?new ca(this,{kind:"constant",value:f(t.value.value,o.value.value,h)},t.parameters):t}evaluate(t,o,h,f,m,v){return t.kind==="constant"?t.value:t.evaluate(o,h,f,m,v)}}class Gu{constructor(t){this.specification=t}possiblyEvaluate(t,o,h,f){return!!t.expression.evaluate(o,null,{},h,f)}interpolate(){return!1}}class Us{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new Xn(0,{});for(const h in t){const f=t[h];f.specification.overridable&&this.overridableProperties.push(h);const m=this.defaultPropertyValues[h]=new Ch(f,void 0),v=this.defaultTransitionablePropertyValues[h]=new oc(f);this.defaultTransitioningPropertyValues[h]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=m.possiblyEvaluate(o)}}}Zi(Gi,"DataDrivenProperty"),Zi(Ei,"DataConstantProperty"),Zi(Gu,"ColorRampProperty");var Ft=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function ac(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function vd(l){if(Array.isArray(l))return l.map(vd);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const t={};for(const o in l)t[o]=vd(l[o]);return t}return ac(l)}function yA(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const t of l.slice(1))if(!yA(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function vA(l,t="",o=null,h="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yA(l)||(l=Xu(l));const f=l;let m=!0;try{m=function(k){if(!Su(k))return k;let z=vd(k);return Df(z),z=Wu(z),z}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let v=null,C=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){C=Ft[`filter_${h}`];const k=as(m,C,t,o);if(k.result==="error")throw new Error(k.value.map(z=>`${z.key}: ${z.message}`).join(", "));v=(z,H,$)=>k.value.evaluate(z,H,{},$)}let I=null,F=null;if(m!==f){const k=as(f,C,t,o);if(k.result==="error")throw new Error(k.value.map(z=>`${z.key}: ${z.message}`).join(", "));I=(z,H,$,ee,ae)=>k.value.evaluate(z,H,{},$,void 0,void 0,ee,ae),F=!Nu(k.value.expression)}return{filter:v,dynamicFilter:I||void 0,needGeometry:Kh(m),needFeature:!!F}}function Wu(l){if(!Array.isArray(l))return l;const t=function(o){if(Of.has(o[0])){for(let h=1;h<o.length;h++)if(Su(o[h]))return!0}return o}(l);return t===!0?t:t.map(o=>Wu(o))}function Df(l){let t=!1;const o=[];if(l[0]==="case"){for(let h=1;h<l.length-1;h+=2)t=t||Su(l[h]),o.push(l[h+1]);o.push(l[l.length-1])}else if(l[0]==="match"){t=t||Su(l[1]);for(let h=2;h<l.length-1;h+=2)o.push(l[h+1]);o.push(l[l.length-1])}else if(l[0]==="step"){t=t||Su(l[1]);for(let h=1;h<l.length-1;h+=2)o.push(l[h+1])}t&&(l.length=0,l.push("any",...o));for(let h=1;h<l.length;h++)Df(l[h])}function Su(l){if(!Array.isArray(l))return!1;if((t=l[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<l.length;o++)if(Su(l[o]))return!0;return!1}const Of=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ma(l,t){return l<t?-1:l>t?1:0}function Kh(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let t=1;t<l.length;t++)if(Kh(l[t]))return!0;return!1}function Xu(l){if(!l)return!0;const t=l[0];return l.length<=1?t!=="any":t==="=="?_d(l[1],l[2],"=="):t==="!="?Sc(_d(l[1],l[2],"==")):t==="<"||t===">"||t==="<="||t===">="?_d(l[1],l[2],t):t==="any"?(o=l.slice(1),["any"].concat(o.map(Xu))):t==="all"?["all"].concat(l.slice(1).map(Xu)):t==="none"?["all"].concat(l.slice(1).map(Xu).map(Sc)):t==="in"?Sh(l[1],l.slice(2)):t==="!in"?Sc(Sh(l[1],l.slice(2))):t==="has"?lc(l[1]):t!=="!has"||Sc(lc(l[1]));var o}function _d(l,t,o){switch(l){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,l,t]}}function Sh(l,t){if(t.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",l,["literal",t.sort(Ma)]]:["filter-in-small",l,["literal",t]]}}function lc(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Sc(l){return["!",l]}const cc="";function Zc(l,t){return t?`${l}${cc}${t}`:l}const xd="-transition",Eu=new Set(["fill","line","background","hillshade","raster"]);class Wa extends gu{constructor(t,o,h,f,m){if(super(),this.id=t.id,this.fqid=Zc(this.id,h),this.type=t.type,this.scope=h,this.lut=f,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,t.type!=="custom"){if(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type&&t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"){this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter;const v=as(this.filter,Ft[`filter_${t.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(t.slot&&(this.slot=t.slot),o.layout&&(this._unevaluatedLayout=new ef(o.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new md(o.paint,this.scope,m);for(const v in t.paint)this.setPaintProperty(v,t.paint[v]);for(const v in t.layout)this.setLayoutProperty(v,t.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $c(o.paint)}}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D(!0)&&Eu.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o){if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const h=this._unevaluatedLayout;h._properties.properties[t]&&(h.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(t){return t.endsWith(xd)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o){const h=this._transitionablePaint,f=h._properties.properties;if(t.endsWith(xd)){const z=t.slice(0,-11);return f[z]&&h.setTransition(z,o||void 0),!1}if(!f[t])return!1;const m=h._values[t],v=m.value.isDataDriven(),C=m.value;h.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const I=h._values[t].value,F=I.isDataDriven(),k=t.endsWith("pattern")||t==="line-dasharray";return F||v||k||this._handleOverridablePaintPropertyUpdate(t,C,I)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o,h){return null}_handleOverridablePaintPropertyUpdate(t,o,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){return Sr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,o)=>!(t===void 0||o==="layout"&&!Object.keys(t).length||o==="paint"&&!Object.keys(t).length))}is3D(t){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof ca&&Ir(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=vA(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,o,h,f,m,v,C,I,F){}}const tf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Eh{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ms{constructor(){this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&o.add(t.arrayBuffer),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Rn(l,t=1){let o=0,h=0;return{members:l.map(f=>{const m=tf[f.type].BYTES_PER_ELEMENT,v=o=Uf(o,Math.max(t,m)),C=f.components||1;return h=Math.max(h,m),o+=m*C,{name:f.name,type:f.type,components:C,offset:v}}),size:Uf(o,Math.max(h,t)),alignment:t}}function Uf(l,t){return Math.ceil(l/t)*t}class Yu extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const f=2*t;return this.int16[f+0]=o,this.int16[f+1]=h,t}}Yu.prototype.bytesPerElement=4,Zi(Yu,"StructArrayLayout2i4");class bd extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,h)}emplace(t,o,h,f){const m=3*t;return this.int16[m+0]=o,this.int16[m+1]=h,this.int16[m+2]=f,t}}bd.prototype.bytesPerElement=6,Zi(bd,"StructArrayLayout3i6");class _A extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,f){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,h,f)}emplace(t,o,h,f,m){const v=4*t;return this.int16[v+0]=o,this.int16[v+1]=h,this.int16[v+2]=f,this.int16[v+3]=m,t}}_A.prototype.bytesPerElement=8,Zi(_A,"StructArrayLayout4i8");class qh extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}qh.prototype.bytesPerElement=4,Zi(qh,"StructArrayLayout1f4");class Tp extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,h)}emplace(t,o,h,f){const m=4*t,v=2*t;return this.int16[m+0]=o,this.int16[m+1]=h,this.float32[v+1]=f,t}}Tp.prototype.bytesPerElement=8,Zi(Tp,"StructArrayLayout2i1f8");class zf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,h)}emplace(t,o,h,f){const m=4*t;return this.int16[m+0]=o,this.int16[m+1]=h,this.int16[m+2]=f,t}}zf.prototype.bytesPerElement=8,Zi(zf,"StructArrayLayout3i8");class Th extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,h,f,m)}emplace(t,o,h,f,m,v){const C=5*t;return this.int16[C+0]=o,this.int16[C+1]=h,this.int16[C+2]=f,this.int16[C+3]=m,this.int16[C+4]=v,t}}Th.prototype.bytesPerElement=10,Zi(Th,"StructArrayLayout5i10");class xA extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,h,f,m,v,C)}emplace(t,o,h,f,m,v,C,I){const F=6*t,k=12*t,z=3*t;return this.int16[F+0]=o,this.int16[F+1]=h,this.uint8[k+4]=f,this.uint8[k+5]=m,this.uint8[k+6]=v,this.uint8[k+7]=C,this.float32[z+2]=I,t}}xA.prototype.bytesPerElement=12,Zi(xA,"StructArrayLayout2i4ub1f12");class Ku extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,h)}emplace(t,o,h,f){const m=3*t;return this.float32[m+0]=o,this.float32[m+1]=h,this.float32[m+2]=f,t}}Ku.prototype.bytesPerElement=12,Zi(Ku,"StructArrayLayout3f12");class Ih extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,h,f,m)}emplace(t,o,h,f,m,v){const C=6*t,I=3*t;return this.uint16[C+0]=o,this.uint16[C+1]=h,this.uint16[C+2]=f,this.uint16[C+3]=m,this.float32[I+2]=v,t}}Ih.prototype.bytesPerElement=12,Zi(Ih,"StructArrayLayout4ui1f12");class wd extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,f){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,h,f)}emplace(t,o,h,f,m){const v=4*t;return this.uint16[v+0]=o,this.uint16[v+1]=h,this.uint16[v+2]=f,this.uint16[v+3]=m,t}}wd.prototype.bytesPerElement=8,Zi(wd,"StructArrayLayout4ui8");class rf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,h,f,m,v)}emplace(t,o,h,f,m,v,C){const I=6*t;return this.int16[I+0]=o,this.int16[I+1]=h,this.int16[I+2]=f,this.int16[I+3]=m,this.int16[I+4]=v,this.int16[I+5]=C,t}}rf.prototype.bytesPerElement=12,Zi(rf,"StructArrayLayout6i12");class Bd extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z,H){const $=this.length;return this.resize($+1),this.emplace($,t,o,h,f,m,v,C,I,F,k,z,H)}emplace(t,o,h,f,m,v,C,I,F,k,z,H,$){const ee=12*t;return this.int16[ee+0]=o,this.int16[ee+1]=h,this.int16[ee+2]=f,this.int16[ee+3]=m,this.uint16[ee+4]=v,this.uint16[ee+5]=C,this.uint16[ee+6]=I,this.uint16[ee+7]=F,this.int16[ee+8]=k,this.int16[ee+9]=z,this.int16[ee+10]=H,this.int16[ee+11]=$,t}}Bd.prototype.bytesPerElement=24,Zi(Bd,"StructArrayLayout4i4ui4i24");class Cd extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,h,f,m,v)}emplace(t,o,h,f,m,v,C){const I=10*t,F=5*t;return this.int16[I+0]=o,this.int16[I+1]=h,this.int16[I+2]=f,this.float32[F+2]=m,this.float32[F+3]=v,this.float32[F+4]=C,t}}Cd.prototype.bytesPerElement=20,Zi(Cd,"StructArrayLayout3i3f20");class Xa extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,h,f)}emplace(t,o,h,f,m){const v=4*t;return this.float32[v+0]=o,this.float32[v+1]=h,this.float32[v+2]=f,this.float32[v+3]=m,t}}Xa.prototype.bytesPerElement=16,Zi(Xa,"StructArrayLayout4f16");class Fh extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}Fh.prototype.bytesPerElement=4,Zi(Fh,"StructArrayLayout1ul4");class Lh extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const f=2*t;return this.uint16[f+0]=o,this.uint16[f+1]=h,t}}Lh.prototype.bytesPerElement=4,Zi(Lh,"StructArrayLayout2ui4");class Nf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z,H,$){const ee=this.length;return this.resize(ee+1),this.emplace(ee,t,o,h,f,m,v,C,I,F,k,z,H,$)}emplace(t,o,h,f,m,v,C,I,F,k,z,H,$,ee){const ae=20*t,Ae=10*t;return this.int16[ae+0]=o,this.int16[ae+1]=h,this.int16[ae+2]=f,this.int16[ae+3]=m,this.int16[ae+4]=v,this.float32[Ae+3]=C,this.float32[Ae+4]=I,this.float32[Ae+5]=F,this.float32[Ae+6]=k,this.int16[ae+14]=z,this.uint32[Ae+8]=H,this.uint16[ae+18]=$,this.uint16[ae+19]=ee,t}}Nf.prototype.bytesPerElement=40,Zi(Nf,"StructArrayLayout5i4f1i1ul2ui40");class jf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,h,f,m,v,C)}emplace(t,o,h,f,m,v,C,I){const F=8*t;return this.int16[F+0]=o,this.int16[F+1]=h,this.int16[F+2]=f,this.int16[F+4]=m,this.int16[F+5]=v,this.int16[F+6]=C,this.int16[F+7]=I,t}}jf.prototype.bytesPerElement=16,Zi(jf,"StructArrayLayout3i2i2i16");class Ip extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,h,f,m)}emplace(t,o,h,f,m,v){const C=4*t,I=8*t;return this.float32[C+0]=o,this.float32[C+1]=h,this.float32[C+2]=f,this.int16[I+6]=m,this.int16[I+7]=v,t}}Ip.prototype.bytesPerElement=16,Zi(Ip,"StructArrayLayout2f1f2i16");class bA extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,h,f,m,v)}emplace(t,o,h,f,m,v,C){const I=20*t,F=5*t;return this.uint8[I+0]=o,this.uint8[I+1]=h,this.float32[F+1]=f,this.float32[F+2]=m,this.float32[F+3]=v,this.float32[F+4]=C,t}}bA.prototype.bytesPerElement=20,Zi(bA,"StructArrayLayout2ub4f20");class Zo extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,h)}emplace(t,o,h,f){const m=3*t;return this.uint16[m+0]=o,this.uint16[m+1]=h,this.uint16[m+2]=f,t}}Zo.prototype.bytesPerElement=6,Zi(Zo,"StructArrayLayout3ui6");class Sd extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee){const ke=this.length;return this.resize(ke+1),this.emplace(ke,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee)}emplace(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee,ke){const He=30*t,gt=15*t,ht=60*t;return this.int16[He+0]=o,this.int16[He+1]=h,this.int16[He+2]=f,this.float32[gt+2]=m,this.float32[gt+3]=v,this.uint16[He+8]=C,this.uint16[He+9]=I,this.uint32[gt+5]=F,this.uint32[gt+6]=k,this.uint32[gt+7]=z,this.uint16[He+16]=H,this.uint16[He+17]=$,this.uint16[He+18]=ee,this.float32[gt+10]=ae,this.float32[gt+11]=Ae,this.uint8[ht+48]=ve,this.uint8[ht+49]=Fe,this.uint8[ht+50]=Le,this.uint32[gt+13]=ce,this.int16[He+28]=Ee,this.uint8[ht+58]=ke,t}}Sd.prototype.bytesPerElement=60,Zi(Sd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class wA extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee,ke,He,gt,ht,yt,Lt,Wt,Si,fi,Ci,Ii,$t){const _i=this.length;return this.resize(_i+1),this.emplace(_i,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee,ke,He,gt,ht,yt,Lt,Wt,Si,fi,Ci,Ii,$t)}emplace(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le,ce,Ee,ke,He,gt,ht,yt,Lt,Wt,Si,fi,Ci,Ii,$t,_i){const Gt=20*t,Yt=40*t,ki=80*t;return this.float32[Gt+0]=o,this.float32[Gt+1]=h,this.int16[Yt+4]=f,this.int16[Yt+5]=m,this.int16[Yt+6]=v,this.int16[Yt+7]=C,this.int16[Yt+8]=I,this.int16[Yt+9]=F,this.int16[Yt+10]=k,this.int16[Yt+11]=z,this.int16[Yt+12]=H,this.uint16[Yt+13]=$,this.uint16[Yt+14]=ee,this.uint16[Yt+15]=ae,this.uint16[Yt+16]=Ae,this.uint16[Yt+17]=ve,this.uint16[Yt+18]=Fe,this.uint16[Yt+19]=Le,this.uint16[Yt+20]=ce,this.uint16[Yt+21]=Ee,this.uint16[Yt+22]=ke,this.uint16[Yt+23]=He,this.uint16[Yt+24]=gt,this.uint16[Yt+25]=ht,this.uint16[Yt+26]=yt,this.uint16[Yt+27]=Lt,this.uint32[Gt+14]=Wt,this.float32[Gt+15]=Si,this.float32[Gt+16]=fi,this.float32[Gt+17]=Ci,this.float32[Gt+18]=Ii,this.uint8[ki+76]=$t,this.uint16[Yt+39]=_i,t}}wA.prototype.bytesPerElement=80,Zi(wA,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Fp extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,h,f,m,v)}emplace(t,o,h,f,m,v,C){const I=6*t;return this.float32[I+0]=o,this.float32[I+1]=h,this.float32[I+2]=f,this.float32[I+3]=m,this.float32[I+4]=v,this.float32[I+5]=C,t}}Fp.prototype.bytesPerElement=24,Zi(Fp,"StructArrayLayout6f24");class $h extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,h,f,m)}emplace(t,o,h,f,m,v){const C=5*t;return this.float32[C+0]=o,this.float32[C+1]=h,this.float32[C+2]=f,this.float32[C+3]=m,this.float32[C+4]=v,t}}$h.prototype.bytesPerElement=20,Zi($h,"StructArrayLayout5f20");class nf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,h,f,m,v,C)}emplace(t,o,h,f,m,v,C,I){const F=7*t;return this.float32[F+0]=o,this.float32[F+1]=h,this.float32[F+2]=f,this.float32[F+3]=m,this.float32[F+4]=v,this.float32[F+5]=C,this.float32[F+6]=I,t}}nf.prototype.bytesPerElement=28,Zi(nf,"StructArrayLayout7f28");class Lp extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z){const H=this.length;return this.resize(H+1),this.emplace(H,t,o,h,f,m,v,C,I,F,k,z)}emplace(t,o,h,f,m,v,C,I,F,k,z,H){const $=11*t;return this.float32[$+0]=o,this.float32[$+1]=h,this.float32[$+2]=f,this.float32[$+3]=m,this.float32[$+4]=v,this.float32[$+5]=C,this.float32[$+6]=I,this.float32[$+7]=F,this.float32[$+8]=k,this.float32[$+9]=z,this.float32[$+10]=H,t}}Lp.prototype.bytesPerElement=44,Zi(Lp,"StructArrayLayout11f44");class sf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F){const k=this.length;return this.resize(k+1),this.emplace(k,t,o,h,f,m,v,C,I,F)}emplace(t,o,h,f,m,v,C,I,F,k){const z=9*t;return this.float32[z+0]=o,this.float32[z+1]=h,this.float32[z+2]=f,this.float32[z+3]=m,this.float32[z+4]=v,this.float32[z+5]=C,this.float32[z+6]=I,this.float32[z+7]=F,this.float32[z+8]=k,t}}sf.prototype.bytesPerElement=36,Zi(sf,"StructArrayLayout9f36");class Mh extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const f=2*t;return this.float32[f+0]=o,this.float32[f+1]=h,t}}Mh.prototype.bytesPerElement=8,Zi(Mh,"StructArrayLayout2f8");class Hf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,f){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,h,f)}emplace(t,o,h,f,m){const v=6*t;return this.uint32[3*t+0]=o,this.uint16[v+2]=h,this.uint16[v+3]=f,this.uint16[v+4]=m,t}}Hf.prototype.bytesPerElement=12,Zi(Hf,"StructArrayLayout1ul3ui12");class BA extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}BA.prototype.bytesPerElement=2,Zi(BA,"StructArrayLayout1ui2");class Zh extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae){const ve=this.length;return this.resize(ve+1),this.emplace(ve,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae)}emplace(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve){const Fe=16*t;return this.float32[Fe+0]=o,this.float32[Fe+1]=h,this.float32[Fe+2]=f,this.float32[Fe+3]=m,this.float32[Fe+4]=v,this.float32[Fe+5]=C,this.float32[Fe+6]=I,this.float32[Fe+7]=F,this.float32[Fe+8]=k,this.float32[Fe+9]=z,this.float32[Fe+10]=H,this.float32[Fe+11]=$,this.float32[Fe+12]=ee,this.float32[Fe+13]=ae,this.float32[Fe+14]=Ae,this.float32[Fe+15]=ve,t}}Zh.prototype.bytesPerElement=64,Zi(Zh,"StructArrayLayout16f64");class CA extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,f,m,v,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,h,f,m,v,C)}emplace(t,o,h,f,m,v,C,I){const F=10*t,k=5*t;return this.uint16[F+0]=o,this.uint16[F+1]=h,this.uint16[F+2]=f,this.uint16[F+3]=m,this.float32[k+2]=v,this.float32[k+3]=C,this.float32[k+4]=I,t}}CA.prototype.bytesPerElement=20,Zi(CA,"StructArrayLayout4ui3f20");class Qf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.int16[1*t+0]=o,t}}Qf.prototype.bytesPerElement=2,Zi(Qf,"StructArrayLayout1i2");class Vf extends Ms{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}Vf.prototype.bytesPerElement=1,Zi(Vf,"StructArrayLayout1ub1");class of extends Eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}of.prototype.size=40;class Ed extends Nf{get(t){return new of(this,t)}}Zi(Ed,"CollisionBoxArray");class Mp extends Eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Mp.prototype.size=60;class Pp extends Sd{get(t){return new Mp(this,t)}}Zi(Pp,"PlacedSymbolArray");class xg extends Eh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}xg.prototype.size=80;class kp extends wA{get(t){return new xg(this,t)}}Zi(kp,"SymbolInstanceArray");class Gf extends qh{getoffsetX(t){return this.float32[1*t+0]}}Zi(Gf,"GlyphOffsetArray");class bg extends Yu{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Zi(bg,"SymbolLineVertexArray");class wg extends Eh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}wg.prototype.size=12;class Td extends Hf{get(t){return new wg(this,t)}}Zi(Td,"FeatureIndexArray");class Rp extends Lh{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Zi(Rp,"FillExtrusionCentroidArray");class ma extends Eh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ma.prototype.size=6;class Jh extends bd{get(t){return new ma(this,t)}}Zi(Jh,"FillExtrusionWallArray");const SA=Rn([{name:"a_pos",components:2,type:"Int16"}],4),ed=Rn([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),Tu=Rn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Vs{constructor(t=[]){this.segments=t}_prepareSegment(t,o,h,f){let m=this.segments[this.segments.length-1];return t>Vs.MAX_VERTEX_ARRAY_LENGTH&&Yr(`Max vertices per segment is ${Vs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>Vs.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==f)&&(m={vertexOffset:o,primitiveOffset:h,vertexLength:0,primitiveLength:0},f!==void 0&&(m.sortKey=f),this.segments.push(m)),m}prepareSegment(t,o,h,f){return this._prepareSegment(t,o.length,h.length,f)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,h,f){return new Vs([{vertexOffset:t,primitiveOffset:o,vertexLength:h,primitiveLength:f,vaos:{},sortKey:0}])}}function qu(l,t){return 256*(l=Ge(Math.floor(l),0,255))+Ge(Math.floor(t),0,255)}Vs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zi(Vs,"SegmentVector");const af=Rn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Wf=Rn([{name:"a_pattern_b",components:4,type:"Uint16"}]),Dp=Rn([{name:"a_dash",components:4,type:"Uint16"}]);class Id{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,h,f){this.ids.push(Fd(t)),this.positions.push(o,h,f)}eachPosition(t,o){const h=Fd(t);let f=0,m=this.ids.length-1;for(;f<m;){const v=f+m>>1;this.ids[v]>=h?m=v:f=v+1}for(;this.ids[f]===h;)o(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(t,o){const h=new Float64Array(t.ids),f=new Uint32Array(t.positions);return lf(h,f,0,h.length-1),o&&(o.add(h.buffer),o.add(f.buffer)),{ids:h,positions:f}}static deserialize(t){const o=new Id;let h;o.ids=t.ids,o.positions=t.positions;for(const f of o.ids)f!==h&&o.uniqueIds.push(f),h=f;return o.indexed=!0,o}}function Fd(l){const t=+l;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Uo(String(l))}function lf(l,t,o,h){for(;o<h;){const f=l[o+h>>1];let m=o-1,v=h+1;for(;;){do m++;while(l[m]<f);do v--;while(l[v]>f);if(m>=v)break;EA(l,m,v),EA(t,3*m,3*v),EA(t,3*m+1,3*v+1),EA(t,3*m+2,3*v+2)}v-o<h-v?(lf(l,t,o,v),o=v+1):(lf(l,t,v+1,h),h=v)}}function EA(l,t,o){const h=l[t];l[t]=l[o],l[o]=h}Zi(Id,"FeaturePositionMap");class Ec{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}set(t,o,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Xf extends Ec{constructor(t){super(t),this.current=0}set(t,o,h){this.fetchUniformLocation(t,o)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class To extends Ec{constructor(t){super(t),this.current=0}set(t,o,h){this.fetchUniformLocation(t,o)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class $u extends Ec{constructor(t){super(t),this.current=[0,0]}set(t,o,h){this.fetchUniformLocation(t,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class cf extends Ec{constructor(t){super(t),this.current=[0,0,0]}set(t,o,h){this.fetchUniformLocation(t,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class Yf extends Ec{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,h){this.fetchUniformLocation(t,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class Kf extends Ec{constructor(t){super(t),this.current=Un.transparent.toPremultipliedRenderColor(null)}set(t,o,h){this.fetchUniformLocation(t,o)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const gm=new Float32Array(16);class TA extends Ec{constructor(t){super(t),this.current=gm}set(t,o,h){if(this.fetchUniformLocation(t,o)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let f=1;f<16;f++)if(h[f]!==this.current[f]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const Op=new Float32Array(9),Zu=new Float32Array(4);class uf extends Ec{constructor(t){super(t),this.current=Zu}set(t,o,h){if(this.fetchUniformLocation(t,o)){for(let f=0;f<4;f++)if(h[f]!==this.current[f]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function hf(l){return[qu(255*l.r,255*l.g),qu(255*l.b,255*l.a)]}class Ld{constructor(t,o,h,f){this.value=t,this.uniformNames=o.map(m=>`u_${m}`),this.type=h,this.context=f}setUniform(t,o,h,f,m){const v=f.constantOr(this.value);o.set(t,m,v instanceof Un?v.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(t,o){return this.type==="color"?new Kf(t):new To(t)}}class Md{constructor(t,o){this.uniformNames=o.map(h=>`u_${h}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(t,o){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(t,o,h,f,m){let v=null;m!=="u_pattern"&&m!=="u_dash"||(v=this.pattern),m==="u_pattern_b"&&(v=this.patternTransition),m==="u_pixel_ratio"&&(v=this.pixelRatio),v&&o.set(t,m,v)}getBinding(t,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new Yf(t):new To(t)}}class Ph{constructor(t,o,h,f){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=o.map(m=>({name:`a_${m}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,o,h,f,m,v,C,I){const F=this.paintVertexArray.length,k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Xn(0,{brightness:v,worldview:I}),o,{},m,f,C):this.expression.kind==="constant"&&this.expression.value,z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Xn(0,{brightness:v,worldview:I}),o,{},m,f,C):this.lutExpression.value)==="none";this.paintVertexArray.resize(t),this._setPaintValue(F,t,k,z?null:this.context.lut)}updatePaintArray(t,o,h,f,m,v,C,I){const F=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:C,worldview:I},h,f,void 0,m):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Xn(0,{brightness:C,worldview:I}),h,f,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(t,o,F,k?null:this.context.lut)}_setPaintValue(t,o,h,f){if(this.type==="color"){const m=hf(h.toPremultipliedRenderColor(f));for(let v=t;v<o;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Iu{constructor(t,o,h,f,m,v){this.expression=t,this.uniformNames=o.map(C=>`u_${C}_t`),this.type=h,this.useIntegerZoom=f,this.context=m,this.maxValue=0,this.paintVertexAttributes=o.map(C=>({name:`a_${C}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,o,h,f,m,v,C,I){const F=this.expression.evaluate(new Xn(this.context.zoom,{brightness:v,worldview:I}),o,{},m,f,C),k=this.expression.evaluate(new Xn(this.context.zoom+1,{brightness:v,worldview:I}),o,{},m,f,C),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Xn(0,{brightness:v,worldview:I}),o,{},m,f,C):this.lutExpression.value)==="none",H=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(H,t,F,k,z?null:this.context.lut)}updatePaintArray(t,o,h,f,m,v,C,I){const F=this.expression.evaluate({zoom:this.context.zoom,brightness:C,worldview:I},h,f,void 0,m),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:C,worldview:I},h,f,void 0,m),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Xn(0,{brightness:C,worldview:I}),h,f,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(t,o,F,k,z?null:this.context.lut)}_setPaintValue(t,o,h,f,m){if(this.type==="color"){const v=hf(h.toPremultipliedRenderColor(m)),C=hf(h.toPremultipliedRenderColor(m));for(let I=t;I<o;I++)this.paintVertexArray.emplace(I,v[0],v[1],C[0],C[1])}else{for(let v=t;v<o;v++)this.paintVertexArray.emplace(v,h,f);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,h,f,m){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,C=Ge(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);o.set(t,m,C)}getBinding(t,o){return new To(t)}}class Tc{constructor(t,o,h,f,m){this.expression=t,this.layerId=m,this.paintVertexAttributes=(h==="array"?Dp:af).members;for(let v=0;v<o.length;++v);this.paintVertexArray=new f,this.paintTransitionVertexArray=new wd}populatePaintArray(t,o,h,f){const m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(m,t,o.patterns&&o.patterns[this.layerId],h)}updatePaintArray(t,o,h,f,m,v,C){this._setPaintValues(t,o,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(t,o,h,f){if(!f||!h)return;const m=f[h[0]],v=f[h[1]];if(m){if(m){const{tl:C,br:I,pixelRatio:F}=m;for(let k=t;k<o;k++)this.paintVertexArray.emplace(k,C[0],C[1],I[0],I[1],F)}if(v){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:C,br:I}=v;for(let F=t;F<o;F++)this.paintTransitionVertexArray.emplace(F,C[0],C[1],I[0],I[1])}}}upload(t){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=t.createVertexBuffer(this.paintTransitionVertexArray,Wf.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class IA{constructor(t,o,h=()=>!0){this.binders={},this._buffers=[],this.context=o;const f=[];for(const m in t.paint._values){const v=t.paint.get(m);if(m.endsWith("-use-theme")||!h(m)||!(v instanceof ca&&Ir(v.property.specification)))continue;const C=u(m,t.type),I=v.value,F=v.property.specification.type,k=!!v.property.useIntegerZoom,z=m==="line-dasharray"||m.endsWith("pattern"),H=t.paint.get(`${m}-use-theme`),$=m==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant"||H&&H.value.kind!=="constant";if(I.kind!=="constant"||$)if(I.kind==="source"||$||z){const ee=w(m,F,"source");this.binders[m]=z?new Tc(I,C,F,ee,t.id):new Ph(I,C,F,ee),f.push(`/a_${m}`)}else{const ee=w(m,F,"composite");this.binders[m]=new Iu(I,C,F,k,o,ee),f.push(`/z_${m}`)}else this.binders[m]=z?new Md(I.value,C):new Ld(I.value,C,F,o),f.push(`/u_${m}`);H&&(this.binders[m].lutExpression=H.value)}this.cacheKey=f.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof Ph||o instanceof Iu?o.maxValue:0}populatePaintArrays(t,o,h,f,m,v,C,I){for(const F in this.binders){const k=this.binders[F];k.context=this.context,(k instanceof Ph||k instanceof Iu||k instanceof Tc)&&k.populatePaintArray(t,o,h,f,m,v,C,I)}}setConstantPatternPositions(t,o){for(const h in this.binders){const f=this.binders[h];f instanceof Md&&f.setConstantPatternPositions(t,o)}}getPatternTransitionVertexBuffer(t){const o=this.binders[t];return o instanceof Tc?o.paintTransitionVertexBuffer:null}updatePaintArrays(t,o,h,f,m,v,C,I,F,k){let z=!1;const H=Object.keys(t),$=H.length!==0&&!I,ee=$?H:o.uniqueIds;this.context.lut=m.lut;for(const ae in this.binders){const Ae=this.binders[ae];if(Ae.context=this.context,(Ae instanceof Ph||Ae instanceof Iu||Ae instanceof Tc)&&Ae.expression&&Ae.expression.kind&&Ae.expression.kind!=="constant"&&(Ae.expression.isStateDependent===!0||Ae.expression.isLightConstant===!1)){const ve=m.paint.get(ae);Ae.expression=ve.value;for(const Fe of ee){const Le=t[Fe.toString()];o.eachPosition(Fe,(ce,Ee,ke)=>{const He=f.feature(ce);Ae.updatePaintArray(Ee,ke,He,Le,v,C,F,k)})}if(!$)for(const Fe of h.uniqueIds){const Le=t[Fe.toString()];h.eachPosition(Fe,(ce,Ee,ke)=>{const He=f.feature(ce);Ae.updatePaintArray(Ee,ke,He,Le,v,C,F,k)})}z=!0}}return z}defines(){const t=[];for(const o in this.binders){const h=this.binders[o];(h instanceof Ld||h instanceof Md)&&t.push(...h.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Ph||h instanceof Iu||h instanceof Tc)for(let f=0;f<h.paintVertexAttributes.length;f++)t.push(h.paintVertexAttributes[f].name);if(h instanceof Tc)for(let f=0;f<Wf.members.length;f++)t.push(Wf.members[f].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Ld||h instanceof Md||h instanceof Iu)for(const f of h.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof Ld||f instanceof Md||f instanceof Iu)for(const m of f.uniformNames)o.push({name:m,property:h,binding:f.getBinding(t,m)})}return o}setUniforms(t,o,h,f,m){for(const{name:v,property:C,binding:I}of h)this.binders[C].setUniform(t,I,m,f.get(C),v)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof Ph||o instanceof Iu||o instanceof Tc)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof Tc&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(t){for(const o in this.binders){const h=this.binders[o];(h instanceof Ph||h instanceof Iu||h instanceof Tc)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof Ph||o instanceof Iu||o instanceof Tc)&&o.destroy()}}}class p{constructor(t,o,h=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new IA(f,o,h);this.needsUpload=!1,this._featureMap=new Id,this._featureMapWithoutIds=new Id,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,h,f,m,v,C,I,F){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(t,o,f,m,v,C,I,F);o.id!==void 0?this._featureMap.add(o.id,h,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,h,f,m,v,C,I){for(const F of h)this.needsUpload=this.programConfigurations[F.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,F,f,m,v,C||0,I)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const n={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function u(l,t){return n[l]||[l.replace(`${t}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:Ih,composite:Ih},"fill-pattern":{source:Ih,composite:Ih},"fill-extrusion-pattern":{source:Ih,composite:Ih},"line-dasharray":{source:wd,composite:wd}},_={color:{source:Mh,composite:Xa},number:{source:qh,composite:Mh}};function w(l,t,o){const h=g[l];return h&&h[o]||_[t][o]}Zi(Ld,"ConstantBinder"),Zi(Md,"PatternConstantBinder"),Zi(Ph,"SourceExpressionBinder"),Zi(Tc,"PatternCompositeBinder"),Zi(Iu,"CompositeExpressionBinder"),Zi(IA,"ProgramConfiguration",{omit:["_buffers"]}),Zi(p,"ProgramConfigurationSet");const S=wi/Math.PI/2,L=5,M=6,V=16383,Y=64,J=[Y,32,16],Z=-S,te=S;function de(l,t,o,h=S){return o=dn(o),[l*Math.sin(o)*h,-t*h,l*Math.cos(o)*h]}function ue(l,t,o){return de(Math.cos(dn(l)),Math.sin(dn(l)),t,o)}const ge=63710088e-1,_e=2*Math.PI*ge;class Te{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Te(Rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,h=this.lat*o,f=t.lat*o,m=Math.sin(h)*Math.sin(f)+Math.cos(h)*Math.cos(f)*Math.cos((t.lng-this.lng)*o);return ge*Math.acos(Math.min(m,1))}toBounds(t=0){const o=360*t/40075017,h=o/Math.cos(Math.PI/180*this.lat);return new Ne({lng:this.lng-h,lat:this.lat-o},{lng:this.lng+h,lat:this.lat+o})}toEcef(t){return ue(this.lat,this.lng,S+t*S/ge)}static convert(t){if(t instanceof Te)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Te(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Te(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Ne{constructor(t,o){if(t)if(o)this.setSouthWest(t).setNorthEast(o);else if(t.length===4){const h=t;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=t;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(t){return this._ne=t instanceof Te?new Te(t.lng,t.lat):Te.convert(t),this}setSouthWest(t){return this._sw=t instanceof Te?new Te(t.lng,t.lat):Te.convert(t),this}extend(t){const o=this._sw,h=this._ne;let f,m;if(t instanceof Te)f=t,m=t;else{if(!(t instanceof Ne))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ne.convert(t)):this.extend(Te.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(Te.convert(t)):this;if(f=t._sw,m=t._ne,!f||!m)return this}return o||h?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),h.lng=Math.max(m.lng,h.lng),h.lat=Math.max(m.lat,h.lat)):(this._sw=new Te(f.lng,f.lat),this._ne=new Te(m.lng,m.lat)),this}getCenter(){return new Te((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Te(this.getWest(),this.getNorth())}getSouthEast(){return new Te(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:h}=Te.convert(t);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f}static convert(t){if(t)return t instanceof Ne?t:new Ne(t)}}const Qe=0,at=25.5;function st(l){return _e*Math.cos(l*Math.PI/180)}function it(l){return(180+l)/360}function Xe(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function lt(l,t){return l/st(t)}function dt(l){return 360*l-180}function kt(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Dt(l,t){return l*st(kt(t))}const ti=85.051129;function ri(l){return Math.cos(dn(Ge(l,-85.051129,ti)))}function vi(l,t){const o=Ge(t,Qe,at),h=Math.pow(2,o);return ri(l)*_e/(512*h)}function Mt(l){return 1/Math.cos(l*Math.PI/180)}function Vt(l,t=0){const o=Math.exp(Math.PI*(1-(l.y+t/wi)/(1<<l.z)*2));return 80150034*o/(o*o+1)/wi/(1<<l.z)}class wt{constructor(t,o,h=0){this.x=+t,this.y=+o,this.z=+h}static fromLngLat(t,o=0){const h=Te.convert(t);return new wt(it(h.lng),Xe(h.lat),lt(o,h.lat))}toLngLat(){return new Te(dt(this.x),kt(this.y))}toAltitude(){return Dt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/_e*Mt(kt(this.y))}}function oi(l,t,o,h,f,m,v,C,I){const F=(t+h)/2,k=(o+f)/2,z=new qt(F,k);C(z),function(H,$,ee,ae,Ae,ve){const Fe=ee-Ae,Le=ae-ve;return Math.abs((ae-$)*Fe-(ee-H)*Le)/Math.hypot(Fe,Le)}(z.x,z.y,m.x,m.y,v.x,v.y)>=I?(oi(l,t,o,F,k,m,z,C,I),oi(l,F,k,h,f,z,v,C,I)):l.push(v)}function zt(l,t,o){let h=l[0],f=h.x,m=h.y;t(h);const v=[h];for(let C=1;C<l.length;C++){const I=l[C],{x:F,y:k}=I;t(I),oi(v,f,m,F,k,h,I,t,o),f=F,m=k,h=I}return v}function mi(l,t,o,h){if(h(t,o)){const f=t.add(o)._mult(.5);mi(l,t,f,h),mi(l,f,o,h)}else l.push(o)}function Li(l,t){let o=l[0];const h=[o];for(let f=1;f<l.length;f++){const m=l[f];mi(h,o,m,t),o=m}return h}const ai=Math.pow(2,14)-1,Mi=-ai-1;function ir(l,t){const o=Math.round(l.x*t),h=Math.round(l.y*t);return l.x=Ge(o,Mi,ai),l.y=Ge(h,Mi,ai),(o<l.x||o>l.x+1||h<l.y||h>l.y+1)&&Yr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function tr(l,t,o){const h=l.loadGeometry(),f=l.extent,m=wi/f;if(t&&o&&o.projection.isReprojectedInTileSpace){const v=1<<t.z,{scale:C,x:I,y:F,projection:k}=o,z=H=>{const $=dt((t.x+H.x/f)/v),ee=kt((t.y+H.y/f)/v),ae=k.project($,ee);H.x=(ae.x*C-I)*f,H.y=(ae.y*C-F)*f};for(let H=0;H<h.length;H++)if(l.type!==1)h[H]=zt(h[H],z,1);else{const $=[];for(const ee of h[H])ee.x<0||ee.x>=f||ee.y<0||ee.y>=f||(z(ee),$.push(ee));h[H]=$}}for(const v of h)for(const C of v)ir(C,m);return h}function Ki(l,t){return{type:l.type,id:l.id,properties:l.properties,geometry:t?tr(l):[]}}var pr,gr,Cr,Hr,sn,Yn,xs,es={};function is(){if(gr)return pr;gr=1;var l=yr();function t(f,m,v,C,I){this.properties={},this.extent=v,this.type=0,this._pbf=f,this._geometry=-1,this._keys=C,this._values=I,f.readFields(o,this,m)}function o(f,m,v){f==1?m.id=v.readVarint():f==2?function(C,I){for(var F=C.readVarint()+C.pos;C.pos<F;){var k=I._keys[C.readVarint()],z=I._values[C.readVarint()];I.properties[k]=z}}(v,m):f==3?m.type=v.readVarint():f==4&&(m._geometry=v.pos)}function h(f){for(var m,v,C=0,I=0,F=f.length,k=F-1;I<F;k=I++)C+=((v=f[k]).x-(m=f[I]).x)*(m.y+v.y);return C}return pr=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var m,v=f.readVarint()+f.pos,C=1,I=0,F=0,k=0,z=[];f.pos<v;){if(I<=0){var H=f.readVarint();C=7&H,I=H>>3}if(I--,C===1||C===2)F+=f.readSVarint(),k+=f.readSVarint(),C===1&&(m&&z.push(m),m=[]),m.push(new l(F,k));else{if(C!==7)throw new Error("unknown command "+C);m&&m.push(m[0].clone())}}return m&&z.push(m),z},t.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var m=f.readVarint()+f.pos,v=1,C=0,I=0,F=0,k=1/0,z=-1/0,H=1/0,$=-1/0;f.pos<m;){if(C<=0){var ee=f.readVarint();v=7&ee,C=ee>>3}if(C--,v===1||v===2)(I+=f.readSVarint())<k&&(k=I),I>z&&(z=I),(F+=f.readSVarint())<H&&(H=F),F>$&&($=F);else if(v!==7)throw new Error("unknown command "+v)}return[k,H,z,$]},t.prototype.toGeoJSON=function(f,m,v){var C,I,F=this.extent*Math.pow(2,v),k=this.extent*f,z=this.extent*m,H=this.loadGeometry(),$=t.types[this.type];function ee(ve){for(var Fe=0;Fe<ve.length;Fe++){var Le=ve[Fe];ve[Fe]=[360*(Le.x+k)/F-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+z)/F)*Math.PI/180))-90]}}switch(this.type){case 1:var ae=[];for(C=0;C<H.length;C++)ae[C]=H[C][0];ee(H=ae);break;case 2:for(C=0;C<H.length;C++)ee(H[C]);break;case 3:for(H=function(ve){var Fe=ve.length;if(Fe<=1)return[ve];for(var Le,ce,Ee=[],ke=0;ke<Fe;ke++){var He=h(ve[ke]);He!==0&&(ce===void 0&&(ce=He<0),ce===He<0?(Le&&Ee.push(Le),Le=[ve[ke]]):Le.push(ve[ke]))}return Le&&Ee.push(Le),Ee}(H),C=0;C<H.length;C++)for(I=0;I<H[C].length;I++)ee(H[C][I])}H.length===1?H=H[0]:$="Multi"+$;var Ae={type:"Feature",geometry:{type:$,coordinates:H},properties:this.properties};return"id"in this&&(Ae.id=this.id),Ae},pr}function uo(){if(Hr)return Cr;Hr=1;var l=is();function t(h,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(o,this,f),this.length=this._features.length}function o(h,f,m){h===15?f.version=m.readVarint():h===1?f.name=m.readString():h===5?f.extent=m.readVarint():h===2?f._features.push(m.pos):h===3?f._keys.push(m.readString()):h===4&&f._values.push(function(v){for(var C=null,I=v.readVarint()+v.pos;v.pos<I;){var F=v.readVarint()>>3;C=F===1?v.readString():F===2?v.readFloat():F===3?v.readDouble():F===4?v.readVarint64():F===5?v.readVarint():F===6?v.readSVarint():F===7?v.readBoolean():null}return C}(m))}return Cr=t,t.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var f=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,f,this.extent,this._keys,this._values)},Cr}function Jr(){return xs||(xs=1,es.VectorTile=function(){if(Yn)return sn;Yn=1;var l=uo();function t(o,h,f){if(o===3){var m=new l(f,f.readVarint()+f.pos);m.length&&(h[m.name]=m)}}return sn=function(o,h){this.layers=o.readFields(t,{},h)},sn}(),es.VectorTileFeature=is(),es.VectorTileLayer=uo()),es}var ln=Jr();const yn="3d_elevation_id",Ps="level";class Qo{constructor(){this._valid=!1}reset(t){return this.feature=t,this._valid=!0,this._geometry=t.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(t,o){return this._valid&&t(o(this._geometry)),this}require(t,o,h){return this.get(t,!0,o,h)}optional(t,o,h){return this.get(t,!1,o,h)}success(){return this._valid}get(t,o,h,f){const m=this.feature.properties.hasOwnProperty(t)?+this.feature.properties[t]:void 0;return this._valid&&m!==void 0&&!Number.isNaN(m)?h(f?f(m):m):o&&(this._valid=!1),this}}class Es{constructor(t,o){this.featureFunc=t,this.vertexFunc=o}parseFeature(t,o,h){return this.featureFunc(t,o,h)}parseVertex(t,o,h){return this.vertexFunc(t,o,h)}}const Hn=new Es((l,t,o)=>l.reset(t).require(yn,h=>{o.id=h}).optional("fixed_height_relative",h=>{o.constantHeight=h},Fn.decodeRelativeHeight).geometry(h=>{o.bounds=h},bc).success(),(l,t,o)=>l.reset(t).require(yn,h=>{o.id=h}).require("elevation_idx",h=>{o.idx=h}).require("extent",h=>{o.extent=h}).require("height_relative",h=>{o.height=h},Fn.decodeRelativeHeight).geometry(h=>{o.position=h},Fn.getPoint).success()),to=new Es((l,t,o)=>l.reset(t).require(yn,h=>{o.id=h}).optional("fixed_height",h=>{o.constantHeight=h},Fn.decodeMetricHeight).geometry(h=>{o.bounds=h},bc).success(),(l,t,o)=>l.reset(t).require(yn,h=>{o.id=h}).require("elevation_idx",h=>{o.idx=h}).require("extent",h=>{o.extent=h}).require("height",h=>{o.height=h},Fn.decodeMetricHeight).geometry(h=>{o.position=h},Fn.getPoint).success());class Fn{static getPoint(t){return Vi(t[0][0].x,t[0][0].y)}static decodeRelativeHeight(t){return 1e-4*t*5}static decodeMetricHeight(t){return 1e-4*t}static parse(t){const o=[],h=[],f=t.length,m=new Qo;for(let C=0;C<f;C++){const I=t.feature(C),F=I.properties.hasOwnProperty("version")?String(I.properties.version):void 0,k=(v=F)?v==="1.0.1"?to:void 0:Hn;if(k===void 0){Yr(`Unknown elevation feature version number ${F||"(unknown)"}`);continue}const z=I.properties.hasOwnProperty("type")?I.properties.type:void 0;if(z){if(ln.VectorTileFeature.types[I.type]==="Point"&&z==="curve_point"){const H={};k.parseVertex(m,I,H)&&o.push(H)}else if(ln.VectorTileFeature.types[I.type]==="Polygon"&&z==="curve_meta"){const H={};k.parseFeature(m,I,H)&&h.push(H)}}}var v;return{vertices:o,features:h}}}class Io{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,h){const f=Ur(o,this.dir);if(Math.abs(f)<1e-6)return!1;const m=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1])/f;return h[0]=this.pos[0]+this.dir[0]*m,h[1]=this.pos[1]+this.dir[1]*m,!0}}class ks{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,h){const f=Ct(o,this.dir);if(Math.abs(f)<1e-6)return!1;const m=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/f;return h[0]=this.pos[0]+this.dir[0]*m,h[1]=this.pos[1]+this.dir[1]*m,h[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(t,o,h){if(function($,ee){var ae=$[0],Ae=$[1],ve=$[2],Fe=ee[0],Le=ee[1],ce=ee[2];return Math.abs(ae-Fe)<=y*Math.max(1,Math.abs(ae),Math.abs(Fe))&&Math.abs(Ae-Le)<=y*Math.max(1,Math.abs(Ae),Math.abs(Le))&&Math.abs(ve-ce)<=y*Math.max(1,Math.abs(ve),Math.abs(ce))}(this.pos,t)||o===0)return h[0]=h[1]=h[2]=0,!1;const[f,m,v]=this.dir,C=this.pos[0]-t[0],I=this.pos[1]-t[1],F=this.pos[2]-t[2],k=f*f+m*m+v*v,z=2*(C*f+I*m+F*v),H=z*z-4*k*(C*C+I*I+F*F-o*o);if(H<0){const $=Math.max(-z/2,0),ee=C+f*$,ae=I+m*$,Ae=F+v*$,ve=Math.hypot(ee,ae,Ae);return h[0]=ee*o/ve,h[1]=ae*o/ve,h[2]=Ae*o/ve,!1}{const $=(-z-Math.sqrt(H))/(2*k);if($<0){const ee=Math.hypot(C,I,F);return h[0]=C*o/ee,h[1]=I*o/ee,h[2]=F*o/ee,!1}return h[0]=C+f*$,h[1]=I+m*$,h[2]=F+v*$,!0}}}class N{constructor(t,o,h,f,m){this.TL=t,this.TR=o,this.BR=h,this.BL=f,this.horizon=m}static fromInvProjectionMatrix(t,o,h){const f=[-1,1,1],m=[1,1,1],v=[1,-1,1],C=[-1,-1,1],I=tt(f,f,t),F=tt(m,m,t),k=tt(v,v,t),z=tt(C,C,t);return new N(I,F,k,z,o/h)}}function O(l,t,o){let h=1/0,f=-1/0;const m=[];for(const v of l){Ke(m,v,t);const C=Ct(m,o);h=Math.min(h,C),f=Math.max(f,C)}return[h,f]}function X(l,t){let o=!0;for(let h=0;h<l.planes.length;h++){const f=l.planes[h];let m=0;for(let v=0;v<t.length;v++)m+=Ct(f,t[v])+f[3]>=0;if(m===0)return 0;m!==t.length&&(o=!1)}return o?2:1}function W(l,t){for(const o of l.projections){const h=O(t,l.points[0],o.axis);if(o.projection[1]<h[0]||o.projection[0]>h[1])return 0}return 1}function le(l,t){let o=0;const h=[0,0,0,0];for(let v=0;v<l.length;v++)h[0]=l[v][0],h[1]=l[v][1],h[2]=l[v][2],h[3]=1,(f=h)[0]*(m=t)[0]+f[1]*m[1]+f[2]*m[2]+f[3]*m[3]>=0&&o++;var f,m;return o}class we{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=Re.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ke([],this.points[2],this.points[3]),Ke([],this.points[0],this.points[3]),Ke([],this.points[4],this.points[0]),Ke([],this.points[5],this.points[1]),Ke([],this.points[6],this.points[2]),Ke([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const f=[0,-h[2],h[1]],m=[h[2],0,-h[0]];this.projections.push({axis:f,projection:O(this.points,this.points[0],f)}),this.projections.push({axis:m,projection:O(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(t,o,h,f){const m=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>{const k=Kt([],F,t),z=1/k[3]/o*m;return(H=k)[0]=($=k)[0]*(ee=[z,z,f?1/k[3]:z,z])[0],H[1]=$[1]*ee[1],H[2]=$[2]*ee[2],H[3]=$[3]*ee[3],H;var H,$,ee}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const k=mt([],rt([],Ke([],v[F[0]],v[F[1]]),Ke([],v[F[2]],v[F[1]]))),z=-Ct(k,v[F[1]]);return k.concat(z)}),I=[];for(let F=0;F<v.length;F++)I.push([v[F][0],v[F][1],v[F][2]]);return new we(I,C)}intersectsPrecise(t,o,h){for(let f=0;f<o.length;f++)if(!le(t,o[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!le(t,this.planes[f]))return 0;for(const f of h)for(const m of this.frustumEdges){const v=rt([],f,m),C=Me(v);if(C===0)continue;pt(v,v,1/C);const I=O(this.points,this.points[0],v),F=O(t,this.points[0],v);if(I[0]>F[1]||F[0]>I[1])return 0}return 1}containsPoint(t){for(const o of this.planes){const h=o[3];if(Ct([o[0],o[1],o[2]],t)+h<0)return!1}return!0}}class Re{static fromPoints(t){const o=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const f of t)Ye(o,o,f),bt(h,h,f);return new Re(o,h)}static fromTileIdAndHeight(t,o,h){const f=1<<t.canonical.z,m=t.canonical.x,v=t.canonical.y;return new Re([m/f,v/f,o],[(m+1)/f,(v+1)/f,h])}static applyTransform(t,o){const h=t.getCorners();for(let f=0;f<h.length;++f)tt(h[f],h[f],o);return Re.fromPoints(h)}static applyTransformFast(t,o){const h=[o[12],o[13],o[14]],f=[...h];for(let m=0;m<3;m++)for(let v=0;v<3;v++){const C=o[4*v+m],I=C*t.min[v],F=C*t.max[v];h[m]+=Math.min(I,F),f[m]+=Math.max(I,F)}return new Re(h,f)}static projectAabbCorners(t,o){const h=t.getCorners();for(let f=0;f<h.length;++f)tt(h[f],h[f],o);return h}constructor(t,o){this.min=t,this.max=o,this.center=pt([],Pe([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],h=ye(this.min),f=ye(this.max);for(let m=0;m<o.length;m++)h[m]=o[m]?this.min[m]:this.center[m],f[m]=o[m]?this.center[m]:this.max[m];return f[2]=this.max[2],new Re(h,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?X(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?X(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?W(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?W(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Zi(Re,"Aabb");class ft{constructor(t,o){this.feature=t,this.metersToTile=o,this.index=0}get(){const t=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,h=o[1],f=-o[0],m=(t.extent+1)*this.metersToTile;return[new qt(Math.trunc(t.position[0]+h*m),Math.trunc(t.position[1]+f*m)),new qt(Math.trunc(t.position[0]-h*m),Math.trunc(t.position[1]-f*m))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class At{constructor(t,o,h,f,m,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=t,this.heightRange={min:h,max:h},this.safeArea=o,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||f.length!==0)){this.vertices=f,this.edges=m,this.edges=this.edges.filter(C=>{return C.a<this.vertices.length&&C.b<this.vertices.length&&!((I=this.vertices[C.a].position)[0]===(F=this.vertices[C.b].position)[0]&&I[1]===F[1]);var I,F}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const C of this.vertices)this.vertexProps.push({dir:Vi(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,C.height),this.heightRange.max=Math.max(this.heightRange.max,C.height);for(const C of this.edges){const I=this.vertices[C.a].position,F=this.vertices[C.b].position,k=qr(li(),F,I),z=Zr(k),H=_r(li(),k,1/z);this.edgeProps.push({vec:k,dir:H,len:z});const $=this.vertexProps[C.a].dir,ee=this.vertexProps[C.b].dir;rr($,$,H),rr(ee,ee,H)}for(const C of this.vertexProps)C.dir[0]===0&&C.dir[1]===0||io(C.dir,C.dir);this.tessellate(v)}}pointElevation(t){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(t);if(o==null)return 0;const[h,f]=o;return Er(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,f)}computeSlopeNormal(t,o){const h=this.getClosestEdge(t);if(!h)return Be(0,0,1);const f=h[0],m=this.edges[f],v=this.edgeProps[f].vec,C=Be(v[0],v[1],(this.vertices[m.b].height-this.vertices[m.a].height)*o),I=Be(C[1],-C[0],0);rt(I,I,C);const F=Me(I);return F>0?pt(I,I,1/F):Be(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(t){if(this.edges.length===0)return;let o=0,h=Number.POSITIVE_INFINITY,f=0;const m=Vi(t.x,t.y);for(let v=0;v<this.edges.length;v++){const C=this.edges[v],I=this.edgeProps[v].dir,F=new Io(m,this.edgeProps[v].dir),k=this.vertices[C.a].position,z=this.vertices[C.b].position,H=li(),$=li(),ee=F.intersectsPlane(k,this.vertexProps[C.a].dir,H),ae=F.intersectsPlane(z,this.vertexProps[C.b].dir,$);if(!ee||!ae)continue;const Ae=qr(li(),$,H),ve=qr(li(),m,H),Fe=Ur(Ae,Ae),Le=Fe>0?Ur(ve,Ae)/Fe:0,ce=Ge(Le,0,1),Ee=Math.abs((Le-ce)*this.edgeProps[v].len),ke=qr(li(),m,k),He=Ee+Math.abs(Ur(ke,Vi(I[1],-I[0])));He<h&&(o=v,h=He,f=ce)}return[o,f]}tessellate(t){for(let o=this.edges.length-1;o>=0;--o){const h=this.edges[o].a,f=this.edges[o].b,{position:m,height:v,extent:C}=this.vertices[h],{position:I,height:F,extent:k}=this.vertices[f],z=this.vertexProps[h].dir,H=this.vertexProps[f].dir,$=Be(m[0]/t,m[1]/t,v),ee=Be(I[0]/t,I[1]/t,F),ae=Be(z[1],-z[0],0);pt(ae,ae,C);const Ae=Be(H[1],-H[0],0);if(pt(Ae,Ae,k),this.distSqLines(Be($[0]+.5*ae[0],$[1]+.5*ae[1],$[2]+.5*ae[2]),Be(ee[0]-.5*Ae[0],ee[1]-.5*Ae[1],ee[2]-.5*Ae[2]),Be($[0]-.5*ae[0],$[1]-.5*ae[1],$[2]-.5*ae[2]),Be(ee[0]+.5*Ae[0],ee[1]+.5*Ae[1],ee[2]+.5*Ae[2]))<=.0025000000000000005)continue;const ve=this.vertices.length,Fe=rr(li(),m,I);this.vertices.push({position:_r(Fe,Fe,.5),height:.5*(v+F),extent:.5*(C+k)});const Le=rr(li(),z,H);this.vertexProps.push({dir:io(Le,Le)}),this.edges.splice(o,1),this.edgeProps.splice(o,1),this.edges.push({a:h,b:ve}),this.edges.push({a:ve,b:f});const ce=qr(li(),this.vertices[ve].position,m),Ee=Zr(ce),ke={vec:ce,dir:_r(li(),ce,1/Ee),len:Ee};this.edgeProps.push(ke),this.edgeProps.push(ke)}}distSqLines(t,o,h,f){const m=De(oe(),o,t),v=De(oe(),f,h),C=De(oe(),t,h),I=Ct(m,m),F=Ct(m,v),k=Ct(m,C),z=Ct(v,v),H=Ct(v,C),$=I*z-F*F;if($===0){const Ae=Ct(C,v)/Ct(v,v);return Ie(Bt(oe(),h,f,Ae),t)}const ee=(F*H-k*z)/$,ae=(I*H-F*k)/$;return Ie(Bt(oe(),t,o,ee),Bt(oe(),h,f,ae))}}class Ht{static parseFrom(t,o){const h=Fn.parse(t);if(!h)return[];let{vertices:f,features:m}=h;const v=1/Vt(o);m.sort((k,z)=>k.id-z.id),f.sort((k,z)=>k.id-z.id||k.idx-z.idx),f=f.filter((k,z,H)=>z===H.findIndex($=>$.id===k.id&&$.idx===k.idx));const C=new Array;let I=0;const F=f.length;for(const k of m){if(k.constantHeight){C.push(new At(k.id,k.bounds,k.constantHeight));continue}for(;I!==F&&f[I].id<k.id;)I++;if(I===F||f[I].id!==k.id)continue;const z=new Array,H=new Array,$=I;for(;I!==F&&f[I].id===k.id;){const ee=f[I];if(z.push({position:ee.position,height:ee.height,extent:ee.extent}),I!==$&&f[I-1].idx===ee.idx-1){const ae=I-$;H.push({a:ae-1,b:ae})}I++}C.push(new At(k.id,k.bounds,void 0,z,H,v))}return C}static getElevationFeature(t,o){if(!o)return;const h=+t.properties[yn];return Number.isNaN(h)?void 0:o.find(f=>f.id===h)}}class si{constructor(t,o){this.zScale=1,this.xOffset=0,this.yOffset=0,t.equals(o)||(this.zScale=Math.pow(2,o.z-t.z),this.xOffset=(t.x*this.zScale-o.x)*wi,this.yOffset=(t.y*this.zScale-o.y)*wi)}constantElevation(t,o){if(t.constantHeight!=null)return this.computeBiasedHeight(t.constantHeight,o)}pointElevation(t,o,h){const f=this.constantElevation(o,h);return f??(t.x=t.x*this.zScale+this.xOffset,t.y=t.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(t),h))}computeBiasedHeight(t,o){return o<=0?t:t+o*vt(0,o,t>=0?t:Math.abs(.5*t))}}Zi(At,"ElevationFeature");class gi{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Yu,this.indexArray=new Zo,this.segments=new Vs,this.programConfigurations=new p(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new qh),this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,h,f){const m=this.layers[0],v=[];let C=null;m.type==="circle"&&(C=m.layout.get("circle-sort-key"));for(const{feature:F,id:k,index:z,sourceLayerIndex:H}of t){const $=this.layers[0]._featureFilter.needGeometry,ee=Ki(F,$);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),ee,h))continue;const ae=C?C.evaluate(ee,{},h):void 0,Ae={id:k,properties:F.properties,type:F.type,sourceLayerIndex:H,index:z,geometry:$?ee.geometry:tr(F,h,f),patterns:{},sortKey:ae};v.push(Ae)}C&&v.sort((F,k)=>F.sortKey-k.sortKey);let I=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new rf,I=f.projection);for(const F of v){const{geometry:k,index:z,sourceLayerIndex:H}=F,$=t[z].feature;this.addFeature(F,k,z,o.availableImages,h,I,o.brightness,o.elevationFeatures),o.featureIndex.insert($,k,z,H,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(t,o,h,f,m,v,C){this.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,SA.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Tu.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,ed.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(t,o,h,f,m,v,C,I){let F;this.elevationMode!=="none"&&(F=Ht.getElevationFeature(t,I));for(const k of o)for(const z of k){const H=z.x,$=z.y;if(H<0||H>=wi||$<0||$>=wi)continue;if(v){const Ae=v.projectTilePoint(H,$,m),ve=v.upVector(m,H,$);this.addGlobeExtVertex(Ae,ve),this.addGlobeExtVertex(Ae,ve),this.addGlobeExtVertex(Ae,ve),this.addGlobeExtVertex(Ae,ve)}const ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),ae=ee.vertexLength;if(this.addCircleVertex(H,$,-1,-1),this.addCircleVertex(H,$,1,-1),this.addCircleVertex(H,$,1,1),this.addCircleVertex(H,$,-1,1),this.elevationMode!=="none"){const Ae=F?F.pointElevation(new qt(H,$)):0;this.hasElevation=this.hasElevation||Ae!==0;for(let ve=0;ve<4;ve++)this.elevatedLayoutVertexArray.emplaceBack(Ae)}this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+2,ae+3),ee.vertexLength+=4,ee.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{},f,m,C,void 0,this.worldview)}addCircleVertex(t,o,h,f){this.layoutVertexArray.emplaceBack(2*t+(h+1)/2,2*o+(f+1)/2)}addGlobeExtVertex(t,o){this.globeExtVertexArray.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}}function Ui(l,t){for(let o=0;o<l.length;o++)if(rs(t,l[o]))return!0;for(let o=0;o<t.length;o++)if(rs(l,t[o]))return!0;return!!Kn(l,t)}function Gr(l,t,o){return!!rs(l,t)||!!ts(t,l,o)}function vr(l,t){if(l.length===1)return Kr(t,l[0]);for(let o=0;o<t.length;o++){const h=t[o];for(let f=0;f<h.length;f++)if(rs(l,h[f]))return!0}for(let o=0;o<l.length;o++)if(Kr(t,l[o]))return!0;for(let o=0;o<t.length;o++)if(Kn(l,t[o]))return!0;return!1}function Rr(l,t,o){if(l.length>1){if(Kn(l,t))return!0;for(let h=0;h<t.length;h++)if(ts(t[h],l,o))return!0}for(let h=0;h<l.length;h++)if(ts(l[h],t,o))return!0;return!1}function Kn(l,t){if(l.length===0||t.length===0)return!1;for(let o=0;o<l.length-1;o++){const h=l[o],f=l[o+1];for(let m=0;m<t.length-1;m++)if(An(h,f,t[m],t[m+1]))return!0}return!1}function An(l,t,o,h){return Wn(l,o,h)!==Wn(t,o,h)&&Wn(l,t,o)!==Wn(l,t,h)}function rn(l,t,o){return(l.x-o.x)*(t.y-o.y)-(l.y-o.y)*(t.x-o.x)}function Xs(l,t,o,h){const f=rn(l,t,h),m=rn(l,t,o);if(Math.sign(f)===Math.sign(m))return;const v=rn(o,h,l),C=v+m-f;return Math.sign(v)!==Math.sign(C)?[v/(v-C),m/(m-f)]:void 0}function ts(l,t,o){const h=o*o;if(t.length===1)return l.distSqr(t[0])<h;for(let f=1;f<t.length;f++)if(Dn(l,t[f-1],t[f])<h)return!0;return!1}function Dn(l,t,o){const h=t.distSqr(o);if(h===0)return l.distSqr(t);const f=((l.x-t.x)*(o.x-t.x)+(l.y-t.y)*(o.y-t.y))/h;return l.distSqr(f<0?t:f>1?o:o.sub(t)._mult(f)._add(t))}function Kr(l,t){let o,h,f,m=!1;for(let v=0;v<l.length;v++){o=l[v];for(let C=0,I=o.length-1;C<o.length;I=C++)h=o[C],f=o[I],h.y>t.y!=f.y>t.y&&t.x<(f.x-h.x)*(t.y-h.y)/(f.y-h.y)+h.x&&(m=!m)}return m}function rs(l,t){let o=!1;for(let h=0,f=l.length-1;h<l.length;f=h++){const m=l[h],v=l[f];m.y>t.y!=v.y>t.y&&t.x<(v.x-m.x)*(t.y-m.y)/(v.y-m.y)+m.x&&(o=!o)}return o}function bs(l,t,o,h,f){for(const v of l)if(t<=v.x&&o<=v.y&&h>=v.x&&f>=v.y)return!0;const m=[new qt(t,o),new qt(t,f),new qt(h,f),new qt(h,o)];if(l.length>2){for(const v of m)if(rs(l,v))return!0}for(let v=0;v<l.length-1;v++)if(Ln(l[v],l[v+1],m))return!0;return!1}function Ln(l,t,o){const h=o[0],f=o[2];if(l.x<h.x&&t.x<h.x||l.x>f.x&&t.x>f.x||l.y<h.y&&t.y<h.y||l.y>f.y&&t.y>f.y)return!1;const m=Wn(l,t,o[0]);return m!==Wn(l,t,o[1])||m!==Wn(l,t,o[2])||m!==Wn(l,t,o[3])}function Fo(l,t,o,h,f,m){let v=t.y-l.y,C=l.x-t.x;if(m=m||0){const I=v*v+C*C;if(I===0)return!0;const F=Math.sqrt(I);v/=F,C/=F}return!((o.x-l.x)*v+(o.y-l.y)*C-m<0||(h.x-l.x)*v+(h.y-l.y)*C-m<0||(f.x-l.x)*v+(f.y-l.y)*C-m<0)}function uc(l,t,o,h,f,m,v){return!(Fo(l,t,h,f,m,v)||Fo(t,o,h,f,m,v)||Fo(o,l,h,f,m,v)||Fo(h,f,l,t,o,v)||Fo(f,m,l,t,o,v)||Fo(m,h,l,t,o,v))}function El(l,t,o){const h=t.paint.get(l).value;return h.kind==="constant"?h.value:o.programConfigurations.get(t.id).getMaxValue(l)}function po(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Tl(l,t,o,h,f){if(!t[0]&&!t[1])return l;const m=qt.convert(t)._mult(f);o==="viewport"&&m._rotate(-h);const v=[];for(let C=0;C<l.length;C++)v.push(l[C].sub(m));return v}function Pd(l,t,o,h){const f=qt.convert(l)._mult(h);return t==="viewport"&&f._rotate(-o),f}let Ic,Fc;function FA(l,t,o){var h=2*Math.PI*6378137/256/Math.pow(2,o);return[l*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}Zi(gi,"CircleBucket",{omit:["layers"]});class hc{constructor(t,o,h){this.z=t,this.x=o,this.y=h,this.key=Ju(0,t,t,o,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o){const h=function(m,v,C){var I=FA(256*m,256*(v=Math.pow(2,C)-v-1),C),F=FA(256*(m+1),256*(v+1),C);return I[0]+","+I[1]+","+F[0]+","+F[1]}(this.x,this.y,this.z),f=function(m,v,C){let I,F="";for(let k=m;k>0;k--)I=1<<k-1,F+=(v&I?1:0)+(C&I?2:0);return F}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class kd{constructor(t,o){this.wrap=t,this.canonical=o,this.key=Ju(t,o.z,o.z,o.x,o.y)}}class ya{constructor(t,o,h,f,m){this.overscaledZ=t,this.wrap=o,this.canonical=new hc(h,+f,+m),this.key=o===0&&t===h?this.canonical.key:Ju(o,t,h,f,m)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new ya(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ya(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return Ju(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-t;return Ju(this.wrap*+o,t,t,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,h=2*this.canonical.x,f=2*this.canonical.y;return[new ya(o,this.wrap,o,h,f),new ya(o,this.wrap,o,h+1,f),new ya(o,this.wrap,o,h,f+1),new ya(o,this.wrap,o,h+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ya(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new kd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ju(l,t,o,h,f){const m=1<<Math.min(o,22);let v=m*(f%m)+h%m;return l&&o<22&&(v+=m*m*((l<0?-2*l-1:2*l)%(1<<2*(22-o)))),16*(32*v+o)+(t-o)}const Rd=[l=>{let t=l.canonical.x-1,o=l.wrap;return t<0&&(t=(1<<l.canonical.z)-1,o--),new ya(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>{let t=l.canonical.x+1,o=l.wrap;return t===1<<l.canonical.z&&(t=0,o++),new ya(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>new ya(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new ya(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];Zi(hc,"CanonicalTileID"),Zi(ya,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const df=Rn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:eh}=df,qf=Rn([{name:"a_pos_3",components:3,type:"Int16"}]);var $f=Rn([{name:"a_pos",type:"Int16",components:2}]);function t0(l){return l*S/ge}const qI=[new Re([Z,Z,Z],[te,te,te]),new Re([Z,Z,Z],[0,0,te]),new Re([0,Z,Z],[te,0,te]),new Re([Z,0,Z],[0,te,te]),new Re([0,0,Z],[te,te,te])];function lw(l,t,o,h=!0){const f=pt([],l._camera.position,l.worldSize),m=[t,o,1,1];Kt(m,m,l.pixelMatrixInverse),yi(m,m,1/m[3]);const v=mt([],Ke([],m,f)),C=l.globeMatrix,I=[C[12],C[13],C[14]],F=Ke([],I,f),k=Me(F),z=mt([],F),H=l.worldSize/(2*Math.PI),$=Ct(z,v),ee=Math.asin(H/k);if(ee<Math.acos($)){if(!h)return null;const yt=[],Lt=[];pt(yt,v,k/$),mt(Lt,Ke(Lt,yt,F)),mt(v,Pe(v,F,pt(v,Lt,Math.tan(ee)*k)))}const ae=[];new ks(f,v).closestPointOnSphere(I,H,ae);const Ae=mt([],_s(C,0)),ve=mt([],_s(C,1)),Fe=mt([],_s(C,2)),Le=Ct(Ae,ae),ce=Ct(ve,ae),Ee=Ct(Fe,ae),ke=St(Math.asin(-ce/H));let He=St(Math.atan2(Le,Ee));He=l.center.lng+function(yt,Lt){const Wt=(Lt-yt+180)%360-180;return Wt<-180?Wt+360:Wt}(l.center.lng,He);const gt=it(He),ht=Ge(Xe(ke),0,1);return new wt(gt,ht)}class $I{constructor(t,o,h){this.a=Ke([],t,h),this.b=Ke([],o,h),this.center=h;const f=mt([],this.a),m=mt([],this.b);this.angle=Math.acos(Ct(f,m))}}function y_(l,t){if(l.angle===0)return null;let o;return o=l.a[t]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[t]/l.a[t]/Math.sin(l.angle)-1/Math.tan(l.angle)),o<0||o>1?null:function(h,f,m,v){const C=Math.sin(m);return h*(Math.sin((1-v)*m)/C)+f*(Math.sin(v*m)/C)}(l.a[t],l.b[t],l.angle,Ge(o,0,1))+l.center[t]}function LA(l){if(l.z<=1)return qI[l.z+2*l.y+l.x];const t=v_(i0(l));return Re.fromPoints(t)}function Af(l,t,o){return pt(l,l,1-o),Qt(l,l,t,o)}function cw(l,t,o){for(const h of l)tt(h,h,t),pt(h,h,o)}function uw(l,t,o,h){const f=t/l.worldSize,m=l.globeMatrix;if(o.z<=1){const ht=LA(o).getCorners();return cw(ht,m,f),Re.fromPoints(ht)}const v=i0(o,h),C=v_(v,S+t0(l._tileCoverLift));cw(C,m,f);const I=Number.MAX_VALUE,F=[-I,-I,-I],k=[I,I,I];if(v.contains(l.center)){for(const Lt of C)Ye(k,k,Lt),bt(F,F,Lt);F[2]=0;const ht=l.point,yt=[ht.x*f,ht.y*f,0];return Ye(k,k,yt),bt(F,F,yt),new Re(k,F)}if(l._tileCoverLift>0){for(const ht of C)Ye(k,k,ht),bt(F,F,ht);return new Re(k,F)}const z=[m[12]*f,m[13]*f,m[14]*f],H=v.getCenter(),$=Ge(l.center.lat,-85.051129,ti),ee=Ge(H.lat,-85.051129,ti),ae=it(l.center.lng),Ae=Xe($);let ve=ae-it(H.lng);const Fe=Ae-Xe(ee);ve>.5?ve-=1:ve<-.5&&(ve+=1);let Le=0;Math.abs(ve)>Math.abs(Fe)?Le=ve>=0?1:3:(Le=Fe>=0?0:2,Qt(z,z,[m[4]*f,m[5]*f,m[6]*f],-Math.sin(dn(Fe>=0?v.getSouth():v.getNorth()))*S));const ce=C[Le],Ee=C[(Le+1)%4],ke=new $I(ce,Ee,z),He=[y_(ke,0)||ce[0],y_(ke,1)||ce[1],y_(ke,2)||ce[2]],gt=Zf(l.zoom);if(gt>0){const ht=function({x:Lt,y:Wt,z:Si},fi,Ci,Ii,$t){const _i=1/(1<<Si);let Gt=Lt*_i,Yt=Gt+_i,ki=Wt*_i,Di=ki+_i,xr=0;const cr=(Gt+Yt)/2-Ii;return cr>.5?xr=-1:cr<-.5&&(xr=1),Gt=((Gt+xr)*fi-(Ii*=fi))*Ci+Ii,Yt=((Yt+xr)*fi-Ii)*Ci+Ii,ki=(ki*fi-($t*=fi))*Ci+$t,Di=(Di*fi-$t)*Ci+$t,[[Gt,Di,0],[Yt,Di,0],[Yt,ki,0],[Gt,ki,0]]}(o,t,l._pixelsPerMercatorPixel,ae,Ae);for(let Lt=0;Lt<C.length;Lt++)Af(C[Lt],ht[Lt],gt);const yt=Pe([],ht[Le],ht[(Le+1)%4]);pt(yt,yt,.5),Af(He,yt,gt)}for(const ht of C)Ye(k,k,ht),bt(F,F,ht);return k[2]=Math.min(ce[2],Ee[2]),Ye(k,k,He),bt(F,F,He),new Re(k,F)}function i0({x:l,y:t,z:o},h=!1){const f=1/(1<<o),m=new Te(dt(l*f),t===(1<<o)-1&&h?-90:kt((t+1)*f)),v=new Te(dt((l+1)*f),t===0&&h?90:kt(t*f));return new Ne(m,v)}function v_(l,t=S){const o=dn(l.getNorth()),h=dn(l.getSouth()),f=Math.cos(o),m=Math.cos(h),v=Math.sin(o),C=Math.sin(h),I=l.getWest(),F=l.getEast();return[de(m,C,I,t),de(m,C,F,t),de(f,v,F,t),de(f,v,I,t)]}function mm(l,t,o,h){const f=1<<o.z,m=(l/wi+o.x)/f;return ue(kt((t/wi+o.y)/f),dt(m),h)}function r0({min:l,max:t}){return V/Math.max(t[0]-l[0],t[1]-l[1],t[2]-l[2])}const hw=new Float64Array(16);function n0(l){const t=r0(l),o=fe(hw,[t,t,t]);return Q(o,o,ut([],l.min))}function __(l){const t=(h=l.min,(o=hw)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=h[0],o[13]=h[1],o[14]=h[2],o[15]=1,o);var o,h;const f=1/r0(l);return q(t,t,[f,f,f])}function x_(l){const t=wi/(2*Math.PI);return l/(2*Math.PI)/t}function dw(l,t){return wi/(512*Math.pow(2,l))*r0(LA(t))}function Aw(l,t,o,h,f){const m=x_(o),v=[l,t,-o/(2*Math.PI)],C=P(new Float64Array(16));return Q(C,C,v),q(C,C,[m,m,m]),ne(C,C,dn(-f)),re(C,C,dn(-h)),C}function Zf(l){return vt(L,M,l)}function fw(l,t){const o=ue(t.lat,t.lng),h=function(ee){const ae=ue(ee._center.lat,ee._center.lng);let Ae=rt([],Be(0,1,0),ae);const ve=he([],-ee.angle,ae);Ae=tt(Ae,Ae,ve),he(ve,-ee._pitch,Ae);const Fe=mt([],ae);return pt(Fe,Fe,t0(ee.cameraToCenterDistance/ee.pixelsPerMeter)),tt(Fe,Fe,ve),Pe([],ae,Fe)}(l);return v=(f=De([],h,o))[0],C=f[1],I=f[2],F=(m=o)[0],k=m[1],z=m[2],$=(H=Math.sqrt(v*v+C*C+I*I)*Math.sqrt(F*F+k*k+z*z))&&Ct(f,m)/H,Math.acos(Math.min(Math.max($,-1),1));var f,m,v,C,I,F,k,z,H,$}function b_(l,t){return fw(l,t)>Math.PI/2*1.01}const pw=dn(85),ZI=Math.cos(pw),JI=Math.sin(pw),eF=R(),gw=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function mw(l,t,o,h,f,m,v,C,I){if(m&&l.queryGeometry.isAboveHorizon)return!1;m&&(I*=l.pixelToTileUnitsFactor);const F=l.tileID.canonical,k=o.projection.upVectorScale(F,o.center.lat,o.worldSize).metersToTile;for(const z of t)for(const H of z){const $=H.add(C),ee=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt($.x,$.y,!0):0,ae=o.projection.projectTilePoint($.x,$.y,F);if(ee>0){const Le=o.projection.upVector(F,$.x,$.y);ae.x+=Le[0]*k*ee,ae.y+=Le[1]*k*ee,ae.z+=Le[2]*k*ee}const Ae=m?$:tF(ae.x,ae.y,ae.z,h),ve=m?l.tilespaceRays.map(Le=>rF(Le,ee)):l.queryGeometry.screenGeometry,Fe=Kt([],[ae.x,ae.y,ae.z,1],h);if(!v&&m?I*=Fe[3]/o.cameraToCenterDistance:v&&!m&&(I*=o.cameraToCenterDistance/Fe[3]),m){const Le=kt((H.y/wi+F.y)/(1<<F.z));I/=o.projection.pixelsPerMeter(Le,1)/lt(1,Le)}if(Gr(ve,Ae,I))return!0}return!1}function tF(l,t,o,h){const f=Kt([],[l,t,o,1],h);return new qt(f[0]/f[3],f[1]/f[3])}const yw=Be(0,0,0),iF=Be(0,0,1);function rF(l,t){const o=oe();return yw[2]=t,l.intersectsPlane(yw,iF,o),new qt(o[0],o[1])}class vw extends gi{}let _w,xw,bw,ww;function Bw(l,{width:t,height:o},h,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*o*h)throw new RangeError("mismatched image size")}else f=new Uint8Array(t*o*h);return l.width=t,l.height=o,l.data=f,l}function Cw(l,t,o){const{width:h,height:f}=t;h===l.width&&f===l.height||(w_(l,t,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,f)},o,null),l.width=h,l.height=f,l.data=t.data)}function w_(l,t,o,h,f,m,v,C){if(f.width===0||f.height===0)return t;if(f.width>l.width||f.height>l.height||o.x>l.width-f.width||o.y>l.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||h.x>t.width-f.width||h.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const I=l.data,F=t.data,k=m===4&&C;for(let z=0;z<f.height;z++){const H=((o.y+z)*l.width+o.x)*m,$=((h.y+z)*t.width+h.x)*m;if(k)for(let ee=0;ee<f.width;ee++){const ae=H+ee*m+3,Ae=$+ee*m;F[Ae+0]=255,F[Ae+1]=255,F[Ae+2]=255,F[Ae+3]=I[ae]}else if(v)for(let ee=0;ee<f.width;ee++){const ae=H+ee*m,Ae=$+ee*m,ve=new Un(I[ae+0]/255,I[ae+1]/255,I[ae+2]/255,I[ae+3]).toNonPremultipliedRenderColor(v).toArray();F[Ae+0]=ve[0],F[Ae+1]=ve[1],F[Ae+2]=ve[2],F[Ae+3]=ve[3]}else for(let ee=0;ee<f.width*m;ee++)F[$+ee]=I[H+ee]}return t}Zi(vw,"HeatmapBucket",{omit:["layers"]});class Jf{constructor(t,o){Bw(this,t,1,o)}resize(t){Cw(this,new Jf(t),1)}clone(){return new Jf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,h,f,m){w_(t,o,h,f,m,1,null)}}class Il{constructor(t,o){Bw(this,t,4,o)}resize(t){Cw(this,new Il(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Il({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,h,f,m,v,C){w_(t,o,h,f,m,4,v,C)}}class Sw{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function ym(l){const t={},o=l.resolution||256,h=l.clips?l.clips.length:1,f=l.image||new Il({width:o,height:h}),m=(v,C,I)=>{t[l.evaluationKey]=I;const F=l.expression.evaluate(t),k=F?F.toNonPremultipliedRenderColor(null):null;k&&(f.data[v+C+0]=Math.floor(255*k.r),f.data[v+C+1]=Math.floor(255*k.g),f.data[v+C+2]=Math.floor(255*k.b),f.data[v+C+3]=Math.floor(255*k.a))};if(l.clips)for(let v=0,C=0;v<h;++v,C+=4*o)for(let I=0,F=0;I<o;I++,F+=4){const k=I/(o-1),{start:z,end:H}=l.clips[v];m(C,F,z*(1-k)+H*k)}else for(let v=0,C=0;v<o;v++,C+=4)m(0,C,v/(o-1));return f}Zi(Jf,"AlphaImage"),Zi(Il,"RGBAImage");const nF=Rn([{name:"a_pos",components:2,type:"Int16"}],4),sF=Rn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),oF=Rn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),aF=Rn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function vm(l,t,o=2){const h=t&&t.length,f=h?t[0]*o:l.length;let m=Ew(l,0,f,o,!0);const v=[];if(!m||m.next===m.prev)return v;let C,I,F;if(h&&(m=function(k,z,H,$){const ee=[];for(let ae=0,Ae=z.length;ae<Ae;ae++){const ve=Ew(k,z[ae]*$,ae<Ae-1?z[ae+1]*$:k.length,$,!1);ve===ve.next&&(ve.steiner=!0),ee.push(pF(ve))}ee.sort(dF);for(let ae=0;ae<ee.length;ae++)H=AF(ee[ae],H);return H}(l,t,m,o)),l.length>80*o){C=1/0,I=1/0;let k=-1/0,z=-1/0;for(let H=o;H<f;H+=o){const $=l[H],ee=l[H+1];$<C&&(C=$),ee<I&&(I=ee),$>k&&(k=$),ee>z&&(z=ee)}F=Math.max(k-C,z-I),F=F!==0?32767/F:0}return _m(m,v,o,C,I,F,0),v}function Ew(l,t,o,h,f){let m;if(f===function(v,C,I,F){let k=0;for(let z=C,H=I-F;z<I;z+=F)k+=(v[H]-v[z])*(v[z+1]+v[H+1]),H=z;return k}(l,t,o,h)>0)for(let v=t;v<o;v+=h)m=Lw(v/h|0,l[v],l[v+1],m);else for(let v=o-h;v>=t;v-=h)m=Lw(v/h|0,l[v],l[v+1],m);return m&&Bg(m,m.next)&&(wm(m),m=m.next),m}function Up(l,t){if(!l)return l;t||(t=l);let o,h=l;do if(o=!1,h.steiner||!Bg(h,h.next)&&Ya(h.prev,h,h.next)!==0)h=h.next;else{if(wm(h),h=t=h.prev,h===h.next)break;o=!0}while(o||h!==t);return t}function _m(l,t,o,h,f,m,v){if(!l)return;!v&&m&&function(I,F,k,z){let H=I;do H.z===0&&(H.z=B_(H.x,H.y,F,k,z)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==I);H.prevZ.nextZ=null,H.prevZ=null,function($){let ee,ae=1;do{let Ae,ve=$;$=null;let Fe=null;for(ee=0;ve;){ee++;let Le=ve,ce=0;for(let ke=0;ke<ae&&(ce++,Le=Le.nextZ,Le);ke++);let Ee=ae;for(;ce>0||Ee>0&&Le;)ce!==0&&(Ee===0||!Le||ve.z<=Le.z)?(Ae=ve,ve=ve.nextZ,ce--):(Ae=Le,Le=Le.nextZ,Ee--),Fe?Fe.nextZ=Ae:$=Ae,Ae.prevZ=Fe,Fe=Ae;ve=Le}Fe.nextZ=null,ae*=2}while(ee>1)}(H)}(l,h,f,m);let C=l;for(;l.prev!==l.next;){const I=l.prev,F=l.next;if(m?cF(l,h,f,m):lF(l))t.push(I.i,l.i,F.i),wm(l),l=F.next,C=F.next;else if((l=F)===C){v?v===1?_m(l=uF(Up(l),t),t,o,h,f,m,2):v===2&&hF(l,t,o,h,f,m):_m(Up(l),t,o,h,f,m,1);break}}}function lF(l){const t=l.prev,o=l,h=l.next;if(Ya(t,o,h)>=0)return!1;const f=t.x,m=o.x,v=h.x,C=t.y,I=o.y,F=h.y,k=Math.min(f,m,v),z=Math.min(C,I,F),H=Math.max(f,m,v),$=Math.max(C,I,F);let ee=h.next;for(;ee!==t;){if(ee.x>=k&&ee.x<=H&&ee.y>=z&&ee.y<=$&&xm(f,C,m,I,v,F,ee.x,ee.y)&&Ya(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function cF(l,t,o,h){const f=l.prev,m=l,v=l.next;if(Ya(f,m,v)>=0)return!1;const C=f.x,I=m.x,F=v.x,k=f.y,z=m.y,H=v.y,$=Math.min(C,I,F),ee=Math.min(k,z,H),ae=Math.max(C,I,F),Ae=Math.max(k,z,H),ve=B_($,ee,t,o,h),Fe=B_(ae,Ae,t,o,h);let Le=l.prevZ,ce=l.nextZ;for(;Le&&Le.z>=ve&&ce&&ce.z<=Fe;){if(Le.x>=$&&Le.x<=ae&&Le.y>=ee&&Le.y<=Ae&&Le!==f&&Le!==v&&xm(C,k,I,z,F,H,Le.x,Le.y)&&Ya(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,ce.x>=$&&ce.x<=ae&&ce.y>=ee&&ce.y<=Ae&&ce!==f&&ce!==v&&xm(C,k,I,z,F,H,ce.x,ce.y)&&Ya(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;Le&&Le.z>=ve;){if(Le.x>=$&&Le.x<=ae&&Le.y>=ee&&Le.y<=Ae&&Le!==f&&Le!==v&&xm(C,k,I,z,F,H,Le.x,Le.y)&&Ya(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;ce&&ce.z<=Fe;){if(ce.x>=$&&ce.x<=ae&&ce.y>=ee&&ce.y<=Ae&&ce!==f&&ce!==v&&xm(C,k,I,z,F,H,ce.x,ce.y)&&Ya(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function uF(l,t){let o=l;do{const h=o.prev,f=o.next.next;!Bg(h,f)&&Iw(h,o,o.next,f)&&bm(h,f)&&bm(f,h)&&(t.push(h.i,o.i,f.i),wm(o),wm(o.next),o=l=f),o=o.next}while(o!==l);return Up(o)}function hF(l,t,o,h,f,m){let v=l;do{let C=v.next.next;for(;C!==v.prev;){if(v.i!==C.i&&gF(v,C)){let I=Fw(v,C);return v=Up(v,v.next),I=Up(I,I.next),_m(v,t,o,h,f,m,0),void _m(I,t,o,h,f,m,0)}C=C.next}v=v.next}while(v!==l)}function dF(l,t){let o=l.x-t.x;return o===0&&(o=l.y-t.y,o===0)&&(o=(l.next.y-l.y)/(l.next.x-l.x)-(t.next.y-t.y)/(t.next.x-t.x)),o}function AF(l,t){const o=function(f,m){let v=m;const C=f.x,I=f.y;let F,k=-1/0;if(Bg(f,v))return v;do{if(Bg(f,v.next))return v.next;if(I<=v.y&&I>=v.next.y&&v.next.y!==v.y){const ae=v.x+(I-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(ae<=C&&ae>k&&(k=ae,F=v.x<v.next.x?v:v.next,ae===C))return F}v=v.next}while(v!==m);if(!F)return null;const z=F,H=F.x,$=F.y;let ee=1/0;v=F;do{if(C>=v.x&&v.x>=H&&C!==v.x&&Tw(I<$?C:k,I,H,$,I<$?k:C,I,v.x,v.y)){const ae=Math.abs(I-v.y)/(C-v.x);bm(v,f)&&(ae<ee||ae===ee&&(v.x>F.x||v.x===F.x&&fF(F,v)))&&(F=v,ee=ae)}v=v.next}while(v!==z);return F}(l,t);if(!o)return t;const h=Fw(o,l);return Up(h,h.next),Up(o,o.next)}function fF(l,t){return Ya(l.prev,l,t.prev)<0&&Ya(t.next,l,l.next)<0}function B_(l,t,o,h,f){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*f|0)|l<<8))|l<<4))|l<<2))|l<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-h)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function pF(l){let t=l,o=l;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==l);return o}function Tw(l,t,o,h,f,m,v,C){return(f-v)*(t-C)>=(l-v)*(m-C)&&(l-v)*(h-C)>=(o-v)*(t-C)&&(o-v)*(m-C)>=(f-v)*(h-C)}function xm(l,t,o,h,f,m,v,C){return!(l===v&&t===C)&&Tw(l,t,o,h,f,m,v,C)}function gF(l,t){return l.next.i!==t.i&&l.prev.i!==t.i&&!function(o,h){let f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==h.i&&f.next.i!==h.i&&Iw(f,f.next,o,h))return!0;f=f.next}while(f!==o);return!1}(l,t)&&(bm(l,t)&&bm(t,l)&&function(o,h){let f=o,m=!1;const v=(o.x+h.x)/2,C=(o.y+h.y)/2;do f.y>C!=f.next.y>C&&f.next.y!==f.y&&v<(f.next.x-f.x)*(C-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==o);return m}(l,t)&&(Ya(l.prev,l,t.prev)||Ya(l,t.prev,t))||Bg(l,t)&&Ya(l.prev,l,l.next)>0&&Ya(t.prev,t,t.next)>0)}function Ya(l,t,o){return(t.y-l.y)*(o.x-t.x)-(t.x-l.x)*(o.y-t.y)}function Bg(l,t){return l.x===t.x&&l.y===t.y}function Iw(l,t,o,h){const f=o0(Ya(l,t,o)),m=o0(Ya(l,t,h)),v=o0(Ya(o,h,l)),C=o0(Ya(o,h,t));return f!==m&&v!==C||!(f!==0||!s0(l,o,t))||!(m!==0||!s0(l,h,t))||!(v!==0||!s0(o,l,h))||!(C!==0||!s0(o,t,h))}function s0(l,t,o){return t.x<=Math.max(l.x,o.x)&&t.x>=Math.min(l.x,o.x)&&t.y<=Math.max(l.y,o.y)&&t.y>=Math.min(l.y,o.y)}function o0(l){return l>0?1:l<0?-1:0}function bm(l,t){return Ya(l.prev,l,l.next)<0?Ya(l,t,l.next)>=0&&Ya(l,l.prev,t)>=0:Ya(l,t,l.prev)<0||Ya(l,l.next,t)<0}function Fw(l,t){const o=C_(l.i,l.x,l.y),h=C_(t.i,t.x,t.y),f=l.next,m=t.prev;return l.next=t,t.prev=l,o.next=f,f.prev=o,h.next=o,o.prev=h,m.next=h,h.prev=m,h}function Lw(l,t,o,h){const f=C_(l,t,o);return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function wm(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function C_(l,t,o){return{i:l,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function a0(l,t){const o=l.length;if(o<=1)return[l];const h=[];let f,m;for(let v=0;v<o;v++){const C=fs(l[v]);C!==0&&(l[v].area=Math.abs(C),m===void 0&&(m=C<0),m===C<0?(f&&h.push(f),f=[l[v]]):f.push(l[v]))}if(f&&h.push(f),t>1)for(let v=0;v<h.length;v++)h[v].length<=t||(Ko(h[v],t,1,h[v].length-1,mF),h[v]=h[v].slice(0,t));return h}function mF(l,t){return t.area-l.area}function Mw(l,t,o=1){if(!l)return null;const h=typeof l=="string"?Js.from(l).getPrimary():l.getPrimary(),f=typeof l=="string"?null:l.getSecondary();for(const m of[h,f]){if(!m)continue;const v=m.id.toString();t.has(v)||t.set(v,[]),m.scaleSelf(o),t.get(v).push(m)}return{primary:h.toString(),secondary:f?f.toString():null}}function S_(l,t,o,h){const f=h.patternDependencies;let m=!1;for(const v of t){const C=v.paint.get(`${l}-pattern`);C.isConstant()||(m=!0),Mw(C.constantOr(null),f,o)&&(m=!0)}return m}function E_(l,t,o,h,f,m){const v=m.patternDependencies;for(const C of t){const I=C.paint.get(`${l}-pattern`).value;if(I.kind!=="constant"){let F=I.evaluate({zoom:h},o,{},m.availableImages);F=F&&F.name?F.name:F;const k=Mw(F,v,f);if(!k)continue;const{primary:z,secondary:H}=k;z&&(o.patterns[C.id]=[z,H].filter(Boolean))}}return o}class Pw{constructor(){this.polygons=new Map}add(t,...o){this.polygons.has(t)?this.polygons.get(t).push(...o):this.polygons.set(t,o)}merge(t){for(const[o,h]of t.polygons)this.add(o,...h)}}class zp{constructor(){this.portals=[]}static evaluate(t){if(t.length===0)return new zp;let o=[];for(const F of t)o.push(...F.portals);if(o.length===0)return new zp;const h=(F,k)=>F<=0&&k<=0||F>=wi&&k>=wi;for(const F of o){const k=F.va,z=F.vb;(h(k.x,z.x)||h(k.y,z.y))&&(F.type="border")}const f=o.filter(F=>F.type!=="unevaluated"),m=o.filter(F=>F.type==="unevaluated");if(m.length===0)return new zp;m.sort((F,k)=>F.hash===k.hash?F.isTunnel===k.isTunnel?0:F.isTunnel?-1:1:F.hash<k.hash?1:-1),o=f.concat(m);let v=f.length,C=v,I=v;do if(C++,C===o.length||o[v].hash!==o[C].hash){if(C-v==2){I<v&&(o[I]=o[v],o[v]=null);const F=o[I],k=o[C-1];F.type=F.isTunnel!==k.isTunnel?"tunnel":"polygon",F.connection={a:F.connection.a,b:k.connection.a},I++}v=C}while(v!==o.length);return o.splice(I),o.sort((F,k)=>F.hash<k.hash?1:-1),{portals:o}}}Zi(zp,"ElevationPortalGraph"),Zi(Pw,"ElevationPolygons");class yF{constructor(t,o,h){this.outPositions=t,this.outNormals=o,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(t,o,h){let f=t[2];h!=null&&(f*=h);const m=this.getVec3Bits(t)<<96n|this.getVec3Bits(o),v=this.vertexLookup.get(m);if(v!=null)return v;const C=this.outPositions.length;this.vertexLookup.set(m,C);const I=Math.trunc(16384*o[0]),F=Math.trunc(16384*o[1]),k=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(t[0],t[1],f),this.outNormals.emplaceBack(I,F,k),C}addVertices(t,o,...h){const f=[];for(const m of h){const v=this.addVertex(m,t,o);f.push(v)}return f}addTriangles(t,o,h){if(o&&h){const f=h.length===1,m=Be(0,0,0);for(let v=0;v<t.length;v+=3){const C=o[t[v+0]],I=o[t[v+1]],F=o[t[v+2]],k=f?h[0]:h[t[v+1]],z=f?h[0]:h[t[v+2]],H=this.addVertex(Be(C.x,C.y,f?h[0]:h[t[v+0]]),m),$=this.addVertex(Be(I.x,I.y,k),m),ee=this.addVertex(Be(F.x,F.y,z),m);this.outIndices.emplaceBack(H,$,ee)}}else for(let f=0;f<t.length;f+=3)this.outIndices.emplaceBack(t[f+0],t[f+1],t[f+2])}addQuad(t,o){const h=this.addVertices(o,void 0,...t.map(I=>Be(I.coord.x,I.coord.y,I.height))),[f,m,v,C]=h;this.addTriangles([f,m,v,v,C,f])}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(t){return this.view.setFloat32(0,t),BigInt(this.view.getUint32(0))}getVec3Bits(t){return this.getBits(t[0])<<64n|this.getBits(t[1])<<32n|this.getBits(t[2])}}class th{constructor(t,o,h,f){this.unevaluatedPortals=new zp,this.portalPolygons=new Pw,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Tp,this.vertexNormals=new zf,this.indexArray=new Zo,this.tileToMeters=Vt(t),this.bridgeProgramConfigurations=new p(o,{zoom:h,lut:f},m=>m!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new p(o,{zoom:h,lut:f},m=>m!=="fill-bridge-guard-rail-color")}addVertices(t,o){const h=this.unevalVertices.length;for(let f=0;f<t.length;f++)this.unevalVertices.push(t[f]),this.unevalHeights.push(o[f]);return h}addTriangles(t,o,h){const f=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const m of t)f.push(m+o)}addRenderableRing(t,o,h,f,m,v){const C=[new qt(m.min.x,m.min.y),new qt(m.max.x,m.min.y),new qt(m.max.x,m.max.y),new qt(m.min.x,m.max.y)];for(let I=0;I<h-1;I++){const F=o+I,k=F+1,z=this.unevalVertices[F],H=this.unevalVertices[k];if(!(z.x>=m.min.x&&z.x<=m.max.x&&z.y>=m.min.y&&z.y<=m.max.y||H.x>=m.min.x&&H.x<=m.max.x&&H.y>=m.min.y&&H.y<=m.max.y||Ln(z,H,C))||this.isOnBorder(z.x,H.x)||this.isOnBorder(z.y,H.y))continue;const $=th.computeEdgeHash(this.unevalVertices[F],this.unevalVertices[k]);let ee,ae=this.vertexHashLookup.get(th.computePosHash(z));ae!=null?ee=ae.next:(ae=this.vertexHashLookup.get(th.computePosHash(H)),ee=ae!=null?ae.prev:$),this.unevalEdges.push({polygonIdx:t,a:F,b:k,hash:$,portalHash:ee,isTunnel:f,type:"unevaluated",featureInfo:v})}}addPortalCandidates(t,o,h,f,m){if(o.length===0)return;this.portalPolygons.add(t,{geometry:o,zLevel:m});const v=o[0];this.vertexHashLookup.clear();let C=th.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let I=0;I<v.length-1;I++){const F=v[I+0],k=v[I+1],z=Vi(k.x-F.x,k.y-F.y),H=Zr(z);if(H===0)continue;let $="unevaluated";const ee=f.pointElevation(F),ae=f.pointElevation(k);Math.abs(ee)<.01&&Math.abs(ae)<.01?$="entrance":(this.isOnBorder(F.x,k.x)||this.isOnBorder(F.y,k.y))&&($="border");const Ae=th.computeEdgeHash(F,k);this.unevaluatedPortals.portals.push({connection:{a:t,b:void 0},va:F,vb:k,vab:z,length:H,hash:Ae,isTunnel:h,type:$});const ve=th.computePosHash(F);this.vertexHashLookup.set(ve,{prev:C,next:Ae}),C=Ae}}construct(t){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=H=>{H.primitiveLength=this.indexArray.length-H.primitiveOffset},f=new yF(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(t.portals,this.unevalEdges);const m=o(),v=o(),C=o(),I=(H,$)=>{H.sort((ae,Ae)=>ae.type===$&&Ae.type!==$?-1:ae.type!==$&&Ae.type===$?1:0);const ee=H.findIndex(ae=>ae.type!==$);return ee>=0?ee:H.length};let F=0;this.unevalEdges.length>0&&(F=I(this.unevalEdges,"none"),this.constructBridgeStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:F},this.tileToMeters)),h(C);const k=o(),z=o();if(this.unevalEdges.length>0){const H=this.unevalEdges.splice(F),$=I(H,"tunnel")+F;this.unevalEdges.push(...H),this.constructTunnelStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:F},{min:F,max:$})}h(k),f.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(z),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(v),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(m),this.maskSegments=Vs.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=Vs.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableBridgeSegments=Vs.simpleSegment(0,C.primitiveOffset,0,C.primitiveLength),this.renderableTunnelSegments=Vs.simpleSegment(0,k.primitiveOffset,0,k.primitiveLength),this.shadowCasterSegments=Vs.simpleSegment(0,m.primitiveOffset,0,m.primitiveLength)}update(t,o,h,f,m,v,C,I){this.bridgeProgramConfigurations.updatePaintArrays(t,o,m,h,f,v,C,I),this.tunnelProgramConfigurations.updatePaintArrays(t,o,m,h,f,v,C,I)}upload(t){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=t.createVertexBuffer(this.vertexPositions,oF.members),this.vertexBufferNormal=t.createVertexBuffer(this.vertexNormals,aF.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(t),this.tunnelProgramConfigurations.upload(t))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(t,o,h,f,m){const v=(C,I)=>{for(let F=0;F<I.length-1;F++){const k=I[F].featureIndex,z=I[F+1].vertexStart,H=t.feature(k);C.populatePaintArrays(z,H,k,{},h,o,f,void 0,m)}};v(this.bridgeProgramConfigurations,this.bridgeFeatureSections),v(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(t,o,h,f,m){const v=new Map;for(let C=f;C<m;C++){const I=h[C],F=I.a,k=I.b,z=th.computePosHash(t[F]),H=th.computePosHash(t[k]);v.has(z)||v.set(z,{}),v.has(H)||v.set(H,{});const $=v.get(z),ee=v.get(H);o[F]<=0&&o[k]<=0||($.to=k,ee.from=F)}return v}constructBridgeStructures(t,o,h,f,m,v){t.clearVertexLookup();const C=this.computeVertexConnections(o,h,f,m.min,m.max),I=1/v,F=.5*I,k=$=>Be(o[$].x,o[$].y,h[$]*I),z=$=>{const ee=C.get(th.computePosHash(o[$])),ae=ee.from,Ae=ee.to;if(!ae||!Ae)return;const ve=k(ae),Fe=k($),Le=k(Ae),ce=Be(0,0,0);if(!qe(ve,Fe)){const ke=Ke(oe(),Fe,ve);Pe(ce,ce,mt(ke,ke))}if(!qe(Le,Fe)){const ke=Ke(oe(),Le,Fe);Pe(ce,ce,mt(ke,ke))}const Ee=It(ce);return Ee>0?pt(ce,ce,1/Ee):void 0};let H=Number.POSITIVE_INFINITY;this.sortSubarray(f,m.min,m.max,($,ee)=>$.featureInfo.featureIndex-ee.featureInfo.featureIndex);for(let $=m.min;$<m.max;$++){const ee=f[$];if(!ee.featureInfo.guardRailEnabled)continue;const ae=this.prepareEdgePoints(o,h,ee,($r,or)=>$r>or);if(ae==null)continue;const Ae=ae[0],ve=ae[1],Fe=Be(Ae.coord.x,Ae.coord.y,I*Ae.height),Le=Be(ve.coord.x,ve.coord.y,I*ve.height);if(qe(Fe,Le))continue;const ce=Ke(oe(),Le,Fe);mt(ce,ce);const Ee=$r=>mt($r,$r),ke=z(ee.a)||ce,He=z(ee.b)||ce,gt=Ee(Be(ke[1],-ke[0],0)),ht=Ee(Be(He[1],-He[0],0)),yt=Ee(rt(oe(),gt,ke)),Lt=Ee(rt(oe(),ht,He)),Wt=oe(),Si=[Pe(oe(),Fe,pt(Wt,Ke(Wt,gt,yt),F)),Pe(oe(),Fe,pt(Wt,Pe(Wt,gt,yt),F)),Pe(oe(),Fe,pt(Wt,yt,F)),Fe],fi=[Pe(oe(),Le,pt(Wt,Ke(Wt,ht,Lt),F)),Pe(oe(),Le,pt(Wt,Pe(Wt,ht,Lt),F)),Pe(oe(),Le,pt(Wt,Lt,F)),Le];H=this.addFeatureSection(ee.featureInfo.featureIndex,H,this.bridgeFeatureSections,t);const[Ci,Ii]=t.addVertices(gt,v,Si[0],Si[1]),[$t,_i]=t.addVertices(ht,v,fi[0],fi[1]);t.addTriangles([Ci,Ii,$t,Ii,_i,$t]);const[Gt,Yt]=t.addVertices(yt,v,Si[1],Si[2]),[ki,Di]=t.addVertices(Lt,v,fi[1],fi[2]);t.addTriangles([Gt,Yt,ki,Yt,Di,ki]);const[xr,cr]=t.addVertices(ut(gt,gt),v,Si[2],Si[3]),[Xi,Pi]=t.addVertices(ut(ht,ht),v,fi[2],fi[3]);t.addTriangles([xr,cr,Xi,cr,Pi,Xi])}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}constructTunnelStructures(t,o,h,f,m,v){t.clearVertexLookup();let C=Number.POSITIVE_INFINITY;const I=(k,z)=>k.featureInfo.featureIndex-z.featureInfo.featureIndex;this.sortSubarray(f,m.min,m.max,I),this.sortSubarray(f,v.min,v.max,I);const F=k=>mt(k,k);for(let k=m.min;k<m.max;k++){const z=this.prepareEdgePoints(o,h,f[k],(ae,Ae)=>ae<Ae);if(z==null)continue;const[H,$]=z,ee=F(Be(-($.coord.y-H.coord.y),$.coord.x-H.coord.x,0));C=this.addFeatureSection(f[k].featureInfo.featureIndex,C,this.tunnelFeatureSections,t),t.addQuad([H,$,{coord:$.coord,height:f[k].isTunnel?-.1:0},{coord:H.coord,height:f[k].isTunnel?-.1:0}],ee)}for(let k=v.min;k<v.max;k++){const z=f[k];z.isTunnel&&([z.a,z.b]=[z.b,z.a]);const H=o[z.a],$=o[z.b],ee=F(Be(-($.y-H.y),$.x-H.x,0));C=this.addFeatureSection(z.featureInfo.featureIndex,C,this.tunnelFeatureSections,t),t.addQuad([{coord:$,height:0},{coord:H,height:0},{coord:H,height:h[z.a]+4},{coord:$,height:h[z.b]+4}],ee),t.addQuad([{coord:H,height:0},{coord:$,height:0},{coord:$,height:h[z.b]+4},{coord:H,height:h[z.a]+4}],ee)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}prepareEdgePoints(t,o,h,f){let m=o[h.a],v=o[h.b];const C=f(m,0),I=f(v,0);if(C&&I)return[{coord:t[h.a],height:m},{coord:t[h.b],height:v}];if(!C&&!I)return;const F=t[h.a].clone(),k=t[h.b].clone();if(C){if(!I){const z=v/(v-m);k.x=Er(k.x,F.x,z),k.y=Er(k.y,F.y,z),v=Er(v,m,z)}}else{const z=m/(m-v);F.x=Er(F.x,k.x,z),F.y=Er(F.y,k.y,z),m=Er(m,v,z)}return[{coord:F,height:m},{coord:k,height:v}]}prepareEdges(t,o){if(o.length===0)return;o.sort((C,I)=>C.hash===I.hash?I.polygonIdx-C.polygonIdx:I.hash>C.hash?1:-1);let h=0,f=0,m=0,v=o[h].polygonIdx;do f++,(f===o.length||o[h].hash!==o[f].hash)&&((f-h==1||o[f-1].polygonIdx!==v)&&(m<h&&(o[m]=o[h],o[h]=null),o[m].type="none",m++),h=f,h!==o.length&&(v=o[h].polygonIdx));while(h!==o.length);if(o.splice(m),o.length!==0&&t.length!==0){o.sort((F,k)=>F.portalHash<k.portalHash?1:-1);let C=0,I=0;for(;C!==o.length&&I!==t.length;){const F=o[C],k=t[I];F.portalHash>k.hash?C++:k.hash>F.portalHash?I++:(F.type=k.type,C++)}}}isOnBorder(t,o){return t<=0&&o<=0||t>=wi&&o>=wi}addFeatureSection(t,o,h,f){return t!==o&&(o=t,h.push({featureIndex:t,vertexStart:f.getVertexCount()}),f.clearVertexLookup()),o}sortSubarray(t,o,h,f){const m=t.slice(o,h);m.sort(f),t.splice(o,m.length,...m)}static computeEdgeHash(t,o){return(t.y===o.y&&t.x>o.x||t.y>o.y)&&([t,o]=[o,t]),BigInt(th.computePosHash(t))<<32n|BigInt(th.computePosHash(o))}static computePosHash(t){return((65535&t.x)<<16|65535&t.y)>>>0}}var kw,Rw={exports:{}},Dw=(kw||(kw=1,function(l,t){(function(o){function h(ze,Ve){return ze>Ve?1:ze<Ve?-1:0}var f=function(ze,Ve){ze===void 0&&(ze=h),Ve===void 0&&(Ve=!1),this._compare=ze,this._root=null,this._size=0,this._noDuplicates=!!Ve},m={size:{configurable:!0}};function v(ze,Ve,Jt,zi,Yi){var Wi=Yi-zi;if(Wi>0){var sr=zi+Math.floor(Wi/2),Or={key:Ve[sr],data:Jt[sr],parent:ze};return Or.left=v(Or,Ve,Jt,zi,sr),Or.right=v(Or,Ve,Jt,sr+1,Yi),Or}return null}function C(ze,Ve,Jt,zi,Yi){if(!(Jt>=zi)){for(var Wi=ze[Jt+zi>>1],sr=Jt-1,Or=zi+1;;){do sr++;while(Yi(ze[sr],Wi)<0);do Or--;while(Yi(ze[Or],Wi)>0);if(sr>=Or)break;var wn=ze[sr];ze[sr]=ze[Or],ze[Or]=wn,wn=Ve[sr],Ve[sr]=Ve[Or],Ve[Or]=wn}C(ze,Ve,Jt,Or,Yi),C(ze,Ve,Or+1,zi,Yi)}}f.prototype.rotateLeft=function(ze){var Ve=ze.right;Ve&&(ze.right=Ve.left,Ve.left&&(Ve.left.parent=ze),Ve.parent=ze.parent),ze.parent?ze===ze.parent.left?ze.parent.left=Ve:ze.parent.right=Ve:this._root=Ve,Ve&&(Ve.left=ze),ze.parent=Ve},f.prototype.rotateRight=function(ze){var Ve=ze.left;Ve&&(ze.left=Ve.right,Ve.right&&(Ve.right.parent=ze),Ve.parent=ze.parent),ze.parent?ze===ze.parent.left?ze.parent.left=Ve:ze.parent.right=Ve:this._root=Ve,Ve&&(Ve.right=ze),ze.parent=Ve},f.prototype._splay=function(ze){for(;ze.parent;){var Ve=ze.parent;Ve.parent?Ve.left===ze&&Ve.parent.left===Ve?(this.rotateRight(Ve.parent),this.rotateRight(Ve)):Ve.right===ze&&Ve.parent.right===Ve?(this.rotateLeft(Ve.parent),this.rotateLeft(Ve)):Ve.left===ze&&Ve.parent.right===Ve?(this.rotateRight(Ve),this.rotateLeft(Ve)):(this.rotateLeft(Ve),this.rotateRight(Ve)):Ve.left===ze?this.rotateRight(Ve):this.rotateLeft(Ve)}},f.prototype.splay=function(ze){for(var Ve,Jt,zi,Yi,Wi;ze.parent;)(Jt=(Ve=ze.parent).parent)&&Jt.parent?((zi=Jt.parent).left===Jt?zi.left=ze:zi.right=ze,ze.parent=zi):(ze.parent=null,this._root=ze),Yi=ze.left,Wi=ze.right,ze===Ve.left?(Jt&&(Jt.left===Ve?(Ve.right?(Jt.left=Ve.right,Jt.left.parent=Jt):Jt.left=null,Ve.right=Jt,Jt.parent=Ve):(Yi?(Jt.right=Yi,Yi.parent=Jt):Jt.right=null,ze.left=Jt,Jt.parent=ze)),Wi?(Ve.left=Wi,Wi.parent=Ve):Ve.left=null,ze.right=Ve,Ve.parent=ze):(Jt&&(Jt.right===Ve?(Ve.left?(Jt.right=Ve.left,Jt.right.parent=Jt):Jt.right=null,Ve.left=Jt,Jt.parent=Ve):(Wi?(Jt.left=Wi,Wi.parent=Jt):Jt.left=null,ze.right=Jt,Jt.parent=ze)),Yi?(Ve.right=Yi,Yi.parent=Ve):Ve.right=null,ze.left=Ve,Ve.parent=ze)},f.prototype.replace=function(ze,Ve){ze.parent?ze===ze.parent.left?ze.parent.left=Ve:ze.parent.right=Ve:this._root=Ve,Ve&&(Ve.parent=ze.parent)},f.prototype.minNode=function(ze){if(ze===void 0&&(ze=this._root),ze)for(;ze.left;)ze=ze.left;return ze},f.prototype.maxNode=function(ze){if(ze===void 0&&(ze=this._root),ze)for(;ze.right;)ze=ze.right;return ze},f.prototype.insert=function(ze,Ve){var Jt=this._root,zi=null,Yi=this._compare;if(this._noDuplicates)for(;Jt;){if(zi=Jt,Yi(Jt.key,ze)===0)return;Jt=Yi(Jt.key,ze)<0?Jt.right:Jt.left}else for(;Jt;)zi=Jt,Jt=Yi(Jt.key,ze)<0?Jt.right:Jt.left;return Jt={key:ze,data:Ve,left:null,right:null,parent:zi},zi?Yi(zi.key,Jt.key)<0?zi.right=Jt:zi.left=Jt:this._root=Jt,this.splay(Jt),this._size++,Jt},f.prototype.find=function(ze){for(var Ve=this._root,Jt=this._compare;Ve;){var zi=Jt(Ve.key,ze);if(zi<0)Ve=Ve.right;else{if(!(zi>0))return Ve;Ve=Ve.left}}return null},f.prototype.contains=function(ze){for(var Ve=this._root,Jt=this._compare;Ve;){var zi=Jt(ze,Ve.key);if(zi===0)return!0;Ve=zi<0?Ve.left:Ve.right}return!1},f.prototype.remove=function(ze){var Ve=this.find(ze);if(!Ve)return!1;if(this.splay(Ve),Ve.left)if(Ve.right){var Jt=this.minNode(Ve.right);Jt.parent!==Ve&&(this.replace(Jt,Jt.right),Jt.right=Ve.right,Jt.right.parent=Jt),this.replace(Ve,Jt),Jt.left=Ve.left,Jt.left.parent=Jt}else this.replace(Ve,Ve.left);else this.replace(Ve,Ve.right);return this._size--,!0},f.prototype.removeNode=function(ze){if(!ze)return!1;if(this.splay(ze),ze.left)if(ze.right){var Ve=this.minNode(ze.right);Ve.parent!==ze&&(this.replace(Ve,Ve.right),Ve.right=ze.right,Ve.right.parent=Ve),this.replace(ze,Ve),Ve.left=ze.left,Ve.left.parent=Ve}else this.replace(ze,ze.left);else this.replace(ze,ze.right);return this._size--,!0},f.prototype.erase=function(ze){var Ve=this.find(ze);if(Ve){this.splay(Ve);var Jt=Ve.left,zi=Ve.right,Yi=null;Jt&&(Jt.parent=null,Yi=this.maxNode(Jt),this.splay(Yi),this._root=Yi),zi&&(Jt?Yi.right=zi:this._root=zi,zi.parent=Yi),this._size--}},f.prototype.pop=function(){var ze=this._root,Ve=null;if(ze){for(;ze.left;)ze=ze.left;Ve={key:ze.key,data:ze.data},this.remove(ze.key)}return Ve},f.prototype.next=function(ze){var Ve=ze;if(Ve)if(Ve.right)for(Ve=Ve.right;Ve&&Ve.left;)Ve=Ve.left;else for(Ve=ze.parent;Ve&&Ve.right===ze;)ze=Ve,Ve=Ve.parent;return Ve},f.prototype.prev=function(ze){var Ve=ze;if(Ve)if(Ve.left)for(Ve=Ve.left;Ve&&Ve.right;)Ve=Ve.right;else for(Ve=ze.parent;Ve&&Ve.left===ze;)ze=Ve,Ve=Ve.parent;return Ve},f.prototype.forEach=function(ze){for(var Ve=this._root,Jt=[],zi=!1,Yi=0;!zi;)Ve?(Jt.push(Ve),Ve=Ve.left):Jt.length>0?(ze(Ve=Jt.pop(),Yi++),Ve=Ve.right):zi=!0;return this},f.prototype.range=function(ze,Ve,Jt,zi){for(var Yi=[],Wi=this._compare,sr=this._root;Yi.length!==0||sr;)if(sr)Yi.push(sr),sr=sr.left;else{if(Wi((sr=Yi.pop()).key,Ve)>0)break;if(Wi(sr.key,ze)>=0&&Jt.call(zi,sr))return this;sr=sr.right}return this},f.prototype.keys=function(){for(var ze=this._root,Ve=[],Jt=[],zi=!1;!zi;)ze?(Ve.push(ze),ze=ze.left):Ve.length>0?(ze=Ve.pop(),Jt.push(ze.key),ze=ze.right):zi=!0;return Jt},f.prototype.values=function(){for(var ze=this._root,Ve=[],Jt=[],zi=!1;!zi;)ze?(Ve.push(ze),ze=ze.left):Ve.length>0?(ze=Ve.pop(),Jt.push(ze.data),ze=ze.right):zi=!0;return Jt},f.prototype.at=function(ze){for(var Ve=this._root,Jt=[],zi=!1,Yi=0;!zi;)if(Ve)Jt.push(Ve),Ve=Ve.left;else if(Jt.length>0){if(Ve=Jt.pop(),Yi===ze)return Ve;Yi++,Ve=Ve.right}else zi=!0;return null},f.prototype.load=function(ze,Ve,Jt){if(ze===void 0&&(ze=[]),Ve===void 0&&(Ve=[]),Jt===void 0&&(Jt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var zi=ze.length;return Jt&&C(ze,Ve,0,zi-1,this._compare),this._root=v(null,ze,Ve,0,zi),this._size=zi,this},f.prototype.min=function(){var ze=this.minNode(this._root);return ze?ze.key:null},f.prototype.max=function(){var ze=this.maxNode(this._root);return ze?ze.key:null},f.prototype.isEmpty=function(){return this._root===null},m.size.get=function(){return this._size},f.createTree=function(ze,Ve,Jt,zi,Yi){return new f(Jt,Yi).load(ze,Ve,zi)},Object.defineProperties(f.prototype,m);var I=0,F=1,k=2,z=3,H=0,$=1,ee=2,ae=3;function Ae(ze,Ve,Jt){Ve===null?(ze.inOut=!1,ze.otherInOut=!0):(ze.isSubject===Ve.isSubject?(ze.inOut=!Ve.inOut,ze.otherInOut=Ve.otherInOut):(ze.inOut=!Ve.otherInOut,ze.otherInOut=Ve.isVertical()?!Ve.inOut:Ve.inOut),Ve&&(ze.prevInResult=!ve(Ve,Jt)||Ve.isVertical()?Ve.prevInResult:Ve));var zi=ve(ze,Jt);ze.resultTransition=zi?function(Yi,Wi){var sr,Or=!Yi.inOut,wn=!Yi.otherInOut;switch(Wi){case H:sr=Or&&wn;break;case $:sr=Or||wn;break;case ae:sr=Or^wn;break;case ee:sr=Yi.isSubject?Or&&!wn:wn&&!Or}return sr?1:-1}(ze,Jt):0}function ve(ze,Ve){switch(ze.type){case I:switch(Ve){case H:return!ze.otherInOut;case $:return ze.otherInOut;case ee:return ze.isSubject&&ze.otherInOut||!ze.isSubject&&!ze.otherInOut;case ae:return!0}break;case k:return Ve===H||Ve===$;case z:return Ve===ee;case F:return!1}return!1}var Fe=function(ze,Ve,Jt,zi,Yi){this.left=Ve,this.point=ze,this.otherEvent=Jt,this.isSubject=zi,this.type=Yi||I,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Le={inResult:{configurable:!0}};function ce(ze,Ve){return ze[0]===Ve[0]&&ze[1]===Ve[1]}Fe.prototype.isBelow=function(ze){var Ve=this.point,Jt=this.otherEvent.point;return this.left?(Ve[0]-ze[0])*(Jt[1]-ze[1])-(Jt[0]-ze[0])*(Ve[1]-ze[1])>0:(Jt[0]-ze[0])*(Ve[1]-ze[1])-(Ve[0]-ze[0])*(Jt[1]-ze[1])>0},Fe.prototype.isAbove=function(ze){return!this.isBelow(ze)},Fe.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Le.inResult.get=function(){return this.resultTransition!==0},Fe.prototype.clone=function(){var ze=new Fe(this.point,this.left,this.otherEvent,this.isSubject,this.type);return ze.contourId=this.contourId,ze.resultTransition=this.resultTransition,ze.prevInResult=this.prevInResult,ze.isExteriorRing=this.isExteriorRing,ze.inOut=this.inOut,ze.otherInOut=this.otherInOut,ze},Object.defineProperties(Fe.prototype,Le);var Ee=11102230246251565e-32,ke=134217729,He=(3+8*Ee)*Ee;function gt(ze,Ve,Jt,zi,Yi){var Wi,sr,Or,wn,Bn=Ve[0],hn=zi[0],ls=0,Rs=0;hn>Bn==hn>-Bn?(Wi=Bn,Bn=Ve[++ls]):(Wi=hn,hn=zi[++Rs]);var Cn=0;if(ls<ze&&Rs<Jt)for(hn>Bn==hn>-Bn?(Or=Wi-((sr=Bn+Wi)-Bn),Bn=Ve[++ls]):(Or=Wi-((sr=hn+Wi)-hn),hn=zi[++Rs]),Wi=sr,Or!==0&&(Yi[Cn++]=Or);ls<ze&&Rs<Jt;)hn>Bn==hn>-Bn?(Or=Wi-((sr=Wi+Bn)-(wn=sr-Wi))+(Bn-wn),Bn=Ve[++ls]):(Or=Wi-((sr=Wi+hn)-(wn=sr-Wi))+(hn-wn),hn=zi[++Rs]),Wi=sr,Or!==0&&(Yi[Cn++]=Or);for(;ls<ze;)Or=Wi-((sr=Wi+Bn)-(wn=sr-Wi))+(Bn-wn),Bn=Ve[++ls],Wi=sr,Or!==0&&(Yi[Cn++]=Or);for(;Rs<Jt;)Or=Wi-((sr=Wi+hn)-(wn=sr-Wi))+(hn-wn),hn=zi[++Rs],Wi=sr,Or!==0&&(Yi[Cn++]=Or);return Wi===0&&Cn!==0||(Yi[Cn++]=Wi),Cn}function ht(ze){return new Float64Array(ze)}var yt=33306690738754716e-32,Lt=22204460492503146e-32,Wt=11093356479670487e-47,Si=ht(4),fi=ht(8),Ci=ht(12),Ii=ht(16),$t=ht(4);function _i(ze,Ve,Jt){var zi=function(Yi,Wi,sr,Or,wn,Bn){var hn=(Wi-Bn)*(sr-wn),ls=(Yi-wn)*(Or-Bn),Rs=hn-ls;if(hn===0||ls===0||hn>0!=ls>0)return Rs;var Cn=Math.abs(hn+ls);return Math.abs(Rs)>=yt*Cn?Rs:-function(so,Ns,ss,wo,Gs,Ds,js){var ds,fn,ms,oo,kr,On,Ws,go,Ys,va,ws,ua,Jc,Fl,ul,eu,kA,_a,Pa=so-Gs,Ll=ss-Gs,dc=Ns-Ds,Vl=wo-Ds;Si[0]=(ul=(go=Pa-(Ws=(On=ke*Pa)-(On-Pa)))*(va=Vl-(Ys=(On=ke*Vl)-(On-Vl)))-((Fl=Pa*Vl)-Ws*Ys-go*Ys-Ws*va))-((ws=ul-(kA=(go=dc-(Ws=(On=ke*dc)-(On-dc)))*(va=Ll-(Ys=(On=ke*Ll)-(On-Ll)))-((eu=dc*Ll)-Ws*Ys-go*Ys-Ws*va)))+(kr=ul-ws))+(kr-kA),Si[1]=(Jc=Fl-((ua=Fl+ws)-(kr=ua-Fl))+(ws-kr))-((ws=Jc-eu)+(kr=Jc-ws))+(kr-eu),Si[2]=ua-((_a=ua+ws)-(kr=_a-ua))+(ws-kr),Si[3]=_a;var sp=function(j6,GC){for(var WC=GC[0],Mx=1;Mx<4;Mx++)WC+=GC[Mx];return WC}(0,Si),$m=Lt*js;if(sp>=$m||-sp>=$m||(ds=so-(Pa+(kr=so-Pa))+(kr-Gs),ms=ss-(Ll+(kr=ss-Ll))+(kr-Gs),fn=Ns-(dc+(kr=Ns-dc))+(kr-Ds),oo=wo-(Vl+(kr=wo-Vl))+(kr-Ds),ds===0&&fn===0&&ms===0&&oo===0)||($m=Wt*js+He*Math.abs(sp),(sp+=Pa*oo+Vl*ds-(dc*ms+Ll*fn))>=$m||-sp>=$m))return sp;$t[0]=(ul=(go=ds-(Ws=(On=ke*ds)-(On-ds)))*(va=Vl-(Ys=(On=ke*Vl)-(On-Vl)))-((Fl=ds*Vl)-Ws*Ys-go*Ys-Ws*va))-((ws=ul-(kA=(go=fn-(Ws=(On=ke*fn)-(On-fn)))*(va=Ll-(Ys=(On=ke*Ll)-(On-Ll)))-((eu=fn*Ll)-Ws*Ys-go*Ys-Ws*va)))+(kr=ul-ws))+(kr-kA),$t[1]=(Jc=Fl-((ua=Fl+ws)-(kr=ua-Fl))+(ws-kr))-((ws=Jc-eu)+(kr=Jc-ws))+(kr-eu),$t[2]=ua-((_a=ua+ws)-(kr=_a-ua))+(ws-kr),$t[3]=_a;var o3=gt(4,Si,4,$t,fi);$t[0]=(ul=(go=Pa-(Ws=(On=ke*Pa)-(On-Pa)))*(va=oo-(Ys=(On=ke*oo)-(On-oo)))-((Fl=Pa*oo)-Ws*Ys-go*Ys-Ws*va))-((ws=ul-(kA=(go=dc-(Ws=(On=ke*dc)-(On-dc)))*(va=ms-(Ys=(On=ke*ms)-(On-ms)))-((eu=dc*ms)-Ws*Ys-go*Ys-Ws*va)))+(kr=ul-ws))+(kr-kA),$t[1]=(Jc=Fl-((ua=Fl+ws)-(kr=ua-Fl))+(ws-kr))-((ws=Jc-eu)+(kr=Jc-ws))+(kr-eu),$t[2]=ua-((_a=ua+ws)-(kr=_a-ua))+(ws-kr),$t[3]=_a;var a3=gt(o3,fi,4,$t,Ci);$t[0]=(ul=(go=ds-(Ws=(On=ke*ds)-(On-ds)))*(va=oo-(Ys=(On=ke*oo)-(On-oo)))-((Fl=ds*oo)-Ws*Ys-go*Ys-Ws*va))-((ws=ul-(kA=(go=fn-(Ws=(On=ke*fn)-(On-fn)))*(va=ms-(Ys=(On=ke*ms)-(On-ms)))-((eu=fn*ms)-Ws*Ys-go*Ys-Ws*va)))+(kr=ul-ws))+(kr-kA),$t[1]=(Jc=Fl-((ua=Fl+ws)-(kr=ua-Fl))+(ws-kr))-((ws=Jc-eu)+(kr=Jc-ws))+(kr-eu),$t[2]=ua-((_a=ua+ws)-(kr=_a-ua))+(ws-kr),$t[3]=_a;var l3=gt(a3,Ci,4,$t,Ii);return Ii[l3-1]}(Yi,Wi,sr,Or,wn,Bn,Cn)}(ze[0],ze[1],Ve[0],Ve[1],Jt[0],Jt[1]);return zi>0?-1:zi<0?1:0}function Gt(ze,Ve){var Jt=ze.point,zi=Ve.point;return Jt[0]>zi[0]?1:Jt[0]<zi[0]?-1:Jt[1]!==zi[1]?Jt[1]>zi[1]?1:-1:function(Yi,Wi,sr,Or){return Yi.left!==Wi.left?Yi.left?1:-1:_i(sr,Yi.otherEvent.point,Wi.otherEvent.point)!==0?Yi.isBelow(Wi.otherEvent.point)?-1:1:!Yi.isSubject&&Wi.isSubject?1:-1}(ze,Ve,Jt)}function Yt(ze,Ve,Jt){var zi=new Fe(Ve,!1,ze,ze.isSubject),Yi=new Fe(Ve,!0,ze.otherEvent,ze.isSubject);return ce(ze.point,ze.otherEvent.point)&&console.warn("what is that, a collapsed segment?",ze),zi.contourId=Yi.contourId=ze.contourId,Gt(Yi,ze.otherEvent)>0&&(ze.otherEvent.left=!0,Yi.left=!1),ze.otherEvent.otherEvent=Yi,ze.otherEvent=zi,Jt.push(Yi),Jt.push(zi),Jt}function ki(ze,Ve){return ze[0]*Ve[1]-ze[1]*Ve[0]}function Di(ze,Ve){return ze[0]*Ve[0]+ze[1]*Ve[1]}function xr(ze,Ve,Jt){var zi=function(wn,Bn,hn,ls,Rs){var Cn=[Bn[0]-wn[0],Bn[1]-wn[1]],so=[ls[0]-hn[0],ls[1]-hn[1]];function Ns(On,Ws,go){return[On[0]+Ws*go[0],On[1]+Ws*go[1]]}var ss=[hn[0]-wn[0],hn[1]-wn[1]],wo=ki(Cn,so),Gs=wo*wo,Ds=Di(Cn,Cn);if(Gs>0){var js=ki(ss,so)/wo;if(js<0||js>1)return null;var ds=ki(ss,Cn)/wo;return ds<0||ds>1?null:js===0||js===1?[Ns(wn,js,Cn)]:ds===0||ds===1?[Ns(hn,ds,so)]:[Ns(wn,js,Cn)]}if((Gs=(wo=ki(ss,Cn))*wo)>0)return null;var fn=Di(Cn,ss)/Ds,ms=fn+Di(Cn,so)/Ds,oo=Math.min(fn,ms),kr=Math.max(fn,ms);return oo<=1&&kr>=0?oo===1?[Ns(wn,oo>0?oo:0,Cn)]:kr===0?[Ns(wn,kr<1?kr:1,Cn)]:[Ns(wn,oo>0?oo:0,Cn),Ns(wn,kr<1?kr:1,Cn)]:null}(ze.point,ze.otherEvent.point,Ve.point,Ve.otherEvent.point),Yi=zi?zi.length:0;if(Yi===0||Yi===1&&(ce(ze.point,Ve.point)||ce(ze.otherEvent.point,Ve.otherEvent.point))||Yi===2&&ze.isSubject===Ve.isSubject)return 0;if(Yi===1)return ce(ze.point,zi[0])||ce(ze.otherEvent.point,zi[0])||Yt(ze,zi[0],Jt),ce(Ve.point,zi[0])||ce(Ve.otherEvent.point,zi[0])||Yt(Ve,zi[0],Jt),1;var Wi=[],sr=!1,Or=!1;return ce(ze.point,Ve.point)?sr=!0:Gt(ze,Ve)===1?Wi.push(Ve,ze):Wi.push(ze,Ve),ce(ze.otherEvent.point,Ve.otherEvent.point)?Or=!0:Gt(ze.otherEvent,Ve.otherEvent)===1?Wi.push(Ve.otherEvent,ze.otherEvent):Wi.push(ze.otherEvent,Ve.otherEvent),sr&&Or||sr?(Ve.type=F,ze.type=Ve.inOut===ze.inOut?k:z,sr&&!Or&&Yt(Wi[1].otherEvent,Wi[0].point,Jt),2):Or?(Yt(Wi[0],Wi[1].point,Jt),3):Wi[0]!==Wi[3].otherEvent?(Yt(Wi[0],Wi[1].point,Jt),Yt(Wi[1],Wi[2].point,Jt),3):(Yt(Wi[0],Wi[1].point,Jt),Yt(Wi[3].otherEvent,Wi[2].point,Jt),3)}function cr(ze,Ve){if(ze===Ve)return 0;if(_i(ze.point,ze.otherEvent.point,Ve.point)!==0||_i(ze.point,ze.otherEvent.point,Ve.otherEvent.point)!==0)return ce(ze.point,Ve.point)?ze.isBelow(Ve.otherEvent.point)?-1:1:ze.point[0]===Ve.point[0]?ze.point[1]<Ve.point[1]?-1:1:Gt(ze,Ve)===1?Ve.isAbove(ze.point)?-1:1:ze.isBelow(Ve.point)?-1:1;if(ze.isSubject!==Ve.isSubject)return ze.isSubject?-1:1;var Jt=ze.point,zi=Ve.point;return Jt[0]===zi[0]&&Jt[1]===zi[1]?(Jt=ze.otherEvent.point)[0]===(zi=Ve.otherEvent.point)[0]&&Jt[1]===zi[1]?0:ze.contourId>Ve.contourId?1:-1:Gt(ze,Ve)===1?1:-1}var Xi=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Pi(ze,Ve,Jt,zi){var Yi,Wi=ze+1,sr=Ve[ze].point,Or=Ve.length;for(Wi<Or&&(Yi=Ve[Wi].point);Wi<Or&&Yi[0]===sr[0]&&Yi[1]===sr[1];){if(!Jt[Wi])return Wi;++Wi<Or&&(Yi=Ve[Wi].point)}for(Wi=ze-1;Jt[Wi]&&Wi>zi;)Wi--;return Wi}Xi.prototype.isExterior=function(){return this.holeOf==null};var $r=Ar,or=Ar;function Ar(ze,Ve){if(!(this instanceof Ar))return new Ar(ze,Ve);if(this.data=ze||[],this.length=this.data.length,this.compare=Ve||Nr,this.length>0)for(var Jt=(this.length>>1)-1;Jt>=0;Jt--)this._down(Jt)}function Nr(ze,Ve){return ze<Ve?-1:ze>Ve?1:0}Ar.prototype={push:function(ze){this.data.push(ze),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var ze=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),ze}},peek:function(){return this.data[0]},_up:function(ze){for(var Ve=this.data,Jt=this.compare,zi=Ve[ze];ze>0;){var Yi=ze-1>>1,Wi=Ve[Yi];if(Jt(zi,Wi)>=0)break;Ve[ze]=Wi,ze=Yi}Ve[ze]=zi},_down:function(ze){for(var Ve=this.data,Jt=this.compare,zi=this.length>>1,Yi=Ve[ze];ze<zi;){var Wi=1+(ze<<1),sr=Wi+1,Or=Ve[Wi];if(sr<this.length&&Jt(Ve[sr],Or)<0&&(Wi=sr,Or=Ve[sr]),Jt(Or,Yi)>=0)break;Ve[ze]=Or,ze=Wi}Ve[ze]=Yi}},$r.default=or;var an=Math.max,on=Math.min,vn=0;function un(ze,Ve,Jt,zi,Yi,Wi){var sr,Or,wn,Bn,hn,ls;for(sr=0,Or=ze.length-1;sr<Or;sr++)if(Bn=ze[sr+1],hn=new Fe(wn=ze[sr],!1,void 0,Ve),ls=new Fe(Bn,!1,hn,Ve),hn.otherEvent=ls,wn[0]!==Bn[0]||wn[1]!==Bn[1]){hn.contourId=ls.contourId=Jt,Wi||(hn.isExteriorRing=!1,ls.isExteriorRing=!1),Gt(hn,ls)>0?ls.left=!0:hn.left=!0;var Rs=wn[0],Cn=wn[1];Yi[0]=on(Yi[0],Rs),Yi[1]=on(Yi[1],Cn),Yi[2]=an(Yi[2],Rs),Yi[3]=an(Yi[3],Cn),zi.push(hn),zi.push(ls)}}var _n=[];function ns(ze,Ve,Jt){typeof ze[0][0][0]=="number"&&(ze=[ze]),typeof Ve[0][0][0]=="number"&&(Ve=[Ve]);var zi=function(Cn,so,Ns){var ss=null;return Cn.length*so.length==0&&(Ns===H?ss=_n:Ns===ee?ss=Cn:Ns!==$&&Ns!==ae||(ss=Cn.length===0?so:Cn)),ss}(ze,Ve,Jt);if(zi)return zi===_n?null:zi;var Yi=[1/0,1/0,-1/0,-1/0],Wi=[1/0,1/0,-1/0,-1/0],sr=function(Cn,so,Ns,ss,wo){var Gs,Ds,js,ds,fn,ms,oo=new $r(null,Gt);for(js=0,ds=Cn.length;js<ds;js++)for(fn=0,ms=(Gs=Cn[js]).length;fn<ms;fn++)(Ds=fn===0)&&vn++,un(Gs[fn],!0,vn,oo,Ns,Ds);for(js=0,ds=so.length;js<ds;js++)for(fn=0,ms=(Gs=so[js]).length;fn<ms;fn++)Ds=fn===0,wo===ee&&(Ds=!1),Ds&&vn++,un(Gs[fn],!1,vn,oo,ss,Ds);return oo}(ze,Ve,Yi,Wi,Jt);if(zi=function(Cn,so,Ns,ss,wo){var Gs=null;return(Ns[0]>ss[2]||ss[0]>Ns[2]||Ns[1]>ss[3]||ss[1]>Ns[3])&&(wo===H?Gs=_n:wo===ee?Gs=Cn:wo!==$&&wo!==ae||(Gs=Cn.concat(so))),Gs}(ze,Ve,Yi,Wi,Jt))return zi===_n?null:zi;for(var Or=function(Cn){var so,Ns,ss=function(js){var ds,fn,ms,oo,kr=[];for(fn=0,ms=js.length;fn<ms;fn++)((ds=js[fn]).left&&ds.inResult||!ds.left&&ds.otherEvent.inResult)&&kr.push(ds);for(var On=!1;!On;)for(On=!0,fn=0,ms=kr.length;fn<ms;fn++)fn+1<ms&&Gt(kr[fn],kr[fn+1])===1&&(oo=kr[fn],kr[fn]=kr[fn+1],kr[fn+1]=oo,On=!1);for(fn=0,ms=kr.length;fn<ms;fn++)(ds=kr[fn]).otherPos=fn;for(fn=0,ms=kr.length;fn<ms;fn++)(ds=kr[fn]).left||(oo=ds.otherPos,ds.otherPos=ds.otherEvent.otherPos,ds.otherEvent.otherPos=oo);return kr}(Cn),wo={},Gs=[],Ds=function(){if(!wo[so]){var js=Gs.length,ds=function(kr,On,Ws){var go=new Xi;if(kr.prevInResult!=null){var Ys=kr.prevInResult,va=Ys.outputContourId;if(Ys.resultTransition>0){var ws=On[va];if(ws.holeOf!=null){var ua=ws.holeOf;On[ua].holeIds.push(Ws),go.holeOf=ua,go.depth=On[va].depth}else On[va].holeIds.push(Ws),go.holeOf=va,go.depth=On[va].depth+1}else go.holeOf=null,go.depth=On[va].depth}else go.holeOf=null,go.depth=0;return go}(ss[so],Gs,js),fn=function(kr){wo[kr]=!0,kr<ss.length&&ss[kr]&&(ss[kr].outputContourId=js)},ms=so,oo=so;for(ds.points.push(ss[so].point);fn(ms),fn(ms=ss[ms].otherPos),ds.points.push(ss[ms].point),!((ms=Pi(ms,ss,wo,oo))==oo||ms>=ss.length)&&ss[ms];);Gs.push(ds)}};for(so=0,Ns=ss.length;so<Ns;so++)Ds();return Gs}(function(Cn,so,Ns,ss,wo,Gs){for(var Ds,js,ds,fn=new f(cr),ms=[],oo=Math.min(ss[2],wo[2]);Cn.length!==0;){var kr=Cn.pop();if(ms.push(kr),Gs===H&&kr.point[0]>oo||Gs===ee&&kr.point[0]>ss[2])break;if(kr.left){js=Ds=fn.insert(kr),Ds=Ds!==(ds=fn.minNode())?fn.prev(Ds):null,js=fn.next(js);var On=Ds?Ds.key:null;if(Ae(kr,On,Gs),js&&xr(kr,js.key,Cn)===2&&(Ae(kr,On,Gs),Ae(js.key,kr,Gs)),Ds&&xr(Ds.key,kr,Cn)===2){var Ws=Ds;Ae(On,(Ws=Ws!==ds?fn.prev(Ws):null)?Ws.key:null,Gs),Ae(kr,On,Gs)}}else js=Ds=fn.find(kr=kr.otherEvent),Ds&&js&&(Ds=Ds!==ds?fn.prev(Ds):null,js=fn.next(js),fn.remove(kr),js&&Ds&&xr(Ds.key,js.key,Cn))}return ms}(sr,0,0,Yi,Wi,Jt)),wn=[],Bn=0;Bn<Or.length;Bn++){var hn=Or[Bn];if(hn.isExterior()){for(var ls=[hn.points],Rs=0;Rs<hn.holeIds.length;Rs++)ls.push(Or[hn.holeIds[Rs]].points);wn.push(ls)}}return wn}var zs={UNION:$,DIFFERENCE:ee,INTERSECTION:H,XOR:ae};o.diff=function(ze,Ve){return ns(ze,Ve,ee)},o.intersection=function(ze,Ve){return ns(ze,Ve,H)},o.operations=zs,o.union=function(ze,Ve){return ns(ze,Ve,$)},o.xor=function(ze,Ve){return ns(ze,Ve,ae)},Object.defineProperty(o,"__esModule",{value:!0})})(t)}(0,Rw.exports)),Rw.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function l0(l,t,o,h){const f=[],m=h===0?(v,C,I,F,k,z)=>{v.push(new qt(z,I+(z-C)/(F-C)*(k-I)))}:(v,C,I,F,k,z)=>{v.push(new qt(C+(z-I)/(k-I)*(F-C),z))};for(const v of l){const C=[];for(const I of v){if(I.length<=2)continue;const F=[];for(let H=0;H<I.length-1;H++){const $=I[H].x,ee=I[H].y,ae=I[H+1].x,Ae=I[H+1].y,ve=h===0?$:ee,Fe=h===0?ae:Ae;ve<t?Fe>t&&m(F,$,ee,ae,Ae,t):ve>o?Fe<o&&m(F,$,ee,ae,Ae,o):F.push(I[H]),Fe<t&&ve>=t&&m(F,$,ee,ae,Ae,t),Fe>o&&ve<=o&&m(F,$,ee,ae,Ae,o)}let k=I[I.length-1];const z=h===0?k.x:k.y;z>=t&&z<=o&&F.push(k),F.length&&(k=F[F.length-1],F[0].x===k.x&&F[0].y===k.y||F.push(F[0]),C.push(F))}C.length&&f.push(C)}return f}function vF(l,t){const o=T_(l),h=T_([t]),f=Dw.intersection(o,h);return f==null?[]:Ow(f)}function _F(l,t){let h=T_(l,65536);for(;t.valid();t.next()){const[f,m]=t.get(),v=f.x*65536,C=f.y*65536,I=m.x*65536,F=m.y*65536,k=I-v,z=F-C,H=Math.hypot(k,z),$=Math.trunc(z/H*3),ee=-Math.trunc(k/H*3);h=Dw.diff(h,[[[v,C],[I,F],[I+$,F+ee],[v+$,C+ee],[v,C]]])}return Ow(h,1/65536)}function T_(l,t=1){return[l.map(o=>o.map(h=>[h.x*t,h.y*t]))]}function Ow(l,t=1){return l.map(o=>o.map((h,f)=>{const m=h.map(v=>new qt(v[0]*t,v[1]*t).round());return f>0&&m.reverse(),m}))}class I_{constructor(t,o){this.layoutVertexArray=new Yu,this.indexArray=new Zo,this.lineIndexArray=new Lh,this.triangleSegments=new Vs,this.lineSegments=new Vs,this.programConfigurations=new p(t.layers,{zoom:t.zoom,lut:t.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new qh)}update(t,o,h,f,m,v,C,I){this.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,I)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nF.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.lineIndexBuffer=t.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,sF.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(t,o,h,f,m,v,C){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,h,f,m,v,void 0,C)}}class F_{constructor(t){this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=t.lut,this.bufferData=new I_(t,!1),this.elevationBufferData=new I_(t,!0),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=t.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=t.sourceLayerIndex,this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,h,f){this.hasPattern=S_("fill",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:C,id:I,index:F,sourceLayerIndex:k}of t){const z=this.layers[0]._featureFilter.needGeometry,H=Ki(C,z);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),H,h))continue;const $=m?m.evaluate(H,{},h,o.availableImages):void 0,ee={id:I,properties:C.properties,type:C.type,sourceLayerIndex:k,index:F,geometry:z?H.geometry:tr(C,h,f),patterns:{},sortKey:$};v.push(ee)}m&&v.sort((C,I)=>C.sortKey-I.sortKey);for(const C of v){const{geometry:I,index:F,sourceLayerIndex:k}=C;if(this.hasPattern){const z=E_("fill",this.layers,C,this.zoom,this.pixelRatio,o);this.patternFeatures.push(z)}else this.addFeature(C,I,F,h,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(t[F].feature,I,F,k,this.index)}}update(t,o,h,f,m,v,C){this.bufferData.update(t,o,h,f,m,v,C,this.worldview),this.elevationBufferData.update(t,o,h,f,m,v,C,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(t,o,h,f,m,v,C,this.worldview)}addFeatures(t,o,h,f,m,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,h,f,v,t.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(t){this.bufferData.upload(t),this.elevationBufferData.upload(t),this.elevatedStructures&&this.elevatedStructures.upload(t)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(t,o,h,f,m,v=[],C,I){const F=a0(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(t,F,f,h,I):this.addGeometry(F,this.bufferData),this.bufferData.populatePaintArrays(t,h,m,v,f,C,this.worldview),this.elevationBufferData.populatePaintArrays(t,h,m,v,f,C,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(t,o,h,f,m){this.elevatedStructures&&(this.elevatedStructures.construct(t),this.elevatedStructures.populatePaintArrays(o,h,f,m,this.worldview))}addElevatedRoadFeature(t,o,h,f,m){const v=new Array,C=Ht.getElevationFeature(t,m);if(!C)return void this.addGeometry(o,this.bufferData);{const F=this.clipPolygonsToTile(o,1);F.length>0&&v.push({polygons:F,elevationFeature:C,elevationTileID:h})}const I={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(t,{},h),featureIndex:f};for(const F of v)if(F.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new th(F.elevationTileID,this.layers,this.zoom,this.lut));const z=F.elevationFeature.isTunnel();let H=0;t.properties.hasOwnProperty(Ps)&&(H=+t.properties[Ps]);for(const $ of F.polygons)this.elevatedStructures.addPortalCandidates(F.elevationFeature.id,$,z,F.elevationFeature,H)}F.elevationFeature.constantHeight==null&&(F.polygons=this.prepareElevatedPolygons(F.polygons,F.elevationFeature,F.elevationTileID));const k=new si(h,F.elevationTileID);this.addElevatedGeometry(F.polygons,k,F.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,f,I)}}addElevatedGeometry(t,o,h,f,m,v){const C={elevation:h,elevationSampler:o,bias:f,index:m,featureInfo:v},[I,F]=this.addGeometry(t,this.elevationBufferData,C);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:I,max:F}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,I),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,F))}addGeometry(t,o,h){let f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=null;h&&(v=h.elevationSampler.constantElevation(h.elevation,h.bias),v!=null&&(f=v,m=v));const C=(I,F,k)=>{if(h!=null)if(F.push(I),v!=null)o.elevatedLayoutVertexArray.emplaceBack(v),k.push(v);else{const z=h.elevationSampler.pointElevation(I,h.elevation,h.bias);o.elevatedLayoutVertexArray.emplaceBack(z),k.push(z),f=Math.min(f,z),m=Math.max(m,z)}};for(const I of t){let F=0;for(const Le of I)F+=Le.length;const k=o.triangleSegments.prepareSegment(F,o.layoutVertexArray,o.indexArray),z=k.vertexLength,H=[],$=[],ee=[],ae=[],Ae=[],ve=o.layoutVertexArray.length;for(const Le of I){if(Le.length===0)continue;Le!==I[0]&&$.push(H.length/2);const ce=o.lineSegments.prepareSegment(Le.length,o.layoutVertexArray,o.lineIndexArray),Ee=ce.vertexLength;h&&Ae.push(o.layoutVertexArray.length-ve),C(Le[0],ee,ae),o.layoutVertexArray.emplaceBack(Le[0].x,Le[0].y),o.lineIndexArray.emplaceBack(Ee+Le.length-1,Ee),H.push(Le[0].x),H.push(Le[0].y);for(let ke=1;ke<Le.length;ke++)C(Le[ke],ee,ae),o.layoutVertexArray.emplaceBack(Le[ke].x,Le[ke].y),o.lineIndexArray.emplaceBack(Ee+ke-1,Ee+ke),H.push(Le[ke].x),H.push(Le[ke].y);ce.vertexLength+=Le.length,ce.primitiveLength+=Le.length}const Fe=vm(H,$);for(let Le=0;Le<Fe.length;Le+=3)o.indexArray.emplaceBack(z+Fe[Le],z+Fe[Le+1],z+Fe[Le+2]);if(Fe.length>0&&h&&this.elevationMode==="hd-road-base"){const Le=h.elevation.isTunnel(),ce=h.elevation.safeArea,Ee=this.elevatedStructures.addVertices(ee,ae);this.elevatedStructures.addTriangles(Fe,Ee,Le);const ke=Ae.length;if(ke>0){for(let He=0;He<ke-1;He++)this.elevatedStructures.addRenderableRing(h.index,Ae[He]+Ee,Ae[He+1]-Ae[He],Le,ce,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,Ae[ke-1]+Ee,ee.length-Ae[ke-1],Le,ce,h.featureInfo)}}k.vertexLength+=F,k.primitiveLength+=Fe.length/3}return[f,m]}prepareElevatedPolygons(t,o,h){const f=1/Vt(h),m=[];for(const v of t){const C=_F(v,new ft(o,f));m.push(...C)}return m}clipPolygonsToTile(t,o){const h=-o,f=-o,m=wi+o,v=wi+o;let C=0;const I=[],F=[];for(;C<t.length;C++){const H=t[C],$=bc(H);($.min.x>=h&&$.max.x<=m&&$.min.y>=f&&$.max.y<=v?I:F).push(H)}if(I.length===t.length)return t;const k=[new qt(h,f),new qt(m,f),new qt(m,v),new qt(h,v),new qt(h,f)],z=I;for(const H of F)z.push(...vF(H,k));return z}}let Uw,zw,Nw,jw;Zi(F_,"FillBucket",{omit:["layers","patternFeatures"]}),Zi(I_,"FillBufferData"),Zi(th,"ElevatedStructures");class L_{constructor(t,o,h,f){if(this.triangleCount=o.length/3,this.min=new qt(0,0),this.max=new qt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[m,v]=[t[0].clone(),t[0].clone()];for(let z=1;z<t.length;++z){const H=t[z];m.x=Math.min(m.x,H.x),m.y=Math.min(m.y,H.y),v.x=Math.max(v.x,H.x),v.y=Math.max(v.y,H.y)}if(f){const z=Math.ceil(Math.max(v.x-m.x,v.y-m.y)/f);h=Math.max(h,z)}if(h===0)return;this.min=m,this.max=v;const C=this.max.sub(this.min);C.x=Math.max(C.x,1),C.y=Math.max(C.y,1);const I=Math.max(C.x,C.y)/h;this.cellsX=Math.max(1,Math.ceil(C.x/I)),this.cellsY=Math.max(1,Math.ceil(C.y/I)),this.xScale=1/I,this.yScale=1/I;const F=[];for(let z=0;z<this.triangleCount;z++){const H=t[o[3*z+0]].sub(this.min),$=t[o[3*z+1]].sub(this.min),ee=t[o[3*z+2]].sub(this.min),ae=MA(Math.floor(Math.min(H.x,$.x,ee.x)),this.xScale,this.cellsX),Ae=MA(Math.floor(Math.max(H.x,$.x,ee.x)),this.xScale,this.cellsX),ve=MA(Math.floor(Math.min(H.y,$.y,ee.y)),this.yScale,this.cellsY),Fe=MA(Math.floor(Math.max(H.y,$.y,ee.y)),this.yScale,this.cellsY),Le=new qt(0,0),ce=new qt(0,0),Ee=new qt(0,0),ke=new qt(0,0);for(let He=ve;He<=Fe;++He){Le.y=ce.y=He*I,Ee.y=ke.y=(He+1)*I;for(let gt=ae;gt<=Ae;++gt)Le.x=Ee.x=gt*I,ce.x=ke.x=(gt+1)*I,(uc(H,$,ee,Le,ce,ke)||uc(H,$,ee,Le,ke,Ee))&&F.push({cellIdx:He*this.cellsX+gt,triIdx:z})}}if(F.length===0)return;F.sort((z,H)=>z.cellIdx-H.cellIdx||z.triIdx-H.triIdx);let k=0;for(;k<F.length;){const z=F[k].cellIdx,H={start:this.payload.length,len:0};for(;k<F.length&&F[k].cellIdx===z;)++H.len,this.payload.push(F[k++].triIdx);this.cells[z]=H}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const h=MA(t.x-this.min.x,this.xScale,this.cellsX),f=MA(t.y-this.min.y,this.yScale,this.cellsY),m=this.cells[f*this.cellsX+h];if(m){this._lazyInitLookup();for(let v=0;v<m.len;v++){const C=this.payload[m.start+v],I=Math.floor(C/8),F=1<<C%8;if(!(this.lookup[I]&F)&&(this.lookup[I]|=F,o.push(C),o.length===this.triangleCount))return}}}query(t,o,h){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const f=MA(t.x-this.min.x,this.xScale,this.cellsX),m=MA(o.x-this.min.x,this.xScale,this.cellsX),v=MA(t.y-this.min.y,this.yScale,this.cellsY),C=MA(o.y-this.min.y,this.yScale,this.cellsY);for(let I=v;I<=C;I++)for(let F=f;F<=m;F++){const k=this.cells[I*this.cellsX+F];if(k)for(let z=0;z<k.len;z++){const H=this.payload[k.start+z],$=Math.floor(H/8),ee=1<<H%8;if(!(this.lookup[$]&ee)&&(this.lookup[$]|=ee,h.push(H),h.length===this.triangleCount))return}}}}function MA(l,t,o){return Math.max(0,Math.min(o-1,Math.floor(l*t)))}Zi(L_,"TriangleGridIndex");class Hw{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[],this.worldview=t.worldview}updateFootprints(t,o){for(const h of this.footprints)o.push({footprint:h,id:t})}populate(t,o,h,f){const m=[];for(const{feature:v,id:C,index:I,sourceLayerIndex:F}of t){const k=this.layers[0]._featureFilter.needGeometry,z=Ki(v,k);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),z,h))continue;const H={id:C,properties:v.properties,type:v.type,sourceLayerIndex:F,index:I,geometry:k?z.geometry:tr(v,h,f),patterns:{}};m.push(H)}for(const v of m){const{geometry:C,index:I,sourceLayerIndex:F}=v;this.addFeature(v,C,I,h,{},o.availableImages,o.brightness),o.featureIndex.insert(t[I].feature,C,I,F,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,o,h,f,m,v,C){}destroy(){}addFeature(t,o,h,f,m,v=[],C){for(const I of a0(o,2)){const F=[],k=[],z=[],H=new qt(1/0,1/0),$=new qt(-1/0,-1/0);for(const Ae of I)if(Ae.length!==0){Ae!==I[0]&&z.push(k.length/2);for(let ve=0;ve<Ae.length;ve++)k.push(Ae[ve].x),k.push(Ae[ve].y),F.push(Ae[ve]),H.x=Math.min(H.x,Ae[ve].x),H.y=Math.min(H.y,Ae[ve].y),$.x=Math.max($.x,Ae[ve].x),$.y=Math.max($.y,Ae[ve].y)}const ee=vm(k,z),ae=new L_(F,ee,8,256);this.footprints.push({vertices:F,indices:ee,grid:ae,min:H,max:$})}}}Zi(Hw,"ClipBucket",{omit:["layers"]});const xF=Rn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),bF=Rn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),wF=Rn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),BF=Rn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),CF=Rn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),SF=Rn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:EF}=xF,c0=Number.MAX_SAFE_INTEGER;function Qw(l,t,o,h){return l.order<t||l.order===c0||!(l.clipMask&o)||function(f,m){return m.length!==0&&m.find(v=>v===f)===void 0}(h,l.clipScope)}function u0(l,t){return l.x-t.x||l.y-t.y}function Vw(l,t){return u0(l.min,t.min)===0&&u0(l.max,t.max)===0}function M_(l,t){return!(l.min.x>t.max.x||l.max.x<t.min.x||l.min.y>t.max.y||l.max.y<t.min.y)}function P_(l,t){if(l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(l[o].sourceId!==t[o].sourceId||!Vw(l[o],t[o])||l[o].order!==t[o].order||l[o].clipMask!==t[o].clipMask||!Nn(l[o].clipScope,t[o].clipScope))return!1;return!0}function Gw(l,t,o){const h=1/wi,f=1/(1<<o.canonical.z),m=(t.x*h+o.canonical.x)*f+o.wrap,v=(t.y*h+o.canonical.y)*f;return{min:new qt((l.x*h+o.canonical.x)*f+o.wrap,(l.y*h+o.canonical.y)*f),max:new qt(m,v)}}function TF(l,t,o){const h=1<<o.canonical.z,f=((t.x-o.wrap)*h-o.canonical.x)*wi,m=(t.y*h-o.canonical.y)*wi;return{min:new qt(((l.x-o.wrap)*h-o.canonical.x)*wi,(l.y*h-o.canonical.y)*wi),max:new qt(f,m)}}function Ww(l,t,o,h,f,m,v){const C=l.indices,I=l.vertices,F=[];for(let k=h;k<h+f;k+=3){const z=t[o[k+0]+m],H=t[o[k+1]+m],$=t[o[k+2]+m],ee=Math.min(z.x,H.x,$.x),ae=Math.max(z.x,H.x,$.x),Ae=Math.min(z.y,H.y,$.y),ve=Math.max(z.y,H.y,$.y);F.length=0,l.grid.query(new qt(ee,Ae),new qt(ae,ve),F);for(let Fe=0;Fe<F.length;Fe++){const Le=F[Fe];if(uc(I[C[3*Le+0]],I[C[3*Le+1]],I[C[3*Le+2]],z,H,$,v))return!0}}return!1}function Xw(l,t,o,h){if(!l||!o)return!1;let f=l.vertices;if(!t.canonical.equals(h.canonical)||t.wrap!==h.wrap){if(o.vertices.length<l.vertices.length)return Xw(o,h,l,t);const m=t.canonical,v=h.canonical,C=Math.pow(2,v.z-m.z);f=l.vertices.map(I=>new qt((I.x+m.x*wi)*C-v.x*wi,(I.y+m.y*wi)*C-v.y*wi))}return Ww(o,f,l.indices,0,l.indices.length,0,0)}function Yw(l,t,o,h){const f=Math.pow(2,h.z-o.z);return new qt((l+o.x*wi)*f-h.x*wi,(t+o.y*wi)*f-h.y*wi)}function Kw(l,t){const o=[];t.grid.queryPoint(l,o);const h=t.indices,f=t.vertices;for(let m=0;m<o.length;m++){const v=o[m];if(rs([f[h[3*v+0]],f[h[3*v+1]],f[h[3*v+2]]],l))return!0}return!1}const k_=[new qt(0,0),new qt(wi,0),new qt(wi,wi),new qt(0,wi)];function qw(l,t){const o=[];let h=[];if(!t||l.length<2)return[l];if(l.length===2)return Ln(l[0],l[1],k_)?[l]:[];for(let f=0;f<l.length+2;f++){const m=l[f%l.length],v=l[(f+1)%l.length],C=Ln(f===0?l[l.length-1]:l[(f-1)%l.length],m,k_),I=Ln(m,v,k_),F=C||I;F&&h.push(m),F&&I||h.length>0&&(h.length>1&&o.push(h),h=[])}return h.length>1&&o.push(h),o}const R_=ln.VectorTileFeature.types,IF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],FF=["fill-extrusion-flood-light-ground-radius"],LF=Math.pow(2,13),MF=Math.pow(2,15)-1,$w=new qt(0,1),ep=2147483648;function Bm(l,t,o,h,f,m,v,C){l.emplaceBack((t<<1)+v,(o<<1)+m,(Math.floor(h*LF)<<1)+f,Math.round(C))}function Cm(l,t,o){l.emplaceBack(t.x*wi,t.y*wi,o?1:0)}function h0(l,t,o,h,f,m){l.emplaceBack(t.x,t.y,(o.x<<1)+h,(o.y<<1)+f,m)}function Sm(l,t,o){l.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Zw{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Jw{constructor(){this.centroidXY=new qt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new qt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new qt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new qt(this.max.x-this.min.x,this.max.y-this.min.y)}}class e2{constructor(){this.acc=new qt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,h){this.accCount++,this.acc._add(o);let f=!!this.borders;o.x<t.min.x?(t.min.x=o.x,f=!0):o.x>t.max.x&&(t.max.x=o.x,f=!0),o.y<t.min.y?(t.min.y=o.y,f=!0):o.y>t.max.y&&(t.max.y=o.y,f=!0),((o.x===0||o.x===wi)&&o.x===h.x)!=((o.y===0||o.y===wi)&&o.y===h.y)&&this.processBorderOverlap(o,h),f&&this.checkBorderIntersection(o,h)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,Er(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>wi!=t.x>wi&&this.addBorderIntersection(1,Er(o.y,t.y,(wi-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,Er(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>wi!=t.y>wi&&this.addBorderIntersection(3,Er(o.x,t.x,(wi-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[t];o<h[0]&&(h[0]=o),o>h[1]&&(h[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const h=t.x===0?0:1;this.addBorderIntersection(h,o.y),this.addBorderIntersection(h,t.y)}else{const h=t.y===0?2:3;this.addBorderIntersection(h,o.x),this.addBorderIntersection(h,t.x)}}centroid(){return this.accCount===0?new qt(0,0):new qt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,o)=>t+ +(o[0]!==Number.MAX_VALUE),0):0}}function t2(l,t){const o=l.add(t)._unit(),h=Ge(l.x*o.x+l.y*o.y,-1,1);var f,m,v;return f=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(f)))/4*MF*((m=l).x*(v=t).y-m.y*v.x<0?-1:1)}const PF=[l=>l.x<0,l=>l.x>wi,l=>l.y<0,l=>l.y>wi];function kF(l,t,o,h){const f=[4];if(h===0)return f;o._mult(h);const m=l.sub(o),v=t.sub(o),C=[l,t,m,v];for(let I=0;I<4;I++)for(const F of C)if(PF[I](F)){f.push(I);break}return f}class i2{constructor(t){this.vertexArray=new Th,this.indexArray=new Zo,this.programConfigurations=new p(t.layers,{zoom:t.zoom,lut:t.lut},o=>FF.includes(o)),this._segments=new Vs,this.hiddenByLandmarkVertexArray=new Vf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Vs}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,h,f=!1){const m=t.length;if(m>2){let v=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let I;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const F=t[0],k=t[1];I=t2(F.sub(t[m-1])._perp()._unit(),k.sub(F)._perp()._unit())}for(let F=0;F<m;F++){const k=F===m-1?0:F+1,z=t[F],H=t[k],$=t[k===m-1?0:k+1],ee=H.sub(z)._perp()._unit(),ae=t2(ee,$.sub(H)._perp()._unit()),Ae=I,ve=ae;if(D_(z,H,o)||f&&s2(z,o)&&s2(H,o)){I=ae;continue}const Fe=C.vertexLength;h0(this.vertexArray,z,H,1,1,Ae),h0(this.vertexArray,z,H,1,0,Ae),h0(this.vertexArray,z,H,0,1,ve),h0(this.vertexArray,z,H,0,0,ve),C.vertexLength+=4;const Le=kF(z,H,ee,h);for(const ce of Le)this._segmentToGroundQuads[v].push({id:Fe,region:ce}),this._segmentToRegionTriCounts[v][ce]+=2,C.primitiveLength+=2;I=ae}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let h=0;h<o;h++)this._segmentToGroundQuads[h].sort((f,m)=>f.region-m.region);for(let h=0;h<o;h++){const f=this._segmentToGroundQuads[h],m=t[h],v=this._segmentToRegionTriCounts[h];v.reduce((I,F)=>I+F,0);let C=0;for(let I=0;I<=4;I++){const F=v[I];if(F!==0){let k=this.regionSegments[I];k||(k=this.regionSegments[I]=new Vs);const z={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+C,vertexLength:m.vertexLength,primitiveLength:F};k.get().push(z)}C+=F}for(let I=0;I<f.length;I++){const F=f[I].id;this.indexArray.emplaceBack(F,F+1,F+3),this.indexArray.emplaceBack(F,F+3,F+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,h,f,m,v,C){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,h,f,m,v,void 0,C)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,bF.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,h,f,m,v,C,I){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,h,f,m,v,C,I)}updateHiddenByLandmark(t){if(!this.hasData())return;const o=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const h=t.flags&ep?1:0;for(let f=t.groundVertexArrayOffset;f<o;++f)this.hiddenByLandmarkVertexArray.emplace(f,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,CF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class d0{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.pixelRatio=t.pixelRatio,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Zo,this.footprintVertices=new Yu,this.footprintSegments=[],this.layoutVertexArray=new _A,this.centroidVertexArray=new Rp,this.wallVertexArray=new Jh,this.indexArray=new Zo,this.programConfigurations=new p(t.layers,{zoom:t.zoom,lut:t.lut},o=>IF.includes(o)),this.segments=new Vs,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new i2(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,h,f){this.features=[],this.hasPattern=S_("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Vt(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:v,index:C,sourceLayerIndex:I}of t){const F=this.layers[0]._featureFilter.needGeometry,k=Ki(m,F);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),k,h))continue;const z={id:v,sourceLayerIndex:I,index:C,geometry:F?k.geometry:tr(m,h,f),properties:m.properties,type:m.type,patterns:{}},H=this.layoutVertexArray.length,$=R_[z.type]==="Polygon";if(this.hasPattern)this.features.push(E_("fill-extrusion",this.layers,z,this.zoom,this.pixelRatio,o));else if(this.wallMode)for(const ee of z.geometry)for(const ae of qw(ee,$))this.addFeature(z,[ae],C,h,{},o.availableImages,f,o.brightness);else this.addFeature(z,z.geometry,C,h,{},o.availableImages,f,o.brightness);o.featureIndex.insert(m,z.geometry,C,I,this.index,H)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,o,h,f,m,v){for(const C of this.features){const I=R_[C.type]==="Polygon",{geometry:F}=C;if(this.wallMode)for(const k of F)for(const z of qw(k,I))this.addFeature(C,[z],C.index,o,h,f,m,v);else this.addFeature(C,F,C.index,o,h,f,m,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,o,h,f,m,v,C){this.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,this.worldview),this.groundEffect.update(t,o,m,h,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,EF),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,BF.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,SF.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,wF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,h,f,m,v,C,I){const F=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,k=[new qt(0,0),new qt(wi,wi)],z=C.projection,H=z.name==="globe",$=this.wallMode||R_[t.type]==="Polygon",ee=new e2;ee.centroidDataIndex=this.centroidData.length;const ae=new Jw,Ae=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},f)<=0,ve=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},f);let Fe;if(ae.height=ve,ae.vertexArrayOffset=this.layoutVertexArray.length,ae.groundVertexArrayOffset=this.groundEffect.vertexArray.length,H&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rf),this.wallMode){if(H)return void Yr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;Fe=function(yt){const Lt=yt[0].x===yt[yt.length-1].x&&yt[0].y===yt[yt.length-1].y;(function(Xi){let Pi=0;const $r=Xi.length;for(let or=0;or<$r;or++)Pi+=(Xi[(or+1)%$r].x-Xi[or].x)*(Xi[(or+1)%$r].y+Xi[or].y);return Pi>=0})(yt)||(yt=yt.reverse());const Si={geometry:[],joinNormals:[],indices:[]},fi=[],Ci=[],Ii=[];let $t=yt.length;for(;$t>=2&&yt[$t-1].equals(yt[$t-2]);)$t--;if($t<(Lt?3:2))return Si;let _i,Gt,Yt,ki,Di,xr=0;for(;xr<$t-1&&yt[xr].equals(yt[xr+1]);)xr++;Lt&&(_i=yt[$t-2],Di=yt[xr].sub(_i)._unit()._perp());for(let Xi=xr;Xi<$t;Xi++){if(Yt=Xi===$t-1?Lt?yt[xr+1]:void 0:yt[Xi+1],Yt&&yt[Xi].equals(Yt))continue;Di&&(ki=Di),_i&&(Gt=_i),_i=yt[Xi],Di=Yt?Yt.sub(_i)._unit()._perp():ki,ki=ki||Di;let Pi=ki.add(Di);Pi.x===0&&Pi.y===0||Pi._unit();const $r=Pi.x*Di.x+Pi.y*Di.y,or=$r!==0?1/$r:1/0,Ar=ki.x*Di.y-ki.y*Di.x>0;let Nr="miter";const an=2;Nr==="miter"&&or>an&&(Nr="bevel"),Nr==="bevel"&&(or>100&&(Nr="flipbevel"),or<an&&(Nr="miter"));const on=(vn,un,_n,ns)=>{const zs=new qt(vn.x,vn.y),ze=new qt(vn.x,vn.y);zs.x+=un.x*ns,zs.y+=un.y*ns,ze.x-=un.x*Math.max(_n,1),ze.y-=un.y*Math.max(_n,1),Ii.push(un),fi.push(zs),Ci.push(ze)};if(Nr==="miter")Pi._mult(or),on(_i,Pi,0,0);else if(Nr==="flipbevel")Pi=Di.mult(-1),on(_i,Pi,0,0),on(_i,Pi.mult(-1),0,0);else{const vn=-Math.sqrt(or*or-1),un=Ar?vn:0,_n=Ar?0:vn;Gt&&on(_i,ki,un,_n),Yt&&on(_i,Di,un,_n)}}Si.geometry=[...fi,...Ci.reverse(),fi[0]],Si.joinNormals=[...Ii,...Ii.reverse(),Ii[Ii.length-1]];const cr=Si.geometry.length-1;for(let Xi=0;Xi<cr/2;Xi++)if(Xi+1<cr/2){let Pi=Xi,$r=Xi+1,or=cr-1-Xi,Ar=cr-2-Xi;Pi=Pi===0?cr-1:Pi-1,$r=$r===0?cr-1:$r-1,or=or===0?cr-1:or-1,Ar=Ar===0?cr-1:Ar-1,Si.indices.push(or),Si.indices.push($r),Si.indices.push(Pi),Si.indices.push(or),Si.indices.push(Ar),Si.indices.push($r)}return Si}(o[0]),o=[Fe.geometry]}const Le=(yt,Lt)=>yt<(Lt.length-1)/2||yt===Lt.length-1,ce=this.wallMode?[o]:a0(o,500);for(let yt=ce.length-1;yt>=0;yt--){const Lt=ce[yt];(Lt.length===0||(Ee=Lt[0]).every(Wt=>Wt.x<=0)||Ee.every(Wt=>Wt.x>=wi)||Ee.every(Wt=>Wt.y<=0)||Ee.every(Wt=>Wt.y>=wi))&&ce.splice(yt,1)}var Ee;let ke;if(H)ke=c2(ce,k,f);else{ke=[];for(const yt of ce)ke.push({polygon:yt,bounds:k})}const He=$?this.edgeRadius:0,gt=He>0&&this.zoom<17,ht=(yt,Lt)=>{if(yt.length===0)return!1;const Wt=yt[yt.length-1];return Lt.x===Wt.x&&Lt.y===Wt.y};for(const{polygon:yt,bounds:Lt}of ke){let Wt=0,Si=0;for(const $t of yt)$&&!$t[0].equals($t[$t.length-1])&&$t.push($t[0]),Si+=$?$t.length-1:$t.length;const fi=this.segments.prepareSegment(($?5:4)*Si,this.layoutVertexArray,this.indexArray);ae.footprintSegIdx<0&&(ae.footprintSegIdx=this.footprintSegments.length),ae.polygonSegIdx<0&&(ae.polygonSegIdx=this.polygonSegments.length);const Ci={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ii=new Zw;if(Ii.vertexOffset=this.footprintVertices.length,Ii.indexOffset=3*this.footprintIndices.length,Ii.ringIndices=[],$){const $t=[],_i=[];Wt=fi.vertexLength;for(let Yt=0;Yt<yt.length;Yt++){const ki=yt[Yt];ki.length&&Yt!==0&&_i.push($t.length/2);const Di=[];let xr,cr;xr=ki[1].sub(ki[0])._perp()._unit(),Ii.ringIndices.push(ki.length-1);for(let Xi=1;Xi<ki.length;Xi++){const Pi=ki[Xi],$r=ki[Xi===ki.length-1?1:Xi+1],or=Pi.clone();if(He){cr=$r.sub(Pi)._perp()._unit();const Ar=xr.add(cr)._unit(),Nr=He*Math.min(4,1/(xr.x*Ar.x+xr.y*Ar.y));or.x+=Nr*Ar.x,or.y+=Nr*Ar.y,or.x=Math.round(or.x),or.y=Math.round(or.y),xr=cr}if(!Ae||He!==0&&!gt||ht(Di,or)||Di.push(or),Bm(this.layoutVertexArray,or.x,or.y,0,0,1,1,0),this.wallMode){const Ar=Le(Xi,ki);Cm(this.wallVertexArray,Fe.joinNormals[Xi],!Ar)}fi.vertexLength++,this.footprintVertices.emplaceBack(Pi.x,Pi.y),$t.push(Pi.x,Pi.y),H&&Sm(this.layoutVertexExtArray,z.projectTilePoint(or.x,or.y,f),z.upVector(f,or.x,or.y))}Ae&&(He===0||gt)&&(Di.length!==0&&ht(Di,Di[0])&&Di.pop(),this.groundEffect.addData(Di,Lt,F))}const Gt=this.wallMode?Fe.indices:vm($t,_i);for(let Yt=0;Yt<Gt.length;Yt+=3)this.footprintIndices.emplaceBack(Ii.vertexOffset+Gt[Yt+0],Ii.vertexOffset+Gt[Yt+1],Ii.vertexOffset+Gt[Yt+2]),this.indexArray.emplaceBack(Wt+Gt[Yt],Wt+Gt[Yt+2],Wt+Gt[Yt+1]),fi.primitiveLength++;Ii.indexCount+=Gt.length,Ii.vertexCount+=this.footprintVertices.length-Ii.vertexOffset}for(let $t=0;$t<yt.length;$t++){const _i=yt[$t];ee.startRing(ae,_i[0]);let Gt=_i.length>4&&o2(_i[_i.length-2],_i[0],_i[1]),Yt=He?RF(_i[_i.length-2],_i[0],_i[1],He):0;const ki=[];let Di,xr,cr;xr=_i[1].sub(_i[0])._perp()._unit();let Xi=!0;for(let Pi=1,$r=0;Pi<_i.length;Pi++){let or=_i[Pi-1],Ar=_i[Pi];const Nr=_i[Pi===_i.length-1?1:Pi+1];if(ee.appendEdge(ae,Ar,or),D_(Ar,or,Lt)){He&&(xr=Nr.sub(Ar)._perp()._unit(),Xi=!Xi);continue}const an=Ar.sub(or)._perp(),on=an.x/(Math.abs(an.x)+Math.abs(an.y)),vn=an.y>0?1:0,un=or.dist(Ar);if($r+un>32768&&($r=0),He){cr=Nr.sub(Ar)._perp()._unit();let ze=n2(or,Ar,Nr,r2(xr,cr),He);isNaN(ze)&&(ze=0);const Ve=Ar.sub(or)._unit();or=or.add(Ve.mult(Yt))._round(),Ar=Ar.add(Ve.mult(-ze))._round(),Yt=ze,xr=cr,Ae&&this.zoom>=17&&(ht(ki,or)||ki.push(or),ht(ki,Ar)||ki.push(Ar))}const _n=fi.vertexLength,ns=_i.length>4&&o2(or,Ar,Nr);let zs=a2($r,Gt,Xi);if(Bm(this.layoutVertexArray,or.x,or.y,on,vn,0,0,zs),Bm(this.layoutVertexArray,or.x,or.y,on,vn,0,1,zs),this.wallMode){const ze=Le(Pi-1,_i),Ve=Fe.joinNormals[Pi-1];Cm(this.wallVertexArray,Ve,ze),Cm(this.wallVertexArray,Ve,ze)}if($r+=un,zs=a2($r,ns,!Xi),Gt=ns,Bm(this.layoutVertexArray,Ar.x,Ar.y,on,vn,0,0,zs),Bm(this.layoutVertexArray,Ar.x,Ar.y,on,vn,0,1,zs),this.wallMode){const ze=Le(Pi,_i),Ve=Fe.joinNormals[Pi];Cm(this.wallVertexArray,Ve,ze),Cm(this.wallVertexArray,Ve,ze)}if(fi.vertexLength+=4,this.indexArray.emplaceBack(_n+0,_n+1,_n+2),this.indexArray.emplaceBack(_n+1,_n+3,_n+2),fi.primitiveLength+=2,He){const ze=Wt+(Pi===1?_i.length-2:Pi-2),Ve=Pi===1?Wt:ze+1;if(this.indexArray.emplaceBack(_n+1,ze,_n+3),this.indexArray.emplaceBack(ze,Ve,_n+3),fi.primitiveLength+=2,Di===void 0&&(Di=_n),!D_(Nr,_i[Pi],Lt)){const Jt=Pi===_i.length-1?Di:fi.vertexLength;this.indexArray.emplaceBack(_n+2,_n+3,Jt),this.indexArray.emplaceBack(_n+3,Jt+1,Jt),this.indexArray.emplaceBack(_n+3,Ve,Jt+1),fi.primitiveLength+=3}Xi=!Xi}if(H){const ze=this.layoutVertexExtArray,Ve=z.projectTilePoint(or.x,or.y,f),Jt=z.projectTilePoint(Ar.x,Ar.y,f),zi=z.upVector(f,or.x,or.y),Yi=z.upVector(f,Ar.x,Ar.y);Sm(ze,Ve,zi),Sm(ze,Ve,zi),Sm(ze,Jt,Yi),Sm(ze,Jt,Yi)}}$&&(Wt+=_i.length-1),Ae&&He&&this.zoom>=17&&(ki.length!==0&&ht(ki,ki[0])&&ki.pop(),this.groundEffect.addData(ki,Lt,F,He>0))}this.footprintSegments.push(Ii),Ci.triangleCount=this.indexArray.length-Ci.triangleArrayOffset,this.polygonSegments.push(Ci),++ae.footprintSegLen,++ae.polygonSegLen}if(ae.vertexCount=this.layoutVertexArray.length-ae.vertexArrayOffset,ae.groundVertexCount=this.groundEffect.vertexArray.length-ae.groundVertexArrayOffset,ae.vertexCount!==0){if(ae.centroidXY=ee.borders?$w:this.encodeCentroid(ee,ae),this.centroidData.push(ae),ee.borders){this.featuresOnBorder.push(ee);const yt=this.featuresOnBorder.length-1;for(let Lt=0;Lt<ee.borders.length;Lt++)ee.borders[Lt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Lt].push(yt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,m,v,f,I,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(t,h,m,v,f,I,this.worldview),this.maxHeight=Math.max(this.maxHeight,ve)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((o,h)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[h].borders[t][0])}splitToSubtiles(){const t=[];for(let C=0;C<this.centroidData.length;C++){const I=this.centroidData[C],F=+(I.min.y+I.max.y>wi),k=2*F+(+(I.min.x+I.max.x>wi)^F);for(let z=0;z<I.polygonSegLen;z++){const H=I.polygonSegIdx+z;t.push({centroidIdx:C,subtile:k,polygonSegmentIdx:H,triangleSegmentIdx:this.polygonSegments[H].triangleSegIdx})}}const o=new Zo;t.sort((C,I)=>C.triangleSegmentIdx===I.triangleSegmentIdx?C.subtile-I.subtile:C.triangleSegmentIdx-I.triangleSegmentIdx);let h=0,f=0,m=0;for(const C of t){if(C.triangleSegmentIdx!==h)break;m++}const v=t.length;for(;f!==t.length;){h=t[f].triangleSegmentIdx;let C=0,I=f,F=f;for(let k=I;k<m&&t[k].subtile===C;k++)F++;for(;I!==m;){const k=t[I];C=k.subtile;const z=this.centroidData[k.centroidIdx].min.clone(),H=this.centroidData[k.centroidIdx].max.clone(),$={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let ee=I;ee<F;ee++){const ae=t[ee],Ae=this.polygonSegments[ae.polygonSegmentIdx],ve=this.centroidData[ae.centroidIdx].min,Fe=this.centroidData[ae.centroidIdx].max,Le=this.indexArray.uint16;for(let ce=Ae.triangleArrayOffset;ce<Ae.triangleArrayOffset+Ae.triangleCount;ce++)o.emplaceBack(Le[3*ce],Le[3*ce+1],Le[3*ce+2]);$.primitiveLength+=Ae.triangleCount,z.x=Math.min(z.x,ve.x),z.y=Math.min(z.y,ve.y),H.x=Math.max(H.x,Fe.x),H.y=Math.max(H.y,Fe.y)}$.primitiveLength>0&&this.triangleSubSegments.push({segment:$,min:z,max:H}),I=F;for(let ee=I;ee<m&&t[ee].subtile===t[I].subtile;ee++)F++}f=m;for(let k=f;k<v&&t[k].triangleSegmentIdx===t[f].triangleSegmentIdx;k++)m++}o._trim(),this.indexArray=o}getVisibleSegments(t,o,h){const f=new Vs;if(this.wallMode){for(const ae of this.triangleSubSegments)f.segments.push(ae.segment);return f}let m=0,v=0;const C=1<<t.canonical.z;if(o){const ae=o.getMinMaxForTile(t);ae&&(m=ae.min,v=ae.max)}v+=this.maxHeight;const I=t.toUnwrapped();let F;const k=[I.canonical.x/C+I.wrap,I.canonical.y/C],z=[(I.canonical.x+1)/C+I.wrap,(I.canonical.y+1)/C],H=(ae,Ae,ve)=>[ae[0]*(1-ve[0])+Ae[0]*ve[0],ae[1]*(1-ve[1])+Ae[1]*ve[1]],$=[],ee=[];for(const ae of this.triangleSubSegments){$[0]=ae.min.x/wi,$[1]=ae.min.y/wi,ee[0]=ae.max.x/wi,ee[1]=ae.max.y/wi;const Ae=H(k,z,$),ve=H(k,z,ee);if(new Re([Ae[0],Ae[1],m],[ve[0],ve[1],v]).intersectsPrecise(h)===0){F&&(f.segments.push(F),F=void 0);continue}const Fe=ae.segment;F&&F.vertexOffset!==Fe.vertexOffset&&(f.segments.push(F),F=void 0),F?(F.vertexLength+=Fe.vertexLength,F.primitiveLength+=Fe.primitiveLength):F={vertexOffset:Fe.vertexOffset,primitiveLength:Fe.primitiveLength,vertexLength:Fe.vertexLength,primitiveOffset:Fe.primitiveOffset,sortKey:void 0,vaos:{}}}return F&&f.segments.push(F),f}encodeCentroid(t,o){const h=t.centroid(),f=o.span(),m=Math.min(7,Math.round(f.x*this.tileToMeter/10)),v=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new qt(Ge(h.x,1,wi-1)<<3|m,Ge(h.y,1,wi-1)<<3|v)}encodeBorderCentroid(t){if(!t.borders)return new qt(0,0);const o=t.borders,h=Number.MAX_VALUE;if(o[0][0]!==h||o[1][0]!==h){const f=o[0][0]!==h?0:1;return new qt(6|(o[0][0]!==h?0:65528),(o[f][0]+o[f][1])/2<<3|6)}{const f=o[2][0]!==h?2:3;return new qt((o[f][0]+o[f][1])/2<<3|6,6|(o[2][0]!==h?0:65528))}}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=ep,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,h=t.vertexCount+t.vertexArrayOffset,f=t.flags&ep?$w:t.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==f.y||m!==f.x){for(let v=o;v<h;++v)this.centroidVertexArray.emplace(v,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o,h){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(t.toUnwrapped());if(P_(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const m=[];for(const v of this.activeReplacements){if(v.order<h)continue;const C=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-t.canonical.z));for(const I of this.centroidData)if(!(I.flags&ep||v.min.x>I.max.x||I.min.x>v.max.x||v.min.y>I.max.y||I.min.y>v.max.y))for(let F=0;F<I.footprintSegLen;F++){const k=this.footprintSegments[I.footprintSegIdx+F];if(m.length=0,DF(this.footprintVertices,k.vertexOffset,k.vertexCount,v.footprintTileId.canonical,t.canonical,m),Ww(v.footprint,m,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-C)){I.flags|=ep;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,h){let f=!1;for(let m=0;m<h.footprintSegLen;m++){const v=this.footprintSegments[h.footprintSegIdx+m];let C=0;for(const I of v.ringIndices){for(let F=C,k=I+C-1;F<I+C;k=F++){const z=this.footprintVertices.int16[2*(F+v.vertexOffset)+0],H=this.footprintVertices.int16[2*(F+v.vertexOffset)+1],$=this.footprintVertices.int16[2*(k+v.vertexOffset)+1];H>o!=$>o&&t<(this.footprintVertices.int16[2*(k+v.vertexOffset)+0]-z)*(o-H)/($-H)+z&&(f=!f)}C=I}}return f}getHeightAtTileCoord(t,o){let h=Number.NEGATIVE_INFINITY,f=!0;const m=4*(t+wi)*wi+(o+wi);if(this.partLookup.hasOwnProperty(m)){const v=this.partLookup[m];return v?{height:v.height,hidden:!!(v.flags&ep)}:void 0}for(const v of this.centroidData)t>v.max.x||v.min.x>t||o>v.max.y||v.min.y>o||this.footprintContainsPoint(t,o,v)&&v&&v.height>h&&(h=v.height,this.partLookup[m]=v,f=!!(v.flags&ep));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:f};this.partLookup[m]=void 0}}function r2(l,t){const o=l.add(t)._unit();return l.x*o.x+l.y*o.y}function RF(l,t,o,h){const f=t.sub(l)._perp()._unit(),m=o.sub(t)._perp()._unit();return n2(l,t,o,r2(f,m),h)}function n2(l,t,o,h,f){const m=Math.sqrt(1-h*h);return Math.min(l.dist(t)/3,t.dist(o)/3,f*m/h)}function D_(l,t,o){return l.x<o[0].x&&t.x<o[0].x||l.x>o[1].x&&t.x>o[1].x||l.y<o[0].y&&t.y<o[0].y||l.y>o[1].y&&t.y>o[1].y}function s2(l,t){return l.x<t[0].x||l.x>t[1].x||l.y<t[0].y||l.y>t[1].y}function o2(l,t,o){if(l.x<0||l.x>=wi||t.x<0||t.x>=wi||o.x<0||o.x>=wi)return!1;const h=o.sub(t),f=h.perp(),m=l.sub(t);return(h.x*m.x+h.y*m.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(m.x*m.x+m.y*m.y))>-.866&&f.x*m.x+f.y*m.y<0}function a2(l,t,o){const h=t?2|l:-3&l;return o?1|h:-2&h}function l2(){const l=Math.PI/32,t=Math.tan(l),o=ge;return o*Math.sqrt(1+2*t*t)-o}function c2(l,t,o){const h=1<<o.z,f=dt(o.x/h),m=dt((o.x+1)/h),v=kt(o.y/h),C=kt((o.y+1)/h);return function(I,F,k,z,H=0,$){const ee=[];if(!I.length||!k||!z)return ee;const ae=(ke,He)=>{for(const gt of ke)ee.push({polygon:gt,bounds:He})},Ae=Math.ceil(Math.log2(k)),ve=Math.ceil(Math.log2(z)),Fe=Ae-ve,Le=[];for(let ke=0;ke<Math.abs(Fe);ke++)Le.push(Fe>0?0:1);for(let ke=0;ke<Math.min(Ae,ve);ke++)Le.push(0),Le.push(1);let ce=I;if(ce=l0(ce,F[0].y-H,F[1].y+H,1),ce=l0(ce,F[0].x-H,F[1].x+H,0),!ce.length)return ee;const Ee=[];for(Le.length?Ee.push({polygons:ce,bounds:F,depth:0}):ae(ce,F);Ee.length;){const ke=Ee.pop(),He=ke.depth,gt=Le[He],ht=ke.bounds[0],yt=ke.bounds[1],Lt=gt===0?ht.x:ht.y,Wt=gt===0?yt.x:yt.y,Si=$?$(gt,Lt,Wt):.5*(Lt+Wt),fi=l0(ke.polygons,Lt-H,Si+H,gt),Ci=l0(ke.polygons,Si-H,Wt+H,gt);if(fi.length){const Ii=[ht,new qt(gt===0?Si:yt.x,gt===1?Si:yt.y)];Le.length>He+1?Ee.push({polygons:fi,bounds:Ii,depth:He+1}):ae(fi,Ii)}if(Ci.length){const Ii=[new qt(gt===0?Si:ht.x,gt===1?Si:ht.y),yt];Le.length>He+1?Ee.push({polygons:Ci,bounds:Ii,depth:He+1}):ae(Ci,Ii)}}return ee}(l,t,Math.ceil((m-f)/11.25),Math.ceil((v-C)/11.25),1,(I,F,k)=>{if(I===0)return .5*(F+k);{const z=kt((o.y+F/wi)/h);return(Xe(.5*(kt((o.y+k/wi)/h)+z))*h-o.y)*wi}})}function DF(l,t,o,h,f,m){const v=Math.pow(2,h.z-f.z);for(let C=0;C<o;C++){let I=l.int16[2*(C+t)+0],F=l.int16[2*(C+t)+1];I=(I+f.x*wi)*v-h.x*wi,F=(F+f.y*wi)*v-h.y*wi,m.push(new qt(I,F))}}let u2,h2;Zi(d0,"FillExtrusionBucket",{omit:["layers","features"]}),Zi(Jw,"PartData"),Zi(Zw,"FootprintSegment"),Zi(e2,"BorderCentroidData"),Zi(i2,"GroundEffect");class Np extends qt{constructor(t,o,h){super(t,o),this.z=h}}class d2 extends Np{constructor(t,o,h,f){super(t,o,h),this.w=f}}function A2(l,t,o,h){const f=o==="x"?"y":"x",m=(h-l[o])/(t[o]-l[o]);l[f]=Math.round(l[f]+(t[f]-l[f])*m),l[o]=h,l.hasOwnProperty("z")&&(l.z=Er(l.z,t.z,m)),l.hasOwnProperty("w")&&(l.w=Er(l.w,t.w,m))}function f2(l,t,o,h){const f=o,m=h;for(const v of["x","y"]){let C=l,I=t;C[v]>=I[v]&&(C=t,I=l),C[v]<f&&I[v]>f&&A2(C,I,v,f),C[v]<m&&I[v]>m&&A2(I,C,v,m)}}function A0(l,t,o,h,f,m){const v=[];for(let C=0;C<l.length;C++){const I=l[C];let F;const k=v.length;let z=0;for(let H=0;H<I.length-1;H++){let $=I[H],ee=I[H+1],ae=0;const Ae=z;let ve,Fe;m&&(ae=Math.hypot(ee.x-$.x,ee.y-$.y),z+=ae,ve=$,Fe=ee),$.x<t&&ee.x<t||($.x<t?$=new qt(t,$.y+(t-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x<t&&(ee=new qt(t,$.y+(t-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y<o&&ee.y<o||($.y<o?$=new qt($.x+(o-$.y)/(ee.y-$.y)*(ee.x-$.x),o)._round():ee.y<o&&(ee=new qt($.x+(o-$.y)/(ee.y-$.y)*(ee.x-$.x),o)._round()),$.x>=h&&ee.x>=h||($.x>=h?$=new qt(h,$.y+(h-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x>=h&&(ee=new qt(h,$.y+(h-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y>=f&&ee.y>=f||($.y>=f?$=new qt($.x+(f-$.y)/(ee.y-$.y)*(ee.x-$.x),f)._round():ee.y>=f&&(ee=new qt($.x+(f-$.y)/(ee.y-$.y)*(ee.x-$.x),f)._round()),F&&$.equals(F[F.length-1])||(F=[$],v.push(F),m&&m.push({progress:{min:Ae+p2(ve,Fe,$)*ae,max:1},parentIndex:C,prevPoint:ve,nextPoint:Fe})),F.push(ee),m&&(m[m.length-1].progress.max=Ae+p2(ve,Fe,ee)*ae,m[m.length-1].nextPoint=Fe)))))}if(m&&z>0)for(let H=k;H<v.length;H++)m[H].progress.min/=z,m[H].progress.max/=z}return v}function OF(l,t,o,h,f){if(l.length<2)return void h.push(l);const m=[];for(;t.valid();){const[F,k]=t.get();for(let z=0;z<l.length-1;z++){const H=l[z],$=l[z+1],ee=Xs(H,$,F,k);if(ee){const[ae]=ee,Ae=new qt(Er(H.x,$.x,ae),Er(H.y,$.y,ae));m.push({t:z+ae,distance:0,point:Ae})}}t.next()}if(m.length===0)return void h.push(l);m.sort((F,k)=>F.t-k.t);let v=0,C=0,I=[];for(h.push(I);v!==l.length;){if(C===m.length){for(;v!==l.length;)I.length!==0&&I[I.length-1].equals(l[v])||I.push(l[v]),v++;break}m[C].t<=v?(I.length!==0&&I[I.length-1].equals(m[C].point)||I.push(m[C].point),Math.trunc(m[C].t),C++):(I.length!==0&&I[I.length-1].equals(l[v])||I.push(l[v]),v++)}}function p2(l,t,o){return l.x!==t.x?(o.x-l.x)/(t.x-l.x):l.y!==t.y?(o.y-l.y)/(t.y-l.y):0}function Em(l,t){return l.x*t.x+l.y*t.y}function g2(l,t){if(l.length===1){let o=0;const h=t[o++];let f;for(;!f||h.equals(f);)if(f=t[o++],!f)return 1/0;for(;o<t.length;o++){const m=t[o],v=l[0],C=f.sub(h),I=m.sub(h),F=v.sub(h),k=Em(C,C),z=Em(C,I),H=Em(I,I),$=Em(F,C),ee=Em(F,I),ae=k*H-z*z,Ae=(H*$-z*ee)/ae,ve=(k*ee-z*$)/ae,Fe=h.z*(1-Ae-ve)+f.z*Ae+m.z*ve;if(isFinite(Fe))return Fe}return 1/0}{let o=1/0;for(const h of t)o=Math.min(o,h.z);return o}}function m2(l,t,o,h,f,m,v,C){const I=v*f.getElevationAt(l,t,!0,!0),F=m[0]!==0,k=F?m[1]===0?v*(m[0]/7-450):v*function(z,H,$){const ee=Math.floor(H[0]/8),ae=Math.floor(H[1]/8),Ae=10*(H[0]-8*ee),ve=10*(H[1]-8*ae),Fe=z.getElevationAt(ee,ae,!0,!0),Le=z.getMeterToDEM($),ce=Math.floor(.5*(Ae*Le-1)),Ee=Math.floor(.5*(ve*Le-1)),ke=z.tileCoordToPixel(ee,ae),He=2*ce+1,gt=2*Ee+1,ht=function(Ci,Ii,$t,_i,Gt){return[Ci.getElevationAtPixel(Ii,$t,!0),Ci.getElevationAtPixel(Ii+Gt,$t,!0),Ci.getElevationAtPixel(Ii,$t+Gt,!0),Ci.getElevationAtPixel(Ii+_i,$t+Gt,!0)]}(z,ke.x-ce,ke.y-Ee,He,gt),yt=Math.abs(ht[0]-ht[1]),Lt=Math.abs(ht[2]-ht[3]),Wt=Math.abs(ht[0]-ht[2])+Math.abs(ht[1]-ht[3]),Si=Math.min(.25,.5*Le*(yt+Lt)/He),fi=Math.min(.25,.5*Le*Wt/gt);return Fe+Math.max(Si*Ae,fi*ve)}(f,m,C):I;return{base:I+(o===0?-1:o),top:F?Math.max(k+h,I+o+2):I+h}}class UF{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class zF{constructor(){this.tasks={},this.taskQueue=[],er(["process"],this),this.invoker=new UF(this.process),this.nextId=0}add(t,o){const h=this.nextId++,f=function({type:m,isSymbolTile:v,zoom:C}){return C=C||0,m==="message"?0:m!=="maybePrepare"||v?m!=="parseTile"||v?m==="parseTile"&&v?300-C:m==="maybePrepare"&&v?400-C:500:200-C:100-C}(o);if(f===0){try{t()}finally{}return null}return this.tasks[h]={fn:t,metadata:o,priority:f,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const m=this.tasks[this.taskQueue[f]];m.priority<o&&(o=m.priority,t=f)}if(t===null)return null;const h=this.taskQueue[t];return this.taskQueue.splice(t,1),h}remove(){this.invoker.remove()}}class y2{constructor(t,o,h){this.target=t,this.parent=o,this.mapId=h,this.callbacks={},this.cancelCallbacks={},er(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new zF}send(t,o,h,f,m=!1,v){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=v,this.callbacks[C]=h);const I=new Set;return this.target.postMessage({id:C,type:t,hasCallback:!!h,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:Kc(o,I)},I),{cancel:()=>{h&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(t){const o=t.data;if(!o)return;const h=o.id;if(h&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[h];delete this.cancelCallbacks[h],f&&f.cancel()}else if(o.mustQueue||Sn(self)){const f=this.callbacks[h],m=this.scheduler.add(()=>this.processTask(h,o),f&&f.metadata||{type:"message"});m&&(this.cancelCallbacks[h]=m)}else this.processTask(h,o)}processTask(t,o){if(delete this.cancelCallbacks[t],o.type==="<response>"){const h=this.callbacks[t];delete this.callbacks[t],h&&(o.error?h(Cu(o.error)):h(null,Cu(o.data)))}else{const h=new Set,f=o.hasCallback?(v,C)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:v?Kc(v):null,data:Kc(C,h)},h)}:()=>{},m=Cu(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,m,f);else if(this.parent.getWorkerSource){const v=o.type.split("."),{source:C,scope:I}=m;this.parent.getWorkerSource(o.sourceMapId,v[0],C,I)[v[1]](m,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Tm={workerUrl:"",workerClass:null,workerParams:void 0};const O_="mapboxgl_preloaded_worker_pool";class jp{constructor(){this.active={}}acquire(t,o=jp.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(Tm.workerClass!=null?new Tm.workerClass:new self.Worker(Tm.workerUrl,Tm.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[O_]}numActive(){return Object.keys(this.active).length}}jp.workerCount=2;class Cg{constructor(t,o,h="Worker",f=jp.workerCount){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Nt();const m=this.workerPool.acquire(this.id,f);for(let v=0;v<m.length;v++){const C=new Cg.Actor(m[v],o,this.id);C.name=`${h} ${v}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,o,h){_t(this.actors,(f,m)=>{f.send(t,o,m)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Im,U_;function f0(){return Im||(Im=new jp),Im}Cg.Actor=y2;class NF{constructor(t){this.module=t}createIntArray(t){const o=new Int32Array(t),h=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heap32.set(o,h/o.BYTES_PER_ELEMENT),h}createFloatArray(t){const o=new Float32Array(t),h=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heapF32.set(o,h/o.BYTES_PER_ELEMENT),h}createStringBuffer(t){const o=this.module.malloc(t.length+1);for(let h=0;h<t.length;++h)this.module.heapU8[o+h]=t.charCodeAt(h);return this.module.heapU8[o+t.length]=0,o}readStringBuffer(t){let o="";for(;this.module.heapU8[t]!==0;)o+=String.fromCharCode(this.module.heapU8[t]),++t;return o}setStyle(t){const o=t.entranceColorRgb,h=t.facadeGlazingColorRgb,f=t.roofColorRgb,m=t.wallColorRgb,v=t.normalScale;this.module.setStyle(o[0],o[1],o[2],h[0],h[1],h[2],f[0],f[1],f[2],m[0],m[1],m[2],v[0],v[1],v[2],t.tileToMeters)}setAOOptions(t,o){this.module.setAOOptions(t?1:0,o)}setMetricOptions(t,o){this.module.setMetricOptions(t?1:0,o)}setFacadeOptions(t,o,h){this.module.setFacadeOptions(t,o,h)}generateMesh(t,o){for(const C of t){const I=this.createStringBuffer(C.roofType),F=[0],k=[];for(const $ of C.coordinates)if(Array.isArray($)){for(const ee of $)k.push(ee.x),k.push(ee.y);F.push(k.length)}const z=this.createIntArray(F),H=this.createFloatArray(k);this.module.addFeature(C.id,C.sourceId,C.minHeight,C.height,I,C.roofType.length,H,z,F.length-1),this.module.free(I),this.module.free(z),this.module.free(H)}for(const C of o){let I;I=C.entrances?JSON.parse(C.entrances):[];const F=this.createFloatArray(I),k=[];for(const H of C.coordinates)k.push(H.x),k.push(H.y);const z=this.createFloatArray(k);this.module.addFacade(C.sourceId,C.crossPerc,C.distanceToRoad,F,I.length,z,k.length),this.module.free(F),this.module.free(z)}if(!this.module.generateMesh()){const C=this.module.getLastError();return this.readStringBuffer(C)}const h=this.module.getMeshCount(),f=new Array(h);for(let C=0;C<h;C++){const I=this.module.getPositionsPtr(C),F=this.module.getPositionsLength(C),k=new Float32Array(this.module.heapF32.buffer,I,F),z=this.module.getNormalsPtr(C),H=this.module.getNormalsLength(C),$=new Float32Array(this.module.heapF32.buffer,z,H),ee=this.module.getColorsPtr(C),ae=this.module.getColorsLength(C),Ae=new Uint8Array(this.module.heapU8.buffer,ee,ae),ve=this.module.getAOPtr(C),Fe=this.module.getAOLength(C),Le=new Float32Array(this.module.heapF32.buffer,ve,Fe),ce=this.module.getIndicesPtr(C),Ee=this.module.getIndicesLength(C),ke=new Int32Array(this.module.heap32.buffer,ce,Ee),He=this.module.getBuildingPart(C),gt=this.readStringBuffer(He);f[C]={positions:k,normals:$,colors:Ae,ao:Le,indices:ke,buildingPart:gt}}const m=this.module.getRingCount(),v=[];for(let C=0;C<m;C++){const I=this.module.getRingPtr(C),F=this.module.getRingLength(C),k=new Float32Array(this.module.heapF32.buffer,I,F);v.push(k)}return{meshes:f,modifiedPolygonRings:v}}}let Fm,z_,Dd,Sg,N_,Eg=null,Tg=null,v2=null,j_=null;function _2(){return Sn(self)&&self.worker.dracoUrl?self.worker.dracoUrl:z_||us.DRACO_URL}function x2(){if(Sn(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Sg)return Sg;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Sg=WebAssembly.validate(l)?us.MESHOPT_SIMD_URL:us.MESHOPT_URL,Sg}const p0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},jF={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Lm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function b2(l,t,o){const h=o.json.bufferViews.length,f=o.buffers.length;t.bufferView=h,o.json.bufferViews[h]={buffer:f,byteLength:l.byteLength},o.buffers[f]=l}const H_="KHR_draco_mesh_compression";function HF(l,t){const o=l.extensions&&l.extensions[H_];if(!o)return;const h=new Dd.Decoder,f=S2(t,o.bufferView),m=new Dd.Mesh;if(!h.DecodeArrayToMesh(f,f.byteLength,m))throw new Error("Failed to decode Draco mesh");const v=t.json.accessors[l.indices],C=p0[v.componentType],I=v.count*C.BYTES_PER_ELEMENT,F=Dd._malloc(I);C===Uint16Array?h.GetTrianglesUInt16Array(m,I,F):h.GetTrianglesUInt32Array(m,I,F),b2(Dd.memory.buffer.slice(F,F+I),v,t),Dd._free(F);for(const k of Object.keys(o.attributes)){const z=h.GetAttributeByUniqueId(m,o.attributes[k]),H=t.json.accessors[l.attributes[k]],$=jF[H.componentType],ee=H.count*Lm[H.type]*p0[H.componentType].BYTES_PER_ELEMENT,ae=Dd._malloc(ee);h.GetAttributeDataArrayForAllPoints(m,z,Dd[$],ee,ae),b2(Dd.memory.buffer.slice(ae,ae+ee),H,t),Dd._free(ae)}h.destroy(),m.destroy(),delete l.extensions[H_]}const g0="EXT_meshopt_compression";function QF(l,t){if(!l.extensions||!l.extensions[g0])return;const o=l.extensions[g0],h=new Uint8Array(t.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),f=new Uint8Array(o.count*o.byteStride);N_.decodeGltfBuffer(f,o.count,o.byteStride,h,o.mode,o.filter),l.buffer=t.buffers.length,l.byteOffset=0,t.buffers[l.buffer]=f.buffer,delete l.extensions[g0]}const w2=1179937895,B2=new TextDecoder("utf8");function C2(l,t){return new URL(l,t).href}function VF(l,t,o,h){return fetch(C2(l.uri,h)).then(f=>f.arrayBuffer()).then(f=>{t.buffers[o]=f})}function S2(l,t){const o=l.json.bufferViews[t];return new Uint8Array(l.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function GF(l,t,o,h){if(l.uri){const f=C2(l.uri,h);return fetch(f).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{t.images[o]=m})}if(l.bufferView!==void 0){const f=S2(t,l.bufferView),m=new Blob([f],{type:l.mimeType});return createImageBitmap(m).then(v=>{t.images[o]=v})}}function E2(l,t=0,o){const h={json:null,images:[],buffers:[]};if(new Uint32Array(l,t,1)[0]===w2){const k=new Uint32Array(l,t);let z=2;const H=(k[z++]>>2)-3,$=k[z++]>>2;if(z++,h.json=JSON.parse(B2.decode(k.subarray(z,z+$))),z+=$,z<H){const ee=k[z++];z++;const ae=t+(z<<2);h.buffers[0]=l.slice(ae,ae+ee)}}else h.json=JSON.parse(B2.decode(new Uint8Array(l,t)));const{buffers:f,images:m,meshes:v,extensionsUsed:C,bufferViews:I}=h.json;let F=Promise.resolve();if(f){const k=[];for(let z=0;z<f.length;z++){const H=f[z];H.uri?k.push(VF(H,h,z,o)):h.buffers[z]||(h.buffers[z]=null)}F=Promise.all(k)}return F.then(()=>{const k=[],z=C&&C.includes(H_),H=C&&C.includes(g0);if(z&&k.push(function(){if(!Dd)return Fm??(Fm=function($){let ee,ae=null;function Ae(){ee=new Uint8Array(ae.buffer)}function ve(){throw new Error("Unexpected Draco error.")}const Fe={a:{a:ve,d:function(Le,ce,Ee){return ee.copyWithin(Le,ce,ce+Ee)},c:function(Le){const ce=ee.length,Ee=Math.max(Le>>>0,Math.ceil(1.2*ce)),ke=Math.ceil((Ee-ce)/65536);try{return ae.grow(ke),Ae(),!0}catch{return!1}},b:ve}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming($,Fe):$.then(Le=>Le.arrayBuffer()).then(Le=>WebAssembly.instantiate(Le,Fe))).then(Le=>{const{Rb:ce,Qb:Ee,P:ke,T:He,X:gt,Ja:ht,La:yt,Qa:Lt,Va:Wt,Wa:Si,eb:fi,jb:Ci,f:Ii,e:$t,yb:_i,zb:Gt,Ab:Yt,Bb:ki,Db:Di,Gb:xr}=Le.instance.exports;ae=$t;const cr=(()=>{let Xi=0,Pi=0,$r=0,or=0;return Ar=>{$r&&(ce(or),ce(Xi),Pi+=$r,$r=Xi=0),Xi||(Pi+=128,Xi=Ee(Pi));const Nr=Ar.length+7&-8;let an=Xi;Nr>=Pi&&($r=Nr,an=or=Ee(Nr));for(let on=0;on<Ar.length;on++)ee[an+on]=Ar[on];return an}})();return Ae(),Ii(),{memory:$t,_free:ce,_malloc:Ee,Mesh:class{constructor(){this.ptr=ke()}destroy(){He(this.ptr)}},Decoder:class{constructor(){this.ptr=ht()}destroy(){Ci(this.ptr)}DecodeArrayToMesh(Xi,Pi,$r){const or=cr(Xi),Ar=yt(this.ptr,or,Pi,$r.ptr);return!!gt(Ar)}GetAttributeByUniqueId(Xi,Pi){return{ptr:Lt(this.ptr,Xi.ptr,Pi)}}GetTrianglesUInt16Array(Xi,Pi,$r){Wt(this.ptr,Xi.ptr,Pi,$r)}GetTrianglesUInt32Array(Xi,Pi,$r){Si(this.ptr,Xi.ptr,Pi,$r)}GetAttributeDataArrayForAllPoints(Xi,Pi,$r,or,Ar){fi(this.ptr,Xi.ptr,Pi.ptr,$r,or,Ar)}},DT_INT8:_i(),DT_UINT8:Gt(),DT_INT16:Yt(),DT_UINT16:ki(),DT_UINT32:Di(),DT_FLOAT32:xr()}})}(fetch(_2())),Fm.then($=>{Dd=$,Fm=void 0}))}()),H&&k.push(function(){if(N_)return;const $=function(ee){let ae;const Ae=WebAssembly.instantiateStreaming(ee,{}).then(Le=>{ae=Le.instance,ae.exports.__wasm_call_ctors()}),ve={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Fe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Ae,supported:!0,decodeGltfBuffer(Le,ce,Ee,ke,He,gt){(function(ht,yt,Lt,Wt,Si,fi,Ci){const Ii=ht.exports.sbrk,$t=Wt+3&-4,_i=Ii($t*Si),Gt=Ii(fi.length),Yt=new Uint8Array(ht.exports.memory.buffer);Yt.set(fi,Gt);const ki=yt(_i,Wt,Si,Gt,fi.length);if(ki===0&&Ci&&Ci(_i,$t,Si),Lt.set(Yt.subarray(_i,_i+Wt*Si)),Ii(_i-Ii(0)),ki!==0)throw new Error(`Malformed buffer data: ${ki}`)})(ae,ae.exports[Fe[He]],Le,ce,Ee,ke,ae.exports[ve[gt]])}}}(fetch(x2()));return $.ready.then(()=>{N_=$})}()),m)for(let $=0;$<m.length;$++)k.push(GF(m[$],h,$,o));return(k.length?Promise.all(k):Promise.resolve()).then(()=>{if(z&&v)for(const{primitives:$}of v)for(const ee of $)HF(ee,h);if(H&&v&&I)for(const $ of I)QF($,h);return h})})}class T2{constructor(t){this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.hasPattern=!1,this.worldview=t.worldview}updateFootprints(t,o){}prepare(){return function(){if(j_!=null||v2!=null)return null;if(Tg!=null)return Tg;const t=fetch(us.BUILDING_GEN_URL);return Tg=function(o){let h,f,m,v;function C(){h=new Uint8Array(v.buffer),f=new Int32Array(v.buffer),m=new Float32Array(v.buffer)}function I(){throw new Error("Unexpected BuildingGen error.")}const F=()=>{},k={a:{a:I,f:function(z){const H=h.length,$=Math.max(z>>>0,Math.ceil(1.2*H)),ee=Math.ceil(($-H)/65536);try{return v.grow(ee),C(),!0}catch{return!1}},g:I,b:F,c:F,d:F,e:F}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,k):o.then(z=>z.arrayBuffer()).then(z=>WebAssembly.instantiate(z,k))).then(z=>{const H=z.instance.exports;return(0,H.g)(),v=H.f,C(),new NF({setStyle:H.h,setAOOptions:H.i,setMetricOptions:H.j,setFacadeOptions:H.k,addFeature:H.l,addFacade:H.m,generateMesh:H.n,getLastError:H.o,getMeshCount:H.p,getPositionsPtr:H.q,getPositionsLength:H.r,getNormalsPtr:H.s,getNormalsLength:H.t,getColorsPtr:H.u,getColorsLength:H.v,getAOPtr:H.w,getAOLength:H.x,getIndicesPtr:H.y,getIndicesLength:H.z,getBuildingPart:H.A,getRingCount:H.B,getRingPtr:H.C,getRingLength:H.D,free:H.E,malloc:H.F,heapU8:h,heap32:f,heapF32:m})})}(t).then(o=>(Tg=null,j_=o,j_)).catch(o=>{Yr("Could not load building-gen"),Tg=null,v2=o}),Tg}()}populate(t,o,h,f){}update(t,o,h,f,m,v,C){}isEmpty(){return!1}uploadPending(){return!1}upload(t){}destroy(){}getHeightAtTileCoord(t,o){return{height:Number.NEGATIVE_INFINITY,hidden:!0}}}let I2,F2;Zi(T2,"BuildingBucket",{omit:["layers"]});const WF=Rn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),XF=Rn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:YF}=WF,KF=Rn([{name:"a_packed",components:3,type:"Float32"}]),{members:qF}=KF,$F=Rn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:ZF}=$F;class L2{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new Jf({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const h=this.getKey(t,o);return this.positions[h]}trim(){const t=this.width,o=this.height=Fi(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,h){const f=[];let m=t.length%2==1?-t[t.length-1]*h:0,v=t[0]*h,C=!0;f.push({left:m,right:v,isDash:C,zeroLength:t[0]===0});let I=t[0];for(let F=1;F<t.length;F++){C=!C;const k=t[F];m=I*h,I+=k,v=I*h,f.push({left:m,right:v,isDash:C,zeroLength:k===0})}return f}addRoundDash(t,o,h){const f=o/2;for(let m=-h;m<=h;m++){const v=this.width*(this.nextRow+h+m);let C=0,I=t[C];for(let F=0;F<this.width;F++){F/I.right>1&&(I=t[++C]);const k=Math.abs(F-I.left),z=Math.abs(F-I.right),H=Math.min(k,z);let $;const ee=m/h*(f+1);if(I.isDash){const ae=f-Math.abs(ee);$=Math.sqrt(H*H+ae*ae)}else $=f-Math.sqrt(H*H+ee*ee);this.image.data[v+F]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(t,o){for(let I=t.length-1;I>=0;--I){const F=t[I],k=t[I+1];F.zeroLength?t.splice(I,1):k&&k.isDash===F.isDash&&(k.left=F.left,t.splice(I,1))}const h=t[0],f=t[t.length-1];h.isDash===f.isDash&&(h.left=f.left-this.width,f.right=h.right+this.width);const m=this.width*this.nextRow;let v=0,C=t[v];for(let I=0;I<this.width;I++){I/C.right>1&&(C=t[++v]);const F=Math.abs(I-C.left),k=Math.abs(I-C.right),z=Math.min(F,k);this.image.data[m+I]=Math.max(0,Math.min(255,(C.isDash?z:-z)+o+128))}}addDash(t,o){const h=this.getKey(t,o);if(this.positions[h])return this.positions[h];const f=o==="round",m=f?7:0,v=2*m+1;if(this.nextRow+v>this.height)return Yr("LineAtlas out of space"),null;t.length===0&&t.push(1);let C=0;for(let k=0;k<t.length;k++)t[k]<0&&(Yr("Negative value is found in line dasharray, replacing values with 0"),t[k]=0),C+=t[k];if(C!==0){const k=this.width/C,z=this.getDashRanges(t,this.width,k);f?this.addRoundDash(z,k,m):this.addRegularDash(z,o==="square"?.5*k:0)}const I=this.nextRow+m;this.nextRow+=v;const F={tl:[I,m],br:[C,0]};return this.positions[h]=F,F}}Zi(L2,"LineAtlas");const JF=ln.VectorTileFeature.types,eL=Math.cos(Math.PI/180*37.5),tL=Math.cos(Math.PI/180*5);class Q_{constructor(t){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=t.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=t.overscaling,this.pixelRatio=t.pixelRatio,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new xA,this.layoutVertexArray2=new Ku,this.patternVertexArray=new Ku,this.indexArray=new Zo,this.programConfigurations=new p(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new Vs,this.maxLineLength=0,this.zOffsetVertexArray=new Ku,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=t.tessellationStep?t.tessellationStep:wi/64,this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,h,f){this.hasPattern=S_("line",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Vt(h);const v=this.layers[0].layout.get("line-elevation-reference");if(v==="hd-road-markup")this.elevationType="road";else{const H=this.layers[0].layout.get("line-z-offset"),$=H.isConstant()&&!H.constantOr(0);this.elevationType=v!=="sea"&&v!=="ground"&&$?"none":"offset",this.elevationType==="offset"&&v==="none"&&Yr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const C=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&C!==void 0;const I=[];for(const{feature:H,id:$,index:ee,sourceLayerIndex:ae}of t){const Ae=this.layers[0]._featureFilter.needGeometry,ve=Ki(H,Ae);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),ve,h))continue;const Fe=m?m.evaluate(ve,{},h):void 0,Le={id:$,properties:H.properties,type:H.type,sourceLayerIndex:ae,index:ee,geometry:Ae?ve.geometry:tr(H,h,f),patterns:{},sortKey:Fe};I.push(Le)}m&&I.sort((H,$)=>H.sortKey-$.sortKey);const{lineAtlas:F,featureIndex:k}=o,z=this.addConstantDashes(F);for(const H of I){const{geometry:$,index:ee,sourceLayerIndex:ae}=H;if(z&&this.addFeatureDashes(H,F),this.hasPattern){const Ae=E_("line",this.layers,H,this.zoom,this.pixelRatio,o);this.patternFeatures.push(Ae)}else this.addFeature(H,$,ee,h,F.positions,o.availableImages,o.brightness,o.elevationFeatures);k.insert(t[ee].feature,$,ee,ae,this.index)}}addConstantDashes(t){let o=!1;for(const h of this.layers){const f=h.paint.get("line-dasharray").value,m=h.layout.get("line-cap").value;if(f.kind!=="constant"||m.kind!=="constant")o=!0;else{const v=m.value,C=f.value;if(!C)continue;t.addDash(C,v)}}return o}addFeatureDashes(t,o){const h=this.zoom;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(m.kind==="constant"&&v.kind==="constant")continue;let C,I;if(m.kind==="constant"){if(C=m.value,!C)continue}else C=m.evaluate({zoom:h},t);I=v.kind==="constant"?v.value:v.evaluate({zoom:h},t),o.addDash(C,I),t.patterns[f.id]=[o.getKey(C,I)]}}update(t,o,h,f,m,v,C,I){this.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,I)}addFeatures(t,o,h,f,m,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,h,f,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,qF)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,ZF)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,XF.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,YF),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,h,f,m,v,C,I){const F=this.layers[0].layout,k=F.get("line-join").evaluate(t,{}),z=F.get("line-cap").evaluate(t,{}),H=F.get("line-miter-limit"),$=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(t),this.lineFeature=t,this.zOffsetValue=F.get("line-z-offset").value;const ee=this.layers[0].paint.get("line-width").value;if(ee.kind!=="constant"&&ee.isLineProgressConstant===!1&&(this.variableWidthValue=ee),this.elevationType==="road"){const ae=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(t,o,f,I,k,z,H,$)){const[Ae,ve]=this.clipRuntimeLinesToTile(o,1);for(let Fe=0;Fe<Ae.length;Fe++){const Le=Ae[Fe],ce=ve[Fe],Ee={progress:{min:ce.progress.min,max:ce.progress.max},nextDir:this.computeSegNextDir(ce,Le),prevDir:this.computeSegPrevDir(ce,Le)};this.addLine(Le,t,f,k,z,H,$,Ee)}this.fillNonElevatedRoadSegment(ae)}}else for(const ae of o)this.addLine(ae,t,f,k,z,H,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,m,v,f,C,void 0,this.worldview)}computeSegNextDir(t,o){return t.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(t,o){return o[1].sub(t.prevPoint).unit()}clipLinesToTile(t,o){return A0(t,-o,-o,wi+o,wi+o)}clipRuntimeLinesToTile(t,o){const h=[];return[A0(t,-o,-o,wi+o,wi+o,h),h]}addElevatedRoadFeature(t,o,h,f,m,v,C,I){const F=[],k=Ht.getElevationFeature(t,f);if(k){const z=this.clipLinesToTile(o,1),H=this.prepareElevatedLines(z,k,h);for(const $ of H)F.push({geometry:$,elevation:k,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(F.length===0)return!1;for(const z of F){const H=this.layoutVertexArray.length;this.addLine(z.geometry,t,h,m,v,C,I);const $=new si(h,z.elevationTileID);if(z.elevation)for(let ee=H;ee<this.layoutVertexArray.length;ee++){const ae=new qt(this.layoutVertexArray.int16[6*ee]>>1,this.layoutVertexArray.int16[6*ee+1]>>1),Ae=$.pointElevation(ae,z.elevation,.05);this.updateHeightRange(Ae),this.zOffsetVertexArray.emplaceBack(Ae,0,0)}else this.fillNonElevatedRoadSegment(H)}return!0}prepareElevatedLines(t,o,h){if(o.constantHeight!=null)return t;const f=[],m=1/Vt(h);for(const v of t)OF(v,new ft(o,m),0,f);return f}fillNonElevatedRoadSegment(t){for(let o=t;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(t){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,t),this.heightRange.max=Math.max(this.heightRange.max,t)):this.heightRange={min:t,max:t}}addLine(t,o,h,f,m,v,C,I){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const F=f==="none";this.patternJoinNone=this.hasPattern&&F,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const k=I&&I.progress.min>0,z=I&&I.progress.max<1;if(this.lineClips){let gt={min:this.lineClips.start,max:this.lineClips.end},ht=1;if(I){const Wt=this.lineClips.end-this.lineClips.start;gt=function(Si,fi,Ci){return{min:fc(Si.min,fi,Ci),max:fc(Si.max,fi,Ci)}}(I.progress,{min:0,max:1},gt),Wt>0&&(ht=(gt.max-gt.min)/Wt)}const yt=+o.properties.mapbox_clip_feature_len,Lt=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(yt)||Number.isNaN(Lt)){for(let Si=0;Si<t.length-1;Si++)this.totalDistance+=t[Si].dist(t[Si+1]);const Wt=this.totalDistance/(gt.max-gt.min);this.totalFeatureLength=Number.isFinite(Wt)?Wt:0,this.lineClips.start=gt.min,this.lineClips.end=gt.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=yt,this.distance=Lt*ht,this.lineClips.start=gt.min,this.lineClips.end=gt.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const H=JF[o.type]==="Polygon";let $=t.length;for(;$>=2&&t[$-1].equals(t[$-2]);)$--;let ee=0;for(;ee<$-1&&t[ee].equals(t[ee+1]);)ee++;if($<(H?3:2))return;f==="bevel"&&(v=1.05);const ae=this.segments.prepareSegment(10*$,this.layoutVertexArray,this.indexArray);let Ae,ve,Fe,Le,ce,Ee,ke,He;I&&I.prevDir&&(Ee=I.prevDir.perp()),I&&I.nextDir&&(ke=I.nextDir.perp()),this.e1=this.e2=-1,H&&(Ae=t[$-2],ce=t[ee].sub(Ae)._unit()._perp());for(let gt=ee;gt<$;gt++){if(Fe=gt===$-1?H?t[ee+1]:void 0:t[gt+1],Fe&&t[gt].equals(Fe))continue;ce&&(Le=ce),Ae&&(ve=Ae),Ae=t[gt],He=this.evaluateLineProgressFeatures(ve?ve.dist(Ae):0),ce=Fe?Fe.sub(Ae)._unit()._perp():Le,Le=Le||ce;const ht=ve&&Fe;let yt=ht?f:H||F?"butt":m;const Lt=Le.x*ce.x+Le.y*ce.y;if(F){const Gt=function(Yt){if(Yt.patternJoinNone){const ki=Yt.segmentPoints.length/2,Di=Yt.lineSoFar-Yt.segmentStart;for(let xr=0;xr<ki;++xr){const cr=Yt.segmentPoints[2*xr+1],Xi=Math.round(Yt.segmentPoints[2*xr])+.5+.25*cr;Yt.patternVertexArray.emplaceBack(Xi,Di,Yt.segmentStart),Yt.patternVertexArray.emplaceBack(Xi,Di,Yt.segmentStart)}Yt.segmentPoints.length=0}Yt.e1=Yt.e2=-1};if(ht&&Lt<tL){this.updateDistance(ve,Ae),this.addCurrentVertex(Ae,Le,1,1,ae,He),Gt(this),this.addCurrentVertex(Ae,ce,-1,-1,ae,He);continue}if(ve){if(!Fe){this.updateDistance(ve,Ae),this.addCurrentVertex(Ae,Le,1,1,ae,He),Gt(this);continue}yt="miter"}}let Wt=Le.add(ce);Wt.x===0&&Wt.y===0||Wt._unit();const Si=Wt.x*ce.x+Wt.y*ce.y,fi=Si!==0?1/Si:1/0,Ci=2*Math.sqrt(2-2*Si),Ii=Si<eL&&ve&&Fe,$t=Le.x*ce.y-Le.y*ce.x>0,_i=this.overscaling<=16?15*wi/(512*this.overscaling):0;if(ht&&yt==="round"){if(fi<C)yt="miter";else if(fi<=2){const Gt=V_(Ae,-10,wi+10);yt=this.elevationType==="offset"&&(Gt||this.hasCrossSlope)?"miter":"fakeround"}}if(yt==="miter"&&fi>v&&(yt="bevel"),yt==="bevel"&&(fi>2&&(yt="flipbevel"),fi<v&&(yt="miter")),ve&&!(yt==="miter"&&Ii)&&this.updateDistance(ve,Ae),yt==="miter")if(Ii){const Gt=Ae.dist(ve);if(Gt>2*_i){const ki=Ae.sub(Ae.sub(ve)._mult(_i/Gt)._round());this.updateDistance(ve,ki),this.addCurrentVertex(ki,Le,0,0,ae,He),ve=ki}this.updateDistance(ve,Ae),Wt._mult(fi),this.addCurrentVertex(Ae,Wt,0,0,ae,He);const Yt=Ae.dist(Fe);if(Yt>2*_i){const ki=Ae.add(Fe.sub(Ae)._mult(_i/Yt)._round());this.updateDistance(Ae,ki),this.addCurrentVertex(ki,ce,0,0,ae,He),Ae=ki}}else Wt._mult(fi),this.addCurrentVertex(Ae,Wt,0,0,ae,He);else if(yt==="flipbevel"){if(fi>100)Wt=ce.mult(-1);else{const Gt=fi*Le.add(ce).mag()/Le.sub(ce).mag();Wt._perp()._mult(Gt*($t?-1:1))}this.addCurrentVertex(Ae,Wt,0,0,ae,He),this.addCurrentVertex(Ae,Wt.mult(-1),0,0,ae,He)}else if(yt==="bevel"||yt==="fakeround"){He!=null&&ve&&this.addCurrentVertex(Ae,ke||Le,-1,-1,ae,He);const Gt=Ae.dist(ve)<=2*_i&&yt!=="bevel",Yt=Wt.mult($t?1:-1);Yt._mult(fi);const ki=ce.mult($t?-1:1),Di=Le.mult($t?-1:1),xr=this.evaluateLineProgressFeatures(this.distance);if(He==null&&(this.addHalfVertex(Ae,Yt.x,Yt.y,!1,!$t,0,ae,xr),Gt||this.addHalfVertex(Ae,Yt.x+2*Di.x,Yt.y+2*Di.y,!1,$t,0,ae,xr)),yt==="fakeround"){const cr=Math.round(180*Ci/Math.PI/20);this.addHalfVertex(Ae,Di.x,Di.y,!1,$t,0,ae,xr);for(let Xi=0;Xi<cr;Xi++){let Pi=Xi/cr;if(Pi!==.5){const or=Pi-.5;Pi+=Pi*or*(Pi-1)*((1.0904+Lt*(Lt*(3.55645-1.43519*Lt)-3.2452))*or*or+(.848013+Lt*(.215638*Lt-1.06021)))}const $r=ki.sub(Di)._mult(Pi)._add(Di)._unit();this.addHalfVertex(Ae,$r.x,$r.y,!1,$t,0,ae,xr)}this.addHalfVertex(Ae,ki.x,ki.y,!1,$t,0,ae,xr)}Gt||He!=null||this.addHalfVertex(Ae,Yt.x+2*ki.x,Yt.y+2*ki.y,!1,$t,0,ae,xr),He!=null&&Fe&&this.addCurrentVertex(Ae,Ee||ce,1,1,ae,He)}else if(yt==="butt")this.addCurrentVertex(Ae,Wt,0,0,ae,He);else if(yt==="square"){if(!ve){const Gt=k?0:-1;this.addCurrentVertex(Ae,Wt,Gt,Gt,ae,He)}if(this.addCurrentVertex(Ae,Wt,0,0,ae,He),ve){const Gt=z?0:1;this.addCurrentVertex(Ae,Wt,Gt,Gt,ae,He)}}else if(yt==="round"){if(ve){const Gt=!ht&&ke?ke:Le;this.addCurrentVertex(Ae,Gt,0,0,ae,He),!ht&&z||this.addCurrentVertex(Ae,Gt,1,1,ae,He,!0)}if(Fe){const Gt=!ht&&Ee?Ee:ce;!ht&&k||this.addCurrentVertex(Ae,Gt,-1,-1,ae,He,!0),this.addCurrentVertex(Ae,Gt,0,0,ae,He)}}}}addVerticesTo(t,o,h,f,m,v,C,I,F,k){const z=(o.w-t.w)/this.tessellationStep|0;let H=0;const $=this.scaledDistance;if(z>1){this.lineSoFar=t.w;const ae=(o.x-t.x)/z,Ae=(o.y-t.y)/z,ve=(o.z-t.z)/z,Fe=(o.w-t.w)/z;for(let Le=1;Le<z;++Le){t.x+=ae,t.y+=Ae,t.z+=ve,this.lineSoFar+=Fe,H+=Fe;const ce=this.evaluateLineProgressFeatures(this.prevDistance+H);this.scaledDistance=(this.prevDistance+H)/this.totalDistance,this.addHalfVertex(t,h,f,k,!1,C,F,ce),this.addHalfVertex(t,m,v,k,!0,-I,F,ce)}}this.lineSoFar=o.w,this.scaledDistance=$;const ee=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,h,f,k,!1,C,F,ee),this.addHalfVertex(o,m,v,k,!0,-I,F,ee)}evaluateLineProgressFeatures(t){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+t)/this.totalFeatureLength):Yr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(t,o,h,f,m,v,C=!1){const I=o.x+o.y*h,F=o.y-o.x*h,k=o.y*f-o.x,z=-o.y-o.x*f;if(v!=null){const H=this.elevationType==="offset",$=-10,ee=wi+10,ae=v.zOffset,Ae=new d2(t.x,t.y,ae,this.lineSoFar),ve=!!H&&V_(t,$,ee),Fe=this.lineSoFar,Le=this.distance;if(this.currentVertex)if(ve){const ce=this.currentVertexIsOutside,Ee=this.currentVertex,ke=new d2(t.x,t.y,ae,this.lineSoFar);if(f2(Ee,ke,$,ee),!V_(ke,$,ee)){if(ce){this.e1=this.e2=-1,this.distance-=Ee.dist(Ae),this.lineSoFar=Ee.w;const He=this.evaluateLineProgressFeatures(Ee.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ee,I,F,C,!1,h,m,He),this.addHalfVertex(Ee,k,z,C,!0,-f,m,He),this.prevDistance=this.distance}this.distance=this.prevDistance+Ee.dist(ke),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ee,ke,I,F,k,z,h,f,m,C),this.distance=Le,this.scaledDistance=this.distance/this.totalDistance}}else{const ce=this.currentVertex;if(this.currentVertexIsOutside){f2(ce,Ae,$,ee),this.e1=this.e2=-1,this.distance-=ce.dist(Ae),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ce.w;const Ee=this.evaluateLineProgressFeatures(ce.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ce,I,F,C,!1,h,m,Ee),this.addHalfVertex(ce,k,z,C,!0,-f,m,Ee),this.prevDistance=this.distance,this.distance=Le,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ce,Ae,I,F,k,z,h,f,m,C)}else ve||(this.addHalfVertex(t,I,F,C,!1,h,m,v),this.addHalfVertex(t,k,z,C,!0,-f,m,v));this.currentVertex=Ae,this.currentVertexIsOutside=ve,this.lineSoFar=Fe}else this.addHalfVertex(t,I,F,C,!1,h,m,v),this.addHalfVertex(t,k,z,C,!0,-f,m,v)}addHalfVertex({x:t,y:o},h,f,m,v,C,I,F){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,C)),this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(o<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*f)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const z=Er(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,z)}const k=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),I.primitiveLength++),v?this.e2=k:this.e1=k,F!=null&&this.zOffsetVertexArray.emplaceBack(F.zOffset,F.variableWidth,F.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(t,o){this.prevDistance=this.distance,this.distance+=t.dist(o),this.updateScaledDistance()}}function V_(l,t,o){return l.x<t||l.x>o||l.y<t||l.y>o}let M2,P2;function k2(l,t,o){return t*(wi/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}Zi(Q_,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const R2=(l,t,o)=>(1-o)*l+o*t;function D2(l,t){return 1/k2(l,1,t.tileZoom)}function O2(l,t,o,h){return l.translatePosMatrix(h||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const U2=l=>{const t=[];z2(l)&&t.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=l.paint.get("line-trim-offset");o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const h=l.layout.get("line-join").constantOr("miter")==="none",f=!!l.paint.get("line-pattern").constantOr(1);return h&&f&&t.push("LINE_JOIN_NONE"),t};function z2(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}let G_;const N2=()=>G_||(G_={layout:M2||(M2=new Us({"line-cap":new Gi(Ft.layout_line["line-cap"]),"line-join":new Gi(Ft.layout_line["line-join"]),"line-miter-limit":new Ei(Ft.layout_line["line-miter-limit"]),"line-round-limit":new Ei(Ft.layout_line["line-round-limit"]),"line-sort-key":new Gi(Ft.layout_line["line-sort-key"]),"line-z-offset":new Gi(Ft.layout_line["line-z-offset"]),"line-elevation-reference":new Ei(Ft.layout_line["line-elevation-reference"]),"line-cross-slope":new Ei(Ft.layout_line["line-cross-slope"]),visibility:new Ei(Ft.layout_line.visibility),"line-width-unit":new Ei(Ft.layout_line["line-width-unit"])})),paint:P2||(P2=new Us({"line-opacity":new Gi(Ft.paint_line["line-opacity"]),"line-color":new Gi(Ft.paint_line["line-color"]),"line-translate":new Ei(Ft.paint_line["line-translate"]),"line-translate-anchor":new Ei(Ft.paint_line["line-translate-anchor"]),"line-width":new Gi(Ft.paint_line["line-width"]),"line-gap-width":new Gi(Ft.paint_line["line-gap-width"]),"line-offset":new Gi(Ft.paint_line["line-offset"]),"line-blur":new Gi(Ft.paint_line["line-blur"]),"line-dasharray":new Gi(Ft.paint_line["line-dasharray"]),"line-pattern":new Gi(Ft.paint_line["line-pattern"]),"line-pattern-cross-fade":new Ei(Ft.paint_line["line-pattern-cross-fade"]),"line-gradient":new Gu(Ft.paint_line["line-gradient"]),"line-trim-offset":new Ei(Ft.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ei(Ft.paint_line["line-trim-fade-range"]),"line-trim-color":new Ei(Ft.paint_line["line-trim-color"]),"line-emissive-strength":new Ei(Ft.paint_line["line-emissive-strength"]),"line-border-width":new Gi(Ft.paint_line["line-border-width"]),"line-border-color":new Gi(Ft.paint_line["line-border-color"]),"line-occlusion-opacity":new Ei(Ft.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},G_);class iL extends Gi{possiblyEvaluate(t,o){return o=new Xn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition,worldview:o.worldview}),super.possiblyEvaluate(t,o)}evaluate(t,o,h,f){return o=Ot({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,h,f)}}let Mm;function j2(l,t){return t>0?t+2*l:l}const rL=Rn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nL=Rn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),sL=Rn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Rn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oL=Rn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),aL=Rn([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),lL=Rn([{name:"a_texb",components:2,type:"Uint16"}]),cL=Rn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),uL=Rn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Rn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const H2=Rn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hL=Rn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Rn([{name:"triangle",components:3,type:"Uint16"}]),Rn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Rn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Rn([{type:"Float32",name:"offsetX"}]),Rn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var il=24;function dL(l,t,o){return l.sections.forEach(h=>{h.text=function(f,m,v){const C=m.layout.get("text-transform").evaluate(v,{});return C==="uppercase"?f=f.toLocaleUpperCase():C==="lowercase"&&(f=f.toLocaleLowerCase()),qc.applyArabicShaping&&(f=qc.applyArabicShaping(f)),f}(h.text,t,o)}),l}const Pm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function AL(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function fL(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var Q2,W_,V2,X_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function pL(){return Q2||(Q2=1,X_.read=function(l,t,o,h,f){var m,v,C=8*f-h-1,I=(1<<C)-1,F=I>>1,k=-7,z=o?f-1:0,H=o?-1:1,$=l[t+z];for(z+=H,m=$&(1<<-k)-1,$>>=-k,k+=C;k>0;m=256*m+l[t+z],z+=H,k-=8);for(v=m&(1<<-k)-1,m>>=-k,k+=h;k>0;v=256*v+l[t+z],z+=H,k-=8);if(m===0)m=1-F;else{if(m===I)return v?NaN:1/0*($?-1:1);v+=Math.pow(2,h),m-=F}return($?-1:1)*v*Math.pow(2,m-h)},X_.write=function(l,t,o,h,f,m){var v,C,I,F=8*m-f-1,k=(1<<F)-1,z=k>>1,H=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=h?0:m-1,ee=h?1:-1,ae=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(C=isNaN(t)?1:0,v=k):(v=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-v))<1&&(v--,I*=2),(t+=v+z>=1?H/I:H*Math.pow(2,1-z))*I>=2&&(v++,I/=2),v+z>=k?(C=0,v=k):v+z>=1?(C=(t*I-1)*Math.pow(2,f),v+=z):(C=t*Math.pow(2,z-1)*Math.pow(2,f),v=0));f>=8;l[o+$]=255&C,$+=ee,C/=256,f-=8);for(v=v<<f|C,F+=f;F>0;l[o+$]=255&v,$+=ee,v/=256,F-=8);l[o+$-ee]|=128*ae}),X_}function G2(){if(V2)return W_;V2=1,W_=t;var l=pL();function t(ce){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ce)?ce:new Uint8Array(ce||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var o=4294967296,h=1/o,f=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ce){return ce.type===t.Bytes?ce.readVarint()+ce.pos:ce.pos+1}function v(ce,Ee,ke){return ke?4294967296*Ee+(ce>>>0):4294967296*(Ee>>>0)+(ce>>>0)}function C(ce,Ee,ke){var He=Ee<=16383?1:Ee<=2097151?2:Ee<=268435455?3:Math.floor(Math.log(Ee)/(7*Math.LN2));ke.realloc(He);for(var gt=ke.pos-1;gt>=ce;gt--)ke.buf[gt+He]=ke.buf[gt]}function I(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeVarint(ce[ke])}function F(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeSVarint(ce[ke])}function k(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeFloat(ce[ke])}function z(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeDouble(ce[ke])}function H(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeBoolean(ce[ke])}function $(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeFixed32(ce[ke])}function ee(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeSFixed32(ce[ke])}function ae(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeFixed64(ce[ke])}function Ae(ce,Ee){for(var ke=0;ke<ce.length;ke++)Ee.writeSFixed64(ce[ke])}function ve(ce,Ee){return(ce[Ee]|ce[Ee+1]<<8|ce[Ee+2]<<16)+16777216*ce[Ee+3]}function Fe(ce,Ee,ke){ce[ke]=Ee,ce[ke+1]=Ee>>>8,ce[ke+2]=Ee>>>16,ce[ke+3]=Ee>>>24}function Le(ce,Ee){return(ce[Ee]|ce[Ee+1]<<8|ce[Ee+2]<<16)+(ce[Ee+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(ce,Ee,ke){for(ke=ke||this.length;this.pos<ke;){var He=this.readVarint(),gt=He>>3,ht=this.pos;this.type=7&He,ce(gt,Ee,this),this.pos===ht&&this.skip(He)}return Ee},readMessage:function(ce,Ee){return this.readFields(ce,Ee,this.readVarint()+this.pos)},readFixed32:function(){var ce=ve(this.buf,this.pos);return this.pos+=4,ce},readSFixed32:function(){var ce=Le(this.buf,this.pos);return this.pos+=4,ce},readFixed64:function(){var ce=ve(this.buf,this.pos)+ve(this.buf,this.pos+4)*o;return this.pos+=8,ce},readSFixed64:function(){var ce=ve(this.buf,this.pos)+Le(this.buf,this.pos+4)*o;return this.pos+=8,ce},readFloat:function(){var ce=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ce},readDouble:function(){var ce=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ce},readVarint:function(ce){var Ee,ke,He=this.buf;return Ee=127&(ke=He[this.pos++]),ke<128?Ee:(Ee|=(127&(ke=He[this.pos++]))<<7,ke<128?Ee:(Ee|=(127&(ke=He[this.pos++]))<<14,ke<128?Ee:(Ee|=(127&(ke=He[this.pos++]))<<21,ke<128?Ee:function(gt,ht,yt){var Lt,Wt,Si=yt.buf;if(Lt=(112&(Wt=Si[yt.pos++]))>>4,Wt<128||(Lt|=(127&(Wt=Si[yt.pos++]))<<3,Wt<128)||(Lt|=(127&(Wt=Si[yt.pos++]))<<10,Wt<128)||(Lt|=(127&(Wt=Si[yt.pos++]))<<17,Wt<128)||(Lt|=(127&(Wt=Si[yt.pos++]))<<24,Wt<128)||(Lt|=(1&(Wt=Si[yt.pos++]))<<31,Wt<128))return v(gt,Lt,ht);throw new Error("Expected varint not more than 10 bytes")}(Ee|=(15&(ke=He[this.pos]))<<28,ce,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ce=this.readVarint();return ce%2==1?(ce+1)/-2:ce/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ce=this.readVarint()+this.pos,Ee=this.pos;return this.pos=ce,ce-Ee>=12&&f?function(ke,He,gt){return f.decode(ke.subarray(He,gt))}(this.buf,Ee,ce):function(ke,He,gt){for(var ht="",yt=He;yt<gt;){var Lt,Wt,Si,fi=ke[yt],Ci=null,Ii=fi>239?4:fi>223?3:fi>191?2:1;if(yt+Ii>gt)break;Ii===1?fi<128&&(Ci=fi):Ii===2?(192&(Lt=ke[yt+1]))==128&&(Ci=(31&fi)<<6|63&Lt)<=127&&(Ci=null):Ii===3?(Wt=ke[yt+2],(192&(Lt=ke[yt+1]))==128&&(192&Wt)==128&&((Ci=(15&fi)<<12|(63&Lt)<<6|63&Wt)<=2047||Ci>=55296&&Ci<=57343)&&(Ci=null)):Ii===4&&(Wt=ke[yt+2],Si=ke[yt+3],(192&(Lt=ke[yt+1]))==128&&(192&Wt)==128&&(192&Si)==128&&((Ci=(15&fi)<<18|(63&Lt)<<12|(63&Wt)<<6|63&Si)<=65535||Ci>=1114112)&&(Ci=null)),Ci===null?(Ci=65533,Ii=1):Ci>65535&&(Ci-=65536,ht+=String.fromCharCode(Ci>>>10&1023|55296),Ci=56320|1023&Ci),ht+=String.fromCharCode(Ci),yt+=Ii}return ht}(this.buf,Ee,ce)},readBytes:function(){var ce=this.readVarint()+this.pos,Ee=this.buf.subarray(this.pos,ce);return this.pos=ce,Ee},readPackedVarint:function(ce,Ee){if(this.type!==t.Bytes)return ce.push(this.readVarint(Ee));var ke=m(this);for(ce=ce||[];this.pos<ke;)ce.push(this.readVarint(Ee));return ce},readPackedSVarint:function(ce){if(this.type!==t.Bytes)return ce.push(this.readSVarint());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readSVarint());return ce},readPackedBoolean:function(ce){if(this.type!==t.Bytes)return ce.push(this.readBoolean());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readBoolean());return ce},readPackedFloat:function(ce){if(this.type!==t.Bytes)return ce.push(this.readFloat());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readFloat());return ce},readPackedDouble:function(ce){if(this.type!==t.Bytes)return ce.push(this.readDouble());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readDouble());return ce},readPackedFixed32:function(ce){if(this.type!==t.Bytes)return ce.push(this.readFixed32());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readFixed32());return ce},readPackedSFixed32:function(ce){if(this.type!==t.Bytes)return ce.push(this.readSFixed32());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readSFixed32());return ce},readPackedFixed64:function(ce){if(this.type!==t.Bytes)return ce.push(this.readFixed64());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readFixed64());return ce},readPackedSFixed64:function(ce){if(this.type!==t.Bytes)return ce.push(this.readSFixed64());var Ee=m(this);for(ce=ce||[];this.pos<Ee;)ce.push(this.readSFixed64());return ce},skip:function(ce){var Ee=7&ce;if(Ee===t.Varint)for(;this.buf[this.pos++]>127;);else if(Ee===t.Bytes)this.pos=this.readVarint()+this.pos;else if(Ee===t.Fixed32)this.pos+=4;else{if(Ee!==t.Fixed64)throw new Error("Unimplemented type: "+Ee);this.pos+=8}},writeTag:function(ce,Ee){this.writeVarint(ce<<3|Ee)},realloc:function(ce){for(var Ee=this.length||16;Ee<this.pos+ce;)Ee*=2;if(Ee!==this.length){var ke=new Uint8Array(Ee);ke.set(this.buf),this.buf=ke,this.length=Ee}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ce){this.realloc(4),Fe(this.buf,ce,this.pos),this.pos+=4},writeSFixed32:function(ce){this.realloc(4),Fe(this.buf,ce,this.pos),this.pos+=4},writeFixed64:function(ce){this.realloc(8),Fe(this.buf,-1&ce,this.pos),Fe(this.buf,Math.floor(ce*h),this.pos+4),this.pos+=8},writeSFixed64:function(ce){this.realloc(8),Fe(this.buf,-1&ce,this.pos),Fe(this.buf,Math.floor(ce*h),this.pos+4),this.pos+=8},writeVarint:function(ce){(ce=+ce||0)>268435455||ce<0?function(Ee,ke){var He,gt;if(Ee>=0?(He=Ee%4294967296|0,gt=Ee/4294967296|0):(gt=~(-Ee/4294967296),4294967295^(He=~(-Ee%4294967296))?He=He+1|0:(He=0,gt=gt+1|0)),Ee>=18446744073709552e3||Ee<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ke.realloc(10),function(ht,yt,Lt){Lt.buf[Lt.pos++]=127&ht|128,ht>>>=7,Lt.buf[Lt.pos++]=127&ht|128,ht>>>=7,Lt.buf[Lt.pos++]=127&ht|128,ht>>>=7,Lt.buf[Lt.pos++]=127&ht|128,Lt.buf[Lt.pos]=127&(ht>>>=7)}(He,0,ke),function(ht,yt){var Lt=(7&ht)<<4;yt.buf[yt.pos++]|=Lt|((ht>>>=3)?128:0),ht&&(yt.buf[yt.pos++]=127&ht|((ht>>>=7)?128:0),ht&&(yt.buf[yt.pos++]=127&ht|((ht>>>=7)?128:0),ht&&(yt.buf[yt.pos++]=127&ht|((ht>>>=7)?128:0),ht&&(yt.buf[yt.pos++]=127&ht|((ht>>>=7)?128:0),ht&&(yt.buf[yt.pos++]=127&ht)))))}(gt,ke)}(ce,this):(this.realloc(4),this.buf[this.pos++]=127&ce|(ce>127?128:0),ce<=127||(this.buf[this.pos++]=127&(ce>>>=7)|(ce>127?128:0),ce<=127||(this.buf[this.pos++]=127&(ce>>>=7)|(ce>127?128:0),ce<=127||(this.buf[this.pos++]=ce>>>7&127))))},writeSVarint:function(ce){this.writeVarint(ce<0?2*-ce-1:2*ce)},writeBoolean:function(ce){this.writeVarint(!!ce)},writeString:function(ce){ce=String(ce),this.realloc(4*ce.length),this.pos++;var Ee=this.pos;this.pos=function(He,gt,ht){for(var yt,Lt,Wt=0;Wt<gt.length;Wt++){if((yt=gt.charCodeAt(Wt))>55295&&yt<57344){if(!Lt){yt>56319||Wt+1===gt.length?(He[ht++]=239,He[ht++]=191,He[ht++]=189):Lt=yt;continue}if(yt<56320){He[ht++]=239,He[ht++]=191,He[ht++]=189,Lt=yt;continue}yt=Lt-55296<<10|yt-56320|65536,Lt=null}else Lt&&(He[ht++]=239,He[ht++]=191,He[ht++]=189,Lt=null);yt<128?He[ht++]=yt:(yt<2048?He[ht++]=yt>>6|192:(yt<65536?He[ht++]=yt>>12|224:(He[ht++]=yt>>18|240,He[ht++]=yt>>12&63|128),He[ht++]=yt>>6&63|128),He[ht++]=63&yt|128)}return ht}(this.buf,ce,this.pos);var ke=this.pos-Ee;ke>=128&&C(Ee,ke,this),this.pos=Ee-1,this.writeVarint(ke),this.pos+=ke},writeFloat:function(ce){this.realloc(4),l.write(this.buf,ce,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ce){this.realloc(8),l.write(this.buf,ce,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ce){var Ee=ce.length;this.writeVarint(Ee),this.realloc(Ee);for(var ke=0;ke<Ee;ke++)this.buf[this.pos++]=ce[ke]},writeRawMessage:function(ce,Ee){this.pos++;var ke=this.pos;ce(Ee,this);var He=this.pos-ke;He>=128&&C(ke,He,this),this.pos=ke-1,this.writeVarint(He),this.pos+=He},writeMessage:function(ce,Ee,ke){this.writeTag(ce,t.Bytes),this.writeRawMessage(Ee,ke)},writePackedVarint:function(ce,Ee){Ee.length&&this.writeMessage(ce,I,Ee)},writePackedSVarint:function(ce,Ee){Ee.length&&this.writeMessage(ce,F,Ee)},writePackedBoolean:function(ce,Ee){Ee.length&&this.writeMessage(ce,H,Ee)},writePackedFloat:function(ce,Ee){Ee.length&&this.writeMessage(ce,k,Ee)},writePackedDouble:function(ce,Ee){Ee.length&&this.writeMessage(ce,z,Ee)},writePackedFixed32:function(ce,Ee){Ee.length&&this.writeMessage(ce,$,Ee)},writePackedSFixed32:function(ce,Ee){Ee.length&&this.writeMessage(ce,ee,Ee)},writePackedFixed64:function(ce,Ee){Ee.length&&this.writeMessage(ce,ae,Ee)},writePackedSFixed64:function(ce,Ee){Ee.length&&this.writeMessage(ce,Ae,Ee)},writeBytesField:function(ce,Ee){this.writeTag(ce,t.Bytes),this.writeBytes(Ee)},writeFixed32Field:function(ce,Ee){this.writeTag(ce,t.Fixed32),this.writeFixed32(Ee)},writeSFixed32Field:function(ce,Ee){this.writeTag(ce,t.Fixed32),this.writeSFixed32(Ee)},writeFixed64Field:function(ce,Ee){this.writeTag(ce,t.Fixed64),this.writeFixed64(Ee)},writeSFixed64Field:function(ce,Ee){this.writeTag(ce,t.Fixed64),this.writeSFixed64(Ee)},writeVarintField:function(ce,Ee){this.writeTag(ce,t.Varint),this.writeVarint(Ee)},writeSVarintField:function(ce,Ee){this.writeTag(ce,t.Varint),this.writeSVarint(Ee)},writeStringField:function(ce,Ee){this.writeTag(ce,t.Bytes),this.writeString(Ee)},writeFloatField:function(ce,Ee){this.writeTag(ce,t.Fixed32),this.writeFloat(Ee)},writeDoubleField:function(ce,Ee){this.writeTag(ce,t.Fixed64),this.writeDouble(Ee)},writeBooleanField:function(ce,Ee){this.writeVarintField(ce,!!Ee)}},W_}var m0=ta(G2());const Y_=3;function gL(l,t,o){t.glyphs=[],l===1&&o.readMessage(mL,t)}function mL(l,t,o){if(l===3){const{id:h,bitmap:f,width:m,height:v,left:C,top:I,advance:F}=o.readMessage(yL,{});t.glyphs.push({id:h,bitmap:new Jf({width:m+2*Y_,height:v+2*Y_},f),metrics:{width:m,height:v,left:C,top:I,advance:F}})}else l===4?t.ascender=o.readSVarint():l===5&&(t.descender=o.readSVarint())}function yL(l,t,o){l===1?t.id=o.readVarint():l===2?t.bitmap=o.readBytes():l===3?t.width=o.readVarint():l===4?t.height=o.readVarint():l===5?t.left=o.readSVarint():l===6?t.top=o.readSVarint():l===7&&(t.advance=o.readVarint())}const vL=Y_,Fu={horizontal:1,vertical:2,horizontalOnly:3};class km{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(t,o){const h=new km;return h.scale=t||1,h.fontStack=o,h}static forImage(t){const o=new km;return o.image=t,o}}class Ig{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o,h){const f=new Ig;for(let m=0;m<t.sections.length;m++){const v=t.sections[m];v.image?f.addImageSection(v,h):f.addTextSection(v,o)}return f}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(o,h){let f="";for(let m=0;m<o.length;m++){const v=o.charCodeAt(m+1)||null,C=o.charCodeAt(m-1)||null;f+=!h&&(v&&bh(v)&&!Pm[o[m+1]]||C&&bh(C)&&!Pm[o[m-1]])||!Pm[o[m]]?o[m]:Pm[o[m]]}return f}(this.text,t)}trim(){let t=0;for(let h=0;h<this.text.length&&y0[this.text.charCodeAt(h)];h++)t++;let o=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&y0[this.text.charCodeAt(h)];h--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const h=new Ig;return h.text=this.text.substring(t,o),h.sectionIndex=this.sectionIndex.slice(t,o),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(km.forText(t.scale,t.fontStack||o));const h=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(h)}addImageSection(t,o){const h=t.image?t.image.getPrimary():null;if(!h)return void Yr("Can't add FormattedSection with an empty image.");h.scaleSelf(o);const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(km.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Yr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function K_(l,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae=1){const Ae=Ig.fromFeature(l,f,ae);z===Fu.vertical&&Ae.verticalizePunctuation(H);let ve=[];const Fe=function(He,gt,ht,yt,Lt,Wt){if(!He)return[];const Si=[],fi=function(_i,Gt,Yt,ki,Di,xr){let cr=0;for(let Xi=0;Xi<_i.length();Xi++){const Pi=_i.getSection(Xi);cr+=W2(_i.getCodePoint(Xi),Pi,ki,Di,Gt,xr)}return cr/Math.max(1,Math.ceil(cr/Yt))}(He,gt,ht,yt,Lt,Wt),Ci=He.text.indexOf("")>=0;let Ii=0;for(let _i=0;_i<He.length();_i++){const Gt=He.getSection(_i),Yt=He.getCodePoint(_i);if(y0[Yt]||(Ii+=W2(Yt,Gt,yt,Lt,gt,Wt)),_i<He.length()-1){const ki=!(($t=Yt)<11904||!(Br["Bopomofo Extended"]($t)||Br.Bopomofo($t)||Br["CJK Compatibility Forms"]($t)||Br["CJK Compatibility Ideographs"]($t)||Br["CJK Compatibility"]($t)||Br["CJK Radicals Supplement"]($t)||Br["CJK Strokes"]($t)||Br["CJK Symbols and Punctuation"]($t)||Br["CJK Unified Ideographs Extension A"]($t)||Br["CJK Unified Ideographs"]($t)||Br["Enclosed CJK Letters and Months"]($t)||Br["Halfwidth and Fullwidth Forms"]($t)||Br.Hiragana($t)||Br["Ideographic Description Characters"]($t)||Br["Kangxi Radicals"]($t)||Br["Katakana Phonetic Extensions"]($t)||Br.Katakana($t)||Br["Vertical Forms"]($t)||Br["Yi Radicals"]($t)||Br["Yi Syllables"]($t)));(_L[Yt]||ki||Gt.image)&&Si.push(Y2(_i+1,Ii,fi,Si,xL(Yt,He.getCodePoint(_i+1),ki&&Ci),!1))}}var $t;return K2(Y2(He.length(),Ii,fi,Si,0,!0))}(Ae,F,m,t,h,$),{processBidirectionalText:Le,processStyledBidirectionalText:ce}=qc;if(Le&&Ae.sections.length===1){const He=Le(Ae.toString(),Fe);for(const gt of He){const ht=new Ig;ht.text=gt,ht.sections=Ae.sections;for(let yt=0;yt<gt.length;yt++)ht.sectionIndex.push(0);ve.push(ht)}}else if(ce){const He=ce(Ae.text,Ae.sectionIndex,Fe);for(const gt of He){const ht=new Ig;ht.text=gt[0],ht.sectionIndex=gt[1],ht.sections=Ae.sections,ve.push(ht)}}else ve=function(He,gt){const ht=[],yt=He.text;let Lt=0;for(const Wt of gt)ht.push(He.substring(Lt,Wt)),Lt=Wt;return Lt<yt.length&&ht.push(He.substring(Lt,yt.length)),ht}(Ae,Fe);const Ee=[],ke={positionedLines:Ee,text:Ae.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(He,gt,ht,yt,Lt,Wt,Si,fi,Ci,Ii,$t,_i){let Gt=0,Yt=0,ki=0;const Di=fi==="right"?1:fi==="left"?0:.5;let xr=!1;for(const Ar of Lt){const Nr=Ar.getSections();for(const an of Nr){if(an.image)continue;const on=gt[an.fontStack];if(on&&(xr=on.ascender!==void 0&&on.descender!==void 0,!xr))break}if(!xr)break}let cr=0;for(const Ar of Lt){Ar.trim();const Nr=Ar.getMaxScale(),an=(Nr-1)*il,on={positionedGlyphs:[],lineOffset:0};He.positionedLines[cr]=on;const vn=on.positionedGlyphs;let un=0;if(!Ar.length()){Yt+=Wt,++cr;continue}let _n=0,ns=0;for(let ze=0;ze<Ar.length();ze++){const Ve=Ar.getSection(ze),Jt=Ar.getSectionIndex(ze),zi=Ar.getCodePoint(ze);let Yi=Ve.scale,Wi=null,sr=null,Or=null,wn=il,Bn=0;Ci===Fu.vertical&&((Xi=zi)===12312||Xi===12313||Xi===12316||Xi===12540||Xi===12448)&&(Ci=Fu.horizontal);const hn=!(Ci===Fu.horizontal||!$t&&!Ql(zi)||$t&&(y0[zi]||Yh(zi)));if(Ve.image){const ls=yt.get(Ve.image.toString());if(!ls)continue;Or=Ve.image,He.iconsInText=He.iconsInText||!0,sr=ls.paddedRect;const Rs=ls.displaySize;Yi=Yi*il/_i,Wi={width:Rs[0],height:Rs[1],left:0,top:-3,advance:hn?Rs[1]:Rs[0],localGlyph:!1},Bn=xr?-Wi.height*Yi:Nr*il-17-Rs[1]*Yi,wn=Wi.advance;const Cn=(hn?Rs[0]:Rs[1])*Yi-il*Nr;Cn>0&&Cn>un&&(un=Cn)}else{const ls=ht[Ve.fontStack];if(!ls)continue;ls[zi]&&(sr=ls[zi]);const Rs=gt[Ve.fontStack];if(!Rs)continue;const Cn=Rs.glyphs[zi];if(!Cn)continue;if(Wi=Cn.metrics,wn=zi!==8203?il:0,xr){const so=Rs.ascender!==void 0?Math.abs(Rs.ascender):0,Ns=Rs.descender!==void 0?Math.abs(Rs.descender):0,ss=(so+Ns)*Yi;_n<ss&&(_n=ss,ns=(so-Ns)/2*Yi),Bn=-so*Yi}else Bn=(Nr-Yi)*il-17}hn?(He.verticalizable=!0,vn.push({glyph:zi,image:Or,x:Gt,y:Yt+Bn,vertical:hn,scale:Yi,localGlyph:Wi.localGlyph,fontStack:Ve.fontStack,sectionIndex:Jt,metrics:Wi,rect:sr}),Gt+=wn*Yi+Ii):(vn.push({glyph:zi,image:Or,x:Gt,y:Yt+Bn,vertical:hn,scale:Yi,localGlyph:Wi.localGlyph,fontStack:Ve.fontStack,sectionIndex:Jt,metrics:Wi,rect:sr}),Gt+=Wi.advance*Yi+Ii)}vn.length!==0&&(ki=Math.max(Gt-Ii,ki),xr?q2(vn,Di,un,ns,Wt*Nr/2):q2(vn,Di,un,0,Wt/2)),Gt=0;const zs=Wt*Nr+un;on.lineOffset=Math.max(un,an),Yt+=zs,++cr}var Xi;const Pi=Yt,{horizontalAlign:$r,verticalAlign:or}=q_(Si);(function(Ar,Nr,an,on,vn,un){const _n=(Nr-an)*vn,ns=-un*on;for(const zs of Ar)for(const ze of zs.positionedGlyphs)ze.x+=_n,ze.y+=ns})(He.positionedLines,Di,$r,or,ki,Pi),He.top+=-or*Pi,He.bottom=He.top+Pi,He.left+=-$r*ki,He.right=He.left+ki,He.hasBaseline=xr}(ke,t,o,h,ve,v,C,I,z,F,H,ee),!function(He){for(const gt of He)if(gt.positionedGlyphs.length!==0)return!1;return!0}(Ee))return ke}const y0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_L={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function W2(l,t,o,h,f,m){if(t.image){const v=h.get(t.image.toString());return v?v.displaySize[0]*t.scale*il/m+f:0}{const v=o[t.fontStack],C=v&&v.glyphs[l];return C?C.metrics.advance*t.scale+f:0}}function X2(l,t,o,h){const f=Math.pow(l-t,2);return h?l<t?f/2:2*f:f+Math.abs(o)*o}function xL(l,t,o){let h=0;return l===10&&(h-=1e4),o&&(h+=150),l!==40&&l!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function Y2(l,t,o,h,f,m){let v=null,C=X2(t,o,f,m);for(const I of h){const F=X2(t-I.x,o,f,m)+I.badness;F<=C&&(v=I,C=F)}return{index:l,x:t,priorBreak:v,badness:C}}function K2(l){return l?K2(l.priorBreak).concat(l.index):[]}function q_(l){let t=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function q2(l,t,o,h,f){if(!(t||o||h||f))return;const m=l.length-1,v=l[m],C=(v.x+v.metrics.advance*v.scale)*t;for(let I=0;I<=m;I++)l[I].x-=C,l[I].y+=o+h+f}function $2(l){return l.imagePrimary!==void 0&&l.top!==void 0&&l.bottom!==void 0&&l.left!==void 0&&l.right!==void 0}function bL(l,t,o,h){const{horizontalAlign:f,verticalAlign:m}=q_(h),v=o[0]-l.displaySize[0]*f,C=o[1]-l.displaySize[1]*m;return{imagePrimary:l,imageSecondary:t,top:C,bottom:C+l.displaySize[1],left:v,right:v+l.displaySize[0]}}function Z2(l,t,o,h,f,m){const v=l.imagePrimary;let C;if(v.content){const Ae=v.content,ve=v.pixelRatio||1;C=[Ae[0]/ve,Ae[1]/ve,v.displaySize[0]-Ae[2]/ve,v.displaySize[1]-Ae[3]/ve]}const I=t.left*m,F=t.right*m;let k,z,H,$;o==="width"||o==="both"?($=f[0]+I-h[3],z=f[0]+F+h[1]):($=f[0]+(I+F-v.displaySize[0])/2,z=$+v.displaySize[0]);const ee=t.top*m,ae=t.bottom*m;return o==="height"||o==="both"?(k=f[1]+ee-h[0],H=f[1]+ae+h[2]):(k=f[1]+(ee+ae-v.displaySize[1])/2,H=k+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:k,right:z,bottom:H,left:$,collisionPadding:C}}function J2(l){return!l.imagePrimary.stretchX}function eB(l){return!l.imagePrimary.stretchY}function tB(l){return{width:l.right-l.left,height:l.bottom-l.top}}const PA=128;function iB(l,t,o){const{expression:h}=t;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Xn(l+1,{worldview:o}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=h;let v=0;for(;v<f.length&&f[v]<=l;)v++;v=Math.max(0,v-1);let C=v;for(;C<f.length&&f[C]<l+1;)C++;C=Math.min(f.length-1,C);const I=f[v],F=f[C];return h.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:F,interpolationType:m}:{kind:"camera",minZoom:I,maxZoom:F,minSize:h.evaluate(new Xn(I,{worldview:o})),maxSize:h.evaluate(new Xn(F,{worldview:o})),interpolationType:m}}}function $_(l,{uSize:t,uSizeT:o},{lowerSize:h,upperSize:f}){return l.kind==="source"?h/PA:l.kind==="composite"?Er(h/PA,f/PA,o):t}function Rm(l,t,o=1){let h=0,f=0;if(l.kind==="constant")f=l.layoutSize*o;else if(l.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:C}=l,I=m?Ge(Hl.interpolationFactor(m,t,v,C),0,1):0;l.kind==="camera"?f=Er(l.minSize,l.maxSize,I)*o:h=I*o}return{uSizeT:h,uSize:f}}class ff extends qt{constructor(t,o,h,f,m){super(t,o),this.angle=f,this.z=h,m!==void 0&&(this.segment=m)}clone(){return new ff(this.x,this.y,this.z,this.angle,this.segment)}}function rB(l,t,o,h,f){if(t.segment===void 0)return!0;let m=t,v=t.segment+1,C=0;for(;C>-o/2;){if(v--,v<0)return!1;C-=l[v].dist(m),m=l[v]}C+=l[v].dist(l[v+1]),v++;const I=[];let F=0;for(;C<o/2;){const k=l[v],z=l[v+1];if(!z)return!1;let H=l[v-1].angleTo(k)-k.angleTo(z);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:H}),F+=H;C-I[0].distance>h;)F-=I.shift().angleDelta;if(F>f)return!1;v++,C+=k.dist(z)}return!0}function nB(l){let t=0;for(let o=0;o<l.length-1;o++)t+=l[o].dist(l[o+1]);return t}function sB(l,t,o){return l?.6*t*o:0}function oB(l,t){return Math.max(l?l.right-l.left:0,t?t.right-t.left:0)}function wL(l,t,o,h,f,m){const v=sB(o,f,m),C=oB(o,h)*m;let I=0;const F=nB(l)/2;for(let k=0;k<l.length-1;k++){const z=l[k],H=l[k+1],$=z.dist(H);if(I+$>F){const ee=(F-I)/$,ae=Er(z.x,H.x,ee),Ae=Er(z.y,H.y,ee),ve=new ff(ae,Ae,0,H.angleTo(z),k);return!v||rB(l,ve,C,v,t)?ve:void 0}I+=$}}function BL(l,t,o,h,f,m,v,C,I){const F=sB(h,m,v),k=oB(h,f),z=k*v,H=l[0].x===0||l[0].x===I||l[0].y===0||l[0].y===I;return t-z<t/4&&(t=z+t/4),aB(l,H?t/2*C%t:(k/2+2*m)*v*C%t,t,F,o,z,H,!1,I)}function aB(l,t,o,h,f,m,v,C,I){const F=m/2,k=nB(l);let z=0,H=t-o,$=[];for(let ee=0;ee<l.length-1;ee++){const ae=l[ee],Ae=l[ee+1],ve=ae.dist(Ae),Fe=Ae.angleTo(ae);for(;H+o<z+ve;){H+=o;const Le=(H-z)/ve,ce=Er(ae.x,Ae.x,Le),Ee=Er(ae.y,Ae.y,Le);if(ce>=0&&ce<I&&Ee>=0&&Ee<I&&H-F>=0&&H+F<=k){const ke=new ff(ce,Ee,0,Fe,ee);h&&!rB(l,ke,m,h,f)||$.push(ke)}}z+=ve}return C||$.length||v||($=aB(l,z/2,o,h,f,m,v,!0,I)),$}function lB(l){let t=0,o=0;for(const v of l)t+=v.w*v.h,o=Math.max(o,v.w);l.sort((v,C)=>C.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let f=0,m=0;for(const v of l)for(let C=h.length-1;C>=0;C--){const I=h[C];if(!(v.w>I.w||v.h>I.h)){if(v.x=I.x,v.y=I.y,m=Math.max(m,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===I.w&&v.h===I.h){const F=h.pop();C<h.length&&(h[C]=F)}else v.h===I.h?(I.x+=v.w,I.w-=v.w):v.w===I.w?(I.y+=v.h,I.h-=v.h):(h.push({x:I.x+v.w,y:I.y,w:I.w-v.w,h:v.h}),I.y+=v.h,I.h-=v.h);break}}return{w:f,h:m,fill:t/(f*m)||0}}Zi(ff,"Anchor");const Hp=1;class Dm{static getImagePositionScale(t,o,h){if(o&&t&&t.options&&t.options.transform){const f=t.options.transform;return{x:f.a,y:f.d}}return{x:h,y:h}}constructor(t,o,h,f){this.paddedRect=t;const{pixelRatio:m,version:v,stretchX:C,stretchY:I,content:F,sdf:k,usvg:z}=o;this.pixelRatio=m,this.stretchX=C,this.stretchY=I,this.content=F,this.version=v,this.padding=h,this.sdf=k,this.usvg=z,this.scale=Dm.getImagePositionScale(f,z,m)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function Z_(l,t,o){const h=xn.parse(l),f=function(m,v,C=[1,1]){return{x:0,y:0,w:(m.data?m.data.width:m.width*C[0])+2*v,h:(m.data?m.data.height:m.height*C[1])+2*v}}(t,o,[h.options.transform.a,h.options.transform.d]);return{bin:f,imagePosition:new Dm(f,t,o,h),imageVariant:h}}class cB{constructor(t,o,h){const f=new Map,m=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(t,f,Hp,v),this.addImages(o,m,2,v);const{w:C,h:I}=lB(v),F=new Il({width:C||1,height:I||1});for(const[k,z]of t.entries()){const H=f.get(k).paddedRect;Il.copy(z.data,F,{x:0,y:0},{x:H.x+Hp,y:H.y+Hp},z.data,h,z.sdf)}for(const[k,z]of o.entries()){const H=m.get(k),$=H.paddedRect;let ee=H.padding;const ae=$.x+ee,Ae=$.y+ee,ve=z.data.width,Fe=z.data.height;ee=ee>1?ee-1:ee,Il.copy(z.data,F,{x:0,y:0},{x:ae,y:Ae},z.data,h),Il.copy(z.data,F,{x:0,y:Fe-ee},{x:ae,y:Ae-ee},{width:ve,height:ee},h),Il.copy(z.data,F,{x:0,y:0},{x:ae,y:Ae+Fe},{width:ve,height:ee},h),Il.copy(z.data,F,{x:ve-ee,y:0},{x:ae-ee,y:Ae},{width:ee,height:Fe},h),Il.copy(z.data,F,{x:0,y:0},{x:ae+ve,y:Ae},{width:ee,height:Fe},h),Il.copy(z.data,F,{x:ve-ee,y:Fe-ee},{x:ae-ee,y:Ae-ee},{width:ee,height:ee},h),Il.copy(z.data,F,{x:0,y:Fe-ee},{x:ae+ve,y:Ae-ee},{width:ee,height:ee},h),Il.copy(z.data,F,{x:0,y:0},{x:ae+ve,y:Ae+Fe},{width:ee,height:ee},h),Il.copy(z.data,F,{x:ve-ee,y:0},{x:ae-ee,y:Ae+Fe},{width:ee,height:ee},h)}this.lut=h,this.image=F,this.iconPositions=f,this.patternPositions=m}addImages(t,o,h,f){for(const[m,v]of t.entries()){const{bin:C,imagePosition:I,imageVariant:F}=Z_(m,v,h);o.set(m,I),f.push(C),v.hasRenderCallback&&this.haveRenderCallbacks.push(F.id)}}patchUpdatedImages(t,o,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>t.hasImage(f,h)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const f of t.getUpdatedImages(h)){for(const m of this.iconPositions.keys()){const v=xn.parse(m);if(ra.isEqual(v.id,f)){const C=t.getImage(f,h);this.patchUpdatedImage(this.iconPositions.get(m),C,o)}}for(const m of this.patternPositions.keys()){const v=xn.parse(m);if(ra.isEqual(v.id,f)){const C=t.getImage(f,h);this.patchUpdatedImage(this.patternPositions.get(m),C,o)}}}}patchUpdatedImage(t,o,h){if(!t||!o||t.version===o.version)return;t.version=o.version;const[f,m]=t.tl,v=t.sdf;if(this.lut||v){const C={width:o.data.width,height:o.data.height},I=new Il(C);Il.copy(o.data,I,{x:0,y:0},{x:0,y:0},C,this.lut,v),h.update(I,{position:{x:f,y:m}})}else h.update(o.data,{position:{x:f,y:m}})}}Zi(Dm,"ImagePosition"),Zi(cB,"ImageAtlas");const v0=1e20;function uB(l,t,o,h,f,m,v,C,I){for(let F=t;F<t+h;F++)hB(l,o*m+F,m,f,v,C,I);for(let F=o;F<o+f;F++)hB(l,F*m+t,1,h,v,C,I)}function hB(l,t,o,h,f,m,v){m[0]=0,v[0]=-1e20,v[1]=v0,f[0]=l[t];for(let C=1,I=0,F=0;C<h;C++){f[C]=l[t+C*o];const k=C*C;do{const z=m[I];F=(f[C]-f[z]+k-z*z)/(C-z)/2}while(F<=v[I]&&--I>-1);I++,m[I]=C,v[I]=F,v[I+1]=v0}for(let C=0,I=0;C<h;C++){for(;v[I+1]<C;)I++;const F=m[I],k=C-F;l[t+C*o]=f[F]+k*k}}const Od=2,J_={none:0,ideographs:1,all:2};class Fg{constructor(t,o,h){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,o){this.urls[o]=t}getGlyphs(t,o,h){const f=[],m=this.urls[o]||us.GLYPHS_URL;for(const v in t)for(const C of t[v])f.push({stack:v,id:C});_t(f,({stack:v,id:C},I)=>{let F=this.entries[v];F||(F=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=F.glyphs[C];if(k!==void 0)return void I(null,{stack:v,id:C,glyph:k});if(k=this._tinySDF(F,v,C),k)return F.glyphs[C]=k,void I(null,{stack:v,id:C,glyph:k});const z=Math.floor(C/256);if(256*z>65535)return Yr("glyphs > 65535 not supported"),void I(null,{stack:v,id:C,glyph:k});if(F.ranges[z])return void I(null,{stack:v,id:C,glyph:k});let H=F.requests[z];H||(H=F.requests[z]=[],Fg.loadGlyphRange(v,z,m,this.requestManager,($,ee)=>{if(ee){F.ascender=ee.ascender,F.descender=ee.descender;for(const ae in ee.glyphs)this._doesCharSupportLocalGlyph(+ae)||(F.glyphs[+ae]=ee.glyphs[+ae]);F.ranges[z]=!0}for(const ae of H)ae($,ee);delete F.requests[z]})),H.push(($,ee)=>{$?I($):ee&&I(null,{stack:v,id:C,glyph:ee.glyphs[C]||null})})},(v,C)=>{if(v)h(v);else if(C){const I={};for(const{stack:F,id:k,glyph:z}of C)I[F]===void 0&&(I[F]={}),I[F].glyphs===void 0&&(I[F].glyphs={}),I[F].glyphs[k]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},I[F].ascender=this.entries[F].ascender,I[F].descender=this.entries[F].descender;h(null,I)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==J_.none&&(this.localGlyphMode===J_.all?!!this.localFontFamily:!!this.localFontFamily&&(Br["CJK Unified Ideographs"](t)||Br["Hangul Syllables"](t)||Br.Hiragana(t)||Br.Katakana(t)||Br["CJK Symbols and Punctuation"](t)||Br["CJK Unified Ideographs Extension A"](t)||Br["CJK Unified Ideographs Extension B"](t)||Br.Osage(t)))}_tinySDF(t,o,h){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(h))return;let m=t.tinySDF;if(!m){let ae="400";/bold/i.test(o)?ae="900":/medium/i.test(o)?ae="500":/light/i.test(o)&&(ae="200"),m=t.tinySDF=new Fg.TinySDF({fontFamily:f,fontWeight:ae,fontSize:24*Od,buffer:3*Od,radius:8*Od}),m.fontWeight=ae}if(this.localGlyphs[m.fontWeight][h])return this.localGlyphs[m.fontWeight][h];const v=String.fromCodePoint(h),{data:C,width:I,height:F,glyphWidth:k,glyphHeight:z,glyphLeft:H,glyphTop:$,glyphAdvance:ee}=m.draw(v);return this.localGlyphs[m.fontWeight][h]={id:h,bitmap:new Jf({width:I,height:F},C),metrics:{width:k/Od,height:z/Od,left:H/Od,top:$/Od-27,advance:ee/Od,localGlyph:!0}}}}Fg.loadGlyphRange=function(l,t,o,h,f){const m=256*t,v=m+255,C=h.transformRequest(h.normalizeGlyphsURL(o).replace("{fontstack}",l).replace("{range}",`${m}-${v}`),uh.Glyphs);jc(C,(I,F)=>{if(I)f(I);else if(F){const k={},z=function(H){return new m0(H).readFields(gL,{})}(F);for(const H of z.glyphs)k[H.id]=H;f(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},Fg.TinySDF=class{constructor({fontSize:l=24,buffer:t=3,radius:o=8,cutoff:h=.25,fontFamily:f="sans-serif",fontWeight:m="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=h,this.radius=o;const C=this.size=l+4*t,I=this._createCanvas(C),F=this.ctx=I.getContext("2d",{willReadFrequently:!0});F.font=`${v} ${m} ${l}px ${f}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(l){const t=document.createElement("canvas");return t.width=t.height=l,t}draw(l){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:h,actualBoundingBoxLeft:f,actualBoundingBoxRight:m}=this.ctx.measureText(l),v=Math.ceil(o),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-f))),I=Math.min(this.size-this.buffer,v+Math.ceil(h)),F=C+2*this.buffer,k=I+2*this.buffer,z=Math.max(F*k,0),H=new Uint8ClampedArray(z),$={data:H,width:F,height:k,glyphWidth:C,glyphHeight:I,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(C===0||I===0)return $;const{ctx:ee,buffer:ae,gridInner:Ae,gridOuter:ve}=this;ee.clearRect(ae,ae,C,I),ee.fillText(l,ae,ae+v);const Fe=ee.getImageData(ae,ae,C,I);ve.fill(v0,0,z),Ae.fill(0,0,z);for(let Le=0;Le<I;Le++)for(let ce=0;ce<C;ce++){const Ee=Fe.data[4*(Le*C+ce)+3]/255;if(Ee===0)continue;const ke=(Le+ae)*F+ce+ae;if(Ee===1)ve[ke]=0,Ae[ke]=v0;else{const He=.5-Ee;ve[ke]=He>0?He*He:0,Ae[ke]=He<0?He*He:0}}uB(ve,0,0,F,k,F,this.f,this.v,this.z),uB(Ae,ae,ae,C,I,F,this.f,this.v,this.z);for(let Le=0;Le<z;Le++){const ce=Math.sqrt(ve[Le])-Math.sqrt(Ae[Le]);H[Le]=Math.round(255-255*(ce/this.radius+this.cutoff))}return $}};const Qp=Hp;function dB(l,t){return l+t[1]-t[0]}function AB(l,t,o,h,f=1){const m=[],v=l.imagePrimary,C=v.pixelRatio,I=v.paddedRect.w-2*Qp,F=v.paddedRect.h-2*Qp,k=(l.right-l.left)*f,z=(l.bottom-l.top)*f,H=v.stretchX||[[0,I]],$=v.stretchY||[[0,F]],ee=H.reduce(dB,0),ae=$.reduce(dB,0),Ae=I-ee,ve=F-ae;let Fe=0,Le=ee,ce=0,Ee=ae,ke=0,He=Ae,gt=0,ht=ve;if(v.content&&h){const Lt=v.content;Fe=_0(H,0,Lt[0]),ce=_0($,0,Lt[1]),Le=_0(H,Lt[0],Lt[2]),Ee=_0($,Lt[1],Lt[3]),ke=Lt[0]-Fe,gt=Lt[1]-ce,He=Lt[2]-Lt[0]-Le,ht=Lt[3]-Lt[1]-Ee}const yt=(Lt,Wt,Si,fi)=>{const Ci=x0(Lt.stretch-Fe,Le,k,l.left*f),Ii=b0(Lt.fixed-ke,He,Lt.stretch,ee),$t=x0(Wt.stretch-ce,Ee,z,l.top*f),_i=b0(Wt.fixed-gt,ht,Wt.stretch,ae),Gt=x0(Si.stretch-Fe,Le,k,l.left*f),Yt=b0(Si.fixed-ke,He,Si.stretch,ee),ki=x0(fi.stretch-ce,Ee,z,l.top*f),Di=b0(fi.fixed-gt,ht,fi.stretch,ae),xr=new qt(Ci,$t),cr=new qt(Gt,$t),Xi=new qt(Gt,ki),Pi=new qt(Ci,ki),$r=new qt(Ii/C,_i/C),or=new qt(Yt/C,Di/C),Ar=t*Math.PI/180;if(Ar){const _n=Math.sin(Ar),ns=Math.cos(Ar),zs=[ns,-_n,_n,ns];xr._matMult(zs),cr._matMult(zs),Pi._matMult(zs),Xi._matMult(zs)}const Nr=Lt.stretch+Lt.fixed,an=Si.stretch+Si.fixed,on=Wt.stretch+Wt.fixed,vn=fi.stretch+fi.fixed,un=l.imageSecondary;return{tl:xr,tr:cr,bl:Pi,br:Xi,texPrimary:{x:v.paddedRect.x+Qp+Nr,y:v.paddedRect.y+Qp+on,w:an-Nr,h:vn-on},texSecondary:un?{x:un.paddedRect.x+Qp+Nr,y:un.paddedRect.y+Qp+on,w:an-Nr,h:vn-on}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$r,pixelOffsetBR:or,minFontScaleX:He/C/k,minFontScaleY:ht/C/z,isSDF:o}};if(h&&(v.stretchX||v.stretchY)){const Lt=fB(H,Ae,ee),Wt=fB($,ve,ae);for(let Si=0;Si<Lt.length-1;Si++){const fi=Lt[Si],Ci=Lt[Si+1];for(let Ii=0;Ii<Wt.length-1;Ii++)m.push(yt(fi,Wt[Ii],Ci,Wt[Ii+1]))}}else m.push(yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:F+1}));return m}function _0(l,t,o){let h=0;for(const f of l)h+=Math.max(t,Math.min(o,f[1]))-Math.max(t,Math.min(o,f[0]));return h}function fB(l,t,o){const h=[{fixed:-1,stretch:0}];for(const[f,m]of l){const v=h[h.length-1];h.push({fixed:f-v.stretch,stretch:v.stretch}),h.push({fixed:f-v.stretch,stretch:v.stretch+(m-f)})}return h.push({fixed:t+Qp,stretch:o}),h}function x0(l,t,o,h){return l/t*o+h}function b0(l,t,o,h){return l-t*o/h}function CL(l,t,o,h){const f=t+l.positionedLines[h].lineOffset;return h===0?o+f/2:o+(f+(t+l.positionedLines[h-1].lineOffset))/2}function SL(l,t=1,o=!1){let h=1/0,f=1/0,m=-1/0,v=-1/0;const C=l[0];for(let $=0;$<C.length;$++){const ee=C[$];(!$||ee.x<h)&&(h=ee.x),(!$||ee.y<f)&&(f=ee.y),(!$||ee.x>m)&&(m=ee.x),(!$||ee.y>v)&&(v=ee.y)}const I=Math.min(m-h,v-f);let F=I/2;const k=new el([],EL);if(I===0)return new qt(h,f);for(let $=h;$<m;$+=I)for(let ee=f;ee<v;ee+=I)k.push(new Lg($+F,ee+F,F,l));let z=function($){let ee=0,ae=0,Ae=0;const ve=$[0];for(let Fe=0,Le=ve.length,ce=Le-1;Fe<Le;ce=Fe++){const Ee=ve[Fe],ke=ve[ce],He=Ee.x*ke.y-ke.x*Ee.y;ae+=(Ee.x+ke.x)*He,Ae+=(Ee.y+ke.y)*He,ee+=3*He}return new Lg(ae/ee,Ae/ee,0,$)}(l),H=k.length;for(;k.length;){const $=k.pop();($.d>z.d||!z.d)&&(z=$,o&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,H)),$.max-z.d<=t||(F=$.h/2,k.push(new Lg($.p.x-F,$.p.y-F,F,l)),k.push(new Lg($.p.x+F,$.p.y-F,F,l)),k.push(new Lg($.p.x-F,$.p.y+F,F,l)),k.push(new Lg($.p.x+F,$.p.y+F,F,l)),H+=4)}return o&&(console.log(`num probes: ${H}`),console.log(`best distance: ${z.d}`)),z.p}function EL(l,t){return t.max-l.max}class Lg{constructor(t,o,h,f){this.p=new qt(t,o),this.h=h,this.d=function(m,v){let C=!1,I=1/0;for(let F=0;F<v.length;F++){const k=v[F];for(let z=0,H=k.length,$=H-1;z<H;$=z++){const ee=k[z],ae=k[$];ee.y>m.y!=ae.y>m.y&&m.x<(ae.x-ee.x)*(m.y-ee.y)/(ae.y-ee.y)+ee.x&&(C=!C),I=Math.min(I,Dn(m,ee,ae))}}return(C?1:-1)*Math.sqrt(I)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const TL=Object.keys,ex=Number.POSITIVE_INFINITY,IL=Math.sqrt(2);function pB(l,[t,o]){let h=0,f=0;if(o===ex){t<0&&(t=0);const m=t/IL;switch(l){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-t;break;case"top":f=t-7}switch(l){case"top-right":case"bottom-right":h=-m;break;case"top-left":case"bottom-left":h=m;break;case"left":h=t;break;case"right":h=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),l){case"top-right":case"top-left":case"top":f=o-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-o}switch(l){case"top-right":case"bottom-right":case"right":h=-t;break;case"top-left":case"bottom-left":case"left":h=t}}return[h,f]}function w0(l,t,o,h,f,m,v,C,I){if(!t||!t.usvg)return;const F=tB(h),k=tB(f),z=m!=="both"&&m!=="width"||!J2(h)?1:k.width/F.width,H=m!=="both"&&m!=="height"||!eB(h)?1:k.height/F.height;o.scaleSelf(z,H);const $=o.toString();v.set($,o),C.set($,t);const{imagePosition:ee}=Z_($,t,Hp);I.set($,ee)}function gB(l,t,o,h,f,m,v,C,I){if(!l)return;const F=function(k,z,H,$,ee,ae){if(k.kind==="camera")return k.maxSize;if(k.kind==="composite"){const Ae=z.possiblyEvaluate(new Xn(k.maxZoom,{worldview:ae}),H).evaluate(ee,{},H),ve=z.possiblyEvaluate(new Xn(k.minZoom,{worldview:ae}),H).evaluate(ee,{},H);return Math.max(Ae,ve)}return z.possiblyEvaluate(new Xn($,{worldview:ae})).evaluate(ee,{},H)}(t,o,h,f,m,I);return l.scaleSelf(F*C*v)}function mB(l,t,o,h,f,m,v,C,I){return{iconPrimary:gB(l.getPrimary(),t,o,h,f,m,v,C,I),iconSecondary:gB(l.getSecondary(),t,o,h,f,m,v,C,I)}}function FL(l,t,o){if(!t)return;const h=o.get(l.toString()),f=o.get(t.toString());f&&(h.paddedRect.w===f.paddedRect.w&&h.paddedRect.h===f.paddedRect.h||Yr(`Mismatch in icon variant sizes: ${l.toString()} and ${t.toString()}`),h.usvg!==f.usvg&&Yr(`Mismatch in icon variant image types: ${l.id} and ${t.id}`))}function yB(l,t,o,h){if(!l)return;const f=t.get(o.toString());if(l.imagePrimary=f,h){const m=t.get(h.toString());l.imageSecondary=m}}function LL(l,t){for(const o in l.horizontal)vB(l.horizontal[o],t);vB(l.vertical,t)}function vB(l,t){if(l){for(const o of l.positionedLines)for(const h of o.positionedGlyphs)if(h.image!==null){const f=h.image.toString();h.rect=t.get(f).paddedRect}}}function tx(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ML(l,t,o,h,f,m,v,C,I){const F=ix(m.horizontal)||m.vertical,k=o.get("icon-text-fit-padding").evaluate(h,{},f);let z,H=t;return t&&I!=="none"&&(l.allowVerticalPlacement&&m.vertical&&(z=Z2(t,m.vertical,I,k,C,v)),F&&(H=Z2(t,F,I,k,C,v))),{defaultShapedIcon:H,verticallyShapedIcon:z}}function PL(l,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve,Fe,Le){let ce=v.textMaxSize.evaluate(t,{},H);ce===void 0?ce=C*v.textScaleFactor:ce*=v.textScaleFactor;const Ee=l.layers[0].layout,ke=ix(o.horizontal)||o.vertical,He=$.name==="globe",gt=il,ht=l.tilePixelRatio*ce/gt,yt=(Ii=l.overscaling,l.zoom>18&&Ii>2&&(Ii>>=1),Math.max(wi/(512*Ii),1)*Ee.get("symbol-spacing")),Lt=Ee.get("text-padding")*l.tilePixelRatio,Wt=Ee.get("icon-padding")*l.tilePixelRatio,Si=dn(Ee.get("text-max-angle")),fi=Ee.get("icon-rotation-alignment")==="map"&&Le!=="point",Ci=yt/2;var Ii;l.hasAnyIconTextFit===!1&&Ae!=="none"&&(l.hasAnyIconTextFit=!0);const $t=t.properties?+t.properties[yn]:null,_i=$t&&l.elevationFeatureIdToIndex?l.elevationFeatureIdToIndex.get($t):65535,Gt=(Yt,ki,Di)=>{if(ki.x<0||ki.x>=wi||ki.y<0||ki.y>=wi)return;let xr=null;if(He){const{x:cr,y:Xi,z:Pi}=$.projectTilePoint(ki.x,ki.y,Di);xr={anchor:new ff(cr,Xi,Pi,0,void 0),up:$.upVector(Di,ki.x,ki.y)}}(function(cr,Xi,Pi,$r,or,Ar,Nr,an,on,vn,un,_n,ns,zs,ze,Ve,Jt,zi,Yi,Wi,sr,Or,wn,Bn,hn,ls,Rs,Cn,so){const Ns=cr.addToLineVertexArray(Xi,$r);let ss,wo,Gs,Ds,js,ds,fn,ms=0,oo=0,kr=0,On=0,Ws=-1,go=-1;const Ys={};let va=Uo("");const ws=Pi?Pi.anchor:Xi,ua=Cn!=="none";let Jc=0,Fl=0;if(on._unevaluatedLayout.getValue("text-radial-offset")===void 0){const _a=on.layout.get("text-offset").evaluate(sr,{},hn);Jc=_a[0]*il,Fl=_a[1]*il}else Jc=on.layout.get("text-radial-offset").evaluate(sr,{},hn)*il,Fl=ex;if(cr.allowVerticalPlacement&&or.vertical){const _a=or.vertical;if(ze)ds=rx(_a),an&&(fn=rx(an));else{const Pa=on.layout.get("text-rotate").evaluate(sr,{},hn)+90;Gs=B0(vn,ws,Xi,un,_n,ns,_a,zs,Pa,Ve),an&&(Ds=B0(vn,ws,Xi,un,_n,ns,an,zi,Pa))}}if(Ar){const _a=cr.iconSizeData,Pa=on.layout.get("icon-rotate").evaluate(sr,{},hn),Ll=AB(Ar,Pa,wn,ua,Or.iconScaleFactor),dc=an?AB(an,Pa,wn,ua,Or.iconScaleFactor):void 0;wo=B0(vn,ws,Xi,un,_n,ns,Ar,zi,Pa,null),ms=4*Ll.length;let Vl=null;_a.kind==="source"?(Vl=[PA*on.layout.get("icon-size").evaluate(sr,{},hn)*Or.iconScaleFactor],Vl[0]>tp&&Yr(`${cr.layerIds[0]}: Value for "icon-size" is >= ${Om}. Reduce your "icon-size".`)):_a.kind==="composite"&&(Vl=[PA*Or.compositeIconSizes[0].evaluate(sr,{},hn)*Or.iconScaleFactor,PA*Or.compositeIconSizes[1].evaluate(sr,{},hn)*Or.iconScaleFactor],(Vl[0]>tp||Vl[1]>tp)&&Yr(`${cr.layerIds[0]}: Value for "icon-size" is >= ${Om}. Reduce your "icon-size".`)),cr.addSymbols(cr.icon,Ll,Vl,Wi,Yi,sr,void 0,Pi,Xi,Ns.lineStartIndex,Ns.lineLength,-1,Bn,hn,ls,Rs),Ws=cr.icon.placedSymbolArray.length-1,dc&&(oo=4*dc.length,cr.addSymbols(cr.icon,dc,Vl,Wi,Yi,sr,Fu.vertical,Pi,Xi,Ns.lineStartIndex,Ns.lineLength,-1,Bn,hn,ls,Rs),go=cr.icon.placedSymbolArray.length-1)}for(const _a in or.horizontal){const Pa=_a,Ll=or.horizontal[Pa];ss||(va=Uo(Ll.text),ze?js=rx(Ll):ss=B0(vn,ws,Xi,un,_n,ns,Ll,zs,on.layout.get("text-rotate").evaluate(sr,{},hn),Ve));const dc=Ll.positionedLines.length===1;if(kr+=_B(cr,Pi,Xi,Ll,Nr,on,ze,sr,Ve,Ns,or.vertical?Fu.horizontal:Fu.horizontalOnly,dc?TL(or.horizontal):[Pa],Ys,Ws,Or,Bn,hn,ls),dc)break}or.vertical&&(On+=_B(cr,Pi,Xi,or.vertical,Nr,on,ze,sr,Ve,Ns,Fu.vertical,["vertical"],Ys,go,Or,Bn,hn,ls));let ul=-1;const eu=(_a,Pa)=>_a?Math.max(_a,Pa):Pa;ul=eu(js,ul),ul=eu(ds,ul),ul=eu(fn,ul);const kA=ul>-1?1:0;cr.glyphOffsetArray.length>=65535&&Yr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),sr.sortKey!==void 0&&cr.addToSortKeyRanges(cr.symbolInstances.length,sr.sortKey),cr.symbolInstances.emplaceBack(Xi.x,Xi.y,ws.x,ws.y,ws.z,Ys.right>=0?Ys.right:-1,Ys.center>=0?Ys.center:-1,Ys.left>=0?Ys.left:-1,Ys.vertical>=0?Ys.vertical:-1,Ws,go,va,ss!==void 0?ss:cr.collisionBoxArray.length,ss!==void 0?ss+1:cr.collisionBoxArray.length,Gs!==void 0?Gs:cr.collisionBoxArray.length,Gs!==void 0?Gs+1:cr.collisionBoxArray.length,wo!==void 0?wo:cr.collisionBoxArray.length,wo!==void 0?wo+1:cr.collisionBoxArray.length,Ds||cr.collisionBoxArray.length,Ds?Ds+1:cr.collisionBoxArray.length,un,kr,On,ms,oo,kA,0,Jc,Fl,ul,0,ua?1:0,so)})(l,ki,xr,Yt,o,h,m,f,l.layers[0],l.collisionBoxArray,t.index,t.sourceLayerIndex,l.index,Lt,Fe,F,0,Wt,fi,ve,t,v,k,z,H,ee,ae,Ae,_i)};if(Le==="line")for(const Yt of A0(t.geometry,0,0,wi,wi)){const ki=BL(Yt,yt,Si,o.vertical||ke,h,gt,ht,l.overscaling,wi);for(const Di of ki)ke&&kL(l,ke.text,Ci,Di)||Gt(Yt,Di,H)}else if(Le==="line-center"){for(const Yt of t.geometry)if(Yt.length>1){const ki=wL(Yt,Si,o.vertical||ke,h,gt,ht);ki&&Gt(Yt,ki,H)}}else if(t.type==="Polygon")for(const Yt of a0(t.geometry,0)){const ki=SL(Yt,16);Gt(Yt[0],new ff(ki.x,ki.y,0,0,void 0),H)}else if(t.type==="LineString")for(const Yt of t.geometry)Gt(Yt,new ff(Yt[0].x,Yt[0].y,0,0,void 0),H);else if(t.type==="Point")for(const Yt of t.geometry)for(const ki of Yt)Gt([ki],new ff(ki.x,ki.y,0,0,void 0),H)}const Om=255,tp=Om*PA;function _B(l,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae,ve){const Fe=function(Ee,ke,He,gt,ht,yt,Lt,Wt){const Si=[];if(ke.positionedLines.length===0)return Si;const fi=gt.layout.get("text-rotate").evaluate(yt,{})*Math.PI/180,Ci=function(Yt){const ki=Yt[0],Di=Yt[1],xr=ki*Di;return xr>0?[ki,-Di]:xr<0?[-ki,Di]:ki===0?[Di,ki]:[Di,-ki]}(He);let Ii=Math.abs(ke.top-ke.bottom);for(const Yt of ke.positionedLines)Ii-=Yt.lineOffset;const $t=ke.positionedLines.length,_i=Ii/$t;let Gt=ke.top-He[1];for(let Yt=0;Yt<$t;++Yt){const ki=ke.positionedLines[Yt];Gt=CL(ke,_i,Gt,Yt);for(const Di of ki.positionedGlyphs){if(!Di.rect)continue;const xr=Di.rect||{};let cr=vL+1,Xi=!0,Pi=1,$r=0;if(Di.image){const sr=Lt.get(Di.image.toString());if(!sr)continue;if(sr.sdf){Yr("SDF images are not supported in formatted text and will be ignored.");continue}Xi=!1,Pi=sr.pixelRatio,cr=Hp/Pi}const or=(ht||Wt)&&Di.vertical,Ar=Di.metrics.advance*Di.scale/2,Nr=Di.metrics,an=Di.rect;if(an===null)continue;Wt&&ke.verticalizable&&($r=Di.image?Ar-Di.metrics.width*Di.scale/2:0);const on=ht?[Di.x+Ar,Di.y]:[0,0];let vn=[0,0],un=[0,0],_n=!1;ht||(or?(un=[Di.x+Ar+Ci[0],Di.y+Ci[1]-$r],_n=!0):vn=[Di.x+Ar+He[0],Di.y+He[1]-$r]);const ns=an.w*Di.scale/(Pi*(Di.localGlyph?Od:1)),zs=an.h*Di.scale/(Pi*(Di.localGlyph?Od:1));let ze,Ve,Jt,zi;if(or){const sr=Di.y-Gt,Or=new qt(-Ar,Ar-sr),wn=-Math.PI/2,Bn=new qt(...un);ze=new qt(-Ar+vn[0],vn[1]),ze._rotateAround(wn,Or)._add(Bn),ze.x+=-sr+Ar,ze.y-=(Nr.left-cr)*Di.scale;const hn=Di.image?Nr.advance*Di.scale:il*Di.scale,ls=String.fromCodePoint(Di.glyph);AL(ls)?ze.x+=(1-cr)*Di.scale:fL(ls)?ze.x+=hn-Nr.height*Di.scale+(-cr-1)*Di.scale:ze.x+=Di.image||Nr.width+2*cr===an.w&&Nr.height+2*cr===an.h?(hn-zs)/2:(hn-(Nr.height+2*cr)*Di.scale)/2,Ve=new qt(ze.x,ze.y-ns),Jt=new qt(ze.x+zs,ze.y),zi=new qt(ze.x+zs,ze.y-ns)}else{const sr=(Nr.left-cr)*Di.scale-Ar+vn[0],Or=(-Nr.top-cr)*Di.scale+vn[1],wn=sr+ns,Bn=Or+zs;ze=new qt(sr,Or),Ve=new qt(wn,Or),Jt=new qt(sr,Bn),zi=new qt(wn,Bn)}if(fi){let sr;sr=ht?new qt(0,0):_n?new qt(Ci[0],Ci[1]):new qt(He[0],He[1]),ze._rotateAround(fi,sr),Ve._rotateAround(fi,sr),Jt._rotateAround(fi,sr),zi._rotateAround(fi,sr)}const Yi=new qt(0,0),Wi=new qt(0,0);Si.push({tl:ze,tr:Ve,bl:Jt,br:zi,texPrimary:xr,texSecondary:void 0,writingMode:ke.writingMode,glyphOffset:on,sectionIndex:Di.sectionIndex,isSDF:Xi,pixelOffsetTL:Yi,pixelOffsetBR:Wi,minFontScaleX:0,minFontScaleY:0})}}return Si}(0,h,I,m,v,C,f,l.allowVerticalPlacement),Le=l.textSizeData;let ce=null;Le.kind==="source"?(ce=[PA*m.layout.get("text-size").evaluate(C,{},Ae)*ee.textScaleFactor],ce[0]>tp&&Yr(`${l.layerIds[0]}: Value for "text-size" is >= ${Om}. Reduce your "text-size".`)):Le.kind==="composite"&&(ce=[PA*ee.compositeTextSizes[0].evaluate(C,{},Ae)*ee.textScaleFactor,PA*ee.compositeTextSizes[1].evaluate(C,{},Ae)*ee.textScaleFactor],(ce[0]>tp||ce[1]>tp)&&Yr(`${l.layerIds[0]}: Value for "text-size" is >= ${Om}. Reduce your "text-size".`)),l.addSymbols(l.text,Fe,ce,I,v,C,k,t,o,F.lineStartIndex,F.lineLength,$,ae,Ae,ve,!1);for(const Ee of z)H[Ee]=l.text.placedSymbolArray.length-1;return 4*Fe.length}function ix(l){for(const t in l)return l[t];return null}function B0(l,t,o,h,f,m,v,C,I,F){let k=v.top,z=v.bottom,H=v.left,$=v.right;if($2(v)&&v.collisionPadding){const ee=v.collisionPadding;H-=ee[0],k-=ee[1],$+=ee[2],z+=ee[3]}if(I){const ee=new qt(H,k),ae=new qt($,k),Ae=new qt(H,z),ve=new qt($,z),Fe=dn(I);let Le=new qt(0,0);F&&(Le=new qt(F[0],F[1])),ee._rotateAround(Fe,Le),ae._rotateAround(Fe,Le),Ae._rotateAround(Fe,Le),ve._rotateAround(Fe,Le),H=Math.min(ee.x,ae.x,Ae.x,ve.x),$=Math.max(ee.x,ae.x,Ae.x,ve.x),k=Math.min(ee.y,ae.y,Ae.y,ve.y),z=Math.max(ee.y,ae.y,Ae.y,ve.y)}return l.emplaceBack(t.x,t.y,t.z,o.x,o.y,H,k,$,z,C,h,f,m),l.length-1}function rx(l){$2(l)&&l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const t=l.bottom-l.top;return t>0?Math.max(10,t):null}function kL(l,t,o,h){const f=l.compareText;if(t in f){const m=f[t];for(let v=m.length-1;v>=0;v--)if(h.dist(m[v])<o)return!0}else f[t]=[];return f[t].push(h),!1}function xB(l,t){const o=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*t:0,f=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),m=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-l._pitch-o,.01));let v=Math.sin(l._pitch)*m+f;const C=f*(1/l._horizonShift);if(!l.elevation||l.elevation.exaggeration()===0){let I=Math.max(l.zoom-17,0);l.isOrthographic&&(I/=10),v*=1+I}return Math.min(1.01*v,C)}function Um(l,t){if(!t.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:t};const o=Math.pow(2,-l.z),h=l.x*o,f=(l.x+1)*o,m=l.y*o,v=(l.y+1)*o,C=dt(h),I=dt(f),F=kt(m),k=kt(v),z=t.project(C,F),H=t.project(I,F),$=t.project(I,k),ee=t.project(C,k);let ae=Math.min(z.x,H.x,$.x,ee.x),Ae=Math.min(z.y,H.y,$.y,ee.y),ve=Math.max(z.x,H.x,$.x,ee.x),Fe=Math.max(z.y,H.y,$.y,ee.y);const Le=o/16;function ce(ke,He,gt,ht,yt,Lt){const Wt=(gt+yt)/2,Si=(ht+Lt)/2,fi=t.project(dt(Wt),kt(Si)),Ci=Math.max(0,ae-fi.x,Ae-fi.y,fi.x-ve,fi.y-Fe);ae=Math.min(ae,fi.x),ve=Math.max(ve,fi.x),Ae=Math.min(Ae,fi.y),Fe=Math.max(Fe,fi.y),Ci>Le&&(ce(ke,fi,gt,ht,Wt,Si),ce(fi,He,Wt,Si,yt,Lt))}ce(z,H,h,m,f,m),ce(H,$,f,m,f,v),ce($,ee,f,v,h,v),ce(ee,z,h,v,h,m),ae-=Le,Ae-=Le,ve+=Le,Fe+=Le;const Ee=1/Math.max(ve-ae,Fe-Ae);return{scale:Ee,x:ae*Ee,y:Ae*Ee,x2:ve*Ee,y2:Fe*Ee,projection:t}}function bB(l,{x:t,y:o},h=0){return new qt(((t-h)*l.scale-l.x)*wi,(o*l.scale-l.y)*wi)}const RL=P(new Float32Array(16));class ip{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new Te(0,0)}projectTilePoint(t,o,h){return{x:t,y:o,z:0}}locationPoint(t,o,h,f=!0){return t._coordinatePoint(t.locationCoordinate(o,h),f)}pixelsPerMeter(t,o){return lt(1,t)*o}pixelSpaceConversion(t,o,h){return 1}farthestPixelDistance(t){return xB(t,t.pixelsPerMeter)}pointCoordinate(t,o,h,f){const m=t.horizonLineFromTop(!1),v=new qt(o,Math.max(m,h));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,f))}pointCoordinate3D(t,o,h){const f=new qt(o,h);if(t.elevation)return t.elevation.pointCoordinate(f);{const m=this.pointCoordinate(t,f.x,f.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(t,o){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,o.x,o.y);const h=t.horizonLineFromTop();return o.y<h}createInversionMatrix(t,o){return RL}createTileMatrix(t,o,h){let f,m,v;const C=h.canonical,I=P(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=Um(C,this);f=1,m=F.x+h.wrap*F.scale,v=F.y,q(I,I,[f/F.scale,f/F.scale,t.pixelsPerMeter/o])}else f=o/t.zoomScale(C.z),m=(C.x+Math.pow(2,C.z)*h.wrap)*f,v=C.y*f;return Q(I,I,[m,v,0]),q(I,I,[f/wi,f/wi,1]),I}upVector(t,o,h){return[0,0,1]}upVectorScale(t,o,h){return{metersToTile:1}}}class DL extends ip{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,h]=this.parallels=t.parallels||[29.5,45.5],f=Math.sin(dn(o));this.n=(f+Math.sin(dn(h)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:h,c:f,r0:m}=this,v=dn(t-this.center[0]),C=dn(o),I=Math.sqrt(f-2*h*Math.sin(C))/h;return{x:I*Math.sin(v*h),y:I*Math.cos(v*h)-m,z:0}}unproject(t,o){const{n:h,c:f,r0:m}=this,v=m+o;let C=Math.atan2(t,Math.abs(v))*Math.sign(v);v*h<0&&(C-=Math.PI*Math.sign(t)*Math.sign(v));const I=dn(this.center[0])*h;C=Rt(C,-Math.PI-I,Math.PI-I);const F=Ge(St(C/h)+this.center[0],-180,180),k=Math.asin(Ge((f-(t*t+v*v)*h*h)/(2*h),-1,1)),z=Ge(St(k),-85.051129,ti);return new Te(F,z)}}const zm=1.340264,Nm=-.081106,jm=893e-6,Hm=.003796,C0=Math.sqrt(3)/2;class OL extends ip{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const h=Math.asin(C0*Math.sin(o)),f=h*h,m=f*f*f;return{x:.5*(t*Math.cos(h)/(C0*(zm+3*Nm*f+m*(7*jm+9*Hm*f)))/Math.PI+.5),y:1-.5*(h*(zm+Nm*f+m*(jm+Hm*f))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let h=o=(2*(1-o)-1)*Math.PI,f=h*h,m=f*f*f;for(let k,z,H,$=0;$<12&&(z=h*(zm+Nm*f+m*(jm+Hm*f))-o,H=zm+3*Nm*f+m*(7*jm+9*Hm*f),k=z/H,h=Ge(h-k,-Math.PI/3,Math.PI/3),f=h*h,m=f*f*f,!(Math.abs(k)<1e-12));++$);const v=C0*t*(zm+3*Nm*f+m*(7*jm+9*Hm*f))/Math.cos(h),C=Math.asin(Math.sin(h)/C0),I=Ge(180*v/Math.PI,-180,180),F=Ge(180*C/Math.PI,-85.051129,ti);return new Te(I,F)}}class UL extends ip{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const h=360*(t-.5),f=Ge(360*(.5-o),-85.051129,ti);return new Te(h,f)}}const Mg=Math.PI/2;function S0(l){return Math.tan((Mg+l)/2)}class zL extends ip{constructor(t){super(t),this.center=t.center||[0,30];const[o,h]=this.parallels=t.parallels||[30,30];let f=dn(o),m=dn(h);this.southernCenter=f+m<0,this.southernCenter&&(f=-f,m=-m);const v=Math.cos(f),C=S0(f);this.n=f===m?Math.sin(f):Math.log(v/Math.cos(m))/Math.log(S0(m)/C),this.f=v*Math.pow(S0(f),this.n)/this.n}project(t,o){o=dn(o),this.southernCenter&&(o=-o),t=dn(t-this.center[0]);const h=1e-6,{n:f,f:m}=this;m>0?o<-Mg+h&&(o=-Mg+h):o>Mg-h&&(o=Mg-h);const v=m/Math.pow(S0(o),f);let C=v*Math.sin(f*t),I=m-v*Math.cos(f*t);return C=.5*(C/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:C,y:this.southernCenter?I:1-I,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:h,f}=this,m=f-o,v=Math.sign(m),C=Math.sign(h)*Math.sqrt(t*t+m*m);let I=Math.atan2(t,Math.abs(m))*v;m*h<0&&(I-=Math.PI*Math.sign(t)*v);const F=Ge(St(I/h)+this.center[0],-180,180),k=Ge(St(2*Math.atan(Math.pow(f/C,1/h))-Mg),-85.051129,ti);return new Te(F,this.southernCenter?-k:k)}}class wB extends ip{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:it(t),y:Xe(o),z:0}}unproject(t,o){const h=dt(t),f=kt(o);return new Te(h,f)}}const BB=dn(ti);class NL extends ip{project(t,o){const h=(o=dn(o))*o,f=h*h;return{x:.5*((t=dn(t))*(.8707-.131979*h+f*(f*(.003971*h-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+h*(.015085+f*(.028874*h-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let h=o=(2*(1-o)-1)*Math.PI,f=25,m=0,v=h*h;do{v=h*h;const F=v*v;m=(h*(1.007226+v*(.015085+F*(.028874*v-.044475-.005916*F)))-o)/(1.007226+v*(.045255+F*(.259866*v-.311325-.005916*11*F))),h=Ge(h-m,-BB,BB)}while(Math.abs(m)>1e-6&&--f>0);v=h*h;const C=Ge(St(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),I=St(h);return new Te(C,I)}}const CB=dn(ti);class jL extends ip{project(t,o){o=dn(o),t=dn(t);const h=Math.cos(o),f=2/Math.PI,m=Math.acos(h*Math.cos(t/2)),v=Math.sin(m)/m,C=.5*(t*f+2*h*Math.sin(t/2)/v)||0,I=.5*(o+Math.sin(o)/v)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(t,o){let h=t=(2*t-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,m=25;const v=1e-6;let C=0,I=0;do{const F=Math.cos(f),k=Math.sin(f),z=2*k*F,H=k*k,$=F*F,ee=Math.cos(h/2),ae=Math.sin(h/2),Ae=2*ee*ae,ve=ae*ae,Fe=1-$*ee*ee,Le=Fe?1/Fe:0,ce=Fe?Math.acos(F*ee)*Math.sqrt(1/Fe):0,Ee=.5*(2*ce*F*ae+2*h/Math.PI)-t,ke=.5*(ce*k+f)-o,He=.5*Le*($*ve+ce*F*ee*H)+1/Math.PI,gt=Le*(Ae*z/4-ce*k*ae),ht=.125*Le*(z*ae-ce*k*$*Ae),yt=.5*Le*(H*ee+ce*ve*F)+.5,Lt=gt*ht-yt*He;C=(ke*gt-Ee*yt)/Lt,I=(Ee*ht-ke*He)/Lt,h=Ge(h-C,-Math.PI,Math.PI),f=Ge(f-I,-CB,CB)}while((Math.abs(C)>v||Math.abs(I)>v)&&--m>0);return new Te(St(h),St(f))}}class SB extends ip{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(dn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:h,cosPhi:f}=this;return{x:dn(t)*f*h+.5,y:-Math.sin(dn(o))/f*h+.5,z:0}}unproject(t,o){const{scale:h,cosPhi:f}=this,m=-(o-.5)/h,v=Ge(St((t-.5)/h)/f,-180,180),C=Math.asin(Ge(m*f,-1,1)),I=Ge(St(C),-85.051129,ti);return new Te(v,I)}}class HL extends wB{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,h){const f=mm(t,o,h);return tt(f,f,n0(LA(h))),{x:f[0],y:f[1],z:f[2]}}locationPoint(t,o,h){const f=ue(o.lat,o.lng),m=mt([],f),v=h?t._centerAltitude+h:t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude;Qt(f,f,m,lt(1,0)*wi*v);const C=P(new Float64Array(16));return U(C,t.pixelMatrix,t.globeMatrix),tt(f,f,C),new qt(f[0],f[1])}pixelsPerMeter(t,o){return lt(1,0)*o}pixelSpaceConversion(t,o,h){const f=lt(1,t)*o,m=Er(lt(1,45)*o,f,h);return this.pixelsPerMeter(t,o)/m}createTileMatrix(t,o,h){const f=__(LA(h.canonical));return U(new Float64Array(16),t.globeMatrix,f)}createInversionMatrix(t,o){const{center:h}=t,f=n0(LA(o));return re(f,f,dn(h.lng)),ne(f,f,dn(h.lat)),q(f,f,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(t,o,h,f){return lw(t,o,h,!0)||new wt(0,0)}pointCoordinate3D(t,o,h){const f=this.pointCoordinate(t,o,h,0);return[f.x,f.y,f.z]}isPointAboveHorizon(t,o){return!lw(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=function(f,m){const v=f.cameraToCenterDistance,C=f._centerAltitude*m,I=f._camera,F=f._camera.forward(),k=Pe([],pt([],F,-v),[0,0,C]),z=f.worldSize/(2*Math.PI),H=[0,0,-z],$=f.width/f.height,ee=Math.tan(f.fovAboveCenter),ae=pt([],I.up(),ee),Ae=pt([],I.right(),ee*$),ve=mt([],Pe([],Pe([],F,ae),Ae)),Fe=[];let Le;if(new ks(k,ve).closestPointOnSphere(H,z,Fe)){const ce=Pe([],Fe,H),Ee=Ke([],ce,k);Le=Math.cos(f.fovAboveCenter)*Me(Ee)}else{const ce=Ke([],k,H),Ee=Ke([],H,k);mt(Ee,Ee);const ke=Me(ce)-z;Le=Math.sqrt(ke*(ke+2*z));const He=Math.acos(Le/(z+ke))-Math.acos(Ct(F,Ee));Le*=Math.cos(He)}return 1.01*Le}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),h=Zf(t.zoom);if(h>0){const f=xB(t,lt(1,t.center.lat)*t.worldSize),m=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Er(o,f+m*(1-Math.cos(v)),Math.pow(h,10))}return o}upVector(t,o,h){return mm(o,h,t,1)}upVectorScale(t){return{metersToTile:t0(r0(LA(t)))}}}function EB(l){const t=l.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(l.name){case"mercator":return new wB(l);case"equirectangular":return new UL(l);case"naturalEarth":return new NL(l);case"equalEarth":return new OL(l);case"winkelTripel":return new jL(l);case"albers":return o?new SB(l):new DL(l);case"lambertConformalConic":return o?new SB(l):new zL(l);case"globe":return new HL(l)}throw new Error(`Invalid projection name: ${l.name}`)}const QL=ln.VectorTileFeature.types,VL=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function E0(l,t,o,h,f,m,v,C,I,F,k,z,H){const $=C?Math.min(tp,Math.round(C[0])):0,ee=C?Math.min(tp,Math.round(C[1])):0;l.emplaceBack(t,o,Math.round(32*h),Math.round(32*f),m,v,($<<1)+(I?1:0),ee,16*F,16*k,256*z,256*H)}function T0(l,t,o){l.emplaceBack(t,o)}function I0(l,t,o,h,f,m,v){l.emplaceBack(t,o,h,f,m,v)}const F0=(l,t,o,h)=>{for(let f=0;f<t;f++)l.emplaceBack(o[0],o[1],o[2],h[0],h[1],h[2])};function L0(l,t,o,h,f){l.emplaceBack(t,o,h,f),l.emplaceBack(t,o,h,f),l.emplaceBack(t,o,h,f),l.emplaceBack(t,o,h,f)}function GL(l){for(const t of l.sections)if(gd(t.text))return!0;return!1}class nx{constructor(t){this.layoutVertexArray=new Bd,this.indexArray=new Zo,this.programConfigurations=t,this.segments=new Vs,this.dynamicLayoutVertexArray=new Xa,this.opacityVertexArray=new Fh,this.placedSymbolArray=new Pp,this.iconTransitioningVertexArray=new Lh,this.globeExtVertexArray=new Cd,this.zOffsetVertexArray=new qh,this.orientationVertexArray=new Fp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,o,h,f,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rL.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,sL.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,VL,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,lL.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,nL.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,oL.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=t.createVertexBuffer(this.orientationVertexArray,aL.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Zi(nx,"SymbolBuffers");class sx{constructor(t,o,h){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new h,this.segments=new Vs,this.collisionVertexArray=new bA,this.collisionVertexArrayExt=new Xa}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,cL.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,uL.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Zi(sx,"CollisionBuffers");class M0{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.lut=t.lut,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=P([]),this.placementViewportMatrix=P([]);const o=this.layers[0]._unevaluatedLayout._values;this.worldview=t.worldview,this.textSizeData=iB(this.zoom,o["text-size"],this.worldview),this.iconSizeData=iB(this.zoom,o["icon-size"],this.worldview);const h=this.layers[0].layout,f=h.get("symbol-sort-key"),m=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(v=>Fu[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new nx(new p(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("text")||t.startsWith("symbol"))),this.icon=new nx(new p(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("icon")||t.startsWith("symbol"))),this.glyphOffsetArray=new Gf,this.lineVertexArray=new bg,this.symbolInstances=new kp}calculateGlyphDependencies(t,o,h,f,m){for(const v of t){const C=v.codePointAt(0);if(C===void 0)break;if(o[C]=!0,f&&m&&C<=65535){const I=Pm[v];I&&(o[I.charCodeAt(0)]=!0)}}}updateFootprints(t,o){}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!P_(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(t,o,h,f){const m=this.layers[0],v=m.layout,C=this.projection.name==="globe",I=v.get("text-font"),F=v.get("text-field"),k=v.get("icon-image"),[z,H]=v.get("icon-size-scale-range"),$=Ge(o.scaleFactor||1,z,H),ee=(F.value.kind!=="constant"||F.value.value instanceof Zn&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),ae=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,Ae=v.get("symbol-sort-key");if(this.features=[],!ee&&!ae)return;const ve=o.iconDependencies,Fe=o.glyphDependencies,Le=o.availableImages,ce=new Xn(this.zoom,{worldview:this.worldview});for(const{feature:Ee,id:ke,index:He,sourceLayerIndex:gt}of t){const ht=m._featureFilter.needGeometry,yt=Ki(Ee,ht);if(!m._featureFilter.filter(ce,yt,h))continue;if(ht||(yt.geometry=tr(Ee,h,f)),C&&Ee.type!==1&&h.z<=5){const Ci=yt.geometry,Ii=.98078528056,$t=(_i,Gt)=>Ct(mm(_i.x,_i.y,h,1),mm(Gt.x,Gt.y,h,1))<Ii;for(let _i=0;_i<Ci.length;_i++)Ci[_i]=Li(Ci[_i],$t)}let Lt,Wt;if(ee){const Ci=m.getValueAndResolveTokens("text-field",yt,h,Le),Ii=Zn.factory(Ci);GL(Ii)&&(this.hasRTLText=!0),(!this.hasRTLText||cl()==="unavailable"||this.hasRTLText&&qc.isParsed())&&(Lt=dL(Ii,m,yt))}if(ae){const Ci=m.getValueAndResolveTokens("icon-image",yt,h,Le);Wt=typeof Ci=="string"?Js.build(Ci):Ci}if(!Lt&&!Wt)continue;const Si=this.sortFeaturesByKey?Ae.evaluate(yt,{},h):void 0,fi={id:ke,text:Lt,icon:Wt,index:He,sourceLayerIndex:gt,geometry:yt.geometry,properties:Ee.properties,type:QL[Ee.type],sortKey:Si};if(this.features.push(fi),Wt){const Ci=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Ii,iconSecondary:$t}=mB(Wt,this.iconSizeData,Ci["icon-size"],h,this.zoom,fi,this.pixelRatio,$,this.worldview),_i=Ii.id.toString();if(ve.has(_i)?ve.get(_i).push(Ii):ve.set(_i,[Ii]),$t){const Gt=$t.id.toString();ve.has(Gt)?ve.get(Gt).push($t):ve.set(Gt,[$t])}}if(Lt){const Ci=I.evaluate(yt,{},h).join(","),Ii=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fu.vertical)>=0;for(const $t of Lt.sections)if($t.image){const _i=$t.image.getPrimary().scaleSelf(this.pixelRatio),Gt=_i.id.toString(),Yt=ve.get(Gt)||[];Yt.push(_i),ve.set(Gt,Yt)}else{const _i=Qu(Lt.toString()),Gt=$t.fontStack||Ci,Yt=Fe[Gt]=Fe[Gt]||{};this.calculateGlyphDependencies($t.text,Yt,Ii,this.allowVerticalPlacement,_i)}}}if(v.get("symbol-placement")==="line"&&(this.features=function(Ee){const ke={},He={},gt=[];let ht=0;function yt(fi){gt.push(Ee[fi]),ht++}function Lt(fi,Ci,Ii){const $t=He[fi];return delete He[fi],He[Ci]=$t,gt[$t].geometry[0].pop(),gt[$t].geometry[0]=gt[$t].geometry[0].concat(Ii[0]),$t}function Wt(fi,Ci,Ii){const $t=ke[Ci];return delete ke[Ci],ke[fi]=$t,gt[$t].geometry[0].shift(),gt[$t].geometry[0]=Ii[0].concat(gt[$t].geometry[0]),$t}function Si(fi,Ci,Ii){const $t=Ii?Ci[0][Ci[0].length-1]:Ci[0][0];return`${fi}:${$t.x}:${$t.y}`}for(let fi=0;fi<Ee.length;fi++){const Ci=Ee[fi],Ii=Ci.geometry,$t=Ci.text?Ci.text.toString():null;if(!$t){yt(fi);continue}const _i=Si($t,Ii),Gt=Si($t,Ii,!0);if(_i in He&&Gt in ke&&He[_i]!==ke[Gt]){const Yt=Wt(_i,Gt,Ii),ki=Lt(_i,Gt,gt[Yt].geometry);delete ke[_i],delete He[Gt],He[Si($t,gt[ki].geometry,!0)]=ki,gt[Yt].geometry=null}else _i in He?Lt(_i,Gt,Ii):Gt in ke?Wt(_i,Gt,Ii):(yt(fi),ke[_i]=ht-1,He[Gt]=ht-1)}return gt.filter(fi=>fi.geometry)}(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ee of o.elevationFeatures)this.elevationFeatureIdToIndex.set(Ee.id,this.elevationFeatures.length),this.elevationFeatures.push(Ee)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Ee,ke)=>Ee.sortKey-ke.sortKey)}update(t,o,h,f,m,v,C){this.text.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,this.worldview),this.icon.programConfigurations.updatePaintArrays(t,o,m,h,f,v,C,this.worldview)}updateRoadElevation(t){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;const h=Vt(t),f=1/h;let m=!1,v=!1;for(let C=0;C<this.symbolInstances.length;C++){const I=this.symbolInstances.get(C),F=Be(1,0,0),k=Be(0,1,0),{numHorizontalGlyphVertices:z,numVerticalGlyphVertices:H,numIconVertices:$,numVerticalIconVertices:ee}=I,ae=z>0||H>0,Ae=$>0,ve=this.elevationFeatures[I.elevationFeatureIndex];if(ve){const Fe=new qt(I.tileAnchorX,I.tileAnchorY),Le=.075+ve.pointElevation(Fe);I.zOffset!==Le&&(o=!0,I.zOffset=Le);const ce=ve.computeSlopeNormal(Fe,f),Ee=ui(di(),Be(0,0,1),ce);Ai(F,F,Ee),Ai(k,k,Ee),F[2]*=h,k[2]*=h,F[0]===1&&F[1]===0&&F[2]===0&&k[0]===0&&k[1]===1&&k[2]===0||(m=m||ae,v=v||Ae)}if(ae&&(F0(this.text.orientationVertexArray,z,F,k),F0(this.text.orientationVertexArray,H,F,k)),Ae){const{placedIconSymbolIndex:Fe,verticalPlacedIconSymbolIndex:Le}=I;Fe>=0&&F0(this.icon.orientationVertexArray,$,F,k),Le>=0&&F0(this.icon.orientationVertexArray,ee,F,k)}}m||(this.text.orientationVertexArray=void 0),v||(this.icon.orientationVertexArray=void 0),o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const t=(m,v,C)=>{h+=v,h>m.length&&m.resize(h);for(let I=-v;I<0;I++)m.emplace(I+h,C)},o=(m,v,C)=>{f+=v,f>m.length&&m.resize(f);for(let I=-v;I<0;I++)m.emplace(I+f,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,f=0;for(let m=0;m<this.symbolInstances.length;m++){const v=this.symbolInstances.get(m),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:I,numIconVertices:F}=v,k=v.zOffset,z=F>0;if((C>0||I>0)&&(t(this.text.zOffsetVertexArray,C,k),t(this.text.zOffsetVertexArray,I,k)),z){const{placedIconSymbolIndex:H,verticalPlacedIconSymbolIndex:$}=v;H>=0&&o(this.icon.zOffsetVertexArray,F,k),$>=0&&o(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,k)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=EB(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const h=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:f,y:m}of o)this.lineVertexArray.emplaceBack(f,m);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae,Ae){const ve=t.indexArray,Fe=t.layoutVertexArray,Le=t.globeExtVertexArray,ce=t.segments.prepareSegment(4*o.length,Fe,ve,this.canOverlap?v.sortKey:void 0),Ee=this.glyphOffsetArray.length,ke=ce.vertexLength,He=this.allowVerticalPlacement&&C===Fu.vertical?Math.PI/2:0,gt=v.text&&v.text.sections;for(let yt=0;yt<o.length;yt++){const{tl:Lt,tr:Wt,bl:Si,br:fi,texPrimary:Ci,texSecondary:Ii,pixelOffsetTL:$t,pixelOffsetBR:_i,minFontScaleX:Gt,minFontScaleY:Yt,glyphOffset:ki,isSDF:Di,sectionIndex:xr}=o[yt],cr=ce.vertexLength,Xi=ki[1];if(E0(Fe,F.x,F.y,Lt.x,Xi+Lt.y,Ci.x,Ci.y,h,Di,$t.x,$t.y,Gt,Yt),E0(Fe,F.x,F.y,Wt.x,Xi+Wt.y,Ci.x+Ci.w,Ci.y,h,Di,_i.x,$t.y,Gt,Yt),E0(Fe,F.x,F.y,Si.x,Xi+Si.y,Ci.x,Ci.y+Ci.h,h,Di,$t.x,_i.y,Gt,Yt),E0(Fe,F.x,F.y,fi.x,Xi+fi.y,Ci.x+Ci.w,Ci.y+Ci.h,h,Di,_i.x,_i.y,Gt,Yt),I){const{x:Pi,y:$r,z:or}=I.anchor,[Ar,Nr,an]=I.up;I0(Le,Pi,$r,or,Ar,Nr,an),I0(Le,Pi,$r,or,Ar,Nr,an),I0(Le,Pi,$r,or,Ar,Nr,an),I0(Le,Pi,$r,or,Ar,Nr,an),L0(t.dynamicLayoutVertexArray,Pi,$r,or,He)}else L0(t.dynamicLayoutVertexArray,F.x,F.y,F.z,He);if(Ae){const Pi=Ii||Ci;T0(t.iconTransitioningVertexArray,Pi.x,Pi.y),T0(t.iconTransitioningVertexArray,Pi.x+Pi.w,Pi.y),T0(t.iconTransitioningVertexArray,Pi.x,Pi.y+Pi.h),T0(t.iconTransitioningVertexArray,Pi.x+Pi.w,Pi.y+Pi.h)}ve.emplaceBack(cr,cr+1,cr+2),ve.emplaceBack(cr+1,cr+2,cr+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ki[0]),yt!==o.length-1&&xr===o[yt+1].sectionIndex||t.programConfigurations.populatePaintArrays(Fe.length,v,v.index,{},$,ee,ae,gt&&gt[xr],this.worldview)}const ht=I?I.anchor:F;t.placedSymbolArray.emplaceBack(ht.x,ht.y,ht.z,F.x,F.y,Ee,this.glyphOffsetArray.length-Ee,ke,k,z,F.segment,h?h[0]:0,h?h[1]:0,f[0],f[1],C,0,0,0,H,0)}_commitLayoutVertex(t,o,h,f,m,v,C){t.emplaceBack(o,h,f,m,v,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(t,o,h,f,m,v,C){const I=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),F=I.vertexLength,k=C.tileAnchorX,z=C.tileAnchorY;for(let $=0;$<4;$++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,o,t.padding,C.zOffset),this._commitLayoutVertex(h.layoutVertexArray,f,m,v,k,z,new qt(t.x1,t.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,m,v,k,z,new qt(t.x2,t.y1)),this._commitLayoutVertex(h.layoutVertexArray,f,m,v,k,z,new qt(t.x2,t.y2)),this._commitLayoutVertex(h.layoutVertexArray,f,m,v,k,z,new qt(t.x1,t.y2)),I.vertexLength+=4;const H=h.indexArray;H.emplaceBack(F,F+1),H.emplaceBack(F+1,F+2),H.emplaceBack(F+2,F+3),H.emplaceBack(F+3,F),I.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,h,f,m,v){for(let C=f;C<m;C++){const I=h.get(C),F=this.getSymbolInstanceTextSize(t,v,o,C);this._addCollisionDebugVertices(I,F,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,o,h,f,m,v){for(let C=f;C<m;C++){const I=h.get(C),F=this.getSymbolInstanceIconSize(t,o,v.placedIconSymbolIndex);this._addCollisionDebugVertices(I,F,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,o,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sx(jf,H2.members,Lh),this.iconCollisionBox=new sx(jf,H2.members,Lh);const f=Rm(this.iconSizeData,t),m=Rm(this.textSizeData,t,h);for(let v=0;v<this.symbolInstances.length;v++){const C=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,t,o,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(m,t,o,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,t,o,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,t,o,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(t,o,h,f){const m=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),v=$_(this.textSizeData,t,m)/il;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,o,h){const f=this.icon.placedSymbolArray.get(h),m=$_(this.iconSizeData,t,f);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(t,o,h,f){t.emplaceBack(o,-h,-h,f),t.emplaceBack(o,h,-h,f),t.emplaceBack(o,h,h,f),t.emplaceBack(o,-h,h,f)}_updateTextDebugCollisionBoxes(t,o,h,f,m,v,C){for(let I=f;I<m;I++){const F=h.get(I),k=this.getSymbolInstanceTextSize(t,v,o,I);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,F.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(t,o,h,f,m,v,C){for(let I=f;I<m;I++){const F=h.get(I),k=this.getSymbolInstanceIconSize(t,o,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,F.padding,v.zOffset)}}updateCollisionDebugBuffers(t,o,h,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=Rm(this.iconSizeData,t,f),v=Rm(this.textSizeData,t,h);for(let C=0;C<this.symbolInstances.length;C++){const I=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(v,t,o,I.textBoxStartIndex,I.textBoxEndIndex,I,h),this._updateTextDebugCollisionBoxes(v,t,o,I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,h),this._updateIconDebugCollisionBoxes(m,t,o,I.iconBoxStartIndex,I.iconBoxEndIndex,I,f),this._updateIconDebugCollisionBoxes(m,t,o,I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,h,f,m,v,C,I,F){const k={};if(o<h){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce,featureIndex:Ee}=t.get(o);k.textBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce},k.textFeatureIndex=Ee}if(f<m){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce,featureIndex:Ee}=t.get(f);k.verticalTextBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce},k.verticalTextFeatureIndex=Ee}if(v<C){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce,featureIndex:Ee}=t.get(v);k.iconBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce},k.iconFeatureIndex=Ee}if(I<F){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce,featureIndex:Ee}=t.get(I);k.verticalIconBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:Ae,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Le,tileAnchorY:ce},k.verticalIconFeatureIndex=Ee}return k}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const h=t.placedSymbolArray.get(o),f=h.vertexStartIndex+4*h.numGlyphs;for(let m=h.vertexStartIndex;m<f;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),h=Math.cos(t),f=[],m=[],v=[];for(let C=0;C<this.symbolInstances.length;++C){v.push(C);const I=this.symbolInstances.get(C);f.push(0|Math.round(o*I.tileAnchorX+h*I.tileAnchorY)),m.push(I.featureIndex)}return v.sort((C,I)=>f[C]-f[I]||m[I]-m[C]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,o){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===o?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const h=this.symbolInstances.get(o);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:F}=h;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),m>=0&&m!==f&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),F>=0&&this.addIndicesForPlacedSymbol(this.icon,F)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let TB,IB,ox;Zi(M0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),M0.addDynamicAttributes=L0;class FB{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ou,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zi(FB,"FormatSectionOverride",{omit:["defaultValue"]});const ax=()=>ox||(ox={layout:TB||(TB=new Us({"symbol-placement":new Ei(Ft.layout_symbol["symbol-placement"]),"symbol-spacing":new Ei(Ft.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ei(Ft.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gi(Ft.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ei(Ft.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ei(Ft.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Ei(Ft.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Ei(Ft.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ei(Ft.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ei(Ft.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ei(Ft.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gi(Ft.layout_symbol["icon-size"]),"icon-size-scale-range":new Ei(Ft.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Gi(Ft.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gi(Ft.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gi(Ft.layout_symbol["icon-image"]),"icon-rotate":new Gi(Ft.layout_symbol["icon-rotate"]),"icon-padding":new Ei(Ft.layout_symbol["icon-padding"]),"icon-keep-upright":new Ei(Ft.layout_symbol["icon-keep-upright"]),"icon-offset":new Gi(Ft.layout_symbol["icon-offset"]),"icon-anchor":new Gi(Ft.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ei(Ft.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ei(Ft.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ei(Ft.layout_symbol["text-rotation-alignment"]),"text-field":new Gi(Ft.layout_symbol["text-field"]),"text-font":new Gi(Ft.layout_symbol["text-font"]),"text-size":new Gi(Ft.layout_symbol["text-size"]),"text-size-scale-range":new Ei(Ft.layout_symbol["text-size-scale-range"]),"text-max-width":new Gi(Ft.layout_symbol["text-max-width"]),"text-line-height":new Gi(Ft.layout_symbol["text-line-height"]),"text-letter-spacing":new Gi(Ft.layout_symbol["text-letter-spacing"]),"text-justify":new Gi(Ft.layout_symbol["text-justify"]),"text-radial-offset":new Gi(Ft.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ei(Ft.layout_symbol["text-variable-anchor"]),"text-anchor":new Gi(Ft.layout_symbol["text-anchor"]),"text-max-angle":new Ei(Ft.layout_symbol["text-max-angle"]),"text-writing-mode":new Ei(Ft.layout_symbol["text-writing-mode"]),"text-rotate":new Gi(Ft.layout_symbol["text-rotate"]),"text-padding":new Ei(Ft.layout_symbol["text-padding"]),"text-keep-upright":new Ei(Ft.layout_symbol["text-keep-upright"]),"text-transform":new Gi(Ft.layout_symbol["text-transform"]),"text-offset":new Gi(Ft.layout_symbol["text-offset"]),"text-allow-overlap":new Ei(Ft.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ei(Ft.layout_symbol["text-ignore-placement"]),"text-optional":new Ei(Ft.layout_symbol["text-optional"]),visibility:new Ei(Ft.layout_symbol.visibility)})),paint:IB||(IB=new Us({"icon-opacity":new Gi(Ft.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Gi(Ft.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Gi(Ft.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Gi(Ft.paint_symbol["text-emissive-strength"]),"icon-color":new Gi(Ft.paint_symbol["icon-color"]),"icon-halo-color":new Gi(Ft.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gi(Ft.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gi(Ft.paint_symbol["icon-halo-blur"]),"icon-translate":new Ei(Ft.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ei(Ft.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ei(Ft.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Gi(Ft.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Gi(Ft.paint_symbol["text-occlusion-opacity"]),"text-color":new Gi(Ft.paint_symbol["text-color"],{runtimeType:na,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Gi(Ft.paint_symbol["text-halo-color"]),"text-halo-width":new Gi(Ft.paint_symbol["text-halo-width"]),"text-halo-blur":new Gi(Ft.paint_symbol["text-halo-blur"]),"text-translate":new Ei(Ft.paint_symbol["text-translate"]),"text-translate-anchor":new Ei(Ft.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ei(Ft.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ei(Ft.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ei(Ft.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ei(Ft.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Gi(Ft.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},ox);class P0 extends Wa{constructor(t,o,h,f){super(t,ax(),o,h,f),this._colorAdjustmentMatrix=P([]),this.hasInitialOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}recalculate(t,o){super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const f=[];for(const m of h)f.indexOf(m)<0&&f.push(m);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,o,h,f){return this._saturation===t&&this._contrast===o&&this._brightnessMin===h&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(m,v,C,I){m=Bo(m),v=Ra(v);const F=R(),k=m/3,z=1-2*k,H=[z,k,k,0,k,z,k,0,k,k,z,0,0,0,0,1],$=.5-.5*v,ee=I-C;return U(F,[ee,0,0,0,0,ee,0,0,0,0,ee,0,C,C,C,1],[v,0,0,0,0,v,0,0,0,0,v,0,$,$,$,1]),U(F,F,H),F}(t,o,h,f),this._saturation=t,this._contrast=o,this._brightnessMin=h,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,o,h,f){const m=this.layout.get(t).evaluate(o,{},h,f),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||oa(v.value)||!m?m:function(C,I){return I.replace(/{([^{}]+)}/g,(F,k)=>k in C?String(C[k]):"")}(o.properties,m)}createBucket(t){return new M0(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of ax().paint.overridableProperties){if(!P0.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),h=new FB(o),f=new bo(h,o.property.specification,this.scope,this.options);let m=null;m=o.value.kind==="constant"||o.value.kind==="source"?new Na("source",f):new ja("composite",f,o.value.zoomStops,o.value.interpolationType),this.paint._values[t]=new ca(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,h){return!(!this.layout||o.isDataDriven()||h.isDataDriven())&&P0.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const h=t.get("text-field"),f=ax().paint.properties[o];let m=!1;const v=C=>{for(const I of C)if(f.overrides&&f.overrides.hasOverride(I))return void(m=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Zn)v(h.value.value.sections);else if(h.value.kind==="source"){const C=F=>{m||(F instanceof Pr&&ji(F.value)===Et?v(F.value.sections):F instanceof vo?v(F.sections):F.eachChild(C))},I=h.value;I._styleExpression&&C(I._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,o,h){return{config:new IA(this,{zoom:o,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let LB,MB,PB,kB;var lx=Rn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function cx(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function ux(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class hx{constructor(t,o,h,f){this.context=t,this.format=h,this.useMipmap=f&&f.useMipmap,this.texture=t.gl.createTexture(),this.update(o,{premultiply:f&&f.premultiply})}update(t,o){const h=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,f=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:m}=this,{gl:v}=m,{x:C,y:I}=o&&o.position?o.position:{x:0,y:0},F=C+h,k=I+f;!this.size||this.size[0]===F&&this.size[1]===k||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!o||o.premultiply!==!1));const z=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&F>0&&k>0){const H=this.useMipmap?Math.floor(Math.log2(Math.max(F,k)))+1:1;v.texStorage2D(v.TEXTURE_2D,H,this.format,F,k),this.size=[F,k]}if(this.size)if(z)v.texSubImage2D(v.TEXTURE_2D,0,C,I,cx(this.format),ux(this.format),t);else{const H=t.data;H&&v.texSubImage2D(v.TEXTURE_2D,0,C,I,h,f,cx(this.format),ux(this.format),H)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(t,o,h=!1){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!h?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),o!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,h,f,m){const{context:v}=this,{gl:C}=v;C.bindTexture(C.TEXTURE_2D,this.texture),o!==this.magFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,this.useMipmap?t===C.NEAREST?C.NEAREST_MIPMAP_NEAREST:C.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),h!==this.wrapS&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,h),this.wrapS=h),f!==this.wrapT&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,f),this.wrapT=f),m!==this.compareMode&&(m?(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.COMPARE_REF_TO_TEXTURE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_FUNC,m)):C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.NONE),this.compareMode=m)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class k0{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:h}=this,{gl:f}=h;f.bindTexture(f.TEXTURE_2D,this.texture),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}}function R0(l,t,o,h,f,m,v,C){const I=[l,t,1,o,h,1,f,m,1],F=[v,C,1],k=T([],I),[z,H,$]=Ut(F,F,k);return E(I,I,[z,0,0,0,H,0,0,0,$])}function RB(l,t,o,h,f,m,v,C){const I=function(F,k,z,H,$,ee,ae,Ae){const ve=R0(0,0,1,0,1,1,0,1),Fe=R0(F,k,z,H,$,ee,ae,Ae);return E(Fe,Fe,T([],ve))}(l,t,o,h,f,m,v,C);return[I[2]/I[8]/wi,I[5]/I[8]/wi]}function D0(l){return[l[0],Math.min(Math.max(l[1],-85.051129),ti)]}class DB extends gu{constructor(t,o,h,f){super(),this.id=t,this.dispatcher=h,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new Qc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=dh(this.map._requestManager.transformRequest(this.url,uh.Image),(h,f)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new Jl(h)):f&&(this.image=f instanceof HTMLImageElement?pl.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new k0(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Qc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof k0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],h=t[0][1];for(const m of t)m[1]>h&&(h=m[1]),m[1]<o&&(o=m[1]);const f=(h+o)/2;if(f>ti?this.onNorthPole=!0:f<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=t.map(wt.fromLngLat);this.tileID=function(v){let C=1/0,I=1/0,F=-1/0,k=-1/0;for(const ae of v)C=Math.min(C,ae.x),I=Math.min(I,ae.y),F=Math.max(F,ae.x),k=Math.max(k,ae.y);const z=Math.max(F-C,k-I),H=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),$=Math.pow(2,H);let ee=Math.floor((C+F)/2*$);return ee>1&&(ee-=1),new hc(H,ee,Math.floor((I+k)/2*$))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Qc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const ve in this.tiles){const Fe=this.tiles[ve];Fe.state!=="loaded"&&(Fe.state="loaded",Fe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Um(new hc(0,0,0),this.map.transform.projection),h=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ve){const Fe=ve[1].x-ve[0].x,Le=ve[1].y-ve[0].y,ce=ve[2].x-ve[1].x,Ee=ve[2].y-ve[1].y,ke=ve[3].x-ve[2].x,He=ve[3].y-ve[2].y,gt=ve[0].x-ve[3].x,ht=ve[0].y-ve[3].y,yt=Fe*Ee-ce*Le,Lt=ce*He-ke*Ee,Wt=ke*ht-gt*He,Si=gt*Le-Fe*ht;return yt>0&&Lt>0&&Wt>0&&Si>0||yt<0&&Lt<0&&Wt<0&&Si<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Um(this.tileID,this.map.transform.projection),[m,v,C,I]=this.coordinates.map(ve=>{const Fe=f.projection.project(ve[0],ve[1]);return bB(f,Fe)._round()});this.perspectiveTransform=RB(m.x,m.y,v.x,v.y,C.x,C.y,I.x,I.y);const F=this._boundsArray=new _A;F.emplaceBack(m.x,m.y,0,0),F.emplaceBack(v.x,v.y,wi,0),F.emplaceBack(I.x,I.y,0,wi),F.emplaceBack(C.x,C.y,wi,wi),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(F,lx.members),this.boundsSegments=Vs.simpleSegment(0,0,4,2);const k=[],z=[D0((H=this.coordinates)[0]),D0(H[1]),D0(H[2]),D0(H[3])];var H;const[$,ee,ae,Ae]=function(ve){let Fe=ve[0][0],Le=Fe,ce=ve[0][1],Ee=ce;for(let ke=1;ke<ve.length;ke++)ve[ke][0]<Fe?Fe=ve[ke][0]:ve[ke][0]>Le&&(Le=ve[ke][0]),ve[ke][1]<ce?ce=ve[ke][1]:ve[ke][1]>Ee&&(Ee=ve[ke][1]);return[Fe,ce,Le-Fe,Ee-ce]}(z);{const ve=new _A,[Fe,Le,ce,Ee]=function($t){let _i=$t[0].x,Gt=_i,Yt=$t[0].y,ki=Yt;for(let Di=1;Di<$t.length;Di++)$t[Di].x<_i?_i=$t[Di].x:$t[Di].x>Gt&&(Gt=$t[Di].x),$t[Di].y<Yt?Yt=$t[Di].y:$t[Di].y>ki&&(ki=$t[Di].y);return[_i,Yt,Gt-_i,ki-Yt]}(h),ke=$t=>[($t.x-Fe)/ce,($t.y-Le)/Ee],[He,gt,ht,yt]=h.map(ke),Lt=function($t,_i,Gt,Yt,ki,Di,xr,cr){const Xi=R0(0,0,1,0,1,1,0,1);return E(Xi,Xi,T([],R0($t,_i,Gt,Yt,ki,Di,xr,cr)))}(He[0],He[1],gt[0],gt[1],ht[0],ht[1],yt[0],yt[1]);this.elevatedGlobePerspectiveTransform=RB(He[0],He[1],gt[0],gt[1],ht[0],ht[1],yt[0],yt[1]);const Wt=($t,_i)=>{k.push($t.lng);const Gt=Math.round(($t.lng-$)/ae*wi),Yt=Math.round(($t.lat-ee)/Ae*wi),ki=ke(_i),Di=Ut([],[ki[0],ki[1],1],Lt),xr=Math.round(Di[0]/Di[2]*wi),cr=Math.round(Di[1]/Di[2]*wi);ve.emplaceBack(Gt,Yt,xr,cr)},Si=h[3].x-h[0].x,fi=h[3].y-h[0].y,Ci=h[2].x-h[1].x,Ii=h[2].y-h[1].y;for(let $t=0;$t<65;$t++){const _i=$t/64,Gt=[h[0].x+_i*Si,h[0].y+_i*fi],Yt=[h[1].x+_i*Ci,h[1].y+_i*Ii],ki=Yt[0]-Gt[0],Di=Yt[1]-Gt[1];for(let xr=0;xr<65;xr++){const cr=xr/64,Xi={x:Gt[0]+ki*cr,y:Gt[1]+Di*cr};Wt(o.projection.unproject(Xi.x,Xi.y),Xi)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(ve,lx.members)}{this.maxLongitudeTriangleSize=0;let ve=[],Fe=new Zo;const Le=(ce,Ee,ke)=>{Fe.emplaceBack(ce,Ee,ke);const He=k[ce],gt=k[Ee],ht=k[ke],yt=Math.min(Math.min(He,gt),ht),Lt=Math.max(Math.max(He,gt),ht)-yt;Lt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Lt),ve.push(yt+Lt/2)};for(let ce=0;ce<64;ce++)for(let Ee=0;Ee<64;Ee++){const ke=65*ce+Ee,He=ke+1,gt=ke+65,ht=gt+1;Le(ke,gt,He),Le(He,gt,ht)}[ve,Fe]=function(ce,Ee){const ke=Array.from({length:ce.length},(ht,yt)=>yt);ke.sort((ht,yt)=>ce[ht]-ce[yt]);const He=[],gt=new Zo;for(let ht=0;ht<ke.length;ht++){const yt=ke[ht];He.push(ce[yt]);const Lt=3*yt,Wt=Lt+1;gt.emplaceBack(Ee.uint16[Lt],Ee.uint16[Wt],Ee.uint16[Wt+1])}return[He,gt]}(ve,Fe),this.elevatedGlobeTrianglesCenterLongitudes=ve,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(Fe)}this.elevatedGlobeSegments=Vs.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ae/wi,0,Ae/wi,0,0,ee,$,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,h=o.gl;!this._dirty||this.texture instanceof k0||(this.texture?this.texture.update(this.image):(this.texture=new hx(o,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let f=(m=t+180)+360*Math.round((h[0]-m)/360);var m;const v=new Vs,C=(z,H)=>{v.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:o.segments[0].vertexLength,primitiveLength:H,sortKey:void 0,vaos:{}})},I=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-f)<=I){const z=Oo(h,0,h.length,f+I);return z===h.length||C(z,cs(h,z+1,h.length,f+360-I)-z),v}f<h[0]&&(f+=360);const F=cs(h,0,h.length,f-I);if(F===h.length)return C(0,h.length),v;C(0,F-0);const k=Oo(h,F+1,h.length,f+I);return k!==h.length&&C(k,h.length-k),v}}const WL=(Math.pow(256,2)-1)/16907520;class OB extends Wa{constructor(t,o,h,f){super(t,{layout:PB||(PB=new Us({visibility:new Ei(Ft.layout_raster.visibility)})),paint:kB||(kB=new Us({"raster-opacity":new Ei(Ft.paint_raster["raster-opacity"]),"raster-color":new Gu(Ft.paint_raster["raster-color"]),"raster-color-mix":new Ei(Ft.paint_raster["raster-color-mix"]),"raster-color-range":new Ei(Ft.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ei(Ft.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ei(Ft.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ei(Ft.paint_raster["raster-brightness-max"]),"raster-saturation":new Ei(Ft.paint_raster["raster-saturation"]),"raster-contrast":new Ei(Ft.paint_raster["raster-contrast"]),"raster-resampling":new Ei(Ft.paint_raster["raster-resampling"]),"raster-fade-duration":new Ei(Ft.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ei(Ft.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ei(Ft.paint_raster["raster-array-band"]),"raster-elevation":new Ei(Ft.paint_raster["raster-elevation"]),"raster-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},o,h,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof DB&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[h,f]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(f)||h===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=ym({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,f])}}let UB,zB,NB,jB,HB;class QB extends Wa{constructor(t,o,h,f){super(t,{layout:UB||(UB=new Us({visibility:new Ei(Ft["layout_raster-particle"].visibility)})),paint:zB||(zB=new Us({"raster-particle-array-band":new Ei(Ft["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ei(Ft["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Gu(Ft["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ei(Ft["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ei(Ft["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ei(Ft["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ei(Ft["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ei(Ft["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},o,h,f),this._updateColorRamp(),this.lastInvalidatedAt=pl.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=ym({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=pl.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class XL extends Wa{constructor(t,o){super(t,{},o,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(t){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function dx(l,t,o){const h=[0,0,1],f=pi([]);return Oi(f,f,o?-dn(l)+Math.PI:dn(l)),Ri(f,f,-dn(t)),Ai(h,h,f),mt(h,h)}function VB(l,t){const o=O0(l.projection,l.zoom,l.width,l.height),h=function(m,v,C,I,F){const k=new Te(C.lng-180*rp,C.lat),z=new Te(C.lng+180*rp,C.lat),H=m.project(k.lng,k.lat),$=m.project(z.lng,z.lat),ee=-Math.atan2($.y-H.y,$.x-H.x),ae=wt.fromLngLat(C);ae.y=Ge(ae.y,-1+rp,1-rp);const Ae=ae.toLngLat(),ve=m.project(Ae.lng,Ae.lat),Fe=wt.fromLngLat(Ae);Fe.x+=rp;const Le=Fe.toLngLat(),ce=m.project(Le.lng,Le.lat),Ee=WB(ce.x-ve.x,ce.y-ve.y,ee),ke=wt.fromLngLat(Ae);ke.y+=rp;const He=ke.toLngLat(),gt=m.project(He.lng,He.lat),ht=WB(gt.x-ve.x,gt.y-ve.y,ee),yt=Math.abs(Ee.x)/Math.abs(ht.y),Lt=P([]);pe(Lt,Lt,-ee*(1-(F?0:I)));const Wt=P([]);return q(Wt,Wt,[1,1-(1-yt)*I,1]),Wt[4]=-ht.x/ht.y*I,pe(Wt,Wt,ee),U(Wt,Lt,Wt),Wt}(l.projection,0,l.center,o,t),f=GB(l);return q(h,h,[f,f,1]),h}function GB(l){const t=l.projection,o=O0(l.projection,l.zoom,l.width,l.height),h=Ax(t,l.center),f=Ax(t,Te.convert(t.center));return Math.pow(2,h*o+(1-o)*f)}function O0(l,t,o,h,f=1/0){const m=l.range;if(!m)return 0;const v=Math.min(f,Math.max(o,h)),C=Math.log(v/1024)/Math.LN2;return vt(m[0]+C,m[1]+C,t)}const rp=1/4e4;function Ax(l,t){const o=Ge(t.lat,-85.051129,ti),h=new Te(t.lng-180*rp,o),f=new Te(t.lng+180*rp,o),m=l.project(h.lng,o),v=l.project(f.lng,o),C=wt.fromLngLat(h),I=wt.fromLngLat(f),F=v.x-m.x,k=v.y-m.y,z=I.x-C.x,H=I.y-C.y,$=Math.sqrt((z*z+H*H)/(F*F+k*k));return Math.log($)/Math.LN2}function WB(l,t,o){const h=Math.cos(o),f=Math.sin(o);return{x:l*h-t*f,y:l*f+t*h}}function XB(l,t,o){P(l),pe(l,l,dn(t[2])),ne(l,l,dn(t[0])),re(l,l,dn(t[1])),q(l,l,o),U(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function U0(l,t,o,h,f,m,v,C){const I=[o[0]-t[0],o[1]-t[1],0],F=[h[0]-t[0],h[1]-t[1],0];if(Me(I)<1e-12||Me(F)<1e-12)return pi(l);const k=rt([],I,F);mt(k,k),De(F,h,t),I[2]=(m-f)*C,F[2]=(v-f)*C;const z=I;return rt(z,I,F),mt(z,z),ui(l,k,z)}function fx(l,t,o=!1){const h=Zf(t.zoom),f=function(m,v,C){const I=v.worldSize,F=[m[12],m[13],m[14]],k=kt(F[1]/I),z=dt(F[0]/I),H=P([]),$=lt(1,k)*I,ee=lt(1,0)*I*vi(k,v.zoom),ae=1/x_(I);let Ae=ee*ae;if(C){const ce=O0(v.projection,v.zoom,v.width,v.height,1024);Ae=ae*v.projection.pixelSpaceConversion(v.center.lat,I,ce)}const ve=ue(k,z);Pe(ve,ve,pt([],mt([],ve),$*Ae*F[2]));const Fe=function(ce){const Ee=[ce[0],ce[1],ce[2]];let ke=[0,1,0];const He=rt([],ke,Ee);return rt(ke,Ee,He),ot(ke)===0&&(ke=[0,1,0],rt(He,Ee,ke)),mt(He,He),mt(ke,ke),mt(Ee,Ee),[He[0],He[1],He[2],0,ke[0],ke[1],ke[2],0,Ee[0],Ee[1],Ee[2],0,ce[0],ce[1],ce[2],1]}(ve);q(H,H,[Ae,Ae,Ae*$]),Q(H,H,[-F[0],-F[1],-F[2]]);const Le=U([],v.globeMatrix,Fe);return U(Le,Le,H),U(Le,Le,m),Le}(l,t,o);if(h>0){const m=function(v,C){const I=C.worldSize,F=lt(1,0)*I*vi(C.center.lat,C.zoom)/x_(I),k=lt(1,C.center.lat)*I,z=P([]);return re(z,z,dn(C.center.lng)),ne(z,z,dn(C.center.lat)),Q(z,z,[0,0,S]),q(z,z,[F,F,F*k]),Q(z,z,[C.point.x-.5*I,C.point.y-.5*I,0]),U(z,z,v),U(z,C.globeMatrix,z)}(l,t);return function(v,C,I){const F=(ee,ae,Ae)=>{const ve=Me(ee),Fe=Me(ae),Le=Af(ee,ae,Ae);return pt(Le,Le,1/Me(Le)*Er(ve,Fe,Ae))},k=F([v[0],v[1],v[2]],[C[0],C[1],C[2]],I),z=F([v[4],v[5],v[6]],[C[4],C[5],C[6]],I),H=F([v[8],v[9],v[10]],[C[8],C[9],C[10]],I),$=Af([v[12],v[13],v[14]],[C[12],C[13],C[14]],I);return[k[0],k[1],k[2],0,z[0],z[1],z[2],0,H[0],H[1],H[2],0,$[0],$[1],$[2],1]}(f,m,h)}return f}function YB(l,t,o,h){const f=Re.projectAabbCorners(h,o);let m=Number.MAX_VALUE,v=-1;for(let F=0;F<f.length;++F){const k=f[F];k[0]=(.5*k[0]+.5)*t.width,k[1]=(.5-.5*k[1])*t.height,k[2]<m&&(v=F,m=k[2])}const C=F=>new qt(f[F][0],f[F][1]);let I;switch(v){case 0:case 6:I=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:I=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:I=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:I=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(Ui(l,I))return m}const YL=Rn([{name:"a_pos_3f",components:3,type:"Float32"}]),KL=Rn([{name:"a_color_3f",components:3,type:"Float32"}]),qL=Rn([{name:"a_color_4f",components:4,type:"Float32"}]),$L=Rn([{name:"a_uv_2f",components:2,type:"Float32"}]),ZL=Rn([{name:"a_normal_3f",components:3,type:"Float32"}]),JL=Rn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),eM=Rn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),KB={None:0,Model:1,Symbol:2,FillExtrusion:4};class z0{constructor(t,o,h,f){this.message=(t?`${t}: `:"")+h,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function px(l,t){const o=l.indexOf("://")===-1;try{return new URL(l,o&&t?"http://example.com":void 0),!0}catch{return!1}}class qB{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class $B{constructor(){this.instancedDataArray=new Zh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class gx{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=t.projection,this.index=t.index,this.worldview=t.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=t.styleDefinedModelURLs}updateFootprints(t,o){}populate(t,o,h,f){this.tileToMeter=Vt(h);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:C,index:I,sourceLayerIndex:F}of t){const k=C??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),z=Ki(v,m);if(!this.layers[0]._featureFilter.filter(new Xn(this.zoom,{worldview:this.worldview}),z,h))continue;const H={id:k,sourceLayerIndex:F,index:I,geometry:m?z.geometry:tr(v,h,f),properties:v.properties,type:v.type,patterns:{}},$=this.addFeature(H,H.geometry,z);$&&o.featureIndex.insert(v,H.geometry,I,F,this.index,this.instancesPerModel[$].instancedDataArray.length,wi/32)}this.lookup=null}update(t,o,h,f){for(const m in this.instancesPerModel){const v=this.instancesPerModel[m];for(const C in t)v.idToFeaturesIndex.hasOwnProperty(C)&&(this.evaluate(v.features[v.idToFeaturesIndex[C]],t[C],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];for(const f of h.features){const m=this.layers[0],v=f.feature,C=this.canonical,I=m.paint.get("model-rotation").evaluate(v,{},C),F=m.paint.get("model-scale").evaluate(v,{},C),k=m.paint.get("model-translation").evaluate(v,{},C);qe(f.rotation,I)&&qe(f.scale,F)&&qe(f.translation,k)||(this.evaluate(f,f.featureStates,h,!0),t=!0)}}return t}updateReplacement(t,o,h,f){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const m=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(P_(this.activeReplacements,m))return!1;this.activeReplacements=m;let v=!1;for(const C in this.instancesPerModel){const I=this.instancesPerModel[C],F=I.instancedDataArray;for(const k of I.features){const z=k.instancedDataOffset,H=k.instancedDataCount;for(let $=0;$<H;$++){const ee=16*($+z);let ae=F.float32[ee+0];const Ae=ae>wi;ae=Ae?ae-wi:ae;const ve=Math.floor(ae),Fe=F.float32[ee+1];let Le=!1;for(const ce of this.activeReplacements)if(!Qw(ce,h,KB.Model,f)&&!(ce.min.x>ve||ve>ce.max.x||ce.min.y>Fe||Fe>ce.max.y)&&(Le=Kw(Yw(ve,Fe,t.canonical,ce.footprintTileId.canonical),ce.footprint),Le))break;F.float32[ee]=Le?ae+wi:ae,v=v||Le!==Ae}}}return v}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=t.createVertexBuffer(h.instancedDataArray,JL.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)t.removeModel(o,"",!0)}addFeature(t,o,h){const f=this.layers[0],m=f.layout.get("model-id").evaluate(h,{},this.canonical);if(!m)return Yr(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),m;(px(m,!1)||this.styleDefinedModelURLs[m]!==void 0)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new $B);const v=this.instancesPerModel[m],C=v.instancedDataArray,I=new qB(h,C.length);for(const F of o)for(const k of F){if(k.x<0||k.x>=wi||k.y<0||k.y>=wi)continue;const z=(this.lookupDim-1)/wi,H=this.lookupDim*(k.y*z|0)+k.x*z|0;if(this.lookup){if(this.lookup[H]!==0)continue;this.lookup[H]=1}this.instanceCount++;const $=C.length;C.resize($+1),v.instancesEvaluatedElevation.push(0),C.float32[16*$]=k.x,C.float32[16*$+1]=k.y}return I.instancedDataCount=v.instancedDataArray.length-I.instancedDataOffset,I.instancedDataCount>0&&(t.id&&(v.idToFeaturesIndex[t.id]=v.features.length),v.features.push(I),this.evaluate(I,{},v,!1)),m}getModelUris(){return this.modelUris}evaluate(t,o,h,f){const m=this.layers[0],v=t.feature,C=this.canonical,I=t.rotation=m.paint.get("model-rotation").evaluate(v,o,C),F=t.scale=m.paint.get("model-scale").evaluate(v,o,C),k=t.translation=m.paint.get("model-translation").evaluate(v,o,C),z=m.paint.get("model-color").evaluate(v,o,C);z.a=m.paint.get("model-color-mix-intensity").evaluate(v,o,C);const H=[];this.maxVerticalOffset<k[2]&&(this.maxVerticalOffset=k[2]),this.maxScale=Math.max(Math.max(this.maxScale,F[0]),Math.max(F[1],F[2])),XB(H,I,F);const $=Math.round(100*z.a)+z.b/1.05;for(let ee=0;ee<t.instancedDataCount;++ee){const ae=t.instancedDataOffset+ee,Ae=16*ae,ve=h.instancedDataArray.float32;let Fe=0;f&&(Fe=ve[Ae+6]-h.instancesEvaluatedElevation[ae]);const Le=0|ve[Ae+1];ve[Ae]=(0|ve[Ae])+z.r/1.05,ve[Ae+1]=Le+z.g/1.05,ve[Ae+2]=$,ve[Ae+3]=1/(C.z>10?this.tileToMeter:Vt(C,Le)),ve[Ae+4]=k[0],ve[Ae+5]=k[1],ve[Ae+6]=k[2]+Fe,ve[Ae+7]=H[0],ve[Ae+8]=H[1],ve[Ae+9]=H[2],ve[Ae+10]=H[4],ve[Ae+11]=H[5],ve[Ae+12]=H[6],ve[Ae+13]=H[8],ve[Ae+14]=H[9],ve[Ae+15]=H[10],h.instancesEvaluatedElevation[ae]=k[2]}}}let ZB,JB;Zi(gx,"ModelBucket",{omit:["layers"]}),Zi($B,"PerModelAttributes"),Zi(qB,"ModelFeature");const Vp=64,Pg={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function eC(l,t,o,h,f,m,v,C,I,F=!1){const k=o.zoom,z=o.project(h),H=vi(h.lat,k),$=1/H;P(l),Q(l,l,[z.x+v[0]*$,z.y+v[1]*$,v[2]]);let ee=1,ae=1;const Ae=o.worldSize;if(F){if(o.projection.name==="mercator"){let ce=0;o.elevation&&(ce=o.elevation.getAtPointOrZero(new wt(z.x/Ae,z.y/Ae),0));const Ee=Kt([],[z.x,z.y,ce,1],o.projMatrix)[3]/o.cameraToCenterDistance;ee=Ee,ae=Ee*vi(o.center.lat,k)}else if(o.projection.name==="globe"){const ce=fx(l,o),Ee=[0,0,0,1];Kt(Ee,Ee,U([],o.projMatrix,ce));const ke=Ee[3]/o.cameraToCenterDistance,He=Zf(k),gt=o.projection.pixelsPerMeter(h.lat,Ae)*vi(h.lat,k),ht=o.projection.pixelsPerMeter(o.center.lat,Ae)*vi(o.center.lat,k);ee=ke/Er(gt,ri(o.center.lat),He),ae=ke*H/gt,ee*=ht,ae*=ht}}else ee=$;q(l,l,[ee,ee,ae]);const ve=[...l],Fe=t.orientation,Le=[];if(XB(Le,[Fe[0]+f[0],Fe[1]+f[1],Fe[2]+f[2]],m),U(l,ve,Le),C&&o.elevation){let ce=0;const Ee=[];if(I&&o.elevation){ce=function(He,gt,ht,yt,Lt){const Wt=gt.elevation;if(!Wt)return 0;const Si=Re.projectAabbCorners(ht,yt),fi=lt(1,Lt.lat)*gt.worldSize,Ci=function(Pi,$r){const or=[0,0,1],Ar=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Nr of Ar){const an=Pi[Nr.corners[0]],on=Pi[Nr.corners[1]],vn=Pi[Nr.corners[2]],un=[on[0]-an[0],on[1]-an[1],$r*(on[2]-an[2])],_n=rt(un,un,[vn[0]-an[0],vn[1]-an[1],$r*(vn[2]-an[2])]);mt(_n,_n),Nr.dotProductWithUp=Ct(_n,or)}return Ar.sort((Nr,an)=>Nr.dotProductWithUp-an.dotProductWithUp),Ar[0].corners}(Si,fi),Ii=Si[Ci[0]],$t=Si[Ci[1]],_i=Si[Ci[2]],Gt=Si[Ci[3]],Yt=Wt.getAtPointOrZero(new wt(Ii[0]/gt.worldSize,Ii[1]/gt.worldSize),0),ki=Wt.getAtPointOrZero(new wt($t[0]/gt.worldSize,$t[1]/gt.worldSize),0),Di=Wt.getAtPointOrZero(new wt(_i[0]/gt.worldSize,_i[1]/gt.worldSize),0),xr=Wt.getAtPointOrZero(new wt(Gt[0]/gt.worldSize,Gt[1]/gt.worldSize),0),cr=(Yt+xr)/2,Xi=(ki+Di)/2;return cr>Xi?ki<Di?U0(He,$t,Gt,Ii,ki,xr,Yt,fi):U0(He,_i,Ii,Gt,Di,Yt,xr,fi):Yt<xr?U0(He,Ii,$t,_i,Yt,ki,Di,fi):U0(He,Gt,_i,$t,xr,Di,ki,fi),Math.max(cr,Xi)}(Ee,o,t.aabb,l,h);const ke=U([],be([],Ee),Le);U(l,ve,ke)}else ce=o.elevation.getAtPointOrZero(new wt(z.x/Ae,z.y/Ae),0);ce!==0&&(l[14]+=ce)}}function Qm(l,t,o=!1){l.uploaded||(l.gfxTexture=new hx(t,l.image,o?t.gl.R8:t.gl.RGBA8,{useMipmap:l.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function tM(l,t,o){l.indexBuffer=t.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=t.createVertexBuffer(l.vertexArray,YL.members,!1,!0),l.normalArray&&(l.normalBuffer=t.createVertexBuffer(l.normalArray,ZL.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=t.createVertexBuffer(l.texcoordArray,$L.members,!1,!0)),l.colorArray&&(l.colorBuffer=t.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?KL:qL).members,!1,!0)),l.featureArray&&(l.pbrBuffer=t.createVertexBuffer(l.featureArray,eM.members,!0)),l.segments=Vs.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const h=l.material;h.pbrMetallicRoughness.baseColorTexture&&Qm(h.pbrMetallicRoughness.baseColorTexture,t),h.pbrMetallicRoughness.metallicRoughnessTexture&&Qm(h.pbrMetallicRoughness.metallicRoughnessTexture,t),h.normalTexture&&Qm(h.normalTexture,t),h.occlusionTexture&&Qm(h.occlusionTexture,t,o),h.emissionTexture&&Qm(h.emissionTexture,t)}function mx(l,t,o){if(l.meshes)for(const h of l.meshes)tM(h,t,o);if(l.children)for(const h of l.children)mx(h,t,o)}function N0(l){if(l.meshes)for(const t of l.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(l.children)for(const t of l.children)N0(t)}function yx(l){if(l.meshes)for(const o of l.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(l.children)for(const o of l.children)yx(o)}class kg{constructor(t,o,h){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=h}static create(t,o,h){const f=h||t.findDEMTileFor(o);if(!f||!f.dem)return;const m=f.dem,v=f.tileID,C=1<<o.canonical.z-v.canonical.z;return new kg(f,m.dim/wi/C,[(o.canonical.x/C-v.canonical.x)*m.dim,(o.canonical.y/C-v.canonical.y)*m.dim])}tileCoordToPixel(t,o){const h=o*this._scale+this._offset[1],f=Math.floor(t*this._scale+this._offset[0]),m=Math.floor(h);return new qt(f,m)}getElevationAt(t,o,h,f){const m=t*this._scale+this._offset[0],v=o*this._scale+this._offset[1],C=Math.floor(m),I=Math.floor(v),F=this._dem;return f=!!f,h?Er(Er(F.get(C,I,f),F.get(C,I+1,f),v-I),Er(F.get(C+1,I,f),F.get(C+1,I+1,f),v-I),m-C):F.get(C,I,f)}getElevationAtPixel(t,o,h){return this._dem.get(t,o,!!h)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*lt(1,t)*this._dem.stride}}const vx=new Float32Array(262144),Gp=new Uint8Array(262144);function tC(l){let t=0;if(l.meshes)for(const o of l.meshes)t=Math.max(t,o.aabb.max[2]);if(l.children)for(const o of l.children)t=Math.max(t,tC(o));return t}function iC(l,t,o){if(l.meshes)for(const h of l.meshes){if(h.aabb.min[0]===1/0)continue;const f=Re.applyTransform(h.aabb,l.matrix);o.insert(t,f.min[0],f.min[1],f.max[0],f.max[1])}if(l.children)for(const h of l.children)iC(h,t,o)}const rC=["","wall","door","roof","window","lamp","logo"];class nC{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:tC(t)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Re([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const o=new Re([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==t&&(h.transformedAabb=Re.applyTransformFast(h.aabb,this.node.matrix),o.encapsulate(h.transformedAabb)),t++;this.aabb=o}return this.aabb}}class j0{constructor(t,o,h,f,m,v,C,I){this.id=h,this.layers=t,this.layerIds=this.layers.map(F=>F.fqid),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.modelTraits|=Pg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=Pg.HasMapboxMeshFeatures),m&&(this.modelTraits|=Pg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.worldview=I,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const F of o)this.nodesInfo.push(new nC(F)),iC(F,C.featureIndexArray.length,C.grid),C.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,C.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(t,o){for(const h of this.getNodesInfo()){const f=h.node;f.footprint&&o.push({footprint:f.footprint,id:t})}}update(t){const o=Object.keys(t).length!==0;if(o&&!this.stateDependentLayers.length)return;const h=o?this.stateDependentLayers:this.layers;if(!Nn(t,this.states))for(const f of h)this.evaluate(f,t);this.states=structuredClone(t)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const h of o){const f=h.node;this.uploaded?this.updatePbrBuffer(f):mx(f,t,!0)}for(const h of o)N0(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const h of t.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),o=!0);return o}needsReEvaluation(t,o,h){const f=t.transform.projectionOptions,m=t.style.getBrightness(),v=this.brightness!==m;if(!this.uploaded||this.dirty||f.name!==this.projection.name||Vm(h.paint.get("model-color").value,v)||Vm(h.paint.get("model-color-mix-intensity").value,v)||Vm(h.paint.get("model-roughness").value,v)||Vm(h.paint.get("model-emissive-strength").value,v)||Vm(h.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=f,this.brightness=m;const C=this.getNodesInfo();for(const I of C)I.state=null;return!0}return!1}evaluateTransform(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const h=this.getNodesInfo(),f=this.id.canonical;for(const m of h){const v=m.feature;m.evaluatedTranslation=o.paint.get("model-translation").evaluate(v,{},f),m.evaluatedScale=o.paint.get("model-scale").evaluate(v,{},f)}}evaluate(t,o){const h=this.getNodesInfo();for(const f of h){if(!f.node.meshes)continue;const m=f.feature,v=o&&o[m.id];if(Nn(v,f.state))continue;f.state=structuredClone(v);const C=f.node.meshes&&f.node.meshes[0].featureData,I=f.evaluatedColor[2],F=f.evaluatedRMEA[2],k=this.id.canonical;if(f.hasTranslucentParts=!1,C){for(let z=0;z<rC.length;z++){const H=rC[z];H.length&&(m.properties.part=H);const $=t.paint.get("model-color").evaluate(m,v,k).toPremultipliedRenderColor(null),ee=t.paint.get("model-color-mix-intensity").evaluate(m,v,k);f.evaluatedColor[z]=[$.r,$.g,$.b,ee],f.evaluatedRMEA[z][0]=t.paint.get("model-roughness").evaluate(m,v,k),f.evaluatedRMEA[z][2]=t.paint.get("model-emissive-strength").evaluate(m,v,k),f.evaluatedRMEA[z][3]=$.a,f.emissionHeightBasedParams[z]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,v,k),!f.hasTranslucentParts&&$.a<1&&(f.hasTranslucentParts=!0)}delete m.properties.part,rM(f,I!==f.evaluatedColor[2]||F!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(m,v,k);f.evaluatedTranslation=t.paint.get("model-translation").evaluate(m,v,k),f.evaluatedScale=t.paint.get("model-scale").evaluate(m,v,k),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,h,f){const m=t.findDEMTileFor(h);if(m&&(m.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const v=kg.create(t,h,m);if(!v)return;this.modelTraits&Pg.HasMapboxMeshFeatures&&this.updateDEM(t,v,h,f);for(const C of this.getNodesInfo()){const I=C.node;if(!I.footprint||!I.footprint.vertices||!I.footprint.vertices.length)continue;const F=I.footprint.vertices;let k=v.getElevationAt(F[0].x,F[0].y,!0,!0);for(let z=1;z<F.length;z++)k=Math.min(k,v.getElevationAt(F[z].x,F[z].y,!0,!0));I.elevation=k}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,h,f){let m=o._dem._modifiedForSources[f];if(m===void 0&&(o._dem._modifiedForSources[f]=[],m=o._dem._modifiedForSources[f]),m.includes(h.canonical))return;const v=o._dem.dim;m.push(h.canonical);let C=!1;for(const I of this.getNodesInfo()){const F=I.node;if(!F.footprint||!F.footprint.grid)continue;const k=F.footprint.grid,z=o.tileCoordToPixel(k.min.x,k.min.y),H=o.tileCoordToPixel(k.max.x,k.max.y),$=Math.min(Math.min(v-H.y,z.x),Math.min(z.y,v-H.x));if($<0)continue;const ee=Ge($,2,5);let ae=Math.max(0,z.x-ee),Ae=Math.max(0,z.y-ee),ve=Math.min(H.x+ee,v-1),Fe=Math.min(H.y+ee,v-1);for(let ke=Ae;ke<=Fe;++ke)for(let He=ae;He<=ve;++He)Gp[ke*v+He]=255;let Le=0,ce=0;for(let ke=0;ke<k.cellsY;++ke)for(let He=0;He<k.cellsX;++He){if(!k.cells[ke*k.cellsX+He])continue;const gt=o.tileCoordToPixel(k.min.x+He/k.xScale,k.min.y+ke/k.yScale),ht=o.tileCoordToPixel(k.min.x+(He+1)/k.xScale,k.min.y+(ke+1)/k.yScale);for(let yt=gt.y;yt<=Math.min(ht.y+1,v-1);++yt)for(let Lt=gt.x;Lt<=Math.min(ht.x+1,v-1);++Lt)Gp[yt*v+Lt]===255&&(Gp[yt*v+Lt]=0,Le+=o.getElevationAtPixel(Lt,yt),ce++)}const Ee=Le/ce;ae=Math.max(1,z.x-ee),Ae=Math.max(1,z.y-ee),ve=Math.min(H.x+ee,v-2),Fe=Math.min(H.y+ee,v-2),C=!0;for(let ke=Ae;ke<=Fe;++ke)for(let He=ae;He<=ve;++He)Gp[ke*v+He]===0&&(vx[ke*v+He]=o._dem.set(He,ke,Ee));for(let ke=1;ke<ee;++ke){ae=Math.max(1,z.x-ke),Ae=Math.max(1,z.y-ke),ve=Math.min(H.x+ke,v-2),Fe=Math.min(H.y+ke,v-2);for(let He=Ae;He<=Fe;++He)for(let gt=ae;gt<=ve;++gt){const ht=He*v+gt;if(Gp[ht]===255){let yt=0,Lt=0,Wt=-1,Si=-1;for(let fi=-1;fi<=1;++fi)for(let Ci=-1;Ci<=1;++Ci){const Ii=(He+fi)*v+gt+Ci;if(Gp[Ii]>=ke)continue;const $t=vx[Ii],_i=Math.abs($t);_i>Lt&&(yt=$t,Lt=_i,Wt=Ci,Si=fi)}if(Lt>.1){const fi=1-(ke+.5*Math.abs(Wt*Si))/ee;let Ci=o._dem.get(gt,He)+yt*fi;const Ii=o._dem.get(gt+Wt,He+Si),$t=o._dem.get(gt-Wt,He-Si,!0);(Ci-Ii)*(Ci-$t)>0&&(Ci=(Ii+$t)/2),vx[ht]=o._dem.set(gt,He,Ci),Gp[ht]=ke}}}}}C&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=pl.now())}setFilter(t){this.filter=t?vA(t):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(t=>this.filter.filter(new Xn(this.id.overscaledZ,{worldview:this.worldview}),t.feature,this.id.canonical)):this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const o of t)N0(o.node),yx(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(t.toUnwrapped());for(const f of this.getNodesInfo()){const m=f.node.footprint;f.hiddenByReplacement=!!m&&!h.find(v=>v.footprint===m)}}getHeightAtTileCoord(t,o){const h=[],f=[0,0,0],m=P([]);for(const v of this.getNodesInfo()){const C=v.node.meshes[0],I=C.transformedAabb;if(t<I.min[0]||o<I.min[1]||t>I.max[0]||o>I.max[1])continue;if(v.node.hidden===!0)return{height:1/0,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};G(m,v.node.matrix),f[0]=t,f[1]=o,tt(f,f,m);const F=(f[0]-C.aabb.min[0])/(C.aabb.max[0]-C.aabb.min[0])*Vp|0,k=Math.min(63,(f[1]-C.aabb.min[1])/(C.aabb.max[1]-C.aabb.min[1])*Vp|0)*Vp+Math.min(63,F),z=C.heightmap[k];if(!(z<0&&v.node.footprint))return v.hiddenByReplacement?void 0:{height:z,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};if(v.node.footprint.grid.query(new qt(t,o),new qt(t,o),h),h.length>0)return{height:void 0,maxHeight:v.feature.properties.height,hidden:v.hiddenByReplacement,verticalScale:v.evaluatedScale[2]}}}}function Vm(l,t){return l instanceof Na&&!l.isLightConstant&&t}function iM(l,t,o,h,f,m,v,C){let I=(61440&t|(61440&t)>>4)>>8,F=(3840&t|(3840&t)>>4)>>4,k=240&t|(240&t)>>4;o[3]>0&&(I=Er(I,255*o[0],o[3]),F=Er(F,255*o[1],o[3]),k=Er(k,255*o[2],o[3]));const z=I<<8|F,H=k<<8|Math.floor(255*h[3]),$=function(ke){const He=Ge(ke,0,2);return Math.min(Math.round(.5*He*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],ee=Ge(f[0],0,1),ae=Ge(f[1],0,1),Ae=Ge(f[2],0,1),ve=Ge(f[3],0,1);let Fe,Le,ce,Ee;if(ee!==ae&&v!==m&&ae!==ee){const ke=v-m;Le=1/(ke*(ae-ee)),ce=-(m+ke*ee)/(ke*(ae-ee));const He=Ge(f[4],-1,1);Ee=Math.pow(10,He),Fe=255*Ae<<8|255*ve}else Fe=65535,Le=0,ce=1,Ee=1;if(l.emplaceBack(z,H,$,Fe,Le,ce,Ee),C){const ke=C.length;C.clear();for(let He=0;He<ke;He++)C.emplaceBack(z,H,$,Fe,Le,ce,Ee)}}function rM(l,t,o){const h=l.node;let f=0;const m=o&Pg.HasMeshoptCompression;for(const v of h.meshes){if(h.lights&&h.lightMeshIndex===f||!v.featureData)continue;v.featureArray=new CA,v.featureArray.reserve(v.featureData.length);let C=t;for(const I of v.featureData){const F=m?65535&I:I>>16&65535,k=m?I>>16&65535:65535&I,z=(15&k)<8?15&k:0,H=l.evaluatedRMEA[z],$=l.evaluatedColor[z],ee=l.emissionHeightBasedParams[z];let ae;if(C&&z===2&&h.lights&&(ae=new CA,ae.resize(10*h.lights.length)),iM(v.featureArray,F,$,H,ee,v.aabb.min[2],v.aabb.max[2],ae),ae&&C){C=!1;const Ae=h.meshes[h.lightMeshIndex];Ae.featureArray=ae,Ae.featureArray._trim()}}v.featureArray._trim(),f++}}function sC(l,t,o,h){const f=1<<l.z;t.lat=kt((h/wi+l.y)/f),t.lng=dt((o/wi+l.x)/f)}function nM(l,t,o,h){const f=l.getNodesInfo()[t];if(!f||f.hiddenByReplacement||!f.node.meshes)return;let m=Number.MAX_VALUE;const v=f.node,C=o.tile,I=h.calculatePosMatrix(C.tileID.toUnwrapped(),h.worldSize),F=f.evaluatedScale;let k=0;h.elevation&&v.elevation&&(k=v.elevation*h.elevation.exaggeration()),Q(I,I,[(v.anchor?v.anchor[0]:0)*(F[0]-1),(v.anchor?v.anchor[1]:0)*(F[1]-1),k]),q(I,I,F);const z=o.queryGeometry,H=z.isPointQuery()?z.screenBounds:z.screenGeometry,$=function(ae){const Ae=U([],I,ae.matrix);U(Ae,h.expandedFarZProjMatrix,Ae);for(let ve=0;ve<ae.meshes.length;++ve){const Fe=ae.meshes[ve];if(ve===ae.lightMeshIndex)continue;const Le=YB(H,h,Ae,Fe.aabb);Le!=null&&(m=Math.min(Le,m))}if(ae.children)for(const ve of ae.children)$(ve)};if($(v),m===Number.MAX_VALUE)return;const ee=new Te(0,0);return sC(C.tileID.canonical,ee,f.node.anchor[0],f.node.anchor[1]),{intersectionZ:m,position:ee,feature:f.feature}}Zi(j0,"Tiled3dModelBucket",{omit:["layers"]}),Zi(nC,"Tiled3dModelFeature");const sM={circle:class extends Wa{constructor(l,t,o,h){super(l,{layout:Ic||(Ic=new Us({"circle-sort-key":new Gi(Ft.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Ei(Ft.layout_circle["circle-elevation-reference"]),visibility:new Ei(Ft.layout_circle.visibility)})),paint:Fc||(Fc=new Us({"circle-radius":new Gi(Ft.paint_circle["circle-radius"]),"circle-color":new Gi(Ft.paint_circle["circle-color"]),"circle-blur":new Gi(Ft.paint_circle["circle-blur"]),"circle-opacity":new Gi(Ft.paint_circle["circle-opacity"]),"circle-translate":new Ei(Ft.paint_circle["circle-translate"]),"circle-translate-anchor":new Ei(Ft.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ei(Ft.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ei(Ft.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gi(Ft.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gi(Ft.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gi(Ft.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ei(Ft.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h)}createBucket(l){return new gi(l)}queryRadius(l){const t=l;return El("circle-radius",this,t)+El("circle-stroke-width",this,t)+po(this.paint.get("circle-translate"))}queryIntersectsFeature(l,t,o,h,f,m,v,C){const I=Pd(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return mw(l,h,m,v,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",I,F)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,t,o){const h=gw(this);return{config:new IA(this,{zoom:t,lut:o}),defines:h,overrideFog:!1}}is3D(l){return!l&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Wa{createBucket(l){return new vw(l)}constructor(l,t,o,h){super(l,{layout:_w||(_w=new Us({visibility:new Ei(Ft.layout_heatmap.visibility)})),paint:xw||(xw=new Us({"heatmap-radius":new Gi(Ft.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gi(Ft.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ei(Ft.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gu(Ft.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ei(Ft.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ym({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return El("heatmap-radius",this,l)}queryIntersectsFeature(l,t,o,h,f,m,v,C){const I=this.paint.get("heatmap-radius").evaluate(t,o);return mw(l,h,m,v,C,!0,!0,new qt(0,0),I)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,t,o){return l==="heatmap"?{config:new IA(this,{zoom:t,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Wa{constructor(l,t,o,h){super(l,{layout:bw||(bw=new Us({visibility:new Ei(Ft.layout_hillshade.visibility)})),paint:ww||(ww=new Us({"hillshade-illumination-direction":new Ei(Ft.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ei(Ft.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ei(Ft.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ei(Ft.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ei(Ft.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ei(Ft.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ei(Ft.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}},fill:class extends Wa{constructor(l,t,o,h){super(l,{layout:Uw||(Uw=new Us({"fill-sort-key":new Gi(Ft.layout_fill["fill-sort-key"]),visibility:new Ei(Ft.layout_fill.visibility),"fill-elevation-reference":new Ei(Ft.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Gi(Ft.layout_fill["fill-construct-bridge-guard-rail"])})),paint:zw||(zw=new Us({"fill-antialias":new Ei(Ft.paint_fill["fill-antialias"]),"fill-opacity":new Gi(Ft.paint_fill["fill-opacity"]),"fill-color":new Gi(Ft.paint_fill["fill-color"]),"fill-outline-color":new Gi(Ft.paint_fill["fill-outline-color"]),"fill-translate":new Ei(Ft.paint_fill["fill-translate"]),"fill-translate-anchor":new Ei(Ft.paint_fill["fill-translate-anchor"]),"fill-pattern":new Gi(Ft.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Ei(Ft.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Ei(Ft.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Gi(Ft.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Gi(Ft.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Gi(Ft.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h)}getProgramIds(){const l=this.paint.get("fill-pattern"),t=l&&l.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(l,t,o){return{config:new IA(this,{zoom:t,lut:o}),overrideFog:!1}}recalculate(l,t){super.recalculate(l,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new F_(l)}queryRadius(){return po(this.paint.get("fill-translate"))}queryIntersectsFeature(l,t,o,h,f,m){return!l.queryGeometry.isAboveHorizon&&vr(Tl(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(l){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const t=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return l!=null?t&&!l:t}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Wa{constructor(l,t,o,h){super(l,{layout:u2||(u2=new Us({visibility:new Ei(Ft["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ei(Ft["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:h2||(h2=new Us({"fill-extrusion-opacity":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Gi(Ft["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ei(Ft["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new d0(l)}queryRadius(){return po(this.paint.get("fill-extrusion-translate"))}is3D(l){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,t,o,h,f,m,v,C,I){const F=Pd(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(t,o),z=this.paint.get("fill-extrusion-base").evaluate(t,o),H=[0,0],$=C&&m.elevation,ee=m.elevation?m.elevation.exaggeration():1,ae=l.tile.getBucket(this);if($&&ae instanceof d0){const ce=ae.centroidVertexArray,Ee=I+1;Ee<ce.length&&(H[0]=ce.geta_centroid_pos0(Ee),H[1]=ce.geta_centroid_pos1(Ee))}if(H[0]===0&&H[1]===1)return!1;m.projection.name==="globe"&&(h=c2([h],[new qt(0,0),new qt(wi,wi)],l.tileID.canonical).map(ce=>ce.polygon).flat());const Ae=$?C:null,[ve,Fe]=function(ce,Ee,ke,He,gt,ht,yt,Lt,Wt,Si,fi){return ce.projection.name==="globe"?function(Ci,Ii,$t,_i,Gt,Yt,ki,Di,xr,cr,Xi){const Pi=[],$r=[],or=Ci.projection.upVectorScale(Xi,Ci.center.lat,Ci.worldSize).metersToTile,Ar=[0,0,0,1],Nr=[0,0,0,1],an=(vn,un,_n,ns)=>{vn[0]=un,vn[1]=_n,vn[2]=ns,vn[3]=1},on=l2();$t>0&&($t+=on),_i+=on;for(const vn of Ii){const un=[],_n=[];for(const ns of vn){const zs=ns.x+Gt.x,ze=ns.y+Gt.y,Ve=Ci.projection.projectTilePoint(zs,ze,Xi),Jt=Ci.projection.upVector(Xi,ns.x,ns.y);let zi=$t,Yi=_i;if(ki){const Wi=m2(zs,ze,$t,_i,ki,Di,xr,cr);zi+=Wi.base,Yi+=Wi.top}$t!==0?an(Ar,Ve.x+Jt[0]*or*zi,Ve.y+Jt[1]*or*zi,Ve.z+Jt[2]*or*zi):an(Ar,Ve.x,Ve.y,Ve.z),an(Nr,Ve.x+Jt[0]*or*Yi,Ve.y+Jt[1]*or*Yi,Ve.z+Jt[2]*or*Yi),tt(Ar,Ar,Yt),tt(Nr,Nr,Yt),un.push(new Np(Ar[0],Ar[1],Ar[2])),_n.push(new Np(Nr[0],Nr[1],Nr[2]))}Pi.push(un),$r.push(_n)}return[Pi,$r]}(ce,Ee,ke,He,gt,ht,yt,Lt,Wt,Si,fi):yt?function(Ci,Ii,$t,_i,Gt,Yt,ki,Di,xr){const cr=[],Xi=[],Pi=[0,0,0,1];for(const $r of Ci){const or=[],Ar=[];for(const Nr of $r){const an=Nr.x+_i.x,on=Nr.y+_i.y,vn=m2(an,on,Ii,$t,Yt,ki,Di,xr);Pi[0]=an,Pi[1]=on,Pi[2]=vn.base,Pi[3]=1,Kt(Pi,Pi,Gt),Pi[3]=Math.max(Pi[3],1e-5);const un=new Np(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);Pi[0]=an,Pi[1]=on,Pi[2]=vn.top,Pi[3]=1,Kt(Pi,Pi,Gt),Pi[3]=Math.max(Pi[3],1e-5);const _n=new Np(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);or.push(un),Ar.push(_n)}cr.push(or),Xi.push(Ar)}return[cr,Xi]}(Ee,ke,He,gt,ht,yt,Lt,Wt,Si):function(Ci,Ii,$t,_i,Gt){const Yt=[],ki=[],Di=Gt[8]*Ii,xr=Gt[9]*Ii,cr=Gt[10]*Ii,Xi=Gt[11]*Ii,Pi=Gt[8]*$t,$r=Gt[9]*$t,or=Gt[10]*$t,Ar=Gt[11]*$t;for(const Nr of Ci){const an=[],on=[];for(const vn of Nr){const un=vn.x+_i.x,_n=vn.y+_i.y,ns=Gt[0]*un+Gt[4]*_n+Gt[12],zs=Gt[1]*un+Gt[5]*_n+Gt[13],ze=Gt[2]*un+Gt[6]*_n+Gt[14],Ve=Gt[3]*un+Gt[7]*_n+Gt[15],Jt=ns+Di,zi=zs+xr,Yi=ze+cr,Wi=Math.max(Ve+Xi,1e-5),sr=ns+Pi,Or=zs+$r,wn=ze+or,Bn=Math.max(Ve+Ar,1e-5);an.push(new Np(Jt/Wi,zi/Wi,Yi/Wi)),on.push(new Np(sr/Bn,Or/Bn,wn/Bn))}Yt.push(an),ki.push(on)}return[Yt,ki]}(Ee,ke,He,gt,ht)}(m,h,z,k,F,v,Ae,H,ee,m.center.lat,l.tileID.canonical),Le=l.queryGeometry;return function(ce,Ee,ke){let He=1/0;vr(ke,Ee)&&(He=g2(ke,Ee[0]));for(let gt=0;gt<Ee.length;gt++){const ht=Ee[gt],yt=ce[gt];for(let Lt=0;Lt<ht.length-1;Lt++){const Wt=ht[Lt],Si=[Wt,ht[Lt+1],yt[Lt+1],yt[Lt],Wt];Ui(ke,Si)&&(He=Math.min(He,g2(ke,Si)))}}return He!==1/0&&He}(ve,Fe,Le.isPointQuery()?Le.screenBounds:Le.screenGeometry)}},building:class extends Wa{constructor(l,t,o,h){super(l,{layout:I2||(I2=new Us({visibility:new Ei(Ft.layout_building.visibility),"building-roof-shape":new Gi(Ft.layout_building["building-roof-shape"]),"building-height":new Gi(Ft.layout_building["building-height"]),"building-base":new Gi(Ft.layout_building["building-base"])})),paint:F2||(F2=new Us({"building-opacity":new Ei(Ft.paint_building["building-opacity"]),"building-ambient-occlusion-wall-intensity":new Ei(Ft.paint_building["building-ambient-occlusion-wall-intensity"]),"building-ambient-occlusion-ground-intensity":new Ei(Ft.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Ei(Ft.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Ei(Ft.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Ei(Ft.paint_building["building-vertical-scale"]),"building-cast-shadows":new Ei(Ft.paint_building["building-cast-shadows"]),"building-color":new Gi(Ft.paint_building["building-color"]),"building-emissive-strength":new Gi(Ft.paint_building["building-emissive-strength"]),"building-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new T2(l)}},line:class extends Wa{constructor(l,t,o,h){const f=N2();super(l,f,t,o,h),f.layout&&(this.layout=new $c(f.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof tl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,t){super.recalculate(l,t),this.paint._values["line-floorwidth"]=(()=>{if(Mm)return Mm;const o=N2();return Mm=new iL(o.paint.properties["line-width"].specification),Mm.useIntegerZoom=!0,Mm})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Q_(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,t,o){const h=U2(this);return{config:new IA(this,{zoom:t,lut:o}),defines:h,overrideFog:!1}}queryRadius(l){const t=l,o=j2(El("line-width",this,t),El("line-gap-width",this,t)),h=El("line-offset",this,t);return o/2+Math.abs(h)+po(this.paint.get("line-translate"))}queryIntersectsFeature(l,t,o,h,f,m){if(l.queryGeometry.isAboveHorizon)return!1;const v=Tl(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),C=l.pixelToTileUnitsFactor/2*j2(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),I=this.paint.get("line-offset").evaluate(t,o);return I&&(h=function(F,k){const z=[],H=new qt(0,0);for(let $=0;$<F.length;$++){const ee=F[$],ae=[];for(let Ae=0;Ae<ee.length;Ae++){const ve=ee[Ae],Fe=ee[Ae+1],Le=Ae===0?H:ve.sub(ee[Ae-1])._unit()._perp(),ce=Ae===ee.length-1?H:Fe.sub(ve)._unit()._perp(),Ee=Le._add(ce)._unit();Ee._mult(1/(Ee.x*ce.x+Ee.y*ce.y)),ae.push(Ee._mult(k)._add(ve))}z.push(ae)}return z}(h,I*l.pixelToTileUnitsFactor)),function(F,k,z){for(let H=0;H<k.length;H++){const $=k[H];if(F.length>=3){for(let ee=0;ee<$.length;ee++)if(rs(F,$[ee]))return!0}if(Rr(F,$,z))return!0}return!1}(v,h,C)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(l){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:P0,background:class extends Wa{constructor(l,t,o,h){super(l,{layout:LB||(LB=new Us({visibility:new Ei(Ft.layout_background.visibility)})),paint:MB||(MB=new Us({"background-pitch-alignment":new Ei(Ft.paint_background["background-pitch-alignment"]),"background-color":new Ei(Ft.paint_background["background-color"]),"background-pattern":new Ei(Ft.paint_background["background-pattern"]),"background-opacity":new Ei(Ft.paint_background["background-opacity"]),"background-emissive-strength":new Ei(Ft.paint_background["background-emissive-strength"]),"background-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}is3D(l){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:OB,"raster-particle":QB,sky:class extends Wa{constructor(l,t,o,h){super(l,{layout:NB||(NB=new Us({visibility:new Ei(Ft.layout_sky.visibility)})),paint:jB||(jB=new Us({"sky-type":new Ei(Ft.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ei(Ft.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ei(Ft.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ei(Ft.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ei(Ft.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gu(Ft.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ei(Ft.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ei(Ft.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ei(Ft.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ym({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(l,t){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),f=!h,m=l.style.light,v=m.properties.get("position");return f&&m.properties.get("anchor")==="viewport"&&Yr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?dx(v.azimuthal,90-v.polar,t):dx(h[0],90-h[1],t)}const o=this.paint.get("sky-gradient-center");return dx(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends Wa{constructor(l,t,o,h){super(l,{paint:HB||(HB=new Us({}))},t,null)}},model:class extends Wa{constructor(l,t,o,h){super(l,{layout:ZB||(ZB=new Us({visibility:new Ei(Ft.layout_model.visibility),"model-id":new Gi(Ft.layout_model["model-id"])})),paint:JB||(JB=new Us({"model-opacity":new Gi(Ft.paint_model["model-opacity"]),"model-rotation":new Gi(Ft.paint_model["model-rotation"]),"model-scale":new Gi(Ft.paint_model["model-scale"]),"model-translation":new Gi(Ft.paint_model["model-translation"]),"model-color":new Gi(Ft.paint_model["model-color"]),"model-color-mix-intensity":new Gi(Ft.paint_model["model-color-mix-intensity"]),"model-type":new Ei(Ft.paint_model["model-type"]),"model-cast-shadows":new Ei(Ft.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ei(Ft.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ei(Ft.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Gi(Ft.paint_model["model-emissive-strength"]),"model-roughness":new Gi(Ft.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Gi(Ft.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ei(Ft.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ei(Ft.paint_model["model-front-cutoff"]),"model-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},t,o,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new gx(l)}getProgramIds(){return["model"]}is3D(l){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof j0?wi-1:0}queryIntersectsFeature(l,t,o,h,f,m){if(!this.modelManager)return!1;const v=this.modelManager,C=l.tile.getBucket(this);if(!(C&&C instanceof gx))return!1;for(const I in C.instancesPerModel){const F=C.instancesPerModel[I],k=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(F.idToFeaturesIndex.hasOwnProperty(k)){const z=F.features[F.idToFeaturesIndex[k]],H=v.getModel(I,this.scope);if(!H)return!1;let $=R();const ee=new Te(0,0),ae=C.canonical;let Ae=Number.MAX_VALUE;for(let ve=0;ve<z.instancedDataCount;++ve){const Fe=16*(z.instancedDataOffset+ve),Le=F.instancedDataArray.float32,ce=[Le[Fe+4],Le[Fe+5],Le[Fe+6]];sC(ae,ee,Le[Fe],0|Le[Fe+1]),eC($,H,m,ee,z.rotation,z.scale,ce,!1,!1,!1),m.projection.name==="globe"&&($=fx($,m));const Ee=U([],m.projMatrix,$),ke=l.queryGeometry,He=YB(ke.isPointQuery()?ke.screenBounds:ke.screenGeometry,m,Ee,H.aabb);He!=null&&(Ae=Math.min(He,Ae))}return Ae!==Number.MAX_VALUE&&Ae}}return!1}_handleOverridablePaintPropertyUpdate(l,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const t=this._transitionablePaint._values[l];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof ja}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Wa{constructor(l,t,o,h){super(l,{layout:Nw||(Nw=new Us({"clip-layer-types":new Ei(Ft.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ei(Ft.layout_clip["clip-layer-scope"])})),paint:jw||(jw=new Us({}))},t,o,h)}recalculate(l,t){super.recalculate(l,t)}createBucket(l){return new Hw(l)}is3D(l){return!0}}},_x=new Un(0,0,0),xx={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},bx={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},H0={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},oM={PAINT_ORDER_FILL_AND_STROKE:1},Gm={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},oC={MASK_TYPE_LUMINANCE:1};function aM(l,t,o){l===1&&t.icons.push(function(h,f){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:v}=m;if(v.content_area){const{content_area:C}=v;C.top==null&&(C.top=C.left),C.width==null&&(C.width=m.usvg_tree.width),C.height==null&&(C.height=C.width)}return v.stretch_x&&v.stretch_x.length&&aC(v,"x"),v.stretch_y&&v.stretch_y.length&&aC(v,"y"),m}(h.readFields(lM,{name:void 0},f))}(o,o.readVarint()+o.pos))}function aC(l,t){const o=[],h=l[`stretch_${t}`];let f=null;for(let m=0;m<h.length;m++)f===null?f=o.length===0?h[0]:o[o.length-1][1]+h[m]:(o.push([f,f+h[m]]),f=null);l[`stretch_${t}_areas`]=o}function lM(l,t,o){l===1?t.name=o.readString():l===2?t.metadata=function(h,f){return h.readFields(cM,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)}(o,o.readVarint()+o.pos):l===3&&(t.usvg_tree=function(h,f){return h.readFields(dM,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)}(o,o.readVarint()+o.pos),t.data="usvg_tree")}function cM(l,t,o){l===1?t.stretch_x=o.readPackedVarint():l===2?t.stretch_y=o.readPackedVarint():l===3?t.content_area=function(h,f){return h.readFields(uM,{left:0},f)}(o,o.readVarint()+o.pos):l===4&&t.variables.push(function(h,f){return h.readFields(hM,{name:void 0},f)}(o,o.readVarint()+o.pos))}function uM(l,t,o){l===1?t.left=o.readVarint():l===2?t.width=o.readVarint():l===3?t.top=o.readVarint():l===4&&(t.height=o.readVarint())}function hM(l,t,o){l===1?t.name=o.readString():l===2&&(t.rgb_color=G0(o.readVarint()),t.value="rgb_color")}function dM(l,t,o){l===1?t.width=t.height=o.readVarint():l===2?t.height=o.readVarint():l===3?t.children.push(Q0(o,o.readVarint()+o.pos)):l===4?t.linear_gradients.push(function(h,f){return h.readFields(vM,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)}(o,o.readVarint()+o.pos)):l===5?t.radial_gradients.push(function(h,f){return h.readFields(xM,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)}(o,o.readVarint()+o.pos)):l===7?t.clip_paths.push(function(h,f){return h.readFields(bM,{children:[]},f)}(o,o.readVarint()+o.pos)):l===8&&t.masks.push(function(h,f){const m=h.readFields(wM,{left:0,width:20,mask_type:oC.MASK_TYPE_LUMINANCE,children:[]},f);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(o,o.readVarint()+o.pos))}function Q0(l,t){return l.readFields(AM,{},t)}function AM(l,t,o){l===1?(t.group=function(h,f){return h.readFields(fM,{opacity:255,children:[]},f)}(o,o.readVarint()+o.pos),t.node="group"):l===2&&(t.path=function(h,f){return h.readFields(gM,{paint_order:1,commands:[],step:1,diffs:[],rule:xx.PATH_RULE_NON_ZERO},f)}(o,o.readVarint()+o.pos),t.node="path")}function fM(l,t,o){l===1?t.transform=V0(o,o.readVarint()+o.pos):l===2?t.opacity=o.readVarint():l===5?t.clip_path_idx=o.readVarint():l===6?t.mask_idx=o.readVarint():l===7&&t.children.push(Q0(o,o.readVarint()+o.pos))}function V0(l,t){return l.readFields(pM,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function pM(l,t,o){l===1?t.sx=o.readFloat():l===2?t.ky=o.readFloat():l===3?t.kx=o.readFloat():l===4?t.sy=o.readFloat():l===5?t.tx=o.readFloat():l===6&&(t.ty=o.readFloat())}function gM(l,t,o){l===1?t.fill=function(h,f){return h.readFields(mM,{rgb_color:_x,paint:"rgb_color",opacity:255},f)}(o,o.readVarint()+o.pos):l===2?t.stroke=function(h,f){return h.readFields(yM,{rgb_color:_x,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)}(o,o.readVarint()+o.pos):l===3?t.paint_order=o.readVarint():l===5?o.readPackedVarint(t.commands):l===6?t.step=o.readFloat():l===7?o.readPackedSVarint(t.diffs):l===8&&(t.rule=o.readVarint())}function mM(l,t,o){l===1?(t.rgb_color=G0(o.readVarint()),t.paint="rgb_color"):l===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):l===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):l===5&&(t.opacity=o.readVarint())}function G0(l){return new Un((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function yM(l,t,o){l===1?(t.rgb_color=G0(o.readVarint()),t.paint="rgb_color"):l===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):l===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):l===5?o.readPackedFloat(t.dasharray):l===6?t.dashoffset=o.readFloat():l===7?t.miterlimit=o.readFloat():l===8?t.opacity=o.readVarint():l===9?t.width=o.readFloat():l===10?t.linecap=o.readVarint():l===11&&(t.linejoin=o.readVarint())}function vM(l,t,o){l===1?t.transform=V0(o,o.readVarint()+o.pos):l===2?t.spread_method=o.readVarint():l===3?t.stops.push(lC(o,o.readVarint()+o.pos)):l===4?t.x1=o.readFloat():l===5?t.y1=o.readFloat():l===6?t.x2=o.readFloat():l===7&&(t.y2=o.readFloat())}function lC(l,t){return l.readFields(_M,{offset:0,opacity:255,rgb_color:_x},t)}function _M(l,t,o){l===1?t.offset=o.readFloat():l===2?t.opacity=o.readVarint():l===3&&(t.rgb_color=G0(o.readVarint()))}function xM(l,t,o){l===1?t.transform=V0(o,o.readVarint()+o.pos):l===2?t.spread_method=o.readVarint():l===3?t.stops.push(lC(o,o.readVarint()+o.pos)):l===4?t.cx=o.readFloat():l===5?t.cy=o.readFloat():l===6?t.r=o.readFloat():l===7?t.fx=o.readFloat():l===8?t.fy=o.readFloat():l===9&&(t.fr=o.readFloat())}function bM(l,t,o){l===1?t.transform=V0(o,o.readVarint()+o.pos):l===2?t.clip_path_idx=o.readVarint():l===3&&t.children.push(Q0(o,o.readVarint()+o.pos))}function wM(l,t,o){l===1?t.left=t.top=o.readFloat():l===2?t.width=t.height=o.readFloat():l===3?t.top=o.readFloat():l===4?t.height=o.readFloat():l===5?t.mask_type=o.readVarint():l===6?t.mask_idx=o.readVarint():l===7&&t.children.push(Q0(o,o.readVarint()+o.pos))}class BM{static calculate(t={},o=[]){const h=new Map,f=new Map;if(Object.keys(t).length===0)return h;o.forEach(m=>{f.set(m.name,m.rgb_color||new Un(0,0,0))});for(const[m,v]of Object.entries(t))f.has(m)?h.set(f.get(m).toString(),v):console.warn(`Ignoring unknown image variable "${m}"`);return h}}function Rg(l,t=255,o){const h=t/255,f=l.toString(),m=o.has(f)?o.get(f).clone():l.clone();return m.a*=h,m.toString()}function Wm(l,t){if(!ku()){const o=document.createElement("canvas");return o.width=l,o.height=t,o}return new OffscreenCanvas(l,t)}function CM(l,t){const o=BM.calculate(t.params,l.metadata?l.metadata.variables:[]),h=l.usvg_tree,f=h.width,m=h.height,v=t.transform?t.transform:new DOMMatrix,C=Math.max(1,Math.round(f*v.a)),I=Math.max(1,Math.round(m*v.d)),F=new DOMMatrix([C/f,0,0,I/m,0,0]),k=Wm(C,I).getContext("2d");return wx(k,F,h,h,o),k.getImageData(0,0,C,I)}function wx(l,t,o,h,f){for(const m of h.children)cC(l,t,o,m,f)}function cC(l,t,o,h,f){h.group?(l.save(),function(m,v,C,I,F){const k=I.mask_idx!=null?C.masks[I.mask_idx]:null,z=I.clip_path_idx!=null?C.clip_paths[I.clip_path_idx]:null;if(I.transform&&(v=Dg(I.transform).preMultiplySelf(v)),!function(ee,ae,Ae){return ee.opacity!==255||ae||Ae}(I,z!=null,k!=null))return void wx(m,v,C,I,F);const H=Wm(m.canvas.width,m.canvas.height),$=H.getContext("2d");wx($,v,C,I,F),z&&gC($,v,C,z),k&&mC($,v,C,k,F),m.globalAlpha=I.opacity/255,m.drawImage(H,0,0)}(l,t,o,h.group,f),l.restore()):h.path&&(l.save(),function(m,v,C,I,F){m.setTransform(v),I.paint_order===oM.PAINT_ORDER_FILL_AND_STROKE?(uC(m,C,I,F),dC(m,C,I,F)):(dC(m,C,I,F),uC(m,C,I,F))}(l,t,o,h.path,f),l.restore())}function uC(l,t,o,h){const f=o.fill;if(!f)return;const m=f.opacity/255;switch(l.save(),l.beginPath(),yC(o,l),f.paint){case"rgb_color":l.fillStyle=Rg(f.rgb_color,f.opacity,h);break;case"linear_gradient_idx":{const v=t.linear_gradients[f.linear_gradient_idx];v.transform&&l.setTransform(Dg(v.transform).preMultiplySelf(l.getTransform())),l.fillStyle=AC(l,v,m,h);break}case"radial_gradient_idx":{const v=t.radial_gradients[f.radial_gradient_idx];v.transform&&l.setTransform(Dg(v.transform).preMultiplySelf(l.getTransform())),l.fillStyle=fC(l,v,m,h)}}l.fill(hC(o)),l.restore()}function hC(l){return l.rule===xx.PATH_RULE_NON_ZERO?"nonzero":l.rule===xx.PATH_RULE_EVEN_ODD?"evenodd":void 0}function dC(l,t,o,h){const f=o.stroke;if(!f)return;const m=vC(o);l.lineWidth=f.width,l.miterLimit=f.miterlimit,l.setLineDash(f.dasharray),l.lineDashOffset=f.dashoffset;const v=f.opacity/255;switch(f.paint){case"rgb_color":l.strokeStyle=Rg(f.rgb_color,f.opacity,h);break;case"linear_gradient_idx":l.strokeStyle=AC(l,t.linear_gradients[f.linear_gradient_idx],v,h,!0);break;case"radial_gradient_idx":l.strokeStyle=fC(l,t.radial_gradients[f.radial_gradient_idx],v,h,!0)}switch(f.linejoin){case H0.LINE_JOIN_MITER_CLIP:case H0.LINE_JOIN_MITER:l.lineJoin="miter";break;case H0.LINE_JOIN_ROUND:l.lineJoin="round";break;case H0.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(f.linecap){case bx.LINE_CAP_BUTT:l.lineCap="butt";break;case bx.LINE_CAP_ROUND:l.lineCap="round";break;case bx.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(m)}function AC(l,t,o,h,f=!1){if(t.stops.length===1){const H=t.stops[0];return Rg(H.rgb_color,H.opacity*o,h)}const{x1:m,y1:v,x2:C,y2:I}=t;let F=new DOMPoint(m,v),k=new DOMPoint(C,I);if(f){const H=Dg(t.transform);F=H.transformPoint(F),k=H.transformPoint(k)}const z=l.createLinearGradient(F.x,F.y,k.x,k.y);for(const H of t.stops)z.addColorStop(H.offset,Rg(H.rgb_color,H.opacity*o,h));return z}function fC(l,t,o,h,f=!1){if(t.stops.length===1){const ve=t.stops[0];return Rg(ve.rgb_color,ve.opacity*o,h)}const m=Dg(t.transform),{fx:v,fy:C,fr:I,cx:F,cy:k,r:z}=t;let H=new DOMPoint(v,C),$=new DOMPoint(F,k),ee=I,ae=z;if(f){H=m.transformPoint(H),$=m.transformPoint($);const ve=(m.a+m.d)/2;ee=I*ve,ae=t.r*ve}const Ae=l.createRadialGradient(H.x,H.y,ee,$.x,$.y,ae);for(const ve of t.stops)Ae.addColorStop(ve.offset,Rg(ve.rgb_color,ve.opacity*o,h));return Ae}function pC(l,t,o,h){const f=h.transform?Dg(h.transform).preMultiplySelf(t):t,m=Wm(l.canvas.width,l.canvas.height),v=m.getContext("2d");for(const I of h.children)if(I.group)pC(v,f,o,I.group);else if(I.path){const F=I.path,k=new Path2D;k.addPath(vC(F),f),v.fill(k,hC(F))}const C=h.clip_path_idx!=null?o.clip_paths[h.clip_path_idx]:null;C&&gC(v,f,o,C),l.globalCompositeOperation="source-over",l.drawImage(m,0,0)}function gC(l,t,o,h){const f=Wm(l.canvas.width,l.canvas.height);pC(f.getContext("2d"),t,o,h),l.globalCompositeOperation="destination-in",l.drawImage(f,0,0)}function mC(l,t,o,h,f){if(h.children.length===0)return;const m=h.mask_idx!=null?o.masks[h.mask_idx]:null;m&&mC(l,t,o,m,f);const v=l.canvas.width,C=l.canvas.height,I=Wm(v,C),F=I.getContext("2d"),k=h.width,z=h.height,H=h.left,$=h.top,ee=new Path2D,ae=new Path2D;ae.rect(H,$,k,z),ee.addPath(ae,t),F.clip(ee);for(const Fe of h.children)cC(F,t,o,Fe,f);const Ae=F.getImageData(0,0,v,C),ve=Ae.data;if(h.mask_type===oC.MASK_TYPE_LUMINANCE)for(let Fe=0;Fe<ve.length;Fe+=4)ve[Fe+3]=ve[Fe+3]/255*(.2126*ve[Fe]+.7152*ve[Fe+1]+.0722*ve[Fe+2]);F.putImageData(Ae,0,0),l.globalCompositeOperation="destination-in",l.drawImage(I,0,0)}function Dg(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function yC(l,t){const o=l.step;let h=l.diffs[0]*o,f=l.diffs[1]*o;t.moveTo(h,f);for(let m=0,v=2;m<l.commands.length;m++)switch(l.commands[m]){case Gm.PATH_COMMAND_MOVE:h+=l.diffs[v++]*o,f+=l.diffs[v++]*o,t.moveTo(h,f);break;case Gm.PATH_COMMAND_LINE:h+=l.diffs[v++]*o,f+=l.diffs[v++]*o,t.lineTo(h,f);break;case Gm.PATH_COMMAND_QUAD:{const C=h+l.diffs[v++]*o,I=f+l.diffs[v++]*o;h=C+l.diffs[v++]*o,f=I+l.diffs[v++]*o,t.quadraticCurveTo(C,I,h,f);break}case Gm.PATH_COMMAND_CUBIC:{const C=h+l.diffs[v++]*o,I=f+l.diffs[v++]*o,F=C+l.diffs[v++]*o,k=I+l.diffs[v++]*o;h=F+l.diffs[v++]*o,f=k+l.diffs[v++]*o,t.bezierCurveTo(C,I,F,k,h,f);break}case Gm.PATH_COMMAND_CLOSE:t.closePath()}return t}function vC(l){return yC(l,new Path2D)}class W0{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const o=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,o),o}put(t,o){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,o)}delete(t){this.cache.delete(t)}}Zi(W0,"LRUCache");class Bx{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(t){return new Il(t,t.data)}getFromCache(t,o,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new W0(150)),this.cacheMap.get(h).get(Zc(t.toString(),o))}setInCache(t,o,h,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new W0(150));const m=this.cacheDependenciesMap.get(f),v=Zc(t.id.toString(),h);m.get(v)||m.set(v,new Set);const C=this.cacheMap.get(f),I=t.toString();m.get(v).add(I),C.put(Zc(t.toString(),h),o)}removeImagesFromCacheByIds(t,o,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const f=this.cacheMap.get(h),m=this.cacheDependenciesMap.get(h);for(const v of t){const C=Zc(v.toString(),o);if(m.has(C)){for(const I of m.get(C))f.delete(I);m.delete(C)}}}rasterize(t,o,h,f,m=CM){const v=this.getFromCache(t,h,f);if(v)return v.clone();const C=m(o.icon,t.options),I=Bx._getImage(C);return this.setInCache(t,I,h,f),I.clone()}}class _C{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const h=this.toIdx(t,o);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function xC(l,t,o,h){let f=0,m=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(h[v])<1e-15){if(o[v]<l[v]||o[v]>t[v])return null}else{const C=1/h[v];let I=(l[v]-o[v])*C,F=(t[v]-o[v])*C;if(I>F){const k=I;I=F,F=k}if(I>f&&(f=I),F<m&&(m=F),f>m)return null}return f}function bC(l,t,o,h,f,m,v,C,I,F,k){const z=h-l,H=f-t,$=m-o,ee=v-l,ae=C-t,Ae=I-o,ve=k[1]*Ae-k[2]*ae,Fe=k[2]*ee-k[0]*Ae,Le=k[0]*ae-k[1]*ee,ce=z*ve+H*Fe+$*Le;if(Math.abs(ce)<1e-15)return null;const Ee=1/ce,ke=F[0]-l,He=F[1]-t,gt=F[2]-o,ht=(ke*ve+He*Fe+gt*Le)*Ee;if(ht<0||ht>1)return null;const yt=He*$-gt*H,Lt=gt*z-ke*$,Wt=ke*H-He*z,Si=(k[0]*yt+k[1]*Lt+k[2]*Wt)*Ee;return Si<0||ht+Si>1?null:(ee*yt+ae*Lt+Ae*Wt)*Ee}function wC(l,t,o){return(l-t)/(o-t)}function BC(l,t,o,h,f,m,v,C,I){const F=1<<o,k=m-h,z=v-f,H=(l+1)/F*k+h,$=(t+0)/F*z+f,ee=(t+1)/F*z+f;C[0]=(l+0)/F*k+h,C[1]=$,I[0]=H,I[1]=ee}class CC{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(m){const v=Math.ceil(Math.log2(m.dim/8)),C=[];let I=Math.ceil(Math.pow(2,v));const F=1/I,k=($,ee,ae,Ae,ve)=>{const Fe=Ae?1:0,Le=($+1)*ae-Fe,ce=ee*ae,Ee=(ee+1)*ae-Fe;ve[0]=$*ae,ve[1]=ce,ve[2]=Le,ve[3]=Ee};let z=new _C(I);const H=[];for(let $=0;$<I*I;$++){k($%I,Math.floor($/I),F,!1,H);const ee=np(H[0],H[1],m),ae=np(H[2],H[1],m),Ae=np(H[2],H[3],m),ve=np(H[0],H[3],m);z.minimums.push(Math.min(ee,ae,Ae,ve)),z.maximums.push(Math.max(ee,ae,Ae,ve)),z.leaves.push(1)}for(C.push(z),I/=2;I>=1;I/=2){const $=C[C.length-1];z=new _C(I);for(let ee=0;ee<I*I;ee++){k(ee%I,Math.floor(ee/I),2,!0,H);const ae=$.getElevation(H[0],H[1]),Ae=$.getElevation(H[2],H[1]),ve=$.getElevation(H[2],H[3]),Fe=$.getElevation(H[0],H[3]),Le=$.isLeaf(H[0],H[1]),ce=$.isLeaf(H[2],H[1]),Ee=$.isLeaf(H[2],H[3]),ke=$.isLeaf(H[0],H[3]),He=Math.min(ae.min,Ae.min,ve.min,Fe.min),gt=Math.max(ae.max,Ae.max,ve.max,Fe.max),ht=Le&&ce&&Ee&&ke;z.maximums.push(gt),z.minimums.push(He),z.leaves.push(gt-He<=5&&ht?1:0)}C.push(z)}return C}(this.dem),h=o.length-1,f=o[h];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,h,0)}raycastRoot(t,o,h,f,m,v,C=1){return xC([t,o,-100],[h,f,this.maximums[0]*C],m,v)}raycast(t,o,h,f,m,v,C=1){if(!this.nodeCount)return null;const I=this.raycastRoot(t,o,h,f,m,v,C);if(I==null)return null;const F=[],k=[],z=[],H=[],$=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:ee,t:ae,nodex:Ae,nodey:ve,depth:Fe}=$.pop();if(this.leaves[ee]){BC(Ae,ve,Fe,t,o,h,f,z,H);const ce=1<<Fe,Ee=(Ae+0)/ce,ke=(Ae+1)/ce,He=(ve+0)/ce,gt=(ve+1)/ce,ht=np(Ee,He,this.dem)*C,yt=np(ke,He,this.dem)*C,Lt=np(ke,gt,this.dem)*C,Wt=np(Ee,gt,this.dem)*C,Si=bC(z[0],z[1],ht,H[0],z[1],yt,H[0],H[1],Lt,m,v),fi=bC(H[0],H[1],Lt,z[0],H[1],Wt,z[0],z[1],ht,m,v),Ci=Math.min(Si!==null?Si:Number.MAX_VALUE,fi!==null?fi:Number.MAX_VALUE);if(Ci!==Number.MAX_VALUE)return Ci;{const Ii=Qt([],m,v,ae);if(SC(ht,yt,Wt,Lt,wC(Ii[0],z[0],H[0]),wC(Ii[1],z[1],H[1]))>=Ii[2])return ae}continue}let Le=0;for(let ce=0;ce<this._siblingOffset.length;ce++){BC((Ae<<1)+this._siblingOffset[ce][0],(ve<<1)+this._siblingOffset[ce][1],Fe+1,t,o,h,f,z,H),z[2]=-100,H[2]=this.maximums[this.childOffsets[ee]+ce]*C;const Ee=xC(z,H,m,v);if(Ee!=null){const ke=Ee;F[ce]=ke;let He=!1;for(let gt=0;gt<Le&&!He;gt++)ke>=F[k[gt]]&&(k.splice(gt,0,ce),He=!0);He||(k[Le]=ce),Le++}}for(let ce=0;ce<Le;ce++){const Ee=k[ce];$.push({idx:this.childOffsets[ee]+Ee,t:F[Ee],nodex:(Ae<<1)+this._siblingOffset[Ee][0],nodey:(ve<<1)+this._siblingOffset[Ee][1],depth:Fe+1})}}return null}_addNode(t,o,h){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,h,f,m){if(t[f].isLeaf(o,h)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const v=f-1,C=t[v];let I=0,F=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*o+this._siblingOffset[k][0],H=2*h+this._siblingOffset[k][1],$=C.getElevation(z,H),ee=C.isLeaf(z,H),ae=this._addNode($.min,$.max,ee);ee&&(I|=1<<k),F||(F=ae)}for(let k=0;k<this._siblingOffset.length;k++)I&1<<k||this._construct(t,2*o+this._siblingOffset[k][0],2*h+this._siblingOffset[k][1],v,F+k)}}function SC(l,t,o,h,f,m){return Er(Er(l,o,m),Er(t,h,m),f)}function np(l,t,o){const h=o.dim,f=Ge(l*h-.5,0,h-1),m=Ge(t*h-.5,0,h-1),v=Math.floor(f),C=Math.floor(m),I=Math.min(v+1,h-1),F=Math.min(C+1,h-1);return SC(o.get(v,C),o.get(I,C),o.get(v,F),o.get(I,F),f-v,m-C)}const SM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function EM(l,t,o){return(256*l*256+256*t+o)/10-1e4}function TM(l,t,o){return 256*l+t+o/256-32768}class X0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,h,f=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void Yr(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2,v=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let I=0;I<m;I++)v[this._idx(-1,I)]=v[this._idx(0,I)],v[this._idx(m,I)]=v[this._idx(m-1,I)],v[this._idx(I,-1)]=v[this._idx(I,0)],v[this._idx(I,m)]=v[this._idx(I,m-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(m,-1)]=v[this._idx(m-1,0)],v[this._idx(-1,m)]=v[this._idx(0,m-1)],v[this._idx(m,m)]=v[this._idx(m-1,m-1)]}const C=h==="terrarium"?TM:EM;for(let I=0;I<v.length;++I){const F=4*I;this.floatView[I]=C(this.pixels[F],this.pixels[F+1],this.pixels[F+2])}this._timestamp=pl.now()}_buildQuadTree(){this._tree=new CC(this)}get(t,o,h=!1){h&&(t=Ge(t,-1,this.dim),o=Ge(o,-1,this.dim));const f=this._idx(t,o);return this.floatView[f]}set(t,o,h){const f=this._idx(t,o),m=this.floatView[f];return this.floatView[f]=h,h-m}static getUnpackVector(t){return SM[t]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const h=[0,0,0,0],f=X0.getUnpackVector(o);let m=Math.floor((t+f[3])/f[2]);return h[2]=m%256,m=Math.floor(m/256),h[1]=m%256,m=Math.floor(m/256),h[0]=m,h}getPixels(){return new Sw({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,m=o*this.dim+this.dim,v=h*this.dim,C=h*this.dim+this.dim;switch(o){case-1:f=m-1;break;case 1:m=f+1}switch(h){case-1:v=C-1;break;case 1:C=v+1}const I=-o*this.dim,F=-h*this.dim;for(let k=v;k<C;k++)for(let z=f;z<m;z++){const H=4*this._idx(z,k),$=4*this._idx(z+I,k+F);this.pixels[H+0]=t.pixels[$+0],this.pixels[H+1]=t.pixels[$+1],this.pixels[H+2]=t.pixels[$+2],this.pixels[H+3]=t.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function IM(l,t,o){l===1?t.headerLength=o.readFixed32():l===2?t.x=o.readVarint():l===3?t.y=o.readVarint():l===4?t.z=o.readVarint():l===5&&t.layers.push(function(h,f){return h.readFields(kM,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)}(o,o.readVarint()+o.pos))}function FM(l,t,o){l===1?(t.delta_filter=function(h,f){return h.readFields(LM,{blockSize:0},f)}(o,o.readVarint()+o.pos),t.filter="delta_filter"):l===2?(o.readVarint(),t.filter="zigzag_filter"):l===3?(o.readVarint(),t.filter="bitshuffle_filter"):l===4&&(o.readVarint(),t.filter="byteshuffle_filter")}function LM(l,t,o){l===1&&(t.blockSize=o.readVarint())}function MM(l,t,o){l===1?(o.readVarint(),t.codec="gzip_data"):l===2?(o.readVarint(),t.codec="jpeg_image"):l===3?(o.readVarint(),t.codec="webp_image"):l===4&&(o.readVarint(),t.codec="png_image")}function PM(l,t,o){let h=0,f=0;l===1?t.firstByte=o.readFixed64():l===2?t.lastByte=o.readFixed64():l===3?t.filters.push(function(m,v){return m.readFields(FM,{},v)}(o,o.readVarint()+o.pos)):l===4?t.codec=function(m,v){return m.readFields(MM,{},v)}(o,o.readVarint()+o.pos):l===5?f=o.readFloat():l===6?h=o.readFloat():l===7?t.bands.push(o.readString()):l===8?t.offset=o.readDouble():l===9&&(t.scale=o.readDouble()),t.offset===0&&(t.offset=f),t.scale===0&&(t.scale=h)}function kM(l,t,o){l===1?t.version=o.readVarint():l===2?t.name=o.readString():l===3?t.units=o.readString():l===4?t.tileSize=o.readVarint():l===5?t.buffer=o.readVarint():l===6?t.pixelFormat=o.readVarint():l===7&&t.dataIndex.push(function(h,f){return h.readFields(PM,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)}(o,o.readVarint()+o.pos))}function RM(l,t,o){if(l===2)(function(h,f,m){h.readFields(DM,m,f)})(o,o.readVarint()+o.pos,t);else if(l===3)throw new Error("Not implemented")}function DM(l,t,o){if(l===1){let h=0;const f=o.readVarint()+o.pos;for(;o.pos<f;)t[h++]=o.readVarint()}}function OM(l,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let o=t[3];for(let h=2;h>=1;h--){const f=h===1?1:0,m=h===2?1:0;for(let v=0;v<t[0];v++){const C=t[1]*v;for(let I=f;I<t[1];I++){const F=t[2]*(I+C);for(let k=m;k<t[2];k++){const z=t[3]*(k+F);for(let H=0;H<t[3];H++){const $=z+H;l[$]+=l[$-o]}}}}o*=t[h]}return l}function UM(l){for(let t=0,o=l.length;t<o;t++)l[t]=l[t]>>>1^-(1&l[t]);return l}function zM(l,t){switch(t){case"uint32":return l;case"uint16":for(let o=0;o<l.length;o+=2){const h=l[o],f=l[o+1];l[o]=(240&h)>>4|(61440&h)>>8|(240&f)<<4|61440&f,l[o+1]=15&h|(3840&h)>>4|(15&f)<<8|(3840&f)<<4}return l;case"uint8":for(let o=0;o<l.length;o+=4){const h=l[o],f=l[o+1],m=l[o+2],v=l[o+3];l[o+0]=(192&h)>>6|(192&f)>>4|(192&m)>>2|192&v,l[o+1]=(48&h)>>4|(48&f)>>2|48&m|(48&v)<<2,l[o+2]=(12&h)>>2|12&f|(12&m)<<2|(12&v)<<4,l[o+3]=3&h|(3&f)<<2|(3&m)<<4|(3&v)<<6}return l;default:throw new Error(`Invalid pixel format, "${t}"`)}}Zi(X0,"DEMData"),Zi(CC,"DemMinMaxQuadTree",{omit:["dem"]});var kh=Uint8Array,Xm=Uint16Array,NM=Int32Array,EC=new kh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),TC=new kh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jM=new kh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),IC=function(l,t){for(var o=new Xm(31),h=0;h<31;++h)o[h]=t+=1<<l[h-1];var f=new NM(o[30]);for(h=1;h<30;++h)for(var m=o[h];m<o[h+1];++m)f[m]=m-o[h]<<5|h;return{b:o,r:f}},FC=IC(EC,2),LC=FC.b,HM=FC.r;LC[28]=258,HM[258]=28;for(var QM=IC(TC,0).b,MC=new Xm(32768),Sa=0;Sa<32768;++Sa){var Og=(43690&Sa)>>1|(21845&Sa)<<1;MC[Sa]=((65280&(Og=(61680&(Og=(52428&Og)>>2|(13107&Og)<<2))>>4|(3855&Og)<<4))>>8|(255&Og)<<8)>>1}var Ym=function(l,t,o){for(var h=l.length,f=0,m=new Xm(t);f<h;++f)l[f]&&++m[l[f]-1];var v,C=new Xm(t);for(f=1;f<t;++f)C[f]=C[f-1]+m[f-1]<<1;v=new Xm(1<<t);var I=15-t;for(f=0;f<h;++f)if(l[f])for(var F=f<<4|l[f],k=t-l[f],z=C[l[f]-1]++<<k,H=z|(1<<k)-1;z<=H;++z)v[MC[z]>>I]=F;return v},Km=new kh(288);for(Sa=0;Sa<144;++Sa)Km[Sa]=8;for(Sa=144;Sa<256;++Sa)Km[Sa]=9;for(Sa=256;Sa<280;++Sa)Km[Sa]=7;for(Sa=280;Sa<288;++Sa)Km[Sa]=8;var PC=new kh(32);for(Sa=0;Sa<32;++Sa)PC[Sa]=5;var VM=Ym(Km,9),GM=Ym(PC,5),Cx=function(l){for(var t=l[0],o=1;o<l.length;++o)l[o]>t&&(t=l[o]);return t},Ud=function(l,t,o){var h=t/8|0;return(l[h]|l[h+1]<<8)>>(7&t)&o},Sx=function(l,t){var o=t/8|0;return(l[o]|l[o+1]<<8|l[o+2]<<16)>>(7&t)},WM=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],zd=function(l,t,o){var h=new Error(t||WM[l]);if(h.code=l,Error.captureStackTrace&&Error.captureStackTrace(h,zd),!o)throw h;return h},XM=new kh(0),YM=typeof TextDecoder<"u"&&new TextDecoder;try{YM.decode(XM,{stream:!0})}catch{}const KM={gzip_data:"gzip"};class td extends Error{constructor(t){super(t),this.name="MRTError"}}const qM={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},kC={uint32:1,uint16:2,uint8:4},$M={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Ex;class Y0{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const o=this.layers[t];if(!o)throw new td(`Layer '${t}' not found`);return o}getHeaderLength(t){const o=new Uint8Array(t),h=new DataView(t);if(o[0]!==13)throw new td("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(t){const o=new Uint8Array(t),h=this.getHeaderLength(t);if(o.length<h)throw new td(`Expected header with length >= ${h} but got buffer of length ${o.length}`);const f=function(m,v){return m.readFields(IM,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Ex(o.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new td(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const m of f.layers)this.layers[m.name]=new RC(m,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const o=[],h=this.getLayer(t.layerName);for(let f of t.blockIndices){const m=h.dataIndex[f],v=m.firstByte-t.firstByte,C=m.lastByte-t.firstByte;if(h._blocksInProgress.has(f))continue;const I={layerName:h.name,firstByte:v,lastByte:C,pixelFormat:h.pixelFormat,blockIndex:f,blockShape:[m.bands.length].concat(h.bandShape),buffer:h.buffer,codec:m.codec.codec,filters:m.filters.map(F=>F.filter)};h._blocksInProgress.add(f),o.push(I)}return new DC(o,()=>{o.forEach(f=>h._blocksInProgress.delete(f.blockIndex))},(f,m)=>{if(o.forEach(v=>h._blocksInProgress.delete(v.blockIndex)),f)throw f;m.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class RC{constructor({version:t,name:o,units:h,tileSize:f,pixelFormat:m,buffer:v,dataIndex:C},I){if(this.version=t,this.version!==1)throw new td(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=o,this.units=h,this.tileSize=f,this.buffer=v,this.pixelFormat=qM[m],this.dataIndex=C,this.bandShape=[f+2*v,f+2*v,kC[this.pixelFormat]],this._decodedBlocks=new W0(I?I.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return kC[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:t})=>t).flat()}processDecodedData(t){const o=t.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,t.data)}getBlockForBand(t){let o=0;switch(typeof t){case"string":for(const[h,f]of this.dataIndex.entries()){for(const[m,v]of f.bands.entries())if(v===t)return{bandIndex:o+m,blockIndex:h,blockBandIndex:m};o+=f.bands.length}break;case"number":for(const[h,f]of this.dataIndex.entries()){if(t>=o&&t<o+f.bands.length)return{bandIndex:t,blockIndex:h,blockBandIndex:t-o};o+=f.bands.length}break;default:throw new td(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(t){let o=1/0,h=-1/0;const f=[],m=new Set;for(const v of t){const{blockIndex:C}=this.getBlockForBand(v);if(C<0)throw new td(`Invalid band: ${JSON.stringify(v)}`);const I=this.dataIndex[C];f.includes(C)||f.push(C),m.add(C),o=Math.min(o,I.firstByte),h=Math.max(h,I.lastByte)}if(m.size>this.cacheSize)throw new td(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:h,blockIndices:f}}hasBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0}hasDataForBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(t){const{blockIndex:o,blockBandIndex:h}=this.getBlockForBand(t);if(o<0)throw new td(`Band not found: ${JSON.stringify(t)}`);const f=this._decodedBlocks.get(o.toString());if(!f)throw new td(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[o],v=this.bandShape.reduce((F,k)=>F*k,1),C=h*v,I=f.subarray(C,C+v);return{data:I,bytes:new Uint8Array(I.buffer).subarray(I.byteOffset,I.byteOffset+I.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}Y0.setPbf=function(l){Ex=l};class DC{constructor(t,o,h){this.tasks=t,this._onCancel=o,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,o){this._finalized||(this._onComplete(t,o),this._finalized=!0)}}function Wp(l,t){const o=l.json.bufferViews[t.bufferView],h=p0[t.componentType];return new h(l.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*(o.byteStride&&o.byteStride!==Lm[t.type]*h.BYTES_PER_ELEMENT?o.byteStride/h.BYTES_PER_ELEMENT:Lm[t.type]))}function Tx(l,t,o,h){const f=p0[t.componentType],m=function(k){switch(k){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),v=l.json.bufferViews[t.bufferView],C=v.byteStride?v.byteStride/f.BYTES_PER_ELEMENT:Lm[t.type],I=o.float32,F=I.length/o.capacity;for(let k=0,z=0;k<t.count*C;k+=C,z+=F)for(let H=0;H<F;H++)I[z+H]=h[k+H]*m;o._trim()}function ZM(l,t,o){const h=l.indices,f=l.attributes,m={};m.indexArray=new Zo;const v=t.json.accessors[h],C=v.count/3;m.indexArray.reserve(C);const I=Wp(t,v);for(let H=0;H<C;H++)m.indexArray.emplaceBack(I[3*H],I[3*H+1],I[3*H+2]);m.indexArray._trim(),m.vertexArray=new Ku;const F=t.json.accessors[f.POSITION];m.vertexArray.reserve(F.count);const k=Wp(t,F);for(let H=0;H<F.count;H++)m.vertexArray.emplaceBack(k[3*H],k[3*H+1],k[3*H+2]);if(m.vertexArray._trim(),m.aabb=new Re(F.min,F.max),m.centroid=function(H,$){const ee=[0,0,0],ae=H.length;if(ae>0){for(let Ae=0;Ae<ae;Ae++){const ve=3*H[Ae];ee[0]+=$[ve],ee[1]+=$[ve+1],ee[2]+=$[ve+2]}ee[0]/=ae,ee[1]/=ae,ee[2]/=ae}return ee}(I,k),f.COLOR_0!==void 0){const H=t.json.accessors[f.COLOR_0],$=Lm[H.type],ee=Wp(t,H);m.colorArray=$===3?new Ku:new Xa,m.colorArray.resize(H.count),Tx(t,H,m.colorArray,ee)}if(f.NORMAL!==void 0){m.normalArray=new Ku;const H=t.json.accessors[f.NORMAL];m.normalArray.resize(H.count);const $=Wp(t,H);Tx(t,H,m.normalArray,$)}if(f.TEXCOORD_0!==void 0&&o.length>0){m.texcoordArray=new Mh;const H=t.json.accessors[f.TEXCOORD_0];m.texcoordArray.resize(H.count);const $=Wp(t,H);Tx(t,H,m.texcoordArray,$)}if(f._FEATURE_ID_RGBA4444!==void 0){const H=t.json.accessors[f._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=Wp(t,H))}f._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(Wp(t,t.json.accessors[f._FEATURE_RGBA4444]).buffer));const z=l.material;return m.material=function(H,$){const{emissiveFactor:ee=[0,0,0],alphaMode:ae="OPAQUE",alphaCutoff:Ae=.5,normalTexture:ve,occlusionTexture:Fe,emissiveTexture:Le,doubleSided:ce}=H,{baseColorFactor:Ee=[1,1,1,1],metallicFactor:ke=1,roughnessFactor:He=1,baseColorTexture:gt,metallicRoughnessTexture:ht}=H.pbrMetallicRoughness||{},yt=Fe?$[Fe.index]:void 0;if(Fe&&Fe.extensions&&Fe.extensions.KHR_texture_transform&&yt){const Lt=Fe.extensions.KHR_texture_transform;yt.offsetScale=[Lt.offset[0],Lt.offset[1],Lt.scale[0],Lt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Un(...Ee),metallicFactor:ke,roughnessFactor:He,baseColorTexture:gt?$[gt.index]:void 0,metallicRoughnessTexture:ht?$[ht.index]:void 0},doubleSided:ce,emissiveFactor:new Un(...ee),alphaMode:ae,alphaCutoff:Ae,normalTexture:ve?$[ve.index]:void 0,occlusionTexture:yt,emissionTexture:Le?$[Le.index]:void 0,defined:H.defined===void 0}}(z!==void 0?t.json.materials[z]:{defined:!1},o),m}function OC(l,t,o){const{matrix:h,rotation:f,translation:m,scale:v,mesh:C,extras:I,children:F}=l,k={};if(k.matrix=h||function(z,H,$,ee){var ae=H[0],Ae=H[1],ve=H[2],Fe=H[3],Le=ae+ae,ce=Ae+Ae,Ee=ve+ve,ke=ae*Le,He=ae*ce,gt=ae*Ee,ht=Ae*ce,yt=Ae*Ee,Lt=ve*Ee,Wt=Fe*Le,Si=Fe*ce,fi=Fe*Ee,Ci=ee[0],Ii=ee[1],$t=ee[2];return z[0]=(1-(ht+Lt))*Ci,z[1]=(He+fi)*Ci,z[2]=(gt-Si)*Ci,z[3]=0,z[4]=(He-fi)*Ii,z[5]=(1-(ke+Lt))*Ii,z[6]=(yt+Wt)*Ii,z[7]=0,z[8]=(gt+Si)*$t,z[9]=(yt-Wt)*$t,z[10]=(1-(ke+ht))*$t,z[11]=0,z[12]=$[0],z[13]=$[1],z[14]=$[2],z[15]=1,z}([],f||[0,0,0,1],m||[0,0,0],v||[1,1,1]),C!==void 0){k.meshes=o[C];const z=k.anchor=[0,0];for(const H of k.meshes){const{min:$,max:ee}=H.aabb;z[0]+=$[0]+ee[0],z[1]+=$[1]+ee[1]}z[0]=Math.floor(z[0]/k.meshes.length/2),z[1]=Math.floor(z[1]/k.meshes.length/2)}if(I&&(I.id&&(k.id=I.id),I.lights&&(k.lights=function(z){if(!z.length)return[];const H=function(ve){const Fe=atob(ve),Le=new Uint8Array(Fe.length);for(let ce=0;ce<Fe.length;ce++)Le[ce]=Fe.codePointAt(ce);return Le}(z),$=[],ee=H.length/24,ae=new Uint16Array(H.buffer),Ae=new Float32Array(H.buffer);for(let ve=0;ve<ee;ve++){const Fe=ae[2*ve*6]/30,Le=ae[2*ve*6+1]/30,ce=ae[2*ve*6+10]/100,Ee=Ae[6*ve+1],ke=Ae[6*ve+2],He=Ae[6*ve+3],gt=Ae[6*ve+4],ht=He-Ee,yt=gt-ke,Lt=Math.hypot(ht,yt);$.push({pos:[Ee+.5*ht,ke+.5*yt,Le],normal:[yt/Lt,-ht/Lt,0],width:Lt,height:Fe,depth:ce,points:[Ee,ke,He,gt]})}return $}(I.lights))),F){const z=[];for(const H of F)z.push(OC(t.json.nodes[H],t,o));k.children=z}return k}function JM(l){if(l.vertices.length===0||l.indices.length===0)return null;const t=new L_(l.vertices,l.indices,8,256),[o,h]=[t.min.clone(),t.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:t,min:o,max:h}}function e3(l){if(!l.extras||!l.extras.ground)return null;const t=l.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const h=[];for(const v of o){if(!Array.isArray(v)||v.length!==2)continue;const C=v[0],I=v[1];typeof C=="number"&&typeof I=="number"&&h.push(new qt(C,I))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let f=0;for(let v=0;v<h.length;v++){const C=h[v],I=h[(v+1)%h.length],F=h[(v+2)%h.length];f+=(C.x-I.x)*(F.y-I.y)-(F.x-I.x)*(C.y-I.y)}f>0&&h.reverse();const m=vm(h.flatMap(v=>[v.x,v.y]),[]);return m.length===0?null:{vertices:h,indices:m}}function t3(l,t){const o=[],h=[];let f=0;const m=[];for(const v of l){f=o.length;const C=v.vertexArray.float32,I=v.indexArray.uint16;for(let F=0;F<v.vertexArray.length;F++)m[0]=C[3*F+0],m[1]=C[3*F+1],m[2]=C[3*F+2],tt(m,m,t),o.push(new qt(m[0],m[1]));for(let F=0;F<3*v.indexArray.length;F++)h.push(I[F]+f)}if(h.length%3!=0)return null;for(let v=0;v<h.length;v+=3){const C=o[h[v+0]],I=o[h[v+1]],F=o[h[v+2]];(C.x-I.x)*(F.y-I.y)-(F.x-I.x)*(C.y-I.y)>0&&([h[v+1],h[v+2]]=[h[v+2],h[v+1]])}return{vertices:o,indices:h}}function UC(l){const t=function(I,F){const k=[],z=WebGL2RenderingContext;if(I.json.textures)for(const H of I.json.textures){const $={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};H.sampler!==void 0&&Object.assign($,I.json.samplers[H.sampler]),k.push({image:F[H.source],sampler:$,uploaded:!1})}return k}(l,l.images),o=function(I,F){const k=[];for(const z of I.json.meshes){const H=[];for(const $ of z.primitives)H.push(ZM($,I,F));k.push(H)}return k}(l,t),{scenes:h,scene:f,nodes:m}=l.json,v=h?h[f||0].nodes:m,C=[];for(const I of v)C.push(OC(m[I],l,o));return function(I,F,k){const z={},H=new Set;for(let $=0;$<I.length;$++){const ee=k[F[$]];if(!ee.extras)continue;const ae=ee.extras["mapbox:footprint:version"],Ae=ee.extras["mapbox:footprint:id"];(ae||Ae)&&H.add($),ae==="1.0.0"&&Ae&&(z[Ae]=$)}for(let $=0;$<I.length;$++){if(H.has($))continue;const ee=I[$],ae=k[F[$]];if(!ae.extras)continue;let Ae=null;ee.id in z&&(Ae=t3(I[z[ee.id]].meshes,ee.matrix)),Ae||(Ae=e3(ae)),Ae&&(ee.footprint=JM(Ae))}if(H.size>0){const $=Array.from(H.values()).sort((ee,ae)=>ee-ae);for(let ee=$.length-1;ee>=0;ee--)I.splice($[ee],1)}}(C,v,l.json.nodes),C}function i3(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const t=l.vertexArray.float32,o=l.aabb.min[0]-1,h=l.aabb.min[1]-1,f=Vp/(l.aabb.max[0]-o+2),m=Vp/(l.aabb.max[1]-h+2);for(let v=0;v<t.length;v+=3){const C=t[v+2],I=(t[v+0]-o)*f|0,F=(t[v+1]-h)*m|0;C>l.heightmap[F*Vp+I]&&(l.heightmap[F*Vp+I]=C)}}function r3(l,t){const o={};o.indexArray=new Zo,o.indexArray.reserve(4*l.length),o.vertexArray=new Ku,o.vertexArray.reserve(10*l.length),o.colorArray=new Xa,o.vertexArray.reserve(10*l.length);let h=0;for(const v of l){const C=Math.min(10,Math.max(4,1.3*v.height))*t,I=[-v.normal[1],v.normal[0],0],F=Math.min(.29,.1*v.width/v.depth),k=v.width-2*v.depth*t*(F+.01),z=Qt([],v.pos,I,k/2),H=Qt([],v.pos,I,-k/2),$=[z[0],z[1],z[2]+v.height],ee=[H[0],H[1],H[2]+v.height],ae=Qt([],v.normal,I,F);pt(ae,ae,C);const Ae=Qt([],v.normal,I,-F);pt(Ae,Ae,C),Pe(ae,z,ae),Pe(Ae,H,Ae),z[2]+=.1,H[2]+=.1,o.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),o.vertexArray.emplaceBack(Ae[0],Ae[1],Ae[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]),o.vertexArray.emplaceBack(H[0],H[1],H[2]),o.vertexArray.emplaceBack($[0],$[1],$[2]),o.vertexArray.emplaceBack(ee[0],ee[1],ee[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]),o.vertexArray.emplaceBack(H[0],H[1],H[2]),o.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),o.vertexArray.emplaceBack(Ae[0],Ae[1],Ae[2]);const ve=k/C/2;o.colorArray.emplaceBack(-ve-F,-1,ve,.8),o.colorArray.emplaceBack(ve+F,-1,ve,.8),o.colorArray.emplaceBack(-ve,0,ve,1.3),o.colorArray.emplaceBack(ve,0,ve,1.3),o.colorArray.emplaceBack(ve+F,-.8,ve,.7),o.colorArray.emplaceBack(ve+F,-.8,ve,.7),o.colorArray.emplaceBack(0,0,ve,1.3),o.colorArray.emplaceBack(0,0,ve,1.3),o.colorArray.emplaceBack(ve+F,-1.2,ve,.8),o.colorArray.emplaceBack(ve+F,-1.2,ve,.8),o.indexArray.emplaceBack(6+h,4+h,8+h),o.indexArray.emplaceBack(7+h,9+h,5+h),o.indexArray.emplaceBack(0+h,1+h,2+h),o.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const f={defined:!0};f.emissiveFactor=Un.black;const m={};return m.baseColorFactor=Un.white,f.pbrMetallicRoughness=m,o.material=f,o.aabb=new Re([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}Y0.performDecoding=function(l,t){const o=new Uint8Array(l);return Promise.all(t.tasks.map(h=>{const{layerName:f,firstByte:m,lastByte:v,pixelFormat:C,blockShape:I,blockIndex:F,filters:k,codec:z}=h,H=o.subarray(m,v+1),$=new Uint32Array(I[0]*I[1]*I[2]);let ee;if(z!=="gzip_data")throw new td(`Unhandled codec: ${z}`);return ee=function(ae,Ae){if(!globalThis.DecompressionStream&&Ae==="gzip_data")return Promise.resolve(((ce=function(He){He[0]==31&&He[1]==139&&He[2]==8||zd(6,"invalid gzip data");var gt=He[3],ht=10;4&gt&&(ht+=2+(He[10]|He[11]<<8));for(var yt=(gt>>3&1)+(gt>>4&1);yt>0;yt-=!He[ht++]);return ht+(2&gt)}(Le=ae))+8>Le.length&&zd(6,"invalid gzip data"),function(He,gt,ht,yt){var Lt=He.length;if(!Lt||gt.f&&!gt.l)return ht||new kh(0);var Wt=!ht,Si=Wt||gt.i!=2,fi=gt.i;Wt&&(ht=new kh(3*Lt));var Ci,Ii,$t=function(wo){var Gs=ht.length;if(wo>Gs){var Ds=new kh(Math.max(2*Gs,wo));Ds.set(ht),ht=Ds}},_i=gt.f||0,Gt=gt.p||0,Yt=gt.b||0,ki=gt.l,Di=gt.d,xr=gt.m,cr=gt.n,Xi=8*Lt;do{if(!ki){_i=Ud(He,Gt,1);var Pi=Ud(He,Gt+1,3);if(Gt+=3,!Pi){var $r=He[(ze=4+((Gt+7)/8|0))-4]|He[ze-3]<<8,or=ze+$r;if(or>Lt){fi&&zd(0);break}Si&&$t(Yt+$r),ht.set(He.subarray(ze,or),Yt),gt.b=Yt+=$r,gt.p=Gt=8*or,gt.f=_i;continue}if(Pi==1)ki=VM,Di=GM,xr=9,cr=5;else if(Pi==2){var Ar=Ud(He,Gt,31)+257,Nr=Ud(He,Gt+10,15)+4,an=Ar+Ud(He,Gt+5,31)+1;Gt+=14;for(var on=new kh(an),vn=new kh(19),un=0;un<Nr;++un)vn[jM[un]]=Ud(He,Gt+3*un,7);Gt+=3*Nr;var _n=Cx(vn),ns=(1<<_n)-1,zs=Ym(vn,_n);for(un=0;un<an;){var ze,Ve=zs[Ud(He,Gt,ns)];if(Gt+=15&Ve,(ze=Ve>>4)<16)on[un++]=ze;else{var Jt=0,zi=0;for(ze==16?(zi=3+Ud(He,Gt,3),Gt+=2,Jt=on[un-1]):ze==17?(zi=3+Ud(He,Gt,7),Gt+=3):ze==18&&(zi=11+Ud(He,Gt,127),Gt+=7);zi--;)on[un++]=Jt}}var Yi=on.subarray(0,Ar),Wi=on.subarray(Ar);xr=Cx(Yi),cr=Cx(Wi),ki=Ym(Yi,xr),Di=Ym(Wi,cr)}else zd(1);if(Gt>Xi){fi&&zd(0);break}}Si&&$t(Yt+131072);for(var sr=(1<<xr)-1,Or=(1<<cr)-1,wn=Gt;;wn=Gt){var Bn=(Jt=ki[Sx(He,Gt)&sr])>>4;if((Gt+=15&Jt)>Xi){fi&&zd(0);break}if(Jt||zd(2),Bn<256)ht[Yt++]=Bn;else{if(Bn==256){wn=Gt,ki=null;break}var hn=Bn-254;Bn>264&&(hn=Ud(He,Gt,(1<<(Cn=EC[un=Bn-257]))-1)+LC[un],Gt+=Cn);var ls=Di[Sx(He,Gt)&Or],Rs=ls>>4;if(ls||zd(3),Gt+=15&ls,Wi=QM[Rs],Rs>3){var Cn=TC[Rs];Wi+=Sx(He,Gt)&(1<<Cn)-1,Gt+=Cn}if(Gt>Xi){fi&&zd(0);break}Si&&$t(Yt+131072);var so=Yt+hn;if(Yt<Wi){var Ns=0-Wi,ss=Math.min(Wi,so);for(Ns+Yt<0&&zd(3);Yt<ss;++Yt)ht[Yt]=(void 0)[Ns+Yt]}for(;Yt<so;++Yt)ht[Yt]=ht[Yt-Wi]}}gt.l=ki,gt.p=wn,gt.b=Yt,gt.f=_i,ki&&(_i=1,gt.m=xr,gt.d=Di,gt.n=cr)}while(!_i);return Yt!=ht.length&&Wt?(Ci=ht,((Ii=Yt)==null||Ii>Ci.length)&&(Ii=Ci.length),new kh(Ci.subarray(0,Ii))):ht.subarray(0,Yt)}(Le.subarray(ce,-8),{i:2},new kh(((ve=Le)[(Fe=ve.length)-4]|ve[Fe-3]<<8|ve[Fe-2]<<16|ve[Fe-1]<<24)>>>0))));var ve,Fe,Le,ce;const Ee=KM[Ae];if(!Ee)throw new Error(`Unhandled codec: ${Ae}`);const ke=new globalThis.DecompressionStream(Ee);return new Response(new Blob([ae]).stream().pipeThrough(ke)).arrayBuffer().then(He=>new Uint8Array(He))}(H,z).then(ae=>(function(Ae,ve){Ae.readFields(RM,ve)}(new Ex(ae),$),new $M[C]($.buffer))),ee.then(ae=>{for(let Ae=k.length-1;Ae>=0;Ae--)switch(k[Ae]){case"delta_filter":OM(ae,I);break;case"zigzag_filter":UM(ae);break;case"bitshuffle_filter":zM(ae,C);break;default:throw new td(`Unhandled filter "${k[Ae]}"`)}return{layerName:f,blockIndex:F,data:ae}}).catch(ae=>{throw ae})}))},Zi(DC,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Zi(Y0,"MapboxRasterTile"),Zi(RC,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class zC{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const h=t[o];this._stringToNumber[h]=o,this._numberToString[o]=h}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const n3=["id","tile","layer","source","sourceLayer","state"];class Ug{constructor(t,o,h,f,m){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=h,this._y=f,this.properties=t.properties,this.id=m}clone(){const t=new Ug(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(t.state=Object.assign({},this.state)),this.layer&&(t.layer=Object.assign({},this.layer)),this.source&&(t.source=this.source),this.sourceLayer&&(t.sourceLayer=this.sourceLayer),t}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of n3)this[o]!==void 0&&(t[o]=this[o]);return t}}class NC{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qa(wi,16,0),this.featureIndexArray=new Td,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(t,o,h,f,m,v=0,C=0){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,f,m,v);const F=this.grid;for(let k=0;k<o.length;k++){const z=o[k],H=[1/0,1/0,-1/0,-1/0];for(let $=0;$<z.length;$++){const ee=z[$];H[0]=Math.min(H[0],ee.x),H[1]=Math.min(H[1],ee.y),H[2]=Math.max(H[2],ee.x),H[3]=Math.max(H[3],ee.y)}C!==0&&(H[0]-=C,H[1]-=C,H[2]+=C,H[3]+=C),H[0]<wi&&H[1]<wi&&H[2]>=0&&H[3]>=0&&F.insert(I,H[0],H[1],H[2],H[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ln.VectorTile(new m0(this.rawTileData)).layers,this.sourceLayerCoder=new zC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o){const{tilespaceGeometry:h,transform:f,tileTransform:m,pixelPosMatrix:v,availableImages:C,worldview:I}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const F=h.bufferedTilespaceBounds,k=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(ee,ae,Ae,ve)=>bs(h.bufferedTilespaceGeometry,ee,ae,Ae,ve));k.sort(s3);let z=null;f.elevation&&k.length>0&&(z=kg.create(f.elevation,this.tileID));const H={};let $;for(let ee=0;ee<k.length;ee++){const ae=k[ee];if(ae===$)continue;$=ae;const Ae=this.featureIndexArray.get(ae);let ve=null;this.is3DTile?this.loadMatchingModelFeature(H,Ae,t,h,f,I):this.loadMatchingFeature(H,Ae,t,C,I,(Fe,Le,ce,Ee=0)=>(ve||(ve=tr(Fe,this.tileID.canonical,m)),Le.queryIntersectsFeature(h,Fe,ce,ve,this.z,f,v,z,Ee)))}return H}loadMatchingFeature(t,o,h,f,m,v){const{featureIndex:C,bucketIndex:I,sourceLayerIndex:F,layoutVertexArrayOffset:k}=o,z=this.bucketLayerIDs[I],H=h.layers,$=Object.keys(H);if($.length&&!jr($,z))return;const ee=h.sourceCache,ae=this.sourceLayerCoder.decode(F),Ae=this.vtLayers[ae].feature(C),ve=this.getId(Ae,ae);for(let Fe=0;Fe<z.length;Fe++){const Le=z[Fe];if(!H[Le])continue;const{styleLayer:ce,targets:Ee}=H[Le];let ke={};ve!==void 0&&(ke=ee.getFeatureState(ce.sourceLayer,ve));const He=!v||v(Ae,ce,ke,k);if(!He)continue;const gt=new Ug(Ae,this.z,this.x,this.y,ve);gt.tile=this.tileID.canonical,gt.state=ke;let ht=this.serializedLayersCache.get(Le);ht||(ht=ce.serialize(),ht.id=Le,this.serializedLayersCache.set(Le,ht)),gt.source=ht.source,gt.sourceLayer=ht["source-layer"],gt.layer=Ot({},ht),gt.layer.paint=jC(ht.paint,ce.paint,Ae,ke,f),gt.layer.layout=jC(ht.layout,ce.layout,Ae,ke,f);let yt=!1;for(const Lt of Ee){this.updateFeatureProperties(gt,Lt);const{filter:Wt}=Lt;if(Wt){if(Ae.properties=gt.properties,Wt.needGeometry){const Si=Ki(Ae,!0);if(!Wt.filter(new Xn(this.tileID.overscaledZ,{worldview:m}),Si,this.tileID.canonical))continue}else if(!Wt.filter(new Xn(this.tileID.overscaledZ,{worldview:m}),Ae))continue}yt=!0,Lt.targetId&&this.addFeatureVariant(gt,Lt)}yt&&this.appendToResult(t,Le,C,gt,He)}}loadMatchingModelFeature(t,o,h,f,m,v){const{featureIndex:C,bucketIndex:I}=o,F=this.bucketLayerIDs[I],k=h.layers,z=Object.keys(k);if(!z.length||jr(z,F))for(let H=0;H<F.length;H++){const $=F[H],{styleLayer:ee,targets:ae}=k[$];if(ee.type!=="model")continue;const Ae=f.tile,ve=Ae.getBucket(ee);if(!(ve&&ve instanceof j0))continue;const Fe=nM(ve,C,f,m);if(!Fe)continue;const{z:Le,x:ce,y:Ee}=Ae.tileID.canonical,{feature:ke,intersectionZ:He,position:gt}=Fe;let ht={};ke.id!==void 0&&(ht=h.sourceCache.getFeatureState(ee.sourceLayer,ke.id));const yt=new Ug({},Le,ce,Ee,ke.id);yt.tile=this.tileID.canonical,yt.state=ht,yt.properties=ke.properties,yt.geometry={type:"Point",coordinates:[gt.lng,gt.lat]};let Lt=this.serializedLayersCache.get($);Lt||(Lt=ee.serialize(),Lt.id=$,this.serializedLayersCache.set($,Lt)),yt.source=Lt.source,yt.sourceLayer=Lt["source-layer"],yt.layer=Ot({},Lt);let Wt=!1;for(const Si of ae){this.updateFeatureProperties(yt,Si);const{filter:fi}=Si;if(fi){if(ke.properties=yt.properties,fi.needGeometry){if(!fi.filter(new Xn(this.tileID.overscaledZ,{worldview:v}),ke,this.tileID.canonical))continue}else if(!fi.filter(new Xn(this.tileID.overscaledZ,{worldview:v}),ke))continue}Wt=!0,Si.targetId&&this.addFeatureVariant(yt,Si)}Wt&&this.appendToResult(t,$,C,yt,He)}}updateFeatureProperties(t,o,h){if(o.properties){const f={};for(const m in o.properties){const v=o.properties[m].evaluate({zoom:this.z},t._vectorTileFeature,t.state,t.tile,h);v!=null&&(f[m]=v)}t.properties=f}}addFeatureVariant(t,o,h){const f={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(f.properties=t.properties),t.variants=t.variants||{},t.variants[o.targetId]=t.variants[o.targetId]||[],t.variants[o.targetId].push(f)}appendToResult(t,o,h,f,m){let v=t[o];v===void 0&&(v=t[o]=[]),v.push({featureIndex:h,feature:f,intersectionZ:m})}lookupSymbolFeatures(t,o,h,f,m,v){const C={};this.loadVTLayers();for(const I of t)this.loadMatchingFeature(C,{bucketIndex:o,sourceLayerIndex:h,featureIndex:I,layoutVertexArrayOffset:0},f,m,v);return C}loadFeature(t){const{featureIndex:o,sourceLayerIndex:h}=t;this.loadVTLayers();const f=this.sourceLayerCoder.decode(h),m=this.vtFeatures[f];if(m[o])return m[o];const v=this.vtLayers[f].feature(o);return m[o]=v,v}hasLayer(t){for(const o of this.bucketLayerIDs)for(const h of o)if(t===h)return!0;return!1}getId(t,o){let h=t.id;if(this.promoteId){const f=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(f!=null)if(Array.isArray(f)){if(!this.promoteIdExpression){const m=as(f);if(m.result!=="success"){const v=m.value.map(C=>`${C.key}: ${C.message}`).join(", ");return void Yr(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new xc),h=this.promoteIdExpression.evaluate({zoom:0},t)}else h=t.properties[f];typeof h=="boolean"&&(h=Number(h))}return h}}function jC(l,t,o,h,f){return nr(l,(m,v)=>{const C=t instanceof $c?t.get(v):null;return C&&C.evaluate?C.evaluate(o,h,void 0,f):C})}function s3(l,t){return t-l}Zi(NC,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const HC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ix{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,h]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=h>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const m=HC[15&h];if(!m)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new Ix(C,v,m,t)}constructor(t,o=64,h=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=h,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=HC.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${h}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+I,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+C+I),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+I,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=t,this.coords[this._pos++]=o,h}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Fx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,h,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:C}=this,I=[0,m.length-1,0],F=[];for(;I.length;){const k=I.pop()||0,z=I.pop()||0,H=I.pop()||0;if(z-H<=C){for(let Ae=H;Ae<=z;Ae++){const ve=v[2*Ae],Fe=v[2*Ae+1];ve>=t&&ve<=h&&Fe>=o&&Fe<=f&&F.push(m[Ae])}continue}const $=H+z>>1,ee=v[2*$],ae=v[2*$+1];ee>=t&&ee<=h&&ae>=o&&ae<=f&&F.push(m[$]),(k===0?t<=ee:o<=ae)&&(I.push(H),I.push($-1),I.push(1-k)),(k===0?h>=ee:f>=ae)&&(I.push($+1),I.push(z),I.push(1-k))}return F}within(t,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:m,nodeSize:v}=this,C=[0,f.length-1,0],I=[],F=h*h;for(;C.length;){const k=C.pop()||0,z=C.pop()||0,H=C.pop()||0;if(z-H<=v){for(let Ae=H;Ae<=z;Ae++)VC(m[2*Ae],m[2*Ae+1],t,o)<=F&&I.push(f[Ae]);continue}const $=H+z>>1,ee=m[2*$],ae=m[2*$+1];VC(ee,ae,t,o)<=F&&I.push(f[$]),(k===0?t-h<=ee:o-h<=ae)&&(C.push(H),C.push($-1),C.push(1-k)),(k===0?t+h>=ee:o+h>=ae)&&(C.push($+1),C.push(z),C.push(1-k))}return I}}function Fx(l,t,o,h,f,m){if(f-h<=o)return;const v=h+f>>1;QC(l,t,v,h,f,m),Fx(l,t,o,h,v-1,1-m),Fx(l,t,o,v+1,f,1-m)}function QC(l,t,o,h,f,m){for(;f>h;){if(f-h>600){const F=f-h+1,k=o-h+1,z=Math.log(F),H=.5*Math.exp(2*z/3),$=.5*Math.sqrt(z*H*(F-H)/F)*(k-F/2<0?-1:1);QC(l,t,o,Math.max(h,Math.floor(o-k*H/F+$)),Math.min(f,Math.floor(o+(F-k)*H/F+$)),m)}const v=t[2*o+m];let C=h,I=f;for(qm(l,t,h,o),t[2*f+m]>v&&qm(l,t,h,f);C<I;){for(qm(l,t,C,I),C++,I--;t[2*C+m]<v;)C++;for(;t[2*I+m]>v;)I--}t[2*h+m]===v?qm(l,t,h,I):(I++,qm(l,t,I,f)),I<=o&&(h=I+1),o<=I&&(f=I-1)}}function qm(l,t,o,h){Lx(l,o,h),Lx(t,2*o,2*h),Lx(t,2*o+1,2*h+1)}function Lx(l,t,o){const h=l[t];l[t]=l[o],l[o]=h}function VC(l,t,o,h){const f=l-o,m=t-h;return f*f+m*m}r.$=So,r.A=Qc,r.B=xn,r.C=Zc,r.D=Cg,r.E=gu,r.F=2,r.G=Dm,r.H=lB,r.I=ra,r.J=pa,r.K=class extends z0{},r.L=_c,r.M=ac,r.N=Fs,r.O=Ir,r.P=qt,r.Q=zr,r.R=uh,r.S=oa,r.T=hx,r.U=vd,r.V=z0,r.W=Ca,r.X=as,r.Y=wu,r.Z=Gh,r._=Nu,r.a=function(l){return us.API_CDN_URL_REGEX.test(l)},r.a$=Nt,r.a0=xl,r.a1=yA,r.a2=Qs,r.a3=bn,r.a4=function(l){const t=l.value;let o=[];if(!t)return o;const h=pa(t);return h!=="string"?(o=o.concat([new z0(l.key,t,`string expected, "${h}" found`)]),o):(px(t,!0)||(o=o.concat([new z0(l.key,t,`invalid url "${t}"`)])),o)},r.a5=Ft,r.a6=md,r.a7=Us,r.a8=Ei,r.a9=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return ps(l.expression.evaluate(t))}interpolate(l,t,o){return{x:Er(l.x,t.x,o),y:Er(l.y,t.y,o),z:Er(l.z,t.z,o),azimuthal:Er(l.azimuthal,t.azimuthal,o),polar:Er(l.polar,t.polar,o)}}},r.aA=Kt,r.aB=S,r.aC=rs,r.aD=it,r.aE=zt,r.aF=function(l,t){const o={};for(let h=0;h<t.length;h++){const f=t[h];f in l&&(o[f]=l[f])}return o},r.aG=Ne,r.aH=Xe,r.aI=class{constructor(l){this.entries={},this.scheduler=l}request(l,t,o,h){const f=this.entries[l]=this.entries[l]||{callbacks:[]};if(f.result){const[m,v]=f.result;return this.scheduler?this.scheduler.add(()=>{h(m,v)},t):h(m,v),()=>{}}return f.callbacks.push(h),f.cancel||(f.cancel=o((m,v)=>{f.result=[m,v];for(const C of f.callbacks)this.scheduler?this.scheduler.add(()=>{C(m,v)},t):C(m,v);setTimeout(()=>delete this.entries[l],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==h),f.callbacks.length||(f.cancel(),delete this.entries[l]))}}},r.aJ=function(l,t,o){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},f=>{const m=jc(l.request,(v,C,I,F)=>{v?f(v):C&&f(null,{vectorTile:o?void 0:new ln.VectorTile(new m0(C)),rawData:C,cacheControl:I,expires:F})});return()=>{m.cancel(),f()}},t)},r.aK=function(l){uu++,uu>yc&&(l.getActor().send("enforceCacheSizeLimit",gl),uu=0)},r.aL=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},r.aM=ya,r.aN=OB,r.aO=QB,r.aP=DB,r.aQ=function(l,t){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let h=0;h<l.length;h++){const f=document.createElement("source");yl(l[h])||(o.crossOrigin="Anonymous"),f.src=l[h],o.appendChild(f)}return{cancel:()=>{}}},r.aR=k0,r.aS=function(l){return fetch(l).then(t=>t.arrayBuffer()).then(t=>E2(t,0,l))},r.aT=UC,r.aU=class{constructor(l,t,o,h){this.id=l,this.position=t!=null?new Te(t[0],t[1]):new Te(0,0),this.orientation=o??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new Re([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,t){if(U(l.matrix,t,l.matrix),l.meshes)for(const o of l.meshes){const h=Re.applyTransformFast(o.aabb,l.matrix);this.aabb.encapsulate(h)}if(l.children)for(const o of l.children)this._applyTransformations(o,l.matrix)}computeBoundsAndApplyParent(){const l=P([]);for(const t of this.nodes)this._applyTransformations(t,l)}computeModelMatrix(l,t,o,h,f,m,v=!1){eC(this.matrix,this,l.transform,this.position,t,o,h,f,m,v)}upload(l){if(!this.uploaded){for(const t of this.nodes)mx(t,l);for(const t of this.nodes)N0(t);this.uploaded=!0}}destroy(){for(const l of this.nodes)yx(l)}},r.aV=er,r.aW=Um,r.aX=dt,r.aY=kt,r.aZ=_A,r.a_=Zo,r.aa=Xn,r.ab=ja,r.ac=wt,r.ad=tt,r.ae=Me,r.af=vt,r.ag=$c,r.ah=Zf,r.ai=Er,r.aj=wi,r.ak=Ah,r.al=dn,r.am=Un,r.an=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return function([o,h]){const f=ps([1,o,h]);return{x:f.x,y:f.y,z:f.z}}(l.expression.evaluate(t))}interpolate(l,t,o){return{x:Er(l.x,t.x,o),y:Er(l.y,t.y,o),z:Er(l.z,t.z,o)}}},r.ao=function(l,t,o=0,h=!0){const f=new qt(o,o),m=l.sub(f),v=t.add(f),C=[m,new qt(v.x,m.y),v,new qt(m.x,v.y)];return h&&C.push(m.clone()),C},r.ap=function(l,t){const o=[];for(let h=0;h<l.length;h++){const f=Rt(h-1,-1,l.length-1),m=Rt(h+1,-1,l.length-1),v=l[h],C=l[m],I=l[f].sub(v).unit(),F=C.sub(v).unit(),k=F.angleWithSep(I.x,I.y),z=I.add(F).unit().mult(-1*t/Math.sin(k/2));o.push(v.add(z))}return o},r.aq=bB,r.ar=bs,r.as=function(l,t,o=0){return Be(((t.x-o)*l.scale-l.x)*wi,(t.y*l.scale-l.y)*wi,Dt(t.z,t.y))},r.at=Ke,r.au=mt,r.av=ks,r.aw=k2,r.ax=function(l){let t=1/0,o=1/0,h=-1/0,f=-1/0;for(const m of l)t=Math.min(t,m.x),o=Math.min(o,m.y),h=Math.max(h,m.x),f=Math.max(f,m.y);return{min:new qt(t,o),max:new qt(h,f)}},r.ay=Ge,r.az=U,r.b=function(l){return us.API_FONTS_REGEX.test(l)},r.b$=function(l,t,o){o*=.5;var h=t[0],f=t[1],m=t[2],v=t[3],C=Math.sin(o),I=Math.cos(o);return l[0]=h*I+f*C,l[1]=f*I-h*C,l[2]=m*I+v*C,l[3]=v*I-m*C,l},r.b0=Ed,r.b1=M0,r.b2=function(){qc.isLoading()||qc.isLoaded()||cl()!=="deferred"||mA()},r.b3=vA,r.b4=Ki,r.b5=Ug,r.b6=En,r.b7=Q_,r.b8=F_,r.b9=tr,r.bA=function(l,t){const{x:o,y:h}=l.point,f=Aw(o,h,l.worldSize/l._pixelsPerMercatorPixel,0,0);return U(f,f,__(LA(t)))},r.bB=x,r.bC=function(l){return l[0]=0,l[1]=0,l[2]=0,l},r.bD=function(l,t){return Math.hypot(t[0]-l[0],t[1]-l[1],t[2]-l[2])},r.bE=Qt,r.bF=rt,r.bG=Ct,r.bH=Rm,r.bI=Fu,r.bJ=$_,r.bK=function(l,t,o,h,f){const m=5*t+2;l.float32[m+0]=o,l.float32[m+1]=h,l.float32[m+2]=f},r.bL=L0,r.bM=A0,r.bN=Ui,r.bO=il,r.bP=Qw,r.bQ=KB,r.bR=Yw,r.bS=Kw,r.bT=q_,r.bU=pB,r.bV=tx,r.bW=Ix,r.bX=Rt,r.bY=pt,r.bZ=It,r.b_=pi,r.ba=Yu,r.bb=BA,r.bc=$f,r.bd=Vs,r.be=vm,r.bf=lx,r.bg=function(l,t){const o=Zf(t.zoom);if(o===0)return LA(l);const h=i0(l),f=v_(h),m=it(h.getWest())*t.worldSize,v=it(h.getEast())*t.worldSize,C=Xe(h.getNorth())*t.worldSize,I=Xe(h.getSouth())*t.worldSize,F=[m,C,0],k=[v,C,0],z=[m,I,0],H=[v,I,0],$=G([],t.globeMatrix);return tt(F,F,$),tt(k,k,$),tt(z,z,$),tt(H,H,$),f[0]=Af(f[0],z,o),f[1]=Af(f[1],H,o),f[2]=Af(f[2],k,o),f[3]=Af(f[3],F,o),Re.fromPoints(f)},r.bh=n0,r.bi=G,r.bj=mm,r.bk=Af,r.bl=bd,r.bm=qf,r.bn=fe,r.bo=Q,r.bp=Y0,r.bq=m0,r.br=jc,r.bs=function(l,t){const o=[];for(const h in l)h in t||o.push(h);return o},r.bt=_t,r.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bv=Nn,r.bw=function(l){var t=new b(16);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],t[4]=l[4],t[5]=l[5],t[6]=l[6],t[7]=l[7],t[8]=l[8],t[9]=l[9],t[10]=l[10],t[11]=l[11],t[12]=l[12],t[13]=l[13],t[14]=l[14],t[15]=l[15],t},r.bx=P,r.by=pe,r.bz=R,r.c=lh,r.c$=f0,r.c0=Ri,r.c1=_s,r.c2=function(l,t){return l[0]=-t[0],l[1]=-t[1],l[2]=-t[2],l[3]=t[3],l},r.c3=be,r.c4=function(l,t,o,h,f){var m,v=1/Math.tan(t/2);return l[0]=v/o,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=v,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,f!=null&&f!==1/0?(l[10]=(f+h)*(m=1/(h-f)),l[14]=2*f*h*m):(l[10]=-1,l[14]=-2*h),l},r.c5=function(l,t,o,h,f,m,v){var C=1/(t-o),I=1/(h-f),F=1/(m-v);return l[0]=-2*C,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*I,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*F,l[11]=0,l[12]=(t+o)*C,l[13]=(f+h)*I,l[14]=(v+m)*F,l[15]=1,l},r.c6=lt,r.c7=function(l,t,o){l[4*t+0]=o[0],l[4*t+1]=o[1],l[4*t+2]=o[2],l[4*t+3]=o[3]},r.c8=Xf,r.c9=cf,r.cA=O0,r.cB=Se,r.cC=VB,r.cD=function(l){const t=VB(l,!0);return x([],[t[0],t[1],t[4],t[5]])},r.cE=q,r.cF=N,r.cG=ne,r.cH=function(l){const{x:t,y:o}=l.point,{lng:h,lat:f}=l._center;return Aw(t,o,l.worldSize,h,f)},r.cI=et,r.cJ=St,r.cK=Ju,r.cL=L,r.cM=function(l,t,o){let h=0;for(let f=0;f<2;++f)l[f]>0&&(h+=(l[f]-0)*(l[f]-0)),t[f]<0&&(h+=(0-t[f])*(0-t[f]));return h},r.cN=function(l){return l*l*l*l*l},r.cO=st,r.cP=45,r.cQ=Yf,r.cR=function(l,t,o){const h=Math.sqrt(l*l+t*t+o*o),f=h>0?Math.acos(o/h)*ia:0;let m=l!==0||t!==0?Math.atan2(-t,-l)*ia+90:0;return m<0&&(m+=360),[h,m,f]},r.cS=Be,r.cT=ps,r.cU=Vt,r.cV=Pe,r.cW=Re,r.cX=De,r.cY=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},r.cZ=px,r.c_=function(l,t){return l.readFields(aM,{icons:[]},t)},r.ca=To,r.cb=$u,r.cc=TA,r.cd=Te,r.ce=EB,r.cf=function(){var l=new b(4);return b!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l},r.cg=function(l,t,o){var h=t[0],f=t[1],m=t[2],v=t[3],C=Math.sin(o),I=Math.cos(o);return l[0]=h*I+m*C,l[1]=f*I+v*C,l[2]=h*-C+m*I,l[3]=f*-C+v*I,l},r.ch=function(l,t){return l[0]===t[0]&&l[1]===t[1]&&l[2]===t[2]&&l[3]===t[3]},r.ci=qe,r.cj=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},r.ck=Qr,r.cl=Ai,r.cm=kd,r.cn=we,r.co=GB,r.cp=hc,r.cq=uw,r.cr=function(l,t,o,h,f,m,v,C,I){if(I.name==="globe")return uw(l,t,new hc(o,h,f),!1);const F=Um({z:o,x:h,y:f},I);return new Re([(m+F.x/F.scale)*t,t*(F.y/F.scale),v],[(m+F.x2/F.scale)*t,t*(F.y2/F.scale),C])},r.cs=function(l,t,o){return l[0]=Math.min(t[0],o[0]),l[1]=Math.min(t[1],o[1]),l[2]=Math.min(t[2],o[2]),l[3]=Math.min(t[3],o[3]),l},r.ct=function(l,t,o){return l[0]=Math.max(t[0],o[0]),l[1]=Math.max(t[1],o[1]),l[2]=Math.max(t[2],o[2]),l[3]=Math.max(t[3],o[3]),l},r.cu=function(l){const t=Math.round((l+45+360)%360/90)%4;return me[t]},r.cv=ti,r.cw=yi,r.cx=M,r.cy=function(l){const t=P(new Float64Array(16));U(t,l.pixelMatrix,l.globeMatrix);const o=[0,Z,0],h=[0,te,0];return tt(o,o,t),tt(h,h,t),[o[0]>0&&o[0]<=l.width&&o[1]>0&&o[1]<=l.height&&!b_(l,new Te(l.center.lat,90)),h[0]>0&&h[0]<=l.width&&h[1]>0&&h[1]<=l.height&&!b_(l,new Te(l.center.lat,-90))]},r.cz=function(l,t){const{scale:o}=l.tileTransform,h=o*wi/(l.tileSize*Math.pow(2,t.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return function(f,m,v){var C=m[1],I=m[2],F=m[3],k=v[0],z=v[1];return f[0]=m[0]*k,f[1]=C*k,f[2]=I*z,f[3]=F*z,f}(new Float32Array(4),t.inverseAdjustmentMatrix,[h,h])},r.d=function(l){return us.API_TILEJSON_REGEX.test(l)},r.d$=Qf,r.d0=Fg,r.d1=J_,r.d2=hh,r.d3=Vu,r.d4=ol,r.d5=Uo,r.d6=Mr,r.d7=function(l){const t=l.indexOf(cc);return t>=0?l.slice(0,t):l},r.d8=function(l){return l.indexOf(cc)>=0},r.d9=function(l){const t=l.lastIndexOf(cc);return t>=0?l.slice(t+1):""},r.dA=dw,r.dB=Ra,r.dC=Bo,r.dD=256,r.dE=function(l,t){const o=[0,0,0];return tt(o,o,n0(LA(t.canonical))),tt(o,o,l),o},r.dF=l=>({u_matrix:new TA(l),u_texsize:new $u(l),u_pixels_to_tile_units:new uf(l),u_device_pixel_ratio:new To(l),u_width_scale:new To(l),u_floor_width_scale:new To(l),u_image:new Xf(l),u_units_to_pixels:new $u(l),u_tile_units_to_pixels:new To(l),u_alpha_discard_threshold:new To(l),u_trim_offset:new $u(l),u_trim_fade_range:new $u(l),u_trim_color:new Yf(l),u_emissive_strength:new To(l),u_zbias_factor:new To(l),u_tile_to_meter:new To(l),u_ground_shadow_factor:new cf(l),u_pattern_transition:new To(l)}),r.dG=l=>({u_matrix:new TA(l),u_pixels_to_tile_units:new uf(l),u_device_pixel_ratio:new To(l),u_width_scale:new To(l),u_floor_width_scale:new To(l),u_units_to_pixels:new $u(l),u_dash_image:new Xf(l),u_gradient_image:new Xf(l),u_image_height:new To(l),u_texsize:new $u(l),u_tile_units_to_pixels:new To(l),u_alpha_discard_threshold:new To(l),u_trim_offset:new $u(l),u_trim_fade_range:new $u(l),u_trim_color:new Yf(l),u_emissive_strength:new To(l),u_zbias_factor:new To(l),u_tile_to_meter:new To(l),u_ground_shadow_factor:new cf(l)}),r.dH=l=>({u_camera_to_center_distance:new To(l),u_extrude_scale:new uf(l),u_device_pixel_ratio:new To(l),u_matrix:new TA(l),u_inv_rot_matrix:new TA(l),u_merc_center:new $u(l),u_tile_id:new cf(l),u_zoom_transition:new To(l),u_up_dir:new cf(l),u_emissive_strength:new To(l)}),r.dI=Ip,r.dJ=hL,r.dK=gw,r.dL=(l,t,o,h,f,m)=>{const v=l.transform,C=v.projection.name==="globe";let I;if(m.paint.get("circle-pitch-alignment")==="map")if(C){const k=dw(v.zoom,t.canonical)*v._pixelsPerMercatorPixel;I=Float32Array.from([k,0,0,k])}else I=v.calculatePixelsToTileUnitsMatrix(o);else I=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const F={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(v.projection),u_matrix:l.translatePosMatrix(t.projMatrix,o,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:pl.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:eF,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(C){F.u_inv_rot_matrix=h,F.u_merc_center=f,F.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],F.u_zoom_transition=Zf(v.zoom);const k=f[0]*wi,z=f[1]*wi;F.u_up_dir=v.projection.upVector(new hc(0,0,0),k,z)}return F},r.dM=U2,r.dN=Js,r.dO=(l,t,o,h,f,m,v,C,I,F)=>{const k=l.transform,z=k.pitch<15?R2(.07,.7,Ge((14-k.zoom)/5,0,1)):.07,H=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:O2(l,t,o,h),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:f,u_width_scale:m,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:D2(t,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(H?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:Vt(t.tileID.canonical,0),u_ground_shadow_factor:I,u_pattern_transition:F}},r.dP=(l,t,o,h,f,m,v,C,I,F)=>{const k=l.transform,z=k.calculatePixelsToTileUnitsMatrix(t),H=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",$=k.pitch<15?R2(.07,.7,Ge((14-k.zoom)/5,0,1)):.07;return{u_matrix:O2(l,t,o,h),u_pixels_to_tile_units:z,u_device_pixel_ratio:m,u_width_scale:v,u_floor_width_scale:C,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:z2(o)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:D2(t,l.transform),u_alpha_discard_threshold:0,u_trim_offset:I,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(H?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:$,u_tile_to_meter:Vt(t.tileID.canonical,0),u_ground_shadow_factor:F}},r.dQ=Fi,r.dR=ym,r.dS=Dt,r.dT=Rd,r.dU=d0,r.dV=l2,r.dW=ep,r.dX=450,r.dY=7,r.dZ=WL,r.d_=Rn,r.da=function(l){const t=[],o=l.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},r.db=function(l,t,o,h){return l.type==="custom"?new XL(l,t):new sM[l.type](l,t,o,h)},r.dc=Sr,r.dd=function(l){const t=l.indexOf(cc);return t>=0?l.slice(t+1):""},r.de=class extends Ug{constructor(l,t){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state=Object.assign({},l.state)),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},r.df=Bh,r.dg=du,r.dh=function(l){return l({pluginStatus:la,pluginURL:Sl}),Bh.on("pluginStateChange",l),l},r.di=Kf,r.dj=class extends Ec{constructor(l){super(l),this.current=Op}set(l,t,o){if(this.fetchUniformLocation(l,t)){for(let h=0;h<9;h++)if(o[h]!==this.current[h]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},r.dk=Ce,r.dl=function(l,t,o){const h=Zf(o.zoom),f=l.style.map._antialias,m=l.terrain&&l.terrain.exaggeration()>0;return h===0&&!f&&!m},r.dm=function(l){const t=l.pixelsPerMeter,o=t/lt(1,l.center.lat),h=P(new Float64Array(16));return Q(h,h,[l.point.x,l.point.y,0]),q(h,h,[o,o,t]),Float32Array.from(h)},r.dn=i0,r.dp=function(l){const t=ti-5;l=Ge(l,-80.051129,t)/t*90;const o=Math.pow(Math.abs(Math.sin(dn(l))),3);return Math.round(o*(J.length-1))},r.dq=function(l,t,o,h){const f=t.getNorth(),m=t.getSouth(),v=t.getWest(),C=t.getEast(),I=1<<l.z,F=C-v,k=f-m,z=F/Y,H=-k/J[o],$=[0,z,0,H,0,0,f,v,0];if(l.z>0){const ee=180/h;E($,$,[ee/F+1,0,0,0,ee/k+1,0,-.5*ee/z,.5*ee/H,1])}return $[2]=I,$[5]=l.x,$[8]=l.y,$},r.dr=LA,r.ds=function(l,t,o){const h=P(new Float64Array(16)),f=(t/(1<<l)-.5)*Math.PI*2;return re(h,o.globeMatrix,f),Float32Array.from(h)},r.dt=class{isDataAvailableAtPoint(l){const t=this._source();if(this.isUsingMockSource()||!t||l.y<0||l.y>1)return!1;const o=t.getSource().maxzoom,h=1<<o,f=Math.floor(l.x),m=Math.floor((l.x-f)*h),v=Math.floor(l.y*h),C=this.findDEMTileFor(new ya(o,f,o,m,v));return!(!C||!C.dem)}getAtPointOrZero(l,t=0){return this.getAtPoint(l,t)||0}getAtPoint(l,t,o=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const h=this._source();if(!h||l.y<0||l.y>1)return t;const f=h.getSource().maxzoom,m=1<<f,v=Math.floor(l.x),C=l.x-v,I=new ya(f,v,f,Math.floor(C*m),Math.floor(l.y*m)),F=this.findDEMTileFor(I);if(!F||!F.dem)return t;const k=F.dem,z=1<<F.tileID.canonical.z,H=(C*z-F.tileID.canonical.x)*k.dim,$=(l.y*z-F.tileID.canonical.y)*k.dim,ee=Math.floor(H),ae=Math.floor($);return(o?this.exaggeration():1)*Er(Er(k.get(ee,ae),k.get(ee,ae+1),$-ae),Er(k.get(ee+1,ae),k.get(ee+1,ae+1),$-ae),H-ee)}getAtTileOffset(l,t,o){const h=1<<l.canonical.z;return this.getAtPointOrZero(new wt(l.wrap+(l.canonical.x+t/wi)/h,(l.canonical.y+o/wi)/h))}getAtTileOffsetFunc(l,t,o,h){return f=>{const m=this.getAtTileOffset(l,f.x,f.y),v=h.upVector(l.canonical,f.x,f.y);return pt(v,v,m*h.upVectorScale(l.canonical,t,o).metersToTile),v}}getForTilePoints(l,t,o,h){if(this.isUsingMockSource())return!1;const f=kg.create(this,l,h);return!!f&&(t.forEach(m=>{m[2]=this.exaggeration()*f.getElevationAt(m[0],m[1],o)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(l);if(!t||!t.dem)return null;const o=t.dem.tree,h=t.tileID,f=1<<l.canonical.z-h.canonical.z;let m=l.canonical.x/f-h.canonical.x,v=l.canonical.y/f-h.canonical.y,C=0;for(let I=0;I<l.canonical.z-h.canonical.z&&!o.leaves[C];I++){m*=2,v*=2;const F=2*Math.floor(v)+Math.floor(m);C=o.childOffsets[C]+F,m%=1,v%=1}return{min:this.exaggeration()*o.minimums[C],max:this.exaggeration()*o.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,t,o){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let t=!1,o=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const f of l){const m=this.getMinMaxForTile(f.tileID);m&&(o=Math.min(o,m.min),h=Math.max(h,m.max),t=!0)}return t?{min:o,max:h}:null}},r.du=Sw,r.dv=t0,r.dw=function(l,t){return[Math.pow(l[0],2.2)*t,Math.pow(l[1],2.2)*t,Math.pow(l[2],2.2)*t]},r.dx=B,r.dy=function(l,t){var o=Math.sin(t),h=Math.cos(t);return l[0]=h,l[1]=o,l[2]=0,l[3]=-o,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},r.dz=Ut,r.e=us,r.e$=zC,r.e0=256,r.e1=__,r.e2=Ku,r.e3=re,r.e4=function(l,t){return l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[4],l[4]=t[5],l[5]=t[6],l[6]=t[8],l[7]=t[9],l[8]=t[10],l},r.e5=$h,r.e6=nf,r.e7=Bi,r.e8=function(l,t,o,h,f){return Ge((l-t)/(o-t)*(f-h)+h,h,f)},r.e9=Oi,r.eA=function(l,t,o){return l[0]=t[0]/o[0],l[1]=t[1]/o[1],l[2]=t[2]/o[2],l},r.eB=Pt,r.eC=ue,r.eD=ot,r.eE=function(l,t,o,h){return l[0]=t,l[1]=o,l[2]=h,l},r.eF=function([l,t,o]){const h=Math.hypot(l,t,o),f=Math.atan2(l,o),m=.5*Math.PI-Math.acos(-t/h);return new Te(St(f),St(m))},r.eG=bi,r.eH=Ax,r.eI=function(l){const t=l.navigator?l.navigator.userAgent:null;return!!function(o){if(Is==null){const h=o.navigator?o.navigator.userAgent:null;Is=!!o.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Is}(l)&&!(!t||!(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},r.eJ=function(l,t){gl=l,yc=t},r.eK=b_,r.eL=fw,r.eM=function(l){const t=[0,0,0],o=P(new Float64Array(16));return U(o,l.pixelMatrix,l.globeMatrix),tt(t,t,o),new qt(t[0],t[1])},r.eN=function(){const l=Im;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(O_),Im=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.eO=function(){f0().acquire(O_)},r.eP=cl,r.eQ=function(l,t,o=!1){if(la===Ga.deferred||la===Ga.loading||la===Ga.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Sl=pl.resolveURL(l),la=Ga.deferred,wh=t,gA(),o||mA()},r.eR=function(l){Sg=pl.resolveURL(l),Eg||(Eg=new Cg(f0(),new gu)),Eg.broadcast("setMeshoptUrl",Sg)},r.eS=x2,r.eT=function(l){z_=pl.resolveURL(l),Eg||(Eg=new Cg(f0(),new gu)),Eg.broadcast("setDracoUrl",z_)},r.eU=_2,r.eV=Tm,r.eW=function(l){const t=cu();if(!t)return;const o=t.delete(mc);l&&o.then(()=>l()).catch(l)},r.eX=jp,r.eY=Zi,r.eZ=Jf,r.e_=Od,r.ea=function(l,t){var o=t[0],h=t[1],f=t[2],m=t[3],v=t[4],C=t[5],I=t[6],F=t[7],k=t[8],z=k*v-C*F,H=-k*m+C*I,$=F*m-v*I,ee=o*z+h*H+f*$;return ee?(l[0]=z*(ee=1/ee),l[1]=(-k*h+f*F)*ee,l[2]=(C*h-f*v)*ee,l[3]=H*ee,l[4]=(k*o-f*I)*ee,l[5]=(-C*o+f*m)*ee,l[6]=$*ee,l[7]=(-F*o+h*I)*ee,l[8]=(v*o-h*m)*ee,l):null},r.eb=ut,r.ec=vi,r.ed=fx,r.ee=function(l,t){if(l===t){var o=t[1],h=t[2],f=t[3],m=t[6],v=t[7],C=t[11];l[1]=t[4],l[2]=t[8],l[3]=t[12],l[4]=o,l[6]=t[9],l[7]=t[13],l[8]=h,l[9]=m,l[11]=t[14],l[12]=f,l[13]=v,l[14]=C}else l[0]=t[0],l[1]=t[4],l[2]=t[8],l[3]=t[12],l[4]=t[1],l[5]=t[5],l[6]=t[9],l[7]=t[13],l[8]=t[2],l[9]=t[6],l[10]=t[10],l[11]=t[14],l[12]=t[3],l[13]=t[7],l[14]=t[11],l[15]=t[15];return l},r.ef=oe,r.eg=[1,1,1],r.eh=class{constructor(l,t,o,h){this.context=l,this.format=h,this.size=o,this.texture=l.gl.createTexture();const[f,m,v]=this.size,{gl:C}=l;C.bindTexture(C.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),C.texImage3D(C.TEXTURE_3D,0,this.format,f,m,v,0,cx(this.format),ux(this.format),t.data)}bind(l,t){const{context:o}=this,{gl:h}=o;h.bindTexture(h.TEXTURE_3D,this.texture),l!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,l),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,l),this.minFilter=l),t!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,t),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},r.ei=kg,r.ej=function(l,t,o,h){var f=new b(4);return f[0]=l,f[1]=t,f[2]=o,f[3]=h,f},r.ek=Ze,r.el=function(l,t,o,h){var f=t[0],m=t[1],v=t[2],C=t[3];return l[0]=f+h*(o[0]-f),l[1]=m+h*(o[1]-m),l[2]=v+h*(o[2]-v),l[3]=C+h*(o[3]-C),l},r.em=Pg,r.en=Lh,r.eo=Mh,r.ep=function(l,t,o,h,f,m,v,C,I,F,k,z,H,$,ee,ae){var Ae=new b(16);return Ae[0]=l,Ae[1]=t,Ae[2]=o,Ae[3]=h,Ae[4]=f,Ae[5]=m,Ae[6]=v,Ae[7]=C,Ae[8]=I,Ae[9]=F,Ae[10]=k,Ae[11]=z,Ae[12]=H,Ae[13]=$,Ae[14]=ee,Ae[15]=ae,Ae},r.eq=ge,r.er=sf,r.es=Lp,r.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new qt(1/0,1/0),max:new qt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,t=!1){const o=Gw(new qt(0,0),new qt(wi,wi),l),h=[];if(t&&!M_(o,this._globalClipBounds))return h;for(const f of this._activeRegions){if(f.hiddenByOverlap||!M_(o,f))continue;const m=TF(f.min,f.max,l);h.push({min:m.min,max:m.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return h}setSources(l){this._setSources(l.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const o=[];for(const h of t.cache.getVisibleCoordinates()){const f=t.cache.getTile(h).buckets[t.layer];f&&f.updateFootprints(h.toUnwrapped(),o)}return o},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope})))}_addSource(l){const t=l.getFootprints();if(t.length===0)return;const o=l.getOrder(),h=l.getClipMask(),f=l.getClipScope();for(const m of t){if(!m.footprint)continue;const v=Gw(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:o,clipMask:h,clipScope:f})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((t,o)=>t.priority-o.priority||u0(t.min,o.min)||u0(t.max,o.max)||t.order-o.order||t.clipMask-o.clipMask||function(h,f){const m=(v,C)=>v+C;return h.length-f.length||h.reduce(m,"").localeCompare(f.reduce(m,""))}(t.clipScope,o.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let t=0;for(;!l&&t!==this._activeRegions.length;){const o=this._activeRegions[t],h=this._prevRegions[t];l=o.priority!==h.priority||!Vw(o,h)||o.order!==h.order||o.clipMask!==h.clipMask||!Nn(o.clipScope,h.clipScope),++t}}if(l){++this._updateTime;for(const o of this._activeRegions)o.order!==c0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const t=o=>{const h=this._activeRegions;if(o>=h.length)return o;const f=h[o].priority;for(;o<h.length&&h[o].priority===f;)++o;return o};if(this._sourceIds.length>1){let o=0,h=t(o);for(;o!==h;){let f=o;const m=o;for(;f!==h;){const v=this._activeRegions[f];v.hiddenByOverlap=!1;for(let C=0;C<m;C++){const I=this._activeRegions[C];if(!I.hiddenByOverlap&&v.order===c0&&M_(v,I)&&(v.hiddenByOverlap=Xw(v.footprint,v.tileId,I.footprint,I.tileId),v.hiddenByOverlap))break}++f}o=h,h=t(o)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=l.length-1;t>=0;t--)this._addSource(l[t]);this._computeReplacement()}},r.eu=c0,r.ev=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,t){const o=new Yu,h=new Zo,f=[],m=l+1+2,v=t[0]+1,C=t[0]+1+(1+t.length),I=(F,k,z)=>{let H=F===m-1?F-2:F===0?F:F-1;return H+=z?24575:0,[H,k]};for(let F=0;F<m;++F)o.emplaceBack(...I(F,0,!0));for(let F=0;F<v;++F)for(let k=0;k<m;++k)o.emplaceBack(...I(k,F,(k===0||k===m-1)&&!0));for(let F=0;F<t.length;++F){const k=t[F];for(let z=0;z<m;++z)o.emplaceBack(...I(z,k,!0))}for(let F=0;F<t.length;++F){const k=h.length,z=t[F]+1+2,H=new Zo;for(let ae=0;ae<z-1;ae++){const Ae=ae===z-2,ve=Ae?m*(C-t.length+F-ae):m;for(let Fe=0;Fe<m-1;Fe++){const Le=ae*m+Fe;ae===0||Ae||Fe===0||Fe===m-2?(H.emplaceBack(Le+1,Le,Le+ve),H.emplaceBack(Le+ve,Le+ve+1,Le+1)):(h.emplaceBack(Le+1,Le,Le+ve),h.emplaceBack(Le+ve,Le+ve+1,Le+1))}}const $=Vs.simpleSegment(0,k,o.length,h.length-k);for(let ae=0;ae<H.uint16.length;ae+=3)h.emplaceBack(H.uint16[ae],H.uint16[ae+1],H.uint16[ae+2]);const ee=Vs.simpleSegment(0,k,o.length,h.length-k);f.push({withoutSkirts:$,withSkirts:ee})}return{vertices:o,indices:h,segments:f}}_createGrid(l){const t=this._fillGridMeshWithLods(Y,J);this._gridSegments=t.segments,this._gridBuffer=l.createVertexBuffer(t.vertices,$f.members),this._gridIndexBuffer=l.createIndexBuffer(t.indices,!0)}_createPoles(l){const t=new Zo;for(let v=0;v<=Y;v++)t.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=l.createIndexBuffer(t,!0);const o=new $h,h=new $h,f=new $h,m=new $h;this._poleSegments=[];for(let v=0,C=0;v<L;v++){const I=360/(1<<v);o.emplaceBack(0,-S,0,.5,0),h.emplaceBack(0,-S,0,.5,1),f.emplaceBack(0,-S,0,.5,.5),m.emplaceBack(0,-S,0,.5,.5);for(let F=0;F<=Y;F++){let k=F/Y,z=0;const H=Er(0,I,k),[$,ee,ae]=de(ZI,JI,H,S);o.emplaceBack($,ee,ae,k,z),h.emplaceBack($,ee,ae,k,1-z);const Ae=dn(H);k=.5+.5*Math.sin(Ae),z=.5+.5*Math.cos(Ae),f.emplaceBack($,ee,ae,k,z),m.emplaceBack($,ee,ae,k,1-z)}this._poleSegments.push(Vs.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(o,eh,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,eh,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(f,eh,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(m,eh,!1)}getGridBuffers(l,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},r.ew=je,r.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.ey=Je,r.ez=Mt,r.f=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(t,o)=>String.fromCharCode(+("0x"+o))))},r.f0=NC,r.f1=L2,r.f2=yn,r.f3="hd_road_elevation",r.f4=Ht,r.f5=nr,r.f6=zp,r.f7=Z_,r.f8=Hp,r.f9=function(l,t,o,h,f,m,v,C=1,I,F,k){l.createArrays(),l.tilePixelRatio=wi/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const z=l.layers[0].layout,H=l.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=C,$.textSizeScaleRange=z.get("text-size-scale-range"),$.iconSizeScaleRange=z.get("icon-size-scale-range");const[ee,ae]=$.textSizeScaleRange,[Ae,ve]=$.iconSizeScaleRange;$.textScaleFactor=Ge($.scaleFactor,ee,ae),$.iconScaleFactor=Ge($.scaleFactor,Ae,ve);const Fe=H["text-size"],Le=H["icon-size"];if(l.textSizeData.kind==="composite"){const{minZoom:ht,maxZoom:yt}=l.textSizeData;$.compositeTextSizes=[Fe.possiblyEvaluate(new Xn(ht,{worldview:k}),m),Fe.possiblyEvaluate(new Xn(yt,{worldview:k}),m)]}if(l.iconSizeData.kind==="composite"){const{minZoom:ht,maxZoom:yt}=l.iconSizeData;$.compositeIconSizes=[Le.possiblyEvaluate(new Xn(ht,{worldview:k}),m),Le.possiblyEvaluate(new Xn(yt,{worldview:k}),m)]}$.layoutTextSize=Fe.possiblyEvaluate(new Xn(v+1,{worldview:k}),m),$.layoutIconSize=Le.possiblyEvaluate(new Xn(v+1,{worldview:k}),m),$.textMaxSize=Fe.possiblyEvaluate(new Xn(18,{worldview:k}),m);const ce=z.get("symbol-placement"),Ee=z.get("text-rotation-alignment")==="map"&&ce!=="point",ke=z.get("text-size");let He=!1;const gt=[];for(const ht of l.features){const yt=z.get("text-font").evaluate(ht,{},m).join(","),Lt=ke.evaluate(ht,{},m)*$.textScaleFactor,Wt=$.layoutTextSize.evaluate(ht,{},m)*$.textScaleFactor,Si=$.layoutIconSize.evaluate(ht,{},m)*$.iconScaleFactor,fi={horizontal:{},vertical:void 0},Ci=ht.text;let Ii,$t=[0,0];if(Ci){const Nr=Ci.toString(),an=z.get("text-letter-spacing").evaluate(ht,{},m)*il,on=z.get("text-line-height").evaluate(ht,{},m)*il,vn=fd(Nr)?an:0,un=z.get("text-anchor").evaluate(ht,{},m),_n=z.get("text-variable-anchor");if(!_n){const Jt=z.get("text-radial-offset").evaluate(ht,{},m);if(Jt)$t=pB(un,[Jt*il,ex]);else{const zi=z.get("text-offset").evaluate(ht,{},m);$t=[zi[0]*il,zi[1]*il]}}let ns=Ee?"center":z.get("text-justify").evaluate(ht,{},m);const zs=ce==="point",ze=zs?z.get("text-max-width").evaluate(ht,{},m)*il:1/0,Ve=Jt=>{l.allowVerticalPlacement&&Qu(Nr)&&(fi.vertical=K_(Ci,t,o,f,yt,ze,on,un,Jt,vn,$t,Fu.vertical,!0,Wt,Lt,I))};if(!Ee&&_n){const Jt=ns==="auto"?_n.map(Yi=>tx(Yi)):[ns];let zi=!1;for(let Yi=0;Yi<Jt.length;Yi++){const Wi=Jt[Yi];if(!fi.horizontal[Wi])if(zi)fi.horizontal[Wi]=fi.horizontal[0];else{const sr=K_(Ci,t,o,f,yt,ze,on,"center",Wi,vn,$t,Fu.horizontal,!1,Wt,Lt,I);sr&&(fi.horizontal[Wi]=sr,zi=sr.positionedLines.length===1)}}Ve("left")}else{if(ns==="auto"&&(ns=tx(un)),zs||z.get("text-writing-mode").indexOf("horizontal")>=0||!Qu(Nr)){const Jt=K_(Ci,t,o,f,yt,ze,on,un,ns,vn,$t,Fu.horizontal,!1,Wt,Lt,I);Jt&&(fi.horizontal[ns]=Jt)}Ve(zs?"left":ns)}}let _i,Gt,Yt,ki,Di,xr,cr=!1;const Xi=z.get("icon-text-fit").evaluate(ht,{},m);if(ht.icon&&ht.icon.hasPrimary()){const Nr=mB(ht.icon,l.iconSizeData,H["icon-size"],m,l.zoom,ht,I,$.iconScaleFactor,k);_i=Nr.iconPrimary,Yt=Nr.iconSecondary;const an=_i.toString();if(Gt=h.get(an),Gt&&(Di=z.get("icon-offset").evaluate(ht,{},m),xr=z.get("icon-anchor").evaluate(ht,{},m),Ii=bL(f.get(an),Yt?f.get(Yt.toString()):void 0,Di,xr),cr=Gt.sdf,l.sdfIcons===void 0?l.sdfIcons=Gt.sdf:l.sdfIcons!==Gt.sdf&&Yr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Gt.pixelRatio!==l.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0)),Yt){const on=Yt.toString();ki=h.get(on)}}He=He||!(!ht.icon||!ht.icon.hasSecondary());const Pi=ix(fi.horizontal)||fi.vertical;l.iconsInText||(l.iconsInText=!!Pi&&Pi.iconsInText);const $r=Wt*$.textScaleFactor/il,{defaultShapedIcon:or,verticallyShapedIcon:Ar}=ML(l,Ii,z,ht,m,fi,$r,Di,Xi);Xi!=="none"&&Ii&&(J2(Ii)||eB(Ii))&&(w0(0,Gt,_i,Ii,or,Xi,F,h,f),w0(0,ki,Yt,Ii,or,Xi,F,h,f),Ar&&(w0(0,Gt,_i,Ii,Ar,Xi,F,h,f),w0(0,ki,Yt,Ii,Ar,Xi,F,h,f))),Ii=or,gt.push({feature:ht,shapedTextOrientations:fi,shapedText:Pi,shapedIcon:Ii,iconPrimary:_i,iconSecondary:Yt,iconOffset:Di,iconAnchor:xr,verticallyShapedIcon:Ar,layoutTextSize:Wt,layoutIconSize:Si,textOffset:$t,isSDFIcon:cr,iconTextFit:Xi})}return{featureData:gt,sizes:$,hasAnySecondaryIcon:He,textAlongLine:Ee,symbolPlacement:ce}},r.fa=cB,r.fb=function(l,t,o,h,f,m,v,C,I,F){const{featureData:k,hasAnySecondaryIcon:z,sizes:H,textAlongLine:$,symbolPlacement:ee}=t;for(const ae of k){const{shapedIcon:Ae,verticallyShapedIcon:ve,feature:Fe,shapedTextOrientations:Le,shapedText:ce,layoutTextSize:Ee,textOffset:ke,isSDFIcon:He,iconPrimary:gt,iconSecondary:ht,iconTextFit:yt,iconOffset:Lt}=ae;yB(Ae,F.iconPositions,gt,ht),yB(ve,F.iconPositions,gt,ht),LL(Le,F.iconPositions),FL(gt,ht,F.iconPositions),(ce||Ae)&&PL(l,Fe,Le,Ae,ve,I,H,Ee,0,ke,He,h,f,v,C,z,yt,Lt,$,ee)}o&&l.generateCollisionDebugBuffers(m,l.collisionBoxArray,H.textScaleFactor)},r.fc=ln,r.fd=X0,r.fe=yr,r.ff=Jr,r.fg=G2,r.fh=ta,r.fi=function(l){let t=0;if(new Uint32Array(l,0,1)[0]!==w2){const o=new Uint32Array(l,0,7),[,,h,f,m,v]=o;t=o.byteLength+f+m+v+m,(h!==l.byteLength||t>=l.byteLength)&&Yr("Invalid b3dm header information.")}return E2(l,t)},r.fj=function(l,t){const o=UC(l);for(const h of o){for(const f of h.meshes)i3(f);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(r3(h.lights,t)))}return o},r.fk=j0,r.fl=Sn,r.fm=y2,r.fn=qc,r.fo=Ga,r.fp=function(l){ml(),Zl!=null&&Zl.then(t=>{t.keys().then(o=>{for(let h=0;h<o.length-l;h++)t.delete(o[h]).catch(f=>Yr(f.message))}).catch(o=>Yr(o.message))}).catch(t=>Yr(t.message))},r.g=function(l,t){return du(Ot(l,{method:"GET"}),t)},r.h=Ot,r.i=function(l){return us.API_STYLE_REGEX.test(l)&&!lh(l)},r.j=function(l){return l.indexOf("mapbox:")===0},r.k=pc,r.l=Nc,r.m=function(l){return decodeURIComponent(atob(l).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.n=function(l,t){return du(Ot(l,{type:"json"}),t)},r.o=dh,r.p=function(l,t){return du(Ot(l,{method:"POST"}),t)},r.q=pl,r.r=Il,r.s=function(l){try{const t=self[l];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=ku,r.u=function(){return function l(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},r.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},r.w=Yr,r.x=function(){return U_||(U_=new jp),U_},r.y=Bx,r.z=Jl}),d(["./shared"],function(r){function y(St){const me=St?St.url.toString():void 0;return me?performance.getEntriesByName(me):[]}function b(St){if(typeof St=="number"||typeof St=="boolean"||typeof St=="string"||St==null)return JSON.stringify(St);if(Array.isArray(St)){let Ce="[";for(const je of St)Ce+=`${b(je)},`;return`${Ce}]`}let me="{";for(const Ce of Object.keys(St).sort())me+=`${Ce}:${b(St[Ce])},`;return`${me}}`}function x(St){let me="";for(const Ce of r.bu)me+=`/${b(St[Ce])}`;return me}class B{constructor(me){this.keyCache={},this._layers={},this._layerConfigs={},me&&this.replace(me)}replace(me,Ce){this._layerConfigs={},this._layers={},this.update(me,[],Ce)}update(me,Ce,je){this._options=je;for(const Ge of me)this._layerConfigs[Ge.id]=Ge,(this._layers[Ge.id]=r.db(Ge,this.scope,null,this._options)).compileFilter(je),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id];for(const Ge of Ce)delete this.keyCache[Ge],delete this._layerConfigs[Ge],delete this._layers[Ge];this.familiesBySource={};const Je=function(Ge,vt){const Rt={};for(let Ot=0;Ot<Ge.length;Ot++){const ii=Ge[Ot];let Nt=vt&&vt[ii.id];Nt||(ii.type==="symbol"?Nt=ii.id:(Nt=x(ii),ii.type==="line"&&ii.paint&&function er(nr){return typeof nr=="string"&&nr==="line-progress"||(Array.isArray(nr)?nr.some(er):!(!nr||typeof nr!="object")&&Object.values(nr).some(er))}(ii.paint["line-width"])&&(Nt+=`/${b(ii.paint["line-width"])}`))),vt&&(vt[ii.id]=Nt);let Fi=Rt[Nt];Fi||(Fi=Rt[Nt]=[]),Fi.push(ii)}const _t=[];for(const Ot in Rt)_t.push(Rt[Ot]);return _t}(Object.values(this._layerConfigs),this.keyCache);for(const Ge of Je){const vt=Ge.map(Fi=>this._layers[Fi.id]),Rt=vt[0];if(Rt.visibility==="none")continue;const _t=Rt.source||"";let Ot=this.familiesBySource[_t];Ot||(Ot=this.familiesBySource[_t]={});const ii=Rt.sourceLayer||"_geojsonTileLayer";let Nt=Ot[ii];Nt||(Nt=Ot[ii]=[]),Nt.push(vt)}}}const T=1*r.e_;class E{constructor(me){const Ce={},je=[];for(const Rt in me){const _t=me[Rt],Ot=Ce[Rt]={};for(const ii in _t.glyphs){const Nt=_t.glyphs[+ii];if(!Nt||Nt.bitmap.width===0||Nt.bitmap.height===0)continue;const Fi=Nt.metrics.localGlyph?T:1,er={x:0,y:0,w:Nt.bitmap.width+2*Fi,h:Nt.bitmap.height+2*Fi};je.push(er),Ot[ii]=er}}const{w:Je,h:Ge}=r.H(je),vt=new r.eZ({width:Je||1,height:Ge||1});for(const Rt in me){const _t=me[Rt];for(const Ot in _t.glyphs){const ii=_t.glyphs[+Ot];if(!ii||ii.bitmap.width===0||ii.bitmap.height===0)continue;const Nt=Ce[Rt][Ot],Fi=ii.metrics.localGlyph?T:1;r.eZ.copy(ii.bitmap,vt,{x:0,y:0},{x:Nt.x+Fi,y:Nt.y+Fi},ii.bitmap)}}this.image=vt,this.positions=Ce}}r.eY(E,"GlyphAtlas");class R{constructor(me){this.tileID=new r.aM(me.tileID.overscaledZ,me.tileID.wrap,me.tileID.canonical.z,me.tileID.canonical.x,me.tileID.canonical.y),this.tileZoom=me.tileZoom,this.uid=me.uid,this.zoom=me.zoom,this.lut=me.lut,this.canonical=me.tileID.canonical,this.pixelRatio=me.pixelRatio,this.tileSize=me.tileSize,this.source=me.source,this.scope=me.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=me.showCollisionBoxes,this.collectResourceTiming=!!me.request&&me.request.collectResourceTiming,this.promoteId=me.promoteId,this.isSymbolTile=me.isSymbolTile,this.tileTransform=r.aW(me.tileID.canonical,me.projection),this.projection=me.projection,this.worldview=me.worldview,this.localizableLayerIds=me.localizableLayerIds,this.brightness=me.brightness,this.extraShadowCaster=!!me.extraShadowCaster,this.tessellationStep=me.tessellationStep,this.scaleFactor=me.scaleFactor,this.worldview=me.worldview}parse(me,Ce,je,Je,Ge,vt){this.status="parsing",this.data=me,this.collisionBoxArray=new r.b0;const Rt=new r.e$(Object.keys(me.layers).sort()),_t=new r.f0(this.tileID,this.promoteId);_t.bucketLayerIDs=[];const Ot={},ii=new r.f1(256,256),Nt={featureIndex:_t,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:ii,availableImages:je,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Fi=[],er=Ce.familiesBySource[this.source];for(const Sr in er){const Mr=me.layers[Sr];if(!Mr)continue;let jr=!1,nn=!1,Yr=!1;for(const Sn of er[Sr])Sn[0].type==="symbol"?jr=!0:nn=!0,Sn[0].is3D()&&Sn[0].type!=="model"&&(Yr=!0);if(this.extraShadowCaster&&!Yr||this.isSymbolTile===!0&&!jr||this.isSymbolTile===!1&&!nn)continue;Mr.version===1&&r.w(`Vector tile source "${this.source}" layer "${Sr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wn=Rt.encode(Sr),fs=[];let ps=!1;for(let Sn=0,En=0;Sn<Mr.length;Sn++){const Is=Mr.feature(Sn),_s=_t.getId(Is,Sr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Sr)){const cs=Is.properties?Is.properties.worldview:null;if(this.worldview&&typeof cs=="string")if(cs==="all")Is.properties.$localized=!0;else{if(!cs.split(",").includes(this.worldview))continue;Is.properties.$localized=!0,Is.properties.worldview=this.worldview}}!ps&&Is.properties&&Is.properties.hasOwnProperty(r.f2)&&(ps=!0),fs.push({feature:Is,id:_s,index:En,sourceLayerIndex:Wn}),En++}ps&&!Nt.elevationFeatures&&me.layers.hasOwnProperty(r.f3)&&(Nt.elevationFeatures=r.f4.parseFrom(me.layers[r.f3],this.canonical));for(const Sn of er[Sr]){const En=Sn[0];if(this.extraShadowCaster&&(!En.is3D()||En.type==="model")||this.isSymbolTile!==void 0&&En.type==="symbol"!==this.isSymbolTile||En.minzoom&&this.zoom<Math.floor(En.minzoom)||En.maxzoom&&this.zoom>=En.maxzoom||En.visibility==="none")continue;P(Sn,this.zoom,Nt.brightness,je,this.worldview);const Is=Ot[En.id]=En.createBucket({index:_t.bucketLayerIDs.length,layers:Sn,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Je,worldview:this.worldview});_t.bucketLayerIDs.push(Sn.map(cs=>r.C(cs.id,cs.scope)));let _s=Is.prepare?Is.prepare():null;_s!=null?(_s=_s.then(()=>Is.populate(fs,Nt,this.tileID.canonical,this.tileTransform)),Fi.push(_s)):Is.populate(fs,Nt,this.tileID.canonical,this.tileTransform)}}const nr=()=>{let Sr,Mr,jr,nn,Yr,Wn;ii.trim();const fs={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ps=()=>{if(Sr)return this.status="done",vt(Sr);if(this.extraShadowCaster)this.status="done",vt(null,{buckets:Object.values(Ot).filter(En=>!En.isEmpty()),featureIndex:_t,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Nt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Mr&&jr&&nn){const En=new E(Mr),Is=new Map;for(const[Oo,Ra]of jr.entries()){const{imagePosition:Bo}=r.f7(Oo,Ra,r.f8);Is.set(Oo,Bo)}const _s={};for(const Oo in Ot){const Ra=Ot[Oo];Ra instanceof r.b1&&(P(Ra.layers,this.zoom,Nt.brightness,je,this.worldview),_s[Oo]=r.f9(Ra,Mr,En.positions,jr,Is,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Yr,this.worldview))}const cs={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ge,jr,Yr,()=>{cs.iconsPending=!1,Sn(_s,En,cs)}),this.rasterizeIfNeeded(Ge,nn,Wn,()=>{cs.patternsPending=!1,Sn(_s,En,cs)})}},Sn=(En,Is,_s,cs)=>{if(_s.iconsPending||_s.patternsPending)return;const Oo=new r.fa(jr,nn,this.lut);for(const Ra in Ot){const Bo=Ot[Ra];if(Ra in En)r.fb(Bo,En[Ra],this.showCollisionBoxes,je,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,jr,Oo);else if(Bo.hasPattern&&(Bo instanceof r.b7||Bo instanceof r.b8||Bo instanceof r.dU)){P(Bo.layers,this.zoom,Nt.brightness,je,this.worldview);const fc=Object.fromEntries(Oo.patternPositions);Bo.addFeatures(Nt,this.tileID.canonical,fc,je,this.tileTransform,this.brightness)}}this.status="done",vt(null,{buckets:Object.values(Ot).filter(Ra=>!Ra.isEmpty()),featureIndex:_t,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Is.image,lineAtlas:ii,imageAtlas:Oo,brightness:Nt.brightness})};if(!this.extraShadowCaster){const En=r.f5(Nt.glyphDependencies,cs=>Object.keys(cs).map(Number));Object.keys(En).length?Ge.send("getGlyphs",{uid:this.uid,stacks:En,scope:this.scope},(cs,Oo)=>{Sr||(Sr=cs,Mr=Oo,ps())},void 0,!1,fs):Mr={};const Is=Array.from(Nt.iconDependencies.keys()).map(cs=>r.I.parse(cs));Is.length?Ge.send("getImages",{images:Is,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(cs,Oo)=>{Sr||(Sr=cs,jr=new Map,Yr=this.updateImageMapAndGetImageTaskQueue(jr,Oo,Nt.iconDependencies),ps())},void 0,!1,fs):(jr=new Map,Yr=new Map);const _s=Array.from(Nt.patternDependencies.keys()).map(cs=>r.I.parse(cs));_s.length?Ge.send("getImages",{images:_s,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(cs,Oo)=>{Sr||(Sr=cs,nn=new Map,Wn=this.updateImageMapAndGetImageTaskQueue(nn,Oo,Nt.patternDependencies),ps())},void 0,!1,fs):(nn=new Map,Wn=new Map)}if(Nt.elevationFeatures&&Nt.elevationFeatures.length>0){const En=[];for(const _s of Object.values(Ot))if(_s instanceof r.b8){const cs=_s.getUnevaluatedPortalGraph();cs&&En.push(cs)}const Is=r.f6.evaluate(En);for(const _s of Object.values(Ot))if(_s instanceof r.b8){const cs=me.layers[Rt.decode(_s.sourceLayerIndex)];_s.setEvaluatedPortalGraph(Is,cs,this.tileID.canonical,Nt.availableImages,Nt.brightness)}}ps()};Fi.length>0?Promise.allSettled(Fi).then(nr).catch(vt):nr()}rasterizeIfNeeded(me,Ce,je,Je){Array.from(Ce.values()).some(Ge=>Ge.usvg)?this.rasterize(me,Ce,je,Je):Je()}updateImageMapAndGetImageTaskQueue(me,Ce,je){const Je=new Map;for(const Ge of Ce.keys()){const vt=je.get(Ge)||[];for(const Rt of vt){const _t=Rt.toString(),Ot=Ce.get(Rt.id.toString());Ot.usvg?Je.has(_t)||(Je.set(_t,Rt),me.set(_t,Object.assign({},Ot))):me.set(_t,Ot)}}return Je}rasterize(me,Ce,je,Je){this.rasterizeTask=me.send("rasterizeImages",{scope:this.scope,tasks:je},(Ge,vt)=>{if(!Ge)for(const[Rt,_t]of vt.entries()){const Ot=Object.assign(Ce.get(Rt),{data:_t});Ce.set(Rt,Ot)}Je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function P(St,me,Ce,je,Je){const Ge=new r.aa(me,{brightness:Ce,worldview:Je});for(const vt of St)vt.recalculate(Ge,je)}class G extends r.E{constructor(me,Ce,je,Je,Ge,vt,Rt){super(),this.actor=me,this.layerIndex=Ce,this.availableImages=je,this.availableModels=Je,this.loadVectorData=vt||r.aJ,this.loading={},this.loaded={},this.deduped=new r.aI(me.scheduler),this.isSpriteLoaded=Ge,this.scheduler=me.scheduler,this.brightness=Rt}loadTile(me,Ce){const je=me.uid,Je=me&&me.request,Ge=Je&&Je.collectResourceTiming,vt=this.loading[je]=new R(me);vt.abort=this.loadVectorData(me,(Rt,_t)=>{const Ot=!this.loading[je];if(delete this.loading[je],vt.cancelRasterize(),Ot||Rt||!_t)return vt.status="done",Ot||(this.loaded[je]=vt),Ce(Rt);const ii=_t.rawData,Nt={};_t.expires&&(Nt.expires=_t.expires),_t.cacheControl&&(Nt.cacheControl=_t.cacheControl),vt.vectorTile=_t.vectorTile||new r.fc.VectorTile(new r.bq(ii));const Fi=()=>{vt.parse(vt.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(er,nr)=>{if(er||!nr)return Ce(er);const Sr={};if(Ge){const Mr=y(Je);Mr.length>0&&(Sr.resourceTiming=JSON.parse(JSON.stringify(Mr)))}Ce(null,r.h({rawTileData:ii.slice(0)},nr,Nt,Sr))})};this.isSpriteLoaded?Fi():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Fi,{type:"parseTile",isSymbolTile:me.isSymbolTile,zoom:me.tileZoom}):Fi()}),this.loaded=this.loaded||{},this.loaded[je]=vt})}reloadTile(me,Ce){const je=this.loaded,Je=me.uid;if(je&&je[Je]){const Ge=je[Je];Ge.scaleFactor=me.scaleFactor,Ge.showCollisionBoxes=me.showCollisionBoxes,Ge.projection=me.projection,Ge.brightness=me.brightness,Ge.tileTransform=r.aW(me.tileID.canonical,me.projection),Ge.extraShadowCaster=me.extraShadowCaster,Ge.lut=me.lut,Ge.worldview=me.worldview;const vt=(Rt,_t)=>{const Ot=Ge.reloadCallback;Ot&&(delete Ge.reloadCallback,Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ot)),Ce(Rt,_t)};Ge.status==="parsing"?Ge.reloadCallback=vt:Ge.status==="done"&&(Ge.vectorTile?Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,vt):vt())}else Ce(null,void 0)}abortTile(me,Ce){const je=me.uid,Je=this.loading[je];Je&&(Je.abort&&Je.abort(),delete this.loading[je]),Ce()}removeTile(me,Ce){const je=this.loaded,Je=me.uid;je&&je[Je]&&delete je[Je],Ce()}}class U{loadTile(me,Ce){const{uid:je,encoding:Je,rawImageData:Ge,padding:vt}=me,Rt=ImageBitmap&&Ge instanceof ImageBitmap?this.getImageData(Ge,vt):Ge;Ce(null,new r.fd(je,Rt,Je,vt<1))}reloadTile(me,Ce){Ce(null,null)}abortTile(me,Ce){Ce()}removeTile(me,Ce){Ce()}getImageData(me,Ce){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(me.width,me.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=me.width,this.offscreenCanvas.height=me.height,this.offscreenCanvasContext.drawImage(me,0,0,me.width,me.height);const je=this.offscreenCanvasContext.getImageData(-Ce,-Ce,me.width+2*Ce,me.height+2*Ce);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),je}}r.bp.setPbf(r.bq);class Q{constructor(me){this._mrt=new r.bp(me.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=me.uid,this.tileID=me.tileID,this.source=me.source}parse(me,Ce){const je=this._mrt;this.status="parsing",this._entireBuffer=me;try{je.parseHeader(me),this._isHeaderLoaded=!0;const Je=[];for(const Ge in je.layers){const vt=je.getLayer(Ge),Rt=vt.getDataRange(vt.getBandList()),_t=je.createDecodingTask(Rt),Ot=me.slice(Rt.firstByte,Rt.lastByte+1),ii=r.bp.performDecoding(Ot,_t).then(Nt=>_t.complete(null,Nt)).catch(Nt=>_t.complete(Nt,null));Je.push(ii)}Promise.allSettled(Je).then(()=>Ce(null,je)).catch(Ge=>Ce(Ge))}catch(Je){Ce(Je)}}}class q{constructor(me){this.actor=me,this.loading={},this.loaded={}}loadTile(me,Ce){const je=me.uid,Je=me.request,Ge=this.loading[je]=new Q(me),{cancel:vt}=r.br(Je,(Rt,_t,Ot,ii)=>{const Nt=!this.loading[je];if(delete this.loading[je],Nt||Rt||!_t)return Ge.status="done",Nt||(this.loaded[je]=Ge),Ce(Rt);Ge.parse(_t,(Fi,er)=>{if(Fi||!er)return Ce(Fi);Ce(null,er,Ot,ii)}),this.loaded[je]=Ge});Ge.abort=vt}reloadTile(me,Ce){Ce(null,void 0)}abortTile(me,Ce){const je=me.uid,Je=this.loading[je];Je&&(Je.abort&&Je.abort(),delete this.loading[je]),Ce()}removeTile(me,Ce){const je=me.uid;this.loaded[je]&&delete this.loaded[je],Ce()}decodeRasterArray(me,Ce){r.bp.performDecoding(me.buffer,me.task).then(je=>Ce(null,je)).catch(je=>Ce(je))}}const ne=r.fc.VectorTileFeature.prototype.toGeoJSON;class re{constructor(me){this._feature=me,this.extent=r.aj,this.type=me.type,this.properties=me.tags,"id"in me&&!isNaN(me.id)&&(this.id=parseInt(me.id,10))}loadGeometry(){if(this._feature.type===1){const me=[];for(const Ce of this._feature.geometry)me.push([new r.P(Ce[0],Ce[1])]);return me}{const me=[];for(const Ce of this._feature.geometry){const je=[];for(const Je of Ce)je.push(new r.P(Je[0],Je[1]));me.push(je)}return me}}toGeoJSON(me,Ce,je){return ne.call(this,me,Ce,je)}}class pe{constructor(me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.aj,this.length=me.length,this._features=me}feature(me){return new re(this._features[me])}}class fe{constructor(me,Ce){this.name=me,this.extent=r.aj,this.length=Ce.length,this._features=Ce}feature(me){return new re(this._features[me])}}class he extends pe{constructor(me){super([]),this.layers={};for(const Ce in me)this.layers[Ce]=new fe(Ce,me[Ce])}}const be=64/4096,Se=128;class oe{constructor(){this.features=new Map}clear(){this.features.clear()}load(me=[],Ce){for(const je of me){const Je=je.id;if(Je==null)continue;let Ge=this.features.get(Je);Ge&&this.updateCache(Ge,Ce),je.geometry?(Ge=Me(je),this.updateCache(Ge,Ce),this.features.set(Je,Ge)):this.features.delete(Je),this.updateCache(Ge,Ce)}}updateCache(me,Ce){for(const{canonical:je,uid:Je}of Object.values(Ce)){const{z:Ge,x:vt,y:Rt}=je;ye(me,Math.pow(2,Ge),vt,Rt)&&delete Ce[Je]}}getTile(me,Ce,je){const Je=Math.pow(2,me),Ge=[];for(const vt of this.features.values())ye(vt,Je,Ce,je)&&Ge.push(et(vt,Je,Ce,je));return{features:Ge}}getFeatures(){return[...this.features.values()]}}function ye({minX:St,minY:me,maxX:Ce,maxY:je},Je,Ge,vt){return St<(Ge+1+be)/Je&&me<(vt+1+be)/Je&&Ce>(Ge-be)/Je&&je>(vt-be)/Je}function Me(St){const{id:me,geometry:Ce,properties:je}=St;if(!Ce)return;if(Ce.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Je,coordinates:Ge}=Ce,vt={id:me,type:1,geometry:[],tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Rt=vt.geometry;if(Je==="Point")Be(Ge,Rt,vt);else if(Je==="MultiPoint")for(const _t of Ge)Be(_t,Rt,vt);else if(Je==="LineString")vt.type=2,Pe(Ge,Rt,vt);else if(Je==="MultiLineString")vt.type=2,De(Ge,Rt,vt);else if(Je==="Polygon")vt.type=3,De(Ge,Rt,vt,!0);else{if(Je!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");vt.type=3;for(const _t of Ge)De(_t,Rt,vt,!0)}return vt}function Be([St,me],Ce,je){const Je=r.aD(St);let Ge=r.aH(me);Ge=Ge<0?0:Ge>1?1:Ge,Ce.push(Je,Ge),je.minX=Math.min(je.minX,Je),je.minY=Math.min(je.minY,Ge),je.maxX=Math.max(je.maxX,Je),je.maxY=Math.max(je.maxY,Ge)}function Pe(St,me,Ce,je=!1,Je=!1){const Ge=[];for(const vt of St)Be(vt,Ge,Ce);me.push(Ge),je&&function(vt,Rt){let _t=0;for(let Ot=0,ii=vt.length,Nt=ii-2;Ot<ii;Nt=Ot,Ot+=2)_t+=(vt[Ot]-vt[Nt])*(vt[Ot+1]+vt[Nt+1]);if(_t>0===Rt)for(let Ot=0,ii=vt.length;Ot<ii/2;Ot+=2){const Nt=vt[Ot],Fi=vt[Ot+1];vt[Ot]=vt[ii-2-Ot],vt[Ot+1]=vt[ii-1-Ot],vt[ii-2-Ot]=Nt,vt[ii-1-Ot]=Fi}}(Ge,Je)}function De(St,me,Ce,je=!1){for(let Je=0;Je<St.length;Je++)Pe(St[Je],me,Ce,je,Je===0)}function et(St,me,Ce,je){const{id:Je,type:Ge,geometry:vt,tags:Rt}=St,_t=[];if(Ge===1)(function(Ot,ii,Nt,Fi,er){for(let nr=0;nr<Ot.length;nr+=2){const Sr=Math.round(r.aj*(Ot[nr+0]*ii-Nt)),Mr=Math.round(r.aj*(Ot[nr+1]*ii-Fi));er.push([Sr,Mr])}})(vt,me,Ce,je,_t);else for(const Ot of vt)Ye(Ot,me,Ce,je,_t);return{id:Je,type:Ge,geometry:_t,tags:Rt}}function Ye(St,me,Ce,je,Je){const vt=r.aj+Se;let Rt;for(let _t=0;_t<St.length-2;_t+=2){let Ot=Math.round(r.aj*(St[_t+0]*me-Ce)),ii=Math.round(r.aj*(St[_t+1]*me-je)),Nt=Math.round(r.aj*(St[_t+2]*me-Ce)),Fi=Math.round(r.aj*(St[_t+3]*me-je));const er=Nt-Ot,nr=Fi-ii;Ot<-128&&Nt<-128||(Ot<-128?(ii+=Math.round(nr*((-128-Ot)/er)),Ot=-128):Nt<-128&&(Fi=ii+Math.round(nr*((-128-Ot)/er)),Nt=-128),ii<-128&&Fi<-128||(ii<-128?(Ot+=Math.round(er*((-128-ii)/nr)),ii=-128):Fi<-128&&(Nt=Ot+Math.round(er*((-128-ii)/nr)),Fi=-128),Ot>=vt&&Nt>=vt||(Ot>=vt?(ii+=Math.round(nr*((vt-Ot)/er)),Ot=vt):Nt>=vt&&(Fi=ii+Math.round(nr*((vt-Ot)/er)),Nt=vt),ii>=vt&&Fi>=vt||(ii>=vt?(Ot+=Math.round(er*((vt-ii)/nr)),ii=vt):Fi>=vt&&(Nt=Ot+Math.round(er*((vt-ii)/nr)),Fi=vt),Rt&&Ot===Rt[Rt.length-1][0]&&ii===Rt[Rt.length-1][1]||(Rt=[[Ot,ii]],Je.push(Rt)),Rt.push([Nt,Fi])))))}}var bt,pt,Qt,Ie={exports:{}},ot=function(){if(Qt)return Ie.exports;Qt=1;var St=r.fg(),me=function(){if(pt)return bt;pt=1;var ii=r.fe(),Nt=r.ff().VectorTileFeature;function Fi(nr,Sr){this.options=Sr||{},this.features=nr,this.length=nr.length}function er(nr,Sr){this.id=typeof nr.id=="number"?nr.id:void 0,this.type=nr.type,this.rawGeometry=nr.type===1?[nr.geometry]:nr.geometry,this.properties=nr.tags,this.extent=Sr||4096}return bt=Fi,Fi.prototype.feature=function(nr){return new er(this.features[nr],this.options.extent)},er.prototype.loadGeometry=function(){var nr=this.rawGeometry;this.geometry=[];for(var Sr=0;Sr<nr.length;Sr++){for(var Mr=nr[Sr],jr=[],nn=0;nn<Mr.length;nn++)jr.push(new ii(Mr[nn][0],Mr[nn][1]));this.geometry.push(jr)}return this.geometry},er.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var nr=this.geometry,Sr=1/0,Mr=-1/0,jr=1/0,nn=-1/0,Yr=0;Yr<nr.length;Yr++)for(var Wn=nr[Yr],fs=0;fs<Wn.length;fs++){var ps=Wn[fs];Sr=Math.min(Sr,ps.x),Mr=Math.max(Mr,ps.x),jr=Math.min(jr,ps.y),nn=Math.max(nn,ps.y)}return[Sr,jr,Mr,nn]},er.prototype.toGeoJSON=Nt.prototype.toGeoJSON,bt}();function Ce(ii){var Nt=new St;return function(Fi,er){for(var nr in Fi.layers)er.writeMessage(3,je,Fi.layers[nr])}(ii,Nt),Nt.finish()}function je(ii,Nt){var Fi;Nt.writeVarintField(15,ii.version||1),Nt.writeStringField(1,ii.name||""),Nt.writeVarintField(5,ii.extent||4096);var er={keys:[],values:[],keycache:{},valuecache:{}};for(Fi=0;Fi<ii.length;Fi++)er.feature=ii.feature(Fi),Nt.writeMessage(2,Je,er);var nr=er.keys;for(Fi=0;Fi<nr.length;Fi++)Nt.writeStringField(3,nr[Fi]);var Sr=er.values;for(Fi=0;Fi<Sr.length;Fi++)Nt.writeMessage(4,Ot,Sr[Fi])}function Je(ii,Nt){var Fi=ii.feature;Fi.id!==void 0&&Nt.writeVarintField(1,Fi.id),Nt.writeMessage(2,Ge,ii),Nt.writeVarintField(3,Fi.type),Nt.writeMessage(4,_t,Fi)}function Ge(ii,Nt){var Fi=ii.feature,er=ii.keys,nr=ii.values,Sr=ii.keycache,Mr=ii.valuecache;for(var jr in Fi.properties){var nn=Fi.properties[jr],Yr=Sr[jr];if(nn!==null){Yr===void 0&&(er.push(jr),Sr[jr]=Yr=er.length-1),Nt.writeVarint(Yr);var Wn=typeof nn;Wn!=="string"&&Wn!=="boolean"&&Wn!=="number"&&(nn=JSON.stringify(nn));var fs=Wn+":"+nn,ps=Mr[fs];ps===void 0&&(nr.push(nn),Mr[fs]=ps=nr.length-1),Nt.writeVarint(ps)}}}function vt(ii,Nt){return(Nt<<3)+(7&ii)}function Rt(ii){return ii<<1^ii>>31}function _t(ii,Nt){for(var Fi=ii.loadGeometry(),er=ii.type,nr=0,Sr=0,Mr=Fi.length,jr=0;jr<Mr;jr++){var nn=Fi[jr],Yr=1;er===1&&(Yr=nn.length),Nt.writeVarint(vt(1,Yr));for(var Wn=er===3?nn.length-1:nn.length,fs=0;fs<Wn;fs++){fs===1&&er!==1&&Nt.writeVarint(vt(2,Wn-1));var ps=nn[fs].x-nr,Sn=nn[fs].y-Sr;Nt.writeVarint(Rt(ps)),Nt.writeVarint(Rt(Sn)),nr+=ps,Sr+=Sn}er===3&&Nt.writeVarint(vt(7,1))}}function Ot(ii,Nt){var Fi=typeof ii;Fi==="string"?Nt.writeStringField(1,ii):Fi==="boolean"?Nt.writeBooleanField(7,ii):Fi==="number"&&(ii%1!=0?Nt.writeDoubleField(3,ii):ii<0?Nt.writeSVarintField(6,ii):Nt.writeVarintField(5,ii))}return Ie.exports=Ce,Ie.exports.fromVectorTileJs=Ce,Ie.exports.fromGeojsonVt=function(ii,Nt){Nt=Nt||{};var Fi={};for(var er in ii)Fi[er]=new me(ii[er].features,Nt),Fi[er].name=er,Fi[er].version=Nt.version,Fi[er].extent=Nt.extent;return Ce({layers:Fi})},Ie.exports.GeoJSONWrapper=me,Ie.exports}(),ut=r.fh(ot);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:St=>St},Ct=Math.fround||(rt=new Float32Array(1),St=>(rt[0]=+St,rt[0]));var rt;const Bt=3,tt=5,Ut=6;class Ai{constructor(me){this.options=Object.assign(Object.create(mt),me),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(me){const{log:Ce,minZoom:je,maxZoom:Je}=this.options;Ce&&console.time("total time");const Ge=`prepare ${me.length} points`;Ce&&console.time(Ge),this.points=me;const vt=[];for(let _t=0;_t<me.length;_t++){const Ot=me[_t];if(!Ot.geometry)continue;const[ii,Nt]=Ot.geometry.coordinates,Fi=Ct(Pt(ii)),er=Ct(It(Nt));vt.push(Fi,er,1/0,_t,-1,1),this.options.reduce&&vt.push(0)}let Rt=this.trees[Je+1]=this._createTree(vt);Ce&&console.timeEnd(Ge);for(let _t=Je;_t>=je;_t--){const Ot=+Date.now();Rt=this.trees[_t]=this._createTree(this._cluster(Rt,_t)),Ce&&console.log("z%d: %d clusters in %dms",_t,Rt.numItems,+Date.now()-Ot)}return Ce&&console.timeEnd("total time"),this}getClusters(me,Ce){let je=((me[0]+180)%360+360)%360-180;const Je=Math.max(-90,Math.min(90,me[1]));let Ge=me[2]===180?180:((me[2]+180)%360+360)%360-180;const vt=Math.max(-90,Math.min(90,me[3]));if(me[2]-me[0]>=360)je=-180,Ge=180;else if(je>Ge){const Nt=this.getClusters([je,Je,180,vt],Ce),Fi=this.getClusters([-180,Je,Ge,vt],Ce);return Nt.concat(Fi)}const Rt=this.trees[this._limitZoom(Ce)],_t=Rt.range(Pt(je),It(vt),Pt(Ge),It(Je)),Ot=Rt.data,ii=[];for(const Nt of _t){const Fi=this.stride*Nt;ii.push(Ot[Fi+tt]>1?qe(Ot,Fi,this.clusterProps):this.points[Ot[Fi+Bt]])}return ii}getChildren(me){const Ce=this._getOriginId(me),je=this._getOriginZoom(me),Je="No cluster with the specified id.",Ge=this.trees[je];if(!Ge)throw new Error(Je);const vt=Ge.data;if(Ce*this.stride>=vt.length)throw new Error(Je);const Rt=this.options.radius/(this.options.extent*Math.pow(2,je-1)),_t=Ge.within(vt[Ce*this.stride],vt[Ce*this.stride+1],Rt),Ot=[];for(const ii of _t){const Nt=ii*this.stride;vt[Nt+4]===me&&Ot.push(vt[Nt+tt]>1?qe(vt,Nt,this.clusterProps):this.points[vt[Nt+Bt]])}if(Ot.length===0)throw new Error(Je);return Ot}getLeaves(me,Ce,je){const Je=[];return this._appendLeaves(Je,me,Ce=Ce||10,je=je||0,0),Je}getTile(me,Ce,je){const Je=this.trees[this._limitZoom(me)],Ge=Math.pow(2,me),{extent:vt,radius:Rt}=this.options,_t=Rt/vt,Ot=(je-_t)/Ge,ii=(je+1+_t)/Ge,Nt={features:[]};return this._addTileFeatures(Je.range((Ce-_t)/Ge,Ot,(Ce+1+_t)/Ge,ii),Je.data,Ce,je,Ge,Nt),Ce===0&&this._addTileFeatures(Je.range(1-_t/Ge,Ot,1,ii),Je.data,Ge,je,Ge,Nt),Ce===Ge-1&&this._addTileFeatures(Je.range(0,Ot,_t/Ge,ii),Je.data,-1,je,Ge,Nt),Nt.features.length?Nt:null}getClusterExpansionZoom(me){let Ce=this._getOriginZoom(me)-1;for(;Ce<=this.options.maxZoom;){const je=this.getChildren(me);if(Ce++,je.length!==1)break;me=je[0].properties.cluster_id}return Ce}_appendLeaves(me,Ce,je,Je,Ge){const vt=this.getChildren(Ce);for(const Rt of vt){const _t=Rt.properties;if(_t&&_t.cluster?Ge+_t.point_count<=Je?Ge+=_t.point_count:Ge=this._appendLeaves(me,_t.cluster_id,je,Je,Ge):Ge<Je?Ge++:me.push(Rt),me.length===je)break}return Ge}_createTree(me){const Ce=new r.bW(me.length/this.stride|0,this.options.nodeSize,Float32Array);for(let je=0;je<me.length;je+=this.stride)Ce.add(me[je],me[je+1]);return Ce.finish(),Ce.data=me,Ce}_addTileFeatures(me,Ce,je,Je,Ge,vt){for(const Rt of me){const _t=Rt*this.stride,Ot=Ce[_t+tt]>1;let ii,Nt,Fi;if(Ot)ii=Ke(Ce,_t,this.clusterProps),Nt=Ce[_t],Fi=Ce[_t+1];else{const Sr=this.points[Ce[_t+Bt]];ii=Sr.properties;const[Mr,jr]=Sr.geometry.coordinates;Nt=Pt(Mr),Fi=It(jr)}const er={type:1,geometry:[[Math.round(this.options.extent*(Nt*Ge-je)),Math.round(this.options.extent*(Fi*Ge-Je))]],tags:ii};let nr;nr=Ot||this.options.generateId?Ce[_t+Bt]:this.points[Ce[_t+Bt]].id,nr!==void 0&&(er.id=nr),vt.features.push(er)}}_limitZoom(me){return Math.max(this.options.minZoom,Math.min(Math.floor(+me),this.options.maxZoom+1))}_cluster(me,Ce){const{radius:je,extent:Je,reduce:Ge,minPoints:vt}=this.options,Rt=je/(Je*Math.pow(2,Ce)),_t=me.data,Ot=[],ii=this.stride;for(let Nt=0;Nt<_t.length;Nt+=ii){if(_t[Nt+2]<=Ce)continue;_t[Nt+2]=Ce;const Fi=_t[Nt],er=_t[Nt+1],nr=me.within(_t[Nt],_t[Nt+1],Rt),Sr=_t[Nt+tt];let Mr=Sr;for(const jr of nr){const nn=jr*ii;_t[nn+2]>Ce&&(Mr+=_t[nn+tt])}if(Mr>Sr&&Mr>=vt){let jr,nn=Fi*Sr,Yr=er*Sr,Wn=-1;const fs=(Nt/ii<<5)+(Ce+1)+this.points.length;for(const ps of nr){const Sn=ps*ii;if(_t[Sn+2]<=Ce)continue;_t[Sn+2]=Ce;const En=_t[Sn+tt];nn+=_t[Sn]*En,Yr+=_t[Sn+1]*En,_t[Sn+4]=fs,Ge&&(jr||(jr=this._map(_t,Nt,!0),Wn=this.clusterProps.length,this.clusterProps.push(jr)),Ge(jr,this._map(_t,Sn)))}_t[Nt+4]=fs,Ot.push(nn/Mr,Yr/Mr,1/0,fs,-1,Mr),Ge&&Ot.push(Wn)}else{for(let jr=0;jr<ii;jr++)Ot.push(_t[Nt+jr]);if(Mr>1)for(const jr of nr){const nn=jr*ii;if(!(_t[nn+2]<=Ce)){_t[nn+2]=Ce;for(let Yr=0;Yr<ii;Yr++)Ot.push(_t[nn+Yr])}}}}return Ot}_getOriginId(me){return me-this.points.length>>5}_getOriginZoom(me){return(me-this.points.length)%32}_map(me,Ce,je){if(me[Ce+tt]>1){const vt=this.clusterProps[me[Ce+Ut]];return je?Object.assign({},vt):vt}const Je=this.points[me[Ce+Bt]].properties,Ge=this.options.map(Je);return je&&Ge===Je?Object.assign({},Ge):Ge}}function qe(St,me,Ce){return{type:"Feature",id:St[me+Bt],properties:Ke(St,me,Ce),geometry:{type:"Point",coordinates:[(je=St[me],360*(je-.5)),Ze(St[me+1])]}};var je}function Ke(St,me,Ce){const je=St[me+tt],Je=je>=1e4?`${Math.round(je/1e3)}k`:je>=1e3?Math.round(je/100)/10+"k":je,Ge=St[me+Ut],vt=Ge===-1?{}:Object.assign({},Ce[Ge]);return Object.assign(vt,{cluster:!0,cluster_id:St[me+Bt],point_count:je,point_count_abbreviated:Je})}function Pt(St){return St/360+.5}function It(St){const me=Math.sin(St*Math.PI/180),Ce=.5-.25*Math.log((1+me)/(1-me))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function Ze(St){const me=(180-360*St)*Math.PI/180;return 360*Math.atan(Math.exp(me))/Math.PI-90}function yi(St,me,Ce,je){let Je=je;const Ge=me+(Ce-me>>1);let vt,Rt=Ce-me;const _t=St[me],Ot=St[me+1],ii=St[Ce],Nt=St[Ce+1];for(let Fi=me+3;Fi<Ce;Fi+=3){const er=bi(St[Fi],St[Fi+1],_t,Ot,ii,Nt);if(er>Je)vt=Fi,Je=er;else if(er===Je){const nr=Math.abs(Fi-Ge);nr<Rt&&(vt=Fi,Rt=nr)}}Je>je&&(vt-me>3&&yi(St,me,vt,je),St[vt+2]=Je,Ce-vt>3&&yi(St,vt,Ce,je))}function bi(St,me,Ce,je,Je,Ge){let vt=Je-Ce,Rt=Ge-je;if(vt!==0||Rt!==0){const _t=((St-Ce)*vt+(me-je)*Rt)/(vt*vt+Rt*Rt);_t>1?(Ce=Je,je=Ge):_t>0&&(Ce+=vt*_t,je+=Rt*_t)}return vt=St-Ce,Rt=me-je,vt*vt+Rt*Rt}function Kt(St,me,Ce,je){const Je={id:St??null,type:me,geometry:Ce,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(me==="Point"||me==="MultiPoint"||me==="LineString")di(Je,Ce);else if(me==="Polygon")di(Je,Ce[0]);else if(me==="MultiLineString")for(const Ge of Ce)di(Je,Ge);else if(me==="MultiPolygon")for(const Ge of Ce)di(Je,Ge[0]);return Je}function di(St,me){for(let Ce=0;Ce<me.length;Ce+=3)St.minX=Math.min(St.minX,me[Ce]),St.minY=Math.min(St.minY,me[Ce+1]),St.maxX=Math.max(St.maxX,me[Ce]),St.maxY=Math.max(St.maxY,me[Ce+1])}function pi(St,me,Ce,je){if(!me.geometry)return;const Je=me.geometry.coordinates;if(Je&&Je.length===0)return;const Ge=me.geometry.type,vt=Math.pow(Ce.tolerance/((1<<Ce.maxZoom)*Ce.extent),2);let Rt=[],_t=me.id;if(Ce.promoteId?_t=me.properties[Ce.promoteId]:Ce.generateId&&(_t=je||0),Ge==="Point")Ri(Je,Rt);else if(Ge==="MultiPoint")for(const Ot of Je)Ri(Ot,Rt);else if(Ge==="LineString")Oi(Je,Rt,vt,!1);else if(Ge==="MultiLineString"){if(Ce.lineMetrics){for(const Ot of Je)Rt=[],Oi(Ot,Rt,vt,!1),St.push(Kt(_t,"LineString",Rt,me.properties));return}Ji(Je,Rt,vt,!1)}else if(Ge==="Polygon")Ji(Je,Rt,vt,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(const Ot of me.geometry.geometries)pi(St,{id:_t,geometry:Ot,properties:me.properties},Ce,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ot of Je){const ii=[];Ji(Ot,ii,vt,!0),Rt.push(ii)}}St.push(Kt(_t,Ge,Rt,me.properties))}function Ri(St,me){me.push(ar(St[0]),br(St[1]),0)}function Oi(St,me,Ce,je){let Je,Ge,vt=0;for(let _t=0;_t<St.length;_t++){const Ot=ar(St[_t][0]),ii=br(St[_t][1]);me.push(Ot,ii,0),_t>0&&(vt+=je?(Je*ii-Ot*Ge)/2:Math.sqrt(Math.pow(Ot-Je,2)+Math.pow(ii-Ge,2))),Je=Ot,Ge=ii}const Rt=me.length-3;me[2]=1,yi(me,0,Rt,Ce),me[Rt+2]=1,me.size=Math.abs(vt),me.start=0,me.end=me.size}function Ji(St,me,Ce,je){for(let Je=0;Je<St.length;Je++){const Ge=[];Oi(St[Je],Ge,Ce,je),me.push(Ge)}}function ar(St){return St/360+.5}function br(St){const me=Math.sin(St*Math.PI/180),Ce=.5-.25*Math.log((1+me)/(1-me))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function Dr(St,me,Ce,je,Je,Ge,vt,Rt){if(je/=me,Ge>=(Ce/=me)&&vt<je)return St;if(vt<Ce||Ge>=je)return null;const _t=[];for(const Ot of St){const ii=Ot.geometry;let Nt=Ot.type;const Fi=Je===0?Ot.minX:Ot.minY,er=Je===0?Ot.maxX:Ot.maxY;if(Fi>=Ce&&er<je){_t.push(Ot);continue}if(er<Ce||Fi>=je)continue;let nr=[];if(Nt==="Point"||Nt==="MultiPoint")Fr(ii,nr,Ce,je,Je);else if(Nt==="LineString")Qr(ii,nr,Ce,je,Je,!1,Rt.lineMetrics);else if(Nt==="MultiLineString")li(ii,nr,Ce,je,Je,!1);else if(Nt==="Polygon")li(ii,nr,Ce,je,Je,!0);else if(Nt==="MultiPolygon")for(const Sr of ii){const Mr=[];li(Sr,Mr,Ce,je,Je,!0),Mr.length&&nr.push(Mr)}if(nr.length){if(Rt.lineMetrics&&Nt==="LineString"){for(const Sr of nr)_t.push(Kt(Ot.id,Nt,Sr,Ot.tags));continue}Nt!=="LineString"&&Nt!=="MultiLineString"||(nr.length===1?(Nt="LineString",nr=nr[0]):Nt="MultiLineString"),Nt!=="Point"&&Nt!=="MultiPoint"||(Nt=nr.length===3?"Point":"MultiPoint"),_t.push(Kt(Ot.id,Nt,nr,Ot.tags))}}return _t.length?_t:null}function Fr(St,me,Ce,je,Je){for(let Ge=0;Ge<St.length;Ge+=3){const vt=St[Ge+Je];vt>=Ce&&vt<=je&&Vi(me,St[Ge],St[Ge+1],St[Ge+2])}}function Qr(St,me,Ce,je,Je,Ge,vt){let Rt=ui(St);const _t=Je===0?rr:qr;let Ot,ii,Nt=St.start;for(let Mr=0;Mr<St.length-3;Mr+=3){const jr=St[Mr],nn=St[Mr+1],Yr=St[Mr+2],Wn=St[Mr+3],fs=St[Mr+4],ps=Je===0?jr:nn,Sn=Je===0?Wn:fs;let En=!1;vt&&(Ot=Math.sqrt(Math.pow(jr-Wn,2)+Math.pow(nn-fs,2))),ps<Ce?Sn>Ce&&(ii=_t(Rt,jr,nn,Wn,fs,Ce),vt&&(Rt.start=Nt+Ot*ii)):ps>je?Sn<je&&(ii=_t(Rt,jr,nn,Wn,fs,je),vt&&(Rt.start=Nt+Ot*ii)):Vi(Rt,jr,nn,Yr),Sn<Ce&&ps>=Ce&&(ii=_t(Rt,jr,nn,Wn,fs,Ce),En=!0),Sn>je&&ps<=je&&(ii=_t(Rt,jr,nn,Wn,fs,je),En=!0),!Ge&&En&&(vt&&(Rt.end=Nt+Ot*ii),me.push(Rt),Rt=ui(St)),vt&&(Nt+=Ot)}let Fi=St.length-3;const er=St[Fi],nr=St[Fi+1],Sr=Je===0?er:nr;Sr>=Ce&&Sr<=je&&Vi(Rt,er,nr,St[Fi+2]),Fi=Rt.length-3,Ge&&Fi>=3&&(Rt[Fi]!==Rt[0]||Rt[Fi+1]!==Rt[1])&&Vi(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&me.push(Rt)}function ui(St){const me=[];return me.size=St.size,me.start=St.start,me.end=St.end,me}function li(St,me,Ce,je,Je,Ge){for(const vt of St)Qr(vt,me,Ce,je,Je,Ge,!1)}function Vi(St,me,Ce,je){St.push(me,Ce,je)}function rr(St,me,Ce,je,Je,Ge){const vt=(Ge-me)/(je-me);return Vi(St,Ge,Ce+(Je-Ce)*vt,1),vt}function qr(St,me,Ce,je,Je,Ge){const vt=(Ge-Ce)/(Je-Ce);return Vi(St,me+(je-me)*vt,Ge,1),vt}function _r(St,me){const Ce=[];for(let je=0;je<St.length;je++){const Je=St[je],Ge=Je.type;let vt;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")vt=Zr(Je.geometry,me);else if(Ge==="MultiLineString"||Ge==="Polygon"){vt=[];for(const Rt of Je.geometry)vt.push(Zr(Rt,me))}else if(Ge==="MultiPolygon"){vt=[];for(const Rt of Je.geometry){const _t=[];for(const Ot of Rt)_t.push(Zr(Ot,me));vt.push(_t)}}Ce.push(Kt(Je.id,Ge,vt,Je.tags))}return Ce}function Zr(St,me){const Ce=[];Ce.size=St.size,St.start!==void 0&&(Ce.start=St.start,Ce.end=St.end);for(let je=0;je<St.length;je+=3)Ce.push(St[je]+me,St[je+1],St[je+2]);return Ce}function io(St,me){if(St.transformed)return St;const Ce=1<<St.z,je=St.x,Je=St.y;for(const Ge of St.features){const vt=Ge.geometry,Rt=Ge.type;if(Ge.geometry=[],Rt===1)for(let _t=0;_t<vt.length;_t+=2)Ge.geometry.push(Ur(vt[_t],vt[_t+1],me,Ce,je,Je));else for(let _t=0;_t<vt.length;_t++){const Ot=[];for(let ii=0;ii<vt[_t].length;ii+=2)Ot.push(Ur(vt[_t][ii],vt[_t][ii+1],me,Ce,je,Je));Ge.geometry.push(Ot)}}return St.transformed=!0,St}function Ur(St,me,Ce,je,Je,Ge){return[Math.round(Ce*(St*je-Je)),Math.round(Ce*(me*je-Ge))]}function ta(St,me,Ce,je,Je){const Ge=me===Je.maxZoom?0:Je.tolerance/((1<<me)*Je.extent),vt={features:[],numPoints:0,numSimplified:0,numFeatures:St.length,source:null,x:Ce,y:je,z:me,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Rt of St)As(vt,Rt,Ge,Je);return vt}function As(St,me,Ce,je){const Je=me.geometry,Ge=me.type,vt=[];if(St.minX=Math.min(St.minX,me.minX),St.minY=Math.min(St.minY,me.minY),St.maxX=Math.max(St.maxX,me.maxX),St.maxY=Math.max(St.maxY,me.maxY),Ge==="Point"||Ge==="MultiPoint")for(let Rt=0;Rt<Je.length;Rt+=3)vt.push(Je[Rt],Je[Rt+1]),St.numPoints++,St.numSimplified++;else if(Ge==="LineString")ro(vt,Je,St,Ce,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(let Rt=0;Rt<Je.length;Rt++)ro(vt,Je[Rt],St,Ce,Ge==="Polygon",Rt===0);else if(Ge==="MultiPolygon")for(let Rt=0;Rt<Je.length;Rt++){const _t=Je[Rt];for(let Ot=0;Ot<_t.length;Ot++)ro(vt,_t[Ot],St,Ce,!0,Ot===0)}if(vt.length){let Rt=me.tags||null;if(Ge==="LineString"&&je.lineMetrics){Rt={};for(const Ot in me.tags)Rt[Ot]=me.tags[Ot];Rt.mapbox_clip_start=Je.start/Je.size,Rt.mapbox_clip_end=Je.end/Je.size}const _t={geometry:vt,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Rt};me.id!==null&&(_t.id=me.id),St.features.push(_t)}}function ro(St,me,Ce,je,Je,Ge){const vt=je*je;if(je>0&&me.size<(Je?vt:je))return void(Ce.numPoints+=me.length/3);const Rt=[];for(let _t=0;_t<me.length;_t+=3)(je===0||me[_t+2]>vt)&&(Ce.numSimplified++,Rt.push(me[_t],me[_t+1])),Ce.numPoints++;Je&&function(_t,Ot){let ii=0;for(let Nt=0,Fi=_t.length,er=Fi-2;Nt<Fi;er=Nt,Nt+=2)ii+=(_t[Nt]-_t[er])*(_t[Nt+1]+_t[er+1]);if(ii>0===Ot)for(let Nt=0,Fi=_t.length;Nt<Fi/2;Nt+=2){const er=_t[Nt],nr=_t[Nt+1];_t[Nt]=_t[Fi-2-Nt],_t[Nt+1]=_t[Fi-1-Nt],_t[Fi-2-Nt]=er,_t[Fi-1-Nt]=nr}}(Rt,Ge),St.push(Rt)}const zn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Lr{constructor(me,Ce){const je=(Ce=this.options=function(Ge,vt){for(const Rt in vt)Ge[Rt]=vt[Rt];return Ge}(Object.create(zn),Ce)).debug;if(je&&console.time("preprocess data"),Ce.maxZoom<0||Ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ce.promoteId&&Ce.generateId)throw new Error("promoteId and generateId cannot be used together.");let Je=function(Ge,vt){const Rt=[];if(Ge.type==="FeatureCollection")for(let _t=0;_t<Ge.features.length;_t++)pi(Rt,Ge.features[_t],vt,_t);else pi(Rt,Ge.type==="Feature"?Ge:{geometry:Ge},vt);return Rt}(me,Ce);this.tiles={},this.tileCoords=[],je&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ce.indexMaxZoom,Ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Je=function(Ge,vt){const Rt=vt.buffer/vt.extent;let _t=Ge;const Ot=Dr(Ge,1,-1-Rt,Rt,0,-1,2,vt),ii=Dr(Ge,1,1-Rt,2+Rt,0,-1,2,vt);return(Ot||ii)&&(_t=Dr(Ge,1,-Rt,1+Rt,0,-1,2,vt)||[],Ot&&(_t=_r(Ot,1).concat(_t)),ii&&(_t=_t.concat(_r(ii,-1)))),_t}(Je,Ce),Je.length&&this.splitTile(Je,0,0,0),je&&(Je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(me,Ce,je,Je,Ge,vt,Rt){const _t=[me,Ce,je,Je],Ot=this.options,ii=Ot.debug;for(;_t.length;){Je=_t.pop(),je=_t.pop(),Ce=_t.pop(),me=_t.pop();const Nt=1<<Ce,Fi=yr(Ce,je,Je);let er=this.tiles[Fi];if(!er&&(ii>1&&console.time("creation"),er=this.tiles[Fi]=ta(me,Ce,je,Je,Ot),this.tileCoords.push({z:Ce,x:je,y:Je}),ii)){ii>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ce,je,Je,er.numFeatures,er.numPoints,er.numSimplified),console.timeEnd("creation"));const En=`z${Ce}`;this.stats[En]=(this.stats[En]||0)+1,this.total++}if(er.source=me,Ge==null){if(Ce===Ot.indexMaxZoom||er.numPoints<=Ot.indexMaxPoints)continue}else{if(Ce===Ot.maxZoom||Ce===Ge)continue;if(Ge!=null){const En=Ge-Ce;if(je!==vt>>En||Je!==Rt>>En)continue}}if(er.source=null,me.length===0)continue;ii>1&&console.time("clipping");const nr=.5*Ot.buffer/Ot.extent,Sr=.5-nr,Mr=.5+nr,jr=1+nr;let nn=null,Yr=null,Wn=null,fs=null,ps=Dr(me,Nt,je-nr,je+Mr,0,er.minX,er.maxX,Ot),Sn=Dr(me,Nt,je+Sr,je+jr,0,er.minX,er.maxX,Ot);me=null,ps&&(nn=Dr(ps,Nt,Je-nr,Je+Mr,1,er.minY,er.maxY,Ot),Yr=Dr(ps,Nt,Je+Sr,Je+jr,1,er.minY,er.maxY,Ot),ps=null),Sn&&(Wn=Dr(Sn,Nt,Je-nr,Je+Mr,1,er.minY,er.maxY,Ot),fs=Dr(Sn,Nt,Je+Sr,Je+jr,1,er.minY,er.maxY,Ot),Sn=null),ii>1&&console.timeEnd("clipping"),_t.push(nn||[],Ce+1,2*je,2*Je),_t.push(Yr||[],Ce+1,2*je,2*Je+1),_t.push(Wn||[],Ce+1,2*je+1,2*Je),_t.push(fs||[],Ce+1,2*je+1,2*Je+1)}}getTile(me,Ce,je){me=+me,Ce=+Ce,je=+je;const Je=this.options,{extent:Ge,debug:vt}=Je;if(me<0||me>24)return null;const Rt=1<<me,_t=yr(me,Ce=Ce+Rt&Rt-1,je);if(this.tiles[_t])return io(this.tiles[_t],Ge);vt>1&&console.log("drilling down to z%d-%d-%d",me,Ce,je);let Ot,ii=me,Nt=Ce,Fi=je;for(;!Ot&&ii>0;)ii--,Nt>>=1,Fi>>=1,Ot=this.tiles[yr(ii,Nt,Fi)];return Ot&&Ot.source?(vt>1&&(console.log("found parent tile z%d-%d-%d",ii,Nt,Fi),console.time("drilling down")),this.splitTile(Ot.source,ii,Nt,Fi,me,Ce,je),vt>1&&console.timeEnd("drilling down"),this.tiles[_t]?io(this.tiles[_t],Ge):null):null}}function yr(St,me,Ce){return 32*((1<<St)*Ce+me)+St}function qt(St,me){const Ce=St.tileID.canonical;if(!this._geoJSONIndex)return void me(null,null);const je=this._geoJSONIndex.getTile(Ce.z,Ce.x,Ce.y);if(!je)return void me(null,null);const Je=_t=>_t.tags&&"3d_elevation_id"in _t.tags&&"source"in _t.tags&&_t.tags.source==="elevation",Ge=je.features.filter(_t=>Je(_t));let vt;if(Ge.length>0){const _t=je.features.filter(Ot=>!Je(Ot));vt=new he({_geojsonTileLayer:_t,hd_road_elevation:Ge})}else vt=new pe(je.features);let Rt=ut(vt);Rt.byteOffset===0&&Rt.byteLength===Rt.buffer.byteLength||(Rt=new Uint8Array(Rt)),me(null,{vectorTile:vt,rawData:Rt.buffer})}class Nn extends G{constructor(me,Ce,je,Je,Ge,vt,Rt){super(me,Ce,je,Je,Ge,qt,Rt),vt&&(this.loadGeoJSON=vt),this._dynamicIndex=new oe}loadData(me,Ce){const je=me&&me.request,Je=je&&je.collectResourceTiming;this.loadGeoJSON(me,(Ge,vt)=>{if(Ge||!vt)return Ce(Ge);if(typeof vt!="object")return Ce(new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`));{try{if(me.filter){const _t=r.X(me.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_t.result==="error")throw new Error(_t.value.map(Ot=>`${Ot.key}: ${Ot.message}`).join(", "));vt.features=vt.features.filter(Ot=>_t.value.evaluate({zoom:0},Ot))}me.dynamic?(vt.type==="Feature"&&(vt={type:"FeatureCollection",features:[vt]}),me.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(vt.features,this.loaded),me.cluster&&(vt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=me.cluster?new Ai(function({superclusterOptions:_t,clusterProperties:Ot}){if(!Ot||!_t)return _t;const ii={},Nt={},Fi={accumulated:null,zoom:0},er={properties:null},nr=Object.keys(Ot);for(const Sr of nr){const[Mr,jr]=Ot[Sr],nn=r.X(jr),Yr=r.X(typeof Mr=="string"?[Mr,["accumulated"],["get",Sr]]:Mr);ii[Sr]=nn.value,Nt[Sr]=Yr.value}return _t.map=Sr=>{er.properties=Sr;const Mr={};for(const jr of nr)Mr[jr]=ii[jr].evaluate(Fi,er);return Mr},_t.reduce=(Sr,Mr)=>{er.properties=Mr;for(const jr of nr)Fi.accumulated=Sr[jr],Sr[jr]=Nt[jr].evaluate(Fi,er)},_t}(me)).load(vt.features):me.dynamic?this._dynamicIndex:function(_t,Ot){return new Lr(_t,Ot)}(vt,me.geojsonVtOptions)}catch(_t){return Ce(_t)}const Rt={};if(Je){const _t=y(je);_t&&(Rt.resourceTiming={},Rt.resourceTiming[me.source]=JSON.parse(JSON.stringify(_t)))}Ce(null,Rt)}})}reloadTile(me,Ce){const je=this.loaded;return je&&je[me.uid]?me.partial?Ce(null,void 0):super.reloadTile(me,Ce):this.loadTile(me,Ce)}loadGeoJSON(me,Ce){if(me.request)r.n(me.request,Ce);else{if(typeof me.data!="string")return Ce(new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`));try{return Ce(null,JSON.parse(me.data))}catch{return Ce(new Error(`Input data given to '${me.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(me,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(me.clusterId))}catch(je){Ce(je)}}getClusterChildren(me,Ce){try{Ce(null,this._geoJSONIndex.getChildren(me.clusterId))}catch(je){Ce(je)}}getClusterLeaves(me,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(me.clusterId,me.limit,me.offset))}catch(je){Ce(je)}}}class vs{constructor(me,Ce,je){this.tileID=new r.aM(me.tileID.overscaledZ,me.tileID.wrap,me.tileID.canonical.z,me.tileID.canonical.x,me.tileID.canonical.y),this.tileZoom=me.tileZoom,this.uid=me.uid,this.zoom=me.zoom,this.canonical=me.tileID.canonical,this.pixelRatio=me.pixelRatio,this.tileSize=me.tileSize,this.source=me.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=me.projection,this.brightness=Ce,this.worldview=je}parse(me,Ce,je,Je){this.status="parsing";const Ge=new r.aM(je.tileID.overscaledZ,je.tileID.wrap,je.tileID.canonical.z,je.tileID.canonical.x,je.tileID.canonical.y),vt=[],Rt=Ce.familiesBySource[je.source],_t=new r.f0(Ge,je.promoteId);_t.bucketLayerIDs=[],_t.is3DTile=!0,r.fi(me).then(Ot=>{if(!Ot)return Je(new Error("Could not parse tile"));const ii=Ot.json.extensionsUsed&&Ot.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ot.json.asset.extras&&Ot.json.asset.extras.MAPBOX_mesh_features,Nt=Ot.json.extensionsUsed&&Ot.json.extensionsUsed.includes("EXT_meshopt_compression"),Fi=new r.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const er in Rt)for(const nr of Rt[er]){const Sr=nr[0];_t.bucketLayerIDs.push(nr.map(nn=>r.C(nn.id,nn.scope))),Sr.recalculate(Fi,[]);const Mr=r.fj(Ot,1/r.cU(je.tileID.canonical)),jr=new r.fk(nr,Mr,Ge,ii,Nt,this.brightness,_t,this.worldview);ii||(jr.needsUpload=!0),vt.push(jr),jr.evaluate(Sr)}this.status="done",Je(null,{buckets:vt,featureIndex:_t,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Ot=>Je(new Error(Ot.message)))}}class ia{constructor(me,Ce,je,Je,Ge,vt,Rt,_t){this.actor=me,this.layerIndex=Ce,this.availableImages=je,this.availableModels=Je,this.brightness=Rt,this.loading={},this.loaded={},this.worldview=_t}loadTile(me,Ce){const je=me.uid,Je=this.loading[je]=new vs(me,this.brightness,this.worldview);r.br(me.request,(Ge,vt)=>{const Rt=!this.loading[je];return delete this.loading[je],Rt||Ge?(Je.status="done",Rt||(this.loaded[je]=Je),Ce(Ge)):vt&&vt.byteLength!==0?void Je.parse(vt,this.layerIndex,me,(_t,Ot)=>{Je.status="done",this.loaded=this.loaded||{},this.loaded[je]=Je,_t||!Ot?Ce(_t):Ce(null,Ot)}):(Je.status="done",this.loaded[je]=Je,Ce())})}reloadTile(me,Ce){const je=this.loaded,Je=me.uid;if(je&&je[Je]){const Ge=je[Je];Ge.projection=me.projection,Ge.brightness=me.brightness;const vt=(Rt,_t)=>{Ge.reloadCallback&&(delete Ge.reloadCallback,this.loadTile(me,Ce)),Ce(Rt,_t)};Ge.status==="parsing"?Ge.reloadCallback=vt:Ge.status==="done"&&this.loadTile(me,Ce)}}abortTile(me,Ce){const je=me.uid;this.loading[je]&&delete this.loading[je],Ce()}removeTile(me,Ce){const je=this.loaded,Je=me.uid;je&&je[Je]&&delete je[Je],Ce()}}class dn{constructor(me){this.self=me,this.actor=new r.fm(me,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new r.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=r.ce({name:"mercator"}),this.workerSourceTypes={vector:G,geojson:Nn,"raster-dem":U,"raster-array":q,"batched-model":ia},this.workerSources={},this.self.registerWorkerSource=(Ce,je)=>{if(this.workerSourceTypes[Ce])throw new Error(`Worker source with name "${Ce}" already registered.`);this.workerSourceTypes[Ce]=je},this.self.registerRTLTextPlugin=Ce=>{if(r.fn.isParsed())throw new Error("RTL text plugin already registered.");r.fn.setState({pluginStatus:r.fo.parsed,pluginURL:r.fn.getPluginURL()}),r.fn.applyArabicShaping=Ce.applyArabicShaping,r.fn.processBidirectionalText=Ce.processBidirectionalText,r.fn.processStyledBidirectionalText=Ce.processStyledBidirectionalText;for(const je of this.rtlPluginParsingListeners)je(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(me,Ce,je){delete this.layerIndexes[me],delete this.availableImages[me],delete this.availableModels[me],delete this.workerSources[me],je()}checkIfReady(me,Ce,je){je()}setReferrer(me,Ce){this.referrer=Ce}spriteLoaded(me,Ce){this.isSpriteLoaded[me]||(this.isSpriteLoaded[me]={});const{scope:je,isLoaded:Je}=Ce;if(this.isSpriteLoaded[me][je]=Je,this.workerSources[me]&&this.workerSources[me][je])for(const Ge in this.workerSources[me][je]){const vt=this.workerSources[me][je][Ge];for(const Rt in vt){const _t=vt[Rt];_t instanceof G&&(_t.isSpriteLoaded=Je,_t.fire(new r.A("isSpriteLoaded")))}}}setImages(me,Ce,je){this.availableImages[me]||(this.availableImages[me]={});const{scope:Je,images:Ge}=Ce;if(this.availableImages[me][Je]=Ge,this.workerSources[me]&&this.workerSources[me][Je]){for(const vt in this.workerSources[me][Je]){const Rt=this.workerSources[me][Je][vt];for(const _t in Rt)Rt[_t].availableImages=Ge}je()}else je()}setModels(me,{scope:Ce,models:je},Je){if(this.availableModels[me]||(this.availableModels[me]={}),this.availableModels[me][Ce]=je,this.workerSources[me]&&this.workerSources[me][Ce]){for(const Ge in this.workerSources[me][Ce]){const vt=this.workerSources[me][Ce][Ge];for(const Rt in vt)vt[Rt].availableModels=je}Je()}else Je()}setProjection(me,Ce){this.projections[me]=r.ce(Ce)}setBrightness(me,Ce,je){this.brightness=Ce,je()}setWorldview(me,Ce,je){this.worldview=Ce,je()}setLayers(me,Ce,je){this.getLayerIndex(me,Ce.scope).replace(Ce.layers,Ce.options),je()}updateLayers(me,Ce,je){this.getLayerIndex(me,Ce.scope).update(Ce.layers,Ce.removedIds,Ce.options),je()}loadTile(me,Ce,je){Ce.projection=this.projections[me]||this.defaultProjection,this.getWorkerSource(me,Ce.type,Ce.source,Ce.scope).loadTile(Ce,je)}decodeRasterArray(me,Ce,je){this.getWorkerSource(me,Ce.type,Ce.source,Ce.scope).decodeRasterArray(Ce,je)}reloadTile(me,Ce,je){Ce.projection=this.projections[me]||this.defaultProjection,this.getWorkerSource(me,Ce.type,Ce.source,Ce.scope).reloadTile(Ce,je)}abortTile(me,Ce,je){this.getWorkerSource(me,Ce.type,Ce.source,Ce.scope).abortTile(Ce,je)}removeTile(me,Ce,je){this.getWorkerSource(me,Ce.type,Ce.source,Ce.scope).removeTile(Ce,je)}removeSource(me,Ce,je){if(!(this.workerSources[me]&&this.workerSources[me][Ce.scope]&&this.workerSources[me][Ce.scope][Ce.type]&&this.workerSources[me][Ce.scope][Ce.type][Ce.source]))return;const Je=this.workerSources[me][Ce.scope][Ce.type][Ce.source];delete this.workerSources[me][Ce.scope][Ce.type][Ce.source],Je.removeSource!==void 0?Je.removeSource(Ce,je):je()}loadWorkerSource(me,Ce,je){try{this.self.importScripts(Ce.url),je()}catch(Je){je(Je.toString())}}syncRTLPluginState(me,Ce,je){if(r.fn.isParsed())je(null,!0);else if(r.fn.isParsing())this.rtlPluginParsingListeners.push(je);else try{r.fn.setState(Ce);const Je=r.fn.getPluginURL();!r.fn.isLoaded()||r.fn.isParsed()||r.fn.isParsing()||Je==null||(r.fn.setState({pluginStatus:r.fo.parsing,pluginURL:r.fn.getPluginURL()}),this.self.importScripts(Je),r.fn.isParsed()?je(null,!0):this.rtlPluginParsingListeners.push(je))}catch(Je){je(Je.toString())}}setDracoUrl(me,Ce){this.dracoUrl=Ce}getAvailableImages(me,Ce){this.availableImages[me]||(this.availableImages[me]={});let je=this.availableImages[me][Ce];return je||(je=[]),je}getAvailableModels(me,Ce){this.availableModels[me]||(this.availableModels[me]={});let je=this.availableModels[me][Ce];return je||(je={}),je}getLayerIndex(me,Ce){this.layerIndexes[me]||(this.layerIndexes[me]={});let je=this.layerIndexes[me][Ce];return je||(je=this.layerIndexes[me][Ce]=new B,je.scope=Ce),je}getWorkerSource(me,Ce,je,Je){const Ge=this.workerSources;return Ge[me]||(Ge[me]={}),Ge[me][Je]||(Ge[me][Je]={}),Ge[me][Je][Ce]||(Ge[me][Je][Ce]={}),this.isSpriteLoaded[me]||(this.isSpriteLoaded[me]={}),Ge[me][Je][Ce][je]||(Ge[me][Je][Ce][je]=new this.workerSourceTypes[Ce]({send:(vt,Rt,_t,Ot,ii,Nt)=>this.actor.send(vt,Rt,_t,me,ii,Nt),scheduler:this.actor.scheduler},this.getLayerIndex(me,Je),this.getAvailableImages(me,Je),this.getAvailableModels(me,Je),this.isSpriteLoaded[me][Je],void 0,this.brightness,this.worldview)),Ge[me][Je][Ce][je]}rasterizeImagesWorker(me,Ce,je){const Je=new Map;for(const[Ge,{image:vt,imageVariant:Rt}]of Ce.tasks.entries()){const _t=this.imageRasterizer.rasterize(Rt,vt,Ce.scope,me);Je.set(Ge,_t)}je(void 0,Je)}removeRasterizedImages(me,Ce,je){this.imageRasterizer.removeImagesFromCacheByIds(Ce.imageIds,Ce.scope,me),je()}enforceCacheSizeLimit(me,Ce){r.fp(Ce)}getWorkerPerformanceMetrics(me,Ce,je){je(void 0,void 0)}}return r.fl(self)&&(self.worker=new dn(self)),dn}),d(["./shared"],function(r){var y="3.13.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},x={mark(p){performance.mark(p)},measure(p,n,u){performance.measure(p,n,u)}};function B(p){const n=p.name.split("?")[0];return r.a(n)&&n.includes("mapbox-gl.js")?"javascript":r.a(n)&&n.includes("mapbox-gl.css")?"css":r.b(n)?"fontRange":r.c(n)?"sprite":r.i(n)?"style":r.d(n)?"tilejson":"other"}var T,E={},R=function(){if(T)return E;function p(g){return!n(g)}function n(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,S,L=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(L);try{S=new Worker(M),w=!0}catch{w=!1}return S&&S.terminate(),URL.revokeObjectURL(M),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var S=w.getContext("2d");if(!S)return!1;var L=S.getImageData(0,0,1,1);return L&&L.width===w.width}()?(u[_=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[_]=function(w){var S,L=function(M){var V=document.createElement("canvas"),Y=Object.create(p.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=M,V.getContext("webgl2",Y)}(w);if(!L)return!1;try{S=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!S||L.isContextLost())&&(L.shaderSource(S,"void main() {}"),L.compileShader(S),L.getShaderParameter(S,L.COMPILE_STATUS)===!0)}(_)),u[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var _}T=1,E.supported=p,E.notSupportedReason=n;var u={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},E}();function P(p,n,u){const g=document.createElement(p);return n!=null&&(g.className=n),u&&u.appendChild(g),g}function G(p,n,u){const g=document.createElementNS("http://www.w3.org/2000/svg",p);for(const _ of Object.keys(n))g.setAttributeNS(null,_,String(n[_]));return u&&u.appendChild(g),g}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Q=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;function ne(){U&&Q&&(q=U[Q],U[Q]="none")}function re(){U&&Q&&(U[Q]=q)}function pe(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",pe,!0)}function fe(){window.addEventListener("click",pe,!0),window.setTimeout(()=>{window.removeEventListener("click",pe,!0)},0)}function he(p,n){const u=p.getBoundingClientRect();return oe(p,u,n)}function be(p,n){const u=p.getBoundingClientRect(),g=[];for(let _=0;_<n.length;_++)g.push(oe(p,u,n[_]));return g}function Se(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function oe(p,n,u){const g=p.offsetWidth===n.width?1:p.offsetWidth/n.width;return new r.P((u.clientX-n.left)*g,(u.clientY-n.top)*g)}const ye="01",Me="NO_ACCESS_TOKEN";class Be{constructor(n,u,g){this._transformRequestFn=n,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const n=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ye,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}normalizeStyleURL(n,u){if(!r.j(n))return n;const g=De(n);return g.params.push(`sdk=js-${y}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(n,u){if(!r.j(n))return n;const g=De(n);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(n,u){if(!r.j(n))return n;const g=De(n);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(n,u,g,_){if(!r.j(n))return n;const w=De(n);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),g&&w.params.push(`language=${g}`),_&&w.params.push(`worldview=${_}`),this._makeAPIURL(w,this._customAccessToken||u)}normalizeIconsetURL(n,u){const g=De(n);return r.j(n)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):et(g)}normalizeSpriteURL(n,u,g,_){const w=De(n);return r.j(n)?(w.path=`/styles/v1${w.path}/sprite${u}${g}`,this._makeAPIURL(w,this._customAccessToken||_)):(w.path+=`${u}${g}`,et(w))}normalizeTileURL(n,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!r.j(n))return n;const _=De(n);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&_.authority!=="raster"&&g===512?"@2x":""}${r.l.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${r.e.RASTER_URL_PREFIX}${_.path}`:_.authority==="rasterarrays"?_.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${_.path}`:_.authority==="3dtiles"?_.path=`/${r.e.TILES3D_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${r.e.TILE_URL_VERSION}${_.path}`);const w=this._customAccessToken||function(S){for(const L of S){const M=L.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(_.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,w)}canonicalizeTileURL(n,u){const g=De(n);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return n;let _="mapbox://";g.path.match(/^\/raster\/v1\//)?_+=`raster/${g.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?_+=`rasterarrays/${g.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:_+=`tiles/${g.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let w=g.params;return u&&(w=w.filter(S=>!S.match(/^access_token=/))),w.length&&(_+=`?${w.join("&")}`),_}canonicalizeTileset(n,u){const g=!!u&&r.j(u),_=[];for(const w of n.tiles||[])r.k(w)?_.push(this.canonicalizeTileURL(w,g)):_.push(w);return _}_makeAPIURL(n,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",_=De(r.e.API_URL);if(n.protocol=_.protocol,n.authority=_.authority,n.protocol==="http"){const w=n.params.indexOf("secure");w>=0&&n.params.splice(w,1)}if(_.path!=="/"&&(n.path=`${_.path}${n.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return et(n);if(u=u||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return n.params=n.params.filter(w=>w.indexOf("access_token")===-1),n.params.push(`access_token=${u||""}`),et(n)}}const Pe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function De(p){const n=p.match(Pe);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function et(p){const n=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${n}`}const Ye="mapbox.eventData";function bt(p){if(!p)return null;const n=p.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(r.m(n[1]))}catch{return null}}class pt{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const u=bt(r.e.ACCESS_TOKEN);let g="";return g=u&&u.u?r.f(u.u):r.e.ACCESS_TOKEN||"",n?`${Ye}.${n}:${g}`:`${Ye}:${g}`}fetchEventData(){const n=r.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid");if(n)try{const _=localStorage.getItem(u);_&&(this.eventData=JSON.parse(_));const w=localStorage.getItem(g);w&&(this.anonId=w)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const n=r.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),_=this.anonId;if(n&&_)try{localStorage.setItem(g,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,u,g,_){if(!r.e.EVENTS_URL)return;const w=De(r.e.EVENTS_URL);w.params.push(`access_token=${_||r.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(n).toISOString()},L=u?r.h(S,u):S,M={url:et(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=r.p(M,V=>{this.pendingRequest=null,g(V),this.saveEventData(),this.processRequests(_)})}queueRequest(n,u){this.queue.push(n),this.processRequests(u)}}const Qt=new class extends pt{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,n){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(u=>r.j(u)||r.k(u))&&this.queueRequest(Date.now(),n)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=bt(r.e.ACCESS_TOKEN),u=n?n.u:r.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),g=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),S=new Date(_),L=(_-this.eventData.lastSuccess)/864e5;g=g||L>=1||L<-1||w.getDate()!==S.getDate()}else g=!0;g?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ye,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=_,this.eventData.tokenU=u)},p):this.processRequests()}},Ie=Qt.postTurnstileEvent.bind(Qt),ot=new class extends pt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,n,u,g){this.skuToken=n,this.errorCb=g,r.e.EVENTS_URL&&(u||r.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(Me)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ye,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):n&&(this.success[n]=!0)},p))}remove(){this.errorCb=null}},ut=ot.postMapLoadEvent.bind(ot),mt=new class extends pt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let n=this.mapInstanceIdMap.get(p);return n||(n=r.u(),this.mapInstanceIdMap.set(p,n)),n}getEventId(p){const n=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,n+1),n}postStyleLoadEvent(p,n){const{map:u,style:g,importedStyles:_}=n;if(!r.e.EVENTS_URL||!p&&!r.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(u),S={mapInstanceId:w,eventId:this.getEventId(w),style:g};_.length&&(S.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:S},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:u}=this.queue.shift();this.postEvent(n,u,()=>{},p)}},Ct=mt.postStyleLoadEvent.bind(mt),rt=new class extends pt{constructor(){super("gljs.performance")}postPerformanceEvent(p,n){r.e.EVENTS_URL&&(p||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:u}=this.queue.shift(),g=function(_){const w=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),L=function(te){const de={};if(te){for(const ue in te)if(ue!=="other")for(const ge of te[ue]){const _e=`${ue}ResolveRangeMin`,Te=`${ue}ResolveRangeMax`,Ne=`${ue}RequestCount`,Qe=`${ue}RequestCachedCount`;de[_e]=Math.min(de[_e]||1/0,ge.startTime),de[Te]=Math.max(de[Te]||-1/0,ge.responseEnd);const at=st=>{de[st]===void 0&&(de[st]=0),++de[st]};ge.transferSize!==void 0&&ge.transferSize===0&&at(Qe),at(Ne)}}return de}(function(te,de){const ue={};if(te)for(const ge of te){const _e=de(ge);ue[_e]===void 0&&(ue[_e]=[]),ue[_e].push(ge)}return ue}(w,B)),M=window.devicePixelRatio,V=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=V?V.effectiveType:void 0,J={counters:[],metadata:[],attributes:[]},Z=(te,de,ue)=>{ue!=null&&te.push({name:de,value:ue.toString()})};for(const te in L)Z(J.counters,te,L[te]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(Z(J.counters,"interactionRangeMin",_.interactionRange[0]),Z(J.counters,"interactionRangeMax",_.interactionRange[1])),S)for(const te of Object.keys(b)){const de=b[te],ue=S.find(ge=>ge.name===de);ue&&Z(J.counters,de,ue.startTime)}return Z(J.counters,"visibilityHidden",_.visibilityHidden),Z(J.attributes,"style",function(te){if(te)for(const de of te){const ue=de.name.split("?")[0];if(r.i(ue)){const ge=ue.split("/").slice(-2);if(ge.length===2)return`mapbox://styles/${ge[0]}/${ge[1]}`}}}(w)),Z(J.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),Z(J.attributes,"fogEnabled",_.fogEnabled?"true":"false"),Z(J.attributes,"projection",_.projection),Z(J.attributes,"zoom",_.zoom),Z(J.metadata,"devicePixelRatio",M),Z(J.metadata,"connectionEffectiveType",Y),Z(J.metadata,"navigatorUserAgent",navigator.userAgent),Z(J.metadata,"screenWidth",window.screen.width),Z(J.metadata,"screenHeight",window.screen.height),Z(J.metadata,"windowWidth",window.innerWidth),Z(J.metadata,"windowHeight",window.innerHeight),Z(J.metadata,"mapWidth",_.width/M),Z(J.metadata,"mapHeight",_.height/M),Z(J.metadata,"webglRenderer",_.renderer),Z(J.metadata,"webglVendor",_.vendor),Z(J.metadata,"sdkVersion",y),Z(J.metadata,"sdkIdentifier","mapbox-gl-js"),J}(u);for(const _ of g.metadata);for(const _ of g.counters);for(const _ of g.attributes);this.postEvent(n,g,()=>{},p)}},Bt=rt.postPerformanceEvent.bind(rt),tt=new class extends pt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,n,u,g){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const _=De(r.e.API_URL+r.e.SESSION_PATH);_.params.push(`sku=${n||""}`),_.params.push(`access_token=${g||r.e.ACCESS_TOKEN||""}`);const w={url:et(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(w,S=>{this.pendingRequest=null,u(S),this.saveEventData(),this.processRequests(g)})}getSessionAPI(p,n,u,g){this.skuToken=n,this.errorCb=g,r.e.SESSION_PATH&&r.e.API_URL&&(u||r.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(Me)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):n&&(this.success[n]=!0)},p)}remove(){this.errorCb=null}},Ut=tt.getSessionAPI.bind(tt),Ai=new Set;function qe(p,n){n?Ai.add(p):Ai.delete(p)}class Ke{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,u){this._updatedSourceCaches[n]=u,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const u=n.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(n.id),this.setDirty()}removeLayer(n){const u=n.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][n.id]=n,this._updatedLayers[u].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const u in this._updatedLayers)n[u]=n[u]||{},n[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)n[u]=n[u]||{},n[u].removedIds=Object.keys(this._removedLayers[u]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(n){return this._updatedImages[n]?Array.from(this._updatedImages[n].values()):[]}updateImage(n,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(r.I.toString(n)),this.setDirty()}resetUpdatedImages(n){this._updatedImages[n]&&this._updatedImages[n].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Pt(p){const{userImage:n}=p;return!!(n&&n.render&&n.render())&&(p.data.replace(new Uint8Array(n.data.buffer)),!0)}class It extends r.E{constructor(n){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=n,n!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}addScope(n){this.loaded.set(n,!1),this.imageProviders.set(n,new Map),this.images.set(n,new Map),this.updatedImages.set(n,new Set),this.callbackDispatchedThisFrame.set(n,new Set),this.patterns.set(n,new Map),this.atlasImage.set(n,new r.r({width:1,height:1}))}removeScope(n){this.loaded.delete(n),this.imageProviders.delete(n),this.images.delete(n),this.updatedImages.delete(n),this.callbackDispatchedThisFrame.delete(n),this.patterns.delete(n),this.atlasImage.delete(n);const u=this.atlasTexture.get(n);u&&(u.destroy(),this.atlasTexture.delete(n))}addImageProvider(n,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(n.id,n)}removeImageProvider(n,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(n)}getPendingImageProviders(){const n=[];for(const u of this.imageProviders.values())for(const g of u.values())g.hasPendingRequests()&&n.push(g);return n}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.y),this._imageRasterizer}isLoaded(){for(const n of this.loaded.keys())if(!this.loaded.get(n))return!1;return!0}setLoaded(n,u){if(this.loaded.get(u)!==n&&(this.loaded.set(u,n),n)){for(const{ids:g,callback:_}of this.requestors)this._notify(g,u,_);this.requestors=[]}}hasImage(n,u){return!!this.getImage(n,u)}getImage(n,u){return this.images.get(u).get(n.toString())}addImage(n,u,g){this._validate(n,g)&&this.images.get(u).set(n.toString(),g)}_validate(n,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "content" value`))),g=!1),g}_validateStretch(n,u){if(!n)return!0;let g=0;for(const _ of n){if(_[0]<g||_[1]<_[0]||u<_[1])return!1;g=_[1]}return!0}_validateContent(n,u){return n?n.length!==4||!u.usvg&&(n[0]<0||u.data.width<n[0]||n[1]<0||u.data.height<n[1]||n[2]<0||u.data.width<n[2]||n[3]<0||u.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,u,g){const _=this.images.get(u).get(n.toString());g.version=_.version+1,this.images.get(u).set(n.toString(),g),this.updatedImages.get(u).add(n),this.removeFromImageRasterizerCache(n,u)}clearUpdatedImages(n){this.updatedImages.get(n).clear()}removeFromImageRasterizerCache(n,u){this.spriteFormat!=="raster"&&(r.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([n],u))}removeImage(n,u){const g=this.images.get(u),_=g.get(n.toString());g.delete(n.toString()),this.patterns.get(u).delete(n.toString()),this.removeFromImageRasterizerCache(n,u),_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(n){return Array.from(this.images.get(n).keys()).map(u=>r.I.from(u))}getImages(n,u,g){const _=[],w=[],S=this.imageProviders.get(u);for(const Y of n){if(!Y.iconsetId){_.push(Y);continue}const J=S.get(Y.iconsetId);J&&(this.getImage(Y,u)?w.push(Y):J.addPendingRequest(Y))}if(_.length===0)return void this._notify(w,u,g);let L=!0;const M=!!this.loaded.get(u),V=this.images.get(u);if(!M)for(const Y of _)V.has(Y.toString())||(L=!1);M||L?this._notify(_,u,g):this.requestors.push({ids:_,scope:u,callback:g})}rasterizeImages(n,u){const g=new Map,{tasks:_,scope:w}=n;for(const[S,L]of _.entries()){const M=this.getImage(L.id,w);M&&g.set(S,{image:M,imageVariant:L})}this._rasterizeImages(w,g,u)}_rasterizeImages(n,u,g){if(r.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:n},g);else{const _=new Map;for(const[w,{image:S,imageVariant:L}]of u.entries())_.set(w,this.imageRasterizer.rasterize(L,S,n,0));g(void 0,_)}}getUpdatedImages(n){return this.updatedImages.get(n)||new Set}_notify(n,u,g){const _=this.images.get(u),w=new Map;for(const S of n){if(!_.get(S.toString())){if(S.iconsetId)continue;this.fire(new r.A("styleimagemissing",{id:S.name}))}const L=_.get(S.toString());if(!L){r.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const M={data:L.usvg?null:L.data.clone(),pixelRatio:L.pixelRatio,sdf:L.sdf,usvg:L.usvg,version:L.version,stretchX:L.stretchX,stretchY:L.stretchY,content:L.content,hasRenderCallback:!!(L.userImage&&L.userImage.render)};L.usvg&&Object.assign(M,{width:L.icon.usvg_tree.width,height:L.icon.usvg_tree.height}),w.set(r.I.toString(S),M)}g(null,w)}getPixelSize(n){const{width:u,height:g}=this.atlasImage.get(n);return{width:u,height:g}}getPattern(n,u,g){const _=n.toString(),w=this.patterns.get(u),S=w.get(_),L=this.getImage(n,u);if(!L)return null;if(S){if(S.position.version===L.version)return S.position;S.position.version=L.version}else{if(L.usvg&&!L.data){const M=this.getPatternInFlightId(_,u);if(this.patternsInFlight.has(M))return null;this.patternsInFlight.add(M);const V=new r.B(n).scaleSelf(r.q.devicePixelRatio),Y=new Map([[V.toString(),{image:L,imageVariant:V}]]);return this._rasterizeImages(u,Y,(J,Z)=>this.storePatternImage(V,u,L,g,Z)),null}this.storePattern(n,u,L)}return this._updatePatternAtlas(u,g),w.get(_).position}getPatternInFlightId(n,u){return r.C(n,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(n,u,g,_,w){const S=n.toString(),L=w?w.get(S):void 0;L&&(g.data=L,this.storePattern(n.id,u,g),this._updatePatternAtlas(u,_),this.patternsInFlight.delete(this.getPatternInFlightId(n.id.toString(),u)))}storePattern(n,u,g){const _={w:g.data.width+2*r.F,h:g.data.height+2*r.F,x:0,y:0},w=new r.G(_,g,r.F);this.patterns.get(u).set(n.toString(),{bin:_,position:w})}bind(n,u){const g=n.gl;let _=this.atlasTexture.get(u);_?this.dirty&&(_.update(this.atlasImage.get(u)),this.dirty=!1):(_=new r.T(n,this.atlasImage.get(u),g.RGBA8),this.atlasTexture.set(u,_)),_.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(n,u){const g=this.patterns.get(n),_=Array.from(g.values()).map(({bin:V})=>V),{w,h:S}=r.H(_),L=this.atlasImage.get(n);L.resize({width:w||1,height:S||1});const M=this.images.get(n);for(const[V,{bin:Y,position:J}]of g.entries()){let Z=J.padding;const te=Y.x+Z,de=Y.y+Z,ue=M.get(V).data,ge=ue.width,_e=ue.height;Z=Z>1?Z-1:Z,r.r.copy(ue,L,{x:0,y:0},{x:te,y:de},{width:ge,height:_e},u),r.r.copy(ue,L,{x:0,y:_e-Z},{x:te,y:de-Z},{width:ge,height:Z},u),r.r.copy(ue,L,{x:0,y:0},{x:te,y:de+_e},{width:ge,height:Z},u),r.r.copy(ue,L,{x:ge-Z,y:0},{x:te-Z,y:de},{width:Z,height:_e},u),r.r.copy(ue,L,{x:0,y:0},{x:te+ge,y:de},{width:Z,height:_e},u),r.r.copy(ue,L,{x:ge-Z,y:_e-Z},{x:te-Z,y:de-Z},{width:Z,height:Z},u),r.r.copy(ue,L,{x:0,y:_e-Z},{x:te+ge,y:de-Z},{width:Z,height:Z},u),r.r.copy(ue,L,{x:0,y:0},{x:te+ge,y:de+_e},{width:Z,height:Z},u),r.r.copy(ue,L,{x:ge-Z,y:0},{x:te-Z,y:de+_e},{width:Z,height:Z},u)}this.dirty=!0}beginFrame(){for(const n of this.images.keys())this.callbackDispatchedThisFrame.set(n,new Set)}dispatchRenderCallbacks(n,u){const g=this.images.get(u);for(const _ of n){if(this.callbackDispatchedThisFrame.get(u).has(_.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(_.toString());const w=g.get(_.toString());Pt(w)&&this.updateImage(_,u,w)}}}function Ze(p){const n=p.key,u=p.value,g=p.valueSpec||{},_=p.objectElementValidators||{},w=p.style,S=p.styleSpec;let L=[];const M=r.J(u);if(M!=="object")return[new r.V(n,u,`object expected, ${M} found`)];for(const V in u){const Y=V.split(".")[0];let J;_[Y]?J=_[Y]:g[Y]?J=Ur:_["*"]?J=_["*"]:g["*"]&&(J=Ur),J?L=L.concat(J({key:(n&&`${n}.`)+V,value:u[V],valueSpec:g[Y]||g["*"],style:w,styleSpec:S,object:u,objectKey:V},u)):L.push(new r.K(n,u[V],`unknown property "${V}"`))}for(const V in g)_[V]||g[V].required&&g[V].default===void 0&&u[V]===void 0&&L.push(new r.V(n,u,`missing required property "${V}"`));return L}function yi(p){const n=p.value,u=p.valueSpec,g=p.style,_=p.styleSpec,w=p.key,S=p.arrayElementValidator||Ur;if(r.J(n)!=="array")return[new r.V(w,n,`array expected, ${r.J(n)} found`)];if(u.length&&n.length!==u.length)return[new r.V(w,n,`array length ${u.length} expected, length ${n.length} found`)];if(u["min-length"]&&n.length<u["min-length"])return[new r.V(w,n,`array length at least ${u["min-length"]} expected, length ${n.length} found`)];let L={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};_.$version<7&&(L.function=u.function),r.J(u.value)==="object"&&(L=u.value);let M=[];for(let V=0;V<n.length;V++)M=M.concat(S({array:n,arrayIndex:V,value:n[V],valueSpec:L,style:g,styleSpec:_,key:`${w}[${V}]`},!0));return M}function bi(p){const n=p.key,u=p.value,g=p.valueSpec;let _=r.J(u);if(_==="number"&&u!=u&&(_="NaN"),_!=="number")return[new r.V(n,u,`number expected, ${_} found`)];if("minimum"in g){let w=g.minimum;if(r.J(g.minimum)==="array"&&(w=g.minimum[p.arrayIndex]),u<w)return[new r.V(n,u,`${u} is less than the minimum value ${w}`)]}if("maximum"in g){let w=g.maximum;if(r.J(g.maximum)==="array"&&(w=g.maximum[p.arrayIndex]),u>w)return[new r.V(n,u,`${u} is greater than the maximum value ${w}`)]}return[]}function Kt(p){const n=p.valueSpec,u=r.M(p.value.type);let g,_,w,S={};const L=u!=="categorical"&&p.value.property===void 0,M=!L,V=r.J(p.value.stops)==="array"&&r.J(p.value.stops[0])==="array"&&r.J(p.value.stops[0][0])==="object",Y=Ze({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(te){if(u==="identity")return[new r.V(te.key,te.value,'identity function may not have a "stops" property')];let de=[];const ue=te.value;return de=de.concat(yi({key:te.key,value:ue,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:J})),r.J(ue)==="array"&&ue.length===0&&de.push(new r.V(te.key,ue,"array must have at least one stop")),de},default:function(te){return Ur({key:te.key,value:te.value,valueSpec:n,style:te.style,styleSpec:te.styleSpec})}}});return u==="identity"&&L&&Y.push(new r.V(p.key,p.value,'missing required property "property"')),u==="identity"||p.value.stops||Y.push(new r.V(p.key,p.value,'missing required property "stops"')),u==="exponential"&&p.valueSpec.expression&&!r.N(p.valueSpec)&&Y.push(new r.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(M&&!r.O(p.valueSpec)?Y.push(new r.V(p.key,p.value,"property functions not supported")):L&&!r.Q(p.valueSpec)&&Y.push(new r.V(p.key,p.value,"zoom functions not supported"))),u!=="categorical"&&!V||p.value.property!==void 0||Y.push(new r.V(p.key,p.value,'"property" property is required')),Y;function J(te){let de=[];const ue=te.value,ge=te.key;if(r.J(ue)!=="array")return[new r.V(ge,ue,`array expected, ${r.J(ue)} found`)];if(ue.length!==2)return[new r.V(ge,ue,`array length 2 expected, length ${ue.length} found`)];if(V){if(r.J(ue[0])!=="object")return[new r.V(ge,ue,`object expected, ${r.J(ue[0])} found`)];if(ue[0].zoom===void 0)return[new r.V(ge,ue,"object stop key must have zoom")];if(ue[0].value===void 0)return[new r.V(ge,ue,"object stop key must have value")];const _e=r.M(ue[0].zoom);if(typeof _e!="number")return[new r.V(ge,ue[0].zoom,"stop zoom values must be numbers")];if(w&&w>_e)return[new r.V(ge,ue[0].zoom,"stop zoom values must appear in ascending order")];_e!==w&&(w=_e,_=void 0,S={}),de=de.concat(Ze({key:`${ge}[0]`,value:ue[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:bi,value:Z}}))}else de=de.concat(Z({key:`${ge}[0]`,value:ue[0],style:te.style,styleSpec:te.styleSpec},ue));return r.S(r.U(ue[1]))?de.concat([new r.V(`${ge}[1]`,ue[1],"expressions are not allowed in function stops.")]):de.concat(Ur({key:`${ge}[1]`,value:ue[1],valueSpec:n,style:te.style,styleSpec:te.styleSpec}))}function Z(te,de){const ue=r.J(te.value),ge=r.M(te.value),_e=te.value!==null?te.value:de;if(g){if(ue!==g)return[new r.V(te.key,_e,`${ue} stop domain type must match previous stop domain type ${g}`)]}else g=ue;if(ue!=="number"&&ue!=="string"&&ue!=="boolean"&&typeof ge!="number"&&typeof ge!="string"&&typeof ge!="boolean")return[new r.V(te.key,_e,"stop domain value must be a number, string, or boolean")];if(ue!=="number"&&u!=="categorical"){let Te=`number expected, ${ue} found`;return r.O(n)&&u===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(te.key,_e,Te)]}return u!=="categorical"||ue!=="number"||typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge?u!=="categorical"&&ue==="number"&&typeof ge=="number"&&typeof _=="number"&&_!==void 0&&ge<_?[new r.V(te.key,_e,"stop domain values must appear in ascending order")]:(_=ge,u==="categorical"&&ge in S?[new r.V(te.key,_e,"stop domain values must be unique")]:(S[ge]=!0,[])):[new r.V(te.key,_e,`integer expected, found ${String(ge)}`)]}}function di(p){const n=(p.expressionContext==="property"?r.W:r.X)(r.U(p.value),p.valueSpec);if(n.result==="error")return n.value.map(g=>new r.V(`${p.key}${g.key}`,p.value,g.message));const u=n.value.expression||n.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!u.outputDefined())return[new r.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!r.Y(u))return[new r.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return pi(u,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!r.Z(u,["zoom","feature-state"]))return[new r.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!r._(u))return[new r.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function pi(p,n){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const _ of n.valueSpec.expression.parameters)u.delete(_);if(u.size===0)return[];const g=[];return p instanceof r.$&&u.has(p.name)?[new r.V(n.key,n.value,`["${p.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(p.eachChild(_=>{g.push(...pi(_,n))}),g)}function Ri(p){const n=p.key,u=p.value,g=p.valueSpec,_=[];return Array.isArray(g.values)?g.values.indexOf(r.M(u))===-1&&_.push(new r.V(n,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(r.M(u))===-1&&_.push(new r.V(n,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),_}function Oi(p){return r.a1(r.U(p.value))?di(r.L({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Ji(p)}function Ji(p){const n=p.value,u=p.key;if(r.J(n)!=="array")return[new r.V(u,n,`array expected, ${r.J(n)} found`)];const g=p.styleSpec;let _,w=[];if(n.length<1)return[new r.V(u,n,"filter array must have at least 1 element")];switch(w=w.concat(Ri({key:`${u}[0]`,value:n[0],valueSpec:g.filter_operator,style:p.style,styleSpec:p.styleSpec})),r.M(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&r.M(n[1])==="$type"&&w.push(new r.V(u,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&w.push(new r.V(u,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(_=r.J(n[1]),_!=="string"&&w.push(new r.V(`${u}[1]`,n[1],`string expected, ${_} found`)));for(let S=2;S<n.length;S++)_=r.J(n[S]),r.M(n[1])==="$type"?w=w.concat(Ri({key:`${u}[${S}]`,value:n[S],valueSpec:g.geometry_type,style:p.style,styleSpec:p.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&w.push(new r.V(`${u}[${S}]`,n[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<n.length;S++)w=w.concat(Ji({key:`${u}[${S}]`,value:n[S],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":_=r.J(n[1]),n.length!==2?w.push(new r.V(u,n,`filter array for "${n[0]}" operator must have 2 elements`)):_!=="string"&&w.push(new r.V(`${u}[1]`,n[1],`string expected, ${_} found`))}return w}function ar(p,n){const u=p.key,g=p.style,_=p.layer,w=p.styleSpec,S=p.value,L=p.objectKey,M=w[`${n}_${p.layerType}`];if(!M)return[];const V=L.match(/^(.*)-use-theme$/);if(n==="paint"&&V&&M[V[1]])return r.S(S)?[].concat(Ur({key:p.key,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:L})):Ur({key:u,value:S,valueSpec:{type:"string"},style:g,styleSpec:w});const Y=L.match(/^(.*)-transition$/);if(n==="paint"&&Y&&M[Y[1]]&&M[Y[1]].transition)return Ur({key:u,value:S,valueSpec:w.transition,style:g,styleSpec:w});const J=p.valueSpec||M[L];if(!J)return[new r.K(u,S,`unknown property "${L}"`)];let Z;if(r.J(S)==="string"&&r.O(J)&&!J.tokens&&(Z=/^{([^}]+)}$/.exec(S))){const de=`\`{ "type": "identity", "property": ${Z?JSON.stringify(Z[1]):'"_"'} }\``;return[new r.V(u,S,`"${L}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const te=[];if(p.layerType==="symbol")L!=="text-field"||!g||g.glyphs||g.imports||te.push(new r.V(u,S,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&r.a2(r.U(S))&&r.M(S.type)==="identity"&&te.push(new r.V(u,S,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&n==="paint"&&_&&_.layout&&_.layout.hasOwnProperty("model-id")&&r.O(J)&&(r.a3(J)||r.Q(J))){const de=r.W(r.U(S),J),ue=de.value.expression||de.value._styleExpression.expression;ue&&!r.Z(ue,["measure-light"])&&(L==="model-emissive-strength"&&r._(ue)&&r.Y(ue)||te.push(new r.V(u,S,`${L} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return te.concat(Ur({key:p.key,value:S,valueSpec:J,style:g,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:L}))}function br(p){return ar(p,"paint")}function Dr(p){return ar(p,"layout")}function Fr(p){let n=[];const u=p.value,g=p.key,_=p.style,w=p.styleSpec;u.type||u.ref||n.push(new r.V(g,u,'either "type" or "ref" is required'));let S=r.M(u.type);const L=r.M(u.ref);if(u.id){const M=r.M(u.id);for(let V=0;V<p.arrayIndex;V++){const Y=_.layers[V];r.M(Y.id)===M&&n.push(new r.V(g,u.id,`duplicate layer id "${u.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in u){let M;["type","source","source-layer","filter","layout"].forEach(V=>{V in u&&n.push(new r.V(g,u[V],`"${V}" is prohibited for ref layers`))}),_.layers.forEach(V=>{r.M(V.id)===L&&(M=V)}),M?M.ref?n.push(new r.V(g,u.ref,"ref cannot reference another ref layer")):S=r.M(M.type):typeof L=="string"&&n.push(new r.V(g,u.ref,`ref layer "${L}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(u.source){const M=_.sources&&_.sources[u.source],V=M&&r.M(M.type);M?V==="vector"&&S==="raster"?n.push(new r.V(g,u.source,`layer "${u.id}" requires a raster source`)):V==="raster"&&S!=="raster"?n.push(new r.V(g,u.source,`layer "${u.id}" requires a vector source`)):V!=="vector"||u["source-layer"]?V==="raster-dem"&&S!=="hillshade"?n.push(new r.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):V!=="raster-array"||["raster","raster-particle"].includes(S)?S==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&V==="geojson"&&!M.lineMetrics?n.push(new r.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):S==="raster-particle"&&V!=="raster-array"&&n.push(new r.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):n.push(new r.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new r.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):n.push(new r.V(g,u.source,`source "${u.source}" not found`))}else n.push(new r.V(g,u,'missing required property "source"'));return n=n.concat(Ze({key:g,value:u,valueSpec:w.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ur({key:`${g}.type`,value:u.type,valueSpec:w.layer.type,style:p.style,styleSpec:p.styleSpec,object:u,objectKey:"type"}),filter:M=>Oi(r.L({layerType:S},M)),layout:M=>Ze({layer:u,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":V=>Dr(r.L({layerType:S},V))}}),paint:M=>Ze({layer:u,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":V=>br(r.L({layerType:S,layer:u},V))}})}})),n}function Qr(p){const n=p.value,u=p.key,g=r.J(n);return g!=="string"?[new r.V(u,n,`string expected, ${g} found`)]:[]}const ui={promoteId:function p({key:n,value:u}){if(r.J(u)==="string")return Qr({key:n,value:u});if(Array.isArray(u)){const g=[],_=r.U(u),w=r.X(_);return w.result==="error"&&w.value.forEach(S=>{g.push(new r.V(`${n}${S.key}`,null,`${S.message}`))}),r.Z(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new r.V(`${n}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const _ in u)g.push(...p({key:`${n}.${_}`,value:u[_]}));return g}}};function li(p){const n=p.value,u=p.key,g=p.styleSpec,_=p.style;if(!n.type)return[new r.V(u,n,'"type" is required')];const w=r.M(n.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(n.url||n.tiles||S.push(new r.K(u,n,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(Ze({key:u,value:n,valueSpec:g[`source_${w.replace("-","_")}`],style:p.style,styleSpec:g,objectElementValidators:ui})),S;case"geojson":if(S=Ze({key:u,value:n,valueSpec:g.source_geojson,style:_,styleSpec:g,objectElementValidators:ui}),n.cluster)for(const L in n.clusterProperties){const[M,V]=n.clusterProperties[L],Y=typeof M=="string"?[M,["accumulated"],["get",L]]:M;S.push(...di({key:`${u}.${L}.map`,value:V,expressionContext:"cluster-map"})),S.push(...di({key:`${u}.${L}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return S;case"video":return Ze({key:u,value:n,valueSpec:g.source_video,style:_,styleSpec:g});case"image":return Ze({key:u,value:n,valueSpec:g.source_image,style:_,styleSpec:g});case"canvas":return[new r.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ri({key:`${u}.type`,value:n.type,valueSpec:{values:Vi(g)}})}}function Vi(p){return p.source.reduce((n,u)=>{const g=p[u];return g.type.type==="enum"&&(n=n.concat(Object.keys(g.type.values))),n},[])}function rr(p){const n=p.value,u=p.styleSpec,g=u.light,_=p.style;let w=[];const S=r.J(n);if(n===void 0)return w;if(S!=="object")return w=w.concat([new r.V("light",n,`object expected, ${S} found`)]),w;for(const L in n){const M=L.match(/^(.*)-transition$/),V=L.match(/^(.*)-use-theme$/);w=w.concat(V&&g[V[1]]?Ur({key:L,value:n[L],valueSpec:{type:"string"},style:_,styleSpec:u}):M&&g[M[1]]&&g[M[1]].transition?Ur({key:L,value:n[L],valueSpec:u.transition,style:_,styleSpec:u}):g[L]?Ur({key:L,value:n[L],valueSpec:g[L],style:_,styleSpec:u}):[new r.V(L,n[L],`unknown property "${L}"`)])}return w}function qr(p){const n=p.value;let u=[];if(!n)return u;const g=r.J(n);if(g!=="object")return u=u.concat([new r.V("light-3d",n,`object expected, ${g} found`)]),u;const _=p.styleSpec,w=_["light-3d"],S=p.key,L=p.style,M=p.style.lights;for(const J of["type","id"])if(!(J in n))return u=u.concat([new r.V("light-3d",n,`missing property ${J} on light`)]),u;if(n.type&&M)for(let J=0;J<p.arrayIndex;J++){const Z=r.M(n.type),te=M[J];r.M(te.type)===Z&&u.push(new r.V(S,n.id,`duplicate light type "${n.type}", previously defined at line ${te.id.__line__}`))}const V=`properties_light_${n.type}`;if(!(V in _))return u=u.concat([new r.V("light-3d",n,`Invalid light type ${n.type}`)]),u;const Y=_[V];for(const J in n)if(J==="properties"){const Z=n[J],te=r.J(Z);if(te!=="object")return u=u.concat([new r.V("properties",Z,`object expected, ${te} found`)]),u;for(const de in Z){const ue=de.match(/^(.*)-transition$/),ge=de.match(/^(.*)-use-theme$/);u=u.concat(ge&&Y[ge[1]]?Ur({key:J,value:Z[de],valueSpec:{type:"string"},style:L,styleSpec:_}):ue&&Y[ue[1]]&&Y[ue[1]].transition?Ur({key:J,value:n[J],valueSpec:_.transition,style:L,styleSpec:_}):Y[de]?Ur({key:de,value:Z[de],valueSpec:Y[de],style:L,styleSpec:_}):[new r.K(p.key,Z[de],`unknown property "${de}"`)])}}else u=u.concat(w[J]?Ur({key:J,value:n[J],valueSpec:w[J],style:L,styleSpec:_}):[new r.K(J,n[J],`unknown property "${J}"`)]);return u}function _r(p){const n=p.value,u=p.key,g=p.style,_=p.styleSpec,w=_.terrain;let S=[];const L=r.J(n);if(n===void 0||L==="null")return S;if(L!=="object")return S=S.concat([new r.V("terrain",n,`object expected, ${L} found`)]),S;for(const M in n){const V=M.match(/^(.*)-transition$/),Y=M.match(/^(.*)-use-theme$/);S=S.concat(Y&&w[Y[1]]?Ur({key:M,value:n[M],valueSpec:{type:"string"},style:g,styleSpec:_}):V&&w[V[1]]&&w[V[1]].transition?Ur({key:M,value:n[M],valueSpec:_.transition,style:g,styleSpec:_}):w[M]?Ur({key:M,value:n[M],valueSpec:w[M],style:g,styleSpec:_}):[new r.K(M,n[M],`unknown property "${M}"`)])}if(n.source){const M=g.sources&&g.sources[n.source],V=M&&r.M(M.type);M?V!=="raster-dem"&&S.push(new r.V(u,n.source,`terrain cannot be used with a source of type ${String(V)}, it only be used with a "raster-dem" source type`)):S.push(new r.V(u,n.source,`source "${n.source}" not found`))}else S.push(new r.V(u,n,'terrain is missing required property "source"'));return S}function Zr(p){const n=p.value,u=p.style,g=p.styleSpec,_=g.fog;let w=[];const S=r.J(n);if(n===void 0)return w;if(S!=="object")return w=w.concat([new r.V("fog",n,`object expected, ${S} found`)]),w;for(const L in n){const M=L.match(/^(.*)-transition$/),V=L.match(/^(.*)-use-theme$/);w=w.concat(V&&_[V[1]]?Ur({key:L,value:n[L],valueSpec:{type:"string"},style:u,styleSpec:g}):M&&_[M[1]]&&_[M[1]].transition?Ur({key:L,value:n[L],valueSpec:g.transition,style:u,styleSpec:g}):_[L]?Ur({key:L,value:n[L],valueSpec:_[L],style:u,styleSpec:g}):[new r.K(L,n[L],`unknown property "${L}"`)])}return w}const io={"*":()=>[],array:yi,boolean:function(p){const n=p.value,u=p.key,g=r.J(n);return g!=="boolean"?[new r.V(u,n,`boolean expected, ${g} found`)]:[]},number:bi,color:function(p){const n=p.key,u=p.value,g=r.J(u);return g!=="string"?[new r.V(n,u,`color expected, ${g} found`)]:r.a0.parseCSSColor(u)===null?[new r.V(n,u,`color expected, "${u}" found`)]:[]},enum:Ri,filter:Oi,function:Kt,layer:Fr,object:Ze,source:li,model:r.a4,light:rr,"light-3d":qr,terrain:_r,fog:Zr,string:Qr,formatted:function(p){return Qr(p).length===0?[]:di(p)},resolvedImage:function(p){return Qr(p).length===0?[]:di(p)},projection:function(p){const n=p.value,u=p.styleSpec,g=u.projection,_=p.style;let w=[];const S=r.J(n);if(S==="object")for(const L in n)w=w.concat(Ur({key:L,value:n[L],valueSpec:g[L],style:_,styleSpec:u}));else S!=="string"&&(w=w.concat([new r.V("projection",n,`object or string expected, ${S} found`)]));return w},import:function(p){const{value:n,styleSpec:u}=p,{data:g,..._}=n;Object.defineProperty(_,"__line__",{value:n.__line__,enumerable:!1});let w=Ze(r.L({},p,{value:_,valueSpec:u.import}));return r.M(_.id)===""&&w.push(new r.V(`${p.key}.id`,_,"import id can't be an empty string")),g&&(w=w.concat(As(g,u,{key:`${p.key}.data`}))),w},iconset:function(p){const n=p.value,u=p.key,g=p.styleSpec,_=p.style;if(!n.type)return[new r.V(u,n,'"type" is required')];const w=r.M(n.type);let S=[];if(S=S.concat(Ze({key:u,value:n,valueSpec:g[`iconset_${w}`],style:_,styleSpec:g})),w==="source"&&n.source){const L=_.sources&&_.sources[n.source],M=L&&r.M(L.type);L?M!=="raster-array"&&S.push(new r.V(u,n.source,`iconset cannot be used with a source of type ${String(M)}, it only be used with a "raster-array" source type`)):S.push(new r.V(u,n.source,`source "${n.source}" not found`))}return S}};function Ur(p,n=!1){const u=p.value,g=p.valueSpec,_=p.styleSpec;if(g.expression&&r.a2(r.M(u)))return Kt(p);if(g.expression&&r.S(r.U(u)))return di(p);if(g.type&&io[g.type]){const w=io[g.type](p);return n===!0&&w.length>0&&r.J(p.value)==="array"?di(p):w}return Ze(r.L({},p,{valueSpec:g.type?_[g.type]:g}))}function ta(p){const n=p.value,u=p.key,g=Qr(p);return g.length||(n.indexOf("{fontstack}")===-1&&g.push(new r.V(u,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&g.push(new r.V(u,n,'"glyphs" url must include a "{range}" token'))),g}function As(p,n=r.a5,u={}){return Ur({key:u.key||"",value:p,valueSpec:n.$root,styleSpec:n,style:p,objectElementValidators:{glyphs:ta,"*":()=>[]}})}function ro(p,n=r.a5){return Je(As(p,n))}const zn=p=>Je(li(p)),Lr=p=>Je(rr(p)),yr=p=>Je(qr(p)),qt=p=>Je(_r(p)),Nn=p=>Je(Zr(p)),vs=p=>Je(function(n){const u=n.value,g=n.style,_=n.styleSpec,w=_.snow;let S=[];const L=r.J(u);if(u===void 0)return S;if(L!=="object")return S=S.concat([new r.V("snow",u,`object expected, ${L} found`)]),S;for(const M in u){const V=M.match(/^(.*)-transition$/);S=S.concat(V&&w[V[1]]&&w[V[1]].transition?Ur({key:M,value:u[M],valueSpec:_.transition,style:g,styleSpec:_}):w[M]?Ur({key:M,value:u[M],valueSpec:w[M],style:g,styleSpec:_}):[new r.K(M,u[M],`unknown property "${M}"`)])}return S}(p)),ia=p=>Je(function(n){const u=n.value,g=n.style,_=n.styleSpec,w=_.rain;let S=[];const L=r.J(u);if(u===void 0)return S;if(L!=="object")return S=S.concat([new r.V("rain",u,`object expected, ${L} found`)]),S;for(const M in u){const V=M.match(/^(.*)-transition$/);S=S.concat(V&&w[V[1]]&&w[V[1]].transition?Ur({key:M,value:u[M],valueSpec:_.transition,style:g,styleSpec:_}):w[M]?Ur({key:M,value:u[M],valueSpec:w[M],style:g,styleSpec:_}):[new r.K(M,u[M],`unknown property "${M}"`)])}return S}(p)),dn=p=>Je(Fr(p)),St=p=>Je(Oi(p)),me=p=>Je(br(p)),Ce=p=>Je(Dr(p)),je=p=>Je(r.a4(p));function Je(p){return p.slice().sort((n,u)=>n.line&&u.line?n.line-u.line:0)}function Ge(p,n){let u=!1;if(n&&n.length)for(const g of n)g instanceof r.K?r.w(g.message):(p.fire(new r.z(new Error(g.message))),u=!0);return u}let vt;class Rt extends r.E{constructor(n,u="flat"){super(),this._transitionable=new r.a6(vt||(vt=new r.a7({anchor:new r.a8(r.a5.light.anchor),position:new r.a9(r.a5.light.position),color:new r.a8(r.a5.light.color),intensity:new r.a8(r.a5.light.intensity)}))),this.setLight(n,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u,g={}){this._validate(Lr,n,g)||(this._transitionable.setTransitionOrValue(n),this.id=u)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g){return(!g||g.validate!==!1)&&Ge(this,n.call(ro,r.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let _t=class extends r.E{constructor(p,n,u,g,_){super(),this.scope=u,this._transitionable=new r.a6(new r.a7({source:new r.a8(r.a5.terrain.source),exaggeration:new r.a8(r.a5.terrain.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(p,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n,this.worldview=_}get(){return this._transitionable.serialize()}set(p,n){this._transitionable.setTransitionOrValue(p,n)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new r.aa(p,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const n=p.value.expression;if(!n)return null;let u=-1,g=-1,_=1;for(const w of n.zoomStops)_=n.evaluate(new r.aa(w,{worldview:this.worldview})),_>.01?(u=w,g=-1):g=w;return _<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof r.ab}};const Ot=45,ii=65,Nt=.05;function Fi(p,n,u,g){const _=r.af(Ot,ii,u),[w,S]=er(p,g);let L=1-Math.min(1,Math.exp((n-w)/(S-w)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*_*p.alpha}function er(p,n){const u=.5/Math.tan(.5*n);return[p.range[0]+u,p.range[1]+u]}function nr(p,n,u,g,_){const w=r.ad([],[n,u,g],_.mercatorFogMatrix);return Fi(p,r.ae(w),_.pitch,_._fov)}function Sr(p,n,u,g,_,w,S){const L=[[u,g,0],[_,g,0],[_,w,0],[u,w,0]];let M=Number.MAX_VALUE,V=-Number.MAX_VALUE;for(const Y of L){const J=r.ad([],Y,n),Z=r.ae(J);M=Math.min(M,Z),V=Math.max(V,Z)}return[Fi(p,M,S.pitch,S._fov),Fi(p,V,S.pitch,S._fov)]}class Mr extends r.E{constructor(n,u,g,_){super();const w=new r.a7({range:new r.a8(r.a5.fog.range),color:new r.a8(r.a5.fog.color),"color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a8(r.a5.fog["high-color"]),"high-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a8(r.a5.fog["space-color"]),"space-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a8(r.a5.fog["horizon-blend"]),"star-intensity":new r.a8(r.a5.fog["star-intensity"]),"vertical-range":new r.a8(r.a5.fog["vertical-range"])});this._transitionable=new r.a6(w,g,new Map(_)),this.set(n,_),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new r.ag(w),this.scope=g}get state(){const n=this._transform,u=n.projection.name==="globe",g=r.ah(n.zoom),_=this.properties.get("range"),w=[.5,3];return{range:u?[r.ai(w[0],_[0],g),r.ai(w[1],_[1],g)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,u,g={}){if(this._validate(Nn,n,g))return;const _=r.h({},n);for(const w of Object.keys(r.a5.fog))_[w]===void 0&&(_[w]=r.a5.fog[w].default);this._options=_,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.af(Ot,ii,n))*u.a}getOpacityAtLatLng(n,u){return this._transform.projection.supportsFog?function(g,_,w){const S=r.ac.fromLngLat(_),L=w.elevation?w.elevation.getAtPointOrZero(S):0;return nr(g,S.x,S.y,L,w)}(this.state,n,u):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Sr(this.state,u,0,0,r.aj,r.aj,this._transform)}getOpacityForBounds(n,u,g,_,w){return this._transform.projection.supportsFog?Sr(this.state,n,u,g,_,w,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?er(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const _=n.points[g];let w;if(_[2]>=0)w=_;else{const S=n.points[g-4];w=r.ak(S,_,S[2]/(S[2]-_[2]))}if(nr(this.state,w[0],w[1],0,this._transform)>=Nt)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g){return(!g||g.validate!==!1)&&Ge(this,n.call(ro,r.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let jr,nn,Yr,Wn,fs=class extends r.E{constructor(p,n,u,g){super();const _=jr||(jr=new r.a7({density:new r.a8(r.a5.snow.density),intensity:new r.a8(r.a5.snow.intensity),color:new r.a8(r.a5.snow.color),opacity:new r.a8(r.a5.snow.opacity),vignette:new r.a8(r.a5.snow.vignette),"vignette-color":new r.a8(r.a5.snow["vignette-color"]),"center-thinning":new r.a8(r.a5.snow["center-thinning"]),direction:new r.a8(r.a5.snow.direction),"flake-size":new r.a8(r.a5.snow["flake-size"])}));this._transitionable=new r.a6(_,u,new Map(g)),this.set(p,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(_),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),g=r.al(u[0]),_=-Math.max(r.al(u[1]),.01),w=[Math.cos(g)*Math.cos(_),Math.sin(g)*Math.cos(_),Math.sin(_)],S=this.properties.get("vignette"),L=this.properties.get("vignette-color");return L.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(n.r,n.g,n.b,n.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:L}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(vs,p,u))return;const g=r.h({},p);for(const _ of Object.keys(r.a5.snow))g[_]===void 0&&(g[_]=r.a5.snow[_].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Ge(this,p.call(ro,r.h({value:n,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}},ps=class extends r.E{constructor(p,n,u,g){super();const _=nn||(nn=new r.a7({density:new r.a8(r.a5.rain.density),intensity:new r.a8(r.a5.rain.intensity),color:new r.a8(r.a5.rain.color),opacity:new r.a8(r.a5.rain.opacity),vignette:new r.a8(r.a5.rain.vignette),"vignette-color":new r.a8(r.a5.rain["vignette-color"]),"center-thinning":new r.a8(r.a5.rain["center-thinning"]),direction:new r.a8(r.a5.rain.direction),"droplet-size":new r.a8(r.a5.rain["droplet-size"]),"distortion-strength":new r.a8(r.a5.rain["distortion-strength"])}));this._transitionable=new r.a6(_,u,new Map(g)),this.set(p,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(_),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),g=r.al(u[0]),_=-Math.max(r.al(u[1]),.01),w=[Math.cos(g)*Math.cos(_),Math.sin(g)*Math.cos(_),Math.sin(_)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(n.r,n.g,n.b,n.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(ia,p,u))return;const g=r.h({},p);for(const _ of Object.keys(r.a5.rain))g[_]===void 0&&(g[_]=r.a5.rain[_].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Ge(this,p.call(ro,r.h({value:n,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}};class Sn extends r.E{constructor(n,u,g,_){super(),this.scope=g,this._options=n,this.properties=new r.ag(u),this._transitionable=new r.a6(u,g,new Map(_)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,u){this._options=n,this._transitionable.setTransitionOrValue(n.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class En{constructor(n,u,g,_){this.screenBounds=n,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(n,u){let g,_;if(n instanceof r.P||typeof n[0]=="number"){const w=r.P.convert(n);g=[w],_=u.isPointAboveHorizon(w)}else{const w=r.P.convert(n[0]),S=r.P.convert(n[1]),L=w.add(S)._div(2);g=[w,S],_=r.ao(w,S).every(M=>u.isPointAboveHorizon(M))&&u.isPointAboveHorizon(L)}return new En(g,u.getCameraPoint(),_,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return r.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],_=r.ao(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?_[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(_[3]=this.cameraPoint)),r.ap(_,n)}bufferedCameraGeometryGlobe(n){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],_=r.ao(u,g,n),w=this.cameraPoint.clone();switch(3*((w.y>u.y)+(w.y>g.y))+((w.x>u.x)+(w.x>g.x))){case 0:_[0]=w,_[4]=w.clone();break;case 1:_.splice(1,0,w);break;case 2:_[1]=w;break;case 3:_.splice(4,0,w);break;case 5:_.splice(2,0,w);break;case 6:_[3]=w;break;case 7:_.splice(3,0,w);break;case 8:_[2]=w}return _}containsTile(n,u,g,_=0){const w=n.queryPadding/u._pixelsPerMercatorPixel+1,S=g?this._bufferedCameraMercator(w,u):this._bufferedScreenMercator(w,u);let L=n.tileID.wrap+(S.unwrapped?_:0);const M=S.polygon.map(ge=>r.aq(n.tileTransform,ge,L));if(!r.ar(M,0,0,r.aj,r.aj))return;L=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const V=this.screenGeometryMercator.polygon.map(ge=>r.as(n.tileTransform,ge,L)),Y=V.map(ge=>new r.P(ge[0],ge[1])),J=u.getFreeCameraOptions().position||new r.ac(0,0,0),Z=r.as(n.tileTransform,J,L),te=V.map(ge=>{const _e=r.at(ge,ge,Z);return r.au(_e,_e),new r.av(Z,_e)}),de=r.aw(n,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:te,bufferedTilespaceGeometry:M,bufferedTilespaceBounds:(ue=r.ax(M),ue.min.x=r.ay(ue.min.x,0,r.aj),ue.min.y=r.ay(ue.min.y,0,r.aj),ue.max.x=r.ay(ue.max.x,0,r.aj),ue.max.y=r.ay(ue.max.y,0,r.aj),ue),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:de};var ue}_bufferedScreenMercator(n,u){const g=cs(n);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),u):{polygon:this.bufferedScreenGeometry(n).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[g]=_,_}}_bufferedCameraMercator(n,u){const g=cs(n);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),u):{polygon:this.bufferedCameraGeometry(n).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[g]=_,_}}_projectAndResample(n,u){const g=function(w,S){const L=r.az([],S.pixelMatrix,S.globeMatrix),M=[0,-r.aB,0,1],V=[0,r.aB,0,1],Y=[0,0,0,1];r.aA(M,M,L),r.aA(V,V,L),r.aA(Y,Y,L);const J=new r.P(M[0]/M[3],M[1]/M[3]),Z=new r.P(V[0]/V[3],V[1]/V[3]),te=r.aC(w,J)&&M[3]<Y[3],de=r.aC(w,Z)&&V[3]<Y[3];if(!te&&!de)return null;const ue=function(it,Xe,lt){for(let dt=1;dt<it.length;dt++){const kt=_s(Xe.pointCoordinate3D(it[dt-1]).x),Dt=_s(Xe.pointCoordinate3D(it[dt]).x);if(lt<0){if(kt<Dt)return{idx:dt,t:-kt/(Dt-1-kt)}}else if(Dt<kt)return{idx:dt,t:(1-kt)/(Dt+1-kt)}}return null}(w,S,te?-1:1);if(!ue)return null;const{idx:ge,t:_e}=ue;let Te=ge>1?Is(w.slice(0,ge),S):[],Ne=ge<w.length?Is(w.slice(ge),S):[];Te=Te.map(it=>new r.P(_s(it.x),it.y)),Ne=Ne.map(it=>new r.P(_s(it.x),it.y));const Qe=[...Te];Qe.length===0&&Qe.push(Ne[Ne.length-1]);const at=r.ai(Qe[Qe.length-1].y,(Ne.length===0?Te[0]:Ne[0]).y,_e);let st;return st=te?[new r.P(0,at),new r.P(0,0),new r.P(1,0),new r.P(1,at)]:[new r.P(1,at),new r.P(1,1),new r.P(0,1),new r.P(0,at)],Qe.push(...st),Ne.length===0?Qe.push(Te[0]):Qe.push(...Ne),{polygon:Qe.map(it=>new r.ac(it.x,it.y)),unwrapped:!1}}(n,u);if(g)return g;const _=function(w,S){let L=!1,M=-1/0,V=0;for(let J=0;J<w.length-1;J++)w[J].x>M&&(M=w[J].x,V=J);for(let J=0;J<w.length-1;J++){const Z=(V+J)%(w.length-1),te=w[Z],de=w[Z+1];Math.abs(te.x-de.x)>.5&&(te.x<de.x?(te.x+=1,Z===0&&(w[w.length-1].x+=1)):(de.x+=1,Z+1===w.length-1&&(w[0].x+=1)),L=!0)}const Y=r.aD(S.center.lng);return L&&Y<Math.abs(Y-1)&&w.forEach(J=>{J.x-=1}),{polygon:w,unwrapped:L}}(Is(n,u).map(w=>new r.P(_s(w.x),w.y)),u);return{polygon:_.polygon.map(w=>new r.ac(w.x,w.y)),unwrapped:_.unwrapped}}}function Is(p,n){return r.aE(p,u=>{const g=n.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function _s(p){return p<0?1+p%1:p%1}function cs(p){return 100*p|0}function Oo(p,n,u,g,_){const w=function(L,M){if(L)return _(L);if(M){if(p.url&&M.tiles&&p.tiles&&delete p.tiles,M.variants){if(!Array.isArray(M.variants))return _(new Error("variants must be an array"));for(const Y of M.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return _(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return _(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){M=r.h(M,Y);break}}}const V=r.aF(r.h({},M,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);V.tiles=n.canonicalizeTileset(V,p.url),_(null,V)}},S=function(L,M,V){if(!L)return null;if(!M&&!V)return L;V=V||L.worldview_default;const Y=Object.values(L.language||{});if(Y.length===0)return null;const J=Object.values(L.worldview||{});if(J.length===0)return null;const Z=Y.every(de=>de===M),te=J.every(de=>de===V);return Z&&te?L:M in(L.language_options||{})||V in(L.worldview_options||{})?null:L.language_options&&L.worldview_options?L:null}(p.data,u,g);return S?r.q.frame(()=>w(null,S)):p.url?r.n(n.transformRequest(n.normalizeSourceURL(p.url,null,u,g),r.R.Source),w):r.q.frame(()=>{const{data:L,...M}=p;w(null,M)})}function Ra(p,n){const u=Math.pow(2,n.z),g=Math.floor(r.aD(p.getWest())*u),_=Math.floor(r.aH(p.getNorth())*u),w=Math.ceil(r.aD(p.getEast())*u),S=Math.ceil(r.aH(p.getSouth())*u);return n.x>=g&&n.x<w&&n.y>=_&&n.y<S}class Bo{constructor(n,u,g){this.bounds=n?r.aG.convert(this.validateBounds(n)):null,this.minzoom=u||0,this.maxzoom=g||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}addExtraBounds(n){if(n){this.extraBounds||(this.extraBounds=[]);for(const u of n)this.extraBounds.push(r.aG.convert(this.validateBounds(u)))}}contains(n){if(n.z>this.maxzoom||n.z<this.minzoom||this.bounds&&!Ra(this.bounds,n))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(Ra(u,n))return!0;return!1}static fromTileJSON(n){if(!n.bounds&&!n.extra_bounds)return null;const u=new Bo(n.bounds,n.minzoom,n.maxzoom);return u.addExtraBounds(n.extra_bounds),u}}class fc extends r.E{constructor(n,u,g,_){if(super(),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.h(this,r.aF(u,["url","scheme","tileSize","promoteId"])),this._options=r.h({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new r.aI}load(n){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Oo(this._options,this.map._requestManager,u,g,(_,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,_)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new r.z(_));else if(w){if(r.h(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of w.vector_layers)this.vectorLayerIds.push(S.id),w.worldview&&w.worldview[S.source]&&this.localizableLayerIds.add(S.id)}this.tileBounds=Bo.fromTileJSON(w),Ie(w.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}n&&n(_)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}loadTile(n,u){const g=n.tileID.canonical.url(this.tiles,this.scheme),_=this.map._requestManager.normalizeTileURL(g),w=this.map._requestManager.transformRequest(_,r.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,L=S?{image:S.image.clone()}:null,M={request:w,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:L,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&r.j(g)&&(M.localizableLayerIds=this.localizableLayerIds),M.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=u:n.request=n.actor.send("reloadTile",M,V.bind(this));else if(n.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",M,V.bind(this),void 0,!0);else{const Y=r.aJ.call({deduped:this._deduped},M,(J,Z)=>{J||!Z?V.call(this,J):(M.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},n.actor&&n.actor.send("loadTile",M,V.bind(this),void 0,!0))},!0);n.request={cancel:Y}}function V(Y,J){return delete n.request,n.aborted?u(null):Y&&Y.status!==404?u(Y):(J&&J.resourceTiming&&(n.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&n.setExpiryData(J),n.loadVectorData(J,this.map.painter),r.aK(this.dispatcher),u(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class us extends r.E{constructor(n,u,g,_){super(),this.id=n,this.dispatcher=g,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.h({type:"raster"},u),r.h(this,r.aF(u,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=Oo(this._options,this.map._requestManager,null,u,(g,_)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new r.z(g)):_&&(r.h(this,_),_.raster_layers&&(this.rasterLayers=_.raster_layers,this.rasterLayerIds=this.rasterLayers.map(w=>w.id)),this.tileBounds=Bo.fromTileJSON(_),Ie(_.tiles),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),n&&n(g)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,u){const g=r.q.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);n.request=r.o(this.map._requestManager.transformRequest(_,r.R.Tile),(w,S,L,M)=>(delete n.request,n.aborted?(n.state="unloaded",u(null)):w?(n.state="errored",u(w)):S?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:L,expires:M}),n.setTexture(S,this.map.painter),n.state="loaded",r.aK(this.dispatcher),void u(null)):u(null)))}abortTile(n,u){n.request&&(n.request.cancel(),delete n.request),u&&u()}unloadTile(n,u){n.texture&&n.texture instanceof r.T?(n.destroy(!0),n.texture&&n.texture instanceof r.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class pc extends us{constructor(n,u,g,_){super(n,u,g,_),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=r.h({type:"raster-array"},u)}triggerRepaint(n){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,n.tileID),this.map.triggerRepaint()}loadTile(n,u){const g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),_=this.map._requestManager.transformRequest(g,r.R.Tile),w={request:_,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};n.source=this.id,n.scope=this.scope,n.requestParams=_,n.actor||(n.actor=this.dispatcher.getActor());const S=(L,M,V,Y)=>{if(delete n.request,n.aborted)return n.state="unloaded",u(null);if(L)return L.name==="AbortError"?void 0:(n.state="errored",u(L));if(this.map._refreshExpiredTiles&&M&&n.setExpiryData({cacheControl:V,expires:Y}),this.partial)n.state="empty";else{if(!M)return u(null);n.state="loaded",n._isHeaderLoaded=!0,n._mrt=M}u(null)};n.request=this.partial?n.fetchHeader(void 0,S.bind(this)):n.actor.send("loadTile",w,S.bind(this),void 0,!0)}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){const g=n.texture;g&&g instanceof r.T?(n.destroy(!0),this.map.painter.saveTileTexture(g)):(n.destroy(),n.flushQueues(),n._isHeaderLoaded=!1,delete n._mrt,delete n.textureDescriptor),n.fbo&&(n.fbo.destroy(),delete n.fbo),delete n.request,delete n.requestParams,delete n.neighboringTiles,n.state="unloaded"}prepareTile(n,u,g){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBand(u,g,(_,w)=>{if(_)return n.state="errored",this.fire(new r.z(_)),void this.triggerRepaint(n);w&&(n._isHeaderLoaded=!0,n.setTexture(w,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:w})=>w===n),g=u&&u.fields,_=g&&g.bands&&g.bands;return _?_[0]:0}getTextureDescriptor(n,u,g){if(!n)return;const _=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!_)return;let w=null;u instanceof r.aN?w=u.paint.get("raster-array-band"):u instanceof r.aO&&(w=u.paint.get("raster-particle-array-band"));const S=w||this.getInitialBand(_);if(S!=null)if(n.textureDescriptor){if(!n.updateNeeded(_,S)||g)return Object.assign({},n.textureDescriptor,{texture:n.texture})}else this.prepareTile(n,_,S)}getImages(n,u){const g=new Map;for(const _ of n)for(const w of u){const[S,L]=w.split("/"),M=_.getLayer(S);if(!M||!M.hasBand(L)||!M.hasDataForBand(L))continue;const{bytes:V,tileSize:Y,buffer:J}=M.getBandView(L),Z=Y+2*J,te={data:new r.r({width:Z,height:Z},V),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(w,te)}return g}}const lh={vector:fc,raster:us,"raster-dem":class extends us{constructor(p,n,u,g){super(p,n,u,g),this.type="raster-dem",this.maxzoom=22,this._options=r.h({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(_,w){_&&(p.state="errored",n(_)),w&&(p.dem=w,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",n(null))}p.request=r.o(this.map._requestManager.transformRequest(u,r.R.Tile),(function(_,w,S,L){if(delete p.request,p.aborted)p.state="unloaded",n(null);else if(_)p.state="errored",n(_);else if(w){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:S,expires:L});const M=ImageBitmap&&w instanceof ImageBitmap&&r.t(),V=1-(w.width-r.aL(w.width))/2;V<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const Y=M?w:r.q.getImageData(w,V),J={uid:p.uid,tileID:p.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:V};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadTile",J,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const n=p.canonical,u=Math.pow(2,n.z),g=(n.x-1+u)%u,_=n.x===0?p.wrap-1:p.wrap,w=(n.x+1+u)%u,S=n.x+1===u?p.wrap+1:p.wrap,L={};return L[new r.aM(p.overscaledZ,_,n.z,g,n.y).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y).key]={backfilled:!1},n.y>0&&(L[new r.aM(p.overscaledZ,_,n.z,g,n.y-1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,p.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y-1).key]={backfilled:!1}),n.y+1<u&&(L[new r.aM(p.overscaledZ,_,n.z,g,n.y+1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,p.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y+1).key]={backfilled:!1}),L}},"raster-array":pc,geojson:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=n.data,this._options=r.h({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const _=r.aj/this.tileSize;this.workerOptions=r.h({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*_,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*_,extent:r.aj,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:r.aj,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*_,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new r.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new r.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const u of this._data.features)n.set(u.id,u);for(const u of p.features)n.set(u.id,u);this._data.features=[...n.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterChildren(p,n){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterLeaves(p,n,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:n,offset:u},g),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.A("dataloading",{dataType:"source"})),this._loaded=!1;const n=r.h({append:p},this.workerOptions);n.scope=this.scope;const u=this._data;typeof u=="string"?(n.request=this.map._requestManager.transformRequest(r.q.resolveURL(u),r.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(g,_)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new r.z(g));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(w.resourceTiming=_.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new r.A("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=r.C(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,n){const u=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,_=g?{image:g.image.clone()}:null,w=this._partialReload,S={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:_,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:p.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:w,worldview:this.map.getWorldview()};p.request=this.actor.send(u,S,(L,M)=>w&&!M?(p.state="loaded",n(null)):(delete p.request,p.destroy(),p.aborted?n(null):L?n(L):(p.loadVectorData(M,this.map.painter,u==="reloadTile"),n(null))),void 0,u==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,n){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aP{constructor(p,n,u,g){super(p,n,u,g),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const n of p.urls)this.urls.push(this.map._requestManager.transformRequest(n,r.R.Source).url);r.aQ(this.urls,(n,u)=>{this._loaded=!0,n?this.fire(new r.z(n)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const n=this.video.seekable;p<n.start(0)||p>n.end(0)?this.fire(new r.z(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,n=p.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(p,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aP,model:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const p=[];for(const n in this._options.models){const u=this._options.models[n],g=r.aS(this.map._requestManager.transformRequest(u.uri,r.R.Model).url).then(_=>{if(!_)return;const w=r.aT(_),S=new r.aU(n,u.position,u.orientation,w);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(_=>{this.fire(new r.z(new Error(`Could not load model ${n} from ${u.uri}: ${_.message}`)))});p.push(g)}Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(n=>{this._loaded=!0,this.fire(new r.z(new Error(`Could not load models: ${n.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,n){}serialize(){return this._options}},"batched-model":class extends r.E{constructor(p,n,u,g){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Oo(this._options,this.map._requestManager,n,u,(g,_)=>{this._tileJSONRequest=null,this._loaded=!0,g?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new r.z(g))):_&&(r.h(this,_),_.bounds&&(this.tileBounds=new Bo(_.bounds,this.minzoom,this.maxzoom)),Ie(_.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),p&&p(g)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,r.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:r.q.devicePixelRatio,promoteId:this.promoteId};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=n;else{if(p.buckets){const w=Object.values(p.buckets);for(const S of w)S.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",g,_.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",g,_.bind(this),void 0,!0);function _(w,S){return p.aborted?n(null):w&&w.status!==404?n(w):(this.map._refreshExpiredTiles&&S&&p.setExpiryData(S),p.loadModelData(S,this.map.painter),p.state="loaded",void n(null))}}serialize(){return r.h({},this._options)}},canvas:class extends r.aP{constructor(p,n,u,g){super(p,n,u,g),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(w=>typeof w!="number"))||this.fire(new r.z(new r.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.z(new r.V(`sources.${p}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new r.z(new r.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new r.z(new r.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.z(new r.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof r.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=n,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Bo(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),r.h(this,r.aF(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:n,y:u,z:g}=p.canonical;return this._implementation.hasTile({x:n,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,n){const{x:u,y:g,z:_}=p.tileID.canonical,w=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:_},{signal:w.signal})).then((function(S){return delete p.request,p.aborted?(p.state="unloaded",n(null)):S===void 0?(p.state="errored",n(null)):S===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",n(null)):function(L){return L instanceof ImageData||L instanceof HTMLCanvasElement||L instanceof ImageBitmap||L instanceof HTMLImageElement}(S)?(this.loadTileData(p,S),p.state="loaded",void n(null)):(p.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.name!=="AbortError"&&(p.state="errored",n(S))}),p.request.cancel=()=>w.abort()}loadTileData(p,n){p.setTexture(n,this.map.painter)}unloadTile(p,n){if(p.texture&&p.texture instanceof r.T?(p.destroy(!0),p.texture&&p.texture instanceof r.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:_}=p.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:_})}n&&n()}abortTile(p,n){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=r.C(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}}},gc=function(p,n,u,g){const _=new lh[n.type](p,n,u,g);if(_.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${_.id}`);return r.aV(["load","abort","unload","serialize","prepare"],_),_};function ql(p,n,u=""){return`${u}:${n.id||""}:${n.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:_,importId:w}=g;return`featureset:${_}${w?`:import:${w}`:""}`}}(p.target)}`}function zc(p,n,u,g=""){if(p.uniqueFeatureID){const _=ql(p,n,g);if(u.has(_))return!0;u.add(_)}return!1}function fl(p,n,u,g,_=!1){const w=n.sourceCache.transform,S=n.sourceCache.tilesIn(p,n.has3DLayers,_);S.sort(ku);const L=[];for(const M of S){const V=M.tile.queryRenderedFeatures(n,M,u,g,w,_);Object.keys(V).length&&L.push({wrappedTileID:M.tile.tileID.wrapped().key,queryResults:V})}return L.length===0?{}:function(M){const V={},Y={};for(const J of M){const Z=J.queryResults,te=J.wrappedTileID,de=Y[te]=Y[te]||{};for(const ue in Z){const ge=Z[ue],_e=de[ue]=de[ue]||{},Te=V[ue]=V[ue]||[];for(const Ne of ge)_e[Ne.featureIndex]||(_e[Ne.featureIndex]=!0,Te.push(Ne))}}return V}(L)}function Co(p,n,u,g,_,w){const S={},L=g.queryRenderedSymbols(p),M=[];for(const V of Object.keys(L).map(Number))M.push(_[V]);M.sort(ku);for(const V of M){const Y=V.featureIndex.lookupSymbolFeatures(L[V.bucketInstanceId],V.bucketIndex,V.sourceLayerIndex,n,u,w);for(const J in Y){const Z=S[J]=S[J]||[],te=Y[J];te.sort((de,ue)=>{const ge=V.featureSortOrder;if(ge){const _e=ge.indexOf(de.featureIndex);return ge.indexOf(ue.featureIndex)-_e}return ue.featureIndex-de.featureIndex});for(const de of te)Z.push(de)}}return S}function Ta(p,n){const u=p.getRenderableIds().map(w=>p.getTileByID(w)),g=[],_={};for(let w=0;w<u.length;w++){const S=u[w],L=S.tileID.canonical.key;_[L]||(_[L]=!0,S.querySourceFeatures(g,n))}return g}function ku(p,n){const u=p.tileID,g=n.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function pl(p,n){const u={};if(!n)return u;for(const g of p){const _=g.layerIds.map(w=>n.getLayer(w)).filter(Boolean);if(_.length!==0){g.layers=_,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(w=>_.filter(S=>S.id===w)[0]));for(const w of _)u[w.fqid]=g}}return u}const sl=32,ol=33,mc=new Uint16Array(8184);for(let p=0;p<2046;p++){let n=p+2,u=0,g=0,_=0,w=0,S=0,L=0;for(1&n?_=w=S=sl:u=g=L=sl;(n>>=1)>1;){const V=u+_>>1,Y=g+w>>1;1&n?(_=u,w=g,u=S,g=L):(u=_,g=w,_=S,w=L),S=V,L=Y}const M=4*p;mc[M+0]=u,mc[M+1]=g,mc[M+2]=_,mc[M+3]=w}const gl=new Uint16Array(2178),yc=new Uint8Array(1089),$l=new Uint16Array(1089);function Zl(p){return p===0?-.03125:p===32?.03125:0}const Ru={type:2,extent:r.aj,loadGeometry:()=>[[new r.P(0,0),new r.P(r.aj+1,0),new r.P(r.aj+1,r.aj+1),new r.P(0,r.aj+1),new r.P(0,0)]]};class cu{constructor(n,u,g,_,w,S){this.tileID=n,this.uid=r.a$(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,_&&_.style&&(this._lastUpdatedBrightness=_.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection),this.worldview=S}registerFadeDuration(n){const u=n+this.timeAdded;u<r.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,u,g){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=pl(n.buckets,u.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof r.b1){if(this.hasSymbolBuckets=!0,!g)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof r.b1&&w.hasRTLText){this.hasRTLText=!0,r.b2();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_],S=u.style.getOwnLayer(_);if(!S)continue;const L=S.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,L)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new r.b0}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,u,g){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets=Object.assign({},this.buckets,pl(n.buckets,u.style)),n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const _ in this.buckets){const w=this.buckets[_];w.uploadPending()&&w.upload(n)}const u=n.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new r.T(n,g.image,u.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(n,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(n,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(n,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const _=u.style.getBrightness();(this._lastUpdatedBrightness||_)&&(this._lastUpdatedBrightness&&_&&Math.abs(this._lastUpdatedBrightness-_)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==_),this._lastUpdatedBrightness=_))}queryRenderedFeatures(n,u,g,_,w,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const L=function(M,V){const Y=r.bn([],[.5*M.width,.5*-M.height,1]);return r.bo(Y,Y,[1,-1,0]),r.az(Y,Y,M.calculateProjMatrix(V.toUnwrapped())),Float32Array.from(Y)}(w,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:u,pixelPosMatrix:L,transform:_,availableImages:g,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(n,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const _=g.loadVTLayers(),w=u?u.sourceLayer:"",S=_._geojsonTileLayer||_[w];if(!S)return;const L=r.b3(u&&u.filter),{z:M,x:V,y:Y}=this.tileID.canonical,J={z:M,x:V,y:Y};for(let Z=0;Z<S.length;Z++){const te=S.feature(Z);if(L.needGeometry){const ge=r.b4(te,!0);if(!L.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),ge,this.tileID.canonical))continue}else if(!L.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),te))continue;const de=g.getId(te,w),ue=new r.b5(te,M,V,Y,de);ue.tile=J,n.push(ue)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const g=r.b6(n.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const g=Date.now();let _=!1;if(this.expirationTime>g)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const w=this.expirationTime-u;w?this.expirationTime=g+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}updateBuckets(n,u){if(!this.latestFeatureIndex||!n.style)return;const g=this.latestFeatureIndex.loadVTLayers(),_=n.style.listImages(),w=n.style.getBrightness();for(const S in this.buckets){if(!n.style.hasLayer(S))continue;const L=this.buckets[S],M=L.layers[0],V=M.sourceLayer||"_geojsonTileLayer",Y=g[V],J=n.style.getLayerSourceCache(M);let Z={};J&&(Z=J._state.getState(V,void 0));const te=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},de=Object.keys(Z).length>0&&!u;de&&!L.stateDependentLayers.length&&!u||L.update(Z,Y,_,te,de?L.stateDependentLayers:L.layers,u,w),(L instanceof r.b7||L instanceof r.b8)&&n._terrain&&n._terrain.enabled&&J&&L.uploadPending()&&n._terrain._clearRenderCacheForTile(J.id,this.tileID);const ue=n&&n.style&&n.style.getOwnLayer(S);ue&&(this.queryPadding=Math.max(this.queryPadding,ue.queryRadius(L)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=r.q.now()+n}setTexture(n,u){const g=u.context,_=g.gl;this.texture=this.texture||u.getTileTexture(n.width),this.texture&&this.texture instanceof r.T?this.texture.update(n):(this.texture=new r.T(g,n,_.RGBA8,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(n,u){const g={};for(const _ of u)g[_]=!0;this.dependencies[n]=g}hasDependency(n,u){for(const g of n){const _=this.dependencies[g];if(_){for(const w of u)if(_[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=r.b9(Ru,this.tileID.canonical,this.tileTransform)[0],_=new r.ba,w=new r.bb;for(let S=0;S<g.length;S++){const{x:L,y:M}=g[S];_.emplaceBack(L,M),w.emplaceBack(S)}w.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(w),this._tileDebugBuffer=n.createVertexBuffer(_,r.bc.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,_.length,w.length)}_makeTileBoundsBuffers(n,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=r.b9(Ru,this.tileID.canonical,this.tileTransform)[0];let _,w;if(this.isRaster){const S=function(L,M){const V=r.aW(L,M),Y=Math.pow(2,L.z);for(let ge=0;ge<ol;ge++)for(let _e=0;_e<ol;_e++){const Te=r.aX((L.x+(_e+Zl(_e))/sl)/Y),Ne=r.aY((L.y+(ge+Zl(ge))/sl)/Y),Qe=M.project(Te,Ne),at=ge*ol+_e;gl[2*at+0]=Math.round((Qe.x*V.scale-V.x)*r.aj),gl[2*at+1]=Math.round((Qe.y*V.scale-V.y)*r.aj)}yc.fill(0),$l.fill(0);for(let ge=2045;ge>=0;ge--){const _e=4*ge,Te=mc[_e+0],Ne=mc[_e+1],Qe=mc[_e+2],at=mc[_e+3],st=Te+Qe>>1,it=Ne+at>>1,Xe=st+it-Ne,lt=it+Te-st,dt=Ne*ol+Te,kt=at*ol+Qe,Dt=it*ol+st,ti=Math.hypot((gl[2*dt+0]+gl[2*kt+0])/2-gl[2*Dt+0],(gl[2*dt+1]+gl[2*kt+1])/2-gl[2*Dt+1])>=16;yc[Dt]=yc[Dt]||(ti?1:0),ge<1022&&(yc[Dt]=yc[Dt]||yc[(Ne+lt>>1)*ol+(Te+Xe>>1)]||yc[(at+lt>>1)*ol+(Qe+Xe>>1)])}const J=new r.aZ,Z=new r.a_;let te=0;function de(ge,_e){const Te=_e*ol+ge;return $l[Te]===0&&(J.emplaceBack(gl[2*Te+0],gl[2*Te+1],ge*r.aj/sl,_e*r.aj/sl),$l[Te]=++te),$l[Te]-1}function ue(ge,_e,Te,Ne,Qe,at){const st=ge+Te>>1,it=_e+Ne>>1;if(Math.abs(ge-Qe)+Math.abs(_e-at)>1&&yc[it*ol+st])ue(Qe,at,ge,_e,st,it),ue(Te,Ne,Qe,at,st,it);else{const Xe=de(ge,_e),lt=de(Te,Ne),dt=de(Qe,at);Z.emplaceBack(Xe,lt,dt)}}return ue(0,0,sl,sl,sl,0),ue(sl,sl,0,0,0,sl),{vertices:J,indices:Z}}(this.tileID.canonical,u);_=S.vertices,w=S.indices}else{_=new r.aZ,w=new r.a_;for(const{x:L,y:M}of g)_.emplaceBack(L,M,0,0);const S=r.be(_.int16.subarray(0,4*_.length),void 0,4);for(let L=0;L<S.length;L+=3)w.emplaceBack(S[L],S[L+1],S[L+2])}this._tileBoundsBuffer=n.createVertexBuffer(_,r.bf.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(w),this._tileBoundsSegments=r.bd.simpleSegment(0,0,_.length,w.length)}_makeGlobeTileDebugBuffers(n,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const _=this.tileID.canonical,w=r.bg(_,u),S=r.bh(w),L=r.ah(u.zoom);let M;L>0&&(M=r.bi(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,_,u,S,M,L),this._makeGlobeTileDebugTextBuffer(n,_,u,S,M,L)}_globePoint(n,u,g,_,w,S,L){let M=r.bj(n,u,g);if(S){const V=1<<g.z,Y=r.aD(_.center.lng),J=r.aH(_.center.lat),Z=(g.x+.5)/V-Y;let te=0;Z>.5?te=-1:Z<-.5&&(te=1);let de=(n/r.aj+g.x)/V+te,ue=(u/r.aj+g.y)/V;de=(de-Y)*_._pixelsPerMercatorPixel+Y,ue=(ue-J)*_._pixelsPerMercatorPixel+J;const ge=[de*_.worldSize,ue*_.worldSize,0];r.ad(ge,ge,S),M=r.bk(M,ge,L)}return r.ad(M,M,w)}_makeGlobeTileDebugBorderBuffer(n,u,g,_,w,S){const L=new r.ba,M=new r.bb,V=new r.bl,Y=(Z,te,de,ue,ge)=>{const _e=(de-Z)/(ge-1),Te=(ue-te)/(ge-1),Ne=L.length;for(let Qe=0;Qe<ge;Qe++){const at=Z+Qe*_e,st=te+Qe*Te;L.emplaceBack(at,st);const it=this._globePoint(at,st,u,g,_,w,S);V.emplaceBack(it[0],it[1],it[2]),M.emplaceBack(Ne+Qe)}},J=r.aj;Y(0,0,J,0,16),Y(J,0,J,J,16),Y(J,J,0,J,16),Y(0,J,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(M),this._tileDebugBuffer=n.createVertexBuffer(L,r.bc.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(V,r.bm.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,L.length,M.length)}_makeGlobeTileDebugTextBuffer(n,u,g,_,w,S){const L=r.aj/4,M=new r.ba,V=new r.a_,Y=new r.bl,J=25;V.reserve(32),M.reserve(J),Y.reserve(J);const Z=(te,de)=>J*te+de;for(let te=0;te<J;te++){const de=te*L;for(let ue=0;ue<J;ue++){const ge=ue*L;M.emplaceBack(ge,de);const _e=this._globePoint(ge,de,u,g,_,w,S);Y.emplaceBack(_e[0],_e[1],_e[2])}}for(let te=0;te<4;te++)for(let de=0;de<4;de++){const ue=Z(te,de),ge=Z(te,de+1),_e=Z(te+1,de),Te=Z(te+1,de+1);V.emplaceBack(ue,ge,_e),V.emplaceBack(_e,ge,Te)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(V),this._tileDebugTextBuffer=n.createVertexBuffer(M,r.bc.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(Y,r.bm.members),this._tileDebugTextSegments=r.bd.simpleSegment(0,0,J,32)}destroy(n=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bp.setPbf(r.bq);class ml extends cu{constructor(n,u,g,_,w){super(n,u,g,_,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(n){return this._mrt&&this._mrt.getLayer(n)}setTexture(n,u){const g=u.context,_=g.gl;this.texture=this.texture||u.getTileTexture(n.width),this.texture&&this.texture instanceof r.T?this.texture.update(n,{premultiply:!1}):this.texture=new r.T(g,n,_.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(n=16384,u){const g=this._mrt=new r.bp(30),_=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=r.br(_,(w,S,L,M)=>{if(w)u(w);else try{const V=g.getHeaderLength(S);if(V>n)return void(this.request=this.fetchHeader(V,u));g.parseHeader(S),this._isHeaderLoaded=!0;let Y=0;for(const J of Object.values(g.layers))Y=Math.max(Y,J.dataIndex[J.dataIndex.length-1].lastByte);S.byteLength>=Y&&(this.entireBuffer=S),u(null,this.entireBuffer||S,L,M)}catch(V){u(V)}}),this.request}fetchBand(n,u,g){const _=this._mrt;if(!this._isHeaderLoaded||!_)return void g(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void g(new Error("Can't fetch tile band without an actor"));let S;const L=(J,Z)=>{S.complete(J,Z),J?g(J):(this.updateTextureDescriptor(n,u),g(null,this.textureDescriptor&&this.textureDescriptor.img))},M=(J,Z)=>{if(J)return g(J);const te=w.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Z,task:S},L,void 0,!0);this._workQueue.push(()=>{te&&te.cancel(),S.cancel()})},V=_.getLayer(n);if(!V)return void g(new Error(`Unknown sourceLayer "${n}"`));if(V.hasDataForBand(u))return this.updateTextureDescriptor(n,u),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=V.getDataRange([u]);if(S=_.createDecodingTask(Y),!S||S.tasks.length)if(this.flushQueues(),this.entireBuffer)M(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const J=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),Z=r.br(J,M);this._fetchQueue.push(()=>{Z.cancel(),S.cancel()})}else g(null)}updateNeeded(n,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==n)&&this.state!=="errored"}updateTextureDescriptor(n,u){if(!this._mrt)return;const g=this._mrt.getLayer(n);if(!g||!g.hasBand(u)||!g.hasDataForBand(u))return;const{bytes:_,tileSize:w,buffer:S,offset:L,scale:M}=g.getBandView(u),V=w+2*S,Y=new r.r({width:V,height:V},_),J=this.texture;J&&J instanceof r.T&&J.update(Y,{premultiply:!1}),this.textureDescriptor={layer:n,band:u,img:Y,buffer:S,offset:L,tileSize:w,format:g.pixelFormat,mix:[M,256*M,65536*M,16777216*M]}}}class uu{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,g){const _=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const w={value:u,timeout:void 0};if(g!==void 0&&(w.timeout=setTimeout(()=>{this.remove(n,w)},g)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const g=n.wrapped().key,_=u===void 0?0:this.data[g].indexOf(u),w=this.data[g][_];return this.data[g].splice(_,1),w.timeout&&clearTimeout(w.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(w.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const g in this.data)for(const _ of this.data[g])n(_.value)||u.push(_);for(const g of u)this.remove(g.value.tileID,g)}}class Nc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,g){const _=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][_]=this.stateChanges[n][_]||{},r.h(this.stateChanges[n][_],g),this.deletedStates[n]===null){this.deletedStates[n]={};for(const w in this.state[n])w!==_&&(this.deletedStates[n][w]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][_]===null){this.deletedStates[n][_]={};for(const w in this.state[n][_])g[w]||(this.deletedStates[n][_][w]=null)}else for(const w in g)this.deletedStates[n]&&this.deletedStates[n][_]&&this.deletedStates[n][_][w]===null&&delete this.deletedStates[n][_][w]}removeFeatureState(n,u,g){if(this.deletedStates[n]===null)return;const _=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},g&&u!==void 0)this.deletedStates[n][_]!==null&&(this.deletedStates[n][_]=this.deletedStates[n][_]||{},this.deletedStates[n][_][g]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][_])for(g in this.deletedStates[n][_]={},this.stateChanges[n][_])this.deletedStates[n][_][g]=null;else this.deletedStates[n][_]=null;else this.deletedStates[n]=null}getState(n,u){const g=this.state[n]||{},_=this.stateChanges[n]||{},w=this.deletedStates[n];if(w===null)return{};if(u!==void 0){const L=String(u),M=r.h({},g[L],_[L]);if(w){const V=w[u];if(V===null)return{};for(const Y in V)delete M[Y]}return M}const S=r.h({},g,_);if(w)for(const L in w)delete S[L];return S}initializeTileState(n,u){n.refreshFeatureState(u)}coalesceChanges(n,u){const g={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const S in this.stateChanges[_])this.state[_][S]||(this.state[_][S]={}),r.h(this.state[_][S],this.stateChanges[_][S]),w[S]=this.state[_][S];g[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(this.deletedStates[_]===null)for(const S in this.state[_])w[S]={},this.state[_][S]={};else for(const S in this.deletedStates[_]){if(this.deletedStates[_][S]===null)this.state[_][S]={};else if(this.state[_][S])for(const L of Object.keys(this.deletedStates[_][S]))delete this.state[_][S][L];w[S]=this.state[_][S]}g[_]=g[_]||{},r.h(g[_],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const _ in n)n[_].refreshFeatureState(u)}}class Po extends r.E{constructor(n,u,g){super(),this.id=n,this._onlySymbols=g,u.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new uu(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Nc,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles)if(!this._tiles[n].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,u){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,u)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(n),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Wo).map(n=>n.key)}getRenderableIds(n,u){const g=[];for(const _ in this._tiles)this._isIdRenderable(+_,n,u)&&g.push(this._tiles[_]);return n?g.sort((_,w)=>{const S=_.tileID,L=w.tileID,M=new r.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),V=new r.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-L.overscaledZ||V.y-M.y||V.x-M.x}).map(_=>_.tileID.key):g.map(_=>_.tileID).sort(Wo).map(_=>_.key)}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u,g){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())&&(g||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,u){const g=this._tiles[n];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,n,u)))}_tileLoaded(n,u,g,_){if(_)if(n.state="errored",_.status!==404)this._source.fire(new r.z(_,{tile:n}));else{if(this._source.fire(new r.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=r.q.now(),g==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new r.A("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const w=u[_];if(n.neighboringTiles&&n.neighboringTiles[w]){const S=this.getTileByID(w);g(n,S),g(S,n)}}function g(_,w){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let S=w.tileID.canonical.x-_.tileID.canonical.x;const L=w.tileID.canonical.y-_.tileID.canonical.y,M=Math.pow(2,_.tileID.canonical.z),V=w.tileID.key;S===0&&L===0||Math.abs(L)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,S,L),_.neighboringTiles&&_.neighboringTiles[V]&&(_.neighboringTiles[V].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,g,_){for(const w in this._tiles){let S=this._tiles[w];if(_[w]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>g)continue;let L=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const V=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[V.key],S&&S.hasData()&&(L=V)}let M=L;for(;M.overscaledZ>u;)if(M=M.scaledTo(M.overscaledZ-1),n[M.key]){_[L.key]=L;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const g=this._loadedParentTiles[n.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=n.overscaledZ-1;g>=u;g--){const _=n.scaledTo(g),w=this._getLoadedTile(_);if(w)return w}}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,u){u=u||this._source.tileSize;const g=Math.ceil(n.width/u)+1,_=Math.ceil(n.height/u)+1,w=Math.floor(g*_*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(L)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const g={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+u),g[w.tileID.key]=w}this._tiles=g;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(n,u,g,_,w){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(n,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let L,M=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const Z=V.attenuationRange()[0],te=Math.floor(Z)-Math.log2(V.getDemUpscale());M>te&&(M=te)}if(this.used||this.usedForTerrain){if(this._source.tileID)L=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new r.aM(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=n.clone();Z.tileCoverLift=this.tileCoverLift,L=Z.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:M,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&n.projection.name==="globe"&&(L.push(new r.aM(1,0,1,0,0)),L.push(new r.aM(1,0,1,1,0)),L.push(new r.aM(1,0,1,0,1)),L.push(new r.aM(1,0,1,1,1)))}else if(L=n.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:M,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);L=L.filter(te=>Z(te))}}else L=[];if(L.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ch(this._source.type)){const Z=n.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),te=Math.min(Z,this._source.maxzoom);if(S){const de=n.extendTileCover(L,te);for(const ue of de)L.push(ue)}else if(w){const de=n.extendTileCover(L,te,this.transform._camera.forward());for(const ue of de)L.push(ue)}else if(this.castsShadows&&_){const de=n.extendTileCover(L,te,_);for(const ue of de)this._shadowCasterTiles[ue.key]=!0,L.push(ue)}}const Y=this._updateRetainedTiles(L);if(ch(this._source.type)&&L.length!==0){const Z={},te={},de=Object.keys(Y);for(const ge of de){const _e=Y[ge],Te=this._tiles[ge];if(!Te||Te.fadeEndTime&&Te.fadeEndTime<=r.q.now())continue;const Ne=this.findLoadedParent(_e,Math.max(_e.overscaledZ-Po.maxOverzooming,this._source.minzoom));Ne&&(this._addTile(Ne.tileID),Z[Ne.tileID.key]=Ne.tileID),te[ge]=_e}const ue=L[L.length-1].overscaledZ;for(const ge in this._tiles){const _e=this._tiles[ge];if(Y[ge]||!_e.hasData())continue;let Te=_e.tileID;for(;Te.overscaledZ>ue;){Te=Te.scaledTo(Te.overscaledZ-1);const Ne=this._tiles[Te.key];if(Ne&&Ne.hasData()&&te[Te.key]){Y[ge]=_e.tileID;break}}}for(const ge in Z)Y[ge]||(this._coveredTiles[ge]=!0,Y[ge]=Z[ge])}for(const Z in Y)this._tiles[Z].clearFadeHold();const J=r.bs(this._tiles,Y);for(const Z of J){const te=this._tiles[Z];te.hasSymbolBuckets&&!te.holdingForFade()?te.setHoldDuration(this.map._fadeDuration):te.hasSymbolBuckets&&!te.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const u={};if(n.length===0)return u;const g={},_=n.reduce((V,Y)=>Math.min(V,Y.overscaledZ),1/0),w=n[0].overscaledZ,S=Math.max(w-Po.maxOverzooming,this._source.minzoom),L=Math.max(w+Po.maxUnderzooming,this._source.minzoom),M={};for(const V of n){const Y=this._addTile(V);u[V.key]=V,Y.hasData()||_<this._source.maxzoom&&(M[V.key]=V)}this._retainLoadedChildren(M,_,L,u);for(const V of n){let Y=this._tiles[V.key];if(Y.hasData())continue;if(V.canonical.z>=this._source.maxzoom){const Z=V.children(this._source.maxzoom)[0],te=this.getTile(Z);if(te&&te.hasData()){u[Z.key]=Z;continue}}else{const Z=V.children(this._source.maxzoom);if(u[Z[0].key]&&u[Z[1].key]&&u[Z[2].key]&&u[Z[3].key])continue}let J=Y.wasRequested();for(let Z=V.overscaledZ-1;Z>=S;--Z){const te=V.scaledTo(Z);if(g[te.key]||(g[te.key]=!0,Y=this.getTile(te),!Y&&J&&(Y=this._addTile(te)),Y&&(u[te.key]=te,J=Y.wasRequested(),Y.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let g,_=this._tiles[n].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){g=this._loadedParentTiles[_.key];break}u.push(_.key);const w=_.scaledTo(_.overscaledZ-1);if(g=this._getLoadedTile(w),g)break;_=w}for(const w of u)this._loadedParentTiles[w]=g}}_addTile(n){let u=this._tiles[n.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const g=!!u;if(!g){const _=this.map?this.map.painter:null,w=this._source.tileSize*n.overscaleFactor();u=this._source.type==="raster-array"?new ml(n,w,this.transform.tileZoom,_,this._isRaster):new cu(n,w,this.transform.tileZoom,_,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,n.key,u.state))}return u.uses++,this._tiles[n.key]=u,g||this._source.fire(new r.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const g=u.getExpiryTimeout();g&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},g))}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,u,g){const _=[],w=this.transform;if(!w)return _;const S=w.projection.name==="globe",L=r.aD(w.center.lng);for(const M in this._tiles){const V=this._tiles[M];if(g&&V.clearQueryDebugViz(),V.holdingForFade())continue;let Y;if(S){const J=V.tileID.canonical;if(J.z===0){const Z=[Math.abs(r.ay(L,...hu(J,-1))-L),Math.abs(r.ay(L,...hu(J,1))-L)];Y=[0,2*Z.indexOf(Math.min(...Z))-1]}else{const Z=[Math.abs(r.ay(L,...hu(J,-1))-L),Math.abs(r.ay(L,...hu(J,0))-L),Math.abs(r.ay(L,...hu(J,1))-L)];Y=[Z.indexOf(Math.min(...Z))-1]}}else Y=[0];for(const J of Y){const Z=n.containsTile(V,w,u,J);Z&&_.push(Z)}}return _}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,u){const g=this.getRenderableIds(n,u).map(w=>this._tiles[w].tileID),_=this.transform.projection.name==="globe";for(const w of g)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=_?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return g}sortCoordinatesByDistance(n){const u=n.slice(),g=this.transform._camera.position,_=this.transform._camera.forward(),w={};for(const S of u){const L=1/(1<<S.canonical.z);w[S.key]=((S.canonical.x+.5)*L+S.wrap-g[0])*_[0]+((S.canonical.y+.5)*L-g[1])*_[1]-g[2]*_[2]}return u.sort((S,L)=>w[S.key]-w[L.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(ch(this._source.type))for(const n in this._tiles){const u=this._tiles[n];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(n,u,g){this._state.updateState(n=n||"_geojsonTileLayer",u,g)}removeFeatureState(n,u,g){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,g)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,g){const _=this._tiles[n];_&&_.setDependencies(u,g)}reloadTilesForDependencies(n,u){for(const g in this._tiles)this._tiles[g].hasDependency(n,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(n,u))}_preloadTiles(n,u){if(!this._sourceLoaded){const M=()=>{this._sourceLoaded&&(this._source.off("data",M),this._preloadTiles(n,u))};return void this._source.on("data",M)}const g=new Map,_=Array.isArray(n)?n:[n],w=this.map.painter.terrain,S=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const M of _){const V=M.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of V)g.set(Y.key,Y);this.usedForTerrain&&M.updateElevation(!1)}const L=Array.from(g.values());r.bt(L,(M,V)=>{const Y=new cu(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(Y,J=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),V(J,Y)})},u)}}function Wo(p,n){const u=Math.abs(2*p.wrap)-+(p.wrap<0),g=Math.abs(2*n.wrap)-+(n.wrap<0);return p.overscaledZ-n.overscaledZ||g-u||n.canonical.y-p.canonical.y||n.canonical.x-p.canonical.x}function ch(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function hu(p,n){const u=1<<p.z;return[p.x/u+n,(p.x+1)/u+n]}Po.maxOverzooming=10,Po.maxUnderzooming=3;class Tn{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,u=!1;for(const g in this.style._mergedLayers){const _=this.style._mergedLayers[g];if(_.type==="fill-extrusion"||_.type==="building")this.layers.push({layer:_,visible:n,visibilityChanged:u});else if(_.type==="model"){const w=this.style.getLayerSource(_);w&&w.type==="batched-model"&&this.layers.push({layer:_,visible:n,visibilityChanged:u})}}}onNewFrame(n){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let _=!1;g.type==="fill-extrusion"?_=!g.isHidden(n)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="building"?_=!g.isHidden(n)&&g.paint.get("building-opacity")>0:g.type==="model"&&(_=!g.isHidden(n)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!_&&u.visible,u.visible=_}}updateZOffset(n,u){this.currentBuildingBuckets=[];for(const _ of this.layers){const w=_.layer,S=this.style.getLayerSourceCache(w);let L=1;w.type==="fill-extrusion"?L=_.visible?w.paint.get("fill-extrusion-vertical-scale"):0:w.type==="building"&&(L=_.visible?w.paint.get("building-vertical-scale"):0);let M=S?S.getTile(u):null;if(!M&&S&&u.canonical.z>S.getSource().minzoom){let V=u.scaledTo(Math.min(S.getSource().maxzoom,u.overscaledZ-1));for(;V.overscaledZ>=S.getSource().minzoom&&(M=S.getTile(V),!M&&V.overscaledZ!==0);)V=V.scaledTo(V.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:M?M.getBucket(w):null,tileID:M?M.tileID:u,verticalScale:L})}n.hasAnyZOffset=!1;let g=!1;for(let _=0;_<n.symbolInstances.length;_++){const w=n.symbolInstances.get(_),S=w.zOffset,L=this._getHeightAtTileOffset(u,w.tileAnchorX,w.tileAnchorY);w.zOffset=L!==Number.NEGATIVE_INFINITY?L:S,g||S===w.zOffset||(g=!0),n.hasAnyZOffset||w.zOffset===0||(n.hasAnyZOffset=!0)}g&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,u,g,_){let w=u,S=g;if(n.canonical.z!==_.canonical.z){const L=_.canonical,M=1/(1<<n.canonical.z-L.z);w=(u+n.canonical.x*r.aj)*M-L.x*r.aj|0,S=(g+n.canonical.y*r.aj)*M-L.y*r.aj|0}return{tileX:w,tileY:S}}_getHeightAtTileOffset(n,u,g){let _,w;for(let S=0;S<this.layers.length;++S){const L=this.layers[S].layer;if(L.type!=="fill-extrusion"&&L.type!=="building")continue;const{bucket:M,tileID:V,verticalScale:Y}=this.currentBuildingBuckets[S];if(!M)continue;const{tileX:J,tileY:Z}=this._mapCoordToOverlappingTile(n,u,g,V),te=M.getHeightAtTileCoord(J,Z);te&&te.height!==void 0&&(te.hidden?_=te.height:w=Math.max(te.height*Y,w||0))}if(w!==void 0)return w;for(let S=0;S<this.layers.length;++S){const L=this.layers[S];if(L.layer.type!=="model"||!L.visible)continue;const{bucket:M,tileID:V}=this.currentBuildingBuckets[S];if(!M)continue;const{tileX:Y,tileY:J}=this._mapCoordToOverlappingTile(n,u,g,V),Z=M.getHeightAtTileCoord(Y,J);if(Z&&!Z.hidden)return Z.height===void 0&&_!==void 0?Math.min(Z.maxHeight,_)*Z.verticalScale:Z.height?Z.height*Z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Jd(p,n){const u={};for(const g in p)g!=="ref"&&(u[g]=p[g]);return r.bu.forEach(g=>{g in n&&(u[g]=n[g])}),u}function uh(p){p=p.slice();const n=Object.create(null);for(let u=0;u<p.length;u++)n[p[u].id]=p[u];for(let u=0;u<p.length;u++)"ref"in p[u]&&(p[u]=Jd(p[u],n[p[u].ref]));return p}const pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function hh(p,n,u){u.push({command:pn.addSource,args:[p,n[p]]})}function du(p,n,u){n.push({command:pn.removeSource,args:[p]}),u[p]=!0}function jc(p,n,u,g){du(p,u,g),hh(p,n,u)}function yl(p,n,u){let g;for(g in p[u])if(p[u].hasOwnProperty(g)&&g!=="data"&&!r.bv(p[u][g],n[u][g]))return!1;for(g in n[u])if(n[u].hasOwnProperty(g)&&g!=="data"&&!r.bv(p[u][g],n[u][g]))return!1;return!0}function Du(p,n,u,g,_,w){let S;for(S in n=n||{},p=p||{})p.hasOwnProperty(S)&&(r.bv(p[S],n[S])||u.push({command:w,args:[g,S,n[S],_]}));for(S in n)n.hasOwnProperty(S)&&!p.hasOwnProperty(S)&&(r.bv(p[S],n[S])||u.push({command:w,args:[g,S,n[S],_]}))}function Hc(p){return p.id}function vc(p,n){return p[n.id]=n,p}class dh{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=r.ay(n,0,1);let u=1,g=this._distances[u];const _=n*this.paddedLength+this.padding;for(;g<_&&u<this._distances.length;)g=this._distances[++u];const w=u-1,S=this._distances[w],L=g-S,M=L>0?(_-S)/L:0;return this.points[w].mult(1-M).add(this.points[u].mult(M))}}class Au{constructor(n,u,g){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/g),this.yCellCount=Math.ceil(u/g);for(let S=0;S<this.xCellCount*this.yCellCount;S++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,g,_,w){this._forEachCell(u,g,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(n,u,g,_){this._forEachCell(u-_,g-_,u+_,g+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(g),this.circles.push(_)}_insertBoxCell(n,u,g,_,w,S){this.boxCells[w].push(S)}_insertCircleCell(n,u,g,_,w,S){this.circleCells[w].push(S)}_query(n,u,g,_,w,S){if(g<0||n>this.width||_<0||u>this.height)return!w&&[];const L=[];if(n<=0&&u<=0&&this.width<=g&&this.height<=_){if(w)return!0;for(let M=0;M<this.boxKeys.length;M++)L.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const V=this.circles[3*M],Y=this.circles[3*M+1],J=this.circles[3*M+2];L.push({key:this.circleKeys[M],x1:V-J,y1:Y-J,x2:V+J,y2:Y+J})}return S?L.filter(S):L}return this._forEachCell(n,u,g,_,this._queryCell,L,{hitTest:w,seenUids:{box:{},circle:{}}},S),w?L.length>0:L}_queryCircle(n,u,g,_,w){const S=n-g,L=n+g,M=u-g,V=u+g;if(L<0||S>this.width||V<0||M>this.height)return!_&&[];const Y=[];return this._forEachCell(S,M,L,V,this._queryCellCircle,Y,{hitTest:_,circle:{x:n,y:u,radius:g},seenUids:{box:{},circle:{}}},w),_?Y.length>0:Y}query(n,u,g,_,w){return this._query(n,u,g,_,!1,w)}hitTest(n,u,g,_,w){return this._query(n,u,g,_,!0,w)}hitTestCircle(n,u,g,_){return this._queryCircle(n,u,g,!0,_)}_queryCell(n,u,g,_,w,S,L,M){const V=L.seenUids,Y=this.boxCells[w];if(Y!==null){const Z=this.bboxes;for(const te of Y)if(!V.box[te]){V.box[te]=!0;const de=4*te;if(n<=Z[de+2]&&u<=Z[de+3]&&g>=Z[de+0]&&_>=Z[de+1]&&(!M||M(this.boxKeys[te]))){if(L.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[te],x1:Z[de],y1:Z[de+1],x2:Z[de+2],y2:Z[de+3]})}}}const J=this.circleCells[w];if(J!==null){const Z=this.circles;for(const te of J)if(!V.circle[te]){V.circle[te]=!0;const de=3*te;if(this._circleAndRectCollide(Z[de],Z[de+1],Z[de+2],n,u,g,_)&&(!M||M(this.circleKeys[te]))){if(L.hitTest)return S.push(!0),!0;{const ue=Z[de],ge=Z[de+1],_e=Z[de+2];S.push({key:this.circleKeys[te],x1:ue-_e,y1:ge-_e,x2:ue+_e,y2:ge+_e})}}}}}_queryCellCircle(n,u,g,_,w,S,L,M){const V=L.circle,Y=L.seenUids,J=this.boxCells[w];if(J!==null){const te=this.bboxes;for(const de of J)if(!Y.box[de]){Y.box[de]=!0;const ue=4*de;if(this._circleAndRectCollide(V.x,V.y,V.radius,te[ue+0],te[ue+1],te[ue+2],te[ue+3])&&(!M||M(this.boxKeys[de])))return S.push(!0),!0}}const Z=this.circleCells[w];if(Z!==null){const te=this.circles;for(const de of Z)if(!Y.circle[de]){Y.circle[de]=!0;const ue=3*de;if(this._circlesCollide(te[ue],te[ue+1],te[ue+2],V.x,V.y,V.radius)&&(!M||M(this.circleKeys[de])))return S.push(!0),!0}}}_forEachCell(n,u,g,_,w,S,L,M){const V=this._convertToXCellCoord(n),Y=this._convertToYCellCoord(u),J=this._convertToXCellCoord(g),Z=this._convertToYCellCoord(_);for(let te=V;te<=J;te++)for(let de=Y;de<=Z;de++)if(w.call(this,n,u,g,_,this.xCellCount*de+te,S,L,M))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,g,_,w,S){const L=_-n,M=w-u,V=g+S;return V*V>L*L+M*M}_circleAndRectCollide(n,u,g,_,w,S,L){const M=(S-_)/2,V=Math.abs(n-(_+M));if(V>M+g)return!1;const Y=(L-w)/2,J=Math.abs(u-(w+Y));if(J>Y+g)return!1;if(V<=M||J<=Y)return!0;const Z=V-M,te=J-Y;return Z*Z+te*te<=g*g}}const vl={unknown:0,flipRequired:1,flipNotRequired:2},ld=Math.tan(85*Math.PI/180);function qa(p,n,u,g,_,w,S){const L=r.bz();if(u)if(w.name==="globe"){const M=r.bA(_,n);r.az(L,L,M)}else{const M=r.bB([],S);L[0]=M[0],L[1]=M[1],L[4]=M[2],L[5]=M[3],g||r.by(L,L,_.angle)}else r.az(L,_.labelPlaneMatrix,p);return L}function fu(p,n,u,g,_,w,S){const L=qa(p,n,u,g,_,w,S);return w.name==="globe"&&u||(L[2]=L[6]=L[10]=L[14]=0),L}function pu(p,n,u,g,_,w,S){if(u){if(w.name==="globe"){const L=qa(p,n,u,g,_,w,S);return r.bi(L,L),r.az(L,p,L),L}{const L=r.bw(p),M=r.bx([]);return M[0]=S[0],M[1]=S[1],M[4]=S[2],M[5]=S[3],r.az(L,L,M),g||r.by(L,L,-_.angle),L}}return _.glCoordMatrix}function _l(p,n,u,g){const _=[p,n,u,1];u?r.aA(_,_,g):Un(_,_,g);const w=_[3];return _[0]/=w,_[1]/=w,_[2]/=w,_}function Uo(p,n){return Math.min(.5+p/n*.5,1.5)}function Qc(p,n){const u=p[0]/p[3],g=p[1]/p[3];return u>=-n[0]&&u<=n[0]&&g>=-n[1]&&g<=n[1]}function Jl(p,n,u,g,_,w,S,L,M,V){const Y=u.transform,J=g?p.textSizeData:p.iconSizeData,Z=r.bH(J,u.transform.zoom),te=Y.projection.name==="globe",de=[256/u.width*2+1,256/u.height*2+1],ue=g?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;ue.clear();let ge=null;te&&(ge=g?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const _e=p.lineVertexArray,Te=g?p.text.placedSymbolArray:p.icon.placedSymbolArray,Ne=u.transform.width/u.transform.height;let Qe,at=!1;for(let st=0;st<Te.length;st++){const it=Te.get(st),{numGlyphs:Xe,writingMode:lt}=it;if(lt!==r.bI.vertical||at||Qe===r.bI.horizontal||(at=!0),Qe=lt,(it.hidden||lt===r.bI.vertical)&&!at){xl(Xe,ue);continue}at=!1;const dt=new r.P(it.tileAnchorX,it.tileAnchorY);let{x:kt,y:Dt,z:ti}=Y.projection.projectTilePoint(dt.x,dt.y,V.canonical);if(M){const[ir,tr,Ki]=M(dt);kt+=ir,Dt+=tr,ti+=Ki}const ri=[kt,Dt,ti,1];if(r.aA(ri,ri,n),!Qc(ri,de)){xl(Xe,ue);continue}const vi=ri[3],Mt=Uo(u.transform.getCameraToCenterDistance(Y.projection),vi),Vt=r.bJ(J,Z,it),wt=S?Vt/Mt:Vt*Mt,oi=_l(kt,Dt,ti,_);if(oi[3]<=0){xl(Xe,ue);continue}let zt={};const mi=r.al(p.layers[0].layout.get("text-max-angle")),Li=Math.cos(mi),ai=S?null:M,Mi=gu(it,wt,!1,L,n,_,w,p.glyphOffsetArray,_e,ue,ge,oi,dt,zt,Ne,ai,Y.projection,V,S,Li);at=Mi.useVertical,ai&&Mi.needsFlipping&&(zt={}),(Mi.notEnoughRoom||at||Mi.needsFlipping&&gu(it,wt,!0,L,n,_,w,p.glyphOffsetArray,_e,ue,ge,oi,dt,zt,Ne,ai,Y.projection,V,S,Li).notEnoughRoom)&&xl(Xe,ue)}g?(p.text.dynamicLayoutVertexBuffer.updateData(ue),ge&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(ge)):(p.icon.dynamicLayoutVertexBuffer.updateData(ue),ge&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(ge))}function ec(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge){const{lineStartIndex:_e,glyphStartIndex:Te,segment:Ne}=L,Qe=Te+L.numGlyphs,at=_e+L.lineLength,st=n.getoffsetX(Te),it=n.getoffsetX(Qe-1),Xe=Pl(p*st,u,g,_,w,S,Ne,_e,at,M,V,Y,J,Z,!0,te,de,ue,ge);if(!Xe)return null;const lt=Pl(p*it,u,g,_,w,S,Ne,_e,at,M,V,Y,J,Z,!0,te,de,ue,ge);return lt?{first:Xe,last:lt}:null}function tc(p,n,u,g){return p===r.bI.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:p===r.bI.vertical?g>0?{needsFlipping:!0}:null:n!==vl.unknown&&function(_,w){return _===0||Math.abs(w/_)>ld}(u,g)?n===vl.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function gu(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te,Ne){const Qe=n/24,at=p.lineOffsetX*Qe,st=p.lineOffsetY*Qe,{lineStartIndex:it,glyphStartIndex:Xe,numGlyphs:lt,segment:dt,writingMode:kt,flipState:Dt}=p,ti=it+p.lineLength,ri=vi=>{if(Y){const[oi,zt,mi]=vi.up,Li=V.length;r.bK(Y,Li+0,oi,zt,mi),r.bK(Y,Li+1,oi,zt,mi),r.bK(Y,Li+2,oi,zt,mi),r.bK(Y,Li+3,oi,zt,mi)}const[Mt,Vt,wt]=vi.point;r.bL(V,Mt,Vt,wt,vi.angle)};if(lt>1){const vi=ec(Qe,L,at,st,u,J,Z,p,M,w,te,ue,!1,ge,_e,Te,Ne);if(!vi)return{notEnoughRoom:!0};if(g&&!u){let[Mt,Vt,wt]=vi.first.point,[oi,zt,mi]=vi.last.point;[Mt,Vt]=_l(Mt,Vt,wt,S),[oi,zt]=_l(oi,zt,mi,S);const Li=tc(kt,Dt,(oi-Mt)*de,zt-Vt);if(p.flipState=Li&&Li.needsFlipping?vl.flipRequired:vl.flipNotRequired,Li)return Li}ri(vi.first);for(let Mt=Xe+1;Mt<Xe+lt-1;Mt++){const Vt=Pl(Qe*L.getoffsetX(Mt),at,st,u,J,Z,dt,it,ti,M,w,te,ue,!1,!1,ge,_e,Te,Ne);if(!Vt)return V.length-=4*(Mt-Xe),{notEnoughRoom:!0};ri(Vt)}ri(vi.last)}else{if(g&&!u){const Mt=_l(Z.x,Z.y,0,_),Vt=it+dt+1,wt=new r.P(M.getx(Vt),M.gety(Vt)),oi=_l(wt.x,wt.y,0,_),zt=oi[3]>0?oi:$a(Z,wt,Mt,1,_,void 0,ge,_e.canonical),mi=tc(kt,Dt,(zt[0]-Mt[0])*de,zt[1]-Mt[1]);if(p.flipState=mi&&mi.needsFlipping?vl.flipRequired:vl.flipNotRequired,mi)return mi}const vi=Pl(Qe*L.getoffsetX(Xe),at,st,u,J,Z,dt,it,ti,M,w,te,ue,!1,!1,ge,_e,Te,Ne);if(!vi)return{notEnoughRoom:!0};ri(vi)}return{}}function ra(p,n,u,g,_){const{x:w,y:S,z:L}=g.projectTilePoint(p.x,p.y,n);if(!_)return _l(w,S,L,u);const[M,V,Y]=_(p);return _l(w+M,S+V,L+Y,u)}function $a(p,n,u,g,_,w,S,L){const M=ra(p.sub(n)._unit()._add(p),L,_,S,w);return r.at(M,u,M),r.au(M,M),r.bE(M,u,M,g)}function Pl(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te){const Ne=g?p-n:p+n;let Qe=Ne>0?1:-1,at=0;g&&(Qe*=-1,at=Math.PI),Qe<0&&(at+=Math.PI);let st=L+S+(Qe>0?0:1)|0,it=_,Xe=_,lt=0,dt=0;const kt=Math.abs(Ne),Dt=[],ti=[];let ri=w,vi=ri,Mt=r.bC([]);const Vt=()=>$a(vi,ri,Xe,kt-lt+1,Y,Z,ue,ge.canonical);for(;lt+dt<=kt;){if(st+=Qe,st<L||st>=M)return null;if(Xe=it,vi=ri,Dt.push(Xe),te&&ti.push(vi),ri=new r.P(V.getx(st),V.gety(st)),it=J[st],!it){const Ki=ra(ri,ge.canonical,Y,ue,Z);it=Ki[3]>0?J[st]=Ki:Vt()}lt+=dt;const ir=r.at([],it,Xe),tr=r.bD(Xe,it);if(u&&tr>0&&dt>0&&r.bG(Mt,ir)/(dt*tr)<Te)return null;dt=tr,Mt=ir}de&&Z&&(J[st]&&(it=Vt(),dt=r.bD(Xe,it),Mt=r.at([],it,Xe)),J[st]=it);const wt=(kt-lt)/dt,oi=ri.sub(vi)._mult(wt)._add(vi),zt=r.bE([],Xe,Mt,wt);let mi=[0,0,1],Li=Mt[0],ai=Mt[1];if(_e&&(mi=ue.upVector(ge.canonical,oi.x,oi.y),mi[0]!==0||mi[1]!==0||mi[2]!==1)){const ir=[mi[2],0,-mi[0]],tr=r.bF([],mi,ir);r.au(ir,ir),r.au(tr,tr),Li=r.bG(Mt,ir),ai=r.bG(Mt,tr)}if(u){const ir=r.bF([],mi,Mt);r.au(ir,ir),r.bE(zt,zt,ir,u*Qe)}const Mi=at+Math.atan2(ai,Li);return Dt.push(zt),te&&ti.push(oi),{point:zt,angle:Mi,path:Dt,tilePath:ti,up:mi}}function xl(p,n){const u=n.length,g=u+4*p;n.resize(g),n.float32.fill(-1/0,4*u,4*g)}function Un(p,n,u){const g=n[0],_=n[1];return p[0]=u[0]*g+u[4]*_+u[12],p[1]=u[1]*g+u[5]*_+u[13],p[3]=u[3]*g+u[7]*_+u[15],p}const zo=100;class Hh{constructor(n,u,g=new Au(n.width+200,n.height+200,25),_=new Au(n.width+200,n.height+200,25)){this.transform=n,this.grid=g,this.ignoredGrid=_,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+zo,this.screenBottomBoundary=n.height+zo,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=u}placeCollisionBox(n,u,g,_,w,S,L,M){let V=g.projectedAnchorX,Y=g.projectedAnchorY,J=g.projectedAnchorZ;const Z=g.elevation,te=g.tileID,de=n.getProjection();if(Z&&te){const[st,it,Xe]=de.upVector(te.canonical,g.tileAnchorX,g.tileAnchorY),lt=de.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;V+=st*Z*lt,Y+=it*Z*lt,J+=Xe*Z*lt}const ue=this.projectAndGetPerspectiveRatio(L,V,Y,J,g.tileID,de.name==="globe"||!!Z||this.transform.pitch>0,de),ge=S*ue.perspectiveRatio,_e=(g.x1*u+_.x-g.padding)*ge+ue.point.x,Te=(g.y1*u+_.y-g.padding)*ge+ue.point.y,Ne=(g.x2*u+_.x+g.padding)*ge+ue.point.x,Qe=(g.y2*u+_.y+g.padding)*ge+ue.point.y,at=ue.perspectiveRatio<=.55||ue.occluded;return!this.isInsideGrid(_e,Te,Ne,Qe)||!w&&this.grid.hitTest(_e,Te,Ne,Qe,M)||at?{box:[],offscreen:!1,occluded:ue.occluded}:{box:[_e,Te,Ne,Qe],offscreen:this.isOffscreen(_e,Te,Ne,Qe),occluded:!1}}placeCollisionCircles(n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue){const ge=[],_e=this.transform.elevation,Te=n.getProjection(),Ne=_e?_e.getAtTileOffsetFunc(ue,this.transform.center.lat,this.transform.worldSize,Te):null,Qe=new r.P(g.tileAnchorX,g.tileAnchorY);let{x:at,y:st,z:it}=Te.projectTilePoint(Qe.x,Qe.y,ue.canonical);if(Ne){const[mi,Li,ai]=Ne(Qe);at+=mi,st+=Li,it+=ai}const Xe=Te.name==="globe",lt=this.projectAndGetPerspectiveRatio(L,at,st,it,ue,Xe||!!_e||this.transform.pitch>0,Te),{perspectiveRatio:dt}=lt,kt=(J?S/dt:S*dt)/r.bO,Dt=_l(at,st,it,M),ti=g.lineOffsetX*kt,ri=g.lineOffsetY*kt,vi=r.al(n.layers[0].layout.get("text-max-angle")),Mt=Math.cos(vi),Vt=lt.signedDistanceFromCamera>0?ec(kt,w,ti,ri,!1,Dt,Qe,g,_,M,{},_e&&!J?Ne:null,J&&!!_e,Te,ue,J,Mt):null;let wt=!1,oi=!1,zt=!0;if(Vt&&!lt.occluded){const mi=.5*te*dt+de,Li=new r.P(-100,-100),ai=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Mi=new dh,{first:ir,last:tr}=Vt,Ki=ir.path.length;let pr=[];for(let Hr=Ki-1;Hr>=1;Hr--)pr.push(ir.path[Hr]);for(let Hr=1;Hr<tr.path.length;Hr++)pr.push(tr.path[Hr]);const gr=2.5*mi;V&&(pr=pr.map(([Hr,sn,Yn],xs)=>(Ne&&!Xe&&(Yn=Ne(xs<Ki-1?ir.tilePath[Ki-1-xs]:tr.tilePath[xs-Ki+2])[2]),_l(Hr,sn,Yn,V))),pr.some(Hr=>Hr[3]<=0)&&(pr=[]));let Cr=[];if(pr.length>0){let Hr=1/0,sn=-1/0,Yn=1/0,xs=-1/0;for(const es of pr)Hr=Math.min(Hr,es[0]),Yn=Math.min(Yn,es[1]),sn=Math.max(sn,es[0]),xs=Math.max(xs,es[1]);sn>=Li.x&&Hr<=ai.x&&xs>=Li.y&&Yn<=ai.y&&(Cr=[pr.map(es=>new r.P(es[0],es[1]))],(Hr<Li.x||sn>ai.x||Yn<Li.y||xs>ai.y)&&(Cr=r.bM(Cr,Li.x,Li.y,ai.x,ai.y)))}for(const Hr of Cr){Mi.reset(Hr,.25*mi);let sn=0;sn=Mi.length<=.5*mi?1:Math.ceil(Mi.paddedLength/gr)+1;for(let Yn=0;Yn<sn;Yn++){const xs=Yn/Math.max(sn-1,1),es=Mi.lerp(xs),is=es.x+zo,uo=es.y+zo;ge.push(is,uo,mi,0);const Jr=is-mi,ln=uo-mi,yn=is+mi,Ps=uo+mi;if(zt=zt&&this.isOffscreen(Jr,ln,yn,Ps),oi=oi||this.isInsideGrid(Jr,ln,yn,Ps),!u&&this.grid.hitTestCircle(is,uo,mi,Z)&&(wt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:wt,occluded:!1}}}}return{circles:!Y&&wt||!oi?[]:ge,offscreen:zt,collisionDetected:wt,occluded:lt.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,_=1/0,w=-1/0,S=-1/0;for(const Y of n){const J=new r.P(Y.x+zo,Y.y+zo);g=Math.min(g,J.x),_=Math.min(_,J.y),w=Math.max(w,J.x),S=Math.max(S,J.y),u.push(J)}const L=this.grid.query(g,_,w,S).concat(this.ignoredGrid.query(g,_,w,S)),M={},V={};for(const Y of L){const J=Y.key;if(M[J.bucketInstanceId]===void 0&&(M[J.bucketInstanceId]={}),M[J.bucketInstanceId][J.featureIndex])continue;const Z=[new r.P(Y.x1,Y.y1),new r.P(Y.x2,Y.y1),new r.P(Y.x2,Y.y2),new r.P(Y.x1,Y.y2)];r.bN(u,Z)&&(M[J.bucketInstanceId][J.featureIndex]=!0,V[J.bucketInstanceId]===void 0&&(V[J.bucketInstanceId]=[]),V[J.bucketInstanceId].push(J.featureIndex))}return V}insertCollisionBox(n,u,g,_,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:_,collisionGroupID:w},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,g,_,w){const S=u?this.ignoredGrid:this.grid,L={bucketInstanceId:g,featureIndex:_,collisionGroupID:w};for(let M=0;M<n.length;M+=4)S.insertCircle(L,n[M],n[M+1],n[M+2])}projectAndGetPerspectiveRatio(n,u,g,_,w,S,L){const M=[u,g,_,1];let V=!1;_||this.transform.pitch>0?(r.aA(M,M,n),this.fogState&&w&&L.name!=="globe"&&(V=function(Z,te,de,ue,ge,_e){const Te=_e.calculateFogTileMatrix(ge),Ne=[te,de,ue];return r.ad(Ne,Ne,Te),Fi(Z,r.ae(Ne),_e.pitch,_e._fov)}(this.fogState,u,g,_,w.toUnwrapped(),this.transform)>.9)):Un(M,M,n);const Y=M[3];return{point:new r.P((M[0]/Y+1)/2*this.transform.width+zo,(-M[1]/Y+1)/2*this.transform.height+zo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:S&&M[2]>Y||V}}isOffscreen(n,u,g,_){return g<zo||n>=this.screenRightBoundary||_<zo||u>this.screenBottomBoundary}isInsideGrid(n,u,g,_){return g>=0&&n<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=r.bx([]);return r.bo(n,n,[-100,-100,0]),n}}function mu(p,n,u){const g=n.createTileMatrix(p,p.worldSize,u.toUnwrapped());return r.az(new Float32Array(16),p.projMatrix,g)}function Er(p,n,u){if(n.projection.name===u.projection.name)return p.projMatrix;const g=u.clone();return g.setProjection(n.projection),mu(g,n.getProjection(),p)}function Ah(p,n,u){return n.name===u.projection.name?p.projMatrix:mu(u,n,p)}class Vc{constructor(n,u,g,_){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):_&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class _c{constructor(n,u,g,_,w,S=!1){this.text=new Vc(n?n.text:null,u,g,w),this.icon=new Vc(n?n.icon:null,u,_,w),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Da{constructor(n,u,g,_=!1){this.text=n,this.icon=u,this.skipFade=g,this.clipped=_}}class Qh{constructor(){this.invProjMatrix=r.bz(),this.viewportMatrix=r.bz(),this.circles=[]}}class Ou{constructor(n,u,g,_,w){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=_,this.tileID=w}}class hr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[n]}}function Mn(p,n,u,g,_){const{horizontalAlign:w,verticalAlign:S}=r.bT(p),L=-(w-.5)*n,M=-(S-.5)*u,V=r.bU(p,g);return new r.P(L+V[0]*_,M+V[1]*_)}function In(p,n,u,g,_){const w=new r.P(p,n);return u&&w._rotate(g?_:-_),w}class na{constructor(n,u,g,_,w,S){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new Hh(this.transform,w),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new hr(g),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,u,g,_,w=1){const S=g.getBucket(u),L=g.latestFeatureIndex;if(!S||!L||u.fqid!==S.layerIds[0])return;const M=S.layers[0].layout,V=S.layers[0].paint,Y=g.collisionBoxArray,J=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Z=g.tileSize/r.aj,te=g.tileID.toUnwrapped();this.transform.setProjection(S.projection);const de=(ue=g.tileID,ge=S.getProjection(),_e=this.transform,ge.name===this.projection?_e.calculateProjMatrix(ue.toUnwrapped()):mu(_e,ge,ue));var ue,ge,_e;const Te=M.get("text-pitch-alignment")==="map",Ne=M.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Qe=u.dynamicFilter(),at=u.dynamicFilterNeedsFeature(),st=this.transform.calculatePixelsToTileUnitsMatrix(g),it=fu(de,g.tileID.canonical,Te,Ne,this.transform,S.getProjection(),st);let Xe=null;if(Te){const Vt=pu(de,g.tileID.canonical,Te,Ne,this.transform,S.getProjection(),st);Xe=r.az([],this.transform.labelPlaneMatrix,Vt)}let lt=null;Qe&&g.latestFeatureIndex&&(lt={unwrappedTileID:te,dynamicFilter:Qe,dynamicFilterNeedsFeature:at}),this.retainedQueryData[S.bucketInstanceId]=new Ou(S.bucketInstanceId,L,S.sourceLayerIndex,S.index,g.tileID);const[dt,kt]=S.layers[0].layout.get("text-size-scale-range"),Dt=r.ay(w,dt,kt),[ti,ri]=M.get("icon-size-scale-range"),vi=r.ay(w,ti,ri),Mt={bucket:S,layout:M,paint:V,posMatrix:de,textLabelPlaneMatrix:it,labelToScreenMatrix:Xe,clippingData:lt,scale:J,textPixelRatio:Z,holdingForFade:g.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:r.bH(S.textSizeData,this.transform.zoom,Dt),partiallyEvaluatedIconSize:r.bH(S.iconSizeData,this.transform.zoom,vi),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(_)for(const Vt of S.sortKeyRanges){const{sortKey:wt,symbolInstanceStart:oi,symbolInstanceEnd:zt}=Vt;n.push({sortKey:wt,symbolInstanceStart:oi,symbolInstanceEnd:zt,parameters:Mt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Mt})}attemptAnchorPlacement(n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te){const{textOffset0:Ne,textOffset1:Qe,crossTileID:at}=Z,st=[Ne,Qe],it=Mn(n,g,_,st,w),Xe=this.collisionIndex.placeCollisionBox(de,w,u,In(it.x,it.y,S,L,this.transform.angle),J,M,V,Y.predicate);if(ge){const lt=de.getSymbolInstanceIconSize(Te,this.transform.zoom,Z.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,lt,ge,In(it.x,it.y,S,L,this.transform.angle),J,M,V,Y.predicate).box.length===0)return}if(Xe.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[at]&&this.prevPlacement.placements[at]&&this.prevPlacement.placements[at].text&&(lt=this.prevPlacement.variableOffsets[at].anchor),this.variableOffsets[at]={textOffset:st,width:g,height:_,anchor:n,textScale:w,prevAnchor:lt},this.markUsedJustification(de,n,Z,ue),de.allowVerticalPlacement&&(this.markUsedOrientation(de,ue,Z),this.placedOrientations[at]=ue),{shift:it,placedGlyphBoxes:Xe}}}placeLayerBucketPart(n,u,g,_,w=1){const{bucket:S,layout:L,paint:M,posMatrix:V,textLabelPlaneMatrix:Y,labelToScreenMatrix:J,clippingData:Z,textPixelRatio:te,holdingForFade:de,collisionBoxArray:ue,partiallyEvaluatedTextSize:ge,partiallyEvaluatedIconSize:_e,collisionGroup:Te,latestFeatureIndex:Ne}=n.parameters,Qe=L.get("text-optional"),at=L.get("icon-optional"),st=L.get("text-allow-overlap"),it=L.get("icon-allow-overlap"),Xe=L.get("text-rotation-alignment")==="map",lt=L.get("text-pitch-alignment")==="map",dt=M.get("symbol-z-offset"),kt=L.get("symbol-elevation-reference")==="sea",[Dt,ti]=L.get("text-size-scale-range"),[ri,vi]=L.get("icon-size-scale-range"),Mt=r.ay(w,Dt,ti),Vt=r.ay(w,ri,vi);this.transform.setProjection(S.projection);let wt=st&&(it||!S.hasIconData()||at),oi=it&&(st||!S.hasTextData()||Qe);const zt=!dt.isConstant();!S.collisionArrays&&ue&&S.deserializeCollisionBoxes(ue),g&&_&&S.updateCollisionDebugBuffers(this.transform.zoom,ue,Mt,Vt);const mi=(ai,Mi,ir)=>{const{crossTileID:tr,numVerticalGlyphVertices:Ki}=ai;let pr=null;if(Z&&Z.dynamicFilterNeedsFeature||zt){const N=this.retainedQueryData[S.bucketInstanceId];pr=Ne.loadFeature({featureIndex:ai.featureIndex,bucketIndex:N.bucketIndex,sourceLayerIndex:N.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Z&&!(0,Z.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},pr,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new r.P(ai.tileAnchorX,ai.tileAnchorY),this.transform.calculateDistanceTileData(Z.unwrappedTileID)))return this.placements[tr]=new Da(!1,!1,!1,!0),void u.add(tr);const gr=dt.evaluate(pr,{});if(u.has(tr))return;if(de)return void(this.placements[tr]=new Da(!1,!1,!1));let Cr=!1,Hr=!1,sn=!0,Yn=!1,xs=!1,es=null,is={box:null,offscreen:null,occluded:null},uo={box:null},Jr=null,ln=null,yn=null,Ps=0,Qo=0,Es=0;ir.textFeatureIndex?Ps=ir.textFeatureIndex:ai.useRuntimeCollisionCircles&&(Ps=ai.featureIndex),ir.verticalTextFeatureIndex&&(Qo=ir.verticalTextFeatureIndex);const Hn=N=>{N.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const O=this.transform.elevation;N.elevation=kt?gr:gr+(O?O.getAtTileOffset(N.tileID,N.tileAnchorX,N.tileAnchorY):0),N.elevation+=ai.zOffset},to=ir.textBox;if(to){Hn(to);const N=X=>{let W=r.bI.horizontal;if(S.allowVerticalPlacement&&!X&&this.prevPlacement){const le=this.prevPlacement.placedOrientations[tr];le&&(this.placedOrientations[tr]=le,W=le,this.markUsedOrientation(S,W,ai))}return W},O=(X,W)=>{if(S.allowVerticalPlacement&&Ki>0&&ir.verticalTextBox){for(const le of S.writingModes)if(le===r.bI.vertical?(is=W(),uo=is):is=X(),is&&is.box&&is.box.length)break}else is=X()};if(L.get("text-variable-anchor")){let X=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[tr]){const we=this.prevPlacement.variableOffsets[tr];X.indexOf(we.anchor)>0&&(X=X.filter(Re=>Re!==we.anchor),X.unshift(we.anchor))}const W=(we,Re,ft)=>{const At=S.getSymbolInstanceTextSize(ge,ai,this.transform.zoom,Mi),Ht=(we.x2-we.x1)*At+2*we.padding,si=(we.y2-we.y1)*At+2*we.padding,gi=ai.hasIconTextFit&&!it?Re:null;gi&&Hn(gi);let Ui={box:[],offscreen:!1,occluded:!1};const Gr=st?2*X.length:X.length;for(let vr=0;vr<Gr;++vr){const Rr=this.attemptAnchorPlacement(X[vr%X.length],we,Ht,si,At,Xe,lt,te,V,Te,vr>=X.length,ai,Mi,S,ft,gi,ge,_e);if(Rr&&(Ui=Rr.placedGlyphBoxes,Ui&&Ui.box&&Ui.box.length)){Cr=!0,es=Rr.shift;break}}return Ui};O(()=>W(to,ir.iconBox,r.bI.horizontal),()=>{const we=ir.verticalTextBox;return we&&Hn(we),S.allowVerticalPlacement&&!(is&&is.box&&is.box.length)&&Ki>0&&we?W(we,ir.verticalIconBox,r.bI.vertical):{box:null,offscreen:null,occluded:null}}),is&&(Cr=is.box,sn=is.offscreen,Yn=is.occluded);const le=N(!(!is||!is.box));if(!Cr&&this.prevPlacement){const we=this.prevPlacement.variableOffsets[tr];we&&(this.variableOffsets[tr]=we,this.markUsedJustification(S,we.anchor,ai,le))}}else{const X=(W,le)=>{const we=S.getSymbolInstanceTextSize(ge,ai,this.transform.zoom,Mi,w),Re=this.collisionIndex.placeCollisionBox(S,we,W,new r.P(0,0),st,te,V,Te.predicate);return Re&&Re.box&&Re.box.length&&(this.markUsedOrientation(S,le,ai),this.placedOrientations[tr]=le),Re};O(()=>X(to,r.bI.horizontal),()=>{const W=ir.verticalTextBox;return S.allowVerticalPlacement&&Ki>0&&W?(Hn(W),X(W,r.bI.vertical)):{box:null,offscreen:null,occluded:null}}),N(!!(is&&is.box&&is.box.length))}}if(Jr=is,Cr=Jr&&Jr.box&&Jr.box.length>0,sn=Jr&&Jr.offscreen,Yn=Jr&&Jr.occluded,ai.useRuntimeCollisionCircles){const N=S.text.placedSymbolArray.get(ai.centerJustifiedTextSymbolIndex>=0?ai.centerJustifiedTextSymbolIndex:ai.verticalPlacedTextSymbolIndex),O=r.bJ(S.textSizeData,ge,N),X=L.get("text-padding");ln=this.collisionIndex.placeCollisionCircles(S,st,N,S.lineVertexArray,S.glyphOffsetArray,O,V,Y,J,g,lt,Te.predicate,ai.collisionCircleDiameter*O/r.bO,X,this.retainedQueryData[S.bucketInstanceId].tileID),Cr=st||ln.circles.length>0&&!ln.collisionDetected,sn=sn&&ln.offscreen,Yn=ln.occluded}if(ir.iconFeatureIndex&&(Es=ir.iconFeatureIndex),ir.iconBox){const N=O=>{Hn(O);const X=ai.hasIconTextFit&&es?In(es.x,es.y,Xe,lt,this.transform.angle):new r.P(0,0),W=S.getSymbolInstanceIconSize(_e,this.transform.zoom,ai.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,W,O,X,it,te,V,Te.predicate)};uo&&uo.box&&uo.box.length&&ir.verticalIconBox?(yn=N(ir.verticalIconBox),Hr=yn.box.length>0):(yn=N(ir.iconBox),Hr=yn.box.length>0),sn=sn&&yn.offscreen,xs=yn.occluded}const Fn=Qe||ai.numHorizontalGlyphVertices===0&&Ki===0,Io=at||ai.numIconVertices===0;if(Fn||Io?Io?Fn||(Hr=Hr&&Cr):Cr=Hr&&Cr:Hr=Cr=Hr&&Cr,Cr&&Jr&&Jr.box&&this.collisionIndex.insertCollisionBox(Jr.box,L.get("text-ignore-placement"),S.bucketInstanceId,uo&&uo.box&&Qo?Qo:Ps,Te.ID),Hr&&yn&&this.collisionIndex.insertCollisionBox(yn.box,L.get("icon-ignore-placement"),S.bucketInstanceId,Es,Te.ID),ln&&(Cr&&this.collisionIndex.insertCollisionCircles(ln.circles,L.get("text-ignore-placement"),S.bucketInstanceId,Ps,Te.ID),g)){const N=S.bucketInstanceId;let O=this.collisionCircleArrays[N];O===void 0&&(O=this.collisionCircleArrays[N]=new Qh);for(let X=0;X<ln.circles.length;X+=4)O.circles.push(ln.circles[X+0]),O.circles.push(ln.circles[X+1]),O.circles.push(ln.circles[X+2]),O.circles.push(ln.collisionDetected?1:0)}const ks=S.projection.name!=="globe";wt=wt&&(ks||!Yn),oi=oi&&(ks||!xs),this.placements[tr]=new Da(Cr||wt,Hr||oi,sn||S.justReloaded),u.add(tr)},Li=this.retainedQueryData[S.bucketInstanceId].tileID;if(S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,Li),S.elevationType==="road"&&S.updateRoadElevation(Li.canonical),S.updateZOffset(),S.sortFeaturesByY){const ai=S.getSortedSymbolIndexes(this.transform.angle);for(let Mi=ai.length-1;Mi>=0;--Mi){const ir=ai[Mi];mi(S.symbolInstances.get(ir),ir,S.collisionArrays[ir])}S.hasAnyZOffset&&r.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const ai=S.getSortedIndexesByZOffset();for(let Mi=0;Mi<ai.length;++Mi){const ir=ai[Mi];mi(S.symbolInstances.get(ir),ir,S.collisionArrays[ir])}}else for(let ai=n.symbolInstanceStart;ai<n.symbolInstanceEnd;ai++)mi(S.symbolInstances.get(ai),ai,S.collisionArrays[ai]);if(g&&S.bucketInstanceId in this.collisionCircleArrays){const ai=this.collisionCircleArrays[S.bucketInstanceId];r.bi(ai.invProjMatrix,V),ai.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(n,u,g,_){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:M,crossTileID:V}=g,Y=r.bV(u),J=_===r.bI.vertical?M:Y==="left"?w:Y==="center"?S:Y==="right"?L:-1;w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=J>=0&&w!==J?0:V),S>=0&&(n.text.placedSymbolArray.get(S).crossTileID=J>=0&&S!==J?0:V),L>=0&&(n.text.placedSymbolArray.get(L).crossTileID=J>=0&&L!==J?0:V),M>=0&&(n.text.placedSymbolArray.get(M).crossTileID=J>=0&&M!==J?0:V)}markUsedOrientation(n,u,g){const _=u===r.bI.horizontal||u===r.bI.horizontalOnly?u:0,w=u===r.bI.vertical?u:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:V}=g,Y=n.text.placedSymbolArray;S>=0&&(Y.get(S).placedOrientation=_),L>=0&&(Y.get(L).placedOrientation=_),M>=0&&(Y.get(M).placedOrientation=_),V>=0&&(Y.get(V).placedOrientation=w)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(n):1,w=u?u.opacities:{},S=u?u.variableOffsets:{},L=u?u.placedOrientations:{};for(const M in this.placements){const V=this.placements[M],Y=w[M];Y?(this.opacities[M]=new _c(Y,_,V.text,V.icon,null,V.clipped),g=g||V.text!==Y.text.placed||V.icon!==Y.icon.placed):(this.opacities[M]=new _c(null,_,V.text,V.icon,V.skipFade,V.clipped),g=g||V.text||V.icon)}for(const M in w){const V=w[M];if(!this.opacities[M]){const Y=new _c(V,_,!1,!1);Y.isHidden()||(this.opacities[M]=Y,g=g||V.text.placed||V.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in L)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=L[M]);g?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u,g,_){const w=new Set;for(const S of u){const L=S.getBucket(n);L&&S.latestFeatureIndex&&n.fqid===L.layerIds[0]&&(this.updateBucketOpacities(L,w,S,S.collisionBoxArray,g,_,S.tileID,n.scope),L.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(L,S.tileID),L.elevationType==="road"&&L.updateRoadElevation(S.tileID.canonical),L.updateZOffset())}}updateBucketOpacities(n,u,g,_,w,S,L,M){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const V=n.layers[0].layout,Y=n.layers[0].paint,J=!!n.layers[0].dynamicFilter(),Z=new _c(null,0,!1,!1,!0),te=V.get("text-allow-overlap"),de=V.get("icon-allow-overlap"),ue=V.get("text-variable-anchor"),ge=V.get("text-rotation-alignment")==="map",_e=V.get("text-pitch-alignment")==="map",Te=Y.get("symbol-z-offset"),Ne=V.get("symbol-elevation-reference")==="sea",Qe=!Te.isConstant(),at=new _c(null,0,te&&(de||!n.hasIconData()||V.get("icon-optional")),de&&(te||!n.hasTextData()||V.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const st=(Xe,lt,dt)=>{for(let kt=0;kt<lt/4;kt++)Xe.opacityVertexArray.emplaceBack(dt)};let it=0;S&&n.updateReplacement(L,S);for(let Xe=0;Xe<n.symbolInstances.length;Xe++){const lt=n.symbolInstances.get(Xe),{numHorizontalGlyphVertices:dt,numVerticalGlyphVertices:kt,crossTileID:Dt,numIconVertices:ti,tileAnchorX:ri,tileAnchorY:vi}=lt;let Mt=null;const Vt=this.retainedQueryData[n.bucketInstanceId];Qe&&lt&&Vt&&(Mt=g.latestFeatureIndex.loadFeature({featureIndex:lt.featureIndex,bucketIndex:Vt.bucketIndex,sourceLayerIndex:Vt.sourceLayerIndex,layoutVertexArrayOffset:0}));const wt=Te.evaluate(Mt,{}),oi=u.has(Dt);let zt=this.opacities[Dt];oi?zt=Z:zt||(zt=at,this.opacities[Dt]=zt),u.add(Dt);const mi=dt>0||kt>0,Li=ti>0,ai=this.placedOrientations[Dt],Mi=ai===r.bI.vertical,ir=ai===r.bI.horizontal||ai===r.bI.horizontalOnly;!mi&&!Li||zt.isHidden()||it++;let tr=!1;if((mi||Li)&&S)for(const Ki of n.activeReplacements){if(r.bP(Ki,w,r.bQ.Symbol,M)||Ki.min.x>ri||ri>Ki.max.x||Ki.min.y>vi||vi>Ki.max.y)continue;const pr=r.bR(ri,vi,L.canonical,Ki.footprintTileId.canonical);if(tr=r.bS(pr,Ki.footprint),tr)break}if(mi){const Ki=tr?cn:Vr(zt.text);st(n.text,dt,Mi?cn:Ki),st(n.text,kt,ir?cn:Ki);const pr=zt.text.isHidden(),{leftJustifiedTextSymbolIndex:gr,centerJustifiedTextSymbolIndex:Cr,rightJustifiedTextSymbolIndex:Hr,verticalPlacedTextSymbolIndex:sn}=lt,Yn=n.text.placedSymbolArray,xs=pr||Mi?1:0;gr>=0&&(Yn.get(gr).hidden=xs),Cr>=0&&(Yn.get(Cr).hidden=xs),Hr>=0&&(Yn.get(Hr).hidden=xs),sn>=0&&(Yn.get(sn).hidden=pr||ir?1:0);const es=this.variableOffsets[Dt];es&&this.markUsedJustification(n,es.anchor,lt,ai);const is=this.placedOrientations[Dt];is&&(this.markUsedJustification(n,"left",lt,is),this.markUsedOrientation(n,is,lt))}if(Li){const Ki=tr?cn:Vr(zt.icon),{placedIconSymbolIndex:pr,verticalPlacedIconSymbolIndex:gr}=lt,Cr=n.icon.placedSymbolArray,Hr=zt.icon.isHidden()?1:0;pr>=0&&(st(n.icon,ti,Mi?cn:Ki),Cr.get(pr).hidden=Hr),gr>=0&&(st(n.icon,lt.numVerticalIconVertices,ir?cn:Ki),Cr.get(gr).hidden=Hr)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ki=n.collisionArrays[Xe];if(Ki){let pr=new r.P(0,0),gr=!0;if(Ki.textBox||Ki.verticalTextBox){if(ue){const Hr=this.variableOffsets[Dt];Hr?(pr=Mn(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textScale),ge&&pr._rotate(_e?this.transform.angle:-this.transform.angle)):gr=!1}J&&(gr=!zt.clipped),Ki.textBox&&kl(n.textCollisionBox.collisionVertexArray,zt.text.placed,!gr||Mi,wt,Ne,pr.x,pr.y),Ki.verticalTextBox&&kl(n.textCollisionBox.collisionVertexArray,zt.text.placed,!gr||ir,wt,Ne,pr.x,pr.y)}const Cr=gr&&!!(!ir&&Ki.verticalIconBox);Ki.iconBox&&kl(n.iconCollisionBox.collisionVertexArray,zt.icon.placed,Cr,wt,Ne,lt.hasIconTextFit?pr.x:0,lt.hasIconTextFit?pr.y:0),Ki.verticalIconBox&&kl(n.iconCollisionBox.collisionVertexArray,zt.icon.placed,!Cr,wt,Ne,lt.hasIconTextFit?pr.x:0,lt.hasIconTextFit?pr.y:0)}}}if(n.fullyClipped=it===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Xe.invProjMatrix,n.placementViewportMatrix=Xe.viewportMatrix,n.collisionCircleArray=Xe.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>n}setStale(){this.stale=!0}}function kl(p,n,u,g,_,w,S){p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,_?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,_?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,_?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,_?1:0)}const ie=Math.pow(2,25),Ue=Math.pow(2,24),Et=Math.pow(2,17),jt=Math.pow(2,16),hi=Math.pow(2,9),Ti=Math.pow(2,8),mr=Math.pow(2,1);function Vr(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const n=p.placed?1:0,u=Math.floor(127*p.opacity);return u*ie+n*Ue+u*Et+n*jt+u*hi+n*Ti+u*mr+n}const cn=0;class Pn{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,u,g,_,w,S){const L=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(L,_,n[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((M,V)=>M.sortKey-V.sortKey));this._currentPartIndex<L.length;){const M=L[this._currentPartIndex];if(u.placeLayerBucketPart(M,this._seenCrossTileIDs,g,M.symbolInstanceStart===0,S),this._currentPartIndex++,w())return!0}return!1}}class kn{constructor(n,u,g,_,w,S,L,M,V){this.placement=new na(n,w,S,L,M,V),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(n,u,g,_,w){const S=r.q.now(),L=()=>{const M=r.q.now()-S;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=u[n[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=V)&&(!M.maxzoom||M.maxzoom>V)){const Y=M,J=Y.layout.get("symbol-z-elevate"),Z=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,te=Y.layout.get("symbol-z-order"),de=te==="viewport-y"||te==="auto"&&!(te!=="viewport-y"&&Z),ue=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),ge=de&&ue,_e=this._inProgressLayer=this._inProgressLayer||new Pn(Y),Te=r.C(M.source,M.scope);if(_e.continuePlacement(J||ge?_[Te]:g[Te],this.placement,this._showCollisionBoxes,M,L,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const hs=512/r.aj/2;class Zs{constructor(n,u,g){this.tileID=n,this.bucketInstanceId=g,this.index=new r.bW(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=n.canonical.x*r.aj,w=n.canonical.y*r.aj;for(let S=0;S<u.length;S++){const{key:L,crossTileID:M,tileAnchorX:V,tileAnchorY:Y}=u.get(S),J=Math.floor((_+V)*hs),Z=Math.floor((w+Y)*hs);this.index.add(J,Z),this.keys.push(L),this.crossTileIDs.push(M)}this.index.finish()}findMatches(n,u,g){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),w=hs/Math.pow(2,u.canonical.z-this.tileID.canonical.z),S=u.canonical.x*r.aj,L=u.canonical.y*r.aj;for(let M=0;M<n.length;M++){const V=n.get(M);if(V.crossTileID)continue;const{key:Y,tileAnchorX:J,tileAnchorY:Z}=V,te=Math.floor((S+J)*w),de=Math.floor((L+Z)*w),ue=this.index.range(te-_,de-_,te+_,de+_).sort((ge,_e)=>ge-_e);for(const ge of ue){const _e=this.crossTileIDs[ge];if(this.keys[ge]===Y&&!g.has(_e)){g.add(_e),V.crossTileID=_e;break}}}}}class Zn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const g in this.indexes){const _=this.indexes[g],w={};for(const S in _){const L=_[S];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+u),w[L.tileID.key]=L}this.indexes[g]=w}this.lng=n}addBucket(n,u,g){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const _=this.usedCrossTileIDs[n.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>n.overscaledZ)for(const L in S){const M=S[L];M.tileID.isChildOf(n)&&M.findMatches(u.symbolInstances,n,_)}else{const L=S[n.scaledTo(Number(w)).key];L&&L.findMatches(u.symbolInstances,n,_)}}for(let w=0;w<u.symbolInstances.length;w++){const S=u.symbolInstances.get(w);S.crossTileID||(S.crossTileID=g.generate(),_.add(S.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Zs(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[n].delete(g)}removeStaleBuckets(n){let u=!1;for(const g in this.indexes){const _=this.indexes[g];for(const w in _)n[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,_[w]),delete _[w],u=!0)}return u}}class Js{constructor(){this.layerIndexes={},this.crossTileIDs=new Zn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,g,_){let w=this.layerIndexes[n.fqid];w===void 0&&(w=this.layerIndexes[n.fqid]=new xn);let S=!1;const L={};_.name!=="globe"&&w.handleWrapJump(g);for(const M of u){const V=M.getBucket(n);V&&n.fqid===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(M.tileID,V,this.crossTileIDs)&&(S=!0),L[V.bucketInstanceId]=!0)}return w.removeStaleBuckets(L)&&(S=!0),S}pruneUnusedLayers(n){const u={};n.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const yo=771;class Wr{constructor(n,u,g,_){this.blendFunction=n,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=g,this.blendEquation=_}}Wr.Replace=[1,0,1,0],Wr.disabled=new Wr(Wr.Replace,r.am.transparent,[!1,!1,!1,!1]),Wr.unblended=new Wr(Wr.Replace,r.am.transparent,[!0,!0,!0,!0]),Wr.alphaBlended=new Wr([1,yo,1,yo],r.am.transparent,[!0,!0,!0,!0]),Wr.alphaBlendedNonPremultiplied=new Wr([770,yo,770,yo],r.am.transparent,[!0,!0,!0,!0]),Wr.multiply=new Wr([774,0,774,0],r.am.transparent,[!0,!0,!0,!0]);class ji{constructor(n,u,g){this.func=n,this.mask=u,this.range=g}}ji.ReadOnly=!1,ji.ReadWrite=!0,ji.disabled=new ji(519,ji.ReadOnly,[0,1]);const eo=7680;class Pr{constructor(n,u,g,_,w,S){this.test=n,this.ref=u,this.mask=g,this.fail=_,this.depthFail=w,this.pass=S}}Pr.disabled=new Pr({func:519,mask:0},0,0,eo,eo,eo);const Cs=1029,ao=2305;class wr{constructor(n,u,g){this.enable=n,this.mode=u,this.frontFace=g}}function vo(p,n){const u=r.c1(p,3);r.c3(p,n),r.c7(p,3,u)}function ic(p,n){const u=r.b_([]);return r.b$(u,u,-n),r.c0(u,u,-p),u}function pa(p,n){const u=[p[0],p[1],0],g=[n[0],n[1],0];if(r.ae(u)>=1e-15){const S=r.au([],u);r.bY(g,S,r.bG(g,S)),n[0]=g[0],n[1]=g[1]}const _=r.bF([],n,p);if(r.bZ(_)<1e-15)return null;const w=Math.atan2(-_[1],_[0]);return ic(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),w)}wr.disabled=new wr(!1,Cs,ao),wr.backCCW=new wr(!0,Cs,ao),wr.backCW=new wr(!0,Cs,2304),wr.frontCW=new wr(!0,1028,2304),wr.frontCCW=new wr(!0,1028,ao);class Xo{constructor(n,u){this.position=n,this.orientation=u}get position(){return this._position}set position(n){if(n){const u=n instanceof r.ac?n:new r.ac(n[0],n[1],n[2]);this._renderWorldCopies&&(u.x=r.bX(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(n,u){if(this.orientation=null,!this.position)return;const g=this.position,_=this._elevation?this._elevation.getAtPointOrZero(r.ac.fromLngLat(n)):0,w=r.ac.fromLngLat(n,_),S=[w.x-g.x,w.y-g.y,w.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=pa(S,u)}setPitchBearing(n,u){this.orientation=ic(r.al(n),r.al(-u))}}class Jn{constructor(n,u){this._transform=r.bx([]),this.orientation=u,this.position=n}get mercatorPosition(){const n=this.position;return new r.ac(n[0],n[1],n[2])}get position(){const n=r.c1(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var u;n&&r.c7(this._transform,3,[(u=n)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||r.b_([]),n&&vo(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,u){this._orientation=ic(n,u),vo(this._transform,this._orientation)}forward(){const n=r.c1(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=r.c1(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=r.c1(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,u){const g=new Float64Array(16);return r.bi(g,this.getWorldToCamera(n,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,u,g){const _=this.position;r.bY(_,_,-n);const w=new Float64Array(16);return r.bn(w,[g,g,g]),r.bo(w,w,_),w[10]*=u,w}getWorldToCamera(n,u){const g=new Float64Array(16),_=new Float64Array(4),w=this.position;return r.c2(_,this._orientation),r.bY(w,w,-n),r.c3(g,_),r.bo(g,g,w),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(n,u,g,_){const w=new Float64Array(16);return r.c4(w,n,u,g,_),w}getCameraToClipOrthographic(n,u,g,_,w,S){const L=new Float64Array(16);return r.c5(L,n,u,g,_,w,S),L}getDistanceToElevation(n,u=!1){const g=n===0?0:r.c6(n,u?r.aY(this.position[1]):this.position[1]),_=this.forward();return(g-this.position[2])/_[2]}clone(){return new Jn([...this.position],[...this.orientation])}}const Yo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class xc{constructor(n=0,u=0,g=0,_=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=g,this.right=_}interpolate(n,u,g){return u.top!=null&&n.top!=null&&(this.top=r.ai(n.top,u.top,g)),u.bottom!=null&&n.bottom!=null&&(this.bottom=r.ai(n.bottom,u.bottom,g)),u.left!=null&&n.left!=null&&(this.left=r.ai(n.left,u.left,g)),u.right!=null&&n.right!=null&&(this.right=r.ai(n.right,u.right,g)),this}getCenter(n,u){const g=r.ay((this.left+n-this.right)/2,0,n),_=r.ay((this.top+u-this.bottom)/2,0,u);return new r.P(g,_)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new xc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const So=15;class Oa{constructor(n,u,g,_,w,S,L){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=_??60,this.setProjection(S),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new r.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new xc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Jn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const n=new Oa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n._allowWorldUnderZoom=this._allowWorldUnderZoom,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<So}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(n||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return r.aF(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=r.ce(this.projectionOptions);const g=this.getProjection(),_=!r.bv(u,g);return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.ce({name:"mercator"});const u=n!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bX(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const u=-n*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=r.cf(),r.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const u=r.ay(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=r.al(n),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const n=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let _=0,w=0;for(let S=0;S<u.length;S++){const L=new r.P(u[S][0]*this.width,g+u[S][1]*(this.height-g)),M=n.pointCoordinate(L);if(!M)continue;const V=1/Math.hypot(M[0]-this._camera.position[0],M[1]-this._camera.position[1]);_+=M[3]*V,w+=V}return w===0?NaN:_/w}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,_=this._mercatorZfromZoom(n),w=this._mercatorZfromZoom(this._maxZoom),S=Math.max(_-g,w);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let g;g=n.z<this._camera.position[2]?[u.x,u.y,u.z]:[n.x,n.y,n.z];const _=r.ae(r.at([],this._camera.position,g));return r.ay(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let u=!1;if(n.orientation&&!r.ch(n.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(n.orientation)),n.position){const g=[n.position.x,n.position.y,n.position.z];r.ci(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,u=new Xo;return u.position=new r.ac(n[0],n[1],n[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(n){if(!r.cj(n))return!1;r.ck(n,n);const u=r.cl([],[0,0,-1],n),g=r.cl([],[0,-1,0],n);if(g[2]<0)return!1;const _=pa(u,g);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(n){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;n[2]=r.ay(n[2],_/g,_/u),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,g){this._unmodified=!1,this._edgeInsets.interpolate(n,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(n){const u=[new r.cm(0,n)];if(this.renderWorldCopies){const g=this.pointCoordinate(new r.P(0,0)),_=this.pointCoordinate(new r.P(this.width,0)),w=this.pointCoordinate(new r.P(this.width,this.height)),S=this.pointCoordinate(new r.P(0,this.height)),L=Math.floor(Math.min(g.x,_.x,w.x,S.x)),M=Math.floor(Math.max(g.x,_.x,w.x,S.x)),V=1;for(let Y=L-V;Y<=M+V;Y++)Y!==0&&u.push(new r.cm(Y,n))}return u}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,u,g){let _=[];const w=g!=null,S=!w;if(S&&this.zoom<u||w&&g[0]===0&&g[1]===0)return _;const L=new Set,M=(Y,J,Z,te,de)=>{const ue=r.cK(J,Y,Z,te,de);L.has(ue)||(_.push(new r.aM(Y,J,Z,te,de)),L.add(ue))};for(let Y=0;Y<n.length;Y++){const J=n[Y];if(S&&J.canonical.z!==u)continue;const Z=J.canonical,te=J.overscaledZ,de=J.wrap,ue=1<<Z.z,ge=Z.x+1<ue,_e=Z.x>0,Te=Z.y+1<ue,Ne=Z.y>0,Qe=J.wrap-(_e?0:1),at=J.wrap+(ge?0:1),st=_e?Z.x-1:ue-1,it=ge?Z.x+1:0;if(w)g[0]<0?(M(te,at,Z.z,it,Z.y),g[1]<0&&Te&&(M(te,de,Z.z,Z.x,Z.y+1),M(te,at,Z.z,it,Z.y+1)),g[1]>0&&Ne&&(M(te,de,Z.z,Z.x,Z.y-1),M(te,at,Z.z,it,Z.y-1))):g[0]>0?(M(te,Qe,Z.z,st,Z.y),g[1]<0&&Te&&(M(te,de,Z.z,Z.x,Z.y+1),M(te,Qe,Z.z,st,Z.y+1)),g[1]>0&&Ne&&(M(te,de,Z.z,Z.x,Z.y-1),M(te,Qe,Z.z,st,Z.y-1))):g[1]<0&&Te?M(te,de,Z.z,Z.x,Z.y+1):Ne&&M(te,de,Z.z,Z.x,Z.y-1);else{const Xe=J.visibleQuadrants;1&Xe&&(M(te,Qe,Z.z,st,Z.y),Ne&&(M(te,de,Z.z,Z.x,Z.y-1),M(te,Qe,Z.z,st,Z.y-1))),2&Xe&&(M(te,at,Z.z,it,Z.y),Ne&&(M(te,de,Z.z,Z.x,Z.y-1),M(te,at,Z.z,it,Z.y-1))),4&Xe&&(M(te,Qe,Z.z,st,Z.y),Te&&(M(te,de,Z.z,Z.x,Z.y+1),M(te,Qe,Z.z,st,Z.y+1))),8&Xe&&(M(te,at,Z.z,it,Z.y),Te&&(M(te,de,Z.z,Z.x,Z.y+1),M(te,at,Z.z,it,Z.y+1)))}}const V=[];for(const Y of _)_.some(J=>Y.isChildOf(J))||V.push(Y);if(_=V.filter(Y=>!n.some(J=>!!(Y.overscaledZ<u&&J.isChildOf(Y))||Y.equals(J)||Y.isChildOf(J))),S){const Y=1<<u,J=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Z=[Y*J.x,Y*J.y],te=4,de=te*te;_=_.filter(ue=>{const ge=ue.canonical.x+.5-Z[0],_e=ue.canonical.y+.5-Z[1];return ge*ge+_e*_e<de})}return _}coveringTiles(n){let u=this.coveringZoomLevel(n);const g=u,_=this.elevation&&this.elevation.exaggeration(),w=_&&!n.isTerrainDEM,S=this.projection.name==="mercator";if(n.minzoom!==void 0&&u<n.minzoom)return[];n.maxzoom!==void 0&&u>n.maxzoom&&(u=n.maxzoom);const L=this.locationCoordinate(this.center),M=this.center.lat,V=1<<u,Y=[V*L.x,V*L.y,0],J=this.projection.name==="globe",Z=!J,te=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,Z),de=J?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ue=V*r.c6(1,this.center.lat),ge=this._camera.position[2]/r.c6(1,this.center.lat),_e=[V*de.x,V*de.y,ge*(Z?1:ue)],Te=J||_,Ne=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),Qe=this.isLODDisabled(!0)?u:0;let at;if(this._elevation&&n.isTerrainDEM)at=1e4*this._elevation.exaggeration();else if(this._elevation){const wt=this._elevation.getMinMaxForVisibleTiles();at=wt?wt.max:this._centerAltitude}else at=this._centerAltitude;const st=n.isTerrainDEM?-at:this._elevation?this._elevation.getMinElevationBelowMSL():0,it=this.projection.isReprojectedInTileSpace?r.co(this):1,Xe=wt=>{const zt=new r.ac(wt.x+25e-6,wt.y,wt.z),mi=new r.ac(wt.x,wt.y+25e-6,wt.z),Li=wt.toLngLat(),ai=zt.toLngLat(),Mi=mi.toLngLat(),ir=this.locationCoordinate(Li),tr=this.locationCoordinate(ai),Ki=this.locationCoordinate(Mi),pr=Math.hypot(tr.x-ir.x,tr.y-ir.y),gr=Math.hypot(Ki.x-ir.x,Ki.y-ir.y);return Math.sqrt(pr*gr)*it/25e-6},lt=wt=>{const oi=at,zt=st;return{aabb:r.cr(this,V,0,0,0,wt,zt,oi,this.projection),zoom:0,x:0,y:0,minZ:zt,maxZ:oi,wrap:wt,fullyVisible:!1}},dt=[];let kt=[];const Dt=u,ti=n.reparseOverscaled?g:u,ri=(ge-this._centerAltitude)*ue,vi=wt=>{if(!this._elevation||!wt.tileID||!S)return;const oi=this._elevation.getMinMaxForTile(wt.tileID),zt=wt.aabb;oi?(zt.min[2]=oi.min,zt.max[2]=oi.max,zt.center[2]=(zt.min[2]+zt.max[2])/2):(wt.shouldSplit=Vt(wt),wt.shouldSplit||(zt.min[2]=zt.max[2]=zt.center[2]=this._centerAltitude))},Mt=(wt,oi)=>{if(.707*oi<wt)return 1;const zt=oi/wt;return zt/(1.4144271570014144+(Math.pow(1.1,zt-1.4144271570014144+1)-1)/(1.1-1)-1)},Vt=wt=>{if(wt.zoom<Qe)return!0;if(wt.zoom===Dt)return!1;if(wt.shouldSplit!=null)return wt.shouldSplit;const oi=wt.aabb.distanceX(_e),zt=wt.aabb.distanceY(_e);let mi=ri,Li=1;if(J){mi=wt.aabb.distanceZ(_e);const gr=Math.pow(2,wt.zoom),Cr=r.aY((wt.y+1)/gr),Hr=r.aY(wt.y/gr),sn=Math.min(Math.max(M,Cr),Hr),Yn=r.cO(sn)/r.cO(M);if(Li=sn===M?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Yn/this._mercatorScaleRatio),this.zoom<=r.cL&&wt.zoom===Dt-1&&Yn>=.9)return!0}else if(w&&(mi=wt.aabb.distanceZ(_e)*ue),this.projection.isReprojectedInTileSpace&&g<=5){const gr=Math.pow(2,wt.zoom),Cr=Xe(new r.ac((wt.x+.5)/gr,(wt.y+.5)/gr));Li=Cr>.85?1:Cr}if(!S){const gr=Math.sqrt(oi*oi+zt*zt+mi*mi);let Cr=(1<<Dt-wt.zoom)*Ne*Li;return Cr*=Mt(Math.max(mi,ri),gr),gr<Cr}let ai=Number.MAX_VALUE,Mi=0;const ir=wt.aabb.getCorners(),tr=[];for(const gr of ir){r.at(tr,gr,_e),J||(w?tr[2]*=ue:tr[2]=ri);const Cr=r.bG(tr,this._camera.forward());Cr<ai&&(ai=Cr,Mi=Math.abs(tr[2]))}let Ki=(1<<Dt-wt.zoom)*Ne*Li;if(Ki*=Mt(Math.max(Mi,ri),ai),ai<Ki)return!0;const pr=wt.aabb.closestPoint(Y);return pr[0]===Y[0]&&pr[1]===Y[1]};if(this.renderWorldCopies)for(let wt=1;wt<=3;wt++)dt.push(lt(-wt)),dt.push(lt(wt));for(dt.push(lt(0));dt.length>0;){const wt=dt.pop(),oi=wt.x,zt=wt.y;let mi=wt.fullyVisible;const Li=()=>this.projection.name==="globe"&&(wt.y===0||wt.y===(1<<wt.zoom)-1);if(!mi){let ai=Te?wt.aabb.intersects(te):wt.aabb.intersectsFlat(te);if(ai===0&&Li()){const Mi=new r.cp(wt.zoom,oi,zt);ai=r.cq(this,V,Mi,!0).intersects(te)}if(ai===0)continue;mi=ai===2}if(wt.zoom!==Dt&&Vt(wt))for(let ai=0;ai<4;ai++){const Mi=(oi<<1)+ai%2,ir=(zt<<1)+(ai>>1),tr={aabb:S?wt.aabb.quadrant(ai):r.cr(this,V,wt.zoom+1,Mi,ir,wt.wrap,wt.minZ,wt.maxZ,this.projection),zoom:wt.zoom+1,x:Mi,y:ir,wrap:wt.wrap,fullyVisible:mi,tileID:void 0,shouldSplit:void 0,minZ:wt.minZ,maxZ:wt.maxZ};w&&!J&&(tr.tileID=new r.aM(wt.zoom+1===Dt?ti:wt.zoom+1,wt.wrap,wt.zoom+1,Mi,ir),vi(tr)),dt.push(tr)}else{const ai=wt.zoom===Dt?ti:wt.zoom;if(n.minzoom&&n.minzoom>ai)continue;let Mi=0;if(!mi){let pr=Te?wt.aabb.intersectsPrecise(te):wt.aabb.intersectsPreciseFlat(te);if(pr===0&&Li()){const gr=new r.cp(wt.zoom,oi,zt);pr=r.cq(this,V,gr,!0).intersectsPrecise(te)}if(pr===0)continue;if(n.calculateQuadrantVisibility)if(te.containsPoint(wt.aabb.center))Mi=15;else for(let gr=0;gr<4;gr++)wt.aabb.quadrant(gr).intersects(te)!==0&&(Mi|=1<<gr)}const ir=Y[0]-(.5+oi+(wt.wrap<<wt.zoom))*(1<<u-wt.zoom),tr=Y[1]-.5-zt,Ki=wt.tileID?wt.tileID:new r.aM(ai,wt.wrap,wt.zoom,oi,zt);n.calculateQuadrantVisibility&&(Ki.visibleQuadrants=Mi),kt.push({tileID:Ki,distanceSq:ir*ir+tr*tr})}}if(this.fogCullDistSq){const wt=this.fogCullDistSq,oi=this.horizonLineFromTop();kt=kt.filter(zt=>{const mi=[0,0,0,1],Li=[r.aj,r.aj,0,1],ai=this.calculateFogTileMatrix(zt.tileID.toUnwrapped());r.aA(mi,mi,ai),r.aA(Li,Li,ai);const Mi=r.cs([],mi,Li),ir=r.ct([],mi,Li),tr=r.cM(Mi,ir);if(tr===0)return!0;let Ki=!1;const pr=this._elevation;if(pr&&tr>wt&&oi!==0){const gr=this.calculateProjMatrix(zt.tileID.toUnwrapped());let Cr;n.isTerrainDEM||(Cr=pr.getMinMaxForTile(zt.tileID)),Cr||(Cr={min:st,max:at});const Hr=r.cu(this.rotation),sn=[Hr[0]*r.aj,Hr[1]*r.aj,Cr.max];r.ad(sn,sn,gr),Ki=(1-sn[1])*this.height*.5<oi}return tr<wt||Ki})}return kt.sort((wt,oi)=>wt.distanceSq-oi.distanceSq).map(wt=>wt.tileID)}resize(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const u=r.ay(n.lat,-85.051129,r.cv),g=this.projection.project(n.lng,u);return new r.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,u){let g,_;const w=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;g=(u.x-w.x)/L,_=(u.y-w.y)/L}else{const L=this.pointCoordinate(u),M=this.pointCoordinate(w);g=L.x-M.x,_=L.y-M.y}const S=this.locationCoordinate(n);this.setLocation(new r.ac(S.x-g,S.y-_))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n,u){return this.projection.locationPoint(this,n,u)}locationPoint3D(n,u){return this.projection.locationPoint(this,n,u,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n,u){return this.coordinateLocation(this.pointCoordinate3D(n,u))}locationCoordinate(n,u){const g=u?r.c6(u,n.lat):void 0,_=this.projection.project(n.lng,n.lat);return new r.ac(_.x,_.y,g)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,u){const g=u??this._centerAltitude,_=[n.x,n.y,0,1],w=[n.x,n.y,1,1];r.aA(_,_,this.pixelMatrixInverse),r.aA(w,w,this.pixelMatrixInverse);const S=w[3];r.cw(_,_,1/_[3]),r.cw(w,w,1/S);const L=_[2],M=w[2];return{p0:_,p1:w,t:L===M?0:(g-L)/(M-L)}}screenPointToMercatorRay(n){const u=[n.x,n.y,0,1],g=[n.x,n.y,1,1];return r.aA(u,u,this.pixelMatrixInverse),r.aA(g,g,this.pixelMatrixInverse),r.cw(u,u,1/u[3]),r.cw(g,g,1/g[3]),u[2]=r.c6(u[2],this._center.lat)*this.worldSize,g[2]=r.c6(g[2],this._center.lat)*this.worldSize,r.cw(u,u,1/this.worldSize),r.cw(g,g,1/this.worldSize),new r.av([u[0],u[1],u[2]],r.au([],r.at([],g,u)))}rayIntersectionCoordinate(n){const{p0:u,p1:g,t:_}=n,w=r.c6(u[2],this._center.lat),S=r.c6(g[2],this._center.lat);return new r.ac(r.ai(u[0],g[0],_)/this.worldSize,r.ai(u[1],g[1],_)/this.worldSize,r.ai(w,S,_))}pointCoordinate(n,u=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,u)}pointCoordinate3D(n,u){if(!this.elevation)return this.pointCoordinate(n,u);let g=this.projection.pointCoordinate3D(this,n.x,n.y);if(g)return new r.ac(g[0],g[1],g[2]);let _=0,w=this.horizonLineFromTop();if(n.y>w)return this.pointCoordinate(n,u);const S=.02*w,L=n.clone();for(let M=0;M<10&&w-_>S;M++){L.y=r.ai(_,w,.66);const V=this.projection.pointCoordinate3D(this,L.x,L.y);V?(w=L.y,g=V):_=L.y}return g?new r.ac(g[0],g[1],g[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=r.cx)return!this.isPointAboveHorizon(n);const u=this.pointCoordinate(n);return u.y>=0&&u.y<=1}_coordinatePoint(n,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,_=[n.x*this.worldSize,n.y*this.worldSize,g+n.toAltitude(),1];return r.aA(_,_,this.pixelMatrix),_[3]>0?new r.P(_[0]/_[3],_[1]/_[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,w=this.pointLocation3D(new r.P(u,n)),S=this.pointLocation3D(new r.P(_,n)),L=this.pointLocation3D(new r.P(_,g)),M=this.pointLocation3D(new r.P(u,g));let V=Math.min(w.lng,S.lng,L.lng,M.lng),Y=Math.max(w.lng,S.lng,L.lng,M.lng),J=Math.min(w.lat,S.lat,L.lat,M.lat),Z=Math.max(w.lat,S.lat,L.lat,M.lat);const te=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,ue=(ge,_e,Te,Ne,Qe)=>{const at=(ge+Te)/2,st=(_e+Ne)/2,it=new r.P(at,st),{lng:Xe,lat:lt}=this.pointLocation3D(it),dt=Math.max(0,V-Xe,J-lt,Xe-Y,lt-Z);V=Math.min(V,Xe),Y=Math.max(Y,Xe),J=Math.min(J,lt),Z=Math.max(Z,lt),(Qe<de||dt>te)&&(ue(ge,_e,at,st,Qe+1),ue(at,st,Te,Ne,Qe+1))};if(ue(u,n,_,n,1),ue(_,n,_,g,1),ue(_,g,u,g,1),ue(u,g,u,n,1),this.projection.name==="globe"){const[ge,_e]=r.cy(this);ge?(Z=90,Y=180,V=-180):_e&&(J=-90,Y=180,V=-180)}return new r.aG(new r.cd(V,J),new r.cd(Y,Z))}_getBoundsRectangular(n,u){const{top:g,left:_}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,L=new r.P(_,g),M=new r.P(S,g),V=new r.P(S,w),Y=new r.P(_,w);let J=this.pointCoordinate(L,n),Z=this.pointCoordinate(M,n);const te=this.pointCoordinate(V,u),de=this.pointCoordinate(Y,u),ue=(ge,_e)=>(_e.y-ge.y)/(_e.x-ge.x);return J.y>1&&Z.y>=0?J=new r.ac((1-de.y)/ue(de,J)+de.x,1):J.y<0&&Z.y<=1&&(J=new r.ac(-de.y/ue(de,J)+de.x,0)),Z.y>1&&J.y>=0?Z=new r.ac((1-te.y)/ue(te,Z)+te.x,1):Z.y<0&&J.y<=1&&(Z=new r.ac(-te.y/ue(te,Z)+te.x,0)),new r.aG().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=n.visibleDemTiles.reduce((g,_)=>{if(_.dem){const w=_.dem.tree;g.min=Math.min(g.min,w.minimums[0]),g.max=Math.max(g.max,w.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*n.exaggeration(),u.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return n?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-85.051129,this.maxLat=r.cv,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.aD(this.minLng)*this.tileSize,this.worldMaxX=r.aD(this.maxLng)*this.tileSize,this.worldMinY=r.aH(this.maxLat)*this.tileSize,this.worldMaxY=r.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,u){return this.projection.createTileMatrix(this,u,n)}calculateDistanceTileData(n){const u=n.key,g=this._distanceTileDataCache;if(g[u])return g[u];const _=n.canonical,w=1/this.height,S=this.cameraWorldSize,L=S/this.zoomScale(_.z),M=(_.x+Math.pow(2,_.z)*n.wrap)*L,V=_.y*L,Y=this.point;Y.x*=S/this.worldSize,Y.y*=S/this.worldSize;const J=this.angle,Z=Math.sin(-J),te=-Math.cos(-J);return g[u]={bearing:[Z,te],center:[(Y.x-M)*w,(Y.y-V)*w],scale:L/r.aj*w},g[u]}calculateFogTileMatrix(n){const u=n.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return r.az(_,this.worldToFogMatrix,_),g[u]=new Float32Array(_),g[u]}calculateProjMatrix(n,u=!1,g=!1){const _=n.key;let w;if(w=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,w[_])return w[_];const S=this.calculatePosMatrix(n,this.worldSize);let L;return L=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,r.az(S,L,S),w[_]=new Float32Array(S),w[_]}calculatePixelsToTileUnitsMatrix(n){const u=n.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const _=r.cz(n,this);return g[u]=_,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,u=r.bn([],[n,n,n]);return r.az(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const u=r.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),_=this._camera.forward(),w=r.c6(1,this._center.lat);g[2]/=w,_[2]/=w,r.au(_,_);const S=n.raycast(g,_,n.exaggeration());if(S){const L=r.bE([],g,_,S),M=new r.ac(L[0],L[1],r.c6(L[2],r.aY(L[1]))),V=(M.z+r.ae([M.x-g[0],M.y-g[1],M.z-g[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=M.toAltitude(),this._center=this.coordinateLocation(M),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const u=this._elevation,g=r.c6(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(g),w=u.getAtPointOrZero(new r.ac(..._)),S=this.pixelsPerMeter/this.worldSize*w,L=this._minimumHeightOverTerrain(),M=_[2]-S;if(M<=L)if(M<0||n){const V=this.locationCoordinate(this._center,this._centerAltitude),Y=[_[0],_[1],V.z-_[2]],J=r.ae(Y);Y[2]-=(L-M)/this._pixelsPerMercatorPixel;const Z=r.ae(Y);if(Z===0)return;r.bY(Y,Y,J/Z*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],V.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const Z=this.center;return Z.lat=r.ay(Z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(Z.lng=r.ay(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:_}=this.point;let w=0,S=g,L=_;const M=this.width/2,V=this.height/2,Y=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(_-V<Y&&(L=Y+V),_+V>J&&(L=J-V),J-Y<this.height&&(w=Math.max(w,this.height/(J-Y)),L=(J+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,de=this.worldSize/2-(Z+te)/2;S=(g+de+this.worldSize)%this.worldSize-de,S-M<Z&&(S=Z+M),S+M>te&&(S=te-M),te-Z<this.width&&(w=Math.max(w,this.width/(te-Z)),S=(te+Z)/2)}S===g&&L===_||this._allowWorldUnderZoom||(this.center=this.unproject(new r.P(S,L))),w&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.c6(1,this.center.lat)/r.c6(1,r.cP));const _=r.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?g:1,S=this._camera.getWorldToCamera(this.worldSize,w);let L;const M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(M[8]=2*-n.x/this.width,M[9]=2*n.y/this.height,this.isOrthographic){let lt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),dt=lt*this.aspect,kt=-dt,Dt=-lt;dt-=n.x,kt-=n.x,lt+=n.y,Dt+=n.y,L=this._camera.getCameraToClipOrthographic(kt,dt,Dt,lt,this._nearZ,this._farZ),((ti,ri,vi,Mt)=>{for(let Vt=0;Vt<16;Vt++)ti[Vt]=r.ai(ri[Vt],vi[Vt],Mt)})(L,L,M,r.cN(this.pitch>=So?1:this.pitch/So))}else L=M;const V=r.cB([],M,S);let Y=r.cB([],L,S);if(this.projection.isReprojectedInTileSpace){const lt=this.locationCoordinate(this.center),dt=r.bx([]);r.bo(dt,dt,[lt.x*this.worldSize,lt.y*this.worldSize,0]),r.az(dt,dt,r.cC(this)),r.bo(dt,dt,[-lt.x*this.worldSize,-lt.y*this.worldSize,0]),r.az(Y,Y,dt),r.az(V,V,dt),this.inverseAdjustmentMatrix=r.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.cE([],Y,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=Y,this.invProjMatrix=r.bi(new Float64Array(16),this.projMatrix),u){const lt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);lt[8]=2*-n.x/this.width,lt[9]=2*n.y/this.height,this.expandedFarZProjMatrix=r.cB([],lt,S)}else this.expandedFarZProjMatrix=this.projMatrix;const J=r.bi([],L);this.frustumCorners=r.cF.fromInvProjectionMatrix(J,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const Z=new Float32Array(16);r.bx(Z),r.cE(Z,Z,[1,-1,1]),r.cG(Z,Z,this._pitch),r.by(Z,Z,this.angle);const te=r.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.bw(te);const de=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-n.x/this.width,te[9]=2*(n.y+de)/this.height,this.skyboxMatrix=r.az(Z,te,Z);const ue=this.point,ge=ue.x,_e=ue.y,Te=this.width%2/2,Ne=this.height%2/2,Qe=Math.cos(this.angle),at=Math.sin(this.angle),st=ge-Math.round(ge)+Qe*Te+at*Ne,it=_e-Math.round(_e)+Qe*Ne+at*Te,Xe=new Float64Array(Y);if(r.bo(Xe,Xe,[st>.5?st-1:st,it>.5?it-1:it,0]),this.alignedProjMatrix=Xe,Y=r.bz(),r.cE(Y,Y,[this.width/2,-this.height/2,1]),r.bo(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=r.bz(),r.cE(Y,Y,[1,-1,1]),r.bo(Y,Y,[-1,-1,0]),r.cE(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=r.az(new Float64Array(16),this.labelPlaneMatrix,V),this._calcFogMatrices(),this._distanceTileDataCache={},Y=r.bi(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.cH(this);const lt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ad(lt,lt,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,w=[n,n,u];r.bY(w,w,_),r.bY(g,g,-1),r.cI(g,g,w);const S=r.bz();r.bo(S,S,g),r.cE(S,S,w),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,u,_)}_computeCameraPosition(n){const u=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),_=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-n/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-g[0]*w,_.y/this.worldSize-g[1]*w,n/this.worldSize*this._centerAltitude-g[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],_=n[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(w=Math.min((u-g)/_,1)),this._camera.position=r.bE([],this._camera.position,n,w),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:_}=this._camera.getPitchBearing(),w=r.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.al(this._maxPitch)),L=Math.max((n[2]-w)/Math.cos(g),S),M=this._zoomFromMercatorZ(L);r.bE(n,n,u,L),this._pitch=r.ay(g,r.al(this.minPitch),r.al(this.maxPitch)),this.angle=r.bX(_,-Math.PI,Math.PI),this._setZoom(r.ay(M,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.ac(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,n)*this.tileSize))}zoomFromMercatorZAdjusted(n){let u=0,g=r.cx,_=0,w=1/0;for(;g-u>1e-6&&g>u;){const S=u+.5*(g-u),L=this.tileSize*Math.pow(2,S),M=this.getCameraToCenterDistance(this.projection,S,L),V=this.scaleZoom(M/(Math.max(0,n)*this.tileSize)),Y=Math.abs(S-V);Y<w&&(w=Y,_=S),S<V?u=S:g=S}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,u){const g=Math.min(n.x,u.x),_=Math.max(n.x,u.x),w=Math.min(n.y,u.y),S=Math.max(n.y,u.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new r.P(g,w),new r.P(_,S),new r.P(g,S),new r.P(_,w)],M=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const Y of L){const J=this.pointRayIntersection(Y);if(J.t<0)return!0;const Z=this.rayIntersectionCoordinate(J);if(Z.x<M||Z.y<0||Z.x>V||Z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(n,u){const g=r.ae(r.at([],this._camera.position,n)),_=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([u,g,_],w){const S=[u,g,_,1];r.aA(S,S,w);const L=S[3]=Math.max(S[3],1e-6);return S[0]/=L,S[1]/=L,S[2]/=L,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,n))}}getCameraToCenterDistance(n,u=this.zoom,g=this.worldSize){const _=r.cA(n,u,this.width,this.height,1024),w=n.pixelSpaceConversion(this.center.lat,g,_);let S=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(S=r.ai(1,S,r.cN(this.pitch>=So?1:this.pitch/So))),S}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.az(n,n,this.globeMatrix),n}getFrustum(n){return r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const al=(p,n)=>{if(n>0&&p.terrain&&r.w("Cutoff is currently disabled on terrain"),n<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=p.transform,g=Math.max(Math.abs(u._zoom-(p.minCutoffZoom-1)),1),_=u.isLODDisabled(!1)?r.af(60,45,u.pitch):r.af(30,15,u.pitch),w=u._farZ-u._nearZ,S=n*u.height,L=((1-(M=_))*u.cameraToCenterDistance+M*(u._farZ+S))*g;var M;return{shouldRenderCutoff:_<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(L-u._nearZ)/w,(L-S-u._nearZ)/w]}}},Ko={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class yu{constructor(n,u){this.aabb=n,this.lastCascade=u}}class No{add(n,u){const g=this.receivers[n.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[n.key]=new yu(u,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,u,g){const _=r.cW.fromPoints(n.points);let w=0;for(const S in this.receivers){const L=this.receivers[S];if(!L||!_.intersectsAabb(L.aabb))continue;L.aabb.min=_.closestPoint(L.aabb.min),L.aabb.max=_.closestPoint(L.aabb.max);const M=L.aabb.getCorners();for(let V=0;V<g.length;V++){let Y=!0;for(const J of M){const Z=[J[0]*u,J[1]*u,J[2]];if(r.ad(Z,Z,g[V].matrix),Z[0]<-1||Z[0]>1||Z[1]<-1||Z[1]>1){Y=!1;break}}if(L.lastCascade=V,w=Math.max(w,V),Y)break}}return w+1}}class Rl{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new No,this._depthMode=new ji(n.context.gl.LEQUAL,ji.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),n.tp.registerParameter(Ko,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(Ko,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(Ko,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const _=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||_<=0||(this._shadowLayerCount=g.style.order.reduce((de,ue)=>{const ge=g.style._mergedLayers[ue];return de+(ge.hasShadowPass()&&!ge.isHidden(n.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=g.context,S=Ko.shadowMapResolution,L=Ko.shadowMapResolution;if(this._cascades.length===0||Ko.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let de=0;de<Ko.cascadeCount;++de){const ue=g._shadowMapDebug,ge=w.gl,_e=w.createFramebuffer(S,L,ue,"texture"),Te=new r.T(w,{width:S,height:L,data:null},ge.DEPTH_COMPONENT16);if(_e.depthAttachment.set(Te.texture),ue){const Ne=new r.T(w,{width:S,height:L,data:null},ge.RGBA8);_e.colorAttachment.set(Ne.texture)}this._cascades.push({framebuffer:_e,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.cn,scale:0})}}this.shadowDirection=_o(u);let M=0;if(n.elevation){const de=n.elevation,ue=[1e4,-1e4];de.visibleDemTiles.filter(ge=>ge.dem).forEach(ge=>{const _e=ge.dem.tree;ue[0]=Math.min(ue[0],_e.minimums[0]),ue[1]=Math.max(ue[1],_e.maximums[0])}),ue[0]!==1e4&&(M=(ue[1]-ue[0])*de.exaggeration())}const V=1.5*n.cameraToCenterDistance,Y=3*V,J=new Float64Array(16);for(let de=0;de<this._cascades.length;++de){const ue=this._cascades[de];let ge=n.height/50,_e=1;Ko.cascadeCount===1?_e=Y:de===0?_e=V:(ge=V,_e=Y);const[Te,Ne]=Dl(n,this.shadowDirection,ge,_e,Ko.shadowMapResolution,M);ue.scale=n.scale,ue.matrix=Te,ue.boundingSphereRadius=Ne,r.bi(J,ue.matrix),ue.frustum=r.cn.fromInvProjectionMatrix(J,1,0,!0),ue.far=_e}const Z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Z].far,this._cascades[Z].far],this._uniformValues.u_shadow_intensity=_,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ko.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ko.shadowMapResolution,this._uniformValues.u_shadowmap_0=Yo.ShadowMap0,this._uniformValues.u_shadowmap_1=Yo.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const te=g.transform.elevation;for(const de of this._groundShadowTiles){let ue={min:0,max:0};if(te){const ge=te.getMinMaxForTile(de);ge&&(ue=ge)}this.addShadowReceiver(de.toUnwrapped(),ue.min,ue.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,u){if(!this.enabled)return;const g=this.painter,_=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),_.viewport.set([0,0,Ko.shadowMapResolution,Ko.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){g.currentShadowCascade=w,_.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),_.clear({color:r.am.white,depth:1});for(const S of n.order){const L=n._mergedLayers[S];if(!L.hasShadowPass()||L.isHidden(g.transform.zoom))continue;const M=n.getLayerSourceCache(L),V=M?u[M.id]:void 0;(L.type==="model"||V&&V.length)&&g.renderLayer(g,M,L,V)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,u=n.style,g=n.context,_=g.gl,w=u.directionalLight,S=u.ambientLight;if(!w||!S)return;const L=[],M=al(n,n.longestCutoffRange);M.shouldRenderCutoff&&L.push("RENDER_CUTOFF"),L.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&L.push("NORMAL_OFFSET");const V=sa(u,w,S),Y=new ji(_.LEQUAL,ji.ReadOnly,n.depthRangeFor3D),J=new Pr({func:_.EQUAL,mask:255},0,255,_.KEEP,_.KEEP,_.KEEP);for(const Z of this._groundShadowTiles){const te=Z.toUnwrapped(),de=n.isTileAffectedByFog(Z),ue=n.getOrCreateProgram("groundShadow",{defines:L,overrideFog:de});this.setupShadows(te,ue),n.uploadCommonUniforms(g,ue,te,null,M);const ge={u_matrix:n.transform.calculateProjMatrix(te),u_ground_shadow_factor:V};ue.draw(n,_.TRIANGLES,Y,J,Wr.multiply,wr.disabled,ge,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,null,n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Wr.unblended:Wr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const u=this.painter.transform,g=u.calculatePosMatrix(n,u.worldSize);return r.az(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(n){return r.az(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,u,g,_=0){if(!this.enabled)return;const w=this.painter.transform,S=this.painter.context,L=S.gl,M=this._uniformValues,V=new Float64Array(16),Y=w.calculatePosMatrix(n,w.worldSize);for(let J=0;J<this._cascades.length;J++)r.az(V,this._cascades[J].matrix,Y),M[J===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(V),S.activeTexture.set(L.TEXTURE0+Yo.ShadowMap0+J),this._cascades[J].texture.bindExtraParam(L.LINEAR,L.LINEAR,L.CLAMP_TO_EDGE,L.CLAMP_TO_EDGE,L.GREATER);if(this.useNormalOffset=!!g,this.useNormalOffset){const J=r.cU(n.canonical),Z=2/w.tileSize*r.aj/Ko.shadowMapResolution,te=Z*this._cascades[0].boundingSphereRadius,de=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,ue=(g==="vector-tile"?1:3)/Math.pow(2,_-n.canonical.z-(1-w.zoom+Math.floor(w.zoom)));M.u_shadow_normal_offset=[J,te*ue,de*ue],M.u_shadow_bias=[6e-5,.0012,.012]}else M.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(S,M)}setupShadowsFromMatrix(n,u,g=!1){if(!this.enabled)return;const _=this.painter.context,w=_.gl,S=this._uniformValues,L=new Float64Array(16);for(let M=0;M<Ko.cascadeCount;M++)r.az(L,this._cascades[M].matrix,n),S[M===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),_.activeTexture.set(w.TEXTURE0+Yo.ShadowMap0+M),this._cascades[M].texture.bindExtraParam(w.LINEAR,w.LINEAR,w.CLAMP_TO_EDGE,w.CLAMP_TO_EDGE,w.GREATER);if(this.useNormalOffset=g,g){const M=Ko.normalOffset;S.u_shadow_normal_offset=[1,M,M],S.u_shadow_bias=[6e-5,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(_,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,u,g,_){if(_[2]>=0)return{};const w=function(M,V,Y){const J=Y/(1<<M.canonical.z);return new r.cW([M.canonical.x*J+M.wrap*Y,M.canonical.y*J+M.wrap*Y,0],[(M.canonical.x+1)*J+M.wrap*Y,(M.canonical.y+1)*J+M.wrap*Y,V])}(n,u,g).getCorners(),S=u/-_[2];_[0]<0?(r.cV(w[0],w[0],[_[0]*S,0,0]),r.cV(w[3],w[3],[_[0]*S,0,0])):_[0]>0&&(r.cV(w[1],w[1],[_[0]*S,0,0]),r.cV(w[2],w[2],[_[0]*S,0,0])),_[1]<0?(r.cV(w[0],w[0],[0,_[1]*S,0]),r.cV(w[1],w[1],[0,_[1]*S,0])):_[1]>0&&(r.cV(w[2],w[2],[0,_[1]*S,0]),r.cV(w[3],w[3],[0,_[1]*S,0]));const L={};return L.vertices=w,L.planes=[Ia(w[1],w[0],w[4]),Ia(w[2],w[1],w[5]),Ia(w[3],w[2],w[6]),Ia(w[0],w[3],w[7])],L}addShadowReceiver(n,u,g){this._receivers.add(n,r.cW.fromTileIdAndHeight(n,u,g))}getMaxCascadeForTile(n){const u=this._receivers.get(n);return u&&u.lastCascade?u.lastCascade:0}}function Ia(p,n,u){const g=r.at([],u,n),_=r.at([],p,n),w=r.bF([],g,_),S=r.ae(w);return S===0?[0,0,1,0]:(r.bY(w,w,1/S),[w[0],w[1],w[2],-r.bG(w,n)])}function _o(p){const n=p.properties.get("direction"),u=r.cR(n.x,n.y,n.z);u[2]=r.ay(u[2],0,75);const g=r.cT([u[0],u[1],u[2]]);return r.cS(g.x,g.y,g.z)}function sa(p,n,u){const g=n.properties.get("color-use-theme")==="none",_=n.properties.get("color"),w=n.properties.get("intensity"),S=n.properties.get("direction"),L=[S.x,S.y,S.z],M=u.properties.get("color-use-theme")==="none",V=u.properties.get("color"),Y=u.properties.get("intensity"),J=Math.max(r.bG([0,0,1],L),0),Z=[0,0,0];r.bY(Z,V.toPremultipliedRenderColor(M?null:p.getLut(n.scope)).toArray01Linear().slice(0,3),Y);const te=[0,0,0];return r.bY(te,_.toPremultipliedRenderColor(g?null:p.getLut(u.scope)).toArray01Linear().slice(0,3),J*w),r.cY([Z[0]>0?Z[0]/(Z[0]+te[0]):0,Z[1]>0?Z[1]/(Z[1]+te[1]):0,Z[2]>0?Z[2]/(Z[2]+te[2]):0])}function Dl(p,n,u,g,_,w){const S=p.zoom,L=p.scale,M=p.worldSize,V=1/M,Y=p.aspect,J=Math.sqrt(1+Y*Y)*Math.tan(.5*p.fovX),Z=J*J,te=g-u,de=g+u;let ue,ge;Z>te/de?(ue=g,ge=g*J):(ue=.5*de*(1+Z),ge=.5*Math.sqrt(te*te+2*(g*g+u*u)*Z+de*de*Z*Z));const _e=p.projection.pixelsPerMeter(p.center.lat,M),Te=p._camera.getCameraToWorldMercator(),Ne=[0,0,-ue*V];r.ad(Ne,Ne,Te);let Qe=ge*V;const at=p._edgeInsets;if(!(at.left===0&&at.top===0&&at.right===0&&at.bottom===0||at.left===at.right&&at.top===at.bottom)){const mi=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?_e:1),Li=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,u,g);Li[8]=2*-p.centerOffset.x/p.width,Li[9]=2*p.centerOffset.y/p.height;const ai=new Float64Array(16);r.cB(ai,Li,mi);const Mi=new Float64Array(16);r.bi(Mi,ai);const ir=r.cn.fromInvProjectionMatrix(Mi,M,S,!0);for(const tr of ir.points){const Ki=((st=tr)[0]/=L,st[1]/=L,st[2]=r.c6(st[2],p._center.lat),st);Qe=Math.max(Qe,r.bZ(r.cX([],Ne,Ki)))}}var st;Qe*=_/(_-1);const it=Math.acos(n[2]),Xe=Math.atan2(-n[0],-n[1]),lt=new Jn;lt.position=Ne,lt.setPitchBearing(it,Xe);const dt=lt.getWorldToCamera(M,_e),kt=Qe*M,Dt=Math.min(p._mercatorZfromZoom(17)*M*-2,-2*kt),ti=lt.getCameraToClipOrthographic(-kt,kt,-kt,kt,Dt,(kt+w*_e)/n[2]),ri=new Float64Array(16);r.az(ri,ti,dt);const vi=r.cS(Math.floor(1e6*Ne[0])/1e6*M,Math.floor(1e6*Ne[1])/1e6*M,0),Mt=.5*_,Vt=[0,0,0];r.ad(Vt,vi,ri),r.bY(Vt,Vt,Mt);const wt=[Math.floor(Vt[0]),Math.floor(Vt[1]),Math.floor(Vt[2])],oi=[0,0,0];r.at(oi,Vt,wt),r.bY(oi,oi,-1/Mt);const zt=new Float64Array(16);return r.bx(zt),r.bo(zt,zt,oi),r.az(ri,zt,ri),[ri,kt]}class Za extends r.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(n,u){return r.aS(this.requestManager.transformRequest(u,r.R.Model).url).then(g=>{if(!g)return;const _=r.aT(g),w=new r.aU(n,void 0,void 0,_);return w.computeBoundsAndApplyParent(),w}).catch(g=>{if(g&&g.status===404)return null;this.fire(new r.z(new Error(`Could not load model ${n} from ${u}: ${g.message}`)))})}load(n,u,g={forceReload:!1}){this.models[u]||(this.models[u]={});const _=Object.keys(n),w=[],S=[];for(const L of _){const M=n[L];this.hasURLBeenRequested(M)&&!g.forceReload||(this.modelByURL[M]={modelId:L,scope:u},w.push(this.loadModel(L,M)),S.push(L)),this.models[u][L]||(this.models[u][L]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+S.length,Promise.allSettled(w).then(L=>{for(let M=0;M<L.length;M++){const{status:V}=L[M];if(V==="rejected")continue;const{value:Y}=L[M];this.models[u][S[M]]||(this.models[u][S[M]]={model:null,numReferences:1}),this.models[u][S[M]].model=Y}this.numModelsLoading[u]-=S.length,this.fire(new r.A("data",{dataType:"style"}))}).catch(L=>{this.fire(new r.z(new Error(`Could not load models: ${L.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,u,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(n,u):this.getModelByURL(this.modelUris[u][n]))}getModel(n,u){return this.models[u]||(this.models[u]={}),this.models[u][n]?this.models[u][n].model:void 0}getModelByURL(n){if(!n)return null;const u=this.modelByURL[n];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(n,u){return this.models[u]&&this.models[u][n]!==void 0}getModelURIs(n){return this.modelUris[n]||{}}addModel(n,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const _=this.requestManager.normalizeModelURL(u);if((this.hasModel(n,g,{exactIdMatch:!0})||this.hasModelBeenAdded(n,g))&&this.modelUris[g][n]===_)this.models[g][n].numReferences++;else if(this.hasURLBeenRequested(_)){const{scope:w,modelId:S}=this.modelByURL[_];this.models[w][S].numReferences++}else this.modelUris[g][n]=_,this.load({[n]:this.modelUris[g][n]},g)}addModelURLs(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const _ in n)g[_]=this.requestManager.normalizeModelURL(n[_])}reloadModels(n){this.load(this.modelUris[n],n,{forceReload:!0})}addModelsFromBucket(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const _ of n)this.hasModel(_,u,{exactIdMatch:!0})||this.hasURLBeenRequested(_)?this.models[u][_].numReferences++:this.modelUris[u][_]&&!this.hasURLBeenRequested(_)?g[_]=this.modelUris[u][_]:!this.hasURLBeenRequested(_)&&r.cZ(_,!1)&&(this.modelUris[u][_]=this.requestManager.normalizeModelURL(_),g[_]=this.modelUris[u][_]);this.load(g,u)}hasURLBeenRequested(n){return this.modelByURL[n]!==void 0}removeModel(n,u,g=!1){if(this.models[u]&&this.models[u][n]&&(this.models[u][n].numReferences--,this.models[u][n].numReferences===0)){const _=this.modelUris[u][n];g||delete this.modelUris[u][n],delete this.modelByURL[_];const w=this.models[u][n].model;if(!w)return;delete this.models[u][n],w.destroy()}}destroy(){for(const n of Object.keys(this.models))for(const u of Object.keys(this.models[n])){const g=this.models[n][u].model;delete this.models[n][u],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(n.context)}}const ga=new r.a7({data:new r.a8(r.a5.colorTheme.data)}),bc={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Ua(p){return p=p||{},Object.assign(p,bc)}class Ol extends r.E{constructor(n){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._floorplanStates={},r.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=n,this._checkFloorplanVisible(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(n=>{n.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=n.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=n.stylesheet.indoor.buildingFeaturesetId,this._scope=n.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:n=>(n.feature&&n.feature.properties.floorplan&&this.selectFloorplan(n.feature.properties.floorplan),!0)}),this._checkFloorplanVisible()}_onMove(){this._checkFloorplanVisible()}_checkFloorplanVisible(){if(!this._queryFeatureSetId||!this._map.isStyleLoaded())return;const n=()=>{this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.A("floorplangone"))};if(this._map.transform.zoom<13)return void n();const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=this._map.transform.width,_=this._map.transform.height,w=g*(2/3),S=_*(2/3),L=.5*(g-w),M=.5*(_-S),V=[new r.P(L,M),new r.P(L+w,M+S)],Y=this._map.queryRenderedFeatures(V,u);Y.length>0?this._selectedFloorplan&&Y[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=Y[0],this._floorplanSelected()):n()}_floorplanSelected(){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._floorplanStates[this._indoorData.id]=this._floorplanStates[this._indoorData.id]||{},this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[this._indoorData.id]]);const n=this._floorplanStates[this._indoorData.id].selectedBuilding,u=n?this._indoorData.buildings.find(L=>L.id===n):this._indoorData.buildings.length>0?this._indoorData.buildings[0]:null,g=this._floorplanStates[this._indoorData.id].selectedLevel,_=this._indoorData.levels.find(L=>L.id===g),w=this._indoorData.levels.find(L=>!(!u||!u.levels)&&Number(L.levelOrder)===0&&u.levels.includes(L.id)),S=_?_.id:w?w.id:void 0;this.fire(new r.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),u&&this._buildingSelected(u,!1),S&&this._levelSelected(S)}_buildingSelected(n,u){if(!n||!n.id)return void console.warn("IndoorManager: Building or building id is undefined");u&&n.extent&&this._map.fitBounds(n.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=n?n.id:void 0;const g=this._indoorData.levels.filter(_=>n.levels.includes(_.id));this.fire(new r.A("buildingselected",{buildingId:n.id,levels:g}))}_levelSelected(n){const u=this._indoorData.levels.find(g=>g.id===n);u?(this._updateLevels(u,!0),this.fire(new r.A("levelselected",{levelId:u.id}))):console.warn(`IndoorManager: Level with ID ${n} not found in the current floorplan.`)}_updateLevels(n,u){if(!n||!n.id)throw new Error("IndoorManager: Selected level or level ID is undefined");function g(V){const Y=V.indexOf("/floor/");if(Y===-1)return V;const J=Y+7,Z=V.indexOf("/",J);return Z===-1?V.slice(J):V.slice(J,Z)}this._floorplanStates[this._indoorData.id].selectedLevel=n.id;const _=[],w={},S={},L={},M={};for(const V of this._indoorData.levels){if(_.push(V.id),w[V.id]=V.levelOrder>=0?3*Math.abs(V.levelOrder+1):3*Math.abs(V.levelOrder),S[V.id]=V.levelOrder>=0?3*V.levelOrder:0,this.mergeFloors){const Y=g(n.id),J=g(V.id);L[V.id]=J===Y?"true":"false"}else L[V.id]=V.id===n.id?"true":"false";M[V.id]=V.levelOrder<n.levelOrder?"true":"false"}this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",_]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",L]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",n.levelOrder<0)}selectFloorplan(n){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],_=this._map.queryRenderedFeatures(g,u);if(_.length>0){for(const w of _)if(JSON.parse(w.properties["indoor-data"]).id===n){this._selectedFloorplan=w,this._floorplanSelected();break}}}selectBuilding(n){const u=this._indoorData.buildings.find(g=>g.id===n);this._buildingSelected(u,!0)}selectLevel(n){this._levelSelected(n)}}function bl(p){if(!p.metadata||!p.metadata.content_area)return;const n=r.q.devicePixelRatio,{left:u,top:g,width:_,height:w}=p.metadata.content_area,S=u*n,L=g*n;return[S,L,S+_*n,L+w*n]}function Gc(p){if(p)return p.map(([n,u])=>[n*r.q.devicePixelRatio,u*r.q.devicePixelRatio])}class qo{constructor(n,u,g){this.id=n,this.scope=u,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(n){this.missingRequests.has(n.name)||this.pendingRequests.has(n.name)||this.pendingRequests.add(n.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const n=new Map;if(!this.sourceCache.loaded())return n;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return n;const g=this.sourceCache.getSource();if(!(g instanceof pc))return n;const _=u.map(S=>this.sourceCache.getTile(S)),w=g.getImages(_,Array.from(this.pendingRequests));for(const[S,L]of w)n.set(r.I.from({name:S,iconsetId:this.id}),L),this.pendingRequests.delete(S);for(const S of this.pendingRequests)this.missingRequests.add(S);return this.pendingRequests.clear(),n}}const wl=(p,n)=>Ge(p,n&&n.filter(u=>u.identifier!=="source.canvas")),Fa=r.aF(pn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Ul=r.aF(pn,["setCenter","setZoom","setBearing","setPitch"]),vu=new Set(["background","sky","slot","custom"]),Ja={version:8,layers:[],sources:{}},Uu={duration:300,delay:0};class jo extends r.E{constructor(n,u={}){super(),this.map=n,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=r.h({},Uu),this._buildingIndex=new Tn(this),this.crossTileSymbolIndex=new Js,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Ke,this.dispatcher=u.dispatcher?u.dispatcher:new r.D(r.c$(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new It(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new r.d0(n._requestManager,u.localFontFamily?r.d1.all:u.localIdeographFontFamily?r.d1.ideographs:r.d1.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new Za(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",r.d2());const g=this;this._rtlTextPluginCallback=jo.registerForPluginStateChange(_=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(w,S)=>{if(r.d3(w),S&&S.every(L=>L))for(const L in g._sourceCaches){const M=g._sourceCaches[L],V=M.getSource().type;V!=="vector"&&V!=="geojson"||M.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const w=this.getOwnSource(_.sourceId);if(w&&w.vectorLayerIds)for(const S in this._layers){const L=this._layers[S];L.source===w.id&&this._validateLayer(L)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(r.j(n))return n;const u=r.d4(n);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${r.d5(JSON.stringify(n))}`}_diffStyle(n,u,g){this.globalId=this._getGlobalId(n);const _=(w,S)=>{try{S(null,this.setState(w,g))}catch(L){S(L,!1)}};if(typeof n=="string"){const w=this.map._requestManager.normalizeStyleURL(n),S=this.map._requestManager.transformRequest(w,r.R.Style);r.n(S,(L,M)=>{L?this.fire(new r.z(L)):M&&_(M,u)})}else typeof n=="object"&&_(n,u)}loadURL(n,u={}){this.fire(new r.A("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!r.j(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,u.accessToken),this.resolvedImports.add(n);const _=this.importsCache.get(n);if(_)return this._load(_,g);const w=this.map._requestManager.transformRequest(n,r.R.Style);this._request=r.n(w,(S,L)=>{if(this._request=null,S)this.fire(new r.z(S));else if(L)return this.importsCache.set(n,L),this._load(L,g)})}loadJSON(n,u={}){this.fire(new r.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=r.q.frame(()=>{this._request=null,this._load(n,u.validate!==!1)})}loadEmpty(){this.fire(new r.A("dataloading",{dataType:"style"})),this._load(Ja,!1)}_loadImports(n,u,g){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const _=[];for(const w of n){const S=this._createFragmentStyle(w),L=new Promise(Y=>{S.once("style.import.load",Y),S.once("error",Y)}).then(()=>this.mergeAll());if(_.push(L),this.resolvedImports.has(w.url)){S.loadEmpty();continue}const M=w.data||this.importsCache.get(w.url);M?(S.loadJSON(M,{validate:u}),this._isInternalStyle(M)&&(S.globalId=null)):w.url?S.loadURL(w.url,{validate:u}):S.loadEmpty();const V={style:S,id:w.id,config:w.config};if(g){const Y=this.fragments.findIndex(({id:J})=>J===g);this.fragments=this.fragments.slice(0,Y).concat(V).concat(this.fragments.slice(Y))}else this.fragments.push(V)}return Promise.allSettled(_)}getImportGlobalIds(n=this,u=new Set){for(const g of n.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(n){const u=this.scope?r.C(n.id,this.scope):n.id;let g;const _=this._initialConfig&&this._initialConfig[u];(n.config||_)&&(g=r.h({},n.config,_));const w=new jo(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,u){const g=n.indoor?Ua(n.schema):n.schema;if(this._isInternalStyle(n)){const S=r.h({},Ja,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(S,u)}if(this.updateConfig(this._config,g),u&&wl(this,ro(n)))return;this._loaded=!0,this.stylesheet=r.d6(n);const _=()=>{for(const V in n.sources)this.addSource(V,n.sources[V],{validate:!1,isInitialLoad:!0});if(n.iconsets)for(const V in n.iconsets)this.addIconset(V,n.iconsets[V]);n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(n.glyphs);const S=uh(this.stylesheet.layers);if(this._order=S.map(V=>V.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const V=this.stylesheet.lights[0];this.light=new Rt(V.properties,V.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Rt(this.stylesheet.light)),this._layers={};for(const V of S){const Y=r.db(V,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const J=this.getOwnLayerSourceCache(Y),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();J&&Y.canCastShadows()&&Z&&(J.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const L=this.stylesheet.terrain;L&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(L,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.A("data",{dataType:"style"}));const M=this.isRootStyle();n.imports?this._loadImports(n.imports,u).then(()=>{this._reloadImports(),this.fire(new r.A(M?"style.load":"style.import.load"))}).catch(V=>{this.fire(new r.z(new Error("Failed to load imports",V))),this.fire(new r.A(M?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.A(M?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const S=this._evaluateColorThemeData(w);this._loadColorTheme(S).then(()=>{_()}).catch(L=>{r.w(`Couldn't load color theme from the stylesheet: ${L}`),_()})}else this._styleColorTheme.lut=null,_()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,u,g,_,w,S,L,M,V,Y;const J={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Z=>{if(Z.stylesheet){if(Z.light!=null&&(n=Z.light),Z.stylesheet.lights)for(const te of Z.stylesheet.lights)te.type==="ambient"&&Z.ambientLight!=null&&(u=Z.ambientLight),te.type==="directional"&&Z.directionalLight!=null&&(g=Z.directionalLight);_=this._prioritizeTerrain(_,Z.terrain,Z.stylesheet.terrain),Z.stylesheet.fog&&Z.fog!=null&&(w=Z.fog),Z.stylesheet.snow&&Z.snow!=null&&(S=Z.snow),Z.stylesheet.rain&&Z.rain!=null&&(L=Z.rain),Z.stylesheet.camera!=null&&(Y=Z.stylesheet.camera),Z.stylesheet.projection!=null&&(M=Z.stylesheet.projection),Z.stylesheet.transition!=null&&(V=Z.stylesheet.transition),J[Z.scope]=Z._styleColorTheme}}),this.light=n,this.ambientLight=u,this.directionalLight=g,this.fog=w,this.snow=S,this.rain=L,this._styleColorThemeForScope=J,_===null?delete this.terrain:this.terrain=_,this.camera=Y||{"camera-projection":"perspective"},this.projection=M||{name:"mercator"},this.transition=r.h({},Uu,V),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const u=g=>{for(const _ of g.fragments)u(_.style);n(g)};u(this)}_prioritizeTerrain(n,u,g){const _=n&&n.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:_?n:null:u!=null&&(!n||_||u&&u.drapeRenderMode===1)?u:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{n=this._prioritizeTerrain(n,u.terrain,u.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(n=u.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},u={},g={};this.forEachFragmentStyle(_=>{for(const w in _._sourceCaches){const S=r.C(w,_.scope);n[S]=_._sourceCaches[w]}for(const w in _._otherSourceCaches){const S=r.C(w,_.scope);u[S]=_._otherSourceCaches[w]}for(const w in _._symbolSourceCaches){const S=r.C(w,_.scope);g[S]=_._symbolSourceCaches[w]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeLayers(){const n={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const S of w._order){const L=w._layers[S];if(L.type==="slot"){const M=r.d7(S);if(n[M])continue;n[M]=[]}L.slot&&n[L.slot]?n[L.slot].push(L):u.push(L)}}),this._mergedOrder=[];const _=(w=[])=>{for(const S of w)if(S.type==="slot"){const L=r.d7(S.id);n[L]&&_(n[L]),this._mergedSlots.push(L)}else{const L=r.C(S.id,S.scope);this._mergedOrder.push(L),g[L]=S,S.is3D(!!this.terrain)&&(this._has3DLayers=!0),S.type==="circle"&&(this._hasCircleLayers=!0),S.type==="symbol"&&(this._hasSymbolLayers=!0),S.type==="clip"&&(this._clipLayerPresent=!0)}};_(u),this._mergedOrder.sort((w,S)=>{const L=g[w],M=g[S];return L.hasInitialOcclusionOpacityProperties?M.is3D(!!this.terrain)?1:0:L.is3D(!!this.terrain)&&M.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=r.h({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?function(u,g,_,w){const S=r.h({},g);for(const M of Object.keys(r.a5.colorTheme))S[M]===void 0&&(S[M]=r.a5.colorTheme[M].default);const L=new r.a6(ga,u,new Map(_));return L.setTransitionOrValue(S,_),L.untransitioned().possiblyEvaluate(new r.aa(0,{worldview:void 0}))}(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,_)=>{const w="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let S=n;S.startsWith(w)||(S=w+S);const L=r.I.from("mapbox-reserved-lut"),M=new Image;M.src=S,M.onerror=()=>{this._styleColorTheme.lutLoading=!1,_(new Error("Failed to load image data"))},M.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:V,height:Y,data:J}=r.q.getImageData(M);if(Y>32)return void _(new Error("The height of the image must be less than or equal to 32 pixels."));if(V!==Y*Y)return void _(new Error("The width of the image must be equal to the height squared."));this.getImage(L)&&this.removeImage(L),this.addImage(L,{data:new r.r({width:V,height:Y},J),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Z=this.imageManager.getImage(L,this.scope);Z?(this._styleColorTheme.lut={image:Z.data,data:n},g()):_(new Error("Missing LUT image."))}})}getLut(n){const u=this._styleColorThemeForScope[n];return u?u.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=function(u,g,_){let w,S,L;const M=r.q.devicePixelRatio>1?"@2x":"";let V=r.n(g.transformRequest(g.normalizeSpriteURL(u,M,".json"),r.R.SpriteJSON),(Z,te)=>{V=null,L||(L=Z,w=te,J())}),Y=r.o(g.transformRequest(g.normalizeSpriteURL(u,M,".png"),r.R.SpriteImage),(Z,te)=>{Y=null,L||(L=Z,S=te,J())});function J(){if(L)_(L);else if(w&&S){const Z=r.q.getImageData(S),te={};for(const de in w){const{width:ue,height:ge,x:_e,y:Te,sdf:Ne,pixelRatio:Qe,stretchX:at,stretchY:st,content:it}=w[de],Xe=new r.r({width:ue,height:ge});r.r.copy(Z,Xe,{x:_e,y:Te},{x:0,y:0},{width:ue,height:ge},null),te[de]={data:Xe,pixelRatio:Qe,sdf:Ne,stretchX:at,stretchY:st,content:it,usvg:!1}}_(null,te)}}return{cancel(){V&&(V.cancel(),V=null),Y&&(Y.cancel(),Y=null)}}}(n,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new r.z(u));else if(g){const _=new Map;for(const w in g)_.set(r.I.from(w),g[w]);this.addImages(_)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))})}addIconset(n,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSourceCache(u.source);if(!g)return void this.fire(new r.z(new Error(`Source "${u.source}" as specified by iconset "${n}" does not exist and cannot be used as an iconset source`)));const _=g.getSource();if(_.type!=="raster-array")return void this.fire(new r.z(new Error(`Source "${u.source}" as specified by iconset "${n}" is not a "raster-array" source and cannot be used as an iconset source`)));_.partial=!1;const w=new qo(n,this.scope,g);this.imageManager.addImageProvider(w,this.scope)}removeIconset(n){this.imageManager.removeImageProvider(n,this.scope)}_loadIconset(n){if(!r.j(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const u=this.map._spriteFormat==="auto";var g,_;this._spriteRequest=(_=(w,S)=>{if(this._spriteRequest=null,w)u?this._loadSprite(n):this.fire(new r.z(w));else if(S){const L=new Map;for(const M in S)L.set(r.I.from(M),S[M]);this.addImages(L)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))},r.br((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(n),r.R.Iconset),(w,S)=>{if(w)return void _(w);const L={},M=r.c_(new r.bq(S));for(const V of M.icons){const Y={version:1,pixelRatio:r.q.devicePixelRatio,content:bl(V),stretchX:V.metadata?Gc(V.metadata.stretch_x_areas):void 0,stretchY:V.metadata?Gc(V.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:V};L[V.name]=Y}_(null,L)}))}_validateLayer(n){const u=this.getOwnSource(n.source);if(!u)return;const g=n.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new r.z(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,u)=>{const g=this.fragments[u];return g&&g.style&&(n.data=g.style.serialize()),n})}_serializeSources(){const n={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();n[g.id]||(n[g.id]=g.serialize())}return n}_serializeLayers(n){const u=[];for(const g of n){const _=this._layers[g];_&&_.type!=="custom"&&u.push(_.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const u=this.getOwnLayer(n);if(u)return u;this.fire(new r.z(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const u=this.getOwnSource(n);if(u)return u;this.fire(new r.z(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,u){const g=this.map.painter;if(g)for(let _=n.minzoom||0;_<(n.maxzoom||25.5);_++){const w=n.getProgramIds();if(w)for(const S of w){const L=n.getDefaultProgramParams(S,u.zoom,this._styleColorTheme.lut);L&&(g.style=this,this.fog&&(g._fogVisible=!0,L.overrideFog=!0,g.getOrCreateProgram(S,L)),g._fogVisible=!1,L.overrideFog=!1,g.getOrCreateProgram(S,L),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(L.overrideRtt=!0,g.getOrCreateProgram(S,L)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const u=this.calculateLightsBrightness();n.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),n.worldview!==this._worldview&&(this._worldview=n.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const g=this._changes.isDirty();let _=!1;if(this._changes.isDirty()){const L=this._changes.getLayerUpdatesByScope();for(const M in L){const{updatedIds:V,removedIds:Y}=L[M];(V||Y)&&(this._updateWorkerLayers(M,V,Y),_=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const w={};for(const L in this._mergedSourceCaches){const M=this._mergedSourceCaches[L];w[L]=M.used,M.used=!1,M.tileCoverLift=0}for(const L of this._mergedOrder){const M=this._mergedLayers[L];if(M.recalculate(n,this._availableImages),!M.isHidden(n.zoom)){const V=this.getLayerSourceCache(M);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,M.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(M,n)}):this.precompilePrograms(M,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&_&&this.mergeLayers();const S=this.imageManager.getPendingImageProviders();for(const L of S)L.sourceCache.used=!0;for(const L in w){const M=this._mergedSourceCaches[L];w[L]!==M.used&&M.getSource().fire(new r.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:M.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new r.A("data",{dataType:"style"}))}updateImageProviders(){const n=this.imageManager.getPendingImageProviders();for(const u of n){const g=u.resolvePendingRequests(),_=this.getFragmentStyle(u.scope);_&&_.addImages(g)}}_updateTilesForChangedImages(){const n={};for(const u in this._mergedSourceCaches){const g=this._mergedSourceCaches[u].getSource().scope;n[g]=n[g]||this._changes.getUpdatedImages(g),n[g].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n[g])}for(const u in n)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(n,u,g){const _=this.getFragmentStyle(n);_&&this.dispatcher.broadcast("updateLayers",{layers:u?_._serializeLayers(u):[],scope:n,removedIds:g||[],options:_.options})}setState(n,u){if(this._checkLoaded(),wl(this,ro(n)))return!1;(n=r.d6(n)).layers=uh(n.layers);const g=function(S,L){if(!S)return[{command:pn.setStyle,args:[L]}];let M=[];try{if(!r.bv(S.version,L.version))return[{command:pn.setStyle,args:[L]}];if(r.bv(S.center,L.center)||M.push({command:pn.setCenter,args:[L.center]}),r.bv(S.zoom,L.zoom)||M.push({command:pn.setZoom,args:[L.zoom]}),r.bv(S.bearing,L.bearing)||M.push({command:pn.setBearing,args:[L.bearing]}),r.bv(S.pitch,L.pitch)||M.push({command:pn.setPitch,args:[L.pitch]}),r.bv(S.sprite,L.sprite)||M.push({command:pn.setSprite,args:[L.sprite]}),r.bv(S.glyphs,L.glyphs)||M.push({command:pn.setGlyphs,args:[L.glyphs]}),r.bv(S.imports,L.imports)||function(te=[],de=[],ue){de=de||[];const ge=(te=te||[]).map(Hc),_e=de.map(Hc),Te=te.reduce(vc,{}),Ne=de.reduce(vc,{}),Qe=ge.slice();let at,st,it,Xe;for(at=0,st=0;at<ge.length;at++)it=ge[at],Ne.hasOwnProperty(it)?st++:(ue.push({command:pn.removeImport,args:[it]}),Qe.splice(Qe.indexOf(it,st),1));for(at=0,st=0;at<_e.length;at++)it=_e[_e.length-1-at],Qe[Qe.length-1-at]!==it&&(Te.hasOwnProperty(it)?(ue.push({command:pn.removeImport,args:[it]}),Qe.splice(Qe.lastIndexOf(it,Qe.length-st),1)):st++,Xe=Qe[Qe.length-at],ue.push({command:pn.addImport,args:[Ne[it],Xe]}),Qe.splice(Qe.length-at,0,it));for(const lt of de){const dt=Te[lt.id];dt&&(delete dt.data,r.bv(dt,lt)||ue.push({command:pn.updateImport,args:[lt.id,lt]}))}}(S.imports,L.imports,M),r.bv(S.transition,L.transition)||M.push({command:pn.setTransition,args:[L.transition]}),r.bv(S.light,L.light)||M.push({command:pn.setLight,args:[L.light]}),r.bv(S.fog,L.fog)||M.push({command:pn.setFog,args:[L.fog]}),r.bv(S.snow,L.snow)||M.push({command:pn.setSnow,args:[L.snow]}),r.bv(S.rain,L.rain)||M.push({command:pn.setRain,args:[L.rain]}),r.bv(S.projection,L.projection)||M.push({command:pn.setProjection,args:[L.projection]}),r.bv(S.lights,L.lights)||M.push({command:pn.setLights,args:[L.lights]}),r.bv(S.camera,L.camera)||M.push({command:pn.setCamera,args:[L.camera]}),r.bv(S.iconsets,L.iconsets)||function(te,de,ue){let ge;for(ge in de=de||{},te=te||{})te.hasOwnProperty(ge)&&(de.hasOwnProperty(ge)||ue.push({command:pn.removeIconset,args:[ge]}));for(ge in de){if(!de.hasOwnProperty(ge))continue;const _e=de[ge];te.hasOwnProperty(ge)?r.bv(te[ge],_e)||(ue.push({command:pn.removeIconset,args:[ge]}),ue.push({command:pn.addIconset,args:[ge,_e]})):ue.push({command:pn.addIconset,args:[ge,_e]})}}(S.iconsets,L.iconsets,M),!r.bv(S["color-theme"],L["color-theme"]))return[{command:pn.setStyle,args:[L]}];const V={},Y=[];(function(te,de,ue,ge){let _e;for(_e in de=de||{},te=te||{})te.hasOwnProperty(_e)&&(de.hasOwnProperty(_e)||du(_e,ue,ge));for(_e in de){if(!de.hasOwnProperty(_e))continue;const Te=de[_e];te.hasOwnProperty(_e)?r.bv(te[_e],Te)||(te[_e].type==="geojson"&&Te.type==="geojson"&&yl(te,de,_e)?ue.push({command:pn.setGeoJSONSourceData,args:[_e,Te.data]}):jc(_e,de,ue,ge)):hh(_e,de,ue)}})(S.sources,L.sources,Y,V);const J=[];S.layers&&S.layers.forEach(te=>{te.source&&V[te.source]?M.push({command:pn.removeLayer,args:[te.id]}):J.push(te)});let Z=S.terrain;Z&&V[Z.source]&&(M.push({command:pn.setTerrain,args:[void 0]}),Z=void 0),M=M.concat(Y),r.bv(Z,L.terrain)||M.push({command:pn.setTerrain,args:[L.terrain]}),function(te,de,ue){de=de||[];const ge=(te=te||[]).map(Hc),_e=de.map(Hc),Te=te.reduce(vc,{}),Ne=de.reduce(vc,{}),Qe=ge.slice(),at=Object.create(null);let st,it,Xe,lt,dt,kt,Dt;for(st=0,it=0;st<ge.length;st++)Xe=ge[st],Ne.hasOwnProperty(Xe)?it++:(ue.push({command:pn.removeLayer,args:[Xe]}),Qe.splice(Qe.indexOf(Xe,it),1));for(st=0,it=0;st<_e.length;st++)Xe=_e[_e.length-1-st],Qe[Qe.length-1-st]!==Xe&&(Te.hasOwnProperty(Xe)?(ue.push({command:pn.removeLayer,args:[Xe]}),Qe.splice(Qe.lastIndexOf(Xe,Qe.length-it),1)):it++,kt=Qe[Qe.length-st],ue.push({command:pn.addLayer,args:[Ne[Xe],kt]}),Qe.splice(Qe.length-st,0,Xe),at[Xe]=!0);for(st=0;st<_e.length;st++)if(Xe=_e[st],lt=Te[Xe],dt=Ne[Xe],!at[Xe]&&!r.bv(lt,dt))if(r.bv(lt.source,dt.source)&&r.bv(lt["source-layer"],dt["source-layer"])&&r.bv(lt.type,dt.type)){for(Dt in Du(lt.layout,dt.layout,ue,Xe,null,pn.setLayoutProperty),Du(lt.paint,dt.paint,ue,Xe,null,pn.setPaintProperty),r.bv(lt.slot,dt.slot)||ue.push({command:pn.setSlot,args:[Xe,dt.slot]}),r.bv(lt.filter,dt.filter)||ue.push({command:pn.setFilter,args:[Xe,dt.filter]}),r.bv(lt.minzoom,dt.minzoom)&&r.bv(lt.maxzoom,dt.maxzoom)||ue.push({command:pn.setLayerZoomRange,args:[Xe,dt.minzoom,dt.maxzoom]}),lt)lt.hasOwnProperty(Dt)&&Dt!=="layout"&&Dt!=="paint"&&Dt!=="filter"&&Dt!=="metadata"&&Dt!=="minzoom"&&Dt!=="maxzoom"&&Dt!=="slot"&&(Dt.indexOf("paint.")===0?Du(lt[Dt],dt[Dt],ue,Xe,Dt.slice(6),pn.setPaintProperty):r.bv(lt[Dt],dt[Dt])||ue.push({command:pn.setLayerProperty,args:[Xe,Dt,dt[Dt]]}));for(Dt in dt)dt.hasOwnProperty(Dt)&&!lt.hasOwnProperty(Dt)&&Dt!=="layout"&&Dt!=="paint"&&Dt!=="filter"&&Dt!=="metadata"&&Dt!=="minzoom"&&Dt!=="maxzoom"&&Dt!=="slot"&&(Dt.indexOf("paint.")===0?Du(lt[Dt],dt[Dt],ue,Xe,Dt.slice(6),pn.setPaintProperty):r.bv(lt[Dt],dt[Dt])||ue.push({command:pn.setLayerProperty,args:[Xe,Dt,dt[Dt]]}))}else ue.push({command:pn.removeLayer,args:[Xe]}),kt=Qe[Qe.lastIndexOf(Xe)+1],ue.push({command:pn.addLayer,args:[dt,kt]})}(J,L.layers,M)}catch(V){console.warn("Unable to compute style diff:",V),M=[{command:pn.setStyle,args:[L]}]}return M}(this.serialize(),n).filter(S=>!(S.command in Ul));if(g.length===0)return!1;const _=g.filter(S=>!(S.command in Fa));if(_.length>0)throw new Error(`Unimplemented: ${_.map(S=>S.command).join(", ")}.`);const w=[];return g.forEach(S=>{w.push(this[S.command](...S.args))}),u&&Promise.all(w).then(u).catch(u),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(n){for(const[u,g]of n.entries()){if(this.getImage(u))return this.fire(new r.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this}addImage(n,u){return this.getImage(n)?this.fire(new r.z(new Error(`An image with the name "${n.name}" already exists.`))):(this.imageManager.addImage(n,this.scope,u),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this)}updateImage(n,u,g=!1){this.imageManager.updateImage(n,this.scope,u),g&&(this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})))}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(n){return this.modelManager.addModelURLs(n,this.scope),this._updateWorkerModels(),this.fire(new r.A("data",{dataType:"style"})),this}addModel(n,u,g={}){return this._checkLoaded(),this._validate(je,`models.${n}`,u,null,g)||(this.modelManager.addModel(n,u,this.scope),this.fire(new r.A("data",{dataType:"style"}))),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,u,g={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(zn,`sources.${n}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=gc(n,u,this.dispatcher,this);_.scope=this.scope,_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(_.id),source:_.serialize(),sourceId:_.id}));const w=S=>{const L=(S?"symbol:":"other:")+_.id,M=r.C(L,this.scope),V=this._sourceCaches[L]=new Po(M,_,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[_.id]=V,V.onAdd(this.map)};w(!1),u.type!=="vector"&&u.type!=="geojson"||w(!0),_.onAdd&&_.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const u=this.getOwnSource(n);if(!u)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===n)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const _=Object.entries(this.stylesheet.iconsets).find(([w,S])=>S.type==="source"&&S.source===n);if(_)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while iconset "${_[0]}" is using it.`)))}const g=this.getOwnSourceCaches(n);for(const _ of g){const w=r.d7(_.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(_.id),_.fire(new r.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,u){this._checkLoaded(),this.getOwnSource(n).setData(u),this._changes.setDirty()}getOwnSource(n){const u=this.getOwnSourceCache(n);return u&&u.getSource()}getOwnSources(){const n=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&n.push(g.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const u in n){const g=n[u]._tiles;for(const _ in g){const w=g[_];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const w of n){if(this._validate(yr,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(w),S.updateTransitions(u)}else this.ambientLight=new Sn(w,Yr||(Yr=new r.a7({color:new r.a8(r.a5.properties_light_ambient.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(w),S.updateTransitions(u)}else this.directionalLight=new Sn(w,Wn||(Wn=new r.a7({direction:new r.an(r.a5.properties_light_directional.direction),color:new r.a8(r.a5.properties_light_directional.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_directional.intensity),"cast-shadows":new r.a8(r.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a8(r.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a8(r.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=Object.assign(u,{worldview:this.map.getWorldview()}),_=new r.aa(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(_),this.directionalLight&&this.directionalLight.recalculate(_),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,u=this.ambientLight;if(!n||!u)return;const g=Z=>.2126*(Z[0]<=.03928?Z[0]/12.92:Math.pow((Z[0]+.055)/1.055,2.4))+.7152*(Z[1]<=.03928?Z[1]/12.92:Math.pow((Z[1]+.055)/1.055,2.4))+.0722*(Z[2]<=.03928?Z[2]/12.92:Math.pow((Z[2]+.055)/1.055,2.4)),_=n.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),w=n.properties.get("intensity"),S=n.properties.get("direction"),L=1-r.cR(S.x,S.y,S.z)[2]/90,M=g(_)*w*L,V=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),Y=u.properties.get("intensity"),J=g(V)*Y;return Number(((M+J)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(n==null||n===""&&this.isRootStyle())return this;if(r.d8(n)){const u=r.d9(n),g=this.fragments.find(({id:w})=>w===u);if(!g)return;const _=r.d7(n);return g.style.getFragmentStyle(_)}{const u=this.fragments.find(({id:g})=>g===n);return u?u.style:void 0}}setFeaturesetSelectors(n){if(!n)return;const u={},g=(_,w="")=>`${_}::${w}`;this._featuresetSelectors={};for(const _ in n){const w=this._featuresetSelectors[_]=[];for(const S of n[_].selectors){if(S.featureNamespace){const M=this.getOwnLayer(S.layer);if(!M){r.w(`Layer is undefined for selector: ${S.layer}`);continue}const V=g(M.source,M.sourceLayer);if(V in u&&u[V]!==S.featureNamespace){r.w(`"featureNamespace ${S.featureNamespace} of featureset ${_}'s selector is not associated to the same source, skip this selector`);continue}u[V]=S.featureNamespace}let L;if(S.properties)for(const M in S.properties){const V=r.X(S.properties[M]);V.result==="success"&&(L=L||{},L[M]=V.value)}w.push({layerId:S.layer,namespace:S.featureNamespace,properties:L,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(n){const u=this.getFragmentStyle(n);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const _ in u.stylesheet.featuresets)g.push({featuresetId:_,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(n,u){const g=this.getFragmentStyle(u),_=g.stylesheet.featuresets;if(!_||!_[n])return this.fire(new r.z(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const S of _[n].selectors){const L=g.getOwnLayer(S.layer);L&&w.push(L)}return w}getConfigProperty(n,u){const g=this.getFragmentStyle(n);if(!g)return null;const _=r.C(u,g.scope),w=g.options.get(_),S=w?w.value||w.default:null;return S?S.serialize():null}setConfigProperty(n,u,g){const _=this.getFragmentStyle(n);if(!_)return;const w=_.stylesheet.indoor?Ua(_.stylesheet.schema):_.stylesheet.schema;if(!w||!w[u])return;const S=r.X(g);if(S.result!=="success")return void wl(this,S.value);const L=S.value.expression,M=r.C(u,_.scope),V=_.options.get(M);if(!V)return;let Y;const{minValue:J,maxValue:Z,stepValue:te,type:de,values:ue}=w[u],ge=r.X(w[u].default);ge.result==="success"&&(Y=ge.value.expression),Y?(this.options.set(M,Object.assign({},V,{value:L,default:Y,minValue:J,maxValue:Z,stepValue:te,type:de,values:ue})),this.updateConfigDependencies(u)):this.fire(new r.z(new Error(`No schema defined for the config option "${u}" in the "${n}" fragment.`)))}getConfig(n){const u=this.getFragmentStyle(n);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const _={};for(const w in g){const S=r.C(w,u.scope),L=u.options.get(S),M=L?L.value||L.default:null;_[w]=M?M.serialize():null}return _}setConfig(n,u){const g=this.getFragmentStyle(n);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const u=this.getFragmentStyle(n);return u?u.stylesheet.schema:null}setSchema(n,u){const g=this.getFragmentStyle(n);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(n,u){if(this._config=n,n||u)if(u)for(const g in u){let _,w;const S=r.X(u[g].default);if(S.result==="success"&&(_=S.value.expression),n&&n[g]!==void 0){const Z=r.X(n[g]);Z.result==="success"&&(w=Z.value.expression)}const{minValue:L,maxValue:M,stepValue:V,type:Y,values:J}=u[g];if(_){const Z=r.C(g,this.scope);this.options.set(Z,{default:_,value:w,minValue:L,maxValue:M,stepValue:V,type:Y,values:J})}else this.fire(new r.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new r.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const u of this._configDependentLayers){const g=this.getLayer(u);if(g){if(n&&!g.configDependencies.has(n))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const _=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&_!==""||u._styleColorTheme.lut&&_!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(n,u,g={}){this._checkLoaded();const _=n.id;if(this._layers[_])return void this.fire(new r.z(new Error(`Layer with id "${_}" already exists on this map`)));let w;if(n.type==="custom"){if(wl(this,r.da(n)))return;w=r.db(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(_,n.source),n=r.d6(n),n=r.h(n,{source:_})),this._validate(dn,`layers.${_}`,n,{arrayIndex:-1},g))return;w=r.db(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let S=this._order.length;if(u){const Y=this._order.indexOf(u);if(Y===-1)return void this.fire(new r.z(new Error(`Layer with id "${u}" does not exist on this map.`)));w.slot===this._layers[u].slot?S=Y:r.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,_),this._layerOrderChanged=!0,this._layers[_]=w;const L=this.getOwnLayerSourceCache(w),M=!!this.directionalLight&&this.directionalLight.shadowsEnabled();L&&w.canCastShadows()&&M&&(L.castsShadows=!0);const V=this._changes.getRemovedLayer(w);if(V&&w.source&&L&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const Y=r.C(w.source,w.scope);V.type!==w.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),L.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(n,u){this._checkLoaded();const g=this._checkLayer(n);if(!g||n===u)return;const _=this._order.indexOf(n);this._order.splice(_,1);let w=this._order.length;if(u){const S=this._order.indexOf(u);if(S===-1)return void this.fire(new r.z(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?w=S:r.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const u=this._checkLayer(n);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(n);this._order.splice(g,1),delete this._layers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const _=this.getOwnLayerSourceCache(u);if(_&&_.castsShadows){let w=!1;for(const S in this._layers)if(this._layers[S].source===u.source&&this._layers[S].canCastShadows()){w=!0;break}_.castsShadows=w}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const u in this._layers)if(this._layers[u].type===n)return!0;return!1}setLayerZoomRange(n,u,g){this._checkLoaded();const _=this._checkLayer(n);_&&(_.minzoom===u&&_.maxzoom===g||(u!=null&&(_.minzoom=u),g!=null&&(_.maxzoom=g),this._updateLayer(_)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,u){this._checkLoaded();const g=this._checkLayer(n);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(n,u,g={}){this._checkLoaded();const _=this._checkLayer(n);if(_&&!r.bv(_.filter,u))return u==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(St,`layers.${_.id}.filter`,u,{layerType:_.type},g)||(_.filter=r.d6(u),this._updateLayer(_)))}getFilter(n){const u=this._checkLayer(n);if(u)return r.d6(u.filter)}setLayoutProperty(n,u,g,_={}){this._checkLoaded();const w=this._checkLayer(n);if(w&&!r.bv(w.getLayoutProperty(u),g)){if(g!=null&&(!_||_.validate!==!1)&&wl(w,Ce.call(ro,{key:`layers.${n}.layout.${u}`,layerType:w.type,objectKey:u,value:g,styleSpec:r.a5,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(u,g),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(n,u){const g=this._checkLayer(n);if(g)return g.getLayoutProperty(u)}setPaintProperty(n,u,g,_={}){this._checkLoaded();const w=this._checkLayer(n);if(!w||r.bv(w.getPaintProperty(u),g)||g!=null&&(!_||_.validate!==!1)&&wl(w,me.call(ro,{key:`layers.${n}.paint.${u}`,layerType:w.type,objectKey:u,value:g,styleSpec:r.a5})))return;const S=w.setPaintProperty(u,g);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),S&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(n,u){const g=this._checkLayer(n);if(g)return g.getPaintProperty(u)}setFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:M,importId:V}=n.target,Y=this.getFragmentStyle(V),J=Y.getFeaturesetLayers(M);for(const{source:Z,sourceLayer:te}of J)Y.setFeatureState({id:n.id,source:Z,sourceLayer:te},u)}else if("layerId"in n.target){const{layerId:M}=n.target,V=this.getLayer(M);this.setFeatureState({id:n.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=n.source,_=n.sourceLayer,w=this._checkSource(g);if(!w)return;const S=w.type;if(S==="geojson"&&_)return void this.fire(new r.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!_)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided.")));const L=this.getOwnSourceCaches(g);for(const M of L)M.setFeatureState(_,n.id,u)}removeFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:M,importId:V}=n.target,Y=this.getFragmentStyle(V),J=Y.getFeaturesetLayers(M);for(const{source:Z,sourceLayer:te}of J)Y.removeFeatureState({id:n.id,source:Z,sourceLayer:te},u)}else if("layerId"in n.target){const{layerId:M}=n.target,V=this.getLayer(M);this.removeFeatureState({id:n.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=n.source,_=this._checkSource(g);if(!_)return;const w=_.type,S=w==="vector"?n.sourceLayer:void 0;if(w==="vector"&&!S)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new r.z(new Error("A feature id is required to remove its specific state property.")));const L=this.getOwnSourceCaches(g);for(const M of L)M.removeFeatureState(S,n.id,u)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let w;if("featuresetId"in n.target){const{featuresetId:S,importId:L}=n.target,M=this.getFragmentStyle(L),V=M.getFeaturesetLayers(S);for(const{source:Y,sourceLayer:J}of V){const Z=M.getFeatureState({id:n.id,source:Y,sourceLayer:J});if(Z&&!w)w=Z;else if(!r.bv(w,Z))return void this.fire(new r.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:S}=n.target,L=this.getLayer(S);w=this.getFeatureState({id:n.id,source:L.source,sourceLayer:L.sourceLayer})}return w}const u=n.source,g=n.sourceLayer,_=this._checkSource(u);if(_){if(_.type!=="vector"||g)return n.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,n.id);this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=r.h({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return r.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),u=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return r.dc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(n){for(const u of Object.values(this._mergedLayers))n(u)&&this._updateLayer(u)}_updateLayer(n){this._changes.updateLayer(n);const u=this.getLayerSourceCache(n),g=r.C(n.source,n.scope),_=this._changes.getUpdatedSourceCaches();n.source&&!_[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const u=L=>this._mergedLayers[L].is3D(!!this.terrain),g=this.order,_={},w=[];for(let L=g.length-1;L>=0;L--){const M=g[L];if(u(M)){_[M]=L;for(const V of n){const Y=V[M];if(Y)for(const J of Y)w.push(J)}}}w.sort((L,M)=>M.intersectionZ-L.intersectionZ);const S=[];for(let L=g.length-1;L>=0;L--){const M=g[L];if(u(M))for(let V=w.length-1;V>=0;V--){const Y=w[V].feature;if(Y.layer&&_[Y.layer.id]<L)break;S.push(Y),w.pop()}else for(const V of n){const Y=V[M];if(Y)for(const J of Y)S.push(J.feature)}}return S}queryRenderedFeatures(n,u,g){let _;u&&!Array.isArray(u)&&u.filter&&(this._validate(St,"queryRenderedFeatures.filter",u.filter,null,u),_=r.b3(u.filter));const w={},S=Y=>{if(vu.has(Y.type))return;const J=this.getOwnLayerSourceCache(Y),Z=w[J.id]=w[J.id]||{sourceCache:J,layers:{},has3DLayers:!1};Y.is3D(!!this.terrain)&&(Z.has3DLayers=!0),Z.layers[Y.fqid]=Z.layers[Y.fqid]||{styleLayer:Y,targets:[]},Z.layers[Y.fqid].targets.push({filter:_})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new r.z(new Error("parameters.layers must be an Array."))),[];for(const Y of u.layers){const J=this._layers[Y];if(!J)return this.fire(new r.z(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];S(J)}}else for(const Y in this._layers)S(this._layers[Y]);const L=this._queryRenderedFeatures(n,w,g),M=this._flattenAndSortRenderedFeatures(L),V=[];for(const Y of M)r.dd(Y.layer.id)===this.scope&&V.push(Y);return V}queryRenderedFeatureset(n,u,g){let _;u&&!Array.isArray(u)&&u.filter&&(this._validate(St,"queryRenderedFeatures.filter",u.filter,null,u),_=r.b3(u.filter));const w="mock",S=[];if(u&&u.target)S.push(Object.assign({},u,{targetId:w,filter:_}));else{const Y=this.getFeaturesetDescriptors();for(const J of Y)S.push({targetId:w,filter:_,target:J});for(const{style:J}of this.fragments){const Z=J.getFeaturesetDescriptors();for(const te of Z)S.push({targetId:w,filter:_,target:te})}}const L=this.queryRenderedTargets(n,S,g),M=[],V=new Set;for(const Y of L)for(const J of Y.variants[w])zc(J,Y,V)||M.push(new r.de(Y,J));return M}queryRenderedTargets(n,u,g){const _={},w=(L,M,V,Y)=>{const J=_[M.id]=_[M.id]||{sourceCache:M,layers:{},has3DLayers:!1};if(J.layers[L.fqid]=J.layers[L.fqid]||{styleLayer:L,targets:[]},L.is3D(!!this.terrain)&&(J.has3DLayers=!0),!Y)return V.uniqueFeatureID=!1,void J.layers[L.fqid].targets.push(V);J.layers[L.fqid].targets.push(Object.assign({},V,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const L of u)if("featuresetId"in L.target){const{featuresetId:M,importId:V}=L.target,Y=this.getFragmentStyle(V);if(!Y||!Y._featuresetSelectors)continue;const J=Y._featuresetSelectors[M];if(!J){this.fire(new r.z(new Error(`The featureset '${M}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Z of J){const te=Y.getOwnLayer(Z.layerId);te&&!vu.has(te.type)&&w(te,Y.getOwnLayerSourceCache(te),L,Z)}}else if("layerId"in L.target){const{layerId:M}=L.target,V=this.getLayer(M);if(!V||vu.has(V.type))continue;w(V,this.getLayerSourceCache(V),L)}const S=this._queryRenderedFeatures(n,_,g);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(n,u,g){const _=[],w=!!this.map._showQueryGeometry,S=En.createFromScreenPoints(n,g);for(const L in u){const M=fl(S,u[L],this._availableImages,g,w);Object.keys(M).length&&_.push(M)}if(this.placement)for(const L in u){if(!u[L].sourceCache._onlySymbols)continue;const M=Co(S.screenGeometry,u[L],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(M).length&&_.push(M)}return _}querySourceFeatures(n,u){const g=u&&u.filter;g&&this._validate(St,"querySourceFeatures.filter",g,null,u);let _=[];const w=this.getOwnSourceCaches(n);for(const S of w)_=_.concat(Ta(S,u));return _}addSourceType(n,u,g){return jo.getSourceType(n)?g(new Error(`A source type called "${n}" already exists.`)):(jo.setSourceType(n,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,u,g={}){this._checkLoaded();const _=this.light.getLight();let w=!1;for(const L in n)if(!r.bv(n[L],_[L])){w=!0;break}if(!w)return;const S=this._getTransitionParameters();this.light.setLight(n,u,g),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,u=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=n;const _=n.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const L="terrain-dem-src";this.addSource(L,g.source),g=r.d6(g),g=r.h(g,{source:L})}const w=r.h({},g),S={};if(this.terrain&&_){w.source=this.terrain.get().source;const L=this.terrain?this.getFragmentStyle(this.terrain.scope):null;L&&(S.style=L.serialize())}if(this._validate(qt,"terrain",w,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!_||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new r.A("data",{dataType:"style"}))}else{const w=this.terrain,S=w.get();for(const L of Object.keys(r.a5.terrain))!g.hasOwnProperty(L)&&r.a5.terrain[L].default&&(g[L]=r.a5.terrain[L].default);for(const L in n)if(!r.bv(n[L],S[L])){w.set(n,this.options),this.stylesheet.terrain=n;const M=this._getTransitionParameters({duration:0});w.updateTransitions(M),this.fire(new r.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const u=this.fog=new Mr(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(n){const u=this.snow=new fs(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(n){const u=this.rain=new ps(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const _ in this._layers)this._layers[_].lut=this._styleColorTheme.lut;for(const _ in this._sourceCaches)this._sourceCaches[_].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void n();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new r.A("colorthemeset")),n()}).catch(_=>{r.w(`Couldn't set color theme: ${_}`)})}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,u){const g=this.getFragmentStyle(n);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(n){return{now:r.q.now(),transition:r.h(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?n.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...u)}_createTerrain(n,u){const g=this.terrain=new _t(n,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const _=this._getTransitionParameters({duration:0});g.updateTransitions(_)}_force3DLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="symbol"&&this._updateLayer(u)}}_validate(n,u,g,_,w={}){if(w&&w.validate===!1)return!1;const S=r.h({},this.serialize());return wl(this,n.call(ro,r.h({key:u,style:S,value:g,styleSpec:r.a5},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.df.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(n){const u=this.getSourceCaches(n);for(const g of u)g.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}reloadSource(n){const u=this.getSourceCaches(n);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(n=>{n.modelManager.reloadModels(n.scope)})}updateSources(n){let u;this.directionalLight&&(u=_o(this.directionalLight));const g=new Set;for(const _ in this._mergedLayers){const w=this._mergedLayers[_];w.hasElevation()&&!g.has(w.source)&&g.add(w.source)}for(const _ in this._mergedSourceCaches){const w=this._mergedSourceCaches[_],S=g.has(w._source.id);w.update(n,void 0,void 0,u,S)}}_generateCollisionBoxes(){for(const n in this._sourceCaches){const u=this._sourceCaches[n];u.resume(),u.reload()}}_updatePlacement(n,u,g,_,w,S,L=!1){let M=!1,V=!1;const Y={},J={};for(const Z of this._mergedOrder){const te=this._mergedLayers[Z];if(te.type!=="symbol")continue;const de=r.C(te.source,te.scope);let ue=Y[de];if(!ue){const _e=this.getLayerSourceCache(te);if(!_e)continue;const Te=_e.getRenderableIds(!0).map(Ne=>_e.getTileByID(Ne));J[de]=Te.slice(),ue=Y[de]=Te.sort((Ne,Qe)=>Qe.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(Qe.tileID)?-1:1))}const ge=this.crossTileSymbolIndex.addLayer(te,ue,u.center.lng,u.projection);M=M||ge}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),L=L||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new r.A("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),u.zoom))&&(this.pauseablePlacement=new kn(u,this._mergedOrder,L,g,_,w,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,J,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),V=!0),M&&this.pauseablePlacement.placement.setStale()),V||M){this._buildingIndex.onNewFrame(u.zoom);for(let Z=0;Z<this._mergedOrder.length;Z++){const te=this._mergedLayers[this._mergedOrder[Z]];if(te.type!=="symbol")continue;const de=this.isLayerClipped(te);this.placement.updateLayerOpacities(te,Y[r.C(te.source,te.scope)],Z,de?S:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:w})=>w===n.id)!==-1)return void this.fire(new r.z(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!u)return g.push(n),this._loadImports([n],!0);const _=g.findIndex(({id:w})=>w===u);return _===-1&&this.fire(new r.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,_).concat(n).concat(g.slice(_)),this._loadImports([n],!0,u)}updateImport(n,u){this._checkLoaded();const g=this.stylesheet.imports||[],_=this.getImportIndex(n);return _===-1?this:typeof u=="string"?(this.setImportUrl(n,u),this):(u.url&&u.url!==g[_].url&&this.setImportUrl(n,u.url),r.bv(u.config,g[_].config)||this.setImportConfig(n,u.config,u.data.schema),r.bv(u.data,g[_].data)||this.setImportData(n,u.data),this)}moveImport(n,u){this._checkLoaded();let g=this.stylesheet.imports||[];const _=this.getImportIndex(n);if(_===-1)return this;const w=this.getImportIndex(u);if(w===-1)return this;const S=g[_],L=this.fragments[_];return g=g.filter(({id:M})=>M!==n),this.fragments=this.fragments.filter(({id:M})=>M!==n),this.stylesheet.imports=g.slice(0,w).concat(S).concat(g.slice(w)),this.fragments=this.fragments.slice(0,w).concat(L).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(n,u){this._checkLoaded();const g=this.stylesheet.imports||[],_=this.getImportIndex(n);if(_===-1)return this;g[_].url=u;const w=this.fragments[_];return w.style=this._createFragmentStyle(g[_]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(u),this}setImportData(n,u){this._checkLoaded();const g=this.getImportIndex(n),_=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete _[g].data,this.setImportUrl(n,_[g].url))}setImportConfig(n,u,g){this._checkLoaded();const _=this.getImportIndex(n),w=this.stylesheet.imports||[];if(_===-1)return this;u?w[_].config=u:delete w[_].config;const S=this.fragments[_];g&&S.style.stylesheet&&(S.style.stylesheet.schema=g);const L=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=u,S.style.updateConfig(u,L),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(n);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(n){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===n);return u===-1&&this.fire(new r.z(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),u}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&n.push(g.getSource())}return n}getSource(n,u){const g=this.getSourceCache(n,u);return g&&g.getSource()}getLayerSource(n){const u=this.getLayerSourceCache(n);return u&&u.getSource()}getSourceCache(n,u){const g=r.C(n,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(n){const u=r.C(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[n]&&u.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&u.push(this._mergedSymbolSourceCaches[n]),u}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const u in n){const g=n[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(n){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const _=this.getLayer(g);_&&_.updateTransitions(n)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(n){this.stylesheet.glyphs=n,this.glyphManager.setURL(n,this.scope)}getImages(n,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const _=S=>{if(S){const L=u.images.map(M=>r.I.toString(M));S.setDependencies(u.tileID.key,u.type,L)}},w=r.C(u.source,u.scope);_(this._mergedOtherSourceCaches[w]),_(this._mergedSymbolSourceCaches[w])}rasterizeImages(n,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(n,u,g){this.glyphManager.getGlyphs(u.stacks,u.scope,g)}getResource(n,u,g){return r.dg(u,g)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const u=[];return this._otherSourceCaches[n]&&u.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&u.push(this._symbolSourceCaches[n]),u}_isSourceCacheLoaded(n){const u=this.getOwnSourceCaches(n);return u.length===0?(this.fire(new r.z(new Error(`There is no source with ID '${n}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,u){if(!this._clipLayerPresent&&n.type!=="fill-extrusion"&&n.type!=="building")return!1;const g=n.type==="fill-extrusion"&&n.sourceLayer==="building",_=n.type==="building";if(n.is3D(!!this.terrain)){if(g||_||u&&u.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}jo.getSourceType=function(p){return lh[p]},jo.setSourceType=function(p,n){lh[p]=n},jo.registerForPluginStateChange=r.dh;var wc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,zl=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,_u=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,rc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Nl=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Bc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,xu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Eo=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,el=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,wi=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,no=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const xo=[];ll(wc,xo),ll(_u,xo),ll(zl,xo);const fo={"_prelude_fog.vertex.glsl":Bc,"_prelude_terrain.vertex.glsl":Nl,"_prelude_shadow.vertex.glsl":wi,"_prelude_fog.fragment.glsl":xu,"_prelude_shadow.fragment.glsl":no,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Eo,"_prelude_raster_particle.glsl":el},jl={};gn("",Nl),gn(xu,Bc),gn(no,wi),gn(Eo,""),gn(el,"");const bu=gn(zl,_u),za=wc;var fh={background:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:gn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:gn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:gn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:gn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:gn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:gn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:gn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:gn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:gn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:gn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:gn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rc),skyboxGradient:gn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,rc),skyboxCapture:gn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:gn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:gn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:gn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:gn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:gn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ll(p,n){const u=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=g.split(" ");for(const w of _)n.includes(w)||n.push(w)}}function gn(p,n){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let _=n.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);_&&(_=_.map(V=>{const Y=V.split(" ");return Y[Y.length-1]}),_=[...new Set(_)]);const w={},S=[],L=[];if(p=p.replace(u,(V,Y)=>(L.push(Y),"")),(n=n.replace(u,(V,Y)=>(S.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let M=[...xo];ll(p,M),ll(n,M);for(const V of[...S,...L])fo[V]||console.error(`Undefined include: ${V}`),jl[V]||(jl[V]=[],ll(fo[V],jl[V])),M=[...M,...jl[V]];return{fragmentSource:p=p.replace(g,(V,Y,J,Z,te)=>(w[te]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
in ${J} ${Z} ${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = u_${te};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${J} ${Z} ${te};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(g,(V,Y,J,Z,te)=>{const de=Z==="float"?"vec2":Z,ue=te.match(/color/)?"color":de;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${te}
in ${J} ${Z} a_${te};
#endif
`:w[te]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${J} ${de} a_${te};
out ${J} ${Z} ${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize"?ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = a_${te};
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = unpack_mix_${ue}(a_${te}, u_${te}_t);
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${J} ${Z} a_${te};
    out ${J} ${Z} ${te};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${te} = a_${te};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${J} ${de} a_${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="define-instanced"?ue==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${te}0;
in vec4 a_${te}1;
in vec4 a_${te}2;
in vec4 a_${te}3;
#else
uniform ${J} ${Z} u_${te};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${J} ${de} a_${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${J} ${Z} ${te} = a_${te};
#endif
`:ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = a_${te};
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = unpack_mix_${ue}(a_${te}, u_${te}_t);
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`}),staticAttributes:_,usedDefines:M,vertexIncludes:S,fragmentIncludes:L}}class La{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,u,g,_,w,S,L,M){this.context=n;let V=this.boundPaintVertexBuffers.length!==_.length;for(let J=0;!V&&J<_.length;J++)this.boundPaintVertexBuffers[J]!==_[J]&&(V=!0);let Y=this.boundDynamicVertexBuffers.length!==L.length;for(let J=0;!Y&&J<L.length;J++)this.boundDynamicVertexBuffers[J]!==L[J]&&(Y=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||V||Y||this.boundIndexBuffer!==w||this.boundVertexOffset!==S)this.freshBind(u,g,_,w,S,L,M);else{n.bindVertexArrayOES.set(this.vao);for(const J of L)J&&(J.bind(),M&&J.instanceCount&&J.setVertexAttribDivisor(n.gl,u,M));w&&w.dynamicDraw&&w.bind()}}freshBind(n,u,g,_,w,S,L){const M=n.numAttributes,V=this.context,Y=V.gl;this.vao&&this.destroy(),this.vao=V.gl.createVertexArray(),V.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=S,u.enableAttributes(Y,n),u.bind(),u.setVertexAttribPointers(Y,n,w);for(const J of g)J.enableAttributes(Y,n),J.bind(),J.setVertexAttribPointers(Y,n,w);for(const J of S)J&&(J.enableAttributes(Y,n),J.bind(),J.setVertexAttribPointers(Y,n,w),L&&J.instanceCount&&J.setVertexAttribDivisor(Y,n,L));_&&_.bind(),V.currentNumAttributes=M}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function nc(p,n){const u=Math.pow(2,n.canonical.z),g=n.canonical.y;return[new r.ac(0,g/u).toLngLat().lat,new r.ac(0,(g+1)/u).toLngLat().lat]}function eA(p,n,u,g,_,w,S){const L=p.context,M=L.gl,V=u.hillshadeFBO;if(!V)return;p.prepareDrawTile();const Y=p.isTileAffectedByFog(n),J=p.getOrCreateProgram("hillshade",{overrideFog:Y});L.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,V.colorAttachment.get());const Z=((ge,_e,Te,Ne)=>{const Qe=Te.paint.get("hillshade-shadow-color"),at=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",st=Te.paint.get("hillshade-highlight-color"),it=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Xe=Te.paint.get("hillshade-accent-color"),lt=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",dt=Te.paint.get("hillshade-emissive-strength");let kt=r.al(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")kt-=ge.transform.angle;else if(ge.style&&ge.style.enable3dLights()&&ge.style.directionalLight){const ti=ge.style.directionalLight.properties.get("direction"),ri=r.cR(ti.x,ti.y,ti.z);kt=r.al(ri[1])}const Dt=!ge.options.moving;return{u_matrix:Ne||ge.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),Dt),u_image:0,u_latrange:nc(0,_e.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),kt],u_shadow:Qe.toPremultipliedRenderColor(at?null:Te.lut),u_highlight:st.toPremultipliedRenderColor(it?null:Te.lut),u_emissive_strength:dt,u_accent:Xe.toPremultipliedRenderColor(lt?null:Te.lut)}})(p,u,g,p.terrain?n.projMatrix:null);p.uploadCommonUniforms(L,J,n.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:de,tileBoundsSegments:ue}=p.getTileBoundsBuffers(u);J.draw(p,M.TRIANGLES,_,w,S,wr.disabled,Z,g.id,te,de,ue)}function ph(p,n,u){if(!n.needsDEMTextureUpload)return;const g=p.context,_=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||p.getTileTexture(u.stride);const w=u.getPixels();n.demTexture?n.demTexture.update(w,{premultiply:!1}):n.demTexture=new r.T(g,w,_.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function gh(p,n,u){const g=p.context,_=g.gl;if(!n.dem)return;const w=n.dem;if(g.activeTexture.set(_.TEXTURE1),ph(p,n,w),!n.demTexture)return;n.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);const S=w.dim;g.activeTexture.set(_.TEXTURE0);let L=n.hillshadeFBO;if(!L){const Z=new r.T(g,{width:S,height:S,data:null},_.RGBA8);Z.bind(_.LINEAR,_.CLAMP_TO_EDGE),L=n.hillshadeFBO=g.createFramebuffer(S,S,!0,"renderbuffer"),L.colorAttachment.set(Z.texture)}g.bindFramebuffer.set(L.framebuffer),g.viewport.set([0,0,S,S]);const{tileBoundsBuffer:M,tileBoundsIndexBuffer:V,tileBoundsSegments:Y}=p.getMercatorTileBoundsBuffers(),J=[];p.linearFloatFilteringSupported()&&J.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:J}).draw(p,_.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.disabled,((Z,te)=>{const de=te.stride,ue=r.bz();return r.c5(ue,0,r.aj,-8192,0,0,1),r.bo(ue,ue,[0,-8192,0]),{u_matrix:ue,u_image:1,u_dimension:[de,de],u_zoom:Z.overscaledZ}})(n.tileID,w),u.id,M,V,Y),n.needsHillshadePrepare=!1}class Ss{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class cd extends Ss{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class zu extends Ss{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Ef extends Ss{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class XA extends Ss{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class YA extends Ss{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class tA extends Ss{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mh extends Ss{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Ep extends Ss{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class iA extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class Tf extends Ss{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class If extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Vh extends Ss{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class rA extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class KA extends Ss{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class yh extends Ss{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Nu extends Ss{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class wu extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class ju extends Ss{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Gh extends Ss{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let Ff=class extends Ss{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class nA extends Ss{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Lf extends Ss{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Wh extends Ss{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class sA extends Ss{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class oA extends Ss{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Wc extends Ss{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Bl extends Ss{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class tl extends Ss{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class Mf extends Ss{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class qA extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Xc extends Ss{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Ba extends Ss{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class Pf extends Ba{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class aA extends Ba{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ud extends Ba{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class kf extends aA{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const lA=(p,n,u)=>({u_matrix:p,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:u}),hd=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:_,u_merc_center:w,u_image0:0,u_frustum_tl:S,u_frustum_tr:L,u_frustum_br:M,u_frustum_bl:V,u_globe_pos:Y,u_globe_radius:J,u_viewport:Z,u_grid_matrix:ue?Float32Array.from(ue):new Float32Array(9),u_skirt_height:te,u_far_z_cutoff:de});function cA(p,n){return p!=null&&n!=null&&!(!p.hasData()||!n.hasData())&&p.demTexture!=null&&n.demTexture!=null&&p.tileID.key!==n.tileID.key}const Cc=new class{constructor(){this.operations={}}newMorphing(p,n,u,g,_){if(p in this.operations){const w=this.operations[p];w.to.tileID.key!==u.tileID.key&&(w.queued=u)}else this.operations[p]={startTime:g,phase:0,duration:_,from:n,to:u,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const n=this.operations[p];return{from:n.from,to:n.to,phase:n.phase}}update(p){for(const n in this.operations){const u=this.operations[n];for(u.phase=(p-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,p)){delete this.operations[n];break}}}_nextOp(p,n){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=n,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Xh={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Yc(p,n,u){if(n===0)return 0;const g=n<1&&u===514?.25/n:1;return 6*Math.pow(1.5,22-p)*Math.max(n,1)*g}function $A(p,n){const u=1<<p.z;return!n&&(p.x===0||p.x===u-1)||p.y===0||p.y===u-1}const vh=p=>({u_matrix:p});function Hu(p,n,u,g,_){if(_>0){const w=r.q.now(),S=(w-p.timeAdded)/_,L=n?(w-n.timeAdded)/_:-1,M=u.getSource(),V=g.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),Y=!n||Math.abs(n.tileID.overscaledZ-V)>Math.abs(p.tileID.overscaledZ-V),J=Y&&p.refreshedUponExpiration?1:r.ay(Y?S:1-L,0,1);return p.refreshedUponExpiration&&S>=1&&(p.refreshedUponExpiration=!1),n?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class Rf extends Po{constructor(n){const u={type:"raster-dem",maxzoom:n.transform.maxZoom},g=new r.D(r.c$(),null),_=gc("mock-dem",u,g,n.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,u){n.state="loaded",u(null)}}class Hl extends Po{constructor(n){const u=gc("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new r.D(r.c$(),null),n.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,u,g){if(n.freezeTileCoverage)return;this.transform=n;const _=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,S)=>{if(w[S.key]="",!this._tiles[S.key]){const L=new cu(S,this._source.tileSize*S.overscaleFactor(),n.tileZoom,void 0,void 0,this._source.worldview);L.state="loaded",this._tiles[S.key]=L}return w},{});for(const w in this._tiles)w in _||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(n){const u=this.proxyCachedFBO[n];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class uA extends r.aM{constructor(n,u,g){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class dd extends r.dt{constructor(n,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,_,w]=function(M){const V=new r.ba,Y=new r.a_,J=131;V.reserve(17161),Y.reserve(33800);const Z=r.aj/128,te=r.aj+Z/2,de=te+Z;for(let ge=-64;ge<de;ge+=Z)for(let _e=-64;_e<de;_e+=Z){const Te=_e<0||_e>te||ge<0||ge>te?24575:0,Ne=r.ay(Math.round(_e),0,r.aj),Qe=r.ay(Math.round(ge),0,r.aj);V.emplaceBack(Ne+Te,Qe)}const ue=(ge,_e)=>{const Te=_e*J+ge;Y.emplaceBack(Te+1,Te,Te+J),Y.emplaceBack(Te+J,Te+J+1,Te+1)};for(let ge=1;ge<129;ge++)for(let _e=1;_e<129;_e++)ue(_e,ge);return[0,129].forEach(ge=>{for(let _e=0;_e<130;_e++)ue(_e,ge),ue(ge,_e)}),[V,Y,32768]}(),S=n.context;this.gridBuffer=S.createVertexBuffer(g,r.bc.members),this.gridIndexBuffer=S.createIndexBuffer(_),this.gridSegments=r.bd.simpleSegment(0,0,g.length,_.length),this.gridNoSkirtSegments=r.bd.simpleSegment(0,0,g.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Hl(u.map),this.orthoMatrix=r.bz(),r.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.aj,0,r.aj,0,1);const L=S.gl;this._overlapStencilMode=new Pr({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Rf(u.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,u,g){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const _=n.terrain.properties,w=n.terrain.drapeRenderMode===0,S=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const L=n.terrain&&n.terrain.scope,M=_.get("source"),V=w?this._mockSourceCache:n.getSourceCache(M,L);if(!V)return void r.w(`Couldn't find terrain source "${M}".`);if(this.sourceCache=V,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(u):_.get("exaggeration"),!u.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const J=this.getScaledDemTileSize();this.sourceCache.update(u,J,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const u=this._previousCameraAltitude,g=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=g;const _=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(_)<2)return this._exaggeration;const w=n.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(w);let L=w-this._previousZoom;const M=this._previousUpdateTimestamp;let V=w;this._evaluationZoom!=null&&(V=this._evaluationZoom,Math.abs(w-V)>.5&&(L=.5*(w-V+L)),L*_<0&&(V+=L)),this._evaluationZoom=V;const Y=S.getExaggeration(V),J=Y===S.getExaggeration(Math.max(0,V-.1));if(J&&Math.abs(Y-this._exaggeration)<.01)return Y;let Z=Math.min(.1,.00375*(this._updateTimestamp-M));return(J||Y<.1||Math.abs(L)<1e-4)&&(Z=Math.min(.2,4*Z)),r.ai(this._exaggeration,Y,Z)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(r.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=u.getIds().map(M=>{const V=u.getTileByID(M).tileID;return V.projMatrix=g.calculateProjMatrix(V.toUnwrapped()),V});(function(M,V){const Y=V.transform.pointCoordinate(V.transform.getCameraPoint()),J=new r.P(Y.x,Y.y);M.sort((Z,te)=>{if(te.overscaledZ-Z.overscaledZ)return te.overscaledZ-Z.overscaledZ;const de=new r.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),ue=new r.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ge=J.mult(1<<Z.canonical.z);return ge.x-=.5,ge.y-=.5,ge.distSqr(de)-ge.distSqr(ue)})})(_,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},_.forEach(M=>{this.proxyToSource[M.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const M in S){const V=S[M];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,n[M],w),V.usedForTerrain))continue;const Y=n[M];V.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[u.id]=_.map(M=>new uA(M,M.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const L={};this._visibleDemTiles=[];for(const M of this.proxyCoords){const V=this.terrainTileForTile[M.key];if(!V)continue;const Y=V.tileID.key;Y in L||(this._visibleDemTiles.push(V),L[Y]=Y)}}_assignTerrainTiles(n){this._initializing||n.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const n=this.painter.context,u=n.gl;for(const g in this.terrainTileForTile){const _=this.terrainTileForTile[g],w=_.dem;!w||_.demTexture&&!_.needsDEMTextureUpload||(n.activeTexture.set(u.TEXTURE1),ph(this.painter,_,w))}}_prepareDemTileUniforms(n,u,g,_){if(!u||u.demTexture==null)return!1;const w=n.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-w.z),L=_||"";return g[`u_dem_tl${L}`]=[w.x*S%1,w.y*S%1],g[`u_dem_scale${L}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const u=this._visibleDemTiles.reduce((g,_)=>{if(!_.dem)return g;const w=_.dem.tree.minimums[0];return w>0&&n++,g+w},0);return n?u/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,u=n.gl;n.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),_=new r.du({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(_,{premultiply:!1}):w=this._emptyDEMTexture=new r.T(n,_,u.R32F,{premultiply:!1}),w}setupElevationDraw(n,u,g){const _=this.painter.context,w=_.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let L=null,M=null,V=1;if(g&&g.morphing&&this._useVertexMorphing){const te=g.morphing.srcDemTile,de=g.morphing.dstDemTile;V=g.morphing.phase,te&&de&&(this._prepareDemTileUniforms(n,te,S,"_prev")&&(M=te),this._prepareDemTileUniforms(n,de,S)&&(L=de))}const Y=te=>te&&te.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let J=null;var Z;if(this.enabled?M&&L?(J=L.demTexture,_.activeTexture.set(w.TEXTURE4),M.demTexture.bind(Y(M),w.CLAMP_TO_EDGE),S.u_dem_lerp=V):(L=this.terrainTileForTile[n.tileID.key],J=this._prepareDemTileUniforms(n,L,S)?L.demTexture:this.emptyDEMTexture):J=this.emptyDEMTexture,_.activeTexture.set(w.TEXTURE2),J&&(S.u_dem_size=(Z=J).size[0]===1?1:Z.size[0]-2,J.bind(Y(L),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,S),g&&g.useMeterToDem&&L){const te=(1<<L.tileID.canonical.z)*r.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=te}if(g&&g.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(_,S),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,n.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(_,te)}}globeUniformValues(n,u,g){const _=n.projection;return{u_tile_tl_up:_.upVector(u,0,0),u_tile_tr_up:_.upVector(u,r.aj,0),u_tile_br_up:_.upVector(u,r.aj,r.aj),u_tile_bl_up:_.upVector(u,0,r.aj),u_tile_up_scale:g?r.dv(1):_.upVectorScale(u,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const u=this.painter,g=this.painter.context;n.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,w,S,L,M){if(_.transform.projection.name==="globe")(function(V,Y,J,Z,te){const de=V.context,ue=de.gl;let ge,_e;const Te=V.transform,Ne=r.dl(V,de,Te),Qe=(ti,ri)=>{if(_e===ri)return;const vi=[Xh[ri],"PROJECTION_GLOBE_VIEW"];Ne&&vi.push("CUSTOM_ANTIALIASING");const Mt=V.isTileAffectedByFog(ti);ge=V.getOrCreateProgram("globeRaster",{defines:vi,overrideFog:Mt}),_e=ri},at=V.colorModeForRenderPass(),st=new ji(ue.LEQUAL,ji.ReadWrite,V.depthRangeFor3D);Cc.update(te);const it=r.dm(Te),Xe=[r.aD(Te.center.lng),r.aH(Te.center.lat)],lt=V.globeSharedBuffers,dt=[Te.width*r.q.devicePixelRatio,Te.height*r.q.devicePixelRatio],kt=Float32Array.from(Te.globeMatrix),Dt={useDenormalizedUpVectorScale:!0};{const ti=V.transform,ri=Yc(ti.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);_e=-1;const vi=ue.TRIANGLES;for(const Mt of Z){const Vt=J.getTile(Mt),wt=Pr.disabled,oi=Y.prevTerrainTileForTile[Mt.key],zt=Y.terrainTileForTile[Mt.key];cA(oi,zt)&&Cc.newMorphing(Mt.key,oi,zt,te,250),de.activeTexture.set(ue.TEXTURE0),Vt.texture&&Vt.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const mi=Cc.getMorphValuesForProxy(Mt.key),Li=mi?1:0;mi&&r.L(Dt,{morphing:{srcDemTile:mi.from,dstDemTile:mi.to,phase:r.dk(mi.phase)}});const ai=r.dn(Mt.canonical),Mi=r.dp(ai.getCenter().lat),ir=r.dq(Mt.canonical,ai,Mi,ti.worldSize/ti._pixelsPerMercatorPixel),tr=r.bh(r.dr(Mt.canonical)),Ki=hd(ti.expandedFarZProjMatrix,kt,it,tr,r.ah(ti.zoom),Xe,ti.frustumCorners.TL,ti.frustumCorners.TR,ti.frustumCorners.BR,ti.frustumCorners.BL,ti.globeCenterInViewSpace,ti.globeRadius,dt,ri,ti._farZ,ir);if(Qe(Mt,Li),ge&&(Y.setupElevationDraw(Vt,ge,Dt),V.uploadCommonUniforms(de,ge,Mt.toUnwrapped()),lt)){const[pr,gr,Cr]=lt.getGridBuffers(Mi,ri!==0);ge.draw(V,vi,st,wt,at,wr.backCCW,Ki,"globe_raster",pr,gr,Cr)}}}if(lt&&(V.renderDefaultNorthPole||V.renderDefaultSouthPole)){const ti=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ne&&ti.push("CUSTOM_ANTIALIASING"),ge=V.getOrCreateProgram("globeRaster",{defines:ti});for(const ri of Z){const{x:vi,y:Mt,z:Vt}=ri.canonical,wt=Mt===0,oi=Mt===(1<<Vt)-1,[zt,mi,Li,ai]=lt.getPoleBuffers(Vt,!1);if(ai&&(wt||oi)){const Mi=J.getTile(ri);de.activeTexture.set(ue.TEXTURE0),Mi.texture&&Mi.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);let ir=r.ds(Vt,vi,Te);const tr=r.bh(r.dr(ri.canonical)),Ki=(pr,gr)=>pr.draw(V,ue.TRIANGLES,st,Pr.disabled,at,wr.disabled,hd(Te.expandedFarZProjMatrix,ir,ir,tr,0,Xe,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,dt,0,Te._farZ),"globe_pole_raster",gr,Li,ai);Y.setupElevationDraw(Mi,ge,Dt),V.uploadCommonUniforms(de,ge,ri.toUnwrapped()),wt&&V.renderDefaultNorthPole&&Ki(ge,zt),oi&&V.renderDefaultSouthPole&&(ir=r.cE(r.bz(),ir,[1,-1,1]),Ki(ge,mi))}}}})(_,w,S,L,M);else{const V=_.context,Y=V.gl;let J,Z;const te=_.shadowRenderer,de=al(_,_.longestCutoffRange),ue=at=>{if(Z===at)return;const st=[];st.push(Xh[at]),de.shouldRenderCutoff&&st.push("RENDER_CUTOFF"),te&&(st.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&st.push("NORMAL_OFFSET")),J=_.getOrCreateProgram("terrainRaster",{defines:st}),Z=at},ge=_.colorModeForRenderPass(),_e=new ji(Y.LEQUAL,ji.ReadWrite,_.depthRangeFor3D);Cc.update(M);const Te=_.transform,Ne=Yc(Te.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let Qe=[0,0,0];if(te){const at=_.style.directionalLight,st=_.style.ambientLight;at&&st&&(Qe=sa(_.style,at,st))}{Z=-1;const at=Y.TRIANGLES,[st,it]=[w.gridIndexBuffer,w.gridSegments];for(const Xe of L){const lt=S.getTile(Xe),dt=Pr.disabled,kt=w.prevTerrainTileForTile[Xe.key],Dt=w.terrainTileForTile[Xe.key];cA(kt,Dt)&&Cc.newMorphing(Xe.key,kt,Dt,M,250),V.activeTexture.set(Y.TEXTURE0),lt.texture&&lt.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const ti=Cc.getMorphValuesForProxy(Xe.key),ri=ti?1:0;let vi;ti&&(vi={morphing:{srcDemTile:ti.from,dstDemTile:ti.to,phase:r.dk(ti.phase)}});const Mt=lA(Xe.projMatrix,$A(Xe.canonical,Te.renderWorldCopies)?Ne/10:Ne,Qe);if(ue(ri),!J)continue;w.setupElevationDraw(lt,J,vi);const Vt=Xe.toUnwrapped();te&&te.setupShadows(Vt,J),_.uploadCommonUniforms(V,J,Vt,null,de),J.draw(_,at,_e,dt,ge,wr.backCCW,Mt,"terrain_raster",w.gridBuffer,st,it)}}}}(u,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,_=this.proxySourceCache,w=this.proxiedCoords[_.id],S=this._drapedRenderBatches.shift(),L=u.style.order,M=[];let V=0;for(const Y of w){const J=_.getTileByID(Y.proxyTileKey),Z=_.proxyCachedFBO[Y.key]?_.proxyCachedFBO[Y.key][n]:void 0,te=Z!==void 0?_.renderCache[Z]:this.pool[V++],de=Z!==void 0;if(J.texture=te.tex,de&&!te.dirty){M.push(J.tileID);continue}let ue;g.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(g.clear({color:r.am.transparent,stencil:0}),te.dirty=!1);for(let ge=S.start;ge<=S.end;++ge){const _e=u.style._mergedLayers[L[ge]];if(_e.isHidden(u.transform.zoom))continue;const Te=u.style.getLayerSourceCache(_e),Ne=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!Ne)continue;const Qe=Ne;g.viewport.set([0,0,te.fb.width,te.fb.height]),ue!==(Te?Te.id:null)&&(this._setupStencil(te,Ne,_e,Te),ue=Te?Te.id:null),u.renderLayer(u,Te,_e,Qe)}if(this._drapedRenderBatches.length===0)for(const ge of this._pendingGroundEffectLayers){const _e=u.style._mergedLayers[L[ge]];if(_e.isHidden(u.transform.zoom))continue;const Te=u.style.getLayerSourceCache(_e),Ne=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!Ne)continue;const Qe=Ne;g.viewport.set([0,0,te.fb.width,te.fb.height]),ue!==(Te?Te.id:null)&&(this._setupStencil(te,Ne,_e,Te),ue=Te?Te.id:null),u.renderLayer(u,Te,_e,Qe)}this.renderedToTile?(te.dirty=!0,M.push(J.tileID)):de||--V,V===5&&(V=0,this.renderToBackBuffer(M))}return this.renderToBackBuffer(M),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}isLayerOrderingCorrect(n){const u=n.order.length;let g=-1,_=u;for(let w=0;w<u;++w)this._style.isLayerDraped(n._mergedLayers[n.order[w]])?g=Math.max(g,w):_=Math.min(_,w);return _>g}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{n=Math.min(n,u.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,u,g){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const S=w.tileID,L=1<<S.overscaledZ,{x:M,y:V}=S.canonical,Y=M/L,J=(M+1)/L,Z=V/L,te=(V+1)/L;return{minx:Y,miny:Z,maxx:J,maxy:te,t:w.dem.tree.raycastRoot(Y,Z,J,te,n,u,g),tile:w}});_.sort((w,S)=>(w.t!==null?w.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const w of _){if(w.t==null)return null;const S=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,n,u,g);if(S!=null)return S}return null}_createFBO(){const n=this.painter.context,u=n.gl,g=this.drapeBufferSize;n.activeTexture.set(u.TEXTURE0);const _=new r.T(n,{width:g[0],height:g[1],data:null},u.RGBA8);_.bind(u.LINEAR,u.CLAMP_TO_EDGE);const w=n.createFramebuffer(g[0],g[1],!0,null);return w.colorAttachment.set(_.texture),w.depthAttachment=new kf(n,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:w,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const u=this._style._mergedLayers[n],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const g of this._style.getSources())if(g instanceof fc){n=!0;break}if(!n)return;const u={};for(let g=0;g<this._style.order.length;++g){const _=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(_);if(w&&!u[w.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof r.ab){u[w.id]=!0;for(const S of this.proxyCoords){const L=this.proxyToSource[S.key][w.id];if(L)for(const M of L)this._clearRenderCacheForTile(w.id,M)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof us){n=!0;break}if(!n)return;const u={};for(let g=0;g<this._style.order.length;++g){const _=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(_);if(!w||u[w.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const S=_.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const M=this.proxyToSource[L.key][w.id];if(M)for(const V of M){const Y=Hu(w.getTile(V),w.findLoadedParent(V,0),w,this.painter.transform,S);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(w.id,V)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,u=n.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let _,w=0,S=this._style._mergedLayers[n[w]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++w<u;)S=this._style._mergedLayers[n[w]];for(;w<u;++w){const L=this._style._mergedLayers[n[w]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?_===void 0&&(_=w):(L.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),_!==void 0&&(g.push({start:_,end:w-1}),_=void 0)))}if(_!==void 0&&g.push({start:_,end:w-1}),g.length!==0){const L=g[g.length-1];this._pendingGroundEffectLayers.every(M=>M>L.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(n){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let L=0;L<S.length;++L){const M=Object.values(S[L]);u.renderCachePool.push(...M)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,_=this._tilesDirty;for(let S=g.length-1;S>=0;S--){const L=g[S];if(u.getTileByID(L.key),u.proxyCachedFBO[L.key]!==void 0){const M=n[L.key],V=this.proxyToSource[L.key];let Y=0;for(const J in V){const Z=V[J],te=M[J];if(!te||te.length!==Z.length||Z.some((de,ue)=>de!==te[ue]||_[J]&&_[J].hasOwnProperty(de.key))){Y=-1;break}++Y}for(const J in u.proxyCachedFBO[L.key])u.renderCache[u.proxyCachedFBO[L.key][J]].dirty=Y<0||Y!==Object.values(M).length}}const w=[...this._drapedRenderBatches];w.sort((S,L)=>L.end-L.start-(S.end-S.start));for(const S of w)for(const L of g){if(u.proxyCachedFBO[L.key])continue;let M=u.renderCachePool.pop();M===void 0&&u.renderCache.length<50&&(M=u.renderCache.length,u.renderCache.push(this._createFBO())),M!==void 0&&(u.proxyCachedFBO[L.key]={},u.proxyCachedFBO[L.key][S.start]=M,u.renderCache[M].dirty=!0)}this._tilesDirty={}}_setupStencil(n,u,g,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,S=w.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let L;if(g.isTileClipped())L=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):Pr.disabled}_renderTileClippingMasks(n,u){const g=this.painter,_=this.painter.context,w=_.gl;g._tileClippingMaskIDs={},_.setColorMode(Wr.disabled),_.setDepthMode(ji.disabled);const S=g.getOrCreateProgram("clippingMask");for(const L of n){const M=g._tileClippingMaskIDs[L.key]=--u;S.draw(g,w.TRIANGLES,ji.disabled,new Pr({func:w.ALWAYS,mask:0},M,255,w.KEEP,w.KEEP,w.REPLACE),Wr.disabled,wr.disabled,vh(L.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(n){const u=this.painter.transform;if(n.x<0||n.x>u.width||n.y<0||n.y>u.height)return null;const g=[n.x,n.y,1,1];r.aA(g,g,u.pixelMatrixInverse),r.cw(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const _=u._camera.position,w=r.c6(1,u.center.lat),S=[_[0],_[1],_[2]/w,0],L=r.cX([],g.slice(0,3),S);r.au(L,L);const M=this.raycast(S,L,this._exaggeration);return M!==null&&M?(r.bE(S,S,L,M),S[3]=S[2],S[2]*=w,S):null}_setupProxiedCoordsForOrtho(n,u,g){if(n.getSource()instanceof r.aP)return this._setupProxiedCoordsForImageSource(n,u,g);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const _=this.proxiedCoords[n.id]=[],w=this.proxyCoords;for(let M=0;M<w.length;M++){const V=w[M],Y=this._findTileCoveringTileID(V,n);if(Y){const J=this._createProxiedId(V,Y,g[V.key]&&g[V.key][n.id]);_.push(J),this.proxyToSource[V.key][n.id]=[J]}}let S=!1;const L=new Set;for(let M=0;M<u.length;M++){const V=n.getTile(u[M]);if(!V||!V.hasData())continue;const Y=this._findTileCoveringTileID(V.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==V.tileID.canonical.z){const J=this.proxyToSource[Y.tileID.key][n.id],Z=this._createProxiedId(Y.tileID,V,g[Y.tileID.key]&&g[Y.tileID.key][n.id]);J?J.splice(J.length-1,0,Z):this.proxyToSource[Y.tileID.key][n.id]=[Z];const te=this.proxyToSource[Y.tileID.key][n.id];L.has(te)||L.add(te),_.push(Z),S=!0}}if(this._sourceTilesOverlap[n.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const M of L)M.sort((V,Y)=>Y.overscaledZ-V.overscaledZ)}_setupProxiedCoordsForImageSource(n,u,g){if(!n.getSource().loaded())return;const _=this.proxiedCoords[n.id]=[],w=this.proxyCoords,S=n.getSource(),L=S.tileID;if(!L)return;const M=new r.P(L.x,L.y)._div(1<<L.z),V=S.coordinates.map(r.ac.fromLngLat).reduce((J,Z)=>(J.min.x=Math.min(J.min.x,Z.x-M.x),J.min.y=Math.min(J.min.y,Z.y-M.y),J.max.x=Math.max(J.max.x,Z.x-M.x),J.max.y=Math.max(J.max.y,Z.y-M.y),J),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(J,Z)=>{const te=J.wrap+J.canonical.x/(1<<J.canonical.z),de=J.canonical.y/(1<<J.canonical.z),ue=r.aj/(1<<J.canonical.z),ge=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),_e=Z.canonical.y/(1<<Z.canonical.z);return te+ue<ge+V.min.x||te>ge+V.max.x||de+ue<_e+V.min.y||de>_e+V.max.y};for(let J=0;J<w.length;J++){const Z=w[J];for(let te=0;te<u.length;te++){const de=n.getTile(u[te]);if(!de||!de.hasData()||Y(Z,de.tileID))continue;const ue=this._createProxiedId(Z,de,g[Z.key]&&g[Z.key][n.id]),ge=this.proxyToSource[Z.key][n.id];ge?ge.push(ue):this.proxyToSource[Z.key][n.id]=[ue],_.push(ue)}}}_createProxiedId(n,u,g){let _=this.orthoMatrix;if(g){const w=g.find(S=>S.key===u.tileID.key);if(w)return w}if(u.tileID.key!==n.key){const w=n.canonical.z-u.tileID.canonical.z;let S,L,M;_=r.bz();const V=u.tileID.wrap-n.wrap<<n.overscaledZ;w>0?(S=r.aj>>w,L=S*((u.tileID.canonical.x<<w)-n.canonical.x+V),M=S*((u.tileID.canonical.y<<w)-n.canonical.y)):(S=r.aj<<-w,L=r.aj*(u.tileID.canonical.x-(n.canonical.x+V<<-w)),M=r.aj*(u.tileID.canonical.y-(n.canonical.y<<-w))),r.c5(_,0,S,0,S,0,1),r.bo(_,_,[L,M,0])}return new uA(u.tileID,n.key,_)}_findTileCoveringTileID(n,u){let g=u.getTile(n);if(g&&g.hasData())return g;const _=this._findCoveringTileCache[u.id],w=_[n.key];if(g=w?u.getTileByID(w):null,g&&g.hasData()||w===null)return g;let S=g?g.tileID:n,L=S.overscaledZ;const M=u.getSource().minzoom,V=[];if(!w){const J=u.getSource().maxzoom;if(n.canonical.z>=J){const Z=n.canonical.z-J;u.getSource().reparseOverscaled?(L=Math.max(n.canonical.z+2,u.transform.tileZoom),S=new r.aM(L,n.wrap,J,n.canonical.x>>Z,n.canonical.y>>Z)):Z!==0&&(L=J,S=new r.aM(L,n.wrap,J,n.canonical.x>>Z,n.canonical.y>>Z))}S.key!==n.key&&(V.push(S.key),g=u.getTile(S))}const Y=J=>{V.forEach(Z=>{_[Z]=J}),V.length=0};for(L-=1;L>=M&&(!g||!g.hasData());L--){g&&Y(g.tileID.key);const J=S.calculateScaledKey(L);if(g=u.getTileByID(J),g&&g.hasData())break;const Z=_[J];if(Z===null)break;Z===void 0?V.push(J):g=u.getTileByID(Z)}return Y(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,u){let g=this._tilesDirty[n];g||(g=this._tilesDirty[n]={}),g[u.key]=!0}}function hA(p,n,u){const g=function(L,M,V){const Y=r.bG(M,L),J=r.bG(V,[.2126,.7152,.0722]),Z=(de,ue,ge)=>(1-ge)*de+ge*ue,te=Z(1-.3*Math.min(J,1),1,Math.min(Y+1,1));return Z(.92,1,Math.asin(r.ay(M[2],-1,1))/Math.PI+.5)*te}(p,[0,0,1],n),_=[0,0,0];r.bY(_,u.slice(0,3),g);const w=[0,0,0];r.bY(w,n.slice(0,3),p[2]);const S=[0,0,0];return r.cV(S,_,w),r.cY(S)}const ZA=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],dA=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class _h{static cacheKey(n,u,g,_){let w=`${u}${_?_.cacheKey:""}`;for(const S of g)n.usedDefines.includes(S)&&(w+=`/${S}`);return w}constructor(n,u,g,_,w,S){const L=n.gl;this.program=L.createProgram(),this.configuration=_,this.name=u,this.fixedDefines=[...S];const M=_?_.getBinderAttributes():[],V=(g.staticAttributes||[]).concat(M);let Y=_?_.defines():[];Y=Y.concat(S.map(ge=>`#define ${ge}`));const J=`#version 300 es
`;let Z=J+Y.concat("precision mediump float;",za,bu.fragmentSource).join(`
`);for(const ge of g.fragmentIncludes)Z+=`
${fo[ge]}`;Z+=`
${g.fragmentSource}`;let te=J+Y.concat("precision highp float;",za,bu.vertexSource).join(`
`);for(const ge of g.vertexIncludes)te+=`
${fo[ge]}`;this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(te+=`
uniform int u_instanceID;
`),te+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(te=te.replaceAll("gl_InstanceID","u_instanceID"));const de=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(de,Z),L.compileShader(de),L.attachShader(this.program,de);const ue=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(ue,te),L.compileShader(ue),L.attachShader(this.program,ue),this.attributes={},this.numAttributes=V.length;for(let ge=0;ge<this.numAttributes;ge++)if(V[ge]){const _e=V[ge].startsWith("a_")?V[ge]:`a_${V[ge]}`;L.bindAttribLocation(this.program,ge,_e),this.attributes[_e]=ge}L.linkProgram(this.program),L.deleteShader(ue),L.deleteShader(de),this.fixedUniforms=w(n),this.binderUniforms=_?_.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ge=>({u_instanceID:new r.c8(ge)}))(n)),(S.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(ge=>({u_dem:new r.c8(ge),u_dem_prev:new r.c8(ge),u_dem_tl:new r.cb(ge),u_dem_scale:new r.ca(ge),u_dem_tl_prev:new r.cb(ge),u_dem_scale_prev:new r.ca(ge),u_dem_size:new r.ca(ge),u_dem_lerp:new r.ca(ge),u_exaggeration:new r.ca(ge),u_depth:new r.c8(ge),u_depth_size_inv:new r.cb(ge),u_depth_range_unpack:new r.cb(ge),u_occluder_half_size:new r.ca(ge),u_occlusion_depth_offset:new r.ca(ge),u_meter_to_dem:new r.ca(ge),u_label_plane_matrix_inv:new r.cc(ge)}))(n)),S.includes("GLOBE")&&(this.globeUniforms=(ge=>({u_tile_tl_up:new r.c9(ge),u_tile_tr_up:new r.c9(ge),u_tile_br_up:new r.c9(ge),u_tile_bl_up:new r.c9(ge),u_tile_up_scale:new r.ca(ge)}))(n)),S.includes("FOG")&&(this.fogUniforms=(ge=>({u_fog_matrix:new r.cc(ge),u_fog_range:new r.cb(ge),u_fog_color:new r.cQ(ge),u_fog_horizon_blend:new r.ca(ge),u_fog_vertical_limit:new r.cb(ge),u_fog_temporal_offset:new r.ca(ge),u_frustum_tl:new r.c9(ge),u_frustum_tr:new r.c9(ge),u_frustum_br:new r.c9(ge),u_frustum_bl:new r.c9(ge),u_globe_pos:new r.c9(ge),u_globe_radius:new r.ca(ge),u_globe_transition:new r.ca(ge),u_is_globe:new r.c8(ge),u_viewport:new r.cb(ge)}))(n)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ge=>({u_cutoff_params:new r.cQ(ge)}))(n)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ge=>({u_lighting_ambient_color:new r.c9(ge),u_lighting_directional_dir:new r.c9(ge),u_lighting_directional_color:new r.c9(ge),u_ground_radiance:new r.c9(ge)}))(n)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ge=>({u_light_matrix_0:new r.cc(ge),u_light_matrix_1:new r.cc(ge),u_fade_range:new r.cb(ge),u_shadow_normal_offset:new r.c9(ge),u_shadow_intensity:new r.ca(ge),u_shadow_texel_size:new r.ca(ge),u_shadow_map_resolution:new r.ca(ge),u_shadow_direction:new r.c9(ge),u_shadow_bias:new r.c9(ge),u_shadowmap_0:new r.c8(ge),u_shadowmap_1:new r.c8(ge)}))(n))}}setTerrainUniformValues(n,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in u)g[_]&&g[_].set(this.program,_,u[_])}}setGlobeUniformValues(n,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in u)g[_]&&g[_].set(this.program,_,u[_])}}setFogUniformValues(n,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in u)g[_].set(this.program,_,u[_])}}setCutoffUniformValues(n,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in u)g[_].set(this.program,_,u[_])}}setLightsUniformValues(n,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in u)g[_].set(this.program,_,u[_])}}setShadowUniformValues(n,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;n.program.set(this.program);for(const _ in u)g[_].set(this.program,_,u[_])}_drawDebugWireframe(n,u,g,_,w,S,L,M,V,Y){const J=n.options.wireframe;if(J.terrain===!1&&J.layers2D===!1&&J.layers3D===!1)return;const Z=n.context;if(!(!(!J.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!J.layers2D||n._terrain&&n._terrain.renderingToTexture||!ZA.includes(this.name))||!(!J.layers3D||!dA.includes(this.name))))return;const te=Z.gl,de=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,w,Z);if(!de)return;const ue=[...this.fixedDefines];ue.push("DEBUG_WIREFRAME");const ge=n.getOrCreateProgram(this.name,{config:this.configuration,defines:ue});Z.program.set(ge.program);const _e=(Qe,at,st)=>{if(at[Qe]&&st[Qe])for(const it in at[Qe])st[Qe][it]&&st[Qe][it].set(st.program,it,at[Qe][it].current)};V&&V.setUniforms(ge.program,Z,ge.binderUniforms,L,{zoom:M}),_e("fixedUniforms",this,ge),_e("terrainUniforms",this,ge),_e("globeUniforms",this,ge),_e("fogUniforms",this,ge),_e("lightsUniforms",this,ge),_e("shadowUniforms",this,ge),de.bind(),Z.setColorMode(new Wr([te.ONE,te.ONE_MINUS_SRC_ALPHA,te.ZERO,te.ONE],r.am.transparent,[!0,!0,!0,!1])),Z.setDepthMode(new ji(u.func===te.LESS?te.LEQUAL:u.func,ji.ReadOnly,u.range)),Z.setStencilMode(Pr.disabled);const Te=3*S.primitiveLength*2,Ne=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Qe=Y||1;for(let at=0;at<Qe;++at)ge.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",at),te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,Ne)}else Y&&Y>1?te.drawElementsInstanced(te.LINES,Te,te.UNSIGNED_SHORT,Ne,Y):te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,Ne);w.bind(),Z.program.set(this.program),Z.setDepthMode(u),Z.setStencilMode(g),Z.setColorMode(_)}checkUniforms(n,u,g){if(this.fixedDefines.includes(u)){for(const _ of Object.keys(g))if(!g[_].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${_} not set but required by ${u} being defined`)}}draw(n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge){const _e=n.context,Te=_e.gl;if(this.failedToCreate)return;_e.program.set(this.program),_e.setDepthMode(g),_e.setStencilMode(_),_e.setColorMode(w),_e.setCullFace(S);for(const at of Object.keys(this.fixedUniforms))this.fixedUniforms[at].set(this.program,at,L[at]);de&&de.setUniforms(this.program,_e,this.binderUniforms,Z,{zoom:te});const Ne={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[u];this.checkUniforms(M,"RENDER_SHADOWS",this.shadowUniforms);const Qe=ge&&ge>0?1:void 0;for(const at of J.get()){const st=at.vaos||(at.vaos={});if((st[M]||(st[M]=new La)).bind(_e,this,V,de?de.getPaintVertexBuffers():[],Y,at.vertexOffset,ue||[],Qe),this.forceManualRenderingForInstanceIDShaders){const it=ge||1;for(let Xe=0;Xe<it;++Xe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Xe),Y?Te.drawElements(u,at.primitiveLength*Ne,Te.UNSIGNED_SHORT,at.primitiveOffset*Ne*2):Te.drawArrays(u,at.vertexOffset,at.vertexLength)}else ge&&ge>1?Te.drawElementsInstanced(u,at.primitiveLength*Ne,Te.UNSIGNED_SHORT,at.primitiveOffset*Ne*2,ge):Y?Te.drawElements(u,at.primitiveLength*Ne,Te.UNSIGNED_SHORT,at.primitiveOffset*Ne*2):Te.drawArrays(u,at.vertexOffset,at.vertexLength);u===Te.TRIANGLES&&Y&&this._drawDebugWireframe(n,g,_,w,Y,at,Z,te,de,ge)}}}function Ad(p,n,u=0){const g=Math.pow(2,n.tileID.overscaledZ),_=n.tileSize*Math.pow(2,p.transform.tileZoom)/g,w=_*(n.tileID.canonical.x+n.tileID.wrap*g),S=_*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.aw(n,1,p.transform.tileZoom),u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S],u_pattern_transition:u}}const xh={terrain:0,flat:1},AA=r.bz(),D=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e)=>{const Te=n.style.light,Ne=Te.properties.get("position"),Qe=[Ne.x,Ne.y,Ne.z],at=r.dx();Te.properties.get("anchor")==="viewport"&&(r.dy(at,-n.transform.angle),r.dz(Qe,Qe,at));const st=Te.properties.get("color").toPremultipliedRenderColor(null),it=n.transform,Xe={u_matrix:p,u_lightpos:Qe,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[st.r,st.g,st.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:AA,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:xh[V],u_base_type:xh[Y],u_ao:_,u_edge_radius:w,u_width_scale:S,u_flood_light_color:de,u_vertical_scale:ue,u_flood_light_intensity:ge,u_ground_shadow_factor:_e};return it.projection.name==="globe"&&(Xe.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],Xe.u_zoom_transition=J,Xe.u_inv_rot_matrix=te,Xe.u_merc_center=Z,Xe.u_up_dir=it.projection.upVector(new r.cp(0,0,0),Z[0]*r.aj,Z[1]*r.aj),Xe.u_height_lift=M),Xe},K=(p,n,u,g,_,w)=>({u_matrix:p,u_edge_radius:n,u_width_scale:u,u_vertical_scale:g,u_height_type:xh[_],u_base_type:xh[w]}),se=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e)=>{const Te=D(p,n,u,g,_,w,S,L,V,Y,J,Z,te,de,ue,ge,1,[0,0,0]),Ne={u_height_factor:-Math.pow(2,L.overscaledZ)/M.tileSize/8};return r.h(Te,Ad(n,M,_e),Ne)},xe=(p,n,u)=>({u_matrix:p,u_emissive_strength:n,u_ground_shadow_factor:u}),Oe=(p,n,u,g,_,w=0)=>r.h(xe(p,n,_),Ad(u,g,w)),We=(p,n,u,g)=>({u_matrix:p,u_world:u,u_emissive_strength:n,u_ground_shadow_factor:g}),$e=(p,n,u,g,_,w,S=0)=>r.h(Oe(p,n,u,g,w,S),{u_world:_}),nt=(p,n)=>({u_matrix:p,u_ground_shadow_factor:n}),ct=(p,n,u,g,_)=>({u_matrix:p,u_camera_pos:[n[0],n[1],n[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:_}),xt=(p,n,u,g)=>{const _=r.aj/u.tileSize;return{u_matrix:p,u_camera_to_center_distance:n.getCameraToCenterDistance(g),u_extrude_scale:[n.pixelsToGLUnits[0]/_,n.pixelsToGLUnits[1]/_]}},Xt=(p,n,u=1)=>({u_matrix:p,u_color:n,u_overlay:0,u_overlay_scale:u}),xi=r.bz(),Bi=(p,n,u,g,_,w,S)=>{const L=p.transform,M=L.projection.name==="globe",V=M?r.dA(L.zoom,n.canonical)*L._pixelsPerMercatorPixel:r.aw(u,1,w),Y={u_matrix:n.projMatrix,u_extrude_scale:V,u_intensity:S,u_inv_rot_matrix:xi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){Y.u_inv_rot_matrix=g,Y.u_merc_center=_,Y.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],Y.u_zoom_transition=r.ah(L.zoom);const J=_[0]*r.aj,Z=_[1]*r.aj;Y.u_up_dir=L.projection.upVector(new r.cp(0,0,0),J,Z)}return Y};function ci(p,[n,u,g,_],[w,S]){if(w===S)return[0,0,0,0];const L=255*(p-1)/(p*(S-w));return[n*L,u*L,g*L,_*L]}function Hi(p,n,[u,g]){return u===g?0:.5/p+(n-u)*(p-1)/(p*(g-u))}const Ni=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te,Ne,Qe)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:_,u_tl_parent:w,u_scale_parent:V,u_fade_t:Y.mix,u_opacity:Y.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:r.dC(J.paint.get("raster-saturation")),u_contrast_factor:r.dB(J.paint.get("raster-contrast")),u_spin_weights:Zt(J.paint.get("raster-hue-rotate")),u_perspective_transform:Z,u_raster_elevation:te,u_zoom_transition:S,u_merc_center:L,u_cutoff_params:M,u_colorization_mix:ci(r.dD,ue,_e),u_colorization_offset:Hi(r.dD,ge,_e),u_color_ramp:de,u_texture_offset:[Ne/(Te+2*Ne),Te/(Te+2*Ne)],u_texture_res:[Te+2*Ne,Te+2*Ne],u_emissive_strength:Qe});function Zt(p){p*=Math.PI/180;const n=Math.sin(p),u=Math.cos(p);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const ei=.05,qi=(p,n,u,g,_,w,S,L,M,V,Y,J)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:_,u_tl_parent:w,u_scale_parent:V,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:J,u_zoom_transition:S,u_merc_center:L,u_cutoff_params:M}),lr=(p,n,u,g,_,w,S,L,M,V)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_tile_offset:u,u_velocity:g,u_color_ramp:w,u_velocity_res:_,u_max_speed:S,u_uv_offset:L,u_data_scale:[255*M[0],255*M[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[ei,ei]}),$i=(p,n,u,g,_,w,S,L,M,V)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_velocity:u,u_velocity_res:g,u_max_speed:_,u_speed_factor:w,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:L,u_data_scale:[255*M[0],255*M[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[ei,ei]}),Xr=r.bz(),Ir=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te,Ne,Qe,at,st,it)=>{const Xe=_.transform,lt={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Xe.getCameraToCenterDistance(Te),u_rotate_symbol:+u,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:L,u_is_text:+V,u_elevation_from_sea:M?1:0,u_pitch_with_map:+g,u_texsize:Y,u_texsize_icon:J,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xr,u_up_vector:[0,-1,0],u_color_adj_mat:at,u_icon_transition:st||0,u_gamma_scale:g?_.transform.getCameraToCenterDistance(Te)*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:1,u_scale_factor:it||1,u_ground_shadow_factor:Ne,u_inv_matrix:r.bi(r.bz(),S),u_normal_scale:Qe};return Te.name==="globe"&&(lt.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],lt.u_zoom_transition=de,lt.u_inv_rot_matrix=ge,lt.u_merc_center=ue,lt.u_camera_forward=Xe._camera.forward(),lt.u_ecef_origin=r.dE(Xe.globeMatrix,te.toUnwrapped()),lt.u_tile_matrix=Float32Array.from(Xe.globeMatrix),lt.u_up_vector=_e),lt},bn=(p,n,u,g)=>({u_matrix:p,u_emissive_strength:n,u_opacity:u,u_color:g}),zr=(p,n,u,g,_,w,S,L,M)=>r.h(function(V,Y,J,Z,te,de){const{width:ue,height:ge}=Z.imageManager.getPixelSize(Y),_e=Math.pow(2,de.tileID.overscaledZ),Te=de.tileSize*Math.pow(2,Z.transform.tileZoom)/_e,Ne=Te*(de.tileID.canonical.x+de.tileID.wrap*_e),Qe=Te*de.tileID.canonical.y;return{u_image:0,u_pattern_tl:J.tl,u_pattern_br:J.br,u_texsize:[ue,ge],u_pattern_size:J.displaySize,u_pattern_units_to_pixels:te?[Z.transform.width,-1*Z.transform.height]:[1/r.aw(de,1,Z.transform.tileZoom),1/r.aw(de,1,Z.transform.tileZoom)],u_pixel_coord_upper:[Ne>>16,Qe>>16],u_pixel_coord_lower:[65535&Ne,65535&Qe]}}(0,w,S,g,L,M),{u_matrix:p,u_emissive_strength:n,u_opacity:u}),Fs=new Float32Array(r.bx([])),Qs=(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te=[0,0,0],de)=>{const ue=_.style.light,ge=ue.properties.get("position"),_e=[-ge.x,-ge.y,ge.z],Te=r.dx();ue.properties.get("anchor")==="viewport"&&(r.dy(Te,-_.transform.angle),r.dz(_e,_e,Te));const Ne=Y.alphaMode==="MASK",Qe=ue.properties.get("color").toNonPremultipliedRenderColor(null),at=Z.paint.get("model-ambient-occlusion-intensity"),st=Z.paint.get("model-color").constantOr(r.am.white).toNonPremultipliedRenderColor(null);return st.a=Z.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:p,u_lighting_matrix:n,u_normal_matrix:u,u_node_matrix:g||Fs,u_lightpos:_e,u_lightintensity:ue.properties.get("intensity"),u_lightcolor:[Qe.r,Qe.g,Qe.b],u_camera_pos:te,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Ne,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:L.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:M,u_roughnessFactor:V,u_baseColorTexture:Yo.BaseColor,u_metallicRoughnessTexture:Yo.MetallicRoughness,u_normalTexture:Yo.Normal,u_occlusionTexture:Yo.Occlusion,u_emissionTexture:Yo.Emission,u_lutTexture:Yo.LUT,u_color_mix:st.toArray01(),u_aoIntensity:at,u_emissive_strength:J,u_occlusionTextureTransform:de||[0,0,0,0]}},Ls=(p,n=Fs,u=Fs)=>({u_matrix:p,u_instance:n,u_node_matrix:u}),dr={fillExtrusion:p=>({u_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_vertical_gradient:new r.ca(p),u_opacity:new r.ca(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_ao:new r.cb(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_up_dir:new r.c9(p),u_height_lift:new r.ca(p),u_flood_light_color:new r.c9(p),u_vertical_scale:new r.ca(p),u_flood_light_intensity:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),fillExtrusionDepth:p=>({u_matrix:new r.cc(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_vertical_scale:new r.ca(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p)}),fillExtrusionPattern:p=>({u_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_vertical_gradient:new r.ca(p),u_height_factor:new r.ca(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_ao:new r.cb(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_up_dir:new r.c9(p),u_height_lift:new r.ca(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_opacity:new r.ca(p),u_pattern_transition:new r.ca(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new r.cc(p),u_opacity:new r.ca(p),u_ao_pass:new r.ca(p),u_meter_to_tile:new r.ca(p),u_ao:new r.cb(p),u_flood_light_intensity:new r.ca(p),u_flood_light_color:new r.c9(p),u_attenuation:new r.ca(p),u_edge_radius:new r.ca(p),u_fb:new r.c8(p),u_fb_size:new r.ca(p),u_dynamic_offset:new r.ca(p)}),fill:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),fillPattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_pattern_transition:new r.ca(p)}),fillOutline:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_world:new r.cb(p),u_ground_shadow_factor:new r.c9(p)}),fillOutlinePattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_world:new r.cb(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_pattern_transition:new r.ca(p)}),building:p=>({u_matrix:new r.cc(p),u_normal_matrix:new r.cc(p),u_opacity:new r.ca(p)}),buildingDepth:p=>({u_matrix:new r.cc(p)}),elevatedStructuresDepth:p=>({u_matrix:new r.cc(p),u_depth_bias:new r.ca(p)}),elevatedStructures:p=>({u_matrix:new r.cc(p),u_ground_shadow_factor:new r.c9(p)}),elevatedStructuresDepthReconstruct:p=>({u_matrix:new r.cc(p),u_camera_pos:new r.c9(p),u_depth_bias:new r.ca(p),u_height_scale:new r.ca(p),u_reset_depth:new r.ca(p)}),circle:r.dH,collisionBox:p=>({u_matrix:new r.cc(p),u_camera_to_center_distance:new r.ca(p),u_extrude_scale:new r.cb(p)}),collisionCircle:p=>({u_matrix:new r.cc(p),u_inv_matrix:new r.cc(p),u_camera_to_center_distance:new r.ca(p),u_viewport_size:new r.cb(p)}),debug:p=>({u_color:new r.di(p),u_matrix:new r.cc(p),u_overlay:new r.c8(p),u_overlay_scale:new r.ca(p)}),clippingMask:p=>({u_matrix:new r.cc(p)}),heatmap:p=>({u_extrude_scale:new r.ca(p),u_intensity:new r.ca(p),u_matrix:new r.cc(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_up_dir:new r.c9(p)}),heatmapTexture:p=>({u_image:new r.c8(p),u_color_ramp:new r.c8(p),u_opacity:new r.ca(p)}),hillshade:p=>({u_matrix:new r.cc(p),u_image:new r.c8(p),u_latrange:new r.cb(p),u_light:new r.cb(p),u_shadow:new r.di(p),u_highlight:new r.di(p),u_emissive_strength:new r.ca(p),u_accent:new r.di(p)}),hillshadePrepare:p=>({u_matrix:new r.cc(p),u_image:new r.c8(p),u_dimension:new r.cb(p),u_zoom:new r.ca(p)}),line:r.dG,linePattern:r.dF,raster:p=>({u_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_grid_matrix:new r.dj(p),u_tl_parent:new r.cb(p),u_scale_parent:new r.ca(p),u_fade_t:new r.ca(p),u_opacity:new r.ca(p),u_image0:new r.c8(p),u_image1:new r.c8(p),u_brightness_low:new r.ca(p),u_brightness_high:new r.ca(p),u_saturation_factor:new r.ca(p),u_contrast_factor:new r.ca(p),u_spin_weights:new r.c9(p),u_perspective_transform:new r.cb(p),u_raster_elevation:new r.ca(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_cutoff_params:new r.cQ(p),u_colorization_mix:new r.cQ(p),u_colorization_offset:new r.ca(p),u_color_ramp:new r.c8(p),u_texture_offset:new r.cb(p),u_texture_res:new r.cb(p),u_emissive_strength:new r.ca(p)}),rasterParticle:p=>({u_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_grid_matrix:new r.dj(p),u_tl_parent:new r.cb(p),u_scale_parent:new r.ca(p),u_fade_t:new r.ca(p),u_opacity:new r.ca(p),u_image0:new r.c8(p),u_image1:new r.c8(p),u_raster_elevation:new r.ca(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_cutoff_params:new r.cQ(p)}),rasterParticleTexture:p=>({u_texture:new r.c8(p),u_opacity:new r.ca(p)}),rasterParticleDraw:p=>({u_particle_texture:new r.c8(p),u_particle_texture_side_len:new r.ca(p),u_tile_offset:new r.cb(p),u_velocity:new r.c8(p),u_color_ramp:new r.c8(p),u_velocity_res:new r.cb(p),u_max_speed:new r.ca(p),u_uv_offset:new r.cb(p),u_data_scale:new r.cb(p),u_data_offset:new r.ca(p),u_particle_pos_scale:new r.ca(p),u_particle_pos_offset:new r.cb(p)}),rasterParticleUpdate:p=>({u_particle_texture:new r.c8(p),u_particle_texture_side_len:new r.ca(p),u_velocity:new r.c8(p),u_velocity_res:new r.cb(p),u_max_speed:new r.ca(p),u_speed_factor:new r.ca(p),u_reset_rate:new r.ca(p),u_rand_seed:new r.ca(p),u_uv_offset:new r.cb(p),u_data_scale:new r.cb(p),u_data_offset:new r.ca(p),u_particle_pos_scale:new r.ca(p),u_particle_pos_offset:new r.cb(p)}),symbol:p=>({u_is_size_zoom_constant:new r.c8(p),u_is_size_feature_constant:new r.c8(p),u_size_t:new r.ca(p),u_size:new r.ca(p),u_camera_to_center_distance:new r.ca(p),u_rotate_symbol:new r.c8(p),u_aspect_ratio:new r.ca(p),u_fade_change:new r.ca(p),u_matrix:new r.cc(p),u_label_plane_matrix:new r.cc(p),u_coord_matrix:new r.cc(p),u_is_text:new r.c8(p),u_elevation_from_sea:new r.c8(p),u_pitch_with_map:new r.c8(p),u_texsize:new r.cb(p),u_texsize_icon:new r.cb(p),u_texture:new r.c8(p),u_texture_icon:new r.c8(p),u_gamma_scale:new r.ca(p),u_device_pixel_ratio:new r.ca(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_camera_forward:new r.c9(p),u_tile_matrix:new r.cc(p),u_up_vector:new r.c9(p),u_ecef_origin:new r.c9(p),u_is_halo:new r.c8(p),u_icon_transition:new r.ca(p),u_color_adj_mat:new r.cc(p),u_scale_factor:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_inv_matrix:new r.cc(p),u_normal_scale:new r.ca(p)}),background:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_opacity:new r.ca(p),u_color:new r.di(p)}),backgroundPattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_opacity:new r.ca(p),u_image:new r.c8(p),u_pattern_tl:new r.cb(p),u_pattern_br:new r.cb(p),u_texsize:new r.cb(p),u_pattern_size:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_pattern_units_to_pixels:new r.cb(p)}),terrainRaster:p=>({u_matrix:new r.cc(p),u_image0:new r.c8(p),u_skirt_height:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),skybox:p=>({u_matrix:new r.cc(p),u_sun_direction:new r.c9(p),u_cubemap:new r.c8(p),u_opacity:new r.ca(p),u_temporal_offset:new r.ca(p)}),skyboxGradient:p=>({u_matrix:new r.cc(p),u_color_ramp:new r.c8(p),u_center_direction:new r.c9(p),u_radius:new r.ca(p),u_opacity:new r.ca(p),u_temporal_offset:new r.ca(p)}),skyboxCapture:p=>({u_matrix_3f:new r.dj(p),u_sun_direction:new r.c9(p),u_sun_intensity:new r.ca(p),u_color_tint_r:new r.cQ(p),u_color_tint_m:new r.cQ(p),u_luminance:new r.ca(p)}),globeRaster:p=>({u_proj_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_image0:new r.c8(p),u_grid_matrix:new r.dj(p),u_skirt_height:new r.ca(p),u_far_z_cutoff:new r.ca(p),u_frustum_tl:new r.c9(p),u_frustum_tr:new r.c9(p),u_frustum_br:new r.c9(p),u_frustum_bl:new r.c9(p),u_globe_pos:new r.c9(p),u_globe_radius:new r.ca(p),u_viewport:new r.cb(p)}),globeAtmosphere:p=>({u_frustum_tl:new r.c9(p),u_frustum_tr:new r.c9(p),u_frustum_br:new r.c9(p),u_frustum_bl:new r.c9(p),u_horizon:new r.ca(p),u_transition:new r.ca(p),u_fadeout_range:new r.ca(p),u_color:new r.cQ(p),u_high_color:new r.cQ(p),u_space_color:new r.cQ(p),u_temporal_offset:new r.ca(p),u_horizon_angle:new r.ca(p)}),model:p=>({u_matrix:new r.cc(p),u_lighting_matrix:new r.cc(p),u_normal_matrix:new r.cc(p),u_node_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_camera_pos:new r.c9(p),u_opacity:new r.ca(p),u_baseColorFactor:new r.cQ(p),u_emissiveFactor:new r.cQ(p),u_metallicFactor:new r.ca(p),u_roughnessFactor:new r.ca(p),u_baseTextureIsAlpha:new r.c8(p),u_alphaMask:new r.c8(p),u_alphaCutoff:new r.ca(p),u_baseColorTexture:new r.c8(p),u_metallicRoughnessTexture:new r.c8(p),u_normalTexture:new r.c8(p),u_occlusionTexture:new r.c8(p),u_emissionTexture:new r.c8(p),u_lutTexture:new r.c8(p),u_color_mix:new r.cQ(p),u_aoIntensity:new r.ca(p),u_emissive_strength:new r.ca(p),u_occlusionTextureTransform:new r.cQ(p)}),modelDepth:p=>({u_matrix:new r.cc(p),u_instance:new r.cc(p),u_node_matrix:new r.cc(p)}),groundShadow:p=>({u_matrix:new r.cc(p),u_ground_shadow_factor:new r.c9(p)}),stars:p=>({u_matrix:new r.cc(p),u_up:new r.c9(p),u_right:new r.c9(p),u_intensity_multiplier:new r.ca(p)}),snowParticle:p=>({u_modelview:new r.cc(p),u_projection:new r.cc(p),u_time:new r.ca(p),u_cam_pos:new r.c9(p),u_velocityConeAperture:new r.ca(p),u_velocity:new r.ca(p),u_horizontalOscillationRadius:new r.ca(p),u_horizontalOscillationRate:new r.ca(p),u_boxSize:new r.ca(p),u_billboardSize:new r.ca(p),u_simpleShapeParameters:new r.cb(p),u_screenSize:new r.cb(p),u_thinningCenterPos:new r.cb(p),u_thinningShape:new r.c9(p),u_thinningAffectedRatio:new r.ca(p),u_thinningParticleOffset:new r.ca(p),u_particleColor:new r.cQ(p),u_direction:new r.c9(p)}),rainParticle:p=>({u_modelview:new r.cc(p),u_projection:new r.cc(p),u_time:new r.ca(p),u_cam_pos:new r.c9(p),u_texScreen:new r.c8(p),u_velocityConeAperture:new r.ca(p),u_velocity:new r.ca(p),u_boxSize:new r.ca(p),u_rainDropletSize:new r.cb(p),u_distortionStrength:new r.ca(p),u_rainDirection:new r.c9(p),u_color:new r.cQ(p),u_screenSize:new r.cb(p),u_thinningCenterPos:new r.cb(p),u_thinningShape:new r.c9(p),u_thinningAffectedRatio:new r.ca(p),u_thinningParticleOffset:new r.ca(p),u_shapeDirectionalPower:new r.ca(p),u_shapeNormalPower:new r.ca(p),u_mode:new r.ca(p)}),vignette:p=>({u_vignetteShape:new r.c9(p),u_vignetteColor:new r.cQ(p)}),occlusion:p=>({u_matrix:new r.cc(p),u_anchorPos:new r.c9(p),u_screenSizePx:new r.cb(p),u_occluderSizePx:new r.cb(p),u_color:new r.cQ(p)})};class gs{constructor(n,u,g,_){this.id=gs.uniqueIdxCounter,gs.uniqueIdxCounter++,this.context=n;const w=n.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||_||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=gs.uniqueIdxCounter,gs.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}gs.uniqueIdxCounter=0;const lo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Vn{constructor(n,u,g,_,w,S){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.instanceCount=S,this.context=n;const L=n.gl;this.buffer=L.createBuffer(),n.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||w||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let g=0;g<this.attributes.length;g++){const _=u.attributes[this.attributes[g].name];_!==void 0&&n.enableVertexAttribArray(_)}}setVertexAttribPointers(n,u,g){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],S=u.attributes[w.name];S!==void 0&&n.vertexAttribPointer(S,w.components,n[lo[w.type]],!1,this.itemSize,w.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(n,u,g){for(let _=0;_<this.attributes.length;_++){const w=u.attributes[this.attributes[_].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(w,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qs{constructor(n,u,g,_,w){this.context=n,this.width=u,this.height=g;const S=this.framebuffer=n.gl.createFramebuffer();_&&(this.colorAttachment=new Pf(n,S)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new aA(n,S):new ud(n,S))}destroy(){const n=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&n.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&n.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&n.deleteTexture(u)}n.deleteFramebuffer(this.framebuffer)}}class Cl{constructor(n,u){this.gl=n,this.clearColor=new cd(this),this.clearDepth=new zu(this),this.clearStencil=new Ef(this),this.colorMask=new XA(this),this.depthMask=new YA(this),this.stencilMask=new tA(this),this.stencilFunc=new mh(this),this.stencilOp=new Ep(this),this.stencilTest=new iA(this),this.depthRange=new Tf(this),this.depthTest=new If(this),this.depthFunc=new Vh(this),this.blend=new rA(this),this.blendFunc=new KA(this),this.blendColor=new yh(this),this.blendEquation=new Nu(this),this.cullFace=new wu(this),this.cullFaceSide=new ju(this),this.frontFace=new Gh(this),this.program=new Ff(this),this.activeTexture=new nA(this),this.viewport=new Lf(this),this.bindFramebuffer=new Wh(this),this.bindRenderbuffer=new sA(this),this.bindTexture=new oA(this),this.bindVertexBuffer=new Wc(this),this.bindElementBuffer=new Bl(this),this.bindVertexArrayOES=new tl(this),this.pixelStoreUnpack=new Mf(this),this.pixelStoreUnpackPremultiplyAlpha=new qA(this),this.pixelStoreUnpackFlipY=new Xc(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u,g){return new gs(this,n,u,g)}createVertexBuffer(n,u,g,_,w){return new Vn(this,n,u,g,_,w)}createRenderbuffer(n,u,g){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,n,u,g),this.bindRenderbuffer.set(null),w}createFramebuffer(n,u,g,_){return new qs(this,n,u,g,_)}clear({color:n,depth:u,stencil:g,colorMask:_}){const w=this.gl;let S=0;n&&(S|=w.COLOR_BUFFER_BIT,this.clearColor.set(n.toNonPremultipliedRenderColor(null)),this.colorMask.set(_||[!0,!0,!0,!0])),u!==void 0&&(S|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(S|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),w.clear(S)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){r.bv(n.blendFunction,Wr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let bo;function oa(p,n,u,g,_,w,S){const L=p.context,M=L.gl,V=p.transform,Y=p.getOrCreateProgram("collisionBox"),J=[];let Z=0,te=0;for(let Qe=0;Qe<g.length;Qe++){const at=g[Qe],st=n.getTile(at),it=st.getBucket(u);if(!it)continue;const Xe=Er(at,it,V);let lt=Xe;_[0]===0&&_[1]===0||(lt=p.translatePosMatrix(Xe,st,_,w));const dt=S?it.textCollisionBox:it.iconCollisionBox,kt=it.collisionCircleArray;if(kt.length>0){const Dt=r.bz(),ti=lt;r.cB(Dt,it.placementInvProjMatrix,V.glCoordMatrix),r.cB(Dt,Dt,it.placementViewportMatrix),J.push({circleArray:kt,circleOffset:te,transform:ti,invTransform:Dt,projection:it.getProjection()}),Z+=kt.length/4,te=Z}dt&&(p.terrain&&p.terrain.setupElevationDraw(st,Y),Y.draw(p,M.LINES,ji.disabled,Pr.disabled,p.colorModeForRenderPass(),wr.disabled,xt(lt,V,st,it.getProjection()),u.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,null,V.zoom,null,[dt.collisionVertexBuffer,dt.collisionVertexBufferExt]))}if(!S||!J.length)return;const de=p.getOrCreateProgram("collisionCircle"),ue=new r.dI;ue.resize(4*Z),ue._trim();let ge=0;for(const Qe of J)for(let at=0;at<Qe.circleArray.length/4;at++){const st=4*at,it=Qe.circleArray[st+0],Xe=Qe.circleArray[st+1],lt=Qe.circleArray[st+2],dt=Qe.circleArray[st+3];ue.emplace(ge++,it,Xe,lt,dt,0),ue.emplace(ge++,it,Xe,lt,dt,1),ue.emplace(ge++,it,Xe,lt,dt,2),ue.emplace(ge++,it,Xe,lt,dt,3)}(!bo||bo.length<2*Z)&&(bo=function(Qe){const at=2*Qe,st=new r.a_;st.resize(at),st._trim();for(let it=0;it<at;it++){const Xe=6*it;st.uint16[Xe+0]=4*it+0,st.uint16[Xe+1]=4*it+1,st.uint16[Xe+2]=4*it+2,st.uint16[Xe+3]=4*it+2,st.uint16[Xe+4]=4*it+3,st.uint16[Xe+5]=4*it+0}return st}(Z));const _e=L.createIndexBuffer(bo,!0),Te=L.createVertexBuffer(ue,r.dJ.members,!0);for(const Qe of J){const at={u_matrix:Qe.transform,u_inv_matrix:Qe.invTransform,u_camera_to_center_distance:(Ne=V).getCameraToCenterDistance(Qe.projection),u_viewport_size:[Ne.width,Ne.height]};de.draw(p,M.TRIANGLES,ji.disabled,Pr.disabled,p.colorModeForRenderPass(),wr.disabled,at,u.id,Te,_e,r.bd.simpleSegment(0,2*Qe.circleOffset,Qe.circleArray.length,Qe.circleArray.length/2),null,V.zoom)}var Ne;Te.destroy(),_e.destroy()}const as=r.bz();function Na(p){const n=p._camera.getWorldToCamera(p.worldSize,1),u=r.az([],n,p.globeMatrix);r.bi(u,u);const g=[0,0,0],_=[0,1,0,0];return r.aA(_,_,u),g[0]=_[0],g[1]=_[1],g[2]=_[2],r.au(g,g),g}function ja({width:p,height:n,anchor:u,textOffset:g,textScale:_},w){const{horizontalAlign:S,verticalAlign:L}=r.bT(u),M=-(S-.5)*p,V=-(L-.5)*n,Y=r.bU(u,g);return new r.P((M/_+Y[0])*w,(V/_+Y[1])*w)}function Ca(p,n,u,g,_,w,S,L,M,V){const Y=p.text.placedSymbolArray,J=p.text.dynamicLayoutVertexArray,Z=p.icon.dynamicLayoutVertexArray,te={},de=p.getProjection(),ue=Ah(S,de,_),ge=_.elevation,_e=de.upVectorScale(S.canonical,_.center.lat,_.worldSize).metersToTile;J.clear();for(let Te=0;Te<Y.length;Te++){const Ne=Y.get(Te),{tileAnchorX:Qe,tileAnchorY:at,numGlyphs:st}=Ne,it=Ne.hidden||!Ne.crossTileID||p.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(it){let Xe=0,lt=0,dt=0;if(ge){const oi=ge?ge.getAtTileOffset(S,Qe,at):0,[zt,mi,Li]=de.upVector(S.canonical,Qe,at);Xe=oi*zt*_e,lt=oi*mi*_e,dt=oi*Li*_e}let[kt,Dt,ti,ri]=_l(Ne.projectedAnchorX+Xe,Ne.projectedAnchorY+lt,Ne.projectedAnchorZ+dt,u?ue:w);const vi=Uo(_.getCameraToCenterDistance(de),ri);let Mt=r.bJ(p.textSizeData,M,Ne)*vi/r.bO;u&&(Mt*=p.tilePixelRatio/L);const Vt=ja(it,Mt);u?({x:kt,y:Dt,z:ti}=de.projectTilePoint(Qe+Vt.x,at+Vt.y,S.canonical),[kt,Dt,ti]=_l(kt+Xe,Dt+lt,ti+dt,w)):(n&&Vt._rotate(-_.angle),kt+=Vt.x,Dt+=Vt.y,ti=0);const wt=p.allowVerticalPlacement&&Ne.placedOrientation===r.bI.vertical?Math.PI/2:0;for(let oi=0;oi<st;oi++)r.bL(J,kt,Dt,ti,wt);V&&Ne.associatedIconIndex>=0&&(te[Ne.associatedIconIndex]={x:kt,y:Dt,z:ti,angle:wt})}else xl(st,J)}if(V){Z.clear();const Te=p.icon.placedSymbolArray;for(let Ne=0;Ne<Te.length;Ne++){const Qe=Te.get(Ne),{numGlyphs:at}=Qe,st=te[Ne];if(Qe.hidden||!st)xl(at,Z);else{const{x:it,y:Xe,z:lt,angle:dt}=st;for(let kt=0;kt<at;kt++)r.bL(Z,it,Xe,lt,dt)}}p.icon.dynamicLayoutVertexBuffer.updateData(Z)}p.text.dynamicLayoutVertexBuffer.updateData(J)}function co(p,n,u,g,_,w,S={}){const L=u.paint.get("icon-translate"),M=u.paint.get("text-translate"),V=u.paint.get("icon-translate-anchor"),Y=u.paint.get("text-translate-anchor"),J=u.layout.get("icon-rotation-alignment"),Z=u.layout.get("text-rotation-alignment"),te=u.layout.get("icon-pitch-alignment"),de=u.layout.get("text-pitch-alignment"),ue=u.layout.get("icon-keep-upright"),ge=u.layout.get("text-keep-upright"),_e=u.paint.get("icon-color-saturation"),Te=u.paint.get("icon-color-contrast"),Ne=u.paint.get("icon-color-brightness-min"),Qe=u.paint.get("icon-color-brightness-max"),at=u.layout.get("symbol-elevation-reference")==="sea",st=p.context,it=st.gl,Xe=p.transform,lt=J==="map",dt=Z==="map",kt=te==="map",Dt=de==="map",ti=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ri=!1;const vi=p.depthModeForSublayer(0,ji.ReadOnly),Mt=new ji(p.context.gl.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),Vt=[r.aD(Xe.center.lng),r.aH(Xe.center.lat)],wt=u.layout.get("text-variable-anchor"),oi=Xe.projection.name==="globe",zt=[],mi=[0,-1,0];for(const Li of g){const ai=n.getTile(Li),Mi=ai.getBucket(u);if(!Mi||Mi.projection.name==="mercator"&&oi||Mi.fullyClipped)continue;const ir=Mi.projection.name==="globe",tr=ir?r.ah(Xe.zoom):0,Ki=Ah(Li,Mi.getProjection(),Xe),pr=Xe.calculatePixelsToTileUnitsMatrix(ai),gr=wt&&Mi.hasTextData(),Cr=Mi.hasIconTextFit()&&gr&&Mi.hasIconData(),Hr=Mi.getProjection().createInversionMatrix(Xe,Li.canonical),sn=(1<<ai.tileID.canonical.z)*r.aj/p.transform.worldSize,Yn=Es=>{let Hn=[0,0,0];if(Es){const to=p.style.directionalLight,Fn=p.style.ambientLight;to&&Fn&&(Hn=sa(p.style,to,Fn))}return Hn},xs=Es=>{Xe.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||p.terrain)&&(Es.push("DEPTH_D24"),Es.push("DEPTH_OCCLUSION"))},es=()=>{const Es=lt&&u.layout.get("symbol-placement")!=="point",Hn=[];xs(Hn);const to=Es||Cr,Fn=Mi.elevationType==="road"&&kt,Io=p.shadowRenderer,ks=Fn&&!!Io&&Io.enabled,N=Yn(ks),O=Fn?Mt:vi,X=u.paint.get("icon-image-cross-fade");p.terrainRenderModeElevated()&&kt&&Hn.push("PITCH_WITH_MAP_TERRAIN"),ir&&(Hn.push("PROJECTION_GLOBE_VIEW"),to&&Hn.push("PROJECTED_POS_ON_VIEWPORT")),X>0&&Hn.push("ICON_TRANSITION"),Mi.icon.zOffsetVertexBuffer&&Hn.push("Z_OFFSET"),_e===0&&Te===0&&Ne===0&&Qe===1||Hn.push("COLOR_ADJUSTMENT"),Mi.sdfIcons&&Hn.push("RENDER_SDF"),ks&&Hn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Fn&&Mi.icon.orientationVertexBuffer&&Hn.push("ELEVATED_ROADS");const W=Mi.icon.programConfigurations.get(u.id),le=p.getOrCreateProgram("symbol",{config:W,defines:Hn}),we=ai.imageAtlasTexture?ai.imageAtlasTexture.size:[0,0],Re=Mi.iconSizeData,ft=r.bH(Re,Xe.zoom),At=kt||!Xe.isOrthographic,Ht=qa(Ki,ai.tileID.canonical,kt,lt,Xe,Mi.getProjection(),pr),si=pu(Ki,ai.tileID.canonical,kt,lt,Xe,Mi.getProjection(),pr),gi=p.translatePosMatrix(si,ai,L,V,!0),Ui=p.translatePosMatrix(Ki,ai,L,V),Gr=to?as:Ht,vr=lt&&!kt&&!Es;let Rr=mi;!oi&&!Xe.mercatorFromTransition||lt||(Rr=Na(Xe));const Kn=ir?Rr:mi,An=u.getColorAdjustmentMatrix(_e,Te,Ne,Qe),rn=Ir(Re.kind,ft,vr,kt,p,Ui,Gr,gi,at,!1,we,[0,0],0,Li,tr,Vt,Hr,Kn,Mi.getProjection(),N,sn,An,X,null),Xs=ai.imageAtlasTexture?ai.imageAtlasTexture:null,ts=u.layout.get("icon-size").constantOr(0)!==1||Mi.iconsNeedLinear,Dn=Mi.sdfIcons||p.options.rotating||p.options.zooming||ts||At?it.LINEAR:it.NEAREST,Kr=Mi.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,rs=p.terrain&&kt&&Es?r.bi(r.bz(),Ht):as;if(Es&&Mi.icon){const bs=Xe.elevation,Ln=bs?bs.getAtTileOffsetFunc(Li,Xe.center.lat,Xe.worldSize,Mi.getProjection()):null,Fo=fu(Ki,ai.tileID.canonical,kt,lt,Xe,Mi.getProjection(),pr);Jl(Mi,Ki,p,!1,Fo,si,kt,ue,Ln,Li)}return{program:le,buffers:Mi.icon,uniformValues:rn,atlasTexture:Xs,atlasTextureIcon:null,atlasInterpolation:Dn,atlasInterpolationIcon:null,isSDF:Mi.sdfIcons,hasHalo:Kr,depthMode:O,tile:ai,renderWithShadows:ks,labelPlaneMatrixInv:rs}},is=()=>{const Es=dt&&u.layout.get("symbol-placement")!=="point",Hn=[],to=Es||wt||Cr,Fn=Mi.elevationType==="road"&&Dt,Io=p.shadowRenderer,ks=Fn&&!!Io&&Io.enabled,N=Yn(ks),O=Fn?Mt:vi;p.terrainRenderModeElevated()&&Dt&&Hn.push("PITCH_WITH_MAP_TERRAIN"),ir&&(Hn.push("PROJECTION_GLOBE_VIEW"),to&&Hn.push("PROJECTED_POS_ON_VIEWPORT")),Mi.text.zOffsetVertexBuffer&&Hn.push("Z_OFFSET"),Mi.iconsInText&&Hn.push("RENDER_TEXT_AND_SYMBOL"),Hn.push("RENDER_SDF"),ks&&Hn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Fn&&Mi.text.orientationVertexBuffer&&Hn.push("ELEVATED_ROADS"),xs(Hn);const X=Mi.text.programConfigurations.get(u.id),W=p.getOrCreateProgram("symbol",{config:X,defines:Hn});let le,we=[0,0],Re=null;const ft=Mi.textSizeData;Mi.iconsInText&&(we=ai.imageAtlasTexture?ai.imageAtlasTexture.size:[0,0],Re=ai.imageAtlasTexture?ai.imageAtlasTexture:null,le=Dt||!Xe.isOrthographic||p.options.rotating||p.options.zooming||ft.kind==="composite"||ft.kind==="camera"?it.LINEAR:it.NEAREST);const At=ai.glyphAtlasTexture?ai.glyphAtlasTexture.size:[0,0],Ht=u.layout.get("text-size-scale-range"),si=r.ay(p.scaleFactor,Ht[0],Ht[1]),gi=r.bH(ft,Xe.zoom,si),Ui=qa(Ki,ai.tileID.canonical,Dt,dt,Xe,Mi.getProjection(),pr),Gr=pu(Ki,ai.tileID.canonical,Dt,dt,Xe,Mi.getProjection(),pr),vr=p.translatePosMatrix(Gr,ai,M,Y,!0),Rr=p.translatePosMatrix(Ki,ai,M,Y),Kn=to?as:Ui,An=dt&&!Dt&&!Es;let rn=mi;!oi&&!Xe.mercatorFromTransition||dt||(rn=Na(Xe));const Xs=Ir(ft.kind,gi,An,Dt,p,Rr,Kn,vr,at,!0,At,we,0,Li,tr,Vt,Hr,ir?rn:mi,Mi.getProjection(),N,sn,null,null,si),ts=ai.glyphAtlasTexture?ai.glyphAtlasTexture:null,Dn=it.LINEAR,Kr=u.paint.get("text-halo-width").constantOr(1)!==0,rs=p.terrain&&Dt&&Es?r.bi(r.bz(),Ui):as;if(Es&&Mi.text){const bs=Xe.elevation,Ln=bs?bs.getAtTileOffsetFunc(Li,Xe.center.lat,Xe.worldSize,Mi.getProjection()):null,Fo=fu(Ki,ai.tileID.canonical,Dt,dt,Xe,Mi.getProjection(),pr);Jl(Mi,Ki,p,!0,Fo,Gr,Dt,ge,Ln,Li)}return{program:W,buffers:Mi.text,uniformValues:Xs,atlasTexture:ts,atlasTextureIcon:Re,atlasInterpolation:Dn,atlasInterpolationIcon:le,isSDF:!0,hasHalo:Kr,depthMode:O,tile:ai,renderWithShadows:ks,labelPlaneMatrixInv:rs}},uo=Mi.icon.segments.get().length,Jr=Mi.text.segments.get().length,ln=uo&&!S.onlyText?es():null,yn=Jr&&!S.onlyIcons?is():null,Ps=u.paint.get("icon-opacity").constantOr(1),Qo=u.paint.get("text-opacity").constantOr(1);if(ti&&Mi.canOverlap){ri=!0;const Es=Ps&&!S.onlyText?Mi.icon.segments.get():[],Hn=Qo&&!S.onlyIcons?Mi.text.segments.get():[];for(const to of Es)zt.push({segments:new r.bd([to]),sortKey:to.sortKey,state:ln});for(const to of Hn)zt.push({segments:new r.bd([to]),sortKey:to.sortKey,state:yn})}else S.onlyText||zt.push({segments:Ps?Mi.icon.segments:new r.bd([]),sortKey:0,state:ln}),S.onlyIcons||zt.push({segments:Qo?Mi.text.segments:new r.bd([]),sortKey:0,state:yn})}ri&&zt.sort((Li,ai)=>Li.sortKey-ai.sortKey);for(const Li of zt){const ai=Li.state;if(ai)if(p.terrain?p.terrain.setupElevationDraw(ai.tile,ai.program,{useDepthForOcclusion:Xe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ai.labelPlaneMatrixInv}):p.setupDepthForOcclusion(Xe.depthOcclusionForSymbolsAndCircles,ai.program),st.activeTexture.set(it.TEXTURE0),ai.atlasTexture&&ai.atlasTexture.bind(ai.atlasInterpolation,it.CLAMP_TO_EDGE,!0),ai.atlasTextureIcon&&(st.activeTexture.set(it.TEXTURE1),ai.atlasTextureIcon&&ai.atlasTextureIcon.bind(ai.atlasInterpolationIcon,it.CLAMP_TO_EDGE,!0)),ai.renderWithShadows&&p.shadowRenderer.setupShadows(ai.tile.tileID.toUnwrapped(),ai.program,"vector-tile",ai.tile.tileID.overscaledZ),p.uploadCommonLightUniforms(p.context,ai.program),ai.hasHalo){const Mi=ai.uniformValues;Mi.u_is_halo=1,$o(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,_,w,Mi,2),Mi.u_is_halo=0}else{if(ai.isSDF){const Mi=ai.uniformValues;ai.hasHalo&&(Mi.u_is_halo=1,$o(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,_,w,Mi,1)),Mi.u_is_halo=0}$o(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,_,w,ai.uniformValues,1)}}}function $o(p,n,u,g,_,w,S,L,M,V){const Y=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer,p.orientationVertexBuffer];_.draw(g,g.context.gl.TRIANGLES,w,S,L,wr.disabled,M,u.id,p.layoutVertexBuffer,p.indexBuffer,n,u.paint,g.transform.zoom,p.programConfigurations.get(u.id),Y,V)}function Ha(p,n){const u=1<<p.canonical.z,g=(n.x*u-p.canonical.x-p.wrap*u)*r.aj,_=(n.y*u-p.canonical.y)*r.aj,w=r.dS(n.z,n.y);return r.cS(g,_,w)}function sc(p,n,u,g,_){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const w=p.context.gl,S=new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),L=new ji(p.context.gl.GREATER,ji.ReadWrite,p.depthRangeFor3D),M=function(te){const de=r.cJ(te.pitch);let ue=.01;return te.isOrthographic&&(ue=r.ai(1e-4,ue,r.cN(de>=So?1:de/So))),2*ue}(p.transform),V=p.transform.getFreeCameraOptions().position,Y="elevatedStructuresDepthReconstruct",J=p.getOrCreateProgram(Y,{defines:["DEPTH_RECONSTRUCTION"]}),Z=p.getOrCreateProgram(Y);for(const te of g){const de=n.getTile(te),ue=de.getBucket(u);if(!ue)continue;const ge=ue.elevatedStructures;if(!ge)continue;const _e=ue.elevationBufferData.heightRange,Te=Ha(te.toUnwrapped(),V),Ne=p.translatePosMatrix(te.projMatrix,de,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Qe,at,st,it;if(_==="initialize"){if(!_e||_e.min>=1||ge.depthSegments.segments[0].primitiveLength===0)continue;Qe=ct(Ne,Te,M,1,0),at=S,st=ge.depthSegments,it=J}else if(_==="reset"){if(!_e||_e.min>=0||ge.maskSegments.segments[0].primitiveLength===0)continue;Qe=ct(Ne,Te,0,0,1),at=L,st=ge.maskSegments,it=J}else if(_==="geometry"){if(ge.depthSegments.segments[0].primitiveLength===0)continue;Qe=ct(Ne,Te,M,1,0),at=S,st=ge.depthSegments,it=Z}it.draw(p,w.TRIANGLES,at,Pr.disabled,Wr.disabled,wr.disabled,Qe,u.id,ge.vertexBuffer,ge.indexBuffer,st,u.paint,p.transform.zoom)}}function aa(p,n,u){const{painter:g,sourceCache:_,layer:w,coords:S,colorMode:L,elevationType:M,terrainEnabled:V,pass:Y}=p,J=g.context.gl,Z=w.paint.get("fill-pattern"),te=w.paint.get("fill-pattern-cross-fade"),de=Z.constantOr(null);let ue=M;M!=="road"||n&&!V||(ue="none");const ge=ue==="road",_e=p.painter.shadowRenderer,Te=ge&&!!_e&&_e.enabled,Ne=new ji(g.context.gl.LEQUAL,ji.ReadOnly,g.depthRangeFor3D);let Qe=[0,0,0];if(Te){const it=g.style.directionalLight,Xe=g.style.ambientLight;it&&Xe&&(Qe=sa(g.style,it,Xe))}const at=Z&&Z.constantOr(1),st=(it,Xe)=>{let lt,dt,kt,Dt,ti;Xe?(lt=at&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",kt=J.LINES):(lt=at?"fillPattern":"fill",kt=J.TRIANGLES);for(const ri of S){const vi=_.getTile(ri);if(at&&!vi.patternsLoaded())continue;const Mt=vi.getBucket(w);if(!Mt)continue;const Vt=n?Mt.elevationBufferData:Mt.bufferData;if(Vt.isEmpty())continue;g.prepareDrawTile();const wt=Vt.programConfigurations.get(w.id),oi=g.isTileAffectedByFog(ri),zt=[],mi=[];ge&&(zt.push("ELEVATED_ROADS"),mi.push(Vt.elevatedLayoutVertexBuffer)),Te&&zt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),at&&(g.context.activeTexture.set(J.TEXTURE0),vi.imageAtlasTexture&&vi.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),wt.updatePaintBuffers());let Li=!1;if(de&&vi.imageAtlas){const Ki=vi.imageAtlas,pr=r.dN.from(de),gr=pr.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),Cr=pr.getSecondary(),Hr=Ki.patternPositions.get(gr),sn=Cr?Ki.patternPositions.get(Cr.scaleSelf(r.q.devicePixelRatio).toString()):null;Li=!!Hr&&!!sn,Hr&&wt.setConstantPatternPositions(Hr,sn)}te>0&&(Li||wt.getPatternTransitionVertexBuffer("fill-pattern"))&&zt.push("FILL_PATTERN_TRANSITION");const ai=g.getOrCreateProgram(lt,{config:wt,overrideFog:oi,defines:zt}),Mi=g.translatePosMatrix(ri.projMatrix,vi,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));Te&&_e.setupShadows(vi.tileID.toUnwrapped(),ai,"vector-tile",vi.tileID.overscaledZ);const ir=w.paint.get("fill-emissive-strength");if(Xe){Dt=Vt.lineIndexBuffer,ti=Vt.lineSegments;const Ki=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[J.drawingBufferWidth,J.drawingBufferHeight];dt=lt==="fillOutlinePattern"&&at?$e(Mi,ir,g,vi,Ki,Qe,te):We(Mi,ir,Ki,Qe)}else Dt=Vt.indexBuffer,ti=Vt.triangleSegments,dt=at?Oe(Mi,ir,g,vi,Qe,te):xe(Mi,ir,Qe);g.uploadCommonUniforms(g.context,ai,ri.toUnwrapped());let tr=it;(M==="road"&&!V||M==="offset")&&(tr=Ne),ai.draw(g,kt,tr,u||g.stencilModeForClipping(ri),L,wr.disabled,dt,w.id,Vt.layoutVertexBuffer,Dt,ti,w.paint,g.transform.zoom,wt,mi)}};g.renderPass===Y&&st(g.depthModeForSublayer(1,g.renderPass==="opaque"?ji.ReadWrite:ji.ReadOnly),!1),ue==="none"&&g.renderPass==="translucent"&&w.paint.get("fill-antialias")&&st(g.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,ji.ReadOnly),!0)}function Qa(p,n,u,g,_,w,S,L){u.resetLayerRenderingStats(p);const M=p.context,V=M.gl,Y=p.transform,J=u.paint.get("fill-extrusion-pattern"),Z=u.paint.get("fill-extrusion-pattern-cross-fade"),te=J.constantOr(null),de=J.constantOr(1),ue=u.paint.get("fill-extrusion-opacity"),ge=p.style.enable3dLights(),_e=u.paint.get(ge&&!de?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],Ne=u.layout.get("fill-extrusion-edge-radius"),Qe=Ne>0&&!u.paint.get("fill-extrusion-rounded-roof"),at=Qe?0:Ne,st=Y.projection.name==="globe"?r.dV():0,it=Y.projection.name==="globe",Xe=it?r.ah(Y.zoom):0,lt=[r.aD(Y.center.lng),r.aH(Y.center.lat)],dt=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",kt=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(dt?null:u.lut).toArray01().slice(0,3),Dt=u.paint.get("fill-extrusion-flood-light-intensity"),ti=u.paint.get("fill-extrusion-vertical-scale"),ri=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,vi=u.paint.get("fill-extrusion-height-alignment"),Mt=u.paint.get("fill-extrusion-base-alignment"),Vt=al(p,u.paint.get("fill-extrusion-cutoff-fade-range")),wt=[];let oi;it&&wt.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&wt.push("FAUX_AO"),Qe&&wt.push("ZERO_ROOF_RADIUS"),L&&wt.push("HAS_CENTROID"),Dt>0&&wt.push("FLOOD_LIGHT"),Vt.shouldRenderCutoff&&wt.push("RENDER_CUTOFF"),ri&&wt.push("RENDER_WALL_MODE");const zt=p.renderPass==="shadow",mi=p.shadowRenderer,Li=zt&&!!mi,ai=zt?wr.disabled:wr.backCCW;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Mi=[0,0,0];if(mi){const Ki=p.style.directionalLight,pr=p.style.ambientLight;Ki&&pr&&(Mi=sa(p.style,Ki,pr)),zt||(wt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),mi.useNormalOffset&&wt.push("NORMAL_OFFSET")),oi=wt.concat(["SHADOWS_SINGLE_CASCADE"])}const ir=Li?"fillExtrusionDepth":de?"fillExtrusionPattern":"fillExtrusion",tr=u.getLayerRenderingStats();for(const Ki of g){const pr=n.getTile(Ki),gr=pr.getBucket(u);if(!gr||gr.projection.name!==Y.projection.name)continue;let Cr=!1;mi&&(Cr=mi.getMaxCascadeForTile(Ki.toUnwrapped())===0);const Hr=p.isTileAffectedByFog(Ki),sn=gr.programConfigurations.get(u.id);let Yn=!1;if(te&&pr.imageAtlas){const yn=pr.imageAtlas,Ps=r.dN.from(te),Qo=Ps.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),Es=Ps.getSecondary(),Hn=yn.patternPositions.get(Qo),to=Es?yn.patternPositions.get(Es.scaleSelf(r.q.devicePixelRatio).toString()):null;Yn=!!Hn&&!!to,Hn&&sn.setConstantPatternPositions(Hn,to)}Z>0&&(Yn||sn.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&wt.push("FILL_EXTRUSION_PATTERN_TRANSITION");const xs=p.getOrCreateProgram(ir,{config:sn,defines:Cr?oi:wt,overrideFog:Hr});if(p.terrain&&p.terrain.setupElevationDraw(pr,xs,{useMeterToDem:!0}),!gr.centroidVertexBuffer){const yn=xs.attributes.a_centroid_pos;yn!==void 0&&V.vertexAttrib2f(yn,0,0)}!zt&&mi&&mi.setupShadows(pr.tileID.toUnwrapped(),xs,"vector-tile",pr.tileID.overscaledZ),de&&(p.context.activeTexture.set(V.TEXTURE0),pr.imageAtlasTexture&&pr.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),sn.updatePaintBuffers());const es=u.paint.get("fill-extrusion-vertical-gradient"),is=1/gr.tileToMeter;let uo;if(zt&&mi){if(Cu(pr.tileID,gr,p))continue;const yn=mi.calculateShadowPassMatrixFromTile(pr.tileID.toUnwrapped());uo=K(yn,at,is,ti,vi,Mt)}else{const yn=p.translatePosMatrix(Ki.expandedProjMatrix,pr,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Ps=Y.projection.createInversionMatrix(Y,Ki.canonical);uo=de?se(yn,p,es,ue,Te,at,is,Ki,pr,st,vi,Mt,Xe,lt,Ps,kt,ti,Z):D(yn,p,es,ue,Te,at,is,Ki,st,vi,Mt,Xe,lt,Ps,kt,ti,Dt,Mi)}p.uploadCommonUniforms(M,xs,Ki.toUnwrapped(),null,Vt);let Jr=gr.segments;if(Y.projection.name==="mercator"&&!zt&&(Jr=gr.getVisibleSegments(pr.tileID,p.terrain,p.transform.getFrustum(0)),!Jr.get().length))continue;if(tr)if(zt)for(const yn of Jr.get())tr.numRenderedVerticesInShadowPass+=yn.primitiveLength;else for(const yn of Jr.get())tr.numRenderedVerticesInTransparentPass+=yn.primitiveLength;const ln=[];(p.terrain||L)&&ln.push(gr.centroidVertexBuffer),it&&ln.push(gr.layoutVertexExtBuffer),ri&&ln.push(gr.wallVertexBuffer),xs.draw(p,M.gl.TRIANGLES,_,w,S,ai,uo,u.id,gr.layoutVertexBuffer,gr.indexBuffer,Jr,u.paint,p.transform.zoom,sn,ln)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}function Va(p,n,u,g,_,w,S,L,M,V,Y,J,Z,te,de,ue,ge,_e,Te){const Ne=p.context,Qe=Ne.gl,at=p.transform,st=p.transform.zoom,it=[],Xe=al(p,u.paint.get("fill-extrusion-cutoff-fade-range"));V==="clear"?(it.push("CLEAR_SUBPASS"),Te&&(it.push("CLEAR_FROM_TEXTURE"),Ne.activeTexture.set(Qe.TEXTURE0),Te.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE))):V==="sdf"&&it.push("SDF_SUBPASS"),ge&&it.push("HAS_CENTROID"),Xe.shouldRenderCutoff&&it.push("RENDER_CUTOFF");const lt=u.layout.get("fill-extrusion-edge-radius"),dt=(kt,Dt,ti,ri,vi)=>{const Mt=Dt.programConfigurations.get(u.id),Vt=p.isTileAffectedByFog(kt),wt=p.getOrCreateProgram("fillExtrusionGroundEffect",{config:Mt,defines:it,overrideFog:Vt}),oi=((mi,Li,ai,Mi,ir,tr,Ki,pr,gr,Cr,Hr)=>({u_matrix:Li,u_opacity:ai,u_ao_pass:Mi?1:0,u_meter_to_tile:ir,u_ao:tr,u_flood_light_intensity:Ki,u_flood_light_color:pr,u_attenuation:gr,u_edge_radius:Cr,u_fb:0,u_fb_size:Hr,u_dynamic_offset:1}))(0,ri,Y,M,vi,[J,Z*vi],te,de,ue,st>=17?0:lt*vi,Te?Te.size[0]:0),zt=[];ge&&zt.push(Dt.hiddenByLandmarkVertexBuffer),p.uploadCommonUniforms(Ne,wt,kt.toUnwrapped(),null,Xe),wt.draw(p,Ne.gl.TRIANGLES,_,w,S,L,oi,u.id,Dt.vertexBuffer,Dt.indexBuffer,ti,u.paint,st,Mt,zt)};for(const kt of g){const Dt=n.getTile(kt),ti=Dt.getBucket(u);if(!ti||ti.projection.name!==at.projection.name||!ti.groundEffect||ti.groundEffect&&!ti.groundEffect.hasData())continue;const ri=ti.groundEffect,vi=1/ti.tileToMeter;{const Mt=p.translatePosMatrix(kt.projMatrix,Dt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Vt=ri.getDefaultSegment();dt(kt,ri,Vt,Mt,vi)}if(_e)for(let Mt=0;Mt<4;Mt++){const Vt=r.dT[Mt](kt),wt=n.getTile(Vt);if(!wt)continue;const oi=wt.getBucket(u);if(!oi||oi.projection.name!==at.projection.name||!oi.groundEffect||oi.groundEffect&&!oi.groundEffect.hasData())continue;const zt=oi.groundEffect;let mi,Li;Mt===0?(mi=[-8192,0,0],Li=1):Mt===1?(mi=[r.aj,0,0],Li=0):Mt===2?(mi=[0,-8192,0],Li=3):(mi=[0,r.aj,0],Li=2);const ai=zt.regionSegments[Li];if(!ai)continue;const Mi=new Float32Array(16);r.bo(Mi,kt.projMatrix,mi),dt(kt,zt,ai,p.translatePosMatrix(Mi,Dt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),vi)}}}function Zi(p,n,u,g,_,w,S){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const L=w?w.findDEMTileFor(u):null;if(!(L&&L.dem||S))return;w&&L&&L.dem&&g.selfDEMTileTimestamp!==L.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=L.dem._timestamp);const M=_e=>new r.P(Math.ceil((_e+r.dX)*r.dY),0),V=_e=>{const Te=n.getSource().minzoom,Ne=at=>{const st=n.getTileByID(at);if(st&&st.hasData())return st.getBucket(_)},Qe=[0,-1,1];for(const at of Qe){if(_e.overscaledZ+at<Te)continue;const st=Ne(_e.calculateScaledKey(_e.overscaledZ+at));if(st)return st}},Y=[0,0,0],J=(_e,Te)=>(Y[0]=Math.min(_e.min.y,Te.min.y),Y[1]=Math.max(_e.max.y,Te.max.y),Y[2]=r.aj-Te.min.x>_e.max.x?Te.min.x-r.aj:_e.max.x,Y),Z=(_e,Te)=>(Y[0]=Math.min(_e.min.x,Te.min.x),Y[1]=Math.max(_e.max.x,Te.max.x),Y[2]=r.aj-Te.min.y>_e.max.y?Te.min.y-r.aj:_e.max.y,Y),te=[(_e,Te)=>J(_e,Te),(_e,Te)=>J(Te,_e),(_e,Te)=>Z(_e,Te),(_e,Te)=>Z(Te,_e)],de=(_e,Te,Ne,Qe,at,st,it)=>{if(!w)return 0;const Xe=[[st?Ne:_e,st?_e:Ne,0],[st?Ne:Te,st?Te:Ne,0]],lt=it<0?r.aj+it:it,dt=[st?lt:(_e+Te)/2,st?(_e+Te)/2:lt,0];return Ne===0&&it<0||Ne!==0&&it>0?w.getForTilePoints(at,[dt],!0,Qe):Xe.push(dt),w.getForTilePoints(u,Xe,!0,L),Math.max(Xe[0][2],Xe[1][2],dt[2])/w.exaggeration()};for(let _e=0;_e<4;_e++){const Te=g.borderFeatureIndices[_e];if(Te.length===0)continue;const Ne=r.dT[_e](u),Qe=V(Ne);if(!(Qe&&Qe instanceof r.dU))continue;const at=w?w.findDEMTileFor(Ne):null;if(!(at&&at.dem||S)||(w&&at&&at.dem&&g.borderDEMTileTimestamp[_e]!==at.dem._timestamp&&(g.borderDoneWithNeighborZ[_e]=-1,g.borderDEMTileTimestamp[_e]=at.dem._timestamp),g.borderDoneWithNeighborZ[_e]===Qe.canonical.z))continue;Qe.centroidVertexArray.length===0&&Qe.createCentroidsBuffer();const st=(_e<2?1:5)-_e,it=Qe.borderDoneWithNeighborZ[st]!==g.canonical.z,Xe=Qe.borderFeatureIndices[st];let lt=0;if(g.canonical.z!==Qe.canonical.z){for(const dt of Te)g.showCentroid(g.featuresOnBorder[dt]);if(it)for(const dt of Xe)Qe.showCentroid(Qe.featuresOnBorder[dt]);g.borderDoneWithNeighborZ[_e]=Qe.canonical.z,Qe.borderDoneWithNeighborZ[st]=g.canonical.z}for(const dt of Te){const kt=g.featuresOnBorder[dt],Dt=g.centroidData[kt.centroidDataIndex],ti=kt.borders[_e];let ri;for(;lt<Xe.length;){ri=Qe.featuresOnBorder[Xe[lt]];const vi=ri.borders[st];if(vi[1]>ti[0]+3||vi[0]>ti[0]-3)break;Qe.showCentroid(ri),lt++}if(ri&&lt<Xe.length){const vi=lt;let Mt=0;for(;!(ri.borders[st][0]>ti[1]-3)&&(Mt++,++lt!==Xe.length);)ri=Qe.featuresOnBorder[Xe[lt]];ri=Qe.featuresOnBorder[Xe[vi]];let Vt=!1;if(Mt>=1){const zt=ri.borders[st];Math.abs(ti[0]-zt[0])<3&&Math.abs(ti[1]-zt[1])<3&&(Mt=1,Vt=!0,lt=vi+1)}else if(Mt===0){g.showCentroid(kt);continue}const wt=Qe.centroidData[ri.centroidDataIndex];S&&Vt&&(((ue=Dt).flags|(ge=wt).flags)&r.dW?(ue.flags|=r.dW,ge.flags|=r.dW):(ue.flags&=2147483647,ge.flags&=2147483647));const oi=kt.intersectsCount()>1||ri.intersectsCount()>1;if(Mt>1)lt=vi,Dt.centroidXY=wt.centroidXY=new r.P(0,0);else if(at&&at.dem&&!oi){const zt=te[_e](Dt,wt),mi=_e%2?r.aj-1:0,Li=de(zt[0],Math.min(r.aj-1,zt[1]),mi,at,Ne,_e<2,zt[2]);Dt.centroidXY=wt.centroidXY=M(Li)}else oi?Dt.centroidXY=wt.centroidXY=new r.P(0,0):(Dt.centroidXY=g.encodeBorderCentroid(kt),wt.centroidXY=Qe.encodeBorderCentroid(ri));g.writeCentroidToBuffer(Dt),Qe.writeCentroidToBuffer(wt)}else g.showCentroid(kt)}g.borderDoneWithNeighborZ[_e]=Qe.canonical.z,Qe.borderDoneWithNeighborZ[st]=g.canonical.z}var ue,ge;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(p)}const Bu=[1,0,0],Ho=[0,1,0],Kc=[0,0,1];function Cu(p,n,u){const g=u.transform,_=u.shadowRenderer;if(!_)return!0;const w=p.toUnwrapped(),S=g.tileSize*_._cascades[u.currentShadowCascade].scale;let L=n.maxHeight;if(g.elevation){const ue=g.elevation.getMinMaxForTile(p);ue&&(L+=ue.max)}const M=[..._.shadowDirection];M[2]=-M[2];const V=_.computeSimplifiedTileShadowVolume(w,L,S,M);if(!V)return!1;const Y=[Bu,Ho,Kc,M,[M[0],0,M[2]],[0,M[1],M[2]]],J=g.projection.name==="globe",Z=g.scaleZoom(S),te=r.cn.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,Z,!J),de=_.getCurrentCascadeFrustum();return te.intersectsPrecise(V.vertices,V.planes,Y)===0||de.intersectsPrecise(V.vertices,V.planes,Y)===0}function Br(p){return[p[0]*r.dZ,p[1]*r.dZ,p[2]*r.dZ,0]}function Qu(p,n,u,g,_,w,S,L,M){const V=g.getSource(),Y=u.globeSharedBuffers;if(!Y)return;let J,Z,te;if(n&&(J=g.getTile(n)),V instanceof r.aP?(Z=V.texture,te=r.ds(0,0,u.transform)):J&&n&&(Z=J.texture,te=r.ds(n.canonical.z,n.canonical.x,u.transform)),!Z||!te)return;p||(te=r.cE(r.bz(),te,[1,-1,1]));const de=u.context,ue=de.gl,ge=_.paint.get("raster-resampling")==="nearest"?ue.NEAREST:ue.LINEAR,_e=u.colorModeForDrapableLayerRenderPass(w),Te=S.defines;Te.push("GLOBE_POLES");const Ne=new ji(ue.LEQUAL,ji.ReadWrite,u.depthRangeFor3D),Qe=Float32Array.from(u.transform.expandedFarZProjMatrix),at=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),de.activeTexture.set(ue.TEXTURE0),Z.bind(ge,ue.CLAMP_TO_EDGE),de.activeTexture.set(ue.TEXTURE1),Z.bind(ge,ue.CLAMP_TO_EDGE),"useMipmap"in Z&&de.extTextureFilterAnisotropic&&u.transform.pitch>20&&ue.texParameterf(ue.TEXTURE_2D,de.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,de.extTextureFilterAnisotropicMax);const[st,it,Xe,lt]=n?Y.getPoleBuffers(n.canonical.z,!1):Y.getPoleBuffers(0,!0),dt=_.paint.get("raster-elevation");let kt;p?(kt=st,u.renderDefaultNorthPole=dt!==0):(kt=it,u.renderDefaultSouthPole=dt!==0);const Dt=Br(S.mix),ti=((vi,Mt,Vt,wt,oi,zt,mi,Li,ai,Mi,ir,tr,Ki)=>Ni(vi,Mt,Vt,new Float32Array(16),new Float32Array(9),[0,0],wt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},zt,[0,0],Li,2,Mi,ir,tr,1,0,Ki))(Qe,at,te,r.ah(u.transform.zoom),0,_,0,dt,0,Dt,S.offset,S.range,w),ri=u.getOrCreateProgram("raster",{defines:Te});u.uploadCommonUniforms(de,ri,null),ri.draw(u,ue.TRIANGLES,Ne,M,_e,L,ti,_.id,kt,Xe,lt)}function fd(p){const n=p._nearZ,u=p.projection.farthestPixelDistance(p),g=u-n,_=.2*p.height,w=n+_;return[n,u,(w-_-n)/g,(w-n)/g]}function pd(p,n,u,g){if(p)return n instanceof pc&&p instanceof ml?n.getTextureDescriptor(p,u,!0):{texture:p.texture,mix:Br(g.mix),offset:g.offset,buffer:0,tileSize:1}}var Ql=r.d_([{name:"a_index",type:"Int16",components:1}]);class bh{constructor(n,u,g,_){const w={width:g[0],height:g[1],data:null},S=n.gl;this.targetColorTexture=new r.T(n,w,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(n,w,S.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(u,_),this.lastInvalidatedAt=0}updateParticleTexture(n,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,_=u.width*u.height;this.particleTexture0=new r.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const w=new r.d$;w.reserve(_);for(let S=0;S<_;S++)w.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(w,Ql.members,!0),this.particleSegment=r.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Yh(p,n,u){if(!p)return null;const g=n.getTextureDescriptor(p,u,!0);if(!g)return null;let{texture:_,mix:w,offset:S,tileSize:L,buffer:M,format:V}=g;if(!_||!V)return null;let Y=!1;return V==="uint32"&&(Y=!0,w[3]=0,w=ci(r.e0,w,[0,u.paint.get("raster-particle-max-speed")]),S=Hi(r.e0,S,[0,u.paint.get("raster-particle-max-speed")])),{texture:_,textureOffset:[M/(L+2*M),L/(L+2*M)],tileSize:L,scalarData:Y,scale:w,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[V]]}}function fA(p){const n=p._nearZ,u=p.projection.farthestPixelDistance(p),g=u-n,_=.2*p.height,w=n+_;return[n,u,(w-_-n)/g,(w-n)/g]}const pA=new r.am(1,0,0,1),gd=new r.am(0,1,0,1),Ga=new r.am(0,0,1,1),wh=new r.am(1,0,1,1),la=new r.am(0,1,1,1);function Sl(p,n,u,g,_,w){for(let S=0;S<u.length;S++)if(_){const V=new r.am(g.r*.8,g.g*.8,g.b*.8,1);Vu(p,n,u[S],g,-1,-1,w),Vu(p,n,u[S],g,-1,1,w),Vu(p,n,u[S],g,1,1,w),Vu(p,n,u[S],g,1,-1,w),Vu(p,n,u[S],V,0,0,w)}else Vu(p,n,u[S],g,0,0,w)}function Vu(p,n,u,g,_,w,S){const L=p.context,M=p.transform,V=L.gl,Y=M.projection.name==="globe",J=Y?["PROJECTION_GLOBE_VIEW"]:[];let Z=r.bw(u.projMatrix);if(Y&&r.ah(M.zoom)>0){const Dt=r.bg(u.canonical,M),ti=r.e1(Dt);Z=r.az(new Float32Array(16),M.globeMatrix,ti),r.az(Z,M.projMatrix,Z)}const te=r.bz();te[12]+=2*_/(r.q.devicePixelRatio*M.width),te[13]+=2*w/(r.q.devicePixelRatio*M.height),r.az(Z,te,Z);const de=p.getOrCreateProgram("debug",{defines:J}),ue=n.getTileByID(u.key);p.terrain&&p.terrain.setupElevationDraw(ue,de);const ge=ji.disabled,_e=Pr.disabled,Te=p.colorModeForRenderPass(),Ne="$debug";L.activeTexture.set(V.TEXTURE0),p.emptyTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Y?ue._makeGlobeTileDebugBuffers(p.context,M):ue._makeDebugTileBoundsBuffers(p.context,M.projection);const Qe=ue._tileDebugBuffer||p.debugBuffer,at=ue._tileDebugIndexBuffer||p.debugIndexBuffer,st=ue._tileDebugSegments||p.debugSegments;if(de.draw(p,V.LINE_STRIP,ge,_e,Te,wr.disabled,Xt(Z,g.toPremultipliedRenderColor(null)),Ne,Qe,at,st,null,null,null,[ue._globeTileDebugBorderBuffer]),S){const Dt=ue.latestRawTileData,ti=Math.floor((Dt&&Dt.byteLength||0)/1024);let ri=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ri+=` => ${u.overscaledZ}`),ri+=` ${ue.state}`,ri+=` ${ti}kb`,function(vi,Mt){vi.initDebugOverlayCanvas();const Vt=vi.debugOverlayCanvas,wt=vi.context.gl,oi=vi.debugOverlayCanvas.getContext("2d");oi.clearRect(0,0,Vt.width,Vt.height),oi.shadowColor="white",oi.shadowBlur=2,oi.lineWidth=1.5,oi.strokeStyle="white",oi.textBaseline="top",oi.font="bold 36px Open Sans, sans-serif",oi.fillText(Mt,5,5),oi.strokeText(Mt,5,5),vi.debugOverlayTexture.update(Vt),vi.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}(p,ri)}const it=n.getTile(u).tileSize,Xe=512/Math.min(it,512)*(u.overscaledZ/M.zoom)*.5,lt=ue._tileDebugTextBuffer||p.debugBuffer,dt=ue._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,kt=ue._tileDebugTextSegments||p.debugSegments;de.draw(p,V.TRIANGLES,ge,_e,Wr.alphaBlended,wr.disabled,Xt(Z,r.am.transparent.toPremultipliedRenderColor(null),Xe),Ne,lt,dt,kt,null,null,null,[ue._globeTileDebugTextBuffer])}function gA(p,n,u,g){cl(p,0,n+u/2,p.transform.width,u,g)}function Bh(p,n,u,g){cl(p,n-u/2,0,u,p.transform.height,g)}function cl(p,n,u,g,_,w){const S=p.context,L=S.gl;L.enable(L.SCISSOR_TEST),L.scissor(n*r.q.devicePixelRatio,u*r.q.devicePixelRatio,g*r.q.devicePixelRatio,_*r.q.devicePixelRatio),S.clear({color:w}),L.disable(L.SCISSOR_TEST)}const mA=r.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qc}=mA;function Xn(p,n,u,g){p.emplaceBack(n,u,g)}class Ch{constructor(n){this.vertexArray=new r.e2,this.indices=new r.a_,Xn(this.vertexArray,-1,-1,1),Xn(this.vertexArray,1,-1,1),Xn(this.vertexArray,-1,1,1),Xn(this.vertexArray,1,1,1),Xn(this.vertexArray,-1,-1,-1),Xn(this.vertexArray,1,-1,-1),Xn(this.vertexArray,-1,1,-1),Xn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,qc),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=r.bd.simpleSegment(0,0,36,12)}}function oc(p,n,u,g,_,w){const S=p.context.gl,L=n.paint.get("sky-atmosphere-color"),M=n.paint.get("sky-atmosphere-halo-color"),V=n.paint.get("sky-atmosphere-sun-intensity"),Y=((J,Z,te,de,ue)=>({u_matrix_3f:J,u_sun_direction:Z,u_sun_intensity:te,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[ue.r,ue.g,ue.b,ue.a],u_luminance:5e-5}))(r.e4(r.dx(),g),_,V,L.toPremultipliedRenderColor(null),M.toPremultipliedRenderColor(null));S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+w,n.skyboxTexture,0),u.draw(p,S.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.frontCW,Y,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const md=r.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class JA{constructor(n){const u=new r.e5;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new r.a_;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(u,md.members),this.indexBuffer=n.createIndexBuffer(g),this.segments=r.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const yd=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ef{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ca{constructor(n){this.colorModeAlphaBlendedWriteRGB=new Wr([1,yo,1,yo],r.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Wr([1,0,1,0],r.am.transparent,[!1,!1,!1,!0]),this.params=new ef,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(n){const u=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new JA(u);const g=this.params.sizeRange,_=this.params.intensityRange,w=function(Y){const J=r.e7(30),Z=[];for(let te=0;te<Y;++te){const de=2*Math.PI*J(),ue=Math.acos(1-2*J())-.5*Math.PI;Z.push(r.cS(Math.cos(ue)*Math.cos(de),Math.cos(ue)*Math.sin(de),Math.sin(ue)))}return Z}(this.params.starsCount),S=r.e7(300),L=new r.e6,M=new r.a_;let V=0;for(let Y=0;Y<w.length;++Y){const J=r.bY([],w[Y],200),Z=Math.max(0,1+.01*g*(1*S()-.5)),te=Math.max(0,1+.01*_*(1*S()-.5));L.emplaceBack(J[0],J[1],J[2],-1,-1,Z,te),L.emplaceBack(J[0],J[1],J[2],1,-1,Z,te),L.emplaceBack(J[0],J[1],J[2],1,1,Z,te),L.emplaceBack(J[0],J[1],J[2],-1,1,Z,te),M.emplaceBack(V+0,V+1,V+2),M.emplaceBack(V+0,V+2,V+3),V+=4}this.starsVx=u.createVertexBuffer(L,yd.members),this.starsIdx=u.createIndexBuffer(M),this.starsSegments=r.bd.simpleSegment(0,0,L.length,M.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,u){const g=n.context,_=g.gl,w=n.transform,S=new ji(_.LEQUAL,ji.ReadOnly,[0,1]),L=r.ah(w.zoom),M=n.style.getLut(u.scope),V=u.properties.get("color-use-theme")==="none",Y=u.properties.get("color").toNonPremultipliedRenderColor(V?null:M).toArray01(),J=u.properties.get("high-color-use-theme")==="none",Z=u.properties.get("high-color").toNonPremultipliedRenderColor(J?null:M).toArray01(),te=u.properties.get("space-color-use-theme")==="none",de=u.properties.get("space-color").toNonPremultipliedRenderColor(te?null:M).toArray01(),ue=5e-4,ge=r.e8(u.properties.get("horizon-blend"),0,1,ue,.25),_e=r.dl(n,g,w)&&ge===ue?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,Te=n.frameCounter/1e3%1,Ne=r.ae(w.globeCenterInViewSpace),Qe=Math.sqrt(Math.pow(Ne,2)-Math.pow(_e,2)),at=Math.acos(Qe/Ne),st=it=>{const Xe=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];it&&Xe.push("ALPHA_PASS");const lt=n.getOrCreateProgram("globeAtmosphere",{defines:Xe}),dt=((Dt,ti,ri,vi,Mt,Vt,wt,oi,zt,mi,Li,ai)=>({u_frustum_tl:Dt,u_frustum_tr:ti,u_frustum_br:ri,u_frustum_bl:vi,u_horizon:Mt,u_transition:Vt,u_fadeout_range:wt,u_color:oi,u_high_color:zt,u_space_color:mi,u_temporal_offset:Li,u_horizon_angle:ai}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,L,ge,Y,Z,de,Te,at);n.uploadCommonUniforms(g,lt);const kt=this.atmosphereBuffer;kt&&lt.draw(n,_.TRIANGLES,S,Pr.disabled,it?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,wr.backCW,dt,it?"atmosphere_glow_alpha":"atmosphere_glow",kt.vertexBuffer,kt.indexBuffer,kt.segments)};st(!1),st(!0)}drawStars(n,u){const g=r.ay(u.properties.get("star-intensity"),0,1);if(g===0)return;const _=n.context,w=_.gl,S=n.transform,L=n.getOrCreateProgram("stars"),M=r.b_([]);r.c0(M,M,-S._pitch),r.b$(M,M,-S.angle),r.c0(M,M,r.al(S._center.lat)),r.e9(M,M,-r.al(S._center.lng));const V=r.c3(new Float32Array(16),M),Y=r.az([],S.starsProjMatrix,V),J=r.e4([],V),Z=r.ea([],J),te=[0,1,0];r.dz(te,te,Z),r.bY(te,te,this.params.sizeMultiplier);const de=[1,0,0];r.dz(de,de,Z),r.bY(de,de,this.params.sizeMultiplier);const ue=(ge=te,_e=de,Te=g,{u_matrix:Float32Array.from(Y),u_up:ge,u_right:_e,u_intensity_multiplier:Te});var ge,_e,Te;n.uploadCommonUniforms(_,L),this.starsVx&&this.starsIdx&&L.draw(n,w.TRIANGLES,ji.disabled,Pr.disabled,this.colorModeAlphaBlendedWriteRGB,wr.disabled,ue,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function $c(p,n){const u=[...p],g=n.cameraWorldSizeForFog/n.worldSize,_=r.bx([]);return r.cE(_,_,[g,g,1]),r.az(u,_,u),r.az(u,n.worldToFogMatrix,u),u}function Ei(p,n,u,g,_){const w=u.material,S=g.context,{baseColorTexture:L,metallicRoughnessTexture:M}=w.pbrMetallicRoughness,{normalTexture:V,occlusionTexture:Y,emissionTexture:J}=w;function Z(de,ue,ge){if(de&&(p.push(ue),S.activeTexture.set(S.gl.TEXTURE0+ge),de.gfxTexture)){const{minFilter:_e,magFilter:Te,wrapS:Ne,wrapT:Qe}=de.sampler;de.gfxTexture.bindExtraParam(_e,Te,Ne,Qe)}}Z(L,"HAS_TEXTURE_u_baseColorTexture",Yo.BaseColor),Z(M,"HAS_TEXTURE_u_metallicRoughnessTexture",Yo.MetallicRoughness),Z(V,"HAS_TEXTURE_u_normalTexture",Yo.Normal),Z(Y,"HAS_TEXTURE_u_occlusionTexture",Yo.Occlusion),Z(J,"HAS_TEXTURE_u_emissionTexture",Yo.Emission),_&&(_.texture||(_.texture=new r.eh(g.context,_.image,[_.image.height,_.image.height,_.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+Yo.LUT),_.texture&&_.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(u.texcoordBuffer)),u.colorBuffer&&(p.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(u.colorBuffer)),u.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(u.normalBuffer)),u.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(u.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||p.push("DIFFUSE_SHADED");const te=g.shadowRenderer;te&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&p.push("NORMAL_OFFSET"))}function Gi(p,n,u,g,_,w){const S=u.paint.get("model-opacity").constantOr(1),L=n.context,M=new ji(n.context.gl.LEQUAL,ji.ReadWrite,n.depthRangeFor3D),V=n.transform,Y=p.mesh,J=Y.material,Z=J.pbrMetallicRoughness,te=n.style.fog;let de;de=n.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:r.az([],g.zScaleMatrix,p.nodeModelMatrix),r.az(de,g.negCameraPosMatrix,de);const ue=r.bi([],de);r.ee(ue,ue);const ge=u.paint.get("model-color-use-theme").constantOr("default")==="none",_e=u.paint.get("model-emissive-strength").constantOr(0),Te=Qs(new Float32Array(p.worldViewProjection),new Float32Array(de),new Float32Array(ue),null,n,S,Z.baseColorFactor,J.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,J,_e,u),Ne={defines:[]},Qe=[],at=n.shadowRenderer;at&&(at.useNormalOffset=!1),Ei(Ne.defines,Qe,Y,n,ge?null:u.lut);let st=null;if(te){const lt=$c(p.nodeModelMatrix,n.transform);if(st=new Float32Array(lt),V.projection.name!=="globe"){const dt=Y.aabb.min,kt=Y.aabb.max,[Dt,ti]=te.getOpacityForBounds(lt,dt[0],dt[1],kt[0],kt[1]);Ne.overrideFog=Dt>=Nt||ti>=Nt}}const it=al(n,u.paint.get("model-cutoff-fade-range"));it.shouldRenderCutoff&&Ne.defines.push("RENDER_CUTOFF");const Xe=n.getOrCreateProgram("model",Ne);n.uploadCommonUniforms(L,Xe,null,st,it),n.renderPass!=="shadow"&&at&&at.setupShadowsFromMatrix(p.nodeModelMatrix,Xe),Xe.draw(n,L.gl.TRIANGLES,M,_,w,Y.material.doubleSided?wr.disabled:wr.backCCW,Te,u.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,u.paint,n.transform.zoom,void 0,Qe)}function Gu(p,n,u,g,_,w,S){let L;L=p.projection.name==="globe"?r.ed(u,p):[...u],r.az(L,L,n.matrix);const M=r.az([],g,L);if(n.meshes)for(const V of n.meshes){if(V.material.alphaMode!=="BLEND"){S.push({mesh:V,depth:0,modelIndex:_,worldViewProjection:M,nodeModelMatrix:L});continue}const Y=r.ad([],V.centroid,M);!p.isOrthographic&&Y[2]<=0||w.push({mesh:V,depth:Y[2],modelIndex:_,worldViewProjection:M,nodeModelMatrix:L})}if(n.children)for(const V of n.children)Gu(p,V,u,g,_,w,S)}function Us(p,n,u,g){const _=u.shadowRenderer;if(!_)return;const w=_.getShadowPassDepthMode(),S=_.getShadowPassColorMode(),L=_.calculateShadowPassMatrixFromMatrix(n),M=Ls(L);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,w,Pr.disabled,S,wr.backCCW,M,g.id,p.vertexBuffer,p.indexBuffer,p.segments,g.paint,u.transform.zoom,void 0,void 0)}function Ft(p,n,u){const g=n.updateZoomBasedPaintProperties(),_=function(w,S,L){let M,V,Y,J=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&J>0){const Z=w.terrain,te=Z.findDEMTileFor(L);te&&te.dem?M=r.ei.create(Z,L,te):J=0}if(J===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),J===S.validForExaggeration&&(J===0||M&&M._demTile&&M._demTile.tileID===S.validForDEMTile.id&&M._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const Z in S.instancesPerModel){const te=S.instancesPerModel[Z];for(let de=0;de<te.instancedDataArray.length;++de){const ue=(M?J*M.getElevationAt(0|te.instancedDataArray.float32[16*de],0|te.instancedDataArray.float32[16*de+1],!0,!0):0)+te.instancesEvaluatedElevation[de];te.instancedDataArray.float32[16*de+6]=ue,V=V?Math.min(S.terrainElevationMin,ue):ue,Y=Y?Math.max(S.terrainElevationMax,ue):ue}}return S.terrainElevationMin=V||0,S.terrainElevationMax=Y||0,S.validForExaggeration=J,S.validForDEMTile=M&&M._demTile?{id:M._demTile.tileID,timestamp:M._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,n,u);(g||_)&&(n.uploaded=!1,n.upload(p.context))}const ac={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.cW([0,0,0],[r.aj,r.aj,0])};function vd(p,n){const u=1<<p.canonical.z,g=n.getFreeCameraOptions().position,_=n.elevation,w=p.canonical.x/u,S=(p.canonical.x+1)/u,L=p.canonical.y/u,M=(p.canonical.y+1)/u;let V=n._centerAltitude;if(_){const te=_.getMinMaxForTile(p);te&&te.max>V&&(V=te.max)}const Y=r.ay(g.x,w,S)-g.x,J=r.ay(g.y,L,M)-g.y,Z=r.c6(V,n.center.lat)-g.z;return n._zoomFromMercatorZ(Math.sqrt(Y*Y+J*J+Z*Z))}function yA(p,n,u,g,_,w,S){const L=p.context,M=p.renderPass==="shadow",V=p.shadowRenderer,Y=M&&V?V.getShadowPassDepthMode():new ji(L.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),J=p.isTileAffectedByFog(w);if(u.meshes)for(const Z of u.meshes){const te=["MODEL_POSITION_ON_GPU"],de=[];let ue,ge,_e;g.instancedDataArray.length>20&&te.push("INSTANCED_ARRAYS");const Te=al(p,n.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&te.push("RENDER_CUTOFF"),M&&V)ue=p.getOrCreateProgram("modelDepth",{defines:te}),ge=Ls(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(u.matrix)),_e=V.getShadowPassColorMode();else{Ei(te,de,Z,p,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),ue=p.getOrCreateProgram("model",{defines:te,overrideFog:J});const Qe=Z.material,at=Qe.pbrMetallicRoughness,st=n.paint.get("model-opacity").constantOr(1),it=n.paint.get("model-emissive-strength").constantOr(0);ge=Qs(w.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,p,st,at.baseColorFactor,Qe.emissiveFactor,at.metallicFactor,at.roughnessFactor,Qe,it,n,_),V&&(S.shadowUniformsInitialized?ue.setShadowUniformValues(L,V.getShadowUniformValues()):(V.setupShadows(w.toUnwrapped(),ue,"model-tile",w.overscaledZ),S.shadowUniformsInitialized=!0)),_e=Te.shouldRenderCutoff||st<1||Qe.alphaMode!=="OPAQUE"?Wr.alphaBlended:Wr.unblended}p.uploadCommonUniforms(L,ue,w.toUnwrapped(),null,Te);const Ne=Z.material.doubleSided?wr.disabled:wr.backCCW;if(g.instancedDataArray.length>20)de.push(g.instancedDataBuffer),ue.draw(p,L.gl.TRIANGLES,Y,Pr.disabled,_e,Ne,ge,n.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,n.paint,p.transform.zoom,void 0,de,g.instancedDataArray.length);else{const Qe=M?"u_instance":"u_normal_matrix";for(let at=0;at<g.instancedDataArray.length;++at)ge[Qe]=new Float32Array(g.instancedDataArray.arrayBuffer,64*at,16),ue.draw(p,L.gl.TRIANGLES,Y,Pr.disabled,_e,Ne,ge,n.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,n.paint,p.transform.zoom,void 0,de)}}if(u.children)for(const Z of u.children)yA(p,n,Z,g,_,w,S)}const vA=[1,-1,1];function Wu(p,n,u,g){if(!u.modelManager)return!0;const _=u.modelManager;if(!u.shadowRenderer)return!0;const w=u.shadowRenderer,S=n.aabb;let L=!0,M=p.maxHeight;if(M===0){let Y=0;for(const J in p.instancesPerModel){const Z=_.getModel(J,g);Z?Y=Math.max(Y,Math.max(Math.max(Z.aabb.max[0],Z.aabb.max[1]),Z.aabb.max[2])):L=!1}M=p.maxScale*Y*1.41+p.maxVerticalOffset,L&&(p.maxHeight=M)}S.max[2]=M,S.min[2]+=p.terrainElevationMin,S.max[2]+=p.terrainElevationMax,r.ad(S.min,S.min,n.tileMatrix),r.ad(S.max,S.max,n.tileMatrix);const V=S.intersects(w.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=V===2),V===0}function Df(p,n){const u=p.uniformValues.u_cutoff_params[0],g=p.uniformValues.u_cutoff_params[1],_=p.uniformValues.u_cutoff_params[2],w=p.uniformValues.u_cutoff_params[3];return g===u||w===_?1:r.ay(((n-u)/(g-u)-_)/(w-_),0,1)}function Su(p,n,u,g){if(n.pitch<20)return 1;const _=n.getWorldToCameraMatrix();r.az(_,_,p);const w=r.ej(u.min[0],u.min[1],u.min[2],1);let S=r.aA(r.ek(),w,_),L=S,M=S;w[1]=u.max[1],S=r.aA(r.ek(),w,_),L=S[1]<L[1]?S:L,M=S[1]>M[1]?S:M,w[0]=u.max[0],S=r.aA(r.ek(),w,_),L=S[1]<L[1]?S:L,M=S[1]>M[1]?S:M,w[1]=u.min[1],S=r.aA(r.ek(),w,_),L=S[1]<L[1]?S:L,M=S[1]>M[1]?S:M;const V=r.ay(g[0],0,1),Y=100*n.pixelsPerMeter*r.ay(g[1],0,1),J=r.ay(g[2],0,1),Z=r.el(r.ek(),L,M,V),te=Math.tan(.5*n.fovX),de=-Z[2]*te;if(Y===0)return Z[1]<-Math.abs(de)?J:1;const ue=(-Math.abs(de)-Z[1])/Y,ge=(Te,Ne,Qe)=>(1-Qe)*Te+Qe*Ne,_e=r.ay(ge(1,J,ue),J,1);return ge(1,_e,r.ay((n.pitch-20)/20,0,1))}class Of{}class Ma{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,u,g){{const J=this._storage.get(u.id);if(J)return J.lastUsedFrameIdx=n,J.buf}const _=g.gl,w=_.getBufferParameter(_.ELEMENT_ARRAY_BUFFER,_.BUFFER_SIZE),S=new ArrayBuffer(w),L=new Int16Array(S);_.getBufferSubData(_.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const M=new r.en;for(let J=0;J<w/2;J+=3){const Z=L[J],te=L[J+1],de=L[J+2];M.emplaceBack(Z,te),M.emplaceBack(te,de),M.emplaceBack(de,Z)}const V=g.bindVertexArrayOES.current,Y=new Of;return Y.buf=new gs(g,M),Y.lastUsedFrameIdx=n,this._storage.set(u.id,Y),g.bindVertexArrayOES.set(V),Y.buf}update(n){for(const[u,g]of this._storage)n-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[n,u]of this._storage)u.buf.destroy(),this._storage.delete(n)}}class Kh{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Xu=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class _d{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Sh{constructor(n,u){this.revealStart=11,this.revealRange=2,n.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),n.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const lc=r.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class Sc{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,u){const g=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new r.eo,L=new r.a_;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),L.emplaceBack(0,1,2),L.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(S,lc.members),this.vignetteIdx=n.context.createIndexBuffer(L)}const _=r.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,g);const S={u_vignetteShape:(w={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};g.draw(n,n.context.gl.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,_)}var w}}class cc{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,u){const g=n.getFreeCameraOptions().position,_=g.toAltitude(),w=g.toLngLat(),S=r.al(w.lng),L=r.al(w.lat),M=n.pixelsPerMeter/u,V=S*r.eq,Y=r.eq*Math.log(Math.tan(Math.PI/4+L/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const J=-this._offsetYPrev+Y,Z=-this._elevationPrev+_;this._accumulatedOffsetX+=(-this._offsetXPrev+V)*M,this._accumulatedOffsetY+=J*M,this._accumulatedElevation+=Z*M,this._offsetXPrev=V,this._offsetYPrev=Y,this._elevationPrev=_}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Zc(p,n){return[-(p[0]-Math.floor(p[0]/n)*n),-(p[1]-Math.floor(p[1]/n)*n),-(p[2]-Math.floor(p[2]/n)*n)]}function xd(p){const n=r.e7(1323123451230),u=[];for(let g=0;g<p;++g){const _=2*n()-1,w=2*n()-1,S=2*n()-1;u.push(r.cS(_,w,S))}return u}function Eu(p,n,u,g,_){const w=r.ay((_-u)/(g-u),0,1);return(1-w)*p+w*n}class Wa{constructor(n){this._movement=new cc,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Sc,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,u){const g=n.transform;this._movement.update(g,this._ppmScaleFactor);const _=g.starsProjMatrix,w=r.b_([]);r.c0(w,w,r.al(90)-g._pitch),r.b$(w,w,-g.angle);const S=r.c3(new Float32Array(16),w),L=r.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),M=r.ee([],L),V=r.az([],M,S),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*u,this._prevTime=Y,{projectionMatrix:_,modelviewMatrix:V}}}class tf extends Wa{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Sh(n.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const g=xd(this.particlesCount),_=new r.er,w=new r.a_;let S=0;const L=r.e7(1323123451230);for(let M=0;M<g.length;++M){const V=g[M],Y=[2*L()-1,L(),L(),L()];_.emplaceBack(V[0],V[1],V[2],-1,-1,...Y),_.emplaceBack(V[0],V[1],V[2],1,-1,...Y),_.emplaceBack(V[0],V[1],V[2],1,1,...Y),_.emplaceBack(V[0],V[1],V[2],-1,1,...Y),w.emplaceBack(S+0,S+1,S+2),w.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(_,Xu.members),this.particlesIdx=u.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=n.transform.zoom;if(u.revealStart>g)return;const _=Eu(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let S=[-w.direction.x,w.direction.y,-100];r.au(S,S);const L=structuredClone(this._vignetteParams);L.strength*=_,w.overrideStyleParameters||(w.intensity=n.style.rain.state.density,w.timeFactor=n.style.rain.state.intensity,w.color=structuredClone(n.style.rain.state.color),S=structuredClone(n.style.rain.state.direction),w.screenThinning.intensity=n.style.rain.state.centerThinning,w.dropletSizeX=n.style.rain.state.dropletSize[0],w.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],w.distortionStrength=100*n.style.rain.state.distortionStrength,L.strength=1,L.color=structuredClone(n.style.rain.state.vignetteColor));const M=this.updateOnRender(n,w.timeFactor),V=n.context,Y=V.gl,J=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new r.T(V,{width:n.width,height:n.height,data:null},Y.RGBA8)),w.distortionStrength>0&&(V.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const Z=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(V,Z),V.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const te=[w.color.r,w.color.g,w.color.b,w.color.a],de=(ue,ge)=>{const _e=Zc(this._movement.getPosition(),ue),Te=w.dropletSizeX,Ne=w.dropletSizeX*w.dropletSizeYScale,Qe=n.width/2,at=n.height/2,st=Eu(0,w.screenThinning.start,0,1,w.screenThinning.intensity),it=Eu(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),Xe=Eu(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),lt=(dt={modelview:M.modelviewMatrix,projection:M.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:_e,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:ue,rainDropletSize:[Te,Ne],distortionStrength:w.distortionStrength,rainDirection:S,color:te,screenSize:[J.width,J.height],thinningCenterPos:[Qe,at],thinningShape:[st,it,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:Xe,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:ge?0:1},{u_modelview:Float32Array.from(dt.modelview),u_projection:Float32Array.from(dt.projection),u_time:dt.time,u_cam_pos:dt.camPos,u_texScreen:0,u_velocityConeAperture:dt.velocityConeAperture,u_velocity:dt.velocity,u_boxSize:dt.boxSize,u_rainDropletSize:dt.rainDropletSize,u_distortionStrength:dt.distortionStrength,u_rainDirection:dt.rainDirection,u_color:dt.color,u_screenSize:dt.screenSize,u_thinningCenterPos:dt.thinningCenterPos,u_thinningShape:dt.thinningShape,u_thinningAffectedRatio:dt.thinningAffectedRatio,u_thinningParticleOffset:dt.thinningParticleOffset,u_shapeDirectionalPower:dt.shapeDirectionalPower,u_shapeNormalPower:dt.shapeNormalPower,u_mode:dt.mode});var dt;const kt=Math.round(w.intensity*this.particlesCount),Dt=r.bd.simpleSegment(0,0,4*kt,2*kt);Z.draw(n,Y.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,lt,"rain_particles",this.particlesVx,this.particlesIdx,Dt)};w.distortionStrength>0&&de(w.boxSize,!0),de(w.boxSize,!1),this._vignette.draw(n,L)}}const Eh=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Ms extends Wa{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Sh(n.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const g=xd(this.particlesCount),_=new r.es,w=new r.a_;let S=0;const L=r.e7(1323123451230);for(let M=0;M<g.length;++M){const V=g[M],Y=L(),J=L(),Z=L(),te=[M/g.length,Y,J,Z],de=[L(),L()];_.emplaceBack(V[0],V[1],V[2],-1,-1,...te,...de),_.emplaceBack(V[0],V[1],V[2],1,-1,...te,...de),_.emplaceBack(V[0],V[1],V[2],1,1,...te,...de),_.emplaceBack(V[0],V[1],V[2],-1,1,...te,...de),w.emplaceBack(S+0,S+1,S+2),w.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(_,Eh.members),this.particlesIdx=u.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];r.au(g,g);const _=structuredClone(this._vignetteParams),w=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=n.transform.zoom;if(w.revealStart>S)return;const L=Eu(0,1,w.revealStart,w.revealStart+w.revealRange,S);_.strength*=L,u.overrideStyleParameters||(u.intensity=n.style.snow.state.density,u.timeFactor=n.style.snow.state.intensity,u.color=structuredClone(n.style.snow.state.color),g=structuredClone(n.style.snow.state.direction),u.screenThinning.intensity=n.style.snow.state.centerThinning,u.billboardSize=2.79*n.style.snow.state.flakeSize,_.strength=1,_.color=structuredClone(n.style.snow.state.vignetteColor));const M=this.updateOnRender(n,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const V=n.context,Y=V.gl,J=n.transform,Z=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(V,Z),((te,de,ue)=>{const ge=Zc(this._movement.getPosition(),te),_e=J.width/2,Te=J.height/2,Ne=Eu(0,ue.screenThinning.start,0,1,ue.screenThinning.intensity),Qe=Eu(.001,ue.screenThinning.range,0,1,ue.screenThinning.intensity),at=Eu(0,ue.screenThinning.particleOffset,0,1,ue.screenThinning.intensity),st=(it={modelview:M.modelviewMatrix,projection:M.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ge,velocityConeAperture:ue.velocityConeAperture,velocity:ue.velocity,horizontalOscillationRadius:ue.horizontalOscillationRadius,horizontalOscillationRate:ue.horizontalOscillationRate,boxSize:te,billboardSize:1*ue.billboardSize,simpleShapeParameters:[ue.shapeFadeStart,ue.shapeFadePower],screenSize:[J.width,J.height],thinningCenterPos:[_e,Te],thinningShape:[Ne,Qe,Math.pow(10,ue.screenThinning.fadePower)],thinningAffectedRatio:ue.screenThinning.affectedRatio,thinningParticleOffset:at,color:[ue.color.r,ue.color.g,ue.color.b,ue.color.a],direction:g},{u_modelview:Float32Array.from(it.modelview),u_projection:Float32Array.from(it.projection),u_time:it.time,u_cam_pos:it.camPos,u_velocityConeAperture:it.velocityConeAperture,u_velocity:it.velocity,u_horizontalOscillationRadius:it.horizontalOscillationRadius,u_horizontalOscillationRate:it.horizontalOscillationRate,u_boxSize:it.boxSize,u_billboardSize:it.billboardSize,u_simpleShapeParameters:it.simpleShapeParameters,u_screenSize:it.screenSize,u_thinningCenterPos:it.thinningCenterPos,u_thinningShape:it.thinningShape,u_thinningAffectedRatio:it.thinningAffectedRatio,u_thinningParticleOffset:it.thinningParticleOffset,u_particleColor:it.color,u_direction:it.direction});var it;const Xe=Math.round(ue.intensity*this.particlesCount),lt=r.bd.simpleSegment(0,0,4*Xe,2*Xe);this.particlesVx&&this.particlesIdx&&Z.draw(n,Y.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,st,"snow_particles",this.particlesVx,this.particlesIdx,lt)})(u.boxSize,0,u),this._vignette.draw(n,_)}}const Rn={symbol:function(p,n,u,g,_){if(p.renderPass!=="translucent")return;const w=Pr.disabled,S=p.colorModeForRenderPass(),L=u.layout.get("text-variable-anchor"),M=u.layout.get("text-size-scale-range"),V=r.ay(p.scaleFactor,M[0],M[1]);L&&function(Z,te,de,ue,ge,_e,Te,Ne){const Qe=te.transform,at=ge==="map",st=_e==="map";for(const it of Z){const Xe=ue.getTile(it),lt=Xe.getBucket(de);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const dt=r.bH(lt.textSizeData,Qe.zoom,Ne),kt=Ah(it,lt.getProjection(),Qe),Dt=Qe.calculatePixelsToTileUnitsMatrix(Xe),ti=qa(kt,Xe.tileID.canonical,st,at,Qe,lt.getProjection(),Dt),ri=lt.hasIconTextFit()&&lt.hasIconData();dt&&Ca(lt,at,st,Te,Qe,ti,it,Math.pow(2,Qe.zoom-Xe.tileID.overscaledZ),dt,ri)}}(g,p,u,n,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),_,V);const Y=u.paint.get("icon-opacity").constantOr(1)!==0,J=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||J)?co(p,n,u,g,w,S):(Y&&co(p,n,u,g,w,S,{onlyIcons:!0}),J&&co(p,n,u,g,w,S,{onlyText:!0})),n.map.showCollisionBoxes&&(oa(p,n,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),oa(p,n,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(p,n,u,g){if(p.renderPass!=="translucent")return;const _=u.paint.get("circle-opacity"),w=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),L=u.layout.get("circle-sort-key").constantOr(1)!==void 0,M=u.paint.get("circle-emissive-strength");if(_.constantOr(1)===0&&(w.constantOr(1)===0||S.constantOr(1)===0))return;const V=p.context,Y=V.gl,J=p.transform,Z=!(!p.terrain||!p.terrain.enabled),te=u.layout.get("circle-elevation-reference"),de=p.depthModeForSublayer(0,ji.ReadOnly),ue=new ji(p.context.gl.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),ge=te==="none"||Z?de:ue,_e=Pr.disabled,Te=p.colorModeForDrapableLayerRenderPass(M),Ne=J.projection.name==="globe",Qe=[r.aD(J.center.lng),r.aH(J.center.lat)],at=[];for(let it=0;it<g.length;it++){const Xe=g[it],lt=n.getTile(Xe),dt=lt.getBucket(u);if(!dt||dt.projection.name!==J.projection.name)continue;const kt=dt.programConfigurations.get(u.id),Dt=dt.layoutVertexBuffer,ti=dt.globeExtVertexBuffer,ri=dt.indexBuffer,vi=r.dK(u),Mt=[ti],Vt=p.isTileAffectedByFog(Xe);Ne&&vi.push("PROJECTION_GLOBE_VIEW"),vi.push("DEPTH_D24"),p.terrain&&J.depthOcclusionForSymbolsAndCircles&&vi.push("DEPTH_OCCLUSION"),dt.hasElevation&&(vi.push("ELEVATED_ROADS"),Mt.push(dt.elevatedLayoutVertexBuffer));const wt=p.getOrCreateProgram("circle",{config:kt,defines:vi,overrideFog:Vt}),oi=J.projection.createInversionMatrix(J,Xe.canonical),zt={programConfiguration:kt,program:wt,layoutVertexBuffer:Dt,dynamicBuffers:Mt,indexBuffer:ri,uniformValues:r.dL(p,Xe,lt,oi,Qe,u),tile:lt};if(L){const mi=dt.segments.get();for(const Li of mi)at.push({segments:new r.bd([Li]),sortKey:Li.sortKey,state:zt})}else at.push({segments:dt.segments,sortKey:0,state:zt})}L&&at.sort((it,Xe)=>it.sortKey-Xe.sortKey);const st={useDepthForOcclusion:J.depthOcclusionForSymbolsAndCircles};for(const it of at){const{programConfiguration:Xe,program:lt,layoutVertexBuffer:dt,dynamicBuffers:kt,indexBuffer:Dt,uniformValues:ti,tile:ri}=it.state,vi=it.segments;p.terrain&&p.terrain.setupElevationDraw(ri,lt,st),p.uploadCommonUniforms(V,lt,ri.tileID.toUnwrapped()),lt.draw(p,Y.TRIANGLES,ge,_e,Te,wr.disabled,ti,u.id,dt,Dt,vi,u.paint,J.zoom,Xe,kt)}},heatmap:function(p,n,u,g){if(u.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const _=p.context,w=_.gl,S=Pr.disabled,L=new Wr([w.ONE,w.ONE,w.ONE,w.ONE],r.am.transparent,[!0,!0,!0,!0]);(function(te,de,ue,ge){const _e=te.gl,Te=de.width*ge,Ne=de.height*ge;te.activeTexture.set(_e.TEXTURE1),te.viewport.set([0,0,Te,Ne]);let Qe=ue.heatmapFbo;if(!Qe||Qe&&(Qe.width!==Te||Qe.height!==Ne)){Qe&&Qe.destroy();const at=_e.createTexture();_e.bindTexture(_e.TEXTURE_2D,at),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),Qe=ue.heatmapFbo=te.createFramebuffer(Te,Ne,!0,null),function(st,it,Xe,lt,dt,kt){const Dt=st.gl;Dt.texImage2D(Dt.TEXTURE_2D,0,st.extRenderToTextureHalfFloat?Dt.RGBA16F:Dt.RGBA,dt,kt,0,Dt.RGBA,st.extRenderToTextureHalfFloat?Dt.HALF_FLOAT:Dt.UNSIGNED_BYTE,null),lt.colorAttachment.set(Xe)}(te,0,at,Qe,Te,Ne)}else _e.bindTexture(_e.TEXTURE_2D,Qe.colorAttachment.get()),te.bindFramebuffer.set(Qe.framebuffer)})(_,p,u,p.transform.projection.name==="globe"?.5:.25),_.clear({color:r.am.transparent});const M=p.transform,V=M.projection.name==="globe",Y=V?["PROJECTION_GLOBE_VIEW"]:[],J=V?wr.frontCCW:wr.disabled,Z=[r.aD(M.center.lng),r.aH(M.center.lat)];for(let te=0;te<g.length;te++){const de=g[te];if(n.hasRenderableParent(de))continue;const ue=n.getTile(de),ge=ue.getBucket(u);if(!ge||ge.projection.name!==M.projection.name)continue;const _e=p.isTileAffectedByFog(de),Te=ge.programConfigurations.get(u.id),Ne=p.getOrCreateProgram("heatmap",{config:Te,defines:Y,overrideFog:_e}),{zoom:Qe}=p.transform;p.terrain&&p.terrain.setupElevationDraw(ue,Ne),p.uploadCommonUniforms(_,Ne,de.toUnwrapped());const at=M.projection.createInversionMatrix(M,de.canonical);Ne.draw(p,w.TRIANGLES,ji.disabled,S,L,J,Bi(p,de,ue,at,Z,Qe,u.paint.get("heatmap-intensity")),u.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,u.paint,p.transform.zoom,Te,V?[ge.globeExtVertexBuffer]:null)}_.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(_,w){const S=_.context,L=S.gl,M=w.heatmapFbo;if(!M)return;S.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,M.colorAttachment.get()),S.activeTexture.set(L.TEXTURE1);let V=w.colorRampTexture;V||(V=w.colorRampTexture=new r.T(S,w.colorRamp,L.RGBA8)),V.bind(L.LINEAR,L.CLAMP_TO_EDGE),_.getOrCreateProgram("heatmapTexture").draw(_,L.TRIANGLES,ji.disabled,Pr.disabled,_.colorModeForRenderPass(),wr.disabled,((Y,J,Z,te)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,w),w.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,w.paint,_.transform.zoom)}(p,u))},line:function(p,n,u,g){if(p.renderPass!=="translucent")return;const _=u.paint.get("line-opacity"),w=u.paint.get("line-width");if(_.constantOr(1)===0||w.constantOr(1)===0)return;const S=u.paint.get("line-emissive-strength"),L=u.paint.get("line-occlusion-opacity"),M=u.layout.get("line-elevation-reference"),V=u.layout.get("line-width-unit")==="meters",Y=M==="sea",J=!(!p.terrain||!p.terrain.enabled),Z=p.context,te=Z.gl;if(u.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const de=u.layout.get("line-cross-slope"),ue=de!==void 0,ge=de<1,_e=p.colorModeForDrapableLayerRenderPass(S),Te=p.terrain&&p.terrain.renderingToTexture,Ne=Te?1:r.q.devicePixelRatio,Qe=u.paint.get("line-dasharray"),at=Qe.constantOr(1),st=u.layout.get("line-cap"),it=Qe.constantOr(null),Xe=st.constantOr(null),lt=u.paint.get("line-pattern"),dt=lt.constantOr(1),kt=u.paint.get("line-pattern-cross-fade"),Dt=lt.constantOr(null),ti=u.paint.get("line-opacity").constantOr(1);let ri=!dt&&ti!==1||p.depthOcclusion&&L>0&&L<1;const vi=u.paint.get("line-gradient"),Mt=dt?"linePattern":"line",Vt=r.dM(u);let wt;if(Te&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ri=!1),L!==0&&p.depthOcclusion){const Li=u.paint._values["line-opacity"];Li&&Li.value&&Li.value.kind==="constant"?wt=Li.value:r.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&Vt.push("VARIABLE_LINE_WIDTH");const oi=(Li,ai,Mi,ir,tr,Ki)=>{for(const pr of Li){const gr=n.getTile(pr);if(dt&&!gr.patternsLoaded())continue;const Cr=gr.getBucket(u);if(!Cr||Cr.elevationType!=="none"&&!tr||Cr.elevationType==="none"&&tr)continue;p.prepareDrawTile();const Hr=[...ai],sn=p.shadowRenderer,Yn=Cr.elevationType==="road"&&!!sn&&sn.enabled;let xs=[0,0,0];if(Yn){const Fn=p.style.directionalLight,Io=p.style.ambientLight;Fn&&Io&&(xs=sa(p.style,Fn,Io)),Hr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const es=Cr.programConfigurations.get(u.id);let is=!1;if(Dt&&gr.imageAtlas){const Fn=r.dN.from(Dt),Io=Fn.getPrimary().scaleSelf(Ne).toString(),ks=gr.imageAtlas.patternPositions.get(Io),N=Fn.getSecondary(),O=N?gr.imageAtlas.patternPositions.get(N.scaleSelf(Ne).toString()):null;is=!!ks&&!!O,ks&&es.setConstantPatternPositions(ks,O)}kt>0&&(is||es.getPatternTransitionVertexBuffer("line-pattern"))&&Hr.push("LINE_PATTERN_TRANSITION");const uo=p.isTileAffectedByFog(pr),Jr=p.getOrCreateProgram(Mt,{config:es,defines:Hr,overrideFog:uo,overrideRtt:!tr&&void 0});if(!dt&&it&&Xe&&gr.lineAtlas){const Fn=gr.lineAtlas.getDash(it,Xe);Fn&&es.setConstantPatternPositions(Fn)}Yn&&sn.setupShadows(gr.tileID.toUnwrapped(),Jr,"vector-tile",gr.tileID.overscaledZ);let[ln,yn]=u.paint.get("line-trim-offset");(Xe==="round"||Xe==="square")&&ln!==yn&&(ln===0&&(ln-=1),yn===1&&(yn+=1));const Ps=Te?pr.projMatrix:null,Qo=V?1/Cr.tileToMeter/r.aw(gr,1,p.transform.zoom):1,Es=V?1/Cr.tileToMeter/r.aw(gr,1,Math.floor(p.transform.zoom)):1,Hn=dt?r.dO(p,gr,u,Ps,Ne,Qo,Es,[ln,yn],xs,kt):r.dP(p,gr,u,Ps,Cr.lineClipsArray.length,Ne,Qo,Es,[ln,yn],xs);if(vi){const Fn=Cr.gradients[u.id];let Io=Fn.texture;if(u.gradientVersion!==Fn.version){let ks=256;if(u.stepInterpolant){const N=n.getSource().maxzoom,O=pr.canonical.z===N?Math.ceil(1<<p.transform.maxZoom-pr.canonical.z):1;ks=r.ay(r.dQ(Cr.maxLineLength/r.aj*1024*O),256,Z.maxTextureSize)}Fn.gradient=r.dR({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:ks,image:Fn.gradient||void 0,clips:Cr.lineClipsArray}),Fn.texture?Fn.texture.update(Fn.gradient):Fn.texture=new r.T(Z,Fn.gradient,te.RGBA8),Fn.version=u.gradientVersion,Io=Fn.texture}Z.activeTexture.set(te.TEXTURE1),Io.bind(u.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}at&&(Z.activeTexture.set(te.TEXTURE0),gr.lineAtlasTexture&&gr.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),es.updatePaintBuffers()),dt&&(Z.activeTexture.set(te.TEXTURE0),gr.imageAtlasTexture&&gr.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),es.updatePaintBuffers()),tr&&!Y&&p.terrain.setupElevationDraw(gr,Jr),p.uploadCommonUniforms(Z,Jr,pr.toUnwrapped());const to=Fn=>{wt!=null&&(wt.value=ti*L),Jr.draw(p,te.TRIANGLES,Mi,Fn,_e,wr.disabled,Hn,u.id,Cr.layoutVertexBuffer,Cr.indexBuffer,Cr.segments,u.paint,p.transform.zoom,es,[Cr.layoutVertexBuffer2,Cr.patternVertexBuffer,Cr.zOffsetVertexBuffer]),wt!=null&&(wt.value=ti)};if(ri&&!tr){const Fn=p.stencilModeForClipping(pr).ref;Fn===0&&Te&&Z.clear({stencil:0});const Io={func:te.EQUAL,mask:255};Hn.u_alpha_discard_threshold=.8,to(new Pr(Io,Fn,255,te.KEEP,te.KEEP,te.INVERT)),Hn.u_alpha_discard_threshold=0,to(new Pr(Io,Fn,255,te.KEEP,te.KEEP,te.KEEP))}else Hn.u_alpha_discard_threshold=ri&&tr&&Ki?.8:0,to(tr?ir:p.stencilModeForClipping(pr))}};let zt=p.depthModeForSublayer(0,ji.ReadOnly);const mi=new ji(p.depthOcclusion?te.GREATER:te.LEQUAL,ji.ReadOnly,p.depthRangeFor3D);if(u.hasNonElevatedBuckets){const Li=!Te&&p.terrain;L!==0&&Li?r.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):Li?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):oi(g,Vt,zt,Pr.disabled,!1,!0)}if(u.hasElevatedBuckets){M==="hd-road-markup"?J||(zt=mi,Vt.push("ELEVATED_ROADS")):(Vt.push("ELEVATED"),zt=mi,ue&&Vt.push(ge?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&Vt.push("ELEVATION_REFERENCE_SEA"));const Li=ri?p.stencilModeFor3D():Pr.disabled;p.forceTerrainMode=!0,oi(g,Vt,zt,Li,!0,!0),ri&&oi(g,Vt,zt,Li,!0,!1),p.forceTerrainMode=!1}ri&&(p.resetStencilClippingMasks(),Te&&Z.clear({stencil:0})),L===0||p.depthOcclusion||Te||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,n,u,g){const _=u.paint.get("fill-color"),w=u.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const S=u.paint.get("fill-emissive-strength"),L=p.colorModeForDrapableLayerRenderPass(S),M=u.paint.get("fill-pattern"),V=p.opaquePassEnabledForLayer()&&!M.constantOr(1)&&_.constantOr(r.am.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";let Y="none";u.layout.get("fill-elevation-reference")!=="none"?Y="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(Y="offset");const J=!(!p.terrain||!p.terrain.enabled),Z={painter:p,sourceCache:n,layer:u,coords:g,colorMode:L,elevationType:Y,terrainEnabled:J,pass:V};if(p.renderPass!=="shadow")if(Y!=="offset"){if(aa(Z,!1),Y==="road"){const te=!J&&p.renderPass==="translucent";te&&sc(p,n,u,g,"geometry"),aa(Z,!0,Pr.disabled),te&&function(de){const{painter:ue,sourceCache:ge,layer:_e,coords:Te,colorMode:Ne}=de,Qe=ue.context.gl,at=de.painter.shadowRenderer,st=!!at&&at.enabled,it=new ji(ue.context.gl.LEQUAL,ji.ReadOnly,ue.depthRangeFor3D);let Xe=[0,0,0];if(st){const dt=ue.style.directionalLight,kt=ue.style.ambientLight;dt&&kt&&(Xe=sa(ue.style,dt,kt))}const lt=dt=>{for(const kt of Te){const Dt=ge.getTile(kt),ti=Dt.getBucket(_e);if(!ti)continue;const ri=ti.elevatedStructures;if(!ri)continue;let vi,Mt;if(dt?(vi=ri.renderableBridgeSegments,Mt=ri.bridgeProgramConfigurations.get(_e.id)):(vi=ri.renderableTunnelSegments,Mt=ri.tunnelProgramConfigurations.get(_e.id)),!vi||vi.segments[0].primitiveLength===0)continue;Mt.updatePaintBuffers(),ue.prepareDrawTile();const Vt=ue.isTileAffectedByFog(kt),wt=[];st&&wt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const oi=ue.getOrCreateProgram("elevatedStructures",{config:Mt,overrideFog:Vt,defines:wt}),zt=ue.translatePosMatrix(kt.projMatrix,Dt,_e.paint.get("fill-translate"),_e.paint.get("fill-translate-anchor"));st&&at.setupShadows(Dt.tileID.toUnwrapped(),oi,"vector-tile",Dt.tileID.overscaledZ);const mi=nt(zt,Xe);ue.uploadCommonUniforms(ue.context,oi,kt.toUnwrapped()),oi.draw(ue,Qe.TRIANGLES,it,Pr.disabled,Ne,wr.backCCW,mi,_e.id,ri.vertexBuffer,ri.indexBuffer,vi,_e.paint,ue.transform.zoom,Mt,[ri.vertexBufferNormal])}};lt(!0),lt(!1)}(Z)}}else aa(Z,!1,p.stencilModeFor3D());else p.shadowRenderer&&Y==="road"&&!J&&function(te){const{painter:de,sourceCache:ue,layer:ge,coords:_e}=te,Te=de.context.gl,Ne=te.painter.shadowRenderer;for(const Qe of _e){const at=ue.getTile(Qe),st=at.getBucket(ge);if(!st)continue;const it=st.elevatedStructures;if(!it||!it.shadowCasterSegments||it.shadowCasterSegments.segments[0].primitiveLength===0)continue;de.prepareDrawTile();const Xe=st.bufferData.programConfigurations.get(ge.id),lt=de.isTileAffectedByFog(Qe),dt=de.getOrCreateProgram("elevatedStructuresDepth",{config:Xe,overrideFog:lt}),kt=Ne.calculateShadowPassMatrixFromTile(at.tileID.toUnwrapped());de.uploadCommonUniforms(de.context,dt,Qe.toUnwrapped());const Dt={u_matrix:kt,u_depth_bias:.001};dt.draw(de,Te.TRIANGLES,Ne.getShadowPassDepthMode(),Pr.disabled,Ne.getShadowPassColorMode(),wr.disabled,Dt,ge.id,it.vertexBuffer,it.indexBuffer,it.shadowCasterSegments,ge.paint,de.transform.zoom,Xe)}}(Z)},"fill-extrusion":function(p,n,u,g){const _=u.paint.get("fill-extrusion-opacity"),w=p.context,S=w.gl,L=p.terrain,M=L&&L.renderingToTexture;if(_===0)return;const V=p.conflationActive&&p.style.isLayerClipped(u,n.getSource()),Y=p.style.order.indexOf(u.fqid);if(V&&function(J,Z,te,de,ue){for(const ge of de){const _e=Z.getTile(ge).getBucket(te);_e&&(_e.updateReplacement(ge,J.replacementSource,ue),_e.uploadCentroid(J.context))}}(p,n,u,g,Y),L||V)for(const J of g){const Z=n.getTile(J).getBucket(u);Z&&Zi(p.context,n,J,Z,u,L,V)}if(p.renderPass==="shadow"&&p.shadowRenderer){const J=p.shadowRenderer;if(L&&_<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.ab)return;const Z=J.getShadowPassDepthMode(),te=J.getShadowPassColorMode();Qa(p,n,u,g,Z,Pr.disabled,te,V)}else if(p.renderPass==="translucent"){const J=!u.paint.get("fill-extrusion-pattern").constantOr(1),Z=u.paint.get("fill-extrusion-color").constantOr(r.am.white);if(!M&&Z.a!==0){const te=new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D);_===1&&J?Qa(p,n,u,g,te,Pr.disabled,Wr.unblended,V):(Qa(p,n,u,g,te,Pr.disabled,Wr.disabled,V),Qa(p,n,u,g,te,p.stencilModeFor3D(),p.colorModeForRenderPass(),V),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&J&&(!L&&p.transform.projection.name!=="globe"||M)){const te=u.paint.get("fill-extrusion-opacity"),de=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ue=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ge=u.paint.get("fill-extrusion-flood-light-intensity"),_e=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(_e?null:u.lut).toArray01().slice(0,3),Ne=de>0&&ue>0,Qe=ge>0,at=(it,Xe,lt)=>(1-lt)*it+lt*Xe,st=it=>{const Xe=p.depthModeForSublayer(1,ji.ReadOnly,S.LEQUAL,!0),lt=u.paint.get(it?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),dt=at(.1,3,lt),kt=p._showOverdrawInspector;if(!kt){const Dt=new Pr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),ti=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0],S.MIN);Va(p,n,u,g,Xe,Dt,ti,wr.disabled,it,"sdf",te,de,ue,ge,Te,dt,V,!1)}{const Dt=kt?Pr.disabled:new Pr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),ti=kt?p.colorModeForRenderPass():new Wr([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],r.am.transparent,[!0,!0,!0,!0]);Va(p,n,u,g,Xe,Dt,ti,wr.disabled,it,"color",te,de,ue,ge,Te,dt,V,!1)}};if(M){const it=(Xe,lt,dt)=>{const kt=p.depthModeForSublayer(1,ji.ReadOnly,S.LEQUAL,!1),Dt=u.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ti=at(.1,3,Dt);{const ri=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0]);Va(p,n,u,g,kt,Pr.disabled,ri,wr.disabled,Xe,"clear",te,de,ue,ge,Te,ti,V,lt)}{const ri=new Pr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),vi=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0],S.MIN);Va(p,n,u,g,kt,ri,vi,wr.disabled,Xe,"sdf",te,de,ue,ge,Te,ti,V,lt)}{const ri=Xe?S.ZERO:S.ONE_MINUS_DST_ALPHA,vi=new Pr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),Mt=new Wr([ri,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],r.am.transparent,[!0,!0,!0,!0]);Va(p,n,u,g,kt,vi,Mt,wr.disabled,Xe,"color",te,de,ue,ge,Te,ti,V,lt)}{const ri=new Wr([S.ONE,S.ONE,S.ONE,Xe?S.ZERO:S.ONE],r.am.transparent,[!1,!1,!1,!0],Xe?S.FUNC_ADD:S.MAX);Va(p,n,u,g,kt,Pr.disabled,ri,wr.disabled,Xe,"clear",te,de,ue,ge,Te,ti,V,lt,dt)}};if(Ne||Qe){let Xe;if(p.prepareDrawTile(),L){const lt=L.drapeBufferSize[0],dt=L.drapeBufferSize[1];Xe=L.framebufferCopyTexture,Xe&&(!Xe||Xe.size[0]===lt&&Xe.size[1]===dt)||(Xe&&Xe.destroy(),Xe=L.framebufferCopyTexture=new r.T(w,new r.r({width:lt,height:dt}),S.RGBA8)),Xe.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,lt,dt)}Ne&&it(!0,!1,Xe),Qe&&it(!1,!0,Xe)}}else Ne&&st(!0),Qe&&st(!1),(Ne||Qe)&&p.resetStencilClippingMasks()}}},building:function(p,n,u,g){},hillshade:function(p,n,u,g){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const _=p.context,w=p.terrain&&p.terrain.renderingToTexture,[S,L]=p.renderPass!=="translucent"||w?[{},g]:p.stencilConfigForOverlap(g);for(const M of L){const V=n.getTile(M);if(V.needsHillshadePrepare&&p.renderPass==="offscreen")gh(p,V,u);else if(p.renderPass==="translucent"){const Y=p.depthModeForSublayer(0,ji.ReadOnly),J=u.paint.get("hillshade-emissive-strength"),Z=p.colorModeForDrapableLayerRenderPass(J),te=w&&p.terrain?p.terrain.stencilModeForRTTOverlap(M):S[M.overscaledZ];eA(p,M,V,u,Y,te,Z)}}_.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,n,u,g,_,w){if(p.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const S=p.transform.projection.name==="globe",L=u.paint.get("raster-elevation")!==0,M=L&&S;if(p.renderElevatedRasterBackface&&!M)return;const V=p.context,Y=V.gl,J=n.getSource(),Z=function(st,it,Xe,lt){const dt=it.paint.get("raster-color"),kt=st.type==="raster-array",Dt=[],ti=it.paint.get("raster-resampling"),ri=it.paint.get("raster-color-mix");let vi=it.paint.get("raster-color-range");const Mt=[ri[0],ri[1],ri[2],0],Vt=ri[3];let wt=ti==="nearest"?lt.NEAREST:lt.LINEAR;if(kt&&(Dt.push("RASTER_ARRAY"),dt||Dt.push("RASTER_COLOR"),ti==="linear"&&Dt.push("RASTER_ARRAY_LINEAR"),wt=lt.NEAREST,!vi&&st.rasterLayers)){const oi=st.rasterLayers.find(({id:zt})=>zt===it.sourceLayer);oi&&oi.fields&&oi.fields.range&&(vi=oi.fields.range)}if(vi=vi||[0,1],dt){Dt.push("RASTER_COLOR"),Xe.activeTexture.set(lt.TEXTURE2),it.updateColorRamp(vi);let oi=it.colorRampTexture;oi||(oi=it.colorRampTexture=new r.T(Xe,it.colorRamp,lt.RGBA8)),oi.bind(lt.LINEAR,lt.CLAMP_TO_EDGE)}return{mix:Mt,range:vi,offset:Vt,defines:Dt,resampling:wt}}(J,u,V,Y);if(J instanceof r.aP&&!g.length&&!S)return;const te=u.paint.get("raster-emissive-strength"),de=p.colorModeForDrapableLayerRenderPass(te),ue=p.terrain&&p.terrain.renderingToTexture,ge=!p.options.moving,_e=u.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(J instanceof r.aP&&!g.length&&(J.onNorthPole||J.onSouthPole)){const st=L?p.stencilModeFor3D():Pr.disabled;return void Qu(!!J.onNorthPole,null,p,n,u,te,Z,wr.disabled,st)}if(!g.length)return;const[Te,Ne]=J instanceof r.aP||ue?[{},g]:p.stencilConfigForOverlap(g),Qe=Ne[Ne.length-1].overscaledZ;M&&Z.defines.push("PROJECTION_GLOBE_VIEW"),L&&Z.defines.push("RENDER_CUTOFF");const at=(st,it,Xe)=>{for(const lt of st){const dt=lt.toUnwrapped(),kt=n.getTile(lt);if(ue&&(!kt||!kt.hasData()))continue;V.activeTexture.set(Y.TEXTURE0);const Dt=pd(kt,J,u,Z);if(!Dt||!Dt.texture)continue;const{texture:ti,mix:ri,offset:vi,tileSize:Mt,buffer:Vt}=Dt;let wt,oi;ue?(wt=ji.disabled,oi=lt.projMatrix):L?(wt=new ji(Y.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),oi=S?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(dt,ge)):(wt=p.depthModeForSublayer(lt.overscaledZ-Qe,u.paint.get("raster-opacity")===1?ji.ReadWrite:ji.ReadOnly,Y.LESS),oi=p.transform.calculateProjMatrix(dt,ge));const zt=p.terrain&&ue?p.terrain.stencilModeForRTTOverlap(lt):Te[lt.overscaledZ],mi=w?0:u.paint.get("raster-fade-duration");kt.registerFadeDuration(mi);const Li=n.findLoadedParent(lt,0),ai=Hu(kt,Li,n,p.transform,mi);let Mi,ir;p.terrain&&p.terrain.prepareDrawTile(),V.activeTexture.set(Y.TEXTURE0),ti.bind(_e,Y.CLAMP_TO_EDGE),V.activeTexture.set(Y.TEXTURE1),Li?(Li.texture&&Li.texture.bind(_e,Y.CLAMP_TO_EDGE),Mi=Math.pow(2,Li.tileID.overscaledZ-kt.tileID.overscaledZ),ir=[kt.tileID.canonical.x*Mi%1,kt.tileID.canonical.y*Mi%1]):ti.bind(_e,Y.CLAMP_TO_EDGE),"useMipmap"in ti&&V.extTextureFilterAnisotropic&&p.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const tr=p.transform;let Ki;const pr=L?fd(tr):[0,0,0,0];let gr,Cr,Hr,sn,Yn,xs=0;if(M&&J instanceof r.aP&&J.coordinates.length>3)gr=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0)))),Cr=Float32Array.from(tr.globeMatrix),Hr=Float32Array.from(r.dm(tr)),sn=[r.aD(tr.center.lng),r.aH(tr.center.lat)],Ki=J.elevatedGlobePerspectiveTransform,Yn=J.elevatedGlobeGridMatrix||new Float32Array(9);else if(M){const Jr=r.dn(lt.canonical);xs=r.dp(Jr.getCenter().lat),gr=Float32Array.from(r.bh(r.dr(lt.canonical))),Cr=Float32Array.from(tr.globeMatrix),Hr=Float32Array.from(r.dm(tr)),sn=[r.aD(tr.center.lng),r.aH(tr.center.lat)],Ki=[0,0],Yn=Float32Array.from(r.dq(lt.canonical,Jr,xs,tr.worldSize/tr._pixelsPerMercatorPixel))}else Ki=J instanceof r.aP?J.perspectiveTransform:[0,0],gr=new Float32Array(16),Cr=new Float32Array(9),Hr=new Float32Array(16),sn=[0,0],Yn=new Float32Array(9);const es=Ni(oi,gr,Cr,Hr,Yn,ir||[0,0],r.ah(p.transform.zoom),sn,pr,Mi||1,ai,u,Ki,L?u.paint.get("raster-elevation"):0,2,ri,vi,Z.range,Mt,Vt,te),is=p.isTileAffectedByFog(lt),uo=p.getOrCreateProgram("raster",{defines:Z.defines,overrideFog:is});if(p.uploadCommonUniforms(V,uo,dt),J instanceof r.aP){const Jr=J.elevatedGlobeVertexBuffer,ln=J.elevatedGlobeIndexBuffer;if(ue||!S)J.boundsBuffer&&J.boundsSegments&&uo.draw(p,Y.TRIANGLES,wt,Pr.disabled,de,wr.disabled,es,u.id,J.boundsBuffer,p.quadTriangleIndexBuffer,J.boundsSegments);else if(Jr&&ln){const yn=tr.zoom<=r.cL?J.elevatedGlobeSegments:J.getSegmentsForLongitude(tr.center.lng);yn&&uo.draw(p,Y.TRIANGLES,wt,Pr.disabled,de,it,es,u.id,Jr,ln,yn)}}else if(M){wt=new ji(Y.LEQUAL,ji.ReadOnly,p.depthRangeFor3D);const Jr=p.globeSharedBuffers;if(Jr){const[ln,yn,Ps]=Jr.getGridBuffers(xs,!1);uo.draw(p,Y.TRIANGLES,wt,Xe||zt,p.colorModeForRenderPass(),it,es,u.id,ln,yn,Ps)}}else{const{tileBoundsBuffer:Jr,tileBoundsIndexBuffer:ln,tileBoundsSegments:yn}=p.getTileBoundsBuffers(kt);uo.draw(p,Y.TRIANGLES,wt,zt,de,wr.disabled,es,u.id,Jr,ln,yn)}}if(!(J instanceof r.aP)&&M)for(const lt of st){const dt=lt.canonical.y===(1<<lt.canonical.z)-1;lt.canonical.y===0&&Qu(!0,lt,p,n,u,te,Z,it,Xe||Pr.disabled),dt&&Qu(!1,lt,p,n,u,te,Z,it===wr.frontCW?wr.backCW:wr.frontCW,Xe||Pr.disabled)}};M?at(Ne,p.renderElevatedRasterBackface?wr.backCW:wr.frontCW,p.stencilModeFor3D()):at(Ne,wr.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,n,u,g,_,w){p.renderPass==="offscreen"&&function(S,L,M,V){if(!V.length)return;const Y=S.context,J=Y.gl,Z=L.getSource();if(!(Z instanceof pc))return;const te=Math.ceil(Math.sqrt(M.paint.get("raster-particle-count")));let de=M.particlePositionRGBAImage;if(!de||de.width!==te){const Ne=function(Qe){const at=Qe*Qe,st=new Uint8Array(4*at),it=function(lt){return lt|=0,lt=Math.imul(2747636419^lt,2654435769),lt=Math.imul(lt^lt>>>16,2654435769),((lt=Math.imul(lt^lt>>>16,2654435769))>>>0)/4294967296},Xe=1/1.1;for(let lt=0;lt<at;lt++){const dt=Xe*(it(2*lt+0)+ei),kt=Xe*(it(2*lt+1)+ei),Dt=255*dt%1,ti=255*kt%1,ri=Dt,vi=kt-ti/255,Mt=ti;st[4*lt+0]=255*(dt-Dt/255),st[4*lt+1]=255*ri,st[4*lt+2]=255*vi,st[4*lt+3]=255*Mt}return st}(te);de=M.particlePositionRGBAImage=new r.r({width:te,height:te},Ne)}let ue=M.particleFramebuffer;ue?ue.width!==te&&(ue.destroy(),ue=M.particleFramebuffer=Y.createFramebuffer(te,te,!0,null)):ue=M.particleFramebuffer=Y.createFramebuffer(te,te,!0,null);const ge=[];for(const Ne of V){const Qe=L.getTile(Ne);if(!(Qe instanceof ml))continue;const at=Yh(Qe,Z,M);if(!at)continue;const st=[Qe.tileSize,Qe.tileSize];let it=M.tileFramebuffer;it||(it=M.tileFramebuffer=Y.createFramebuffer(st[0],st[1],!0,null));let Xe=Qe.rasterParticleState;Xe||(Xe=Qe.rasterParticleState=new bh(Y,Ne,st,de));const lt=Xe.update(M.lastInvalidatedAt);Xe.particleTextureDimension!==te&&Xe.updateParticleTexture(Ne,de);const dt=Xe.targetColorTexture;Xe.targetColorTexture=Xe.backgroundColorTexture,Xe.backgroundColorTexture=dt;const kt=Xe.particleTexture0;Xe.particleTexture0=Xe.particleTexture1,Xe.particleTexture1=kt,ge.push([Ne,at,Xe,lt])}if(ge.length===0)return;const _e=r.q.now(),Te=M.previousDrawTimestamp?.001*(_e-M.previousDrawTimestamp):.0167;if(M.previousDrawTimestamp=_e,M.hasColorMap()){Y.activeTexture.set(J.TEXTURE0+2);let Ne=M.colorRampTexture;Ne||(Ne=M.colorRampTexture=new r.T(Y,M.colorRamp,J.RGBA8)),Ne.bind(J.LINEAR,J.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(M.tileFramebuffer.framebuffer),function(Ne,Qe,at){const st=Ne.context,it=st.gl,Xe=Qe.tileFramebuffer;st.activeTexture.set(it.TEXTURE0);const lt={u_texture:0,u_opacity:1.05*(kt=Qe.paint.get("raster-particle-fade-opacity-factor"))/(kt+.05)},dt=Ne.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var kt;for(const Dt of at){const[,,ti,ri]=Dt;Xe.colorAttachment.set(ti.targetColorTexture.texture),st.viewport.set([0,0,Xe.width,Xe.height]),st.clear({color:r.am.transparent}),ri&&(ti.backgroundColorTexture.bind(it.NEAREST,it.CLAMP_TO_EDGE),dt.draw(Ne,it.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,lt,Qe.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments))}}(S,M,ge),function(Ne,Qe,at,st){const it=Ne.context,Xe=it.gl,lt=at.tileFramebuffer,dt=Ne.transform.projection.name==="globe",kt=at.paint.get("raster-particle-max-speed");for(const Dt of st){const[ti,ri,vi]=Dt;it.activeTexture.set(Xe.TEXTURE0+0),ri.texture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),lt.colorAttachment.set(vi.targetColorTexture.texture);const Mt=Ne.getOrCreateProgram("rasterParticleDraw",{defines:ri.defines,overrideFog:!1});it.activeTexture.set(Xe.TEXTURE0+1);const Vt=ri.scalarData?[]:[0,1,2,3].map(zt=>r.dT[zt](ti));Vt.push(ti);const wt=ti.canonical.x,oi=ti.canonical.y;for(const zt of Vt){const mi=Qe.getTile(dt?zt.wrapped():zt);if(!mi)continue;const Li=mi.rasterParticleState;if(!Li)continue;const ai=zt.canonical.x+(1<<zt.canonical.z)*(zt.wrap-ti.wrap),Mi=zt.canonical.y;Li.particleTexture0.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE);const ir=lr(1,Li.particleTexture0.size[0],[ai-wt,Mi-oi],0,ri.texture.size,2,kt,ri.textureOffset,ri.scale,ri.offset);Mt.draw(Ne,Xe.POINTS,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,ir,at.id,Li.particleIndexBuffer,void 0,Li.particleSegment)}}}(S,L,M,ge),Y.bindFramebuffer.set(M.particleFramebuffer.framebuffer),function(Ne,Qe,at,st){const it=Ne.context,Xe=it.gl,lt=Qe.paint.get("raster-particle-max-speed"),dt=st*Qe.paint.get("raster-particle-speed-factor")*.15,kt=function(ti){return Math.pow(ti,6)}(.01+1*Qe.paint.get("raster-particle-reset-rate-factor")),Dt=Qe.particleFramebuffer;it.viewport.set([0,0,Dt.width,Dt.height]);for(const ti of at){const[,ri,vi]=ti;it.activeTexture.set(Xe.TEXTURE0+0),ri.texture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),it.activeTexture.set(Xe.TEXTURE0+1);const Mt=vi.particleTexture0;Mt.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE);const Vt=$i(1,Mt.size[0],0,ri.texture.size,lt,dt,kt,ri.textureOffset,ri.scale,ri.offset);Dt.colorAttachment.set(vi.particleTexture1.texture),it.clear({color:r.am.transparent}),Ne.getOrCreateProgram("rasterParticleUpdate",{defines:ri.defines}).draw(Ne,Xe.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.disabled,Vt,Qe.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments)}}(S,M,ge,Te)}(p,n,u,g),p.renderPass==="translucent"&&(function(S,L,M,V,Y){const J=S.context,Z=J.gl,te=L.getSource().tileSize,de=5*(1-r.af(r.cx,r.cx+1,S.transform.zoom))*te+M.paint.get("raster-particle-elevation"),ue=!S.options.moving,ge=S.transform.projection.name==="globe";if(!V.length)return;const[_e,Te]=S.stencilConfigForOverlap(V),Ne=[];ge&&Ne.push("PROJECTION_GLOBE_VIEW");const Qe=S.stencilModeFor3D();for(const at of Te){const st=at.toUnwrapped(),it=L.getTile(at);if(!it.rasterParticleState)continue;const Xe=it.rasterParticleState,lt=100;it.registerFadeDuration(lt);const dt=L.findLoadedParent(at,0),kt=Hu(it,dt,L,S.transform,lt);let Dt,ti;S.terrain&&S.terrain.prepareDrawTile(),J.activeTexture.set(Z.TEXTURE0),Xe.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),J.activeTexture.set(Z.TEXTURE1),dt&&dt.rasterParticleState?(dt.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Dt=Math.pow(2,dt.tileID.overscaledZ-it.tileID.overscaledZ),ti=[it.tileID.canonical.x*Dt%1,it.tileID.canonical.y*Dt%1]):Xe.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const ri=ge?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(st,ue),vi=S.transform,Mt=fA(vi),Vt=r.dn(at.canonical),wt=r.dp(Vt.getCenter().lat);let oi,zt,mi,Li,ai;ge?(oi=Float32Array.from(r.bh(r.dr(at.canonical))),zt=Float32Array.from(vi.globeMatrix),mi=Float32Array.from(r.dm(vi)),Li=[r.aD(vi.center.lng),r.aH(vi.center.lat)],ai=Float32Array.from(r.dq(at.canonical,Vt,wt,vi.worldSize/vi._pixelsPerMercatorPixel))):(oi=new Float32Array(16),zt=new Float32Array(9),mi=new Float32Array(16),Li=[0,0],ai=new Float32Array(9));const Mi=qi(ri,oi,zt,mi,ai,ti||[0,0],r.ah(S.transform.zoom),Li,Mt,Dt||1,kt,de),ir=S.isTileAffectedByFog(at),tr=S.getOrCreateProgram("rasterParticle",{defines:Ne,overrideFog:ir});if(S.uploadCommonUniforms(J,tr,st),ge){const Ki=new ji(Z.LEQUAL,ji.ReadOnly,S.depthRangeFor3D),pr=0,gr=S.globeSharedBuffers;if(gr){const[Cr,Hr,sn]=gr.getGridBuffers(wt,pr!==0);tr.draw(S,Z.TRIANGLES,Ki,Qe,Wr.alphaBlended,S.renderElevatedRasterBackface?wr.frontCCW:wr.backCCW,Mi,M.id,Cr,Hr,sn)}}else{const Ki=S.depthModeForSublayer(0,ji.ReadOnly),pr=_e[at.overscaledZ],{tileBoundsBuffer:gr,tileBoundsIndexBuffer:Cr,tileBoundsSegments:Hr}=S.getTileBoundsBuffers(it);tr.draw(S,Z.TRIANGLES,Ki,pr,Wr.alphaBlended,wr.disabled,Mi,M.id,gr,Cr,Hr)}}S.resetStencilClippingMasks()}(p,n,u,g),p.style.map.triggerRepaint())},background:function(p,n,u,g){const _=u.paint.get("background-color"),w=u.paint.get("background-color-use-theme").constantOr("default")==="none",S=u.paint.get("background-opacity"),L=u.paint.get("background-emissive-strength"),M=u.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const V=p.context,Y=V.gl,J=p.transform,Z=J.tileSize,te=u.paint.get("background-pattern");let de;if(te!==void 0&&(te===null||(de=p.imageManager.getPattern(r.I.from(te.toString()),u.scope,p.style.getLut(u.scope)),!de)))return;const ue=!te&&_.a===1&&S===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==ue)return;const ge=Pr.disabled,_e=p.depthModeForSublayer(0,ue==="opaque"?ji.ReadWrite:ji.ReadOnly),Te=p.colorModeForDrapableLayerRenderPass(L),Ne=te?"backgroundPattern":"background";let Qe,at=g;if(at||(Qe=p.getBackgroundTiles(),at=Object.values(Qe).map(st=>st.tileID)),te&&(V.activeTexture.set(Y.TEXTURE0),p.imageManager.bind(p.context,u.scope)),M){const st=p.getOrCreateProgram(Ne,{overrideFog:!1,overrideRtt:!0}),it=new Float32Array(r.bx([])),Xe=new r.aM(0,0,0,0,0),lt=te?zr(it,L,S,p,0,u.scope,de,M,{tileID:Xe,tileSize:Z}):bn(it,L,S,_.toPremultipliedRenderColor(w?null:u.lut));st.draw(p,Y.TRIANGLES,_e,ge,Te,wr.disabled,lt,u.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const st of at){const it=p.isTileAffectedByFog(st),Xe=p.getOrCreateProgram(Ne,{overrideFog:it}),lt=st.toUnwrapped(),dt=g?st.projMatrix:p.transform.calculateProjMatrix(lt);p.prepareDrawTile();const kt=n?n.getTile(st):Qe?Qe[st.key]:new cu(st,Z,J.zoom,p),Dt=te?zr(dt,L,S,p,0,u.scope,de,M,{tileID:st,tileSize:Z}):bn(dt,L,S,_.toPremultipliedRenderColor(w?null:u.lut));p.uploadCommonUniforms(V,Xe,lt);const{tileBoundsBuffer:ti,tileBoundsIndexBuffer:ri,tileBoundsSegments:vi}=p.getTileBoundsBuffers(kt);Xe.draw(p,Y.TRIANGLES,_e,ge,Te,wr.disabled,Dt,u.id,ti,ri,vi)}},sky:function(p,n,u){const g=p._atmosphere?r.ah(p.transform.zoom):1,_=u.paint.get("sky-opacity")*g;if(_===0)return;const w=p.context,S=u.paint.get("sky-type"),L=new ji(w.gl.LEQUAL,ji.ReadOnly,[0,1]),M=p.frameCounter/1e3%1;S==="atmosphere"?p.renderPass==="offscreen"?u.needsSkyboxCapture(p)&&(function(V,Y,J,Z){const te=V.context,de=te.gl;let ue=Y.skyboxFbo;if(!ue){ue=Y.skyboxFbo=te.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new Ch(te),Y.skyboxTexture=te.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,Y.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let Ne=0;Ne<6;++Ne)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(ue.framebuffer),te.viewport.set([0,0,32,32]);const ge=Y.getCenter(V,!0),_e=V.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);r.bx(Te),r.e3(Te,Te,.5*-Math.PI),oc(V,Y,_e,Te,ge,0),r.bx(Te),r.e3(Te,Te,.5*Math.PI),oc(V,Y,_e,Te,ge,1),r.bx(Te),r.cG(Te,Te,.5*-Math.PI),oc(V,Y,_e,Te,ge,2),r.bx(Te),r.cG(Te,Te,.5*Math.PI),oc(V,Y,_e,Te,ge,3),r.bx(Te),oc(V,Y,_e,Te,ge,4),r.bx(Te),r.e3(Te,Te,Math.PI),oc(V,Y,_e,Te,ge,5),te.viewport.set([0,0,V.width,V.height])}(p,u),u.markSkyboxValid(p)):p.renderPass==="sky"&&function(V,Y,J,Z,te){const de=V.context,ue=de.gl,ge=V.transform,_e=V.getOrCreateProgram("skybox");de.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Te=((Ne,Qe,at,st,it)=>({u_matrix:Ne,u_sun_direction:Qe,u_cubemap:0,u_opacity:st,u_temporal_offset:it}))(ge.skyboxMatrix,Y.getCenter(V,!1),0,Z,te);V.uploadCommonUniforms(de,_e),_e.draw(V,ue.TRIANGLES,J,Pr.disabled,V.colorModeForRenderPass(),wr.backCW,Te,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(p,u,L,_,M):S==="gradient"&&p.renderPass==="sky"&&function(V,Y,J,Z,te){const de=V.context,ue=de.gl,ge=V.transform,_e=V.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new Ch(de)),de.activeTexture.set(ue.TEXTURE0);let Te=Y.colorRampTexture;Te||(Te=Y.colorRampTexture=new r.T(de,Y.colorRamp,ue.RGBA8)),Te.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const Ne=((Qe,at,st,it,Xe)=>({u_matrix:Qe,u_color_ramp:0,u_center_direction:at,u_radius:r.al(st),u_opacity:it,u_temporal_offset:Xe}))(ge.skyboxMatrix,Y.getCenter(V,!1),Y.paint.get("sky-gradient-radius"),Z,te);V.uploadCommonUniforms(de,_e),_e.draw(V,ue.TRIANGLES,J,Pr.disabled,V.colorModeForRenderPass(),wr.backCW,Ne,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(p,u,L,_,M)},custom:function(p,n,u,g){const _=p.context,w=u.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&u.isDraped(n)){if(p.renderPass==="offscreen"){const S=w.prerender;if(S){if(p.setCustomLayerDefaults(),_.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const L=p.transform.pointMerc;S.call(w,_.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),r.ah(p.transform.zoom),[L.x,L.y],p.transform.pixelsPerMeterRatio)}else S.call(w,_.gl,p.transform.customLayerMatrix());_.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const L=w.renderToTile;if(L){const M=g[0].canonical,V={x:M.x+g[0].wrap*(w.wrapTileId?0:1<<M.z),y:M.y,z:M.z};_.setDepthMode(ji.disabled),_.setStencilMode(Pr.disabled),_.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),L.call(w,_.gl,V),_.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),_.setColorMode(p.colorModeForRenderPass()),_.setStencilMode(Pr.disabled);const S=w.renderingMode==="3d"?new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,ji.ReadOnly);if(_.setDepthMode(S),p.transform.projection.name==="globe"){const L=p.transform.pointMerc;w.render(_.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),r.ah(p.transform.zoom),[L.x,L.y],p.transform.pixelsPerMeterRatio)}else w.render(_.gl,p.transform.customLayerMatrix());_.setDirty(),p.setBaseState(),_.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,n,u,g){if(p.renderPass==="opaque")return;const _=u.paint.get("model-opacity").constantOr(1);if(_===0)return;const w=u.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!w||p.terrain&&_<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof r.ab))return;const S=p.shadowRenderer,L=u.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,L||(S.enabled=!1));const M=()=>{S&&(S.useNormalOffset=!0,L||(S.enabled=!0))},V=n.getSource();if(p.renderPass==="light-beam"&&V.type!=="batched-model")return;if(V.type==="vector"||V.type==="geojson")return function(_e,Te,Ne,Qe,at){const st=_e.transform;if(st.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${st.projection.name} projection is not yet implemented`);const it=st.getFreeCameraOptions().position;if(!_e.modelManager)return;const Xe=_e.modelManager;Ne.modelManager=Xe;const lt=_e.shadowRenderer;if(!Ne._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const dt=Ne._unevaluatedLayout._values["model-id"],kt=Object.assign({},Ne.layout.get("model-id").parameters),Dt=_e.style.order.indexOf(Ne.fqid);for(const ti of Qe){const ri=Te.getTile(ti).getBucket(Ne);if(!ri||ri.projection.name!==st.projection.name)continue;const vi=ri.getModelUris();vi&&!ri.modelsRequested&&(Xe.addModelsFromBucket(vi,at),ri.modelsRequested=!0);const Mt=vd(ti,st);kt.zoom=Mt;const Vt=dt.possiblyEvaluate(kt);if(Ft(_e,ri,ti),ac.shadowUniformsInitialized=!1,ac.useSingleShadowCascade=!!lt&&lt.getMaxCascadeForTile(ti.toUnwrapped())===0,_e.renderPass==="shadow"&&lt){if(_e.currentShadowCascade===1&&ri.isInsideFirstShadowMapFrustum)continue;const zt=st.calculatePosMatrix(ti.toUnwrapped(),st.worldSize);if(ac.tileMatrix.set(zt),ac.shadowTileMatrix=Float32Array.from(lt.calculateShadowPassMatrixFromMatrix(zt)),ac.aabb.min.fill(0),ac.aabb.max[0]=ac.aabb.max[1]=r.aj,ac.aabb.max[2]=0,Wu(ri,ac,_e,Ne.scope))continue}const wt=1<<ti.canonical.z,oi=[((it.x-ti.wrap)*wt-ti.canonical.x)*r.aj,(it.y*wt-ti.canonical.y)*r.aj,it.z*wt*r.aj];_e.conflationActive&&Object.keys(ri.instancesPerModel).length>0&&_e.style.isLayerClipped(Ne,Te.getSource())&&ri.updateReplacement(ti,_e.replacementSource,Dt,at)&&(ri.uploaded=!1,ri.upload(_e.context));for(let zt in ri.instancesPerModel){const mi=ri.instancesPerModel[zt];mi.features.length>0&&(zt=Vt.evaluate(mi.features[0].feature,{}));const Li=Xe.getModel(zt,at);if(Li||Xe.hasURLBeenRequested(zt)||ri.modelUris.includes(zt)||(ri.modelUris.push(zt),ri.modelsRequested=!1),Li&&Li.uploaded)for(const ai of Li.nodes)yA(_e,Ne,ai,mi,oi,ti,ac)}}}(p,n,u,g,V.type==="vector"?u.scope:""),void M();if(!V.loaded())return;if(V.type==="batched-model")return function(_e,Te,Ne,Qe){Ne.resetLayerRenderingStats(_e);const at=_e.context,st=_e.transform,it=_e.style.fog,Xe=_e.shadowRenderer;if(st.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${st.projection.name} projection is not yet implemented`);const lt=_e.transform.getFreeCameraOptions().position,dt=r.bY([],[lt.x,lt.y,lt.z],_e.transform.worldSize),kt=r.eb([],dt),Dt=r.bx([]),ti=r.ec(st.center.lat,st.zoom),ri=r.bn([],[1,1,1/ti]);r.bo(Dt,Dt,kt);const vi=Ne.paint.get("model-opacity").constantOr(1),Mt=new ji(at.gl.LEQUAL,ji.ReadWrite,_e.depthRangeFor3D),Vt=new ji(at.gl.LEQUAL,ji.ReadOnly,_e.depthRangeFor3D),wt=new r.cW([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),oi=_e.renderPass==="shadow",zt=oi&&Xe?Xe.getCurrentCascadeFrustum():st.getFrustum(st.scaleZoom(st.worldSize)),mi=Ne.paint.get("model-front-cutoff"),Li=mi[2]<1,ai=al(_e,Ne.paint.get("model-cutoff-fade-range")),Mi=Ne.getLayerRenderingStats();(function(ir,tr,Ki,pr){const gr=ir.terrain?ir.terrain.exaggeration():0,Cr=ir.transform.zoom;for(const Hr of pr){const sn=tr.getTile(Hr).getBucket(Ki);sn&&(sn.setFilter(Ki.filter),ir.conflationActive&&sn.updateReplacement(Hr,ir.replacementSource),sn.evaluateTransform(ir,Ki),ir.terrain&&gr>0&&sn.elevationUpdate(ir.terrain,gr,Hr,Ki.source),sn.needsReEvaluation(ir,Cr,Ki)&&sn.evaluate(Ki))}})(_e,Te,Ne,Qe),function(){let ir,tr,Ki;Li?(ir=Qe.length-1,tr=-1,Ki=-1):(ir=0,tr=Qe.length,Ki=1);const pr=new Float64Array(16),gr=r.ef(),Cr=new r.P(0,0);for(let Hr=ir;Hr!==tr;Hr+=Ki){const sn=Qe[Hr],Yn=Te.getTile(sn).getBucket(Ne);if(!Yn||!Yn.uploaded)continue;let xs=!1;Xe&&(xs=Xe.getMaxCascadeForTile(sn.toUnwrapped())===0);const es=st.calculatePosMatrix(sn.toUnwrapped(),st.worldSize),is=Yn.modelTraits;!oi&&Li&&(r.bi(pr,es),r.ad(gr,dt,pr),Cr.x=gr[0],Cr.y=gr[1]);const uo=[];Yn.setFilter(Ne.filter);for(const Jr of Yn.getNodesInfo()){if(Jr.hiddenByReplacement||!Jr.node.meshes)continue;const ln=Jr.node;let yn=0;_e.terrain&&ln.elevation&&(yn=ln.elevation*_e.terrain.exaggeration());const Ps=(()=>{const W=Jr.aabb;return wt.min=[...W.min],wt.max=[...W.max],wt.min[2]+=yn,wt.max[2]+=yn,r.ad(wt.min,wt.min,es),r.ad(wt.max,wt.max,es),wt})(),Qo=Jr.evaluatedScale;if(Qo[0]<=1&&Qo[1]<=1&&Qo[2]<=1&&Ps.intersects(zt)===0)continue;if(!oi&&Li){const W=.16666666666666666;Jr.cameraCollisionOpacity=dt[0]>Ps.min[0]&&dt[0]<Ps.max[0]&&dt[1]>Ps.min[1]&&dt[1]<Ps.max[1]&&dt[2]*ti<Ps.max[2]&&ln.footprint&&r.bS(Cr,ln.footprint)?Math.max(Jr.cameraCollisionOpacity-W,0):Math.min(1,Jr.cameraCollisionOpacity+W)}const Es=[...es],Hn=1/r.cU(sn.canonical),to=ln.anchor?ln.anchor[0]:0,Fn=ln.anchor?ln.anchor[1]:0;r.bo(Es,Es,[to*(Qo[0]-1)+Jr.evaluatedTranslation[0]*Hn,Fn*(Qo[1]-1)+Jr.evaluatedTranslation[1]*Hn,yn+Jr.evaluatedTranslation[2]]),r.ci(Qo,r.eg)||r.cE(Es,Es,Qo);const Io=r.az([],Es,ln.matrix),ks=r.az([],st.expandedFarZProjMatrix,Io),N=r.az([],st.expandedFarZProjMatrix,Es),O=r.aA([],[to,Fn,yn,1],ks)[2];ln.hidden=!1;let X=vi;oi||(Li&&(X*=Jr.cameraCollisionOpacity,X*=Su(Es,st,Jr.aabb,mi)),X*=Df(ai,O)),X!==0?uo.push({nodeInfo:Jr,depth:O,opacity:X,wvpForNode:ks,wvpForTile:N,nodeModelMatrix:Io,tileModelMatrix:Es}):ln.hidden=!0}oi||uo.sort((Jr,ln)=>!Li||Jr.opacity===1&&ln.opacity===1?Jr.depth<ln.depth?-1:1:Jr.opacity===1?-1:ln.opacity===1?1:Jr.depth>ln.depth?-1:1);for(const Jr of uo){const ln=Jr.nodeInfo,yn=ln.node;let Ps=r.az([],ri,Jr.tileModelMatrix);r.az(Ps,Dt,Ps);const Qo=r.bi([],Ps);r.ee(Qo,Qo),r.cE(Qo,Qo,vA),Ps=r.az(Ps,Ps,yn.matrix);const Es=_e.renderPass==="light-beam",Hn=Ne.paint.get("model-color-use-theme").constantOr("default")==="none",to=is&r.em.HasMapboxMeshFeatures,Fn=to?0:ln.evaluatedRMEA[0][2];for(let Io=0;Io<yn.meshes.length;++Io){const ks=yn.meshes[Io],N=Io===yn.lightMeshIndex;let O=Jr.wvpForNode;if(N){if(!Es&&!_e.terrain&&_e.shadowRenderer){_e.currentLayer<_e.firstLightBeamLayer&&(_e.firstLightBeamLayer=_e.currentLayer);continue}O=Jr.wvpForTile}else if(Es)continue;const X={defines:[]},W=[];if(!oi&&Xe&&(Xe.useNormalOffset=!!ks.normalBuffer),Ei(X.defines,W,ks,_e,Hn?null:Ne.lut),to||X.defines.push("DIFFUSE_SHADED"),xs&&X.defines.push("SHADOWS_SINGLE_CASCADE"),Mi&&(oi?Mi.numRenderedVerticesInShadowPass+=ks.vertexArray.length:Mi.numRenderedVerticesInTransparentPass+=ks.vertexArray.length),oi){Us(ks,Jr.nodeModelMatrix,_e,Ne);continue}let le=null;if(it){const si=$c(Jr.nodeModelMatrix,_e.transform);if(le=new Float32Array(si),st.projection.name!=="globe"){const gi=ks.aabb.min,Ui=ks.aabb.max,[Gr,vr]=it.getOpacityForBounds(si,gi[0],gi[1],Ui[0],Ui[1]);X.overrideFog=Gr>=Nt||vr>=Nt}}const we=ks.material;let Re;we.occlusionTexture&&we.occlusionTexture.offsetScale&&(Re=we.occlusionTexture.offsetScale,X.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ft=_e.getOrCreateProgram("model",X);!oi&&Xe&&Xe.setupShadowsFromMatrix(Jr.tileModelMatrix,ft,Xe.useNormalOffset),_e.uploadCommonUniforms(at,ft,null,le);const At=we.pbrMetallicRoughness;At.metallicFactor=.9,At.roughnessFactor=.5;const Ht=Qs(new Float32Array(O),new Float32Array(Ps),new Float32Array(Qo),new Float32Array(yn.matrix),_e,Jr.opacity,At.baseColorFactor,we.emissiveFactor,At.metallicFactor,At.roughnessFactor,we,Fn,Ne,[0,0,0],Re);!N&&(ln.hasTranslucentParts||Jr.opacity<1)&&ft.draw(_e,at.gl.TRIANGLES,Mt,Pr.disabled,Wr.disabled,wr.backCCW,Ht,Ne.id,ks.vertexBuffer,ks.indexBuffer,ks.segments,Ne.paint,_e.transform.zoom,void 0,W),ft.draw(_e,at.gl.TRIANGLES,N?Vt:Mt,Pr.disabled,N||Jr.opacity<1||ln.hasTranslucentParts?Wr.alphaBlended:Wr.unblended,wr.backCCW,Ht,Ne.id,ks.vertexBuffer,ks.indexBuffer,ks.segments,Ne.paint,_e.transform.zoom,void 0,W)}}}}()}(p,n,u,g),void M();if(V.type!=="model")return;const Y=V.getModels(),J=[],Z=p.transform.getFreeCameraOptions().position,te=r.bY([],[Z.x,Z.y,Z.z],p.transform.worldSize);r.eb(te,te);const de=[],ue=[];let ge=0;for(const _e of Y){const Te=u.paint.get("model-rotation").constantOr(null),Ne=u.paint.get("model-scale").constantOr(null),Qe=u.paint.get("model-translation").constantOr(null);_e.computeModelMatrix(p,Te,Ne,Qe,!0,!0,!1);const at=r.bx([]),st=r.ec(_e.position.lat,p.transform.zoom),it=r.bn([],[1,1,1/st]);r.bo(at,at,te),J.push({zScaleMatrix:it,negCameraPosMatrix:at});for(const Xe of _e.nodes)Gu(p.transform,Xe,_e.matrix,p.transform.expandedFarZProjMatrix,ge,de,ue);ge++}if(de.sort((_e,Te)=>Te.depth-_e.depth),p.renderPass!=="shadow"){if(_===1)for(const _e of ue)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,p.colorModeForRenderPass());else{for(const _e of ue)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,Wr.disabled);for(const _e of ue)Gi(_e,p,u,J[_e.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const _e of de)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,p.colorModeForRenderPass());M()}else{for(const _e of ue)Us(_e.mesh,_e.nodeModelMatrix,p,u);for(const _e of de)Us(_e.mesh,_e.nodeModelMatrix,p,u);M()}}},Uf={line:function(p,n,u){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(n){const g=n.getVisibleCoordinates();for(const _ of g){const w=n.getTile(_).getBucket(p);if(w&&(w.elevationType!=="none"?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,n,u){const g=n.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,g.type==="vector"?p.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const _=g.getModels();for(const w of _)w.upload(u.context)},raster:function(p,n,u){const g=n.getSource();if(!(g instanceof pc&&g.loaded()))return;const _=p.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!_)return;const w=p.paint.get("raster-array-band")||g.getInitialBand(_);if(w==null)return;const S=n.getIds().map(L=>n.getTileByID(L));for(const L of S)L.updateNeeded(_,w)&&g.prepareTile(L,_,w)},"raster-particle":function(p,n,u){const g=n.getSource();if(!(g instanceof pc&&g.loaded()))return;const _=p.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!_)return;const w=p.paint.get("raster-particle-array-band")||g.getInitialBand(_);if(w==null)return;const S=n.getIds().map(L=>n.getTileByID(L));for(const L of S)L.updateNeeded(_,w)&&g.prepareTile(L,_,w)}},Yu={fill:sc},bd={fill:function(p,n,u,g){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const _=p.context.gl,w=new ji(_.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),S=new Pr({func:_.ALWAYS,mask:255},255,255,_.KEEP,_.KEEP,_.REPLACE),L=p.transform.getFreeCameraOptions().position,M=p.getOrCreateProgram("elevatedStructuresDepthReconstruct",{defines:["DEPTH_RECONSTRUCTION"]});for(const V of g){const Y=n.getTile(V),J=Y.getBucket(u);if(!J)continue;const Z=J.elevatedStructures;if(!Z||Z.maskSegments.segments[0].primitiveLength===0)continue;const te=Ha(V.toUnwrapped(),L),de=p.translatePosMatrix(V.projMatrix,Y,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),ue=ct(de,te,0,0,0);M.draw(p,_.TRIANGLES,w,S,Wr.disabled,wr.disabled,ue,u.id,Z.vertexBuffer,Z.indexBuffer,Z.maskSegments,u.paint,p.transform.zoom)}}};class _A{constructor(n,u,g,_,w,S){this.context=new Cl(n,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const L=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const V of L)this._debugParams.enabledLayers[V]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of L)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new Kh(w),this.setup(),this.numSublayers=Po.maxUnderzooming+Po.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Rl(this),this._wireframeDebugCache=new Ma,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const M=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,M,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=_,this.worldview=S}updateTerrain(n,u){const g=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dd(this,n));const _=this._terrain;this.transform.elevation=g?_:null,_.update(n,this.transform,u),this.transform.elevation&&!_.enabled&&(this.transform.elevation=null)}_updateFog(n){const u=n.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,_]=u.getFovAdjustedRange(this.transform._fov);if(g>_)return void(this.transform.fogCullDistSq=null);const w=g+.78*(_-g);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new dd(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,u){if(this.width=n*r.q.devicePixelRatio,this.height=u*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const n=this.context,u=new r.ba;u.emplaceBack(0,0),u.emplaceBack(r.aj,0),u.emplaceBack(0,r.aj),u.emplaceBack(r.aj,r.aj),this.tileExtentBuffer=n.createVertexBuffer(u,r.bc.members),this.tileExtentSegments=r.bd.simpleSegment(0,0,4,2);const g=new r.ba;g.emplaceBack(0,0),g.emplaceBack(r.aj,0),g.emplaceBack(0,r.aj),g.emplaceBack(r.aj,r.aj),this.debugBuffer=n.createVertexBuffer(g,r.bc.members),this.debugSegments=r.bd.simpleSegment(0,0,4,5);const _=new r.ba;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,r.bc.members),this.viewportSegments=r.bd.simpleSegment(0,0,4,2);const w=new r.aZ;w.emplaceBack(0,0,0,0),w.emplaceBack(r.aj,0,r.aj,0),w.emplaceBack(0,r.aj,0,r.aj),w.emplaceBack(r.aj,r.aj,r.aj,r.aj),this.mercatorBoundsBuffer=n.createVertexBuffer(w,r.bf.members),this.mercatorBoundsSegments=r.bd.simpleSegment(0,0,4,2);const S=new r.a_;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S);const L=new r.bb;for(const V of[0,1,3,2,0])L.emplaceBack(V);this.debugIndexBuffer=n.createIndexBuffer(L),this.emptyTexture=new r.T(n,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=r.bz();const M=this.context.gl;this.stencilClearMode=new Pr({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,ji.disabled,this.stencilClearMode,Wr.disabled,wr.disabled,vh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,u,g){if(!u||this.currentStencilSource===u.id||!n.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const M of g)if(this._tileClippingMaskIDs[M.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=u.id;const _=this.context,w=_.gl;this.nextStencilID+g.length>256&&this.clearStencil(),_.setColorMode(Wr.disabled),_.setDepthMode(ji.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of g){const M=u.getTile(L),V=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:J,tileBoundsSegments:Z}=this.getTileBoundsBuffers(M);S.draw(this,w.TRIANGLES,ji.disabled,new Pr({func:w.ALWAYS,mask:0},V,255,w.KEEP,w.KEEP,w.REPLACE),Wr.disabled,wr.disabled,vh(L.projMatrix),"$clipping",Y,J,Z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Pr({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const u=this.context.gl;return new Pr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(n){const u=this.context.gl,g=n.sort((S,L)=>L.overscaledZ-S.overscaledZ),_=g[g.length-1].overscaledZ,w=g[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let L=0;L<w;L++)S[L+_]=new Pr({func:u.GEQUAL,mask:255},L+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[S,g]}return[{[_]:Pr.disabled},g]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Wr([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new r.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Wr.unblended:Wr.alphaBlended}colorModeForDrapableLayerRenderPass(n){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Wr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new r.am(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,u,g,_=!1){if(this.depthOcclusion)return new ji(this.context.gl.GREATER,ji.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!_)return ji.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new ji(g||this.context.gl.LEQUAL,u,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),_=this.context.bindFramebuffer.get(),w=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new qs(this.context,u,g,!1,"texture"),this.depthTexture=new r.T(this.context,{width:u,height:g,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(_),n.bindTexture(n.TEXTURE_2D,w),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,u,g,0,0,u,g,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,u)=>n+u/this._fpsHistory.length,0))}render(n,u){const g=r.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=u;const _=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(w).filter(Mt=>{const Vt=_[Mt];return!(Vt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Vt.type]});let L=S(),M=!1,V=!1;for(const Mt of L){const Vt=_[Mt];Vt.type==="circle"&&(M=!0),Vt.type==="symbol"&&(Vt.hasInitialOcclusionOpacityProperties?V=!0:M=!0)}let Y=L.map(Mt=>_[Mt]);const J=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let Z=0,te=!1;for(const Mt in J){const Vt=J[Mt];Vt.used&&(Vt.prepare(this.context),Vt.getSource().usedInConflation&&++Z)}let de=!1;for(const Mt of Y)Mt.isHidden(this.transform.zoom)||(Mt.type==="clip"&&(de=!0),this.prepareLayer(Mt));const ue={},ge={},_e={},Te={},Ne={};for(const Mt in J){const Vt=J[Mt];ue[Mt]=Vt.getVisibleCoordinates(),ge[Mt]=ue[Mt].slice().reverse(),_e[Mt]=Vt.getVisibleCoordinates(!0).reverse(),Te[Mt]=Vt.getShadowCasterCoordinates(),Ne[Mt]=Vt.sortCoordinatesByDistance(ue[Mt])}const Qe=Mt=>{const Vt=this.style.getLayerSourceCache(Mt);return Vt&&Vt.used?Vt.getSource():null};if(Z||de||this._clippingActiveLastFrame){const Mt=[],Vt=[];let wt=0;for(const oi of Y)this.isSourceForClippingOrConflation(oi,Qe(oi))&&(Mt.push(oi),Vt.push(wt)),wt++;if(Mt&&(de||Mt.length>1)||this._clippingActiveLastFrame){de=!1;const oi=[];for(let zt=0;zt<Mt.length;zt++){const mi=Mt[zt],Li=Vt[zt],ai=this.style.getLayerSourceCache(mi);if(!ai||!ai.used||!ai.getSource().usedInConflation&&mi.type!=="clip")continue;let Mi=r.eu,ir=r.bQ.None;const tr=[];let Ki=!0;if(mi.type==="clip"){Mi=Li;for(const pr of mi.layout.get("clip-layer-types"))ir|=pr==="model"?r.bQ.Model:pr==="symbol"?r.bQ.Symbol:r.bQ.FillExtrusion;for(const pr of mi.layout.get("clip-layer-scope"))tr.push(pr);mi.isHidden(this.transform.zoom)?Ki=!1:de=!0}Ki&&oi.push({layer:mi.fqid,cache:ai,order:Mi,clipMask:ir,clipScope:tr})}this.replacementSource.setSources(oi),te=!0}}this._clippingActiveLastFrame=de,te||this.replacementSource.clear(),this.conflationActive=te,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Mt=0;Mt<Y.length;Mt++){const Vt=Y[Mt],wt=Vt.cutoffRange();if(this.longestCutoffRange=Math.max(wt,this.longestCutoffRange),wt>0){const oi=Qe(Vt);oi&&(this.minCutoffZoom=Math.max(oi.minzoom,this.minCutoffZoom)),Vt.minzoom&&(this.minCutoffZoom=Math.max(Vt.minzoom,this.minCutoffZoom))}Vt.is3D(w)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Mt),this._lastOcclusionLayer=Mt)}const at=this.style&&this.style.fog;at?(this._fogVisible=at.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=at.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0,L=S(),Y=L.map(Mt=>_[Mt]));const st=this._shadowRenderer;if(st){st.updateShadowParameters(this.transform,this.style.directionalLight);for(const Mt in J)for(const Vt of ue[Mt]){let wt={min:0,max:0};this.terrain&&(wt=this.terrain.getMinMaxForTile(Vt)||wt),st.addShadowReceiver(Vt.toUnwrapped(),wt.min,wt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.ev(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ca(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const it=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Xe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(it&&!this._snow&&(this._snow=new Ms(this)),!it&&this._snow&&(this._snow.destroy(),delete this._snow),Xe&&!this._rain&&(this._rain=new tf(this)),!Xe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Ai.has(this.context.gl))return;this.renderPass="offscreen";for(const Mt of Y){const Vt=n.getLayerSourceCache(Mt);if(!Mt.hasOffscreenPass()||Mt.isHidden(this.transform.zoom))continue;const wt=Vt?ge[Vt.id]:void 0;(Mt.type==="custom"||Mt.type==="raster"||Mt.type==="raster-particle"||Mt.isSky()||wt&&wt.length)&&this.renderLayer(this,Vt,Mt,wt)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const lt=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),dt=(()=>{if(u.showOverdrawInspector)return r.am.black;const Mt=this.style.fog;if(Mt&&this.transform.projection.supportsFog){const Vt=this.style.getLut(Mt.scope);if(!lt){const wt=Mt.properties.get("color-use-theme")==="none",oi=Mt.properties.get("color").toNonPremultipliedRenderColor(wt?null:Vt).toArray01();return new r.am(...oi)}if(lt){const wt=Mt.properties.get("space-color-use-theme")==="none",oi=Mt.properties.get("space-color").toNonPremultipliedRenderColor(wt?null:Vt).toArray01();return new r.am(...oi)}}return r.am.transparent})();if(this.context.clear({color:dt,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&lt&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Mt=Y[this.currentLayer],Vt=n.getLayerSourceCache(Mt);if(Mt.isSky())continue;const wt=Vt?(Mt.is3D(w)?Ne:ge)[Vt.id]:void 0;this._renderTileClippingMasks(Mt,Vt,wt),this.renderLayer(this,Vt,Mt,wt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&lt&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Mt=Y[this.currentLayer],Vt=n.getLayerSourceCache(Mt);Mt.isSky()&&this.renderLayer(this,Vt,Mt,Vt?ge[Vt.id]:void 0)}function kt(Mt,Vt){let wt;return Vt&&(wt=(Mt.type==="symbol"?_e:Mt.is3D(w)?Ne:ge)[Vt.id]),wt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<L.length;){const Mt=Y[this.currentLayer];if(Mt.type==="raster"||Mt.type==="raster-particle"){const Vt=n.getLayerSourceCache(Mt);this.renderLayer(this,Vt,Mt,kt(Mt,Vt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Dt=0;st&&(Dt=st.getShadowCastingLayerCount());let ti=!1,ri=-1;for(let Mt=0;Mt<L.length;++Mt){const Vt=Y[Mt];Vt.isHidden(this.transform.zoom)||Vt.is3D(w)&&(ri=Mt)}V&&ri===-1&&(M=!0);let vi=!1;for(;this.currentLayer<L.length;){const Mt=Y[this.currentLayer],Vt=n.getLayerSourceCache(Mt);if(Mt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Mt)){if(Mt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!vi&&Mt.is3D(w)&&!w){const wt=this.currentLayer,oi=zt=>{for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const mi=Y[this.currentLayer];if(Yu[mi.type]){const Li=this.style.getLayerSourceCache(mi);Yu[mi.type](this,Li,mi,kt(mi,Li),zt)}}};oi("initialize"),oi("reset"),this.currentLayer=wt,vi=!0}if(M&&!ti&&this.terrain&&!this.transform.isOrthographic&&(ti=!0,this.blitDepth()),V&&ri!==-1&&this.currentLayer===ri+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Mt,Vt,Vt?ue[Vt.id]:void 0),this.renderLayer(this,Vt,Mt,kt(Mt,Vt)),!this.terrain&&st&&Dt>0&&Mt.hasShadowPass()&&--Dt==0){{this.clearStencil();const wt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const oi=Y[this.currentLayer];if(bd[oi.type]){const zt=this.style.getLayerSourceCache(oi);bd[oi.type](this,zt,oi,kt(oi,zt))}}this.currentLayer=wt}if(st.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const wt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=wt;this.currentLayer++){const oi=Y[this.currentLayer];if(!oi.hasLightBeamPass())continue;const zt=n.getLayerSourceCache(oi);this.renderLayer(this,zt,oi,zt?ge[zt.id]:void 0)}this.currentLayer=wt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const wt=this.currentLayer;this.depthOcclusion=!0;for(const oi of this.layersWithOcclusionOpacity){this.currentLayer=oi;const zt=Y[this.currentLayer],mi=n.getLayerSourceCache(zt),Li=mi?ge[mi.id]:void 0;this.terrain||this._renderTileClippingMasks(zt,mi,mi?ue[mi.id]:void 0),this.renderLayer(this,mi,zt,Li)}this.depthOcclusion=!1,this.currentLayer=wt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Mt=null;Y.forEach(Vt=>{const wt=n.getLayerSourceCache(Vt);wt&&!Vt.isHidden(this.transform.zoom)&&wt.getVisibleCoordinates().length&&(!Mt||Mt.getSource().maxzoom<wt.getSource().maxzoom)&&(Mt=wt)}),Mt&&this.options.showTileBoundaries&&Sl(this,Mt,Mt.getVisibleCoordinates(),r.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Sl(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Mt){const Vt=Mt.transform.padding;gA(Mt,Mt.transform.height-(Vt.top||0),3,pA),gA(Mt,Vt.bottom||0,3,gd),Bh(Mt,Vt.left||0,3,Ga),Bh(Mt,Mt.transform.width-(Vt.right||0),3,wh);const wt=Mt.transform.centerPoint;(function(oi,zt,mi,Li){cl(oi,zt-1,mi-10,2,20,Li),cl(oi,zt-10,mi-1,20,2,Li)})(Mt,wt.x,Mt.transform.height-wt.y,la)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),te||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(n.type);if(Uf[n.type]&&(g||this.terrain&&n.type==="custom")){const _=this.style.getLayerSourceCache(n);Uf[n.type](n,_,this)}this.gpuTimingEnd()}renderLayer(n,u,g,_){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||_&&_.length)&&(this.id=g.id,this.gpuTimingStart(g),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(g.type)&&(!n.terrain||g.type!=="custom")||g.type==="clip"||Rn[g.type](n,u,g,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let _=this.gpuTimers[n.id];_||(_=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:g.createQuery()}),_.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(n.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const u={};for(const g in n){const _=n[g],w=this.context.extTimerQuery,S=w.getQueryParameter(_.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(_.query),u[g]=S}return u}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const _ of n)g+=u.getQueryParameter(_,u.QUERY_RESULT)/1e6,u.deleteQuery(_);return g}translatePosMatrix(n,u,g,_,w){if(!g[0]&&!g[1])return n;const S=w?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(S){const V=Math.sin(S),Y=Math.cos(S);g=[g[0]*Y-g[1]*V,g[0]*V+g[1]*Y]}const L=[w?g[0]:r.aw(u,g[0],this.transform.zoom),w?g[1]:r.aw(u,g[1],this.transform.zoom),0],M=new Float32Array(16);return r.bo(M,n,L),M}saveTileTexture(n){const u=n.size[0],g=this._tileTextures[u];g?g.push(n):this._tileTextures[u]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,u,g){const _=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,w=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):_||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||_||u!==void 0&&!u||w.push("FOG","FOG_DITHERING"),_&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(n,u){this.cache=this.cache||{};const g=u&&u.defines||[],_=u&&u.config,w=this.currentGlobalDefines(n,u&&u.overrideFog,u&&u.overrideRtt).concat(g),S=_h.cacheKey(fh[n],n,w,_);return this.cache[S]||(this.cache[S]=new _h(this.context,n,fh[n],_,dr[n],w)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,_=this.style.ambientLight;if(g&&_){const w=((S,L,M)=>{const V=S.properties.get("direction"),Y=S.properties.get("color-use-theme")==="none",J=S.properties.get("color").toNonPremultipliedRenderColor(Y?null:M.getLut(S.scope)).toArray01(),Z=S.properties.get("intensity"),te=L.properties.get("color-use-theme")==="none",de=L.properties.get("color").toNonPremultipliedRenderColor(te?null:M.getLut(L.scope)).toArray01(),ue=L.properties.get("intensity"),ge=[V.x,V.y,V.z],_e=r.dw(de,ue),Te=r.dw(J,Z);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:ge,u_lighting_directional_color:Te,u_ground_radiance:hA(ge,Te,_e)}})(g,_,this.style);u.setLightsUniformValues(n,w)}}}uploadCommonUniforms(n,u,g,_,w){if(this.uploadCommonLightUniforms(n,u),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const L=S.getOpacity(this.transform.pitch),M=((V,Y,J,Z,te,de,ue,ge,_e,Te,Ne,Qe)=>{const at=V.transform,st=Y.properties.get("color-use-theme")==="none",it=Y.properties.get("color").toNonPremultipliedRenderColor(st?null:V.style.getLut(Y.scope)).toArray01();it[3]=Z;const Xe=V.frameCounter/1e3%1,[lt,dt]=Y.properties.get("vertical-range");return{u_fog_matrix:J?at.calculateFogTileMatrix(J):Qe||V.identityMat,u_fog_range:Y.getFovAdjustedRange(at._fov),u_fog_color:it,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(lt,dt),dt],u_fog_temporal_offset:Xe,u_frustum_tl:te,u_frustum_tr:de,u_frustum_br:ue,u_frustum_bl:ge,u_globe_pos:_e,u_globe_radius:Te,u_viewport:Ne,u_globe_transition:r.ah(at.zoom),u_is_globe:+(at.projection.name==="globe")}})(this,S,g,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],_);u.setFogUniformValues(n,M)}w&&u.setCutoffUniformValues(n,w.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,u=n.createTexture();return n.bindTexture(n.TEXTURE_2D,u),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const _ of g)u[_.key]=n[_.key]||new cu(_,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,u){return!(!n.is3D(!(!this.terrain||!this.terrain.enabled))||n.type!=="clip"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[n.key];return u||(this._cachedTileFogOpacities[n.key]=u=this.style.fog.getOpacityForTile(n)),u[0]>=Nt||u[1]>=Nt}setupDepthForOcclusion(n,u,g){const _=this.context,w=_.gl,S=!!g;var L;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),_.activeTexture.set(w.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((L=this.depthRangeFor3D)[1]-L[0]),-1-2*L[0]/(L[1]-L[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),_.activeTexture.set(w.TEXTURE0),S||u.setTerrainUniformValues(_,g)}}function qh(p,n){let u=!1,g=null;const _=()=>{g=null,u&&(p(),g=setTimeout(_,n),u=!1)};return()=>(u=!0,g||_(),g)}class Tp{constructor(n){this._hashName=n&&encodeURIComponent(n),r.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=qh(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const u=zf(n);if(this._hashName){const g=this._hashName;let _=!1;const w=location.hash.slice(1).split("&").map(S=>{const L=S.split("=")[0];return L===g?(_=!0,`${L}=${u}`):S}).filter(S=>S);return _||w.push(`${g}=${u}`),`#${w.join("&")}`}return`#${u}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(Number(g)))){const g=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(u[3]||0):n.getBearing();return n.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function zf(p,n){const u=p.getCenter(),g=Math.round(100*p.getZoom())/100,_=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),S=Math.round(u.lng*w)/w,L=Math.round(u.lat*w)/w,M=p.getBearing(),V=p.getPitch();let Y=n?`/${S}/${L}/${g}`:`${g}/${L}/${S}`;return(M||V)&&(Y+="/"+Math.round(10*M)/10),V&&(Y+=`/${Math.round(V)}`),Y}const Th={linearity:.3,easing:r.ew(0,0,.3,1)},xA=r.h({deceleration:2500,maxSpeed:1400},Th),Ku=r.h({deceleration:20,maxSpeed:1400},Th),Ih=r.h({deceleration:1e3,maxSpeed:360},Th),wd=r.h({deceleration:1e3,maxSpeed:90},Th);class rf{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=r.q.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const w=Cd(u.pan.mag(),g,r.h({},xA,n||{}));_.offset=u.pan.mult(w.amount/u.pan.mag()),_.center=this._map.transform.center,Bd(_,w)}if(u.zoom){const w=Cd(u.zoom,g,Ku);_.zoom=this._map.transform.zoom+w.amount,Bd(_,w)}if(u.bearing){const w=Cd(u.bearing,g,Ih);_.bearing=this._map.transform.bearing+r.ay(w.amount,-179,179),Bd(_,w)}if(u.pitch){const w=Cd(u.pitch,g,wd);_.pitch=this._map.transform.pitch+w.amount,Bd(_,w)}if(_.zoom||_.bearing){const w=u.pinchAround===void 0?u.around:u.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Bd(p,n){(!p.duration||p.duration<n.duration)&&(p.duration=n.duration,p.easing=n.easing)}function Cd(p,n,u){const{maxSpeed:g,linearity:_,deceleration:w}=u,S=r.ay(p*_/(n/1e3),-g,g),L=Math.abs(S)/(w*_);return{easing:u.easing,duration:1e3*L,amount:S*(L/2)}}class Xa extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g,_={}){const w=he(u.getCanvasContainer(),g),S=u.unproject(w);super(n,r.h({point:w,lngLat:S,originalEvent:g},_)),this._defaultPrevented=!1,this.target=u}}class Fh extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g){const _=n==="touchend"?g.changedTouches:g.touches,w=be(u.getCanvasContainer(),_),S=w.map(M=>u.unproject(M)),L=w.reduce((M,V,Y,J)=>M.add(V.div(J.length)),new r.P(0,0));super(n,{points:w,point:L,lngLats:S,lngLat:u.unproject(L),originalEvent:g}),this._defaultPrevented=!1}}class Lh extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class Nf{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new Lh(this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Xa(n.type,this._map,n))}mouseup(n){this._map.fire(new Xa(n.type,this._map,n))}preclick(n){const u=r.h({},n);u.type="preclick",this._map.fire(new Xa(u.type,this._map,u))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Xa(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Xa(n.type,this._map,n))}mouseover(n){this._map.fire(new Xa(n.type,this._map,n))}mouseout(n){this._map.fire(new Xa(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Fh(n.type,this._map,n))}touchmove(n){this._map.fire(new Fh(n.type,this._map,n))}touchend(n){this._map.fire(new Fh(n.type,this._map,n))}touchcancel(n){this._map.fire(new Fh(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jf{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Xa(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Xa(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ip{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(ne(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const g=u,_=this._startPos,w=this._lastPos;if(!_||!w||w.equals(g)||!this._box&&g.dist(_)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=P("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const S=Math.min(_.x,g.x),L=Math.max(_.x,g.x),M=Math.min(_.y,g.y),V=Math.max(_.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${M}px)`,this._box.style.width=L-S+"px",this._box.style.height=V-M+"px")})}mouseupWindow(n,u){if(!this._active)return;const g=this._startPos,_=u;if(g&&n.button===0){if(this.reset(),fe(),g.x!==_.x||g.y!==_.y)return this._map.fire(new r.A("boxzoomend",{originalEvent:n})),{cameraAnimation:w=>w.fitScreenCoordinates(g,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),re(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new r.A(n,{originalEvent:u}))}}function bA(p,n){const u={};for(let g=0;g<p.length;g++)u[p[g].identifier]=n[g];return u}class Zo{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),g.length===this.numTouches&&(this.centroid=function(_){const w=new r.P(0,0);for(const S of _)w._add(S);return w.div(_.length)}(u),this.touches=bA(g,u)))}touchmove(n,u,g){if(this.aborted||!this.centroid)return;const _=bA(g,u);for(const w in this.touches){const S=_[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(n,u,g){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Sd{constructor(n){this.singleTap=new Zo(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,u,g){this.singleTap.touchstart(n,u,g)}touchmove(n,u,g){this.singleTap.touchmove(n,u,g)}touchend(n,u,g){const _=this.singleTap.touchend(n,u,g);if(_){const w=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(_)<30;if(w&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class wA{constructor(){this._zoomIn=new Sd({numTouches:1,numTaps:2}),this._zoomOut=new Sd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,g){this._zoomIn.touchstart(n,u,g),this._zoomOut.touchstart(n,u,g)}touchmove(n,u,g){this._zoomIn.touchmove(n,u,g),this._zoomOut.touchmove(n,u,g)}touchend(n,u,g){const _=this._zoomIn.touchend(n,u,g),w=this._zoomOut.touchend(n,u,g);return _?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(_)},{originalEvent:n})}):w?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Fp={0:1,2:2},$h={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class nf{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,u){return!1}_move(n,u){return{}}mousedown(n,u){if(this._lastPoint)return;const g=Se(n);this._correctButton(n,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(n,u){const g=this._lastPoint;if(g){if(n.preventDefault(),this._eventButton!=null&&function(_,w){const S=Fp[w];return _.buttons===void 0||(_.buttons&S)!==S}(n,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(n){this._lastPoint&&Se(n)===this._eventButton&&(this._moved&&fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lp extends nf{mousedown(n,u){super.mousedown(n,u),this._lastPoint&&(this._active=!0)}_correctButton(n,u){return u===0&&!n.ctrlKey}_move(n,u){return{around:u,panDelta:u.sub(n)}}}class sf extends nf{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?$h[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const g=.8*(u.x-n.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class Mh extends nf{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?$h[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const g=-.5*(u.y-n.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class Hf{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),r.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(n,u,g){return this._calculateTransform(n,u,g)}touchmove(n,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!r.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,u,g)}}touchend(n,u,g){this._calculateTransform(n,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,g){g.length>0&&(this._active=!0);const _=bA(g,u),w=new r.P(0,0),S=new r.P(0,0);let L=0;for(const V in _){const Y=_[V],J=this._touches[V];J&&(w._add(Y),S._add(Y.sub(J)),L++,_[V]=Y)}if(this._touches=_,L<this._minTouches||!S.mag())return;const M=S.div(L);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(L),panDelta:M}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class BA{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,u,g){return{}}touchstart(n,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,g){const _=this._firstTwoTouches;if(!_)return;n.preventDefault();const[w,S]=_,L=Zh(g,u,w),M=Zh(g,u,S);if(!L||!M)return;const V=this._aroundCenter?null:L.add(M).div(2);return this._move([L,M],V,n)}touchend(n,u,g){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,S=Zh(g,u,_),L=Zh(g,u,w);S&&L||(this._active&&fe(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Zh(p,n,u){for(let g=0;g<p.length;g++)if(p[g].identifier===u)return n[g]}function CA(p,n){return Math.log(p/n)/Math.LN2}class Qf extends BA{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(CA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:CA(this._distance,g),pinchAround:u}}}function Vf(p,n){return 180*p.angleWith(n)/Math.PI}class of extends BA{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u){const g=this._vector;if(this._vector=n[0].sub(n[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Vf(this._vector,g),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const _=Vf(n,g);return Math.abs(_)<u}}function Ed(p){return Math.abs(p.y)>Math.abs(p.x)}class Mp extends BA{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Ed(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,g){const _=this._lastPoints;if(!_)return;const w=n[0].sub(_[0]),S=n[1].sub(_[1]);return this._map._cooperativeGestures&&!r.ex()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(w,S,g.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5})}gestureBeginsVertically(n,u,g){if(this._valid!==void 0)return this._valid;const _=n.mag()>=2,w=u.mag()>=2;if(!_&&!w)return;if(!_||!w)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const S=n.y>0==u.y>0;return Ed(n)&&Ed(u)&&S}}const Pp={panStep:100,bearingStep:15,pitchStep:10};class xg{constructor(){const n=Pp;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,g=0,_=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?g=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?g=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(g=0,_=0),{cameraAnimation:L=>{const M=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:kp,zoom:u?Math.round(M)+u*(n.shiftKey?2:1):M,bearing:L.getBearing()+g*this._bearingStep,pitch:L.getPitch()+_*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:L.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kp(p){return p*(2-p)}const Gf=4.000244140625,bg=1/450;class wg{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=bg,r.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||r.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const g=r.q.now(),_=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%Gf==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=he(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>Gf?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&Y!==0&&(Y=1/Y);const J=u(),Z=Math.pow(2,J),te=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(te*Y))),this._type==="wheel"&&(this._startZoom=J,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),_=this._startZoom,w=this._easing;let S,L=!1;if(this._type==="wheel"&&_&&w){const V=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),Y=w(V);S=r.ai(_,g,Y),V<1?this._frameId||(this._frameId=!0):L=!0}else S=g,L=!0;this._active=!0,L&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let M=S-u();return M*this._lastDelta<0&&(M=0),{noInertia:!0,needsRenderFrame:!L,zoomDelta:M,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=r.ey;if(this._prevEase){const g=this._prevEase,_=(r.q.now()-g.start)/g.duration,w=g.easing(_+.01)-g.easing(_),S=.27/Math.sqrt(w*w+1e-4)*.01,L=Math.sqrt(.0729-S*S);u=r.ew(S,L,.25,1)}return this._prevEase={start:r.q.now(),duration:n,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Td{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Rp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,u){return n.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(n.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ma{constructor(){this._tap=new Sd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,u,g){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(n,u,g))}touchmove(n,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const _=u[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,u,g)}touchend(n,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(n,u,g)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jh{constructor(n,u,g){this._el=n,this._mousePan=u,this._touchPan=g}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class SA{constructor(n,u,g){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ed{constructor(n,u,g,_){this._el=n,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Tu=p=>p.zoom||p.drag||p.pitch||p.rotate;class Vs extends r.A{}class qu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,u){const g=r.at([],u,n);this.radius=r.ae(g[2]<0?r.eA([],g,this.constants):[g[0],g[1],0])}projectRay(n){r.eA(n,n,this.constants),r.au(n,n),r.eB(n,n,this.constants);const u=r.bY([],n,this.radius);if(u[2]>0){const g=r.bY([],[0,0,1],r.bG(u,[0,0,1])),_=r.bY([],r.au([],[u[0],u[1],0]),this.radius),w=r.cV([],u,r.bY([],r.at([],r.cV([],_,g),u),2));u[0]=w[0],u[1]=w[1]}return u}}function af(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Wf{constructor(n,u){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rf(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),r.aV(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,S]of this._listeners){const L=_===document?this.handleWindowEvent:this.handleEvent;_.addEventListener(w,L,S)}}destroy(){for(const[n,u,g]of this._listeners){const _=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(u,_,g)}}_addDefaultHandlers(n){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new Nf(u,n));const _=u.boxZoom=new Ip(u,n);this._add("boxZoom",_);const w=new wA,S=new Rp;u.doubleClickZoom=new Td(S,w),this._add("tapZoom",w),this._add("clickZoom",S);const L=new ma;this._add("tapDragZoom",L);const M=u.touchPitch=new Mp(u);this._add("touchPitch",M);const V=new sf(n),Y=new Mh(n);u.dragRotate=new SA(n,V,Y),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const J=new Lp(n),Z=new Hf(u,n);u.dragPan=new Jh(g,J,Z),this._add("mousePan",J),this._add("touchPan",Z,["touchZoom","touchRotate"]);const te=new of,de=new Qf;u.touchZoomRotate=new ed(g,de,te,L),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new jf(u));const ue=u.scrollZoom=new wg(u,this);this._add("scrollZoom",ue,["mousePan"]);const ge=u.keyboard=new xg;this._add("keyboard",ge);for(const _e of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[_e]&&u[_e].enable(n[_e])}_add(n,u,g){this._handlers.push({handlerName:n,handler:u,allowed:g}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Tu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,u,g){for(const _ in n)if(_!==g&&(!u||u.indexOf(_)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const u=[];for(const g of n)this._el.contains(g.target)&&u.push(g);return u}handleEvent(n,u){this._updatingCamera=!0;const g=n.type==="renderFrame",_=g?void 0:n,w={needsRenderFrame:!1},S={},L={},M=n.touches?this._getMapTouches(n.touches):void 0,V=M?be(this._el,M):g?void 0:he(this._el,n);for(const{handlerName:Z,handler:te,allowed:de}of this._handlers){if(!te.isEnabled())continue;let ue;this._blockedByActive(L,de,Z)?te.reset():te[u||n.type]&&(ue=te[u||n.type](n,V,M),this.mergeHandlerResult(w,S,ue,Z,_),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||te.isActive())&&(L[Z]=te)}const Y={};for(const Z in this._previousActiveHandlers)L[Z]||(Y[Z]=_);this._previousActiveHandlers=L,(Object.keys(Y).length||af(w))&&(this._changes.push([w,S,Y]),this._triggerRenderFrame()),(Object.keys(L).length||af(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=w;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(n,u,g,_,w){if(!g)return;r.h(n,g);const S={handlerName:_,originalEvent:g.originalEvent||w};g.zoomDelta!==void 0&&(u.zoom=S),g.panDelta!==void 0&&(u.drag=S),g.pitchDelta!==void 0&&(u.pitch=S),g.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const n={},u={},g={};for(const[_,w,S]of this._changes)_.panDelta&&(n.panDelta=(n.panDelta||new r.P(0,0))._add(_.panDelta)),_.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(n.around=_.around),_.aroundCoord!==void 0&&(n.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(n.pinchAround=_.pinchAround),_.noInertia&&(n.noInertia=_.noInertia),r.h(u,w),r.h(g,S);this._updateMapTransform(n,u,g),this._changes=[]}_updateMapTransform(n,u,g){const _=this._map,w=_.transform,S=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!af(n)){const Te=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Te!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&_._stop(!0),!af(n))return void this._fireEvents(u,g,!0);let{panDelta:L,zoomDelta:M,bearingDelta:V,pitchDelta:Y,around:J,aroundCoord:Z,pinchAround:te}=n;w._isCameraConstrained&&(M>0&&(M=0),w._isCameraConstrained=!1),te!==void 0&&(J=te),(M||(Te=>u[Te]&&!this._eventsInProgress[Te])("drag"))&&J&&(this._dragOrigin=S(w.pointCoordinate3D(J)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",_._stop(!0),J=J||_.transform.centerPoint,V&&(w.bearing+=V),Y&&(w.pitch+=Y),w._updateCameraState();const de=[0,0,0];if(L)if(w.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(J).dir),Ne=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(J.sub(L)).dir);de[0]=Ne[0]-Te[0],de[1]=Ne[1]-Te[1]}else{const Te=w.pointCoordinate(J);if(w.projection.name==="globe"){L=L.rotate(-w.angle);const Ne=w._pixelsPerMercatorPixel/w.worldSize;de[0]=-L.x*r.ez(r.aY(Te.y))*Ne,de[1]=-L.y*r.ez(w.center.lat)*Ne}else{const Ne=w.pointCoordinate(J.sub(L));Te&&Ne&&(de[0]=Ne.x-Te.x,de[1]=Ne.y-Te.y)}}const ue=w.zoom,ge=[0,0,0];if(M){const Te=S(Z||w.pointCoordinate3D(J)),Ne={dir:r.au([],r.at([],Te,w._camera.position))};if(Ne.dir[2]<0){const Qe=w.zoomDeltaToMovement(Te,M);r.bY(ge,Ne.dir,Qe)}}const _e=r.cV(de,de,ge);w._translateCameraConstrained(_e),M&&Math.abs(w.zoom-ue)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,g,!0)}_fireEvents(n,u,g){const _=Tu(this._eventsInProgress),w=Tu(n),S={};for(const Y in n){const{originalEvent:J}=n[Y];this._eventsInProgress[Y]||(S[`${Y}start`]=J),this._eventsInProgress[Y]=n[Y]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const Y in S)this._fireEvent(Y,S[Y]);w&&this._fireEvent("move",w.originalEvent);for(const Y in n){const{originalEvent:J}=n[Y];this._fireEvent(Y,J)}const L={};let M;for(const Y in this._eventsInProgress){const{handlerName:J,originalEvent:Z}=this._eventsInProgress[Y];this._handlersById[J].isActive()||(delete this._eventsInProgress[Y],M=u[J]||Z,L[`${Y}end`]=M)}for(const Y in L)this._fireEvent(Y,L[Y]);const V=Tu(this._eventsInProgress);if(g&&(_||w)&&!V){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;Y?(J(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:M})):(this._map.fire(new r.A("moveend",{originalEvent:M})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new r.A(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Vs("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Dp="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Id extends r.E{constructor(n,u){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,r.aV(["_renderFrameCallback"],this)}getCenter(){return new r.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}panBy(n,u,g){return n=r.P.convert(n).mult(-1),this.panTo(this.transform.center,r.h({offset:n},u),g)}panTo(n,u,g){return this.easeTo(r.h({center:n},u),g)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,g){return this.easeTo(r.h({zoom:n},u),g)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,g){return this.easeTo(r.h({bearing:n},u),g)}resetNorth(n,u){return this.rotateTo(0,r.h({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(r.h({bearing:0,pitch:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}cameraForBounds(n,u){n=r.aG.convert(n);const g=u&&u.bearing||0,_=u&&u.pitch||0,w=n.getNorthWest(),S=n.getSouthEast();return this._cameraForBounds(this.transform,w,S,g,_,u)}_extendPadding(n){const u={top:0,right:0,bottom:0,left:0};return n==null?r.h({},u,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:r.h({},u,n)}_extendCameraOptions(n){return(n=r.h({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,u){const g=u.max[0]-u.min[0],_=u.max[1]-u.min[1];return g/_>n.aspect?g/(2*Math.tan(.5*n.fovX)*n.aspect):_/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,u,g,_,w,S){const L=n.clone(),M=this._extendCameraOptions(S);L.bearing=_,L.pitch=w;const V=r.cd.convert(u),Y=r.cd.convert(g),J=.5*(V.lat+Y.lat),Z=.5*(V.lng+Y.lng),te=r.eC(J,Z),de=r.au([],te),ue=r.au([],r.bF([],de,[0,1,0])),ge=r.bF([],ue,de),_e=[ue[0],ue[1],ue[2],0,ge[0],ge[1],ge[2],0,de[0],de[1],de[2],0,0,0,0,1],Te=[te,r.eC(V.lat,V.lng),r.eC(Y.lat,V.lng),r.eC(Y.lat,Y.lng),r.eC(V.lat,Y.lng),r.eC(J,V.lng),r.eC(J,Y.lng),r.eC(V.lat,Z),r.eC(Y.lat,Z)];let Ne=r.cW.fromPoints(Te.map(zt=>[r.bG(ue,zt),r.bG(ge,zt),r.bG(de,zt)]));const Qe=r.ad([],Ne.center,_e);r.eD(Qe)===0&&r.eE(Qe,0,0,1),r.au(Qe,Qe),r.bY(Qe,Qe,r.aB),L.center=r.eF(Qe);const at=L.getWorldToCameraMatrix(),st=r.bi(new Float64Array(16),at);Ne=r.cW.applyTransform(Ne,r.az([],at,_e));const it=this._extendAABB(Ne,L,M,_);if(!it)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=it,r.ad(Qe,Qe,at);const Xe=.5*(Ne.max[2]-Ne.min[2]),lt=this._minimumAABBFrustumDistance(L,Ne),dt=r.bY([],[0,0,1],Xe),kt=r.cV(dt,Qe,dt),Dt=lt+(L.pitch===0?0:r.bD(Qe,kt)),ti=L.globeCenterInViewSpace,ri=r.at([],Qe,[ti[0],ti[1],ti[2]]);r.au(ri,ri),r.bY(ri,ri,Dt);const vi=r.cV([],Qe,ri);r.ad(vi,vi,st);const Mt=r.eq/r.aB,Vt=r.ae(vi),wt=r.c6(Math.max(Vt*Mt-r.eq,Number.EPSILON),0),oi=Math.min(L.zoomFromMercatorZAdjusted(wt),M.maxZoom);return oi>.5*(r.cL+r.cx)?(L.setProjection({name:"mercator"}),L.zoom=oi,this._cameraForBounds(L,u,g,_,w,S)):{center:L.center,zoom:oi,bearing:_,pitch:w}}_extendAABB(n,u,g,_){const w=.5*((g.padding.left||0)+(g.padding.right||0)),S=.5*((g.padding.top||0)+(g.padding.bottom||0)),L=S,M=w,V=w,Y=S,J=u.width-(M+V),Z=u.height-(L+Y),te=r.at([],n.max,n.min),de=Math.min(J/te[0],Z/te[1]),ue=Math.min(u.scaleZoom(u.scale*de),g.maxZoom);if(isNaN(ue))return null;const ge=u.scale/u.zoomScale(ue),_e=new r.cW([n.min[0]-M*ge,n.min[1]-Y*ge,n.min[2]],[n.max[0]+V*ge,n.max[1]+L*ge,n.max[2]]),Te=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new r.P(g.offset.x,g.offset.y):r.P.convert(g.offset)).rotate(-r.al(_));return _e.center[0]-=Te.x*ge,_e.center[1]+=Te.y*ge,_e}queryTerrainElevation(n,u){const g=this.transform.elevation;return g?(u=r.h({},{exaggerated:!0},u),g.getAtPoint(r.ac.fromLngLat(n),null,u.exaggerated)):null}_cameraForBounds(n,u,g,_,w,S){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,u,g,_,w,S);const L=n.clone(),M=this._extendCameraOptions(S);L.bearing=_,L.pitch=w;const V=r.cd.convert(u),Y=r.cd.convert(g),J=new r.cd(V.lng,Y.lat),Z=new r.cd(Y.lng,V.lat),te=L.project(V),de=L.project(Y),ue=this.queryTerrainElevation(V),ge=this.queryTerrainElevation(Y),_e=this.queryTerrainElevation(J),Te=this.queryTerrainElevation(Z),Ne=[[te.x,te.y,Math.min(ue||0,ge||0,_e||0,Te||0)],[de.x,de.y,Math.max(ue||0,ge||0,_e||0,Te||0)]];let Qe=r.cW.fromPoints(Ne);const at=L.getWorldToCameraMatrix(),st=r.bi(new Float64Array(16),at);Qe=r.cW.applyTransform(Qe,at);const it=this._extendAABB(Qe,L,M,_);if(!it)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Qe=it;const Xe=.5*r.at([],Qe.max,Qe.min)[2],lt=this._minimumAABBFrustumDistance(L,Qe),dt=[0,0,1,0];r.aA(dt,dt,at),r.eG(dt,dt);const kt=r.bY([],dt,lt+Xe),Dt=r.cV([],Qe.center,kt);r.ad(Qe.center,Qe.center,st),r.ad(Dt,Dt,st);const ti=L.unproject(new r.P(Qe.center[0],Qe.center[1])),ri=r.eH(L.projection,ti),vi=Math.pow(2,ri),Mt=Math.min(L._zoomFromMercatorZ(Dt[2]*L.pixelsPerMeter*vi/L.worldSize),M.maxZoom);return L.mercatorFromTransition&&Mt<.5*(r.cL+r.cx)?(L.setProjection({name:"globe"}),L.zoom=Mt,this._cameraForBounds(L,u,g,_,w,S)):{center:ti,zoom:Mt,bearing:_,pitch:w}}fitBounds(n,u,g){const _=this.cameraForBounds(n,u);return this._fitInternal(_,u,g)}fitScreenCoordinates(n,u,g,_,w){const S=r.P.convert(n),L=r.P.convert(u),M=new r.P(Math.min(S.x,L.x),Math.min(S.y,L.y)),V=new r.P(Math.max(S.x,L.x),Math.max(S.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,L))return this;const Y=this.transform.pointLocation3D(M),J=this.transform.pointLocation3D(V),Z=this.transform.pointLocation3D(new r.P(M.x,V.y)),te=this.transform.pointLocation3D(new r.P(V.x,M.y)),de=[Math.min(Y.lng,J.lng,Z.lng,te.lng),Math.min(Y.lat,J.lat,Z.lat,te.lat)],ue=[Math.max(Y.lng,J.lng,Z.lng,te.lng),Math.max(Y.lat,J.lat,Z.lat,te.lat)],ge=_&&_.pitch?_.pitch:this.getPitch(),_e=this._cameraForBounds(this.transform,de,ue,g,ge,_);return this._fitInternal(_e,_,w)}_fitInternal(n,u,g){return n?(u=r.h(n,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(n,u){this.stop();const g=n.preloadOnly?this.transform.clone():this.transform;let _=!1,w=!1,S=!1;"zoom"in n&&g.zoom!==+n.zoom&&(_=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=r.cd.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(w=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(S=!0,g.pitch=+n.pitch);const L=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!g.isPaddingEqual(L))if(n.retainPadding===!1){const M=g.clone();M.padding=L,g.setLocationAtPoint(g.center,M.centerPoint)}else g.padding=L;return n.preloadOnly?(this._preloadTiles(g),this):(this.fire(new r.A("movestart",u)).fire(new r.A("move",u)),_&&this.fire(new r.A("zoomstart",u)).fire(new r.A("zoom",u)).fire(new r.A("zoomend",u)),w&&this.fire(new r.A("rotatestart",u)).fire(new r.A("rotate",u)).fire(new r.A("rotateend",u)),S&&this.fire(new r.A("pitchstart",u)).fire(new r.A("pitch",u)).fire(new r.A("pitchend",u)),this.fire(new r.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(Dp),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return r.w(Dp),this;this.stop();const _=g.zoom,w=g.pitch,S=g.bearing;g.setFreeCameraOptions(n);const L=_!==g.zoom,M=w!==g.pitch,V=S!==g.bearing;return this.fire(new r.A("movestart",u)).fire(new r.A("move",u)),L&&this.fire(new r.A("zoomstart",u)).fire(new r.A("zoom",u)).fire(new r.A("zoomend",u)),V&&this.fire(new r.A("rotatestart",u)).fire(new r.A("rotate",u)).fire(new r.A("rotateend",u)),M&&this.fire(new r.A("pitchstart",u)).fire(new r.A("pitch",u)).fire(new r.A("pitchend",u)),this.fire(new r.A("moveend",u)),this}easeTo(n,u){this._stop(!1,n.easeId),((n=r.h({offset:[0,0],duration:500,easing:r.ey},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const g=this.transform,_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),L=this.getPadding(),M="zoom"in n?+n.zoom:_,V="bearing"in n?this._normalizeBearing(n.bearing,w):w,Y="pitch"in n?+n.pitch:S,J=this._extendPadding(n.padding),Z=r.P.convert(n.offset);let te,de,ue;if(g.projection.name==="globe"){const dt=r.ac.fromLngLat(g.center),kt=Z.rotate(-g.angle);dt.x+=kt.x/g.worldSize,dt.y+=kt.y/g.worldSize;const Dt=dt.toLngLat(),ti=r.cd.convert(n.center||Dt);this._normalizeCenter(ti),te=g.centerPoint.add(kt),de=new r.P(dt.x,dt.y).mult(g.worldSize),ue=new r.P(r.aD(ti.lng),r.aH(ti.lat)).mult(g.worldSize).sub(de)}else{te=g.centerPoint.add(Z);const dt=g.pointLocation(te),kt=r.cd.convert(n.center||dt);this._normalizeCenter(kt),de=g.project(dt),ue=g.project(kt).sub(de)}const ge=g.zoomScale(M-_);let _e,Te;n.around&&(_e=r.cd.convert(n.around),Te=g.locationPoint(_e));const Ne=this._zooming||M!==_,Qe=this._rotating||w!==V,at=this._pitching||Y!==S,st=!g.isPaddingEqual(J),it=n.retainPadding===!1?g.clone():g,Xe=dt=>kt=>{if(Ne&&(dt.zoom=r.ai(_,M,kt)),Qe&&(dt.bearing=r.ai(w,V,kt)),at&&(dt.pitch=r.ai(S,Y,kt)),st&&(it.interpolatePadding(L,J,kt),te=it.centerPoint.add(Z)),_e)dt.setLocationAtPoint(_e,Te);else{const Dt=dt.zoomScale(dt.zoom-_),ti=M>_?Math.min(2,ge):Math.max(.5,ge),ri=Math.pow(ti,1-kt),vi=dt.unproject(de.add(ue.mult(kt*ri)).mult(Dt));dt.setLocationAtPoint(dt.renderWorldCopies?vi.wrap():vi,te)}return n.preloadOnly||this._fireMoveEvents(u),dt};if(n.preloadOnly){const dt=this._emulate(Xe,n.duration,g);return this._preloadTiles(dt),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=Qe,this._pitching=at,this._padding=st,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,lt),this._ease(Xe(g),dt=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,dt)},n),this}_prepareEase(n,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new r.A("movestart",n)),this._zooming&&!g.zooming&&this.fire(new r.A("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new r.A("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new r.A("pitchstart",n))}_fireMoveEvents(n){this.fire(new r.A("move",n)),this._zooming&&this.fire(new r.A("zoom",n)),this._rotating&&this.fire(new r.A("rotate",n)),this._pitching&&this.fire(new r.A("pitch",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,_=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new r.A("zoomend",n)),_&&this.fire(new r.A("rotateend",n)),w&&this.fire(new r.A("pitchend",n)),this.fire(new r.A("moveend",n))}flyTo(n,u){if(this._prefersReducedMotion(n)){const zt=r.aF(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(zt,u)}this.stop(),n=r.h({offset:[0,0],speed:1.2,curve:1.42,easing:r.ey},n);const g=this.transform,_=this.getZoom(),w=this.getBearing(),S=this.getPitch(),L=this.getPadding(),M="zoom"in n?r.ay(+n.zoom,g.minZoom,g.maxZoom):_,V="bearing"in n?this._normalizeBearing(n.bearing,w):w,Y="pitch"in n?+n.pitch:S,J=this._extendPadding(n.padding),Z=g.zoomScale(M-_),te=r.P.convert(n.offset);let de=g.centerPoint.add(te);const ue=g.pointLocation(de),ge=r.cd.convert(n.center||ue);this._normalizeCenter(ge);const _e=g.project(ue),Te=g.project(ge).sub(_e);let Ne=n.curve;const Qe=Math.max(g.width,g.height),at=Qe/Z,st=Te.mag();if("minZoom"in n){const zt=r.ay(Math.min(n.minZoom,_,M),g.minZoom,g.maxZoom),mi=Qe/g.zoomScale(zt-_);Ne=Math.sqrt(mi/st*2)}const it=Ne*Ne;function Xe(zt){const mi=(at*at-Qe*Qe+(zt?-1:1)*it*it*st*st)/(2*(zt?at:Qe)*it*st);return Math.log(Math.sqrt(mi*mi+1)-mi)}function lt(zt){return(Math.exp(zt)-Math.exp(-zt))/2}function dt(zt){return(Math.exp(zt)+Math.exp(-zt))/2}const kt=Xe(0);let Dt=function(zt){return dt(kt)/dt(kt+Ne*zt)},ti=function(zt){return Qe*((dt(kt)*(lt(mi=kt+Ne*zt)/dt(mi))-lt(kt))/it)/st;var mi},ri=(Xe(1)-kt)/Ne;if(Math.abs(st)<1e-6||!isFinite(ri)){if(Math.abs(Qe-at)<1e-6)return this.easeTo(n,u);const zt=at<Qe?-1:1;ri=Math.abs(Math.log(at/Qe))/Ne,ti=function(){return 0},Dt=function(mi){return Math.exp(zt*Ne*mi)}}n.duration="duration"in n?+n.duration:1e3*ri/("screenSpeed"in n?+n.screenSpeed/Ne:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const vi=w!==V,Mt=Y!==S,Vt=!g.isPaddingEqual(J),wt=n.retainPadding===!1?g.clone():g,oi=zt=>mi=>{const Li=mi*ri,ai=1/Dt(Li);zt.zoom=mi===1?M:_+zt.scaleZoom(ai),vi&&(zt.bearing=r.ai(w,V,mi)),Mt&&(zt.pitch=r.ai(S,Y,mi)),Vt&&(wt.interpolatePadding(L,J,mi),de=wt.centerPoint.add(te));const Mi=mi===1?ge:zt.unproject(_e.add(Te.mult(ti(Li))).mult(ai));return zt.setLocationAtPoint(zt.renderWorldCopies?Mi.wrap():Mi,de),zt._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(u),zt};if(n.preloadOnly){const zt=this._emulate(oi,n.duration,g);return this._preloadTiles(zt),this}return this._zooming=!0,this._rotating=vi,this._pitching=Mt,this._padding=Vt,this._prepareEase(u,!1),this._ease(oi(g),()=>this._afterEase(u),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!n){const g=this.handlers;g&&g.stop(!1)}return this}_ease(n,u,g){g.animate===!1||g.duration===0?(n(1),u()):(this._easeStart=r.q.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,u){n=r.bX(n,-180,180);const g=Math.abs(n-u);return Math.abs(n-360-u)<g&&(n-=360),Math.abs(n+360-u)<g&&(n+=360),n}_normalizeCenter(n){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=n.lng-u.center.lng;n.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,u,g){const _=Math.ceil(15*u/1e3),w=[],S=n(g.clone());for(let L=0;L<=_;L++){const M=S(L/_);w.push(M.clone())}return w}_preloadTiles(n,u){}}class Fd{constructor(n={}){this.options=n,r.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const u=this.options&&this.options.compact,g=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=P("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const _=P("span","mapboxgl-ctrl-icon",this._compactButton);return _.setAttribute("aria-hidden","true"),_.setAttribute("title",g),this._innerContainer=P("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(n){const g=u.reduce((_,w,S)=>(w.value&&(_+=`${w.key}=${w.value}${S<u.length-1?"&":""}`),_),"?");n.href=`${r.e.FEEDBACK_URL}/${g}#${zf(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style._mergedSourceCaches;for(const _ in u){const w=u[_];if(w.used){const S=w.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n.sort((_,w)=>_.length-w.length),n=n.filter((_,w)=>{for(let S=w+1;S<n.length;S++)if(n[S].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const g=n.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class lf{constructor(){r.aV(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=P("div","mapboxgl-ctrl");const u=P("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const u in n){const g=n[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const u=n[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class EA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const _ of g)if(_.id===n)return void(_.cancelled=!0)}run(n=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Ec{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const u=r.dk((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,u,g){this._start=this.getValue(u),this._end=n,this._startTime=u,this._endTime=u+g}}const Xf={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class To extends r.A{constructor(n,u,g,_){const{point:w,lngLat:S,originalEvent:L,target:M}=n;super(n.type,{point:w,lngLat:S,originalEvent:L,target:M}),this.preventDefault=()=>{n.preventDefault()},this.id=u,this.interaction=g,this.feature=_}}class $u{constructor(n){this.map=n,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(n,u){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const g=u.filter;let _=u.type;g&&this.filters.set(n,r.b3(g)),_==="mouseover"&&(_="mouseenter"),_==="mouseout"&&(_="mouseleave");const w=this.interactionsByType.get(_)||new Map;_==="mouseenter"||_==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(n,u)):w.size===0&&this.map.on(_,this.handleType),w.size===0&&this.interactionsByType.set(_,w),w.set(n,u),this.typeById.set(n,_)}get(n){const u=this.typeById.get(n);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(n):void 0}remove(n){const u=this.typeById.get(n);if(!u)return;this.typeById.delete(n),this.filters.delete(n);const g=this.interactionsByType.get(u);g&&(g.delete(n),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(n),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(n,u){const g=[];for(const[_,w]of u)w.target&&g.push({targetId:_,target:w.target,filter:this.filters.get(_)});return this.map.style.queryRenderedTargets(n,g,this.map.transform)}handleMove(n){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(n.point,Array.from(this.delegatedInteractions).reverse());u.length&&(n.type="mouseenter",this.handleType(n,u));const g=new Map;for(const[_,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(_)||g.set(w.id,w);g.size&&(n.type="mouseleave",this.handleType(n,Array.from(g.values())))}handleOut(n){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(n.type="mouseleave",this.handleType(n,u)),this.hoveredFeatures.clear()}handleType(n,u){const g=n.type==="mouseenter";if(g&&!this.interactionsByType.has(n.type))return void r.w("mouseenter interaction required for mouseleave to work.");const _=Array.from(this.interactionsByType.get(n.type)).reverse(),w=!!u;u=u||this.queryTargets(n.point,_);let S=!1;const L=new Set;for(const M of u){for(const[V,Y]of _){if(!Y.target)continue;const J=M.variants?M.variants[V]:null;if(J){for(const Z of J){if(zc(Z,M,L,V))continue;const te=new r.de(M,Z),de=ql(Z,M,V);w&&(te.state=this.map.getFeatureState(te));const ue=g?this.prevHoveredFeatures.get(de):null,ge=new To(n,V,Y,te),_e=ue?ue.stop:Y.handler(ge);if(g&&this.hoveredFeatures.set(de,{feature:M,stop:_e}),_e!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[M,V]of _){const{handler:Y,target:J}=V;if(!J&&Y(new To(n,M,V,null))!==!1)break}}}function cf(p,n){if(Array.isArray(p)&&Array.isArray(n)){const u=new Set(p),g=new Set(n);return u.size===g.size&&p.every(_=>g.has(_))}return r.bv(p,n)}const Yf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Kf={showCompass:!0,showZoom:!0,visualizePitch:!1};class gm{constructor(n,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new sf({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,g&&(this.mousePitch=new Mh({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),r.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(n,u){this.mouseRotate.mousedown(n,u),this.mousePitch&&this.mousePitch.mousedown(n,u),ne()}move(n,u){const g=this.map,_=this.mouseRotate.mousemoveWindow(n,u),w=_&&_.bearingDelta;if(w&&g.setBearing(g.getBearing()+w),this.mousePitch){const S=this.mousePitch.mousemoveWindow(n,u),L=S&&S.pitchDelta;L&&g.setPitch(g.getPitch()+L)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){re(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(r.h({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),he(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,he(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=be(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=be(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function TA(p,n,u){if(p=new r.cd(p.lng,p.lat),n){const g=new r.cd(p.lng-360,p.lat),_=new r.cd(p.lng+360,p.lat),w=360*Math.ceil(Math.abs(p.lng-u.center.lng)/360),S=u.locationPoint3D(p).distSqr(n),L=n.x<0||n.y<0||n.x>u.width||n.y>u.height;u.locationPoint3D(g).distSqr(n)<S&&(L||Math.abs(g.lng-u.center.lng)<w)?p=g:u.locationPoint3D(_).distSqr(n)<S&&(L||Math.abs(_.lng-u.center.lng)<w)&&(p=_)}for(;Math.abs(p.lng-u.center.lng)>180;){const g=u.locationPoint3D(p);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;p.lng>u.center.lng?p.lng-=360:p.lng+=360}return p}const Op={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Zu={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class uf extends r.E{constructor(n,u){super(),(n instanceof HTMLElement||u)&&(n=r.h({element:n},u)),r.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:_="#3FB1CE",scale:w=1,draggable:S=!1,clickTolerance:L=0,rotation:M=Zu.rotation,rotationAlignment:V=Zu.rotationAlignment,pitchAlignment:Y=Zu.pitchAlignment,occludedOpacity:J=Zu.occludedOpacity,altitude:Z=Zu.altitude}=n||{};this._anchor=g,this._color=_,this._scale=w,this._draggable=S,this._clickTolerance=L,this._rotation=M,this._rotationAlignment=V,this._pitchAlignment=Y,this._occludedOpacity=J,this._altitude=Z,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),n&&n.element?(this._element=n.element,this._offset=r.P.convert(n&&n.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=r.P.convert(n&&n.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",ue=>{ue.preventDefault()}),this._element.addEventListener("mousedown",ue=>{ue.preventDefault()});const te=this._element.classList;for(const ue in Op)te.remove(`mapboxgl-marker-anchor-${ue}`);te.add(`mapboxgl-marker-anchor-${this._anchor}`);const de=n&&n.className?n.className.trim().split(/\s+/):[];te.add(...de),this._popup=null}_createDefaultMarker(){const n=P("div"),u=G("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},n);if(this._altitude===0){const g=G("radialGradient",{id:"shadowGradient"},G("defs",{},u));G("stop",{offset:"10%","stop-opacity":.4},g),G("stop",{offset:"100%","stop-opacity":.05},g),G("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return G("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),G("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),G("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),n}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=r.cd.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(n){return n===this._altitude||(this._defaultMarker&&(this._altitude===0&&n!==0||this._altitude!==0&&n===0)&&(this._element=this._createDefaultMarker()),this._altitude=n||Zu.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,n._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const u=n.code,g=n.charCode||n.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(n){const u=n.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,u=this._pos;if(!n||!u)return!1;const g=n.unproject(u,this._altitude),_=n.getFreeCameraOptions();if(!_.position)return!1;const w=_.position.toLngLat();return w.distanceTo(g)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const u=this._pos;if(!u||u.x<0||u.x>n.transform.width||u.y<0||u.y>n.transform.height)return void this._clearFadeTimer();const g=n.unproject(u,this._altitude);let _;n._showingGlobe()&&r.eK(n.transform,this._lngLat)?_=0:(_=1-n._queryFogOpacity(g),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Op[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const n=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!n||g!=="map")return"";if(!u._showingGlobe()){const M=u.getPitch();return M?`rotateX(${M}deg)`:""}const _=r.cJ(r.eL(u.transform,this._lngLat)),w=n.sub(r.eM(u.transform)),S=Math.abs(w.x)+Math.abs(w.y);if(S===0)return"";const L=_/S;return`rotateX(${-w.y*L}deg) rotateY(${w.x*L}deg)`}_calculateZTransform(){const n=this._pos,u=this._map;if(!u||!n)return"";let g=0;const _=this.getRotationAlignment();if(_==="map")if(u._showingGlobe()){const w=u.project(new r.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),S=u.project(new r.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(w);g=r.cJ(Math.atan2(S.y,S.x))-90}else g=-u.getBearing();else if(_==="horizon"){const w=r.af(4,6,u.getZoom()),S=r.eM(u.transform);S.y+=w*u.transform.height;const L=n.sub(S),M=r.cJ(Math.atan2(L.y,L.x));g=(M>90?M-270:M+90)*(1-w)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=TA(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=r.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const u=this._map;if(!u)return;const g=this._pointerdownPos,_=this._positionDelta;if(g&&_){if(!this._isDragging){const w=this._clickTolerance||u._clickTolerance;if(n.point.dist(g)<w)return;this._isDragging=!0}this._pos=n.point.sub(_),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.A("dragstart"))),this.fire(new r.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.A("dragend")),this._state="inactive"}_addDragHandler(n){const u=this._map,g=this._pos;u&&g&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(g),this._pointerdownPos=n.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const u=this._map;return u&&(n?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||Zu.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||Zu.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||Zu.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||Zu.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const hf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ld={maxWidth:100,unit:"metric"},Md={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ph={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Iu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Tc(p=new r.P(0,0),n="bottom"){if(typeof p=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(n){case"top":return new r.P(0,p);case"top-left":return new r.P(u,u);case"top-right":return new r.P(-u,u);case"bottom":return new r.P(0,-p);case"bottom-left":return new r.P(u,-u);case"bottom-right":return new r.P(-u,-u);case"left":return new r.P(p,0);case"right":return new r.P(-p,0)}return new r.P(0,0)}return p instanceof r.P||Array.isArray(p)?r.P.convert(p):r.P.convert(p[n]||[0,0])}return{version:y,supported:R.supported,setRTLTextPlugin:r.eQ,getRTLTextPluginStatus:r.eP,Map:class extends Id{constructor(p){x.mark(b.create);const n=p;if((p=r.h({},Yf,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&r.eI(window)&&(p.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Oa(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies,null,null),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new EA,this._domRenderTaskQueue=new EA,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.a$(),this._locale=r.h({},Xf,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ec(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new Be(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const u=document.getElementById(p.container);if(!u)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=u}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,r.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new _d),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Wf(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||r.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new Ol(this),p.hash&&(this._hash=new Tp(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const u=p.bounds;u&&(this.resize(),this.fitBounds(u,r.h({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new Fd({customAttribution:p.customAttribution})),this._logoControl=new lf,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new r.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new r.A(`${u.dataType}dataloading`,u))}),this._interactions=new $u(this)}_getMapId(){return this._mapId}addControl(p,n){if(n===void 0&&(n=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new r.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=p.onAdd(this);this._controls.push(p);const g=this._controlPositions[n];return n.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new r.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(p);return n>-1&&this._controls.splice(n,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new r.A("movestart",p)).fire(new r.A("move",p)),this.fire(new r.A("resize",p)),n&&this.fire(new r.A("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(r.aG.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(n=>n.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(n=>n==="auto"?navigator.language:n):p}setLanguage(p){const n=this._parseLanguage(p);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,n=p.projection.name;let u;n==="globe"&&p.zoom>=r.cx?(p.setMercatorFromTransition(),u=!0):n==="mercator"&&p.zoom<r.cx&&(p.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(p,n){return this._updateProjection(p||n||{name:"mercator"})}_updateProjection(p){let n;return n=p.name==="globe"&&this.transform.zoom>=r.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p,n){return this.transform.locationPoint3D(r.cd.convert(p),n)}unproject(p,n){return this.transform.pointLocation3D(r.P.convert(p),n)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,n,u){const g=_=>{let w=[];if(Array.isArray(n)){const S=n.filter(L=>this.getLayer(L));w=S.length?this.queryRenderedFeatures(_,{layers:S}):[]}else w=this.queryRenderedFeatures(_,{target:n});return w};if(p==="mouseenter"||p==="mouseover"){let _=!1;return{listener:u,targets:n,delegates:{mousemove:S=>{const L=g(S.point);L.length?_||(_=!0,u.call(this,new Xa(p,this,S.originalEvent,{features:L}))):_=!1},mouseout:()=>{_=!1}}}}if(p==="mouseleave"||p==="mouseout"){let _=!1;return{listener:u,targets:n,delegates:{mousemove:L=>{g(L.point).length?_=!0:_&&(_=!1,u.call(this,new Xa(p,this,L.originalEvent)))},mouseout:L=>{_&&(_=!1,u.call(this,new Xa(p,this,L.originalEvent)))}}}}{const _=w=>{const S=g(w.point);S.length&&(w.features=S,u.call(this,w),delete w.features)};return{listener:u,targets:n,delegates:{[p]:_}}}}on(p,n,u){if(typeof n=="function"||u===void 0)return super.on(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._createDelegatedListener(p,n,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(g);for(const _ in g.delegates)this.on(_,g.delegates[_]);return this}once(p,n,u){if(typeof n=="function"||u===void 0)return super.once(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._createDelegatedListener(p,n,u);for(const _ in g.delegates)this.once(_,g.delegates[_]);return this}off(p,n,u){if(typeof n=="function"||u===void 0)return super.off(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._delegatedListeners?this._delegatedListeners[p]:void 0;return g&&(_=>{for(let w=0;w<_.length;w++){const S=_[w];if(S.listener===u&&cf(S.targets,n)){for(const L in S.delegates)this.off(L,S.delegates[L]);return _.splice(w,1),this}}})(g),this}queryRenderedFeatures(p,n){if(!this.style)return[];if(p===void 0||p instanceof r.P||Array.isArray(p)||n!==void 0||(n=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!n){const w=this.style.queryRenderedFeatures(p,void 0,this.transform),S=this.style.queryRenderedFeatureset(p,void 0,this.transform);return w.concat(S)}let u=!0;if(n.target&&(u=this._isTargetValid(n.target),u&&!n.layers))return this.style.queryRenderedFeatureset(p,n,this.transform);let g=!0;if(n.layers&&Array.isArray(n.layers)){for(const w of n.layers)if(!this._isValidId(w)){g=!1;break}if(g&&!n.target)return this.style.queryRenderedFeatures(p,n,this.transform)}let _=[];return g&&(_=_.concat(this.style.queryRenderedFeatures(p,n,this.transform))),u&&(_=_.concat(this.style.queryRenderedFeatureset(p,n,this.transform))),_}querySourceFeatures(p,n){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,n)}isPointOnSurface(p){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&r.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(p))}addInteraction(p,n){return this._interactions.add(p,n),this}removeInteraction(p){return this._interactions.remove(p),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this}setStyle(p,n){return n=r.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&p&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(p,(u,g)=>{if(u){const _=typeof u=="string"?u:u instanceof Error?u.message:u.error;r.w(`Unable to perform style diff: ${_}. Rebuilding the style from scratch.`),this._updateStyle(p,n)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(p,n))}_getUIString(p){const n=this._locale[p];if(n==null)throw new Error(`Missing UI string '${p}'`);return n}_updateStyle(p,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const u=r.h({},n);n&&n.config&&(u.initialConfig=n.config,delete u.config),this.style=new jo(this,u).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new jo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new r.z(new Error("IDs can't be empty."))),!1):!r.d8(p)||(this.fire(new r.z(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const n of p)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(p)}addSource(p,n){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,n),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,n,u){this._lazyInitEmptyStyle(),this.style.addSourceType(p,n,u)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,n,{pixelRatio:u=1,sdf:g=!1,stretchX:_,stretchY:w,content:S}={}){this._lazyInitEmptyStyle();const L=r.I.from(p);if(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:M,height:V,data:Y}=r.q.getImageData(n);this.style.addImage(L,{data:new r.r({width:M,height:V},Y),pixelRatio:u,stretchX:_,stretchY:w,content:S,sdf:g,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new r.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:V}=n,Y=n;this.style.addImage(L,{data:new r.r({width:M,height:V},new Uint8Array(Y.data)),pixelRatio:u,stretchX:_,stretchY:w,content:S,sdf:g,usvg:!1,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,p)}}updateImage(p,n){this._lazyInitEmptyStyle();const u=r.I.from(p),g=this.style.getImage(u);if(!g)return void this.fire(new r.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?r.q.getImageData(n):n,{width:w,height:S,data:L}=_;if(w===void 0||S===void 0)return void this.fire(new r.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||S!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new r.z(new Error(`The width and height of the updated image (${w}, ${S})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const M=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let V=!1;g.usvg?(g.data=new r.r({width:w,height:S},new Uint8Array(L)),g.usvg=!1,g.icon=void 0,V=!0):g.data.replace(L,M),this.style.updateImage(u,g,V)}hasImage(p){return p?!!this.style&&!!this.style.getImage(r.I.from(p)):(this.fire(new r.z(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(r.I.from(p))}loadImage(p,n){r.o(this._requestManager.transformRequest(p,r.R.Image),(u,g)=>{n(u,g instanceof HTMLImageElement?r.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(p=>p.name)}addModel(p,n){this._lazyInitEmptyStyle(),this.style.addModel(p,n)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new r.z(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,n){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,n),this._update(!0)):this}getSlot(p){const n=this.getLayer(p);return n&&n.slot||null}setSlot(p,n){return this.style.setSlot(p,n),this.style.mergeLayers(),this._update(!0)}addImport(p,n){return this.style.addImport(p,n).catch(u=>this.fire(new r.z(new Error("Failed to add import",u)))),this}updateImport(p,n){return typeof n!="string"&&n.id!==p?(this.removeImport(p),this.addImport(n)):(this.style.updateImport(p,n),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,n){return this.style.moveImport(p,n),this._update(!0)}moveLayer(p,n){return this._isValidId(p)?(this.style.moveLayer(p,n),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const n=this.style.getOwnLayer(p);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,n,u){return this._isValidId(p)?(this.style.setLayerZoomRange(p,n,u),this._update(!0)):this}setFilter(p,n,u={}){return this._isValidId(p)?(this.style.setFilter(p,n,u),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,n,u,g={}){return this._isValidId(p)?(this.style.setPaintProperty(p,n,u,g),this._update(!0)):this}getPaintProperty(p,n){return this._isValidId(p)?this.style.getPaintProperty(p,n):null}setLayoutProperty(p,n,u,g={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,n,u,g),this._update(!0)):this}getLayoutProperty(p,n){return this._isValidId(p)?this.style.getLayoutProperty(p,n):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(p){return this.style.setGlyphsUrl(p),this._update(!0)}getSchema(p){return this.style.getSchema(p)}setSchema(p,n){return this.style.setSchema(p,n),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,n){return this.style.setConfig(p,n),this._update(!0)}getConfigProperty(p,n){return this.style.getConfigProperty(p,n)}setConfigProperty(p,n,u){return this.style.setConfigProperty(p,n,u),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const n=p[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,n),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.cd.convert(p),this.transform):0}setFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,n),this._update())}removeFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,n),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let u,g,_,w=this._container;for(;w&&(!g||!_);){const S=window.getComputedStyle(w).transform;S&&S!=="none"&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(_=u[3])),w=w.parentElement}this._containerWidth=g?Math.abs(p/g):p,this._containerHeight=_?Math.abs(n/_):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=P("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=P("div","mapboxgl-canvas-container",p);this._canvas=P("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=P("div","mapboxgl-control-container",p),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(_=>{g[_]=P("div",`mapboxgl-ctrl-${_}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,n){const u=r.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(p),this._canvas.height=u*Math.ceil(n),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${n}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const n=this._markers.indexOf(p);n!==-1&&this._markers.splice(n,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const n=this._popups.indexOf(p);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const p=r.h({},R.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",p);n?(qe(n,!0),this.painter=new _A(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.l.testSupport(n)):this.fire(new r.z(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.A("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new r.A("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let n;this.fire(new r.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=r.q.now(),_=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=_.createQuery(),_.beginQuery(u.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,Y=this.transform.pitch,J=r.q.now(),Z=new r.aa(V,{now:J,fadeDuration:w,pitch:Y,transition:this.style.transition,worldview:this._worldview});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(g);const L=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),L&&(this._placementDirty=L.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,x.mark(b.load),this.fire(new r.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const V=r.q.now()-g;_.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=_.getQueryParameter(n,_.QUERY_RESULT)/1e6;_.deleteQuery(n),this.fire(new r.A("gpu-timing-frame",{cpuTime:V,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const V=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(V);this.fire(new r.A("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const V=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(V);this.fire(new r.A("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(M||this._repaint)this.triggerRepaint();else{const V=this.idle();if(V&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),V&&(this.fire(new r.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new r.A("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,x.mark(b.fullLoad),this._performanceMetricsCollection&&Bt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const n of this._markers)p&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!p||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(p,n=!1){const u=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(n||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const _=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=p;const S=Math.abs(_-w);if(S>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(w),u(w);this._averageElevation.easeTo(w,p,300)}else if(S>1e-4)return this._averageElevation.jumpTo(w),u(w)}return!!this._averageElevation.isEasing(p)&&u(this._averageElevation.getValue(p))}_authenticate(){Ut(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===Me||p.status===401)){const n=this.painter.context.gl;qe(n,!1),this._logoControl instanceof lf&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),ut(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Ct(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function _(w){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,w,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(_(p),n.canvasCopies.map(_),n.timeStamps)}_canvasPixelComparison(p,n,u){let g=u[1]-u[0];const _=p.length/4;for(let w=0;w<n.length;w++){const S=n[w];let L=0;for(let M=0;M<S.length;M+=4)S[M]===p[M]&&S[M+1]===p[M+1]&&S[M+2]===p[M+2]&&S[M+3]===p[M+3]&&(L+=1);g+=(u[w+2]-u[w+1])*(1-L/_)}return g}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ai.delete(this.painter.context.gl),tt.remove(),ot.remove(),this._removed=!0,this.fire(new r.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=r.q.frame(n=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(n)}))}_preloadTiles(p){const n=this.style?this.style.getSourceCaches():[];return r.bt(n,(u,g)=>u._preloadTiles(p,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,n){r.eJ(p,n)}get version(){return y}},NavigationControl:class{constructor(p={}){this.options=r.h({},Kf,p),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(r.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),P("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),P("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:n}):u.resetNorth({},{originalEvent:n}))}),this._compassIcon=P("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const n=p.getZoom(),u=n===p.getMaxZoom(),g=n===p.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gm(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,n){const u=P("button",p,this._container);return u.type="button",u.addEventListener("click",n),u}_setButtonTitle(p,n){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${n}`);p.setAttribute("aria-label",u),p.firstElementChild&&p.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends r.E{constructor(p={}){super();const n=navigator.geolocation;this.options=r.h({geolocation:n},hf,p),r.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=qh(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const n=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,p(u)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>n(u.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(p){const n=this._map.getMaxBounds(),u=p.coords;return!!n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new r.A("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("geolocate",p)),this._finish()}}_updateCamera(p){const n=new r.cd(p.coords.longitude,p.coords.latitude),u=p.coords.accuracy,g=this._map.getBearing(),_=r.h({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(u),_,{geolocateSource:!0})}_updateMarker(p){if(p){const n=new r.cd(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,n=r.c6(1,p._center.lat)*p.worldSize,u=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=P("button","mapboxgl-ctrl-geolocate",this._container),P("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P("div","mapboxgl-user-location"),this._dotElement.appendChild(P("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(P("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new uf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=P("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new uf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.A("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Fd,ScaleControl:class{constructor(p={}){this.options=r.h({},Ld,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,n=this._map,u=n._containerHeight/2,g=n._containerWidth/2-p/2,_=n.unproject([g,u]),w=n.unproject([g+p,u]),S=_.distanceTo(w);if(this.options.unit==="imperial"){const L=3.2808*S;L>5280?this._setScale(p,L/5280,"mile"):this._setScale(p,L,"foot")}else this.options.unit==="nautical"?this._setScale(p,S/1852,"nautical-mile"):S>=1e3?this._setScale(p,S/1e3,"kilometer"):this._setScale(p,S,"meter")}_setScale(p,n,u){this._map._requestDomTask(()=>{const g=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let L=w/S;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(M){const V=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*V)/V}(L),S*L}(n),_=g/n;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${Md[u]}`,this._container.style.width=p*_+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:r.w("Full screen control 'container' must be a DOM element.")),r.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=P("button","mapboxgl-ctrl-fullscreen",this._controlContainer);P("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(p){super(),this.options=r.h(Object.create(Ph),p),this._altitude=this.options.altitude,r.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new r.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new r.A("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=r.cd.convert(p),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(p){return this._altitude=p,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const n=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=p;g=u.firstChild,g;)n.appendChild(g);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=P("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(p),this.options.closeButton){const u=this._closeButton=P("button","mapboxgl-popup-close-button",n);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let n;return this._classList.delete(p)?n=!1:(this._classList.add(p),n=!0),this._updateClassList(),n}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const n=this._map,u=this._container,g=this._pos;if(!n||!u||!g)return"bottom";const _=u.offsetWidth,w=u.offsetHeight,S=g.x<_/2,L=g.x>n.transform.width-_/2;if(g.y+p<w)return S?"top-left":L?"top-right":"top";if(g.y>n.transform.height-w){if(S)return"bottom-left";if(L)return"bottom-right"}return S?"left":L?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),p.className=n.join(" ")}_update(p){const n=this._map,u=this._content;if(!n||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=P("div","mapboxgl-popup",n.getContainer()),this._tip=P("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=TA(this._lngLat,this._pos,n.transform)),!this._trackPointer||p){const _=this._pos=this._trackPointer&&p instanceof r.P?p:n.project(this._lngLat,this._altitude),w=Tc(this.options.offset),S=this._anchor=this._getAnchor(w.y),L=Tc(this.options.offset,S),M=_.add(L).round();n._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Op[S]} translate(${M.x}px,${M.y}px)`)})}if(!this._marker&&n._showingGlobe()){const _=r.eK(n.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Iu);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:uf,Style:jo,LngLat:r.cd,LngLatBounds:r.aG,Point:r.P,MercatorCoordinate:r.ac,FreeCameraOptions:Xo,Evented:r.E,config:r.e,prewarm:r.eO,clearPrewarmedResources:r.eN,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(p){r.e.ACCESS_TOKEN=p},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(p){r.e.API_URL=p},get workerCount(){return r.eX.workerCount},set workerCount(p){r.eX.workerCount=p},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){r.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){r.eW(p)},get workerUrl(){return r.eV.workerUrl},set workerUrl(p){r.eV.workerUrl=p},get workerClass(){return r.eV.workerClass},set workerClass(p){r.eV.workerClass=p},get workerParams(){return r.eV.workerParams},set workerParams(p){r.eV.workerParams=p},get dracoUrl(){return r.eU()},set dracoUrl(p){r.eT(p)},get meshoptUrl(){return r.eS()},set meshoptUrl(p){r.eR(p)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var A=c;return A})}(yv)),yv.exports}var Nz=zz();const sy=N1(Nz),jz={__name:"MapView",props:{meters:{type:Array,required:!0},role:{type:String,default:"visualizer"}},setup(a){const e=a,i=fr(null);let s;return _p(()=>{sy.accessToken="pk.eyJ1IjoibXV4b2RldXMiLCJhIjoiY2lsanBmZGxhNTN5a3ZybTByYjA1YWhqZSJ9.kspPh-wlVRf49UlMVbrDtA",s=new sy.Map({container:i.value,style:"mapbox://styles/mapbox/streets-v11",center:[-89.19,13.71],zoom:7}),s.addControl(new sy.NavigationControl),e.meters.forEach(c=>{const d=new sy.Popup({offset:25}).setHTML(`
      <strong>${c.name}</strong><br/>
      Estado: ${c.status}<br/>
      ${e.role==="admin"?"<button>Editar</button>":""}
    `);new sy.Marker({color:c.status==="activo"?"#3bb2d0":"#d9534f"}).setLngLat([c.lng,c.lat]).setPopup(d).addTo(s)})}),Ty(()=>{s==null||s.remove()}),(c,d)=>(os(),Hs("div",{class:"map-container",ref_key:"mapContainer",ref:i},null,512))}},Hz=Uc(jz,[["__scopeId","data-v-2749196a"]]);function CI(a,e){return function(){return a.apply(e,arguments)}}const{toString:Qz}=Object.prototype,{getPrototypeOf:nw}=Object,{iterator:h_,toStringTag:SI}=Symbol,d_=(a=>e=>{const i=Qz.call(e);return a[i]||(a[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),Zd=a=>(a=a.toLowerCase(),e=>d_(e)===a),A_=a=>e=>typeof e===a,{isArray:fm}=Array,jy=A_("undefined");function Vz(a){return a!==null&&!jy(a)&&a.constructor!==null&&!jy(a.constructor)&&sh(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const EI=Zd("ArrayBuffer");function Gz(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&EI(a.buffer),e}const Wz=A_("string"),sh=A_("function"),TI=A_("number"),f_=a=>a!==null&&typeof a=="object",Xz=a=>a===!0||a===!1,vv=a=>{if(d_(a)!=="object")return!1;const e=nw(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(SI in a)&&!(h_ in a)},Yz=Zd("Date"),Kz=Zd("File"),qz=Zd("Blob"),$z=Zd("FileList"),Zz=a=>f_(a)&&sh(a.pipe),Jz=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||sh(a.append)&&((e=d_(a))==="formdata"||e==="object"&&sh(a.toString)&&a.toString()==="[object FormData]"))},eN=Zd("URLSearchParams"),[tN,iN,rN,nN]=["ReadableStream","Request","Response","Headers"].map(Zd),sN=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Jy(a,e,{allOwnKeys:i=!1}={}){if(a===null||typeof a>"u")return;let s,c;if(typeof a!="object"&&(a=[a]),fm(a))for(s=0,c=a.length;s<c;s++)e.call(null,a[s],s,a);else{const d=i?Object.getOwnPropertyNames(a):Object.keys(a),A=d.length;let r;for(s=0;s<A;s++)r=d[s],e.call(null,a[r],r,a)}}function II(a,e){e=e.toLowerCase();const i=Object.keys(a);let s=i.length,c;for(;s-- >0;)if(c=i[s],e===c.toLowerCase())return c;return null}const ag=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,FI=a=>!jy(a)&&a!==ag;function A1(){const{caseless:a}=FI(this)&&this||{},e={},i=(s,c)=>{const d=a&&II(e,c)||c;vv(e[d])&&vv(s)?e[d]=A1(e[d],s):vv(s)?e[d]=A1({},s):fm(s)?e[d]=s.slice():e[d]=s};for(let s=0,c=arguments.length;s<c;s++)arguments[s]&&Jy(arguments[s],i);return e}const oN=(a,e,i,{allOwnKeys:s}={})=>(Jy(e,(c,d)=>{i&&sh(c)?a[d]=CI(c,i):a[d]=c},{allOwnKeys:s}),a),aN=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),lN=(a,e,i,s)=>{a.prototype=Object.create(e.prototype,s),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),i&&Object.assign(a.prototype,i)},cN=(a,e,i,s)=>{let c,d,A;const r={};if(e=e||{},a==null)return e;do{for(c=Object.getOwnPropertyNames(a),d=c.length;d-- >0;)A=c[d],(!s||s(A,a,e))&&!r[A]&&(e[A]=a[A],r[A]=!0);a=i!==!1&&nw(a)}while(a&&(!i||i(a,e))&&a!==Object.prototype);return e},uN=(a,e,i)=>{a=String(a),(i===void 0||i>a.length)&&(i=a.length),i-=e.length;const s=a.indexOf(e,i);return s!==-1&&s===i},hN=a=>{if(!a)return null;if(fm(a))return a;let e=a.length;if(!TI(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=a[e];return i},dN=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&nw(Uint8Array)),AN=(a,e)=>{const s=(a&&a[h_]).call(a);let c;for(;(c=s.next())&&!c.done;){const d=c.value;e.call(a,d[0],d[1])}},fN=(a,e)=>{let i;const s=[];for(;(i=a.exec(e))!==null;)s.push(i);return s},pN=Zd("HTMLFormElement"),gN=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,s,c){return s.toUpperCase()+c}),RE=(({hasOwnProperty:a})=>(e,i)=>a.call(e,i))(Object.prototype),mN=Zd("RegExp"),LI=(a,e)=>{const i=Object.getOwnPropertyDescriptors(a),s={};Jy(i,(c,d)=>{let A;(A=e(c,d,a))!==!1&&(s[d]=A||c)}),Object.defineProperties(a,s)},yN=a=>{LI(a,(e,i)=>{if(sh(a)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const s=a[i];if(sh(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},vN=(a,e)=>{const i={},s=c=>{c.forEach(d=>{i[d]=!0})};return fm(a)?s(a):s(String(a).split(e)),i},_N=()=>{},xN=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function bN(a){return!!(a&&sh(a.append)&&a[SI]==="FormData"&&a[h_])}const wN=a=>{const e=new Array(10),i=(s,c)=>{if(f_(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[c]=s;const d=fm(s)?[]:{};return Jy(s,(A,r)=>{const y=i(A,c+1);!jy(y)&&(d[r]=y)}),e[c]=void 0,d}}return s};return i(a,0)},BN=Zd("AsyncFunction"),CN=a=>a&&(f_(a)||sh(a))&&sh(a.then)&&sh(a.catch),MI=((a,e)=>a?setImmediate:e?((i,s)=>(ag.addEventListener("message",({source:c,data:d})=>{c===ag&&d===i&&s.length&&s.shift()()},!1),c=>{s.push(c),ag.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",sh(ag.postMessage)),SN=typeof queueMicrotask<"u"?queueMicrotask.bind(ag):typeof process<"u"&&process.nextTick||MI,EN=a=>a!=null&&sh(a[h_]),Qi={isArray:fm,isArrayBuffer:EI,isBuffer:Vz,isFormData:Jz,isArrayBufferView:Gz,isString:Wz,isNumber:TI,isBoolean:Xz,isObject:f_,isPlainObject:vv,isReadableStream:tN,isRequest:iN,isResponse:rN,isHeaders:nN,isUndefined:jy,isDate:Yz,isFile:Kz,isBlob:qz,isRegExp:mN,isFunction:sh,isStream:Zz,isURLSearchParams:eN,isTypedArray:dN,isFileList:$z,forEach:Jy,merge:A1,extend:oN,trim:sN,stripBOM:aN,inherits:lN,toFlatObject:cN,kindOf:d_,kindOfTest:Zd,endsWith:uN,toArray:hN,forEachEntry:AN,matchAll:fN,isHTMLForm:pN,hasOwnProperty:RE,hasOwnProp:RE,reduceDescriptors:LI,freezeMethods:yN,toObjectSet:vN,toCamelCase:gN,noop:_N,toFiniteNumber:xN,findKey:II,global:ag,isContextDefined:FI,isSpecCompliantForm:bN,toJSONObject:wN,isAsyncFn:BN,isThenable:CN,setImmediate:MI,asap:SN,isIterable:EN};function Ts(a,e,i,s,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),s&&(this.request=s),c&&(this.response=c,this.status=c.status?c.status:null)}Qi.inherits(Ts,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qi.toJSONObject(this.config),code:this.code,status:this.status}}});const PI=Ts.prototype,kI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{kI[a]={value:a}});Object.defineProperties(Ts,kI);Object.defineProperty(PI,"isAxiosError",{value:!0});Ts.from=(a,e,i,s,c,d)=>{const A=Object.create(PI);return Qi.toFlatObject(a,A,function(y){return y!==Error.prototype},r=>r!=="isAxiosError"),Ts.call(A,a.message,e,i,s,c),A.cause=a,A.name=a.name,d&&Object.assign(A,d),A};const TN=null;function f1(a){return Qi.isPlainObject(a)||Qi.isArray(a)}function RI(a){return Qi.endsWith(a,"[]")?a.slice(0,-2):a}function DE(a,e,i){return a?a.concat(e).map(function(c,d){return c=RI(c),!i&&d?"["+c+"]":c}).join(i?".":""):e}function IN(a){return Qi.isArray(a)&&!a.some(f1)}const FN=Qi.toFlatObject(Qi,{},null,function(e){return/^is[A-Z]/.test(e)});function p_(a,e,i){if(!Qi.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,i=Qi.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(P,G){return!Qi.isUndefined(G[P])});const s=i.metaTokens,c=i.visitor||x,d=i.dots,A=i.indexes,y=(i.Blob||typeof Blob<"u"&&Blob)&&Qi.isSpecCompliantForm(e);if(!Qi.isFunction(c))throw new TypeError("visitor must be a function");function b(R){if(R===null)return"";if(Qi.isDate(R))return R.toISOString();if(Qi.isBoolean(R))return R.toString();if(!y&&Qi.isBlob(R))throw new Ts("Blob is not supported. Use a Buffer instead.");return Qi.isArrayBuffer(R)||Qi.isTypedArray(R)?y&&typeof Blob=="function"?new Blob([R]):Buffer.from(R):R}function x(R,P,G){let U=R;if(R&&!G&&typeof R=="object"){if(Qi.endsWith(P,"{}"))P=s?P:P.slice(0,-2),R=JSON.stringify(R);else if(Qi.isArray(R)&&IN(R)||(Qi.isFileList(R)||Qi.endsWith(P,"[]"))&&(U=Qi.toArray(R)))return P=RI(P),U.forEach(function(q,ne){!(Qi.isUndefined(q)||q===null)&&e.append(A===!0?DE([P],ne,d):A===null?P:P+"[]",b(q))}),!1}return f1(R)?!0:(e.append(DE(G,P,d),b(R)),!1)}const B=[],T=Object.assign(FN,{defaultVisitor:x,convertValue:b,isVisitable:f1});function E(R,P){if(!Qi.isUndefined(R)){if(B.indexOf(R)!==-1)throw Error("Circular reference detected in "+P.join("."));B.push(R),Qi.forEach(R,function(U,Q){(!(Qi.isUndefined(U)||U===null)&&c.call(e,U,Qi.isString(Q)?Q.trim():Q,P,T))===!0&&E(U,P?P.concat(Q):[Q])}),B.pop()}}if(!Qi.isObject(a))throw new TypeError("data must be an object");return E(a),e}function OE(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function sw(a,e){this._pairs=[],a&&p_(a,this,e)}const DI=sw.prototype;DI.append=function(e,i){this._pairs.push([e,i])};DI.toString=function(e){const i=e?function(s){return e.call(this,s,OE)}:OE;return this._pairs.map(function(c){return i(c[0])+"="+i(c[1])},"").join("&")};function LN(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function OI(a,e,i){if(!e)return a;const s=i&&i.encode||LN;Qi.isFunction(i)&&(i={serialize:i});const c=i&&i.serialize;let d;if(c?d=c(e,i):d=Qi.isURLSearchParams(e)?e.toString():new sw(e,i).toString(s),d){const A=a.indexOf("#");A!==-1&&(a=a.slice(0,A)),a+=(a.indexOf("?")===-1?"?":"&")+d}return a}class UE{constructor(){this.handlers=[]}use(e,i,s){return this.handlers.push({fulfilled:e,rejected:i,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Qi.forEach(this.handlers,function(s){s!==null&&e(s)})}}const UI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},MN=typeof URLSearchParams<"u"?URLSearchParams:sw,PN=typeof FormData<"u"?FormData:null,kN=typeof Blob<"u"?Blob:null,RN={isBrowser:!0,classes:{URLSearchParams:MN,FormData:PN,Blob:kN},protocols:["http","https","file","blob","url","data"]},ow=typeof window<"u"&&typeof document<"u",p1=typeof navigator=="object"&&navigator||void 0,DN=ow&&(!p1||["ReactNative","NativeScript","NS"].indexOf(p1.product)<0),ON=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",UN=ow&&window.location.href||"http://localhost",zN=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ow,hasStandardBrowserEnv:DN,hasStandardBrowserWebWorkerEnv:ON,navigator:p1,origin:UN},Symbol.toStringTag,{value:"Module"})),au={...zN,...RN};function NN(a,e){return p_(a,new au.classes.URLSearchParams,Object.assign({visitor:function(i,s,c,d){return au.isNode&&Qi.isBuffer(i)?(this.append(s,i.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},e))}function jN(a){return Qi.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function HN(a){const e={},i=Object.keys(a);let s;const c=i.length;let d;for(s=0;s<c;s++)d=i[s],e[d]=a[d];return e}function zI(a){function e(i,s,c,d){let A=i[d++];if(A==="__proto__")return!0;const r=Number.isFinite(+A),y=d>=i.length;return A=!A&&Qi.isArray(c)?c.length:A,y?(Qi.hasOwnProp(c,A)?c[A]=[c[A],s]:c[A]=s,!r):((!c[A]||!Qi.isObject(c[A]))&&(c[A]=[]),e(i,s,c[A],d)&&Qi.isArray(c[A])&&(c[A]=HN(c[A])),!r)}if(Qi.isFormData(a)&&Qi.isFunction(a.entries)){const i={};return Qi.forEachEntry(a,(s,c)=>{e(jN(s),c,i,0)}),i}return null}function QN(a,e,i){if(Qi.isString(a))try{return(e||JSON.parse)(a),Qi.trim(a)}catch(s){if(s.name!=="SyntaxError")throw s}return(i||JSON.stringify)(a)}const e0={transitional:UI,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const s=i.getContentType()||"",c=s.indexOf("application/json")>-1,d=Qi.isObject(e);if(d&&Qi.isHTMLForm(e)&&(e=new FormData(e)),Qi.isFormData(e))return c?JSON.stringify(zI(e)):e;if(Qi.isArrayBuffer(e)||Qi.isBuffer(e)||Qi.isStream(e)||Qi.isFile(e)||Qi.isBlob(e)||Qi.isReadableStream(e))return e;if(Qi.isArrayBufferView(e))return e.buffer;if(Qi.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(d){if(s.indexOf("application/x-www-form-urlencoded")>-1)return NN(e,this.formSerializer).toString();if((r=Qi.isFileList(e))||s.indexOf("multipart/form-data")>-1){const y=this.env&&this.env.FormData;return p_(r?{"files[]":e}:e,y&&new y,this.formSerializer)}}return d||c?(i.setContentType("application/json",!1),QN(e)):e}],transformResponse:[function(e){const i=this.transitional||e0.transitional,s=i&&i.forcedJSONParsing,c=this.responseType==="json";if(Qi.isResponse(e)||Qi.isReadableStream(e))return e;if(e&&Qi.isString(e)&&(s&&!this.responseType||c)){const A=!(i&&i.silentJSONParsing)&&c;try{return JSON.parse(e)}catch(r){if(A)throw r.name==="SyntaxError"?Ts.from(r,Ts.ERR_BAD_RESPONSE,this,null,this.response):r}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:au.classes.FormData,Blob:au.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qi.forEach(["delete","get","head","post","put","patch"],a=>{e0.headers[a]={}});const VN=Qi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),GN=a=>{const e={};let i,s,c;return a&&a.split(`
`).forEach(function(A){c=A.indexOf(":"),i=A.substring(0,c).trim().toLowerCase(),s=A.substring(c+1).trim(),!(!i||e[i]&&VN[i])&&(i==="set-cookie"?e[i]?e[i].push(s):e[i]=[s]:e[i]=e[i]?e[i]+", "+s:s)}),e},zE=Symbol("internals");function oy(a){return a&&String(a).trim().toLowerCase()}function _v(a){return a===!1||a==null?a:Qi.isArray(a)?a.map(_v):String(a)}function WN(a){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=i.exec(a);)e[s[1]]=s[2];return e}const XN=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function _b(a,e,i,s,c){if(Qi.isFunction(s))return s.call(this,e,i);if(c&&(e=i),!!Qi.isString(e)){if(Qi.isString(s))return e.indexOf(s)!==-1;if(Qi.isRegExp(s))return s.test(e)}}function YN(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,s)=>i.toUpperCase()+s)}function KN(a,e){const i=Qi.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(a,s+i,{value:function(c,d,A){return this[s].call(this,e,c,d,A)},configurable:!0})})}let oh=class{constructor(e){e&&this.set(e)}set(e,i,s){const c=this;function d(r,y,b){const x=oy(y);if(!x)throw new Error("header name must be a non-empty string");const B=Qi.findKey(c,x);(!B||c[B]===void 0||b===!0||b===void 0&&c[B]!==!1)&&(c[B||y]=_v(r))}const A=(r,y)=>Qi.forEach(r,(b,x)=>d(b,x,y));if(Qi.isPlainObject(e)||e instanceof this.constructor)A(e,i);else if(Qi.isString(e)&&(e=e.trim())&&!XN(e))A(GN(e),i);else if(Qi.isObject(e)&&Qi.isIterable(e)){let r={},y,b;for(const x of e){if(!Qi.isArray(x))throw TypeError("Object iterator must return a key-value pair");r[b=x[0]]=(y=r[b])?Qi.isArray(y)?[...y,x[1]]:[y,x[1]]:x[1]}A(r,i)}else e!=null&&d(i,e,s);return this}get(e,i){if(e=oy(e),e){const s=Qi.findKey(this,e);if(s){const c=this[s];if(!i)return c;if(i===!0)return WN(c);if(Qi.isFunction(i))return i.call(this,c,s);if(Qi.isRegExp(i))return i.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=oy(e),e){const s=Qi.findKey(this,e);return!!(s&&this[s]!==void 0&&(!i||_b(this,this[s],s,i)))}return!1}delete(e,i){const s=this;let c=!1;function d(A){if(A=oy(A),A){const r=Qi.findKey(s,A);r&&(!i||_b(s,s[r],r,i))&&(delete s[r],c=!0)}}return Qi.isArray(e)?e.forEach(d):d(e),c}clear(e){const i=Object.keys(this);let s=i.length,c=!1;for(;s--;){const d=i[s];(!e||_b(this,this[d],d,e,!0))&&(delete this[d],c=!0)}return c}normalize(e){const i=this,s={};return Qi.forEach(this,(c,d)=>{const A=Qi.findKey(s,d);if(A){i[A]=_v(c),delete i[d];return}const r=e?YN(d):String(d).trim();r!==d&&delete i[d],i[r]=_v(c),s[r]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return Qi.forEach(this,(s,c)=>{s!=null&&s!==!1&&(i[c]=e&&Qi.isArray(s)?s.join(", "):s)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const s=new this(e);return i.forEach(c=>s.set(c)),s}static accessor(e){const s=(this[zE]=this[zE]={accessors:{}}).accessors,c=this.prototype;function d(A){const r=oy(A);s[r]||(KN(c,A),s[r]=!0)}return Qi.isArray(e)?e.forEach(d):d(e),this}};oh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Qi.reduceDescriptors(oh.prototype,({value:a},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(s){this[i]=s}}});Qi.freezeMethods(oh);function xb(a,e){const i=this||e0,s=e||i,c=oh.from(s.headers);let d=s.data;return Qi.forEach(a,function(r){d=r.call(i,d,c.normalize(),e?e.status:void 0)}),c.normalize(),d}function NI(a){return!!(a&&a.__CANCEL__)}function pm(a,e,i){Ts.call(this,a??"canceled",Ts.ERR_CANCELED,e,i),this.name="CanceledError"}Qi.inherits(pm,Ts,{__CANCEL__:!0});function jI(a,e,i){const s=i.config.validateStatus;!i.status||!s||s(i.status)?a(i):e(new Ts("Request failed with status code "+i.status,[Ts.ERR_BAD_REQUEST,Ts.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function qN(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function $N(a,e){a=a||10;const i=new Array(a),s=new Array(a);let c=0,d=0,A;return e=e!==void 0?e:1e3,function(y){const b=Date.now(),x=s[d];A||(A=b),i[c]=y,s[c]=b;let B=d,T=0;for(;B!==c;)T+=i[B++],B=B%a;if(c=(c+1)%a,c===d&&(d=(d+1)%a),b-A<e)return;const E=x&&b-x;return E?Math.round(T*1e3/E):void 0}}function ZN(a,e){let i=0,s=1e3/e,c,d;const A=(b,x=Date.now())=>{i=x,c=null,d&&(clearTimeout(d),d=null),a.apply(null,b)};return[(...b)=>{const x=Date.now(),B=x-i;B>=s?A(b,x):(c=b,d||(d=setTimeout(()=>{d=null,A(c)},s-B)))},()=>c&&A(c)]}const jv=(a,e,i=3)=>{let s=0;const c=$N(50,250);return ZN(d=>{const A=d.loaded,r=d.lengthComputable?d.total:void 0,y=A-s,b=c(y),x=A<=r;s=A;const B={loaded:A,total:r,progress:r?A/r:void 0,bytes:y,rate:b||void 0,estimated:b&&r&&x?(r-A)/b:void 0,event:d,lengthComputable:r!=null,[e?"download":"upload"]:!0};a(B)},i)},NE=(a,e)=>{const i=a!=null;return[s=>e[0]({lengthComputable:i,total:a,loaded:s}),e[1]]},jE=a=>(...e)=>Qi.asap(()=>a(...e)),JN=au.hasStandardBrowserEnv?((a,e)=>i=>(i=new URL(i,au.origin),a.protocol===i.protocol&&a.host===i.host&&(e||a.port===i.port)))(new URL(au.origin),au.navigator&&/(msie|trident)/i.test(au.navigator.userAgent)):()=>!0,e6=au.hasStandardBrowserEnv?{write(a,e,i,s,c,d){const A=[a+"="+encodeURIComponent(e)];Qi.isNumber(i)&&A.push("expires="+new Date(i).toGMTString()),Qi.isString(s)&&A.push("path="+s),Qi.isString(c)&&A.push("domain="+c),d===!0&&A.push("secure"),document.cookie=A.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function t6(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function i6(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function HI(a,e,i){let s=!t6(e);return a&&(s||i==!1)?i6(a,e):e}const HE=a=>a instanceof oh?{...a}:a;function mg(a,e){e=e||{};const i={};function s(b,x,B,T){return Qi.isPlainObject(b)&&Qi.isPlainObject(x)?Qi.merge.call({caseless:T},b,x):Qi.isPlainObject(x)?Qi.merge({},x):Qi.isArray(x)?x.slice():x}function c(b,x,B,T){if(Qi.isUndefined(x)){if(!Qi.isUndefined(b))return s(void 0,b,B,T)}else return s(b,x,B,T)}function d(b,x){if(!Qi.isUndefined(x))return s(void 0,x)}function A(b,x){if(Qi.isUndefined(x)){if(!Qi.isUndefined(b))return s(void 0,b)}else return s(void 0,x)}function r(b,x,B){if(B in e)return s(b,x);if(B in a)return s(void 0,b)}const y={url:d,method:d,data:d,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:r,headers:(b,x,B)=>c(HE(b),HE(x),B,!0)};return Qi.forEach(Object.keys(Object.assign({},a,e)),function(x){const B=y[x]||c,T=B(a[x],e[x],x);Qi.isUndefined(T)&&B!==r||(i[x]=T)}),i}const QI=a=>{const e=mg({},a);let{data:i,withXSRFToken:s,xsrfHeaderName:c,xsrfCookieName:d,headers:A,auth:r}=e;e.headers=A=oh.from(A),e.url=OI(HI(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),r&&A.set("Authorization","Basic "+btoa((r.username||"")+":"+(r.password?unescape(encodeURIComponent(r.password)):"")));let y;if(Qi.isFormData(i)){if(au.hasStandardBrowserEnv||au.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((y=A.getContentType())!==!1){const[b,...x]=y?y.split(";").map(B=>B.trim()).filter(Boolean):[];A.setContentType([b||"multipart/form-data",...x].join("; "))}}if(au.hasStandardBrowserEnv&&(s&&Qi.isFunction(s)&&(s=s(e)),s||s!==!1&&JN(e.url))){const b=c&&d&&e6.read(d);b&&A.set(c,b)}return e},r6=typeof XMLHttpRequest<"u",n6=r6&&function(a){return new Promise(function(i,s){const c=QI(a);let d=c.data;const A=oh.from(c.headers).normalize();let{responseType:r,onUploadProgress:y,onDownloadProgress:b}=c,x,B,T,E,R;function P(){E&&E(),R&&R(),c.cancelToken&&c.cancelToken.unsubscribe(x),c.signal&&c.signal.removeEventListener("abort",x)}let G=new XMLHttpRequest;G.open(c.method.toUpperCase(),c.url,!0),G.timeout=c.timeout;function U(){if(!G)return;const q=oh.from("getAllResponseHeaders"in G&&G.getAllResponseHeaders()),re={data:!r||r==="text"||r==="json"?G.responseText:G.response,status:G.status,statusText:G.statusText,headers:q,config:a,request:G};jI(function(fe){i(fe),P()},function(fe){s(fe),P()},re),G=null}"onloadend"in G?G.onloadend=U:G.onreadystatechange=function(){!G||G.readyState!==4||G.status===0&&!(G.responseURL&&G.responseURL.indexOf("file:")===0)||setTimeout(U)},G.onabort=function(){G&&(s(new Ts("Request aborted",Ts.ECONNABORTED,a,G)),G=null)},G.onerror=function(){s(new Ts("Network Error",Ts.ERR_NETWORK,a,G)),G=null},G.ontimeout=function(){let ne=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const re=c.transitional||UI;c.timeoutErrorMessage&&(ne=c.timeoutErrorMessage),s(new Ts(ne,re.clarifyTimeoutError?Ts.ETIMEDOUT:Ts.ECONNABORTED,a,G)),G=null},d===void 0&&A.setContentType(null),"setRequestHeader"in G&&Qi.forEach(A.toJSON(),function(ne,re){G.setRequestHeader(re,ne)}),Qi.isUndefined(c.withCredentials)||(G.withCredentials=!!c.withCredentials),r&&r!=="json"&&(G.responseType=c.responseType),b&&([T,R]=jv(b,!0),G.addEventListener("progress",T)),y&&G.upload&&([B,E]=jv(y),G.upload.addEventListener("progress",B),G.upload.addEventListener("loadend",E)),(c.cancelToken||c.signal)&&(x=q=>{G&&(s(!q||q.type?new pm(null,a,G):q),G.abort(),G=null)},c.cancelToken&&c.cancelToken.subscribe(x),c.signal&&(c.signal.aborted?x():c.signal.addEventListener("abort",x)));const Q=qN(c.url);if(Q&&au.protocols.indexOf(Q)===-1){s(new Ts("Unsupported protocol "+Q+":",Ts.ERR_BAD_REQUEST,a));return}G.send(d||null)})},s6=(a,e)=>{const{length:i}=a=a?a.filter(Boolean):[];if(e||i){let s=new AbortController,c;const d=function(b){if(!c){c=!0,r();const x=b instanceof Error?b:this.reason;s.abort(x instanceof Ts?x:new pm(x instanceof Error?x.message:x))}};let A=e&&setTimeout(()=>{A=null,d(new Ts(`timeout ${e} of ms exceeded`,Ts.ETIMEDOUT))},e);const r=()=>{a&&(A&&clearTimeout(A),A=null,a.forEach(b=>{b.unsubscribe?b.unsubscribe(d):b.removeEventListener("abort",d)}),a=null)};a.forEach(b=>b.addEventListener("abort",d));const{signal:y}=s;return y.unsubscribe=()=>Qi.asap(r),y}},o6=function*(a,e){let i=a.byteLength;if(i<e){yield a;return}let s=0,c;for(;s<i;)c=s+e,yield a.slice(s,c),s=c},a6=async function*(a,e){for await(const i of l6(a))yield*o6(i,e)},l6=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:i,value:s}=await e.read();if(i)break;yield s}}finally{await e.cancel()}},QE=(a,e,i,s)=>{const c=a6(a,e);let d=0,A,r=y=>{A||(A=!0,s&&s(y))};return new ReadableStream({async pull(y){try{const{done:b,value:x}=await c.next();if(b){r(),y.close();return}let B=x.byteLength;if(i){let T=d+=B;i(T)}y.enqueue(new Uint8Array(x))}catch(b){throw r(b),b}},cancel(y){return r(y),c.return()}},{highWaterMark:2})},g_=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",VI=g_&&typeof ReadableStream=="function",c6=g_&&(typeof TextEncoder=="function"?(a=>e=>a.encode(e))(new TextEncoder):async a=>new Uint8Array(await new Response(a).arrayBuffer())),GI=(a,...e)=>{try{return!!a(...e)}catch{return!1}},u6=VI&&GI(()=>{let a=!1;const e=new Request(au.origin,{body:new ReadableStream,method:"POST",get duplex(){return a=!0,"half"}}).headers.has("Content-Type");return a&&!e}),VE=64*1024,g1=VI&&GI(()=>Qi.isReadableStream(new Response("").body)),Hv={stream:g1&&(a=>a.body)};g_&&(a=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Hv[e]&&(Hv[e]=Qi.isFunction(a[e])?i=>i[e]():(i,s)=>{throw new Ts(`Response type '${e}' is not supported`,Ts.ERR_NOT_SUPPORT,s)})})})(new Response);const h6=async a=>{if(a==null)return 0;if(Qi.isBlob(a))return a.size;if(Qi.isSpecCompliantForm(a))return(await new Request(au.origin,{method:"POST",body:a}).arrayBuffer()).byteLength;if(Qi.isArrayBufferView(a)||Qi.isArrayBuffer(a))return a.byteLength;if(Qi.isURLSearchParams(a)&&(a=a+""),Qi.isString(a))return(await c6(a)).byteLength},d6=async(a,e)=>{const i=Qi.toFiniteNumber(a.getContentLength());return i??h6(e)},A6=g_&&(async a=>{let{url:e,method:i,data:s,signal:c,cancelToken:d,timeout:A,onDownloadProgress:r,onUploadProgress:y,responseType:b,headers:x,withCredentials:B="same-origin",fetchOptions:T}=QI(a);b=b?(b+"").toLowerCase():"text";let E=s6([c,d&&d.toAbortSignal()],A),R;const P=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let G;try{if(y&&u6&&i!=="get"&&i!=="head"&&(G=await d6(x,s))!==0){let re=new Request(e,{method:"POST",body:s,duplex:"half"}),pe;if(Qi.isFormData(s)&&(pe=re.headers.get("content-type"))&&x.setContentType(pe),re.body){const[fe,he]=NE(G,jv(jE(y)));s=QE(re.body,VE,fe,he)}}Qi.isString(B)||(B=B?"include":"omit");const U="credentials"in Request.prototype;R=new Request(e,{...T,signal:E,method:i.toUpperCase(),headers:x.normalize().toJSON(),body:s,duplex:"half",credentials:U?B:void 0});let Q=await fetch(R,T);const q=g1&&(b==="stream"||b==="response");if(g1&&(r||q&&P)){const re={};["status","statusText","headers"].forEach(be=>{re[be]=Q[be]});const pe=Qi.toFiniteNumber(Q.headers.get("content-length")),[fe,he]=r&&NE(pe,jv(jE(r),!0))||[];Q=new Response(QE(Q.body,VE,fe,()=>{he&&he(),P&&P()}),re)}b=b||"text";let ne=await Hv[Qi.findKey(Hv,b)||"text"](Q,a);return!q&&P&&P(),await new Promise((re,pe)=>{jI(re,pe,{data:ne,headers:oh.from(Q.headers),status:Q.status,statusText:Q.statusText,config:a,request:R})})}catch(U){throw P&&P(),U&&U.name==="TypeError"&&/Load failed|fetch/i.test(U.message)?Object.assign(new Ts("Network Error",Ts.ERR_NETWORK,a,R),{cause:U.cause||U}):Ts.from(U,U&&U.code,a,R)}}),m1={http:TN,xhr:n6,fetch:A6};Qi.forEach(m1,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const GE=a=>`- ${a}`,f6=a=>Qi.isFunction(a)||a===null||a===!1,WI={getAdapter:a=>{a=Qi.isArray(a)?a:[a];const{length:e}=a;let i,s;const c={};for(let d=0;d<e;d++){i=a[d];let A;if(s=i,!f6(i)&&(s=m1[(A=String(i)).toLowerCase()],s===void 0))throw new Ts(`Unknown adapter '${A}'`);if(s)break;c[A||"#"+d]=s}if(!s){const d=Object.entries(c).map(([r,y])=>`adapter ${r} `+(y===!1?"is not supported by the environment":"is not available in the build"));let A=e?d.length>1?`since :
`+d.map(GE).join(`
`):" "+GE(d[0]):"as no adapter specified";throw new Ts("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return s},adapters:m1};function bb(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new pm(null,a)}function WE(a){return bb(a),a.headers=oh.from(a.headers),a.data=xb.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),WI.getAdapter(a.adapter||e0.adapter)(a).then(function(s){return bb(a),s.data=xb.call(a,a.transformResponse,s),s.headers=oh.from(s.headers),s},function(s){return NI(s)||(bb(a),s&&s.response&&(s.response.data=xb.call(a,a.transformResponse,s.response),s.response.headers=oh.from(s.response.headers))),Promise.reject(s)})}const XI="1.10.0",m_={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{m_[a]=function(s){return typeof s===a||"a"+(e<1?"n ":" ")+a}});const XE={};m_.transitional=function(e,i,s){function c(d,A){return"[Axios v"+XI+"] Transitional option '"+d+"'"+A+(s?". "+s:"")}return(d,A,r)=>{if(e===!1)throw new Ts(c(A," has been removed"+(i?" in "+i:"")),Ts.ERR_DEPRECATED);return i&&!XE[A]&&(XE[A]=!0,console.warn(c(A," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(d,A,r):!0}};m_.spelling=function(e){return(i,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function p6(a,e,i){if(typeof a!="object")throw new Ts("options must be an object",Ts.ERR_BAD_OPTION_VALUE);const s=Object.keys(a);let c=s.length;for(;c-- >0;){const d=s[c],A=e[d];if(A){const r=a[d],y=r===void 0||A(r,d,a);if(y!==!0)throw new Ts("option "+d+" must be "+y,Ts.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new Ts("Unknown option "+d,Ts.ERR_BAD_OPTION)}}const xv={assertOptions:p6,validators:m_},DA=xv.validators;let fg=class{constructor(e){this.defaults=e||{},this.interceptors={request:new UE,response:new UE}}async request(e,i){try{return await this._request(e,i)}catch(s){if(s instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const d=c.stack?c.stack.replace(/^.+\n/,""):"";try{s.stack?d&&!String(s.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+d):s.stack=d}catch{}}throw s}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=mg(this.defaults,i);const{transitional:s,paramsSerializer:c,headers:d}=i;s!==void 0&&xv.assertOptions(s,{silentJSONParsing:DA.transitional(DA.boolean),forcedJSONParsing:DA.transitional(DA.boolean),clarifyTimeoutError:DA.transitional(DA.boolean)},!1),c!=null&&(Qi.isFunction(c)?i.paramsSerializer={serialize:c}:xv.assertOptions(c,{encode:DA.function,serialize:DA.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),xv.assertOptions(i,{baseUrl:DA.spelling("baseURL"),withXsrfToken:DA.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let A=d&&Qi.merge(d.common,d[i.method]);d&&Qi.forEach(["delete","get","head","post","put","patch","common"],R=>{delete d[R]}),i.headers=oh.concat(A,d);const r=[];let y=!0;this.interceptors.request.forEach(function(P){typeof P.runWhen=="function"&&P.runWhen(i)===!1||(y=y&&P.synchronous,r.unshift(P.fulfilled,P.rejected))});const b=[];this.interceptors.response.forEach(function(P){b.push(P.fulfilled,P.rejected)});let x,B=0,T;if(!y){const R=[WE.bind(this),void 0];for(R.unshift.apply(R,r),R.push.apply(R,b),T=R.length,x=Promise.resolve(i);B<T;)x=x.then(R[B++],R[B++]);return x}T=r.length;let E=i;for(B=0;B<T;){const R=r[B++],P=r[B++];try{E=R(E)}catch(G){P.call(this,G);break}}try{x=WE.call(this,E)}catch(R){return Promise.reject(R)}for(B=0,T=b.length;B<T;)x=x.then(b[B++],b[B++]);return x}getUri(e){e=mg(this.defaults,e);const i=HI(e.baseURL,e.url,e.allowAbsoluteUrls);return OI(i,e.params,e.paramsSerializer)}};Qi.forEach(["delete","get","head","options"],function(e){fg.prototype[e]=function(i,s){return this.request(mg(s||{},{method:e,url:i,data:(s||{}).data}))}});Qi.forEach(["post","put","patch"],function(e){function i(s){return function(d,A,r){return this.request(mg(r||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:d,data:A}))}}fg.prototype[e]=i(),fg.prototype[e+"Form"]=i(!0)});let g6=class YI{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(d){i=d});const s=this;this.promise.then(c=>{if(!s._listeners)return;let d=s._listeners.length;for(;d-- >0;)s._listeners[d](c);s._listeners=null}),this.promise.then=c=>{let d;const A=new Promise(r=>{s.subscribe(r),d=r}).then(c);return A.cancel=function(){s.unsubscribe(d)},A},e(function(d,A,r){s.reason||(s.reason=new pm(d,A,r),i(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=s=>{e.abort(s)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new YI(function(c){e=c}),cancel:e}}};function m6(a){return function(i){return a.apply(null,i)}}function y6(a){return Qi.isObject(a)&&a.isAxiosError===!0}const y1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(y1).forEach(([a,e])=>{y1[e]=a});function KI(a){const e=new fg(a),i=CI(fg.prototype.request,e);return Qi.extend(i,fg.prototype,e,{allOwnKeys:!0}),Qi.extend(i,e,null,{allOwnKeys:!0}),i.create=function(c){return KI(mg(a,c))},i}const ka=KI(e0);ka.Axios=fg;ka.CanceledError=pm;ka.CancelToken=g6;ka.isCancel=NI;ka.VERSION=XI;ka.toFormData=p_;ka.AxiosError=Ts;ka.Cancel=ka.CanceledError;ka.all=function(e){return Promise.all(e)};ka.spread=m6;ka.isAxiosError=y6;ka.mergeConfig=mg;ka.AxiosHeaders=oh;ka.formToJSON=a=>zI(Qi.isHTMLForm(a)?new FormData(a):a);ka.getAdapter=WI.getAdapter;ka.HttpStatusCode=y1;ka.default=ka;const{Axios:oj,AxiosError:aj,CanceledError:lj,isCancel:cj,CancelToken:uj,VERSION:hj,all:dj,Cancel:Aj,isAxiosError:fj,spread:pj,toFormData:gj,AxiosHeaders:mj,HttpStatusCode:yj,formToJSON:vj,getAdapter:_j,mergeConfig:xj}=ka,v6={key:0,class:"modal-overlay"},_6={class:"modal"},x6={class:"form-group"},b6={class:"form-group"},w6={class:"form-group"},B6={class:"form-group"},C6={__name:"AddMeterModal",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","meter-added"],setup(a,{emit:e}){const i=e,s=Qy({name:"",lat:null,lng:null,status:"activo"}),c=()=>{i("update:visible",!1)},d=async()=>{try{const A=await ka.post("/api/meters",s);s.name="",s.lat=null,s.lng=null,s.status="activo",i("meter-added",A.data),c()}catch(A){console.error("Error al registrar medidor:",A),alert("Error al registrar el medidor.")}};return(A,r)=>a.visible?(os(),Hs("div",v6,[Tt("div",_6,[r[10]||(r[10]=Tt("h3",null,"Agregar Medidor",-1)),Tt("form",{onSubmit:T4(d,["prevent"])},[Tt("div",x6,[r[4]||(r[4]=Tt("label",{for:"meterName"},"Nombre:",-1)),fa(Tt("input",{id:"meterName","onUpdate:modelValue":r[0]||(r[0]=y=>s.name=y),required:""},null,512),[[Yl,s.name]])]),Tt("div",b6,[r[5]||(r[5]=Tt("label",{for:"meterLat"},"Latitud:",-1)),fa(Tt("input",{id:"meterLat",type:"number",step:"any","onUpdate:modelValue":r[1]||(r[1]=y=>s.lat=y),required:""},null,512),[[Yl,s.lat,void 0,{number:!0}]])]),Tt("div",w6,[r[6]||(r[6]=Tt("label",{for:"meterLng"},"Longitud:",-1)),fa(Tt("input",{id:"meterLng",type:"number",step:"any","onUpdate:modelValue":r[2]||(r[2]=y=>s.lng=y),required:""},null,512),[[Yl,s.lng,void 0,{number:!0}]])]),Tt("div",B6,[r[8]||(r[8]=Tt("label",{for:"meterStatus"},"Estado:",-1)),fa(Tt("select",{id:"meterStatus","onUpdate:modelValue":r[3]||(r[3]=y=>s.status=y)},r[7]||(r[7]=[Tt("option",{value:"activo"},"Activo",-1),Tt("option",{value:"inactivo"},"Inactivo",-1)]),512),[[r_,s.status]])]),Tt("div",{class:"modal-buttons"},[Tt("button",{type:"button",onClick:c},"Cancelar"),r[9]||(r[9]=Tt("button",{type:"submit"},"Registrar",-1))])],32)])])):t_("",!0)}},S6=Uc(C6,[["__scopeId","data-v-930dce6d"]]);function E6(){const a=fr("visualizer"),e=fr(null),i=async()=>{try{const s=await ka.get("/api/auth/me");e.value=s.data,a.value=s.data.role}catch(s){console.error("Error fetching user info:",s),a.value="visualizer"}};return _p(()=>{i()}),{role:a,user:e}}const T6={class:"fleet-container"},I6={class:"map-wrapper"},F6={__name:"Fleet",setup(a){const{role:e}=E6(),i=fr([{id:1,name:"Medidor A",lat:13.715,lng:-89.2,status:"activo"},{id:2,name:"Planta B",lat:13.73,lng:-89.18,status:"inactivo"},{id:3,name:"Nodo C",lat:13.71,lng:-89.25,status:"activo"}]),s=fr(!0),c=fr(!1),d=()=>{c.value=!0},A=r=>{i.value.push(r)};return(r,y)=>(os(),Hs("div",T6,[$n(Oz,{meters:i.value,role:Aa(e),open:s.value,onAddMeter:d},null,8,["meters","role","open"]),Tt("div",I6,[$n(Hz,{meters:i.value,role:Aa(e)},null,8,["meters","role"])]),$n(S6,{visible:c.value,"onUpdate:visible":y[0]||(y[0]=b=>c.value=b),onMeterAdded:A},null,8,["visible"])]))}},L6=Uc(F6,[["__scopeId","data-v-0221932b"]]),M6={class:"meter-detail"},P6={key:0,class:"error"},k6={key:1},R6={key:2,class:"details"},D6={class:"chart-container"},O6={__name:"MeterDetail",setup(a){const i=eR().params.id,s=fr(null),c=fr(!0),d=fr(null),A=fr([]),r=fr({chart:{id:"energy-chart",toolbar:{show:!0}},xaxis:{type:"datetime",title:{text:"Fecha/Hora"}},yaxis:{title:{text:"Consumo (kWh)"}},stroke:{curve:"smooth"},tooltip:{x:{format:"dd MMM yyyy HH:mm"}}}),y=async()=>{try{const x=await ka.get(`/api/meters/${i}`);s.value=x.data}catch(x){d.value="Error obteniendo los detalles del medidor.",console.error(x)}},b=async()=>{try{const T=(await ka.get(`/api/meters/${i}/chart-data`)).data.map(E=>[E.timestamp,E.consumption]);A.value=[{name:"Consumo Energtico",data:T}]}catch(x){d.value="Error obteniendo los datos del grfico.",console.error(x)}};return _p(async()=>{await y(),await b(),c.value=!1}),(x,B)=>{var E;const T=Gy("apexchart");return os(),Hs("div",M6,[Tt("h2",null,"Detalle del Medidor - "+$s((E=s.value)==null?void 0:E.name),1),d.value?(os(),Hs("div",P6,$s(d.value),1)):c.value?(os(),Hs("div",k6," Cargando datos... ")):(os(),Hs("div",R6,[Tt("p",null,[B[0]||(B[0]=Tt("strong",null,"Estado:",-1)),Fv(" "+$s(s.value.status),1)]),Tt("p",null,[B[1]||(B[1]=Tt("strong",null,"Ubicacin:",-1)),Fv(" "+$s(s.value.location),1)]),Tt("div",D6,[$n(T,{type:"line",height:"350",options:r.value,series:A.value},null,8,["options","series"])])]))])}}},U6=Uc(O6,[["__scopeId","data-v-fb84eaf3"]]),z6=[{path:"/",component:VD},{path:"/reportes",component:YD},{path:"/configuracion",component:$D},{path:"/consumo",component:Mz},{path:"/historicos/tendencias",component:oO},{path:"/historicos/estadisticas",component:HU},{path:"/historicos/factor-carga",component:qU},{path:"/historicos/anomalias",component:CO},{path:"/historicos/patrones",component:oz},{path:"/fleet",component:L6},{path:"/meter/:id",name:"MeterDetail",component:U6,props:!0}],N6=$k({history:Sk(),routes:z6}),aw=L4(K4);aw.use(N6);aw.component("ApexChart",Ka);aw.mount("#app");export{Go as _,J0 as c,N1 as g};
