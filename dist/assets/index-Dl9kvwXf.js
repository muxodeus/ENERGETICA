(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const A of h.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&s(A)}).observe(document,{childList:!0,subtree:!0});function t(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(c){if(c.ep)return;c.ep=!0;const h=t(c);fetch(c.href,h)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function T1(a){const e=Object.create(null);for(const t of a.split(","))e[t]=1;return t=>t in e}const Aa={},sm=[],GA=()=>{},z3=()=>!1,J0=a=>a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&(a.charCodeAt(2)>122||a.charCodeAt(2)<97),F1=a=>a.startsWith("onUpdate:"),uu=Object.assign,L1=(a,e)=>{const t=a.indexOf(e);t>-1&&a.splice(t,1)},N3=Object.prototype.hasOwnProperty,Oo=(a,e)=>N3.call(a,e),Wn=Array.isArray,om=a=>tv(a)==="[object Map]",mm=a=>tv(a)==="[object Set]",nS=a=>tv(a)==="[object Date]",Ss=a=>typeof a=="function",Dl=a=>typeof a=="string",XA=a=>typeof a=="symbol",wa=a=>a!==null&&typeof a=="object",c5=a=>(wa(a)||Ss(a))&&Ss(a.then)&&Ss(a.catch),u5=Object.prototype.toString,tv=a=>u5.call(a),j3=a=>tv(a).slice(8,-1),h5=a=>tv(a)==="[object Object]",M1=a=>Dl(a)&&a!=="NaN"&&a[0]!=="-"&&""+parseInt(a,10)===a,_y=T1(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),e_=a=>{const e=Object.create(null);return t=>e[t]||(e[t]=a(t))},H3=/-(\w)/g,cd=e_(a=>a.replace(H3,(e,t)=>t?t.toUpperCase():"")),Q3=/\B([A-Z])/g,Sg=e_(a=>a.replace(Q3,"-$1").toLowerCase()),t_=e_(a=>a.charAt(0).toUpperCase()+a.slice(1)),jx=e_(a=>a?`on${t_(a)}`:""),wp=(a,e)=>!Object.is(a,e),v0=(a,...e)=>{for(let t=0;t<a.length;t++)a[t](...e)},Mb=(a,e,t,s=!1)=>{Object.defineProperty(a,e,{configurable:!0,enumerable:!1,writable:s,value:t})},R0=a=>{const e=parseFloat(a);return isNaN(e)?a:e};let sS;const i_=()=>sS||(sS=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function P1(a){if(Wn(a)){const e={};for(let t=0;t<a.length;t++){const s=a[t],c=Dl(s)?X3(s):P1(s);if(c)for(const h in c)e[h]=c[h]}return e}else if(Dl(a)||wa(a))return a}const V3=/;(?![^(]*\))/g,G3=/:([^]+)/,W3=/\/\*[^]*?\*\//g;function X3(a){const e={};return a.replace(W3,"").split(V3).forEach(t=>{if(t){const s=t.split(G3);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Ep(a){let e="";if(Dl(a))e=a;else if(Wn(a))for(let t=0;t<a.length;t++){const s=Ep(a[t]);s&&(e+=s+" ")}else if(wa(a))for(const t in a)a[t]&&(e+=t+" ");return e.trim()}const Y3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",K3=T1(Y3);function d5(a){return!!a||a===""}function q3(a,e){if(a.length!==e.length)return!1;let t=!0;for(let s=0;t&&s<a.length;s++)t=bg(a[s],e[s]);return t}function bg(a,e){if(a===e)return!0;let t=nS(a),s=nS(e);if(t||s)return t&&s?a.getTime()===e.getTime():!1;if(t=XA(a),s=XA(e),t||s)return a===e;if(t=Wn(a),s=Wn(e),t||s)return t&&s?q3(a,e):!1;if(t=wa(a),s=wa(e),t||s){if(!t||!s)return!1;const c=Object.keys(a).length,h=Object.keys(e).length;if(c!==h)return!1;for(const A in a){const r=a.hasOwnProperty(A),y=e.hasOwnProperty(A);if(r&&!y||!r&&y||!bg(a[A],e[A]))return!1}}return String(a)===String(e)}function k1(a,e){return a.findIndex(t=>bg(t,e))}const A5=a=>!!(a&&a.__v_isRef===!0),Hn=a=>Dl(a)?a:a==null?"":Wn(a)||wa(a)&&(a.toString===u5||!Ss(a.toString))?A5(a)?Hn(a.value):JSON.stringify(a,f5,2):String(a),f5=(a,e)=>A5(e)?f5(a,e.value):om(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[s,c],h)=>(t[Hx(s,h)+" =>"]=c,t),{})}:mm(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Hx(t))}:XA(e)?Hx(e):wa(e)&&!Wn(e)&&!h5(e)?String(e):e,Hx=(a,e="")=>{var t;return XA(a)?`Symbol(${(t=a.description)!=null?t:e})`:a};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ou;class p5{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ou,!e&&ou&&(this.index=(ou.scopes||(ou.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=ou;try{return ou=this,e()}finally{ou=t}}}on(){++this._on===1&&(this.prevScope=ou,ou=this)}off(){this._on>0&&--this._on===0&&(ou=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(this.effects.length=0,t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function g5(a){return new p5(a)}function m5(){return ou}function $3(a,e=!1){ou&&ou.cleanups.push(a)}let _a;const Qx=new WeakSet;class y5{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ou&&ou.active&&ou.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Qx.has(this)&&(Qx.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||_5(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,oS(this),x5(this);const e=_a,t=Kd;_a=this,Kd=!0;try{return this.fn()}finally{b5(this),_a=e,Kd=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)O1(e);this.deps=this.depsTail=void 0,oS(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Qx.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Pb(this)&&this.run()}get dirty(){return Pb(this)}}let v5=0,xy,by;function _5(a,e=!1){if(a.flags|=8,e){a.next=by,by=a;return}a.next=xy,xy=a}function R1(){v5++}function D1(){if(--v5>0)return;if(by){let e=by;for(by=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let a;for(;xy;){let e=xy;for(xy=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){a||(a=s)}e=t}}if(a)throw a}function x5(a){for(let e=a.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function b5(a){let e,t=a.depsTail,s=t;for(;s;){const c=s.prevDep;s.version===-1?(s===t&&(t=c),O1(s),Z3(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=c}a.deps=e,a.depsTail=t}function Pb(a){for(let e=a.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(w5(e.dep.computed)||e.dep.version!==e.version))return!0;return!!a._dirty}function w5(a){if(a.flags&4&&!(a.flags&16)||(a.flags&=-17,a.globalVersion===Oy)||(a.globalVersion=Oy,!a.isSSR&&a.flags&128&&(!a.deps&&!a._dirty||!Pb(a))))return;a.flags|=2;const e=a.dep,t=_a,s=Kd;_a=a,Kd=!0;try{x5(a);const c=a.fn(a._value);(e.version===0||wp(c,a._value))&&(a.flags|=128,a._value=c,e.version++)}catch(c){throw e.version++,c}finally{_a=t,Kd=s,b5(a),a.flags&=-3}}function O1(a,e=!1){const{dep:t,prevSub:s,nextSub:c}=a;if(s&&(s.nextSub=c,a.prevSub=void 0),c&&(c.prevSub=s,a.nextSub=void 0),t.subs===a&&(t.subs=s,!s&&t.computed)){t.computed.flags&=-5;for(let h=t.computed.deps;h;h=h.nextDep)O1(h,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Z3(a){const{prevDep:e,nextDep:t}=a;e&&(e.nextDep=t,a.prevDep=void 0),t&&(t.prevDep=e,a.nextDep=void 0)}let Kd=!0;const B5=[];function If(){B5.push(Kd),Kd=!1}function Tf(){const a=B5.pop();Kd=a===void 0?!0:a}function oS(a){const{cleanup:e}=a;if(a.cleanup=void 0,e){const t=_a;_a=void 0;try{e()}finally{_a=t}}}let Oy=0;class J3{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class U1{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!_a||!Kd||_a===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==_a)t=this.activeLink=new J3(_a,this),_a.deps?(t.prevDep=_a.depsTail,_a.depsTail.nextDep=t,_a.depsTail=t):_a.deps=_a.depsTail=t,C5(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const s=t.nextDep;s.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=s),t.prevDep=_a.depsTail,t.nextDep=void 0,_a.depsTail.nextDep=t,_a.depsTail=t,_a.deps===t&&(_a.deps=s)}return t}trigger(e){this.version++,Oy++,this.notify(e)}notify(e){R1();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{D1()}}}function C5(a){if(a.dep.sc++,a.sub.flags&4){const e=a.dep.computed;if(e&&!a.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)C5(s)}const t=a.dep.subs;t!==a&&(a.prevSub=t,t&&(t.nextSub=a)),a.dep.subs=a}}const D0=new WeakMap,fg=Symbol(""),kb=Symbol(""),Uy=Symbol("");function au(a,e,t){if(Kd&&_a){let s=D0.get(a);s||D0.set(a,s=new Map);let c=s.get(t);c||(s.set(t,c=new U1),c.map=s,c.key=t),c.track()}}function Bf(a,e,t,s,c,h){const A=D0.get(a);if(!A){Oy++;return}const r=y=>{y&&y.trigger()};if(R1(),e==="clear")A.forEach(r);else{const y=Wn(a),b=y&&M1(t);if(y&&t==="length"){const _=Number(s);A.forEach((B,I)=>{(I==="length"||I===Uy||!XA(I)&&I>=_)&&r(B)})}else switch((t!==void 0||A.has(void 0))&&r(A.get(t)),b&&r(A.get(Uy)),e){case"add":y?b&&r(A.get("length")):(r(A.get(fg)),om(a)&&r(A.get(kb)));break;case"delete":y||(r(A.get(fg)),om(a)&&r(A.get(kb)));break;case"set":om(a)&&r(A.get(fg));break}}D1()}function eP(a,e){const t=D0.get(a);return t&&t.get(e)}function Yg(a){const e=Co(a);return e===a?e:(au(e,"iterate",Uy),sd(a)?e:e.map(Dc))}function r_(a){return au(a=Co(a),"iterate",Uy),a}const tP={__proto__:null,[Symbol.iterator](){return Vx(this,Symbol.iterator,Dc)},concat(...a){return Yg(this).concat(...a.map(e=>Wn(e)?Yg(e):e))},entries(){return Vx(this,"entries",a=>(a[1]=Dc(a[1]),a))},every(a,e){return vf(this,"every",a,e,void 0,arguments)},filter(a,e){return vf(this,"filter",a,e,t=>t.map(Dc),arguments)},find(a,e){return vf(this,"find",a,e,Dc,arguments)},findIndex(a,e){return vf(this,"findIndex",a,e,void 0,arguments)},findLast(a,e){return vf(this,"findLast",a,e,Dc,arguments)},findLastIndex(a,e){return vf(this,"findLastIndex",a,e,void 0,arguments)},forEach(a,e){return vf(this,"forEach",a,e,void 0,arguments)},includes(...a){return Gx(this,"includes",a)},indexOf(...a){return Gx(this,"indexOf",a)},join(a){return Yg(this).join(a)},lastIndexOf(...a){return Gx(this,"lastIndexOf",a)},map(a,e){return vf(this,"map",a,e,void 0,arguments)},pop(){return ly(this,"pop")},push(...a){return ly(this,"push",a)},reduce(a,...e){return aS(this,"reduce",a,e)},reduceRight(a,...e){return aS(this,"reduceRight",a,e)},shift(){return ly(this,"shift")},some(a,e){return vf(this,"some",a,e,void 0,arguments)},splice(...a){return ly(this,"splice",a)},toReversed(){return Yg(this).toReversed()},toSorted(a){return Yg(this).toSorted(a)},toSpliced(...a){return Yg(this).toSpliced(...a)},unshift(...a){return ly(this,"unshift",a)},values(){return Vx(this,"values",Dc)}};function Vx(a,e,t){const s=r_(a),c=s[e]();return s!==a&&!sd(a)&&(c._next=c.next,c.next=()=>{const h=c._next();return h.value&&(h.value=t(h.value)),h}),c}const iP=Array.prototype;function vf(a,e,t,s,c,h){const A=r_(a),r=A!==a&&!sd(a),y=A[e];if(y!==iP[e]){const B=y.apply(a,h);return r?Dc(B):B}let b=t;A!==a&&(r?b=function(B,I){return t.call(this,Dc(B),I,a)}:t.length>2&&(b=function(B,I){return t.call(this,B,I,a)}));const _=y.call(A,b,s);return r&&c?c(_):_}function aS(a,e,t,s){const c=r_(a);let h=t;return c!==a&&(sd(a)?t.length>3&&(h=function(A,r,y){return t.call(this,A,r,y,a)}):h=function(A,r,y){return t.call(this,A,Dc(r),y,a)}),c[e](h,...s)}function Gx(a,e,t){const s=Co(a);au(s,"iterate",Uy);const c=s[e](...t);return(c===-1||c===!1)&&j1(t[0])?(t[0]=Co(t[0]),s[e](...t)):c}function ly(a,e,t=[]){If(),R1();const s=Co(a)[e].apply(a,t);return D1(),Tf(),s}const rP=T1("__proto__,__v_isRef,__isVue"),S5=new Set(Object.getOwnPropertyNames(Symbol).filter(a=>a!=="arguments"&&a!=="caller").map(a=>Symbol[a]).filter(XA));function nP(a){XA(a)||(a=String(a));const e=Co(this);return au(e,"has",a),e.hasOwnProperty(a)}class E5{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,s){if(t==="__v_skip")return e.__v_skip;const c=this._isReadonly,h=this._isShallow;if(t==="__v_isReactive")return!c;if(t==="__v_isReadonly")return c;if(t==="__v_isShallow")return h;if(t==="__v_raw")return s===(c?h?fP:L5:h?F5:T5).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const A=Wn(e);if(!c){let y;if(A&&(y=tP[t]))return y;if(t==="hasOwnProperty")return nP}const r=Reflect.get(e,t,ml(e)?e:s);return(XA(t)?S5.has(t):rP(t))||(c||au(e,"get",t),h)?r:ml(r)?A&&M1(t)?r:r.value:wa(r)?c?P5(r):Eg(r):r}}class I5 extends E5{constructor(e=!1){super(!1,e)}set(e,t,s,c){let h=e[t];if(!this._isShallow){const y=Ip(h);if(!sd(s)&&!Ip(s)&&(h=Co(h),s=Co(s)),!Wn(e)&&ml(h)&&!ml(s))return y?!1:(h.value=s,!0)}const A=Wn(e)&&M1(t)?Number(t)<e.length:Oo(e,t),r=Reflect.set(e,t,s,ml(e)?e:c);return e===Co(c)&&(A?wp(s,h)&&Bf(e,"set",t,s):Bf(e,"add",t,s)),r}deleteProperty(e,t){const s=Oo(e,t);e[t];const c=Reflect.deleteProperty(e,t);return c&&s&&Bf(e,"delete",t,void 0),c}has(e,t){const s=Reflect.has(e,t);return(!XA(t)||!S5.has(t))&&au(e,"has",t),s}ownKeys(e){return au(e,"iterate",Wn(e)?"length":fg),Reflect.ownKeys(e)}}class sP extends E5{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const oP=new I5,aP=new sP,lP=new I5(!0);const Rb=a=>a,l0=a=>Reflect.getPrototypeOf(a);function cP(a,e,t){return function(...s){const c=this.__v_raw,h=Co(c),A=om(h),r=a==="entries"||a===Symbol.iterator&&A,y=a==="keys"&&A,b=c[a](...s),_=t?Rb:e?O0:Dc;return!e&&au(h,"iterate",y?kb:fg),{next(){const{value:B,done:I}=b.next();return I?{value:B,done:I}:{value:r?[_(B[0]),_(B[1])]:_(B),done:I}},[Symbol.iterator](){return this}}}}function c0(a){return function(...e){return a==="delete"?!1:a==="clear"?void 0:this}}function uP(a,e){const t={get(c){const h=this.__v_raw,A=Co(h),r=Co(c);a||(wp(c,r)&&au(A,"get",c),au(A,"get",r));const{has:y}=l0(A),b=e?Rb:a?O0:Dc;if(y.call(A,c))return b(h.get(c));if(y.call(A,r))return b(h.get(r));h!==A&&h.get(c)},get size(){const c=this.__v_raw;return!a&&au(Co(c),"iterate",fg),Reflect.get(c,"size",c)},has(c){const h=this.__v_raw,A=Co(h),r=Co(c);return a||(wp(c,r)&&au(A,"has",c),au(A,"has",r)),c===r?h.has(c):h.has(c)||h.has(r)},forEach(c,h){const A=this,r=A.__v_raw,y=Co(r),b=e?Rb:a?O0:Dc;return!a&&au(y,"iterate",fg),r.forEach((_,B)=>c.call(h,b(_),b(B),A))}};return uu(t,a?{add:c0("add"),set:c0("set"),delete:c0("delete"),clear:c0("clear")}:{add(c){!e&&!sd(c)&&!Ip(c)&&(c=Co(c));const h=Co(this);return l0(h).has.call(h,c)||(h.add(c),Bf(h,"add",c,c)),this},set(c,h){!e&&!sd(h)&&!Ip(h)&&(h=Co(h));const A=Co(this),{has:r,get:y}=l0(A);let b=r.call(A,c);b||(c=Co(c),b=r.call(A,c));const _=y.call(A,c);return A.set(c,h),b?wp(h,_)&&Bf(A,"set",c,h):Bf(A,"add",c,h),this},delete(c){const h=Co(this),{has:A,get:r}=l0(h);let y=A.call(h,c);y||(c=Co(c),y=A.call(h,c)),r&&r.call(h,c);const b=h.delete(c);return y&&Bf(h,"delete",c,void 0),b},clear(){const c=Co(this),h=c.size!==0,A=c.clear();return h&&Bf(c,"clear",void 0,void 0),A}}),["keys","values","entries",Symbol.iterator].forEach(c=>{t[c]=cP(c,a,e)}),t}function z1(a,e){const t=uP(a,e);return(s,c,h)=>c==="__v_isReactive"?!a:c==="__v_isReadonly"?a:c==="__v_raw"?s:Reflect.get(Oo(t,c)&&c in s?t:s,c,h)}const hP={get:z1(!1,!1)},dP={get:z1(!1,!0)},AP={get:z1(!0,!1)};const T5=new WeakMap,F5=new WeakMap,L5=new WeakMap,fP=new WeakMap;function pP(a){switch(a){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function gP(a){return a.__v_skip||!Object.isExtensible(a)?0:pP(j3(a))}function Eg(a){return Ip(a)?a:N1(a,!1,oP,hP,T5)}function M5(a){return N1(a,!1,lP,dP,F5)}function P5(a){return N1(a,!0,aP,AP,L5)}function N1(a,e,t,s,c){if(!wa(a)||a.__v_raw&&!(e&&a.__v_isReactive))return a;const h=gP(a);if(h===0)return a;const A=c.get(a);if(A)return A;const r=new Proxy(a,h===2?s:t);return c.set(a,r),r}function Bp(a){return Ip(a)?Bp(a.__v_raw):!!(a&&a.__v_isReactive)}function Ip(a){return!!(a&&a.__v_isReadonly)}function sd(a){return!!(a&&a.__v_isShallow)}function j1(a){return a?!!a.__v_raw:!1}function Co(a){const e=a&&a.__v_raw;return e?Co(e):a}function H1(a){return!Oo(a,"__v_skip")&&Object.isExtensible(a)&&Mb(a,"__v_skip",!0),a}const Dc=a=>wa(a)?Eg(a):a,O0=a=>wa(a)?P5(a):a;function ml(a){return a?a.__v_isRef===!0:!1}function sr(a){return k5(a,!1)}function mP(a){return k5(a,!0)}function k5(a,e){return ml(a)?a:new yP(a,e)}class yP{constructor(e,t){this.dep=new U1,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Co(e),this._value=t?e:Dc(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,s=this.__v_isShallow||sd(e)||Ip(e);e=s?e:Co(e),wp(e,t)&&(this._rawValue=e,this._value=s?e:Dc(e),this.dep.trigger())}}function Po(a){return ml(a)?a.value:a}const vP={get:(a,e,t)=>e==="__v_raw"?a:Po(Reflect.get(a,e,t)),set:(a,e,t,s)=>{const c=a[e];return ml(c)&&!ml(t)?(c.value=t,!0):Reflect.set(a,e,t,s)}};function R5(a){return Bp(a)?a:new Proxy(a,vP)}function D5(a){const e=Wn(a)?new Array(a.length):{};for(const t in a)e[t]=xP(a,t);return e}class _P{constructor(e,t,s){this._object=e,this._key=t,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return eP(Co(this._object),this._key)}}function xP(a,e,t){const s=a[e];return ml(s)?s:new _P(a,e,t)}class bP{constructor(e,t,s){this.fn=e,this.setter=t,this._value=void 0,this.dep=new U1(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Oy-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&_a!==this)return _5(this,!0),!0}get value(){const e=this.dep.track();return w5(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function wP(a,e,t=!1){let s,c;return Ss(a)?s=a:(s=a.get,c=a.set),new bP(s,c,t)}const u0={},U0=new WeakMap;let rg;function BP(a,e=!1,t=rg){if(t){let s=U0.get(t);s||U0.set(t,s=[]),s.push(a)}}function CP(a,e,t=Aa){const{immediate:s,deep:c,once:h,scheduler:A,augmentJob:r,call:y}=t,b=ne=>c?ne:sd(ne)||c===!1||c===0?Cf(ne,1):Cf(ne);let _,B,I,E,R=!1,M=!1;if(ml(a)?(B=()=>a.value,R=sd(a)):Bp(a)?(B=()=>b(a),R=!0):Wn(a)?(M=!0,R=a.some(ne=>Bp(ne)||sd(ne)),B=()=>a.map(ne=>{if(ml(ne))return ne.value;if(Bp(ne))return b(ne);if(Ss(ne))return y?y(ne,2):ne()})):Ss(a)?e?B=y?()=>y(a,2):a:B=()=>{if(I){If();try{I()}finally{Tf()}}const ne=rg;rg=_;try{return y?y(a,3,[E]):a(E)}finally{rg=ne}}:B=GA,e&&c){const ne=B,re=c===!0?1/0:c;B=()=>Cf(ne(),re)}const G=m5(),U=()=>{_.stop(),G&&G.active&&L1(G.effects,_)};if(h&&e){const ne=e;e=(...re)=>{ne(...re),U()}}let Q=M?new Array(a.length).fill(u0):u0;const q=ne=>{if(!(!(_.flags&1)||!_.dirty&&!ne))if(e){const re=_.run();if(c||R||(M?re.some((pe,Ae)=>wp(pe,Q[Ae])):wp(re,Q))){I&&I();const pe=rg;rg=_;try{const Ae=[re,Q===u0?void 0:M&&Q[0]===u0?[]:Q,E];Q=re,y?y(e,3,Ae):e(...Ae)}finally{rg=pe}}}else _.run()};return r&&r(q),_=new y5(B),_.scheduler=A?()=>A(q,!1):q,E=ne=>BP(ne,!1,_),I=_.onStop=()=>{const ne=U0.get(_);if(ne){if(y)y(ne,4);else for(const re of ne)re();U0.delete(_)}},e?s?q(!0):Q=_.run():A?A(q.bind(null,!0),!0):_.run(),U.pause=_.pause.bind(_),U.resume=_.resume.bind(_),U.stop=U,U}function Cf(a,e=1/0,t){if(e<=0||!wa(a)||a.__v_skip||(t=t||new Set,t.has(a)))return a;if(t.add(a),e--,ml(a))Cf(a.value,e,t);else if(Wn(a))for(let s=0;s<a.length;s++)Cf(a[s],e,t);else if(mm(a)||om(a))a.forEach(s=>{Cf(s,e,t)});else if(h5(a)){for(const s in a)Cf(a[s],e,t);for(const s of Object.getOwnPropertySymbols(a))Object.prototype.propertyIsEnumerable.call(a,s)&&Cf(a[s],e,t)}return a}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function iv(a,e,t,s){try{return s?a(...s):a()}catch(c){n_(c,e,t)}}function YA(a,e,t,s){if(Ss(a)){const c=iv(a,e,t,s);return c&&c5(c)&&c.catch(h=>{n_(h,e,t)}),c}if(Wn(a)){const c=[];for(let h=0;h<a.length;h++)c.push(YA(a[h],e,t,s));return c}}function n_(a,e,t,s=!0){const c=e?e.vnode:null,{errorHandler:h,throwUnhandledErrorInProduction:A}=e&&e.appContext.config||Aa;if(e){let r=e.parent;const y=e.proxy,b=`https://vuejs.org/error-reference/#runtime-${t}`;for(;r;){const _=r.ec;if(_){for(let B=0;B<_.length;B++)if(_[B](a,y,b)===!1)return}r=r.parent}if(h){If(),iv(h,null,10,[a,y,b]),Tf();return}}SP(a,t,c,s,A)}function SP(a,e,t,s=!0,c=!1){if(c)throw a;console.error(a)}const ku=[];let jA=-1;const am=[];let gp=null,em=0;const O5=Promise.resolve();let z0=null;function rv(a){const e=z0||O5;return a?e.then(this?a.bind(this):a):e}function EP(a){let e=jA+1,t=ku.length;for(;e<t;){const s=e+t>>>1,c=ku[s],h=zy(c);h<a||h===a&&c.flags&2?e=s+1:t=s}return e}function Q1(a){if(!(a.flags&1)){const e=zy(a),t=ku[ku.length-1];!t||!(a.flags&2)&&e>=zy(t)?ku.push(a):ku.splice(EP(e),0,a),a.flags|=1,U5()}}function U5(){z0||(z0=O5.then(N5))}function IP(a){Wn(a)?am.push(...a):gp&&a.id===-1?gp.splice(em+1,0,a):a.flags&1||(am.push(a),a.flags|=1),U5()}function lS(a,e,t=jA+1){for(;t<ku.length;t++){const s=ku[t];if(s&&s.flags&2){if(a&&s.id!==a.uid)continue;ku.splice(t,1),t--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function z5(a){if(am.length){const e=[...new Set(am)].sort((t,s)=>zy(t)-zy(s));if(am.length=0,gp){gp.push(...e);return}for(gp=e,em=0;em<gp.length;em++){const t=gp[em];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}gp=null,em=0}}const zy=a=>a.id==null?a.flags&2?-1:1/0:a.id;function N5(a){try{for(jA=0;jA<ku.length;jA++){const e=ku[jA];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),iv(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;jA<ku.length;jA++){const e=ku[jA];e&&(e.flags&=-2)}jA=-1,ku.length=0,z5(),z0=null,(ku.length||am.length)&&N5()}}let Du=null,j5=null;function N0(a){const e=Du;return Du=a,j5=a&&a.type.__scopeId||null,e}function ng(a,e=Du,t){if(!e||a._n)return a;const s=(...c)=>{s._d&&yS(-1);const h=N0(e);let A;try{A=a(...c)}finally{N0(h),s._d&&yS(1)}return A};return s._n=!0,s._c=!0,s._d=!0,s}function ao(a,e){if(Du===null)return a;const t=l_(Du),s=a.dirs||(a.dirs=[]);for(let c=0;c<e.length;c++){let[h,A,r,y=Aa]=e[c];h&&(Ss(h)&&(h={mounted:h,updated:h}),h.deep&&Cf(A),s.push({dir:h,instance:t,value:A,oldValue:void 0,arg:r,modifiers:y}))}return a}function tg(a,e,t,s){const c=a.dirs,h=e&&e.dirs;for(let A=0;A<c.length;A++){const r=c[A];h&&(r.oldValue=h[A].value);let y=r.dir[s];y&&(If(),YA(y,t,8,[a.el,r,a,e]),Tf())}}const TP=Symbol("_vte"),FP=a=>a.__isTeleport;function V1(a,e){a.shapeFlag&6&&a.component?(a.transition=e,V1(a.component.subTree,e)):a.shapeFlag&128?(a.ssContent.transition=e.clone(a.ssContent),a.ssFallback.transition=e.clone(a.ssFallback)):a.transition=e}/*! #__NO_SIDE_EFFECTS__ */function G1(a,e){return Ss(a)?uu({name:a.name},e,{setup:a}):a}function H5(a){a.ids=[a.ids[0]+a.ids[2]+++"-",0,0]}function wy(a,e,t,s,c=!1){if(Wn(a)){a.forEach((R,M)=>wy(R,e&&(Wn(e)?e[M]:e),t,s,c));return}if(By(s)&&!c){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&wy(a,e,t,s.component.subTree);return}const h=s.shapeFlag&4?l_(s.component):s.el,A=c?null:h,{i:r,r:y}=a,b=e&&e.r,_=r.refs===Aa?r.refs={}:r.refs,B=r.setupState,I=Co(B),E=B===Aa?()=>!1:R=>Oo(I,R);if(b!=null&&b!==y&&(Dl(b)?(_[b]=null,E(b)&&(B[b]=null)):ml(b)&&(b.value=null)),Ss(y))iv(y,r,12,[A,_]);else{const R=Dl(y),M=ml(y);if(R||M){const G=()=>{if(a.f){const U=R?E(y)?B[y]:_[y]:y.value;c?Wn(U)&&L1(U,h):Wn(U)?U.includes(h)||U.push(h):R?(_[y]=[h],E(y)&&(B[y]=_[y])):(y.value=[h],a.k&&(_[a.k]=y.value))}else R?(_[y]=A,E(y)&&(B[y]=A)):M&&(y.value=A,a.k&&(_[a.k]=A))};A?(G.id=-1,Dh(G,t)):G()}}}i_().requestIdleCallback;i_().cancelIdleCallback;const By=a=>!!a.type.__asyncLoader,Q5=a=>a.type.__isKeepAlive;function LP(a,e){V5(a,"a",e)}function MP(a,e){V5(a,"da",e)}function V5(a,e,t=mc){const s=a.__wdc||(a.__wdc=()=>{let c=t;for(;c;){if(c.isDeactivated)return;c=c.parent}return a()});if(s_(e,s,t),t){let c=t.parent;for(;c&&c.parent;)Q5(c.parent.vnode)&&PP(s,e,t,c),c=c.parent}}function PP(a,e,t,s){const c=s_(e,a,s,!0);Ny(()=>{L1(s[e],c)},t)}function s_(a,e,t=mc,s=!1){if(t){const c=t[a]||(t[a]=[]),h=e.__weh||(e.__weh=(...A)=>{If();const r=sv(t),y=YA(e,t,a,A);return r(),Tf(),y});return s?c.unshift(h):c.push(h),h}}const Lf=a=>(e,t=mc)=>{(!Hy||a==="sp")&&s_(a,(...s)=>e(...s),t)},G5=Lf("bm"),Ff=Lf("m"),kP=Lf("bu"),RP=Lf("u"),W5=Lf("bum"),Ny=Lf("um"),DP=Lf("sp"),OP=Lf("rtg"),UP=Lf("rtc");function zP(a,e=mc){s_("ec",a,e)}const NP="components";function nv(a,e){return HP(NP,a,!0,e)||a}const jP=Symbol.for("v-ndc");function HP(a,e,t=!0,s=!1){const c=Du||mc;if(c){const h=c.type;{const r=Fk(h,!1);if(r&&(r===e||r===cd(e)||r===t_(cd(e))))return h}const A=cS(c[a]||h[a],e)||cS(c.appContext[a],e);return!A&&s?h:A}}function cS(a,e){return a&&(a[e]||a[cd(e)]||a[t_(cd(e))])}function $d(a,e,t,s){let c;const h=t,A=Wn(a);if(A||Dl(a)){const r=A&&Bp(a);let y=!1,b=!1;r&&(y=!sd(a),b=Ip(a),a=r_(a)),c=new Array(a.length);for(let _=0,B=a.length;_<B;_++)c[_]=e(y?b?O0(Dc(a[_])):Dc(a[_]):a[_],_,void 0,h)}else if(typeof a=="number"){c=new Array(a);for(let r=0;r<a;r++)c[r]=e(r+1,r,void 0,h)}else if(wa(a))if(a[Symbol.iterator])c=Array.from(a,(r,y)=>e(r,y,void 0,h));else{const r=Object.keys(a);c=new Array(r.length);for(let y=0,b=r.length;y<b;y++){const _=r[y];c[y]=e(a[_],_,y,h)}}else c=[];return c}const Db=a=>a?dI(a)?l_(a):Db(a.parent):null,Cy=uu(Object.create(null),{$:a=>a,$el:a=>a.vnode.el,$data:a=>a.data,$props:a=>a.props,$attrs:a=>a.attrs,$slots:a=>a.slots,$refs:a=>a.refs,$parent:a=>Db(a.parent),$root:a=>Db(a.root),$host:a=>a.ce,$emit:a=>a.emit,$options:a=>Y5(a),$forceUpdate:a=>a.f||(a.f=()=>{Q1(a.update)}),$nextTick:a=>a.n||(a.n=rv.bind(a.proxy)),$watch:a=>uk.bind(a)}),Wx=(a,e)=>a!==Aa&&!a.__isScriptSetup&&Oo(a,e),QP={get({_:a},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:s,data:c,props:h,accessCache:A,type:r,appContext:y}=a;let b;if(e[0]!=="$"){const E=A[e];if(E!==void 0)switch(E){case 1:return s[e];case 2:return c[e];case 4:return t[e];case 3:return h[e]}else{if(Wx(s,e))return A[e]=1,s[e];if(c!==Aa&&Oo(c,e))return A[e]=2,c[e];if((b=a.propsOptions[0])&&Oo(b,e))return A[e]=3,h[e];if(t!==Aa&&Oo(t,e))return A[e]=4,t[e];Ob&&(A[e]=0)}}const _=Cy[e];let B,I;if(_)return e==="$attrs"&&au(a.attrs,"get",""),_(a);if((B=r.__cssModules)&&(B=B[e]))return B;if(t!==Aa&&Oo(t,e))return A[e]=4,t[e];if(I=y.config.globalProperties,Oo(I,e))return I[e]},set({_:a},e,t){const{data:s,setupState:c,ctx:h}=a;return Wx(c,e)?(c[e]=t,!0):s!==Aa&&Oo(s,e)?(s[e]=t,!0):Oo(a.props,e)||e[0]==="$"&&e.slice(1)in a?!1:(h[e]=t,!0)},has({_:{data:a,setupState:e,accessCache:t,ctx:s,appContext:c,propsOptions:h}},A){let r;return!!t[A]||a!==Aa&&Oo(a,A)||Wx(e,A)||(r=h[0])&&Oo(r,A)||Oo(s,A)||Oo(Cy,A)||Oo(c.config.globalProperties,A)},defineProperty(a,e,t){return t.get!=null?a._.accessCache[e]=0:Oo(t,"value")&&this.set(a,e,t.value,null),Reflect.defineProperty(a,e,t)}};function uS(a){return Wn(a)?a.reduce((e,t)=>(e[t]=null,e),{}):a}let Ob=!0;function VP(a){const e=Y5(a),t=a.proxy,s=a.ctx;Ob=!1,e.beforeCreate&&hS(e.beforeCreate,a,"bc");const{data:c,computed:h,methods:A,watch:r,provide:y,inject:b,created:_,beforeMount:B,mounted:I,beforeUpdate:E,updated:R,activated:M,deactivated:G,beforeDestroy:U,beforeUnmount:Q,destroyed:q,unmounted:ne,render:re,renderTracked:pe,renderTriggered:Ae,errorCaptured:le,serverPrefetch:be,expose:we,inheritAttrs:oe,components:me,directives:Le,filters:Se}=e;if(b&&GP(b,s,null),A)for(const Ze in A){const $e=A[Ze];Ss($e)&&(s[Ze]=$e.bind(t))}if(c){const Ze=c.call(t,t);wa(Ze)&&(a.data=Eg(Ze))}if(Ob=!0,h)for(const Ze in h){const $e=h[Ze],ct=Ss($e)?$e.bind(t,t):Ss($e.get)?$e.get.bind(t,t):GA,Qe=!Ss($e)&&Ss($e.set)?$e.set.bind(t):GA,It=qa({get:ct,set:Qe});Object.defineProperty(s,Ze,{enumerable:!0,configurable:!0,get:()=>It.value,set:Ce=>It.value=Ce})}if(r)for(const Ze in r)X5(r[Ze],s,t,Ze);if(y){const Ze=Ss(y)?y.call(t):y;Reflect.ownKeys(Ze).forEach($e=>{_0($e,Ze[$e])})}_&&hS(_,a,"c");function Re(Ze,$e){Wn($e)?$e.forEach(ct=>Ze(ct.bind(t))):$e&&Ze($e.bind(t))}if(Re(G5,B),Re(Ff,I),Re(kP,E),Re(RP,R),Re(LP,M),Re(MP,G),Re(zP,le),Re(UP,pe),Re(OP,Ae),Re(W5,Q),Re(Ny,ne),Re(DP,be),Wn(we))if(we.length){const Ze=a.exposed||(a.exposed={});we.forEach($e=>{Object.defineProperty(Ze,$e,{get:()=>t[$e],set:ct=>t[$e]=ct})})}else a.exposed||(a.exposed={});re&&a.render===GA&&(a.render=re),oe!=null&&(a.inheritAttrs=oe),me&&(a.components=me),Le&&(a.directives=Le),be&&H5(a)}function GP(a,e,t=GA){Wn(a)&&(a=Ub(a));for(const s in a){const c=a[s];let h;wa(c)?"default"in c?h=od(c.from||s,c.default,!0):h=od(c.from||s):h=od(c),ml(h)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>h.value,set:A=>h.value=A}):e[s]=h}}function hS(a,e,t){YA(Wn(a)?a.map(s=>s.bind(e.proxy)):a.bind(e.proxy),e,t)}function X5(a,e,t,s){let c=s.includes(".")?aI(t,s):()=>t[s];if(Dl(a)){const h=e[a];Ss(h)&&QA(c,h)}else if(Ss(a))QA(c,a.bind(t));else if(wa(a))if(Wn(a))a.forEach(h=>X5(h,e,t,s));else{const h=Ss(a.handler)?a.handler.bind(t):e[a.handler];Ss(h)&&QA(c,h,a)}}function Y5(a){const e=a.type,{mixins:t,extends:s}=e,{mixins:c,optionsCache:h,config:{optionMergeStrategies:A}}=a.appContext,r=h.get(e);let y;return r?y=r:!c.length&&!t&&!s?y=e:(y={},c.length&&c.forEach(b=>j0(y,b,A,!0)),j0(y,e,A)),wa(e)&&h.set(e,y),y}function j0(a,e,t,s=!1){const{mixins:c,extends:h}=e;h&&j0(a,h,t,!0),c&&c.forEach(A=>j0(a,A,t,!0));for(const A in e)if(!(s&&A==="expose")){const r=WP[A]||t&&t[A];a[A]=r?r(a[A],e[A]):e[A]}return a}const WP={data:dS,props:AS,emits:AS,methods:my,computed:my,beforeCreate:Pu,created:Pu,beforeMount:Pu,mounted:Pu,beforeUpdate:Pu,updated:Pu,beforeDestroy:Pu,beforeUnmount:Pu,destroyed:Pu,unmounted:Pu,activated:Pu,deactivated:Pu,errorCaptured:Pu,serverPrefetch:Pu,components:my,directives:my,watch:YP,provide:dS,inject:XP};function dS(a,e){return e?a?function(){return uu(Ss(a)?a.call(this,this):a,Ss(e)?e.call(this,this):e)}:e:a}function XP(a,e){return my(Ub(a),Ub(e))}function Ub(a){if(Wn(a)){const e={};for(let t=0;t<a.length;t++)e[a[t]]=a[t];return e}return a}function Pu(a,e){return a?[...new Set([].concat(a,e))]:e}function my(a,e){return a?uu(Object.create(null),a,e):e}function AS(a,e){return a?Wn(a)&&Wn(e)?[...new Set([...a,...e])]:uu(Object.create(null),uS(a),uS(e??{})):e}function YP(a,e){if(!a)return e;if(!e)return a;const t=uu(Object.create(null),a);for(const s in e)t[s]=Pu(a[s],e[s]);return t}function K5(){return{app:null,config:{isNativeTag:z3,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let KP=0;function qP(a,e){return function(s,c=null){Ss(s)||(s=uu({},s)),c!=null&&!wa(c)&&(c=null);const h=K5(),A=new WeakSet,r=[];let y=!1;const b=h.app={_uid:KP++,_component:s,_props:c,_container:null,_context:h,_instance:null,version:Mk,get config(){return h.config},set config(_){},use(_,...B){return A.has(_)||(_&&Ss(_.install)?(A.add(_),_.install(b,...B)):Ss(_)&&(A.add(_),_(b,...B))),b},mixin(_){return h.mixins.includes(_)||h.mixins.push(_),b},component(_,B){return B?(h.components[_]=B,b):h.components[_]},directive(_,B){return B?(h.directives[_]=B,b):h.directives[_]},mount(_,B,I){if(!y){const E=b._ceVNode||Pn(s,c);return E.appContext=h,I===!0?I="svg":I===!1&&(I=void 0),a(E,_,I),y=!0,b._container=_,_.__vue_app__=b,l_(E.component)}},onUnmount(_){r.push(_)},unmount(){y&&(YA(r,b._instance,16),a(null,b._container),delete b._container.__vue_app__)},provide(_,B){return h.provides[_]=B,b},runWithContext(_){const B=pg;pg=b;try{return _()}finally{pg=B}}};return b}}let pg=null;function _0(a,e){if(mc){let t=mc.provides;const s=mc.parent&&mc.parent.provides;s===t&&(t=mc.provides=Object.create(s)),t[a]=e}}function od(a,e,t=!1){const s=mc||Du;if(s||pg){let c=pg?pg._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(c&&a in c)return c[a];if(arguments.length>1)return t&&Ss(e)?e.call(s&&s.proxy):e}}function $P(){return!!(mc||Du||pg)}const q5={},$5=()=>Object.create(q5),Z5=a=>Object.getPrototypeOf(a)===q5;function ZP(a,e,t,s=!1){const c={},h=$5();a.propsDefaults=Object.create(null),J5(a,e,c,h);for(const A in a.propsOptions[0])A in c||(c[A]=void 0);t?a.props=s?c:M5(c):a.type.props?a.props=c:a.props=h,a.attrs=h}function JP(a,e,t,s){const{props:c,attrs:h,vnode:{patchFlag:A}}=a,r=Co(c),[y]=a.propsOptions;let b=!1;if((s||A>0)&&!(A&16)){if(A&8){const _=a.vnode.dynamicProps;for(let B=0;B<_.length;B++){let I=_[B];if(o_(a.emitsOptions,I))continue;const E=e[I];if(y)if(Oo(h,I))E!==h[I]&&(h[I]=E,b=!0);else{const R=cd(I);c[R]=zb(y,r,R,E,a,!1)}else E!==h[I]&&(h[I]=E,b=!0)}}}else{J5(a,e,c,h)&&(b=!0);let _;for(const B in r)(!e||!Oo(e,B)&&((_=Sg(B))===B||!Oo(e,_)))&&(y?t&&(t[B]!==void 0||t[_]!==void 0)&&(c[B]=zb(y,r,B,void 0,a,!0)):delete c[B]);if(h!==r)for(const B in h)(!e||!Oo(e,B))&&(delete h[B],b=!0)}b&&Bf(a.attrs,"set","")}function J5(a,e,t,s){const[c,h]=a.propsOptions;let A=!1,r;if(e)for(let y in e){if(_y(y))continue;const b=e[y];let _;c&&Oo(c,_=cd(y))?!h||!h.includes(_)?t[_]=b:(r||(r={}))[_]=b:o_(a.emitsOptions,y)||(!(y in s)||b!==s[y])&&(s[y]=b,A=!0)}if(h){const y=Co(t),b=r||Aa;for(let _=0;_<h.length;_++){const B=h[_];t[B]=zb(c,y,B,b[B],a,!Oo(b,B))}}return A}function zb(a,e,t,s,c,h){const A=a[t];if(A!=null){const r=Oo(A,"default");if(r&&s===void 0){const y=A.default;if(A.type!==Function&&!A.skipFactory&&Ss(y)){const{propsDefaults:b}=c;if(t in b)s=b[t];else{const _=sv(c);s=b[t]=y.call(null,e),_()}}else s=y;c.ce&&c.ce._setProp(t,s)}A[0]&&(h&&!r?s=!1:A[1]&&(s===""||s===Sg(t))&&(s=!0))}return s}const ek=new WeakMap;function eI(a,e,t=!1){const s=t?ek:e.propsCache,c=s.get(a);if(c)return c;const h=a.props,A={},r=[];let y=!1;if(!Ss(a)){const _=B=>{y=!0;const[I,E]=eI(B,e,!0);uu(A,I),E&&r.push(...E)};!t&&e.mixins.length&&e.mixins.forEach(_),a.extends&&_(a.extends),a.mixins&&a.mixins.forEach(_)}if(!h&&!y)return wa(a)&&s.set(a,sm),sm;if(Wn(h))for(let _=0;_<h.length;_++){const B=cd(h[_]);fS(B)&&(A[B]=Aa)}else if(h)for(const _ in h){const B=cd(_);if(fS(B)){const I=h[_],E=A[B]=Wn(I)||Ss(I)?{type:I}:uu({},I),R=E.type;let M=!1,G=!0;if(Wn(R))for(let U=0;U<R.length;++U){const Q=R[U],q=Ss(Q)&&Q.name;if(q==="Boolean"){M=!0;break}else q==="String"&&(G=!1)}else M=Ss(R)&&R.name==="Boolean";E[0]=M,E[1]=G,(M||Oo(E,"default"))&&r.push(B)}}const b=[A,r];return wa(a)&&s.set(a,b),b}function fS(a){return a[0]!=="$"&&!_y(a)}const W1=a=>a[0]==="_"||a==="$stable",X1=a=>Wn(a)?a.map(HA):[HA(a)],tk=(a,e,t)=>{if(e._n)return e;const s=ng((...c)=>X1(e(...c)),t);return s._c=!1,s},tI=(a,e,t)=>{const s=a._ctx;for(const c in a){if(W1(c))continue;const h=a[c];if(Ss(h))e[c]=tk(c,h,s);else if(h!=null){const A=X1(h);e[c]=()=>A}}},iI=(a,e)=>{const t=X1(e);a.slots.default=()=>t},rI=(a,e,t)=>{for(const s in e)(t||!W1(s))&&(a[s]=e[s])},ik=(a,e,t)=>{const s=a.slots=$5();if(a.vnode.shapeFlag&32){const c=e.__;c&&Mb(s,"__",c,!0);const h=e._;h?(rI(s,e,t),t&&Mb(s,"_",h,!0)):tI(e,s)}else e&&iI(a,e)},rk=(a,e,t)=>{const{vnode:s,slots:c}=a;let h=!0,A=Aa;if(s.shapeFlag&32){const r=e._;r?t&&r===1?h=!1:rI(c,e,t):(h=!e.$stable,tI(e,c)),A=e}else e&&(iI(a,e),A={default:1});if(h)for(const r in c)!W1(r)&&A[r]==null&&delete c[r]},Dh=mk;function nk(a){return sk(a)}function sk(a,e){const t=i_();t.__VUE__=!0;const{insert:s,remove:c,patchProp:h,createElement:A,createText:r,createComment:y,setText:b,setElementText:_,parentNode:B,nextSibling:I,setScopeId:E=GA,insertStaticContent:R}=a,M=(ze,Ve,kt,Ft=null,it=null,yi=null,bi=void 0,Kt=null,di=!!Ve.dynamicChildren)=>{if(ze===Ve)return;ze&&!cy(ze,Ve)&&(Ft=rt(ze),Ce(ze,it,yi,!0),ze=null),Ve.patchFlag===-2&&(di=!1,Ve.dynamicChildren=null);const{type:fi,ref:Ri,shapeFlag:Oi}=Ve;switch(fi){case a_:G(ze,Ve,kt,Ft);break;case Tp:U(ze,Ve,kt,Ft);break;case Yx:ze==null&&Q(Ve,kt,Ft,bi);break;case Al:me(ze,Ve,kt,Ft,it,yi,bi,Kt,di);break;default:Oi&1?re(ze,Ve,kt,Ft,it,yi,bi,Kt,di):Oi&6?Le(ze,Ve,kt,Ft,it,yi,bi,Kt,di):(Oi&64||Oi&128)&&fi.process(ze,Ve,kt,Ft,it,yi,bi,Kt,di,Gt)}Ri!=null&&it?wy(Ri,ze&&ze.ref,yi,Ve||ze,!Ve):Ri==null&&ze&&ze.ref!=null&&wy(ze.ref,null,yi,ze,!0)},G=(ze,Ve,kt,Ft)=>{if(ze==null)s(Ve.el=r(Ve.children),kt,Ft);else{const it=Ve.el=ze.el;Ve.children!==ze.children&&b(it,Ve.children)}},U=(ze,Ve,kt,Ft)=>{ze==null?s(Ve.el=y(Ve.children||""),kt,Ft):Ve.el=ze.el},Q=(ze,Ve,kt,Ft)=>{[ze.el,ze.anchor]=R(ze.children,Ve,kt,Ft,ze.el,ze.anchor)},q=({el:ze,anchor:Ve},kt,Ft)=>{let it;for(;ze&&ze!==Ve;)it=I(ze),s(ze,kt,Ft),ze=it;s(Ve,kt,Ft)},ne=({el:ze,anchor:Ve})=>{let kt;for(;ze&&ze!==Ve;)kt=I(ze),c(ze),ze=kt;c(Ve)},re=(ze,Ve,kt,Ft,it,yi,bi,Kt,di)=>{Ve.type==="svg"?bi="svg":Ve.type==="math"&&(bi="mathml"),ze==null?pe(Ve,kt,Ft,it,yi,bi,Kt,di):be(ze,Ve,it,yi,bi,Kt,di)},pe=(ze,Ve,kt,Ft,it,yi,bi,Kt)=>{let di,fi;const{props:Ri,shapeFlag:Oi,transition:Ji,dirs:lr}=ze;if(di=ze.el=A(ze.type,yi,Ri&&Ri.is,Ri),Oi&8?_(di,ze.children):Oi&16&&le(ze.children,di,null,Ft,it,Xx(ze,yi),bi,Kt),lr&&tg(ze,null,Ft,"created"),Ae(di,ze,ze.scopeId,bi,Ft),Ri){for(const Dr in Ri)Dr!=="value"&&!_y(Dr)&&h(di,Dr,null,Ri[Dr],yi,Ft);"value"in Ri&&h(di,"value",null,Ri.value,yi),(fi=Ri.onVnodeBeforeMount)&&UA(fi,Ft,ze)}lr&&tg(ze,null,Ft,"beforeMount");const br=ok(it,Ji);br&&Ji.beforeEnter(di),s(di,Ve,kt),((fi=Ri&&Ri.onVnodeMounted)||br||lr)&&Dh(()=>{fi&&UA(fi,Ft,ze),br&&Ji.enter(di),lr&&tg(ze,null,Ft,"mounted")},it)},Ae=(ze,Ve,kt,Ft,it)=>{if(kt&&E(ze,kt),Ft)for(let yi=0;yi<Ft.length;yi++)E(ze,Ft[yi]);if(it){let yi=it.subTree;if(Ve===yi||cI(yi.type)&&(yi.ssContent===Ve||yi.ssFallback===Ve)){const bi=it.vnode;Ae(ze,bi,bi.scopeId,bi.slotScopeIds,it.parent)}}},le=(ze,Ve,kt,Ft,it,yi,bi,Kt,di=0)=>{for(let fi=di;fi<ze.length;fi++){const Ri=ze[fi]=Kt?mp(ze[fi]):HA(ze[fi]);M(null,Ri,Ve,kt,Ft,it,yi,bi,Kt)}},be=(ze,Ve,kt,Ft,it,yi,bi)=>{const Kt=Ve.el=ze.el;let{patchFlag:di,dynamicChildren:fi,dirs:Ri}=Ve;di|=ze.patchFlag&16;const Oi=ze.props||Aa,Ji=Ve.props||Aa;let lr;if(kt&&ig(kt,!1),(lr=Ji.onVnodeBeforeUpdate)&&UA(lr,kt,Ve,ze),Ri&&tg(Ve,ze,kt,"beforeUpdate"),kt&&ig(kt,!0),(Oi.innerHTML&&Ji.innerHTML==null||Oi.textContent&&Ji.textContent==null)&&_(Kt,""),fi?we(ze.dynamicChildren,fi,Kt,kt,Ft,Xx(Ve,it),yi):bi||$e(ze,Ve,Kt,null,kt,Ft,Xx(Ve,it),yi,!1),di>0){if(di&16)oe(Kt,Oi,Ji,kt,it);else if(di&2&&Oi.class!==Ji.class&&h(Kt,"class",null,Ji.class,it),di&4&&h(Kt,"style",Oi.style,Ji.style,it),di&8){const br=Ve.dynamicProps;for(let Dr=0;Dr<br.length;Dr++){const Fr=br[Dr],Qr=Oi[Fr],ui=Ji[Fr];(ui!==Qr||Fr==="value")&&h(Kt,Fr,Qr,ui,it,kt)}}di&1&&ze.children!==Ve.children&&_(Kt,Ve.children)}else!bi&&fi==null&&oe(Kt,Oi,Ji,kt,it);((lr=Ji.onVnodeUpdated)||Ri)&&Dh(()=>{lr&&UA(lr,kt,Ve,ze),Ri&&tg(Ve,ze,kt,"updated")},Ft)},we=(ze,Ve,kt,Ft,it,yi,bi)=>{for(let Kt=0;Kt<Ve.length;Kt++){const di=ze[Kt],fi=Ve[Kt],Ri=di.el&&(di.type===Al||!cy(di,fi)||di.shapeFlag&198)?B(di.el):kt;M(di,fi,Ri,null,Ft,it,yi,bi,!0)}},oe=(ze,Ve,kt,Ft,it)=>{if(Ve!==kt){if(Ve!==Aa)for(const yi in Ve)!_y(yi)&&!(yi in kt)&&h(ze,yi,Ve[yi],null,it,Ft);for(const yi in kt){if(_y(yi))continue;const bi=kt[yi],Kt=Ve[yi];bi!==Kt&&yi!=="value"&&h(ze,yi,Kt,bi,it,Ft)}"value"in kt&&h(ze,"value",Ve.value,kt.value,it)}},me=(ze,Ve,kt,Ft,it,yi,bi,Kt,di)=>{const fi=Ve.el=ze?ze.el:r(""),Ri=Ve.anchor=ze?ze.anchor:r("");let{patchFlag:Oi,dynamicChildren:Ji,slotScopeIds:lr}=Ve;lr&&(Kt=Kt?Kt.concat(lr):lr),ze==null?(s(fi,kt,Ft),s(Ri,kt,Ft),le(Ve.children||[],kt,Ri,it,yi,bi,Kt,di)):Oi>0&&Oi&64&&Ji&&ze.dynamicChildren?(we(ze.dynamicChildren,Ji,kt,it,yi,bi,Kt),(Ve.key!=null||it&&Ve===it.subTree)&&nI(ze,Ve,!0)):$e(ze,Ve,kt,Ri,it,yi,bi,Kt,di)},Le=(ze,Ve,kt,Ft,it,yi,bi,Kt,di)=>{Ve.slotScopeIds=Kt,ze==null?Ve.shapeFlag&512?it.ctx.activate(Ve,kt,Ft,bi,di):Se(Ve,kt,Ft,it,yi,bi,di):Me(ze,Ve,di)},Se=(ze,Ve,kt,Ft,it,yi,bi)=>{const Kt=ze.component=Bk(ze,Ft,it);if(Q5(ze)&&(Kt.ctx.renderer=Gt),Sk(Kt,!1,bi),Kt.asyncDep){if(it&&it.registerDep(Kt,Re,bi),!ze.el){const di=Kt.subTree=Pn(Tp);U(null,di,Ve,kt)}}else Re(Kt,ze,Ve,kt,it,yi,bi)},Me=(ze,Ve,kt)=>{const Ft=Ve.component=ze.component;if(pk(ze,Ve,kt))if(Ft.asyncDep&&!Ft.asyncResolved){Ze(Ft,Ve,kt);return}else Ft.next=Ve,Ft.update();else Ve.el=ze.el,Ft.vnode=Ve},Re=(ze,Ve,kt,Ft,it,yi,bi)=>{const Kt=()=>{if(ze.isMounted){let{next:Oi,bu:Ji,u:lr,parent:br,vnode:Dr}=ze;{const Vi=sI(ze);if(Vi){Oi&&(Oi.el=Dr.el,Ze(ze,Oi,bi)),Vi.asyncDep.then(()=>{ze.isUnmounted||Kt()});return}}let Fr=Oi,Qr;ig(ze,!1),Oi?(Oi.el=Dr.el,Ze(ze,Oi,bi)):Oi=Dr,Ji&&v0(Ji),(Qr=Oi.props&&Oi.props.onVnodeBeforeUpdate)&&UA(Qr,br,Oi,Dr),ig(ze,!0);const ui=gS(ze),li=ze.subTree;ze.subTree=ui,M(li,ui,B(li.el),rt(li),ze,it,yi),Oi.el=ui.el,Fr===null&&gk(ze,ui.el),lr&&Dh(lr,it),(Qr=Oi.props&&Oi.props.onVnodeUpdated)&&Dh(()=>UA(Qr,br,Oi,Dr),it)}else{let Oi;const{el:Ji,props:lr}=Ve,{bm:br,m:Dr,parent:Fr,root:Qr,type:ui}=ze,li=By(Ve);ig(ze,!1),br&&v0(br),!li&&(Oi=lr&&lr.onVnodeBeforeMount)&&UA(Oi,Fr,Ve),ig(ze,!0);{Qr.ce&&Qr.ce._def.shadowRoot!==!1&&Qr.ce._injectChildStyle(ui);const Vi=ze.subTree=gS(ze);M(null,Vi,kt,Ft,ze,it,yi),Ve.el=Vi.el}if(Dr&&Dh(Dr,it),!li&&(Oi=lr&&lr.onVnodeMounted)){const Vi=Ve;Dh(()=>UA(Oi,Fr,Vi),it)}(Ve.shapeFlag&256||Fr&&By(Fr.vnode)&&Fr.vnode.shapeFlag&256)&&ze.a&&Dh(ze.a,it),ze.isMounted=!0,Ve=kt=Ft=null}};ze.scope.on();const di=ze.effect=new y5(Kt);ze.scope.off();const fi=ze.update=di.run.bind(di),Ri=ze.job=di.runIfDirty.bind(di);Ri.i=ze,Ri.id=ze.uid,di.scheduler=()=>Q1(Ri),ig(ze,!0),fi()},Ze=(ze,Ve,kt)=>{Ve.component=ze;const Ft=ze.vnode.props;ze.vnode=Ve,ze.next=null,JP(ze,Ve.props,Ft,kt),rk(ze,Ve.children,kt),If(),lS(ze),Tf()},$e=(ze,Ve,kt,Ft,it,yi,bi,Kt,di=!1)=>{const fi=ze&&ze.children,Ri=ze?ze.shapeFlag:0,Oi=Ve.children,{patchFlag:Ji,shapeFlag:lr}=Ve;if(Ji>0){if(Ji&128){Qe(fi,Oi,kt,Ft,it,yi,bi,Kt,di);return}else if(Ji&256){ct(fi,Oi,kt,Ft,it,yi,bi,Kt,di);return}}lr&8?(Ri&16&&Bt(fi,it,yi),Oi!==fi&&_(kt,Oi)):Ri&16?lr&16?Qe(fi,Oi,kt,Ft,it,yi,bi,Kt,di):Bt(fi,it,yi,!0):(Ri&8&&_(kt,""),lr&16&&le(Oi,kt,Ft,it,yi,bi,Kt,di))},ct=(ze,Ve,kt,Ft,it,yi,bi,Kt,di)=>{ze=ze||sm,Ve=Ve||sm;const fi=ze.length,Ri=Ve.length,Oi=Math.min(fi,Ri);let Ji;for(Ji=0;Ji<Oi;Ji++){const lr=Ve[Ji]=di?mp(Ve[Ji]):HA(Ve[Ji]);M(ze[Ji],lr,kt,null,it,yi,bi,Kt,di)}fi>Ri?Bt(ze,it,yi,!0,!1,Oi):le(Ve,kt,Ft,it,yi,bi,Kt,di,Oi)},Qe=(ze,Ve,kt,Ft,it,yi,bi,Kt,di)=>{let fi=0;const Ri=Ve.length;let Oi=ze.length-1,Ji=Ri-1;for(;fi<=Oi&&fi<=Ji;){const lr=ze[fi],br=Ve[fi]=di?mp(Ve[fi]):HA(Ve[fi]);if(cy(lr,br))M(lr,br,kt,null,it,yi,bi,Kt,di);else break;fi++}for(;fi<=Oi&&fi<=Ji;){const lr=ze[Oi],br=Ve[Ji]=di?mp(Ve[Ji]):HA(Ve[Ji]);if(cy(lr,br))M(lr,br,kt,null,it,yi,bi,Kt,di);else break;Oi--,Ji--}if(fi>Oi){if(fi<=Ji){const lr=Ji+1,br=lr<Ri?Ve[lr].el:Ft;for(;fi<=Ji;)M(null,Ve[fi]=di?mp(Ve[fi]):HA(Ve[fi]),kt,br,it,yi,bi,Kt,di),fi++}}else if(fi>Ji)for(;fi<=Oi;)Ce(ze[fi],it,yi,!0),fi++;else{const lr=fi,br=fi,Dr=new Map;for(fi=br;fi<=Ji;fi++){const _r=Ve[fi]=di?mp(Ve[fi]):HA(Ve[fi]);_r.key!=null&&Dr.set(_r.key,fi)}let Fr,Qr=0;const ui=Ji-br+1;let li=!1,Vi=0;const rr=new Array(ui);for(fi=0;fi<ui;fi++)rr[fi]=0;for(fi=lr;fi<=Oi;fi++){const _r=ze[fi];if(Qr>=ui){Ce(_r,it,yi,!0);continue}let Zr;if(_r.key!=null)Zr=Dr.get(_r.key);else for(Fr=br;Fr<=Ji;Fr++)if(rr[Fr-br]===0&&cy(_r,Ve[Fr])){Zr=Fr;break}Zr===void 0?Ce(_r,it,yi,!0):(rr[Zr-br]=fi+1,Zr>=Vi?Vi=Zr:li=!0,M(_r,Ve[Zr],kt,null,it,yi,bi,Kt,di),Qr++)}const qr=li?ak(rr):sm;for(Fr=qr.length-1,fi=ui-1;fi>=0;fi--){const _r=br+fi,Zr=Ve[_r],io=_r+1<Ri?Ve[_r+1].el:Ft;rr[fi]===0?M(null,Zr,kt,io,it,yi,bi,Kt,di):li&&(Fr<0||fi!==qr[Fr]?It(Zr,kt,io,2):Fr--)}}},It=(ze,Ve,kt,Ft,it=null)=>{const{el:yi,type:bi,transition:Kt,children:di,shapeFlag:fi}=ze;if(fi&6){It(ze.component.subTree,Ve,kt,Ft);return}if(fi&128){ze.suspense.move(Ve,kt,Ft);return}if(fi&64){bi.move(ze,Ve,kt,Gt);return}if(bi===Al){s(yi,Ve,kt);for(let Oi=0;Oi<di.length;Oi++)It(di[Oi],Ve,kt,Ft);s(ze.anchor,Ve,kt);return}if(bi===Yx){q(ze,Ve,kt);return}if(Ft!==2&&fi&1&&Kt)if(Ft===0)Kt.beforeEnter(yi),s(yi,Ve,kt),Dh(()=>Kt.enter(yi),it);else{const{leave:Oi,delayLeave:Ji,afterLeave:lr}=Kt,br=()=>{ze.ctx.isUnmounted?c(yi):s(yi,Ve,kt)},Dr=()=>{Oi(yi,()=>{br(),lr&&lr()})};Ji?Ji(yi,br,Dr):Dr()}else s(yi,Ve,kt)},Ce=(ze,Ve,kt,Ft=!1,it=!1)=>{const{type:yi,props:bi,ref:Kt,children:di,dynamicChildren:fi,shapeFlag:Ri,patchFlag:Oi,dirs:Ji,cacheIndex:lr}=ze;if(Oi===-2&&(it=!1),Kt!=null&&(If(),wy(Kt,null,kt,ze,!0),Tf()),lr!=null&&(Ve.renderCache[lr]=void 0),Ri&256){Ve.ctx.deactivate(ze);return}const br=Ri&1&&Ji,Dr=!By(ze);let Fr;if(Dr&&(Fr=bi&&bi.onVnodeBeforeUnmount)&&UA(Fr,Ve,ze),Ri&6)mt(ze.component,kt,Ft);else{if(Ri&128){ze.suspense.unmount(kt,Ft);return}br&&tg(ze,null,Ve,"beforeUnmount"),Ri&64?ze.type.remove(ze,Ve,kt,Gt,Ft):fi&&!fi.hasOnce&&(yi!==Al||Oi>0&&Oi&64)?Bt(fi,Ve,kt,!1,!0):(yi===Al&&Oi&384||!it&&Ri&16)&&Bt(di,Ve,kt),Ft&&Je(ze)}(Dr&&(Fr=bi&&bi.onVnodeUnmounted)||br)&&Dh(()=>{Fr&&UA(Fr,Ve,ze),br&&tg(ze,null,Ve,"unmounted")},kt)},Je=ze=>{const{type:Ve,el:kt,anchor:Ft,transition:it}=ze;if(Ve===Al){lt(kt,Ft);return}if(Ve===Yx){ne(ze);return}const yi=()=>{c(kt),it&&!it.persisted&&it.afterLeave&&it.afterLeave()};if(ze.shapeFlag&1&&it&&!it.persisted){const{leave:bi,delayLeave:Kt}=it,di=()=>bi(kt,yi);Kt?Kt(ze.el,yi,di):di()}else yi()},lt=(ze,Ve)=>{let kt;for(;ze!==Ve;)kt=I(ze),c(ze),ze=kt;c(Ve)},mt=(ze,Ve,kt)=>{const{bum:Ft,scope:it,job:yi,subTree:bi,um:Kt,m:di,a:fi,parent:Ri,slots:{__:Oi}}=ze;pS(di),pS(fi),Ft&&v0(Ft),Ri&&Wn(Oi)&&Oi.forEach(Ji=>{Ri.renderCache[Ji]=void 0}),it.stop(),yi&&(yi.flags|=8,Ce(bi,ze,Ve,kt)),Kt&&Dh(Kt,Ve),Dh(()=>{ze.isUnmounted=!0},Ve),Ve&&Ve.pendingBranch&&!Ve.isUnmounted&&ze.asyncDep&&!ze.asyncResolved&&ze.suspenseId===Ve.pendingId&&(Ve.deps--,Ve.deps===0&&Ve.resolve())},Bt=(ze,Ve,kt,Ft=!1,it=!1,yi=0)=>{for(let bi=yi;bi<ze.length;bi++)Ce(ze[bi],Ve,kt,Ft,it)},rt=ze=>{if(ze.shapeFlag&6)return rt(ze.component.subTree);if(ze.shapeFlag&128)return ze.suspense.next();const Ve=I(ze.anchor||ze.el),kt=Ve&&Ve[TP];return kt?I(kt):Ve};let St=!1;const vt=(ze,Ve,kt)=>{ze==null?Ve._vnode&&Ce(Ve._vnode,null,null,!0):M(Ve._vnode||null,ze,Ve,null,null,null,kt),Ve._vnode=ze,St||(St=!0,lS(),z5(),St=!1)},Gt={p:M,um:Ce,m:It,r:Je,mt:Se,mc:le,pc:$e,pbc:we,n:rt,o:a};return{render:vt,hydrate:void 0,createApp:qP(vt)}}function Xx({type:a,props:e},t){return t==="svg"&&a==="foreignObject"||t==="mathml"&&a==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function ig({effect:a,job:e},t){t?(a.flags|=32,e.flags|=4):(a.flags&=-33,e.flags&=-5)}function ok(a,e){return(!a||a&&!a.pendingBranch)&&e&&!e.persisted}function nI(a,e,t=!1){const s=a.children,c=e.children;if(Wn(s)&&Wn(c))for(let h=0;h<s.length;h++){const A=s[h];let r=c[h];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=c[h]=mp(c[h]),r.el=A.el),!t&&r.patchFlag!==-2&&nI(A,r)),r.type===a_&&(r.el=A.el),r.type===Tp&&!r.el&&(r.el=A.el)}}function ak(a){const e=a.slice(),t=[0];let s,c,h,A,r;const y=a.length;for(s=0;s<y;s++){const b=a[s];if(b!==0){if(c=t[t.length-1],a[c]<b){e[s]=c,t.push(s);continue}for(h=0,A=t.length-1;h<A;)r=h+A>>1,a[t[r]]<b?h=r+1:A=r;b<a[t[h]]&&(h>0&&(e[s]=t[h-1]),t[h]=s)}}for(h=t.length,A=t[h-1];h-- >0;)t[h]=A,A=e[A];return t}function sI(a){const e=a.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:sI(e)}function pS(a){if(a)for(let e=0;e<a.length;e++)a[e].flags|=8}const lk=Symbol.for("v-scx"),ck=()=>od(lk);function QA(a,e,t){return oI(a,e,t)}function oI(a,e,t=Aa){const{immediate:s,deep:c,flush:h,once:A}=t,r=uu({},t),y=e&&s||!e&&h!=="post";let b;if(Hy){if(h==="sync"){const E=ck();b=E.__watcherHandles||(E.__watcherHandles=[])}else if(!y){const E=()=>{};return E.stop=GA,E.resume=GA,E.pause=GA,E}}const _=mc;r.call=(E,R,M)=>YA(E,_,R,M);let B=!1;h==="post"?r.scheduler=E=>{Dh(E,_&&_.suspense)}:h!=="sync"&&(B=!0,r.scheduler=(E,R)=>{R?E():Q1(E)}),r.augmentJob=E=>{e&&(E.flags|=4),B&&(E.flags|=2,_&&(E.id=_.uid,E.i=_))};const I=CP(a,e,r);return Hy&&(b?b.push(I):y&&I()),I}function uk(a,e,t){const s=this.proxy,c=Dl(a)?a.includes(".")?aI(s,a):()=>s[a]:a.bind(s,s);let h;Ss(e)?h=e:(h=e.handler,t=e);const A=sv(this),r=oI(c,h.bind(s),t);return A(),r}function aI(a,e){const t=e.split(".");return()=>{let s=a;for(let c=0;c<t.length&&s;c++)s=s[t[c]];return s}}const hk=(a,e)=>e==="modelValue"||e==="model-value"?a.modelModifiers:a[`${e}Modifiers`]||a[`${cd(e)}Modifiers`]||a[`${Sg(e)}Modifiers`];function dk(a,e,...t){if(a.isUnmounted)return;const s=a.vnode.props||Aa;let c=t;const h=e.startsWith("update:"),A=h&&hk(s,e.slice(7));A&&(A.trim&&(c=t.map(_=>Dl(_)?_.trim():_)),A.number&&(c=t.map(R0)));let r,y=s[r=jx(e)]||s[r=jx(cd(e))];!y&&h&&(y=s[r=jx(Sg(e))]),y&&YA(y,a,6,c);const b=s[r+"Once"];if(b){if(!a.emitted)a.emitted={};else if(a.emitted[r])return;a.emitted[r]=!0,YA(b,a,6,c)}}function lI(a,e,t=!1){const s=e.emitsCache,c=s.get(a);if(c!==void 0)return c;const h=a.emits;let A={},r=!1;if(!Ss(a)){const y=b=>{const _=lI(b,e,!0);_&&(r=!0,uu(A,_))};!t&&e.mixins.length&&e.mixins.forEach(y),a.extends&&y(a.extends),a.mixins&&a.mixins.forEach(y)}return!h&&!r?(wa(a)&&s.set(a,null),null):(Wn(h)?h.forEach(y=>A[y]=null):uu(A,h),wa(a)&&s.set(a,A),A)}function o_(a,e){return!a||!J0(e)?!1:(e=e.slice(2).replace(/Once$/,""),Oo(a,e[0].toLowerCase()+e.slice(1))||Oo(a,Sg(e))||Oo(a,e))}function gS(a){const{type:e,vnode:t,proxy:s,withProxy:c,propsOptions:[h],slots:A,attrs:r,emit:y,render:b,renderCache:_,props:B,data:I,setupState:E,ctx:R,inheritAttrs:M}=a,G=N0(a);let U,Q;try{if(t.shapeFlag&4){const ne=c||s,re=ne;U=HA(b.call(re,ne,_,B,E,I,R)),Q=r}else{const ne=e;U=HA(ne.length>1?ne(B,{attrs:r,slots:A,emit:y}):ne(B,null)),Q=e.props?r:Ak(r)}}catch(ne){Sy.length=0,n_(ne,a,1),U=Pn(Tp)}let q=U;if(Q&&M!==!1){const ne=Object.keys(Q),{shapeFlag:re}=q;ne.length&&re&7&&(h&&ne.some(F1)&&(Q=fk(Q,h)),q=cm(q,Q,!1,!0))}return t.dirs&&(q=cm(q,null,!1,!0),q.dirs=q.dirs?q.dirs.concat(t.dirs):t.dirs),t.transition&&V1(q,t.transition),U=q,N0(G),U}const Ak=a=>{let e;for(const t in a)(t==="class"||t==="style"||J0(t))&&((e||(e={}))[t]=a[t]);return e},fk=(a,e)=>{const t={};for(const s in a)(!F1(s)||!(s.slice(9)in e))&&(t[s]=a[s]);return t};function pk(a,e,t){const{props:s,children:c,component:h}=a,{props:A,children:r,patchFlag:y}=e,b=h.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&y>=0){if(y&1024)return!0;if(y&16)return s?mS(s,A,b):!!A;if(y&8){const _=e.dynamicProps;for(let B=0;B<_.length;B++){const I=_[B];if(A[I]!==s[I]&&!o_(b,I))return!0}}}else return(c||r)&&(!r||!r.$stable)?!0:s===A?!1:s?A?mS(s,A,b):!0:!!A;return!1}function mS(a,e,t){const s=Object.keys(e);if(s.length!==Object.keys(a).length)return!0;for(let c=0;c<s.length;c++){const h=s[c];if(e[h]!==a[h]&&!o_(t,h))return!0}return!1}function gk({vnode:a,parent:e},t){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===a&&(s.el=a.el),s===a)(a=e.vnode).el=t,e=e.parent;else break}}const cI=a=>a.__isSuspense;function mk(a,e){e&&e.pendingBranch?Wn(a)?e.effects.push(...a):e.effects.push(a):IP(a)}const Al=Symbol.for("v-fgt"),a_=Symbol.for("v-txt"),Tp=Symbol.for("v-cmt"),Yx=Symbol.for("v-stc"),Sy=[];let Oh=null;function yn(a=!1){Sy.push(Oh=a?null:[])}function yk(){Sy.pop(),Oh=Sy[Sy.length-1]||null}let jy=1;function yS(a,e=!1){jy+=a,a<0&&Oh&&e&&(Oh.hasOnce=!0)}function uI(a){return a.dynamicChildren=jy>0?Oh||sm:null,yk(),jy>0&&Oh&&Oh.push(a),a}function Nn(a,e,t,s,c,h){return uI(ot(a,e,t,s,c,h,!0))}function Wd(a,e,t,s,c){return uI(Pn(a,e,t,s,c,!0))}function H0(a){return a?a.__v_isVNode===!0:!1}function cy(a,e){return a.type===e.type&&a.key===e.key}const hI=({key:a})=>a??null,x0=({ref:a,ref_key:e,ref_for:t})=>(typeof a=="number"&&(a=""+a),a!=null?Dl(a)||ml(a)||Ss(a)?{i:Du,r:a,k:e,f:!!t}:a:null);function ot(a,e=null,t=null,s=0,c=null,h=a===Al?0:1,A=!1,r=!1){const y={__v_isVNode:!0,__v_skip:!0,type:a,props:e,key:e&&hI(e),ref:e&&x0(e),scopeId:j5,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:h,patchFlag:s,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Du};return r?(Y1(y,t),h&128&&a.normalize(y)):t&&(y.shapeFlag|=Dl(t)?8:16),jy>0&&!A&&Oh&&(y.patchFlag>0||h&6)&&y.patchFlag!==32&&Oh.push(y),y}const Pn=vk;function vk(a,e=null,t=null,s=0,c=null,h=!1){if((!a||a===jP)&&(a=Tp),H0(a)){const r=cm(a,e,!0);return t&&Y1(r,t),jy>0&&!h&&Oh&&(r.shapeFlag&6?Oh[Oh.indexOf(a)]=r:Oh.push(r)),r.patchFlag=-2,r}if(Lk(a)&&(a=a.__vccOpts),e){e=_k(e);let{class:r,style:y}=e;r&&!Dl(r)&&(e.class=Ep(r)),wa(y)&&(j1(y)&&!Wn(y)&&(y=uu({},y)),e.style=P1(y))}const A=Dl(a)?1:cI(a)?128:FP(a)?64:wa(a)?4:Ss(a)?2:0;return ot(a,e,t,s,c,A,h,!0)}function _k(a){return a?j1(a)||Z5(a)?uu({},a):a:null}function cm(a,e,t=!1,s=!1){const{props:c,ref:h,patchFlag:A,children:r,transition:y}=a,b=e?xk(c||{},e):c,_={__v_isVNode:!0,__v_skip:!0,type:a.type,props:b,key:b&&hI(b),ref:e&&e.ref?t&&h?Wn(h)?h.concat(x0(e)):[h,x0(e)]:x0(e):h,scopeId:a.scopeId,slotScopeIds:a.slotScopeIds,children:r,target:a.target,targetStart:a.targetStart,targetAnchor:a.targetAnchor,staticCount:a.staticCount,shapeFlag:a.shapeFlag,patchFlag:e&&a.type!==Al?A===-1?16:A|16:A,dynamicProps:a.dynamicProps,dynamicChildren:a.dynamicChildren,appContext:a.appContext,dirs:a.dirs,transition:y,component:a.component,suspense:a.suspense,ssContent:a.ssContent&&cm(a.ssContent),ssFallback:a.ssFallback&&cm(a.ssFallback),el:a.el,anchor:a.anchor,ctx:a.ctx,ce:a.ce};return y&&s&&V1(_,y.clone(_)),_}function xp(a=" ",e=0){return Pn(a_,null,a,e)}function ym(a="",e=!1){return e?(yn(),Wd(Tp,null,a)):Pn(Tp,null,a)}function HA(a){return a==null||typeof a=="boolean"?Pn(Tp):Wn(a)?Pn(Al,null,a.slice()):H0(a)?mp(a):Pn(a_,null,String(a))}function mp(a){return a.el===null&&a.patchFlag!==-1||a.memo?a:cm(a)}function Y1(a,e){let t=0;const{shapeFlag:s}=a;if(e==null)e=null;else if(Wn(e))t=16;else if(typeof e=="object")if(s&65){const c=e.default;c&&(c._c&&(c._d=!1),Y1(a,c()),c._c&&(c._d=!0));return}else{t=32;const c=e._;!c&&!Z5(e)?e._ctx=Du:c===3&&Du&&(Du.slots._===1?e._=1:(e._=2,a.patchFlag|=1024))}else Ss(e)?(e={default:e,_ctx:Du},t=32):(e=String(e),s&64?(t=16,e=[xp(e)]):t=8);a.children=e,a.shapeFlag|=t}function xk(...a){const e={};for(let t=0;t<a.length;t++){const s=a[t];for(const c in s)if(c==="class")e.class!==s.class&&(e.class=Ep([e.class,s.class]));else if(c==="style")e.style=P1([e.style,s.style]);else if(J0(c)){const h=e[c],A=s[c];A&&h!==A&&!(Wn(h)&&h.includes(A))&&(e[c]=h?[].concat(h,A):A)}else c!==""&&(e[c]=s[c])}return e}function UA(a,e,t,s=null){YA(a,e,7,[t,s])}const bk=K5();let wk=0;function Bk(a,e,t){const s=a.type,c=(e?e.appContext:a.appContext)||bk,h={uid:wk++,vnode:a,type:s,parent:e,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new p5(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(c.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eI(s,c),emitsOptions:lI(s,c),emit:null,emitted:null,propsDefaults:Aa,inheritAttrs:s.inheritAttrs,ctx:Aa,data:Aa,props:Aa,attrs:Aa,slots:Aa,refs:Aa,setupState:Aa,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return h.ctx={_:h},h.root=e?e.root:h,h.emit=dk.bind(null,h),a.ce&&a.ce(h),h}let mc=null;const Ck=()=>mc||Du;let Q0,Nb;{const a=i_(),e=(t,s)=>{let c;return(c=a[t])||(c=a[t]=[]),c.push(s),h=>{c.length>1?c.forEach(A=>A(h)):c[0](h)}};Q0=e("__VUE_INSTANCE_SETTERS__",t=>mc=t),Nb=e("__VUE_SSR_SETTERS__",t=>Hy=t)}const sv=a=>{const e=mc;return Q0(a),a.scope.on(),()=>{a.scope.off(),Q0(e)}},vS=()=>{mc&&mc.scope.off(),Q0(null)};function dI(a){return a.vnode.shapeFlag&4}let Hy=!1;function Sk(a,e=!1,t=!1){e&&Nb(e);const{props:s,children:c}=a.vnode,h=dI(a);ZP(a,s,h,e),ik(a,c,t||e);const A=h?Ek(a,e):void 0;return e&&Nb(!1),A}function Ek(a,e){const t=a.type;a.accessCache=Object.create(null),a.proxy=new Proxy(a.ctx,QP);const{setup:s}=t;if(s){If();const c=a.setupContext=s.length>1?Tk(a):null,h=sv(a),A=iv(s,a,0,[a.props,c]),r=c5(A);if(Tf(),h(),(r||a.sp)&&!By(a)&&H5(a),r){if(A.then(vS,vS),e)return A.then(y=>{_S(a,y)}).catch(y=>{n_(y,a,0)});a.asyncDep=A}else _S(a,A)}else AI(a)}function _S(a,e,t){Ss(e)?a.type.__ssrInlineRender?a.ssrRender=e:a.render=e:wa(e)&&(a.setupState=R5(e)),AI(a)}function AI(a,e,t){const s=a.type;a.render||(a.render=s.render||GA);{const c=sv(a);If();try{VP(a)}finally{Tf(),c()}}}const Ik={get(a,e){return au(a,"get",""),a[e]}};function Tk(a){const e=t=>{a.exposed=t||{}};return{attrs:new Proxy(a.attrs,Ik),slots:a.slots,emit:a.emit,expose:e}}function l_(a){return a.exposed?a.exposeProxy||(a.exposeProxy=new Proxy(R5(H1(a.exposed)),{get(e,t){if(t in e)return e[t];if(t in Cy)return Cy[t](a)},has(e,t){return t in e||t in Cy}})):a.proxy}function Fk(a,e=!0){return Ss(a)?a.displayName||a.name:a.name||e&&a.__name}function Lk(a){return Ss(a)&&"__vccOpts"in a}const qa=(a,e)=>wP(a,e,Hy);function K1(a,e,t){const s=arguments.length;return s===2?wa(e)&&!Wn(e)?H0(e)?Pn(a,null,[e]):Pn(a,e):Pn(a,null,e):(s>3?t=Array.prototype.slice.call(arguments,2):s===3&&H0(t)&&(t=[t]),Pn(a,e,t))}const Mk="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jb;const xS=typeof window<"u"&&window.trustedTypes;if(xS)try{jb=xS.createPolicy("vue",{createHTML:a=>a})}catch{}const fI=jb?a=>jb.createHTML(a):a=>a,Pk="http://www.w3.org/2000/svg",kk="http://www.w3.org/1998/Math/MathML",wf=typeof document<"u"?document:null,bS=wf&&wf.createElement("template"),Rk={insert:(a,e,t)=>{e.insertBefore(a,t||null)},remove:a=>{const e=a.parentNode;e&&e.removeChild(a)},createElement:(a,e,t,s)=>{const c=e==="svg"?wf.createElementNS(Pk,a):e==="mathml"?wf.createElementNS(kk,a):t?wf.createElement(a,{is:t}):wf.createElement(a);return a==="select"&&s&&s.multiple!=null&&c.setAttribute("multiple",s.multiple),c},createText:a=>wf.createTextNode(a),createComment:a=>wf.createComment(a),setText:(a,e)=>{a.nodeValue=e},setElementText:(a,e)=>{a.textContent=e},parentNode:a=>a.parentNode,nextSibling:a=>a.nextSibling,querySelector:a=>wf.querySelector(a),setScopeId(a,e){a.setAttribute(e,"")},insertStaticContent(a,e,t,s,c,h){const A=t?t.previousSibling:e.lastChild;if(c&&(c===h||c.nextSibling))for(;e.insertBefore(c.cloneNode(!0),t),!(c===h||!(c=c.nextSibling)););else{bS.innerHTML=fI(s==="svg"?`<svg>${a}</svg>`:s==="mathml"?`<math>${a}</math>`:a);const r=bS.content;if(s==="svg"||s==="mathml"){const y=r.firstChild;for(;y.firstChild;)r.appendChild(y.firstChild);r.removeChild(y)}e.insertBefore(r,t)}return[A?A.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Dk=Symbol("_vtc");function Ok(a,e,t){const s=a[Dk];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?a.removeAttribute("class"):t?a.setAttribute("class",e):a.className=e}const V0=Symbol("_vod"),pI=Symbol("_vsh"),_f={beforeMount(a,{value:e},{transition:t}){a[V0]=a.style.display==="none"?"":a.style.display,t&&e?t.beforeEnter(a):uy(a,e)},mounted(a,{value:e},{transition:t}){t&&e&&t.enter(a)},updated(a,{value:e,oldValue:t},{transition:s}){!e!=!t&&(s?e?(s.beforeEnter(a),uy(a,!0),s.enter(a)):s.leave(a,()=>{uy(a,!1)}):uy(a,e))},beforeUnmount(a,{value:e}){uy(a,e)}};function uy(a,e){a.style.display=e?a[V0]:"none",a[pI]=!e}const Uk=Symbol(""),zk=/(^|;)\s*display\s*:/;function Nk(a,e,t){const s=a.style,c=Dl(t);let h=!1;if(t&&!c){if(e)if(Dl(e))for(const A of e.split(";")){const r=A.slice(0,A.indexOf(":")).trim();t[r]==null&&b0(s,r,"")}else for(const A in e)t[A]==null&&b0(s,A,"");for(const A in t)A==="display"&&(h=!0),b0(s,A,t[A])}else if(c){if(e!==t){const A=s[Uk];A&&(t+=";"+A),s.cssText=t,h=zk.test(t)}}else e&&a.removeAttribute("style");V0 in a&&(a[V0]=h?s.display:"",a[pI]&&(s.display="none"))}const wS=/\s*!important$/;function b0(a,e,t){if(Wn(t))t.forEach(s=>b0(a,e,s));else if(t==null&&(t=""),e.startsWith("--"))a.setProperty(e,t);else{const s=jk(a,e);wS.test(t)?a.setProperty(Sg(s),t.replace(wS,""),"important"):a[s]=t}}const BS=["Webkit","Moz","ms"],Kx={};function jk(a,e){const t=Kx[e];if(t)return t;let s=cd(e);if(s!=="filter"&&s in a)return Kx[e]=s;s=t_(s);for(let c=0;c<BS.length;c++){const h=BS[c]+s;if(h in a)return Kx[e]=h}return e}const CS="http://www.w3.org/1999/xlink";function SS(a,e,t,s,c,h=K3(e)){s&&e.startsWith("xlink:")?t==null?a.removeAttributeNS(CS,e.slice(6,e.length)):a.setAttributeNS(CS,e,t):t==null||h&&!d5(t)?a.removeAttribute(e):a.setAttribute(e,h?"":XA(t)?String(t):t)}function ES(a,e,t,s,c){if(e==="innerHTML"||e==="textContent"){t!=null&&(a[e]=e==="innerHTML"?fI(t):t);return}const h=a.tagName;if(e==="value"&&h!=="PROGRESS"&&!h.includes("-")){const r=h==="OPTION"?a.getAttribute("value")||"":a.value,y=t==null?a.type==="checkbox"?"on":"":String(t);(r!==y||!("_value"in a))&&(a.value=y),t==null&&a.removeAttribute(e),a._value=t;return}let A=!1;if(t===""||t==null){const r=typeof a[e];r==="boolean"?t=d5(t):t==null&&r==="string"?(t="",A=!0):r==="number"&&(t=0,A=!0)}try{a[e]=t}catch{}A&&a.removeAttribute(c||e)}function Sf(a,e,t,s){a.addEventListener(e,t,s)}function Hk(a,e,t,s){a.removeEventListener(e,t,s)}const IS=Symbol("_vei");function Qk(a,e,t,s,c=null){const h=a[IS]||(a[IS]={}),A=h[e];if(s&&A)A.value=s;else{const[r,y]=Vk(e);if(s){const b=h[e]=Xk(s,c);Sf(a,r,b,y)}else A&&(Hk(a,r,A,y),h[e]=void 0)}}const TS=/(?:Once|Passive|Capture)$/;function Vk(a){let e;if(TS.test(a)){e={};let s;for(;s=a.match(TS);)a=a.slice(0,a.length-s[0].length),e[s[0].toLowerCase()]=!0}return[a[2]===":"?a.slice(3):Sg(a.slice(2)),e]}let qx=0;const Gk=Promise.resolve(),Wk=()=>qx||(Gk.then(()=>qx=0),qx=Date.now());function Xk(a,e){const t=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=t.attached)return;YA(Yk(s,t.value),e,5,[s])};return t.value=a,t.attached=Wk(),t}function Yk(a,e){if(Wn(e)){const t=a.stopImmediatePropagation;return a.stopImmediatePropagation=()=>{t.call(a),a._stopped=!0},e.map(s=>c=>!c._stopped&&s&&s(c))}else return e}const FS=a=>a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)>96&&a.charCodeAt(2)<123,Kk=(a,e,t,s,c,h)=>{const A=c==="svg";e==="class"?Ok(a,s,A):e==="style"?Nk(a,t,s):J0(e)?F1(e)||Qk(a,e,t,s,h):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):qk(a,e,s,A))?(ES(a,e,s),!a.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&SS(a,e,s,A,h,e!=="value")):a._isVueCE&&(/[A-Z]/.test(e)||!Dl(s))?ES(a,cd(e),s,h,e):(e==="true-value"?a._trueValue=s:e==="false-value"&&(a._falseValue=s),SS(a,e,s,A))};function qk(a,e,t,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in a&&FS(e)&&Ss(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&a.tagName==="INPUT"||e==="type"&&a.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const c=a.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return FS(e)&&Dl(t)?!1:e in a}const Fp=a=>{const e=a.props["onUpdate:modelValue"]||!1;return Wn(e)?t=>v0(e,t):e};function $k(a){a.target.composing=!0}function LS(a){const e=a.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ad=Symbol("_assign"),Zl={created(a,{modifiers:{lazy:e,trim:t,number:s}},c){a[ad]=Fp(c);const h=s||c.props&&c.props.type==="number";Sf(a,e?"change":"input",A=>{if(A.target.composing)return;let r=a.value;t&&(r=r.trim()),h&&(r=R0(r)),a[ad](r)}),t&&Sf(a,"change",()=>{a.value=a.value.trim()}),e||(Sf(a,"compositionstart",$k),Sf(a,"compositionend",LS),Sf(a,"change",LS))},mounted(a,{value:e}){a.value=e??""},beforeUpdate(a,{value:e,oldValue:t,modifiers:{lazy:s,trim:c,number:h}},A){if(a[ad]=Fp(A),a.composing)return;const r=(h||a.type==="number")&&!/^0\d/.test(a.value)?R0(a.value):a.value,y=e??"";r!==y&&(document.activeElement===a&&a.type!=="range"&&(s&&e===t||c&&a.value.trim()===y)||(a.value=y))}},Zk={deep:!0,created(a,e,t){a[ad]=Fp(t),Sf(a,"change",()=>{const s=a._modelValue,c=um(a),h=a.checked,A=a[ad];if(Wn(s)){const r=k1(s,c),y=r!==-1;if(h&&!y)A(s.concat(c));else if(!h&&y){const b=[...s];b.splice(r,1),A(b)}}else if(mm(s)){const r=new Set(s);h?r.add(c):r.delete(c),A(r)}else A(gI(a,h))})},mounted:MS,beforeUpdate(a,e,t){a[ad]=Fp(t),MS(a,e,t)}};function MS(a,{value:e,oldValue:t},s){a._modelValue=e;let c;if(Wn(e))c=k1(e,s.props.value)>-1;else if(mm(e))c=e.has(s.props.value);else{if(e===t)return;c=bg(e,gI(a,!0))}a.checked!==c&&(a.checked=c)}const PS={created(a,{value:e},t){a.checked=bg(e,t.props.value),a[ad]=Fp(t),Sf(a,"change",()=>{a[ad](um(a))})},beforeUpdate(a,{value:e,oldValue:t},s){a[ad]=Fp(s),e!==t&&(a.checked=bg(e,s.props.value))}},c_={deep:!0,created(a,{value:e,modifiers:{number:t}},s){const c=mm(e);Sf(a,"change",()=>{const h=Array.prototype.filter.call(a.options,A=>A.selected).map(A=>t?R0(um(A)):um(A));a[ad](a.multiple?c?new Set(h):h:h[0]),a._assigning=!0,rv(()=>{a._assigning=!1})}),a[ad]=Fp(s)},mounted(a,{value:e}){kS(a,e)},beforeUpdate(a,e,t){a[ad]=Fp(t)},updated(a,{value:e}){a._assigning||kS(a,e)}};function kS(a,e){const t=a.multiple,s=Wn(e);if(!(t&&!s&&!mm(e))){for(let c=0,h=a.options.length;c<h;c++){const A=a.options[c],r=um(A);if(t)if(s){const y=typeof r;y==="string"||y==="number"?A.selected=e.some(b=>String(b)===String(r)):A.selected=k1(e,r)>-1}else A.selected=e.has(r);else if(bg(um(A),e)){a.selectedIndex!==c&&(a.selectedIndex=c);return}}!t&&a.selectedIndex!==-1&&(a.selectedIndex=-1)}}function um(a){return"_value"in a?a._value:a.value}function gI(a,e){const t=e?"_trueValue":"_falseValue";return t in a?a[t]:e}const Jk=["ctrl","shift","alt","meta"],e4={stop:a=>a.stopPropagation(),prevent:a=>a.preventDefault(),self:a=>a.target!==a.currentTarget,ctrl:a=>!a.ctrlKey,shift:a=>!a.shiftKey,alt:a=>!a.altKey,meta:a=>!a.metaKey,left:a=>"button"in a&&a.button!==0,middle:a=>"button"in a&&a.button!==1,right:a=>"button"in a&&a.button!==2,exact:(a,e)=>Jk.some(t=>a[`${t}Key`]&&!e.includes(t))},mI=(a,e)=>{const t=a._withMods||(a._withMods={}),s=e.join(".");return t[s]||(t[s]=(c,...h)=>{for(let A=0;A<e.length;A++){const r=e4[e[A]];if(r&&r(c,e))return}return a(c,...h)})},t4=uu({patchProp:Kk},Rk);let RS;function i4(){return RS||(RS=nk(t4))}const r4=(...a)=>{const e=i4().createApp(...a),{mount:t}=e;return e.mount=s=>{const c=s4(s);if(!c)return;const h=e._component;!Ss(h)&&!h.render&&!h.template&&(h.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const A=t(c,!1,n4(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),A},e};function n4(a){if(a instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&a instanceof MathMLElement)return"mathml"}function s4(a){return Dl(a)?document.querySelector(a):a}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let yI;const u_=a=>yI=a,vI=Symbol();function Hb(a){return a&&typeof a=="object"&&Object.prototype.toString.call(a)==="[object Object]"&&typeof a.toJSON!="function"}var Ey;(function(a){a.direct="direct",a.patchObject="patch object",a.patchFunction="patch function"})(Ey||(Ey={}));function o4(){const a=g5(!0),e=a.run(()=>sr({}));let t=[],s=[];const c=H1({install(h){u_(c),c._a=h,h.provide(vI,c),h.config.globalProperties.$pinia=c,s.forEach(A=>t.push(A)),s=[]},use(h){return this._a?t.push(h):s.push(h),this},_p:t,_a:null,_e:a,_s:new Map,state:e});return c}const _I=()=>{};function DS(a,e,t,s=_I){a.push(e);const c=()=>{const h=a.indexOf(e);h>-1&&(a.splice(h,1),s())};return!t&&m5()&&$3(c),c}function Kg(a,...e){a.slice().forEach(t=>{t(...e)})}const a4=a=>a(),OS=Symbol(),$x=Symbol();function Qb(a,e){a instanceof Map&&e instanceof Map?e.forEach((t,s)=>a.set(s,t)):a instanceof Set&&e instanceof Set&&e.forEach(a.add,a);for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t],c=a[t];Hb(c)&&Hb(s)&&a.hasOwnProperty(t)&&!ml(s)&&!Bp(s)?a[t]=Qb(c,s):a[t]=s}return a}const l4=Symbol();function c4(a){return!Hb(a)||!Object.prototype.hasOwnProperty.call(a,l4)}const{assign:pp}=Object;function u4(a){return!!(ml(a)&&a.effect)}function h4(a,e,t,s){const{state:c,actions:h,getters:A}=e,r=t.state.value[a];let y;function b(){r||(t.state.value[a]=c?c():{});const _=D5(t.state.value[a]);return pp(_,h,Object.keys(A||{}).reduce((B,I)=>(B[I]=H1(qa(()=>{u_(t);const E=t._s.get(a);return A[I].call(E,E)})),B),{}))}return y=xI(a,b,e,t,s,!0),y}function xI(a,e,t={},s,c,h){let A;const r=pp({actions:{}},t),y={deep:!0};let b,_,B=[],I=[],E;const R=s.state.value[a];!h&&!R&&(s.state.value[a]={}),sr({});let M;function G(le){let be;b=_=!1,typeof le=="function"?(le(s.state.value[a]),be={type:Ey.patchFunction,storeId:a,events:E}):(Qb(s.state.value[a],le),be={type:Ey.patchObject,payload:le,storeId:a,events:E});const we=M=Symbol();rv().then(()=>{M===we&&(b=!0)}),_=!0,Kg(B,be,s.state.value[a])}const U=h?function(){const{state:be}=t,we=be?be():{};this.$patch(oe=>{pp(oe,we)})}:_I;function Q(){A.stop(),B=[],I=[],s._s.delete(a)}const q=(le,be="")=>{if(OS in le)return le[$x]=be,le;const we=function(){u_(s);const oe=Array.from(arguments),me=[],Le=[];function Se(Ze){me.push(Ze)}function Me(Ze){Le.push(Ze)}Kg(I,{args:oe,name:we[$x],store:re,after:Se,onError:Me});let Re;try{Re=le.apply(this&&this.$id===a?this:re,oe)}catch(Ze){throw Kg(Le,Ze),Ze}return Re instanceof Promise?Re.then(Ze=>(Kg(me,Ze),Ze)).catch(Ze=>(Kg(Le,Ze),Promise.reject(Ze))):(Kg(me,Re),Re)};return we[OS]=!0,we[$x]=be,we},ne={_p:s,$id:a,$onAction:DS.bind(null,I),$patch:G,$reset:U,$subscribe(le,be={}){const we=DS(B,le,be.detached,()=>oe()),oe=A.run(()=>QA(()=>s.state.value[a],me=>{(be.flush==="sync"?_:b)&&le({storeId:a,type:Ey.direct,events:E},me)},pp({},y,be)));return we},$dispose:Q},re=Eg(ne);s._s.set(a,re);const Ae=(s._a&&s._a.runWithContext||a4)(()=>s._e.run(()=>(A=g5()).run(()=>e({action:q}))));for(const le in Ae){const be=Ae[le];if(ml(be)&&!u4(be)||Bp(be))h||(R&&c4(be)&&(ml(be)?be.value=R[le]:Qb(be,R[le])),s.state.value[a][le]=be);else if(typeof be=="function"){const we=q(be,le);Ae[le]=we,r.actions[le]=be}}return pp(re,Ae),pp(Co(re),Ae),Object.defineProperty(re,"$state",{get:()=>s.state.value[a],set:le=>{G(be=>{pp(be,le)})}}),s._p.forEach(le=>{pp(re,A.run(()=>le({store:re,app:s._a,pinia:s,options:r})))}),R&&h&&t.hydrate&&t.hydrate(re.$state,R),b=!0,_=!0,re}/*! #__NO_SIDE_EFFECTS__ */function d4(a,e,t){let s;const c=typeof e=="function";s=c?t:e;function h(A,r){const y=$P();return A=A||(y?od(vI,null):null),A&&u_(A),A=yI,A._s.has(a)||(c?xI(a,e,s,A):h4(a,s,A)),A._s.get(a)}return h.$id=a,h}const bI=d4("auth",{state:()=>({isAuthenticated:!1,user:null,selectedMeter:null}),actions:{async login(a){if(a.username==="demo@mail.com"&&a.password==="demo")this.isAuthenticated=!0,this.user={email:a.username},localStorage.setItem("isAuthenticated","true");else throw new Error("Credenciales incorrectas")},logout(){this.isAuthenticated=!1,this.user=null,this.selectedMeter=null,localStorage.removeItem("isAuthenticated")}}}),ol=(a,e)=>{const t=a.__vccOpts||a;for(const[s,c]of e)t[s]=c;return t},A4={class:"custom-sidebar-header"},f4={class:"sidebar-title"},p4={class:"sidebar-title"},g4={class:"custom-sidebar-menu"},m4={class:"menu-title"},y4={class:"menu-title"},v4={class:"menu-item non-clickable"},_4={class:"menu-title"},x4={class:"submenu"},b4={class:"submenu-title"},w4={class:"menu-title"},B4={class:"menu-title"},C4={class:"menu-title"},S4={class:"sidebar-footer"},E4={key:0,class:"mdi mdi-chevron-left"},I4={key:1,class:"mdi mdi-chevron-right"},T4={__name:"Sidebar",props:{isCollapsed:{type:Boolean,default:!1},isAuthenticated:{type:Boolean,default:!1}},emits:["toggleSidebar"],setup(a,{emit:e}){const t=[{href:"/historicos/tendencias",title:"Tendencias",icon:"mdi mdi-trending-up"},{href:"/historicos/estadisticas",title:"Estadísticas",icon:"mdi mdi-chart-bar"},{href:"/historicos/factor-carga",title:"Factor de Carga",icon:"mdi mdi-speedometer"},{href:"/historicos/anomalias",title:"Anomalías",icon:"mdi mdi-alert-circle-outline"},{href:"/historicos/patrones",title:"Patrones",icon:"mdi mdi-view-list"}];return(s,c)=>{const h=nv("router-link");return yn(),Nn("div",{class:Ep(["custom-sidebar",{collapsed:a.isCollapsed}])},[ot("div",A4,[ao(ot("h1",f4,"ANALÍTICA ENERGÉTICA",512),[[_f,!a.isCollapsed]]),ao(ot("h1",p4,"AE",512),[[_f,a.isCollapsed]])]),ot("nav",g4,[ot("ul",null,[ot("li",null,[Pn(h,{to:"/inicio",class:"menu-item"},{default:ng(()=>[c[1]||(c[1]=ot("i",{class:"mdi mdi-home-outline"},null,-1)),ao(ot("span",m4,"Inicio",512),[[_f,!a.isCollapsed]])]),_:1,__:[1]})]),a.isAuthenticated?(yn(),Nn(Al,{key:0},[ot("li",null,[Pn(h,{to:"/tiempo-real",class:"menu-item"},{default:ng(()=>[c[2]||(c[2]=ot("i",{class:"mdi mdi-clock-outline"},null,-1)),ao(ot("span",y4,"Tiempo Real",512),[[_f,!a.isCollapsed]])]),_:1,__:[2]})]),ot("li",null,[ot("div",v4,[c[3]||(c[3]=ot("i",{class:"mdi mdi-history"},null,-1)),ao(ot("span",_4,"Históricos",512),[[_f,!a.isCollapsed]])]),ao(ot("ul",x4,[(yn(),Nn(Al,null,$d(t,(A,r)=>ot("li",{key:r},[Pn(h,{to:A.href,class:"submenu-item"},{default:ng(()=>[ot("i",{class:Ep([A.icon,"submenu-icon"])},null,2),ot("span",b4,Hn(A.title),1)]),_:2},1032,["to"])])),64))],512),[[_f,!a.isCollapsed]])]),ot("li",null,[Pn(h,{to:"/reportes",class:"menu-item"},{default:ng(()=>[c[4]||(c[4]=ot("i",{class:"mdi mdi-file-chart"},null,-1)),ao(ot("span",w4,"Reportes",512),[[_f,!a.isCollapsed]])]),_:1,__:[4]})]),ot("li",null,[Pn(h,{to:"/consumo",class:"menu-item"},{default:ng(()=>[c[5]||(c[5]=ot("i",{class:"mdi mdi-flash-auto"},null,-1)),ao(ot("span",B4,"Análisis de Consumo",512),[[_f,!a.isCollapsed]])]),_:1,__:[5]})]),ot("li",null,[Pn(h,{to:"/configuracion",class:"menu-item"},{default:ng(()=>[c[6]||(c[6]=ot("i",{class:"mdi mdi-cog-outline"},null,-1)),ao(ot("span",C4,"Configuración",512),[[_f,!a.isCollapsed]])]),_:1,__:[6]})])],64)):ym("",!0)])]),ot("div",S4,[ot("button",{class:"toggle-button",onClick:c[0]||(c[0]=A=>s.$emit("toggleSidebar"))},[a.isCollapsed?(yn(),Nn("i",I4)):(yn(),Nn("i",E4))])])],2)}}},F4=ol(T4,[["__scopeId","data-v-466cad29"]]),L4={class:"layout"},M4={class:"main-content"},P4={__name:"App",setup(a){const e=bI(),t=sr(!1),s=()=>{t.value=!t.value};return(c,h)=>{const A=nv("router-view");return yn(),Nn("div",L4,[ot("aside",{class:Ep({sidebar:!0,collapsed:t.value})},[Pn(F4,{"is-collapsed":t.value,isAuthenticated:Po(e).isAuthenticated,onToggleSidebar:s,onLogout:Po(e).logout},null,8,["is-collapsed","isAuthenticated","onLogout"])],2),ot("main",M4,[(yn(),Wd(A,{key:c.$route.fullPath}))])])}}},k4=ol(P4,[["__scopeId","data-v-d53f2d41"]]),R4="modulepreload",D4=function(a,e){return new URL(a,e).href},US={},Qy=function(e,t,s){let c=Promise.resolve();if(t&&t.length>0){let A=function(_){return Promise.all(_.map(B=>Promise.resolve(B).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};const r=document.getElementsByTagName("link"),y=document.querySelector("meta[property=csp-nonce]"),b=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));c=A(t.map(_=>{if(_=D4(_,s),_ in US)return;US[_]=!0;const B=_.endsWith(".css"),I=B?'[rel="stylesheet"]':"";if(!!s)for(let M=r.length-1;M>=0;M--){const G=r[M];if(G.href===_&&(!B||G.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${_}"]${I}`))return;const R=document.createElement("link");if(R.rel=B?"stylesheet":R4,B||(R.as="script"),R.crossOrigin="",R.href=_,b&&R.setAttribute("nonce",b),document.head.appendChild(R),B)return new Promise((M,G)=>{R.addEventListener("load",M),R.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${_}`)))})}))}function h(A){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=A,window.dispatchEvent(r),!r.defaultPrevented)throw A}return c.then(A=>{for(const r of A||[])r.status==="rejected"&&h(r.reason);return e().catch(h)})};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const tm=typeof document<"u";function wI(a){return typeof a=="object"||"displayName"in a||"props"in a||"__vccOpts"in a}function O4(a){return a.__esModule||a[Symbol.toStringTag]==="Module"||a.default&&wI(a.default)}const Do=Object.assign;function Zx(a,e){const t={};for(const s in e){const c=e[s];t[s]=Zd(c)?c.map(a):a(c)}return t}const Iy=()=>{},Zd=Array.isArray,BI=/#/g,U4=/&/g,z4=/\//g,N4=/=/g,j4=/\?/g,CI=/\+/g,H4=/%5B/g,Q4=/%5D/g,SI=/%5E/g,V4=/%60/g,EI=/%7B/g,G4=/%7C/g,II=/%7D/g,W4=/%20/g;function q1(a){return encodeURI(""+a).replace(G4,"|").replace(H4,"[").replace(Q4,"]")}function X4(a){return q1(a).replace(EI,"{").replace(II,"}").replace(SI,"^")}function Vb(a){return q1(a).replace(CI,"%2B").replace(W4,"+").replace(BI,"%23").replace(U4,"%26").replace(V4,"`").replace(EI,"{").replace(II,"}").replace(SI,"^")}function Y4(a){return Vb(a).replace(N4,"%3D")}function K4(a){return q1(a).replace(BI,"%23").replace(j4,"%3F")}function q4(a){return a==null?"":K4(a).replace(z4,"%2F")}function Vy(a){try{return decodeURIComponent(""+a)}catch{}return""+a}const $4=/\/$/,Z4=a=>a.replace($4,"");function Jx(a,e,t="/"){let s,c={},h="",A="";const r=e.indexOf("#");let y=e.indexOf("?");return r<y&&r>=0&&(y=-1),y>-1&&(s=e.slice(0,y),h=e.slice(y+1,r>-1?r:e.length),c=a(h)),r>-1&&(s=s||e.slice(0,r),A=e.slice(r,e.length)),s=iR(s??e,t),{fullPath:s+(h&&"?")+h+A,path:s,query:c,hash:Vy(A)}}function J4(a,e){const t=e.query?a(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function zS(a,e){return!e||!a.toLowerCase().startsWith(e.toLowerCase())?a:a.slice(e.length)||"/"}function eR(a,e,t){const s=e.matched.length-1,c=t.matched.length-1;return s>-1&&s===c&&hm(e.matched[s],t.matched[c])&&TI(e.params,t.params)&&a(e.query)===a(t.query)&&e.hash===t.hash}function hm(a,e){return(a.aliasOf||a)===(e.aliasOf||e)}function TI(a,e){if(Object.keys(a).length!==Object.keys(e).length)return!1;for(const t in a)if(!tR(a[t],e[t]))return!1;return!0}function tR(a,e){return Zd(a)?NS(a,e):Zd(e)?NS(e,a):a===e}function NS(a,e){return Zd(e)?a.length===e.length&&a.every((t,s)=>t===e[s]):a.length===1&&a[0]===e}function iR(a,e){if(a.startsWith("/"))return a;if(!a)return e;const t=e.split("/"),s=a.split("/"),c=s[s.length-1];(c===".."||c===".")&&s.push("");let h=t.length-1,A,r;for(A=0;A<s.length;A++)if(r=s[A],r!==".")if(r==="..")h>1&&h--;else break;return t.slice(0,h).join("/")+"/"+s.slice(A).join("/")}const dp={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Gy;(function(a){a.pop="pop",a.push="push"})(Gy||(Gy={}));var Ty;(function(a){a.back="back",a.forward="forward",a.unknown=""})(Ty||(Ty={}));function rR(a){if(!a)if(tm){const e=document.querySelector("base");a=e&&e.getAttribute("href")||"/",a=a.replace(/^\w+:\/\/[^\/]+/,"")}else a="/";return a[0]!=="/"&&a[0]!=="#"&&(a="/"+a),Z4(a)}const nR=/^[^#]+#/;function sR(a,e){return a.replace(nR,"#")+e}function oR(a,e){const t=document.documentElement.getBoundingClientRect(),s=a.getBoundingClientRect();return{behavior:e.behavior,left:s.left-t.left-(e.left||0),top:s.top-t.top-(e.top||0)}}const h_=()=>({left:window.scrollX,top:window.scrollY});function aR(a){let e;if("el"in a){const t=a.el,s=typeof t=="string"&&t.startsWith("#"),c=typeof t=="string"?s?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!c)return;e=oR(c,a)}else e=a;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function jS(a,e){return(history.state?history.state.position-e:-1)+a}const Gb=new Map;function lR(a,e){Gb.set(a,e)}function cR(a){const e=Gb.get(a);return Gb.delete(a),e}let uR=()=>location.protocol+"//"+location.host;function FI(a,e){const{pathname:t,search:s,hash:c}=e,h=a.indexOf("#");if(h>-1){let r=c.includes(a.slice(h))?a.slice(h).length:1,y=c.slice(r);return y[0]!=="/"&&(y="/"+y),zS(y,"")}return zS(t,a)+s+c}function hR(a,e,t,s){let c=[],h=[],A=null;const r=({state:I})=>{const E=FI(a,location),R=t.value,M=e.value;let G=0;if(I){if(t.value=E,e.value=I,A&&A===R){A=null;return}G=M?I.position-M.position:0}else s(E);c.forEach(U=>{U(t.value,R,{delta:G,type:Gy.pop,direction:G?G>0?Ty.forward:Ty.back:Ty.unknown})})};function y(){A=t.value}function b(I){c.push(I);const E=()=>{const R=c.indexOf(I);R>-1&&c.splice(R,1)};return h.push(E),E}function _(){const{history:I}=window;I.state&&I.replaceState(Do({},I.state,{scroll:h_()}),"")}function B(){for(const I of h)I();h=[],window.removeEventListener("popstate",r),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",r),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:y,listen:b,destroy:B}}function HS(a,e,t,s=!1,c=!1){return{back:a,current:e,forward:t,replaced:s,position:window.history.length,scroll:c?h_():null}}function dR(a){const{history:e,location:t}=window,s={value:FI(a,t)},c={value:e.state};c.value||h(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function h(y,b,_){const B=a.indexOf("#"),I=B>-1?(t.host&&document.querySelector("base")?a:a.slice(B))+y:uR()+a+y;try{e[_?"replaceState":"pushState"](b,"",I),c.value=b}catch(E){console.error(E),t[_?"replace":"assign"](I)}}function A(y,b){const _=Do({},e.state,HS(c.value.back,y,c.value.forward,!0),b,{position:c.value.position});h(y,_,!0),s.value=y}function r(y,b){const _=Do({},c.value,e.state,{forward:y,scroll:h_()});h(_.current,_,!0);const B=Do({},HS(s.value,y,null),{position:_.position+1},b);h(y,B,!1),s.value=y}return{location:s,state:c,push:r,replace:A}}function AR(a){a=rR(a);const e=dR(a),t=hR(a,e.state,e.location,e.replace);function s(h,A=!0){A||t.pauseListeners(),history.go(h)}const c=Do({location:"",base:a,go:s,createHref:sR.bind(null,a)},e,t);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>e.state.value}),c}function fR(a){return typeof a=="string"||a&&typeof a=="object"}function LI(a){return typeof a=="string"||typeof a=="symbol"}const MI=Symbol("");var QS;(function(a){a[a.aborted=4]="aborted",a[a.cancelled=8]="cancelled",a[a.duplicated=16]="duplicated"})(QS||(QS={}));function dm(a,e){return Do(new Error,{type:a,[MI]:!0},e)}function xf(a,e){return a instanceof Error&&MI in a&&(e==null||!!(a.type&e))}const VS="[^/]+?",pR={sensitive:!1,strict:!1,start:!0,end:!0},gR=/[.+*?^${}()[\]/\\]/g;function mR(a,e){const t=Do({},pR,e),s=[];let c=t.start?"^":"";const h=[];for(const b of a){const _=b.length?[]:[90];t.strict&&!b.length&&(c+="/");for(let B=0;B<b.length;B++){const I=b[B];let E=40+(t.sensitive?.25:0);if(I.type===0)B||(c+="/"),c+=I.value.replace(gR,"\\$&"),E+=40;else if(I.type===1){const{value:R,repeatable:M,optional:G,regexp:U}=I;h.push({name:R,repeatable:M,optional:G});const Q=U||VS;if(Q!==VS){E+=10;try{new RegExp(`(${Q})`)}catch(ne){throw new Error(`Invalid custom RegExp for param "${R}" (${Q}): `+ne.message)}}let q=M?`((?:${Q})(?:/(?:${Q}))*)`:`(${Q})`;B||(q=G&&b.length<2?`(?:/${q})`:"/"+q),G&&(q+="?"),c+=q,E+=20,G&&(E+=-8),M&&(E+=-20),Q===".*"&&(E+=-50)}_.push(E)}s.push(_)}if(t.strict&&t.end){const b=s.length-1;s[b][s[b].length-1]+=.7000000000000001}t.strict||(c+="/?"),t.end?c+="$":t.strict&&!c.endsWith("/")&&(c+="(?:/|$)");const A=new RegExp(c,t.sensitive?"":"i");function r(b){const _=b.match(A),B={};if(!_)return null;for(let I=1;I<_.length;I++){const E=_[I]||"",R=h[I-1];B[R.name]=E&&R.repeatable?E.split("/"):E}return B}function y(b){let _="",B=!1;for(const I of a){(!B||!_.endsWith("/"))&&(_+="/"),B=!1;for(const E of I)if(E.type===0)_+=E.value;else if(E.type===1){const{value:R,repeatable:M,optional:G}=E,U=R in b?b[R]:"";if(Zd(U)&&!M)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const Q=Zd(U)?U.join("/"):U;if(!Q)if(G)I.length<2&&(_.endsWith("/")?_=_.slice(0,-1):B=!0);else throw new Error(`Missing required param "${R}"`);_+=Q}}return _||"/"}return{re:A,score:s,keys:h,parse:r,stringify:y}}function yR(a,e){let t=0;for(;t<a.length&&t<e.length;){const s=e[t]-a[t];if(s)return s;t++}return a.length<e.length?a.length===1&&a[0]===80?-1:1:a.length>e.length?e.length===1&&e[0]===80?1:-1:0}function PI(a,e){let t=0;const s=a.score,c=e.score;for(;t<s.length&&t<c.length;){const h=yR(s[t],c[t]);if(h)return h;t++}if(Math.abs(c.length-s.length)===1){if(GS(s))return 1;if(GS(c))return-1}return c.length-s.length}function GS(a){const e=a[a.length-1];return a.length>0&&e[e.length-1]<0}const vR={type:0,value:""},_R=/[a-zA-Z0-9_]/;function xR(a){if(!a)return[[]];if(a==="/")return[[vR]];if(!a.startsWith("/"))throw new Error(`Invalid path "${a}"`);function e(E){throw new Error(`ERR (${t})/"${b}": ${E}`)}let t=0,s=t;const c=[];let h;function A(){h&&c.push(h),h=[]}let r=0,y,b="",_="";function B(){b&&(t===0?h.push({type:0,value:b}):t===1||t===2||t===3?(h.length>1&&(y==="*"||y==="+")&&e(`A repeatable param (${b}) must be alone in its segment. eg: '/:ids+.`),h.push({type:1,value:b,regexp:_,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):e("Invalid state to consume buffer"),b="")}function I(){b+=y}for(;r<a.length;){if(y=a[r++],y==="\\"&&t!==2){s=t,t=4;continue}switch(t){case 0:y==="/"?(b&&B(),A()):y===":"?(B(),t=1):I();break;case 4:I(),t=s;break;case 1:y==="("?t=2:_R.test(y)?I():(B(),t=0,y!=="*"&&y!=="?"&&y!=="+"&&r--);break;case 2:y===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+y:t=3:_+=y;break;case 3:B(),t=0,y!=="*"&&y!=="?"&&y!=="+"&&r--,_="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${b}"`),B(),A(),c}function bR(a,e,t){const s=mR(xR(a.path),t),c=Do(s,{record:a,parent:e,children:[],alias:[]});return e&&!c.record.aliasOf==!e.record.aliasOf&&e.children.push(c),c}function wR(a,e){const t=[],s=new Map;e=KS({strict:!1,end:!0,sensitive:!1},e);function c(B){return s.get(B)}function h(B,I,E){const R=!E,M=XS(B);M.aliasOf=E&&E.record;const G=KS(e,B),U=[M];if("alias"in B){const ne=typeof B.alias=="string"?[B.alias]:B.alias;for(const re of ne)U.push(XS(Do({},M,{components:E?E.record.components:M.components,path:re,aliasOf:E?E.record:M})))}let Q,q;for(const ne of U){const{path:re}=ne;if(I&&re[0]!=="/"){const pe=I.record.path,Ae=pe[pe.length-1]==="/"?"":"/";ne.path=I.record.path+(re&&Ae+re)}if(Q=bR(ne,I,G),E?E.alias.push(Q):(q=q||Q,q!==Q&&q.alias.push(Q),R&&B.name&&!YS(Q)&&A(B.name)),kI(Q)&&y(Q),M.children){const pe=M.children;for(let Ae=0;Ae<pe.length;Ae++)h(pe[Ae],Q,E&&E.children[Ae])}E=E||Q}return q?()=>{A(q)}:Iy}function A(B){if(LI(B)){const I=s.get(B);I&&(s.delete(B),t.splice(t.indexOf(I),1),I.children.forEach(A),I.alias.forEach(A))}else{const I=t.indexOf(B);I>-1&&(t.splice(I,1),B.record.name&&s.delete(B.record.name),B.children.forEach(A),B.alias.forEach(A))}}function r(){return t}function y(B){const I=SR(B,t);t.splice(I,0,B),B.record.name&&!YS(B)&&s.set(B.record.name,B)}function b(B,I){let E,R={},M,G;if("name"in B&&B.name){if(E=s.get(B.name),!E)throw dm(1,{location:B});G=E.record.name,R=Do(WS(I.params,E.keys.filter(q=>!q.optional).concat(E.parent?E.parent.keys.filter(q=>q.optional):[]).map(q=>q.name)),B.params&&WS(B.params,E.keys.map(q=>q.name))),M=E.stringify(R)}else if(B.path!=null)M=B.path,E=t.find(q=>q.re.test(M)),E&&(R=E.parse(M),G=E.record.name);else{if(E=I.name?s.get(I.name):t.find(q=>q.re.test(I.path)),!E)throw dm(1,{location:B,currentLocation:I});G=E.record.name,R=Do({},I.params,B.params),M=E.stringify(R)}const U=[];let Q=E;for(;Q;)U.unshift(Q.record),Q=Q.parent;return{name:G,path:M,params:R,matched:U,meta:CR(U)}}a.forEach(B=>h(B));function _(){t.length=0,s.clear()}return{addRoute:h,resolve:b,removeRoute:A,clearRoutes:_,getRoutes:r,getRecordMatcher:c}}function WS(a,e){const t={};for(const s of e)s in a&&(t[s]=a[s]);return t}function XS(a){const e={path:a.path,redirect:a.redirect,name:a.name,meta:a.meta||{},aliasOf:a.aliasOf,beforeEnter:a.beforeEnter,props:BR(a),children:a.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in a?a.components||null:a.component&&{default:a.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function BR(a){const e={},t=a.props||!1;if("component"in a)e.default=t;else for(const s in a.components)e[s]=typeof t=="object"?t[s]:t;return e}function YS(a){for(;a;){if(a.record.aliasOf)return!0;a=a.parent}return!1}function CR(a){return a.reduce((e,t)=>Do(e,t.meta),{})}function KS(a,e){const t={};for(const s in a)t[s]=s in e?e[s]:a[s];return t}function SR(a,e){let t=0,s=e.length;for(;t!==s;){const h=t+s>>1;PI(a,e[h])<0?s=h:t=h+1}const c=ER(a);return c&&(s=e.lastIndexOf(c,s-1)),s}function ER(a){let e=a;for(;e=e.parent;)if(kI(e)&&PI(a,e)===0)return e}function kI({record:a}){return!!(a.name||a.components&&Object.keys(a.components).length||a.redirect)}function IR(a){const e={};if(a===""||a==="?")return e;const s=(a[0]==="?"?a.slice(1):a).split("&");for(let c=0;c<s.length;++c){const h=s[c].replace(CI," "),A=h.indexOf("="),r=Vy(A<0?h:h.slice(0,A)),y=A<0?null:Vy(h.slice(A+1));if(r in e){let b=e[r];Zd(b)||(b=e[r]=[b]),b.push(y)}else e[r]=y}return e}function qS(a){let e="";for(let t in a){const s=a[t];if(t=Y4(t),s==null){s!==void 0&&(e+=(e.length?"&":"")+t);continue}(Zd(s)?s.map(h=>h&&Vb(h)):[s&&Vb(s)]).forEach(h=>{h!==void 0&&(e+=(e.length?"&":"")+t,h!=null&&(e+="="+h))})}return e}function TR(a){const e={};for(const t in a){const s=a[t];s!==void 0&&(e[t]=Zd(s)?s.map(c=>c==null?null:""+c):s==null?s:""+s)}return e}const FR=Symbol(""),$S=Symbol(""),d_=Symbol(""),$1=Symbol(""),Wb=Symbol("");function hy(){let a=[];function e(s){return a.push(s),()=>{const c=a.indexOf(s);c>-1&&a.splice(c,1)}}function t(){a=[]}return{add:e,list:()=>a.slice(),reset:t}}function yp(a,e,t,s,c,h=A=>A()){const A=s&&(s.enterCallbacks[c]=s.enterCallbacks[c]||[]);return()=>new Promise((r,y)=>{const b=I=>{I===!1?y(dm(4,{from:t,to:e})):I instanceof Error?y(I):fR(I)?y(dm(2,{from:e,to:I})):(A&&s.enterCallbacks[c]===A&&typeof I=="function"&&A.push(I),r())},_=h(()=>a.call(s&&s.instances[c],e,t,b));let B=Promise.resolve(_);a.length<3&&(B=B.then(b)),B.catch(I=>y(I))})}function eb(a,e,t,s,c=h=>h()){const h=[];for(const A of a)for(const r in A.components){let y=A.components[r];if(!(e!=="beforeRouteEnter"&&!A.instances[r]))if(wI(y)){const _=(y.__vccOpts||y)[e];_&&h.push(yp(_,t,s,A,r,c))}else{let b=y();h.push(()=>b.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${r}" at "${A.path}"`);const B=O4(_)?_.default:_;A.mods[r]=_,A.components[r]=B;const E=(B.__vccOpts||B)[e];return E&&yp(E,t,s,A,r,c)()}))}}return h}function ZS(a){const e=od(d_),t=od($1),s=qa(()=>{const y=Po(a.to);return e.resolve(y)}),c=qa(()=>{const{matched:y}=s.value,{length:b}=y,_=y[b-1],B=t.matched;if(!_||!B.length)return-1;const I=B.findIndex(hm.bind(null,_));if(I>-1)return I;const E=JS(y[b-2]);return b>1&&JS(_)===E&&B[B.length-1].path!==E?B.findIndex(hm.bind(null,y[b-2])):I}),h=qa(()=>c.value>-1&&RR(t.params,s.value.params)),A=qa(()=>c.value>-1&&c.value===t.matched.length-1&&TI(t.params,s.value.params));function r(y={}){if(kR(y)){const b=e[Po(a.replace)?"replace":"push"](Po(a.to)).catch(Iy);return a.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>b),b}return Promise.resolve()}return{route:s,href:qa(()=>s.value.href),isActive:h,isExactActive:A,navigate:r}}function LR(a){return a.length===1?a[0]:a}const MR=G1({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ZS,setup(a,{slots:e}){const t=Eg(ZS(a)),{options:s}=od(d_),c=qa(()=>({[eE(a.activeClass,s.linkActiveClass,"router-link-active")]:t.isActive,[eE(a.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const h=e.default&&LR(e.default(t));return a.custom?h:K1("a",{"aria-current":t.isExactActive?a.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:c.value},h)}}}),PR=MR;function kR(a){if(!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)&&!a.defaultPrevented&&!(a.button!==void 0&&a.button!==0)){if(a.currentTarget&&a.currentTarget.getAttribute){const e=a.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return a.preventDefault&&a.preventDefault(),!0}}function RR(a,e){for(const t in e){const s=e[t],c=a[t];if(typeof s=="string"){if(s!==c)return!1}else if(!Zd(c)||c.length!==s.length||s.some((h,A)=>h!==c[A]))return!1}return!0}function JS(a){return a?a.aliasOf?a.aliasOf.path:a.path:""}const eE=(a,e,t)=>a??e??t,DR=G1({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(a,{attrs:e,slots:t}){const s=od(Wb),c=qa(()=>a.route||s.value),h=od($S,0),A=qa(()=>{let b=Po(h);const{matched:_}=c.value;let B;for(;(B=_[b])&&!B.components;)b++;return b}),r=qa(()=>c.value.matched[A.value]);_0($S,qa(()=>A.value+1)),_0(FR,r),_0(Wb,c);const y=sr();return QA(()=>[y.value,r.value,a.name],([b,_,B],[I,E,R])=>{_&&(_.instances[B]=b,E&&E!==_&&b&&b===I&&(_.leaveGuards.size||(_.leaveGuards=E.leaveGuards),_.updateGuards.size||(_.updateGuards=E.updateGuards))),b&&_&&(!E||!hm(_,E)||!I)&&(_.enterCallbacks[B]||[]).forEach(M=>M(b))},{flush:"post"}),()=>{const b=c.value,_=a.name,B=r.value,I=B&&B.components[_];if(!I)return tE(t.default,{Component:I,route:b});const E=B.props[_],R=E?E===!0?b.params:typeof E=="function"?E(b):E:null,G=K1(I,Do({},R,e,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(B.instances[_]=null)},ref:y}));return tE(t.default,{Component:G,route:b})||G}}});function tE(a,e){if(!a)return null;const t=a(e);return t.length===1?t[0]:t}const OR=DR;function UR(a){const e=wR(a.routes,a),t=a.parseQuery||IR,s=a.stringifyQuery||qS,c=a.history,h=hy(),A=hy(),r=hy(),y=mP(dp);let b=dp;tm&&a.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=Zx.bind(null,rt=>""+rt),B=Zx.bind(null,q4),I=Zx.bind(null,Vy);function E(rt,St){let vt,Gt;return LI(rt)?(vt=e.getRecordMatcher(rt),Gt=St):Gt=rt,e.addRoute(Gt,vt)}function R(rt){const St=e.getRecordMatcher(rt);St&&e.removeRoute(St)}function M(){return e.getRoutes().map(rt=>rt.record)}function G(rt){return!!e.getRecordMatcher(rt)}function U(rt,St){if(St=Do({},St||y.value),typeof rt=="string"){const kt=Jx(t,rt,St.path),Ft=e.resolve({path:kt.path},St),it=c.createHref(kt.fullPath);return Do(kt,Ft,{params:I(Ft.params),hash:Vy(kt.hash),redirectedFrom:void 0,href:it})}let vt;if(rt.path!=null)vt=Do({},rt,{path:Jx(t,rt.path,St.path).path});else{const kt=Do({},rt.params);for(const Ft in kt)kt[Ft]==null&&delete kt[Ft];vt=Do({},rt,{params:B(kt)}),St.params=B(St.params)}const Gt=e.resolve(vt,St),mi=rt.hash||"";Gt.params=_(I(Gt.params));const ze=J4(s,Do({},rt,{hash:X4(mi),path:Gt.path})),Ve=c.createHref(ze);return Do({fullPath:ze,hash:mi,query:s===qS?TR(rt.query):rt.query||{}},Gt,{redirectedFrom:void 0,href:Ve})}function Q(rt){return typeof rt=="string"?Jx(t,rt,y.value.path):Do({},rt)}function q(rt,St){if(b!==rt)return dm(8,{from:St,to:rt})}function ne(rt){return Ae(rt)}function re(rt){return ne(Do(Q(rt),{replace:!0}))}function pe(rt){const St=rt.matched[rt.matched.length-1];if(St&&St.redirect){const{redirect:vt}=St;let Gt=typeof vt=="function"?vt(rt):vt;return typeof Gt=="string"&&(Gt=Gt.includes("?")||Gt.includes("#")?Gt=Q(Gt):{path:Gt},Gt.params={}),Do({query:rt.query,hash:rt.hash,params:Gt.path!=null?{}:rt.params},Gt)}}function Ae(rt,St){const vt=b=U(rt),Gt=y.value,mi=rt.state,ze=rt.force,Ve=rt.replace===!0,kt=pe(vt);if(kt)return Ae(Do(Q(kt),{state:typeof kt=="object"?Do({},mi,kt.state):mi,force:ze,replace:Ve}),St||vt);const Ft=vt;Ft.redirectedFrom=St;let it;return!ze&&eR(s,Gt,vt)&&(it=dm(16,{to:Ft,from:Gt}),It(Gt,Gt,!0,!1)),(it?Promise.resolve(it):we(Ft,Gt)).catch(yi=>xf(yi)?xf(yi,2)?yi:Qe(yi):$e(yi,Ft,Gt)).then(yi=>{if(yi){if(xf(yi,2))return Ae(Do({replace:Ve},Q(yi.to),{state:typeof yi.to=="object"?Do({},mi,yi.to.state):mi,force:ze}),St||Ft)}else yi=me(Ft,Gt,!0,Ve,mi);return oe(Ft,Gt,yi),yi})}function le(rt,St){const vt=q(rt,St);return vt?Promise.reject(vt):Promise.resolve()}function be(rt){const St=lt.values().next().value;return St&&typeof St.runWithContext=="function"?St.runWithContext(rt):rt()}function we(rt,St){let vt;const[Gt,mi,ze]=zR(rt,St);vt=eb(Gt.reverse(),"beforeRouteLeave",rt,St);for(const kt of Gt)kt.leaveGuards.forEach(Ft=>{vt.push(yp(Ft,rt,St))});const Ve=le.bind(null,rt,St);return vt.push(Ve),Bt(vt).then(()=>{vt=[];for(const kt of h.list())vt.push(yp(kt,rt,St));return vt.push(Ve),Bt(vt)}).then(()=>{vt=eb(mi,"beforeRouteUpdate",rt,St);for(const kt of mi)kt.updateGuards.forEach(Ft=>{vt.push(yp(Ft,rt,St))});return vt.push(Ve),Bt(vt)}).then(()=>{vt=[];for(const kt of ze)if(kt.beforeEnter)if(Zd(kt.beforeEnter))for(const Ft of kt.beforeEnter)vt.push(yp(Ft,rt,St));else vt.push(yp(kt.beforeEnter,rt,St));return vt.push(Ve),Bt(vt)}).then(()=>(rt.matched.forEach(kt=>kt.enterCallbacks={}),vt=eb(ze,"beforeRouteEnter",rt,St,be),vt.push(Ve),Bt(vt))).then(()=>{vt=[];for(const kt of A.list())vt.push(yp(kt,rt,St));return vt.push(Ve),Bt(vt)}).catch(kt=>xf(kt,8)?kt:Promise.reject(kt))}function oe(rt,St,vt){r.list().forEach(Gt=>be(()=>Gt(rt,St,vt)))}function me(rt,St,vt,Gt,mi){const ze=q(rt,St);if(ze)return ze;const Ve=St===dp,kt=tm?history.state:{};vt&&(Gt||Ve?c.replace(rt.fullPath,Do({scroll:Ve&&kt&&kt.scroll},mi)):c.push(rt.fullPath,mi)),y.value=rt,It(rt,St,vt,Ve),Qe()}let Le;function Se(){Le||(Le=c.listen((rt,St,vt)=>{if(!mt.listening)return;const Gt=U(rt),mi=pe(Gt);if(mi){Ae(Do(mi,{replace:!0,force:!0}),Gt).catch(Iy);return}b=Gt;const ze=y.value;tm&&lR(jS(ze.fullPath,vt.delta),h_()),we(Gt,ze).catch(Ve=>xf(Ve,12)?Ve:xf(Ve,2)?(Ae(Do(Q(Ve.to),{force:!0}),Gt).then(kt=>{xf(kt,20)&&!vt.delta&&vt.type===Gy.pop&&c.go(-1,!1)}).catch(Iy),Promise.reject()):(vt.delta&&c.go(-vt.delta,!1),$e(Ve,Gt,ze))).then(Ve=>{Ve=Ve||me(Gt,ze,!1),Ve&&(vt.delta&&!xf(Ve,8)?c.go(-vt.delta,!1):vt.type===Gy.pop&&xf(Ve,20)&&c.go(-1,!1)),oe(Gt,ze,Ve)}).catch(Iy)}))}let Me=hy(),Re=hy(),Ze;function $e(rt,St,vt){Qe(rt);const Gt=Re.list();return Gt.length?Gt.forEach(mi=>mi(rt,St,vt)):console.error(rt),Promise.reject(rt)}function ct(){return Ze&&y.value!==dp?Promise.resolve():new Promise((rt,St)=>{Me.add([rt,St])})}function Qe(rt){return Ze||(Ze=!rt,Se(),Me.list().forEach(([St,vt])=>rt?vt(rt):St()),Me.reset()),rt}function It(rt,St,vt,Gt){const{scrollBehavior:mi}=a;if(!tm||!mi)return Promise.resolve();const ze=!vt&&cR(jS(rt.fullPath,0))||(Gt||!vt)&&history.state&&history.state.scroll||null;return rv().then(()=>mi(rt,St,ze)).then(Ve=>Ve&&aR(Ve)).catch(Ve=>$e(Ve,rt,St))}const Ce=rt=>c.go(rt);let Je;const lt=new Set,mt={currentRoute:y,listening:!0,addRoute:E,removeRoute:R,clearRoutes:e.clearRoutes,hasRoute:G,getRoutes:M,resolve:U,options:a,push:ne,replace:re,go:Ce,back:()=>Ce(-1),forward:()=>Ce(1),beforeEach:h.add,beforeResolve:A.add,afterEach:r.add,onError:Re.add,isReady:ct,install(rt){const St=this;rt.component("RouterLink",PR),rt.component("RouterView",OR),rt.config.globalProperties.$router=St,Object.defineProperty(rt.config.globalProperties,"$route",{enumerable:!0,get:()=>Po(y)}),tm&&!Je&&y.value===dp&&(Je=!0,ne(c.location).catch(mi=>{}));const vt={};for(const mi in dp)Object.defineProperty(vt,mi,{get:()=>y.value[mi],enumerable:!0});rt.provide(d_,St),rt.provide($1,M5(vt)),rt.provide(Wb,y);const Gt=rt.unmount;lt.add(rt),rt.unmount=function(){lt.delete(rt),lt.size<1&&(b=dp,Le&&Le(),Le=null,y.value=dp,Je=!1,Ze=!1),Gt()}}};function Bt(rt){return rt.reduce((St,vt)=>St.then(()=>be(vt)),Promise.resolve())}return mt}function zR(a,e){const t=[],s=[],c=[],h=Math.max(e.matched.length,a.matched.length);for(let A=0;A<h;A++){const r=e.matched[A];r&&(a.matched.find(b=>hm(b,r))?s.push(r):t.push(r));const y=a.matched[A];y&&(e.matched.find(b=>hm(b,y))||c.push(y))}return[t,s,c]}function NR(){return od(d_)}function jR(a){return od($1)}var h0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z1(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function HR(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var e=a.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(a).forEach(function(s){var c=Object.getOwnPropertyDescriptor(a,s);Object.defineProperty(t,s,c.get?c:{enumerable:!0,get:function(){return a[s]}})}),t}var w0={exports:{}},QR=w0.exports,iE;function VR(){return iE||(iE=1,function(a,e){(function(t,s){a.exports=s()})(QR,function(){var t=1e3,s=6e4,c=36e5,h="millisecond",A="second",r="minute",y="hour",b="day",_="week",B="month",I="quarter",E="year",R="date",M="Invalid Date",G=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Se){var Me=["th","st","nd","rd"],Re=Se%100;return"["+Se+(Me[(Re-20)%10]||Me[Re]||Me[0])+"]"}},q=function(Se,Me,Re){var Ze=String(Se);return!Ze||Ze.length>=Me?Se:""+Array(Me+1-Ze.length).join(Re)+Se},ne={s:q,z:function(Se){var Me=-Se.utcOffset(),Re=Math.abs(Me),Ze=Math.floor(Re/60),$e=Re%60;return(Me<=0?"+":"-")+q(Ze,2,"0")+":"+q($e,2,"0")},m:function Se(Me,Re){if(Me.date()<Re.date())return-Se(Re,Me);var Ze=12*(Re.year()-Me.year())+(Re.month()-Me.month()),$e=Me.clone().add(Ze,B),ct=Re-$e<0,Qe=Me.clone().add(Ze+(ct?-1:1),B);return+(-(Ze+(Re-$e)/(ct?$e-Qe:Qe-$e))||0)},a:function(Se){return Se<0?Math.ceil(Se)||0:Math.floor(Se)},p:function(Se){return{M:B,y:E,w:_,d:b,D:R,h:y,m:r,s:A,ms:h,Q:I}[Se]||String(Se||"").toLowerCase().replace(/s$/,"")},u:function(Se){return Se===void 0}},re="en",pe={};pe[re]=Q;var Ae="$isDayjsObject",le=function(Se){return Se instanceof me||!(!Se||!Se[Ae])},be=function Se(Me,Re,Ze){var $e;if(!Me)return re;if(typeof Me=="string"){var ct=Me.toLowerCase();pe[ct]&&($e=ct),Re&&(pe[ct]=Re,$e=ct);var Qe=Me.split("-");if(!$e&&Qe.length>1)return Se(Qe[0])}else{var It=Me.name;pe[It]=Me,$e=It}return!Ze&&$e&&(re=$e),$e||!Ze&&re},we=function(Se,Me){if(le(Se))return Se.clone();var Re=typeof Me=="object"?Me:{};return Re.date=Se,Re.args=arguments,new me(Re)},oe=ne;oe.l=be,oe.i=le,oe.w=function(Se,Me){return we(Se,{locale:Me.$L,utc:Me.$u,x:Me.$x,$offset:Me.$offset})};var me=function(){function Se(Re){this.$L=be(Re.locale,null,!0),this.parse(Re),this.$x=this.$x||Re.x||{},this[Ae]=!0}var Me=Se.prototype;return Me.parse=function(Re){this.$d=function(Ze){var $e=Ze.date,ct=Ze.utc;if($e===null)return new Date(NaN);if(oe.u($e))return new Date;if($e instanceof Date)return new Date($e);if(typeof $e=="string"&&!/Z$/i.test($e)){var Qe=$e.match(G);if(Qe){var It=Qe[2]-1||0,Ce=(Qe[7]||"0").substring(0,3);return ct?new Date(Date.UTC(Qe[1],It,Qe[3]||1,Qe[4]||0,Qe[5]||0,Qe[6]||0,Ce)):new Date(Qe[1],It,Qe[3]||1,Qe[4]||0,Qe[5]||0,Qe[6]||0,Ce)}}return new Date($e)}(Re),this.init()},Me.init=function(){var Re=this.$d;this.$y=Re.getFullYear(),this.$M=Re.getMonth(),this.$D=Re.getDate(),this.$W=Re.getDay(),this.$H=Re.getHours(),this.$m=Re.getMinutes(),this.$s=Re.getSeconds(),this.$ms=Re.getMilliseconds()},Me.$utils=function(){return oe},Me.isValid=function(){return this.$d.toString()!==M},Me.isSame=function(Re,Ze){var $e=we(Re);return this.startOf(Ze)<=$e&&$e<=this.endOf(Ze)},Me.isAfter=function(Re,Ze){return we(Re)<this.startOf(Ze)},Me.isBefore=function(Re,Ze){return this.endOf(Ze)<we(Re)},Me.$g=function(Re,Ze,$e){return oe.u(Re)?this[Ze]:this.set($e,Re)},Me.unix=function(){return Math.floor(this.valueOf()/1e3)},Me.valueOf=function(){return this.$d.getTime()},Me.startOf=function(Re,Ze){var $e=this,ct=!!oe.u(Ze)||Ze,Qe=oe.p(Re),It=function(vt,Gt){var mi=oe.w($e.$u?Date.UTC($e.$y,Gt,vt):new Date($e.$y,Gt,vt),$e);return ct?mi:mi.endOf(b)},Ce=function(vt,Gt){return oe.w($e.toDate()[vt].apply($e.toDate("s"),(ct?[0,0,0,0]:[23,59,59,999]).slice(Gt)),$e)},Je=this.$W,lt=this.$M,mt=this.$D,Bt="set"+(this.$u?"UTC":"");switch(Qe){case E:return ct?It(1,0):It(31,11);case B:return ct?It(1,lt):It(0,lt+1);case _:var rt=this.$locale().weekStart||0,St=(Je<rt?Je+7:Je)-rt;return It(ct?mt-St:mt+(6-St),lt);case b:case R:return Ce(Bt+"Hours",0);case y:return Ce(Bt+"Minutes",1);case r:return Ce(Bt+"Seconds",2);case A:return Ce(Bt+"Milliseconds",3);default:return this.clone()}},Me.endOf=function(Re){return this.startOf(Re,!1)},Me.$set=function(Re,Ze){var $e,ct=oe.p(Re),Qe="set"+(this.$u?"UTC":""),It=($e={},$e[b]=Qe+"Date",$e[R]=Qe+"Date",$e[B]=Qe+"Month",$e[E]=Qe+"FullYear",$e[y]=Qe+"Hours",$e[r]=Qe+"Minutes",$e[A]=Qe+"Seconds",$e[h]=Qe+"Milliseconds",$e)[ct],Ce=ct===b?this.$D+(Ze-this.$W):Ze;if(ct===B||ct===E){var Je=this.clone().set(R,1);Je.$d[It](Ce),Je.init(),this.$d=Je.set(R,Math.min(this.$D,Je.daysInMonth())).$d}else It&&this.$d[It](Ce);return this.init(),this},Me.set=function(Re,Ze){return this.clone().$set(Re,Ze)},Me.get=function(Re){return this[oe.p(Re)]()},Me.add=function(Re,Ze){var $e,ct=this;Re=Number(Re);var Qe=oe.p(Ze),It=function(lt){var mt=we(ct);return oe.w(mt.date(mt.date()+Math.round(lt*Re)),ct)};if(Qe===B)return this.set(B,this.$M+Re);if(Qe===E)return this.set(E,this.$y+Re);if(Qe===b)return It(1);if(Qe===_)return It(7);var Ce=($e={},$e[r]=s,$e[y]=c,$e[A]=t,$e)[Qe]||1,Je=this.$d.getTime()+Re*Ce;return oe.w(Je,this)},Me.subtract=function(Re,Ze){return this.add(-1*Re,Ze)},Me.format=function(Re){var Ze=this,$e=this.$locale();if(!this.isValid())return $e.invalidDate||M;var ct=Re||"YYYY-MM-DDTHH:mm:ssZ",Qe=oe.z(this),It=this.$H,Ce=this.$m,Je=this.$M,lt=$e.weekdays,mt=$e.months,Bt=$e.meridiem,rt=function(Gt,mi,ze,Ve){return Gt&&(Gt[mi]||Gt(Ze,ct))||ze[mi].slice(0,Ve)},St=function(Gt){return oe.s(It%12||12,Gt,"0")},vt=Bt||function(Gt,mi,ze){var Ve=Gt<12?"AM":"PM";return ze?Ve.toLowerCase():Ve};return ct.replace(U,function(Gt,mi){return mi||function(ze){switch(ze){case"YY":return String(Ze.$y).slice(-2);case"YYYY":return oe.s(Ze.$y,4,"0");case"M":return Je+1;case"MM":return oe.s(Je+1,2,"0");case"MMM":return rt($e.monthsShort,Je,mt,3);case"MMMM":return rt(mt,Je);case"D":return Ze.$D;case"DD":return oe.s(Ze.$D,2,"0");case"d":return String(Ze.$W);case"dd":return rt($e.weekdaysMin,Ze.$W,lt,2);case"ddd":return rt($e.weekdaysShort,Ze.$W,lt,3);case"dddd":return lt[Ze.$W];case"H":return String(It);case"HH":return oe.s(It,2,"0");case"h":return St(1);case"hh":return St(2);case"a":return vt(It,Ce,!0);case"A":return vt(It,Ce,!1);case"m":return String(Ce);case"mm":return oe.s(Ce,2,"0");case"s":return String(Ze.$s);case"ss":return oe.s(Ze.$s,2,"0");case"SSS":return oe.s(Ze.$ms,3,"0");case"Z":return Qe}return null}(Gt)||Qe.replace(":","")})},Me.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Me.diff=function(Re,Ze,$e){var ct,Qe=this,It=oe.p(Ze),Ce=we(Re),Je=(Ce.utcOffset()-this.utcOffset())*s,lt=this-Ce,mt=function(){return oe.m(Qe,Ce)};switch(It){case E:ct=mt()/12;break;case B:ct=mt();break;case I:ct=mt()/3;break;case _:ct=(lt-Je)/6048e5;break;case b:ct=(lt-Je)/864e5;break;case y:ct=lt/c;break;case r:ct=lt/s;break;case A:ct=lt/t;break;default:ct=lt}return $e?ct:oe.a(ct)},Me.daysInMonth=function(){return this.endOf(B).$D},Me.$locale=function(){return pe[this.$L]},Me.locale=function(Re,Ze){if(!Re)return this.$L;var $e=this.clone(),ct=be(Re,Ze,!0);return ct&&($e.$L=ct),$e},Me.clone=function(){return oe.w(this.$d,this)},Me.toDate=function(){return new Date(this.valueOf())},Me.toJSON=function(){return this.isValid()?this.toISOString():null},Me.toISOString=function(){return this.$d.toISOString()},Me.toString=function(){return this.$d.toUTCString()},Se}(),Le=me.prototype;return we.prototype=Le,[["$ms",h],["$s",A],["$m",r],["$H",y],["$W",b],["$M",B],["$y",E],["$D",R]].forEach(function(Se){Le[Se[1]]=function(Me){return this.$g(Me,Se[0],Se[1])}}),we.extend=function(Se,Me){return Se.$i||(Se(Me,me,we),Se.$i=!0),we},we.locale=be,we.isDayjs=le,we.unix=function(Se){return we(1e3*Se)},we.en=pe[re],we.Ls=pe,we.p={},we})}(w0)),w0.exports}var GR=VR();const ba=Z1(GR);/*!
 * ApexCharts v4.7.0
 * (c) 2018-2025 ApexCharts
 * Released under the MIT License.
 */function Xb(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,s=Array(e);t<e;t++)s[t]=a[t];return s}function RI(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function en(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function rE(a,e){for(var t=0;t<e.length;t++){var s=e[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,UI(s.key),s)}}function tn(a,e,t){return e&&rE(a.prototype,e),t&&rE(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function yy(a,e){var t=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!t){if(Array.isArray(a)||(t=J1(a))||e){t&&(a=t);var s=0,c=function(){};return{s:c,n:function(){return s>=a.length?{done:!0}:{done:!1,value:a[s++]}},e:function(y){throw y},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h,A=!0,r=!1;return{s:function(){t=t.call(a)},n:function(){var y=t.next();return A=y.done,y},e:function(y){r=!0,h=y},f:function(){try{A||t.return==null||t.return()}finally{if(r)throw h}}}}function ov(a){var e=DI();return function(){var t,s=W0(a);if(e){var c=W0(this).constructor;t=Reflect.construct(s,arguments,c)}else t=s.apply(this,arguments);return function(h,A){if(A&&(typeof A=="object"||typeof A=="function"))return A;if(A!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RI(h)}(this,t)}}function G0(a,e,t){return(e=UI(e))in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function W0(a){return W0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W0(a)}function av(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&Yb(a,e)}function DI(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DI=function(){return!!a})()}function nE(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(a,c).enumerable})),t.push.apply(t,s)}return t}function Ir(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nE(Object(t),!0).forEach(function(s){G0(a,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):nE(Object(t)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(t,s))})}return a}function Yb(a,e){return Yb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t},Yb(a,e)}function OI(a,e){return function(t){if(Array.isArray(t))return t}(a)||function(t,s){var c=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(c!=null){var h,A,r,y,b=[],_=!0,B=!1;try{if(r=(c=c.call(t)).next,s===0){if(Object(c)!==c)return;_=!1}else for(;!(_=(h=r.call(c)).done)&&(b.push(h.value),b.length!==s);_=!0);}catch(I){B=!0,A=I}finally{try{if(!_&&c.return!=null&&(y=c.return(),Object(y)!==y))return}finally{if(B)throw A}}return b}}(a,e)||J1(a,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Jl(a){return function(e){if(Array.isArray(e))return Xb(e)}(a)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(a)||J1(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function UI(a){var e=function(t,s){if(typeof t!="object"||!t)return t;var c=t[Symbol.toPrimitive];if(c!==void 0){var h=c.call(t,s);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}(a,"string");return typeof e=="symbol"?e:e+""}function Am(a){return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Am(a)}function J1(a,e){if(a){if(typeof a=="string")return Xb(a,e);var t={}.toString.call(a).slice(8,-1);return t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set"?Array.from(a):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Xb(a,e):void 0}}var ni=function(){function a(){en(this,a)}return tn(a,[{key:"shadeRGBColor",value:function(e,t){var s=t.split(","),c=e<0?0:255,h=e<0?-1*e:e,A=parseInt(s[0].slice(4),10),r=parseInt(s[1],10),y=parseInt(s[2],10);return"rgb("+(Math.round((c-A)*h)+A)+","+(Math.round((c-r)*h)+r)+","+(Math.round((c-y)*h)+y)+")"}},{key:"shadeHexColor",value:function(e,t){var s=parseInt(t.slice(1),16),c=e<0?0:255,h=e<0?-1*e:e,A=s>>16,r=s>>8&255,y=255&s;return"#"+(16777216+65536*(Math.round((c-A)*h)+A)+256*(Math.round((c-r)*h)+r)+(Math.round((c-y)*h)+y)).toString(16).slice(1)}},{key:"shadeColor",value:function(e,t){return a.isColorHex(t)?this.shadeHexColor(e,t):this.shadeRGBColor(e,t)}}],[{key:"bind",value:function(e,t){return function(){return e.apply(t,arguments)}}},{key:"isObject",value:function(e){return e&&Am(e)==="object"&&!Array.isArray(e)&&e!=null}},{key:"is",value:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"listToArray",value:function(e){var t,s=[];for(t=0;t<e.length;t++)s[t]=e[t];return s}},{key:"extend",value:function(e,t){var s=this;typeof Object.assign!="function"&&(Object.assign=function(h){if(h==null)throw new TypeError("Cannot convert undefined or null to object");for(var A=Object(h),r=1;r<arguments.length;r++){var y=arguments[r];if(y!=null)for(var b in y)y.hasOwnProperty(b)&&(A[b]=y[b])}return A});var c=Object.assign({},e);return this.isObject(e)&&this.isObject(t)&&Object.keys(t).forEach(function(h){s.isObject(t[h])&&h in e?c[h]=s.extend(e[h],t[h]):Object.assign(c,G0({},h,t[h]))}),c}},{key:"extendArray",value:function(e,t){var s=[];return e.map(function(c){s.push(a.extend(t,c))}),e=s}},{key:"monthMod",value:function(e){return e%12}},{key:"clone",value:function(e){var t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new WeakMap;if(e===null||Am(e)!=="object")return e;if(s.has(e))return s.get(e);if(Array.isArray(e)){t=[],s.set(e,t);for(var c=0;c<e.length;c++)t[c]=this.clone(e[c],s)}else if(e instanceof Date)t=new Date(e.getTime());else for(var h in t={},s.set(e,t),e)e.hasOwnProperty(h)&&(t[h]=this.clone(e[h],s));return t}},{key:"log10",value:function(e){return Math.log(e)/Math.LN10}},{key:"roundToBase10",value:function(e){return Math.pow(10,Math.floor(Math.log10(e)))}},{key:"roundToBase",value:function(e,t){return Math.pow(t,Math.floor(Math.log(e)/Math.log(t)))}},{key:"parseNumber",value:function(e){return e===null?e:parseFloat(e)}},{key:"stripNumber",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return Number.isInteger(e)?e:parseFloat(e.toPrecision(t))}},{key:"randomId",value:function(){return(Math.random()+1).toString(36).substring(4)}},{key:"noExponents",value:function(e){return e.toString().includes("e")?Math.round(e):e}},{key:"elementExists",value:function(e){return!(!e||!e.isConnected)}},{key:"getDimensions",value:function(e){var t=getComputedStyle(e,null),s=e.clientHeight,c=e.clientWidth;return s-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),[c-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),s]}},{key:"getBoundingClientRect",value:function(e){var t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:e.clientWidth,height:e.clientHeight,x:t.left,y:t.top}}},{key:"getLargestStringFromArr",value:function(e){return e.reduce(function(t,s){return Array.isArray(s)&&(s=s.reduce(function(c,h){return c.length>h.length?c:h})),t.length>s.length?t:s},0)}},{key:"hexToRgba",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"#999999",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.6;e.substring(0,1)!=="#"&&(e="#999999");var s=e.replace("#","");s=s.match(new RegExp("(.{"+s.length/3+"})","g"));for(var c=0;c<s.length;c++)s[c]=parseInt(s[c].length===1?s[c]+s[c]:s[c],16);return t!==void 0&&s.push(t),"rgba("+s.join(",")+")"}},{key:"getOpacityFromRGBA",value:function(e){return parseFloat(e.replace(/^.*,(.+)\)/,"$1"))}},{key:"rgb2hex",value:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&e.length===4?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}},{key:"isColorHex",value:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i.test(e)}},{key:"getPolygonPos",value:function(e,t){for(var s=[],c=2*Math.PI/t,h=0;h<t;h++){var A={};A.x=e*Math.sin(h*c),A.y=-e*Math.cos(h*c),s.push(A)}return s}},{key:"polarToCartesian",value:function(e,t,s,c){var h=(c-90)*Math.PI/180;return{x:e+s*Math.cos(h),y:t+s*Math.sin(h)}}},{key:"escapeString",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"x",s=e.toString().slice();return s=s.replace(/[` ~!@#$%^&*()|+\=?;:'",.<>{}[\]\\/]/gi,t)}},{key:"negToZero",value:function(e){return e<0?0:e}},{key:"moveIndexInArray",value:function(e,t,s){if(s>=e.length)for(var c=s-e.length+1;c--;)e.push(void 0);return e.splice(s,0,e.splice(t,1)[0]),e}},{key:"extractNumber",value:function(e){return parseFloat(e.replace(/[^\d.]*/g,""))}},{key:"findAncestor",value:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e}},{key:"setELstyles",value:function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e.style.key=t[s])}},{key:"preciseAddition",value:function(e,t){var s=(String(e).split(".")[1]||"").length,c=(String(t).split(".")[1]||"").length,h=Math.pow(10,Math.max(s,c));return(Math.round(e*h)+Math.round(t*h))/h}},{key:"isNumber",value:function(e){return!isNaN(e)&&parseFloat(Number(e))===e&&!isNaN(parseInt(e,10))}},{key:"isFloat",value:function(e){return Number(e)===e&&e%1!=0}},{key:"isMsEdge",value:function(){var e=window.navigator.userAgent,t=e.indexOf("Edge/");return t>0&&parseInt(e.substring(t+5,e.indexOf(".",t)),10)}},{key:"getGCD",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:7,c=Math.pow(10,s-Math.floor(Math.log10(Math.max(e,t))));for(e=Math.round(Math.abs(e)*c),t=Math.round(Math.abs(t)*c);t;){var h=t;t=e%t,e=h}return e/c}},{key:"getPrimeFactors",value:function(e){for(var t=[],s=2;e>=2;)e%s==0?(t.push(s),e/=s):s++;return t}},{key:"mod",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:7,c=Math.pow(10,s-Math.floor(Math.log10(Math.max(e,t))));return(e=Math.round(Math.abs(e)*c))%(t=Math.round(Math.abs(t)*c))/c}}]),a}(),vm=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"animateLine",value:function(e,t,s,c){e.attr(t).animate(c).attr(s)}},{key:"animateMarker",value:function(e,t,s,c){e.attr({opacity:0}).animate(t).attr({opacity:1}).after(function(){c()})}},{key:"animateRect",value:function(e,t,s,c,h){e.attr(t).animate(c).attr(s).after(function(){return h()})}},{key:"animatePathsGradually",value:function(e){var t=e.el,s=e.realIndex,c=e.j,h=e.fill,A=e.pathFrom,r=e.pathTo,y=e.speed,b=e.delay,_=this.w,B=0;_.config.chart.animations.animateGradually.enabled&&(B=_.config.chart.animations.animateGradually.delay),_.config.chart.animations.dynamicAnimation.enabled&&_.globals.dataChanged&&_.config.chart.type!=="bar"&&(B=0),this.morphSVG(t,s,c,_.config.chart.type!=="line"||_.globals.comboCharts?h:"stroke",A,r,y,b*B)}},{key:"showDelayedElements",value:function(){this.w.globals.delayedElements.forEach(function(e){var t=e.el;t.classList.remove("apexcharts-element-hidden"),t.classList.add("apexcharts-hidden-element-shown")})}},{key:"animationCompleted",value:function(e){var t=this.w;t.globals.animationEnded||(t.globals.animationEnded=!0,this.showDelayedElements(),typeof t.config.chart.events.animationEnd=="function"&&t.config.chart.events.animationEnd(this.ctx,{el:e,w:t}))}},{key:"morphSVG",value:function(e,t,s,c,h,A,r,y){var b=this,_=this.w;h||(h=e.attr("pathFrom")),A||(A=e.attr("pathTo"));var B=function(I){return _.config.chart.type==="radar"&&(r=1),"M 0 ".concat(_.globals.gridHeight)};(!h||h.indexOf("undefined")>-1||h.indexOf("NaN")>-1)&&(h=B()),(!A.trim()||A.indexOf("undefined")>-1||A.indexOf("NaN")>-1)&&(A=B()),_.globals.shouldAnimate||(r=1),e.plot(h).animate(1,y).plot(h).animate(r,y).plot(A).after(function(){ni.isNumber(s)?s===_.globals.series[_.globals.maxValsInArrayIndex].length-2&&_.globals.shouldAnimate&&b.animationCompleted(e):c!=="none"&&_.globals.shouldAnimate&&(!_.globals.comboCharts&&t===_.globals.series.length-1||_.globals.comboCharts)&&b.animationCompleted(e),b.showDelayedElements()})}}]),a}();const Kb={},zI=[];function zs(a,e){if(Array.isArray(a))for(const t of a)zs(t,e);else if(typeof a!="object")NI(Object.getOwnPropertyNames(e)),Kb[a]=Object.assign(Kb[a]||{},e);else for(const t in a)zs(t,a[t])}function sh(a){return Kb[a]||{}}function NI(a){zI.push(...a)}function ew(a,e){let t;const s=a.length,c=[];for(t=0;t<s;t++)c.push(e(a[t]));return c}function tb(a){return a%360*Math.PI/180}function _m(a){return a.charAt(0).toUpperCase()+a.slice(1)}function xm(a,e,t,s){return e!=null&&t!=null||(s=s||a.bbox(),e==null?e=s.width/s.height*t:t==null&&(t=s.height/s.width*e)),{width:e,height:t}}function qb(a,e){const t=a.origin;let s=a.ox!=null?a.ox:a.originX!=null?a.originX:"center",c=a.oy!=null?a.oy:a.originY!=null?a.originY:"center";t!=null&&([s,c]=Array.isArray(t)?t:typeof t=="object"?[t.x,t.y]:[t,t]);const h=typeof s=="string",A=typeof c=="string";if(h||A){const{height:r,width:y,x:b,y:_}=e.bbox();h&&(s=s.includes("left")?b:s.includes("right")?b+y:b+y/2),A&&(c=c.includes("top")?_:c.includes("bottom")?_+r:_+r/2)}return[s,c]}const WR=new Set(["desc","metadata","title"]),$b=a=>WR.has(a.nodeName),jI=(a,e,t={})=>{const s={...e};for(const c in s)s[c].valueOf()===t[c]&&delete s[c];Object.keys(s).length?a.node.setAttribute("data-svgjs",JSON.stringify(s)):(a.node.removeAttribute("data-svgjs"),a.node.removeAttribute("svgjs:data"))},tw="http://www.w3.org/2000/svg",ib="http://www.w3.org/2000/xmlns/",bm="http://www.w3.org/1999/xlink",Ao={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};function lv(){return Ao.window}let iw=class{};const gg={},rw="___SYMBOL___ROOT___";function Wy(a,e=tw){return Ao.document.createElementNS(e,a)}function Ru(a,e=!1){if(a instanceof iw)return a;if(typeof a=="object")return rb(a);if(a==null)return new gg[rw];if(typeof a=="string"&&a.charAt(0)!=="<")return rb(Ao.document.querySelector(a));const t=e?Ao.document.createElement("div"):Wy("svg");return t.innerHTML=a,a=rb(t.firstChild),t.removeChild(t.firstChild),a}function ta(a,e){return e&&(e instanceof Ao.window.Node||e.ownerDocument&&e instanceof e.ownerDocument.defaultView.Node)?e:Wy(a)}function rd(a){if(!a)return null;if(a.instance instanceof iw)return a.instance;if(a.nodeName==="#document-fragment")return new gg.Fragment(a);let e=_m(a.nodeName||"Dom");return e==="LinearGradient"||e==="RadialGradient"?e="Gradient":gg[e]||(e="Dom"),new gg[e](a)}let rb=rd;function fo(a,e=a.name,t=!1){return gg[e]=a,t&&(gg[rw]=a),NI(Object.getOwnPropertyNames(a.prototype)),a}let XR=1e3;function HI(a){return"Svgjs"+_m(a)+XR++}function QI(a){for(let e=a.children.length-1;e>=0;e--)QI(a.children[e]);return a.id&&(a.id=HI(a.nodeName)),a}function Gn(a,e){let t,s;for(s=(a=Array.isArray(a)?a:[a]).length-1;s>=0;s--)for(t in e)a[s].prototype[t]=e[t]}function ea(a){return function(...e){const t=e[e.length-1];return!t||t.constructor!==Object||t instanceof Array?a.apply(this,e):a.apply(this,e.slice(0,-1)).attr(t)}}zs("Dom",{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},prev:function(){return this.siblings()[this.position()-1]},forward:function(){const a=this.position();return this.parent().add(this.remove(),a+1),this},backward:function(){const a=this.position();return this.parent().add(this.remove(),a?a-1:0),this},front:function(){return this.parent().add(this.remove()),this},back:function(){return this.parent().add(this.remove(),0),this},before:function(a){(a=Ru(a)).remove();const e=this.position();return this.parent().add(a,e),this},after:function(a){(a=Ru(a)).remove();const e=this.position();return this.parent().add(a,e+1),this},insertBefore:function(a){return(a=Ru(a)).before(this),this},insertAfter:function(a){return(a=Ru(a)).after(this),this}});const VI=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,YR=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,KR=/rgb\((\d+),(\d+),(\d+)\)/,qR=/(#[a-z_][a-z0-9\-_]*)/i,$R=/\)\s*,?\s*/,ZR=/\s/g,sE=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,oE=/^rgb\(/,aE=/^(\s+)?$/,lE=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,JR=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,Mf=/[\s,]+/,nw=/[MLHVCSQTAZ]/i;function eD(a){const e=Math.round(a),t=Math.max(0,Math.min(255,e)).toString(16);return t.length===1?"0"+t:t}function qg(a,e){for(let t=e.length;t--;)if(a[e[t]]==null)return!1;return!0}function nb(a,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?a+6*(e-a)*t:t<.5?e:t<2/3?a+(e-a)*(2/3-t)*6:a}zs("Dom",{classes:function(){const a=this.attr("class");return a==null?[]:a.trim().split(Mf)},hasClass:function(a){return this.classes().indexOf(a)!==-1},addClass:function(a){if(!this.hasClass(a)){const e=this.classes();e.push(a),this.attr("class",e.join(" "))}return this},removeClass:function(a){return this.hasClass(a)&&this.attr("class",this.classes().filter(function(e){return e!==a}).join(" ")),this},toggleClass:function(a){return this.hasClass(a)?this.removeClass(a):this.addClass(a)}}),zs("Dom",{css:function(a,e){const t={};if(arguments.length===0)return this.node.style.cssText.split(/\s*;\s*/).filter(function(s){return!!s.length}).forEach(function(s){const c=s.split(/\s*:\s*/);t[c[0]]=c[1]}),t;if(arguments.length<2){if(Array.isArray(a)){for(const s of a){const c=s;t[s]=this.node.style.getPropertyValue(c)}return t}if(typeof a=="string")return this.node.style.getPropertyValue(a);if(typeof a=="object")for(const s in a)this.node.style.setProperty(s,a[s]==null||aE.test(a[s])?"":a[s])}return arguments.length===2&&this.node.style.setProperty(a,e==null||aE.test(e)?"":e),this},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},visible:function(){return this.css("display")!=="none"}}),zs("Dom",{data:function(a,e,t){if(a==null)return this.data(ew(function(s,c){let h;const A=s.length,r=[];for(h=0;h<A;h++)c(s[h])&&r.push(s[h]);return r}(this.node.attributes,s=>s.nodeName.indexOf("data-")===0),s=>s.nodeName.slice(5)));if(a instanceof Array){const s={};for(const c of a)s[c]=this.data(c);return s}if(typeof a=="object")for(e in a)this.data(e,a[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch{return this.attr("data-"+a)}else this.attr("data-"+a,e===null?null:t===!0||typeof e=="string"||typeof e=="number"?e:JSON.stringify(e));return this}}),zs("Dom",{remember:function(a,e){if(typeof arguments[0]=="object")for(const t in a)this.remember(t,a[t]);else{if(arguments.length===1)return this.memory()[a];this.memory()[a]=e}return this},forget:function(){if(arguments.length===0)this._memory={};else for(let a=arguments.length-1;a>=0;a--)delete this.memory()[arguments[a]];return this},memory:function(){return this._memory=this._memory||{}}});let KA=class Kl{constructor(...e){this.init(...e)}static isColor(e){return e&&(e instanceof Kl||this.isRgb(e)||this.test(e))}static isRgb(e){return e&&typeof e.r=="number"&&typeof e.g=="number"&&typeof e.b=="number"}static random(e="vibrant",t){const{random:s,round:c,sin:h,PI:A}=Math;if(e==="vibrant"){const r=24*s()+57,y=38*s()+45,b=360*s();return new Kl(r,y,b,"lch")}if(e==="sine"){const r=c(80*h(2*A*(t=t??s())/.5+.01)+150),y=c(50*h(2*A*t/.5+4.6)+200),b=c(100*h(2*A*t/.5+2.3)+150);return new Kl(r,y,b)}if(e==="pastel"){const r=8*s()+86,y=17*s()+9,b=360*s();return new Kl(r,y,b,"lch")}if(e==="dark"){const r=10+10*s(),y=50*s()+86,b=360*s();return new Kl(r,y,b,"lch")}if(e==="rgb"){const r=255*s(),y=255*s(),b=255*s();return new Kl(r,y,b)}if(e==="lab"){const r=100*s(),y=256*s()-128,b=256*s()-128;return new Kl(r,y,b,"lab")}if(e==="grey"){const r=255*s();return new Kl(r,r,r)}throw new Error("Unsupported random color mode")}static test(e){return typeof e=="string"&&(sE.test(e)||oE.test(e))}cmyk(){const{_a:e,_b:t,_c:s}=this.rgb(),[c,h,A]=[e,t,s].map(y=>y/255),r=Math.min(1-c,1-h,1-A);return r===1?new Kl(0,0,0,1,"cmyk"):new Kl((1-c-r)/(1-r),(1-h-r)/(1-r),(1-A-r)/(1-r),r,"cmyk")}hsl(){const{_a:e,_b:t,_c:s}=this.rgb(),[c,h,A]=[e,t,s].map(I=>I/255),r=Math.max(c,h,A),y=Math.min(c,h,A),b=(r+y)/2,_=r===y,B=r-y;return new Kl(360*(_?0:r===c?((h-A)/B+(h<A?6:0))/6:r===h?((A-c)/B+2)/6:r===A?((c-h)/B+4)/6:0),100*(_?0:b>.5?B/(2-r-y):B/(r+y)),100*b,"hsl")}init(e=0,t=0,s=0,c=0,h="rgb"){if(e=e||0,this.space)for(const B in this.space)delete this[this.space[B]];if(typeof e=="number")h=typeof c=="string"?c:h,c=typeof c=="string"?0:c,Object.assign(this,{_a:e,_b:t,_c:s,_d:c,space:h});else if(e instanceof Array)this.space=t||(typeof e[3]=="string"?e[3]:e[4])||"rgb",Object.assign(this,{_a:e[0],_b:e[1],_c:e[2],_d:e[3]||0});else if(e instanceof Object){const B=function(I,E){const R=qg(I,"rgb")?{_a:I.r,_b:I.g,_c:I.b,_d:0,space:"rgb"}:qg(I,"xyz")?{_a:I.x,_b:I.y,_c:I.z,_d:0,space:"xyz"}:qg(I,"hsl")?{_a:I.h,_b:I.s,_c:I.l,_d:0,space:"hsl"}:qg(I,"lab")?{_a:I.l,_b:I.a,_c:I.b,_d:0,space:"lab"}:qg(I,"lch")?{_a:I.l,_b:I.c,_c:I.h,_d:0,space:"lch"}:qg(I,"cmyk")?{_a:I.c,_b:I.m,_c:I.y,_d:I.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return R.space=E||R.space,R}(e,t);Object.assign(this,B)}else if(typeof e=="string")if(oE.test(e)){const B=e.replace(ZR,""),[I,E,R]=KR.exec(B).slice(1,4).map(M=>parseInt(M));Object.assign(this,{_a:I,_b:E,_c:R,_d:0,space:"rgb"})}else{if(!sE.test(e))throw Error("Unsupported string format, can't construct Color");{const B=M=>parseInt(M,16),[,I,E,R]=YR.exec(function(M){return M.length===4?["#",M.substring(1,2),M.substring(1,2),M.substring(2,3),M.substring(2,3),M.substring(3,4),M.substring(3,4)].join(""):M}(e)).map(B);Object.assign(this,{_a:I,_b:E,_c:R,_d:0,space:"rgb"})}}const{_a:A,_b:r,_c:y,_d:b}=this,_=this.space==="rgb"?{r:A,g:r,b:y}:this.space==="xyz"?{x:A,y:r,z:y}:this.space==="hsl"?{h:A,s:r,l:y}:this.space==="lab"?{l:A,a:r,b:y}:this.space==="lch"?{l:A,c:r,h:y}:this.space==="cmyk"?{c:A,m:r,y,k:b}:{};Object.assign(this,_)}lab(){const{x:e,y:t,z:s}=this.xyz();return new Kl(116*t-16,500*(e-t),200*(t-s),"lab")}lch(){const{l:e,a:t,b:s}=this.lab(),c=Math.sqrt(t**2+s**2);let h=180*Math.atan2(s,t)/Math.PI;return h<0&&(h*=-1,h=360-h),new Kl(e,c,h,"lch")}rgb(){if(this.space==="rgb")return this;if((e=this.space)==="lab"||e==="xyz"||e==="lch"){let{x:t,y:s,z:c}=this;if(this.space==="lab"||this.space==="lch"){let{l:E,a:R,b:M}=this;if(this.space==="lch"){const{c:pe,h:Ae}=this,le=Math.PI/180;R=pe*Math.cos(le*Ae),M=pe*Math.sin(le*Ae)}const G=(E+16)/116,U=R/500+G,Q=G-M/200,q=16/116,ne=.008856,re=7.787;t=.95047*(U**3>ne?U**3:(U-q)/re),s=1*(G**3>ne?G**3:(G-q)/re),c=1.08883*(Q**3>ne?Q**3:(Q-q)/re)}const h=3.2406*t+-1.5372*s+-.4986*c,A=-.9689*t+1.8758*s+.0415*c,r=.0557*t+-.204*s+1.057*c,y=Math.pow,b=.0031308,_=h>b?1.055*y(h,1/2.4)-.055:12.92*h,B=A>b?1.055*y(A,1/2.4)-.055:12.92*A,I=r>b?1.055*y(r,1/2.4)-.055:12.92*r;return new Kl(255*_,255*B,255*I)}if(this.space==="hsl"){let{h:t,s,l:c}=this;if(t/=360,s/=100,c/=100,s===0)return c*=255,new Kl(c,c,c);const h=c<.5?c*(1+s):c+s-c*s,A=2*c-h,r=255*nb(A,h,t+1/3),y=255*nb(A,h,t),b=255*nb(A,h,t-1/3);return new Kl(r,y,b)}if(this.space==="cmyk"){const{c:t,m:s,y:c,k:h}=this,A=255*(1-Math.min(1,t*(1-h)+h)),r=255*(1-Math.min(1,s*(1-h)+h)),y=255*(1-Math.min(1,c*(1-h)+h));return new Kl(A,r,y)}return this;var e}toArray(){const{_a:e,_b:t,_c:s,_d:c,space:h}=this;return[e,t,s,c,h]}toHex(){const[e,t,s]=this._clamped().map(eD);return`#${e}${t}${s}`}toRgb(){const[e,t,s]=this._clamped();return`rgb(${e},${t},${s})`}toString(){return this.toHex()}xyz(){const{_a:e,_b:t,_c:s}=this.rgb(),[c,h,A]=[e,t,s].map(G=>G/255),r=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92,y=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,b=A>.04045?Math.pow((A+.055)/1.055,2.4):A/12.92,_=(.4124*r+.3576*y+.1805*b)/.95047,B=(.2126*r+.7152*y+.0722*b)/1,I=(.0193*r+.1192*y+.9505*b)/1.08883,E=_>.008856?Math.pow(_,1/3):7.787*_+16/116,R=B>.008856?Math.pow(B,1/3):7.787*B+16/116,M=I>.008856?Math.pow(I,1/3):7.787*I+16/116;return new Kl(E,R,M,"xyz")}_clamped(){const{_a:e,_b:t,_c:s}=this.rgb(),{max:c,min:h,round:A}=Math;return[e,t,s].map(r=>c(0,h(A(r),255)))}},Go=class GI{constructor(...e){this.init(...e)}clone(){return new GI(this)}init(e,t){const h=Array.isArray(e)?{x:e[0],y:e[1]}:typeof e=="object"?{x:e.x,y:e.y}:{x:e,y:t};return this.x=h.x==null?0:h.x,this.y=h.y==null?0:h.y,this}toArray(){return[this.x,this.y]}transform(e){return this.clone().transformO(e)}transformO(e){qs.isMatrixLike(e)||(e=new qs(e));const{x:t,y:s}=this;return this.x=e.a*t+e.c*s+e.e,this.y=e.b*t+e.d*s+e.f,this}};function $g(a,e,t){return Math.abs(e-a)<1e-6}let qs=class ql{constructor(...e){this.init(...e)}static formatTransforms(e){const t=e.flip==="both"||e.flip===!0,s=e.flip&&(t||e.flip==="x")?-1:1,c=e.flip&&(t||e.flip==="y")?-1:1,h=e.skew&&e.skew.length?e.skew[0]:isFinite(e.skew)?e.skew:isFinite(e.skewX)?e.skewX:0,A=e.skew&&e.skew.length?e.skew[1]:isFinite(e.skew)?e.skew:isFinite(e.skewY)?e.skewY:0,r=e.scale&&e.scale.length?e.scale[0]*s:isFinite(e.scale)?e.scale*s:isFinite(e.scaleX)?e.scaleX*s:s,y=e.scale&&e.scale.length?e.scale[1]*c:isFinite(e.scale)?e.scale*c:isFinite(e.scaleY)?e.scaleY*c:c,b=e.shear||0,_=e.rotate||e.theta||0,B=new Go(e.origin||e.around||e.ox||e.originX,e.oy||e.originY),I=B.x,E=B.y,R=new Go(e.position||e.px||e.positionX||NaN,e.py||e.positionY||NaN),M=R.x,G=R.y,U=new Go(e.translate||e.tx||e.translateX,e.ty||e.translateY),Q=U.x,q=U.y,ne=new Go(e.relative||e.rx||e.relativeX,e.ry||e.relativeY);return{scaleX:r,scaleY:y,skewX:h,skewY:A,shear:b,theta:_,rx:ne.x,ry:ne.y,tx:Q,ty:q,ox:I,oy:E,px:M,py:G}}static fromArray(e){return{a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]}}static isMatrixLike(e){return e.a!=null||e.b!=null||e.c!=null||e.d!=null||e.e!=null||e.f!=null}static matrixMultiply(e,t,s){const c=e.a*t.a+e.c*t.b,h=e.b*t.a+e.d*t.b,A=e.a*t.c+e.c*t.d,r=e.b*t.c+e.d*t.d,y=e.e+e.a*t.e+e.c*t.f,b=e.f+e.b*t.e+e.d*t.f;return s.a=c,s.b=h,s.c=A,s.d=r,s.e=y,s.f=b,s}around(e,t,s){return this.clone().aroundO(e,t,s)}aroundO(e,t,s){const c=e||0,h=t||0;return this.translateO(-c,-h).lmultiplyO(s).translateO(c,h)}clone(){return new ql(this)}decompose(e=0,t=0){const s=this.a,c=this.b,h=this.c,A=this.d,r=this.e,y=this.f,b=s*A-c*h,_=b>0?1:-1,B=_*Math.sqrt(s*s+c*c),I=Math.atan2(_*c,_*s),E=180/Math.PI*I,R=Math.cos(I),M=Math.sin(I),G=(s*h+c*A)/b,U=h*B/(G*s-c)||A*B/(G*c+s);return{scaleX:B,scaleY:U,shear:G,rotate:E,translateX:r-e+e*R*B+t*(G*R*B-M*U),translateY:y-t+e*M*B+t*(G*M*B+R*U),originX:e,originY:t,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(e){if(e===this)return!0;const t=new ql(e);return $g(this.a,t.a)&&$g(this.b,t.b)&&$g(this.c,t.c)&&$g(this.d,t.d)&&$g(this.e,t.e)&&$g(this.f,t.f)}flip(e,t){return this.clone().flipO(e,t)}flipO(e,t){return e==="x"?this.scaleO(-1,1,t,0):e==="y"?this.scaleO(1,-1,0,t):this.scaleO(-1,-1,e,t||e)}init(e){const t=ql.fromArray([1,0,0,1,0,0]);return e=e instanceof zc?e.matrixify():typeof e=="string"?ql.fromArray(e.split(Mf).map(parseFloat)):Array.isArray(e)?ql.fromArray(e):typeof e=="object"&&ql.isMatrixLike(e)?e:typeof e=="object"?new ql().transform(e):arguments.length===6?ql.fromArray([].slice.call(arguments)):t,this.a=e.a!=null?e.a:t.a,this.b=e.b!=null?e.b:t.b,this.c=e.c!=null?e.c:t.c,this.d=e.d!=null?e.d:t.d,this.e=e.e!=null?e.e:t.e,this.f=e.f!=null?e.f:t.f,this}inverse(){return this.clone().inverseO()}inverseO(){const e=this.a,t=this.b,s=this.c,c=this.d,h=this.e,A=this.f,r=e*c-t*s;if(!r)throw new Error("Cannot invert "+this);const y=c/r,b=-t/r,_=-s/r,B=e/r,I=-(y*h+_*A),E=-(b*h+B*A);return this.a=y,this.b=b,this.c=_,this.d=B,this.e=I,this.f=E,this}lmultiply(e){return this.clone().lmultiplyO(e)}lmultiplyO(e){const t=e instanceof ql?e:new ql(e);return ql.matrixMultiply(t,this,this)}multiply(e){return this.clone().multiplyO(e)}multiplyO(e){const t=e instanceof ql?e:new ql(e);return ql.matrixMultiply(this,t,this)}rotate(e,t,s){return this.clone().rotateO(e,t,s)}rotateO(e,t=0,s=0){e=tb(e);const c=Math.cos(e),h=Math.sin(e),{a:A,b:r,c:y,d:b,e:_,f:B}=this;return this.a=A*c-r*h,this.b=r*c+A*h,this.c=y*c-b*h,this.d=b*c+y*h,this.e=_*c-B*h+s*h-t*c+t,this.f=B*c+_*h-t*h-s*c+s,this}scale(){return this.clone().scaleO(...arguments)}scaleO(e,t=e,s=0,c=0){arguments.length===3&&(c=s,s=t,t=e);const{a:h,b:A,c:r,d:y,e:b,f:_}=this;return this.a=h*e,this.b=A*t,this.c=r*e,this.d=y*t,this.e=b*e-s*e+s,this.f=_*t-c*t+c,this}shear(e,t,s){return this.clone().shearO(e,t,s)}shearO(e,t=0,s=0){const{a:c,b:h,c:A,d:r,e:y,f:b}=this;return this.a=c+h*e,this.c=A+r*e,this.e=y+b*e-s*e,this}skew(){return this.clone().skewO(...arguments)}skewO(e,t=e,s=0,c=0){arguments.length===3&&(c=s,s=t,t=e),e=tb(e),t=tb(t);const h=Math.tan(e),A=Math.tan(t),{a:r,b:y,c:b,d:_,e:B,f:I}=this;return this.a=r+y*h,this.b=y+r*A,this.c=b+_*h,this.d=_+b*A,this.e=B+I*h-c*h,this.f=I+B*A-s*A,this}skewX(e,t,s){return this.skew(e,0,t,s)}skewY(e,t,s){return this.skew(0,e,t,s)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(e){if(ql.isMatrixLike(e))return new ql(e).multiplyO(this);const t=ql.formatTransforms(e),{x:s,y:c}=new Go(t.ox,t.oy).transform(this),h=new ql().translateO(t.rx,t.ry).lmultiplyO(this).translateO(-s,-c).scaleO(t.scaleX,t.scaleY).skewO(t.skewX,t.skewY).shearO(t.shear).rotateO(t.theta).translateO(s,c);if(isFinite(t.px)||isFinite(t.py)){const A=new Go(s,c).transform(h),r=isFinite(t.px)?t.px-A.x:0,y=isFinite(t.py)?t.py-A.y:0;h.translateO(r,y)}return h.translateO(t.tx,t.ty),h}translate(e,t){return this.clone().translateO(e,t)}translateO(e,t){return this.e+=e||0,this.f+=t||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}};function vp(){if(!vp.nodes){const a=Ru().size(2,0);a.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),a.attr("focusable","false"),a.attr("aria-hidden","true");const e=a.path().node;vp.nodes={svg:a,path:e}}if(!vp.nodes.svg.node.parentNode){const a=Ao.document.body||Ao.document.documentElement;vp.nodes.svg.addTo(a)}return vp.nodes}function WI(a){return!(a.width||a.height||a.x||a.y)}fo(qs,"Matrix");let yc=class B0{constructor(...e){this.init(...e)}addOffset(){return this.x+=Ao.window.pageXOffset,this.y+=Ao.window.pageYOffset,new B0(this)}init(e){return e=typeof e=="string"?e.split(Mf).map(parseFloat):Array.isArray(e)?e:typeof e=="object"?[e.left!=null?e.left:e.x,e.top!=null?e.top:e.y,e.width,e.height]:arguments.length===4?[].slice.call(arguments):[0,0,0,0],this.x=e[0]||0,this.y=e[1]||0,this.width=this.w=e[2]||0,this.height=this.h=e[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return WI(this)}merge(e){const t=Math.min(this.x,e.x),s=Math.min(this.y,e.y),c=Math.max(this.x+this.width,e.x+e.width)-t,h=Math.max(this.y+this.height,e.y+e.height)-s;return new B0(t,s,c,h)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(e){e instanceof qs||(e=new qs(e));let t=1/0,s=-1/0,c=1/0,h=-1/0;return[new Go(this.x,this.y),new Go(this.x2,this.y),new Go(this.x,this.y2),new Go(this.x2,this.y2)].forEach(function(A){A=A.transform(e),t=Math.min(t,A.x),s=Math.max(s,A.x),c=Math.min(c,A.y),h=Math.max(h,A.y)}),new B0(t,c,s-t,h-c)}};function cE(a,e,t){let s;try{if(s=e(a.node),WI(s)&&(c=a.node)!==Ao.document&&!(Ao.document.documentElement.contains||function(h){for(;h.parentNode;)h=h.parentNode;return h===Ao.document}).call(Ao.document.documentElement,c))throw new Error("Element not in the dom")}catch{s=t(a)}var c;return s}zs({viewbox:{viewbox(a,e,t,s){return a==null?new yc(this.attr("viewBox")):this.attr("viewBox",new yc(a,e,t,s))},zoom(a,e){let{width:t,height:s}=this.attr(["width","height"]);if((t||s)&&typeof t!="string"&&typeof s!="string"||(t=this.node.clientWidth,s=this.node.clientHeight),!t||!s)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const c=this.viewbox(),h=t/c.width,A=s/c.height,r=Math.min(h,A);if(a==null)return r;let y=r/a;y===1/0&&(y=Number.MAX_SAFE_INTEGER/100),e=e||new Go(t/2/h+c.x,s/2/A+c.y);const b=new yc(c).transform(new qs({scale:y,origin:e}));return this.viewbox(b)}}}),fo(yc,"Box");let wg=class extends Array{constructor(e=[],...t){if(super(e,...t),typeof e=="number")return this;this.length=0,this.push(...e)}};Gn([wg],{each(a,...e){return typeof a=="function"?this.map((t,s,c)=>a.call(t,t,s,c)):this.map(t=>t[a](...e))},toArray(){return Array.prototype.concat.apply([],this)}});const tD=["toArray","constructor","each"];function Ig(a,e){return new wg(ew((e||Ao.document).querySelectorAll(a),function(t){return rd(t)}))}wg.extend=function(a){a=a.reduce((e,t)=>(tD.includes(t)||t[0]==="_"||(t in Array.prototype&&(e["$"+t]=Array.prototype[t]),e[t]=function(...s){return this.each(t,...s)}),e),{}),Gn([wg],a)};let iD=0;const XI={};function YI(a){let e=a.getEventHolder();return e===Ao.window&&(e=XI),e.events||(e.events={}),e.events}function sw(a){return a.getEventTarget()}function Ef(a,e,t,s,c){const h=t.bind(s||a),A=Ru(a),r=YI(A),y=sw(A);e=Array.isArray(e)?e:e.split(Mf),t._svgjsListenerId||(t._svgjsListenerId=++iD),e.forEach(function(b){const _=b.split(".")[0],B=b.split(".")[1]||"*";r[_]=r[_]||{},r[_][B]=r[_][B]||{},r[_][B][t._svgjsListenerId]=h,y.addEventListener(_,h,c||!1)})}function nd(a,e,t,s){const c=Ru(a),h=YI(c),A=sw(c);(typeof t!="function"||(t=t._svgjsListenerId))&&(e=Array.isArray(e)?e:(e||"").split(Mf)).forEach(function(r){const y=r&&r.split(".")[0],b=r&&r.split(".")[1];let _,B;if(t)h[y]&&h[y][b||"*"]&&(A.removeEventListener(y,h[y][b||"*"][t],s||!1),delete h[y][b||"*"][t]);else if(y&&b){if(h[y]&&h[y][b]){for(B in h[y][b])nd(A,[y,b].join("."),B);delete h[y][b]}}else if(b)for(r in h)for(_ in h[r])b===_&&nd(A,[r,b].join("."));else if(y){if(h[y]){for(_ in h[y])nd(A,[y,_].join("."));delete h[y]}}else{for(r in h)nd(A,r);(function(I){let E=I.getEventHolder();E===Ao.window&&(E=XI),E.events&&(E.events={})})(c)}})}let cv=class extends iw{addEventListener(){}dispatch(e,t,s){return function(c,h,A,r){const y=sw(c);return h instanceof Ao.window.Event||(h=new Ao.window.CustomEvent(h,{detail:A,cancelable:!0,...r})),y.dispatchEvent(h),h}(this,e,t,s)}dispatchEvent(e){const t=this.getEventHolder().events;if(!t)return!0;const s=t[e.type];for(const c in s)for(const h in s[c])s[c][h](e);return!e.defaultPrevented}fire(e,t,s){return this.dispatch(e,t,s),this}getEventHolder(){return this}getEventTarget(){return this}off(e,t,s){return nd(this,e,t,s),this}on(e,t,s,c){return Ef(this,e,t,s,c),this}removeEventListener(){}};function uE(){}fo(cv,"EventTarget");const sb=400,rD=">",nD=0,sD={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};let Bg=class extends Array{constructor(...e){super(...e),this.init(...e)}clone(){return new this.constructor(this)}init(e){return typeof e=="number"||(this.length=0,this.push(...this.parse(e))),this}parse(e=[]){return e instanceof Array?e:e.trim().split(Mf).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const e=[];return e.push(...this),e}},yo=class Vd{constructor(...e){this.init(...e)}convert(e){return new Vd(this.value,e)}divide(e){return e=new Vd(e),new Vd(this/e,this.unit||e.unit)}init(e,t){return t=Array.isArray(e)?e[1]:t,e=Array.isArray(e)?e[0]:e,this.value=0,this.unit=t||"",typeof e=="number"?this.value=isNaN(e)?0:isFinite(e)?e:e<0?-34e37:34e37:typeof e=="string"?(t=e.match(VI))&&(this.value=parseFloat(t[1]),t[5]==="%"?this.value/=100:t[5]==="s"&&(this.value*=1e3),this.unit=t[5]):e instanceof Vd&&(this.value=e.valueOf(),this.unit=e.unit),this}minus(e){return e=new Vd(e),new Vd(this-e,this.unit||e.unit)}plus(e){return e=new Vd(e),new Vd(this+e,this.unit||e.unit)}times(e){return e=new Vd(e),new Vd(this*e,this.unit||e.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return(this.unit==="%"?~~(1e8*this.value)/1e6:this.unit==="s"?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}};const oD=new Set(["fill","stroke","color","bgcolor","stop-color","flood-color","lighting-color"]),KI=[];let fm=class qI extends cv{constructor(e,t){super(),this.node=e,this.type=e.nodeName,t&&e!==t&&this.attr(t)}add(e,t){return(e=Ru(e)).removeNamespace&&this.node instanceof Ao.window.SVGElement&&e.removeNamespace(),t==null?this.node.appendChild(e.node):e.node!==this.node.childNodes[t]&&this.node.insertBefore(e.node,this.node.childNodes[t]),this}addTo(e,t){return Ru(e).put(this,t)}children(){return new wg(ew(this.node.children,function(e){return rd(e)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(e=!0,t=!0){this.writeDataToDom();let s=this.node.cloneNode(e);return t&&(s=QI(s)),new this.constructor(s)}each(e,t){const s=this.children();let c,h;for(c=0,h=s.length;c<h;c++)e.apply(s[c],[c,s]),t&&s[c].each(e,t);return this}element(e,t){return this.put(new qI(Wy(e),t))}first(){return rd(this.node.firstChild)}get(e){return rd(this.node.childNodes[e])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(e){return this.index(e)>=0}html(e,t){return this.xml(e,t,"http://www.w3.org/1999/xhtml")}id(e){return e!==void 0||this.node.id||(this.node.id=HI(this.type)),this.attr("id",e)}index(e){return[].slice.call(this.node.childNodes).indexOf(e.node)}last(){return rd(this.node.lastChild)}matches(e){const t=this.node,s=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return s&&s.call(t,e)}parent(e){let t=this;if(!t.node.parentNode)return null;if(t=rd(t.node.parentNode),!e)return t;do if(typeof e=="string"?t.matches(e):t instanceof e)return t;while(t=rd(t.node.parentNode));return t}put(e,t){return e=Ru(e),this.add(e,t),e}putIn(e,t){return Ru(e).add(this,t)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(e){return this.node.removeChild(e.node),this}replace(e){return e=Ru(e),this.node.parentNode&&this.node.parentNode.replaceChild(e.node,this.node),e}round(e=2,t=null){const s=10**e,c=this.attr(t);for(const h in c)typeof c[h]=="number"&&(c[h]=Math.round(c[h]*s)/s);return this.attr(c),this}svg(e,t){return this.xml(e,t,tw)}toString(){return this.id()}words(e){return this.node.textContent=e,this}wrap(e){const t=this.parent();if(!t)return this.addTo(e);const s=t.index(this);return t.put(e,s).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(e,t,s){if(typeof e=="boolean"&&(s=t,t=e,e=null),e==null||typeof e=="function"){t=t==null||t,this.writeDataToDom();let r=this;if(e!=null){if(r=rd(r.node.cloneNode(!0)),t){const y=e(r);if(r=y||r,y===!1)return""}r.each(function(){const y=e(this),b=y||this;y===!1?this.remove():y&&this!==b&&this.replace(b)},!0)}return t?r.node.outerHTML:r.node.innerHTML}t=t!=null&&t;const c=Wy("wrapper",s),h=Ao.document.createDocumentFragment();c.innerHTML=e;for(let r=c.children.length;r--;)h.appendChild(c.firstElementChild);const A=this.parent();return t?this.replace(h)&&A:this.add(h)}};Gn(fm,{attr:function(a,e,t){if(a==null){a={},e=this.node.attributes;for(const s of e)a[s.nodeName]=lE.test(s.nodeValue)?parseFloat(s.nodeValue):s.nodeValue;return a}if(a instanceof Array)return a.reduce((s,c)=>(s[c]=this.attr(c),s),{});if(typeof a=="object"&&a.constructor===Object)for(e in a)this.attr(e,a[e]);else if(e===null)this.node.removeAttribute(a);else{if(e==null)return(e=this.node.getAttribute(a))==null?sD[a]:lE.test(e)?parseFloat(e):e;typeof(e=KI.reduce((s,c)=>c(a,s,this),e))=="number"?e=new yo(e):oD.has(a)&&KA.isColor(e)?e=new KA(e):e.constructor===Array&&(e=new Bg(e)),a==="leading"?this.leading&&this.leading(e):typeof t=="string"?this.node.setAttributeNS(t,a,e.toString()):this.node.setAttribute(a,e.toString()),!this.rebuild||a!=="font-size"&&a!=="x"||this.rebuild()}return this},find:function(a){return Ig(a,this.node)},findOne:function(a){return rd(this.node.querySelector(a))}}),fo(fm,"Dom");let zc=class extends fm{constructor(e,t){super(e,t),this.dom={},this.node.instance=this,(e.hasAttribute("data-svgjs")||e.hasAttribute("svgjs:data"))&&this.setData(JSON.parse(e.getAttribute("data-svgjs"))??JSON.parse(e.getAttribute("svgjs:data"))??{})}center(e,t){return this.cx(e).cy(t)}cx(e){return e==null?this.x()+this.width()/2:this.x(e-this.width()/2)}cy(e){return e==null?this.y()+this.height()/2:this.y(e-this.height()/2)}defs(){const e=this.root();return e&&e.defs()}dmove(e,t){return this.dx(e).dy(t)}dx(e=0){return this.x(new yo(e).plus(this.x()))}dy(e=0){return this.y(new yo(e).plus(this.y()))}getEventHolder(){return this}height(e){return this.attr("height",e)}move(e,t){return this.x(e).y(t)}parents(e=this.root()){const t=typeof e=="string";t||(e=Ru(e));const s=new wg;let c=this;for(;(c=c.parent())&&c.node!==Ao.document&&c.nodeName!=="#document-fragment"&&(s.push(c),t||c.node!==e.node)&&(!t||!c.matches(e));)if(c.node===this.root().node)return null;return s}reference(e){if(!(e=this.attr(e)))return null;const t=(e+"").match(qR);return t?Ru(t[1]):null}root(){const e=this.parent(function(t){return gg[t]}(rw));return e&&e.root()}setData(e){return this.dom=e,this}size(e,t){const s=xm(this,e,t);return this.width(new yo(s.width)).height(new yo(s.height))}width(e){return this.attr("width",e)}writeDataToDom(){return jI(this,this.dom),super.writeDataToDom()}x(e){return this.attr("x",e)}y(e){return this.attr("y",e)}};Gn(zc,{bbox:function(){const a=cE(this,e=>e.getBBox(),e=>{try{const t=e.clone().addTo(vp().svg).show(),s=t.node.getBBox();return t.remove(),s}catch(t){throw new Error(`Getting bbox of element "${e.node.nodeName}" is not possible: ${t.toString()}`)}});return new yc(a)},rbox:function(a){const e=cE(this,s=>s.getBoundingClientRect(),s=>{throw new Error(`Getting rbox of element "${s.node.nodeName}" is not possible`)}),t=new yc(e);return a?t.transform(a.screenCTM().inverseO()):t.addOffset()},inside:function(a,e){const t=this.bbox();return a>t.x&&e>t.y&&a<t.x+t.width&&e<t.y+t.height},point:function(a,e){return new Go(a,e).transformO(this.screenCTM().inverseO())},ctm:function(){return new qs(this.node.getCTM())},screenCTM:function(){try{if(typeof this.isRoot=="function"&&!this.isRoot()){const a=this.rect(1,1),e=a.node.getScreenCTM();return a.remove(),new qs(e)}return new qs(this.node.getScreenCTM())}catch{return console.warn(`Cannot get CTM from SVG node ${this.node.nodeName}. Is the element rendered?`),new qs}}}),fo(zc,"Element");const dy={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(a,e){return e==="color"?a:a+"-"+e}};["fill","stroke"].forEach(function(a){const e={};let t;e[a]=function(s){if(s===void 0)return this.attr(a);if(typeof s=="string"||s instanceof KA||KA.isRgb(s)||s instanceof zc)this.attr(a,s);else for(t=dy[a].length-1;t>=0;t--)s[dy[a][t]]!=null&&this.attr(dy.prefix(a,dy[a][t]),s[dy[a][t]]);return this},zs(["Element","Runner"],e)}),zs(["Element","Runner"],{matrix:function(a,e,t,s,c,h){return a==null?new qs(this):this.attr("transform",new qs(a,e,t,s,c,h))},rotate:function(a,e,t){return this.transform({rotate:a,ox:e,oy:t},!0)},skew:function(a,e,t,s){return arguments.length===1||arguments.length===3?this.transform({skew:a,ox:e,oy:t},!0):this.transform({skew:[a,e],ox:t,oy:s},!0)},shear:function(a,e,t){return this.transform({shear:a,ox:e,oy:t},!0)},scale:function(a,e,t,s){return arguments.length===1||arguments.length===3?this.transform({scale:a,ox:e,oy:t},!0):this.transform({scale:[a,e],ox:t,oy:s},!0)},translate:function(a,e){return this.transform({translate:[a,e]},!0)},relative:function(a,e){return this.transform({relative:[a,e]},!0)},flip:function(a="both",e="center"){return"xybothtrue".indexOf(a)===-1&&(e=a,a="both"),this.transform({flip:a,origin:e},!0)},opacity:function(a){return this.attr("opacity",a)}}),zs("radius",{radius:function(a,e=a){return(this._element||this).type==="radialGradient"?this.attr("r",new yo(a)):this.rx(a).ry(e)}}),zs("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(a){return new Go(this.node.getPointAtLength(a))}}),zs(["Element","Runner"],{font:function(a,e){if(typeof a=="object"){for(e in a)this.font(e,a[e]);return this}return a==="leading"?this.leading(e):a==="anchor"?this.attr("text-anchor",e):a==="size"||a==="family"||a==="weight"||a==="stretch"||a==="variant"||a==="style"?this.attr("font-"+a,e):this.attr(a,e)}});zs("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel","contextmenu","wheel","pointerdown","pointermove","pointerup","pointerleave","pointercancel"].reduce(function(a,e){return a[e]=function(t){return t===null?this.off(e):this.on(e,t),this},a},{})),zs("Element",{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split($R).slice(0,-1).map(function(e){const t=e.trim().split("(");return[t[0],t[1].split(Mf).map(function(s){return parseFloat(s)})]}).reverse().reduce(function(e,t){return t[0]==="matrix"?e.lmultiply(qs.fromArray(t[1])):e[t[0]].apply(e,t[1])},new qs)},toParent:function(a,e){if(this===a)return this;if($b(this.node))return this.addTo(a,e);const t=this.screenCTM(),s=a.screenCTM().inverse();return this.addTo(a,e).untransform().transform(s.multiply(t)),this},toRoot:function(a){return this.toParent(this.root(),a)},transform:function(a,e){if(a==null||typeof a=="string"){const s=new qs(this).decompose();return a==null?s:s[a]}qs.isMatrixLike(a)||(a={...a,origin:qb(a,this)});const t=new qs(e===!0?this:e||!1).transform(a);return this.attr("transform",t)}});let Nh=class $I extends zc{flatten(){return this.each(function(){if(this instanceof $I)return this.flatten().ungroup()}),this}ungroup(e=this.parent(),t=e.index(this)){return t=t===-1?e.children().length:t,this.each(function(s,c){return c[c.length-s-1].toParent(e,t)}),this.remove()}};fo(Nh,"Container");let A_=class extends Nh{constructor(e,t=e){super(ta("defs",e),t)}flatten(){return this}ungroup(){return this}};fo(A_,"Defs");let jh=class extends zc{};function ow(a){return this.attr("rx",a)}function aw(a){return this.attr("ry",a)}function ZI(a){return a==null?this.cx()-this.rx():this.cx(a+this.rx())}function JI(a){return a==null?this.cy()-this.ry():this.cy(a+this.ry())}function eT(a){return this.attr("cx",a)}function tT(a){return this.attr("cy",a)}function iT(a){return a==null?2*this.rx():this.rx(new yo(a).divide(2))}function rT(a){return a==null?2*this.ry():this.ry(new yo(a).divide(2))}fo(jh,"Shape");var aD=Object.freeze({__proto__:null,cx:eT,cy:tT,height:rT,rx:ow,ry:aw,width:iT,x:ZI,y:JI});let C0=class extends jh{constructor(e,t=e){super(ta("ellipse",e),t)}size(e,t){const s=xm(this,e,t);return this.rx(new yo(s.width).divide(2)).ry(new yo(s.height).divide(2))}};Gn(C0,aD),zs("Container",{ellipse:ea(function(a=0,e=a){return this.put(new C0).size(a,e).move(0,0)})}),fo(C0,"Ellipse");let nT=class extends fm{constructor(e=Ao.document.createDocumentFragment()){super(e)}xml(e,t,s){if(typeof e=="boolean"&&(s=t,t=e,e=null),e==null||typeof e=="function"){const c=new fm(Wy("wrapper",s));return c.add(this.node.cloneNode(!0)),c.xml(!1,s)}return super.xml(e,!1,s)}};function sT(a,e){return(this._element||this).type==="radialGradient"?this.attr({fx:new yo(a),fy:new yo(e)}):this.attr({x1:new yo(a),y1:new yo(e)})}function oT(a,e){return(this._element||this).type==="radialGradient"?this.attr({cx:new yo(a),cy:new yo(e)}):this.attr({x2:new yo(a),y2:new yo(e)})}fo(nT,"Fragment");var lD=Object.freeze({__proto__:null,from:sT,to:oT});let Fy=class extends Nh{constructor(e,t){super(ta(e+"Gradient",typeof e=="string"?null:e),t)}attr(e,t,s){return e==="transform"&&(e="gradientTransform"),super.attr(e,t,s)}bbox(){return new yc}targets(){return Ig("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}};Gn(Fy,lD),zs({Container:{gradient(...a){return this.defs().gradient(...a)}},Defs:{gradient:ea(function(a,e){return this.put(new Fy(a)).update(e)})}}),fo(Fy,"Gradient");let Xy=class extends Nh{constructor(e,t=e){super(ta("pattern",e),t)}attr(e,t,s){return e==="transform"&&(e="patternTransform"),super.attr(e,t,s)}bbox(){return new yc}targets(){return Ig("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}};zs({Container:{pattern(...a){return this.defs().pattern(...a)}},Defs:{pattern:ea(function(a,e,t){return this.put(new Xy).update(t).attr({x:0,y:0,width:a,height:e,patternUnits:"userSpaceOnUse"})})}}),fo(Xy,"Pattern");let S0=class extends jh{constructor(e,t=e){super(ta("image",e),t)}load(e,t){if(!e)return this;const s=new Ao.window.Image;return Ef(s,"load",function(c){const h=this.parent(Xy);this.width()===0&&this.height()===0&&this.size(s.width,s.height),h instanceof Xy&&h.width()===0&&h.height()===0&&h.size(this.width(),this.height()),typeof t=="function"&&t.call(this,c)},this),Ef(s,"load error",function(){nd(s)}),this.attr("href",s.src=e,bm)}};var hE;hE=function(a,e,t){return a!=="fill"&&a!=="stroke"||JR.test(e)&&(e=t.root().defs().image(e)),e instanceof S0&&(e=t.root().defs().pattern(0,0,s=>{s.add(e)})),e},KI.push(hE),zs({Container:{image:ea(function(a,e){return this.put(new S0).size(0,0).load(a,e)})}}),fo(S0,"Image");let Lp=class extends Bg{bbox(){let e=-1/0,t=-1/0,s=1/0,c=1/0;return this.forEach(function(h){e=Math.max(h[0],e),t=Math.max(h[1],t),s=Math.min(h[0],s),c=Math.min(h[1],c)}),new yc(s,c,e-s,t-c)}move(e,t){const s=this.bbox();if(e-=s.x,t-=s.y,!isNaN(e)&&!isNaN(t))for(let c=this.length-1;c>=0;c--)this[c]=[this[c][0]+e,this[c][1]+t];return this}parse(e=[0,0]){const t=[];(e=e instanceof Array?Array.prototype.concat.apply([],e):e.trim().split(Mf).map(parseFloat)).length%2!=0&&e.pop();for(let s=0,c=e.length;s<c;s+=2)t.push([e[s],e[s+1]]);return t}size(e,t){let s;const c=this.bbox();for(s=this.length-1;s>=0;s--)c.width&&(this[s][0]=(this[s][0]-c.x)*e/c.width+c.x),c.height&&(this[s][1]=(this[s][1]-c.y)*t/c.height+c.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const e=[];for(let t=0,s=this.length;t<s;t++)e.push(this[t].join(","));return e.join(" ")}transform(e){return this.clone().transformO(e)}transformO(e){qs.isMatrixLike(e)||(e=new qs(e));for(let t=this.length;t--;){const[s,c]=this[t];this[t][0]=e.a*s+e.c*c+e.e,this[t][1]=e.b*s+e.d*c+e.f}return this}};const cD=Lp;var lw=Object.freeze({__proto__:null,MorphArray:cD,height:function(a){const e=this.bbox();return a==null?e.height:this.size(e.width,a)},width:function(a){const e=this.bbox();return a==null?e.width:this.size(a,e.height)},x:function(a){return a==null?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return a==null?this.bbox().y:this.move(this.bbox().x,a)}});let cg=class extends jh{constructor(a,e=a){super(ta("line",a),e)}array(){return new Lp([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(a,e){return this.attr(this.array().move(a,e).toLine())}plot(a,e,t,s){return a==null?this.array():(a=e!==void 0?{x1:a,y1:e,x2:t,y2:s}:new Lp(a).toLine(),this.attr(a))}size(a,e){const t=xm(this,a,e);return this.attr(this.array().size(t.width,t.height).toLine())}};Gn(cg,lw),zs({Container:{line:ea(function(...a){return cg.prototype.plot.apply(this.put(new cg),a[0]!=null?a:[0,0,0,0])})}}),fo(cg,"Line");let E0=class extends Nh{constructor(e,t=e){super(ta("marker",e),t)}height(e){return this.attr("markerHeight",e)}orient(e){return this.attr("orient",e)}ref(e,t){return this.attr("refX",e).attr("refY",t)}toString(){return"url(#"+this.id()+")"}update(e){return this.clear(),typeof e=="function"&&e.call(this,this),this}width(e){return this.attr("markerWidth",e)}};function nm(a,e){return function(t){return t==null?this[a]:(this[a]=t,e&&e.call(this),this)}}zs({Container:{marker(...a){return this.defs().marker(...a)}},Defs:{marker:ea(function(a,e,t){return this.put(new E0).size(a,e).ref(a/2,e/2).viewbox(0,0,a,e).attr("orient","auto").update(t)})},marker:{marker(a,e,t,s){let c=["marker"];return a!=="all"&&c.push(a),c=c.join("-"),a=arguments[1]instanceof E0?arguments[1]:this.defs().marker(e,t,s),this.attr(c,a)}}}),fo(E0,"Marker");const uD={"-":function(a){return a},"<>":function(a){return-Math.cos(a*Math.PI)/2+.5},">":function(a){return Math.sin(a*Math.PI/2)},"<":function(a){return 1-Math.cos(a*Math.PI/2)},bezier:function(a,e,t,s){return function(c){return c<0?a>0?e/a*c:t>0?s/t*c:0:c>1?t<1?(1-s)/(1-t)*c+(s-t)/(1-t):a<1?(1-e)/(1-a)*c+(e-a)/(1-a):1:3*c*(1-c)**2*e+3*c**2*(1-c)*s+c**3}},steps:function(a,e="end"){e=e.split("-").reverse()[0];let t=a;return e==="none"?--t:e==="both"&&++t,(s,c=!1)=>{let h=Math.floor(s*a);const A=s*h%1==0;return e!=="start"&&e!=="both"||++h,c&&A&&--h,s>=0&&h<0&&(h=0),s<=1&&h>t&&(h=t),h/t}}};let cw=class{done(){return!1}},Zb=class extends cw{constructor(e=rD){super(),this.ease=uD[e]||e}step(e,t,s){return typeof e!="number"?s<1?e:t:e+(t-e)*this.ease(s)}};class X0 extends cw{constructor(e){super(),this.stepper=e}done(e){return e.done}step(e,t,s,c){return this.stepper(e,t,s,c)}}function dE(){const a=(this._duration||500)/1e3,e=this._overshoot||0,t=Math.PI,s=Math.log(e/100+1e-10),c=-s/Math.sqrt(t*t+s*s),h=3.9/(c*a);this.d=2*c*h,this.k=h*h}Gn(class extends X0{constructor(a=500,e=0){super(),this.duration(a).overshoot(e)}step(a,e,t,s){if(typeof a=="string")return a;if(s.done=t===1/0,t===1/0)return e;if(t===0)return a;t>100&&(t=16),t/=1e3;const c=s.velocity||0,h=-this.d*c-this.k*(a-e),A=a+c*t+h*t*t/2;return s.velocity=c+h*t,s.done=Math.abs(e-A)+Math.abs(c)<.002,s.done?e:A}},{duration:nm("_duration",dE),overshoot:nm("_overshoot",dE)});Gn(class extends X0{constructor(a=.1,e=.01,t=0,s=1e3){super(),this.p(a).i(e).d(t).windup(s)}step(a,e,t,s){if(typeof a=="string")return a;if(s.done=t===1/0,t===1/0)return e;if(t===0)return a;const c=e-a;let h=(s.integral||0)+c*t;const A=(c-(s.error||0))/t,r=this._windup;return r!==!1&&(h=Math.max(-r,Math.min(h,r))),s.error=c,s.integral=h,s.done=Math.abs(c)<.001,s.done?e:a+(this.P*c+this.I*h+this.D*A)}},{windup:nm("_windup"),p:nm("P"),i:nm("I"),d:nm("D")});const hD={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Jb={M:function(a,e,t){return e.x=t.x=a[0],e.y=t.y=a[1],["M",e.x,e.y]},L:function(a,e){return e.x=a[0],e.y=a[1],["L",a[0],a[1]]},H:function(a,e){return e.x=a[0],["H",a[0]]},V:function(a,e){return e.y=a[0],["V",a[0]]},C:function(a,e){return e.x=a[4],e.y=a[5],["C",a[0],a[1],a[2],a[3],a[4],a[5]]},S:function(a,e){return e.x=a[2],e.y=a[3],["S",a[0],a[1],a[2],a[3]]},Q:function(a,e){return e.x=a[2],e.y=a[3],["Q",a[0],a[1],a[2],a[3]]},T:function(a,e){return e.x=a[0],e.y=a[1],["T",a[0],a[1]]},Z:function(a,e,t){return e.x=t.x,e.y=t.y,["Z"]},A:function(a,e){return e.x=a[5],e.y=a[6],["A",a[0],a[1],a[2],a[3],a[4],a[5],a[6]]}},ob="mlhvqtcsaz".split("");for(let a=0,e=ob.length;a<e;++a)Jb[ob[a]]=function(t){return function(s,c,h){if(t==="H")s[0]=s[0]+c.x;else if(t==="V")s[0]=s[0]+c.y;else if(t==="A")s[5]=s[5]+c.x,s[6]=s[6]+c.y;else for(let A=0,r=s.length;A<r;++A)s[A]=s[A]+(A%2?c.y:c.x);return Jb[t](s,c,h)}}(ob[a].toUpperCase());function e1(a){return a.segment.length&&a.segment.length-1===hD[a.segment[0].toUpperCase()]}function dD(a,e){a.inNumber&&sg(a,!1);const t=nw.test(e);if(t)a.segment=[e];else{const s=a.lastCommand,c=s.toLowerCase(),h=s===c;a.segment=[c==="m"?h?"l":"L":s]}return a.inSegment=!0,a.lastCommand=a.segment[0],t}function sg(a,e){if(!a.inNumber)throw new Error("Parser Error");a.number&&a.segment.push(parseFloat(a.number)),a.inNumber=e,a.number="",a.pointSeen=!1,a.hasExponent=!1,e1(a)&&t1(a)}function t1(a){a.inSegment=!1,a.absolute&&(a.segment=function(e){const t=e.segment[0];return Jb[t](e.segment.slice(1),e.p,e.p0)}(a)),a.segments.push(a.segment)}function AD(a){if(!a.segment.length)return!1;const e=a.segment[0].toUpperCase()==="A",t=a.segment.length;return e&&(t===4||t===5)}function fD(a){return a.lastToken.toUpperCase()==="E"}const pD=new Set([" ",",","	",`
`,"\r","\f"]);class Xd extends Bg{bbox(){return vp().path.setAttribute("d",this.toString()),new yc(vp.nodes.path.getBBox())}move(e,t){const s=this.bbox();if(e-=s.x,t-=s.y,!isNaN(e)&&!isNaN(t))for(let c,h=this.length-1;h>=0;h--)c=this[h][0],c==="M"||c==="L"||c==="T"?(this[h][1]+=e,this[h][2]+=t):c==="H"?this[h][1]+=e:c==="V"?this[h][1]+=t:c==="C"||c==="S"||c==="Q"?(this[h][1]+=e,this[h][2]+=t,this[h][3]+=e,this[h][4]+=t,c==="C"&&(this[h][5]+=e,this[h][6]+=t)):c==="A"&&(this[h][6]+=e,this[h][7]+=t);return this}parse(e="M0 0"){return Array.isArray(e)&&(e=Array.prototype.concat.apply([],e).toString()),function(t,s=!0){let c=0,h="";const A={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:s,p0:new Go,p:new Go};for(;A.lastToken=h,h=t.charAt(c++);)if(A.inSegment||!dD(A,h))if(h!==".")if(isNaN(parseInt(h)))if(pD.has(h))A.inNumber&&sg(A,!1);else if(h!=="-"&&h!=="+")if(h.toUpperCase()!=="E"){if(nw.test(h)){if(A.inNumber)sg(A,!1);else{if(!e1(A))throw new Error("parser Error");t1(A)}--c}}else A.number+=h,A.hasExponent=!0;else{if(A.inNumber&&!fD(A)){sg(A,!1),--c;continue}A.number+=h,A.inNumber=!0}else{if(A.number==="0"||AD(A)){A.inNumber=!0,A.number=h,sg(A,!0);continue}A.inNumber=!0,A.number+=h}else{if(A.pointSeen||A.hasExponent){sg(A,!1),--c;continue}A.inNumber=!0,A.pointSeen=!0,A.number+=h}return A.inNumber&&sg(A,!1),A.inSegment&&e1(A)&&t1(A),A.segments}(e)}size(e,t){const s=this.bbox();let c,h;for(s.width=s.width===0?1:s.width,s.height=s.height===0?1:s.height,c=this.length-1;c>=0;c--)h=this[c][0],h==="M"||h==="L"||h==="T"?(this[c][1]=(this[c][1]-s.x)*e/s.width+s.x,this[c][2]=(this[c][2]-s.y)*t/s.height+s.y):h==="H"?this[c][1]=(this[c][1]-s.x)*e/s.width+s.x:h==="V"?this[c][1]=(this[c][1]-s.y)*t/s.height+s.y:h==="C"||h==="S"||h==="Q"?(this[c][1]=(this[c][1]-s.x)*e/s.width+s.x,this[c][2]=(this[c][2]-s.y)*t/s.height+s.y,this[c][3]=(this[c][3]-s.x)*e/s.width+s.x,this[c][4]=(this[c][4]-s.y)*t/s.height+s.y,h==="C"&&(this[c][5]=(this[c][5]-s.x)*e/s.width+s.x,this[c][6]=(this[c][6]-s.y)*t/s.height+s.y)):h==="A"&&(this[c][1]=this[c][1]*e/s.width,this[c][2]=this[c][2]*t/s.height,this[c][6]=(this[c][6]-s.x)*e/s.width+s.x,this[c][7]=(this[c][7]-s.y)*t/s.height+s.y);return this}toString(){return function(e){let t="";for(let s=0,c=e.length;s<c;s++)t+=e[s][0],e[s][1]!=null&&(t+=e[s][1],e[s][2]!=null&&(t+=" ",t+=e[s][2],e[s][3]!=null&&(t+=" ",t+=e[s][3],t+=" ",t+=e[s][4],e[s][5]!=null&&(t+=" ",t+=e[s][5],t+=" ",t+=e[s][6],e[s][7]!=null&&(t+=" ",t+=e[s][7])))));return t+" "}(this)}}const aT=a=>{const e=typeof a;return e==="number"?yo:e==="string"?KA.isColor(a)?KA:Mf.test(a)?nw.test(a)?Xd:Bg:VI.test(a)?yo:i1:r1.indexOf(a.constructor)>-1?a.constructor:Array.isArray(a)?Bg:e==="object"?Yy:i1};class og{constructor(e){this._stepper=e||new Zb("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(e){return this._morphObj.morph(this._from,this._to,e,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,t){return e&&t},!0)}from(e){return e==null?this._from:(this._from=this._set(e),this)}stepper(e){return e==null?this._stepper:(this._stepper=e,this)}to(e){return e==null?this._to:(this._to=this._set(e),this)}type(e){return e==null?this._type:(this._type=e,this)}_set(e){this._type||this.type(aT(e));let t=new this._type(e);return this._type===KA&&(t=this._to?t[this._to[4]]():this._from?t[this._from[4]]():t),this._type===Yy&&(t=this._to?t.align(this._to):this._from?t.align(this._from):t),t=t.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(t.length)).map(Object).map(function(s){return s.done=!0,s}),t}}class i1{constructor(...e){this.init(...e)}init(e){return e=Array.isArray(e)?e[0]:e,this.value=e,this}toArray(){return[this.value]}valueOf(){return this.value}}class uv{constructor(...e){this.init(...e)}init(e){return Array.isArray(e)&&(e={scaleX:e[0],scaleY:e[1],shear:e[2],rotate:e[3],translateX:e[4],translateY:e[5],originX:e[6],originY:e[7]}),Object.assign(this,uv.defaults,e),this}toArray(){const e=this;return[e.scaleX,e.scaleY,e.shear,e.rotate,e.translateX,e.translateY,e.originX,e.originY]}}uv.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const gD=(a,e)=>a[0]<e[0]?-1:a[0]>e[0]?1:0;class Yy{constructor(...e){this.init(...e)}align(e){const t=this.values;for(let s=0,c=t.length;s<c;++s){if(t[s+1]===e[s+1]){if(t[s+1]===KA&&e[s+7]!==t[s+7]){const r=e[s+7],y=new KA(this.values.splice(s+3,5))[r]().toArray();this.values.splice(s+3,0,...y)}s+=t[s+2]+2;continue}if(!e[s+1])return this;const h=new e[s+1]().toArray(),A=t[s+2]+3;t.splice(s,A,e[s],e[s+1],e[s+2],...h),s+=t[s+2]+2}return this}init(e){if(this.values=[],Array.isArray(e))return void(this.values=e.slice());e=e||{};const t=[];for(const s in e){const c=aT(e[s]),h=new c(e[s]).toArray();t.push([s,c,h.length,...h])}return t.sort(gD),this.values=t.reduce((s,c)=>s.concat(c),[]),this}toArray(){return this.values}valueOf(){const e={},t=this.values;for(;t.length;){const s=t.shift(),c=t.shift(),h=t.shift(),A=t.splice(0,h);e[s]=new c(A)}return e}}const r1=[i1,uv,Yy];class lm extends jh{constructor(e,t=e){super(ta("path",e),t)}array(){return this._array||(this._array=new Xd(this.attr("d")))}clear(){return delete this._array,this}height(e){return e==null?this.bbox().height:this.size(this.bbox().width,e)}move(e,t){return this.attr("d",this.array().move(e,t))}plot(e){return e==null?this.array():this.clear().attr("d",typeof e=="string"?e:this._array=new Xd(e))}size(e,t){const s=xm(this,e,t);return this.attr("d",this.array().size(s.width,s.height))}width(e){return e==null?this.bbox().width:this.size(e,this.bbox().height)}x(e){return e==null?this.bbox().x:this.move(e,this.bbox().y)}y(e){return e==null?this.bbox().y:this.move(this.bbox().x,e)}}lm.prototype.MorphArray=Xd,zs({Container:{path:ea(function(a){return this.put(new lm).plot(a||new Xd)})}}),fo(lm,"Path");var lT=Object.freeze({__proto__:null,array:function(){return this._array||(this._array=new Lp(this.attr("points")))},clear:function(){return delete this._array,this},move:function(a,e){return this.attr("points",this.array().move(a,e))},plot:function(a){return a==null?this.array():this.clear().attr("points",typeof a=="string"?a:this._array=new Lp(a))},size:function(a,e){const t=xm(this,a,e);return this.attr("points",this.array().size(t.width,t.height))}});class ug extends jh{constructor(e,t=e){super(ta("polygon",e),t)}}zs({Container:{polygon:ea(function(a){return this.put(new ug).plot(a||new Lp)})}}),Gn(ug,lw),Gn(ug,lT),fo(ug,"Polygon");class hg extends jh{constructor(e,t=e){super(ta("polyline",e),t)}}zs({Container:{polyline:ea(function(a){return this.put(new hg).plot(a||new Lp)})}}),Gn(hg,lw),Gn(hg,lT),fo(hg,"Polyline");class I0 extends jh{constructor(e,t=e){super(ta("rect",e),t)}}Gn(I0,{rx:ow,ry:aw}),zs({Container:{rect:ea(function(a,e){return this.put(new I0).size(a,e)})}}),fo(I0,"Rect");class ab{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(e){const t=e.next!==void 0?e:{value:e,next:null,prev:null};return this._last?(t.prev=this._last,this._last.next=t,this._last=t):(this._last=t,this._first=t),t}remove(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this._last&&(this._last=e.prev),e===this._first&&(this._first=e.next),e.prev=null,e.next=null}shift(){const e=this._first;return e?(this._first=e.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,e.value):null}}const Ro={nextDraw:null,frames:new ab,timeouts:new ab,immediates:new ab,timer:()=>Ao.window.performance||Ao.window.Date,transforms:[],frame(a){const e=Ro.frames.push({run:a});return Ro.nextDraw===null&&(Ro.nextDraw=Ao.window.requestAnimationFrame(Ro._draw)),e},timeout(a,e){e=e||0;const t=Ro.timer().now()+e,s=Ro.timeouts.push({run:a,time:t});return Ro.nextDraw===null&&(Ro.nextDraw=Ao.window.requestAnimationFrame(Ro._draw)),s},immediate(a){const e=Ro.immediates.push(a);return Ro.nextDraw===null&&(Ro.nextDraw=Ao.window.requestAnimationFrame(Ro._draw)),e},cancelFrame(a){a!=null&&Ro.frames.remove(a)},clearTimeout(a){a!=null&&Ro.timeouts.remove(a)},cancelImmediate(a){a!=null&&Ro.immediates.remove(a)},_draw(a){let e=null;const t=Ro.timeouts.last();for(;(e=Ro.timeouts.shift())&&(a>=e.time?e.run():Ro.timeouts.push(e),e!==t););let s=null;const c=Ro.frames.last();for(;s!==c&&(s=Ro.frames.shift());)s.run(a);let h=null;for(;h=Ro.immediates.shift();)h();Ro.nextDraw=Ro.timeouts.first()||Ro.frames.first()?Ao.window.requestAnimationFrame(Ro._draw):null}},mD=function(a){const e=a.start,t=a.runner.duration();return{start:e,duration:t,end:e+t,runner:a.runner}},yD=function(){const a=Ao.window;return(a.performance||a.Date).now()};class cT extends cv{constructor(e=yD){super(),this._timeSource=e,this.terminate()}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const e=this.getLastRunnerInfo(),t=e?e.runner.duration():0;return(e?e.start:this._time)+t}getEndTimeOfTimeline(){const e=this._runners.map(t=>t.start+t.runner.duration());return Math.max(0,...e)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(e){return this._runners[this._runnerIds.indexOf(e)]||null}pause(){return this._paused=!0,this._continue()}persist(e){return e==null?this._persist:(this._persist=e,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(e){const t=this.speed();if(e==null)return this.speed(-t);const s=Math.abs(t);return this.speed(e?-s:s)}schedule(e,t,s){if(e==null)return this._runners.map(mD);let c=0;const h=this.getEndTime();if(t=t||0,s==null||s==="last"||s==="after")c=h;else if(s==="absolute"||s==="start")c=t,t=0;else if(s==="now")c=this._time;else if(s==="relative"){const y=this.getRunnerInfoById(e.id);y&&(c=y.start+t,t=0)}else{if(s!=="with-last")throw new Error('Invalid value for the "when" parameter');{const y=this.getLastRunnerInfo();c=y?y.start:this._time}}e.unschedule(),e.timeline(this);const A=e.persist(),r={persist:A===null?this._persist:A,start:c+t,runner:e};return this._lastRunnerId=e.id,this._runners.push(r),this._runners.sort((y,b)=>y.start-b.start),this._runnerIds=this._runners.map(y=>y.runner.id),this.updateTime()._continue(),this}seek(e){return this.time(this._time+e)}source(e){return e==null?this._timeSource:(this._timeSource=e,this)}speed(e){return e==null?this._speed:(this._speed=e,this)}stop(){return this.time(0),this.pause()}time(e){return e==null?this._time:(this._time=e,this._continue(!0))}unschedule(e){const t=this._runnerIds.indexOf(e.id);return t<0||(this._runners.splice(t,1),this._runnerIds.splice(t,1),e.timeline(null)),this}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(e=!1){return Ro.cancelFrame(this._nextFrame),this._nextFrame=null,e?this._stepImmediate():(this._paused||(this._nextFrame=Ro.frame(this._step)),this)}_stepFn(e=!1){const t=this._timeSource();let s=t-this._lastSourceTime;e&&(s=0);const c=this._speed*s+(this._time-this._lastStepTime);this._lastSourceTime=t,e||(this._time+=c,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let A=this._runners.length;A--;){const r=this._runners[A],y=r.runner;this._time-r.start<=0&&y.reset()}let h=!1;for(let A=0,r=this._runners.length;A<r;A++){const y=this._runners[A],b=y.runner;let _=c;const B=this._time-y.start;if(B<=0){h=!0;continue}B<_&&(_=B),b.active()&&(b.step(_).done?y.persist!==!0&&b.duration()-b.time()+this._time+y.persist<this._time&&(b.unschedule(),--A,--r):h=!0)}return h&&!(this._speed<0&&this._time===0)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}terminate(){this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}}zs({Element:{timeline:function(a){return a==null?(this._timeline=this._timeline||new cT,this._timeline):(this._timeline=a,this)}}});class zh extends cv{constructor(e){super(),this.id=zh.id++,e=typeof(e=e??sb)=="function"?new X0(e):e,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration=typeof e=="number"&&e,this._isDeclarative=e instanceof X0,this._stepper=this._isDeclarative?e:new Zb,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new qs,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=!!this._isDeclarative||null}static sanitise(e,t,s){let c=1,h=!1,A=0;return t=t??nD,s=s||"last",typeof(e=e??sb)!="object"||e instanceof cw||(t=e.delay??t,s=e.when??s,h=e.swing||h,c=e.times??c,A=e.wait??A,e=e.duration??sb),{duration:e,delay:t,swing:h,times:c,wait:A,when:s}}active(e){return e==null?this.enabled:(this.enabled=e,this)}addTransform(e){return this.transforms.lmultiplyO(e),this}after(e){return this.on("finished",e)}animate(e,t,s){const c=zh.sanitise(e,t,s),h=new zh(c.duration);return this._timeline&&h.timeline(this._timeline),this._element&&h.element(this._element),h.loop(c).schedule(c.delay,c.when)}clearTransform(){return this.transforms=new qs,this}clearTransformsFromQueue(){this.done&&this._timeline&&this._timeline._runnerIds.includes(this.id)||(this._queue=this._queue.filter(e=>!e.isTransform))}delay(e){return this.animate(0,e)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(e){return this.queue(null,e)}ease(e){return this._stepper=new Zb(e),this}element(e){return e==null?this._element:(this._element=e,e._prepareRunner(),this)}finish(){return this.step(1/0)}loop(e,t,s){return typeof e=="object"&&(t=e.swing,s=e.wait,e=e.times),this._times=e||1/0,this._swing=t||!1,this._wait=s||0,this._times===!0&&(this._times=1/0),this}loops(e){const t=this._duration+this._wait;if(e==null){const h=Math.floor(this._time/t),A=(this._time-h*t)/this._duration;return Math.min(h+A,this._times)}const s=e%1,c=t*Math.floor(e)+this._duration*s;return this.time(c)}persist(e){return e==null?this._persist:(this._persist=e,this)}position(e){const t=this._time,s=this._duration,c=this._wait,h=this._times,A=this._swing,r=this._reverse;let y;if(e==null){const B=function(E){const R=A*Math.floor(E%(2*(c+s))/(c+s)),M=R&&!r||!R&&r,G=Math.pow(-1,M)*(E%(c+s))/s+M;return Math.max(Math.min(G,1),0)},I=h*(c+s)-c;return y=t<=0?Math.round(B(1e-5)):t<I?B(t):Math.round(B(I-1e-5)),y}const b=Math.floor(this.loops()),_=A&&b%2==0;return y=b+(_&&!r||r&&_?e:1-e),this.loops(y)}progress(e){return e==null?Math.min(1,this._time/this.duration()):this.time(e*this.duration())}queue(e,t,s,c){return this._queue.push({initialiser:e||uE,runner:t||uE,retarget:s,isTransform:c,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted||(this.time(0),this._reseted=!0),this}reverse(e){return this._reverse=e??!this._reverse,this}schedule(e,t,s){if(e instanceof cT||(s=t,t=e,e=this.timeline()),!e)throw Error("Runner cannot be scheduled without timeline");return e.schedule(this,t,s),this}step(e){if(!this.enabled)return this;e=e??16,this._time+=e;const t=this.position(),s=this._lastPosition!==t&&this._time>=0;this._lastPosition=t;const c=this.duration(),h=this._lastTime<=0&&this._time>0,A=this._lastTime<c&&this._time>=c;this._lastTime=this._time,h&&this.fire("start",this);const r=this._isDeclarative;this.done=!r&&!A&&this._time>=c,this._reseted=!1;let y=!1;return(s||r)&&(this._initialise(s),this.transforms=new qs,y=this._run(r?e:t),this.fire("step",this)),this.done=this.done||y&&r,A&&this.fire("finished",this),this}time(e){if(e==null)return this._time;const t=e-this._time;return this.step(t),this}timeline(e){return e===void 0?this._timeline:(this._timeline=e,this)}unschedule(){const e=this.timeline();return e&&e.unschedule(this),this}_initialise(e){if(e||this._isDeclarative)for(let t=0,s=this._queue.length;t<s;++t){const c=this._queue[t],h=this._isDeclarative||!c.initialised&&e;e=!c.finished,h&&e&&(c.initialiser.call(this),c.initialised=!0)}}_rememberMorpher(e,t){if(this._history[e]={morpher:t,caller:this._queue[this._queue.length-1]},this._isDeclarative){const s=this.timeline();s&&s.play()}}_run(e){let t=!0;for(let s=0,c=this._queue.length;s<c;++s){const h=this._queue[s],A=h.runner.call(this,e);h.finished=h.finished||A===!0,t=t&&h.finished}return t}_tryRetarget(e,t,s){if(this._history[e]){if(!this._history[e].caller.initialised){const h=this._queue.indexOf(this._history[e].caller);return this._queue.splice(h,1),!1}this._history[e].caller.retarget?this._history[e].caller.retarget.call(this,t,s):this._history[e].morpher.to(t),this._history[e].caller.finished=!1;const c=this.timeline();return c&&c.play(),!0}return!1}}zh.id=0;class Y0{constructor(e=new qs,t=-1,s=!0){this.transforms=e,this.id=t,this.done=s}clearTransformsFromQueue(){}}Gn([zh,Y0],{mergeWith(a){return new Y0(a.transforms.lmultiply(this.transforms),a.id)}});const uT=(a,e)=>a.lmultiplyO(e),hT=a=>a.transforms;function vD(){const a=this._transformationRunners.runners.map(hT).reduce(uT,new qs);this.transform(a),this._transformationRunners.merge(),this._transformationRunners.length()===1&&(this._frameId=null)}class _D{constructor(){this.runners=[],this.ids=[]}add(e){if(this.runners.includes(e))return;const t=e.id+1;return this.runners.push(e),this.ids.push(t),this}clearBefore(e){const t=this.ids.indexOf(e+1)||1;return this.ids.splice(0,t,0),this.runners.splice(0,t,new Y0).forEach(s=>s.clearTransformsFromQueue()),this}edit(e,t){const s=this.ids.indexOf(e+1);return this.ids.splice(s,1,e+1),this.runners.splice(s,1,t),this}getByID(e){return this.runners[this.ids.indexOf(e+1)]}length(){return this.ids.length}merge(){let e=null;for(let t=0;t<this.runners.length;++t){const s=this.runners[t];if(e&&s.done&&e.done&&(!s._timeline||!s._timeline._runnerIds.includes(s.id))&&(!e._timeline||!e._timeline._runnerIds.includes(e.id))){this.remove(s.id);const c=s.mergeWith(e);this.edit(e.id,c),e=c,--t}else e=s}return this}remove(e){const t=this.ids.indexOf(e+1);return this.ids.splice(t,1),this.runners.splice(t,1),this}}zs({Element:{animate(a,e,t){const s=zh.sanitise(a,e,t),c=this.timeline();return new zh(s.duration).loop(s).element(this).timeline(c.play()).schedule(s.delay,s.when)},delay(a,e){return this.animate(0,a,e)},_clearTransformRunnersBefore(a){this._transformationRunners.clearBefore(a.id)},_currentTransform(a){return this._transformationRunners.runners.filter(e=>e.id<=a.id).map(hT).reduce(uT,new qs)},_addRunner(a){this._transformationRunners.add(a),Ro.cancelImmediate(this._frameId),this._frameId=Ro.immediate(vD.bind(this))},_prepareRunner(){this._frameId==null&&(this._transformationRunners=new _D().add(new Y0(new qs(this))))}}});Gn(zh,{attr(a,e){return this.styleAttr("attr",a,e)},css(a,e){return this.styleAttr("css",a,e)},styleAttr(a,e,t){if(typeof e=="string")return this.styleAttr(a,{[e]:t});let s=e;if(this._tryRetarget(a,s))return this;let c=new og(this._stepper).to(s),h=Object.keys(s);return this.queue(function(){c=c.from(this.element()[a](h))},function(A){return this.element()[a](c.at(A).valueOf()),c.done()},function(A){const r=Object.keys(A),y=(b=h,r.filter(B=>!b.includes(B)));var b;if(y.length){const B=this.element()[a](y),I=new Yy(c.from()).valueOf();Object.assign(I,B),c.from(I)}const _=new Yy(c.to()).valueOf();Object.assign(_,A),c.to(_),h=r,s=A}),this._rememberMorpher(a,c),this},zoom(a,e){if(this._tryRetarget("zoom",a,e))return this;let t=new og(this._stepper).to(new yo(a));return this.queue(function(){t=t.from(this.element().zoom())},function(s){return this.element().zoom(t.at(s),e),t.done()},function(s,c){e=c,t.to(s)}),this._rememberMorpher("zoom",t),this},transform(a,e,t){if(e=a.relative||e,this._isDeclarative&&!e&&this._tryRetarget("transform",a))return this;const s=qs.isMatrixLike(a);t=a.affine!=null?a.affine:t??!s;const c=new og(this._stepper).type(t?uv:qs);let h,A,r,y,b;return this.queue(function(){A=A||this.element(),h=h||qb(a,A),b=new qs(e?void 0:A),A._addRunner(this),e||A._clearTransformRunnersBefore(this)},function(_){e||this.clearTransform();const{x:B,y:I}=new Go(h).transform(A._currentTransform(this));let E=new qs({...a,origin:[B,I]}),R=this._isDeclarative&&r?r:b;if(t){E=E.decompose(B,I),R=R.decompose(B,I);const G=E.rotate,U=R.rotate,Q=[G-360,G,G+360],q=Q.map(pe=>Math.abs(pe-U)),ne=Math.min(...q),re=q.indexOf(ne);E.rotate=Q[re]}e&&(s||(E.rotate=a.rotate||0),this._isDeclarative&&y&&(R.rotate=y)),c.from(R),c.to(E);const M=c.at(_);return y=M.rotate,r=new qs(M),this.addTransform(r),A._addRunner(this),c.done()},function(_){(_.origin||"center").toString()!==(a.origin||"center").toString()&&(h=qb(_,A)),a={..._,origin:h}},!0),this._isDeclarative&&this._rememberMorpher("transform",c),this},x(a){return this._queueNumber("x",a)},y(a){return this._queueNumber("y",a)},ax(a){return this._queueNumber("ax",a)},ay(a){return this._queueNumber("ay",a)},dx(a=0){return this._queueNumberDelta("x",a)},dy(a=0){return this._queueNumberDelta("y",a)},dmove(a,e){return this.dx(a).dy(e)},_queueNumberDelta(a,e){if(e=new yo(e),this._tryRetarget(a,e))return this;const t=new og(this._stepper).to(e);let s=null;return this.queue(function(){s=this.element()[a](),t.from(s),t.to(s+e)},function(c){return this.element()[a](t.at(c)),t.done()},function(c){t.to(s+new yo(c))}),this._rememberMorpher(a,t),this},_queueObject(a,e){if(this._tryRetarget(a,e))return this;const t=new og(this._stepper).to(e);return this.queue(function(){t.from(this.element()[a]())},function(s){return this.element()[a](t.at(s)),t.done()}),this._rememberMorpher(a,t),this},_queueNumber(a,e){return this._queueObject(a,new yo(e))},cx(a){return this._queueNumber("cx",a)},cy(a){return this._queueNumber("cy",a)},move(a,e){return this.x(a).y(e)},amove(a,e){return this.ax(a).ay(e)},center(a,e){return this.cx(a).cy(e)},size(a,e){let t;return a&&e||(t=this._element.bbox()),a||(a=t.width/t.height*e),e||(e=t.height/t.width*a),this.width(a).height(e)},width(a){return this._queueNumber("width",a)},height(a){return this._queueNumber("height",a)},plot(a,e,t,s){if(arguments.length===4)return this.plot([a,e,t,s]);if(this._tryRetarget("plot",a))return this;const c=new og(this._stepper).type(this._element.MorphArray).to(a);return this.queue(function(){c.from(this._element.array())},function(h){return this._element.plot(c.at(h)),c.done()}),this._rememberMorpher("plot",c),this},leading(a){return this._queueNumber("leading",a)},viewbox(a,e,t,s){return this._queueObject("viewbox",new yc(a,e,t,s))},update(a){return typeof a!="object"?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(a.opacity!=null&&this.attr("stop-opacity",a.opacity),a.color!=null&&this.attr("stop-color",a.color),a.offset!=null&&this.attr("offset",a.offset),this)}}),Gn(zh,{rx:ow,ry:aw,from:sT,to:oT}),fo(zh,"Runner");class n1 extends Nh{constructor(e,t=e){super(ta("svg",e),t),this.namespace()}defs(){return this.isRoot()?rd(this.node.querySelector("defs"))||this.put(new A_):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof Ao.window.SVGElement)&&this.node.parentNode.nodeName!=="#document-fragment"}namespace(){return this.isRoot()?this.attr({xmlns:tw,version:"1.1"}).attr("xmlns:xlink",bm,ib):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,ib).attr("xmlns:svgjs",null,ib)}root(){return this.isRoot()?this:super.root()}}zs({Container:{nested:ea(function(){return this.put(new n1)})}}),fo(n1,"Svg",!0);let s1=class extends Nh{constructor(a,e=a){super(ta("symbol",a),e)}};zs({Container:{symbol:ea(function(){return this.put(new s1)})}}),fo(s1,"Symbol");var dT=Object.freeze({__proto__:null,amove:function(a,e){return this.ax(a).ay(e)},ax:function(a){return this.attr("x",a)},ay:function(a){return this.attr("y",a)},build:function(a){return this._build=!!a,this},center:function(a,e,t=this.bbox()){return this.cx(a,t).cy(e,t)},cx:function(a,e=this.bbox()){return a==null?e.cx:this.attr("x",this.attr("x")+a-e.cx)},cy:function(a,e=this.bbox()){return a==null?e.cy:this.attr("y",this.attr("y")+a-e.cy)},length:function(){return this.node.getComputedTextLength()},move:function(a,e,t=this.bbox()){return this.x(a,t).y(e,t)},plain:function(a){return this._build===!1&&this.clear(),this.node.appendChild(Ao.document.createTextNode(a)),this},x:function(a,e=this.bbox()){return a==null?e.x:this.attr("x",this.attr("x")+a-e.x)},y:function(a,e=this.bbox()){return a==null?e.y:this.attr("y",this.attr("y")+a-e.y)}});class Yd extends jh{constructor(e,t=e){super(ta("text",e),t),this.dom.leading=this.dom.leading??new yo(1.3),this._rebuild=!0,this._build=!1}leading(e){return e==null?this.dom.leading:(this.dom.leading=new yo(e),this.rebuild())}rebuild(e){if(typeof e=="boolean"&&(this._rebuild=e),this._rebuild){const t=this;let s=0;const c=this.dom.leading;this.each(function(h){if($b(this.node))return;const A=Ao.window.getComputedStyle(this.node).getPropertyValue("font-size"),r=c*new yo(A);this.dom.newLined&&(this.attr("x",t.attr("x")),this.text()===`
`?s+=r:(this.attr("dy",h?r+s:0),s=0))}),this.fire("rebuild")}return this}setData(e){return this.dom=e,this.dom.leading=new yo(e.leading||1.3),this}writeDataToDom(){return jI(this,this.dom,{leading:1.3}),this}text(e){if(e===void 0){const t=this.node.childNodes;let s=0;e="";for(let c=0,h=t.length;c<h;++c)t[c].nodeName==="textPath"||$b(t[c])?c===0&&(s=c+1):(c!==s&&t[c].nodeType!==3&&rd(t[c]).dom.newLined===!0&&(e+=`
`),e+=t[c].textContent);return e}if(this.clear().build(!0),typeof e=="function")e.call(this,this);else for(let t=0,s=(e=(e+"").split(`
`)).length;t<s;t++)this.newLine(e[t]);return this.build(!1).rebuild()}}Gn(Yd,dT),zs({Container:{text:ea(function(a=""){return this.put(new Yd).text(a)}),plain:ea(function(a=""){return this.put(new Yd).plain(a)})}}),fo(Yd,"Text");class T0 extends jh{constructor(e,t=e){super(ta("tspan",e),t),this._build=!1}dx(e){return this.attr("dx",e)}dy(e){return this.attr("dy",e)}newLine(){this.dom.newLined=!0;const e=this.parent();if(!(e instanceof Yd))return this;const t=e.index(this),s=Ao.window.getComputedStyle(this.node).getPropertyValue("font-size"),c=e.dom.leading*new yo(s);return this.dy(t?c:0).attr("x",e.x())}text(e){return e==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof e=="function"?(this.clear().build(!0),e.call(this,this),this.build(!1)):this.plain(e),this)}}Gn(T0,dT),zs({Tspan:{tspan:ea(function(a=""){const e=new T0;return this._build||this.clear(),this.put(e).text(a)})},Text:{newLine:function(a=""){return this.tspan(a).newLine()}}}),fo(T0,"Tspan");class lb extends jh{constructor(e,t=e){super(ta("circle",e),t)}radius(e){return this.attr("r",e)}rx(e){return this.attr("r",e)}ry(e){return this.rx(e)}size(e){return this.radius(new yo(e).divide(2))}}Gn(lb,{x:ZI,y:JI,cx:eT,cy:tT,width:iT,height:rT}),zs({Container:{circle:ea(function(a=0){return this.put(new lb).size(a).move(0,0)})}}),fo(lb,"Circle");class cb extends Nh{constructor(e,t=e){super(ta("clipPath",e),t)}remove(){return this.targets().forEach(function(e){e.unclip()}),super.remove()}targets(){return Ig("svg [clip-path*="+this.id()+"]")}}zs({Container:{clip:ea(function(){return this.defs().put(new cb)})},Element:{clipper(){return this.reference("clip-path")},clipWith(a){const e=a instanceof cb?a:this.parent().clip().add(a);return this.attr("clip-path","url(#"+e.id()+")")},unclip(){return this.attr("clip-path",null)}}}),fo(cb,"ClipPath");class AE extends zc{constructor(e,t=e){super(ta("foreignObject",e),t)}}zs({Container:{foreignObject:ea(function(a,e){return this.put(new AE).size(a,e)})}}),fo(AE,"ForeignObject");var AT=Object.freeze({__proto__:null,dmove:function(a,e){return this.children().forEach(t=>{let s;try{s=t.node instanceof lv().SVGSVGElement?new yc(t.attr(["x","y","width","height"])):t.bbox()}catch{return}const c=new qs(t),h=c.translate(a,e).transform(c.inverse()),A=new Go(s.x,s.y).transform(h);t.move(A.x,A.y)}),this},dx:function(a){return this.dmove(a,0)},dy:function(a){return this.dmove(0,a)},height:function(a,e=this.bbox()){return a==null?e.height:this.size(e.width,a,e)},move:function(a=0,e=0,t=this.bbox()){const s=a-t.x,c=e-t.y;return this.dmove(s,c)},size:function(a,e,t=this.bbox()){const s=xm(this,a,e,t),c=s.width/t.width,h=s.height/t.height;return this.children().forEach(A=>{const r=new Go(t).transform(new qs(A).inverse());A.scale(c,h,r.x,r.y)}),this},width:function(a,e=this.bbox()){return a==null?e.width:this.size(a,e.height,e)},x:function(a,e=this.bbox()){return a==null?e.x:this.move(a,e.y,e)},y:function(a,e=this.bbox()){return a==null?e.y:this.move(e.x,a,e)}});class Cp extends Nh{constructor(e,t=e){super(ta("g",e),t)}}Gn(Cp,AT),zs({Container:{group:ea(function(){return this.put(new Cp)})}}),fo(Cp,"G");class d0 extends Nh{constructor(e,t=e){super(ta("a",e),t)}target(e){return this.attr("target",e)}to(e){return this.attr("href",e,bm)}}Gn(d0,AT),zs({Container:{link:ea(function(a){return this.put(new d0).to(a)})},Element:{unlink(){const a=this.linker();if(!a)return this;const e=a.parent();if(!e)return this.remove();const t=e.index(a);return e.add(this,t),a.remove(),this},linkTo(a){let e=this.linker();return e||(e=new d0,this.wrap(e)),typeof a=="function"?a.call(e,e):e.to(a),this},linker(){const a=this.parent();return a&&a.node.nodeName.toLowerCase()==="a"?a:null}}}),fo(d0,"A");class ub extends Nh{constructor(e,t=e){super(ta("mask",e),t)}remove(){return this.targets().forEach(function(e){e.unmask()}),super.remove()}targets(){return Ig("svg [mask*="+this.id()+"]")}}zs({Container:{mask:ea(function(){return this.defs().put(new ub)})},Element:{masker(){return this.reference("mask")},maskWith(a){const e=a instanceof ub?a:this.parent().mask().add(a);return this.attr("mask","url(#"+e.id()+")")},unmask(){return this.attr("mask",null)}}}),fo(ub,"Mask");class fE extends zc{constructor(e,t=e){super(ta("stop",e),t)}update(e){return(typeof e=="number"||e instanceof yo)&&(e={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),e.opacity!=null&&this.attr("stop-opacity",e.opacity),e.color!=null&&this.attr("stop-color",e.color),e.offset!=null&&this.attr("offset",new yo(e.offset)),this}}zs({Gradient:{stop:function(a,e,t){return this.put(new fE).update(a,e,t)}}}),fo(fE,"Stop");class hb extends zc{constructor(e,t=e){super(ta("style",e),t)}addText(e=""){return this.node.textContent+=e,this}font(e,t,s={}){return this.rule("@font-face",{fontFamily:e,src:t,...s})}rule(e,t){return this.addText(function(s,c){if(!s)return"";if(!c)return s;let h=s+"{";for(const A in c)h+=A.replace(/([A-Z])/g,function(r,y){return"-"+y.toLowerCase()})+":"+c[A]+";";return h+="}",h}(e,t))}}zs("Dom",{style(a,e){return this.put(new hb).rule(a,e)},fontface(a,e,t){return this.put(new hb).font(a,e,t)}}),fo(hb,"Style");class db extends Yd{constructor(e,t=e){super(ta("textPath",e),t)}array(){const e=this.track();return e?e.array():null}plot(e){const t=this.track();let s=null;return t&&(s=t.plot(e)),e==null?s:this}track(){return this.reference("href")}}zs({Container:{textPath:ea(function(a,e){return a instanceof Yd||(a=this.text(a)),a.path(e)})},Text:{path:ea(function(a,e=!0){const t=new db;let s;if(a instanceof lm||(a=this.defs().path(a)),t.attr("href","#"+a,bm),e)for(;s=this.node.firstChild;)t.node.appendChild(s);return this.put(t)}),textPath(){return this.findOne("textPath")}},Path:{text:ea(function(a){return a instanceof Yd||(a=new Yd().addTo(this.parent()).text(a)),a.path(this)}),targets(){return Ig("svg textPath").filter(a=>(a.attr("href")||"").includes(this.id()))}}}),db.prototype.MorphArray=Xd,fo(db,"TextPath");class pE extends jh{constructor(e,t=e){super(ta("use",e),t)}use(e,t){return this.attr("href",(t||"")+"#"+e,bm)}}zs({Container:{use:ea(function(a,e){return this.put(new pE).use(a,e)})}}),fo(pE,"Use");const xD=Ru;Gn([n1,s1,S0,Xy,E0],sh("viewbox")),Gn([cg,hg,ug,lm],sh("marker")),Gn(Yd,sh("Text")),Gn(lm,sh("Path")),Gn(A_,sh("Defs")),Gn([Yd,T0],sh("Tspan")),Gn([I0,C0,Fy,zh],sh("radius")),Gn(cv,sh("EventTarget")),Gn(fm,sh("Dom")),Gn(zc,sh("Element")),Gn(jh,sh("Shape")),Gn([Nh,nT],sh("Container")),Gn(Fy,sh("Gradient")),Gn(zh,sh("Runner")),wg.extend([...new Set(zI)]),function(a=[]){r1.push(...[].concat(a))}([yo,KA,yc,qs,Bg,Lp,Xd,Go]),Gn(r1,{to(a){return new og().type(this.constructor).from(this.toArray()).to(a)},fromArray(a){return this.init(a),this},toConsumable(){return this.toArray()},morph(a,e,t,s,c){return this.fromArray(a.map(function(h,A){return s.step(h,e[A],t,c[A],c)}))}});class xa extends zc{constructor(e){super(ta("filter",e),e),this.$source="SourceGraphic",this.$sourceAlpha="SourceAlpha",this.$background="BackgroundImage",this.$backgroundAlpha="BackgroundAlpha",this.$fill="FillPaint",this.$stroke="StrokePaint",this.$autoSetIn=!0}put(e,t){return!(e=super.put(e,t)).attr("in")&&this.$autoSetIn&&e.attr("in",this.$source),e.attr("result")||e.attr("result",e.id()),e}remove(){return this.targets().each("unfilter"),super.remove()}targets(){return Ig('svg [filter*="'+this.id()+'"]')}toString(){return"url(#"+this.id()+")"}}class uw extends zc{constructor(e,t){super(e,t),this.result(this.id())}in(e){if(e==null){const t=this.attr("in");return this.parent()&&this.parent().find(`[result="${t}"]`)[0]||t}return this.attr("in",e)}result(e){return this.attr("result",e)}toString(){return this.result()}}const id=a=>function(...e){for(let t=a.length;t--;)e[t]!=null&&this.attr(a[t],e[t])},bD={blend:id(["in","in2","mode"]),colorMatrix:id(["type","values"]),composite:id(["in","in2","operator"]),convolveMatrix:function(a){a=new Bg(a).toString(),this.attr({order:Math.sqrt(a.split(" ").length),kernelMatrix:a})},diffuseLighting:id(["surfaceScale","lightingColor","diffuseConstant","kernelUnitLength"]),displacementMap:id(["in","in2","scale","xChannelSelector","yChannelSelector"]),dropShadow:id(["in","dx","dy","stdDeviation"]),flood:id(["flood-color","flood-opacity"]),gaussianBlur:function(a=0,e=a){this.attr("stdDeviation",a+" "+e)},image:function(a){this.attr("href",a,bm)},morphology:id(["operator","radius"]),offset:id(["dx","dy"]),specularLighting:id(["surfaceScale","lightingColor","diffuseConstant","specularExponent","kernelUnitLength"]),tile:id([]),turbulence:id(["baseFrequency","numOctaves","seed","stitchTiles","type"])};["blend","colorMatrix","componentTransfer","composite","convolveMatrix","diffuseLighting","displacementMap","dropShadow","flood","gaussianBlur","image","merge","morphology","offset","specularLighting","tile","turbulence"].forEach(a=>{const e=_m(a),t=bD[a];xa[e+"Effect"]=class extends uw{constructor(s){super(ta("fe"+e,s),s)}update(s){return t.apply(this,s),this}},xa.prototype[a]=ea(function(s,...c){const h=new xa[e+"Effect"];return s==null?this.put(h):(typeof s=="function"?s.call(h,h):c.unshift(s),this.put(h).update(c))})}),Gn(xa,{merge(a){const e=this.put(new xa.MergeEffect);return typeof a=="function"?(a.call(e,e),e):((a instanceof Array?a:[...arguments]).forEach(t=>{t instanceof xa.MergeNode?e.put(t):e.mergeNode(t)}),e)},componentTransfer(a={}){const e=this.put(new xa.ComponentTransferEffect);if(typeof a=="function")return a.call(e,e),e;a.r||a.g||a.b||a.a||(a={r:a,g:a,b:a,a});for(const t in a)e.add(new xa["Func"+t.toUpperCase()](a[t]));return e}});["distantLight","pointLight","spotLight","mergeNode","FuncR","FuncG","FuncB","FuncA"].forEach(a=>{const e=_m(a);xa[e]=class extends uw{constructor(t){super(ta("fe"+e,t),t)}}});["funcR","funcG","funcB","funcA"].forEach(function(a){const e=xa[_m(a)],t=ea(function(){return this.put(new e)});xa.ComponentTransferEffect.prototype[a]=t});["distantLight","pointLight","spotLight"].forEach(a=>{const e=xa[_m(a)],t=ea(function(){return this.put(new e)});xa.DiffuseLightingEffect.prototype[a]=t,xa.SpecularLightingEffect.prototype[a]=t}),Gn(xa.MergeEffect,{mergeNode(a){return this.put(new xa.MergeNode).attr("in",a)}}),Gn(A_,{filter:function(a){const e=this.put(new xa);return typeof a=="function"&&a.call(e,e),e}}),Gn(Nh,{filter:function(a){return this.defs().filter(a)}}),Gn(zc,{filterWith:function(a){const e=a instanceof xa?a:this.defs().filter(a);return this.attr("filter",e)},unfilter:function(a){return this.attr("filter",null)},filterer(){return this.reference("filter")}});const wD={blend:function(a,e){return this.parent()&&this.parent().blend(this,a,e)},colorMatrix:function(a,e){return this.parent()&&this.parent().colorMatrix(a,e).in(this)},componentTransfer:function(a){return this.parent()&&this.parent().componentTransfer(a).in(this)},composite:function(a,e){return this.parent()&&this.parent().composite(this,a,e)},convolveMatrix:function(a){return this.parent()&&this.parent().convolveMatrix(a).in(this)},diffuseLighting:function(a,e,t,s){return this.parent()&&this.parent().diffuseLighting(a,t,s).in(this)},displacementMap:function(a,e,t,s){return this.parent()&&this.parent().displacementMap(this,a,e,t,s)},dropShadow:function(a,e,t){return this.parent()&&this.parent().dropShadow(this,a,e,t).in(this)},flood:function(a,e){return this.parent()&&this.parent().flood(a,e)},gaussianBlur:function(a,e){return this.parent()&&this.parent().gaussianBlur(a,e).in(this)},image:function(a){return this.parent()&&this.parent().image(a)},merge:function(a){return a=a instanceof Array?a:[...a],this.parent()&&this.parent().merge(this,...a)},morphology:function(a,e){return this.parent()&&this.parent().morphology(a,e).in(this)},offset:function(a,e){return this.parent()&&this.parent().offset(a,e).in(this)},specularLighting:function(a,e,t,s,c){return this.parent()&&this.parent().specularLighting(a,t,s,c).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(a,e,t,s,c){return this.parent()&&this.parent().turbulence(a,e,t,s,c).in(this)}};Gn(uw,wD),Gn(xa.MergeEffect,{in:function(a){return a instanceof xa.MergeNode?this.add(a,0):this.add(new xa.MergeNode().in(a),0),this}}),Gn([xa.CompositeEffect,xa.BlendEffect,xa.DisplacementMapEffect],{in2:function(a){if(a==null){const e=this.attr("in2");return this.parent()&&this.parent().find(`[result="${e}"]`)[0]||e}return this.attr("in2",a)}}),xa.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]};var Uc=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getDefaultFilter",value:function(e,t){var s=this.w;e.unfilter(!0),new xa().size("120%","180%","-5%","-40%"),s.config.chart.dropShadow.enabled&&this.dropShadow(e,s.config.chart.dropShadow,t)}},{key:"applyFilter",value:function(e,t,s){var c,h=this,A=this.w;if(e.unfilter(!0),s!=="none"){var r,y,b=A.config.chart.dropShadow,_=s==="lighten"?2:.3;e.filterWith(function(B){B.colorMatrix({type:"matrix",values:`
          `.concat(_,` 0 0 0 0
          0 `).concat(_,` 0 0 0
          0 0 `).concat(_,` 0 0
          0 0 0 1 0
        `),in:"SourceGraphic",result:"brightness"}),b.enabled&&h.addShadow(B,t,b,"brightness")}),!b.noUserSpaceOnUse&&((r=e.filterer())===null||r===void 0||(y=r.node)===null||y===void 0||y.setAttribute("filterUnits","userSpaceOnUse")),this._scaleFilterSize((c=e.filterer())===null||c===void 0?void 0:c.node)}else this.getDefaultFilter(e,t)}},{key:"addShadow",value:function(e,t,s,c){var h,A=this.w,r=s.blur,y=s.top,b=s.left,_=s.color,B=s.opacity;if(_=Array.isArray(_)?_[t]:_,((h=A.config.chart.dropShadow.enabledOnSeries)===null||h===void 0?void 0:h.length)>0&&A.config.chart.dropShadow.enabledOnSeries.indexOf(t)===-1)return e;e.offset({in:c,dx:b,dy:y,result:"offset"}),e.gaussianBlur({in:"offset",stdDeviation:r,result:"blur"}),e.flood({"flood-color":_,"flood-opacity":B,result:"flood"}),e.composite({in:"flood",in2:"blur",operator:"in",result:"shadow"}),e.merge(["shadow",c])}},{key:"dropShadow",value:function(e,t){var s,c,h,A,r,y=this,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,_=this.w;return e.unfilter(!0),ni.isMsEdge()&&_.config.chart.type==="radialBar"||((s=_.config.chart.dropShadow.enabledOnSeries)===null||s===void 0?void 0:s.length)>0&&((h=_.config.chart.dropShadow.enabledOnSeries)===null||h===void 0?void 0:h.indexOf(b))===-1?e:(e.filterWith(function(B){y.addShadow(B,b,t,"SourceGraphic")}),t.noUserSpaceOnUse||(A=e.filterer())===null||A===void 0||(r=A.node)===null||r===void 0||r.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize((c=e.filterer())===null||c===void 0?void 0:c.node),e)}},{key:"setSelectionFilter",value:function(e,t,s){var c=this.w;if(c.globals.selectedDataPoints[t]!==void 0&&c.globals.selectedDataPoints[t].indexOf(s)>-1){e.node.setAttribute("selected",!0);var h=c.config.states.active.filter;h!=="none"&&this.applyFilter(e,t,h.type)}}},{key:"_scaleFilterSize",value:function(e){e&&function(t){for(var s in t)t.hasOwnProperty(s)&&e.setAttribute(s,t[s])}({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}]),a}(),hr=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"roundPathCorners",value:function(e,t){function s(le,be,we){var oe=be.x-le.x,me=be.y-le.y,Le=Math.sqrt(oe*oe+me*me);return c(le,be,Math.min(1,we/Le))}function c(le,be,we){return{x:le.x+(be.x-le.x)*we,y:le.y+(be.y-le.y)*we}}function h(le,be){le.length>2&&(le[le.length-2]=be.x,le[le.length-1]=be.y)}function A(le){return{x:parseFloat(le[le.length-2]),y:parseFloat(le[le.length-1])}}e.indexOf("NaN")>-1&&(e="");var r=e.split(/[,\s]/).reduce(function(le,be){var we=be.match(/^([a-zA-Z])(.+)/);return we?(le.push(we[1]),le.push(we[2])):le.push(be),le},[]).reduce(function(le,be){return parseFloat(be)==be&&le.length?le[le.length-1].push(be):le.push([be]),le},[]),y=[];if(r.length>1){var b=A(r[0]),_=null;r[r.length-1][0]=="Z"&&r[0].length>2&&(_=["L",b.x,b.y],r[r.length-1]=_),y.push(r[0]);for(var B=1;B<r.length;B++){var I=y[y.length-1],E=r[B],R=E==_?r[1]:r[B+1];if(R&&I&&I.length>2&&E[0]=="L"&&R.length>2&&R[0]=="L"){var M,G,U=A(I),Q=A(E),q=A(R);M=s(Q,U,t),G=s(Q,q,t),h(E,M),E.origPoint=Q,y.push(E);var ne=c(M,Q,.5),re=c(Q,G,.5),pe=["C",ne.x,ne.y,re.x,re.y,G.x,G.y];pe.origPoint=Q,y.push(pe)}else y.push(E)}if(_){var Ae=A(y[y.length-1]);y.push(["Z"]),h(y[0],Ae)}}else y=r;return y.reduce(function(le,be){return le+be.join(" ")+" "},"")}},{key:"drawLine",value:function(e,t,s,c){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"#a8a8a8",A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"butt";return this.w.globals.dom.Paper.line().attr({x1:e,y1:t,x2:s,y2:c,stroke:h,"stroke-dasharray":A,"stroke-width":r,"stroke-linecap":y})}},{key:"drawRect",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"#fefefe",r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1,y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,b=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,_=arguments.length>9&&arguments[9]!==void 0?arguments[9]:0,B=this.w.globals.dom.Paper.rect();return B.attr({x:e,y:t,width:s>0?s:0,height:c>0?c:0,rx:h,ry:h,opacity:r,"stroke-width":y!==null?y:0,stroke:b!==null?b:"none","stroke-dasharray":_}),B.node.setAttribute("fill",A),B}},{key:"drawPolygon",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#e1e1e1",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none";return this.w.globals.dom.Paper.polygon(e).attr({fill:c,stroke:t,"stroke-width":s})}},{key:"drawCircle",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e<0&&(e=0);var s=this.w.globals.dom.Paper.circle(2*e);return t!==null&&s.attr(t),s}},{key:"drawPath",value:function(e){var t=e.d,s=t===void 0?"":t,c=e.stroke,h=c===void 0?"#a8a8a8":c,A=e.strokeWidth,r=A===void 0?1:A,y=e.fill,b=e.fillOpacity,_=b===void 0?1:b,B=e.strokeOpacity,I=B===void 0?1:B,E=e.classes,R=e.strokeLinecap,M=R===void 0?null:R,G=e.strokeDashArray,U=G===void 0?0:G,Q=this.w;return M===null&&(M=Q.config.stroke.lineCap),(s.indexOf("undefined")>-1||s.indexOf("NaN")>-1)&&(s="M 0 ".concat(Q.globals.gridHeight)),Q.globals.dom.Paper.path(s).attr({fill:y,"fill-opacity":_,stroke:h,"stroke-opacity":I,"stroke-linecap":M,"stroke-width":r,"stroke-dasharray":U,class:E})}},{key:"group",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this.w.globals.dom.Paper.group();return e!==null&&t.attr(e),t}},{key:"move",value:function(e,t){var s=["M",e,t].join(" ");return s}},{key:"line",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=null;return s===null?c=[" L",e,t].join(" "):s==="H"?c=[" H",e].join(" "):s==="V"&&(c=[" V",t].join(" ")),c}},{key:"curve",value:function(e,t,s,c,h,A){var r=["C",e,t,s,c,h,A].join(" ");return r}},{key:"quadraticCurve",value:function(e,t,s,c){return["Q",e,t,s,c].join(" ")}},{key:"arc",value:function(e,t,s,c,h,A,r){var y="A";arguments.length>7&&arguments[7]!==void 0&&arguments[7]&&(y="a");var b=[y,e,t,s,c,h,A,r].join(" ");return b}},{key:"renderPaths",value:function(e){var t,s=e.j,c=e.realIndex,h=e.pathFrom,A=e.pathTo,r=e.stroke,y=e.strokeWidth,b=e.strokeLinecap,_=e.fill,B=e.animationDelay,I=e.initialSpeed,E=e.dataChangeSpeed,R=e.className,M=e.chartType,G=e.shouldClipToGrid,U=G===void 0||G,Q=e.bindEventsOnPaths,q=Q===void 0||Q,ne=e.drawShadow,re=ne===void 0||ne,pe=this.w,Ae=new Uc(this.ctx),le=new vm(this.ctx),be=this.w.config.chart.animations.enabled,we=be&&this.w.config.chart.animations.dynamicAnimation.enabled;if(h&&h.startsWith("M 0 0")&&A){var oe=A.match(/^M\s+[\d.-]+\s+[\d.-]+/);oe&&(h=h.replace(/^M\s+0\s+0/,oe[0]))}var me=!!(be&&!pe.globals.resized||we&&pe.globals.dataChanged&&pe.globals.shouldAnimate);me?t=h:(t=A,pe.globals.animationEnded=!0);var Le=pe.config.stroke.dashArray,Se=0;Se=Array.isArray(Le)?Le[c]:pe.config.stroke.dashArray;var Me=this.drawPath({d:t,stroke:r,strokeWidth:y,fill:_,fillOpacity:1,classes:R,strokeLinecap:b,strokeDashArray:Se});Me.attr("index",c),U&&(M==="bar"&&!pe.globals.isHorizontal||pe.globals.comboCharts?Me.attr({"clip-path":"url(#gridRectBarMask".concat(pe.globals.cuid,")")}):Me.attr({"clip-path":"url(#gridRectMask".concat(pe.globals.cuid,")")})),pe.config.chart.dropShadow.enabled&&re&&Ae.dropShadow(Me,pe.config.chart.dropShadow,c),q&&(Me.node.addEventListener("mouseenter",this.pathMouseEnter.bind(this,Me)),Me.node.addEventListener("mouseleave",this.pathMouseLeave.bind(this,Me)),Me.node.addEventListener("mousedown",this.pathMouseDown.bind(this,Me))),Me.attr({pathTo:A,pathFrom:h});var Re={el:Me,j:s,realIndex:c,pathFrom:h,pathTo:A,fill:_,strokeWidth:y,delay:B};return!be||pe.globals.resized||pe.globals.dataChanged?!pe.globals.resized&&pe.globals.dataChanged||le.showDelayedElements():le.animatePathsGradually(Ir(Ir({},Re),{},{speed:I})),pe.globals.dataChanged&&we&&me&&le.animatePathsGradually(Ir(Ir({},Re),{},{speed:E})),Me}},{key:"drawPattern",value:function(e,t,s){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"#a8a8a8",h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;return this.w.globals.dom.Paper.pattern(t,s,function(A){e==="horizontalLines"?A.line(0,0,s,0).stroke({color:c,width:h+1}):e==="verticalLines"?A.line(0,0,0,t).stroke({color:c,width:h+1}):e==="slantedLines"?A.line(0,0,t,s).stroke({color:c,width:h}):e==="squares"?A.rect(t,s).fill("none").stroke({color:c,width:h}):e==="circles"&&A.circle(t).fill("none").stroke({color:c,width:h})})}},{key:"drawGradient",value:function(e,t,s,c,h){var A,r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,b=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],_=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0,B=this.w;t.length<9&&t.indexOf("#")===0&&(t=ni.hexToRgba(t,c)),s.length<9&&s.indexOf("#")===0&&(s=ni.hexToRgba(s,h));var I=0,E=1,R=1,M=null;y!==null&&(I=y[0]!==void 0?y[0]/100:0,E=y[1]!==void 0?y[1]/100:1,R=y[2]!==void 0?y[2]/100:1,M=y[3]!==void 0?y[3]/100:null);var G=!(B.config.chart.type!=="donut"&&B.config.chart.type!=="pie"&&B.config.chart.type!=="polarArea"&&B.config.chart.type!=="bubble");if(A=b&&b.length!==0?B.globals.dom.Paper.gradient(G?"radial":"linear",function(q){(Array.isArray(b[_])?b[_]:b).forEach(function(ne){q.stop(ne.offset/100,ne.color,ne.opacity)})}):B.globals.dom.Paper.gradient(G?"radial":"linear",function(q){q.stop(I,t,c),q.stop(E,s,h),q.stop(R,s,h),M!==null&&q.stop(M,t,c)}),G){var U=B.globals.gridWidth/2,Q=B.globals.gridHeight/2;B.config.chart.type!=="bubble"?A.attr({gradientUnits:"userSpaceOnUse",cx:U,cy:Q,r}):A.attr({cx:.5,cy:.5,r:.8,fx:.2,fy:.2})}else e==="vertical"?A.from(0,0).to(0,1):e==="diagonal"?A.from(0,0).to(1,1):e==="horizontal"?A.from(0,1).to(1,1):e==="diagonal2"&&A.from(1,0).to(0,1);return A}},{key:"getTextBasedOnMaxWidth",value:function(e){var t=e.text,s=e.maxWidth,c=e.fontSize,h=e.fontFamily,A=this.getTextRects(t,c,h),r=A.width/t.length,y=Math.floor(s/r);return s<A.width?t.slice(0,y-3)+"...":t}},{key:"drawText",value:function(e){var t=this,s=e.x,c=e.y,h=e.text,A=e.textAnchor,r=e.fontSize,y=e.fontFamily,b=e.fontWeight,_=e.foreColor,B=e.opacity,I=e.maxWidth,E=e.cssClass,R=E===void 0?"":E,M=e.isPlainText,G=M===void 0||M,U=e.dominantBaseline,Q=U===void 0?"auto":U,q=this.w;h===void 0&&(h="");var ne=h;A||(A="start"),_&&_.length||(_=q.config.chart.foreColor),y=y||q.config.chart.fontFamily,b=b||"regular";var re,pe={maxWidth:I,fontSize:r=r||"11px",fontFamily:y};return Array.isArray(h)?re=q.globals.dom.Paper.text(function(Ae){for(var le=0;le<h.length;le++)ne=h[le],I&&(ne=t.getTextBasedOnMaxWidth(Ir({text:h[le]},pe))),le===0?Ae.tspan(ne):Ae.tspan(ne).newLine()}):(I&&(ne=this.getTextBasedOnMaxWidth(Ir({text:h},pe))),re=G?q.globals.dom.Paper.plain(h):q.globals.dom.Paper.text(function(Ae){return Ae.tspan(ne)})),re.attr({x:s,y:c,"text-anchor":A,"dominant-baseline":Q,"font-size":r,"font-family":y,"font-weight":b,fill:_,class:"apexcharts-text "+R}),re.node.style.fontFamily=y,re.node.style.opacity=B,re}},{key:"getMarkerPath",value:function(e,t,s,c){var h="";switch(s){case"cross":h="M ".concat(e-(c/=1.4)," ").concat(t-c," L ").concat(e+c," ").concat(t+c,"  M ").concat(e-c," ").concat(t+c," L ").concat(e+c," ").concat(t-c);break;case"plus":h="M ".concat(e-(c/=1.12)," ").concat(t," L ").concat(e+c," ").concat(t,"  M ").concat(e," ").concat(t-c," L ").concat(e," ").concat(t+c);break;case"star":case"sparkle":var A=5;c*=1.15,s==="sparkle"&&(c/=1.1,A=4);for(var r=Math.PI/A,y=0;y<=2*A;y++){var b=y*r,_=y%2==0?c:c/2;h+=(y===0?"M":"L")+(e+_*Math.sin(b))+","+(t-_*Math.cos(b))}h+="Z";break;case"triangle":h="M ".concat(e," ").concat(t-c,` 
             L `).concat(e+c," ").concat(t+c,` 
             L `).concat(e-c," ").concat(t+c,` 
             Z`);break;case"square":case"rect":h="M ".concat(e-(c/=1.125)," ").concat(t-c,` 
           L `).concat(e+c," ").concat(t-c,` 
           L `).concat(e+c," ").concat(t+c,` 
           L `).concat(e-c," ").concat(t+c,` 
           Z`);break;case"diamond":c*=1.05,h="M ".concat(e," ").concat(t-c,` 
             L `).concat(e+c," ").concat(t,` 
             L `).concat(e," ").concat(t+c,` 
             L `).concat(e-c," ").concat(t,` 
            Z`);break;case"line":h="M ".concat(e-(c/=1.1)," ").concat(t,` 
           L `).concat(e+c," ").concat(t);break;default:c*=2,h="M ".concat(e,", ").concat(t,` 
           m -`).concat(c/2,`, 0 
           a `).concat(c/2,",").concat(c/2," 0 1,0 ").concat(c,`,0 
           a `).concat(c/2,",").concat(c/2," 0 1,0 -").concat(c,",0")}return h}},{key:"drawMarkerShape",value:function(e,t,s,c,h){var A=this.drawPath({d:this.getMarkerPath(e,t,s,c,h),stroke:h.pointStrokeColor,strokeDashArray:h.pointStrokeDashArray,strokeWidth:h.pointStrokeWidth,fill:h.pointFillColor,fillOpacity:h.pointFillOpacity,strokeOpacity:h.pointStrokeOpacity});return A.attr({cx:e,cy:t,shape:h.shape,class:h.class?h.class:""}),A}},{key:"drawMarker",value:function(e,t,s){e=e||0;var c=s.pSize||0;return ni.isNumber(t)||(c=0,t=0),this.drawMarkerShape(e,t,s==null?void 0:s.shape,c,Ir(Ir({},s),s.shape==="line"||s.shape==="plus"||s.shape==="cross"?{pointStrokeColor:s.pointFillColor,pointStrokeOpacity:s.pointFillOpacity}:{}))}},{key:"pathMouseEnter",value:function(e,t){var s=this.w,c=new Uc(this.ctx),h=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10);if(typeof s.config.chart.events.dataPointMouseEnter=="function"&&s.config.chart.events.dataPointMouseEnter(t,this.ctx,{seriesIndex:h,dataPointIndex:A,w:s}),this.ctx.events.fireEvent("dataPointMouseEnter",[t,this.ctx,{seriesIndex:h,dataPointIndex:A,w:s}]),(s.config.states.active.filter.type==="none"||e.node.getAttribute("selected")!=="true")&&s.config.states.hover.filter.type!=="none"&&!s.globals.isTouchDevice){var r=s.config.states.hover.filter;c.applyFilter(e,h,r.type)}}},{key:"pathMouseLeave",value:function(e,t){var s=this.w,c=new Uc(this.ctx),h=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10);typeof s.config.chart.events.dataPointMouseLeave=="function"&&s.config.chart.events.dataPointMouseLeave(t,this.ctx,{seriesIndex:h,dataPointIndex:A,w:s}),this.ctx.events.fireEvent("dataPointMouseLeave",[t,this.ctx,{seriesIndex:h,dataPointIndex:A,w:s}]),s.config.states.active.filter.type!=="none"&&e.node.getAttribute("selected")==="true"||s.config.states.hover.filter.type!=="none"&&c.getDefaultFilter(e,h)}},{key:"pathMouseDown",value:function(e,t){var s=this.w,c=new Uc(this.ctx),h=parseInt(e.node.getAttribute("index"),10),A=parseInt(e.node.getAttribute("j"),10),r="false";if(e.node.getAttribute("selected")==="true"){if(e.node.setAttribute("selected","false"),s.globals.selectedDataPoints[h].indexOf(A)>-1){var y=s.globals.selectedDataPoints[h].indexOf(A);s.globals.selectedDataPoints[h].splice(y,1)}}else{if(!s.config.states.active.allowMultipleDataPointsSelection&&s.globals.selectedDataPoints.length>0){s.globals.selectedDataPoints=[];var b=s.globals.dom.Paper.find(".apexcharts-series path:not(.apexcharts-decoration-element)"),_=s.globals.dom.Paper.find(".apexcharts-series circle:not(.apexcharts-decoration-element), .apexcharts-series rect:not(.apexcharts-decoration-element)"),B=function(R){Array.prototype.forEach.call(R,function(M){M.node.setAttribute("selected","false"),c.getDefaultFilter(M,h)})};B(b),B(_)}e.node.setAttribute("selected","true"),r="true",s.globals.selectedDataPoints[h]===void 0&&(s.globals.selectedDataPoints[h]=[]),s.globals.selectedDataPoints[h].push(A)}if(r==="true"){var I=s.config.states.active.filter;if(I!=="none")c.applyFilter(e,h,I.type);else if(s.config.states.hover.filter!=="none"&&!s.globals.isTouchDevice){var E=s.config.states.hover.filter;c.applyFilter(e,h,E.type)}}else s.config.states.active.filter.type!=="none"&&(s.config.states.hover.filter.type==="none"||s.globals.isTouchDevice?c.getDefaultFilter(e,h):(E=s.config.states.hover.filter,c.applyFilter(e,h,E.type)));typeof s.config.chart.events.dataPointSelection=="function"&&s.config.chart.events.dataPointSelection(t,this.ctx,{selectedDataPoints:s.globals.selectedDataPoints,seriesIndex:h,dataPointIndex:A,w:s}),t&&this.ctx.events.fireEvent("dataPointSelection",[t,this.ctx,{selectedDataPoints:s.globals.selectedDataPoints,seriesIndex:h,dataPointIndex:A,w:s}])}},{key:"rotateAroundCenter",value:function(e){var t={};return e&&typeof e.getBBox=="function"&&(t=e.getBBox()),{x:t.x+t.width/2,y:t.y+t.height/2}}},{key:"getTextRects",value:function(e,t,s,c){var h=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],A=this.w,r=this.drawText({x:-200,y:-200,text:e,textAnchor:"start",fontSize:t,fontFamily:s,foreColor:"#fff",opacity:0});c&&r.attr("transform",c),A.globals.dom.Paper.add(r);var y=r.bbox();return h||(y=r.node.getBoundingClientRect()),r.remove(),{width:y.width,height:y.height}}},{key:"placeTextWithEllipsis",value:function(e,t,s){if(typeof e.getComputedTextLength=="function"&&(e.textContent=t,t.length>0&&e.getComputedTextLength()>=s/1.1)){for(var c=t.length-3;c>0;c-=3)if(e.getSubStringLength(0,c)<=s/1.1)return void(e.textContent=t.substring(0,c)+"...");e.textContent="."}}}],[{key:"setAttrs",value:function(e,t){for(var s in t)t.hasOwnProperty(s)&&e.setAttribute(s,t[s])}}]),a}(),sl=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getStackedSeriesTotals",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.w,s=[];if(t.globals.series.length===0)return s;for(var c=0;c<t.globals.series[t.globals.maxValsInArrayIndex].length;c++){for(var h=0,A=0;A<t.globals.series.length;A++)t.globals.series[A][c]!==void 0&&e.indexOf(A)===-1&&(h+=t.globals.series[A][c]);s.push(h)}return s}},{key:"getSeriesTotalByIndex",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e===null?this.w.config.series.reduce(function(t,s){return t+s},0):this.w.globals.series[e].reduce(function(t,s){return t+s},0)}},{key:"getStackedSeriesTotalsByGroups",value:function(){var e=this,t=this.w,s=[];return t.globals.seriesGroups.forEach(function(c){var h=[];t.config.series.forEach(function(r,y){c.indexOf(t.globals.seriesNames[y])>-1&&h.push(y)});var A=t.globals.series.map(function(r,y){return h.indexOf(y)===-1?y:-1}).filter(function(r){return r!==-1});s.push(e.getStackedSeriesTotals(A))}),s}},{key:"setSeriesYAxisMappings",value:function(){var e=this.w.globals,t=this.w.config,s=[],c=[],h=[],A=e.series.length>t.yaxis.length||t.yaxis.some(function(B){return Array.isArray(B.seriesName)});t.series.forEach(function(B,I){h.push(I),c.push(null)}),t.yaxis.forEach(function(B,I){s[I]=[]});var r=[];t.yaxis.forEach(function(B,I){var E=!1;if(B.seriesName){var R=[];Array.isArray(B.seriesName)?R=B.seriesName:R.push(B.seriesName),R.forEach(function(M){t.series.forEach(function(G,U){if(G.name===M){var Q=U;I===U||A?!A||h.indexOf(U)>-1?s[I].push([I,U]):console.warn("Series '"+G.name+"' referenced more than once in what looks like the new style. That is, when using either seriesName: [], or when there are more series than yaxes."):(s[U].push([U,I]),Q=I),E=!0,(Q=h.indexOf(Q))!==-1&&h.splice(Q,1)}})})}E||r.push(I)}),s=s.map(function(B,I){var E=[];return B.forEach(function(R){c[R[1]]=R[0],E.push(R[1])}),E});for(var y=t.yaxis.length-1,b=0;b<r.length&&(y=r[b],s[y]=[],h);b++){var _=h[0];h.shift(),s[y].push(_),c[_]=y}h.forEach(function(B){s[y].push(B),c[B]=y}),e.seriesYAxisMap=s.map(function(B){return B}),e.seriesYAxisReverseMap=c.map(function(B){return B}),e.seriesYAxisMap.forEach(function(B,I){B.forEach(function(E){t.series[E]&&t.series[E].group===void 0&&(t.series[E].group="apexcharts-axis-".concat(I.toString()))})})}},{key:"isSeriesNull",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return(e===null?this.w.config.series.filter(function(t){return t!==null}):this.w.config.series[e].data.filter(function(t){return t!==null})).length===0}},{key:"seriesHaveSameValues",value:function(e){return this.w.globals.series[e].every(function(t,s,c){return t===c[0]})}},{key:"getCategoryLabels",value:function(e){var t=this.w,s=e.slice();return t.config.xaxis.convertedCatToNumeric&&(s=e.map(function(c,h){return t.config.xaxis.labels.formatter(c-t.globals.minX+1)})),s}},{key:"getLargestSeries",value:function(){var e=this.w;e.globals.maxValsInArrayIndex=e.globals.series.map(function(t){return t.length}).indexOf(Math.max.apply(Math,e.globals.series.map(function(t){return t.length})))}},{key:"getLargestMarkerSize",value:function(){var e=this.w,t=0;return e.globals.markers.size.forEach(function(s){t=Math.max(t,s)}),e.config.markers.discrete&&e.config.markers.discrete.length&&e.config.markers.discrete.forEach(function(s){t=Math.max(t,s.size)}),t>0&&(e.config.markers.hover.size>0?t=e.config.markers.hover.size:t+=e.config.markers.hover.sizeOffset),e.globals.markers.largestSize=t,t}},{key:"getSeriesTotals",value:function(){var e=this.w;e.globals.seriesTotals=e.globals.series.map(function(t,s){var c=0;if(Array.isArray(t))for(var h=0;h<t.length;h++)c+=t[h];else c+=t;return c})}},{key:"getSeriesTotalsXRange",value:function(e,t){var s=this.w;return s.globals.series.map(function(c,h){for(var A=0,r=0;r<c.length;r++)s.globals.seriesX[h][r]>e&&s.globals.seriesX[h][r]<t&&(A+=c[r]);return A})}},{key:"getPercentSeries",value:function(){var e=this.w;e.globals.seriesPercent=e.globals.series.map(function(t,s){var c=[];if(Array.isArray(t))for(var h=0;h<t.length;h++){var A=e.globals.stackedSeriesTotals[h],r=0;A&&(r=100*t[h]/A),c.push(r)}else{var y=100*t/e.globals.seriesTotals.reduce(function(b,_){return b+_},0);c.push(y)}return c})}},{key:"getCalculatedRatios",value:function(){var e,t,s,c=this,h=this.w,A=h.globals,r=[],y=0,b=[],_=.1,B=0;if(A.yRange=[],A.isMultipleYAxis)for(var I=0;I<A.minYArr.length;I++)A.yRange.push(Math.abs(A.minYArr[I]-A.maxYArr[I])),b.push(0);else A.yRange.push(Math.abs(A.minY-A.maxY));A.xRange=Math.abs(A.maxX-A.minX),A.zRange=Math.abs(A.maxZ-A.minZ);for(var E=0;E<A.yRange.length;E++)r.push(A.yRange[E]/A.gridHeight);if(t=A.xRange/A.gridWidth,e=A.yRange/A.gridWidth,s=A.xRange/A.gridHeight,(y=A.zRange/A.gridHeight*16)||(y=1),A.minY!==Number.MIN_VALUE&&Math.abs(A.minY)!==0&&(A.hasNegs=!0),h.globals.seriesYAxisReverseMap.length>0){var R=function(G,U){var Q=h.config.yaxis[h.globals.seriesYAxisReverseMap[U]],q=G<0?-1:1;return G=Math.abs(G),Q.logarithmic&&(G=c.getBaseLog(Q.logBase,G)),-q*G/r[U]};if(A.isMultipleYAxis){b=[];for(var M=0;M<r.length;M++)b.push(R(A.minYArr[M],M))}else(b=[]).push(R(A.minY,0)),A.minY!==Number.MIN_VALUE&&Math.abs(A.minY)!==0&&(_=-A.minY/e,B=A.minX/t)}else(b=[]).push(0),_=0,B=0;return{yRatio:r,invertedYRatio:e,zRatio:y,xRatio:t,invertedXRatio:s,baseLineInvertedY:_,baseLineY:b,baseLineX:B}}},{key:"getLogSeries",value:function(e){var t=this,s=this.w;return s.globals.seriesLog=e.map(function(c,h){var A=s.globals.seriesYAxisReverseMap[h];return s.config.yaxis[A]&&s.config.yaxis[A].logarithmic?c.map(function(r){return r===null?null:t.getLogVal(s.config.yaxis[A].logBase,r,h)}):c}),s.globals.invalidLogScale?e:s.globals.seriesLog}},{key:"getLogValAtSeriesIndex",value:function(e,t){if(e===null)return null;var s=this.w,c=s.globals.seriesYAxisReverseMap[t];return s.config.yaxis[c]&&s.config.yaxis[c].logarithmic?this.getLogVal(s.config.yaxis[c].logBase,e,t):e}},{key:"getBaseLog",value:function(e,t){return Math.log(t)/Math.log(e)}},{key:"getLogVal",value:function(e,t,s){if(t<=0)return 0;var c=this.w,h=c.globals.minYArr[s]===0?-1:this.getBaseLog(e,c.globals.minYArr[s]),A=(c.globals.maxYArr[s]===0?0:this.getBaseLog(e,c.globals.maxYArr[s]))-h;return t<1?t/A:(this.getBaseLog(e,t)-h)/A}},{key:"getLogYRatios",value:function(e){var t=this,s=this.w,c=this.w.globals;return c.yLogRatio=e.slice(),c.logYRange=c.yRange.map(function(h,A){var r=s.globals.seriesYAxisReverseMap[A];if(s.config.yaxis[r]&&t.w.config.yaxis[r].logarithmic){var y,b=-Number.MAX_VALUE,_=Number.MIN_VALUE;return c.seriesLog.forEach(function(B,I){B.forEach(function(E){s.config.yaxis[I]&&s.config.yaxis[I].logarithmic&&(b=Math.max(E,b),_=Math.min(E,_))})}),y=Math.pow(c.yRange[A],Math.abs(_-b)/c.yRange[A]),c.yLogRatio[A]=y/c.gridHeight,y}}),c.invalidLogScale?e.slice():c.yLogRatio}},{key:"drawSeriesByGroup",value:function(e,t,s,c){var h=this.w,A=[];return e.series.length>0&&t.forEach(function(r){var y=[],b=[];e.i.forEach(function(_,B){h.config.series[_].group===r&&(y.push(e.series[B]),b.push(_))}),y.length>0&&A.push(c.draw(y,s,b))}),A}}],[{key:"checkComboSeries",value:function(e,t){var s=!1,c=0,h=0;return t===void 0&&(t="line"),e.length&&e[0].type!==void 0&&e.forEach(function(A){A.type!=="bar"&&A.type!=="column"&&A.type!=="candlestick"&&A.type!=="boxPlot"||c++,A.type!==void 0&&A.type!==t&&h++}),h>0&&(s=!0),{comboBarCount:c,comboCharts:s}}},{key:"extendArrayProps",value:function(e,t,s){var c,h,A,r,y,b;return(c=t)!==null&&c!==void 0&&c.yaxis&&(t=e.extendYAxis(t,s)),(h=t)!==null&&h!==void 0&&h.annotations&&(t.annotations.yaxis&&(t=e.extendYAxisAnnotations(t)),(A=t)!==null&&A!==void 0&&(r=A.annotations)!==null&&r!==void 0&&r.xaxis&&(t=e.extendXAxisAnnotations(t)),(y=t)!==null&&y!==void 0&&(b=y.annotations)!==null&&b!==void 0&&b.points&&(t=e.extendPointAnnotations(t))),t}}]),a}(),f_=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e}return tn(a,[{key:"setOrientations",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.w;if(e.label.orientation==="vertical"){var c=t!==null?t:0,h=s.globals.dom.baseEl.querySelector(".apexcharts-xaxis-annotations .apexcharts-xaxis-annotation-label[rel='".concat(c,"']"));if(h!==null){var A=h.getBoundingClientRect();h.setAttribute("x",parseFloat(h.getAttribute("x"))-A.height+4);var r=e.label.position==="top"?A.width:-A.width;h.setAttribute("y",parseFloat(h.getAttribute("y"))+r);var y=this.annoCtx.graphics.rotateAroundCenter(h),b=y.x,_=y.y;h.setAttribute("transform","rotate(-90 ".concat(b," ").concat(_,")"))}}}},{key:"addBackgroundToAnno",value:function(e,t){var s=this.w;if(!e||!t.label.text||!String(t.label.text).trim())return null;var c=s.globals.dom.baseEl.querySelector(".apexcharts-grid").getBoundingClientRect(),h=e.getBoundingClientRect(),A=t.label.style.padding,r=A.left,y=A.right,b=A.top,_=A.bottom;if(t.label.orientation==="vertical"){var B=[r,y,b,_];b=B[0],_=B[1],r=B[2],y=B[3]}var I=h.left-c.left-r,E=h.top-c.top-b,R=this.annoCtx.graphics.drawRect(I-s.globals.barPadForNumericAxis,E,h.width+r+y,h.height+b+_,t.label.borderRadius,t.label.style.background,1,t.label.borderWidth,t.label.borderColor,0);return t.id&&R.node.classList.add(t.id),R}},{key:"annotationsBackground",value:function(){var e=this,t=this.w,s=function(c,h,A){var r=t.globals.dom.baseEl.querySelector(".apexcharts-".concat(A,"-annotations .apexcharts-").concat(A,"-annotation-label[rel='").concat(h,"']"));if(r){var y=r.parentNode,b=e.addBackgroundToAnno(r,c);b&&(y.insertBefore(b.node,r),c.label.mouseEnter&&b.node.addEventListener("mouseenter",c.label.mouseEnter.bind(e,c)),c.label.mouseLeave&&b.node.addEventListener("mouseleave",c.label.mouseLeave.bind(e,c)),c.label.click&&b.node.addEventListener("click",c.label.click.bind(e,c)))}};t.config.annotations.xaxis.forEach(function(c,h){return s(c,h,"xaxis")}),t.config.annotations.yaxis.forEach(function(c,h){return s(c,h,"yaxis")}),t.config.annotations.points.forEach(function(c,h){return s(c,h,"point")})}},{key:"getY1Y2",value:function(e,t){var s,c=this.w,h=e==="y1"?t.y:t.y2,A=!1;if(this.annoCtx.invertAxis){var r=c.config.xaxis.convertedCatToNumeric?c.globals.categoryLabels:c.globals.labels,y=r.indexOf(h),b=c.globals.dom.baseEl.querySelector(".apexcharts-yaxis-texts-g text:nth-child(".concat(y+1,")"));s=b?parseFloat(b.getAttribute("y")):(c.globals.gridHeight/r.length-1)*(y+1)-c.globals.barHeight,t.seriesIndex!==void 0&&c.globals.barHeight&&(s-=c.globals.barHeight/2*(c.globals.series.length-1)-c.globals.barHeight*t.seriesIndex)}else{var _,B=c.globals.seriesYAxisMap[t.yAxisIndex][0],I=c.config.yaxis[t.yAxisIndex].logarithmic?new sl(this.annoCtx.ctx).getLogVal(c.config.yaxis[t.yAxisIndex].logBase,h,B)/c.globals.yLogRatio[B]:(h-c.globals.minYArr[B])/(c.globals.yRange[B]/c.globals.gridHeight);s=c.globals.gridHeight-Math.min(Math.max(I,0),c.globals.gridHeight),A=I>c.globals.gridHeight||I<0,!t.marker||t.y!==void 0&&t.y!==null||(s=0),(_=c.config.yaxis[t.yAxisIndex])!==null&&_!==void 0&&_.reversed&&(s=I)}return typeof h=="string"&&h.includes("px")&&(s=parseFloat(h)),{yP:s,clipped:A}}},{key:"getX1X2",value:function(e,t){var s=this.w,c=e==="x1"?t.x:t.x2,h=this.annoCtx.invertAxis?s.globals.minY:s.globals.minX,A=this.annoCtx.invertAxis?s.globals.maxY:s.globals.maxX,r=this.annoCtx.invertAxis?s.globals.yRange[0]:s.globals.xRange,y=!1,b=this.annoCtx.inversedReversedAxis?(A-c)/(r/s.globals.gridWidth):(c-h)/(r/s.globals.gridWidth);return s.config.xaxis.type!=="category"&&!s.config.xaxis.convertedCatToNumeric||this.annoCtx.invertAxis||s.globals.dataFormatXNumeric||s.config.chart.sparkline.enabled||(b=this.getStringX(c)),typeof c=="string"&&c.includes("px")&&(b=parseFloat(c)),c==null&&t.marker&&(b=s.globals.gridWidth),t.seriesIndex!==void 0&&s.globals.barWidth&&!this.annoCtx.invertAxis&&(b-=s.globals.barWidth/2*(s.globals.series.length-1)-s.globals.barWidth*t.seriesIndex),typeof b!="number"&&(b=0,y=!0),parseFloat(b.toFixed(10))>parseFloat(s.globals.gridWidth.toFixed(10))?(b=s.globals.gridWidth,y=!0):b<0&&(b=0,y=!0),{x:b,clipped:y}}},{key:"getStringX",value:function(e){var t=this.w,s=e;t.config.xaxis.convertedCatToNumeric&&t.globals.categoryLabels.length&&(e=t.globals.categoryLabels.indexOf(e)+1);var c=t.globals.labels.map(function(A){return Array.isArray(A)?A.join(" "):A}).indexOf(e),h=t.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g text:nth-child(".concat(c+1,")"));return h&&(s=parseFloat(h.getAttribute("x"))),s}}]),a}(),BD=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.invertAxis=this.annoCtx.invertAxis,this.helpers=new f_(this.annoCtx)}return tn(a,[{key:"addXaxisAnnotation",value:function(e,t,s){var c,h=this.w,A=this.helpers.getX1X2("x1",e),r=A.x,y=A.clipped,b=!0,_=e.label.text,B=e.strokeDashArray;if(ni.isNumber(r)){if(e.x2===null||e.x2===void 0){if(!y){var I=this.annoCtx.graphics.drawLine(r+e.offsetX,0+e.offsetY,r+e.offsetX,h.globals.gridHeight+e.offsetY,e.borderColor,B,e.borderWidth);t.appendChild(I.node),e.id&&I.node.classList.add(e.id)}}else{var E=this.helpers.getX1X2("x2",e);if(c=E.x,b=E.clipped,c<r){var R=r;r=c,c=R}var M=this.annoCtx.graphics.drawRect(r+e.offsetX,0+e.offsetY,c-r,h.globals.gridHeight+e.offsetY,0,e.fillColor,e.opacity,1,e.borderColor,B);M.node.classList.add("apexcharts-annotation-rect"),M.attr("clip-path","url(#gridRectMask".concat(h.globals.cuid,")")),t.appendChild(M.node),e.id&&M.node.classList.add(e.id)}if(!y||!b){var G=this.annoCtx.graphics.getTextRects(_,parseFloat(e.label.style.fontSize)),U=e.label.position==="top"?4:e.label.position==="center"?h.globals.gridHeight/2+(e.label.orientation==="vertical"?G.width/2:0):h.globals.gridHeight,Q=this.annoCtx.graphics.drawText({x:r+e.label.offsetX,y:U+e.label.offsetY-(e.label.orientation==="vertical"?e.label.position==="top"?G.width/2-12:-G.width/2:0),text:_,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-xaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});Q.attr({rel:s}),t.appendChild(Q.node),this.annoCtx.helpers.setOrientations(e,s)}}}},{key:"drawXAxisAnnotations",value:function(){var e=this,t=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return t.config.annotations.xaxis.map(function(c,h){e.addXaxisAnnotation(c,s.node,h)}),s}}]),a}(),Oc=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.months31=[1,3,5,7,8,10,12],this.months30=[2,4,6,9,11],this.daysCntOfYear=[0,31,59,90,120,151,181,212,243,273,304,334]}return tn(a,[{key:"isValidDate",value:function(e){return typeof e!="number"&&!isNaN(this.parseDate(e))}},{key:"getTimeStamp",value:function(e){return Date.parse(e)?this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toISOString().substr(0,25)).getTime():new Date(e).getTime():e}},{key:"getDate",value:function(e){return this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toUTCString()):new Date(e)}},{key:"parseDate",value:function(e){var t=Date.parse(e);if(!isNaN(t))return this.getTimeStamp(e);var s=Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "));return s=this.getTimeStamp(s)}},{key:"parseDateWithTimezone",value:function(e){return Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "))}},{key:"formatDate",value:function(e,t){var s=this.w.globals.locale,c=this.w.config.xaxis.labels.datetimeUTC,h=["\0"].concat(Jl(s.months)),A=[""].concat(Jl(s.shortMonths)),r=[""].concat(Jl(s.days)),y=[""].concat(Jl(s.shortDays));function b(le,be){var we=le+"";for(be=be||2;we.length<be;)we="0"+we;return we}var _=c?e.getUTCFullYear():e.getFullYear();t=(t=(t=t.replace(/(^|[^\\])yyyy+/g,"$1"+_)).replace(/(^|[^\\])yy/g,"$1"+_.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+_);var B=(c?e.getUTCMonth():e.getMonth())+1;t=(t=(t=(t=t.replace(/(^|[^\\])MMMM+/g,"$1"+h[0])).replace(/(^|[^\\])MMM/g,"$1"+A[0])).replace(/(^|[^\\])MM/g,"$1"+b(B))).replace(/(^|[^\\])M/g,"$1"+B);var I=c?e.getUTCDate():e.getDate();t=(t=(t=(t=t.replace(/(^|[^\\])dddd+/g,"$1"+r[0])).replace(/(^|[^\\])ddd/g,"$1"+y[0])).replace(/(^|[^\\])dd/g,"$1"+b(I))).replace(/(^|[^\\])d/g,"$1"+I);var E=c?e.getUTCHours():e.getHours(),R=E>12?E-12:E===0?12:E;t=(t=(t=(t=t.replace(/(^|[^\\])HH+/g,"$1"+b(E))).replace(/(^|[^\\])H/g,"$1"+E)).replace(/(^|[^\\])hh+/g,"$1"+b(R))).replace(/(^|[^\\])h/g,"$1"+R);var M=c?e.getUTCMinutes():e.getMinutes();t=(t=t.replace(/(^|[^\\])mm+/g,"$1"+b(M))).replace(/(^|[^\\])m/g,"$1"+M);var G=c?e.getUTCSeconds():e.getSeconds();t=(t=t.replace(/(^|[^\\])ss+/g,"$1"+b(G))).replace(/(^|[^\\])s/g,"$1"+G);var U=c?e.getUTCMilliseconds():e.getMilliseconds();t=t.replace(/(^|[^\\])fff+/g,"$1"+b(U,3)),U=Math.round(U/10),t=t.replace(/(^|[^\\])ff/g,"$1"+b(U)),U=Math.round(U/10);var Q=E<12?"AM":"PM";t=(t=(t=t.replace(/(^|[^\\])f/g,"$1"+U)).replace(/(^|[^\\])TT+/g,"$1"+Q)).replace(/(^|[^\\])T/g,"$1"+Q.charAt(0));var q=Q.toLowerCase();t=(t=t.replace(/(^|[^\\])tt+/g,"$1"+q)).replace(/(^|[^\\])t/g,"$1"+q.charAt(0));var ne=-e.getTimezoneOffset(),re=c||!ne?"Z":ne>0?"+":"-";if(!c){var pe=(ne=Math.abs(ne))%60;re+=b(Math.floor(ne/60))+":"+b(pe)}t=t.replace(/(^|[^\\])K/g,"$1"+re);var Ae=(c?e.getUTCDay():e.getDay())+1;return t=(t=(t=(t=(t=t.replace(new RegExp(r[0],"g"),r[Ae])).replace(new RegExp(y[0],"g"),y[Ae])).replace(new RegExp(h[0],"g"),h[B])).replace(new RegExp(A[0],"g"),A[B])).replace(/\\(.)/g,"$1")}},{key:"getTimeUnitsfromTimestamp",value:function(e,t,s){var c=this.w;c.config.xaxis.min!==void 0&&(e=c.config.xaxis.min),c.config.xaxis.max!==void 0&&(t=c.config.xaxis.max);var h=this.getDate(e),A=this.getDate(t),r=this.formatDate(h,"yyyy MM dd HH mm ss fff").split(" "),y=this.formatDate(A,"yyyy MM dd HH mm ss fff").split(" ");return{minMillisecond:parseInt(r[6],10),maxMillisecond:parseInt(y[6],10),minSecond:parseInt(r[5],10),maxSecond:parseInt(y[5],10),minMinute:parseInt(r[4],10),maxMinute:parseInt(y[4],10),minHour:parseInt(r[3],10),maxHour:parseInt(y[3],10),minDate:parseInt(r[2],10),maxDate:parseInt(y[2],10),minMonth:parseInt(r[1],10)-1,maxMonth:parseInt(y[1],10)-1,minYear:parseInt(r[0],10),maxYear:parseInt(y[0],10)}}},{key:"isLeapYear",value:function(e){return e%4==0&&e%100!=0||e%400==0}},{key:"calculcateLastDaysOfMonth",value:function(e,t,s){return this.determineDaysOfMonths(e,t)-s}},{key:"determineDaysOfYear",value:function(e){var t=365;return this.isLeapYear(e)&&(t=366),t}},{key:"determineRemainingDaysOfYear",value:function(e,t,s){var c=this.daysCntOfYear[t]+s;return t>1&&this.isLeapYear()&&c++,c}},{key:"determineDaysOfMonths",value:function(e,t){var s=30;switch(e=ni.monthMod(e),!0){case this.months30.indexOf(e)>-1:e===2&&(s=this.isLeapYear(t)?29:28);break;case this.months31.indexOf(e)>-1:default:s=31}return s}}]),a}(),hv=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.tooltipKeyFormat="dd MMM"}return tn(a,[{key:"xLabelFormat",value:function(e,t,s,c){var h=this.w;if(h.config.xaxis.type==="datetime"&&h.config.xaxis.labels.formatter===void 0&&h.config.tooltip.x.formatter===void 0){var A=new Oc(this.ctx);return A.formatDate(A.getDate(t),h.config.tooltip.x.format)}return e(t,s,c)}},{key:"defaultGeneralFormatter",value:function(e){return Array.isArray(e)?e.map(function(t){return t}):e}},{key:"defaultYFormatter",value:function(e,t,s){var c=this.w;if(ni.isNumber(e))if(c.globals.yValueDecimal!==0)e=e.toFixed(t.decimalsInFloat!==void 0?t.decimalsInFloat:c.globals.yValueDecimal);else{var h=e.toFixed(0);e=e==h?h:e.toFixed(1)}return e}},{key:"setLabelFormatters",value:function(){var e=this,t=this.w;return t.globals.xaxisTooltipFormatter=function(s){return e.defaultGeneralFormatter(s)},t.globals.ttKeyFormatter=function(s){return e.defaultGeneralFormatter(s)},t.globals.ttZFormatter=function(s){return s},t.globals.legendFormatter=function(s){return e.defaultGeneralFormatter(s)},t.config.xaxis.labels.formatter!==void 0?t.globals.xLabelFormatter=t.config.xaxis.labels.formatter:t.globals.xLabelFormatter=function(s){if(ni.isNumber(s)){if(!t.config.xaxis.convertedCatToNumeric&&t.config.xaxis.type==="numeric"){if(ni.isNumber(t.config.xaxis.decimalsInFloat))return s.toFixed(t.config.xaxis.decimalsInFloat);var c=t.globals.maxX-t.globals.minX;return c>0&&c<100?s.toFixed(1):s.toFixed(0)}return t.globals.isBarHorizontal&&t.globals.maxY-t.globals.minYArr<4?s.toFixed(1):s.toFixed(0)}return s},typeof t.config.tooltip.x.formatter=="function"?t.globals.ttKeyFormatter=t.config.tooltip.x.formatter:t.globals.ttKeyFormatter=t.globals.xLabelFormatter,typeof t.config.xaxis.tooltip.formatter=="function"&&(t.globals.xaxisTooltipFormatter=t.config.xaxis.tooltip.formatter),(Array.isArray(t.config.tooltip.y)||t.config.tooltip.y.formatter!==void 0)&&(t.globals.ttVal=t.config.tooltip.y),t.config.tooltip.z.formatter!==void 0&&(t.globals.ttZFormatter=t.config.tooltip.z.formatter),t.config.legend.formatter!==void 0&&(t.globals.legendFormatter=t.config.legend.formatter),t.config.yaxis.forEach(function(s,c){s.labels.formatter!==void 0?t.globals.yLabelFormatters[c]=s.labels.formatter:t.globals.yLabelFormatters[c]=function(h){return t.globals.xyCharts?Array.isArray(h)?h.map(function(A){return e.defaultYFormatter(A,s,c)}):e.defaultYFormatter(h,s,c):h}}),t.globals}},{key:"heatmapLabelFormatters",value:function(){var e=this.w;if(e.config.chart.type==="heatmap"){e.globals.yAxisScale[0].result=e.globals.seriesNames.slice();var t=e.globals.seriesNames.reduce(function(s,c){return s.length>c.length?s:c},0);e.globals.yAxisScale[0].niceMax=t,e.globals.yAxisScale[0].niceMin=t}}}]),a}(),Mp=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"getLabel",value:function(e,t,s,c){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"12px",r=!(arguments.length>6&&arguments[6]!==void 0)||arguments[6],y=this.w,b=e[c]===void 0?"":e[c],_=b,B=y.globals.xLabelFormatter,I=y.config.xaxis.labels.formatter,E=!1,R=new hv(this.ctx),M=b;r&&(_=R.xLabelFormat(B,b,M,{i:c,dateFormatter:new Oc(this.ctx).formatDate,w:y}),I!==void 0&&(_=I(b,e[c],{i:c,dateFormatter:new Oc(this.ctx).formatDate,w:y})));var G,U;t.length>0?(G=t[c].unit,U=null,t.forEach(function(re){re.unit==="month"?U="year":re.unit==="day"?U="month":re.unit==="hour"?U="day":re.unit==="minute"&&(U="hour")}),E=U===G,s=t[c].position,_=t[c].value):y.config.xaxis.type==="datetime"&&I===void 0&&(_=""),_===void 0&&(_=""),_=Array.isArray(_)?_:_.toString();var Q=new hr(this.ctx),q={};q=y.globals.rotateXLabels&&r?Q.getTextRects(_,parseInt(A,10),null,"rotate(".concat(y.config.xaxis.labels.rotate," 0 0)"),!1):Q.getTextRects(_,parseInt(A,10));var ne=!y.config.xaxis.labels.showDuplicates&&this.ctx.timeScale;return!Array.isArray(_)&&(String(_)==="NaN"||h.indexOf(_)>=0&&ne)&&(_=""),{x:s,text:_,textRect:q,isBold:E}}},{key:"checkLabelBasedOnTickamount",value:function(e,t,s){var c=this.w,h=c.config.xaxis.tickAmount;return h==="dataPoints"&&(h=Math.round(c.globals.gridWidth/120)),h>s||e%Math.round(s/(h+1))==0||(t.text=""),t}},{key:"checkForOverflowingLabels",value:function(e,t,s,c,h){var A=this.w;if(e===0&&A.globals.skipFirstTimelinelabel&&(t.text=""),e===s-1&&A.globals.skipLastTimelinelabel&&(t.text=""),A.config.xaxis.labels.hideOverlappingLabels&&c.length>0){var r=h[h.length-1];t.x<r.textRect.width/(A.globals.rotateXLabels?Math.abs(A.config.xaxis.labels.rotate)/12:1.01)+r.x&&(t.text="")}return t}},{key:"checkForReversedLabels",value:function(e,t){var s=this.w;return s.config.yaxis[e]&&s.config.yaxis[e].reversed&&t.reverse(),t}},{key:"yAxisAllSeriesCollapsed",value:function(e){var t=this.w.globals;return!t.seriesYAxisMap[e].some(function(s){return t.collapsedSeriesIndices.indexOf(s)===-1})}},{key:"translateYAxisIndex",value:function(e){var t=this.w,s=t.globals,c=t.config.yaxis;return s.series.length>c.length||c.some(function(h){return Array.isArray(h.seriesName)})?e:s.seriesYAxisReverseMap[e]}},{key:"isYAxisHidden",value:function(e){var t=this.w,s=t.config.yaxis[e];if(!s.show||this.yAxisAllSeriesCollapsed(e))return!0;if(!s.showForNullSeries){var c=t.globals.seriesYAxisMap[e],h=new sl(this.ctx);return c.every(function(A){return h.isSeriesNull(A)})}return!1}},{key:"getYAxisForeColor",value:function(e,t){var s=this.w;return Array.isArray(e)&&s.globals.yAxisScale[t]&&this.ctx.theme.pushExtraColors(e,s.globals.yAxisScale[t].result.length,!1),e}},{key:"drawYAxisTicks",value:function(e,t,s,c,h,A,r){var y=this.w,b=new hr(this.ctx),_=y.globals.translateY+y.config.yaxis[h].labels.offsetY;if(y.globals.isBarHorizontal?_=0:y.config.chart.type==="heatmap"&&(_+=A/2),c.show&&t>0){y.config.yaxis[h].opposite===!0&&(e+=c.width);for(var B=t;B>=0;B--){var I=b.drawLine(e+s.offsetX-c.width+c.offsetX,_+c.offsetY,e+s.offsetX+c.offsetX,_+c.offsetY,c.color);r.add(I),_+=A}}}}]),a}(),CD=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.helpers=new f_(this.annoCtx),this.axesUtils=new Mp(this.annoCtx)}return tn(a,[{key:"addYaxisAnnotation",value:function(e,t,s){var c,h=this.w,A=e.strokeDashArray,r=this.helpers.getY1Y2("y1",e),y=r.yP,b=r.clipped,_=!0,B=!1,I=e.label.text;if(e.y2===null||e.y2===void 0){if(!b){B=!0;var E=this.annoCtx.graphics.drawLine(0+e.offsetX,y+e.offsetY,this._getYAxisAnnotationWidth(e),y+e.offsetY,e.borderColor,A,e.borderWidth);t.appendChild(E.node),e.id&&E.node.classList.add(e.id)}}else{if(c=(r=this.helpers.getY1Y2("y2",e)).yP,_=r.clipped,c>y){var R=y;y=c,c=R}if(!b||!_){B=!0;var M=this.annoCtx.graphics.drawRect(0+e.offsetX,c+e.offsetY,this._getYAxisAnnotationWidth(e),y-c,0,e.fillColor,e.opacity,1,e.borderColor,A);M.node.classList.add("apexcharts-annotation-rect"),M.attr("clip-path","url(#gridRectMask".concat(h.globals.cuid,")")),t.appendChild(M.node),e.id&&M.node.classList.add(e.id)}}if(B){var G=e.label.position==="right"?h.globals.gridWidth:e.label.position==="center"?h.globals.gridWidth/2:0,U=this.annoCtx.graphics.drawText({x:G+e.label.offsetX,y:(c??y)+e.label.offsetY-3,text:I,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-yaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});U.attr({rel:s}),t.appendChild(U.node)}}},{key:"_getYAxisAnnotationWidth",value:function(e){var t=this.w;return t.globals.gridWidth,(e.width.indexOf("%")>-1?t.globals.gridWidth*parseInt(e.width,10)/100:parseInt(e.width,10))+e.offsetX}},{key:"drawYAxisAnnotations",value:function(){var e=this,t=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-yaxis-annotations"});return t.config.annotations.yaxis.forEach(function(c,h){c.yAxisIndex=e.axesUtils.translateYAxisIndex(c.yAxisIndex),e.axesUtils.isYAxisHidden(c.yAxisIndex)&&e.axesUtils.yAxisAllSeriesCollapsed(c.yAxisIndex)||e.addYaxisAnnotation(c,s.node,h)}),s}}]),a}(),SD=function(){function a(e){en(this,a),this.w=e.w,this.annoCtx=e,this.helpers=new f_(this.annoCtx)}return tn(a,[{key:"addPointAnnotation",value:function(e,t,s){if(!(this.w.globals.collapsedSeriesIndices.indexOf(e.seriesIndex)>-1)){var c=this.helpers.getX1X2("x1",e),h=c.x,A=c.clipped,r=(c=this.helpers.getY1Y2("y1",e)).yP,y=c.clipped;if(ni.isNumber(h)&&!y&&!A){var b={pSize:e.marker.size,pointStrokeWidth:e.marker.strokeWidth,pointFillColor:e.marker.fillColor,pointStrokeColor:e.marker.strokeColor,shape:e.marker.shape,pRadius:e.marker.radius,class:"apexcharts-point-annotation-marker ".concat(e.marker.cssClass," ").concat(e.id?e.id:"")},_=this.annoCtx.graphics.drawMarker(h+e.marker.offsetX,r+e.marker.offsetY,b);t.appendChild(_.node);var B=e.label.text?e.label.text:"",I=this.annoCtx.graphics.drawText({x:h+e.label.offsetX,y:r+e.label.offsetY-e.marker.size-parseFloat(e.label.style.fontSize)/1.6,text:B,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-point-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});if(I.attr({rel:s}),t.appendChild(I.node),e.customSVG.SVG){var E=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+e.customSVG.cssClass});E.attr({transform:"translate(".concat(h+e.customSVG.offsetX,", ").concat(r+e.customSVG.offsetY,")")}),E.node.innerHTML=e.customSVG.SVG,t.appendChild(E.node)}if(e.image.path){var R=e.image.width?e.image.width:20,M=e.image.height?e.image.height:20;_=this.annoCtx.addImage({x:h+e.image.offsetX-R/2,y:r+e.image.offsetY-M/2,width:R,height:M,path:e.image.path,appendTo:".apexcharts-point-annotations"})}e.mouseEnter&&_.node.addEventListener("mouseenter",e.mouseEnter.bind(this,e)),e.mouseLeave&&_.node.addEventListener("mouseleave",e.mouseLeave.bind(this,e)),e.click&&_.node.addEventListener("click",e.click.bind(this,e))}}}},{key:"drawPointAnnotations",value:function(){var e=this,t=this.w,s=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return t.config.annotations.points.map(function(c,h){e.addPointAnnotation(c,s.node,h)}),s}}]),a}(),fT={name:"en",options:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],toolbar:{exportToSVG:"Download SVG",exportToPNG:"Download PNG",exportToCSV:"Download CSV",menu:"Menu",selection:"Selection",selectionZoom:"Selection Zoom",zoomIn:"Zoom In",zoomOut:"Zoom Out",pan:"Panning",reset:"Reset Zoom"}}},lg=function(){function a(){en(this,a),this.yAxis={show:!0,showAlways:!1,showForNullSeries:!0,seriesName:void 0,opposite:!1,reversed:!1,logarithmic:!1,logBase:10,tickAmount:void 0,stepSize:void 0,forceNiceScale:!1,max:void 0,min:void 0,floating:!1,decimalsInFloat:void 0,labels:{show:!0,showDuplicates:!1,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,align:void 0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",fontWeight:400,fontFamily:void 0,cssClass:""},formatter:void 0},axisBorder:{show:!1,color:"#e0e0e0",width:1,offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#e0e0e0",width:6,offsetX:0,offsetY:0},title:{text:void 0,rotate:-90,offsetY:0,offsetX:0,style:{color:void 0,fontSize:"11px",fontWeight:900,fontFamily:void 0,cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}},this.pointAnnotation={id:void 0,x:0,y:null,yAxisIndex:0,seriesIndex:void 0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,marker:{size:4,fillColor:"#fff",strokeWidth:2,strokeColor:"#333",shape:"circle",offsetX:0,offsetY:0,cssClass:""},label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}},customSVG:{SVG:void 0,cssClass:void 0,offsetX:0,offsetY:0},image:{path:void 0,width:20,height:20,offsetX:0,offsetY:0}},this.yAxisAnnotation={id:void 0,y:0,y2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,width:"100%",yAxisIndex:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"end",position:"right",offsetX:0,offsetY:-3,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.xAxisAnnotation={id:void 0,x:0,x2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",orientation:"vertical",position:"top",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.text={x:0,y:0,text:"",textAnchor:"start",foreColor:void 0,fontSize:"13px",fontFamily:void 0,fontWeight:400,appendTo:".apexcharts-annotations",backgroundColor:"transparent",borderColor:"#c2c2c2",borderRadius:0,borderWidth:0,paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2}}return tn(a,[{key:"init",value:function(){return{annotations:{yaxis:[this.yAxisAnnotation],xaxis:[this.xAxisAnnotation],points:[this.pointAnnotation],texts:[],images:[],shapes:[]},chart:{animations:{enabled:!0,speed:800,animateGradually:{delay:150,enabled:!0},dynamicAnimation:{enabled:!0,speed:350}},background:"",locales:[fT],defaultLocale:"en",dropShadow:{enabled:!1,enabledOnSeries:void 0,top:2,left:2,blur:4,color:"#000",opacity:.7},events:{animationEnd:void 0,beforeMount:void 0,mounted:void 0,updated:void 0,click:void 0,mouseMove:void 0,mouseLeave:void 0,xAxisLabelClick:void 0,legendClick:void 0,markerClick:void 0,selection:void 0,dataPointSelection:void 0,dataPointMouseEnter:void 0,dataPointMouseLeave:void 0,beforeZoom:void 0,beforeResetZoom:void 0,zoomed:void 0,scrolled:void 0,brushScrolled:void 0},foreColor:"#373d3f",fontFamily:"Helvetica, Arial, sans-serif",height:"auto",parentHeightOffset:15,redrawOnParentResize:!0,redrawOnWindowResize:!0,id:void 0,group:void 0,nonce:void 0,offsetX:0,offsetY:0,selection:{enabled:!1,type:"x",fill:{color:"#24292e",opacity:.1},stroke:{width:1,color:"#24292e",opacity:.4,dashArray:3},xaxis:{min:void 0,max:void 0},yaxis:{min:void 0,max:void 0}},sparkline:{enabled:!1},brush:{enabled:!1,autoScaleYaxis:!0,target:void 0,targets:void 0},stacked:!1,stackOnlyBar:!0,stackType:"normal",toolbar:{show:!0,offsetX:0,offsetY:0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0,customIcons:[]},export:{csv:{filename:void 0,columnDelimiter:",",headerCategory:"category",headerValue:"value",categoryFormatter:void 0,valueFormatter:void 0},png:{filename:void 0},svg:{filename:void 0},scale:void 0,width:void 0},autoSelected:"zoom"},type:"line",width:"100%",zoom:{enabled:!0,type:"x",autoScaleYaxis:!1,allowMouseWheelZoom:!0,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},plotOptions:{line:{isSlopeChart:!1,colors:{threshold:0,colorAboveThreshold:void 0,colorBelowThreshold:void 0}},area:{fillTo:"origin"},bar:{horizontal:!1,columnWidth:"70%",barHeight:"70%",distributed:!1,borderRadius:0,borderRadiusApplication:"around",borderRadiusWhenStacked:"last",rangeBarOverlap:!0,rangeBarGroupRows:!1,hideZeroBarsWhenGrouped:!1,isDumbbell:!1,dumbbellColors:void 0,isFunnel:!1,isFunnel3d:!0,colors:{ranges:[],backgroundBarColors:[],backgroundBarOpacity:1,backgroundBarRadius:0},dataLabels:{position:"top",maxItems:100,hideOverflowingLabels:!0,orientation:"horizontal",total:{enabled:!1,formatter:void 0,offsetX:0,offsetY:0,style:{color:"#373d3f",fontSize:"12px",fontFamily:void 0,fontWeight:600}}}},bubble:{zScaling:!0,minBubbleRadius:void 0,maxBubbleRadius:void 0},candlestick:{colors:{upward:"#00B746",downward:"#EF403C"},wick:{useFillColor:!0}},boxPlot:{colors:{upper:"#00E396",lower:"#008FFB"}},heatmap:{radius:2,enableShades:!0,shadeIntensity:.5,reverseNegativeShade:!1,distributed:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},treemap:{enableShades:!0,shadeIntensity:.5,distributed:!1,reverseNegativeShade:!1,useFillColorAsStroke:!1,borderRadius:4,dataLabels:{format:"scale"},colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0},seriesTitle:{show:!0,offsetY:1,offsetX:1,borderColor:"#000",borderWidth:1,borderRadius:2,style:{background:"rgba(0, 0, 0, 0.6)",color:"#fff",fontSize:"12px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:6,right:6,top:2,bottom:2}}}},radialBar:{inverseOrder:!1,startAngle:0,endAngle:360,offsetX:0,offsetY:0,hollow:{margin:5,size:"50%",background:"transparent",image:void 0,imageWidth:150,imageHeight:150,imageOffsetX:0,imageOffsetY:0,imageClipped:!0,position:"front",dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},track:{show:!0,startAngle:void 0,endAngle:void 0,background:"#f2f2f2",strokeWidth:"97%",opacity:1,margin:5,dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:0,formatter:function(e){return e}},value:{show:!0,fontSize:"14px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:16,formatter:function(e){return e+"%"}},total:{show:!1,label:"Total",fontSize:"16px",fontWeight:600,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(t,s){return t+s},0)/e.globals.series.length+"%"}}},barLabels:{enabled:!1,offsetX:0,offsetY:0,useSeriesColors:!0,fontFamily:void 0,fontWeight:600,fontSize:"16px",formatter:function(e){return e},onClick:void 0}},pie:{customScale:1,offsetX:0,offsetY:0,startAngle:0,endAngle:360,expandOnClick:!0,dataLabels:{offset:0,minAngleToShowLabel:10},donut:{size:"65%",background:"transparent",labels:{show:!1,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:-10,formatter:function(e){return e}},value:{show:!0,fontSize:"20px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:10,formatter:function(e){return e}},total:{show:!1,showAlways:!1,label:"Total",fontSize:"16px",fontWeight:400,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(t,s){return t+s},0)}}}}},polarArea:{rings:{strokeWidth:1,strokeColor:"#e8e8e8"},spokes:{strokeWidth:1,connectorColors:"#e8e8e8"}},radar:{size:void 0,offsetX:0,offsetY:0,polygons:{strokeWidth:1,strokeColors:"#e8e8e8",connectorColors:"#e8e8e8",fill:{colors:void 0}}}},colors:void 0,dataLabels:{enabled:!0,enabledOnSeries:void 0,formatter:function(e){return e!==null?e:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"12px",fontFamily:void 0,fontWeight:600,colors:void 0},background:{enabled:!0,foreColor:"#fff",backgroundColor:void 0,borderRadius:2,padding:4,opacity:.9,borderWidth:1,borderColor:"#fff",dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},image:{src:[],width:void 0,height:void 0},pattern:{style:"squares",width:6,height:6,strokeWidth:2}},forecastDataPoints:{count:0,fillOpacity:.5,strokeWidth:void 0,dashArray:4},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:0,position:"back",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}},row:{colors:void 0,opacity:.5},column:{colors:void 0,opacity:.5},padding:{top:0,right:10,bottom:0,left:12}},labels:[],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,floating:!1,position:"bottom",horizontalAlign:"center",inverseOrder:!1,fontSize:"12px",fontFamily:void 0,fontWeight:400,width:void 0,height:void 0,formatter:void 0,tooltipHoverFormatter:void 0,offsetX:-20,offsetY:4,customLegendItems:[],clusterGroupedSeries:!0,clusterGroupedSeriesOrientation:"vertical",labels:{colors:void 0,useSeriesColors:!1},markers:{size:7,fillColors:void 0,strokeWidth:1,shape:void 0,offsetX:0,offsetY:0,customHTML:void 0,onClick:void 0},itemMargin:{horizontal:5,vertical:4},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},markers:{discrete:[],size:0,colors:void 0,strokeColors:"#fff",strokeWidth:2,strokeOpacity:.9,strokeDashArray:0,fillOpacity:1,shape:"circle",offsetX:0,offsetY:0,showNullDataPoints:!0,onClick:void 0,onDblClick:void 0,hover:{size:void 0,sizeOffset:3}},noData:{text:void 0,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},responsive:[],series:void 0,states:{hover:{filter:{type:"lighten"}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken"}}},title:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:900,fontFamily:void 0,color:void 0}},subtitle:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:30,floating:!1,style:{fontSize:"12px",fontWeight:400,fontFamily:void 0,color:void 0}},stroke:{show:!0,curve:"smooth",lineCap:"butt",width:2,colors:void 0,dashArray:0,fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]}}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,hideEmptySeries:!1,followCursor:!1,intersect:!1,inverseOrder:!1,custom:void 0,fillSeriesColor:!1,theme:"light",cssClass:"",style:{fontSize:"12px",fontFamily:void 0},onDatasetHover:{highlightDataSeries:!1},x:{show:!0,format:"dd MMM",formatter:void 0},y:{formatter:void 0,title:{formatter:function(e){return e?e+": ":""}}},z:{formatter:void 0,title:"Size: "},marker:{show:!0,fillColors:void 0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0}},xaxis:{type:"category",categories:[],convertedCatToNumeric:!1,offsetX:0,offsetY:0,overwriteCategories:void 0,labels:{show:!0,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!0,trim:!1,minHeight:void 0,maxHeight:120,showDuplicates:!0,style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""},offsetX:0,offsetY:0,format:void 0,formatter:void 0,datetimeUTC:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm",minute:"HH:mm:ss",second:"HH:mm:ss"}},group:{groups:[],style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""}},axisBorder:{show:!0,color:"#e0e0e0",width:"100%",height:1,offsetX:0,offsetY:0},axisTicks:{show:!0,color:"#e0e0e0",height:6,offsetX:0,offsetY:0},stepSize:void 0,tickAmount:void 0,tickPlacement:"on",min:void 0,max:void 0,range:void 0,floating:!1,decimalsInFloat:void 0,position:"bottom",title:{text:void 0,offsetX:0,offsetY:0,style:{color:void 0,fontSize:"12px",fontWeight:900,fontFamily:void 0,cssClass:""}},crosshairs:{show:!0,width:1,position:"back",opacity:.9,stroke:{color:"#b6b6b6",width:1,dashArray:3},fill:{type:"solid",color:"#B1B9C4",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}},dropShadow:{enabled:!1,left:0,top:0,blur:1,opacity:.8}},tooltip:{enabled:!0,offsetY:0,formatter:void 0,style:{fontSize:"12px",fontFamily:void 0}}},yaxis:this.yAxis,theme:{mode:"",palette:"palette1",monochrome:{enabled:!1,color:"#008FFB",shadeTo:"light",shadeIntensity:.65}}}}}]),a}(),ED=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.graphics=new hr(this.ctx),this.w.globals.isBarHorizontal&&(this.invertAxis=!0),this.helpers=new f_(this),this.xAxisAnnotations=new BD(this),this.yAxisAnnotations=new CD(this),this.pointsAnnotations=new SD(this),this.w.globals.isBarHorizontal&&this.w.config.yaxis[0].reversed&&(this.inversedReversedAxis=!0),this.xDivision=this.w.globals.gridWidth/this.w.globals.dataPoints}return tn(a,[{key:"drawAxesAnnotations",value:function(){var e=this.w;if(e.globals.axisCharts&&e.globals.dataPoints){for(var t=this.yAxisAnnotations.drawYAxisAnnotations(),s=this.xAxisAnnotations.drawXAxisAnnotations(),c=this.pointsAnnotations.drawPointAnnotations(),h=e.config.chart.animations.enabled,A=[t,s,c],r=[s.node,t.node,c.node],y=0;y<3;y++)e.globals.dom.elGraphical.add(A[y]),!h||e.globals.resized||e.globals.dataChanged||e.config.chart.type!=="scatter"&&e.config.chart.type!=="bubble"&&e.globals.dataPoints>1&&r[y].classList.add("apexcharts-element-hidden"),e.globals.delayedElements.push({el:r[y],index:0});this.helpers.annotationsBackground()}}},{key:"drawImageAnnos",value:function(){var e=this;this.w.config.annotations.images.map(function(t,s){e.addImage(t,s)})}},{key:"drawTextAnnos",value:function(){var e=this;this.w.config.annotations.texts.map(function(t,s){e.addText(t,s)})}},{key:"addXaxisAnnotation",value:function(e,t,s){this.xAxisAnnotations.addXaxisAnnotation(e,t,s)}},{key:"addYaxisAnnotation",value:function(e,t,s){this.yAxisAnnotations.addYaxisAnnotation(e,t,s)}},{key:"addPointAnnotation",value:function(e,t,s){this.pointsAnnotations.addPointAnnotation(e,t,s)}},{key:"addText",value:function(e,t){var s=e.x,c=e.y,h=e.text,A=e.textAnchor,r=e.foreColor,y=e.fontSize,b=e.fontFamily,_=e.fontWeight,B=e.cssClass,I=e.backgroundColor,E=e.borderWidth,R=e.strokeDashArray,M=e.borderRadius,G=e.borderColor,U=e.appendTo,Q=U===void 0?".apexcharts-svg":U,q=e.paddingLeft,ne=q===void 0?4:q,re=e.paddingRight,pe=re===void 0?4:re,Ae=e.paddingBottom,le=Ae===void 0?2:Ae,be=e.paddingTop,we=be===void 0?2:be,oe=this.w,me=this.graphics.drawText({x:s,y:c,text:h,textAnchor:A||"start",fontSize:y||"12px",fontWeight:_||"regular",fontFamily:b||oe.config.chart.fontFamily,foreColor:r||oe.config.chart.foreColor,cssClass:B}),Le=oe.globals.dom.baseEl.querySelector(Q);Le&&Le.appendChild(me.node);var Se=me.bbox();if(h){var Me=this.graphics.drawRect(Se.x-ne,Se.y-we,Se.width+ne+pe,Se.height+le+we,M,I||"transparent",1,E,G,R);Le.insertBefore(Me.node,me.node)}}},{key:"addImage",value:function(e,t){var s=this.w,c=e.path,h=e.x,A=h===void 0?0:h,r=e.y,y=r===void 0?0:r,b=e.width,_=b===void 0?20:b,B=e.height,I=B===void 0?20:B,E=e.appendTo,R=E===void 0?".apexcharts-svg":E,M=s.globals.dom.Paper.image(c);M.size(_,I).move(A,y);var G=s.globals.dom.baseEl.querySelector(R);return G&&G.appendChild(M.node),M}},{key:"addXaxisAnnotationExternal",value:function(e,t,s){return this.addAnnotationExternal({params:e,pushToMemory:t,context:s,type:"xaxis",contextMethod:s.addXaxisAnnotation}),s}},{key:"addYaxisAnnotationExternal",value:function(e,t,s){return this.addAnnotationExternal({params:e,pushToMemory:t,context:s,type:"yaxis",contextMethod:s.addYaxisAnnotation}),s}},{key:"addPointAnnotationExternal",value:function(e,t,s){return this.invertAxis===void 0&&(this.invertAxis=s.w.globals.isBarHorizontal),this.addAnnotationExternal({params:e,pushToMemory:t,context:s,type:"point",contextMethod:s.addPointAnnotation}),s}},{key:"addAnnotationExternal",value:function(e){var t=e.params,s=e.pushToMemory,c=e.context,h=e.type,A=e.contextMethod,r=c,y=r.w,b=y.globals.dom.baseEl.querySelector(".apexcharts-".concat(h,"-annotations")),_=b.childNodes.length+1,B=new lg,I=Object.assign({},h==="xaxis"?B.xAxisAnnotation:h==="yaxis"?B.yAxisAnnotation:B.pointAnnotation),E=ni.extend(I,t);switch(h){case"xaxis":this.addXaxisAnnotation(E,b,_);break;case"yaxis":this.addYaxisAnnotation(E,b,_);break;case"point":this.addPointAnnotation(E,b,_)}var R=y.globals.dom.baseEl.querySelector(".apexcharts-".concat(h,"-annotations .apexcharts-").concat(h,"-annotation-label[rel='").concat(_,"']")),M=this.helpers.addBackgroundToAnno(R,E);return M&&b.insertBefore(M.node,R),s&&y.globals.memory.methodsToExec.push({context:r,id:E.id?E.id:ni.randomId(),method:A,label:"addAnnotation",params:t}),c}},{key:"clearAnnotations",value:function(e){for(var t=e.w,s=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-annotations, .apexcharts-xaxis-annotations, .apexcharts-point-annotations"),c=t.globals.memory.methodsToExec.length-1;c>=0;c--)t.globals.memory.methodsToExec[c].label!=="addText"&&t.globals.memory.methodsToExec[c].label!=="addAnnotation"||t.globals.memory.methodsToExec.splice(c,1);s=ni.listToArray(s),Array.prototype.forEach.call(s,function(h){for(;h.firstChild;)h.removeChild(h.firstChild)})}},{key:"removeAnnotation",value:function(e,t){var s=e.w,c=s.globals.dom.baseEl.querySelectorAll(".".concat(t));c&&(s.globals.memory.methodsToExec.map(function(h,A){h.id===t&&s.globals.memory.methodsToExec.splice(A,1)}),Object.keys(s.config.annotations).forEach(function(h){var A=s.config.annotations[h];Array.isArray(A)&&(s.config.annotations[h]=A.filter(function(r){return r.id!==t}))}),Array.prototype.forEach.call(c,function(h){h.parentElement.removeChild(h)}))}}]),a}(),Ab=function(a){var e,t=a.isTimeline,s=a.ctx,c=a.seriesIndex,h=a.dataPointIndex,A=a.y1,r=a.y2,y=a.w,b=y.globals.seriesRangeStart[c][h],_=y.globals.seriesRangeEnd[c][h],B=y.globals.labels[h],I=y.config.series[c].name?y.config.series[c].name:"",E=y.globals.ttKeyFormatter,R=y.config.tooltip.y.title.formatter,M={w:y,seriesIndex:c,dataPointIndex:h,start:b,end:_};typeof R=="function"&&(I=R(I,M)),(e=y.config.series[c].data[h])!==null&&e!==void 0&&e.x&&(B=y.config.series[c].data[h].x),t||y.config.xaxis.type==="datetime"&&(B=new hv(s).xLabelFormat(y.globals.ttKeyFormatter,B,B,{i:void 0,dateFormatter:new Oc(s).formatDate,w:y})),typeof E=="function"&&(B=E(B,M)),Number.isFinite(A)&&Number.isFinite(r)&&(b=A,_=r);var G="",U="",Q=y.globals.colors[c];if(y.config.tooltip.x.formatter===void 0)if(y.config.xaxis.type==="datetime"){var q=new Oc(s);G=q.formatDate(q.getDate(b),y.config.tooltip.x.format),U=q.formatDate(q.getDate(_),y.config.tooltip.x.format)}else G=b,U=_;else G=y.config.tooltip.x.formatter(b),U=y.config.tooltip.x.formatter(_);return{start:b,end:_,startVal:G,endVal:U,ylabel:B,color:Q,seriesName:I}},fb=function(a){var e=a.color,t=a.seriesName,s=a.ylabel,c=a.start,h=a.end,A=a.seriesIndex,r=a.dataPointIndex,y=a.ctx.tooltip.tooltipLabels.getFormatters(A);c=y.yLbFormatter(c),h=y.yLbFormatter(h);var b=y.yLbFormatter(a.w.globals.series[A][r]),_=`<span class="value start-value">
  `.concat(c,`
  </span> <span class="separator">-</span> <span class="value end-value">
  `).concat(h,`
  </span>`);return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+e+'">'+(t||"")+'</span></div><div> <span class="category">'+s+": </span> "+(a.w.globals.comboCharts?a.w.config.series[A].type==="rangeArea"||a.w.config.series[A].type==="rangeBar"?_:"<span>".concat(b,"</span>"):_)+" </div></div>"},Ky=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"hideYAxis",value:function(){this.opts.yaxis[0].show=!1,this.opts.yaxis[0].title.text="",this.opts.yaxis[0].axisBorder.show=!1,this.opts.yaxis[0].axisTicks.show=!1,this.opts.yaxis[0].floating=!0}},{key:"line",value:function(){return{dataLabels:{enabled:!1},stroke:{width:5,curve:"straight"},markers:{size:0,hover:{sizeOffset:6}},xaxis:{crosshairs:{width:1}}}}},{key:"sparkline",value:function(e){return this.hideYAxis(),ni.extend(e,{grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},legend:{show:!1},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}},chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1}})}},{key:"slope",value:function(){return this.hideYAxis(),{chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!0,formatter:function(e,t){var s=t.w.config.series[t.seriesIndex].name;return e!==null?s+": "+e:""},background:{enabled:!1},offsetX:-5},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},xaxis:{position:"top",labels:{style:{fontSize:14,fontWeight:900}},tooltip:{enabled:!1},crosshairs:{show:!1}},markers:{size:8,hover:{sizeOffset:1}},legend:{show:!1},tooltip:{shared:!1,intersect:!0,followCursor:!0},stroke:{width:5,curve:"straight"}}}},{key:"bar",value:function(){return{chart:{stacked:!1},plotOptions:{bar:{dataLabels:{position:"center"}}},dataLabels:{style:{colors:["#fff"]},background:{enabled:!1}},stroke:{width:0,lineCap:"square"},fill:{opacity:.85},legend:{markers:{shape:"square"}},tooltip:{shared:!1,intersect:!0},xaxis:{tooltip:{enabled:!1},tickPlacement:"between",crosshairs:{width:"barWidth",position:"back",fill:{type:"gradient"},dropShadow:{enabled:!1},stroke:{width:0}}}}}},{key:"funnel",value:function(){return this.hideYAxis(),Ir(Ir({},this.bar()),{},{chart:{animations:{speed:800,animateGradually:{enabled:!1}}},plotOptions:{bar:{horizontal:!0,borderRadiusApplication:"around",borderRadius:0,dataLabels:{position:"center"}}},grid:{show:!1,padding:{left:0,right:0}},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}}})}},{key:"candlestick",value:function(){var e=this;return{stroke:{width:1},fill:{opacity:1},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(t){var s=t.seriesIndex,c=t.dataPointIndex,h=t.w;return e._getBoxTooltip(h,s,c,["Open","High","","Low","Close"],"candlestick")}},states:{active:{filter:{type:"none"}}},xaxis:{crosshairs:{width:1}}}}},{key:"boxPlot",value:function(){var e=this;return{chart:{animations:{dynamicAnimation:{enabled:!1}}},stroke:{width:1,colors:["#24292e"]},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(t){var s=t.seriesIndex,c=t.dataPointIndex,h=t.w;return e._getBoxTooltip(h,s,c,["Minimum","Q1","Median","Q3","Maximum"],"boxPlot")}},markers:{size:7,strokeWidth:1,strokeColors:"#111"},xaxis:{crosshairs:{width:1}}}}},{key:"rangeBar",value:function(){return{chart:{animations:{animateGradually:!1}},stroke:{width:0,lineCap:"square"},plotOptions:{bar:{borderRadius:0,dataLabels:{position:"center"}}},dataLabels:{enabled:!1,formatter:function(e,t){t.ctx;var s=t.seriesIndex,c=t.dataPointIndex,h=t.w,A=function(){var r=h.globals.seriesRangeStart[s][c];return h.globals.seriesRangeEnd[s][c]-r};return h.globals.comboCharts?h.config.series[s].type==="rangeBar"||h.config.series[s].type==="rangeArea"?A():e:A()},background:{enabled:!1},style:{colors:["#fff"]}},markers:{size:10},tooltip:{shared:!1,followCursor:!0,custom:function(e){return e.w.config.plotOptions&&e.w.config.plotOptions.bar&&e.w.config.plotOptions.bar.horizontal?function(t){var s=Ab(Ir(Ir({},t),{},{isTimeline:!0})),c=s.color,h=s.seriesName,A=s.ylabel,r=s.startVal,y=s.endVal;return fb(Ir(Ir({},t),{},{color:c,seriesName:h,ylabel:A,start:r,end:y}))}(e):function(t){var s=Ab(t),c=s.color,h=s.seriesName,A=s.ylabel,r=s.start,y=s.end;return fb(Ir(Ir({},t),{},{color:c,seriesName:h,ylabel:A,start:r,end:y}))}(e)}},xaxis:{tickPlacement:"between",tooltip:{enabled:!1},crosshairs:{stroke:{width:0}}}}}},{key:"dumbbell",value:function(e){var t,s;return(t=e.plotOptions.bar)!==null&&t!==void 0&&t.barHeight||(e.plotOptions.bar.barHeight=2),(s=e.plotOptions.bar)!==null&&s!==void 0&&s.columnWidth||(e.plotOptions.bar.columnWidth=2),e}},{key:"area",value:function(){return{stroke:{width:4,fill:{type:"solid",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}}},fill:{type:"gradient",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}},markers:{size:0,hover:{sizeOffset:6}},tooltip:{followCursor:!1}}}},{key:"rangeArea",value:function(){return{stroke:{curve:"straight",width:0},fill:{type:"solid",opacity:.6},markers:{size:0},states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}},tooltip:{intersect:!1,shared:!0,followCursor:!0,custom:function(e){return function(t){var s=Ab(t),c=s.color,h=s.seriesName,A=s.ylabel,r=s.start,y=s.end;return fb(Ir(Ir({},t),{},{color:c,seriesName:h,ylabel:A,start:r,end:y}))}(e)}}}}},{key:"brush",value:function(e){return ni.extend(e,{chart:{toolbar:{autoSelected:"selection",show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{width:1},tooltip:{enabled:!1},xaxis:{tooltip:{enabled:!1}}})}},{key:"stacked100",value:function(e){e.dataLabels=e.dataLabels||{},e.dataLabels.formatter=e.dataLabels.formatter||void 0;var t=e.dataLabels.formatter;return e.yaxis.forEach(function(s,c){e.yaxis[c].min=0,e.yaxis[c].max=100}),e.chart.type==="bar"&&(e.dataLabels.formatter=t||function(s){return typeof s=="number"&&s?s.toFixed(0)+"%":s}),e}},{key:"stackedBars",value:function(){var e=this.bar();return Ir(Ir({},e),{},{plotOptions:Ir(Ir({},e.plotOptions),{},{bar:Ir(Ir({},e.plotOptions.bar),{},{borderRadiusApplication:"end",borderRadiusWhenStacked:"last"})})})}},{key:"convertCatToNumeric",value:function(e){return e.xaxis.convertedCatToNumeric=!0,e}},{key:"convertCatToNumericXaxis",value:function(e,t,s){e.xaxis.type="numeric",e.xaxis.labels=e.xaxis.labels||{},e.xaxis.labels.formatter=e.xaxis.labels.formatter||function(A){return ni.isNumber(A)?Math.floor(A):A};var c=e.xaxis.labels.formatter,h=e.xaxis.categories&&e.xaxis.categories.length?e.xaxis.categories:e.labels;return s&&s.length&&(h=s.map(function(A){return Array.isArray(A)?A:String(A)})),h&&h.length&&(e.xaxis.labels.formatter=function(A){return ni.isNumber(A)?c(h[Math.floor(A)-1]):c(A)}),e.xaxis.categories=[],e.labels=[],e.xaxis.tickAmount=e.xaxis.tickAmount||"dataPoints",e}},{key:"bubble",value:function(){return{dataLabels:{style:{colors:["#fff"]}},tooltip:{shared:!1,intersect:!0},xaxis:{crosshairs:{width:0}},fill:{type:"solid",gradient:{shade:"light",inverse:!0,shadeIntensity:.55,opacityFrom:.4,opacityTo:.8}}}}},{key:"scatter",value:function(){return{dataLabels:{enabled:!1},tooltip:{shared:!1,intersect:!0},markers:{size:6,strokeWidth:1,hover:{sizeOffset:2}}}}},{key:"heatmap",value:function(){return{chart:{stacked:!1},fill:{opacity:1},dataLabels:{style:{colors:["#fff"]}},stroke:{colors:["#fff"]},tooltip:{followCursor:!0,marker:{show:!1},x:{show:!1}},legend:{position:"top",markers:{shape:"square"}},grid:{padding:{right:20}}}}},{key:"treemap",value:function(){return{chart:{zoom:{enabled:!1}},dataLabels:{style:{fontSize:14,fontWeight:600,colors:["#fff"]}},stroke:{show:!0,width:2,colors:["#fff"]},legend:{show:!1},fill:{opacity:1,gradient:{stops:[0,100]}},tooltip:{followCursor:!0,x:{show:!1}},grid:{padding:{left:0,right:0}},xaxis:{crosshairs:{show:!1},tooltip:{enabled:!1}}}}},{key:"pie",value:function(){return{chart:{toolbar:{show:!1}},plotOptions:{pie:{donut:{labels:{show:!1}}}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",stops:[0,100]}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"donut",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",shadeIntensity:.35,stops:[80,100],opacityFrom:1,opacityTo:1}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"polarArea",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},enabled:!1},stroke:{show:!0,width:2},fill:{opacity:.7},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"radar",value:function(){return this.opts.yaxis[0].labels.offsetY=this.opts.yaxis[0].labels.offsetY?this.opts.yaxis[0].labels.offsetY:6,{dataLabels:{enabled:!1,style:{fontSize:"11px"}},stroke:{width:2},markers:{size:5,strokeWidth:1,strokeOpacity:1},fill:{opacity:.2},tooltip:{shared:!1,intersect:!0,followCursor:!0},grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},xaxis:{labels:{formatter:function(e){return e},style:{colors:["#a8a8a8"],fontSize:"11px"}},tooltip:{enabled:!1},crosshairs:{show:!1}}}}},{key:"radialBar",value:function(){return{chart:{animations:{dynamicAnimation:{enabled:!0,speed:800}},toolbar:{show:!1}},fill:{gradient:{shade:"dark",shadeIntensity:.4,inverseColors:!1,type:"diagonal2",opacityFrom:1,opacityTo:1,stops:[70,98,100]}},legend:{show:!1,position:"right"},tooltip:{enabled:!1,fillSeriesColor:!0},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"_getBoxTooltip",value:function(e,t,s,c,h){var A=e.globals.seriesCandleO[t][s],r=e.globals.seriesCandleH[t][s],y=e.globals.seriesCandleM[t][s],b=e.globals.seriesCandleL[t][s],_=e.globals.seriesCandleC[t][s];return e.config.series[t].type&&e.config.series[t].type!==h?`<div class="apexcharts-custom-tooltip">
          `.concat(e.config.series[t].name?e.config.series[t].name:"series-"+(t+1),": <strong>").concat(e.globals.series[t][s],`</strong>
        </div>`):'<div class="apexcharts-tooltip-box apexcharts-tooltip-'.concat(e.config.chart.type,'">')+"<div>".concat(c[0],': <span class="value">')+A+"</span></div>"+"<div>".concat(c[1],': <span class="value">')+r+"</span></div>"+(y?"<div>".concat(c[2],': <span class="value">')+y+"</span></div>":"")+"<div>".concat(c[3],': <span class="value">')+b+"</span></div>"+"<div>".concat(c[4],': <span class="value">')+_+"</span></div></div>"}}]),a}(),qy=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"init",value:function(e){var t=e.responsiveOverride,s=this.opts,c=new lg,h=new Ky(s);this.chartType=s.chart.type,s=this.extendYAxis(s),s=this.extendAnnotations(s);var A=c.init(),r={};if(s&&Am(s)==="object"){var y,b,_,B,I,E,R,M,G,U,Q={};Q=["line","area","bar","candlestick","boxPlot","rangeBar","rangeArea","bubble","scatter","heatmap","treemap","pie","polarArea","donut","radar","radialBar"].indexOf(s.chart.type)!==-1?h[s.chart.type]():h.line(),(y=s.plotOptions)!==null&&y!==void 0&&(b=y.bar)!==null&&b!==void 0&&b.isFunnel&&(Q=h.funnel()),s.chart.stacked&&s.chart.type==="bar"&&(Q=h.stackedBars()),(_=s.chart.brush)!==null&&_!==void 0&&_.enabled&&(Q=h.brush(Q)),(B=s.plotOptions)!==null&&B!==void 0&&(I=B.line)!==null&&I!==void 0&&I.isSlopeChart&&(Q=h.slope()),s.chart.stacked&&s.chart.stackType==="100%"&&(s=h.stacked100(s)),(E=s.plotOptions)!==null&&E!==void 0&&(R=E.bar)!==null&&R!==void 0&&R.isDumbbell&&(s=h.dumbbell(s)),this.checkForDarkTheme(window.Apex),this.checkForDarkTheme(s),s.xaxis=s.xaxis||window.Apex.xaxis||{},t||(s.xaxis.convertedCatToNumeric=!1),((M=(s=this.checkForCatToNumericXAxis(this.chartType,Q,s)).chart.sparkline)!==null&&M!==void 0&&M.enabled||(G=window.Apex.chart)!==null&&G!==void 0&&(U=G.sparkline)!==null&&U!==void 0&&U.enabled)&&(Q=h.sparkline(Q)),r=ni.extend(A,Q)}var q=ni.extend(r,window.Apex);return A=ni.extend(q,s),A=this.handleUserInputErrors(A)}},{key:"checkForCatToNumericXAxis",value:function(e,t,s){var c,h,A=new Ky(s),r=(e==="bar"||e==="boxPlot")&&((c=s.plotOptions)===null||c===void 0||(h=c.bar)===null||h===void 0?void 0:h.horizontal),y=e==="pie"||e==="polarArea"||e==="donut"||e==="radar"||e==="radialBar"||e==="heatmap",b=s.xaxis.type!=="datetime"&&s.xaxis.type!=="numeric",_=s.xaxis.tickPlacement?s.xaxis.tickPlacement:t.xaxis&&t.xaxis.tickPlacement;return r||y||!b||_==="between"||(s=A.convertCatToNumeric(s)),s}},{key:"extendYAxis",value:function(e,t){var s=new lg;(e.yaxis===void 0||!e.yaxis||Array.isArray(e.yaxis)&&e.yaxis.length===0)&&(e.yaxis={}),e.yaxis.constructor!==Array&&window.Apex.yaxis&&window.Apex.yaxis.constructor!==Array&&(e.yaxis=ni.extend(e.yaxis,window.Apex.yaxis)),e.yaxis.constructor!==Array?e.yaxis=[ni.extend(s.yAxis,e.yaxis)]:e.yaxis=ni.extendArray(e.yaxis,s.yAxis);var c=!1;e.yaxis.forEach(function(A){A.logarithmic&&(c=!0)});var h=e.series;return t&&!h&&(h=t.config.series),c&&h.length!==e.yaxis.length&&h.length&&(e.yaxis=h.map(function(A,r){if(A.name||(h[r].name="series-".concat(r+1)),e.yaxis[r])return e.yaxis[r].seriesName=h[r].name,e.yaxis[r];var y=ni.extend(s.yAxis,e.yaxis[0]);return y.show=!1,y})),c&&h.length>1&&h.length!==e.yaxis.length&&console.warn("A multi-series logarithmic chart should have equal number of series and y-axes"),e}},{key:"extendAnnotations",value:function(e){return e.annotations===void 0&&(e.annotations={},e.annotations.yaxis=[],e.annotations.xaxis=[],e.annotations.points=[]),e=this.extendYAxisAnnotations(e),e=this.extendXAxisAnnotations(e),e=this.extendPointAnnotations(e)}},{key:"extendYAxisAnnotations",value:function(e){var t=new lg;return e.annotations.yaxis=ni.extendArray(e.annotations.yaxis!==void 0?e.annotations.yaxis:[],t.yAxisAnnotation),e}},{key:"extendXAxisAnnotations",value:function(e){var t=new lg;return e.annotations.xaxis=ni.extendArray(e.annotations.xaxis!==void 0?e.annotations.xaxis:[],t.xAxisAnnotation),e}},{key:"extendPointAnnotations",value:function(e){var t=new lg;return e.annotations.points=ni.extendArray(e.annotations.points!==void 0?e.annotations.points:[],t.pointAnnotation),e}},{key:"checkForDarkTheme",value:function(e){e.theme&&e.theme.mode==="dark"&&(e.tooltip||(e.tooltip={}),e.tooltip.theme!=="light"&&(e.tooltip.theme="dark"),e.chart.foreColor||(e.chart.foreColor="#f6f7f8"),e.theme.palette||(e.theme.palette="palette4"))}},{key:"handleUserInputErrors",value:function(e){var t=e;if(t.tooltip.shared&&t.tooltip.intersect)throw new Error("tooltip.shared cannot be enabled when tooltip.intersect is true. Turn off any other option by setting it to false.");if(t.chart.type==="bar"&&t.plotOptions.bar.horizontal){if(t.yaxis.length>1)throw new Error("Multiple Y Axis for bars are not supported. Switch to column chart by setting plotOptions.bar.horizontal=false");t.yaxis[0].reversed&&(t.yaxis[0].opposite=!0),t.xaxis.tooltip.enabled=!1,t.yaxis[0].tooltip.enabled=!1,t.chart.zoom.enabled=!1}return t.chart.type!=="bar"&&t.chart.type!=="rangeBar"||t.tooltip.shared&&t.xaxis.crosshairs.width==="barWidth"&&t.series.length>1&&(t.xaxis.crosshairs.width="tickWidth"),t.chart.type!=="candlestick"&&t.chart.type!=="boxPlot"||t.yaxis[0].reversed&&(console.warn("Reversed y-axis in ".concat(t.chart.type," chart is not supported.")),t.yaxis[0].reversed=!1),t}}]),a}(),pT=function(){function a(){en(this,a)}return tn(a,[{key:"initGlobalVars",value:function(e){e.series=[],e.seriesCandleO=[],e.seriesCandleH=[],e.seriesCandleM=[],e.seriesCandleL=[],e.seriesCandleC=[],e.seriesRangeStart=[],e.seriesRangeEnd=[],e.seriesRange=[],e.seriesPercent=[],e.seriesGoals=[],e.seriesX=[],e.seriesZ=[],e.seriesNames=[],e.seriesTotals=[],e.seriesLog=[],e.seriesColors=[],e.stackedSeriesTotals=[],e.seriesXvalues=[],e.seriesYvalues=[],e.labels=[],e.hasXaxisGroups=!1,e.groups=[],e.barGroups=[],e.lineGroups=[],e.areaGroups=[],e.hasSeriesGroups=!1,e.seriesGroups=[],e.categoryLabels=[],e.timescaleLabels=[],e.noLabelsProvided=!1,e.resizeTimer=null,e.selectionResizeTimer=null,e.lastWheelExecution=0,e.delayedElements=[],e.pointsArray=[],e.dataLabelsRects=[],e.isXNumeric=!1,e.skipLastTimelinelabel=!1,e.skipFirstTimelinelabel=!1,e.isDataXYZ=!1,e.isMultiLineX=!1,e.isMultipleYAxis=!1,e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE,e.minYArr=[],e.maxYArr=[],e.maxX=-Number.MAX_VALUE,e.minX=Number.MAX_VALUE,e.initialMaxX=-Number.MAX_VALUE,e.initialMinX=Number.MAX_VALUE,e.maxDate=0,e.minDate=Number.MAX_VALUE,e.minZ=Number.MAX_VALUE,e.maxZ=-Number.MAX_VALUE,e.minXDiff=Number.MAX_VALUE,e.yAxisScale=[],e.xAxisScale=null,e.xAxisTicksPositions=[],e.yLabelsCoords=[],e.yTitleCoords=[],e.barPadForNumericAxis=0,e.padHorizontal=0,e.xRange=0,e.yRange=[],e.zRange=0,e.dataPoints=0,e.xTickAmount=0,e.multiAxisTickAmount=0}},{key:"globalVars",value:function(e){return{chartID:null,cuid:null,events:{beforeMount:[],mounted:[],updated:[],clicked:[],selection:[],dataPointSelection:[],zoomed:[],scrolled:[]},colors:[],clientX:null,clientY:null,fill:{colors:[]},stroke:{colors:[]},dataLabels:{style:{colors:[]}},radarPolygons:{fill:{colors:[]}},markers:{colors:[],size:e.markers.size,largestSize:0},animationEnded:!1,isTouchDevice:"ontouchstart"in window||navigator.msMaxTouchPoints,isDirty:!1,isExecCalled:!1,initialConfig:null,initialSeries:[],lastXAxis:[],lastYAxis:[],columnSeries:null,labels:[],timescaleLabels:[],noLabelsProvided:!1,allSeriesCollapsed:!1,collapsedSeries:[],collapsedSeriesIndices:[],ancillaryCollapsedSeries:[],ancillaryCollapsedSeriesIndices:[],risingSeries:[],dataFormatXNumeric:!1,capturedSeriesIndex:-1,capturedDataPointIndex:-1,selectedDataPoints:[],invalidLogScale:!1,ignoreYAxisIndexes:[],maxValsInArrayIndex:0,radialSize:0,selection:void 0,zoomEnabled:e.chart.toolbar.autoSelected==="zoom"&&e.chart.toolbar.tools.zoom&&e.chart.zoom.enabled,panEnabled:e.chart.toolbar.autoSelected==="pan"&&e.chart.toolbar.tools.pan,selectionEnabled:e.chart.toolbar.autoSelected==="selection"&&e.chart.toolbar.tools.selection,yaxis:null,mousedown:!1,lastClientPosition:{},visibleXRange:void 0,yValueDecimal:0,total:0,SVGNS:"http://www.w3.org/2000/svg",svgWidth:0,svgHeight:0,noData:!1,locale:{},dom:{},memory:{methodsToExec:[]},shouldAnimate:!0,skipLastTimelinelabel:!1,skipFirstTimelinelabel:!1,delayedElements:[],axisCharts:!0,isDataXYZ:!1,isSlopeChart:e.plotOptions.line.isSlopeChart,resized:!1,resizeTimer:null,comboCharts:!1,dataChanged:!1,previousPaths:[],allSeriesHasEqualX:!0,pointsArray:[],dataLabelsRects:[],lastDrawnDataLabelsIndexes:[],hasNullValues:!1,zoomed:!1,gridWidth:0,gridHeight:0,rotateXLabels:!1,defaultLabels:!1,xLabelFormatter:void 0,yLabelFormatters:[],xaxisTooltipFormatter:void 0,ttKeyFormatter:void 0,ttVal:void 0,ttZFormatter:void 0,LINE_HEIGHT_RATIO:1.618,xAxisLabelsHeight:0,xAxisGroupLabelsHeight:0,xAxisLabelsWidth:0,yAxisLabelsWidth:0,scaleX:1,scaleY:1,translateX:0,translateY:0,translateYAxisX:[],yAxisWidths:[],translateXAxisY:0,translateXAxisX:0,tooltip:null,niceScaleAllowedMagMsd:[[1,1,2,5,5,5,10,10,10,10,10],[1,1,2,5,5,5,10,10,10,10,10]],niceScaleDefaultTicks:[1,2,4,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,12,12,12,12,12,12,12,12,12,24],seriesYAxisMap:[],seriesYAxisReverseMap:[]}}},{key:"init",value:function(e){var t=this.globalVars(e);return this.initGlobalVars(t),t.initialConfig=ni.extend({},e),t.initialSeries=ni.clone(e.series),t.lastXAxis=ni.clone(t.initialConfig.xaxis),t.lastYAxis=ni.clone(t.initialConfig.yaxis),t}}]),a}(),ID=function(){function a(e){en(this,a),this.opts=e}return tn(a,[{key:"init",value:function(){var e=new qy(this.opts).init({responsiveOverride:!1});return{config:e,globals:new pT().init(e)}}}]),a}(),qd=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.opts=null,this.seriesIndex=0,this.patternIDs=[]}return tn(a,[{key:"clippedImgArea",value:function(e){var t=this.w,s=t.config,c=parseInt(t.globals.gridWidth,10),h=parseInt(t.globals.gridHeight,10),A=c>h?c:h,r=e.image,y=0,b=0;e.width===void 0&&e.height===void 0?s.fill.image.width!==void 0&&s.fill.image.height!==void 0?(y=s.fill.image.width+1,b=s.fill.image.height):(y=A+1,b=A):(y=e.width,b=e.height);var _=document.createElementNS(t.globals.SVGNS,"pattern");hr.setAttrs(_,{id:e.patternID,patternUnits:e.patternUnits?e.patternUnits:"userSpaceOnUse",width:y+"px",height:b+"px"});var B=document.createElementNS(t.globals.SVGNS,"image");_.appendChild(B),B.setAttributeNS(window.SVG.xlink,"href",r),hr.setAttrs(B,{x:0,y:0,preserveAspectRatio:"none",width:y+"px",height:b+"px"}),B.style.opacity=e.opacity,t.globals.dom.elDefs.node.appendChild(_)}},{key:"getSeriesIndex",value:function(e){var t=this.w,s=t.config.chart.type;return(s==="bar"||s==="rangeBar")&&t.config.plotOptions.bar.distributed||s==="heatmap"||s==="treemap"?this.seriesIndex=e.seriesNumber:this.seriesIndex=e.seriesNumber%t.globals.series.length,this.seriesIndex}},{key:"computeColorStops",value:function(e,t){var s,c=this.w,h=null,A=null,r=yy(e);try{for(r.s();!(s=r.n()).done;){var y=s.value;y>=t.threshold?(h===null||y>h)&&(h=y):(A===null||y<A)&&(A=y)}}catch(B){r.e(B)}finally{r.f()}h===null&&(h=t.threshold),A===null&&(A=t.threshold);var b=h-t.threshold+(t.threshold-A);b===0&&(b=1);var _=100-(t.threshold-A)/b*100;return[{offset:_=Math.max(0,Math.min(_,100)),color:t.colorAboveThreshold,opacity:c.config.fill.opacity},{offset:0,color:t.colorBelowThreshold,opacity:c.config.fill.opacity}]}},{key:"fillPath",value:function(e){var t,s,c,h=this.w;this.opts=e;var A,r,y,b=this.w.config;this.seriesIndex=this.getSeriesIndex(e);var _=b.plotOptions.line.colors.colorAboveThreshold&&b.plotOptions.line.colors.colorBelowThreshold,B=this.getFillColors()[this.seriesIndex];h.globals.seriesColors[this.seriesIndex]!==void 0&&(B=h.globals.seriesColors[this.seriesIndex]),typeof B=="function"&&(B=B({seriesIndex:this.seriesIndex,dataPointIndex:e.dataPointIndex,value:e.value,w:h}));var I,E,R,M=e.fillType?e.fillType:this.getFillType(this.seriesIndex),G=Array.isArray(b.fill.opacity)?b.fill.opacity[this.seriesIndex]:b.fill.opacity,U=M==="gradient"||_;e.color&&(B=e.color),(t=h.config.series[this.seriesIndex])!==null&&t!==void 0&&(s=t.data)!==null&&s!==void 0&&(c=s[e.dataPointIndex])!==null&&c!==void 0&&c.fillColor&&(B=(I=h.config.series[this.seriesIndex])===null||I===void 0||(E=I.data)===null||E===void 0||(R=E[e.dataPointIndex])===null||R===void 0?void 0:R.fillColor),B||(B="#fff",console.warn("undefined color - ApexCharts"));var Q=B;if(B.indexOf("rgb")===-1?B.indexOf("#")===-1?Q=B:B.length<9&&(Q=ni.hexToRgba(B,G)):B.indexOf("rgba")>-1?G=ni.getOpacityFromRGBA(B):Q=ni.hexToRgba(ni.rgb2hex(B),G),e.opacity&&(G=e.opacity),M==="pattern"&&(r=this.handlePatternFill({fillConfig:e.fillConfig,patternFill:r,fillColor:B,fillOpacity:G,defaultColor:Q})),U){var q=Jl(b.fill.gradient.colorStops)||[],ne=b.fill.gradient.type;_&&(q[this.seriesIndex]=this.computeColorStops(h.globals.series[this.seriesIndex],b.plotOptions.line.colors),ne="vertical"),y=this.handleGradientFill({type:ne,fillConfig:e.fillConfig,fillColor:B,fillOpacity:G,colorStops:q,i:this.seriesIndex})}if(M==="image"){var re=b.fill.image.src,pe=e.patternID?e.patternID:"",Ae="pattern".concat(h.globals.cuid).concat(e.seriesNumber+1).concat(pe);this.patternIDs.indexOf(Ae)===-1&&(this.clippedImgArea({opacity:G,image:Array.isArray(re)?e.seriesNumber<re.length?re[e.seriesNumber]:re[0]:re,width:e.width?e.width:void 0,height:e.height?e.height:void 0,patternUnits:e.patternUnits,patternID:Ae}),this.patternIDs.push(Ae)),A="url(#".concat(Ae,")")}else A=U?y:M==="pattern"?r:Q;return e.solid&&(A=Q),A}},{key:"getFillType",value:function(e){var t=this.w;return Array.isArray(t.config.fill.type)?t.config.fill.type[e]:t.config.fill.type}},{key:"getFillColors",value:function(){var e=this.w,t=e.config,s=this.opts,c=[];return e.globals.comboCharts?e.config.series[this.seriesIndex].type==="line"?Array.isArray(e.globals.stroke.colors)?c=e.globals.stroke.colors:c.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?c=e.globals.fill.colors:c.push(e.globals.fill.colors):t.chart.type==="line"?Array.isArray(e.globals.stroke.colors)?c=e.globals.stroke.colors:c.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?c=e.globals.fill.colors:c.push(e.globals.fill.colors),s.fillColors!==void 0&&(c=[],Array.isArray(s.fillColors)?c=s.fillColors.slice():c.push(s.fillColors)),c}},{key:"handlePatternFill",value:function(e){var t=e.fillConfig,s=e.patternFill,c=e.fillColor,h=e.fillOpacity,A=e.defaultColor,r=this.w.config.fill;t&&(r=t);var y=this.opts,b=new hr(this.ctx),_=Array.isArray(r.pattern.strokeWidth)?r.pattern.strokeWidth[this.seriesIndex]:r.pattern.strokeWidth,B=c;return Array.isArray(r.pattern.style)?s=r.pattern.style[y.seriesNumber]!==void 0?b.drawPattern(r.pattern.style[y.seriesNumber],r.pattern.width,r.pattern.height,B,_,h):A:s=b.drawPattern(r.pattern.style,r.pattern.width,r.pattern.height,B,_,h),s}},{key:"handleGradientFill",value:function(e){var t=e.type,s=e.fillColor,c=e.fillOpacity,h=e.fillConfig,A=e.colorStops,r=e.i,y=this.w.config.fill;h&&(y=Ir(Ir({},y),h));var b=this.opts,_=new hr(this.ctx),B=new ni;t=t||y.gradient.type;var I,E=s,R=y.gradient.opacityFrom===void 0?c:Array.isArray(y.gradient.opacityFrom)?y.gradient.opacityFrom[r]:y.gradient.opacityFrom;E.indexOf("rgba")>-1&&(R=ni.getOpacityFromRGBA(E));var M=y.gradient.opacityTo===void 0?c:Array.isArray(y.gradient.opacityTo)?y.gradient.opacityTo[r]:y.gradient.opacityTo;if(y.gradient.gradientToColors===void 0||y.gradient.gradientToColors.length===0)I=y.gradient.shade==="dark"?B.shadeColor(-1*parseFloat(y.gradient.shadeIntensity),s.indexOf("rgb")>-1?ni.rgb2hex(s):s):B.shadeColor(parseFloat(y.gradient.shadeIntensity),s.indexOf("rgb")>-1?ni.rgb2hex(s):s);else if(y.gradient.gradientToColors[b.seriesNumber]){var G=y.gradient.gradientToColors[b.seriesNumber];I=G,G.indexOf("rgba")>-1&&(M=ni.getOpacityFromRGBA(G))}else I=s;if(y.gradient.gradientFrom&&(E=y.gradient.gradientFrom),y.gradient.gradientTo&&(I=y.gradient.gradientTo),y.gradient.inverseColors){var U=E;E=I,I=U}return E.indexOf("rgb")>-1&&(E=ni.rgb2hex(E)),I.indexOf("rgb")>-1&&(I=ni.rgb2hex(I)),_.drawGradient(t,E,I,R,M,b.size,y.gradient.stops,A,r)}}]),a}(),wm=function(){function a(e,t){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"setGlobalMarkerSize",value:function(){var e=this.w;if(e.globals.markers.size=Array.isArray(e.config.markers.size)?e.config.markers.size:[e.config.markers.size],e.globals.markers.size.length>0){if(e.globals.markers.size.length<e.globals.series.length+1)for(var t=0;t<=e.globals.series.length;t++)e.globals.markers.size[t]===void 0&&e.globals.markers.size.push(e.globals.markers.size[0])}else e.globals.markers.size=e.config.series.map(function(s){return e.config.markers.size})}},{key:"plotChartMarkers",value:function(e){var t=e.pointsPos,s=e.seriesIndex,c=e.j,h=e.pSize,A=e.alwaysDrawMarker,r=A!==void 0&&A,y=e.isVirtualPoint,b=y!==void 0&&y,_=this.w,B=s,I=t,E=null,R=new hr(this.ctx),M=_.config.markers.discrete&&_.config.markers.discrete.length;if(Array.isArray(I.x))for(var G=0;G<I.x.length;G++){var U=void 0,Q=c,q=!ni.isNumber(I.y[G]);_.globals.markers.largestSize===0&&_.globals.hasNullValues&&_.globals.series[B][c+1]!==null&&!b&&(q=!0),c===1&&G===0&&(Q=0),c===1&&G===1&&(Q=1);var ne="apexcharts-marker";if(_.config.chart.type!=="line"&&_.config.chart.type!=="area"||_.globals.comboCharts||_.config.tooltip.intersect||(ne+=" no-pointer-events"),(Array.isArray(_.config.markers.size)?_.globals.markers.size[s]>0:_.config.markers.size>0)||r||M){q||(ne+=" w".concat(ni.randomId()));var re=this.getMarkerConfig({cssClass:ne,seriesIndex:s,dataPointIndex:Q});_.config.series[B].data[Q]&&(_.config.series[B].data[Q].fillColor&&(re.pointFillColor=_.config.series[B].data[Q].fillColor),_.config.series[B].data[Q].strokeColor&&(re.pointStrokeColor=_.config.series[B].data[Q].strokeColor)),h!==void 0&&(re.pSize=h),(I.x[G]<-_.globals.markers.largestSize||I.x[G]>_.globals.gridWidth+_.globals.markers.largestSize||I.y[G]<-_.globals.markers.largestSize||I.y[G]>_.globals.gridHeight+_.globals.markers.largestSize)&&(re.pSize=0),!q&&((_.globals.markers.size[s]>0||r||M)&&!E&&(E=R.group({class:r||M?"":"apexcharts-series-markers"})).attr("clip-path","url(#gridRectMarkerMask".concat(_.globals.cuid,")")),(U=R.drawMarker(I.x[G],I.y[G],re)).attr("rel",Q),U.attr("j",Q),U.attr("index",s),U.node.setAttribute("default-marker-size",re.pSize),new Uc(this.ctx).setSelectionFilter(U,s,Q),this.addEvents(U),E&&E.add(U))}else _.globals.pointsArray[s]===void 0&&(_.globals.pointsArray[s]=[]),_.globals.pointsArray[s].push([I.x[G],I.y[G]])}return E}},{key:"getMarkerConfig",value:function(e){var t=e.cssClass,s=e.seriesIndex,c=e.dataPointIndex,h=c===void 0?null:c,A=e.radius,r=A===void 0?null:A,y=e.size,b=y===void 0?null:y,_=e.strokeWidth,B=_===void 0?null:_,I=this.w,E=this.getMarkerStyle(s),R=b===null?I.globals.markers.size[s]:b,M=I.config.markers;return h!==null&&M.discrete.length&&M.discrete.map(function(G){G.seriesIndex===s&&G.dataPointIndex===h&&(E.pointStrokeColor=G.strokeColor,E.pointFillColor=G.fillColor,R=G.size,E.pointShape=G.shape)}),{pSize:r===null?R:r,pRadius:r!==null?r:M.radius,pointStrokeWidth:B!==null?B:Array.isArray(M.strokeWidth)?M.strokeWidth[s]:M.strokeWidth,pointStrokeColor:E.pointStrokeColor,pointFillColor:E.pointFillColor,shape:E.pointShape||(Array.isArray(M.shape)?M.shape[s]:M.shape),class:t,pointStrokeOpacity:Array.isArray(M.strokeOpacity)?M.strokeOpacity[s]:M.strokeOpacity,pointStrokeDashArray:Array.isArray(M.strokeDashArray)?M.strokeDashArray[s]:M.strokeDashArray,pointFillOpacity:Array.isArray(M.fillOpacity)?M.fillOpacity[s]:M.fillOpacity,seriesIndex:s}}},{key:"addEvents",value:function(e){var t=this.w,s=new hr(this.ctx);e.node.addEventListener("mouseenter",s.pathMouseEnter.bind(this.ctx,e)),e.node.addEventListener("mouseleave",s.pathMouseLeave.bind(this.ctx,e)),e.node.addEventListener("mousedown",s.pathMouseDown.bind(this.ctx,e)),e.node.addEventListener("click",t.config.markers.onClick),e.node.addEventListener("dblclick",t.config.markers.onDblClick),e.node.addEventListener("touchstart",s.pathMouseDown.bind(this.ctx,e),{passive:!0})}},{key:"getMarkerStyle",value:function(e){var t=this.w,s=t.globals.markers.colors,c=t.config.markers.strokeColor||t.config.markers.strokeColors;return{pointStrokeColor:Array.isArray(c)?c[e]:c,pointFillColor:Array.isArray(s)?s[e]:s}}}]),a}(),gT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.initialAnim=this.w.config.chart.animations.enabled}return tn(a,[{key:"draw",value:function(e,t,s){var c=this.w,h=new hr(this.ctx),A=s.realIndex,r=s.pointsPos,y=s.zRatio,b=s.elParent,_=h.group({class:"apexcharts-series-markers apexcharts-series-".concat(c.config.chart.type)});if(_.attr("clip-path","url(#gridRectMarkerMask".concat(c.globals.cuid,")")),Array.isArray(r.x))for(var B=0;B<r.x.length;B++){var I=t+1,E=!0;t===0&&B===0&&(I=0),t===0&&B===1&&(I=1);var R=c.globals.markers.size[A];if(y!==1/0){var M=c.config.plotOptions.bubble;R=c.globals.seriesZ[A][I],M.zScaling&&(R/=y),M.minBubbleRadius&&R<M.minBubbleRadius&&(R=M.minBubbleRadius),M.maxBubbleRadius&&R>M.maxBubbleRadius&&(R=M.maxBubbleRadius)}var G=r.x[B],U=r.y[B];if(R=R||0,U!==null&&c.globals.series[A][I]!==void 0||(E=!1),E){var Q=this.drawPoint(G,U,R,A,I,t);_.add(Q)}b.add(_)}}},{key:"drawPoint",value:function(e,t,s,c,h,A){var r=this.w,y=c,b=new vm(this.ctx),_=new Uc(this.ctx),B=new qd(this.ctx),I=new wm(this.ctx),E=new hr(this.ctx),R=I.getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:y,dataPointIndex:h,radius:r.config.chart.type==="bubble"||r.globals.comboCharts&&r.config.series[c]&&r.config.series[c].type==="bubble"?s:null}),M=B.fillPath({seriesNumber:c,dataPointIndex:h,color:R.pointFillColor,patternUnits:"objectBoundingBox",value:r.globals.series[c][A]}),G=E.drawMarker(e,t,R);if(r.config.series[y].data[h]&&r.config.series[y].data[h].fillColor&&(M=r.config.series[y].data[h].fillColor),G.attr({fill:M}),r.config.chart.dropShadow.enabled){var U=r.config.chart.dropShadow;_.dropShadow(G,U,c)}if(!this.initialAnim||r.globals.dataChanged||r.globals.resized)r.globals.animationEnded=!0;else{var Q=r.config.chart.animations.speed;b.animateMarker(G,Q,r.globals.easing,function(){window.setTimeout(function(){b.animationCompleted(G)},100)})}return G.attr({rel:h,j:h,index:c,"default-marker-size":R.pSize}),_.setSelectionFilter(G,c,h),I.addEvents(G),G.node.classList.add("apexcharts-marker"),G}},{key:"centerTextInBubble",value:function(e){var t=this.w;return{y:e+=parseInt(t.config.dataLabels.style.fontSize,10)/4}}}]),a}(),pm=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"dataLabelsCorrection",value:function(e,t,s,c,h,A,r){var y=this.w,b=!1,_=new hr(this.ctx).getTextRects(s,r),B=_.width,I=_.height;t<0&&(t=0),t>y.globals.gridHeight+I&&(t=y.globals.gridHeight+I/2),y.globals.dataLabelsRects[c]===void 0&&(y.globals.dataLabelsRects[c]=[]),y.globals.dataLabelsRects[c].push({x:e,y:t,width:B,height:I});var E=y.globals.dataLabelsRects[c].length-2,R=y.globals.lastDrawnDataLabelsIndexes[c]!==void 0?y.globals.lastDrawnDataLabelsIndexes[c][y.globals.lastDrawnDataLabelsIndexes[c].length-1]:0;if(y.globals.dataLabelsRects[c][E]!==void 0){var M=y.globals.dataLabelsRects[c][R];(e>M.x+M.width||t>M.y+M.height||t+I<M.y||e+B<M.x)&&(b=!0)}return(h===0||A)&&(b=!0),{x:e,y:t,textRects:_,drawnextLabel:b}}},{key:"drawDataLabel",value:function(e){var t=this,s=e.type,c=e.pos,h=e.i,A=e.j,r=e.isRangeStart,y=e.strokeWidth,b=y===void 0?2:y,_=this.w,B=new hr(this.ctx),I=_.config.dataLabels,E=0,R=0,M=A,G=null;if(_.globals.collapsedSeriesIndices.indexOf(h)!==-1||!I.enabled||!Array.isArray(c.x))return G;G=B.group({class:"apexcharts-data-labels"});for(var U=0;U<c.x.length;U++)if(E=c.x[U]+I.offsetX,R=c.y[U]+I.offsetY+b,!isNaN(E)){A===1&&U===0&&(M=0),A===1&&U===1&&(M=1);var Q=_.globals.series[h][M];s==="rangeArea"&&(Q=r?_.globals.seriesRangeStart[h][M]:_.globals.seriesRangeEnd[h][M]);var q="",ne=function(pe){return _.config.dataLabels.formatter(pe,{ctx:t.ctx,seriesIndex:h,dataPointIndex:M,w:_})};_.config.chart.type==="bubble"?(q=ne(Q=_.globals.seriesZ[h][M]),R=c.y[U],R=new gT(this.ctx).centerTextInBubble(R,h,M).y):Q!==void 0&&(q=ne(Q));var re=_.config.dataLabels.textAnchor;_.globals.isSlopeChart&&(re=M===0?"end":M===_.config.series[h].data.length-1?"start":"middle"),this.plotDataLabelsText({x:E,y:R,text:q,i:h,j:M,parent:G,offsetCorrection:!0,dataLabelsConfig:_.config.dataLabels,textAnchor:re})}return G}},{key:"plotDataLabelsText",value:function(e){var t=this.w,s=new hr(this.ctx),c=e.x,h=e.y,A=e.i,r=e.j,y=e.text,b=e.textAnchor,_=e.fontSize,B=e.parent,I=e.dataLabelsConfig,E=e.color,R=e.alwaysDrawDataLabel,M=e.offsetCorrection,G=e.className,U=null;if(Array.isArray(t.config.dataLabels.enabledOnSeries)&&t.config.dataLabels.enabledOnSeries.indexOf(A)<0)return U;var Q={x:c,y:h,drawnextLabel:!0,textRects:null};M&&(Q=this.dataLabelsCorrection(c,h,y,A,r,R,parseInt(I.style.fontSize,10))),t.globals.zoomed||(c=Q.x,h=Q.y),Q.textRects&&(c<-20-Q.textRects.width||c>t.globals.gridWidth+Q.textRects.width+30)&&(y="");var q=t.globals.dataLabels.style.colors[A];((t.config.chart.type==="bar"||t.config.chart.type==="rangeBar")&&t.config.plotOptions.bar.distributed||t.config.dataLabels.distributed)&&(q=t.globals.dataLabels.style.colors[r]),typeof q=="function"&&(q=q({series:t.globals.series,seriesIndex:A,dataPointIndex:r,w:t})),E&&(q=E);var ne=I.offsetX,re=I.offsetY;if(t.config.chart.type!=="bar"&&t.config.chart.type!=="rangeBar"||(ne=0,re=0),t.globals.isSlopeChart&&(r!==0&&(ne=-2*I.offsetX+5),r!==0&&r!==t.config.series[A].data.length-1&&(ne=0)),Q.drawnextLabel){if((U=s.drawText({width:100,height:parseInt(I.style.fontSize,10),x:c+ne,y:h+re,foreColor:q,textAnchor:b||I.textAnchor,text:y,fontSize:_||I.style.fontSize,fontFamily:I.style.fontFamily,fontWeight:I.style.fontWeight||"normal"})).attr({class:G||"apexcharts-datalabel",cx:c,cy:h}),I.dropShadow.enabled){var pe=I.dropShadow;new Uc(this.ctx).dropShadow(U,pe)}B.add(U),t.globals.lastDrawnDataLabelsIndexes[A]===void 0&&(t.globals.lastDrawnDataLabelsIndexes[A]=[]),t.globals.lastDrawnDataLabelsIndexes[A].push(r)}return U}},{key:"addBackgroundToDataLabel",value:function(e,t){var s=this.w,c=s.config.dataLabels.background,h=c.padding,A=c.padding/2,r=t.width,y=t.height,b=new hr(this.ctx).drawRect(t.x-h,t.y-A/2,r+2*h,y+A,c.borderRadius,s.config.chart.background!=="transparent"&&s.config.chart.background?s.config.chart.background:"#fff",c.opacity,c.borderWidth,c.borderColor);return c.dropShadow.enabled&&new Uc(this.ctx).dropShadow(b,c.dropShadow),b}},{key:"dataLabelsBackground",value:function(){var e=this.w;if(e.config.chart.type!=="bubble")for(var t=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text"),s=0;s<t.length;s++){var c=t[s],h=c.getBBox(),A=null;if(h.width&&h.height&&(A=this.addBackgroundToDataLabel(c,h)),A){c.parentNode.insertBefore(A.node,c);var r=e.config.dataLabels.background.backgroundColor||c.getAttribute("fill");e.config.chart.animations.enabled&&!e.globals.resized&&!e.globals.dataChanged?A.animate().attr({fill:r}):A.attr({fill:r}),c.setAttribute("fill",e.config.dataLabels.background.foreColor)}}}},{key:"bringForward",value:function(){for(var e=this.w,t=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),s=e.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child"),c=0;c<t.length;c++)s&&s.insertBefore(t[c],s.nextSibling)}}]),a}(),ld=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.legendInactiveClass="legend-mouseover-inactive"}return tn(a,[{key:"getAllSeriesEls",value:function(){return this.w.globals.dom.baseEl.getElementsByClassName("apexcharts-series")}},{key:"getSeriesByName",value:function(e){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner .apexcharts-series[seriesName='".concat(ni.escapeString(e),"']"))}},{key:"isSeriesHidden",value:function(e){var t=this.getSeriesByName(e),s=parseInt(t.getAttribute("data:realIndex"),10);return{isHidden:t.classList.contains("apexcharts-series-collapsed"),realIndex:s}}},{key:"addCollapsedClassToSeries",value:function(e,t){var s=this.w;function c(h){for(var A=0;A<h.length;A++)h[A].index===t&&e.node.classList.add("apexcharts-series-collapsed")}c(s.globals.collapsedSeries),c(s.globals.ancillaryCollapsedSeries)}},{key:"toggleSeries",value:function(e){var t=this.isSeriesHidden(e);return this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,t.isHidden),t.isHidden}},{key:"showSeries",value:function(e){var t=this.isSeriesHidden(e);t.isHidden&&this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,!0)}},{key:"hideSeries",value:function(e){var t=this.isSeriesHidden(e);t.isHidden||this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,!1)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],c=this.w,h=ni.clone(c.globals.initialSeries);c.globals.previousPaths=[],s?(c.globals.collapsedSeries=[],c.globals.ancillaryCollapsedSeries=[],c.globals.collapsedSeriesIndices=[],c.globals.ancillaryCollapsedSeriesIndices=[]):h=this.emptyCollapsedSeries(h),c.config.series=h,e&&(t&&(c.globals.zoomed=!1,this.ctx.updateHelpers.revertDefaultAxisMinMax()),this.ctx.updateHelpers._updateSeries(h,c.config.chart.animations.dynamicAnimation.enabled))}},{key:"emptyCollapsedSeries",value:function(e){for(var t=this.w,s=0;s<e.length;s++)t.globals.collapsedSeriesIndices.indexOf(s)>-1&&(e[s].data=[]);return e}},{key:"highlightSeries",value:function(e){var t=this.w,s=this.getSeriesByName(e),c=parseInt(s==null?void 0:s.getAttribute("data:realIndex"),10),h=t.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis"),A=null,r=null,y=null;if(t.globals.axisCharts||t.config.chart.type==="radialBar")if(t.globals.axisCharts){A=t.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(c,"']")),r=t.globals.dom.baseEl.querySelector(".apexcharts-datalabels[data\\:realIndex='".concat(c,"']"));var b=t.globals.seriesYAxisReverseMap[c];y=t.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(b,"']"))}else A=t.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(c+1,"']"));else A=t.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(c+1,"'] path"));for(var _=0;_<h.length;_++)h[_].classList.add(this.legendInactiveClass);if(A)t.globals.axisCharts||A.parentNode.classList.remove(this.legendInactiveClass),A.classList.remove(this.legendInactiveClass),r!==null&&r.classList.remove(this.legendInactiveClass),y!==null&&y.classList.remove(this.legendInactiveClass);else for(var B=0;B<h.length;B++)h[B].classList.remove(this.legendInactiveClass)}},{key:"toggleSeriesOnHover",value:function(e,t){var s=this.w;t||(t=e.target);var c=s.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis");if(e.type==="mousemove"){var h=parseInt(t.getAttribute("rel"),10)-1;this.highlightSeries(s.globals.seriesNames[h])}else if(e.type==="mouseout")for(var A=0;A<c.length;A++)c[A].classList.remove(this.legendInactiveClass)}},{key:"highlightRangeInSeries",value:function(e,t){var s=this,c=this.w,h=c.globals.dom.baseEl.getElementsByClassName("apexcharts-heatmap-rect"),A=function(b){for(var _=0;_<h.length;_++)h[_].classList[b](s.legendInactiveClass)};if(e.type==="mousemove"){var r=parseInt(t.getAttribute("rel"),10)-1;A("add");var y=c.config.plotOptions.heatmap.colorScale.ranges;(function(b,_){for(var B=0;B<h.length;B++){var I=Number(h[B].getAttribute("val"));I>=b.from&&(I<b.to||b.to===_&&I===_)&&h[B].classList.remove(s.legendInactiveClass)}})(y[r],y.reduce(function(b,_){return Math.max(b,_.to)},0))}else e.type==="mouseout"&&A("remove")}},{key:"getActiveConfigSeriesIndex",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"asc",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=this.w,c=0;if(s.config.series.length>1){for(var h=s.config.series.map(function(r,y){return r.data&&r.data.length>0&&s.globals.collapsedSeriesIndices.indexOf(y)===-1&&(!s.globals.comboCharts||t.length===0||t.length&&t.indexOf(s.config.series[y].type)>-1)?y:-1}),A=e==="asc"?0:h.length-1;e==="asc"?A<h.length:A>=0;e==="asc"?A++:A--)if(h[A]!==-1){c=h[A];break}}return c}},{key:"getBarSeriesIndices",value:function(){return this.w.globals.comboCharts?this.w.config.series.map(function(e,t){return e.type==="bar"||e.type==="column"?t:-1}).filter(function(e){return e!==-1}):this.w.config.series.map(function(e,t){return t})}},{key:"getPreviousPaths",value:function(){var e=this.w;function t(A,r,y){for(var b=A[r].childNodes,_={type:y,paths:[],realIndex:A[r].getAttribute("data:realIndex")},B=0;B<b.length;B++)if(b[B].hasAttribute("pathTo")){var I=b[B].getAttribute("pathTo");_.paths.push({d:I})}e.globals.previousPaths.push(_)}e.globals.previousPaths=[],["line","area","bar","rangebar","rangeArea","candlestick","radar"].forEach(function(A){for(var r,y=(r=A,e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r,"-series .apexcharts-series"))),b=0;b<y.length;b++)t(y,b,A)});var s=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series"));if(s.length>0)for(var c=function(A){for(var r=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series[data\\:realIndex='").concat(A,"'] rect")),y=[],b=function(B){var I=function(R){return r[B].getAttribute(R)},E={x:parseFloat(I("x")),y:parseFloat(I("y")),width:parseFloat(I("width")),height:parseFloat(I("height"))};y.push({rect:E,color:r[B].getAttribute("color")})},_=0;_<r.length;_++)b(_);e.globals.previousPaths.push(y)},h=0;h<s.length;h++)c(h);e.globals.axisCharts||(e.globals.previousPaths=e.globals.series)}},{key:"clearPreviousPaths",value:function(){var e=this.w;e.globals.previousPaths=[],e.globals.allSeriesCollapsed=!1}},{key:"handleNoData",value:function(){var e=this.w,t=e.config.noData,s=new hr(this.ctx),c=e.globals.svgWidth/2,h=e.globals.svgHeight/2,A="middle";if(e.globals.noData=!0,e.globals.animationEnded=!0,t.align==="left"?(c=10,A="start"):t.align==="right"&&(c=e.globals.svgWidth-10,A="end"),t.verticalAlign==="top"?h=50:t.verticalAlign==="bottom"&&(h=e.globals.svgHeight-50),c+=t.offsetX,h=h+parseInt(t.style.fontSize,10)+2+t.offsetY,t.text!==void 0&&t.text!==""){var r=s.drawText({x:c,y:h,text:t.text,textAnchor:A,fontSize:t.style.fontSize,fontFamily:t.style.fontFamily,foreColor:t.style.color,opacity:1,class:"apexcharts-text-nodata"});e.globals.dom.Paper.add(r)}}},{key:"setNullSeriesToZeroValues",value:function(e){for(var t=this.w,s=0;s<e.length;s++)if(e[s].length===0)for(var c=0;c<e[t.globals.maxValsInArrayIndex].length;c++)e[s].push(0);return e}},{key:"hasAllSeriesEqualX",value:function(){for(var e=!0,t=this.w,s=this.filteredSeriesX(),c=0;c<s.length-1;c++)if(s[c][0]!==s[c+1][0]){e=!1;break}return t.globals.allSeriesHasEqualX=e,e}},{key:"filteredSeriesX",value:function(){var e=this.w.globals.seriesX.map(function(t){return t.length>0?t:[]});return e}}]),a}(),hw=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.twoDSeries=[],this.threeDSeries=[],this.twoDSeriesX=[],this.seriesGoals=[],this.coreUtils=new sl(this.ctx)}return tn(a,[{key:"isMultiFormat",value:function(){return this.isFormatXY()||this.isFormat2DArray()}},{key:"isFormatXY",value:function(){var e=this.w.config.series.slice(),t=new ld(this.ctx);if(this.activeSeriesIndex=t.getActiveConfigSeriesIndex(),e[this.activeSeriesIndex].data!==void 0&&e[this.activeSeriesIndex].data.length>0&&e[this.activeSeriesIndex].data[0]!==null&&e[this.activeSeriesIndex].data[0].x!==void 0&&e[this.activeSeriesIndex].data[0]!==null)return!0}},{key:"isFormat2DArray",value:function(){var e=this.w.config.series.slice(),t=new ld(this.ctx);if(this.activeSeriesIndex=t.getActiveConfigSeriesIndex(),e[this.activeSeriesIndex].data!==void 0&&e[this.activeSeriesIndex].data.length>0&&e[this.activeSeriesIndex].data[0]!==void 0&&e[this.activeSeriesIndex].data[0]!==null&&e[this.activeSeriesIndex].data[0].constructor===Array)return!0}},{key:"handleFormat2DArray",value:function(e,t){for(var s=this.w.config,c=this.w.globals,h=s.chart.type==="boxPlot"||s.series[t].type==="boxPlot",A=0;A<e[t].data.length;A++)if(e[t].data[A][1]!==void 0&&(Array.isArray(e[t].data[A][1])&&e[t].data[A][1].length===4&&!h?this.twoDSeries.push(ni.parseNumber(e[t].data[A][1][3])):e[t].data[A].length>=5?this.twoDSeries.push(ni.parseNumber(e[t].data[A][4])):this.twoDSeries.push(ni.parseNumber(e[t].data[A][1])),c.dataFormatXNumeric=!0),s.xaxis.type==="datetime"){var r=new Date(e[t].data[A][0]);r=new Date(r).getTime(),this.twoDSeriesX.push(r)}else this.twoDSeriesX.push(e[t].data[A][0]);for(var y=0;y<e[t].data.length;y++)e[t].data[y][2]!==void 0&&(this.threeDSeries.push(e[t].data[y][2]),c.isDataXYZ=!0)}},{key:"handleFormatXY",value:function(e,t){var s=this.w.config,c=this.w.globals,h=new Oc(this.ctx),A=t;c.collapsedSeriesIndices.indexOf(t)>-1&&(A=this.activeSeriesIndex);for(var r=0;r<e[t].data.length;r++)e[t].data[r].y!==void 0&&(Array.isArray(e[t].data[r].y)?this.twoDSeries.push(ni.parseNumber(e[t].data[r].y[e[t].data[r].y.length-1])):this.twoDSeries.push(ni.parseNumber(e[t].data[r].y))),e[t].data[r].goals!==void 0&&Array.isArray(e[t].data[r].goals)?(this.seriesGoals[t]===void 0&&(this.seriesGoals[t]=[]),this.seriesGoals[t].push(e[t].data[r].goals)):(this.seriesGoals[t]===void 0&&(this.seriesGoals[t]=[]),this.seriesGoals[t].push(null));for(var y=0;y<e[A].data.length;y++){var b=typeof e[A].data[y].x=="string",_=Array.isArray(e[A].data[y].x),B=!_&&!!h.isValidDate(e[A].data[y].x);if(b||B)if(b||s.xaxis.convertedCatToNumeric){var I=c.isBarHorizontal&&c.isRangeData;s.xaxis.type!=="datetime"||I?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[A].data[y].x),isNaN(e[A].data[y].x)||this.w.config.xaxis.type==="category"||typeof e[A].data[y].x=="string"||(c.isXNumeric=!0)):this.twoDSeriesX.push(h.parseDate(e[A].data[y].x))}else s.xaxis.type==="datetime"?this.twoDSeriesX.push(h.parseDate(e[A].data[y].x.toString())):(c.dataFormatXNumeric=!0,c.isXNumeric=!0,this.twoDSeriesX.push(parseFloat(e[A].data[y].x)));else _?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[A].data[y].x)):(c.isXNumeric=!0,c.dataFormatXNumeric=!0,this.twoDSeriesX.push(e[A].data[y].x))}if(e[t].data[0]&&e[t].data[0].z!==void 0){for(var E=0;E<e[t].data.length;E++)this.threeDSeries.push(e[t].data[E].z);c.isDataXYZ=!0}}},{key:"handleRangeData",value:function(e,t){var s=this.w.globals,c={};return this.isFormat2DArray()?c=this.handleRangeDataFormat("array",e,t):this.isFormatXY()&&(c=this.handleRangeDataFormat("xy",e,t)),s.seriesRangeStart[t]=c.start===void 0?[]:c.start,s.seriesRangeEnd[t]=c.end===void 0?[]:c.end,s.seriesRange[t]=c.rangeUniques,s.seriesRange.forEach(function(h,A){h&&h.forEach(function(r,y){r.y.forEach(function(b,_){for(var B=0;B<r.y.length;B++)if(_!==B){var I=b.y1,E=b.y2,R=r.y[B].y1;I<=r.y[B].y2&&R<=E&&(r.overlaps.indexOf(b.rangeName)<0&&r.overlaps.push(b.rangeName),r.overlaps.indexOf(r.y[B].rangeName)<0&&r.overlaps.push(r.y[B].rangeName))}})})}),c}},{key:"handleCandleStickBoxData",value:function(e,t){var s=this.w.globals,c={};return this.isFormat2DArray()?c=this.handleCandleStickBoxDataFormat("array",e,t):this.isFormatXY()&&(c=this.handleCandleStickBoxDataFormat("xy",e,t)),s.seriesCandleO[t]=c.o,s.seriesCandleH[t]=c.h,s.seriesCandleM[t]=c.m,s.seriesCandleL[t]=c.l,s.seriesCandleC[t]=c.c,c}},{key:"handleRangeDataFormat",value:function(e,t,s){var c=[],h=[],A=t[s].data.filter(function(_,B,I){return B===I.findIndex(function(E){return E.x===_.x})}).map(function(_,B){return{x:_.x,overlaps:[],y:[]}});if(e==="array")for(var r=0;r<t[s].data.length;r++)Array.isArray(t[s].data[r])?(c.push(t[s].data[r][1][0]),h.push(t[s].data[r][1][1])):(c.push(t[s].data[r]),h.push(t[s].data[r]));else if(e==="xy")for(var y=function(_){var B=Array.isArray(t[s].data[_].y),I=ni.randomId(),E=t[s].data[_].x,R={y1:B?t[s].data[_].y[0]:t[s].data[_].y,y2:B?t[s].data[_].y[1]:t[s].data[_].y,rangeName:I};t[s].data[_].rangeName=I;var M=A.findIndex(function(G){return G.x===E});A[M].y.push(R),c.push(R.y1),h.push(R.y2)},b=0;b<t[s].data.length;b++)y(b);return{start:c,end:h,rangeUniques:A}}},{key:"handleCandleStickBoxDataFormat",value:function(e,t,s){var c=this.w,h=c.config.chart.type==="boxPlot"||c.config.series[s].type==="boxPlot",A=[],r=[],y=[],b=[],_=[];if(e==="array")if(h&&t[s].data[0].length===6||!h&&t[s].data[0].length===5)for(var B=0;B<t[s].data.length;B++)A.push(t[s].data[B][1]),r.push(t[s].data[B][2]),h?(y.push(t[s].data[B][3]),b.push(t[s].data[B][4]),_.push(t[s].data[B][5])):(b.push(t[s].data[B][3]),_.push(t[s].data[B][4]));else for(var I=0;I<t[s].data.length;I++)Array.isArray(t[s].data[I][1])&&(A.push(t[s].data[I][1][0]),r.push(t[s].data[I][1][1]),h?(y.push(t[s].data[I][1][2]),b.push(t[s].data[I][1][3]),_.push(t[s].data[I][1][4])):(b.push(t[s].data[I][1][2]),_.push(t[s].data[I][1][3])));else if(e==="xy")for(var E=0;E<t[s].data.length;E++)Array.isArray(t[s].data[E].y)&&(A.push(t[s].data[E].y[0]),r.push(t[s].data[E].y[1]),h?(y.push(t[s].data[E].y[2]),b.push(t[s].data[E].y[3]),_.push(t[s].data[E].y[4])):(b.push(t[s].data[E].y[2]),_.push(t[s].data[E].y[3])));return{o:A,h:r,m:y,l:b,c:_}}},{key:"parseDataAxisCharts",value:function(e){var t=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.ctx,c=this.w.config,h=this.w.globals,A=new Oc(s),r=c.labels.length>0?c.labels.slice():c.xaxis.categories.slice();h.isRangeBar=c.chart.type==="rangeBar"&&h.isBarHorizontal,h.hasXaxisGroups=c.xaxis.type==="category"&&c.xaxis.group.groups.length>0,h.hasXaxisGroups&&(h.groups=c.xaxis.group.groups),e.forEach(function(E,R){E.name!==void 0?h.seriesNames.push(E.name):h.seriesNames.push("series-"+parseInt(R+1,10))}),this.coreUtils.setSeriesYAxisMappings();var y=[],b=Jl(new Set(c.series.map(function(E){return E.group})));c.series.forEach(function(E,R){var M=b.indexOf(E.group);y[M]||(y[M]=[]),y[M].push(h.seriesNames[R])}),h.seriesGroups=y;for(var _=function(){for(var E=0;E<r.length;E++)if(typeof r[E]=="string"){if(!A.isValidDate(r[E]))throw new Error("You have provided invalid Date format. Please provide a valid JavaScript Date");t.twoDSeriesX.push(A.parseDate(r[E]))}else t.twoDSeriesX.push(r[E])},B=0;B<e.length;B++){if(this.twoDSeries=[],this.twoDSeriesX=[],this.threeDSeries=[],e[B].data===void 0)return void console.error("It is a possibility that you may have not included 'data' property in series.");if(c.chart.type!=="rangeBar"&&c.chart.type!=="rangeArea"&&e[B].type!=="rangeBar"&&e[B].type!=="rangeArea"||(h.isRangeData=!0,this.handleRangeData(e,B)),this.isMultiFormat())this.isFormat2DArray()?this.handleFormat2DArray(e,B):this.isFormatXY()&&this.handleFormatXY(e,B),c.chart.type!=="candlestick"&&e[B].type!=="candlestick"&&c.chart.type!=="boxPlot"&&e[B].type!=="boxPlot"||this.handleCandleStickBoxData(e,B),h.series.push(this.twoDSeries),h.labels.push(this.twoDSeriesX),h.seriesX.push(this.twoDSeriesX),h.seriesGoals=this.seriesGoals,B!==this.activeSeriesIndex||this.fallbackToCategory||(h.isXNumeric=!0);else{c.xaxis.type==="datetime"?(h.isXNumeric=!0,_(),h.seriesX.push(this.twoDSeriesX)):c.xaxis.type==="numeric"&&(h.isXNumeric=!0,r.length>0&&(this.twoDSeriesX=r,h.seriesX.push(this.twoDSeriesX))),h.labels.push(this.twoDSeriesX);var I=e[B].data.map(function(E){return ni.parseNumber(E)});h.series.push(I)}h.seriesZ.push(this.threeDSeries),e[B].color!==void 0?h.seriesColors.push(e[B].color):h.seriesColors.push(void 0)}return this.w}},{key:"parseDataNonAxisCharts",value:function(e){var t=this.w.globals,s=this.w.config;t.series=e.slice(),t.seriesNames=s.labels.slice();for(var c=0;c<t.series.length;c++)t.seriesNames[c]===void 0&&t.seriesNames.push("series-"+(c+1));return this.w}},{key:"handleExternalLabelsData",value:function(e){var t=this.w.config,s=this.w.globals;t.xaxis.categories.length>0?s.labels=t.xaxis.categories:t.labels.length>0?s.labels=t.labels.slice():this.fallbackToCategory?(s.labels=s.labels[0],s.seriesRange.length&&(s.seriesRange.map(function(c){c.forEach(function(h){s.labels.indexOf(h.x)<0&&h.x&&s.labels.push(h.x)})}),s.labels=Array.from(new Set(s.labels.map(JSON.stringify)),JSON.parse)),t.xaxis.convertedCatToNumeric&&(new Ky(t).convertCatToNumericXaxis(t,this.ctx,s.seriesX[0]),this._generateExternalLabels(e))):this._generateExternalLabels(e)}},{key:"_generateExternalLabels",value:function(e){var t=this.w.globals,s=this.w.config,c=[];if(t.axisCharts){if(t.series.length>0)if(this.isFormatXY())for(var h=s.series.map(function(B,I){return B.data.filter(function(E,R,M){return M.findIndex(function(G){return G.x===E.x})===R})}),A=h.reduce(function(B,I,E,R){return R[B].length>I.length?B:E},0),r=0;r<h[A].length;r++)c.push(r+1);else for(var y=0;y<t.series[t.maxValsInArrayIndex].length;y++)c.push(y+1);t.seriesX=[];for(var b=0;b<e.length;b++)t.seriesX.push(c);this.w.globals.isBarHorizontal||(t.isXNumeric=!0)}if(c.length===0){c=t.axisCharts?[]:t.series.map(function(B,I){return I+1});for(var _=0;_<e.length;_++)t.seriesX.push(c)}t.labels=c,s.xaxis.convertedCatToNumeric&&(t.categoryLabels=c.map(function(B){return s.xaxis.labels.formatter(B)})),t.noLabelsProvided=!0}},{key:"parseData",value:function(e){var t=this.w,s=t.config,c=t.globals;if(this.excludeCollapsedSeriesInYAxis(),this.fallbackToCategory=!1,this.ctx.core.resetGlobals(),this.ctx.core.isMultipleY(),c.axisCharts?(this.parseDataAxisCharts(e),this.coreUtils.getLargestSeries()):this.parseDataNonAxisCharts(e),s.chart.stacked){var h=new ld(this.ctx);c.series=h.setNullSeriesToZeroValues(c.series)}this.coreUtils.getSeriesTotals(),c.axisCharts&&(c.stackedSeriesTotals=this.coreUtils.getStackedSeriesTotals(),c.stackedSeriesTotalsByGroups=this.coreUtils.getStackedSeriesTotalsByGroups()),this.coreUtils.getPercentSeries(),c.dataFormatXNumeric||c.isXNumeric&&(s.xaxis.type!=="numeric"||s.labels.length!==0||s.xaxis.categories.length!==0)||this.handleExternalLabelsData(e);for(var A=this.coreUtils.getCategoryLabels(c.labels),r=0;r<A.length;r++)if(Array.isArray(A[r])){c.isMultiLineX=!0;break}}},{key:"excludeCollapsedSeriesInYAxis",value:function(){var e=this.w,t=[];e.globals.seriesYAxisMap.forEach(function(s,c){var h=0;s.forEach(function(A){e.globals.collapsedSeriesIndices.indexOf(A)!==-1&&h++}),h>0&&h==s.length&&t.push(c)}),e.globals.ignoreYAxisIndexes=t.map(function(s){return s})}}]),a}(),Ly=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"svgStringToNode",value:function(e){return new DOMParser().parseFromString(e,"image/svg+xml").documentElement}},{key:"scaleSvgNode",value:function(e,t){var s=parseFloat(e.getAttributeNS(null,"width")),c=parseFloat(e.getAttributeNS(null,"height"));e.setAttributeNS(null,"width",s*t),e.setAttributeNS(null,"height",c*t),e.setAttributeNS(null,"viewBox","0 0 "+s+" "+c)}},{key:"getSvgString",value:function(e){var t=this;return new Promise(function(s){var c=t.w,h=e||c.config.chart.toolbar.export.scale||c.config.chart.toolbar.export.width/c.globals.svgWidth;h||(h=1);var A=c.globals.svgWidth*h,r=c.globals.svgHeight*h,y=c.globals.dom.elWrap.cloneNode(!0);y.style.width=A+"px",y.style.height=r+"px";var b=new XMLSerializer().serializeToString(y),_=`
        <svg xmlns="http://www.w3.org/2000/svg"
          version="1.1"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          class="apexcharts-svg"
          xmlns:data="ApexChartsNS"
          transform="translate(0, 0)"
          width="`.concat(c.globals.svgWidth,'px" height="').concat(c.globals.svgHeight,`px">
          <foreignObject width="100%" height="100%">
            <div xmlns="http://www.w3.org/1999/xhtml" style="width:`).concat(A,"px; height:").concat(r,`px;">
            <style type="text/css">
              .apexcharts-tooltip, .apexcharts-toolbar, .apexcharts-xaxistooltip, .apexcharts-yaxistooltip, .apexcharts-xcrosshairs, .apexcharts-ycrosshairs, .apexcharts-zoom-rect, .apexcharts-selection-rect {
                display: none;
              }
            </style>
              `).concat(b,`
            </div>
          </foreignObject>
        </svg>
      `),B=t.svgStringToNode(_);h!==1&&t.scaleSvgNode(B,h),t.convertImagesToBase64(B).then(function(){_=new XMLSerializer().serializeToString(B),s(_.replace(/&nbsp;/g,"&#160;"))})})}},{key:"convertImagesToBase64",value:function(e){var t=this,s=e.getElementsByTagName("image"),c=Array.from(s).map(function(h){var A=h.getAttributeNS("http://www.w3.org/1999/xlink","href");return A&&!A.startsWith("data:")?t.getBase64FromUrl(A).then(function(r){h.setAttributeNS("http://www.w3.org/1999/xlink","href",r)}).catch(function(r){console.error("Error converting image to base64:",r)}):Promise.resolve()});return Promise.all(c)}},{key:"getBase64FromUrl",value:function(e){return new Promise(function(t,s){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var h=document.createElement("canvas");h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0),t(h.toDataURL())},c.onerror=s,c.src=e})}},{key:"svgUrl",value:function(){var e=this;return new Promise(function(t){e.getSvgString().then(function(s){var c=new Blob([s],{type:"image/svg+xml;charset=utf-8"});t(URL.createObjectURL(c))})})}},{key:"dataURI",value:function(e){var t=this;return new Promise(function(s){var c=t.w,h=e?e.scale||e.width/c.globals.svgWidth:1,A=document.createElement("canvas");A.width=c.globals.svgWidth*h,A.height=parseInt(c.globals.dom.elWrap.style.height,10)*h;var r=c.config.chart.background!=="transparent"&&c.config.chart.background?c.config.chart.background:"#fff",y=A.getContext("2d");y.fillStyle=r,y.fillRect(0,0,A.width*h,A.height*h),t.getSvgString(h).then(function(b){var _="data:image/svg+xml,"+encodeURIComponent(b),B=new Image;B.crossOrigin="anonymous",B.onload=function(){if(y.drawImage(B,0,0),A.msToBlob){var I=A.msToBlob();s({blob:I})}else{var E=A.toDataURL("image/png");s({imgURI:E})}},B.src=_})})}},{key:"exportToSVG",value:function(){var e=this;this.svgUrl().then(function(t){e.triggerDownload(t,e.w.config.chart.toolbar.export.svg.filename,".svg")})}},{key:"exportToPng",value:function(){var e=this,t=this.w.config.chart.toolbar.export.scale,s=this.w.config.chart.toolbar.export.width,c=t?{scale:t}:s?{width:s}:void 0;this.dataURI(c).then(function(h){var A=h.imgURI,r=h.blob;r?navigator.msSaveOrOpenBlob(r,e.w.globals.chartID+".png"):e.triggerDownload(A,e.w.config.chart.toolbar.export.png.filename,".png")})}},{key:"exportToCSV",value:function(e){var t=this,s=e.series,c=e.fileName,h=e.columnDelimiter,A=h===void 0?",":h,r=e.lineDelimiter,y=r===void 0?`
`:r,b=this.w;s||(s=b.config.series);var _=[],B=[],I="",E=b.globals.series.map(function(re,pe){return b.globals.collapsedSeriesIndices.indexOf(pe)===-1?re:[]}),R=function(re){return typeof b.config.chart.toolbar.export.csv.categoryFormatter=="function"?b.config.chart.toolbar.export.csv.categoryFormatter(re):b.config.xaxis.type==="datetime"&&String(re).length>=10?new Date(re).toDateString():ni.isNumber(re)?re:re.split(A).join("")},M=function(re){return typeof b.config.chart.toolbar.export.csv.valueFormatter=="function"?b.config.chart.toolbar.export.csv.valueFormatter(re):re},G=Math.max.apply(Math,Jl(s.map(function(re){return re.data?re.data.length:0}))),U=new hw(this.ctx),Q=new Mp(this.ctx),q=function(re){var pe="";if(b.globals.axisCharts){if(b.config.xaxis.type==="category"||b.config.xaxis.convertedCatToNumeric)if(b.globals.isBarHorizontal){var Ae=b.globals.yLabelFormatters[0],le=new ld(t.ctx).getActiveConfigSeriesIndex();pe=Ae(b.globals.labels[re],{seriesIndex:le,dataPointIndex:re,w:b})}else pe=Q.getLabel(b.globals.labels,b.globals.timescaleLabels,0,re).text;b.config.xaxis.type==="datetime"&&(b.config.xaxis.categories.length?pe=b.config.xaxis.categories[re]:b.config.labels.length&&(pe=b.config.labels[re]))}else pe=b.config.labels[re];return pe===null?"nullvalue":(Array.isArray(pe)&&(pe=pe.join(" ")),ni.isNumber(pe)?pe:pe.split(A).join(""))},ne=function(re,pe){if(_.length&&pe===0&&B.push(_.join(A)),re.data){re.data=re.data.length&&re.data||Jl(Array(G)).map(function(){return""});for(var Ae=0;Ae<re.data.length;Ae++){_=[];var le=q(Ae);if(le!=="nullvalue"){if(le||(U.isFormatXY()?le=s[pe].data[Ae].x:U.isFormat2DArray()&&(le=s[pe].data[Ae]?s[pe].data[Ae][0]:"")),pe===0){_.push(R(le));for(var be=0;be<b.globals.series.length;be++){var we,oe=U.isFormatXY()?(we=s[be].data[Ae])===null||we===void 0?void 0:we.y:E[be][Ae];_.push(M(oe))}}(b.config.chart.type==="candlestick"||re.type&&re.type==="candlestick")&&(_.pop(),_.push(b.globals.seriesCandleO[pe][Ae]),_.push(b.globals.seriesCandleH[pe][Ae]),_.push(b.globals.seriesCandleL[pe][Ae]),_.push(b.globals.seriesCandleC[pe][Ae])),(b.config.chart.type==="boxPlot"||re.type&&re.type==="boxPlot")&&(_.pop(),_.push(b.globals.seriesCandleO[pe][Ae]),_.push(b.globals.seriesCandleH[pe][Ae]),_.push(b.globals.seriesCandleM[pe][Ae]),_.push(b.globals.seriesCandleL[pe][Ae]),_.push(b.globals.seriesCandleC[pe][Ae])),b.config.chart.type==="rangeBar"&&(_.pop(),_.push(b.globals.seriesRangeStart[pe][Ae]),_.push(b.globals.seriesRangeEnd[pe][Ae])),_.length&&B.push(_.join(A))}}}};_.push(b.config.chart.toolbar.export.csv.headerCategory),b.config.chart.type==="boxPlot"?(_.push("minimum"),_.push("q1"),_.push("median"),_.push("q3"),_.push("maximum")):b.config.chart.type==="candlestick"?(_.push("open"),_.push("high"),_.push("low"),_.push("close")):b.config.chart.type==="rangeBar"?(_.push("minimum"),_.push("maximum")):s.map(function(re,pe){var Ae=(re.name?re.name:"series-".concat(pe))+"";b.globals.axisCharts&&_.push(Ae.split(A).join("")?Ae.split(A).join(""):"series-".concat(pe))}),b.globals.axisCharts||(_.push(b.config.chart.toolbar.export.csv.headerValue),B.push(_.join(A))),b.globals.allSeriesHasEqualX||!b.globals.axisCharts||b.config.xaxis.categories.length||b.config.labels.length?s.map(function(re,pe){b.globals.axisCharts?ne(re,pe):((_=[]).push(R(b.globals.labels[pe])),_.push(M(E[pe])),B.push(_.join(A)))}):function(){var re=new Set,pe={};s.forEach(function(Ae,le){Ae==null||Ae.data.forEach(function(be){var we,oe;if(U.isFormatXY())we=be.x,oe=be.y;else{if(!U.isFormat2DArray())return;we=be[0],oe=be[1]}pe[we]||(pe[we]=Array(s.length).fill("")),pe[we][le]=M(oe),re.add(we)})}),_.length&&B.push(_.join(A)),Array.from(re).sort().forEach(function(Ae){B.push([R(Ae),pe[Ae].join(A)])})}(),I+=B.join(y),this.triggerDownload("data:text/csv; charset=utf-8,"+encodeURIComponent("\uFEFF"+I),c||b.config.chart.toolbar.export.csv.filename,".csv")}},{key:"triggerDownload",value:function(e,t,s){var c=document.createElement("a");c.href=e,c.download=(t||this.w.globals.chartID)+s,document.body.appendChild(c),c.click(),document.body.removeChild(c)}}]),a}(),$y=function(){function a(e,t){en(this,a),this.ctx=e,this.elgrid=t,this.w=e.w;var s=this.w;this.axesUtils=new Mp(e),this.xaxisLabels=s.globals.labels.slice(),s.globals.timescaleLabels.length>0&&!s.globals.isBarHorizontal&&(this.xaxisLabels=s.globals.timescaleLabels.slice()),s.config.xaxis.overwriteCategories&&(this.xaxisLabels=s.config.xaxis.overwriteCategories),this.drawnLabels=[],this.drawnLabelsRects=[],s.config.xaxis.position==="top"?this.offY=0:this.offY=s.globals.gridHeight,this.offY=this.offY+s.config.xaxis.axisBorder.offsetY,this.isCategoryBarHorizontal=s.config.chart.type==="bar"&&s.config.plotOptions.bar.horizontal,this.xaxisFontSize=s.config.xaxis.labels.style.fontSize,this.xaxisFontFamily=s.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=s.config.xaxis.labels.style.colors,this.xaxisBorderWidth=s.config.xaxis.axisBorder.width,this.isCategoryBarHorizontal&&(this.xaxisBorderWidth=s.config.yaxis[0].axisBorder.width.toString()),this.xaxisBorderWidth.indexOf("%")>-1?this.xaxisBorderWidth=s.globals.gridWidth*parseInt(this.xaxisBorderWidth,10)/100:this.xaxisBorderWidth=parseInt(this.xaxisBorderWidth,10),this.xaxisBorderHeight=s.config.xaxis.axisBorder.height,this.yaxis=s.config.yaxis[0]}return tn(a,[{key:"drawXaxis",value:function(){var e=this.w,t=new hr(this.ctx),s=t.group({class:"apexcharts-xaxis",transform:"translate(".concat(e.config.xaxis.offsetX,", ").concat(e.config.xaxis.offsetY,")")}),c=t.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(e.globals.translateXAxisX,", ").concat(e.globals.translateXAxisY,")")});s.add(c);for(var h=[],A=0;A<this.xaxisLabels.length;A++)h.push(this.xaxisLabels[A]);if(this.drawXAxisLabelAndGroup(!0,t,c,h,e.globals.isXNumeric,function(R,M){return M}),e.globals.hasXaxisGroups){var r=e.globals.groups;h=[];for(var y=0;y<r.length;y++)h.push(r[y].title);var b={};e.config.xaxis.group.style&&(b.xaxisFontSize=e.config.xaxis.group.style.fontSize,b.xaxisFontFamily=e.config.xaxis.group.style.fontFamily,b.xaxisForeColors=e.config.xaxis.group.style.colors,b.fontWeight=e.config.xaxis.group.style.fontWeight,b.cssClass=e.config.xaxis.group.style.cssClass),this.drawXAxisLabelAndGroup(!1,t,c,h,!1,function(R,M){return r[R].cols*M},b)}if(e.config.xaxis.title.text!==void 0){var _=t.group({class:"apexcharts-xaxis-title"}),B=t.drawText({x:e.globals.gridWidth/2+e.config.xaxis.title.offsetX,y:this.offY+parseFloat(this.xaxisFontSize)+(e.config.xaxis.position==="bottom"?e.globals.xAxisLabelsHeight:-e.globals.xAxisLabelsHeight-10)+e.config.xaxis.title.offsetY,text:e.config.xaxis.title.text,textAnchor:"middle",fontSize:e.config.xaxis.title.style.fontSize,fontFamily:e.config.xaxis.title.style.fontFamily,fontWeight:e.config.xaxis.title.style.fontWeight,foreColor:e.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+e.config.xaxis.title.style.cssClass});_.add(B),s.add(_)}if(e.config.xaxis.axisBorder.show){var I=e.globals.barPadForNumericAxis,E=t.drawLine(e.globals.padHorizontal+e.config.xaxis.axisBorder.offsetX-I,this.offY,this.xaxisBorderWidth+I,this.offY,e.config.xaxis.axisBorder.color,0,this.xaxisBorderHeight);this.elgrid&&this.elgrid.elGridBorders&&e.config.grid.show?this.elgrid.elGridBorders.add(E):s.add(E)}return s}},{key:"drawXAxisLabelAndGroup",value:function(e,t,s,c,h,A){var r,y=this,b=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},_=[],B=[],I=this.w,E=b.xaxisFontSize||this.xaxisFontSize,R=b.xaxisFontFamily||this.xaxisFontFamily,M=b.xaxisForeColors||this.xaxisForeColors,G=b.fontWeight||I.config.xaxis.labels.style.fontWeight,U=b.cssClass||I.config.xaxis.labels.style.cssClass,Q=I.globals.padHorizontal,q=c.length,ne=I.config.xaxis.type==="category"?I.globals.dataPoints:q;if(ne===0&&q>ne&&(ne=q),h){var re=Math.max(Number(I.config.xaxis.tickAmount)||1,ne>1?ne-1:ne);r=I.globals.gridWidth/Math.min(re,q-1),Q=Q+A(0,r)/2+I.config.xaxis.labels.offsetX}else r=I.globals.gridWidth/ne,Q=Q+A(0,r)+I.config.xaxis.labels.offsetX;for(var pe=function(le){var be=Q-A(le,r)/2+I.config.xaxis.labels.offsetX;le===0&&q===1&&r/2===Q&&ne===1&&(be=I.globals.gridWidth/2);var we=y.axesUtils.getLabel(c,I.globals.timescaleLabels,be,le,_,E,e),oe=28;if(I.globals.rotateXLabels&&e&&(oe=22),I.config.xaxis.title.text&&I.config.xaxis.position==="top"&&(oe+=parseFloat(I.config.xaxis.title.style.fontSize)+2),e||(oe=oe+parseFloat(E)+(I.globals.xAxisLabelsHeight-I.globals.xAxisGroupLabelsHeight)+(I.globals.rotateXLabels?10:0)),we=I.config.xaxis.tickAmount!==void 0&&I.config.xaxis.tickAmount!=="dataPoints"&&I.config.xaxis.type!=="datetime"?y.axesUtils.checkLabelBasedOnTickamount(le,we,q):y.axesUtils.checkForOverflowingLabels(le,we,q,_,B),I.config.xaxis.labels.show){var me=t.drawText({x:we.x,y:y.offY+I.config.xaxis.labels.offsetY+oe-(I.config.xaxis.position==="top"?I.globals.xAxisHeight+I.config.xaxis.axisTicks.height-2:0),text:we.text,textAnchor:"middle",fontWeight:we.isBold?600:G,fontSize:E,fontFamily:R,foreColor:Array.isArray(M)?e&&I.config.xaxis.convertedCatToNumeric?M[I.globals.minX+le-1]:M[le]:M,isPlainText:!1,cssClass:(e?"apexcharts-xaxis-label ":"apexcharts-xaxis-group-label ")+U});if(s.add(me),me.on("click",function(Se){if(typeof I.config.chart.events.xAxisLabelClick=="function"){var Me=Object.assign({},I,{labelIndex:le});I.config.chart.events.xAxisLabelClick(Se,y.ctx,Me)}}),e){var Le=document.createElementNS(I.globals.SVGNS,"title");Le.textContent=Array.isArray(we.text)?we.text.join(" "):we.text,me.node.appendChild(Le),we.text!==""&&(_.push(we.text),B.push(we))}}le<q-1&&(Q+=A(le+1,r))},Ae=0;Ae<=q-1;Ae++)pe(Ae)}},{key:"drawXaxisInversed",value:function(e){var t,s,c=this,h=this.w,A=new hr(this.ctx),r=h.config.yaxis[0].opposite?h.globals.translateYAxisX[e]:0,y=A.group({class:"apexcharts-yaxis apexcharts-xaxis-inversed",rel:e}),b=A.group({class:"apexcharts-yaxis-texts-g apexcharts-xaxis-inversed-texts-g",transform:"translate("+r+", 0)"});y.add(b);var _=[];if(h.config.yaxis[e].show)for(var B=0;B<this.xaxisLabels.length;B++)_.push(this.xaxisLabels[B]);t=h.globals.gridHeight/_.length,s=-t/2.2;var I=h.globals.yLabelFormatters[0],E=h.config.yaxis[0].labels;if(E.show)for(var R=function(re){var pe=_[re]===void 0?"":_[re];pe=I(pe,{seriesIndex:e,dataPointIndex:re,w:h});var Ae=c.axesUtils.getYAxisForeColor(E.style.colors,e),le=0;Array.isArray(pe)&&(le=pe.length/2*parseInt(E.style.fontSize,10));var be=E.offsetX-15,we="end";c.yaxis.opposite&&(we="start"),h.config.yaxis[0].labels.align==="left"?(be=E.offsetX,we="start"):h.config.yaxis[0].labels.align==="center"?(be=E.offsetX,we="middle"):h.config.yaxis[0].labels.align==="right"&&(we="end");var oe=A.drawText({x:be,y:s+t+E.offsetY-le,text:pe,textAnchor:we,foreColor:Array.isArray(Ae)?Ae[re]:Ae,fontSize:E.style.fontSize,fontFamily:E.style.fontFamily,fontWeight:E.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+E.style.cssClass,maxWidth:E.maxWidth});b.add(oe),oe.on("click",function(Se){if(typeof h.config.chart.events.xAxisLabelClick=="function"){var Me=Object.assign({},h,{labelIndex:re});h.config.chart.events.xAxisLabelClick(Se,c.ctx,Me)}});var me=document.createElementNS(h.globals.SVGNS,"title");if(me.textContent=Array.isArray(pe)?pe.join(" "):pe,oe.node.appendChild(me),h.config.yaxis[e].labels.rotate!==0){var Le=A.rotateAroundCenter(oe.node);oe.node.setAttribute("transform","rotate(".concat(h.config.yaxis[e].labels.rotate," 0 ").concat(Le.y,")"))}s+=t},M=0;M<=_.length-1;M++)R(M);if(h.config.yaxis[0].title.text!==void 0){var G=A.group({class:"apexcharts-yaxis-title apexcharts-xaxis-title-inversed",transform:"translate("+r+", 0)"}),U=A.drawText({x:h.config.yaxis[0].title.offsetX,y:h.globals.gridHeight/2+h.config.yaxis[0].title.offsetY,text:h.config.yaxis[0].title.text,textAnchor:"middle",foreColor:h.config.yaxis[0].title.style.color,fontSize:h.config.yaxis[0].title.style.fontSize,fontWeight:h.config.yaxis[0].title.style.fontWeight,fontFamily:h.config.yaxis[0].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+h.config.yaxis[0].title.style.cssClass});G.add(U),y.add(G)}var Q=0;this.isCategoryBarHorizontal&&h.config.yaxis[0].opposite&&(Q=h.globals.gridWidth);var q=h.config.xaxis.axisBorder;if(q.show){var ne=A.drawLine(h.globals.padHorizontal+q.offsetX+Q,1+q.offsetY,h.globals.padHorizontal+q.offsetX+Q,h.globals.gridHeight+q.offsetY,q.color,0);this.elgrid&&this.elgrid.elGridBorders&&h.config.grid.show?this.elgrid.elGridBorders.add(ne):y.add(ne)}return h.config.yaxis[0].axisTicks.show&&this.axesUtils.drawYAxisTicks(Q,_.length,h.config.yaxis[0].axisBorder,h.config.yaxis[0].axisTicks,0,t,y),y}},{key:"drawXaxisTicks",value:function(e,t,s){var c=this.w,h=e;if(!(e<0||e-2>c.globals.gridWidth)){var A=this.offY+c.config.xaxis.axisTicks.offsetY;if(t=t+A+c.config.xaxis.axisTicks.height,c.config.xaxis.position==="top"&&(t=A-c.config.xaxis.axisTicks.height),c.config.xaxis.axisTicks.show){var r=new hr(this.ctx).drawLine(e+c.config.xaxis.axisTicks.offsetX,A+c.config.xaxis.offsetY,h+c.config.xaxis.axisTicks.offsetX,t+c.config.xaxis.offsetY,c.config.xaxis.axisTicks.color);s.add(r),r.node.classList.add("apexcharts-xaxis-tick")}}}},{key:"getXAxisTicksPositions",value:function(){var e=this.w,t=[],s=this.xaxisLabels.length,c=e.globals.padHorizontal;if(e.globals.timescaleLabels.length>0)for(var h=0;h<s;h++)c=this.xaxisLabels[h].position,t.push(c);else for(var A=s,r=0;r<A;r++){var y=A;e.globals.isXNumeric&&e.config.chart.type!=="bar"&&(y-=1),c+=e.globals.gridWidth/y,t.push(c)}return t}},{key:"xAxisLabelCorrections",value:function(){var e=this.w,t=new hr(this.ctx),s=e.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g"),c=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-texts-g text:not(.apexcharts-xaxis-group-label)"),h=e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-inversed text"),A=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-inversed-texts-g text tspan");if(e.globals.rotateXLabels||e.config.xaxis.labels.rotateAlways)for(var r=0;r<c.length;r++){var y=t.rotateAroundCenter(c[r]);y.y=y.y-1,y.x=y.x+1,c[r].setAttribute("transform","rotate(".concat(e.config.xaxis.labels.rotate," ").concat(y.x," ").concat(y.y,")")),c[r].setAttribute("text-anchor","end"),s.setAttribute("transform","translate(0, ".concat(-10,")"));var b=c[r].childNodes;e.config.xaxis.labels.trim&&Array.prototype.forEach.call(b,function(E){t.placeTextWithEllipsis(E,E.textContent,e.globals.xAxisLabelsHeight-(e.config.legend.position==="bottom"?20:10))})}else(function(){for(var E=e.globals.gridWidth/(e.globals.labels.length+1),R=0;R<c.length;R++){var M=c[R].childNodes;e.config.xaxis.labels.trim&&e.config.xaxis.type!=="datetime"&&Array.prototype.forEach.call(M,function(G){t.placeTextWithEllipsis(G,G.textContent,E)})}})();if(h.length>0){var _=h[h.length-1].getBBox(),B=h[0].getBBox();_.x<-20&&h[h.length-1].parentNode.removeChild(h[h.length-1]),B.x+B.width>e.globals.gridWidth&&!e.globals.isBarHorizontal&&h[0].parentNode.removeChild(h[0]);for(var I=0;I<A.length;I++)t.placeTextWithEllipsis(A[I],A[I].textContent,e.config.yaxis[0].labels.maxWidth-(e.config.yaxis[0].title.text?2*parseFloat(e.config.yaxis[0].title.style.fontSize):0)-15)}}}]),a}(),mT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var t=this.w;this.xaxisLabels=t.globals.labels.slice(),this.axesUtils=new Mp(e),this.isRangeBar=t.globals.seriesRange.length&&t.globals.isBarHorizontal,t.globals.timescaleLabels.length>0&&(this.xaxisLabels=t.globals.timescaleLabels.slice())}return tn(a,[{key:"drawGridArea",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this.w,s=new hr(this.ctx);e||(e=s.group({class:"apexcharts-grid"}));var c=s.drawLine(t.globals.padHorizontal,1,t.globals.padHorizontal,t.globals.gridHeight,"transparent"),h=s.drawLine(t.globals.padHorizontal,t.globals.gridHeight,t.globals.gridWidth,t.globals.gridHeight,"transparent");return e.add(h),e.add(c),e}},{key:"drawGrid",value:function(){if(this.w.globals.axisCharts){var e=this.renderGrid();return this.drawGridArea(e.el),e}return null}},{key:"createGridMask",value:function(){var e=this.w,t=e.globals,s=new hr(this.ctx),c=Array.isArray(e.config.stroke.width)?Math.max.apply(Math,Jl(e.config.stroke.width)):e.config.stroke.width,h=function(_){var B=document.createElementNS(t.SVGNS,"clipPath");return B.setAttribute("id",_),B};t.dom.elGridRectMask=h("gridRectMask".concat(t.cuid)),t.dom.elGridRectBarMask=h("gridRectBarMask".concat(t.cuid)),t.dom.elGridRectMarkerMask=h("gridRectMarkerMask".concat(t.cuid)),t.dom.elForecastMask=h("forecastMask".concat(t.cuid)),t.dom.elNonForecastMask=h("nonForecastMask".concat(t.cuid));var A=0,r=0;(["bar","rangeBar","candlestick","boxPlot"].includes(e.config.chart.type)||e.globals.comboBarCount>0)&&e.globals.isXNumeric&&!e.globals.isBarHorizontal&&(A=Math.max(e.config.grid.padding.left,t.barPadForNumericAxis),r=Math.max(e.config.grid.padding.right,t.barPadForNumericAxis)),t.dom.elGridRect=s.drawRect(-c/2-2,-c/2-2,t.gridWidth+c+4,t.gridHeight+c+4,0,"#fff"),t.dom.elGridRectBar=s.drawRect(-c/2-A-2,-c/2-2,t.gridWidth+c+r+A+4,t.gridHeight+c+4,0,"#fff");var y=e.globals.markers.largestSize;t.dom.elGridRectMarker=s.drawRect(-y,-y,t.gridWidth+2*y,t.gridHeight+2*y,0,"#fff"),t.dom.elGridRectMask.appendChild(t.dom.elGridRect.node),t.dom.elGridRectBarMask.appendChild(t.dom.elGridRectBar.node),t.dom.elGridRectMarkerMask.appendChild(t.dom.elGridRectMarker.node);var b=t.dom.baseEl.querySelector("defs");b.appendChild(t.dom.elGridRectMask),b.appendChild(t.dom.elGridRectBarMask),b.appendChild(t.dom.elGridRectMarkerMask),b.appendChild(t.dom.elForecastMask),b.appendChild(t.dom.elNonForecastMask)}},{key:"_drawGridLines",value:function(e){var t=e.i,s=e.x1,c=e.y1,h=e.x2,A=e.y2,r=e.xCount,y=e.parent,b=this.w;if(!(t===0&&b.globals.skipFirstTimelinelabel||t===r-1&&b.globals.skipLastTimelinelabel&&!b.config.xaxis.labels.formatter||b.config.chart.type==="radar")){b.config.grid.xaxis.lines.show&&this._drawGridLine({i:t,x1:s,y1:c,x2:h,y2:A,xCount:r,parent:y});var _=0;if(b.globals.hasXaxisGroups&&b.config.xaxis.tickPlacement==="between"){var B=b.globals.groups;if(B){for(var I=0,E=0;I<t&&E<B.length;E++)I+=B[E].cols;I===t&&(_=.6*b.globals.xAxisLabelsHeight)}}new $y(this.ctx).drawXaxisTicks(s,_,b.globals.dom.elGraphical)}}},{key:"_drawGridLine",value:function(e){var t=e.i,s=e.x1,c=e.y1,h=e.x2,A=e.y2,r=e.xCount,y=e.parent,b=this.w,_=y.node.classList.contains("apexcharts-gridlines-horizontal"),B=b.globals.barPadForNumericAxis,I=c===0&&A===0||s===0&&h===0||c===b.globals.gridHeight&&A===b.globals.gridHeight||b.globals.isBarHorizontal&&(t===0||t===r-1),E=new hr(this).drawLine(s-(_?B:0),c,h+(_?B:0),A,b.config.grid.borderColor,b.config.grid.strokeDashArray);E.node.classList.add("apexcharts-gridline"),I&&b.config.grid.show?this.elGridBorders.add(E):y.add(E)}},{key:"_drawGridBandRect",value:function(e){var t=e.c,s=e.x1,c=e.y1,h=e.x2,A=e.y2,r=e.type,y=this.w,b=new hr(this.ctx),_=y.globals.barPadForNumericAxis,B=y.config.grid[r].colors[t],I=b.drawRect(s-(r==="row"?_:0),c,h+(r==="row"?2*_:0),A,0,B,y.config.grid[r].opacity);this.elg.add(I),I.attr("clip-path","url(#gridRectMask".concat(y.globals.cuid,")")),I.node.classList.add("apexcharts-grid-".concat(r))}},{key:"_drawXYLines",value:function(e){var t=this,s=e.xCount,c=e.tickAmount,h=this.w;if(h.config.grid.xaxis.lines.show||h.config.xaxis.axisTicks.show){var A,r=h.globals.padHorizontal,y=h.globals.gridHeight;h.globals.timescaleLabels.length?function(R){for(var M=R.xC,G=R.x1,U=R.y1,Q=R.x2,q=R.y2,ne=0;ne<M;ne++)G=t.xaxisLabels[ne].position,Q=t.xaxisLabels[ne].position,t._drawGridLines({i:ne,x1:G,y1:U,x2:Q,y2:q,xCount:s,parent:t.elgridLinesV})}({xC:s,x1:r,y1:0,x2:A,y2:y}):(h.globals.isXNumeric&&(s=h.globals.xAxisScale.result.length),function(R){for(var M=R.xC,G=R.x1,U=R.y1,Q=R.x2,q=R.y2,ne=0;ne<M+(h.globals.isXNumeric?0:1);ne++)ne===0&&M===1&&h.globals.dataPoints===1&&(Q=G=h.globals.gridWidth/2),t._drawGridLines({i:ne,x1:G,y1:U,x2:Q,y2:q,xCount:s,parent:t.elgridLinesV}),Q=G+=h.globals.gridWidth/(h.globals.isXNumeric?M-1:M)}({xC:s,x1:r,y1:0,x2:A,y2:y}))}if(h.config.grid.yaxis.lines.show){var b=0,_=0,B=h.globals.gridWidth,I=c+1;this.isRangeBar&&(I=h.globals.labels.length);for(var E=0;E<I+(this.isRangeBar?1:0);E++)this._drawGridLine({i:E,xCount:I+(this.isRangeBar?1:0),x1:0,y1:b,x2:B,y2:_,parent:this.elgridLinesH}),_=b+=h.globals.gridHeight/(this.isRangeBar?I:c)}}},{key:"_drawInvertedXYLines",value:function(e){var t=e.xCount,s=this.w;if(s.config.grid.xaxis.lines.show||s.config.xaxis.axisTicks.show)for(var c,h=s.globals.padHorizontal,A=s.globals.gridHeight,r=0;r<t+1;r++)s.config.grid.xaxis.lines.show&&this._drawGridLine({i:r,xCount:t+1,x1:h,y1:0,x2:c,y2:A,parent:this.elgridLinesV}),new $y(this.ctx).drawXaxisTicks(h,0,s.globals.dom.elGraphical),c=h+=s.globals.gridWidth/t;if(s.config.grid.yaxis.lines.show)for(var y=0,b=0,_=s.globals.gridWidth,B=0;B<s.globals.dataPoints+1;B++)this._drawGridLine({i:B,xCount:s.globals.dataPoints+1,x1:0,y1:y,x2:_,y2:b,parent:this.elgridLinesH}),b=y+=s.globals.gridHeight/s.globals.dataPoints}},{key:"renderGrid",value:function(){var e=this.w,t=e.globals,s=new hr(this.ctx);this.elg=s.group({class:"apexcharts-grid"}),this.elgridLinesH=s.group({class:"apexcharts-gridlines-horizontal"}),this.elgridLinesV=s.group({class:"apexcharts-gridlines-vertical"}),this.elGridBorders=s.group({class:"apexcharts-grid-borders"}),this.elg.add(this.elgridLinesH),this.elg.add(this.elgridLinesV),e.config.grid.show||(this.elgridLinesV.hide(),this.elgridLinesH.hide(),this.elGridBorders.hide());for(var c=0;c<t.seriesYAxisMap.length&&t.ignoreYAxisIndexes.includes(c);)c++;c===t.seriesYAxisMap.length&&(c=0);var h,A=t.yAxisScale[c].result.length-1;if(!t.isBarHorizontal||this.isRangeBar){var r,y,b;h=this.xaxisLabels.length,this.isRangeBar&&(A=t.labels.length,e.config.xaxis.tickAmount&&e.config.xaxis.labels.formatter&&(h=e.config.xaxis.tickAmount),((r=t.yAxisScale)===null||r===void 0||(y=r[c])===null||y===void 0||(b=y.result)===null||b===void 0?void 0:b.length)>0&&e.config.xaxis.type!=="datetime"&&(h=t.yAxisScale[c].result.length-1)),this._drawXYLines({xCount:h,tickAmount:A})}else h=A,A=t.xTickAmount,this._drawInvertedXYLines({xCount:h,tickAmount:A});return this.drawGridBands(h,A),{el:this.elg,elGridBorders:this.elGridBorders,xAxisTickWidth:t.gridWidth/h}}},{key:"drawGridBands",value:function(e,t){var s,c,h=this,A=this.w;if(((s=A.config.grid.row.colors)===null||s===void 0?void 0:s.length)>0&&function(R,M,G,U,Q,q){for(var ne=0,re=0;ne<M;ne++,re++)re>=A.config.grid[R].colors.length&&(re=0),h._drawGridBandRect({c:re,x1:G,y1:U,x2:Q,y2:q,type:R}),U+=A.globals.gridHeight/t}("row",t,0,0,A.globals.gridWidth,A.globals.gridHeight/t),((c=A.config.grid.column.colors)===null||c===void 0?void 0:c.length)>0){var r=A.globals.isBarHorizontal||A.config.xaxis.tickPlacement!=="on"||A.config.xaxis.type!=="category"&&!A.config.xaxis.convertedCatToNumeric?e:e-1;A.globals.isXNumeric&&(r=A.globals.xAxisScale.result.length-1);for(var y=A.globals.padHorizontal,b=A.globals.padHorizontal+A.globals.gridWidth/r,_=A.globals.gridHeight,B=0,I=0;B<e;B++,I++){var E;I>=A.config.grid.column.colors.length&&(I=0),A.config.xaxis.type==="datetime"&&(y=this.xaxisLabels[B].position,b=(((E=this.xaxisLabels[B+1])===null||E===void 0?void 0:E.position)||A.globals.gridWidth)-this.xaxisLabels[B].position),this._drawGridBandRect({c:I,x1:y,y1:0,x2:b,y2:_,type:"column"}),y+=A.globals.gridWidth/r}}}}]),a}(),yT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.coreUtils=new sl(this.ctx)}return tn(a,[{key:"niceScale",value:function(e,t){var s,c,h,A,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=1e-11,b=this.w,_=b.globals;_.isBarHorizontal?(s=b.config.xaxis,c=Math.max((_.svgWidth-100)/25,2)):(s=b.config.yaxis[r],c=Math.max((_.svgHeight-100)/15,2)),ni.isNumber(c)||(c=10),h=s.min!==void 0&&s.min!==null,A=s.max!==void 0&&s.min!==null;var B=s.stepSize!==void 0&&s.stepSize!==null,I=s.tickAmount!==void 0&&s.tickAmount!==null,E=I?s.tickAmount:_.niceScaleDefaultTicks[Math.min(Math.round(c/2),_.niceScaleDefaultTicks.length-1)];if(_.isMultipleYAxis&&!I&&_.multiAxisTickAmount>0&&(E=_.multiAxisTickAmount,I=!0),E=E==="dataPoints"?_.dataPoints-1:Math.abs(Math.round(E)),(e===Number.MIN_VALUE&&t===0||!ni.isNumber(e)&&!ni.isNumber(t)||e===Number.MIN_VALUE&&t===-Number.MAX_VALUE)&&(e=ni.isNumber(s.min)?s.min:0,t=ni.isNumber(s.max)?s.max:e+E,_.allSeriesCollapsed=!1),e>t){console.warn("axis.min cannot be greater than axis.max: swapping min and max");var R=t;t=e,e=R}else e===t&&(e=e===0?0:e-1,t=t===0?2:t+1);var M=[];E<1&&(E=1);var G=E,U=Math.abs(t-e);!h&&e>0&&e/U<.15&&(e=0,h=!0),!A&&t<0&&-t/U<.15&&(t=0,A=!0);var Q=(U=Math.abs(t-e))/G,q=Q,ne=Math.floor(Math.log10(q)),re=Math.pow(10,ne),pe=Math.ceil(q/re);if(Q=q=(pe=_.niceScaleAllowedMagMsd[_.yValueDecimal===0?0:1][pe])*re,_.isBarHorizontal&&s.stepSize&&s.type!=="datetime"?(Q=s.stepSize,B=!0):B&&(Q=s.stepSize),B&&s.forceNiceScale){var Ae=Math.floor(Math.log10(Q));Q*=Math.pow(10,ne-Ae)}if(h&&A){var le=U/G;if(I)if(B)if(ni.mod(U,Q)!=0){var be=ni.getGCD(Q,le);Q=le/be<10?be:le}else ni.mod(Q,le)==0?Q=le:(le=Q,I=!1);else Q=le;else if(B)ni.mod(U,Q)==0?le=Q:Q=le;else if(ni.mod(U,Q)==0)le=Q;else{le=U/(G=Math.ceil(U/Q));var we=ni.getGCD(U,Q);U/we<c&&(le=we),Q=le}G=Math.round(U/Q)}else{if(h||A){if(A)if(I)e=t-Q*G;else{var oe=e;e=Q*Math.floor(e/Q),Math.abs(t-e)/ni.getGCD(U,Q)>c&&(e=t-Q*E,e+=Q*Math.floor((oe-e)/Q))}else if(h)if(I)t=e+Q*G;else{var me=t;t=Q*Math.ceil(t/Q),Math.abs(t-e)/ni.getGCD(U,Q)>c&&(t=e+Q*E,t+=Q*Math.ceil((me-t)/Q))}}else if(_.isMultipleYAxis&&I){var Le=Q*Math.floor(e/Q),Se=Le+Q*G;Se<t&&(Q*=2),Se=t,t=(e=Le)+Q*G,U=Math.abs(t-e),e>0&&e<Math.abs(Se-t)&&(e=0,t=Q*G),t<0&&-t<Math.abs(Le-e)&&(t=0,e=-Q*G)}else e=Q*Math.floor(e/Q),t=Q*Math.ceil(t/Q);U=Math.abs(t-e),Q=ni.getGCD(U,Q),G=Math.round(U/Q)}if(I||h||A||(G=Math.ceil((U-y)/(Q+y)))>16&&ni.getPrimeFactors(G).length<2&&G++,!I&&s.forceNiceScale&&_.yValueDecimal===0&&G>U&&(G=U,Q=Math.round(U/G)),G>c&&(!I&&!B||s.forceNiceScale)){var Me=ni.getPrimeFactors(G),Re=Me.length-1,Ze=G;e:for(var $e=0;$e<Re;$e++)for(var ct=0;ct<=Re-$e;ct++){for(var Qe=Math.min(ct+$e,Re),It=Ze,Ce=1,Je=ct;Je<=Qe;Je++)Ce*=Me[Je];if((It/=Ce)<c){Ze=It;break e}}Q=Ze===G?U:U/Ze,G=Math.round(U/Q)}_.isMultipleYAxis&&_.multiAxisTickAmount==0&&_.ignoreYAxisIndexes.indexOf(r)<0&&(_.multiAxisTickAmount=G);var lt=e-Q,mt=Q*y;do lt+=Q,M.push(ni.stripNumber(lt,7));while(t-lt>mt);return{result:M,niceMin:M[0],niceMax:M[M.length-1]}}},{key:"linearScale",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,A=Math.abs(t-e),r=[];if(e===t)return{result:r=[e],niceMin:r[0],niceMax:r[r.length-1]};(s=this._adjustTicksForSmallRange(s,c,A))==="dataPoints"&&(s=this.w.globals.dataPoints-1),h||(h=A/s),h=Math.round(100*(h+Number.EPSILON))/100,s===Number.MAX_VALUE&&(s=5,h=1);for(var y=e;s>=0;)r.push(y),y=ni.preciseAddition(y,h),s-=1;return{result:r,niceMin:r[0],niceMax:r[r.length-1]}}},{key:"logarithmicScaleNice",value:function(e,t,s){t<=0&&(t=Math.max(e,s)),e<=0&&(e=Math.min(t,s));for(var c=[],h=Math.ceil(Math.log(t)/Math.log(s)+1),A=Math.floor(Math.log(e)/Math.log(s));A<h;A++)c.push(Math.pow(s,A));return{result:c,niceMin:c[0],niceMax:c[c.length-1]}}},{key:"logarithmicScale",value:function(e,t,s){t<=0&&(t=Math.max(e,s)),e<=0&&(e=Math.min(t,s));for(var c=[],h=Math.log(t)/Math.log(s),A=Math.log(e)/Math.log(s),r=h-A,y=Math.round(r),b=r/y,_=0,B=A;_<y;_++,B+=b)c.push(Math.pow(s,B));return c.push(Math.pow(s,h)),{result:c,niceMin:e,niceMax:t}}},{key:"_adjustTicksForSmallRange",value:function(e,t,s){var c=e;if(t!==void 0&&this.w.config.yaxis[t].labels.formatter&&this.w.config.yaxis[t].tickAmount===void 0){var h=Number(this.w.config.yaxis[t].labels.formatter(1));ni.isNumber(h)&&this.w.globals.yValueDecimal===0&&(c=Math.ceil(s))}return c<e?c:e}},{key:"setYScaleForIndex",value:function(e,t,s){var c=this.w.globals,h=this.w.config,A=c.isBarHorizontal?h.xaxis:h.yaxis[e];c.yAxisScale[e]===void 0&&(c.yAxisScale[e]=[]);var r=Math.abs(s-t);A.logarithmic&&r<=5&&(c.invalidLogScale=!0),A.logarithmic&&r>5?(c.allSeriesCollapsed=!1,c.yAxisScale[e]=A.forceNiceScale?this.logarithmicScaleNice(t,s,A.logBase):this.logarithmicScale(t,s,A.logBase)):s!==-Number.MAX_VALUE&&ni.isNumber(s)&&t!==Number.MAX_VALUE&&ni.isNumber(t)?(c.allSeriesCollapsed=!1,c.yAxisScale[e]=this.niceScale(t,s,e)):c.yAxisScale[e]=this.niceScale(Number.MIN_VALUE,0,e)}},{key:"setXScale",value:function(e,t){var s=this.w,c=s.globals;if(t!==-Number.MAX_VALUE&&ni.isNumber(t)){var h=c.xTickAmount;c.xAxisScale=this.linearScale(e,t,h,0,s.config.xaxis.stepSize)}else c.xAxisScale=this.linearScale(0,10,10);return c.xAxisScale}},{key:"scaleMultipleYAxes",value:function(){var e=this,t=this.w.config,s=this.w.globals;this.coreUtils.setSeriesYAxisMappings();var c=s.seriesYAxisMap,h=s.minYArr,A=s.maxYArr;s.allSeriesCollapsed=!0,s.barGroups=[],c.forEach(function(r,y){var b=[];r.forEach(function(_){var B,I=(B=t.series[_])===null||B===void 0?void 0:B.group;b.indexOf(I)<0&&b.push(I)}),r.length>0?function(){var _,B,I=Number.MAX_VALUE,E=-Number.MAX_VALUE,R=I,M=E;if(t.chart.stacked)(function(){var Q=new Array(s.dataPoints).fill(0),q=[],ne=[],re=[];b.forEach(function(){q.push(Q.map(function(){return Number.MIN_VALUE})),ne.push(Q.map(function(){return Number.MIN_VALUE})),re.push(Q.map(function(){return Number.MIN_VALUE}))});for(var pe=function(le){!_&&t.series[r[le]].type&&(_=t.series[r[le]].type);var be=r[le];B=t.series[be].group?t.series[be].group:"axis-".concat(y),!(s.collapsedSeriesIndices.indexOf(be)<0&&s.ancillaryCollapsedSeriesIndices.indexOf(be)<0)||(s.allSeriesCollapsed=!1,b.forEach(function(we,oe){if(t.series[be].group===we)for(var me=0;me<s.series[be].length;me++){var Le=s.series[be][me];Le>=0?ne[oe][me]+=Le:re[oe][me]+=Le,q[oe][me]+=Le,R=Math.min(R,Le),M=Math.max(M,Le)}})),_!=="bar"&&_!=="column"||s.barGroups.push(B)},Ae=0;Ae<r.length;Ae++)pe(Ae);_||(_=t.chart.type),_==="bar"||_==="column"?b.forEach(function(le,be){I=Math.min(I,Math.min.apply(null,re[be])),E=Math.max(E,Math.max.apply(null,ne[be]))}):(b.forEach(function(le,be){R=Math.min(R,Math.min.apply(null,q[be])),M=Math.max(M,Math.max.apply(null,q[be]))}),I=R,E=M),I===Number.MIN_VALUE&&E===Number.MIN_VALUE&&(E=-Number.MAX_VALUE)})();else for(var G=0;G<r.length;G++){var U=r[G];I=Math.min(I,h[U]),E=Math.max(E,A[U]),!(s.collapsedSeriesIndices.indexOf(U)<0&&s.ancillaryCollapsedSeriesIndices.indexOf(U)<0)||(s.allSeriesCollapsed=!1)}t.yaxis[y].min!==void 0&&(I=typeof t.yaxis[y].min=="function"?t.yaxis[y].min(I):t.yaxis[y].min),t.yaxis[y].max!==void 0&&(E=typeof t.yaxis[y].max=="function"?t.yaxis[y].max(E):t.yaxis[y].max),s.barGroups=s.barGroups.filter(function(Q,q,ne){return ne.indexOf(Q)===q}),e.setYScaleForIndex(y,I,E),r.forEach(function(Q){h[Q]=s.yAxisScale[y].niceMin,A[Q]=s.yAxisScale[y].niceMax})}():e.setYScaleForIndex(y,0,-Number.MAX_VALUE)})}}]),a}(),o1=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.scales=new yT(e)}return tn(a,[{key:"init",value:function(){this.setYRange(),this.setXRange(),this.setZRange()}},{key:"getMinYMaxY",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-Number.MAX_VALUE,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,h=this.w.config,A=this.w.globals,r=-Number.MAX_VALUE,y=Number.MIN_VALUE;c===null&&(c=e+1);var b=A.series,_=b,B=b;h.chart.type==="candlestick"?(_=A.seriesCandleL,B=A.seriesCandleH):h.chart.type==="boxPlot"?(_=A.seriesCandleO,B=A.seriesCandleC):A.isRangeData&&(_=A.seriesRangeStart,B=A.seriesRangeEnd);var I=!1;if(A.seriesX.length>=c){var E,R=(E=A.brushSource)===null||E===void 0?void 0:E.w.config.chart.brush;(h.chart.zoom.enabled&&h.chart.zoom.autoScaleYaxis||R!=null&&R.enabled&&R!=null&&R.autoScaleYaxis)&&(I=!0)}for(var M=e;M<c;M++){A.dataPoints=Math.max(A.dataPoints,b[M].length);var G=h.series[M].type;A.categoryLabels.length&&(A.dataPoints=A.categoryLabels.filter(function(be){return be!==void 0}).length),A.labels.length&&h.xaxis.type!=="datetime"&&A.series.reduce(function(be,we){return be+we.length},0)!==0&&(A.dataPoints=Math.max(A.dataPoints,A.labels.length));var U=0,Q=b[M].length-1;if(I){if(h.xaxis.min)for(;U<Q&&A.seriesX[M][U]<h.xaxis.min;U++);if(h.xaxis.max)for(;Q>U&&A.seriesX[M][Q]>h.xaxis.max;Q--);}for(var q=U;q<=Q&&q<A.series[M].length;q++){var ne=b[M][q];if(ne!==null&&ni.isNumber(ne)){var re,pe,Ae,le;switch(((re=B[M])===null||re===void 0?void 0:re[q])!==void 0&&(r=Math.max(r,B[M][q]),t=Math.min(t,B[M][q])),((pe=_[M])===null||pe===void 0?void 0:pe[q])!==void 0&&(t=Math.min(t,_[M][q]),s=Math.max(s,_[M][q])),G){case"candlestick":A.seriesCandleC[M][q]!==void 0&&(r=Math.max(r,A.seriesCandleH[M][q]),t=Math.min(t,A.seriesCandleL[M][q]));break;case"boxPlot":A.seriesCandleC[M][q]!==void 0&&(r=Math.max(r,A.seriesCandleC[M][q]),t=Math.min(t,A.seriesCandleO[M][q]))}G&&G!=="candlestick"&&G!=="boxPlot"&&G!=="rangeArea"&&G!=="rangeBar"&&(r=Math.max(r,A.series[M][q]),t=Math.min(t,A.series[M][q])),A.seriesGoals[M]&&A.seriesGoals[M][q]&&Array.isArray(A.seriesGoals[M][q])&&A.seriesGoals[M][q].forEach(function(be){r=Math.max(r,be.value),t=Math.min(t,be.value)}),s=r,ne=ni.noExponents(ne),ni.isFloat(ne)&&(A.yValueDecimal=Math.max(A.yValueDecimal,ne.toString().split(".")[1].length)),y>((Ae=_[M])===null||Ae===void 0?void 0:Ae[q])&&((le=_[M])===null||le===void 0?void 0:le[q])<0&&(y=_[M][q])}else A.hasNullValues=!0}G!=="bar"&&G!=="column"||(y<0&&r<0&&(r=0,s=Math.max(s,0)),y===Number.MIN_VALUE&&(y=0,t=Math.min(t,0)))}return h.chart.type==="rangeBar"&&A.seriesRangeStart.length&&A.isBarHorizontal&&(y=t),h.chart.type==="bar"&&(y<0&&r<0&&(r=0),y===Number.MIN_VALUE&&(y=0)),{minY:y,maxY:r,lowestY:t,highestY:s}}},{key:"setYRange",value:function(){var e=this.w.globals,t=this.w.config;e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE;var s,c=Number.MAX_VALUE;if(e.isMultipleYAxis){c=Number.MAX_VALUE;for(var h=0;h<e.series.length;h++)s=this.getMinYMaxY(h),e.minYArr[h]=s.lowestY,e.maxYArr[h]=s.highestY,c=Math.min(c,s.lowestY)}return s=this.getMinYMaxY(0,c,null,e.series.length),t.chart.type==="bar"?(e.minY=s.minY,e.maxY=s.maxY):(e.minY=s.lowestY,e.maxY=s.highestY),c=s.lowestY,t.chart.stacked&&this._setStackedMinMax(),t.chart.type==="line"||t.chart.type==="area"||t.chart.type==="scatter"||t.chart.type==="candlestick"||t.chart.type==="boxPlot"||t.chart.type==="rangeBar"&&!e.isBarHorizontal?e.minY===Number.MIN_VALUE&&c!==-Number.MAX_VALUE&&c!==e.maxY&&(e.minY=c):e.minY=e.minY!==Number.MIN_VALUE?Math.min(s.minY,e.minY):s.minY,t.yaxis.forEach(function(A,r){A.max!==void 0&&(typeof A.max=="number"?e.maxYArr[r]=A.max:typeof A.max=="function"&&(e.maxYArr[r]=A.max(e.isMultipleYAxis?e.maxYArr[r]:e.maxY)),e.maxY=e.maxYArr[r]),A.min!==void 0&&(typeof A.min=="number"?e.minYArr[r]=A.min:typeof A.min=="function"&&(e.minYArr[r]=A.min(e.isMultipleYAxis?e.minYArr[r]===Number.MIN_VALUE?0:e.minYArr[r]:e.minY)),e.minY=e.minYArr[r])}),e.isBarHorizontal&&["min","max"].forEach(function(A){t.xaxis[A]!==void 0&&typeof t.xaxis[A]=="number"&&(A==="min"?e.minY=t.xaxis[A]:e.maxY=t.xaxis[A])}),e.isMultipleYAxis?(this.scales.scaleMultipleYAxes(),e.minY=c):(this.scales.setYScaleForIndex(0,e.minY,e.maxY),e.minY=e.yAxisScale[0].niceMin,e.maxY=e.yAxisScale[0].niceMax,e.minYArr[0]=e.minY,e.maxYArr[0]=e.maxY),e.barGroups=[],e.lineGroups=[],e.areaGroups=[],t.series.forEach(function(A){switch(A.type||t.chart.type){case"bar":case"column":e.barGroups.push(A.group);break;case"line":e.lineGroups.push(A.group);break;case"area":e.areaGroups.push(A.group)}}),e.barGroups=e.barGroups.filter(function(A,r,y){return y.indexOf(A)===r}),e.lineGroups=e.lineGroups.filter(function(A,r,y){return y.indexOf(A)===r}),e.areaGroups=e.areaGroups.filter(function(A,r,y){return y.indexOf(A)===r}),{minY:e.minY,maxY:e.maxY,minYArr:e.minYArr,maxYArr:e.maxYArr,yAxisScale:e.yAxisScale}}},{key:"setXRange",value:function(){var e=this.w.globals,t=this.w.config,s=t.xaxis.type==="numeric"||t.xaxis.type==="datetime"||t.xaxis.type==="category"&&!e.noLabelsProvided||e.noLabelsProvided||e.isXNumeric;if(e.isXNumeric&&function(){for(var y=0;y<e.series.length;y++)if(e.labels[y])for(var b=0;b<e.labels[y].length;b++)e.labels[y][b]!==null&&ni.isNumber(e.labels[y][b])&&(e.maxX=Math.max(e.maxX,e.labels[y][b]),e.initialMaxX=Math.max(e.maxX,e.labels[y][b]),e.minX=Math.min(e.minX,e.labels[y][b]),e.initialMinX=Math.min(e.minX,e.labels[y][b]))}(),e.noLabelsProvided&&t.xaxis.categories.length===0&&(e.maxX=e.labels[e.labels.length-1],e.initialMaxX=e.labels[e.labels.length-1],e.minX=1,e.initialMinX=1),e.isXNumeric||e.noLabelsProvided||e.dataFormatXNumeric){var c=10;if(t.xaxis.tickAmount===void 0)c=Math.round(e.svgWidth/150),t.xaxis.type==="numeric"&&e.dataPoints<30&&(c=e.dataPoints-1),c>e.dataPoints&&e.dataPoints!==0&&(c=e.dataPoints-1);else if(t.xaxis.tickAmount==="dataPoints"){if(e.series.length>1&&(c=e.series[e.maxValsInArrayIndex].length-1),e.isXNumeric){var h=Math.round(e.maxX-e.minX);h<30&&(c=h-1)}}else c=t.xaxis.tickAmount;if(e.xTickAmount=c,t.xaxis.max!==void 0&&typeof t.xaxis.max=="number"&&(e.maxX=t.xaxis.max),t.xaxis.min!==void 0&&typeof t.xaxis.min=="number"&&(e.minX=t.xaxis.min),t.xaxis.range!==void 0&&(e.minX=e.maxX-t.xaxis.range),e.minX!==Number.MAX_VALUE&&e.maxX!==-Number.MAX_VALUE)if(t.xaxis.convertedCatToNumeric&&!e.dataFormatXNumeric){for(var A=[],r=e.minX-1;r<e.maxX;r++)A.push(r+1);e.xAxisScale={result:A,niceMin:A[0],niceMax:A[A.length-1]}}else e.xAxisScale=this.scales.setXScale(e.minX,e.maxX);else e.xAxisScale=this.scales.linearScale(0,c,c,0,t.xaxis.stepSize),e.noLabelsProvided&&e.labels.length>0&&(e.xAxisScale=this.scales.linearScale(1,e.labels.length,c-1,0,t.xaxis.stepSize),e.seriesX=e.labels.slice());s&&(e.labels=e.xAxisScale.result.slice())}return e.isBarHorizontal&&e.labels.length&&(e.xTickAmount=e.labels.length),this._handleSingleDataPoint(),this._getMinXDiff(),{minX:e.minX,maxX:e.maxX}}},{key:"setZRange",value:function(){var e=this.w.globals;if(e.isDataXYZ){for(var t=0;t<e.series.length;t++)if(e.seriesZ[t]!==void 0)for(var s=0;s<e.seriesZ[t].length;s++)e.seriesZ[t][s]!==null&&ni.isNumber(e.seriesZ[t][s])&&(e.maxZ=Math.max(e.maxZ,e.seriesZ[t][s]),e.minZ=Math.min(e.minZ,e.seriesZ[t][s]))}}},{key:"_handleSingleDataPoint",value:function(){var e=this.w.globals,t=this.w.config;if(e.minX===e.maxX){var s=new Oc(this.ctx);if(t.xaxis.type==="datetime"){var c=s.getDate(e.minX);t.xaxis.labels.datetimeUTC?c.setUTCDate(c.getUTCDate()-2):c.setDate(c.getDate()-2),e.minX=new Date(c).getTime();var h=s.getDate(e.maxX);t.xaxis.labels.datetimeUTC?h.setUTCDate(h.getUTCDate()+2):h.setDate(h.getDate()+2),e.maxX=new Date(h).getTime()}else(t.xaxis.type==="numeric"||t.xaxis.type==="category"&&!e.noLabelsProvided)&&(e.minX=e.minX-2,e.initialMinX=e.minX,e.maxX=e.maxX+2,e.initialMaxX=e.maxX)}}},{key:"_getMinXDiff",value:function(){var e=this.w.globals;e.isXNumeric&&e.seriesX.forEach(function(t,s){if(t.length){t.length===1&&t.push(e.seriesX[e.maxValsInArrayIndex][e.seriesX[e.maxValsInArrayIndex].length-1]);var c=t.slice();c.sort(function(h,A){return h-A}),c.forEach(function(h,A){if(A>0){var r=h-c[A-1];r>0&&(e.minXDiff=Math.min(r,e.minXDiff))}}),e.dataPoints!==1&&e.minXDiff!==Number.MAX_VALUE||(e.minXDiff=.5)}})}},{key:"_setStackedMinMax",value:function(){var e=this,t=this.w.globals;if(t.series.length){var s=t.seriesGroups;s.length||(s=[this.w.globals.seriesNames.map(function(A){return A})]);var c={},h={};s.forEach(function(A){c[A]=[],h[A]=[],e.w.config.series.map(function(r,y){return A.indexOf(t.seriesNames[y])>-1?y:null}).filter(function(r){return r!==null}).forEach(function(r){for(var y=0;y<t.series[t.maxValsInArrayIndex].length;y++){var b,_,B,I;c[A][y]===void 0&&(c[A][y]=0,h[A][y]=0),(e.w.config.chart.stacked&&!t.comboCharts||e.w.config.chart.stacked&&t.comboCharts&&(!e.w.config.chart.stackOnlyBar||((b=e.w.config.series)===null||b===void 0||(_=b[r])===null||_===void 0?void 0:_.type)==="bar"||((B=e.w.config.series)===null||B===void 0||(I=B[r])===null||I===void 0?void 0:I.type)==="column"))&&t.series[r][y]!==null&&ni.isNumber(t.series[r][y])&&(t.series[r][y]>0?c[A][y]+=parseFloat(t.series[r][y])+1e-4:h[A][y]+=parseFloat(t.series[r][y]))}})}),Object.entries(c).forEach(function(A){var r=OI(A,1)[0];c[r].forEach(function(y,b){t.maxY=Math.max(t.maxY,c[r][b]),t.minY=Math.min(t.minY,h[r][b])})})}}}]),a}(),dw=function(){function a(e,t){en(this,a),this.ctx=e,this.elgrid=t,this.w=e.w;var s=this.w;this.xaxisFontSize=s.config.xaxis.labels.style.fontSize,this.axisFontFamily=s.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=s.config.xaxis.labels.style.colors,this.isCategoryBarHorizontal=s.config.chart.type==="bar"&&s.config.plotOptions.bar.horizontal,this.xAxisoffX=s.config.xaxis.position==="bottom"?s.globals.gridHeight:0,this.drawnLabels=[],this.axesUtils=new Mp(e)}return tn(a,[{key:"drawYaxis",value:function(e){var t=this.w,s=new hr(this.ctx),c=t.config.yaxis[e].labels.style,h=c.fontSize,A=c.fontFamily,r=c.fontWeight,y=s.group({class:"apexcharts-yaxis",rel:e,transform:"translate(".concat(t.globals.translateYAxisX[e],", 0)")});if(this.axesUtils.isYAxisHidden(e))return y;var b=s.group({class:"apexcharts-yaxis-texts-g"});y.add(b);var _=t.globals.yAxisScale[e].result.length-1,B=t.globals.gridHeight/_,I=t.globals.yLabelFormatters[e],E=this.axesUtils.checkForReversedLabels(e,t.globals.yAxisScale[e].result.slice());if(t.config.yaxis[e].labels.show){var R=t.globals.translateY+t.config.yaxis[e].labels.offsetY;t.globals.isBarHorizontal?R=0:t.config.chart.type==="heatmap"&&(R-=B/2),R+=parseInt(h,10)/3;for(var M=_;M>=0;M--){var G=I(E[M],M,t),U=t.config.yaxis[e].labels.padding;t.config.yaxis[e].opposite&&t.config.yaxis.length!==0&&(U*=-1);var Q=this.getTextAnchor(t.config.yaxis[e].labels.align,t.config.yaxis[e].opposite),q=this.axesUtils.getYAxisForeColor(c.colors,e),ne=Array.isArray(q)?q[M]:q,re=ni.listToArray(t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-label tspan"))).map(function(Ae){return Ae.textContent}),pe=s.drawText({x:U,y:R,text:re.includes(G)&&!t.config.yaxis[e].labels.showDuplicates?"":G,textAnchor:Q,fontSize:h,fontFamily:A,fontWeight:r,maxWidth:t.config.yaxis[e].labels.maxWidth,foreColor:ne,isPlainText:!1,cssClass:"apexcharts-yaxis-label ".concat(c.cssClass)});b.add(pe),this.addTooltip(pe,G),t.config.yaxis[e].labels.rotate!==0&&this.rotateLabel(s,pe,firstLabel,t.config.yaxis[e].labels.rotate),R+=B}}return this.addYAxisTitle(s,y,e),this.addAxisBorder(s,y,e,_,B),y}},{key:"getTextAnchor",value:function(e,t){return e==="left"?"start":e==="center"?"middle":e==="right"?"end":t?"start":"end"}},{key:"addTooltip",value:function(e,t){var s=document.createElementNS(this.w.globals.SVGNS,"title");s.textContent=Array.isArray(t)?t.join(" "):t,e.node.appendChild(s)}},{key:"rotateLabel",value:function(e,t,s,c){var h=e.rotateAroundCenter(s.node),A=e.rotateAroundCenter(t.node);t.node.setAttribute("transform","rotate(".concat(c," ").concat(h.x," ").concat(A.y,")"))}},{key:"addYAxisTitle",value:function(e,t,s){var c=this.w;if(c.config.yaxis[s].title.text!==void 0){var h=e.group({class:"apexcharts-yaxis-title"}),A=c.config.yaxis[s].opposite?c.globals.translateYAxisX[s]:0,r=e.drawText({x:A,y:c.globals.gridHeight/2+c.globals.translateY+c.config.yaxis[s].title.offsetY,text:c.config.yaxis[s].title.text,textAnchor:"end",foreColor:c.config.yaxis[s].title.style.color,fontSize:c.config.yaxis[s].title.style.fontSize,fontWeight:c.config.yaxis[s].title.style.fontWeight,fontFamily:c.config.yaxis[s].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text ".concat(c.config.yaxis[s].title.style.cssClass)});h.add(r),t.add(h)}}},{key:"addAxisBorder",value:function(e,t,s,c,h){var A=this.w,r=A.config.yaxis[s].axisBorder,y=31+r.offsetX;if(A.config.yaxis[s].opposite&&(y=-31-r.offsetX),r.show){var b=e.drawLine(y,A.globals.translateY+r.offsetY-2,y,A.globals.gridHeight+A.globals.translateY+r.offsetY+2,r.color,0,r.width);t.add(b)}A.config.yaxis[s].axisTicks.show&&this.axesUtils.drawYAxisTicks(y,c,r,A.config.yaxis[s].axisTicks,s,h,t)}},{key:"drawYaxisInversed",value:function(e){var t=this.w,s=new hr(this.ctx),c=s.group({class:"apexcharts-xaxis apexcharts-yaxis-inversed"}),h=s.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(t.globals.translateXAxisX,", ").concat(t.globals.translateXAxisY,")")});c.add(h);var A=t.globals.yAxisScale[e].result.length-1,r=t.globals.gridWidth/A+.1,y=r+t.config.xaxis.labels.offsetX,b=t.globals.xLabelFormatter,_=this.axesUtils.checkForReversedLabels(e,t.globals.yAxisScale[e].result.slice()),B=t.globals.timescaleLabels;if(B.length>0&&(this.xaxisLabels=B.slice(),A=(_=B.slice()).length),t.config.xaxis.labels.show)for(var I=B.length?0:A;B.length?I<B.length:I>=0;B.length?I++:I--){var E=b(_[I],I,t),R=t.globals.gridWidth+t.globals.padHorizontal-(y-r+t.config.xaxis.labels.offsetX);if(B.length){var M=this.axesUtils.getLabel(_,B,R,I,this.drawnLabels,this.xaxisFontSize);R=M.x,E=M.text,this.drawnLabels.push(M.text),I===0&&t.globals.skipFirstTimelinelabel&&(E=""),I===_.length-1&&t.globals.skipLastTimelinelabel&&(E="")}var G=s.drawText({x:R,y:this.xAxisoffX+t.config.xaxis.labels.offsetY+30-(t.config.xaxis.position==="top"?t.globals.xAxisHeight+t.config.xaxis.axisTicks.height-2:0),text:E,textAnchor:"middle",foreColor:Array.isArray(this.xaxisForeColors)?this.xaxisForeColors[e]:this.xaxisForeColors,fontSize:this.xaxisFontSize,fontFamily:this.xaxisFontFamily,fontWeight:t.config.xaxis.labels.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-xaxis-label ".concat(t.config.xaxis.labels.style.cssClass)});h.add(G),G.tspan(E),this.addTooltip(G,E),y+=r}return this.inversedYAxisTitleText(c),this.inversedYAxisBorder(c),c}},{key:"inversedYAxisBorder",value:function(e){var t=this.w,s=new hr(this.ctx),c=t.config.xaxis.axisBorder;if(c.show){var h=0;t.config.chart.type==="bar"&&t.globals.isXNumeric&&(h-=15);var A=s.drawLine(t.globals.padHorizontal+h+c.offsetX,this.xAxisoffX,t.globals.gridWidth,this.xAxisoffX,c.color,0,c.height);this.elgrid&&this.elgrid.elGridBorders&&t.config.grid.show?this.elgrid.elGridBorders.add(A):e.add(A)}}},{key:"inversedYAxisTitleText",value:function(e){var t=this.w,s=new hr(this.ctx);if(t.config.xaxis.title.text!==void 0){var c=s.group({class:"apexcharts-xaxis-title apexcharts-yaxis-title-inversed"}),h=s.drawText({x:t.globals.gridWidth/2+t.config.xaxis.title.offsetX,y:this.xAxisoffX+parseFloat(this.xaxisFontSize)+parseFloat(t.config.xaxis.title.style.fontSize)+t.config.xaxis.title.offsetY+20,text:t.config.xaxis.title.text,textAnchor:"middle",fontSize:t.config.xaxis.title.style.fontSize,fontFamily:t.config.xaxis.title.style.fontFamily,fontWeight:t.config.xaxis.title.style.fontWeight,foreColor:t.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text ".concat(t.config.xaxis.title.style.cssClass)});c.add(h),e.add(c)}}},{key:"yAxisTitleRotate",value:function(e,t){var s=this.w,c=new hr(this.ctx),h=s.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-texts-g")),A=h?h.getBoundingClientRect():{width:0,height:0},r=s.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-title text")),y=r?r.getBoundingClientRect():{width:0,height:0};if(r){var b=this.xPaddingForYAxisTitle(e,A,y,t);r.setAttribute("x",b.xPos-(t?10:0));var _=c.rotateAroundCenter(r);r.setAttribute("transform","rotate(".concat(t?-1*s.config.yaxis[e].title.rotate:s.config.yaxis[e].title.rotate," ").concat(_.x," ").concat(_.y,")"))}}},{key:"xPaddingForYAxisTitle",value:function(e,t,s,c){var h=this.w,A=0,r=10;return h.config.yaxis[e].title.text===void 0||e<0?{xPos:A,padd:0}:(c?A=t.width+h.config.yaxis[e].title.offsetX+s.width/2+r/2:(A=-1*t.width+h.config.yaxis[e].title.offsetX+r/2+s.width/2,h.globals.isBarHorizontal&&(r=25,A=-1*t.width-h.config.yaxis[e].title.offsetX-r)),{xPos:A,padd:r})}},{key:"setYAxisXPosition",value:function(e,t){var s=this.w,c=0,h=0,A=18,r=1;s.config.yaxis.length>1&&(this.multipleYs=!0),s.config.yaxis.forEach(function(y,b){var _=s.globals.ignoreYAxisIndexes.includes(b)||!y.show||y.floating||e[b].width===0,B=e[b].width+t[b].width;y.opposite?s.globals.isBarHorizontal?(h=s.globals.gridWidth+s.globals.translateX-1,s.globals.translateYAxisX[b]=h-y.labels.offsetX):(h=s.globals.gridWidth+s.globals.translateX+r,_||(r+=B+20),s.globals.translateYAxisX[b]=h-y.labels.offsetX+20):(c=s.globals.translateX-A,_||(A+=B+20),s.globals.translateYAxisX[b]=c+y.labels.offsetX)})}},{key:"setYAxisTextAlignments",value:function(){var e=this.w;ni.listToArray(e.globals.dom.baseEl.getElementsByClassName("apexcharts-yaxis")).forEach(function(t,s){var c=e.config.yaxis[s];if(c&&!c.floating&&c.labels.align!==void 0){var h=e.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(s,"'] .apexcharts-yaxis-texts-g")),A=ni.listToArray(e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(s,"'] .apexcharts-yaxis-label"))),r=h.getBoundingClientRect();A.forEach(function(y){y.setAttribute("text-anchor",c.labels.align)}),c.labels.align!=="left"||c.opposite?c.labels.align==="center"?h.setAttribute("transform","translate(".concat(r.width/2*(c.opposite?1:-1),", 0)")):c.labels.align==="right"&&c.opposite&&h.setAttribute("transform","translate(".concat(r.width,", 0)")):h.setAttribute("transform","translate(-".concat(r.width,", 0)"))}})}}]),a}(),TD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.documentEvent=ni.bind(this.documentEvent,this)}return tn(a,[{key:"addEventListener",value:function(e,t){var s=this.w;s.globals.events.hasOwnProperty(e)?s.globals.events[e].push(t):s.globals.events[e]=[t]}},{key:"removeEventListener",value:function(e,t){var s=this.w;if(s.globals.events.hasOwnProperty(e)){var c=s.globals.events[e].indexOf(t);c!==-1&&s.globals.events[e].splice(c,1)}}},{key:"fireEvent",value:function(e,t){var s=this.w;if(s.globals.events.hasOwnProperty(e)){t&&t.length||(t=[]);for(var c=s.globals.events[e],h=c.length,A=0;A<h;A++)c[A].apply(null,t)}}},{key:"setupEventHandlers",value:function(){var e=this,t=this.w,s=this.ctx,c=t.globals.dom.baseEl.querySelector(t.globals.chartClass);this.ctx.eventList.forEach(function(h){c.addEventListener(h,function(A){var r=A.target.getAttribute("i")===null&&t.globals.capturedSeriesIndex!==-1?t.globals.capturedSeriesIndex:A.target.getAttribute("i"),y=A.target.getAttribute("j")===null&&t.globals.capturedDataPointIndex!==-1?t.globals.capturedDataPointIndex:A.target.getAttribute("j"),b=Object.assign({},t,{seriesIndex:t.globals.axisCharts?r:0,dataPointIndex:y});A.type==="mousemove"||A.type==="touchmove"?typeof t.config.chart.events.mouseMove=="function"&&t.config.chart.events.mouseMove(A,s,b):A.type==="mouseleave"||A.type==="touchleave"?typeof t.config.chart.events.mouseLeave=="function"&&t.config.chart.events.mouseLeave(A,s,b):(A.type==="mouseup"&&A.which===1||A.type==="touchend")&&(typeof t.config.chart.events.click=="function"&&t.config.chart.events.click(A,s,b),s.ctx.events.fireEvent("click",[A,s,b]))},{capture:!1,passive:!0})}),this.ctx.eventList.forEach(function(h){t.globals.dom.baseEl.addEventListener(h,e.documentEvent,{passive:!0})}),this.ctx.core.setupBrushHandler()}},{key:"documentEvent",value:function(e){var t=this.w,s=e.target.className;if(e.type==="click"){var c=t.globals.dom.baseEl.querySelector(".apexcharts-menu");c&&c.classList.contains("apexcharts-menu-open")&&s!=="apexcharts-menu-icon"&&c.classList.remove("apexcharts-menu-open")}t.globals.clientX=e.type==="touchmove"?e.touches[0].clientX:e.clientX,t.globals.clientY=e.type==="touchmove"?e.touches[0].clientY:e.clientY}}]),a}(),FD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"setCurrentLocaleValues",value:function(e){var t=this.w.config.chart.locales;window.Apex.chart&&window.Apex.chart.locales&&window.Apex.chart.locales.length>0&&(t=this.w.config.chart.locales.concat(window.Apex.chart.locales));var s=t.filter(function(h){return h.name===e})[0];if(!s)throw new Error("Wrong locale name provided. Please make sure you set the correct locale name in options");var c=ni.extend(fT,s);this.w.globals.locale=c.options}}]),a}(),LD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawAxis",value:function(e,t){var s,c,h=this,A=this.w.globals,r=this.w.config,y=new $y(this.ctx,t),b=new dw(this.ctx,t);A.axisCharts&&e!=="radar"&&(A.isBarHorizontal?(c=b.drawYaxisInversed(0),s=y.drawXaxisInversed(0),A.dom.elGraphical.add(s),A.dom.elGraphical.add(c)):(s=y.drawXaxis(),A.dom.elGraphical.add(s),r.yaxis.map(function(_,B){if(A.ignoreYAxisIndexes.indexOf(B)===-1&&(c=b.drawYaxis(B),A.dom.Paper.add(c),h.w.config.grid.position==="back")){var I=A.dom.Paper.children()[1];I.remove(),A.dom.Paper.add(I)}})))}}]),a}(),a1=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawXCrosshairs",value:function(){var e=this.w,t=new hr(this.ctx),s=new Uc(this.ctx),c=e.config.xaxis.crosshairs.fill.gradient,h=e.config.xaxis.crosshairs.dropShadow,A=e.config.xaxis.crosshairs.fill.type,r=c.colorFrom,y=c.colorTo,b=c.opacityFrom,_=c.opacityTo,B=c.stops,I=h.enabled,E=h.left,R=h.top,M=h.blur,G=h.color,U=h.opacity,Q=e.config.xaxis.crosshairs.fill.color;if(e.config.xaxis.crosshairs.show){A==="gradient"&&(Q=t.drawGradient("vertical",r,y,b,_,null,B,null));var q=t.drawRect();e.config.xaxis.crosshairs.width===1&&(q=t.drawLine());var ne=e.globals.gridHeight;(!ni.isNumber(ne)||ne<0)&&(ne=0);var re=e.config.xaxis.crosshairs.width;(!ni.isNumber(re)||re<0)&&(re=0),q.attr({class:"apexcharts-xcrosshairs",x:0,y:0,y2:ne,width:re,height:ne,fill:Q,filter:"none","fill-opacity":e.config.xaxis.crosshairs.opacity,stroke:e.config.xaxis.crosshairs.stroke.color,"stroke-width":e.config.xaxis.crosshairs.stroke.width,"stroke-dasharray":e.config.xaxis.crosshairs.stroke.dashArray}),I&&(q=s.dropShadow(q,{left:E,top:R,blur:M,color:G,opacity:U})),e.globals.dom.elGraphical.add(q)}}},{key:"drawYCrosshairs",value:function(){var e=this.w,t=new hr(this.ctx),s=e.config.yaxis[0].crosshairs,c=e.globals.barPadForNumericAxis;if(e.config.yaxis[0].crosshairs.show){var h=t.drawLine(-c,0,e.globals.gridWidth+c,0,s.stroke.color,s.stroke.dashArray,s.stroke.width);h.attr({class:"apexcharts-ycrosshairs"}),e.globals.dom.elGraphical.add(h)}var A=t.drawLine(-c,0,e.globals.gridWidth+c,0,s.stroke.color,0,0);A.attr({class:"apexcharts-ycrosshairs-hidden"}),e.globals.dom.elGraphical.add(A)}}]),a}(),MD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"checkResponsiveConfig",value:function(e){var t=this,s=this.w,c=s.config;if(c.responsive.length!==0){var h=c.responsive.slice();h.sort(function(b,_){return b.breakpoint>_.breakpoint?1:_.breakpoint>b.breakpoint?-1:0}).reverse();var A=new qy({}),r=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=h[0].breakpoint,B=window.innerWidth>0?window.innerWidth:screen.width;if(B>_){var I=ni.clone(s.globals.initialConfig);I.series=ni.clone(s.config.series);var E=sl.extendArrayProps(A,I,s);b=ni.extend(E,b),b=ni.extend(s.config,b),t.overrideResponsiveOptions(b)}else for(var R=0;R<h.length;R++)B<h[R].breakpoint&&(b=sl.extendArrayProps(A,h[R].options,s),b=ni.extend(s.config,b),t.overrideResponsiveOptions(b))};if(e){var y=sl.extendArrayProps(A,e,s);y=ni.extend(s.config,y),r(y=ni.extend(y,e))}else r({})}}},{key:"overrideResponsiveOptions",value:function(e){var t=new qy(e).init({responsiveOverride:!0});this.w.config=t}}]),a}(),PD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.colors=[],this.isColorFn=!1,this.isHeatmapDistributed=this.checkHeatmapDistributed(),this.isBarDistributed=this.checkBarDistributed()}return tn(a,[{key:"checkHeatmapDistributed",value:function(){var e=this.w.config,t=e.chart,s=e.plotOptions;return t.type==="treemap"&&s.treemap&&s.treemap.distributed||t.type==="heatmap"&&s.heatmap&&s.heatmap.distributed}},{key:"checkBarDistributed",value:function(){var e=this.w.config,t=e.chart,s=e.plotOptions;return s.bar&&s.bar.distributed&&(t.type==="bar"||t.type==="rangeBar")}},{key:"init",value:function(){this.setDefaultColors()}},{key:"setDefaultColors",value:function(){var e=this.w,t=new ni;e.globals.dom.elWrap.classList.add("apexcharts-theme-".concat(e.config.theme.mode||"light"));var s=Jl(e.config.colors||e.config.fill.colors||[]);e.globals.colors=this.getColors(s),this.applySeriesColors(e.globals.seriesColors,e.globals.colors),e.config.theme.monochrome.enabled&&(e.globals.colors=this.getMonochromeColors(e.config.theme.monochrome,e.globals.series,t));var c=e.globals.colors.slice();this.pushExtraColors(e.globals.colors),this.applyColorTypes(["fill","stroke"],c),this.applyDataLabelsColors(c),this.applyRadarPolygonsColors(),this.applyMarkersColors(c)}},{key:"getColors",value:function(e){var t=this,s=this.w;return e&&e.length!==0?Array.isArray(e)&&e.length>0&&typeof e[0]=="function"?(this.isColorFn=!0,s.config.series.map(function(c,h){var A=e[h]||e[0];return typeof A=="function"?A({value:s.globals.axisCharts?s.globals.series[h][0]||0:s.globals.series[h],seriesIndex:h,dataPointIndex:h,w:t.w}):A})):e:this.predefined()}},{key:"applySeriesColors",value:function(e,t){e.forEach(function(s,c){s&&(t[c]=s)})}},{key:"getMonochromeColors",value:function(e,t,s){var c=e.color,h=e.shadeIntensity,A=e.shadeTo,r=this.isBarDistributed||this.isHeatmapDistributed?t[0].length*t.length:t.length,y=1/(r/h),b=0;return Array.from({length:r},function(){var _=A==="dark"?s.shadeColor(-1*b,c):s.shadeColor(b,c);return b+=y,_})}},{key:"applyColorTypes",value:function(e,t){var s=this,c=this.w;e.forEach(function(h){c.globals[h].colors=c.config[h].colors===void 0?s.isColorFn?c.config.colors:t:c.config[h].colors.slice(),s.pushExtraColors(c.globals[h].colors)})}},{key:"applyDataLabelsColors",value:function(e){var t=this.w;t.globals.dataLabels.style.colors=t.config.dataLabels.style.colors===void 0?e:t.config.dataLabels.style.colors.slice(),this.pushExtraColors(t.globals.dataLabels.style.colors,50)}},{key:"applyRadarPolygonsColors",value:function(){var e=this.w;e.globals.radarPolygons.fill.colors=e.config.plotOptions.radar.polygons.fill.colors===void 0?[e.config.theme.mode==="dark"?"#343A3F":"none"]:e.config.plotOptions.radar.polygons.fill.colors.slice(),this.pushExtraColors(e.globals.radarPolygons.fill.colors,20)}},{key:"applyMarkersColors",value:function(e){var t=this.w;t.globals.markers.colors=t.config.markers.colors===void 0?e:t.config.markers.colors.slice(),this.pushExtraColors(t.globals.markers.colors)}},{key:"pushExtraColors",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=this.w,h=t||c.globals.series.length;if(s===null&&(s=this.isBarDistributed||this.isHeatmapDistributed||c.config.chart.type==="heatmap"&&c.config.plotOptions.heatmap&&c.config.plotOptions.heatmap.colorScale.inverse),s&&c.globals.series.length&&(h=c.globals.series[c.globals.maxValsInArrayIndex].length*c.globals.series.length),e.length<h)for(var A=h-e.length,r=0;r<A;r++)e.push(e[r])}},{key:"updateThemeOptions",value:function(e){e.chart=e.chart||{},e.tooltip=e.tooltip||{};var t=e.theme.mode,s=t==="dark"?"palette4":t==="light"?"palette1":e.theme.palette||"palette1",c=t==="dark"?"#f6f7f8":t==="light"?"#373d3f":e.chart.foreColor||"#373d3f";return e.tooltip.theme=t||"light",e.chart.foreColor=c,e.theme.palette=s,e}},{key:"predefined",value:function(){var e={palette1:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"],palette2:["#3f51b5","#03a9f4","#4caf50","#f9ce1d","#FF9800"],palette3:["#33b2df","#546E7A","#d4526e","#13d8aa","#A5978B"],palette4:["#4ecdc4","#c7f464","#81D4FA","#fd6a6a","#546E7A"],palette5:["#2b908f","#f9a3a4","#90ee7e","#fa4443","#69d2e7"],palette6:["#449DD1","#F86624","#EA3546","#662E9B","#C5D86D"],palette7:["#D7263D","#1B998B","#2E294E","#F46036","#E2C044"],palette8:["#662E9B","#F86624","#F9C80E","#EA3546","#43BCCD"],palette9:["#5C4742","#A5978B","#8D5B4C","#5A2A27","#C4BBAF"],palette10:["#A300D6","#7D02EB","#5653FE","#2983FF","#00B1F2"],default:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"]};return e[this.w.config.theme.palette]||e.default}}]),a}(),kD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"draw",value:function(){this.drawTitleSubtitle("title"),this.drawTitleSubtitle("subtitle")}},{key:"drawTitleSubtitle",value:function(e){var t=this.w,s=e==="title"?t.config.title:t.config.subtitle,c=t.globals.svgWidth/2,h=s.offsetY,A="middle";if(s.align==="left"?(c=10,A="start"):s.align==="right"&&(c=t.globals.svgWidth-10,A="end"),c+=s.offsetX,h=h+parseInt(s.style.fontSize,10)+s.margin/2,s.text!==void 0){var r=new hr(this.ctx).drawText({x:c,y:h,text:s.text,textAnchor:A,fontSize:s.style.fontSize,fontFamily:s.style.fontFamily,fontWeight:s.style.fontWeight,foreColor:s.style.color,opacity:1});r.node.setAttribute("class","apexcharts-".concat(e,"-text")),t.globals.dom.Paper.add(r)}}}]),a}(),RD=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getTitleSubtitleCoords",value:function(e){var t=this.w,s=0,c=0,h=e==="title"?t.config.title.floating:t.config.subtitle.floating,A=t.globals.dom.baseEl.querySelector(".apexcharts-".concat(e,"-text"));if(A!==null&&!h){var r=A.getBoundingClientRect();s=r.width,c=t.globals.axisCharts?r.height+5:r.height}return{width:s,height:c}}},{key:"getLegendsRect",value:function(){var e=this.w,t=e.globals.dom.elLegendWrap;e.config.legend.height||e.config.legend.position!=="top"&&e.config.legend.position!=="bottom"||(t.style.maxHeight=e.globals.svgHeight/2+"px");var s=Object.assign({},ni.getBoundingClientRect(t));return t!==null&&!e.config.legend.floating&&e.config.legend.show?this.dCtx.lgRect={x:s.x,y:s.y,height:s.height,width:s.height===0?0:s.width}:this.dCtx.lgRect={x:0,y:0,height:0,width:0},e.config.legend.position!=="left"&&e.config.legend.position!=="right"||1.5*this.dCtx.lgRect.width>e.globals.svgWidth&&(this.dCtx.lgRect.width=e.globals.svgWidth/1.5),this.dCtx.lgRect}},{key:"getDatalabelsRect",value:function(){var e=this,t=this.w,s=[];t.config.series.forEach(function(y,b){y.data.forEach(function(_,B){var I;I=t.globals.series[b][B],c=t.config.dataLabels.formatter(I,{ctx:e.dCtx.ctx,seriesIndex:b,dataPointIndex:B,w:t}),s.push(c)})});var c=ni.getLargestStringFromArr(s),h=new hr(this.dCtx.ctx),A=t.config.dataLabels.style,r=h.getTextRects(c,parseInt(A.fontSize),A.fontFamily);return{width:1.05*r.width,height:r.height}}},{key:"getLargestStringFromMultiArr",value:function(e,t){var s=e;if(this.w.globals.isMultiLineX){var c=t.map(function(A,r){return Array.isArray(A)?A.length:1}),h=Math.max.apply(Math,Jl(c));s=t[c.indexOf(h)]}return s}}]),a}(),DD=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getxAxisLabelsCoords",value:function(){var e,t=this.w,s=t.globals.labels.slice();if(t.config.xaxis.convertedCatToNumeric&&s.length===0&&(s=t.globals.categoryLabels),t.globals.timescaleLabels.length>0){var c=this.getxAxisTimeScaleLabelsCoords();e={width:c.width,height:c.height},t.globals.rotateXLabels=!1}else{this.dCtx.lgWidthForSideLegends=t.config.legend.position!=="left"&&t.config.legend.position!=="right"||t.config.legend.floating?0:this.dCtx.lgRect.width;var h=t.globals.xLabelFormatter,A=ni.getLargestStringFromArr(s),r=this.dCtx.dimHelpers.getLargestStringFromMultiArr(A,s);t.globals.isBarHorizontal&&(r=A=t.globals.yAxisScale[0].result.reduce(function(R,M){return R.length>M.length?R:M},0));var y=new hv(this.dCtx.ctx),b=A;A=y.xLabelFormat(h,A,b,{i:void 0,dateFormatter:new Oc(this.dCtx.ctx).formatDate,w:t}),r=y.xLabelFormat(h,r,b,{i:void 0,dateFormatter:new Oc(this.dCtx.ctx).formatDate,w:t}),(t.config.xaxis.convertedCatToNumeric&&A===void 0||String(A).trim()==="")&&(r=A="1");var _=new hr(this.dCtx.ctx),B=_.getTextRects(A,t.config.xaxis.labels.style.fontSize),I=B;if(A!==r&&(I=_.getTextRects(r,t.config.xaxis.labels.style.fontSize)),(e={width:B.width>=I.width?B.width:I.width,height:B.height>=I.height?B.height:I.height}).width*s.length>t.globals.svgWidth-this.dCtx.lgWidthForSideLegends-this.dCtx.yAxisWidth-this.dCtx.gridPad.left-this.dCtx.gridPad.right&&t.config.xaxis.labels.rotate!==0||t.config.xaxis.labels.rotateAlways){if(!t.globals.isBarHorizontal){t.globals.rotateXLabels=!0;var E=function(R){return _.getTextRects(R,t.config.xaxis.labels.style.fontSize,t.config.xaxis.labels.style.fontFamily,"rotate(".concat(t.config.xaxis.labels.rotate," 0 0)"),!1)};B=E(A),A!==r&&(I=E(r)),e.height=(B.height>I.height?B.height:I.height)/1.5,e.width=B.width>I.width?B.width:I.width}}else t.globals.rotateXLabels=!1}return t.config.xaxis.labels.show||(e={width:0,height:0}),{width:e.width,height:e.height}}},{key:"getxAxisGroupLabelsCoords",value:function(){var e,t=this.w;if(!t.globals.hasXaxisGroups)return{width:0,height:0};var s,c=((e=t.config.xaxis.group.style)===null||e===void 0?void 0:e.fontSize)||t.config.xaxis.labels.style.fontSize,h=t.globals.groups.map(function(B){return B.title}),A=ni.getLargestStringFromArr(h),r=this.dCtx.dimHelpers.getLargestStringFromMultiArr(A,h),y=new hr(this.dCtx.ctx),b=y.getTextRects(A,c),_=b;return A!==r&&(_=y.getTextRects(r,c)),s={width:b.width>=_.width?b.width:_.width,height:b.height>=_.height?b.height:_.height},t.config.xaxis.labels.show||(s={width:0,height:0}),{width:s.width,height:s.height}}},{key:"getxAxisTitleCoords",value:function(){var e=this.w,t=0,s=0;if(e.config.xaxis.title.text!==void 0){var c=new hr(this.dCtx.ctx).getTextRects(e.config.xaxis.title.text,e.config.xaxis.title.style.fontSize);t=c.width,s=c.height}return{width:t,height:s}}},{key:"getxAxisTimeScaleLabelsCoords",value:function(){var e,t=this.w;this.dCtx.timescaleLabels=t.globals.timescaleLabels.slice();var s=this.dCtx.timescaleLabels.map(function(h){return h.value}),c=s.reduce(function(h,A){return h===void 0?(console.error("You have possibly supplied invalid Date format. Please supply a valid JavaScript Date"),0):h.length>A.length?h:A},0);return 1.05*(e=new hr(this.dCtx.ctx).getTextRects(c,t.config.xaxis.labels.style.fontSize)).width*s.length>t.globals.gridWidth&&t.config.xaxis.labels.rotate!==0&&(t.globals.overlappingXLabels=!0),e}},{key:"additionalPaddingXLabels",value:function(e){var t=this,s=this.w,c=s.globals,h=s.config,A=h.xaxis.type,r=e.width;c.skipLastTimelinelabel=!1,c.skipFirstTimelinelabel=!1;var y=s.config.yaxis[0].opposite&&s.globals.isBarHorizontal,b=function(_,B){h.yaxis.length>1&&function(I){return c.collapsedSeriesIndices.indexOf(I)!==-1}(B)||function(I){if(t.dCtx.timescaleLabels&&t.dCtx.timescaleLabels.length){var E=t.dCtx.timescaleLabels[0],R=t.dCtx.timescaleLabels[t.dCtx.timescaleLabels.length-1].position+r/1.75-t.dCtx.yAxisWidthRight,M=E.position-r/1.75+t.dCtx.yAxisWidthLeft,G=s.config.legend.position==="right"&&t.dCtx.lgRect.width>0?t.dCtx.lgRect.width:0;R>c.svgWidth-c.translateX-G&&(c.skipLastTimelinelabel=!0),M<-(I.show&&!I.floating||h.chart.type!=="bar"&&h.chart.type!=="candlestick"&&h.chart.type!=="rangeBar"&&h.chart.type!=="boxPlot"?10:r/1.75)&&(c.skipFirstTimelinelabel=!0)}else A==="datetime"?t.dCtx.gridPad.right<r&&!c.rotateXLabels&&(c.skipLastTimelinelabel=!0):A!=="datetime"&&t.dCtx.gridPad.right<r/2-t.dCtx.yAxisWidthRight&&!c.rotateXLabels&&!s.config.xaxis.labels.trim&&(t.dCtx.xPadRight=r/2+1)}(_)};h.yaxis.forEach(function(_,B){y?(t.dCtx.gridPad.left<r&&(t.dCtx.xPadLeft=r/2+1),t.dCtx.xPadRight=r/2+1):b(_,B)})}}]),a}(),OD=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"getyAxisLabelsCoords",value:function(){var e=this,t=this.w,s=[],c=10,h=new Mp(this.dCtx.ctx);return t.config.yaxis.map(function(A,r){var y={seriesIndex:r,dataPointIndex:-1,w:t},b=t.globals.yAxisScale[r],_=0;if(!h.isYAxisHidden(r)&&A.labels.show&&A.labels.minWidth!==void 0&&(_=A.labels.minWidth),!h.isYAxisHidden(r)&&A.labels.show&&b.result.length){var B=t.globals.yLabelFormatters[r],I=b.niceMin===Number.MIN_VALUE?0:b.niceMin,E=b.result.reduce(function(ne,re){var pe,Ae;return((pe=String(B(ne,y)))===null||pe===void 0?void 0:pe.length)>((Ae=String(B(re,y)))===null||Ae===void 0?void 0:Ae.length)?ne:re},I),R=E=B(E,y);if(E!==void 0&&E.length!==0||(E=b.niceMax),t.globals.isBarHorizontal){c=0;var M=t.globals.labels.slice();E=ni.getLargestStringFromArr(M),E=B(E,{seriesIndex:r,dataPointIndex:-1,w:t}),R=e.dCtx.dimHelpers.getLargestStringFromMultiArr(E,M)}var G=new hr(e.dCtx.ctx),U="rotate(".concat(A.labels.rotate," 0 0)"),Q=G.getTextRects(E,A.labels.style.fontSize,A.labels.style.fontFamily,U,!1),q=Q;E!==R&&(q=G.getTextRects(R,A.labels.style.fontSize,A.labels.style.fontFamily,U,!1)),s.push({width:(_>q.width||_>Q.width?_:q.width>Q.width?q.width:Q.width)+c,height:q.height>Q.height?q.height:Q.height})}else s.push({width:0,height:0})}),s}},{key:"getyAxisTitleCoords",value:function(){var e=this,t=this.w,s=[];return t.config.yaxis.map(function(c,h){if(c.show&&c.title.text!==void 0){var A=new hr(e.dCtx.ctx),r="rotate(".concat(c.title.rotate," 0 0)"),y=A.getTextRects(c.title.text,c.title.style.fontSize,c.title.style.fontFamily,r,!1);s.push({width:y.width,height:y.height})}else s.push({width:0,height:0})}),s}},{key:"getTotalYAxisWidth",value:function(){var e=this.w,t=0,s=0,c=0,h=e.globals.yAxisScale.length>1?10:0,A=new Mp(this.dCtx.ctx),r=function(y,b){var _=e.config.yaxis[b].floating,B=0;y.width>0&&!_?(B=y.width+h,function(I){return e.globals.ignoreYAxisIndexes.indexOf(I)>-1}(b)&&(B=B-y.width-h)):B=_||A.isYAxisHidden(b)?0:5,e.config.yaxis[b].opposite?c+=B:s+=B,t+=B};return e.globals.yLabelsCoords.map(function(y,b){r(y,b)}),e.globals.yTitleCoords.map(function(y,b){r(y,b)}),e.globals.isBarHorizontal&&!e.config.yaxis[0].floating&&(t=e.globals.yLabelsCoords[0].width+e.globals.yTitleCoords[0].width+15),this.dCtx.yAxisWidthLeft=s,this.dCtx.yAxisWidthRight=c,t}}]),a}(),UD=function(){function a(e){en(this,a),this.w=e.w,this.dCtx=e}return tn(a,[{key:"gridPadForColumnsInNumericAxis",value:function(e){var t=this.w,s=t.config,c=t.globals;if(c.noData||c.collapsedSeries.length+c.ancillaryCollapsedSeries.length===s.series.length)return 0;var h=function(E){return["bar","rangeBar","candlestick","boxPlot"].includes(E)},A=s.chart.type,r=0,y=h(A)?s.series.length:1;c.comboBarCount>0&&(y=c.comboBarCount),c.collapsedSeries.forEach(function(E){h(E.type)&&(y-=1)}),s.chart.stacked&&(y=1);var b=h(A)||c.comboBarCount>0,_=Math.abs(c.initialMaxX-c.initialMinX);if(b&&c.isXNumeric&&!c.isBarHorizontal&&y>0&&_!==0){_<=3&&(_=c.dataPoints);var B=_/e,I=c.minXDiff&&c.minXDiff/B>0?c.minXDiff/B:0;I>e/2&&(I/=2),(r=I*parseInt(s.plotOptions.bar.columnWidth,10)/100)<1&&(r=1),c.barPadForNumericAxis=r}return r}},{key:"gridPadFortitleSubtitle",value:function(){var e=this,t=this.w,s=t.globals,c=this.dCtx.isSparkline||!s.axisCharts?0:10;["title","subtitle"].forEach(function(r){t.config[r].text!==void 0?c+=t.config[r].margin:c+=e.dCtx.isSparkline||!s.axisCharts?0:5}),!t.config.legend.show||t.config.legend.position!=="bottom"||t.config.legend.floating||s.axisCharts||(c+=10);var h=this.dCtx.dimHelpers.getTitleSubtitleCoords("title"),A=this.dCtx.dimHelpers.getTitleSubtitleCoords("subtitle");s.gridHeight-=h.height+A.height+c,s.translateY+=h.height+A.height+c}},{key:"setGridXPosForDualYAxis",value:function(e,t){var s=this.w,c=new Mp(this.dCtx.ctx);s.config.yaxis.forEach(function(h,A){s.globals.ignoreYAxisIndexes.indexOf(A)!==-1||h.floating||c.isYAxisHidden(A)||(h.opposite&&(s.globals.translateX-=t[A].width+e[A].width+parseInt(h.labels.style.fontSize,10)/1.2+12),s.globals.translateX<2&&(s.globals.translateX=2))})}}]),a}(),K0=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.lgRect={},this.yAxisWidth=0,this.yAxisWidthLeft=0,this.yAxisWidthRight=0,this.xAxisHeight=0,this.isSparkline=this.w.config.chart.sparkline.enabled,this.dimHelpers=new RD(this),this.dimYAxis=new OD(this),this.dimXAxis=new DD(this),this.dimGrid=new UD(this),this.lgWidthForSideLegends=0,this.gridPad=this.w.config.grid.padding,this.xPadRight=0,this.xPadLeft=0}return tn(a,[{key:"plotCoords",value:function(){var e=this,t=this.w,s=t.globals;this.lgRect=this.dimHelpers.getLegendsRect(),this.datalabelsCoords={width:0,height:0};var c=Array.isArray(t.config.stroke.width)?Math.max.apply(Math,Jl(t.config.stroke.width)):t.config.stroke.width;this.isSparkline&&((t.config.markers.discrete.length>0||t.config.markers.size>0)&&Object.entries(this.gridPad).forEach(function(A){var r=OI(A,2),y=r[0],b=r[1];e.gridPad[y]=Math.max(b,e.w.globals.markers.largestSize/1.5)}),this.gridPad.top=Math.max(c/2,this.gridPad.top),this.gridPad.bottom=Math.max(c/2,this.gridPad.bottom)),s.axisCharts?this.setDimensionsForAxisCharts():this.setDimensionsForNonAxisCharts(),this.dimGrid.gridPadFortitleSubtitle(),s.gridHeight=s.gridHeight-this.gridPad.top-this.gridPad.bottom,s.gridWidth=s.gridWidth-this.gridPad.left-this.gridPad.right-this.xPadRight-this.xPadLeft;var h=this.dimGrid.gridPadForColumnsInNumericAxis(s.gridWidth);s.gridWidth=s.gridWidth-2*h,s.translateX=s.translateX+this.gridPad.left+this.xPadLeft+(h>0?h:0),s.translateY=s.translateY+this.gridPad.top}},{key:"setDimensionsForAxisCharts",value:function(){var e=this,t=this.w,s=t.globals,c=this.dimYAxis.getyAxisLabelsCoords(),h=this.dimYAxis.getyAxisTitleCoords();s.isSlopeChart&&(this.datalabelsCoords=this.dimHelpers.getDatalabelsRect()),t.globals.yLabelsCoords=[],t.globals.yTitleCoords=[],t.config.yaxis.map(function(E,R){t.globals.yLabelsCoords.push({width:c[R].width,index:R}),t.globals.yTitleCoords.push({width:h[R].width,index:R})}),this.yAxisWidth=this.dimYAxis.getTotalYAxisWidth();var A=this.dimXAxis.getxAxisLabelsCoords(),r=this.dimXAxis.getxAxisGroupLabelsCoords(),y=this.dimXAxis.getxAxisTitleCoords();this.conditionalChecksForAxisCoords(A,y,r),s.translateXAxisY=t.globals.rotateXLabels?this.xAxisHeight/8:-4,s.translateXAxisX=t.globals.rotateXLabels&&t.globals.isXNumeric&&t.config.xaxis.labels.rotate<=-45?-this.xAxisWidth/4:0,t.globals.isBarHorizontal&&(s.rotateXLabels=!1,s.translateXAxisY=parseInt(t.config.xaxis.labels.style.fontSize,10)/1.5*-1),s.translateXAxisY=s.translateXAxisY+t.config.xaxis.labels.offsetY,s.translateXAxisX=s.translateXAxisX+t.config.xaxis.labels.offsetX;var b=this.yAxisWidth,_=this.xAxisHeight;s.xAxisLabelsHeight=this.xAxisHeight-y.height,s.xAxisGroupLabelsHeight=s.xAxisLabelsHeight-A.height,s.xAxisLabelsWidth=this.xAxisWidth,s.xAxisHeight=this.xAxisHeight;var B=10;(t.config.chart.type==="radar"||this.isSparkline)&&(b=0,_=0),this.isSparkline&&(this.lgRect={height:0,width:0}),(this.isSparkline||t.config.chart.type==="treemap")&&(b=0,_=0,B=0),this.isSparkline||t.config.chart.type==="treemap"||this.dimXAxis.additionalPaddingXLabels(A);var I=function(){s.translateX=b+e.datalabelsCoords.width,s.gridHeight=s.svgHeight-e.lgRect.height-_-(e.isSparkline||t.config.chart.type==="treemap"?0:t.globals.rotateXLabels?10:15),s.gridWidth=s.svgWidth-b-2*e.datalabelsCoords.width};switch(t.config.xaxis.position==="top"&&(B=s.xAxisHeight-t.config.xaxis.axisTicks.height-5),t.config.legend.position){case"bottom":s.translateY=B,I();break;case"top":s.translateY=this.lgRect.height+B,I();break;case"left":s.translateY=B,s.translateX=this.lgRect.width+b+this.datalabelsCoords.width,s.gridHeight=s.svgHeight-_-12,s.gridWidth=s.svgWidth-this.lgRect.width-b-2*this.datalabelsCoords.width;break;case"right":s.translateY=B,s.translateX=b+this.datalabelsCoords.width,s.gridHeight=s.svgHeight-_-12,s.gridWidth=s.svgWidth-this.lgRect.width-b-2*this.datalabelsCoords.width-5;break;default:throw new Error("Legend position not supported")}this.dimGrid.setGridXPosForDualYAxis(h,c),new dw(this.ctx).setYAxisXPosition(c,h)}},{key:"setDimensionsForNonAxisCharts",value:function(){var e=this.w,t=e.globals,s=e.config,c=0;e.config.legend.show&&!e.config.legend.floating&&(c=20);var h=s.chart.type==="pie"||s.chart.type==="polarArea"||s.chart.type==="donut"?"pie":"radialBar",A=s.plotOptions[h].offsetY,r=s.plotOptions[h].offsetX;if(!s.legend.show||s.legend.floating){t.gridHeight=t.svgHeight;var y=t.dom.elWrap.getBoundingClientRect().width;return t.gridWidth=Math.min(y,t.gridHeight),t.translateY=A,void(t.translateX=r+(t.svgWidth-t.gridWidth)/2)}switch(s.legend.position){case"bottom":t.gridHeight=t.svgHeight-this.lgRect.height,t.gridWidth=t.svgWidth,t.translateY=A-10,t.translateX=r+(t.svgWidth-t.gridWidth)/2;break;case"top":t.gridHeight=t.svgHeight-this.lgRect.height,t.gridWidth=t.svgWidth,t.translateY=this.lgRect.height+A+10,t.translateX=r+(t.svgWidth-t.gridWidth)/2;break;case"left":t.gridWidth=t.svgWidth-this.lgRect.width-c,t.gridHeight=s.chart.height!=="auto"?t.svgHeight:t.gridWidth,t.translateY=A,t.translateX=r+this.lgRect.width+c;break;case"right":t.gridWidth=t.svgWidth-this.lgRect.width-c-5,t.gridHeight=s.chart.height!=="auto"?t.svgHeight:t.gridWidth,t.translateY=A,t.translateX=r+10;break;default:throw new Error("Legend position not supported")}}},{key:"conditionalChecksForAxisCoords",value:function(e,t,s){var c=this.w,h=c.globals.hasXaxisGroups?2:1,A=s.height+e.height+t.height,r=c.globals.isMultiLineX?1.2:c.globals.LINE_HEIGHT_RATIO,y=c.globals.rotateXLabels?22:10,b=c.globals.rotateXLabels&&c.config.legend.position==="bottom"?10:0;this.xAxisHeight=A*r+h*y+b,this.xAxisWidth=e.width,this.xAxisHeight-t.height>c.config.xaxis.labels.maxHeight&&(this.xAxisHeight=c.config.xaxis.labels.maxHeight),c.config.xaxis.labels.minHeight&&this.xAxisHeight<c.config.xaxis.labels.minHeight&&(this.xAxisHeight=c.config.xaxis.labels.minHeight),c.config.xaxis.floating&&(this.xAxisHeight=0);var _=0,B=0;c.config.yaxis.forEach(function(I){_+=I.labels.minWidth,B+=I.labels.maxWidth}),this.yAxisWidth<_&&(this.yAxisWidth=_),this.yAxisWidth>B&&(this.yAxisWidth=B)}}]),a}(),zD=function(){function a(e){en(this,a),this.w=e.w,this.lgCtx=e}return tn(a,[{key:"getLegendStyles",value:function(){var e,t,s,c=document.createElement("style");c.setAttribute("type","text/css");var h=((e=this.lgCtx.ctx)===null||e===void 0||(t=e.opts)===null||t===void 0||(s=t.chart)===null||s===void 0?void 0:s.nonce)||this.w.config.chart.nonce;h&&c.setAttribute("nonce",h);var A=document.createTextNode(`
      .apexcharts-flip-y {
        transform: scaleY(-1) translateY(-100%);
        transform-origin: top;
        transform-box: fill-box;
      }
      .apexcharts-flip-x {
        transform: scaleX(-1);
        transform-origin: center;
        transform-box: fill-box;
      }
      .apexcharts-legend {
        display: flex;
        overflow: auto;
        padding: 0 10px;
      }
      .apexcharts-legend.apexcharts-legend-group-horizontal {
        flex-direction: column;
      }
      .apexcharts-legend-group {
        display: flex;
      }
      .apexcharts-legend-group-vertical {
        flex-direction: column-reverse;
      }
      .apexcharts-legend.apx-legend-position-bottom, .apexcharts-legend.apx-legend-position-top {
        flex-wrap: wrap
      }
      .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {
        flex-direction: column;
        bottom: 0;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-left, .apexcharts-legend.apx-legend-position-top.apexcharts-align-left, .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {
        justify-content: flex-start;
        align-items: flex-start;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-center, .apexcharts-legend.apx-legend-position-top.apexcharts-align-center {
        justify-content: center;
        align-items: center;
      }
      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-right, .apexcharts-legend.apx-legend-position-top.apexcharts-align-right {
        justify-content: flex-end;
        align-items: flex-end;
      }
      .apexcharts-legend-series {
        cursor: pointer;
        line-height: normal;
        display: flex;
        align-items: center;
      }
      .apexcharts-legend-text {
        position: relative;
        font-size: 14px;
      }
      .apexcharts-legend-text *, .apexcharts-legend-marker * {
        pointer-events: none;
      }
      .apexcharts-legend-marker {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-right: 1px;
      }

      .apexcharts-legend-series.apexcharts-no-click {
        cursor: auto;
      }
      .apexcharts-legend .apexcharts-hidden-zero-series, .apexcharts-legend .apexcharts-hidden-null-series {
        display: none !important;
      }
      .apexcharts-inactive-legend {
        opacity: 0.45;
      }

    `);return c.appendChild(A),c}},{key:"getLegendDimensions",value:function(){var e=this.w.globals.dom.baseEl.querySelector(".apexcharts-legend").getBoundingClientRect(),t=e.width;return{clwh:e.height,clww:t}}},{key:"appendToForeignObject",value:function(){this.w.globals.dom.elLegendForeign.appendChild(this.getLegendStyles())}},{key:"toggleDataSeries",value:function(e,t){var s=this,c=this.w;if(c.globals.axisCharts||c.config.chart.type==="radialBar"){c.globals.resized=!0;var h=null,A=null;c.globals.risingSeries=[],c.globals.axisCharts?(h=c.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(e,"']")),A=parseInt(h.getAttribute("data:realIndex"),10)):(h=c.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(e+1,"']")),A=parseInt(h.getAttribute("rel"),10)-1),t?[{cs:c.globals.collapsedSeries,csi:c.globals.collapsedSeriesIndices},{cs:c.globals.ancillaryCollapsedSeries,csi:c.globals.ancillaryCollapsedSeriesIndices}].forEach(function(_){s.riseCollapsedSeries(_.cs,_.csi,A)}):this.hideSeries({seriesEl:h,realIndex:A})}else{var r=c.globals.dom.Paper.findOne(" .apexcharts-series[rel='".concat(e+1,"'] path")),y=c.config.chart.type;if(y==="pie"||y==="polarArea"||y==="donut"){var b=c.config.plotOptions.pie.donut.labels;new hr(this.lgCtx.ctx).pathMouseDown(r,null),this.lgCtx.ctx.pie.printDataLabelsInner(r.node,b)}r.fire("click")}}},{key:"getSeriesAfterCollapsing",value:function(e){var t=e.realIndex,s=this.w,c=s.globals,h=ni.clone(s.config.series);if(c.axisCharts){var A=s.config.yaxis[c.seriesYAxisReverseMap[t]],r={index:t,data:h[t].data.slice(),type:h[t].type||s.config.chart.type};if(A&&A.show&&A.showAlways)c.ancillaryCollapsedSeriesIndices.indexOf(t)<0&&(c.ancillaryCollapsedSeries.push(r),c.ancillaryCollapsedSeriesIndices.push(t));else if(c.collapsedSeriesIndices.indexOf(t)<0){c.collapsedSeries.push(r),c.collapsedSeriesIndices.push(t);var y=c.risingSeries.indexOf(t);c.risingSeries.splice(y,1)}}else c.collapsedSeries.push({index:t,data:h[t]}),c.collapsedSeriesIndices.push(t);return c.allSeriesCollapsed=c.collapsedSeries.length+c.ancillaryCollapsedSeries.length===s.config.series.length,this._getSeriesBasedOnCollapsedState(h)}},{key:"hideSeries",value:function(e){for(var t=e.seriesEl,s=e.realIndex,c=this.w,h=this.getSeriesAfterCollapsing({realIndex:s}),A=t.childNodes,r=0;r<A.length;r++)A[r].classList.contains("apexcharts-series-markers-wrap")&&(A[r].classList.contains("apexcharts-hide")?A[r].classList.remove("apexcharts-hide"):A[r].classList.add("apexcharts-hide"));this.lgCtx.ctx.updateHelpers._updateSeries(h,c.config.chart.animations.dynamicAnimation.enabled)}},{key:"riseCollapsedSeries",value:function(e,t,s){var c=this.w,h=ni.clone(c.config.series);if(e.length>0){for(var A=0;A<e.length;A++)e[A].index===s&&(c.globals.axisCharts?h[s].data=e[A].data.slice():h[s]=e[A].data,typeof h[s]!="number"&&(h[s].hidden=!1),e.splice(A,1),t.splice(A,1),c.globals.risingSeries.push(s));h=this._getSeriesBasedOnCollapsedState(h),this.lgCtx.ctx.updateHelpers._updateSeries(h,c.config.chart.animations.dynamicAnimation.enabled)}}},{key:"_getSeriesBasedOnCollapsedState",value:function(e){var t=this.w,s=0;return t.globals.axisCharts?e.forEach(function(c,h){t.globals.collapsedSeriesIndices.indexOf(h)<0&&t.globals.ancillaryCollapsedSeriesIndices.indexOf(h)<0||(e[h].data=[],s++)}):e.forEach(function(c,h){!t.globals.collapsedSeriesIndices.indexOf(h)<0&&(e[h]=0,s++)}),t.globals.allSeriesCollapsed=s===e.length,e}}]),a}(),vT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.onLegendClick=this.onLegendClick.bind(this),this.onLegendHovered=this.onLegendHovered.bind(this),this.isBarsDistributed=this.w.config.chart.type==="bar"&&this.w.config.plotOptions.bar.distributed&&this.w.config.series.length===1,this.legendHelpers=new zD(this)}return tn(a,[{key:"init",value:function(){var e=this.w,t=e.globals,s=e.config,c=s.legend.showForSingleSeries&&t.series.length===1||this.isBarsDistributed||t.series.length>1;if(this.legendHelpers.appendToForeignObject(),(c||!t.axisCharts)&&s.legend.show){for(;t.dom.elLegendWrap.firstChild;)t.dom.elLegendWrap.removeChild(t.dom.elLegendWrap.firstChild);this.drawLegends(),s.legend.position==="bottom"||s.legend.position==="top"?this.legendAlignHorizontal():s.legend.position!=="right"&&s.legend.position!=="left"||this.legendAlignVertical()}}},{key:"createLegendMarker",value:function(e){var t=e.i,s=e.fillcolor,c=this.w,h=document.createElement("span");h.classList.add("apexcharts-legend-marker");var A=c.config.legend.markers.shape||c.config.markers.shape,r=A;Array.isArray(A)&&(r=A[t]);var y=Array.isArray(c.config.legend.markers.size)?parseFloat(c.config.legend.markers.size[t]):parseFloat(c.config.legend.markers.size),b=Array.isArray(c.config.legend.markers.offsetX)?parseFloat(c.config.legend.markers.offsetX[t]):parseFloat(c.config.legend.markers.offsetX),_=Array.isArray(c.config.legend.markers.offsetY)?parseFloat(c.config.legend.markers.offsetY[t]):parseFloat(c.config.legend.markers.offsetY),B=Array.isArray(c.config.legend.markers.strokeWidth)?parseFloat(c.config.legend.markers.strokeWidth[t]):parseFloat(c.config.legend.markers.strokeWidth),I=h.style;if(I.height=2*(y+B)+"px",I.width=2*(y+B)+"px",I.left=b+"px",I.top=_+"px",c.config.legend.markers.customHTML)I.background="transparent",I.color=s[t],Array.isArray(c.config.legend.markers.customHTML)?c.config.legend.markers.customHTML[t]&&(h.innerHTML=c.config.legend.markers.customHTML[t]()):h.innerHTML=c.config.legend.markers.customHTML();else{var E=new wm(this.ctx).getMarkerConfig({cssClass:"apexcharts-legend-marker apexcharts-marker apexcharts-marker-".concat(r),seriesIndex:t,strokeWidth:B,size:y}),R=window.SVG().addTo(h).size("100%","100%"),M=new hr(this.ctx).drawMarker(0,0,Ir(Ir({},E),{},{pointFillColor:Array.isArray(s)?s[t]:E.pointFillColor,shape:r}));c.globals.dom.Paper.find(".apexcharts-legend-marker.apexcharts-marker").forEach(function(G){G.node.classList.contains("apexcharts-marker-triangle")?G.node.style.transform="translate(50%, 45%)":G.node.style.transform="translate(50%, 50%)"}),R.add(M)}return h}},{key:"drawLegends",value:function(){var e=this,t=this,s=this.w,c=s.config.legend.fontFamily,h=s.globals.seriesNames,A=s.config.legend.markers.fillColors?s.config.legend.markers.fillColors.slice():s.globals.colors.slice();if(s.config.chart.type==="heatmap"){var r=s.config.plotOptions.heatmap.colorScale.ranges;h=r.map(function(E){return E.name?E.name:E.from+" - "+E.to}),A=r.map(function(E){return E.color})}else this.isBarsDistributed&&(h=s.globals.labels.slice());s.config.legend.customLegendItems.length&&(h=s.config.legend.customLegendItems);var y=s.globals.legendFormatter,b=s.config.legend.inverseOrder,_=[];s.globals.seriesGroups.length>1&&s.config.legend.clusterGroupedSeries&&s.globals.seriesGroups.forEach(function(E,R){_[R]=document.createElement("div"),_[R].classList.add("apexcharts-legend-group","apexcharts-legend-group-".concat(R)),s.config.legend.clusterGroupedSeriesOrientation==="horizontal"?s.globals.dom.elLegendWrap.classList.add("apexcharts-legend-group-horizontal"):_[R].classList.add("apexcharts-legend-group-vertical")});for(var B=function(E){var R,M=y(h[E],{seriesIndex:E,w:s}),G=!1,U=!1;if(s.globals.collapsedSeries.length>0)for(var Q=0;Q<s.globals.collapsedSeries.length;Q++)s.globals.collapsedSeries[Q].index===E&&(G=!0);if(s.globals.ancillaryCollapsedSeriesIndices.length>0)for(var q=0;q<s.globals.ancillaryCollapsedSeriesIndices.length;q++)s.globals.ancillaryCollapsedSeriesIndices[q]===E&&(U=!0);var ne=e.createLegendMarker({i:E,fillcolor:A});hr.setAttrs(ne,{rel:E+1,"data:collapsed":G||U}),(G||U)&&ne.classList.add("apexcharts-inactive-legend");var re=document.createElement("div"),pe=document.createElement("span");pe.classList.add("apexcharts-legend-text"),pe.innerHTML=Array.isArray(M)?M.join(" "):M;var Ae=s.config.legend.labels.useSeriesColors?s.globals.colors[E]:Array.isArray(s.config.legend.labels.colors)?(R=s.config.legend.labels.colors)===null||R===void 0?void 0:R[E]:s.config.legend.labels.colors;Ae||(Ae=s.config.chart.foreColor),pe.style.color=Ae,pe.style.fontSize=parseFloat(s.config.legend.fontSize)+"px",pe.style.fontWeight=s.config.legend.fontWeight,pe.style.fontFamily=c||s.config.chart.fontFamily,hr.setAttrs(pe,{rel:E+1,i:E,"data:default-text":encodeURIComponent(M),"data:collapsed":G||U}),re.appendChild(ne),re.appendChild(pe);var le=new sl(e.ctx);s.config.legend.showForZeroSeries||le.getSeriesTotalByIndex(E)===0&&le.seriesHaveSameValues(E)&&!le.isSeriesNull(E)&&s.globals.collapsedSeriesIndices.indexOf(E)===-1&&s.globals.ancillaryCollapsedSeriesIndices.indexOf(E)===-1&&re.classList.add("apexcharts-hidden-zero-series"),s.config.legend.showForNullSeries||le.isSeriesNull(E)&&s.globals.collapsedSeriesIndices.indexOf(E)===-1&&s.globals.ancillaryCollapsedSeriesIndices.indexOf(E)===-1&&re.classList.add("apexcharts-hidden-null-series"),_.length?s.globals.seriesGroups.forEach(function(be,we){var oe;be.includes((oe=s.config.series[E])===null||oe===void 0?void 0:oe.name)&&(s.globals.dom.elLegendWrap.appendChild(_[we]),_[we].appendChild(re))}):s.globals.dom.elLegendWrap.appendChild(re),s.globals.dom.elLegendWrap.classList.add("apexcharts-align-".concat(s.config.legend.horizontalAlign)),s.globals.dom.elLegendWrap.classList.add("apx-legend-position-"+s.config.legend.position),re.classList.add("apexcharts-legend-series"),re.style.margin="".concat(s.config.legend.itemMargin.vertical,"px ").concat(s.config.legend.itemMargin.horizontal,"px"),s.globals.dom.elLegendWrap.style.width=s.config.legend.width?s.config.legend.width+"px":"",s.globals.dom.elLegendWrap.style.height=s.config.legend.height?s.config.legend.height+"px":"",hr.setAttrs(re,{rel:E+1,seriesName:ni.escapeString(h[E]),"data:collapsed":G||U}),(G||U)&&re.classList.add("apexcharts-inactive-legend"),s.config.legend.onItemClick.toggleDataSeries||re.classList.add("apexcharts-no-click")},I=b?h.length-1:0;b?I>=0:I<=h.length-1;b?I--:I++)B(I);s.globals.dom.elWrap.addEventListener("click",t.onLegendClick,!0),s.config.legend.onItemHover.highlightDataSeries&&s.config.legend.customLegendItems.length===0&&(s.globals.dom.elWrap.addEventListener("mousemove",t.onLegendHovered,!0),s.globals.dom.elWrap.addEventListener("mouseout",t.onLegendHovered,!0))}},{key:"setLegendWrapXY",value:function(e,t){var s=this.w,c=s.globals.dom.elLegendWrap,h=c.clientHeight,A=0,r=0;if(s.config.legend.position==="bottom")r=s.globals.svgHeight-Math.min(h,s.globals.svgHeight/2)-5;else if(s.config.legend.position==="top"){var y=new K0(this.ctx),b=y.dimHelpers.getTitleSubtitleCoords("title").height,_=y.dimHelpers.getTitleSubtitleCoords("subtitle").height;r=(b>0?b-10:0)+(_>0?_-10:0)}c.style.position="absolute",A=A+e+s.config.legend.offsetX,r=r+t+s.config.legend.offsetY,c.style.left=A+"px",c.style.top=r+"px",s.config.legend.position==="right"&&(c.style.left="auto",c.style.right=25+s.config.legend.offsetX+"px"),["width","height"].forEach(function(B){c.style[B]&&(c.style[B]=parseInt(s.config.legend[B],10)+"px")})}},{key:"legendAlignHorizontal",value:function(){var e=this.w;e.globals.dom.elLegendWrap.style.right=0;var t=new K0(this.ctx),s=t.dimHelpers.getTitleSubtitleCoords("title"),c=t.dimHelpers.getTitleSubtitleCoords("subtitle"),h=0;e.config.legend.position==="top"&&(h=s.height+c.height+e.config.title.margin+e.config.subtitle.margin-10),this.setLegendWrapXY(20,h)}},{key:"legendAlignVertical",value:function(){var e=this.w,t=this.legendHelpers.getLegendDimensions(),s=0;e.config.legend.position==="left"&&(s=20),e.config.legend.position==="right"&&(s=e.globals.svgWidth-t.clww-10),this.setLegendWrapXY(s,20)}},{key:"onLegendHovered",value:function(e){var t=this.w,s=e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker");if(t.config.chart.type==="heatmap"||this.isBarsDistributed){if(s){var c=parseInt(e.target.getAttribute("rel"),10)-1;this.ctx.events.fireEvent("legendHover",[this.ctx,c,this.w]),new ld(this.ctx).highlightRangeInSeries(e,e.target)}}else!e.target.classList.contains("apexcharts-inactive-legend")&&s&&new ld(this.ctx).toggleSeriesOnHover(e,e.target)}},{key:"onLegendClick",value:function(e){var t=this.w;if(!t.config.legend.customLegendItems.length&&(e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker"))){var s=parseInt(e.target.getAttribute("rel"),10)-1,c=e.target.getAttribute("data:collapsed")==="true",h=this.w.config.chart.events.legendClick;typeof h=="function"&&h(this.ctx,s,this.w),this.ctx.events.fireEvent("legendClick",[this.ctx,s,this.w]);var A=this.w.config.legend.markers.onClick;typeof A=="function"&&e.target.classList.contains("apexcharts-legend-marker")&&(A(this.ctx,s,this.w),this.ctx.events.fireEvent("legendMarkerClick",[this.ctx,s,this.w])),t.config.chart.type!=="treemap"&&t.config.chart.type!=="heatmap"&&!this.isBarsDistributed&&t.config.legend.onItemClick.toggleDataSeries&&this.legendHelpers.toggleDataSeries(s,c)}}}]),a}(),_T=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var t=this.w;this.ev=this.w.config.chart.events,this.selectedClass="apexcharts-selected",this.localeValues=this.w.globals.locale.toolbar,this.minX=t.globals.minX,this.maxX=t.globals.maxX}return tn(a,[{key:"createToolbar",value:function(){var e=this,t=this.w,s=function(){return document.createElement("div")},c=s();if(c.setAttribute("class","apexcharts-toolbar"),c.style.top=t.config.chart.toolbar.offsetY+"px",c.style.right=3-t.config.chart.toolbar.offsetX+"px",t.globals.dom.elWrap.appendChild(c),this.elZoom=s(),this.elZoomIn=s(),this.elZoomOut=s(),this.elPan=s(),this.elSelection=s(),this.elZoomReset=s(),this.elMenuIcon=s(),this.elMenu=s(),this.elCustomIcons=[],this.t=t.config.chart.toolbar.tools,Array.isArray(this.t.customIcons))for(var h=0;h<this.t.customIcons.length;h++)this.elCustomIcons.push(s());var A=[],r=function(B,I,E){var R=B.toLowerCase();e.t[R]&&t.config.chart.zoom.enabled&&A.push({el:I,icon:typeof e.t[R]=="string"?e.t[R]:E,title:e.localeValues[B],class:"apexcharts-".concat(R,"-icon")})};r("zoomIn",this.elZoomIn,`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
</svg>
`),r("zoomOut",this.elZoomOut,`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
</svg>
`);var y=function(B){e.t[B]&&t.config.chart[B].enabled&&A.push({el:B==="zoom"?e.elZoom:e.elSelection,icon:typeof e.t[B]=="string"?e.t[B]:B==="zoom"?`<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="24" viewBox="0 0 24 24" width="24">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>
</svg>`:`<svg fill="#6E8192" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/>
</svg>`,title:e.localeValues[B==="zoom"?"selectionZoom":"selection"],class:t.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-".concat(B,"-icon")})};y("zoom"),y("selection"),this.t.pan&&t.config.chart.zoom.enabled&&A.push({el:this.elPan,icon:typeof this.t.pan=="string"?this.t.pan:`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="24" viewBox="0 0 24 24" width="24">
    <defs>
        <path d="M0 0h24v24H0z" id="a"/>
    </defs>
    <clipPath id="b">
        <use overflow="visible" xlink:href="#a"/>
    </clipPath>
    <path clip-path="url(#b)" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/>
</svg>`,title:this.localeValues.pan,class:t.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-pan-icon"}),r("reset",this.elZoomReset,`<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`),this.t.download&&A.push({el:this.elMenuIcon,icon:typeof this.t.download=="string"?this.t.download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>',title:this.localeValues.menu,class:"apexcharts-menu-icon"});for(var b=0;b<this.elCustomIcons.length;b++)A.push({el:this.elCustomIcons[b],icon:this.t.customIcons[b].icon,title:this.t.customIcons[b].title,index:this.t.customIcons[b].index,class:"apexcharts-toolbar-custom-icon "+this.t.customIcons[b].class});A.forEach(function(B,I){B.index&&ni.moveIndexInArray(A,I,B.index)});for(var _=0;_<A.length;_++)hr.setAttrs(A[_].el,{class:A[_].class,title:A[_].title}),A[_].el.innerHTML=A[_].icon,c.appendChild(A[_].el);this._createHamburgerMenu(c),t.globals.zoomEnabled?this.elZoom.classList.add(this.selectedClass):t.globals.panEnabled?this.elPan.classList.add(this.selectedClass):t.globals.selectionEnabled&&this.elSelection.classList.add(this.selectedClass),this.addToolbarEventListeners()}},{key:"_createHamburgerMenu",value:function(e){this.elMenuItems=[],e.appendChild(this.elMenu),hr.setAttrs(this.elMenu,{class:"apexcharts-menu"});for(var t=[{name:"exportSVG",title:this.localeValues.exportToSVG},{name:"exportPNG",title:this.localeValues.exportToPNG},{name:"exportCSV",title:this.localeValues.exportToCSV}],s=0;s<t.length;s++)this.elMenuItems.push(document.createElement("div")),this.elMenuItems[s].innerHTML=t[s].title,hr.setAttrs(this.elMenuItems[s],{class:"apexcharts-menu-item ".concat(t[s].name),title:t[s].title}),this.elMenu.appendChild(this.elMenuItems[s])}},{key:"addToolbarEventListeners",value:function(){var e=this;this.elZoomReset.addEventListener("click",this.handleZoomReset.bind(this)),this.elSelection.addEventListener("click",this.toggleZoomSelection.bind(this,"selection")),this.elZoom.addEventListener("click",this.toggleZoomSelection.bind(this,"zoom")),this.elZoomIn.addEventListener("click",this.handleZoomIn.bind(this)),this.elZoomOut.addEventListener("click",this.handleZoomOut.bind(this)),this.elPan.addEventListener("click",this.togglePanning.bind(this)),this.elMenuIcon.addEventListener("click",this.toggleMenu.bind(this)),this.elMenuItems.forEach(function(s){s.classList.contains("exportSVG")?s.addEventListener("click",e.handleDownload.bind(e,"svg")):s.classList.contains("exportPNG")?s.addEventListener("click",e.handleDownload.bind(e,"png")):s.classList.contains("exportCSV")&&s.addEventListener("click",e.handleDownload.bind(e,"csv"))});for(var t=0;t<this.t.customIcons.length;t++)this.elCustomIcons[t].addEventListener("click",this.t.customIcons[t].click.bind(this,this.ctx,this.ctx.w))}},{key:"toggleZoomSelection",value:function(e){this.ctx.getSyncedCharts().forEach(function(t){t.ctx.toolbar.toggleOtherControls();var s=e==="selection"?t.ctx.toolbar.elSelection:t.ctx.toolbar.elZoom,c=e==="selection"?"selectionEnabled":"zoomEnabled";t.w.globals[c]=!t.w.globals[c],s.classList.contains(t.ctx.toolbar.selectedClass)?s.classList.remove(t.ctx.toolbar.selectedClass):s.classList.add(t.ctx.toolbar.selectedClass)})}},{key:"getToolbarIconsReference",value:function(){var e=this.w;this.elZoom||(this.elZoom=e.globals.dom.baseEl.querySelector(".apexcharts-zoom-icon")),this.elPan||(this.elPan=e.globals.dom.baseEl.querySelector(".apexcharts-pan-icon")),this.elSelection||(this.elSelection=e.globals.dom.baseEl.querySelector(".apexcharts-selection-icon"))}},{key:"enableZoomPanFromToolbar",value:function(e){this.toggleOtherControls(),e==="pan"?this.w.globals.panEnabled=!0:this.w.globals.zoomEnabled=!0;var t=e==="pan"?this.elPan:this.elZoom,s=e==="pan"?this.elZoom:this.elPan;t&&t.classList.add(this.selectedClass),s&&s.classList.remove(this.selectedClass)}},{key:"togglePanning",value:function(){this.ctx.getSyncedCharts().forEach(function(e){e.ctx.toolbar.toggleOtherControls(),e.w.globals.panEnabled=!e.w.globals.panEnabled,e.ctx.toolbar.elPan.classList.contains(e.ctx.toolbar.selectedClass)?e.ctx.toolbar.elPan.classList.remove(e.ctx.toolbar.selectedClass):e.ctx.toolbar.elPan.classList.add(e.ctx.toolbar.selectedClass)})}},{key:"toggleOtherControls",value:function(){var e=this,t=this.w;t.globals.panEnabled=!1,t.globals.zoomEnabled=!1,t.globals.selectionEnabled=!1,this.getToolbarIconsReference(),[this.elPan,this.elSelection,this.elZoom].forEach(function(s){s&&s.classList.remove(e.selectedClass)})}},{key:"handleZoomIn",value:function(){var e=this.w;e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY);var t=(this.minX+this.maxX)/2,s=(this.minX+t)/2,c=(this.maxX+t)/2,h=this._getNewMinXMaxX(s,c);e.globals.disableZoomIn||this.zoomUpdateOptions(h.minX,h.maxX)}},{key:"handleZoomOut",value:function(){var e=this.w;if(e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY),!(e.config.xaxis.type==="datetime"&&new Date(this.minX).getUTCFullYear()<1e3)){var t=(this.minX+this.maxX)/2,s=this.minX-(t-this.minX),c=this.maxX-(t-this.maxX),h=this._getNewMinXMaxX(s,c);e.globals.disableZoomOut||this.zoomUpdateOptions(h.minX,h.maxX)}}},{key:"_getNewMinXMaxX",value:function(e,t){var s=this.w.config.xaxis.convertedCatToNumeric;return{minX:s?Math.floor(e):e,maxX:s?Math.floor(t):t}}},{key:"zoomUpdateOptions",value:function(e,t){var s=this.w;if(e!==void 0||t!==void 0){if(!(s.config.xaxis.convertedCatToNumeric&&(e<1&&(e=1,t=s.globals.dataPoints),t-e<2))){var c={min:e,max:t},h=this.getBeforeZoomRange(c);h&&(c=h.xaxis);var A={xaxis:c},r=ni.clone(s.globals.initialConfig.yaxis);s.config.chart.group||(A.yaxis=r),this.w.globals.zoomed=!0,this.ctx.updateHelpers._updateOptions(A,!1,this.w.config.chart.animations.dynamicAnimation.enabled),this.zoomCallback(c,r)}}else this.handleZoomReset()}},{key:"zoomCallback",value:function(e,t){typeof this.ev.zoomed=="function"&&(this.ev.zoomed(this.ctx,{xaxis:e,yaxis:t}),this.ctx.events.fireEvent("zoomed",{xaxis:e,yaxis:t}))}},{key:"getBeforeZoomRange",value:function(e,t){var s=null;return typeof this.ev.beforeZoom=="function"&&(s=this.ev.beforeZoom(this,{xaxis:e,yaxis:t})),s}},{key:"toggleMenu",value:function(){var e=this;window.setTimeout(function(){e.elMenu.classList.contains("apexcharts-menu-open")?e.elMenu.classList.remove("apexcharts-menu-open"):e.elMenu.classList.add("apexcharts-menu-open")},0)}},{key:"handleDownload",value:function(e){var t=this.w,s=new Ly(this.ctx);switch(e){case"svg":s.exportToSVG(this.ctx);break;case"png":s.exportToPng(this.ctx);break;case"csv":s.exportToCSV({series:t.config.series,columnDelimiter:t.config.chart.toolbar.export.csv.columnDelimiter})}}},{key:"handleZoomReset",value:function(e){this.ctx.getSyncedCharts().forEach(function(t){var s=t.w;if(s.globals.lastXAxis.min=s.globals.initialConfig.xaxis.min,s.globals.lastXAxis.max=s.globals.initialConfig.xaxis.max,t.updateHelpers.revertDefaultAxisMinMax(),typeof s.config.chart.events.beforeResetZoom=="function"){var c=s.config.chart.events.beforeResetZoom(t,s);c&&t.updateHelpers.revertDefaultAxisMinMax(c)}typeof s.config.chart.events.zoomed=="function"&&t.ctx.toolbar.zoomCallback({min:s.config.xaxis.min,max:s.config.xaxis.max}),s.globals.zoomed=!1;var h=t.ctx.series.emptyCollapsedSeries(ni.clone(s.globals.initialSeries));t.updateHelpers._updateSeries(h,s.config.chart.animations.dynamicAnimation.enabled)})}},{key:"destroy",value:function(){this.elZoom=null,this.elZoomIn=null,this.elZoomOut=null,this.elPan=null,this.elSelection=null,this.elZoomReset=null,this.elMenuIcon=null}}]),a}(),ND=function(a){av(t,_T);var e=ov(t);function t(s){var c;return en(this,t),(c=e.call(this,s)).ctx=s,c.w=s.w,c.dragged=!1,c.graphics=new hr(c.ctx),c.eventList=["mousedown","mouseleave","mousemove","touchstart","touchmove","mouseup","touchend","wheel"],c.clientX=0,c.clientY=0,c.startX=0,c.endX=0,c.dragX=0,c.startY=0,c.endY=0,c.dragY=0,c.moveDirection="none",c.debounceTimer=null,c.debounceDelay=100,c.wheelDelay=400,c}return tn(t,[{key:"init",value:function(s){var c=this,h=s.xyRatios,A=this.w,r=this;this.xyRatios=h,this.zoomRect=this.graphics.drawRect(0,0,0,0),this.selectionRect=this.graphics.drawRect(0,0,0,0),this.gridRect=A.globals.dom.baseEl.querySelector(".apexcharts-grid"),this.constraints=new yc(0,0,A.globals.gridWidth,A.globals.gridHeight),this.zoomRect.node.classList.add("apexcharts-zoom-rect"),this.selectionRect.node.classList.add("apexcharts-selection-rect"),A.globals.dom.Paper.add(this.zoomRect),A.globals.dom.Paper.add(this.selectionRect),A.config.chart.selection.type==="x"?this.slDraggableRect=this.selectionRect.draggable({minX:0,minY:0,maxX:A.globals.gridWidth,maxY:A.globals.gridHeight}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):A.config.chart.selection.type==="y"?this.slDraggableRect=this.selectionRect.draggable({minX:0,maxX:A.globals.gridWidth}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):this.slDraggableRect=this.selectionRect.draggable().on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")),this.preselectedSelection(),this.hoverArea=A.globals.dom.baseEl.querySelector("".concat(A.globals.chartClass," .apexcharts-svg")),this.hoverArea.classList.add("apexcharts-zoomable"),this.eventList.forEach(function(y){c.hoverArea.addEventListener(y,r.svgMouseEvents.bind(r,h),{capture:!1,passive:!0})}),A.config.chart.zoom.enabled&&A.config.chart.zoom.allowMouseWheelZoom&&this.hoverArea.addEventListener("wheel",r.mouseWheelEvent.bind(r),{capture:!1,passive:!1})}},{key:"destroy",value:function(){this.slDraggableRect&&(this.slDraggableRect.draggable(!1),this.slDraggableRect.off(),this.selectionRect.off()),this.selectionRect=null,this.zoomRect=null,this.gridRect=null}},{key:"svgMouseEvents",value:function(s,c){var h=this.w,A=this.ctx.toolbar,r=h.globals.zoomEnabled?h.config.chart.zoom.type:h.config.chart.selection.type,y=h.config.chart.toolbar.autoSelected;if(c.shiftKey?(this.shiftWasPressed=!0,A.enableZoomPanFromToolbar(y==="pan"?"zoom":"pan")):this.shiftWasPressed&&(A.enableZoomPanFromToolbar(y),this.shiftWasPressed=!1),c.target){var b,_=c.target.classList;if(c.target.parentNode&&c.target.parentNode!==null&&(b=c.target.parentNode.classList),!(_.contains("apexcharts-legend-marker")||_.contains("apexcharts-legend-text")||b&&b.contains("apexcharts-toolbar"))){if(this.clientX=c.type==="touchmove"||c.type==="touchstart"?c.touches[0].clientX:c.type==="touchend"?c.changedTouches[0].clientX:c.clientX,this.clientY=c.type==="touchmove"||c.type==="touchstart"?c.touches[0].clientY:c.type==="touchend"?c.changedTouches[0].clientY:c.clientY,c.type==="mousedown"&&c.which===1||c.type==="touchstart"){var B=this.gridRect.getBoundingClientRect();this.startX=this.clientX-B.left-h.globals.barPadForNumericAxis,this.startY=this.clientY-B.top,this.dragged=!1,this.w.globals.mousedown=!0}(c.type==="mousemove"&&c.which===1||c.type==="touchmove")&&(this.dragged=!0,h.globals.panEnabled?(h.globals.selection=null,this.w.globals.mousedown&&this.panDragging({context:this,zoomtype:r,xyRatios:s})):(this.w.globals.mousedown&&h.globals.zoomEnabled||this.w.globals.mousedown&&h.globals.selectionEnabled)&&(this.selection=this.selectionDrawing({context:this,zoomtype:r}))),c.type!=="mouseup"&&c.type!=="touchend"&&c.type!=="mouseleave"||this.handleMouseUp({zoomtype:r}),this.makeSelectionRectDraggable()}}}},{key:"handleMouseUp",value:function(s){var c,h=s.zoomtype,A=s.isResized,r=this.w,y=(c=this.gridRect)===null||c===void 0?void 0:c.getBoundingClientRect();y&&(this.w.globals.mousedown||A)&&(this.endX=this.clientX-y.left-r.globals.barPadForNumericAxis,this.endY=this.clientY-y.top,this.dragX=Math.abs(this.endX-this.startX),this.dragY=Math.abs(this.endY-this.startY),(r.globals.zoomEnabled||r.globals.selectionEnabled)&&this.selectionDrawn({context:this,zoomtype:h})),r.globals.zoomEnabled&&this.hideSelectionRect(this.selectionRect),this.dragged=!1,this.w.globals.mousedown=!1}},{key:"mouseWheelEvent",value:function(s){var c=this,h=this.w;s.preventDefault();var A=Date.now();A-h.globals.lastWheelExecution>this.wheelDelay&&(this.executeMouseWheelZoom(s),h.globals.lastWheelExecution=A),this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){A-h.globals.lastWheelExecution>c.wheelDelay&&(c.executeMouseWheelZoom(s),h.globals.lastWheelExecution=A)},this.debounceDelay)}},{key:"executeMouseWheelZoom",value:function(s){var c,h=this.w;this.minX=h.globals.isRangeBar?h.globals.minY:h.globals.minX,this.maxX=h.globals.isRangeBar?h.globals.maxY:h.globals.maxX;var A=(c=this.gridRect)===null||c===void 0?void 0:c.getBoundingClientRect();if(A){var r,y,b,_=(s.clientX-A.left)/A.width,B=this.minX,I=this.maxX,E=I-B;if(s.deltaY<0){var R=B+_*E;y=R-(r=.5*E)/2,b=R+r/2}else y=B-(r=1.5*E)/2,b=I+r/2;if(!h.globals.isRangeBar){y=Math.max(y,h.globals.initialMinX),b=Math.min(b,h.globals.initialMaxX);var M=.01*(h.globals.initialMaxX-h.globals.initialMinX);if(b-y<M){var G=(y+b)/2;y=G-M/2,b=G+M/2}}var U=this._getNewMinXMaxX(y,b);isNaN(U.minX)||isNaN(U.maxX)||this.zoomUpdateOptions(U.minX,U.maxX)}}},{key:"makeSelectionRectDraggable",value:function(){var s=this,c=this.w;if(this.selectionRect){var h=this.selectionRect.node.getBoundingClientRect();h.width>0&&h.height>0&&(this.selectionRect.select(!1).resize(!1),this.selectionRect.select({createRot:function(){},updateRot:function(){},createHandle:function(A,r,y,b,_){return _==="l"||_==="r"?A.circle(8).css({"stroke-width":1,stroke:"#333",fill:"#fff"}):A.circle(0)},updateHandle:function(A,r){return A.center(r[0],r[1])}}).resize().on("resize",function(){var A=c.globals.zoomEnabled?c.config.chart.zoom.type:c.config.chart.selection.type;s.handleMouseUp({zoomtype:A,isResized:!0})}))}}},{key:"preselectedSelection",value:function(){var s=this.w,c=this.xyRatios;if(!s.globals.zoomEnabled){if(s.globals.selection!==void 0&&s.globals.selection!==null)this.drawSelectionRect(Ir(Ir({},s.globals.selection),{},{translateX:s.globals.translateX,translateY:s.globals.translateY}));else if(s.config.chart.selection.xaxis.min!==void 0&&s.config.chart.selection.xaxis.max!==void 0){var h=(s.config.chart.selection.xaxis.min-s.globals.minX)/c.xRatio,A=s.globals.gridWidth-(s.globals.maxX-s.config.chart.selection.xaxis.max)/c.xRatio-h;s.globals.isRangeBar&&(h=(s.config.chart.selection.xaxis.min-s.globals.yAxisScale[0].niceMin)/c.invertedYRatio,A=(s.config.chart.selection.xaxis.max-s.config.chart.selection.xaxis.min)/c.invertedYRatio);var r={x:h,y:0,width:A,height:s.globals.gridHeight,translateX:s.globals.translateX,translateY:s.globals.translateY,selectionEnabled:!0};this.drawSelectionRect(r),this.makeSelectionRectDraggable(),typeof s.config.chart.events.selection=="function"&&s.config.chart.events.selection(this.ctx,{xaxis:{min:s.config.chart.selection.xaxis.min,max:s.config.chart.selection.xaxis.max},yaxis:{}})}}}},{key:"drawSelectionRect",value:function(s){var c=s.x,h=s.y,A=s.width,r=s.height,y=s.translateX,b=y===void 0?0:y,_=s.translateY,B=_===void 0?0:_,I=this.w,E=this.zoomRect,R=this.selectionRect;if(this.dragged||I.globals.selection!==null){var M={transform:"translate("+b+", "+B+")"};I.globals.zoomEnabled&&this.dragged&&(A<0&&(A=1),E.attr({x:c,y:h,width:A,height:r,fill:I.config.chart.zoom.zoomedArea.fill.color,"fill-opacity":I.config.chart.zoom.zoomedArea.fill.opacity,stroke:I.config.chart.zoom.zoomedArea.stroke.color,"stroke-width":I.config.chart.zoom.zoomedArea.stroke.width,"stroke-opacity":I.config.chart.zoom.zoomedArea.stroke.opacity}),hr.setAttrs(E.node,M)),I.globals.selectionEnabled&&(R.attr({x:c,y:h,width:A>0?A:0,height:r>0?r:0,fill:I.config.chart.selection.fill.color,"fill-opacity":I.config.chart.selection.fill.opacity,stroke:I.config.chart.selection.stroke.color,"stroke-width":I.config.chart.selection.stroke.width,"stroke-dasharray":I.config.chart.selection.stroke.dashArray,"stroke-opacity":I.config.chart.selection.stroke.opacity}),hr.setAttrs(R.node,M))}}},{key:"hideSelectionRect",value:function(s){s&&s.attr({x:0,y:0,width:0,height:0})}},{key:"selectionDrawing",value:function(s){var c=s.context,h=s.zoomtype,A=this.w,r=c,y=this.gridRect.getBoundingClientRect(),b=r.startX-1,_=r.startY,B=!1,I=!1,E=r.clientX-y.left-A.globals.barPadForNumericAxis,R=r.clientY-y.top,M=E-b,G=R-_,U={translateX:A.globals.translateX,translateY:A.globals.translateY};return Math.abs(M+b)>A.globals.gridWidth?M=A.globals.gridWidth-b:E<0&&(M=b),b>E&&(B=!0,M=Math.abs(M)),_>R&&(I=!0,G=Math.abs(G)),U=Ir(Ir({},U=h==="x"?{x:B?b-M:b,y:0,width:M,height:A.globals.gridHeight}:h==="y"?{x:0,y:I?_-G:_,width:A.globals.gridWidth,height:G}:{x:B?b-M:b,y:I?_-G:_,width:M,height:G}),{},{translateX:A.globals.translateX,translateY:A.globals.translateY}),r.drawSelectionRect(U),r.selectionDragging("resizing"),U}},{key:"selectionDragging",value:function(s,c){var h=this,A=this.w;if(c){c.preventDefault();var r=c.detail,y=r.handler,b=r.box,_=b.x,B=b.y;_<this.constraints.x&&(_=this.constraints.x),B<this.constraints.y&&(B=this.constraints.y),b.x2>this.constraints.x2&&(_=this.constraints.x2-b.w),b.y2>this.constraints.y2&&(B=this.constraints.y2-b.h),y.move(_,B);var I=this.xyRatios,E=this.selectionRect,R=0;s==="resizing"&&(R=30);var M=function(U){return parseFloat(E.node.getAttribute(U))},G={x:M("x"),y:M("y"),width:M("width"),height:M("height")};A.globals.selection=G,typeof A.config.chart.events.selection=="function"&&A.globals.selectionEnabled&&(clearTimeout(this.w.globals.selectionResizeTimer),this.w.globals.selectionResizeTimer=window.setTimeout(function(){var U,Q,q,ne,re=h.gridRect.getBoundingClientRect(),pe=E.node.getBoundingClientRect();A.globals.isRangeBar?(U=A.globals.yAxisScale[0].niceMin+(pe.left-re.left)*I.invertedYRatio,Q=A.globals.yAxisScale[0].niceMin+(pe.right-re.left)*I.invertedYRatio,q=0,ne=1):(U=A.globals.xAxisScale.niceMin+(pe.left-re.left)*I.xRatio,Q=A.globals.xAxisScale.niceMin+(pe.right-re.left)*I.xRatio,q=A.globals.yAxisScale[0].niceMin+(re.bottom-pe.bottom)*I.yRatio[0],ne=A.globals.yAxisScale[0].niceMax-(pe.top-re.top)*I.yRatio[0]);var Ae={xaxis:{min:U,max:Q},yaxis:{min:q,max:ne}};A.config.chart.events.selection(h.ctx,Ae),A.config.chart.brush.enabled&&A.config.chart.events.brushScrolled!==void 0&&A.config.chart.events.brushScrolled(h.ctx,Ae)},R))}}},{key:"selectionDrawn",value:function(s){var c,h,A=s.context,r=s.zoomtype,y=this.w,b=A,_=this.xyRatios,B=this.ctx.toolbar,I=y.globals.zoomEnabled?b.zoomRect.node.getBoundingClientRect():b.selectionRect.node.getBoundingClientRect(),E=b.gridRect.getBoundingClientRect(),R=I.left-E.left-y.globals.barPadForNumericAxis,M=I.right-E.left-y.globals.barPadForNumericAxis,G=I.top-E.top,U=I.bottom-E.top;y.globals.isRangeBar?(c=y.globals.yAxisScale[0].niceMin+R*_.invertedYRatio,h=y.globals.yAxisScale[0].niceMin+M*_.invertedYRatio):(c=y.globals.xAxisScale.niceMin+R*_.xRatio,h=y.globals.xAxisScale.niceMin+M*_.xRatio);var Q=[],q=[];if(y.config.yaxis.forEach(function(we,oe){var me=y.globals.seriesYAxisMap[oe][0],Le=y.globals.yAxisScale[oe].niceMax-_.yRatio[me]*G,Se=y.globals.yAxisScale[oe].niceMax-_.yRatio[me]*U;Q.push(Le),q.push(Se)}),b.dragged&&(b.dragX>10||b.dragY>10)&&c!==h){if(y.globals.zoomEnabled){var ne=ni.clone(y.globals.initialConfig.yaxis),re=ni.clone(y.globals.initialConfig.xaxis);if(y.globals.zoomed=!0,y.config.xaxis.convertedCatToNumeric&&(c=Math.floor(c),h=Math.floor(h),c<1&&(c=1,h=y.globals.dataPoints),h-c<2&&(h=c+1)),r!=="xy"&&r!=="x"||(re={min:c,max:h}),r!=="xy"&&r!=="y"||ne.forEach(function(we,oe){ne[oe].min=q[oe],ne[oe].max=Q[oe]}),B){var pe=B.getBeforeZoomRange(re,ne);pe&&(re=pe.xaxis?pe.xaxis:re,ne=pe.yaxis?pe.yaxis:ne)}var Ae={xaxis:re};y.config.chart.group||(Ae.yaxis=ne),b.ctx.updateHelpers._updateOptions(Ae,!1,b.w.config.chart.animations.dynamicAnimation.enabled),typeof y.config.chart.events.zoomed=="function"&&B.zoomCallback(re,ne)}else if(y.globals.selectionEnabled){var le,be=null;le={min:c,max:h},r!=="xy"&&r!=="y"||(be=ni.clone(y.config.yaxis)).forEach(function(we,oe){be[oe].min=q[oe],be[oe].max=Q[oe]}),y.globals.selection=b.selection,typeof y.config.chart.events.selection=="function"&&y.config.chart.events.selection(b.ctx,{xaxis:le,yaxis:be})}}}},{key:"panDragging",value:function(s){var c=s.context,h=this.w,A=c;if(h.globals.lastClientPosition.x!==void 0){var r=h.globals.lastClientPosition.x-A.clientX,y=h.globals.lastClientPosition.y-A.clientY;Math.abs(r)>Math.abs(y)&&r>0?this.moveDirection="left":Math.abs(r)>Math.abs(y)&&r<0?this.moveDirection="right":Math.abs(y)>Math.abs(r)&&y>0?this.moveDirection="up":Math.abs(y)>Math.abs(r)&&y<0&&(this.moveDirection="down")}h.globals.lastClientPosition={x:A.clientX,y:A.clientY};var b=h.globals.isRangeBar?h.globals.minY:h.globals.minX,_=h.globals.isRangeBar?h.globals.maxY:h.globals.maxX;A.panScrolled(b,_)}},{key:"panScrolled",value:function(s,c){var h=this.w,A=this.xyRatios,r=ni.clone(h.globals.initialConfig.yaxis),y=A.xRatio,b=h.globals.minX,_=h.globals.maxX;h.globals.isRangeBar&&(y=A.invertedYRatio,b=h.globals.minY,_=h.globals.maxY),this.moveDirection==="left"?(s=b+h.globals.gridWidth/15*y,c=_+h.globals.gridWidth/15*y):this.moveDirection==="right"&&(s=b-h.globals.gridWidth/15*y,c=_-h.globals.gridWidth/15*y),h.globals.isRangeBar||(s<h.globals.initialMinX||c>h.globals.initialMaxX)&&(s=b,c=_);var B={xaxis:{min:s,max:c}};h.config.chart.group||(B.yaxis=r),this.updateScrolledChart(B,s,c)}},{key:"updateScrolledChart",value:function(s,c,h){var A=this.w;if(this.ctx.updateHelpers._updateOptions(s,!1,!1),typeof A.config.chart.events.scrolled=="function"){var r={xaxis:{min:c,max:h}};A.config.chart.events.scrolled(this.ctx,r),this.ctx.events.fireEvent("scrolled",r)}}}]),t}(),xT=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e,this.ctx=e.ctx}return tn(a,[{key:"getNearestValues",value:function(e){var t=e.hoverArea,s=e.elGrid,c=e.clientX,h=e.clientY,A=this.w,r=s.getBoundingClientRect(),y=r.width,b=r.height,_=y/(A.globals.dataPoints-1),B=b/A.globals.dataPoints,I=this.hasBars();!A.globals.comboCharts&&!I||A.config.xaxis.convertedCatToNumeric||(_=y/A.globals.dataPoints);var E=c-r.left-A.globals.barPadForNumericAxis,R=h-r.top;E<0||R<0||E>y||R>b?(t.classList.remove("hovering-zoom"),t.classList.remove("hovering-pan")):A.globals.zoomEnabled?(t.classList.remove("hovering-pan"),t.classList.add("hovering-zoom")):A.globals.panEnabled&&(t.classList.remove("hovering-zoom"),t.classList.add("hovering-pan"));var M=Math.round(E/_),G=Math.floor(R/B);I&&!A.config.xaxis.convertedCatToNumeric&&(M=Math.ceil(E/_),M-=1);var U=null,Q=null,q=A.globals.seriesXvalues.map(function(le){return le.filter(function(be){return ni.isNumber(be)})}),ne=A.globals.seriesYvalues.map(function(le){return le.filter(function(be){return ni.isNumber(be)})});if(A.globals.isXNumeric){var re=this.ttCtx.getElGrid().getBoundingClientRect(),pe=E*(re.width/y),Ae=R*(re.height/b);U=(Q=this.closestInMultiArray(pe,Ae,q,ne)).index,M=Q.j,U!==null&&A.globals.hasNullValues&&(q=A.globals.seriesXvalues[U],M=(Q=this.closestInArray(pe,q)).j)}return A.globals.capturedSeriesIndex=U===null?-1:U,(!M||M<1)&&(M=0),A.globals.isBarHorizontal?A.globals.capturedDataPointIndex=G:A.globals.capturedDataPointIndex=M,{capturedSeries:U,j:A.globals.isBarHorizontal?G:M,hoverX:E,hoverY:R}}},{key:"getFirstActiveXArray",value:function(e){for(var t=this.w,s=0,c=e.map(function(A,r){return A.length>0?r:-1}),h=0;h<c.length;h++)if(c[h]!==-1&&t.globals.collapsedSeriesIndices.indexOf(h)===-1&&t.globals.ancillaryCollapsedSeriesIndices.indexOf(h)===-1){s=c[h];break}return s}},{key:"closestInMultiArray",value:function(e,t,s,c){for(var h,A=this.w,r=1/0,y=null,b=null,_=0;_<s.length;_++)if(h=_,A.globals.collapsedSeriesIndices.indexOf(h)===-1&&A.globals.ancillaryCollapsedSeriesIndices.indexOf(h)===-1)for(var B=s[_],I=c[_],E=Math.min(B.length,I.length),R=0;R<E;R++){var M=e-B[R],G=Math.sqrt(M*M);if(!A.globals.allSeriesHasEqualX){var U=t-I[R];G=Math.sqrt(M*M+U*U)}G<r&&(r=G,y=_,b=R)}return{index:y,j:b}}},{key:"closestInArray",value:function(e,t){for(var s=t[0],c=null,h=Math.abs(e-s),A=0;A<t.length;A++){var r=Math.abs(e-t[A]);r<h&&(h=r,c=A)}return{j:c}}},{key:"isXoverlap",value:function(e){var t=[],s=this.w.globals.seriesX.filter(function(h){return h[0]!==void 0});if(s.length>0)for(var c=0;c<s.length-1;c++)s[c][e]!==void 0&&s[c+1][e]!==void 0&&s[c][e]!==s[c+1][e]&&t.push("unEqual");return t.length===0}},{key:"isInitialSeriesSameLen",value:function(){for(var e=!0,t=this.w.globals.initialSeries,s=0;s<t.length-1;s++)if(t[s].data.length!==t[s+1].data.length){e=!1;break}return e}},{key:"getBarsHeight",value:function(e){return Jl(e).reduce(function(t,s){return t+s.getBBox().height},0)}},{key:"getElMarkers",value:function(e){return typeof e=="number"?this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-series-markers-wrap > *")):this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap > *")}},{key:"getAllMarkers",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");s=Jl(s),t&&(s=s.filter(function(h){var A=Number(h.getAttribute("data:realIndex"));return e.w.globals.collapsedSeriesIndices.indexOf(A)===-1})),s.sort(function(h,A){var r=Number(h.getAttribute("data:realIndex")),y=Number(A.getAttribute("data:realIndex"));return y<r?1:y>r?-1:0});var c=[];return s.forEach(function(h){c.push(h.querySelector(".apexcharts-marker"))}),c}},{key:"hasMarkers",value:function(e){return this.getElMarkers(e).length>0}},{key:"getPathFromPoint",value:function(e,t){var s=Number(e.getAttribute("cx")),c=Number(e.getAttribute("cy")),h=e.getAttribute("shape");return new hr(this.ctx).getMarkerPath(s,c,h,t)}},{key:"getElBars",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}},{key:"hasBars",value:function(){return this.getElBars().length>0}},{key:"getHoverMarkerSize",value:function(e){var t=this.w,s=t.config.markers.hover.size;return s===void 0&&(s=t.globals.markers.size[e]+t.config.markers.hover.sizeOffset),s}},{key:"toggleAllTooltipSeriesGroups",value:function(e){var t=this.w,s=this.ttCtx;s.allTooltipSeriesGroups.length===0&&(s.allTooltipSeriesGroups=t.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));for(var c=s.allTooltipSeriesGroups,h=0;h<c.length;h++)e==="enable"?(c[h].classList.add("apexcharts-active"),c[h].style.display=t.config.tooltip.items.display):(c[h].classList.remove("apexcharts-active"),c[h].style.display="none")}}]),a}(),jD=function(){function a(e){en(this,a),this.w=e.w,this.ctx=e.ctx,this.ttCtx=e,this.tooltipUtil=new xT(e)}return tn(a,[{key:"drawSeriesTexts",value:function(e){var t=e.shared,s=t===void 0||t,c=e.ttItems,h=e.i,A=h===void 0?0:h,r=e.j,y=r===void 0?null:r,b=e.y1,_=e.y2,B=e.e,I=this.w;I.config.tooltip.custom!==void 0?this.handleCustomTooltip({i:A,j:y,y1:b,y2:_,w:I}):this.toggleActiveInactiveSeries(s,A);var E=this.getValuesToPrint({i:A,j:y});this.printLabels({i:A,j:y,values:E,ttItems:c,shared:s,e:B});var R=this.ttCtx.getElTooltip();this.ttCtx.tooltipRect.ttWidth=R.getBoundingClientRect().width,this.ttCtx.tooltipRect.ttHeight=R.getBoundingClientRect().height}},{key:"printLabels",value:function(e){var t,s=this,c=e.i,h=e.j,A=e.values,r=e.ttItems,y=e.shared,b=e.e,_=this.w,B=[],I=function(re){return _.globals.seriesGoals[re]&&_.globals.seriesGoals[re][h]&&Array.isArray(_.globals.seriesGoals[re][h])},E=A.xVal,R=A.zVal,M=A.xAxisTTVal,G="",U=_.globals.colors[c];h!==null&&_.config.plotOptions.bar.distributed&&(U=_.globals.colors[h]);for(var Q=function(re,pe){var Ae=s.getFormatters(c);G=s.getSeriesName({fn:Ae.yLbTitleFormatter,index:c,seriesIndex:c,j:h}),_.config.chart.type==="treemap"&&(G=Ae.yLbTitleFormatter(String(_.config.series[c].data[h].x),{series:_.globals.series,seriesIndex:c,dataPointIndex:h,w:_}));var le=_.config.tooltip.inverseOrder?pe:re;if(_.globals.axisCharts){var be=function(me){var Le,Se,Me,Re;return _.globals.isRangeData?Ae.yLbFormatter((Le=_.globals.seriesRangeStart)===null||Le===void 0||(Se=Le[me])===null||Se===void 0?void 0:Se[h],{series:_.globals.seriesRangeStart,seriesIndex:me,dataPointIndex:h,w:_})+" - "+Ae.yLbFormatter((Me=_.globals.seriesRangeEnd)===null||Me===void 0||(Re=Me[me])===null||Re===void 0?void 0:Re[h],{series:_.globals.seriesRangeEnd,seriesIndex:me,dataPointIndex:h,w:_}):Ae.yLbFormatter(_.globals.series[me][h],{series:_.globals.series,seriesIndex:me,dataPointIndex:h,w:_})};if(y)Ae=s.getFormatters(le),G=s.getSeriesName({fn:Ae.yLbTitleFormatter,index:le,seriesIndex:c,j:h}),U=_.globals.colors[le],t=be(le),I(le)&&(B=_.globals.seriesGoals[le][h].map(function(me){return{attrs:me,val:Ae.yLbFormatter(me.value,{seriesIndex:le,dataPointIndex:h,w:_})}}));else{var we,oe=b==null||(we=b.target)===null||we===void 0?void 0:we.getAttribute("fill");oe&&(oe.indexOf("url")!==-1?oe.indexOf("Pattern")!==-1&&(U=_.globals.dom.baseEl.querySelector(oe.substr(4).slice(0,-1)).childNodes[0].getAttribute("stroke")):U=oe),t=be(c),I(c)&&Array.isArray(_.globals.seriesGoals[c][h])&&(B=_.globals.seriesGoals[c][h].map(function(me){return{attrs:me,val:Ae.yLbFormatter(me.value,{seriesIndex:c,dataPointIndex:h,w:_})}}))}}h===null&&(t=Ae.yLbFormatter(_.globals.series[c],Ir(Ir({},_),{},{seriesIndex:c,dataPointIndex:c}))),s.DOMHandling({i:c,t:le,j:h,ttItems:r,values:{val:t,goalVals:B,xVal:E,xAxisTTVal:M,zVal:R},seriesName:G,shared:y,pColor:U})},q=0,ne=_.globals.series.length-1;q<_.globals.series.length;q++,ne--)Q(q,ne)}},{key:"getFormatters",value:function(e){var t,s=this.w,c=s.globals.yLabelFormatters[e];return s.globals.ttVal!==void 0?Array.isArray(s.globals.ttVal)?(c=s.globals.ttVal[e]&&s.globals.ttVal[e].formatter,t=s.globals.ttVal[e]&&s.globals.ttVal[e].title&&s.globals.ttVal[e].title.formatter):(c=s.globals.ttVal.formatter,typeof s.globals.ttVal.title.formatter=="function"&&(t=s.globals.ttVal.title.formatter)):t=s.config.tooltip.y.title.formatter,typeof c!="function"&&(c=s.globals.yLabelFormatters[0]?s.globals.yLabelFormatters[0]:function(h){return h}),typeof t!="function"&&(t=function(h){return h?h+": ":""}),{yLbFormatter:c,yLbTitleFormatter:t}}},{key:"getSeriesName",value:function(e){var t=e.fn,s=e.index,c=e.seriesIndex,h=e.j,A=this.w;return t(String(A.globals.seriesNames[s]),{series:A.globals.series,seriesIndex:c,dataPointIndex:h,w:A})}},{key:"DOMHandling",value:function(e){e.i;var t=e.t,s=e.j,c=e.ttItems,h=e.values,A=e.seriesName,r=e.shared,y=e.pColor,b=this.w,_=this.ttCtx,B=h.val,I=h.goalVals,E=h.xVal,R=h.xAxisTTVal,M=h.zVal,G=null;G=c[t].children,b.config.tooltip.fillSeriesColor&&(c[t].style.backgroundColor=y,G[0].style.display="none"),_.showTooltipTitle&&(_.tooltipTitle===null&&(_.tooltipTitle=b.globals.dom.baseEl.querySelector(".apexcharts-tooltip-title")),_.tooltipTitle.innerHTML=E),_.isXAxisTooltipEnabled&&(_.xaxisTooltipText.innerHTML=R!==""?R:E);var U=c[t].querySelector(".apexcharts-tooltip-text-y-label");U&&(U.innerHTML=A||"");var Q=c[t].querySelector(".apexcharts-tooltip-text-y-value");Q&&(Q.innerHTML=B!==void 0?B:""),G[0]&&G[0].classList.contains("apexcharts-tooltip-marker")&&(b.config.tooltip.marker.fillColors&&Array.isArray(b.config.tooltip.marker.fillColors)&&(y=b.config.tooltip.marker.fillColors[t]),b.config.tooltip.fillSeriesColor?G[0].style.backgroundColor=y:G[0].style.color=y),b.config.tooltip.marker.show||(G[0].style.display="none");var q=c[t].querySelector(".apexcharts-tooltip-text-goals-label"),ne=c[t].querySelector(".apexcharts-tooltip-text-goals-value");if(I.length&&b.globals.seriesGoals[t]){var re=function(){var le="<div>",be="<div>";I.forEach(function(we,oe){le+=' <div style="display: flex"><span class="apexcharts-tooltip-marker" style="background-color: '.concat(we.attrs.strokeColor,'; height: 3px; border-radius: 0; top: 5px;"></span> ').concat(we.attrs.name,"</div>"),be+="<div>".concat(we.val,"</div>")}),q.innerHTML=le+"</div>",ne.innerHTML=be+"</div>"};r?b.globals.seriesGoals[t][s]&&Array.isArray(b.globals.seriesGoals[t][s])?re():(q.innerHTML="",ne.innerHTML=""):re()}else q.innerHTML="",ne.innerHTML="";if(M!==null&&(c[t].querySelector(".apexcharts-tooltip-text-z-label").innerHTML=b.config.tooltip.z.title,c[t].querySelector(".apexcharts-tooltip-text-z-value").innerHTML=M!==void 0?M:""),r&&G[0]){if(b.config.tooltip.hideEmptySeries){var pe=c[t].querySelector(".apexcharts-tooltip-marker"),Ae=c[t].querySelector(".apexcharts-tooltip-text");parseFloat(B)==0?(pe.style.display="none",Ae.style.display="none"):(pe.style.display="block",Ae.style.display="block")}B==null||b.globals.ancillaryCollapsedSeriesIndices.indexOf(t)>-1||b.globals.collapsedSeriesIndices.indexOf(t)>-1||Array.isArray(_.tConfig.enabledOnSeries)&&_.tConfig.enabledOnSeries.indexOf(t)===-1?G[0].parentNode.style.display="none":G[0].parentNode.style.display=b.config.tooltip.items.display}else Array.isArray(_.tConfig.enabledOnSeries)&&_.tConfig.enabledOnSeries.indexOf(t)===-1&&(G[0].parentNode.style.display="none")}},{key:"toggleActiveInactiveSeries",value:function(e,t){var s=this.w;if(e)this.tooltipUtil.toggleAllTooltipSeriesGroups("enable");else{this.tooltipUtil.toggleAllTooltipSeriesGroups("disable");var c=s.globals.dom.baseEl.querySelector(".apexcharts-tooltip-series-group-".concat(t));c&&(c.classList.add("apexcharts-active"),c.style.display=s.config.tooltip.items.display)}}},{key:"getValuesToPrint",value:function(e){var t=e.i,s=e.j,c=this.w,h=this.ctx.series.filteredSeriesX(),A="",r="",y=null,b=null,_={series:c.globals.series,seriesIndex:t,dataPointIndex:s,w:c},B=c.globals.ttZFormatter;s===null?b=c.globals.series[t]:c.globals.isXNumeric&&c.config.chart.type!=="treemap"?(A=h[t][s],h[t].length===0&&(A=h[this.tooltipUtil.getFirstActiveXArray(h)][s])):A=new hw(this.ctx).isFormatXY()?c.config.series[t].data[s]!==void 0?c.config.series[t].data[s].x:"":c.globals.labels[s]!==void 0?c.globals.labels[s]:"";var I=A;return c.globals.isXNumeric&&c.config.xaxis.type==="datetime"?A=new hv(this.ctx).xLabelFormat(c.globals.ttKeyFormatter,I,I,{i:void 0,dateFormatter:new Oc(this.ctx).formatDate,w:this.w}):A=c.globals.isBarHorizontal?c.globals.yLabelFormatters[0](I,_):c.globals.xLabelFormatter(I,_),c.config.tooltip.x.formatter!==void 0&&(A=c.globals.ttKeyFormatter(I,_)),c.globals.seriesZ.length>0&&c.globals.seriesZ[t].length>0&&(y=B(c.globals.seriesZ[t][s],c)),r=typeof c.config.xaxis.tooltip.formatter=="function"?c.globals.xaxisTooltipFormatter(I,_):A,{val:Array.isArray(b)?b.join(" "):b,xVal:Array.isArray(A)?A.join(" "):A,xAxisTTVal:Array.isArray(r)?r.join(" "):r,zVal:y}}},{key:"handleCustomTooltip",value:function(e){var t=e.i,s=e.j,c=e.y1,h=e.y2,A=e.w,r=this.ttCtx.getElTooltip(),y=A.config.tooltip.custom;Array.isArray(y)&&y[t]&&(y=y[t]);var b=y({ctx:this.ctx,series:A.globals.series,seriesIndex:t,dataPointIndex:s,y1:c,y2:h,w:A});typeof b=="string"||typeof b=="number"?r.innerHTML=b:(b instanceof Element||typeof b.nodeName=="string")&&(r.innerHTML="",r.appendChild(b.cloneNode(!0)))}}]),a}(),bT=function(){function a(e){en(this,a),this.ttCtx=e,this.ctx=e.ctx,this.w=e.w}return tn(a,[{key:"moveXCrosshairs",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=this.ttCtx,c=this.w,h=s.getElXCrosshairs(),A=e-s.xcrosshairsWidth/2,r=c.globals.labels.slice().length;if(t!==null&&(A=c.globals.gridWidth/r*t),h===null||c.globals.isBarHorizontal||(h.setAttribute("x",A),h.setAttribute("x1",A),h.setAttribute("x2",A),h.setAttribute("y2",c.globals.gridHeight),h.classList.add("apexcharts-active")),A<0&&(A=0),A>c.globals.gridWidth&&(A=c.globals.gridWidth),s.isXAxisTooltipEnabled){var y=A;c.config.xaxis.crosshairs.width!=="tickWidth"&&c.config.xaxis.crosshairs.width!=="barWidth"||(y=A+s.xcrosshairsWidth/2),this.moveXAxisTooltip(y)}}},{key:"moveYCrosshairs",value:function(e){var t=this.ttCtx;t.ycrosshairs!==null&&hr.setAttrs(t.ycrosshairs,{y1:e,y2:e}),t.ycrosshairsHidden!==null&&hr.setAttrs(t.ycrosshairsHidden,{y1:e,y2:e})}},{key:"moveXAxisTooltip",value:function(e){var t=this.w,s=this.ttCtx;if(s.xaxisTooltip!==null&&s.xcrosshairsWidth!==0){s.xaxisTooltip.classList.add("apexcharts-active");var c=s.xaxisOffY+t.config.xaxis.tooltip.offsetY+t.globals.translateY+1+t.config.xaxis.offsetY;if(e-=s.xaxisTooltip.getBoundingClientRect().width/2,!isNaN(e)){e+=t.globals.translateX;var h;h=new hr(this.ctx).getTextRects(s.xaxisTooltipText.innerHTML),s.xaxisTooltipText.style.minWidth=h.width+"px",s.xaxisTooltip.style.left=e+"px",s.xaxisTooltip.style.top=c+"px"}}}},{key:"moveYAxisTooltip",value:function(e){var t=this.w,s=this.ttCtx;s.yaxisTTEls===null&&(s.yaxisTTEls=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));var c=parseInt(s.ycrosshairsHidden.getAttribute("y1"),10),h=t.globals.translateY+c,A=s.yaxisTTEls[e].getBoundingClientRect(),r=A.height,y=t.globals.translateYAxisX[e]-2;t.config.yaxis[e].opposite&&(y-=A.width),h-=r/2,t.globals.ignoreYAxisIndexes.indexOf(e)===-1&&h>0&&h<t.globals.gridHeight?(s.yaxisTTEls[e].classList.add("apexcharts-active"),s.yaxisTTEls[e].style.top=h+"px",s.yaxisTTEls[e].style.left=y+t.config.yaxis[e].tooltip.offsetX+"px"):s.yaxisTTEls[e].classList.remove("apexcharts-active")}},{key:"moveTooltip",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=this.w,h=this.ttCtx,A=h.getElTooltip(),r=h.tooltipRect,y=s!==null?parseFloat(s):1,b=parseFloat(e)+y+5,_=parseFloat(t)+y/2;if(b>c.globals.gridWidth/2&&(b=b-r.ttWidth-y-10),b>c.globals.gridWidth-r.ttWidth-10&&(b=c.globals.gridWidth-r.ttWidth),b<-20&&(b=-20),c.config.tooltip.followCursor){var B=h.getElGrid().getBoundingClientRect();(b=h.e.clientX-B.left)>c.globals.gridWidth/2&&(b-=h.tooltipRect.ttWidth),(_=h.e.clientY+c.globals.translateY-B.top)>c.globals.gridHeight/2&&(_-=h.tooltipRect.ttHeight)}else c.globals.isBarHorizontal||r.ttHeight/2+_>c.globals.gridHeight&&(_=c.globals.gridHeight-r.ttHeight+c.globals.translateY);isNaN(b)||(b+=c.globals.translateX,A.style.left=b+"px",A.style.top=_+"px")}},{key:"moveMarkers",value:function(e,t){var s=this.w,c=this.ttCtx;if(s.globals.markers.size[e]>0)for(var h=s.globals.dom.baseEl.querySelectorAll(" .apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-marker")),A=0;A<h.length;A++)parseInt(h[A].getAttribute("rel"),10)===t&&(c.marker.resetPointsSize(),c.marker.enlargeCurrentPoint(t,h[A]));else c.marker.resetPointsSize(),this.moveDynamicPointOnHover(t,e)}},{key:"moveDynamicPointOnHover",value:function(e,t){var s,c,h,A,r=this.w,y=this.ttCtx,b=new hr(this.ctx),_=r.globals.pointsArray,B=y.tooltipUtil.getHoverMarkerSize(t),I=r.config.series[t].type;if(!I||I!=="column"&&I!=="candlestick"&&I!=="boxPlot"){h=(s=_[t][e])===null||s===void 0?void 0:s[0],A=((c=_[t][e])===null||c===void 0?void 0:c[1])||0;var E=r.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(t,"'] .apexcharts-series-markers path"));if(E&&A<r.globals.gridHeight&&A>0){var R=E.getAttribute("shape"),M=b.getMarkerPath(h,A,R,1.5*B);E.setAttribute("d",M)}this.moveXCrosshairs(h),y.fixedTooltip||this.moveTooltip(h,A,B)}}},{key:"moveDynamicPointsOnHover",value:function(e){var t,s=this.ttCtx,c=s.w,h=0,A=0,r=c.globals.pointsArray,y=new ld(this.ctx),b=new hr(this.ctx);t=y.getActiveConfigSeriesIndex("asc",["line","area","scatter","bubble"]);var _=s.tooltipUtil.getHoverMarkerSize(t);if(r[t]&&(h=r[t][e][0],A=r[t][e][1]),!isNaN(h)){var B=s.tooltipUtil.getAllMarkers();if(B.length)for(var I=0;I<c.globals.series.length;I++){var E=r[I];if(c.globals.comboCharts&&E===void 0&&B.splice(I,0,null),E&&E.length){var R=r[I][e][1],M=void 0;B[I].setAttribute("cx",h);var G=B[I].getAttribute("shape");if(c.config.chart.type==="rangeArea"&&!c.globals.comboCharts){var U=e+c.globals.series[I].length;M=r[I][U][1],R-=Math.abs(R-M)/2}if(R!==null&&!isNaN(R)&&R<c.globals.gridHeight+_&&R+_>0){var Q=b.getMarkerPath(h,R,G,_);B[I].setAttribute("d",Q)}else B[I].setAttribute("d","")}}this.moveXCrosshairs(h),s.fixedTooltip||this.moveTooltip(h,A||c.globals.gridHeight,_)}}},{key:"moveStickyTooltipOverBars",value:function(e,t){var s=this.w,c=this.ttCtx,h=s.globals.columnSeries?s.globals.columnSeries.length:s.globals.series.length;s.config.chart.stacked&&(h=s.globals.barGroups.length);var A=h>=2&&h%2==0?Math.floor(h/2):Math.floor(h/2)+1;s.globals.isBarHorizontal&&(A=new ld(this.ctx).getActiveConfigSeriesIndex("desc")+1);var r=s.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[rel='".concat(A,"'] path[j='").concat(e,"'], .apexcharts-candlestick-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"'], .apexcharts-boxPlot-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"'], .apexcharts-rangebar-series .apexcharts-series[rel='").concat(A,"'] path[j='").concat(e,"']"));r||typeof t!="number"||(r=s.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[data\\:realIndex='".concat(t,"'] path[j='").concat(e,`'],
        .apexcharts-candlestick-series .apexcharts-series[data\\:realIndex='`).concat(t,"'] path[j='").concat(e,`'],
        .apexcharts-boxPlot-series .apexcharts-series[data\\:realIndex='`).concat(t,"'] path[j='").concat(e,`'],
        .apexcharts-rangebar-series .apexcharts-series[data\\:realIndex='`).concat(t,"'] path[j='").concat(e,"']")));var y=r?parseFloat(r.getAttribute("cx")):0,b=r?parseFloat(r.getAttribute("cy")):0,_=r?parseFloat(r.getAttribute("barWidth")):0,B=c.getElGrid().getBoundingClientRect(),I=r&&(r.classList.contains("apexcharts-candlestick-area")||r.classList.contains("apexcharts-boxPlot-area"));s.globals.isXNumeric?(r&&!I&&(y-=h%2!=0?_/2:0),r&&I&&(y-=_/2)):s.globals.isBarHorizontal||(y=c.xAxisTicksPositions[e-1]+c.dataPointsDividedWidth/2,isNaN(y)&&(y=c.xAxisTicksPositions[e]-c.dataPointsDividedWidth/2)),s.globals.isBarHorizontal?b-=c.tooltipRect.ttHeight:s.config.tooltip.followCursor?b=c.e.clientY-B.top-c.tooltipRect.ttHeight/2:b+c.tooltipRect.ttHeight+15>s.globals.gridHeight&&(b=s.globals.gridHeight),s.globals.isBarHorizontal||this.moveXCrosshairs(y),c.fixedTooltip||this.moveTooltip(y,b||s.globals.gridHeight)}}]),a}(),HD=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e,this.ctx=e.ctx,this.tooltipPosition=new bT(e)}return tn(a,[{key:"drawDynamicPoints",value:function(){var e=this.w,t=new hr(this.ctx),s=new wm(this.ctx),c=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");c=Jl(c),e.config.chart.stacked&&c.sort(function(B,I){return parseFloat(B.getAttribute("data:realIndex"))-parseFloat(I.getAttribute("data:realIndex"))});for(var h=0;h<c.length;h++){var A=c[h].querySelector(".apexcharts-series-markers-wrap");if(A!==null){var r=void 0,y="apexcharts-marker w".concat((Math.random()+1).toString(36).substring(4));e.config.chart.type!=="line"&&e.config.chart.type!=="area"||e.globals.comboCharts||e.config.tooltip.intersect||(y+=" no-pointer-events");var b=s.getMarkerConfig({cssClass:y,seriesIndex:Number(A.getAttribute("data:realIndex"))});(r=t.drawMarker(0,0,b)).node.setAttribute("default-marker-size",0);var _=document.createElementNS(e.globals.SVGNS,"g");_.classList.add("apexcharts-series-markers"),_.appendChild(r.node),A.appendChild(_)}}}},{key:"enlargeCurrentPoint",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,h=this.w;h.config.chart.type!=="bubble"&&this.newPointSize(e,t);var A=t.getAttribute("cx"),r=t.getAttribute("cy");if(s!==null&&c!==null&&(A=s,r=c),this.tooltipPosition.moveXCrosshairs(A),!this.fixedTooltip){if(h.config.chart.type==="radar"){var y=this.ttCtx.getElGrid().getBoundingClientRect();A=this.ttCtx.e.clientX-y.left}this.tooltipPosition.moveTooltip(A,r,h.config.markers.hover.size)}}},{key:"enlargePoints",value:function(e){for(var t=this.w,s=this,c=this.ttCtx,h=e,A=t.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),r=t.config.markers.hover.size,y=0;y<A.length;y++){var b=A[y].getAttribute("rel"),_=A[y].getAttribute("index");if(r===void 0&&(r=t.globals.markers.size[_]+t.config.markers.hover.sizeOffset),h===parseInt(b,10)){s.newPointSize(h,A[y]);var B=A[y].getAttribute("cx"),I=A[y].getAttribute("cy");s.tooltipPosition.moveXCrosshairs(B),c.fixedTooltip||s.tooltipPosition.moveTooltip(B,I,r)}else s.oldPointSize(A[y])}}},{key:"newPointSize",value:function(e,t){var s=this.w,c=s.config.markers.hover.size,h=e===0?t.parentNode.firstChild:t.parentNode.lastChild;if(h.getAttribute("default-marker-size")!=="0"){var A=parseInt(h.getAttribute("index"),10);c===void 0&&(c=s.globals.markers.size[A]+s.config.markers.hover.sizeOffset),c<0&&(c=0);var r=this.ttCtx.tooltipUtil.getPathFromPoint(t,c);t.setAttribute("d",r)}}},{key:"oldPointSize",value:function(e){var t=parseFloat(e.getAttribute("default-marker-size")),s=this.ttCtx.tooltipUtil.getPathFromPoint(e,t);e.setAttribute("d",s)}},{key:"resetPointsSize",value:function(){for(var e=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),t=0;t<e.length;t++){var s=parseFloat(e[t].getAttribute("default-marker-size"));if(ni.isNumber(s)&&s>0){var c=this.ttCtx.tooltipUtil.getPathFromPoint(e[t],s);e[t].setAttribute("d",c)}else e[t].setAttribute("d","M0,0")}}}]),a}(),QD=function(){function a(e){en(this,a),this.w=e.w;var t=this.w;this.ttCtx=e,this.isVerticalGroupedRangeBar=!t.globals.isBarHorizontal&&t.config.chart.type==="rangeBar"&&t.config.plotOptions.bar.rangeBarGroupRows}return tn(a,[{key:"getAttr",value:function(e,t){return parseFloat(e.target.getAttribute(t))}},{key:"handleHeatTreeTooltip",value:function(e){var t=e.e,s=e.opt,c=e.x,h=e.y,A=e.type,r=this.ttCtx,y=this.w;if(t.target.classList.contains("apexcharts-".concat(A,"-rect"))){var b=this.getAttr(t,"i"),_=this.getAttr(t,"j"),B=this.getAttr(t,"cx"),I=this.getAttr(t,"cy"),E=this.getAttr(t,"width"),R=this.getAttr(t,"height");if(r.tooltipLabels.drawSeriesTexts({ttItems:s.ttItems,i:b,j:_,shared:!1,e:t}),y.globals.capturedSeriesIndex=b,y.globals.capturedDataPointIndex=_,c=B+r.tooltipRect.ttWidth/2+E,h=I+r.tooltipRect.ttHeight/2-R/2,r.tooltipPosition.moveXCrosshairs(B+E/2),c>y.globals.gridWidth/2&&(c=B-r.tooltipRect.ttWidth/2+E),r.w.config.tooltip.followCursor){var M=y.globals.dom.elWrap.getBoundingClientRect();c=y.globals.clientX-M.left-(c>y.globals.gridWidth/2?r.tooltipRect.ttWidth:0),h=y.globals.clientY-M.top-(h>y.globals.gridHeight/2?r.tooltipRect.ttHeight:0)}}return{x:c,y:h}}},{key:"handleMarkerTooltip",value:function(e){var t,s,c=e.e,h=e.opt,A=e.x,r=e.y,y=this.w,b=this.ttCtx;if(c.target.classList.contains("apexcharts-marker")){var _=parseInt(h.paths.getAttribute("cx"),10),B=parseInt(h.paths.getAttribute("cy"),10),I=parseFloat(h.paths.getAttribute("val"));if(s=parseInt(h.paths.getAttribute("rel"),10),t=parseInt(h.paths.parentNode.parentNode.parentNode.getAttribute("rel"),10)-1,b.intersect){var E=ni.findAncestor(h.paths,"apexcharts-series");E&&(t=parseInt(E.getAttribute("data:realIndex"),10))}if(b.tooltipLabels.drawSeriesTexts({ttItems:h.ttItems,i:t,j:s,shared:!b.showOnIntersect&&y.config.tooltip.shared,e:c}),c.type==="mouseup"&&b.markerClick(c,t,s),y.globals.capturedSeriesIndex=t,y.globals.capturedDataPointIndex=s,A=_,r=B+y.globals.translateY-1.4*b.tooltipRect.ttHeight,b.w.config.tooltip.followCursor){var R=b.getElGrid().getBoundingClientRect();r=b.e.clientY+y.globals.translateY-R.top}I<0&&(r=B),b.marker.enlargeCurrentPoint(s,h.paths,A,r)}return{x:A,y:r}}},{key:"handleBarTooltip",value:function(e){var t,s,c=e.e,h=e.opt,A=this.w,r=this.ttCtx,y=r.getElTooltip(),b=0,_=0,B=0,I=this.getBarTooltipXY({e:c,opt:h});if(I.j!==null||I.barHeight!==0||I.barWidth!==0){t=I.i;var E=I.j;if(A.globals.capturedSeriesIndex=t,A.globals.capturedDataPointIndex=E,A.globals.isBarHorizontal&&r.tooltipUtil.hasBars()||!A.config.tooltip.shared?(_=I.x,B=I.y,s=Array.isArray(A.config.stroke.width)?A.config.stroke.width[t]:A.config.stroke.width,b=_):A.globals.comboCharts||A.config.tooltip.shared||(b/=2),isNaN(B)&&(B=A.globals.svgHeight-r.tooltipRect.ttHeight),parseInt(h.paths.parentNode.getAttribute("data:realIndex"),10),_+r.tooltipRect.ttWidth>A.globals.gridWidth?_-=r.tooltipRect.ttWidth:_<0&&(_=0),r.w.config.tooltip.followCursor){var R=r.getElGrid().getBoundingClientRect();B=r.e.clientY-R.top}r.tooltip===null&&(r.tooltip=A.globals.dom.baseEl.querySelector(".apexcharts-tooltip")),A.config.tooltip.shared||(A.globals.comboBarCount>0?r.tooltipPosition.moveXCrosshairs(b+s/2):r.tooltipPosition.moveXCrosshairs(b)),!r.fixedTooltip&&(!A.config.tooltip.shared||A.globals.isBarHorizontal&&r.tooltipUtil.hasBars())&&(B=B+A.globals.translateY-r.tooltipRect.ttHeight/2,y.style.left=_+A.globals.translateX+"px",y.style.top=B+"px")}}},{key:"getBarTooltipXY",value:function(e){var t=this,s=e.e,c=e.opt,h=this.w,A=null,r=this.ttCtx,y=0,b=0,_=0,B=0,I=0,E=s.target.classList;if(E.contains("apexcharts-bar-area")||E.contains("apexcharts-candlestick-area")||E.contains("apexcharts-boxPlot-area")||E.contains("apexcharts-rangebar-area")){var R=s.target,M=R.getBoundingClientRect(),G=c.elGrid.getBoundingClientRect(),U=M.height;I=M.height;var Q=M.width,q=parseInt(R.getAttribute("cx"),10),ne=parseInt(R.getAttribute("cy"),10);B=parseFloat(R.getAttribute("barWidth"));var re=s.type==="touchmove"?s.touches[0].clientX:s.clientX;A=parseInt(R.getAttribute("j"),10),y=parseInt(R.parentNode.getAttribute("rel"),10)-1;var pe=R.getAttribute("data-range-y1"),Ae=R.getAttribute("data-range-y2");h.globals.comboCharts&&(y=parseInt(R.parentNode.getAttribute("data:realIndex"),10));var le=function(we){return h.globals.isXNumeric?q-Q/2:t.isVerticalGroupedRangeBar?q+Q/2:q-r.dataPointsDividedWidth+Q/2},be=function(){return ne-r.dataPointsDividedHeight+U/2-r.tooltipRect.ttHeight/2};r.tooltipLabels.drawSeriesTexts({ttItems:c.ttItems,i:y,j:A,y1:pe?parseInt(pe,10):null,y2:Ae?parseInt(Ae,10):null,shared:!r.showOnIntersect&&h.config.tooltip.shared,e:s}),h.config.tooltip.followCursor?h.globals.isBarHorizontal?(b=re-G.left+15,_=be()):(b=le(),_=s.clientY-G.top-r.tooltipRect.ttHeight/2-15):h.globals.isBarHorizontal?((b=q)<r.xyRatios.baseLineInvertedY&&(b=q-r.tooltipRect.ttWidth),_=be()):(b=le(),_=ne)}return{x:b,y:_,barHeight:I,barWidth:B,i:y,j:A}}}]),a}(),VD=function(){function a(e){en(this,a),this.w=e.w,this.ttCtx=e}return tn(a,[{key:"drawXaxisTooltip",value:function(){var e=this.w,t=this.ttCtx,s=e.config.xaxis.position==="bottom";t.xaxisOffY=s?e.globals.gridHeight+1:-e.globals.xAxisHeight-e.config.xaxis.axisTicks.height+3;var c=s?"apexcharts-xaxistooltip apexcharts-xaxistooltip-bottom":"apexcharts-xaxistooltip apexcharts-xaxistooltip-top",h=e.globals.dom.elWrap;t.isXAxisTooltipEnabled&&e.globals.dom.baseEl.querySelector(".apexcharts-xaxistooltip")===null&&(t.xaxisTooltip=document.createElement("div"),t.xaxisTooltip.setAttribute("class",c+" apexcharts-theme-"+e.config.tooltip.theme),h.appendChild(t.xaxisTooltip),t.xaxisTooltipText=document.createElement("div"),t.xaxisTooltipText.classList.add("apexcharts-xaxistooltip-text"),t.xaxisTooltipText.style.fontFamily=e.config.xaxis.tooltip.style.fontFamily||e.config.chart.fontFamily,t.xaxisTooltipText.style.fontSize=e.config.xaxis.tooltip.style.fontSize,t.xaxisTooltip.appendChild(t.xaxisTooltipText))}},{key:"drawYaxisTooltip",value:function(){for(var e=this.w,t=this.ttCtx,s=0;s<e.config.yaxis.length;s++){var c=e.config.yaxis[s].opposite||e.config.yaxis[s].crosshairs.opposite;t.yaxisOffX=c?e.globals.gridWidth+1:1;var h="apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(s,c?" apexcharts-yaxistooltip-right":" apexcharts-yaxistooltip-left"),A=e.globals.dom.elWrap;e.globals.dom.baseEl.querySelector(".apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(s))===null&&(t.yaxisTooltip=document.createElement("div"),t.yaxisTooltip.setAttribute("class",h+" apexcharts-theme-"+e.config.tooltip.theme),A.appendChild(t.yaxisTooltip),s===0&&(t.yaxisTooltipText=[]),t.yaxisTooltipText[s]=document.createElement("div"),t.yaxisTooltipText[s].classList.add("apexcharts-yaxistooltip-text"),t.yaxisTooltip.appendChild(t.yaxisTooltipText[s]))}}},{key:"setXCrosshairWidth",value:function(){var e=this.w,t=this.ttCtx,s=t.getElXCrosshairs();if(t.xcrosshairsWidth=parseInt(e.config.xaxis.crosshairs.width,10),e.globals.comboCharts){var c=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(c!==null&&e.config.xaxis.crosshairs.width==="barWidth"){var h=parseFloat(c.getAttribute("barWidth"));t.xcrosshairsWidth=h}else if(e.config.xaxis.crosshairs.width==="tickWidth"){var A=e.globals.labels.length;t.xcrosshairsWidth=e.globals.gridWidth/A}}else if(e.config.xaxis.crosshairs.width==="tickWidth"){var r=e.globals.labels.length;t.xcrosshairsWidth=e.globals.gridWidth/r}else if(e.config.xaxis.crosshairs.width==="barWidth"){var y=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(y!==null){var b=parseFloat(y.getAttribute("barWidth"));t.xcrosshairsWidth=b}else t.xcrosshairsWidth=1}e.globals.isBarHorizontal&&(t.xcrosshairsWidth=0),s!==null&&t.xcrosshairsWidth>0&&s.setAttribute("width",t.xcrosshairsWidth)}},{key:"handleYCrosshair",value:function(){var e=this.w,t=this.ttCtx;t.ycrosshairs=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs"),t.ycrosshairsHidden=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs-hidden")}},{key:"drawYaxisTooltipText",value:function(e,t,s){var c=this.ttCtx,h=this.w,A=h.globals,r=A.seriesYAxisMap[e];if(c.yaxisTooltips[e]&&r.length>0){var y=A.yLabelFormatters[e],b=c.getElGrid().getBoundingClientRect(),_=r[0],B=0;s.yRatio.length>1&&(B=_);var I=(t-b.top)*s.yRatio[B],E=A.maxYArr[_]-A.minYArr[_],R=A.minYArr[_]+(E-I);h.config.yaxis[e].reversed&&(R=A.maxYArr[_]-(E-I)),c.tooltipPosition.moveYCrosshairs(t-b.top),c.yaxisTooltipText[e].innerHTML=y(R),c.tooltipPosition.moveYAxisTooltip(e)}}}]),a}(),gE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var t=this.w;this.tConfig=t.config.tooltip,this.tooltipUtil=new xT(this),this.tooltipLabels=new jD(this),this.tooltipPosition=new bT(this),this.marker=new HD(this),this.intersect=new QD(this),this.axesTooltip=new VD(this),this.showOnIntersect=this.tConfig.intersect,this.showTooltipTitle=this.tConfig.x.show,this.fixedTooltip=this.tConfig.fixed.enabled,this.xaxisTooltip=null,this.yaxisTTEls=null,this.isBarShared=!t.globals.isBarHorizontal&&this.tConfig.shared,this.lastHoverTime=Date.now()}return tn(a,[{key:"getElTooltip",value:function(e){return e||(e=this),e.w.globals.dom.baseEl?e.w.globals.dom.baseEl.querySelector(".apexcharts-tooltip"):null}},{key:"getElXCrosshairs",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-xcrosshairs")}},{key:"getElGrid",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-grid")}},{key:"drawTooltip",value:function(e){var t=this.w;this.xyRatios=e,this.isXAxisTooltipEnabled=t.config.xaxis.tooltip.enabled&&t.globals.axisCharts,this.yaxisTooltips=t.config.yaxis.map(function(A,r){return!!(A.show&&A.tooltip.enabled&&t.globals.axisCharts)}),this.allTooltipSeriesGroups=[],t.globals.axisCharts||(this.showTooltipTitle=!1);var s=document.createElement("div");if(s.classList.add("apexcharts-tooltip"),t.config.tooltip.cssClass&&s.classList.add(t.config.tooltip.cssClass),s.classList.add("apexcharts-theme-".concat(this.tConfig.theme||"light")),t.globals.dom.elWrap.appendChild(s),t.globals.axisCharts){this.axesTooltip.drawXaxisTooltip(),this.axesTooltip.drawYaxisTooltip(),this.axesTooltip.setXCrosshairWidth(),this.axesTooltip.handleYCrosshair();var c=new $y(this.ctx);this.xAxisTicksPositions=c.getXAxisTicksPositions()}if(!t.globals.comboCharts&&!this.tConfig.intersect&&t.config.chart.type!=="rangeBar"||this.tConfig.shared||(this.showOnIntersect=!0),t.config.markers.size!==0&&t.globals.markers.largestSize!==0||this.marker.drawDynamicPoints(this),t.globals.collapsedSeries.length!==t.globals.series.length){this.dataPointsDividedHeight=t.globals.gridHeight/t.globals.dataPoints,this.dataPointsDividedWidth=t.globals.gridWidth/t.globals.dataPoints,this.showTooltipTitle&&(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.classList.add("apexcharts-tooltip-title"),this.tooltipTitle.style.fontFamily=this.tConfig.style.fontFamily||t.config.chart.fontFamily,this.tooltipTitle.style.fontSize=this.tConfig.style.fontSize,s.appendChild(this.tooltipTitle));var h=t.globals.series.length;(t.globals.xyCharts||t.globals.comboCharts)&&this.tConfig.shared&&(h=this.showOnIntersect?1:t.globals.series.length),this.legendLabels=t.globals.dom.baseEl.querySelectorAll(".apexcharts-legend-text"),this.ttItems=this.createTTElements(h),this.addSVGEvents()}}},{key:"createTTElements",value:function(e){for(var t=this,s=this.w,c=[],h=this.getElTooltip(),A=function(y){var b=document.createElement("div");b.classList.add("apexcharts-tooltip-series-group","apexcharts-tooltip-series-group-".concat(y)),b.style.order=s.config.tooltip.inverseOrder?e-y:y+1;var _=document.createElement("span");_.classList.add("apexcharts-tooltip-marker"),s.config.tooltip.fillSeriesColor?_.style.backgroundColor=s.globals.colors[y]:_.style.color=s.globals.colors[y];var B=s.config.markers.shape,I=B;Array.isArray(B)&&(I=B[y]),_.setAttribute("shape",I),b.appendChild(_);var E=document.createElement("div");E.classList.add("apexcharts-tooltip-text"),E.style.fontFamily=t.tConfig.style.fontFamily||s.config.chart.fontFamily,E.style.fontSize=t.tConfig.style.fontSize,["y","goals","z"].forEach(function(R){var M=document.createElement("div");M.classList.add("apexcharts-tooltip-".concat(R,"-group"));var G=document.createElement("span");G.classList.add("apexcharts-tooltip-text-".concat(R,"-label")),M.appendChild(G);var U=document.createElement("span");U.classList.add("apexcharts-tooltip-text-".concat(R,"-value")),M.appendChild(U),E.appendChild(M)}),b.appendChild(E),h.appendChild(b),c.push(b)},r=0;r<e;r++)A(r);return c}},{key:"addSVGEvents",value:function(){var e=this.w,t=e.config.chart.type,s=this.getElTooltip(),c=!(t!=="bar"&&t!=="candlestick"&&t!=="boxPlot"&&t!=="rangeBar"),h=t==="area"||t==="line"||t==="scatter"||t==="bubble"||t==="radar",A=e.globals.dom.Paper.node,r=this.getElGrid();r&&(this.seriesBound=r.getBoundingClientRect());var y,b=[],_=[],B={hoverArea:A,elGrid:r,tooltipEl:s,tooltipY:b,tooltipX:_,ttItems:this.ttItems};if(e.globals.axisCharts&&(h?y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:longestSeries='true'] .apexcharts-marker"):c?y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-bar-area, .apexcharts-series .apexcharts-candlestick-area, .apexcharts-series .apexcharts-boxPlot-area, .apexcharts-series .apexcharts-rangebar-area"):t!=="heatmap"&&t!=="treemap"||(y=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-heatmap, .apexcharts-series .apexcharts-treemap")),y&&y.length))for(var I=0;I<y.length;I++)b.push(y[I].getAttribute("cy")),_.push(y[I].getAttribute("cx"));if(e.globals.xyCharts&&!this.showOnIntersect||e.globals.comboCharts&&!this.showOnIntersect||c&&this.tooltipUtil.hasBars()&&this.tConfig.shared)this.addPathsEventListeners([A],B);else if(c&&!e.globals.comboCharts||h&&this.showOnIntersect)this.addDatapointEventsListeners(B);else if(!e.globals.axisCharts||t==="heatmap"||t==="treemap"){var E=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");this.addPathsEventListeners(E,B)}if(this.showOnIntersect){var R=e.globals.dom.baseEl.querySelectorAll(".apexcharts-line-series .apexcharts-marker, .apexcharts-area-series .apexcharts-marker");R.length>0&&this.addPathsEventListeners(R,B),this.tooltipUtil.hasBars()&&!this.tConfig.shared&&this.addDatapointEventsListeners(B)}}},{key:"drawFixedTooltipRect",value:function(){var e=this.w,t=this.getElTooltip(),s=t.getBoundingClientRect(),c=s.width+10,h=s.height+10,A=this.tConfig.fixed.offsetX,r=this.tConfig.fixed.offsetY,y=this.tConfig.fixed.position.toLowerCase();return y.indexOf("right")>-1&&(A=A+e.globals.svgWidth-c+10),y.indexOf("bottom")>-1&&(r=r+e.globals.svgHeight-h-10),t.style.left=A+"px",t.style.top=r+"px",{x:A,y:r,ttWidth:c,ttHeight:h}}},{key:"addDatapointEventsListeners",value:function(e){var t=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers .apexcharts-marker, .apexcharts-bar-area, .apexcharts-candlestick-area, .apexcharts-boxPlot-area, .apexcharts-rangebar-area");this.addPathsEventListeners(t,e)}},{key:"addPathsEventListeners",value:function(e,t){for(var s=this,c=function(A){var r={paths:e[A],tooltipEl:t.tooltipEl,tooltipY:t.tooltipY,tooltipX:t.tooltipX,elGrid:t.elGrid,hoverArea:t.hoverArea,ttItems:t.ttItems};["mousemove","mouseup","touchmove","mouseout","touchend"].map(function(y){return e[A].addEventListener(y,s.onSeriesHover.bind(s,r),{capture:!1,passive:!0})})},h=0;h<e.length;h++)c(h)}},{key:"onSeriesHover",value:function(e,t){var s=this,c=Date.now()-this.lastHoverTime;c>=20?this.seriesHover(e,t):(clearTimeout(this.seriesHoverTimeout),this.seriesHoverTimeout=setTimeout(function(){s.seriesHover(e,t)},20-c))}},{key:"seriesHover",value:function(e,t){var s=this;this.lastHoverTime=Date.now();var c=[],h=this.w;h.config.chart.group&&(c=this.ctx.getGroupedCharts()),h.globals.axisCharts&&(h.globals.minX===-1/0&&h.globals.maxX===1/0||h.globals.dataPoints===0)||(c.length?c.forEach(function(A){var r=s.getElTooltip(A),y={paths:e.paths,tooltipEl:r,tooltipY:e.tooltipY,tooltipX:e.tooltipX,elGrid:e.elGrid,hoverArea:e.hoverArea,ttItems:A.w.globals.tooltip.ttItems};A.w.globals.minX===s.w.globals.minX&&A.w.globals.maxX===s.w.globals.maxX&&A.w.globals.tooltip.seriesHoverByContext({chartCtx:A,ttCtx:A.w.globals.tooltip,opt:y,e:t})}):this.seriesHoverByContext({chartCtx:this.ctx,ttCtx:this.w.globals.tooltip,opt:e,e:t}))}},{key:"seriesHoverByContext",value:function(e){var t=e.chartCtx,s=e.ttCtx,c=e.opt,h=e.e,A=t.w,r=this.getElTooltip(t);r&&(s.tooltipRect={x:0,y:0,ttWidth:r.getBoundingClientRect().width,ttHeight:r.getBoundingClientRect().height},s.e=h,s.tooltipUtil.hasBars()&&!A.globals.comboCharts&&!s.isBarShared&&this.tConfig.onDatasetHover.highlightDataSeries&&new ld(t).toggleSeriesOnHover(h,h.target.parentNode),A.globals.axisCharts?s.axisChartsTooltips({e:h,opt:c,tooltipRect:s.tooltipRect}):s.nonAxisChartsTooltips({e:h,opt:c,tooltipRect:s.tooltipRect}),s.fixedTooltip&&s.drawFixedTooltipRect())}},{key:"axisChartsTooltips",value:function(e){var t,s,c=e.e,h=e.opt,A=this.w,r=h.elGrid.getBoundingClientRect(),y=c.type==="touchmove"?c.touches[0].clientX:c.clientX,b=c.type==="touchmove"?c.touches[0].clientY:c.clientY;if(this.clientY=b,this.clientX=y,A.globals.capturedSeriesIndex=-1,A.globals.capturedDataPointIndex=-1,b<r.top||b>r.top+r.height)this.handleMouseOut(h);else{if(Array.isArray(this.tConfig.enabledOnSeries)&&!A.config.tooltip.shared){var _=parseInt(h.paths.getAttribute("index"),10);if(this.tConfig.enabledOnSeries.indexOf(_)<0)return void this.handleMouseOut(h)}var B=this.getElTooltip(),I=this.getElXCrosshairs(),E=[];A.config.chart.group&&(E=this.ctx.getSyncedCharts());var R=A.globals.xyCharts||A.config.chart.type==="bar"&&!A.globals.isBarHorizontal&&this.tooltipUtil.hasBars()&&this.tConfig.shared||A.globals.comboCharts&&this.tooltipUtil.hasBars();if(c.type==="mousemove"||c.type==="touchmove"||c.type==="mouseup"){if(A.globals.collapsedSeries.length+A.globals.ancillaryCollapsedSeries.length===A.globals.series.length)return;I!==null&&I.classList.add("apexcharts-active");var M=this.yaxisTooltips.filter(function(Q){return Q===!0});if(this.ycrosshairs!==null&&M.length&&this.ycrosshairs.classList.add("apexcharts-active"),R&&!this.showOnIntersect||E.length>1)this.handleStickyTooltip(c,y,b,h);else if(A.config.chart.type==="heatmap"||A.config.chart.type==="treemap"){var G=this.intersect.handleHeatTreeTooltip({e:c,opt:h,x:t,y:s,type:A.config.chart.type});t=G.x,s=G.y,B.style.left=t+"px",B.style.top=s+"px"}else this.tooltipUtil.hasBars()&&this.intersect.handleBarTooltip({e:c,opt:h}),this.tooltipUtil.hasMarkers()&&this.intersect.handleMarkerTooltip({e:c,opt:h,x:t,y:s});if(this.yaxisTooltips.length)for(var U=0;U<A.config.yaxis.length;U++)this.axesTooltip.drawYaxisTooltipText(U,b,this.xyRatios);A.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),h.tooltipEl.classList.add("apexcharts-active")}else c.type!=="mouseout"&&c.type!=="touchend"||this.handleMouseOut(h)}}},{key:"nonAxisChartsTooltips",value:function(e){var t=e.e,s=e.opt,c=e.tooltipRect,h=this.w,A=s.paths.getAttribute("rel"),r=this.getElTooltip(),y=h.globals.dom.elWrap.getBoundingClientRect();if(t.type==="mousemove"||t.type==="touchmove"){h.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),r.classList.add("apexcharts-active"),this.tooltipLabels.drawSeriesTexts({ttItems:s.ttItems,i:parseInt(A,10)-1,shared:!1});var b=h.globals.clientX-y.left-c.ttWidth/2,_=h.globals.clientY-y.top-c.ttHeight-10;if(r.style.left=b+"px",r.style.top=_+"px",h.config.legend.tooltipHoverFormatter){var B=A-1,I=(0,h.config.legend.tooltipHoverFormatter)(this.legendLabels[B].getAttribute("data:default-text"),{seriesIndex:B,dataPointIndex:B,w:h});this.legendLabels[B].innerHTML=I}}else t.type!=="mouseout"&&t.type!=="touchend"||(r.classList.remove("apexcharts-active"),h.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),h.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(E){var R=E.getAttribute("data:default-text");E.innerHTML=decodeURIComponent(R)}))}},{key:"handleStickyTooltip",value:function(e,t,s,c){var h=this.w,A=this.tooltipUtil.getNearestValues({context:this,hoverArea:c.hoverArea,elGrid:c.elGrid,clientX:t,clientY:s}),r=A.j,y=A.capturedSeries;h.globals.collapsedSeriesIndices.includes(y)&&(y=null);var b=c.elGrid.getBoundingClientRect();if(A.hoverX<0||A.hoverX>b.width)this.handleMouseOut(c);else if(y!==null)this.handleStickyCapturedSeries(e,y,c,r);else if(this.tooltipUtil.isXoverlap(r)||h.globals.isBarHorizontal){var _=h.globals.series.findIndex(function(B,I){return!h.globals.collapsedSeriesIndices.includes(I)});this.create(e,this,_,r,c.ttItems)}}},{key:"handleStickyCapturedSeries",value:function(e,t,s,c){var h=this.w;if(!this.tConfig.shared&&h.globals.series[t][c]===null)return void this.handleMouseOut(s);if(h.globals.series[t][c]!==void 0)this.tConfig.shared&&this.tooltipUtil.isXoverlap(c)&&this.tooltipUtil.isInitialSeriesSameLen()?this.create(e,this,t,c,s.ttItems):this.create(e,this,t,c,s.ttItems,!1);else if(this.tooltipUtil.isXoverlap(c)){var A=h.globals.series.findIndex(function(r,y){return!h.globals.collapsedSeriesIndices.includes(y)});this.create(e,this,A,c,s.ttItems)}}},{key:"deactivateHoverFilter",value:function(){for(var e=this.w,t=new hr(this.ctx),s=e.globals.dom.Paper.find(".apexcharts-bar-area"),c=0;c<s.length;c++)t.pathMouseLeave(s[c])}},{key:"handleMouseOut",value:function(e){var t=this.w,s=this.getElXCrosshairs();if(t.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),e.tooltipEl.classList.remove("apexcharts-active"),this.deactivateHoverFilter(),t.config.chart.type!=="bubble"&&this.marker.resetPointsSize(),s!==null&&s.classList.remove("apexcharts-active"),this.ycrosshairs!==null&&this.ycrosshairs.classList.remove("apexcharts-active"),this.isXAxisTooltipEnabled&&this.xaxisTooltip.classList.remove("apexcharts-active"),this.yaxisTooltips.length){this.yaxisTTEls===null&&(this.yaxisTTEls=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));for(var c=0;c<this.yaxisTTEls.length;c++)this.yaxisTTEls[c].classList.remove("apexcharts-active")}t.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(h){var A=h.getAttribute("data:default-text");h.innerHTML=decodeURIComponent(A)})}},{key:"markerClick",value:function(e,t,s){var c=this.w;typeof c.config.chart.events.markerClick=="function"&&c.config.chart.events.markerClick(e,this.ctx,{seriesIndex:t,dataPointIndex:s,w:c}),this.ctx.events.fireEvent("markerClick",[e,this.ctx,{seriesIndex:t,dataPointIndex:s,w:c}])}},{key:"create",value:function(e,t,s,c,h){var A,r,y,b,_,B,I,E,R,M,G,U,Q,q,ne,re,pe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,Ae=this.w,le=t;e.type==="mouseup"&&this.markerClick(e,s,c),pe===null&&(pe=this.tConfig.shared);var be=this.tooltipUtil.hasMarkers(s),we=this.tooltipUtil.getElBars(),oe=function(){Ae.globals.markers.largestSize>0?le.marker.enlargePoints(c):le.tooltipPosition.moveDynamicPointsOnHover(c)};if(Ae.config.legend.tooltipHoverFormatter){var me=Ae.config.legend.tooltipHoverFormatter,Le=Array.from(this.legendLabels);Le.forEach(function(Je){var lt=Je.getAttribute("data:default-text");Je.innerHTML=decodeURIComponent(lt)});for(var Se=0;Se<Le.length;Se++){var Me=Le[Se],Re=parseInt(Me.getAttribute("i"),10),Ze=decodeURIComponent(Me.getAttribute("data:default-text")),$e=me(Ze,{seriesIndex:pe?Re:s,dataPointIndex:c,w:Ae});if(pe)Me.innerHTML=Ae.globals.collapsedSeriesIndices.indexOf(Re)<0?$e:Ze;else if(Me.innerHTML=Re===s?$e:Ze,s===Re)break}}var ct=Ir(Ir({ttItems:h,i:s,j:c},((A=Ae.globals.seriesRange)===null||A===void 0||(r=A[s])===null||r===void 0||(y=r[c])===null||y===void 0||(b=y.y[0])===null||b===void 0?void 0:b.y1)!==void 0&&{y1:(_=Ae.globals.seriesRange)===null||_===void 0||(B=_[s])===null||B===void 0||(I=B[c])===null||I===void 0||(E=I.y[0])===null||E===void 0?void 0:E.y1}),((R=Ae.globals.seriesRange)===null||R===void 0||(M=R[s])===null||M===void 0||(G=M[c])===null||G===void 0||(U=G.y[0])===null||U===void 0?void 0:U.y2)!==void 0&&{y2:(Q=Ae.globals.seriesRange)===null||Q===void 0||(q=Q[s])===null||q===void 0||(ne=q[c])===null||ne===void 0||(re=ne.y[0])===null||re===void 0?void 0:re.y2});if(pe){if(le.tooltipLabels.drawSeriesTexts(Ir(Ir({},ct),{},{shared:!this.showOnIntersect&&this.tConfig.shared})),be)oe();else if(this.tooltipUtil.hasBars()&&(this.barSeriesHeight=this.tooltipUtil.getBarsHeight(we),this.barSeriesHeight>0)){var Qe=new hr(this.ctx),It=Ae.globals.dom.Paper.find(".apexcharts-bar-area[j='".concat(c,"']"));this.deactivateHoverFilter(),le.tooltipUtil.getAllMarkers(!0).length&&!this.barSeriesHeight&&oe(),le.tooltipPosition.moveStickyTooltipOverBars(c,s);for(var Ce=0;Ce<It.length;Ce++)Qe.pathMouseEnter(It[Ce])}}else le.tooltipLabels.drawSeriesTexts(Ir({shared:!1},ct)),this.tooltipUtil.hasBars()&&le.tooltipPosition.moveStickyTooltipOverBars(c,s),be&&le.tooltipPosition.moveMarkers(s,c)}}]),a}(),GD=function(){function a(e){en(this,a),this.w=e.w,this.barCtx=e,this.totalFormatter=this.w.config.plotOptions.bar.dataLabels.total.formatter,this.totalFormatter||(this.totalFormatter=this.w.config.dataLabels.formatter)}return tn(a,[{key:"handleBarDataLabels",value:function(e){var t,s,c=e.x,h=e.y,A=e.y1,r=e.y2,y=e.i,b=e.j,_=e.realIndex,B=e.columnGroupIndex,I=e.series,E=e.barHeight,R=e.barWidth,M=e.barXPosition,G=e.barYPosition,U=e.visibleSeries,Q=this.w,q=new hr(this.barCtx.ctx),ne=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[_]:this.barCtx.strokeWidth;Q.globals.isXNumeric&&!Q.globals.isBarHorizontal?(t=c+parseFloat(R*(U+1)),s=h+parseFloat(E*(U+1))-ne):(t=c+parseFloat(R*U),s=h+parseFloat(E*U));var re,pe=null,Ae=c,le=h,be={},we=Q.config.dataLabels,oe=this.barCtx.barOptions.dataLabels,me=this.barCtx.barOptions.dataLabels.total;G!==void 0&&this.barCtx.isRangeBar&&(s=G,le=G),M!==void 0&&this.barCtx.isVerticalGroupedRangeBar&&(t=M,Ae=M);var Le=we.offsetX,Se=we.offsetY,Me={width:0,height:0};if(Q.config.dataLabels.enabled){var Re=Q.globals.series[y][b];Me=q.getTextRects(Q.config.dataLabels.formatter?Q.config.dataLabels.formatter(Re,Ir(Ir({},Q),{},{seriesIndex:y,dataPointIndex:b,w:Q})):Q.globals.yLabelFormatters[0](Re),parseFloat(we.style.fontSize))}var Ze={x:c,y:h,i:y,j:b,realIndex:_,columnGroupIndex:B,bcx:t,bcy:s,barHeight:E,barWidth:R,textRects:Me,strokeWidth:ne,dataLabelsX:Ae,dataLabelsY:le,dataLabelsConfig:we,barDataLabelsConfig:oe,barTotalDataLabelsConfig:me,offX:Le,offY:Se};return be=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(Ze):this.calculateColumnsDataLabelsPosition(Ze),re=this.drawCalculatedDataLabels({x:be.dataLabelsX,y:be.dataLabelsY,val:this.barCtx.isRangeBar?[A,r]:Q.config.chart.stackType==="100%"?I[_][b]:Q.globals.series[_][b],i:_,j:b,barWidth:R,barHeight:E,textRects:Me,dataLabelsConfig:we}),Q.config.chart.stacked&&me.enabled&&(pe=this.drawTotalDataLabels({x:be.totalDataLabelsX,y:be.totalDataLabelsY,barWidth:R,barHeight:E,realIndex:_,textAnchor:be.totalDataLabelsAnchor,val:this.getStackedTotalDataLabel({realIndex:_,j:b}),dataLabelsConfig:we,barTotalDataLabelsConfig:me})),{dataLabelsPos:be,dataLabels:re,totalDataLabels:pe}}},{key:"getStackedTotalDataLabel",value:function(e){var t=e.realIndex,s=e.j,c=this.w,h=this.barCtx.stackedSeriesTotals[s];return this.totalFormatter&&(h=this.totalFormatter(h,Ir(Ir({},c),{},{seriesIndex:t,dataPointIndex:s,w:c}))),h}},{key:"calculateColumnsDataLabelsPosition",value:function(e){var t=this,s=this.w,c=e.i,h=e.j,A=e.realIndex;e.columnGroupIndex;var r,y,b=e.y,_=e.bcx,B=e.barWidth,I=e.barHeight,E=e.textRects,R=e.dataLabelsX,M=e.dataLabelsY,G=e.dataLabelsConfig,U=e.barDataLabelsConfig,Q=e.barTotalDataLabelsConfig,q=e.strokeWidth,ne=e.offX,re=e.offY,pe=_;I=Math.abs(I);var Ae=s.config.plotOptions.bar.dataLabels.orientation==="vertical",le=this.barCtx.barHelpers.getZeroValueEncounters({i:c,j:h}).zeroEncounters;_-=q/2;var be=s.globals.gridWidth/s.globals.dataPoints;this.barCtx.isVerticalGroupedRangeBar?R+=B/2:(R=s.globals.isXNumeric?_-B/2+ne:_-be+B/2+ne,!s.config.chart.stacked&&le>0&&s.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(R-=B*le)),Ae&&(R=R+E.height/2-q/2-2);var we=s.globals.series[c][h]<0,oe=b;switch(this.barCtx.isReversed&&(oe=b+(we?I:-I)),U.position){case"center":M=Ae?we?oe-I/2+re:oe+I/2-re:we?oe-I/2+E.height/2+re:oe+I/2+E.height/2-re;break;case"bottom":M=Ae?we?oe-I+re:oe+I-re:we?oe-I+E.height+q+re:oe+I-E.height/2+q-re;break;case"top":M=Ae?we?oe+re:oe-re:we?oe-E.height/2-re:oe+E.height+re}var me=oe;if(s.globals.seriesGroups.forEach(function(Me){var Re;(Re=t.barCtx[Me.join(",")])===null||Re===void 0||Re.prevY.forEach(function(Ze){me=we?Math.max(Ze[h],me):Math.min(Ze[h],me)})}),this.barCtx.lastActiveBarSerieIndex===A&&Q.enabled){var Le=new hr(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:A,j:h}),G.fontSize);r=we?me-Le.height/2-re-Q.offsetY+18:me+Le.height+re+Q.offsetY-18;var Se=be;y=pe+(s.globals.isXNumeric?-B*s.globals.barGroups.length/2:s.globals.barGroups.length*B/2-(s.globals.barGroups.length-1)*B-Se)+Q.offsetX}return s.config.chart.stacked||(M<0?M=0+q:M+E.height/3>s.globals.gridHeight&&(M=s.globals.gridHeight-q)),{bcx:_,bcy:b,dataLabelsX:R,dataLabelsY:M,totalDataLabelsX:y,totalDataLabelsY:r,totalDataLabelsAnchor:"middle"}}},{key:"calculateBarsDataLabelsPosition",value:function(e){var t=this,s=this.w,c=e.x,h=e.i,A=e.j,r=e.realIndex,y=e.bcy,b=e.barHeight,_=e.barWidth,B=e.textRects,I=e.dataLabelsX,E=e.strokeWidth,R=e.dataLabelsConfig,M=e.barDataLabelsConfig,G=e.barTotalDataLabelsConfig,U=e.offX,Q=e.offY,q=s.globals.gridHeight/s.globals.dataPoints,ne=this.barCtx.barHelpers.getZeroValueEncounters({i:h,j:A}).zeroEncounters;_=Math.abs(_);var re,pe,Ae=y-(this.barCtx.isRangeBar?0:q)+b/2+B.height/2+Q-3;!s.config.chart.stacked&&ne>0&&s.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(Ae-=b*ne);var le="start",be=s.globals.series[h][A]<0,we=c;switch(this.barCtx.isReversed&&(we=c+(be?-_:_),le=be?"start":"end"),M.position){case"center":I=be?we+_/2-U:Math.max(B.width/2,we-_/2)+U;break;case"bottom":I=be?we+_-E-U:we-_+E+U;break;case"top":I=be?we-E-U:we-E+U}var oe=we;if(s.globals.seriesGroups.forEach(function(Le){var Se;(Se=t.barCtx[Le.join(",")])===null||Se===void 0||Se.prevX.forEach(function(Me){oe=be?Math.min(Me[A],oe):Math.max(Me[A],oe)})}),this.barCtx.lastActiveBarSerieIndex===r&&G.enabled){var me=new hr(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:r,j:A}),R.fontSize);be?(re=oe-E-U-G.offsetX,le="end"):re=oe+U+G.offsetX+(this.barCtx.isReversed?-(_+E):E),pe=Ae-B.height/2+me.height/2+G.offsetY+E,s.globals.barGroups.length>1&&(pe-=s.globals.barGroups.length/2*(b/2))}return s.config.chart.stacked||(R.textAnchor==="start"?I-B.width<0?I=be?B.width+E:E:I+B.width>s.globals.gridWidth&&(I=be?s.globals.gridWidth-E:s.globals.gridWidth-B.width-E):R.textAnchor==="middle"?I-B.width/2<0?I=B.width/2+E:I+B.width/2>s.globals.gridWidth&&(I=s.globals.gridWidth-B.width/2-E):R.textAnchor==="end"&&(I<1?I=B.width+E:I+1>s.globals.gridWidth&&(I=s.globals.gridWidth-B.width-E))),{bcx:c,bcy:y,dataLabelsX:I,dataLabelsY:Ae,totalDataLabelsX:re,totalDataLabelsY:pe,totalDataLabelsAnchor:le}}},{key:"drawCalculatedDataLabels",value:function(e){var t=e.x,s=e.y,c=e.val,h=e.i,A=e.j,r=e.textRects,y=e.barHeight,b=e.barWidth,_=e.dataLabelsConfig,B=this.w,I="rotate(0)";B.config.plotOptions.bar.dataLabels.orientation==="vertical"&&(I="rotate(-90, ".concat(t,", ").concat(s,")"));var E=new pm(this.barCtx.ctx),R=new hr(this.barCtx.ctx),M=_.formatter,G=null,U=B.globals.collapsedSeriesIndices.indexOf(h)>-1;if(_.enabled&&!U){G=R.group({class:"apexcharts-data-labels",transform:I});var Q="";c!==void 0&&(Q=M(c,Ir(Ir({},B),{},{seriesIndex:h,dataPointIndex:A,w:B}))),!c&&B.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(Q="");var q=B.globals.series[h][A]<0,ne=B.config.plotOptions.bar.dataLabels.position;B.config.plotOptions.bar.dataLabels.orientation==="vertical"&&(ne==="top"&&(_.textAnchor=q?"end":"start"),ne==="center"&&(_.textAnchor="middle"),ne==="bottom"&&(_.textAnchor=q?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&b<R.getTextRects(Q,parseFloat(_.style.fontSize)).width&&(Q=""),B.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?r.width/1.6>Math.abs(b)&&(Q=""):r.height/1.6>Math.abs(y)&&(Q=""));var re=Ir({},_);this.barCtx.isHorizontal&&c<0&&(_.textAnchor==="start"?re.textAnchor="end":_.textAnchor==="end"&&(re.textAnchor="start")),E.plotDataLabelsText({x:t,y:s,text:Q,i:h,j:A,parent:G,dataLabelsConfig:re,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return G}},{key:"drawTotalDataLabels",value:function(e){var t=e.x,s=e.y,c=e.val,h=e.realIndex,A=e.textAnchor,r=e.barTotalDataLabelsConfig;this.w;var y,b=new hr(this.barCtx.ctx);return r.enabled&&t!==void 0&&s!==void 0&&this.barCtx.lastActiveBarSerieIndex===h&&(y=b.drawText({x:t,y:s,foreColor:r.style.color,text:c,textAnchor:A,fontFamily:r.style.fontFamily,fontSize:r.style.fontSize,fontWeight:r.style.fontWeight})),y}}]),a}(),WD=function(){function a(e){en(this,a),this.w=e.w,this.barCtx=e}return tn(a,[{key:"initVariables",value:function(e){var t=this.w;this.barCtx.series=e,this.barCtx.totalItems=0,this.barCtx.seriesLen=0,this.barCtx.visibleI=-1,this.barCtx.visibleItems=1;for(var s=0;s<e.length;s++)if(e[s].length>0&&(this.barCtx.seriesLen=this.barCtx.seriesLen+1,this.barCtx.totalItems+=e[s].length),t.globals.isXNumeric)for(var c=0;c<e[s].length;c++)t.globals.seriesX[s][c]>t.globals.minX&&t.globals.seriesX[s][c]<t.globals.maxX&&this.barCtx.visibleItems++;else this.barCtx.visibleItems=t.globals.dataPoints;this.arrBorderRadius=this.createBorderRadiusArr(t.globals.series),ni.isSafari()&&(this.arrBorderRadius=this.arrBorderRadius.map(function(h){return h.map(function(A){return"none"})})),this.barCtx.seriesLen===0&&(this.barCtx.seriesLen=1),this.barCtx.zeroSerieses=[],t.globals.comboCharts||this.checkZeroSeries({series:e})}},{key:"initialPositions",value:function(e){var t,s,c,h,A,r,y,b,_=this.w,B=_.globals.dataPoints;this.barCtx.isRangeBar&&(B=_.globals.labels.length);var I=this.barCtx.seriesLen;if(_.config.plotOptions.bar.rangeBarGroupRows&&(I=1),this.barCtx.isHorizontal)A=(c=_.globals.gridHeight/B)/I,_.globals.isXNumeric&&(A=(c=_.globals.gridHeight/this.barCtx.totalItems)/this.barCtx.seriesLen),A=A*parseInt(this.barCtx.barOptions.barHeight,10)/100,String(this.barCtx.barOptions.barHeight).indexOf("%")===-1&&(A=parseInt(this.barCtx.barOptions.barHeight,10)),b=this.barCtx.baseLineInvertedY+_.globals.padHorizontal+(this.barCtx.isReversed?_.globals.gridWidth:0)-(this.barCtx.isReversed?2*this.barCtx.baseLineInvertedY:0),this.barCtx.isFunnel&&(b=_.globals.gridWidth/2),s=(c-A*this.barCtx.seriesLen)/2;else{if(h=_.globals.gridWidth/this.barCtx.visibleItems,_.config.xaxis.convertedCatToNumeric&&(h=_.globals.gridWidth/_.globals.dataPoints),r=h/I*parseInt(this.barCtx.barOptions.columnWidth,10)/100,_.globals.isXNumeric){var E=this.barCtx.xRatio;_.globals.minXDiff&&_.globals.minXDiff!==.5&&_.globals.minXDiff/E>0&&(h=_.globals.minXDiff/E),(r=h/I*parseInt(this.barCtx.barOptions.columnWidth,10)/100)<1&&(r=1)}String(this.barCtx.barOptions.columnWidth).indexOf("%")===-1&&(r=parseInt(this.barCtx.barOptions.columnWidth,10)),y=_.globals.gridHeight-this.barCtx.baseLineY[this.barCtx.translationsIndex]-(this.barCtx.isReversed?_.globals.gridHeight:0)+(this.barCtx.isReversed?2*this.barCtx.baseLineY[this.barCtx.translationsIndex]:0),_.globals.isXNumeric?t=this.barCtx.getBarXForNumericXAxis({x:t,j:0,realIndex:e,barWidth:r}).x:t=_.globals.padHorizontal+ni.noExponents(h-r*this.barCtx.seriesLen)/2}return _.globals.barHeight=A,_.globals.barWidth=r,{x:t,y:s,yDivision:c,xDivision:h,barHeight:A,barWidth:r,zeroH:y,zeroW:b}}},{key:"initializeStackedPrevVars",value:function(e){e.w.globals.seriesGroups.forEach(function(t){e[t]||(e[t]={}),e[t].prevY=[],e[t].prevX=[],e[t].prevYF=[],e[t].prevXF=[],e[t].prevYVal=[],e[t].prevXVal=[]})}},{key:"initializeStackedXYVars",value:function(e){e.w.globals.seriesGroups.forEach(function(t){e[t]||(e[t]={}),e[t].xArrj=[],e[t].xArrjF=[],e[t].xArrjVal=[],e[t].yArrj=[],e[t].yArrjF=[],e[t].yArrjVal=[]})}},{key:"getPathFillColor",value:function(e,t,s,c){var h,A,r,y,b=this.w,_=this.barCtx.ctx.fill,B=null,I=this.barCtx.barOptions.distributed?s:t,E=!1;return this.barCtx.barOptions.colors.ranges.length>0&&this.barCtx.barOptions.colors.ranges.map(function(R){e[t][s]>=R.from&&e[t][s]<=R.to&&(B=R.color,E=!0)}),{color:_.fillPath({seriesNumber:this.barCtx.barOptions.distributed?I:c,dataPointIndex:s,color:B,value:e[t][s],fillConfig:(h=b.config.series[t].data[s])===null||h===void 0?void 0:h.fill,fillType:(A=b.config.series[t].data[s])!==null&&A!==void 0&&(r=A.fill)!==null&&r!==void 0&&r.type?(y=b.config.series[t].data[s])===null||y===void 0?void 0:y.fill.type:Array.isArray(b.config.fill.type)?b.config.fill.type[c]:b.config.fill.type}),useRangeColor:E}}},{key:"getStrokeWidth",value:function(e,t,s){var c=0,h=this.w;return this.barCtx.series[e][t]===void 0||this.barCtx.series[e][t]===null?this.barCtx.isNullValue=!0:this.barCtx.isNullValue=!1,h.config.stroke.show&&(this.barCtx.isNullValue||(c=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[s]:this.barCtx.strokeWidth)),c}},{key:"createBorderRadiusArr",value:function(e){var t,s=this.w,c=!this.w.config.chart.stacked||s.config.plotOptions.bar.borderRadius<=0,h=e.length,A=0|((t=e[0])===null||t===void 0?void 0:t.length),r=Array.from({length:h},function(){return Array(A).fill(c?"top":"none")});if(c)return r;for(var y=0;y<A;y++){for(var b=[],_=[],B=0,I=0;I<h;I++){var E=e[I][y];E>0?(b.push(I),B++):E<0&&(_.push(I),B++)}if(b.length>0&&_.length===0)if(b.length===1)r[b[0]][y]="both";else{var R,M=b[0],G=b[b.length-1],U=yy(b);try{for(U.s();!(R=U.n()).done;){var Q=R.value;r[Q][y]=Q===M?"bottom":Q===G?"top":"none"}}catch(Re){U.e(Re)}finally{U.f()}}else if(_.length>0&&b.length===0)if(_.length===1)r[_[0]][y]="both";else{var q,ne=Math.max.apply(Math,_),re=Math.min.apply(Math,_),pe=yy(_);try{for(pe.s();!(q=pe.n()).done;){var Ae=q.value;r[Ae][y]=Ae===ne?"bottom":Ae===re?"top":"none"}}catch(Re){pe.e(Re)}finally{pe.f()}}else if(b.length>0&&_.length>0){var le,be=b[b.length-1],we=yy(b);try{for(we.s();!(le=we.n()).done;){var oe=le.value;r[oe][y]=oe===be?"top":"none"}}catch(Re){we.e(Re)}finally{we.f()}var me,Le=Math.max.apply(Math,_),Se=yy(_);try{for(Se.s();!(me=Se.n()).done;){var Me=me.value;r[Me][y]=Me===Le?"bottom":"none"}}catch(Re){Se.e(Re)}finally{Se.f()}}else B===1&&(r[b[0]||_[0]][y]="both")}return r}},{key:"barBackground",value:function(e){var t=e.j,s=e.i,c=e.x1,h=e.x2,A=e.y1,r=e.y2,y=e.elSeries,b=this.w,_=new hr(this.barCtx.ctx),B=new ld(this.barCtx.ctx).getActiveConfigSeriesIndex();if(this.barCtx.barOptions.colors.backgroundBarColors.length>0&&B===s){t>=this.barCtx.barOptions.colors.backgroundBarColors.length&&(t%=this.barCtx.barOptions.colors.backgroundBarColors.length);var I=this.barCtx.barOptions.colors.backgroundBarColors[t],E=_.drawRect(c!==void 0?c:0,A!==void 0?A:0,h!==void 0?h:b.globals.gridWidth,r!==void 0?r:b.globals.gridHeight,this.barCtx.barOptions.colors.backgroundBarRadius,I,this.barCtx.barOptions.colors.backgroundBarOpacity);y.add(E),E.node.classList.add("apexcharts-backgroundBar")}}},{key:"getColumnPaths",value:function(e){var t,s=e.barWidth,c=e.barXPosition,h=e.y1,A=e.y2,r=e.strokeWidth,y=e.isReversed,b=e.series,_=e.seriesGroup,B=e.realIndex,I=e.i,E=e.j,R=e.w,M=new hr(this.barCtx.ctx);(r=Array.isArray(r)?r[B]:r)||(r=0);var G=s,U=c;(t=R.config.series[B].data[E])!==null&&t!==void 0&&t.columnWidthOffset&&(U=c-R.config.series[B].data[E].columnWidthOffset/2,G=s+R.config.series[B].data[E].columnWidthOffset);var Q=r/2,q=U+Q,ne=U+G-Q,re=(b[I][E]>=0?1:-1)*(y?-1:1);h+=.001-Q*re,A+=.001+Q*re;var pe=M.move(q,h),Ae=M.move(q,h),le=M.line(ne,h);if(R.globals.previousPaths.length>0&&(Ae=this.barCtx.getPreviousPath(B,E,!1)),pe=pe+M.line(q,A)+M.line(ne,A)+le+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),Ae=Ae+M.line(q,h)+le+le+le+le+le+M.line(q,h)+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),this.arrBorderRadius[B][E]!=="none"&&(pe=M.roundPathCorners(pe,R.config.plotOptions.bar.borderRadius)),R.config.chart.stacked){var be=this.barCtx;(be=this.barCtx[_]).yArrj.push(A-Q*re),be.yArrjF.push(Math.abs(h-A+r*re)),be.yArrjVal.push(this.barCtx.series[I][E])}return{pathTo:pe,pathFrom:Ae}}},{key:"getBarpaths",value:function(e){var t,s=e.barYPosition,c=e.barHeight,h=e.x1,A=e.x2,r=e.strokeWidth,y=e.isReversed,b=e.series,_=e.seriesGroup,B=e.realIndex,I=e.i,E=e.j,R=e.w,M=new hr(this.barCtx.ctx);(r=Array.isArray(r)?r[B]:r)||(r=0);var G=s,U=c;(t=R.config.series[B].data[E])!==null&&t!==void 0&&t.barHeightOffset&&(G=s-R.config.series[B].data[E].barHeightOffset/2,U=c+R.config.series[B].data[E].barHeightOffset);var Q=r/2,q=G+Q,ne=G+U-Q,re=(b[I][E]>=0?1:-1)*(y?-1:1);h+=.001+Q*re,A+=.001-Q*re;var pe=M.move(h,q),Ae=M.move(h,q);R.globals.previousPaths.length>0&&(Ae=this.barCtx.getPreviousPath(B,E,!1));var le=M.line(h,ne);if(pe=pe+M.line(A,q)+M.line(A,ne)+le+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),Ae=Ae+M.line(h,q)+le+le+le+le+le+M.line(h,q)+(R.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[B][E]==="both"?" Z":" z"),this.arrBorderRadius[B][E]!=="none"&&(pe=M.roundPathCorners(pe,R.config.plotOptions.bar.borderRadius)),R.config.chart.stacked){var be=this.barCtx;(be=this.barCtx[_]).xArrj.push(A+Q*re),be.xArrjF.push(Math.abs(h-A-r*re)),be.xArrjVal.push(this.barCtx.series[I][E])}return{pathTo:pe,pathFrom:Ae}}},{key:"checkZeroSeries",value:function(e){for(var t=e.series,s=this.w,c=0;c<t.length;c++){for(var h=0,A=0;A<t[s.globals.maxValsInArrayIndex].length;A++)h+=t[c][A];h===0&&this.barCtx.zeroSerieses.push(c)}}},{key:"getXForValue",value:function(e,t){var s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2]?t:null;return e!=null&&(s=t+e/this.barCtx.invertedYRatio-2*(this.barCtx.isReversed?e/this.barCtx.invertedYRatio:0)),s}},{key:"getYForValue",value:function(e,t,s){var c=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3]?t:null;return e!=null&&(c=t-e/this.barCtx.yRatio[s]+2*(this.barCtx.isReversed?e/this.barCtx.yRatio[s]:0)),c}},{key:"getGoalValues",value:function(e,t,s,c,h,A){var r=this,y=this.w,b=[],_=function(E,R){var M;b.push((G0(M={},e,e==="x"?r.getXForValue(E,t,!1):r.getYForValue(E,s,A,!1)),G0(M,"attrs",R),M))};if(y.globals.seriesGoals[c]&&y.globals.seriesGoals[c][h]&&Array.isArray(y.globals.seriesGoals[c][h])&&y.globals.seriesGoals[c][h].forEach(function(E){_(E.value,E)}),this.barCtx.barOptions.isDumbbell&&y.globals.seriesRange.length){var B=this.barCtx.barOptions.dumbbellColors?this.barCtx.barOptions.dumbbellColors:y.globals.colors,I={strokeHeight:e==="x"?0:y.globals.markers.size[c],strokeWidth:e==="x"?y.globals.markers.size[c]:0,strokeDashArray:0,strokeLineCap:"round",strokeColor:Array.isArray(B[c])?B[c][0]:B[c]};_(y.globals.seriesRangeStart[c][h],I),_(y.globals.seriesRangeEnd[c][h],Ir(Ir({},I),{},{strokeColor:Array.isArray(B[c])?B[c][1]:B[c]}))}return b}},{key:"drawGoalLine",value:function(e){var t=e.barXPosition,s=e.barYPosition,c=e.goalX,h=e.goalY,A=e.barWidth,r=e.barHeight,y=new hr(this.barCtx.ctx),b=y.group({className:"apexcharts-bar-goals-groups"});b.node.classList.add("apexcharts-element-hidden"),this.barCtx.w.globals.delayedElements.push({el:b.node}),b.attr("clip-path","url(#gridRectMarkerMask".concat(this.barCtx.w.globals.cuid,")"));var _=null;return this.barCtx.isHorizontal?Array.isArray(c)&&c.forEach(function(B){if(B.x>=-1&&B.x<=y.w.globals.gridWidth+1){var I=B.attrs.strokeHeight!==void 0?B.attrs.strokeHeight:r/2,E=s+I+r/2;_=y.drawLine(B.x,E-2*I,B.x,E,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeWidth?B.attrs.strokeWidth:2,B.attrs.strokeLineCap),b.add(_)}}):Array.isArray(h)&&h.forEach(function(B){if(B.y>=-1&&B.y<=y.w.globals.gridHeight+1){var I=B.attrs.strokeWidth!==void 0?B.attrs.strokeWidth:A/2,E=t+I+A/2;_=y.drawLine(E-2*I,B.y,E,B.y,B.attrs.strokeColor?B.attrs.strokeColor:void 0,B.attrs.strokeDashArray,B.attrs.strokeHeight?B.attrs.strokeHeight:2,B.attrs.strokeLineCap),b.add(_)}}),b}},{key:"drawBarShadow",value:function(e){var t=e.prevPaths,s=e.currPaths,c=e.color,h=this.w,A=t.x,r=t.x1,y=t.barYPosition,b=s.x,_=s.x1,B=s.barYPosition,I=y+s.barHeight,E=new hr(this.barCtx.ctx),R=new ni,M=E.move(r,I)+E.line(A,I)+E.line(b,B)+E.line(_,B)+E.line(r,I)+(h.config.plotOptions.bar.borderRadiusApplication==="around"||this.arrBorderRadius[realIndex][j]==="both"?" Z":" z");return E.drawPath({d:M,fill:R.shadeColor(.5,ni.rgb2hex(c)),stroke:"none",strokeWidth:0,fillOpacity:1,classes:"apexcharts-bar-shadow apexcharts-decoration-element"})}},{key:"getZeroValueEncounters",value:function(e){var t,s=e.i,c=e.j,h=this.w,A=0,r=0;return(h.config.plotOptions.bar.horizontal?h.globals.series.map(function(y,b){return b}):((t=h.globals.columnSeries)===null||t===void 0?void 0:t.i.map(function(y){return y}))||[]).forEach(function(y){var b=h.globals.seriesPercent[y][c];b&&A++,y<s&&b===0&&r++}),{nonZeroColumns:A,zeroEncounters:r}}},{key:"getGroupIndex",value:function(e){var t=this.w,s=t.globals.seriesGroups.findIndex(function(A){return A.indexOf(t.globals.seriesNames[e])>-1}),c=this.barCtx.columnGroupIndices,h=c.indexOf(s);return h<0&&(c.push(s),h=c.length-1),{groupIndex:s,columnGroupIndex:h}}}]),a}(),gm=function(){function a(e,t){en(this,a),this.ctx=e,this.w=e.w;var s=this.w;this.barOptions=s.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=s.config.stroke.width,this.isNullValue=!1,this.isRangeBar=s.globals.seriesRange.length&&this.isHorizontal,this.isVerticalGroupedRangeBar=!s.globals.isBarHorizontal&&s.globals.seriesRange.length&&s.config.plotOptions.bar.rangeBarGroupRows,this.isFunnel=this.barOptions.isFunnel,this.xyRatios=t,this.xyRatios!==null&&(this.xRatio=t.xRatio,this.yRatio=t.yRatio,this.invertedXRatio=t.invertedXRatio,this.invertedYRatio=t.invertedYRatio,this.baseLineY=t.baseLineY,this.baseLineInvertedY=t.baseLineInvertedY),this.yaxisIndex=0,this.translationsIndex=0,this.seriesLen=0,this.pathArr=[];var c=new ld(this.ctx);this.lastActiveBarSerieIndex=c.getActiveConfigSeriesIndex("desc",["bar","column"]),this.columnGroupIndices=[];var h=c.getBarSeriesIndices(),A=new sl(this.ctx);this.stackedSeriesTotals=A.getStackedSeriesTotals(this.w.config.series.map(function(r,y){return h.indexOf(y)===-1?y:-1}).filter(function(r){return r!==-1})),this.barHelpers=new WD(this)}return tn(a,[{key:"draw",value:function(e,t){var s=this.w,c=new hr(this.ctx),h=new sl(this.ctx,s);e=h.getLogSeries(e),this.series=e,this.yRatio=h.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e);var A=c.group({class:"apexcharts-bar-series apexcharts-plot-series"});s.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering - ApexCharts");for(var r=0,y=0;r<e.length;r++,y++){var b,_,B,I,E=void 0,R=void 0,M=[],G=[],U=s.globals.comboCharts?t[r]:r,Q=this.barHelpers.getGroupIndex(U).columnGroupIndex,q=c.group({class:"apexcharts-series",rel:r+1,seriesName:ni.escapeString(s.globals.seriesNames[U]),"data:realIndex":U});this.ctx.series.addCollapsedClassToSeries(q,U),e[r].length>0&&(this.visibleI=this.visibleI+1);var ne=0,re=0;this.yRatio.length>1&&(this.yaxisIndex=s.globals.seriesYAxisReverseMap[U],this.translationsIndex=U);var pe=this.translationsIndex;this.isReversed=s.config.yaxis[this.yaxisIndex]&&s.config.yaxis[this.yaxisIndex].reversed;var Ae=this.barHelpers.initialPositions(U);R=Ae.y,ne=Ae.barHeight,_=Ae.yDivision,I=Ae.zeroW,E=Ae.x,re=Ae.barWidth,b=Ae.xDivision,B=Ae.zeroH,this.isHorizontal||G.push(E+re/2);var le=c.group({class:"apexcharts-datalabels","data:realIndex":U});s.globals.delayedElements.push({el:le.node}),le.node.classList.add("apexcharts-element-hidden");var be=c.group({class:"apexcharts-bar-goals-markers"}),we=c.group({class:"apexcharts-bar-shadows"});s.globals.delayedElements.push({el:we.node}),we.node.classList.add("apexcharts-element-hidden");for(var oe=0;oe<e[r].length;oe++){var me=this.barHelpers.getStrokeWidth(r,oe,U),Le=null,Se={indexes:{i:r,j:oe,realIndex:U,translationsIndex:pe,bc:y},x:E,y:R,strokeWidth:me,elSeries:q};this.isHorizontal?(Le=this.drawBarPaths(Ir(Ir({},Se),{},{barHeight:ne,zeroW:I,yDivision:_})),re=this.series[r][oe]/this.invertedYRatio):(Le=this.drawColumnPaths(Ir(Ir({},Se),{},{xDivision:b,barWidth:re,zeroH:B})),ne=this.series[r][oe]/this.yRatio[pe]);var Me=this.barHelpers.getPathFillColor(e,r,oe,U);if(this.isFunnel&&this.barOptions.isFunnel3d&&this.pathArr.length&&oe>0){var Re,Ze=this.barHelpers.drawBarShadow({color:typeof Me.color=="string"&&((Re=Me.color)===null||Re===void 0?void 0:Re.indexOf("url"))===-1?Me.color:ni.hexToRgba(s.globals.colors[r]),prevPaths:this.pathArr[this.pathArr.length-1],currPaths:Le});we.add(Ze),s.config.chart.dropShadow.enabled&&new Uc(this.ctx).dropShadow(Ze,s.config.chart.dropShadow,U)}this.pathArr.push(Le);var $e=this.barHelpers.drawGoalLine({barXPosition:Le.barXPosition,barYPosition:Le.barYPosition,goalX:Le.goalX,goalY:Le.goalY,barHeight:ne,barWidth:re});$e&&be.add($e),R=Le.y,E=Le.x,oe>0&&G.push(E+re/2),M.push(R),this.renderSeries(Ir(Ir({realIndex:U,pathFill:Me.color},Me.useRangeColor?{lineFill:Me.color}:{}),{},{j:oe,i:r,columnGroupIndex:Q,pathFrom:Le.pathFrom,pathTo:Le.pathTo,strokeWidth:me,elSeries:q,x:E,y:R,series:e,barHeight:Math.abs(Le.barHeight?Le.barHeight:ne),barWidth:Math.abs(Le.barWidth?Le.barWidth:re),elDataLabelsWrap:le,elGoalsMarkers:be,elBarShadows:we,visibleSeries:this.visibleI,type:"bar"}))}s.globals.seriesXvalues[U]=G,s.globals.seriesYvalues[U]=M,A.add(q)}return A}},{key:"renderSeries",value:function(e){var t=e.realIndex,s=e.pathFill,c=e.lineFill,h=e.j,A=e.i,r=e.columnGroupIndex,y=e.pathFrom,b=e.pathTo,_=e.strokeWidth,B=e.elSeries,I=e.x,E=e.y,R=e.y1,M=e.y2,G=e.series,U=e.barHeight,Q=e.barWidth,q=e.barXPosition,ne=e.barYPosition,re=e.elDataLabelsWrap,pe=e.elGoalsMarkers,Ae=e.elBarShadows,le=e.visibleSeries,be=e.type,we=e.classes,oe=this.w,me=new hr(this.ctx),Le=!1;if(!c){var Se=typeof oe.globals.stroke.colors[t]=="function"?function(ct){var Qe,It=oe.config.stroke.colors;return Array.isArray(It)&&It.length>0&&((Qe=It[ct])||(Qe=""),typeof Qe=="function")?Qe({value:oe.globals.series[ct][h],dataPointIndex:h,w:oe}):Qe}(t):oe.globals.stroke.colors[t];c=this.barOptions.distributed?oe.globals.stroke.colors[h]:Se}var Me=new GD(this).handleBarDataLabels({x:I,y:E,y1:R,y2:M,i:A,j:h,series:G,realIndex:t,columnGroupIndex:r,barHeight:U,barWidth:Q,barXPosition:q,barYPosition:ne,visibleSeries:le});oe.globals.isBarHorizontal||(Me.dataLabelsPos.dataLabelsX+Q<0||Me.dataLabelsPos.dataLabelsX-Q>oe.globals.gridWidth)&&(Le=!0),oe.config.series[A].data[h]&&oe.config.series[A].data[h].strokeColor&&(c=oe.config.series[A].data[h].strokeColor),this.isNullValue&&(s="none");var Re=h/oe.config.chart.animations.animateGradually.delay*(oe.config.chart.animations.speed/oe.globals.dataPoints)/2.4;if(!Le){var Ze=me.renderPaths({i:A,j:h,realIndex:t,pathFrom:y,pathTo:b,stroke:c,strokeWidth:_,strokeLineCap:oe.config.stroke.lineCap,fill:s,animationDelay:Re,initialSpeed:oe.config.chart.animations.speed,dataChangeSpeed:oe.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(be,"-area ").concat(we),chartType:be});Ze.attr("clip-path","url(#gridRectBarMask".concat(oe.globals.cuid,")"));var $e=oe.config.forecastDataPoints;$e.count>0&&h>=oe.globals.dataPoints-$e.count&&(Ze.node.setAttribute("stroke-dasharray",$e.dashArray),Ze.node.setAttribute("stroke-width",$e.strokeWidth),Ze.node.setAttribute("fill-opacity",$e.fillOpacity)),R!==void 0&&M!==void 0&&(Ze.attr("data-range-y1",R),Ze.attr("data-range-y2",M)),new Uc(this.ctx).setSelectionFilter(Ze,t,h),B.add(Ze),Ze.attr({cy:Me.dataLabelsPos.bcy,cx:Me.dataLabelsPos.bcx,j:h,val:oe.globals.series[A][h],barHeight:U,barWidth:Q}),Me.dataLabels!==null&&re.add(Me.dataLabels),Me.totalDataLabels&&re.add(Me.totalDataLabels),B.add(re),pe&&B.add(pe),Ae&&B.add(Ae)}return B}},{key:"drawBarPaths",value:function(e){var t,s=e.indexes,c=e.barHeight,h=e.strokeWidth,A=e.zeroW,r=e.x,y=e.y,b=e.yDivision,_=e.elSeries,B=this.w,I=s.i,E=s.j;if(B.globals.isXNumeric)t=(y=(B.globals.seriesX[I][E]-B.globals.minX)/this.invertedXRatio-c)+c*this.visibleI;else if(B.config.plotOptions.bar.hideZeroBarsWhenGrouped){var R=this.barHelpers.getZeroValueEncounters({i:I,j:E}),M=R.nonZeroColumns,G=R.zeroEncounters;M>0&&(c=this.seriesLen*c/M),t=y+c*this.visibleI,t-=c*G}else t=y+c*this.visibleI;this.isFunnel&&(A-=(this.barHelpers.getXForValue(this.series[I][E],A)-A)/2),r=this.barHelpers.getXForValue(this.series[I][E],A);var U=this.barHelpers.getBarpaths({barYPosition:t,barHeight:c,x1:A,x2:r,strokeWidth:h,isReversed:this.isReversed,series:this.series,realIndex:s.realIndex,i:I,j:E,w:B});return B.globals.isXNumeric||(y+=b),this.barHelpers.barBackground({j:E,i:I,y1:t-c*this.visibleI,y2:c*this.seriesLen,elSeries:_}),{pathTo:U.pathTo,pathFrom:U.pathFrom,x1:A,x:r,y,goalX:this.barHelpers.getGoalValues("x",A,null,I,E),barYPosition:t,barHeight:c}}},{key:"drawColumnPaths",value:function(e){var t,s=e.indexes,c=e.x,h=e.y,A=e.xDivision,r=e.barWidth,y=e.zeroH,b=e.strokeWidth,_=e.elSeries,B=this.w,I=s.realIndex,E=s.translationsIndex,R=s.i,M=s.j,G=s.bc;if(B.globals.isXNumeric){var U=this.getBarXForNumericXAxis({x:c,j:M,realIndex:I,barWidth:r});c=U.x,t=U.barXPosition}else if(B.config.plotOptions.bar.hideZeroBarsWhenGrouped){var Q=this.barHelpers.getZeroValueEncounters({i:R,j:M}),q=Q.nonZeroColumns,ne=Q.zeroEncounters;q>0&&(r=this.seriesLen*r/q),t=c+r*this.visibleI,t-=r*ne}else t=c+r*this.visibleI;h=this.barHelpers.getYForValue(this.series[R][M],y,E);var re=this.barHelpers.getColumnPaths({barXPosition:t,barWidth:r,y1:y,y2:h,strokeWidth:b,isReversed:this.isReversed,series:this.series,realIndex:I,i:R,j:M,w:B});return B.globals.isXNumeric||(c+=A),this.barHelpers.barBackground({bc:G,j:M,i:R,x1:t-b/2-r*this.visibleI,x2:r*this.seriesLen+b/2,elSeries:_}),{pathTo:re.pathTo,pathFrom:re.pathFrom,x:c,y:h,goalY:this.barHelpers.getGoalValues("y",null,y,R,M,E),barXPosition:t,barWidth:r}}},{key:"getBarXForNumericXAxis",value:function(e){var t=e.x,s=e.barWidth,c=e.realIndex,h=e.j,A=this.w,r=c;return A.globals.seriesX[c].length||(r=A.globals.maxValsInArrayIndex),ni.isNumber(A.globals.seriesX[r][h])&&(t=(A.globals.seriesX[r][h]-A.globals.minX)/this.xRatio-s*this.seriesLen/2),{barXPosition:t+s*this.visibleI,x:t}}},{key:"getPreviousPath",value:function(e,t){for(var s=this.w,c="M 0 0",h=0;h<s.globals.previousPaths.length;h++){var A=s.globals.previousPaths[h];A.paths&&A.paths.length>0&&parseInt(A.realIndex,10)===parseInt(e,10)&&s.globals.previousPaths[h].paths[t]!==void 0&&(c=s.globals.previousPaths[h].paths[t].d)}return c}}]),a}(),mE=function(a){av(t,gm);var e=ov(t);function t(){return en(this,t),e.apply(this,arguments)}return tn(t,[{key:"draw",value:function(s,c){var h=this,A=this.w;this.graphics=new hr(this.ctx),this.bar=new gm(this.ctx,this.xyRatios);var r=new sl(this.ctx,A);s=r.getLogSeries(s),this.yRatio=r.getLogYRatios(this.yRatio),this.barHelpers.initVariables(s),A.config.chart.stackType==="100%"&&(s=A.globals.comboCharts?c.map(function(R){return A.globals.seriesPercent[R]}):A.globals.seriesPercent.slice()),this.series=s,this.barHelpers.initializeStackedPrevVars(this);for(var y=this.graphics.group({class:"apexcharts-bar-series apexcharts-plot-series"}),b=0,_=0,B=function(R,M){var G=void 0,U=void 0,Q=void 0,q=void 0,ne=A.globals.comboCharts?c[R]:R,re=h.barHelpers.getGroupIndex(ne),pe=re.groupIndex,Ae=re.columnGroupIndex;h.groupCtx=h[A.globals.seriesGroups[pe]];var le=[],be=[],we=0;h.yRatio.length>1&&(h.yaxisIndex=A.globals.seriesYAxisReverseMap[ne][0],we=ne),h.isReversed=A.config.yaxis[h.yaxisIndex]&&A.config.yaxis[h.yaxisIndex].reversed;var oe=h.graphics.group({class:"apexcharts-series",seriesName:ni.escapeString(A.globals.seriesNames[ne]),rel:R+1,"data:realIndex":ne});h.ctx.series.addCollapsedClassToSeries(oe,ne);var me=h.graphics.group({class:"apexcharts-datalabels","data:realIndex":ne}),Le=h.graphics.group({class:"apexcharts-bar-goals-markers"}),Se=0,Me=0,Re=h.initialPositions(b,_,G,U,Q,q,we);_=Re.y,Se=Re.barHeight,U=Re.yDivision,q=Re.zeroW,b=Re.x,Me=Re.barWidth,G=Re.xDivision,Q=Re.zeroH,A.globals.barHeight=Se,A.globals.barWidth=Me,h.barHelpers.initializeStackedXYVars(h),h.groupCtx.prevY.length===1&&h.groupCtx.prevY[0].every(function(mt){return isNaN(mt)})&&(h.groupCtx.prevY[0]=h.groupCtx.prevY[0].map(function(){return Q}),h.groupCtx.prevYF[0]=h.groupCtx.prevYF[0].map(function(){return 0}));for(var Ze=0;Ze<A.globals.dataPoints;Ze++){var $e=h.barHelpers.getStrokeWidth(R,Ze,ne),ct={indexes:{i:R,j:Ze,realIndex:ne,translationsIndex:we,bc:M},strokeWidth:$e,x:b,y:_,elSeries:oe,columnGroupIndex:Ae,seriesGroup:A.globals.seriesGroups[pe]},Qe=null;h.isHorizontal?(Qe=h.drawStackedBarPaths(Ir(Ir({},ct),{},{zeroW:q,barHeight:Se,yDivision:U})),Me=h.series[R][Ze]/h.invertedYRatio):(Qe=h.drawStackedColumnPaths(Ir(Ir({},ct),{},{xDivision:G,barWidth:Me,zeroH:Q})),Se=h.series[R][Ze]/h.yRatio[we]);var It=h.barHelpers.drawGoalLine({barXPosition:Qe.barXPosition,barYPosition:Qe.barYPosition,goalX:Qe.goalX,goalY:Qe.goalY,barHeight:Se,barWidth:Me});It&&Le.add(It),_=Qe.y,b=Qe.x,le.push(b),be.push(_);var Ce=h.barHelpers.getPathFillColor(s,R,Ze,ne),Je="",lt=A.globals.isBarHorizontal?"apexcharts-flip-x":"apexcharts-flip-y";(h.barHelpers.arrBorderRadius[ne][Ze]==="bottom"&&A.globals.series[ne][Ze]>0||h.barHelpers.arrBorderRadius[ne][Ze]==="top"&&A.globals.series[ne][Ze]<0)&&(Je=lt),oe=h.renderSeries(Ir(Ir({realIndex:ne,pathFill:Ce.color},Ce.useRangeColor?{lineFill:Ce.color}:{}),{},{j:Ze,i:R,columnGroupIndex:Ae,pathFrom:Qe.pathFrom,pathTo:Qe.pathTo,strokeWidth:$e,elSeries:oe,x:b,y:_,series:s,barHeight:Se,barWidth:Me,elDataLabelsWrap:me,elGoalsMarkers:Le,type:"bar",visibleSeries:Ae,classes:Je}))}A.globals.seriesXvalues[ne]=le,A.globals.seriesYvalues[ne]=be,h.groupCtx.prevY.push(h.groupCtx.yArrj),h.groupCtx.prevYF.push(h.groupCtx.yArrjF),h.groupCtx.prevYVal.push(h.groupCtx.yArrjVal),h.groupCtx.prevX.push(h.groupCtx.xArrj),h.groupCtx.prevXF.push(h.groupCtx.xArrjF),h.groupCtx.prevXVal.push(h.groupCtx.xArrjVal),y.add(oe)},I=0,E=0;I<s.length;I++,E++)B(I,E);return y}},{key:"initialPositions",value:function(s,c,h,A,r,y,b){var _,B,I=this.w;if(this.isHorizontal){A=I.globals.gridHeight/I.globals.dataPoints;var E=I.config.plotOptions.bar.barHeight;_=String(E).indexOf("%")===-1?parseInt(E,10):A*parseInt(E,10)/100,y=I.globals.padHorizontal+(this.isReversed?I.globals.gridWidth-this.baseLineInvertedY:this.baseLineInvertedY),c=(A-_)/2}else{B=h=I.globals.gridWidth/I.globals.dataPoints;var R=I.config.plotOptions.bar.columnWidth;I.globals.isXNumeric&&I.globals.dataPoints>1?B=(h=I.globals.minXDiff/this.xRatio)*parseInt(this.barOptions.columnWidth,10)/100:String(R).indexOf("%")===-1?B=parseInt(R,10):B*=parseInt(R,10)/100,r=this.isReversed?this.baseLineY[b]:I.globals.gridHeight-this.baseLineY[b],s=I.globals.padHorizontal+(h-B)/2}var M=I.globals.barGroups.length||1;return{x:s,y:c,yDivision:A,xDivision:h,barHeight:_/M,barWidth:B/M,zeroH:r,zeroW:y}}},{key:"drawStackedBarPaths",value:function(s){for(var c,h=s.indexes,A=s.barHeight,r=s.strokeWidth,y=s.zeroW,b=s.x,_=s.y,B=s.columnGroupIndex,I=s.seriesGroup,E=s.yDivision,R=s.elSeries,M=this.w,G=_+B*A,U=h.i,Q=h.j,q=h.realIndex,ne=h.translationsIndex,re=0,pe=0;pe<this.groupCtx.prevXF.length;pe++)re+=this.groupCtx.prevXF[pe][Q];var Ae=U;if(M.config.series[q].name&&(Ae=I.indexOf(M.config.series[q].name)),Ae>0){var le=y;this.groupCtx.prevXVal[Ae-1][Q]<0?le=this.series[U][Q]>=0?this.groupCtx.prevX[Ae-1][Q]+re-2*(this.isReversed?re:0):this.groupCtx.prevX[Ae-1][Q]:this.groupCtx.prevXVal[Ae-1][Q]>=0&&(le=this.series[U][Q]>=0?this.groupCtx.prevX[Ae-1][Q]:this.groupCtx.prevX[Ae-1][Q]-re+2*(this.isReversed?re:0)),c=le}else c=y;b=this.series[U][Q]===null?c:c+this.series[U][Q]/this.invertedYRatio-2*(this.isReversed?this.series[U][Q]/this.invertedYRatio:0);var be=this.barHelpers.getBarpaths({barYPosition:G,barHeight:A,x1:c,x2:b,strokeWidth:r,isReversed:this.isReversed,series:this.series,realIndex:h.realIndex,seriesGroup:I,i:U,j:Q,w:M});return this.barHelpers.barBackground({j:Q,i:U,y1:G,y2:A,elSeries:R}),_+=E,{pathTo:be.pathTo,pathFrom:be.pathFrom,goalX:this.barHelpers.getGoalValues("x",y,null,U,Q,ne),barXPosition:c,barYPosition:G,x:b,y:_}}},{key:"drawStackedColumnPaths",value:function(s){var c=s.indexes,h=s.x,A=s.y,r=s.xDivision,y=s.barWidth,b=s.zeroH,_=s.columnGroupIndex,B=s.seriesGroup,I=s.elSeries,E=this.w,R=c.i,M=c.j,G=c.bc,U=c.realIndex,Q=c.translationsIndex;if(E.globals.isXNumeric){var q=E.globals.seriesX[U][M];q||(q=0),h=(q-E.globals.minX)/this.xRatio-y/2*E.globals.barGroups.length}for(var ne,re=h+_*y,pe=0,Ae=0;Ae<this.groupCtx.prevYF.length;Ae++)pe+=isNaN(this.groupCtx.prevYF[Ae][M])?0:this.groupCtx.prevYF[Ae][M];var le=R;if(B&&(le=B.indexOf(E.globals.seriesNames[U])),le>0&&!E.globals.isXNumeric||le>0&&E.globals.isXNumeric&&E.globals.seriesX[U-1][M]===E.globals.seriesX[U][M]){var be,we,oe,me=Math.min(this.yRatio.length+1,U+1);if(this.groupCtx.prevY[le-1]!==void 0&&this.groupCtx.prevY[le-1].length)for(var Le=1;Le<me;Le++){var Se;if(!isNaN((Se=this.groupCtx.prevY[le-Le])===null||Se===void 0?void 0:Se[M])){oe=this.groupCtx.prevY[le-Le][M];break}}for(var Me=1;Me<me;Me++){var Re,Ze;if(((Re=this.groupCtx.prevYVal[le-Me])===null||Re===void 0?void 0:Re[M])<0){we=this.series[R][M]>=0?oe-pe+2*(this.isReversed?pe:0):oe;break}if(((Ze=this.groupCtx.prevYVal[le-Me])===null||Ze===void 0?void 0:Ze[M])>=0){we=this.series[R][M]>=0?oe:oe+pe-2*(this.isReversed?pe:0);break}}we===void 0&&(we=E.globals.gridHeight),ne=(be=this.groupCtx.prevYF[0])!==null&&be!==void 0&&be.every(function(ct){return ct===0})&&this.groupCtx.prevYF.slice(1,le).every(function(ct){return ct.every(function(Qe){return isNaN(Qe)})})?b:we}else ne=b;A=this.series[R][M]?ne-this.series[R][M]/this.yRatio[Q]+2*(this.isReversed?this.series[R][M]/this.yRatio[Q]:0):ne;var $e=this.barHelpers.getColumnPaths({barXPosition:re,barWidth:y,y1:ne,y2:A,yRatio:this.yRatio[Q],strokeWidth:this.strokeWidth,isReversed:this.isReversed,series:this.series,seriesGroup:B,realIndex:c.realIndex,i:R,j:M,w:E});return this.barHelpers.barBackground({bc:G,j:M,i:R,x1:re,x2:y,elSeries:I}),{pathTo:$e.pathTo,pathFrom:$e.pathFrom,goalY:this.barHelpers.getGoalValues("y",null,b,R,M),barXPosition:re,x:E.globals.isXNumeric?h:h+r,y:A}}}]),t}(),pb=function(a){av(t,gm);var e=ov(t);function t(){return en(this,t),e.apply(this,arguments)}return tn(t,[{key:"draw",value:function(s,c,h){var A=this,r=this.w,y=new hr(this.ctx),b=r.globals.comboCharts?c:r.config.chart.type,_=new qd(this.ctx);this.candlestickOptions=this.w.config.plotOptions.candlestick,this.boxOptions=this.w.config.plotOptions.boxPlot,this.isHorizontal=r.config.plotOptions.bar.horizontal,this.isOHLC=this.candlestickOptions&&this.candlestickOptions.type==="ohlc";var B=new sl(this.ctx,r);s=B.getLogSeries(s),this.series=s,this.yRatio=B.getLogYRatios(this.yRatio),this.barHelpers.initVariables(s);for(var I=y.group({class:"apexcharts-".concat(b,"-series apexcharts-plot-series")}),E=function(M){A.isBoxPlot=r.config.chart.type==="boxPlot"||r.config.series[M].type==="boxPlot";var G,U,Q,q,ne=void 0,re=void 0,pe=[],Ae=[],le=r.globals.comboCharts?h[M]:M,be=A.barHelpers.getGroupIndex(le).columnGroupIndex,we=y.group({class:"apexcharts-series",seriesName:ni.escapeString(r.globals.seriesNames[le]),rel:M+1,"data:realIndex":le});A.ctx.series.addCollapsedClassToSeries(we,le),s[M].length>0&&(A.visibleI=A.visibleI+1);var oe,me,Le=0;A.yRatio.length>1&&(A.yaxisIndex=r.globals.seriesYAxisReverseMap[le][0],Le=le);var Se=A.barHelpers.initialPositions(le);re=Se.y,oe=Se.barHeight,U=Se.yDivision,q=Se.zeroW,ne=Se.x,me=Se.barWidth,G=Se.xDivision,Q=Se.zeroH,Ae.push(ne+me/2);for(var Me=y.group({class:"apexcharts-datalabels","data:realIndex":le}),Re=y.group({class:"apexcharts-bar-goals-markers"}),Ze=function(ct){var Qe=A.barHelpers.getStrokeWidth(M,ct,le),It=null,Ce={indexes:{i:M,j:ct,realIndex:le,translationsIndex:Le},x:ne,y:re,strokeWidth:Qe,elSeries:we};It=A.isHorizontal?A.drawHorizontalBoxPaths(Ir(Ir({},Ce),{},{yDivision:U,barHeight:oe,zeroW:q})):A.drawVerticalBoxPaths(Ir(Ir({},Ce),{},{xDivision:G,barWidth:me,zeroH:Q})),re=It.y,ne=It.x;var Je=A.barHelpers.drawGoalLine({barXPosition:It.barXPosition,barYPosition:It.barYPosition,goalX:It.goalX,goalY:It.goalY,barHeight:oe,barWidth:me});Je&&Re.add(Je),ct>0&&Ae.push(ne+me/2),pe.push(re),It.pathTo.forEach(function(lt,mt){var Bt=!A.isBoxPlot&&A.candlestickOptions.wick.useFillColor?It.color[mt]:r.globals.stroke.colors[M],rt=_.fillPath({seriesNumber:le,dataPointIndex:ct,color:It.color[mt],value:s[M][ct]});A.renderSeries({realIndex:le,pathFill:rt,lineFill:Bt,j:ct,i:M,pathFrom:It.pathFrom,pathTo:lt,strokeWidth:Qe,elSeries:we,x:ne,y:re,series:s,columnGroupIndex:be,barHeight:oe,barWidth:me,elDataLabelsWrap:Me,elGoalsMarkers:Re,visibleSeries:A.visibleI,type:r.config.chart.type})})},$e=0;$e<r.globals.dataPoints;$e++)Ze($e);r.globals.seriesXvalues[le]=Ae,r.globals.seriesYvalues[le]=pe,I.add(we)},R=0;R<s.length;R++)E(R);return I}},{key:"drawVerticalBoxPaths",value:function(s){var c=s.indexes,h=s.x;s.y;var A=s.xDivision,r=s.barWidth,y=s.zeroH,b=s.strokeWidth,_=this.w,B=new hr(this.ctx),I=c.i,E=c.j,R=_.config.plotOptions.candlestick.colors,M=this.boxOptions.colors,G=c.realIndex,U=function($e){return Array.isArray($e)?$e[G]:$e},Q=U(R.upward),q=U(R.downward),ne=this.yRatio[c.translationsIndex],re=this.getOHLCValue(G,E),pe=y,Ae=y,le=re.o<re.c?[Q]:[q];this.isBoxPlot&&(le=[U(M.lower),U(M.upper)]);var be=Math.min(re.o,re.c),we=Math.max(re.o,re.c),oe=re.m;_.globals.isXNumeric&&(h=(_.globals.seriesX[G][E]-_.globals.minX)/this.xRatio-r/2);var me=h+r*this.visibleI;this.series[I][E]===void 0||this.series[I][E]===null?(be=y,we=y):(be=y-be/ne,we=y-we/ne,pe=y-re.h/ne,Ae=y-re.l/ne,oe=y-re.m/ne);var Le=B.move(me,y),Se=B.move(me+r/2,be);if(_.globals.previousPaths.length>0&&(Se=this.getPreviousPath(G,E,!0)),this.isOHLC){var Me=me+r/2,Re=y-re.o/ne,Ze=y-re.c/ne;Le=[B.move(Me,pe)+B.line(Me,Ae)+B.move(Me,Re)+B.line(me,Re)+B.move(Me,Ze)+B.line(me+r,Ze)]}else Le=this.isBoxPlot?[B.move(me,be)+B.line(me+r/2,be)+B.line(me+r/2,pe)+B.line(me+r/4,pe)+B.line(me+r-r/4,pe)+B.line(me+r/2,pe)+B.line(me+r/2,be)+B.line(me+r,be)+B.line(me+r,oe)+B.line(me,oe)+B.line(me,be+b/2),B.move(me,oe)+B.line(me+r,oe)+B.line(me+r,we)+B.line(me+r/2,we)+B.line(me+r/2,Ae)+B.line(me+r-r/4,Ae)+B.line(me+r/4,Ae)+B.line(me+r/2,Ae)+B.line(me+r/2,we)+B.line(me,we)+B.line(me,oe)+"z"]:[B.move(me,we)+B.line(me+r/2,we)+B.line(me+r/2,pe)+B.line(me+r/2,we)+B.line(me+r,we)+B.line(me+r,be)+B.line(me+r/2,be)+B.line(me+r/2,Ae)+B.line(me+r/2,be)+B.line(me,be)+B.line(me,we-b/2)];return Se+=B.move(me,be),_.globals.isXNumeric||(h+=A),{pathTo:Le,pathFrom:Se,x:h,y:we,goalY:this.barHelpers.getGoalValues("y",null,y,I,E,c.translationsIndex),barXPosition:me,color:le}}},{key:"drawHorizontalBoxPaths",value:function(s){var c=s.indexes;s.x;var h=s.y,A=s.yDivision,r=s.barHeight,y=s.zeroW,b=s.strokeWidth,_=this.w,B=new hr(this.ctx),I=c.i,E=c.j,R=this.boxOptions.colors.lower;this.isBoxPlot&&(R=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var M=this.invertedYRatio,G=c.realIndex,U=this.getOHLCValue(G,E),Q=y,q=y,ne=Math.min(U.o,U.c),re=Math.max(U.o,U.c),pe=U.m;_.globals.isXNumeric&&(h=(_.globals.seriesX[G][E]-_.globals.minX)/this.invertedXRatio-r/2);var Ae=h+r*this.visibleI;this.series[I][E]===void 0||this.series[I][E]===null?(ne=y,re=y):(ne=y+ne/M,re=y+re/M,Q=y+U.h/M,q=y+U.l/M,pe=y+U.m/M);var le=B.move(y,Ae),be=B.move(ne,Ae+r/2);return _.globals.previousPaths.length>0&&(be=this.getPreviousPath(G,E,!0)),le=[B.move(ne,Ae)+B.line(ne,Ae+r/2)+B.line(Q,Ae+r/2)+B.line(Q,Ae+r/2-r/4)+B.line(Q,Ae+r/2+r/4)+B.line(Q,Ae+r/2)+B.line(ne,Ae+r/2)+B.line(ne,Ae+r)+B.line(pe,Ae+r)+B.line(pe,Ae)+B.line(ne+b/2,Ae),B.move(pe,Ae)+B.line(pe,Ae+r)+B.line(re,Ae+r)+B.line(re,Ae+r/2)+B.line(q,Ae+r/2)+B.line(q,Ae+r-r/4)+B.line(q,Ae+r/4)+B.line(q,Ae+r/2)+B.line(re,Ae+r/2)+B.line(re,Ae)+B.line(pe,Ae)+"z"],be+=B.move(ne,Ae),_.globals.isXNumeric||(h+=A),{pathTo:le,pathFrom:be,x:re,y:h,goalX:this.barHelpers.getGoalValues("x",y,null,I,E),barYPosition:Ae,color:R}}},{key:"getOHLCValue",value:function(s,c){var h=this.w,A=new sl(this.ctx,h),r=A.getLogValAtSeriesIndex(h.globals.seriesCandleH[s][c],s),y=A.getLogValAtSeriesIndex(h.globals.seriesCandleO[s][c],s),b=A.getLogValAtSeriesIndex(h.globals.seriesCandleM[s][c],s),_=A.getLogValAtSeriesIndex(h.globals.seriesCandleC[s][c],s),B=A.getLogValAtSeriesIndex(h.globals.seriesCandleL[s][c],s);return{o:this.isBoxPlot?r:y,h:this.isBoxPlot?y:r,m:b,l:this.isBoxPlot?_:B,c:this.isBoxPlot?B:_}}}]),t}(),wT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"checkColorRange",value:function(){var e=this.w,t=!1,s=e.config.plotOptions[e.config.chart.type];return s.colorScale.ranges.length>0&&s.colorScale.ranges.map(function(c,h){c.from<=0&&(t=!0)}),t}},{key:"getShadeColor",value:function(e,t,s,c){var h=this.w,A=1,r=h.config.plotOptions[e].shadeIntensity,y=this.determineColor(e,t,s);h.globals.hasNegs||c?A=h.config.plotOptions[e].reverseNegativeShade?y.percent<0?y.percent/100*(1.25*r):(1-y.percent/100)*(1.25*r):y.percent<=0?1-(1+y.percent/100)*r:(1-y.percent/100)*r:(A=1-y.percent/100,e==="treemap"&&(A=(1-y.percent/100)*(1.25*r)));var b=y.color,_=new ni;if(h.config.plotOptions[e].enableShades)if(this.w.config.theme.mode==="dark"){var B=_.shadeColor(-1*A,y.color);b=ni.hexToRgba(ni.isColorHex(B)?B:ni.rgb2hex(B),h.config.fill.opacity)}else{var I=_.shadeColor(A,y.color);b=ni.hexToRgba(ni.isColorHex(I)?I:ni.rgb2hex(I),h.config.fill.opacity)}return{color:b,colorProps:y}}},{key:"determineColor",value:function(e,t,s){var c=this.w,h=c.globals.series[t][s],A=c.config.plotOptions[e],r=A.colorScale.inverse?s:t;A.distributed&&c.config.chart.type==="treemap"&&(r=s);var y=c.globals.colors[r],b=null,_=Math.min.apply(Math,Jl(c.globals.series[t])),B=Math.max.apply(Math,Jl(c.globals.series[t]));A.distributed||e!=="heatmap"||(_=c.globals.minY,B=c.globals.maxY),A.colorScale.min!==void 0&&(_=A.colorScale.min<c.globals.minY?A.colorScale.min:c.globals.minY,B=A.colorScale.max>c.globals.maxY?A.colorScale.max:c.globals.maxY);var I=Math.abs(B)+Math.abs(_),E=100*h/(I===0?I-1e-6:I);return A.colorScale.ranges.length>0&&A.colorScale.ranges.map(function(R,M){if(h>=R.from&&h<=R.to){y=R.color,b=R.foreColor?R.foreColor:null,_=R.from,B=R.to;var G=Math.abs(B)+Math.abs(_);E=100*h/(G===0?G-1e-6:G)}}),{color:y,foreColor:b,percent:E}}},{key:"calculateDataLabels",value:function(e){var t=e.text,s=e.x,c=e.y,h=e.i,A=e.j,r=e.colorProps,y=e.fontSize,b=this.w.config.dataLabels,_=new hr(this.ctx),B=new pm(this.ctx),I=null;if(b.enabled){I=_.group({class:"apexcharts-data-labels"});var E=b.offsetX,R=b.offsetY,M=s+E,G=c+parseFloat(b.style.fontSize)/3+R;B.plotDataLabelsText({x:M,y:G,text:t,i:h,j:A,color:r.foreColor,parent:I,fontSize:y,dataLabelsConfig:b})}return I}},{key:"addListeners",value:function(e){var t=new hr(this.ctx);e.node.addEventListener("mouseenter",t.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",t.pathMouseLeave.bind(this,e)),e.node.addEventListener("mousedown",t.pathMouseDown.bind(this,e))}}]),a}(),XD=function(){function a(e,t){en(this,a),this.ctx=e,this.w=e.w,this.xRatio=t.xRatio,this.yRatio=t.yRatio,this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.helpers=new wT(e),this.rectRadius=this.w.config.plotOptions.heatmap.radius,this.strokeWidth=this.w.config.stroke.show?this.w.config.stroke.width:0}return tn(a,[{key:"draw",value:function(e){var t=this.w,s=new hr(this.ctx),c=s.group({class:"apexcharts-heatmap"});c.attr("clip-path","url(#gridRectMask".concat(t.globals.cuid,")"));var h=t.globals.gridWidth/t.globals.dataPoints,A=t.globals.gridHeight/t.globals.series.length,r=0,y=!1;this.negRange=this.helpers.checkColorRange();var b=e.slice();t.config.yaxis[0].reversed&&(y=!0,b.reverse());for(var _=y?0:b.length-1;y?_<b.length:_>=0;y?_++:_--){var B=s.group({class:"apexcharts-series apexcharts-heatmap-series",seriesName:ni.escapeString(t.globals.seriesNames[_]),rel:_+1,"data:realIndex":_});if(this.ctx.series.addCollapsedClassToSeries(B,_),t.config.chart.dropShadow.enabled){var I=t.config.chart.dropShadow;new Uc(this.ctx).dropShadow(B,I,_)}for(var E=0,R=t.config.plotOptions.heatmap.shadeIntensity,M=0,G=0;G<t.globals.dataPoints;G++)if(t.globals.seriesX.length&&!t.globals.allSeriesHasEqualX&&t.globals.minX+t.globals.minXDiff*G<t.globals.seriesX[_][M])E+=h;else{if(M>=b[_].length)break;var U=this.helpers.getShadeColor(t.config.chart.type,_,M,this.negRange),Q=U.color,q=U.colorProps;t.config.fill.type==="image"&&(Q=new qd(this.ctx).fillPath({seriesNumber:_,dataPointIndex:M,opacity:t.globals.hasNegs?q.percent<0?1-(1+q.percent/100):R+q.percent/100:q.percent/100,patternID:ni.randomId(),width:t.config.fill.image.width?t.config.fill.image.width:h,height:t.config.fill.image.height?t.config.fill.image.height:A}));var ne=this.rectRadius,re=s.drawRect(E,r,h,A,ne);if(re.attr({cx:E,cy:r}),re.node.classList.add("apexcharts-heatmap-rect"),B.add(re),re.attr({fill:Q,i:_,index:_,j:M,val:e[_][M],"stroke-width":this.strokeWidth,stroke:t.config.plotOptions.heatmap.useFillColorAsStroke?Q:t.globals.stroke.colors[0],color:Q}),this.helpers.addListeners(re),t.config.chart.animations.enabled&&!t.globals.dataChanged){var pe=1;t.globals.resized||(pe=t.config.chart.animations.speed),this.animateHeatMap(re,E,r,h,A,pe)}if(t.globals.dataChanged){var Ae=1;if(this.dynamicAnim.enabled&&t.globals.shouldAnimate){Ae=this.dynamicAnim.speed;var le=t.globals.previousPaths[_]&&t.globals.previousPaths[_][M]&&t.globals.previousPaths[_][M].color;le||(le="rgba(255, 255, 255, 0)"),this.animateHeatColor(re,ni.isColorHex(le)?le:ni.rgb2hex(le),ni.isColorHex(Q)?Q:ni.rgb2hex(Q),Ae)}}var be=(0,t.config.dataLabels.formatter)(t.globals.series[_][M],{value:t.globals.series[_][M],seriesIndex:_,dataPointIndex:M,w:t}),we=this.helpers.calculateDataLabels({text:be,x:E+h/2,y:r+A/2,i:_,j:M,colorProps:q,series:b});we!==null&&B.add(we),E+=h,M++}r+=A,c.add(B)}var oe=t.globals.yAxisScale[0].result.slice();return t.config.yaxis[0].reversed?oe.unshift(""):oe.push(""),t.globals.yAxisScale[0].result=oe,c}},{key:"animateHeatMap",value:function(e,t,s,c,h,A){var r=new vm(this.ctx);r.animateRect(e,{x:t+c/2,y:s+h/2,width:0,height:0},{x:t,y:s,width:c,height:h},A,function(){r.animationCompleted(e)})}},{key:"animateHeatColor",value:function(e,t,s,c){e.attr({fill:t}).animate(c).attr({fill:s})}}]),a}(),BT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"drawYAxisTexts",value:function(e,t,s,c){var h=this.w,A=h.config.yaxis[0],r=h.globals.yLabelFormatters[0];return new hr(this.ctx).drawText({x:e+A.labels.offsetX,y:t+A.labels.offsetY,text:r(c,s),textAnchor:"middle",fontSize:A.labels.style.fontSize,fontFamily:A.labels.style.fontFamily,foreColor:Array.isArray(A.labels.style.colors)?A.labels.style.colors[s]:A.labels.style.colors})}}]),a}(),CT=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w;var t=this.w;this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animBeginArr=[0],this.animDur=0,this.donutDataLabels=this.w.config.plotOptions.pie.donut.labels,this.lineColorArr=t.globals.stroke.colors!==void 0?t.globals.stroke.colors:t.globals.colors,this.defaultSize=Math.min(t.globals.gridWidth,t.globals.gridHeight),this.centerY=this.defaultSize/2,this.centerX=t.globals.gridWidth/2,t.config.chart.type==="radialBar"?this.fullAngle=360:this.fullAngle=Math.abs(t.config.plotOptions.pie.endAngle-t.config.plotOptions.pie.startAngle),this.initialAngle=t.config.plotOptions.pie.startAngle%this.fullAngle,t.globals.radialSize=this.defaultSize/2.05-t.config.stroke.width-(t.config.chart.sparkline.enabled?0:t.config.chart.dropShadow.blur),this.donutSize=t.globals.radialSize*parseInt(t.config.plotOptions.pie.donut.size,10)/100;var s=t.config.plotOptions.pie.customScale,c=t.globals.gridWidth/2,h=t.globals.gridHeight/2;this.translateX=c-c*s,this.translateY=h-h*s,this.dataLabelsGroup=new hr(this.ctx).group({class:"apexcharts-datalabels-group",transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(s,")")}),this.maxY=0,this.sliceLabels=[],this.sliceSizes=[],this.prevSectorAngleArr=[]}return tn(a,[{key:"draw",value:function(e){var t=this,s=this.w,c=new hr(this.ctx),h=c.group({class:"apexcharts-pie"});if(s.globals.noData)return h;for(var A=0,r=0;r<e.length;r++)A+=ni.negToZero(e[r]);var y=[],b=c.group();A===0&&(A=1e-5),e.forEach(function(q){t.maxY=Math.max(t.maxY,q)}),s.config.yaxis[0].max&&(this.maxY=s.config.yaxis[0].max),s.config.grid.position==="back"&&this.chartType==="polarArea"&&this.drawPolarElements(h);for(var _=0;_<e.length;_++){var B=this.fullAngle*ni.negToZero(e[_])/A;y.push(B),this.chartType==="polarArea"?(y[_]=this.fullAngle/e.length,this.sliceSizes.push(s.globals.radialSize*e[_]/this.maxY)):this.sliceSizes.push(s.globals.radialSize)}if(s.globals.dataChanged){for(var I,E=0,R=0;R<s.globals.previousPaths.length;R++)E+=ni.negToZero(s.globals.previousPaths[R]);for(var M=0;M<s.globals.previousPaths.length;M++)I=this.fullAngle*ni.negToZero(s.globals.previousPaths[M])/E,this.prevSectorAngleArr.push(I)}if(this.donutSize<0&&(this.donutSize=0),this.chartType==="donut"){var G=c.drawCircle(this.donutSize);G.attr({cx:this.centerX,cy:this.centerY,fill:s.config.plotOptions.pie.donut.background?s.config.plotOptions.pie.donut.background:"transparent"}),b.add(G)}var U=this.drawArcs(y,e);if(this.sliceLabels.forEach(function(q){U.add(q)}),b.attr({transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(s.config.plotOptions.pie.customScale,")")}),b.add(U),h.add(b),this.donutDataLabels.show){var Q=this.renderInnerDataLabels(this.dataLabelsGroup,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});h.add(Q)}return s.config.grid.position==="front"&&this.chartType==="polarArea"&&this.drawPolarElements(h),h}},{key:"drawArcs",value:function(e,t){var s=this.w,c=new Uc(this.ctx),h=new hr(this.ctx),A=new qd(this.ctx),r=h.group({class:"apexcharts-slices"}),y=this.initialAngle,b=this.initialAngle,_=this.initialAngle,B=this.initialAngle;this.strokeWidth=s.config.stroke.show?s.config.stroke.width:0;for(var I=0;I<e.length;I++){var E=h.group({class:"apexcharts-series apexcharts-pie-series",seriesName:ni.escapeString(s.globals.seriesNames[I]),rel:I+1,"data:realIndex":I});r.add(E),b=B,_=(y=_)+e[I],B=b+this.prevSectorAngleArr[I];var R=_<y?this.fullAngle+_-y:_-y,M=A.fillPath({seriesNumber:I,size:this.sliceSizes[I],value:t[I]}),G=this.getChangedPath(b,B),U=h.drawPath({d:G,stroke:Array.isArray(this.lineColorArr)?this.lineColorArr[I]:this.lineColorArr,strokeWidth:0,fill:M,fillOpacity:s.config.fill.opacity,classes:"apexcharts-pie-area apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(I)});if(U.attr({index:0,j:I}),c.setSelectionFilter(U,0,I),s.config.chart.dropShadow.enabled){var Q=s.config.chart.dropShadow;c.dropShadow(U,Q,I)}this.addListeners(U,this.donutDataLabels),hr.setAttrs(U.node,{"data:angle":R,"data:startAngle":y,"data:strokeWidth":this.strokeWidth,"data:value":t[I]});var q={x:0,y:0};this.chartType==="pie"||this.chartType==="polarArea"?q=ni.polarToCartesian(this.centerX,this.centerY,s.globals.radialSize/1.25+s.config.plotOptions.pie.dataLabels.offset,(y+R/2)%this.fullAngle):this.chartType==="donut"&&(q=ni.polarToCartesian(this.centerX,this.centerY,(s.globals.radialSize+this.donutSize)/2+s.config.plotOptions.pie.dataLabels.offset,(y+R/2)%this.fullAngle)),E.add(U);var ne=0;if(!this.initialAnim||s.globals.resized||s.globals.dataChanged?this.animBeginArr.push(0):((ne=R/this.fullAngle*s.config.chart.animations.speed)===0&&(ne=1),this.animDur=ne+this.animDur,this.animBeginArr.push(this.animDur)),this.dynamicAnim&&s.globals.dataChanged?this.animatePaths(U,{size:this.sliceSizes[I],endAngle:_,startAngle:y,prevStartAngle:b,prevEndAngle:B,animateStartingPos:!0,i:I,animBeginArr:this.animBeginArr,shouldSetPrevPaths:!0,dur:s.config.chart.animations.dynamicAnimation.speed}):this.animatePaths(U,{size:this.sliceSizes[I],endAngle:_,startAngle:y,i:I,totalItems:e.length-1,animBeginArr:this.animBeginArr,dur:ne}),s.config.plotOptions.pie.expandOnClick&&this.chartType!=="polarArea"&&U.node.addEventListener("mouseup",this.pieClicked.bind(this,I)),s.globals.selectedDataPoints[0]!==void 0&&s.globals.selectedDataPoints[0].indexOf(I)>-1&&this.pieClicked(I),s.config.dataLabels.enabled){var re=q.x,pe=q.y,Ae=100*R/this.fullAngle+"%";if(R!==0&&s.config.plotOptions.pie.dataLabels.minAngleToShowLabel<e[I]){var le=s.config.dataLabels.formatter;le!==void 0&&(Ae=le(s.globals.seriesPercent[I][0],{seriesIndex:I,w:s}));var be=s.globals.dataLabels.style.colors[I],we=h.group({class:"apexcharts-datalabels"}),oe=h.drawText({x:re,y:pe,text:Ae,textAnchor:"middle",fontSize:s.config.dataLabels.style.fontSize,fontFamily:s.config.dataLabels.style.fontFamily,fontWeight:s.config.dataLabels.style.fontWeight,foreColor:be});if(we.add(oe),s.config.dataLabels.dropShadow.enabled){var me=s.config.dataLabels.dropShadow;c.dropShadow(oe,me)}oe.node.classList.add("apexcharts-pie-label"),s.config.chart.animations.animate&&s.globals.resized===!1&&(oe.node.classList.add("apexcharts-pie-label-delay"),oe.node.style.animationDelay=s.config.chart.animations.speed/940+"s"),this.sliceLabels.push(we)}}}return r}},{key:"addListeners",value:function(e,t){var s=new hr(this.ctx);e.node.addEventListener("mouseenter",s.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",s.pathMouseLeave.bind(this,e)),e.node.addEventListener("mouseleave",this.revertDataLabelsInner.bind(this,e.node,t)),e.node.addEventListener("mousedown",s.pathMouseDown.bind(this,e)),this.donutDataLabels.total.showAlways||(e.node.addEventListener("mouseenter",this.printDataLabelsInner.bind(this,e.node,t)),e.node.addEventListener("mousedown",this.printDataLabelsInner.bind(this,e.node,t)))}},{key:"animatePaths",value:function(e,t){var s=this.w,c=t.endAngle<t.startAngle?this.fullAngle+t.endAngle-t.startAngle:t.endAngle-t.startAngle,h=c,A=t.startAngle,r=t.startAngle;t.prevStartAngle!==void 0&&t.prevEndAngle!==void 0&&(A=t.prevEndAngle,h=t.prevEndAngle<t.prevStartAngle?this.fullAngle+t.prevEndAngle-t.prevStartAngle:t.prevEndAngle-t.prevStartAngle),t.i===s.config.series.length-1&&(c+r>this.fullAngle?t.endAngle=t.endAngle-(c+r):c+r<this.fullAngle&&(t.endAngle=t.endAngle+(this.fullAngle-(c+r)))),c===this.fullAngle&&(c=this.fullAngle-.01),this.animateArc(e,A,r,c,h,t)}},{key:"animateArc",value:function(e,t,s,c,h,A){var r,y=this,b=this.w,_=new vm(this.ctx),B=A.size;(isNaN(t)||isNaN(h))&&(t=s,h=c,A.dur=0);var I=c,E=s,R=t<s?this.fullAngle+t-s:t-s;b.globals.dataChanged&&A.shouldSetPrevPaths&&A.prevEndAngle&&(r=y.getPiePath({me:y,startAngle:A.prevStartAngle,angle:A.prevEndAngle<A.prevStartAngle?this.fullAngle+A.prevEndAngle-A.prevStartAngle:A.prevEndAngle-A.prevStartAngle,size:B}),e.attr({d:r})),A.dur!==0?e.animate(A.dur,A.animBeginArr[A.i]).after(function(){y.chartType!=="pie"&&y.chartType!=="donut"&&y.chartType!=="polarArea"||this.animate(b.config.chart.animations.dynamicAnimation.speed).attr({"stroke-width":y.strokeWidth}),A.i===b.config.series.length-1&&_.animationCompleted(e)}).during(function(M){I=R+(c-R)*M,A.animateStartingPos&&(I=h+(c-h)*M,E=t-h+(s-(t-h))*M),r=y.getPiePath({me:y,startAngle:E,angle:I,size:B}),e.node.setAttribute("data:pathOrig",r),e.attr({d:r})}):(r=y.getPiePath({me:y,startAngle:E,angle:c,size:B}),A.isTrack||(b.globals.animationEnded=!0),e.node.setAttribute("data:pathOrig",r),e.attr({d:r,"stroke-width":y.strokeWidth}))}},{key:"pieClicked",value:function(e){var t,s=this.w,c=this,h=c.sliceSizes[e]+(s.config.plotOptions.pie.expandOnClick?4:0),A=s.globals.dom.Paper.findOne(".apexcharts-".concat(c.chartType.toLowerCase(),"-slice-").concat(e));if(A.attr("data:pieClicked")!=="true"){var r=s.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area");Array.prototype.forEach.call(r,function(B){B.setAttribute("data:pieClicked","false");var I=B.getAttribute("data:pathOrig");I&&B.setAttribute("d",I)}),s.globals.capturedDataPointIndex=e,A.attr("data:pieClicked","true");var y=parseInt(A.attr("data:startAngle"),10),b=parseInt(A.attr("data:angle"),10);t=c.getPiePath({me:c,startAngle:y,angle:b,size:h}),b!==360&&A.plot(t)}else{A.attr({"data:pieClicked":"false"}),this.revertDataLabelsInner(A.node,this.donutDataLabels);var _=A.attr("data:pathOrig");A.attr({d:_})}}},{key:"getChangedPath",value:function(e,t){var s="";return this.dynamicAnim&&this.w.globals.dataChanged&&(s=this.getPiePath({me:this,startAngle:e,angle:t-e,size:this.size})),s}},{key:"getPiePath",value:function(e){var t,s=e.me,c=e.startAngle,h=e.angle,A=e.size,r=new hr(this.ctx),y=c,b=Math.PI*(y-90)/180,_=h+c;Math.ceil(_)>=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle&&(_=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle-.01),Math.ceil(_)>this.fullAngle&&(_-=this.fullAngle);var B=Math.PI*(_-90)/180,I=s.centerX+A*Math.cos(b),E=s.centerY+A*Math.sin(b),R=s.centerX+A*Math.cos(B),M=s.centerY+A*Math.sin(B),G=ni.polarToCartesian(s.centerX,s.centerY,s.donutSize,_),U=ni.polarToCartesian(s.centerX,s.centerY,s.donutSize,y),Q=h>180?1:0,q=["M",I,E,"A",A,A,0,Q,1,R,M];return t=s.chartType==="donut"?[].concat(q,["L",G.x,G.y,"A",s.donutSize,s.donutSize,0,Q,0,U.x,U.y,"L",I,E,"z"]).join(" "):s.chartType==="pie"||s.chartType==="polarArea"?[].concat(q,["L",s.centerX,s.centerY,"L",I,E]).join(" "):[].concat(q).join(" "),r.roundPathCorners(t,2*this.strokeWidth)}},{key:"drawPolarElements",value:function(e){var t=this.w,s=new yT(this.ctx),c=new hr(this.ctx),h=new BT(this.ctx),A=c.group(),r=c.group(),y=s.niceScale(0,Math.ceil(this.maxY),0),b=y.result.reverse(),_=y.result.length;this.maxY=y.niceMax;for(var B=t.globals.radialSize,I=B/(_-1),E=0;E<_-1;E++){var R=c.drawCircle(B);if(R.attr({cx:this.centerX,cy:this.centerY,fill:"none","stroke-width":t.config.plotOptions.polarArea.rings.strokeWidth,stroke:t.config.plotOptions.polarArea.rings.strokeColor}),t.config.yaxis[0].show){var M=h.drawYAxisTexts(this.centerX,this.centerY-B+parseInt(t.config.yaxis[0].labels.style.fontSize,10)/2,E,b[E]);r.add(M)}A.add(R),B-=I}this.drawSpokes(e),e.add(A),e.add(r)}},{key:"renderInnerDataLabels",value:function(e,t,s){var c=this.w,h=new hr(this.ctx),A=t.total.show;e.node.innerHTML="",e.node.style.opacity=s.opacity;var r,y,b=s.centerX,_=this.donutDataLabels.total.label?s.centerY:s.centerY-s.centerY/6;r=t.name.color===void 0?c.globals.colors[0]:t.name.color;var B=t.name.fontSize,I=t.name.fontFamily,E=t.name.fontWeight;y=t.value.color===void 0?c.config.chart.foreColor:t.value.color;var R=t.value.formatter,M="",G="";if(A?(r=t.total.color,B=t.total.fontSize,I=t.total.fontFamily,E=t.total.fontWeight,G=this.donutDataLabels.total.label?t.total.label:"",M=t.total.formatter(c)):c.globals.series.length===1&&(M=R(c.globals.series[0],c),G=c.globals.seriesNames[0]),G&&(G=t.name.formatter(G,t.total.show,c)),t.name.show){var U=h.drawText({x:b,y:_+parseFloat(t.name.offsetY),text:G,textAnchor:"middle",foreColor:r,fontSize:B,fontWeight:E,fontFamily:I});U.node.classList.add("apexcharts-datalabel-label"),e.add(U)}if(t.value.show){var Q=t.name.show?parseFloat(t.value.offsetY)+16:t.value.offsetY,q=h.drawText({x:b,y:_+Q,text:M,textAnchor:"middle",foreColor:y,fontWeight:t.value.fontWeight,fontSize:t.value.fontSize,fontFamily:t.value.fontFamily});q.node.classList.add("apexcharts-datalabel-value"),e.add(q)}return e}},{key:"printInnerLabels",value:function(e,t,s,c){var h,A=this.w;c?h=e.name.color===void 0?A.globals.colors[parseInt(c.parentNode.getAttribute("rel"),10)-1]:e.name.color:A.globals.series.length>1&&e.total.show&&(h=e.total.color);var r=A.globals.dom.baseEl.querySelector(".apexcharts-datalabel-label"),y=A.globals.dom.baseEl.querySelector(".apexcharts-datalabel-value");s=(0,e.value.formatter)(s,A),c||typeof e.total.formatter!="function"||(s=e.total.formatter(A));var b=t===e.total.label;t=this.donutDataLabels.total.label?e.name.formatter(t,b,A):"",r!==null&&(r.textContent=t),y!==null&&(y.textContent=s),r!==null&&(r.style.fill=h)}},{key:"printDataLabelsInner",value:function(e,t){var s=this.w,c=e.getAttribute("data:value"),h=s.globals.seriesNames[parseInt(e.parentNode.getAttribute("rel"),10)-1];s.globals.series.length>1&&this.printInnerLabels(t,h,c,e);var A=s.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group");A!==null&&(A.style.opacity=1)}},{key:"drawSpokes",value:function(e){var t=this,s=this.w,c=new hr(this.ctx),h=s.config.plotOptions.polarArea.spokes;if(h.strokeWidth!==0){for(var A=[],r=360/s.globals.series.length,y=0;y<s.globals.series.length;y++)A.push(ni.polarToCartesian(this.centerX,this.centerY,s.globals.radialSize,s.config.plotOptions.pie.startAngle+r*y));A.forEach(function(b,_){var B=c.drawLine(b.x,b.y,t.centerX,t.centerY,Array.isArray(h.connectorColors)?h.connectorColors[_]:h.connectorColors);e.add(B)})}}},{key:"revertDataLabelsInner",value:function(){var e=this.w;if(this.donutDataLabels.show){var t=e.globals.dom.Paper.findOne(".apexcharts-datalabels-group"),s=this.renderInnerDataLabels(t,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});e.globals.dom.Paper.findOne(".apexcharts-radialbar, .apexcharts-pie").add(s)}}}]),a}(),YD=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animDur=0;var t=this.w;this.graphics=new hr(this.ctx),this.lineColorArr=t.globals.stroke.colors!==void 0?t.globals.stroke.colors:t.globals.colors,this.defaultSize=t.globals.svgHeight<t.globals.svgWidth?t.globals.gridHeight:t.globals.gridWidth,this.isLog=t.config.yaxis[0].logarithmic,this.logBase=t.config.yaxis[0].logBase,this.coreUtils=new sl(this.ctx),this.maxValue=this.isLog?this.coreUtils.getLogVal(this.logBase,t.globals.maxY,0):t.globals.maxY,this.minValue=this.isLog?this.coreUtils.getLogVal(this.logBase,this.w.globals.minY,0):t.globals.minY,this.polygons=t.config.plotOptions.radar.polygons,this.strokeWidth=t.config.stroke.show?t.config.stroke.width:0,this.size=this.defaultSize/2.1-this.strokeWidth-t.config.chart.dropShadow.blur,t.config.xaxis.labels.show&&(this.size=this.size-t.globals.xAxisLabelsWidth/1.75),t.config.plotOptions.radar.size!==void 0&&(this.size=t.config.plotOptions.radar.size),this.dataRadiusOfPercent=[],this.dataRadius=[],this.angleArr=[],this.yaxisLabelsTextsPos=[]}return tn(a,[{key:"draw",value:function(e){var t=this,s=this.w,c=new qd(this.ctx),h=[],A=new pm(this.ctx);e.length&&(this.dataPointsLen=e[s.globals.maxValsInArrayIndex].length),this.disAngle=2*Math.PI/this.dataPointsLen;var r=s.globals.gridWidth/2,y=s.globals.gridHeight/2,b=r+s.config.plotOptions.radar.offsetX,_=y+s.config.plotOptions.radar.offsetY,B=this.graphics.group({class:"apexcharts-radar-series apexcharts-plot-series",transform:"translate(".concat(b||0,", ").concat(_||0,")")}),I=[],E=null,R=null;if(this.yaxisLabels=this.graphics.group({class:"apexcharts-yaxis"}),e.forEach(function(G,U){var Q=G.length===s.globals.dataPoints,q=t.graphics.group().attr({class:"apexcharts-series","data:longestSeries":Q,seriesName:ni.escapeString(s.globals.seriesNames[U]),rel:U+1,"data:realIndex":U});t.dataRadiusOfPercent[U]=[],t.dataRadius[U]=[],t.angleArr[U]=[],G.forEach(function(Le,Se){var Me=Math.abs(t.maxValue-t.minValue);Le-=t.minValue,t.isLog&&(Le=t.coreUtils.getLogVal(t.logBase,Le,0)),t.dataRadiusOfPercent[U][Se]=Le/Me,t.dataRadius[U][Se]=t.dataRadiusOfPercent[U][Se]*t.size,t.angleArr[U][Se]=Se*t.disAngle}),I=t.getDataPointsPos(t.dataRadius[U],t.angleArr[U]);var ne=t.createPaths(I,{x:0,y:0});E=t.graphics.group({class:"apexcharts-series-markers-wrap apexcharts-element-hidden"}),R=t.graphics.group({class:"apexcharts-datalabels","data:realIndex":U}),s.globals.delayedElements.push({el:E.node,index:U});var re={i:U,realIndex:U,animationDelay:U,initialSpeed:s.config.chart.animations.speed,dataChangeSpeed:s.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-radar",shouldClipToGrid:!1,bindEventsOnPaths:!1,stroke:s.globals.stroke.colors[U],strokeLineCap:s.config.stroke.lineCap},pe=null;s.globals.previousPaths.length>0&&(pe=t.getPreviousPath(U));for(var Ae=0;Ae<ne.linePathsTo.length;Ae++){var le=t.graphics.renderPaths(Ir(Ir({},re),{},{pathFrom:pe===null?ne.linePathsFrom[Ae]:pe,pathTo:ne.linePathsTo[Ae],strokeWidth:Array.isArray(t.strokeWidth)?t.strokeWidth[U]:t.strokeWidth,fill:"none",drawShadow:!1}));q.add(le);var be=c.fillPath({seriesNumber:U}),we=t.graphics.renderPaths(Ir(Ir({},re),{},{pathFrom:pe===null?ne.areaPathsFrom[Ae]:pe,pathTo:ne.areaPathsTo[Ae],strokeWidth:0,fill:be,drawShadow:!1}));if(s.config.chart.dropShadow.enabled){var oe=new Uc(t.ctx),me=s.config.chart.dropShadow;oe.dropShadow(we,Object.assign({},me,{noUserSpaceOnUse:!0}),U)}q.add(we)}G.forEach(function(Le,Se){var Me=new wm(t.ctx).getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:U,dataPointIndex:Se}),Re=t.graphics.drawMarker(I[Se].x,I[Se].y,Me);Re.attr("rel",Se),Re.attr("j",Se),Re.attr("index",U),Re.node.setAttribute("default-marker-size",Me.pSize);var Ze=t.graphics.group({class:"apexcharts-series-markers"});Ze&&Ze.add(Re),E.add(Ze),q.add(E);var $e=s.config.dataLabels;if($e.enabled){var ct=$e.formatter(s.globals.series[U][Se],{seriesIndex:U,dataPointIndex:Se,w:s});A.plotDataLabelsText({x:I[Se].x,y:I[Se].y,text:ct,textAnchor:"middle",i:U,j:U,parent:R,offsetCorrection:!1,dataLabelsConfig:Ir({},$e)})}q.add(R)}),h.push(q)}),this.drawPolygons({parent:B}),s.config.xaxis.labels.show){var M=this.drawXAxisTexts();B.add(M)}return h.forEach(function(G){B.add(G)}),B.add(this.yaxisLabels),B}},{key:"drawPolygons",value:function(e){for(var t=this,s=this.w,c=e.parent,h=new BT(this.ctx),A=s.globals.yAxisScale[0].result.reverse(),r=A.length,y=[],b=this.size/(r-1),_=0;_<r;_++)y[_]=b*_;y.reverse();var B=[],I=[];y.forEach(function(E,R){var M=ni.getPolygonPos(E,t.dataPointsLen),G="";M.forEach(function(U,Q){if(R===0){var q=t.graphics.drawLine(U.x,U.y,0,0,Array.isArray(t.polygons.connectorColors)?t.polygons.connectorColors[Q]:t.polygons.connectorColors);I.push(q)}Q===0&&t.yaxisLabelsTextsPos.push({x:U.x,y:U.y}),G+=U.x+","+U.y+" "}),B.push(G)}),B.forEach(function(E,R){var M=t.polygons.strokeColors,G=t.polygons.strokeWidth,U=t.graphics.drawPolygon(E,Array.isArray(M)?M[R]:M,Array.isArray(G)?G[R]:G,s.globals.radarPolygons.fill.colors[R]);c.add(U)}),I.forEach(function(E){c.add(E)}),s.config.yaxis[0].show&&this.yaxisLabelsTextsPos.forEach(function(E,R){var M=h.drawYAxisTexts(E.x,E.y,R,A[R]);t.yaxisLabels.add(M)})}},{key:"drawXAxisTexts",value:function(){var e=this,t=this.w,s=t.config.xaxis.labels,c=this.graphics.group({class:"apexcharts-xaxis"}),h=ni.getPolygonPos(this.size,this.dataPointsLen);return t.globals.labels.forEach(function(A,r){var y=t.config.xaxis.labels.formatter,b=new pm(e.ctx);if(h[r]){var _=e.getTextPos(h[r],e.size),B=y(A,{seriesIndex:-1,dataPointIndex:r,w:t});b.plotDataLabelsText({x:_.newX,y:_.newY,text:B,textAnchor:_.textAnchor,i:r,j:r,parent:c,className:"apexcharts-xaxis-label",color:Array.isArray(s.style.colors)&&s.style.colors[r]?s.style.colors[r]:"#a8a8a8",dataLabelsConfig:Ir({textAnchor:_.textAnchor,dropShadow:{enabled:!1}},s),offsetCorrection:!1}).on("click",function(I){if(typeof t.config.chart.events.xAxisLabelClick=="function"){var E=Object.assign({},t,{labelIndex:r});t.config.chart.events.xAxisLabelClick(I,e.ctx,E)}})}}),c}},{key:"createPaths",value:function(e,t){var s=this,c=[],h=[],A=[],r=[];if(e.length){h=[this.graphics.move(t.x,t.y)],r=[this.graphics.move(t.x,t.y)];var y=this.graphics.move(e[0].x,e[0].y),b=this.graphics.move(e[0].x,e[0].y);e.forEach(function(_,B){y+=s.graphics.line(_.x,_.y),b+=s.graphics.line(_.x,_.y),B===e.length-1&&(y+="Z",b+="Z")}),c.push(y),A.push(b)}return{linePathsFrom:h,linePathsTo:c,areaPathsFrom:r,areaPathsTo:A}}},{key:"getTextPos",value:function(e,t){var s="middle",c=e.x,h=e.y;return Math.abs(e.x)>=10?e.x>0?(s="start",c+=10):e.x<0&&(s="end",c-=10):s="middle",Math.abs(e.y)>=t-10&&(e.y<0?h-=10:e.y>0&&(h+=10)),{textAnchor:s,newX:c,newY:h}}},{key:"getPreviousPath",value:function(e){for(var t=this.w,s=null,c=0;c<t.globals.previousPaths.length;c++){var h=t.globals.previousPaths[c];h.paths.length>0&&parseInt(h.realIndex,10)===parseInt(e,10)&&t.globals.previousPaths[c].paths[0]!==void 0&&(s=t.globals.previousPaths[c].paths[0].d)}return s}},{key:"getDataPointsPos",value:function(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.dataPointsLen;e=e||[],t=t||[];for(var c=[],h=0;h<s;h++){var A={};A.x=e[h]*Math.sin(t[h]),A.y=-e[h]*Math.cos(t[h]),c.push(A)}return c}}]),a}(),KD=function(a){av(t,CT);var e=ov(t);function t(s){var c;en(this,t),(c=e.call(this,s)).ctx=s,c.w=s.w,c.animBeginArr=[0],c.animDur=0;var h=c.w;return c.startAngle=h.config.plotOptions.radialBar.startAngle,c.endAngle=h.config.plotOptions.radialBar.endAngle,c.totalAngle=Math.abs(h.config.plotOptions.radialBar.endAngle-h.config.plotOptions.radialBar.startAngle),c.trackStartAngle=h.config.plotOptions.radialBar.track.startAngle,c.trackEndAngle=h.config.plotOptions.radialBar.track.endAngle,c.barLabels=c.w.config.plotOptions.radialBar.barLabels,c.donutDataLabels=c.w.config.plotOptions.radialBar.dataLabels,c.radialDataLabels=c.donutDataLabels,c.trackStartAngle||(c.trackStartAngle=c.startAngle),c.trackEndAngle||(c.trackEndAngle=c.endAngle),c.endAngle===360&&(c.endAngle=359.99),c.margin=parseInt(h.config.plotOptions.radialBar.track.margin,10),c.onBarLabelClick=c.onBarLabelClick.bind(RI(c)),c}return tn(t,[{key:"draw",value:function(s){var c=this.w,h=new hr(this.ctx),A=h.group({class:"apexcharts-radialbar"});if(c.globals.noData)return A;var r=h.group(),y=this.defaultSize/2,b=c.globals.gridWidth/2,_=this.defaultSize/2.05;c.config.chart.sparkline.enabled||(_=_-c.config.stroke.width-c.config.chart.dropShadow.blur);var B=c.globals.fill.colors;if(c.config.plotOptions.radialBar.track.show){var I=this.drawTracks({size:_,centerX:b,centerY:y,colorArr:B,series:s});r.add(I)}var E=this.drawArcs({size:_,centerX:b,centerY:y,colorArr:B,series:s}),R=360;c.config.plotOptions.radialBar.startAngle<0&&(R=this.totalAngle);var M=(360-R)/360;if(c.globals.radialSize=_-_*M,this.radialDataLabels.value.show){var G=Math.max(this.radialDataLabels.value.offsetY,this.radialDataLabels.name.offsetY);c.globals.radialSize+=G*M}return r.add(E.g),c.config.plotOptions.radialBar.hollow.position==="front"&&(E.g.add(E.elHollow),E.dataLabels&&E.g.add(E.dataLabels)),A.add(r),A}},{key:"drawTracks",value:function(s){var c=this.w,h=new hr(this.ctx),A=h.group({class:"apexcharts-tracks"}),r=new Uc(this.ctx),y=new qd(this.ctx),b=this.getStrokeWidth(s);s.size=s.size-b/2;for(var _=0;_<s.series.length;_++){var B=h.group({class:"apexcharts-radialbar-track apexcharts-track"});A.add(B),B.attr({rel:_+1}),s.size=s.size-b-this.margin;var I=c.config.plotOptions.radialBar.track,E=y.fillPath({seriesNumber:0,size:s.size,fillColors:Array.isArray(I.background)?I.background[_]:I.background,solid:!0}),R=this.trackStartAngle,M=this.trackEndAngle;Math.abs(M)+Math.abs(R)>=360&&(M=360-Math.abs(this.startAngle)-.1);var G=h.drawPath({d:"",stroke:E,strokeWidth:b*parseInt(I.strokeWidth,10)/100,fill:"none",strokeOpacity:I.opacity,classes:"apexcharts-radialbar-area"});if(I.dropShadow.enabled){var U=I.dropShadow;r.dropShadow(G,U)}B.add(G),G.attr("id","apexcharts-radialbarTrack-"+_),this.animatePaths(G,{centerX:s.centerX,centerY:s.centerY,endAngle:M,startAngle:R,size:s.size,i:_,totalItems:2,animBeginArr:0,dur:0,isTrack:!0})}return A}},{key:"drawArcs",value:function(s){var c=this.w,h=new hr(this.ctx),A=new qd(this.ctx),r=new Uc(this.ctx),y=h.group(),b=this.getStrokeWidth(s);s.size=s.size-b/2;var _=c.config.plotOptions.radialBar.hollow.background,B=s.size-b*s.series.length-this.margin*s.series.length-b*parseInt(c.config.plotOptions.radialBar.track.strokeWidth,10)/100/2,I=B-c.config.plotOptions.radialBar.hollow.margin;c.config.plotOptions.radialBar.hollow.image!==void 0&&(_=this.drawHollowImage(s,y,B,_));var E=this.drawHollow({size:I,centerX:s.centerX,centerY:s.centerY,fill:_||"transparent"});if(c.config.plotOptions.radialBar.hollow.dropShadow.enabled){var R=c.config.plotOptions.radialBar.hollow.dropShadow;r.dropShadow(E,R)}var M=1;!this.radialDataLabels.total.show&&c.globals.series.length>1&&(M=0);var G=null;if(this.radialDataLabels.show){var U=c.globals.dom.Paper.findOne(".apexcharts-datalabels-group");G=this.renderInnerDataLabels(U,this.radialDataLabels,{hollowSize:B,centerX:s.centerX,centerY:s.centerY,opacity:M})}c.config.plotOptions.radialBar.hollow.position==="back"&&(y.add(E),G&&y.add(G));var Q=!1;c.config.plotOptions.radialBar.inverseOrder&&(Q=!0);for(var q=Q?s.series.length-1:0;Q?q>=0:q<s.series.length;Q?q--:q++){var ne=h.group({class:"apexcharts-series apexcharts-radial-series",seriesName:ni.escapeString(c.globals.seriesNames[q])});y.add(ne),ne.attr({rel:q+1,"data:realIndex":q}),this.ctx.series.addCollapsedClassToSeries(ne,q),s.size=s.size-b-this.margin;var re=A.fillPath({seriesNumber:q,size:s.size,value:s.series[q]}),pe=this.startAngle,Ae=void 0,le=ni.negToZero(s.series[q]>100?100:s.series[q])/100,be=Math.round(this.totalAngle*le)+this.startAngle,we=void 0;c.globals.dataChanged&&(Ae=this.startAngle,we=Math.round(this.totalAngle*ni.negToZero(c.globals.previousPaths[q])/100)+Ae),Math.abs(be)+Math.abs(pe)>360&&(be-=.01),Math.abs(we)+Math.abs(Ae)>360&&(we-=.01);var oe=be-pe,me=Array.isArray(c.config.stroke.dashArray)?c.config.stroke.dashArray[q]:c.config.stroke.dashArray,Le=h.drawPath({d:"",stroke:re,strokeWidth:b,fill:"none",fillOpacity:c.config.fill.opacity,classes:"apexcharts-radialbar-area apexcharts-radialbar-slice-"+q,strokeDashArray:me});if(hr.setAttrs(Le.node,{"data:angle":oe,"data:value":s.series[q]}),c.config.chart.dropShadow.enabled){var Se=c.config.chart.dropShadow;r.dropShadow(Le,Se,q)}if(r.setSelectionFilter(Le,0,q),this.addListeners(Le,this.radialDataLabels),ne.add(Le),Le.attr({index:0,j:q}),this.barLabels.enabled){var Me=ni.polarToCartesian(s.centerX,s.centerY,s.size,pe),Re=this.barLabels.formatter(c.globals.seriesNames[q],{seriesIndex:q,w:c}),Ze=["apexcharts-radialbar-label"];this.barLabels.onClick||Ze.push("apexcharts-no-click");var $e=this.barLabels.useSeriesColors?c.globals.colors[q]:c.config.chart.foreColor;$e||($e=c.config.chart.foreColor);var ct=Me.x+this.barLabels.offsetX,Qe=Me.y+this.barLabels.offsetY,It=h.drawText({x:ct,y:Qe,text:Re,textAnchor:"end",dominantBaseline:"middle",fontFamily:this.barLabels.fontFamily,fontWeight:this.barLabels.fontWeight,fontSize:this.barLabels.fontSize,foreColor:$e,cssClass:Ze.join(" ")});It.on("click",this.onBarLabelClick),It.attr({rel:q+1}),pe!==0&&It.attr({"transform-origin":"".concat(ct," ").concat(Qe),transform:"rotate(".concat(pe," 0 0)")}),ne.add(It)}var Ce=0;!this.initialAnim||c.globals.resized||c.globals.dataChanged||(Ce=c.config.chart.animations.speed),c.globals.dataChanged&&(Ce=c.config.chart.animations.dynamicAnimation.speed),this.animDur=Ce/(1.2*s.series.length)+this.animDur,this.animBeginArr.push(this.animDur),this.animatePaths(Le,{centerX:s.centerX,centerY:s.centerY,endAngle:be,startAngle:pe,prevEndAngle:we,prevStartAngle:Ae,size:s.size,i:q,totalItems:2,animBeginArr:this.animBeginArr,dur:Ce,shouldSetPrevPaths:!0})}return{g:y,elHollow:E,dataLabels:G}}},{key:"drawHollow",value:function(s){var c=new hr(this.ctx).drawCircle(2*s.size);return c.attr({class:"apexcharts-radialbar-hollow",cx:s.centerX,cy:s.centerY,r:s.size,fill:s.fill}),c}},{key:"drawHollowImage",value:function(s,c,h,A){var r=this.w,y=new qd(this.ctx),b=ni.randomId(),_=r.config.plotOptions.radialBar.hollow.image;if(r.config.plotOptions.radialBar.hollow.imageClipped)y.clippedImgArea({width:h,height:h,image:_,patternID:"pattern".concat(r.globals.cuid).concat(b)}),A="url(#pattern".concat(r.globals.cuid).concat(b,")");else{var B=r.config.plotOptions.radialBar.hollow.imageWidth,I=r.config.plotOptions.radialBar.hollow.imageHeight;if(B===void 0&&I===void 0){var E=r.globals.dom.Paper.image(_,function(M){this.move(s.centerX-M.width/2+r.config.plotOptions.radialBar.hollow.imageOffsetX,s.centerY-M.height/2+r.config.plotOptions.radialBar.hollow.imageOffsetY)});c.add(E)}else{var R=r.globals.dom.Paper.image(_,function(M){this.move(s.centerX-B/2+r.config.plotOptions.radialBar.hollow.imageOffsetX,s.centerY-I/2+r.config.plotOptions.radialBar.hollow.imageOffsetY),this.size(B,I)});c.add(R)}}return A}},{key:"getStrokeWidth",value:function(s){var c=this.w;return s.size*(100-parseInt(c.config.plotOptions.radialBar.hollow.size,10))/100/(s.series.length+1)-this.margin}},{key:"onBarLabelClick",value:function(s){var c=parseInt(s.target.getAttribute("rel"),10)-1,h=this.barLabels.onClick,A=this.w;h&&h(A.globals.seriesNames[c],{w:A,seriesIndex:c})}}]),t}(),qD=function(a){av(t,gm);var e=ov(t);function t(){return en(this,t),e.apply(this,arguments)}return tn(t,[{key:"draw",value:function(s,c){var h=this.w,A=new hr(this.ctx);this.rangeBarOptions=this.w.config.plotOptions.rangeBar,this.series=s,this.seriesRangeStart=h.globals.seriesRangeStart,this.seriesRangeEnd=h.globals.seriesRangeEnd,this.barHelpers.initVariables(s);for(var r=A.group({class:"apexcharts-rangebar-series apexcharts-plot-series"}),y=0;y<s.length;y++){var b,_,B,I,E=void 0,R=void 0,M=h.globals.comboCharts?c[y]:y,G=this.barHelpers.getGroupIndex(M).columnGroupIndex,U=A.group({class:"apexcharts-series",seriesName:ni.escapeString(h.globals.seriesNames[M]),rel:y+1,"data:realIndex":M});this.ctx.series.addCollapsedClassToSeries(U,M),s[y].length>0&&(this.visibleI=this.visibleI+1);var Q=0,q=0,ne=0;this.yRatio.length>1&&(this.yaxisIndex=h.globals.seriesYAxisReverseMap[M][0],ne=M);var re=this.barHelpers.initialPositions(M);R=re.y,I=re.zeroW,E=re.x,q=re.barWidth,Q=re.barHeight,b=re.xDivision,_=re.yDivision,B=re.zeroH;for(var pe=A.group({class:"apexcharts-datalabels","data:realIndex":M}),Ae=A.group({class:"apexcharts-rangebar-goals-markers"}),le=0;le<h.globals.dataPoints;le++){var be=this.barHelpers.getStrokeWidth(y,le,M),we=this.seriesRangeStart[y][le],oe=this.seriesRangeEnd[y][le],me=null,Le=null,Se=null,Me={x:E,y:R,strokeWidth:be,elSeries:U},Re=this.seriesLen;if(h.config.plotOptions.bar.rangeBarGroupRows&&(Re=1),h.config.series[y].data[le]===void 0)break;if(this.isHorizontal){Se=R+Q*this.visibleI;var Ze=(_-Q*Re)/2;if(h.config.series[y].data[le].x){var $e=this.detectOverlappingBars({i:y,j:le,barYPosition:Se,srty:Ze,barHeight:Q,yDivision:_,initPositions:re});Q=$e.barHeight,Se=$e.barYPosition}q=(me=this.drawRangeBarPaths(Ir({indexes:{i:y,j:le,realIndex:M},barHeight:Q,barYPosition:Se,zeroW:I,yDivision:_,y1:we,y2:oe},Me))).barWidth}else{h.globals.isXNumeric&&(E=(h.globals.seriesX[y][le]-h.globals.minX)/this.xRatio-q/2),Le=E+q*this.visibleI;var ct=(b-q*Re)/2;if(h.config.series[y].data[le].x){var Qe=this.detectOverlappingBars({i:y,j:le,barXPosition:Le,srtx:ct,barWidth:q,xDivision:b,initPositions:re});q=Qe.barWidth,Le=Qe.barXPosition}Q=(me=this.drawRangeColumnPaths(Ir({indexes:{i:y,j:le,realIndex:M,translationsIndex:ne},barWidth:q,barXPosition:Le,zeroH:B,xDivision:b},Me))).barHeight}var It=this.barHelpers.drawGoalLine({barXPosition:me.barXPosition,barYPosition:Se,goalX:me.goalX,goalY:me.goalY,barHeight:Q,barWidth:q});It&&Ae.add(It),R=me.y,E=me.x;var Ce=this.barHelpers.getPathFillColor(s,y,le,M);this.renderSeries({realIndex:M,pathFill:Ce.color,lineFill:Ce.useRangeColor?Ce.color:h.globals.stroke.colors[M],j:le,i:y,x:E,y:R,y1:we,y2:oe,pathFrom:me.pathFrom,pathTo:me.pathTo,strokeWidth:be,elSeries:U,series:s,barHeight:Q,barWidth:q,barXPosition:Le,barYPosition:Se,columnGroupIndex:G,elDataLabelsWrap:pe,elGoalsMarkers:Ae,visibleSeries:this.visibleI,type:"rangebar"})}r.add(U)}return r}},{key:"detectOverlappingBars",value:function(s){var c=s.i,h=s.j,A=s.barYPosition,r=s.barXPosition,y=s.srty,b=s.srtx,_=s.barHeight,B=s.barWidth,I=s.yDivision,E=s.xDivision,R=s.initPositions,M=this.w,G=[],U=M.config.series[c].data[h].rangeName,Q=M.config.series[c].data[h].x,q=Array.isArray(Q)?Q.join(" "):Q,ne=M.globals.labels.map(function(pe){return Array.isArray(pe)?pe.join(" "):pe}).indexOf(q),re=M.globals.seriesRange[c].findIndex(function(pe){return pe.x===q&&pe.overlaps.length>0});return this.isHorizontal?(A=M.config.plotOptions.bar.rangeBarGroupRows?y+I*ne:y+_*this.visibleI+I*ne,re>-1&&!M.config.plotOptions.bar.rangeBarOverlap&&(G=M.globals.seriesRange[c][re].overlaps).indexOf(U)>-1&&(A=(_=R.barHeight/G.length)*this.visibleI+I*(100-parseInt(this.barOptions.barHeight,10))/100/2+_*(this.visibleI+G.indexOf(U))+I*ne)):(ne>-1&&!M.globals.timescaleLabels.length&&(r=M.config.plotOptions.bar.rangeBarGroupRows?b+E*ne:b+B*this.visibleI+E*ne),re>-1&&!M.config.plotOptions.bar.rangeBarOverlap&&(G=M.globals.seriesRange[c][re].overlaps).indexOf(U)>-1&&(r=(B=R.barWidth/G.length)*this.visibleI+E*(100-parseInt(this.barOptions.barWidth,10))/100/2+B*(this.visibleI+G.indexOf(U))+E*ne)),{barYPosition:A,barXPosition:r,barHeight:_,barWidth:B}}},{key:"drawRangeColumnPaths",value:function(s){var c=s.indexes,h=s.x,A=s.xDivision,r=s.barWidth,y=s.barXPosition,b=s.zeroH,_=this.w,B=c.i,I=c.j,E=c.realIndex,R=c.translationsIndex,M=this.yRatio[R],G=this.getRangeValue(E,I),U=Math.min(G.start,G.end),Q=Math.max(G.start,G.end);this.series[B][I]===void 0||this.series[B][I]===null?U=b:(U=b-U/M,Q=b-Q/M);var q=Math.abs(Q-U),ne=this.barHelpers.getColumnPaths({barXPosition:y,barWidth:r,y1:U,y2:Q,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,realIndex:E,i:E,j:I,w:_});if(_.globals.isXNumeric){var re=this.getBarXForNumericXAxis({x:h,j:I,realIndex:E,barWidth:r});h=re.x,y=re.barXPosition}else h+=A;return{pathTo:ne.pathTo,pathFrom:ne.pathFrom,barHeight:q,x:h,y:G.start<0&&G.end<0?U:Q,goalY:this.barHelpers.getGoalValues("y",null,b,B,I,R),barXPosition:y}}},{key:"preventBarOverflow",value:function(s){var c=this.w;return s<0&&(s=0),s>c.globals.gridWidth&&(s=c.globals.gridWidth),s}},{key:"drawRangeBarPaths",value:function(s){var c=s.indexes,h=s.y,A=s.y1,r=s.y2,y=s.yDivision,b=s.barHeight,_=s.barYPosition,B=s.zeroW,I=this.w,E=c.realIndex,R=c.j,M=this.preventBarOverflow(B+A/this.invertedYRatio),G=this.preventBarOverflow(B+r/this.invertedYRatio),U=this.getRangeValue(E,R),Q=Math.abs(G-M),q=this.barHelpers.getBarpaths({barYPosition:_,barHeight:b,x1:M,x2:G,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,i:E,realIndex:E,j:R,w:I});return I.globals.isXNumeric||(h+=y),{pathTo:q.pathTo,pathFrom:q.pathFrom,barWidth:Q,x:U.start<0&&U.end<0?M:G,goalX:this.barHelpers.getGoalValues("x",B,null,E,R),y:h}}},{key:"getRangeValue",value:function(s,c){var h=this.w;return{start:h.globals.seriesRangeStart[s][c],end:h.globals.seriesRangeEnd[s][c]}}}]),t}(),$D=function(){function a(e){en(this,a),this.w=e.w,this.lineCtx=e}return tn(a,[{key:"sameValueSeriesFix",value:function(e,t){var s=this.w;if((s.config.fill.type==="gradient"||s.config.fill.type[e]==="gradient")&&new sl(this.lineCtx.ctx,s).seriesHaveSameValues(e)){var c=t[e].slice();c[c.length-1]=c[c.length-1]+1e-6,t[e]=c}return t}},{key:"calculatePoints",value:function(e){var t=e.series,s=e.realIndex,c=e.x,h=e.y,A=e.i,r=e.j,y=e.prevY,b=this.w,_=[],B=[],I=this.lineCtx.categoryAxisCorrection+b.config.markers.offsetX;return b.globals.isXNumeric&&(I=(b.globals.seriesX[s][0]-b.globals.minX)/this.lineCtx.xRatio+b.config.markers.offsetX),r===0&&(_.push(I),B.push(ni.isNumber(t[A][0])?y+b.config.markers.offsetY:null)),_.push(c+b.config.markers.offsetX),B.push(ni.isNumber(t[A][r+1])?h+b.config.markers.offsetY:null),{x:_,y:B}}},{key:"checkPreviousPaths",value:function(e){for(var t=e.pathFromLine,s=e.pathFromArea,c=e.realIndex,h=this.w,A=0;A<h.globals.previousPaths.length;A++){var r=h.globals.previousPaths[A];(r.type==="line"||r.type==="area")&&r.paths.length>0&&parseInt(r.realIndex,10)===parseInt(c,10)&&(r.type==="line"?(this.lineCtx.appendPathFrom=!1,t=h.globals.previousPaths[A].paths[0].d):r.type==="area"&&(this.lineCtx.appendPathFrom=!1,s=h.globals.previousPaths[A].paths[0].d,h.config.stroke.show&&h.globals.previousPaths[A].paths[1]&&(t=h.globals.previousPaths[A].paths[1].d)))}return{pathFromLine:t,pathFromArea:s}}},{key:"determineFirstPrevY",value:function(e){var t,s,c,h=e.i,A=e.realIndex,r=e.series,y=e.prevY,b=e.lineYPosition,_=e.translationsIndex,B=this.w,I=B.config.chart.stacked&&!B.globals.comboCharts||B.config.chart.stacked&&B.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||((t=this.w.config.series[A])===null||t===void 0?void 0:t.type)==="bar"||((s=this.w.config.series[A])===null||s===void 0?void 0:s.type)==="column");if(((c=r[h])===null||c===void 0?void 0:c[0])!==void 0)y=(b=I&&h>0?this.lineCtx.prevSeriesY[h-1][0]:this.lineCtx.zeroY)-r[h][0]/this.lineCtx.yRatio[_]+2*(this.lineCtx.isReversed?r[h][0]/this.lineCtx.yRatio[_]:0);else if(I&&h>0&&r[h][0]===void 0){for(var E=h-1;E>=0;E--)if(r[E][0]!==null&&r[E][0]!==void 0){y=b=this.lineCtx.prevSeriesY[E][0];break}}return{prevY:y,lineYPosition:b}}}]),a}(),ZD=function(a){for(var e,t,s,c,h=function(_){for(var B=[],I=_[0],E=_[1],R=B[0]=gb(I,E),M=1,G=_.length-1;M<G;M++)I=E,E=_[M+1],B[M]=.5*(R+(R=gb(I,E)));return B[M]=R,B}(a),A=a.length-1,r=[],y=0;y<A;y++)s=gb(a[y],a[y+1]),Math.abs(s)<1e-6?h[y]=h[y+1]=0:(c=(e=h[y]/s)*e+(t=h[y+1]/s)*t)>9&&(c=3*s/Math.sqrt(c),h[y]=c*e,h[y+1]=c*t);for(var b=0;b<=A;b++)c=(a[Math.min(A,b+1)][0]-a[Math.max(0,b-1)][0])/(6*(1+h[b]*h[b])),r.push([c||0,h[b]*c||0]);return r},JD=function(a){var e=ZD(a),t=a[1],s=a[0],c=[],h=e[1],A=e[0];c.push(s,[s[0]+A[0],s[1]+A[1],t[0]-h[0],t[1]-h[1],t[0],t[1]]);for(var r=2,y=e.length;r<y;r++){var b=a[r],_=e[r];c.push([b[0]-_[0],b[1]-_[1],b[0],b[1]])}return c},eO=function(a,e,t){var s=a.slice(e,t);if(e){if(t-e>1&&s[1].length<6){var c=s[0].length;s[1]=[2*s[0][c-2]-s[0][c-4],2*s[0][c-1]-s[0][c-3]].concat(s[1])}s[0]=s[0].slice(-2)}return s};function gb(a,e){return(e[1]-a[1])/(e[0]-a[0])}var mb=function(){function a(e,t,s){en(this,a),this.ctx=e,this.w=e.w,this.xyRatios=t,this.pointsChart=!(this.w.config.chart.type!=="bubble"&&this.w.config.chart.type!=="scatter")||s,this.scatter=new gT(this.ctx),this.noNegatives=this.w.globals.minX===Number.MAX_VALUE,this.lineHelpers=new $D(this),this.markers=new wm(this.ctx),this.prevSeriesY=[],this.categoryAxisCorrection=0,this.yaxisIndex=0}return tn(a,[{key:"draw",value:function(e,t,s,c){var h,A=this.w,r=new hr(this.ctx),y=A.globals.comboCharts?t:A.config.chart.type,b=r.group({class:"apexcharts-".concat(y,"-series apexcharts-plot-series")}),_=new sl(this.ctx,A);this.yRatio=this.xyRatios.yRatio,this.zRatio=this.xyRatios.zRatio,this.xRatio=this.xyRatios.xRatio,this.baseLineY=this.xyRatios.baseLineY,e=_.getLogSeries(e),this.yRatio=_.getLogYRatios(this.yRatio),this.prevSeriesY=[];for(var B=[],I=0;I<e.length;I++){e=this.lineHelpers.sameValueSeriesFix(I,e);var E=A.globals.comboCharts?s[I]:I,R=this.yRatio.length>1?E:0;this._initSerieVariables(e,I,E);var M=[],G=[],U=[],Q=A.globals.padHorizontal+this.categoryAxisCorrection;this.ctx.series.addCollapsedClassToSeries(this.elSeries,E),A.globals.isXNumeric&&A.globals.seriesX.length>0&&(Q=(A.globals.seriesX[E][0]-A.globals.minX)/this.xRatio),U.push(Q);var q,ne=Q,re=void 0,pe=ne,Ae=this.zeroY,le=this.zeroY;Ae=this.lineHelpers.determineFirstPrevY({i:I,realIndex:E,series:e,prevY:Ae,lineYPosition:0,translationsIndex:R}).prevY,A.config.stroke.curve==="monotoneCubic"&&e[I][0]===null?M.push(null):M.push(Ae),q=Ae,y==="rangeArea"&&(re=le=this.lineHelpers.determineFirstPrevY({i:I,realIndex:E,series:c,prevY:le,lineYPosition:0,translationsIndex:R}).prevY,G.push(M[0]!==null?le:null));var be=this._calculatePathsFrom({type:y,series:e,i:I,realIndex:E,translationsIndex:R,prevX:pe,prevY:Ae,prevY2:le}),we=[M[0]],oe=[G[0]],me={type:y,series:e,realIndex:E,translationsIndex:R,i:I,x:Q,y:1,pX:ne,pY:q,pathsFrom:be,linePaths:[],areaPaths:[],seriesIndex:s,lineYPosition:0,xArrj:U,yArrj:M,y2Arrj:G,seriesRangeEnd:c},Le=this._iterateOverDataPoints(Ir(Ir({},me),{},{iterations:y==="rangeArea"?e[I].length-1:void 0,isRangeStart:!0}));if(y==="rangeArea"){for(var Se=this._calculatePathsFrom({series:c,i:I,realIndex:E,prevX:pe,prevY:le}),Me=this._iterateOverDataPoints(Ir(Ir({},me),{},{series:c,xArrj:[Q],yArrj:we,y2Arrj:oe,pY:re,areaPaths:Le.areaPaths,pathsFrom:Se,iterations:c[I].length-1,isRangeStart:!1})),Re=Le.linePaths.length/2,Ze=0;Ze<Re;Ze++)Le.linePaths[Ze]=Me.linePaths[Ze+Re]+Le.linePaths[Ze];Le.linePaths.splice(Re),Le.pathFromLine=Me.pathFromLine+Le.pathFromLine}else Le.pathFromArea+="z";this._handlePaths({type:y,realIndex:E,i:I,paths:Le}),this.elSeries.add(this.elPointsMain),this.elSeries.add(this.elDataLabelsWrap),B.push(this.elSeries)}if(((h=A.config.series[0])===null||h===void 0?void 0:h.zIndex)!==void 0&&B.sort(function(Qe,It){return Number(Qe.node.getAttribute("zIndex"))-Number(It.node.getAttribute("zIndex"))}),A.config.chart.stacked)for(var $e=B.length-1;$e>=0;$e--)b.add(B[$e]);else for(var ct=0;ct<B.length;ct++)b.add(B[ct]);return b}},{key:"_initSerieVariables",value:function(e,t,s){var c=this.w,h=new hr(this.ctx);this.xDivision=c.globals.gridWidth/(c.globals.dataPoints-(c.config.xaxis.tickPlacement==="on"?1:0)),this.strokeWidth=Array.isArray(c.config.stroke.width)?c.config.stroke.width[s]:c.config.stroke.width;var A=0;if(this.yRatio.length>1&&(this.yaxisIndex=c.globals.seriesYAxisReverseMap[s],A=s),this.isReversed=c.config.yaxis[this.yaxisIndex]&&c.config.yaxis[this.yaxisIndex].reversed,this.zeroY=c.globals.gridHeight-this.baseLineY[A]-(this.isReversed?c.globals.gridHeight:0)+(this.isReversed?2*this.baseLineY[A]:0),this.areaBottomY=this.zeroY,(this.zeroY>c.globals.gridHeight||c.config.plotOptions.area.fillTo==="end")&&(this.areaBottomY=c.globals.gridHeight),this.categoryAxisCorrection=this.xDivision/2,this.elSeries=h.group({class:"apexcharts-series",zIndex:c.config.series[s].zIndex!==void 0?c.config.series[s].zIndex:s,seriesName:ni.escapeString(c.globals.seriesNames[s])}),this.elPointsMain=h.group({class:"apexcharts-series-markers-wrap","data:realIndex":s}),c.globals.hasNullValues){var r=this.markers.plotChartMarkers({pointsPos:{x:[0],y:[c.globals.gridHeight+c.globals.markers.largestSize]},seriesIndex:t,j:0,pSize:.1,alwaysDrawMarker:!0,isVirtualPoint:!0});r!==null&&this.elPointsMain.add(r)}this.elDataLabelsWrap=h.group({class:"apexcharts-datalabels","data:realIndex":s});var y=e[t].length===c.globals.dataPoints;this.elSeries.attr({"data:longestSeries":y,rel:t+1,"data:realIndex":s}),this.appendPathFrom=!0}},{key:"_calculatePathsFrom",value:function(e){var t,s,c,h,A=e.type,r=e.series,y=e.i,b=e.realIndex,_=e.translationsIndex,B=e.prevX,I=e.prevY,E=e.prevY2,R=this.w,M=new hr(this.ctx);if(r[y][0]===null){for(var G=0;G<r[y].length;G++)if(r[y][G]!==null){B=this.xDivision*G,I=this.zeroY-r[y][G]/this.yRatio[_],t=M.move(B,I),s=M.move(B,this.areaBottomY);break}}else t=M.move(B,I),A==="rangeArea"&&(t=M.move(B,E)+M.line(B,I)),s=M.move(B,this.areaBottomY)+M.line(B,I);if(c=M.move(0,this.areaBottomY)+M.line(0,this.areaBottomY),h=M.move(0,this.areaBottomY)+M.line(0,this.areaBottomY),R.globals.previousPaths.length>0){var U=this.lineHelpers.checkPreviousPaths({pathFromLine:c,pathFromArea:h,realIndex:b});c=U.pathFromLine,h=U.pathFromArea}return{prevX:B,prevY:I,linePath:t,areaPath:s,pathFromLine:c,pathFromArea:h}}},{key:"_handlePaths",value:function(e){var t=e.type,s=e.realIndex,c=e.i,h=e.paths,A=this.w,r=new hr(this.ctx),y=new qd(this.ctx);this.prevSeriesY.push(h.yArrj),A.globals.seriesXvalues[s]=h.xArrj,A.globals.seriesYvalues[s]=h.yArrj;var b=A.config.forecastDataPoints;if(b.count>0&&t!=="rangeArea"){var _=A.globals.seriesXvalues[s][A.globals.seriesXvalues[s].length-b.count-1],B=r.drawRect(_,0,A.globals.gridWidth,A.globals.gridHeight,0);A.globals.dom.elForecastMask.appendChild(B.node);var I=r.drawRect(0,0,_,A.globals.gridHeight,0);A.globals.dom.elNonForecastMask.appendChild(I.node)}this.pointsChart||A.globals.delayedElements.push({el:this.elPointsMain.node,index:s});var E={i:c,realIndex:s,animationDelay:c,initialSpeed:A.config.chart.animations.speed,dataChangeSpeed:A.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(t)};if(t==="area")for(var R=y.fillPath({seriesNumber:s}),M=0;M<h.areaPaths.length;M++){var G=r.renderPaths(Ir(Ir({},E),{},{pathFrom:h.pathFromArea,pathTo:h.areaPaths[M],stroke:"none",strokeWidth:0,strokeLineCap:null,fill:R}));this.elSeries.add(G)}if(A.config.stroke.show&&!this.pointsChart){var U=null;if(t==="line")U=y.fillPath({seriesNumber:s,i:c});else if(A.config.stroke.fill.type==="solid")U=A.globals.stroke.colors[s];else{var Q=A.config.fill;A.config.fill=A.config.stroke.fill,U=y.fillPath({seriesNumber:s,i:c}),A.config.fill=Q}for(var q=0;q<h.linePaths.length;q++){var ne=U;t==="rangeArea"&&(ne=y.fillPath({seriesNumber:s}));var re=Ir(Ir({},E),{},{pathFrom:h.pathFromLine,pathTo:h.linePaths[q],stroke:U,strokeWidth:this.strokeWidth,strokeLineCap:A.config.stroke.lineCap,fill:t==="rangeArea"?ne:"none"}),pe=r.renderPaths(re);if(this.elSeries.add(pe),pe.attr("fill-rule","evenodd"),b.count>0&&t!=="rangeArea"){var Ae=r.renderPaths(re);Ae.node.setAttribute("stroke-dasharray",b.dashArray),b.strokeWidth&&Ae.node.setAttribute("stroke-width",b.strokeWidth),this.elSeries.add(Ae),Ae.attr("clip-path","url(#forecastMask".concat(A.globals.cuid,")")),pe.attr("clip-path","url(#nonForecastMask".concat(A.globals.cuid,")"))}}}}},{key:"_iterateOverDataPoints",value:function(e){var t,s,c=this,h=e.type,A=e.series,r=e.iterations,y=e.realIndex,b=e.translationsIndex,_=e.i,B=e.x,I=e.y,E=e.pX,R=e.pY,M=e.pathsFrom,G=e.linePaths,U=e.areaPaths,Q=e.seriesIndex,q=e.lineYPosition,ne=e.xArrj,re=e.yArrj,pe=e.y2Arrj,Ae=e.isRangeStart,le=e.seriesRangeEnd,be=this.w,we=new hr(this.ctx),oe=this.yRatio,me=M.prevY,Le=M.linePath,Se=M.areaPath,Me=M.pathFromLine,Re=M.pathFromArea,Ze=ni.isNumber(be.globals.minYArr[y])?be.globals.minYArr[y]:be.globals.minY;r||(r=be.globals.dataPoints>1?be.globals.dataPoints-1:be.globals.dataPoints);var $e=function(vt,Gt){return Gt-vt/oe[b]+2*(c.isReversed?vt/oe[b]:0)},ct=I,Qe=be.config.chart.stacked&&!be.globals.comboCharts||be.config.chart.stacked&&be.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||((t=this.w.config.series[y])===null||t===void 0?void 0:t.type)==="bar"||((s=this.w.config.series[y])===null||s===void 0?void 0:s.type)==="column"),It=be.config.stroke.curve;Array.isArray(It)&&(It=Array.isArray(Q)?It[Q[_]]:It[_]);for(var Ce,Je=0,lt=0;lt<r&&A[_].length!==0;lt++){var mt=A[_][lt+1]===void 0||A[_][lt+1]===null;if(be.globals.isXNumeric){var Bt=be.globals.seriesX[y][lt+1];be.globals.seriesX[y][lt+1]===void 0&&(Bt=be.globals.seriesX[y][r-1]),B=(Bt-be.globals.minX)/this.xRatio}else B+=this.xDivision;Qe?_>0&&be.globals.collapsedSeries.length<be.config.series.length-1?q=this.prevSeriesY[function(vt){for(var Gt=vt;Gt>0;Gt--){if(!(be.globals.collapsedSeriesIndices.indexOf((Q==null?void 0:Q[Gt])||Gt)>-1))return Gt;Gt--}return 0}(_-1)][lt+1]:q=this.zeroY:q=this.zeroY,mt?I=$e(Ze,q):(I=$e(A[_][lt+1],q),h==="rangeArea"&&(ct=$e(le[_][lt+1],q))),ne.push(A[_][lt+1]===null?null:B),!mt||be.config.stroke.curve!=="smooth"&&be.config.stroke.curve!=="monotoneCubic"?(re.push(I),pe.push(ct)):(re.push(null),pe.push(null));var rt=this.lineHelpers.calculatePoints({series:A,x:B,y:I,realIndex:y,i:_,j:lt,prevY:me}),St=this._createPaths({type:h,series:A,i:_,realIndex:y,j:lt,x:B,y:I,y2:ct,xArrj:ne,yArrj:re,y2Arrj:pe,pX:E,pY:R,pathState:Je,segmentStartX:Ce,linePath:Le,areaPath:Se,linePaths:G,areaPaths:U,curve:It,isRangeStart:Ae});U=St.areaPaths,G=St.linePaths,E=St.pX,R=St.pY,Je=St.pathState,Ce=St.segmentStartX,Se=St.areaPath,Le=St.linePath,!this.appendPathFrom||be.globals.hasNullValues||It==="monotoneCubic"&&h==="rangeArea"||(Me+=we.line(B,this.areaBottomY),Re+=we.line(B,this.areaBottomY)),this.handleNullDataPoints(A,rt,_,lt,y),this._handleMarkersAndLabels({type:h,pointsPos:rt,i:_,j:lt,realIndex:y,isRangeStart:Ae})}return{yArrj:re,xArrj:ne,pathFromArea:Re,areaPaths:U,pathFromLine:Me,linePaths:G,linePath:Le,areaPath:Se}}},{key:"_handleMarkersAndLabels",value:function(e){var t=e.type,s=e.pointsPos,c=e.isRangeStart,h=e.i,A=e.j,r=e.realIndex,y=this.w,b=new pm(this.ctx);if(this.pointsChart)this.scatter.draw(this.elSeries,A,{realIndex:r,pointsPos:s,zRatio:this.zRatio,elParent:this.elPointsMain});else{y.globals.series[h].length>1&&this.elPointsMain.node.classList.add("apexcharts-element-hidden");var _=this.markers.plotChartMarkers({pointsPos:s,seriesIndex:r,j:A+1});_!==null&&this.elPointsMain.add(_)}var B=b.drawDataLabel({type:t,isRangeStart:c,pos:s,i:r,j:A+1});B!==null&&this.elDataLabelsWrap.add(B)}},{key:"_createPaths",value:function(e){var t=e.type,s=e.series,c=e.i;e.realIndex;var h,A=e.j,r=e.x,y=e.y,b=e.xArrj,_=e.yArrj,B=e.y2,I=e.y2Arrj,E=e.pX,R=e.pY,M=e.pathState,G=e.segmentStartX,U=e.linePath,Q=e.areaPath,q=e.linePaths,ne=e.areaPaths,re=e.curve,pe=e.isRangeStart,Ae=new hr(this.ctx),le=this.areaBottomY,be=t==="rangeArea",we=t==="rangeArea"&&pe;switch(re){case"monotoneCubic":var oe=pe?_:I;switch(M){case 0:if(oe[A+1]===null)break;M=1;case 1:if(!(be?b.length===s[c].length:A===s[c].length-2))break;case 2:var me=pe?b:b.slice().reverse(),Le=pe?oe:oe.slice().reverse(),Se=(h=Le,me.map(function(Bt,rt){return[Bt,h[rt]]}).filter(function(Bt){return Bt[1]!==null})),Me=Se.length>1?JD(Se):Se,Re=[];be&&(we?ne=Se:Re=ne.reverse());var Ze=0,$e=0;if(function(Bt,rt){for(var St=function(ze){var Ve=[],kt=0;return ze.forEach(function(Ft){Ft!==null?kt++:kt>0&&(Ve.push(kt),kt=0)}),kt>0&&Ve.push(kt),Ve}(Bt),vt=[],Gt=0,mi=0;Gt<St.length;mi+=St[Gt++])vt[Gt]=eO(rt,mi,mi+St[Gt]);return vt}(Le,Me).forEach(function(Bt){Ze++;var rt=function(Gt){for(var mi="",ze=0;ze<Gt.length;ze++){var Ve=Gt[ze],kt=Ve.length;kt>4?(mi+="C".concat(Ve[0],", ").concat(Ve[1]),mi+=", ".concat(Ve[2],", ").concat(Ve[3]),mi+=", ".concat(Ve[4],", ").concat(Ve[5])):kt>2&&(mi+="S".concat(Ve[0],", ").concat(Ve[1]),mi+=", ".concat(Ve[2],", ").concat(Ve[3]))}return mi}(Bt),St=$e,vt=($e+=Bt.length)-1;we?U=Ae.move(Se[St][0],Se[St][1])+rt:be?U=Ae.move(Re[St][0],Re[St][1])+Ae.line(Se[St][0],Se[St][1])+rt+Ae.line(Re[vt][0],Re[vt][1]):(U=Ae.move(Se[St][0],Se[St][1])+rt,Q=U+Ae.line(Se[vt][0],le)+Ae.line(Se[St][0],le)+"z",ne.push(Q)),q.push(U)}),be&&Ze>1&&!we){var ct=q.slice(Ze).reverse();q.splice(Ze),ct.forEach(function(Bt){return q.push(Bt)})}M=0}break;case"smooth":var Qe=.35*(r-E);if(s[c][A]===null)M=0;else switch(M){case 0:if(G=E,U=we?Ae.move(E,I[A])+Ae.line(E,R):Ae.move(E,R),Q=Ae.move(E,R),s[c][A+1]===null||s[c][A+1]===void 0){q.push(U),ne.push(Q);break}if(M=1,A<s[c].length-2){var It=Ae.curve(E+Qe,R,r-Qe,y,r,y);U+=It,Q+=It;break}case 1:if(s[c][A+1]===null)U+=we?Ae.line(E,B):Ae.move(E,R),Q+=Ae.line(E,le)+Ae.line(G,le)+"z",q.push(U),ne.push(Q),M=-1;else{var Ce=Ae.curve(E+Qe,R,r-Qe,y,r,y);U+=Ce,Q+=Ce,A>=s[c].length-2&&(we&&(U+=Ae.curve(r,y,r,y,r,B)+Ae.move(r,B)),Q+=Ae.curve(r,y,r,y,r,le)+Ae.line(G,le)+"z",q.push(U),ne.push(Q),M=-1)}}E=r,R=y;break;default:var Je=function(Bt,rt,St){var vt=[];switch(Bt){case"stepline":vt=Ae.line(rt,null,"H")+Ae.line(null,St,"V");break;case"linestep":vt=Ae.line(null,St,"V")+Ae.line(rt,null,"H");break;case"straight":vt=Ae.line(rt,St)}return vt};if(s[c][A]===null)M=0;else switch(M){case 0:if(G=E,U=we?Ae.move(E,I[A])+Ae.line(E,R):Ae.move(E,R),Q=Ae.move(E,R),s[c][A+1]===null||s[c][A+1]===void 0){q.push(U),ne.push(Q);break}if(M=1,A<s[c].length-2){var lt=Je(re,r,y);U+=lt,Q+=lt;break}case 1:if(s[c][A+1]===null)U+=we?Ae.line(E,B):Ae.move(E,R),Q+=Ae.line(E,le)+Ae.line(G,le)+"z",q.push(U),ne.push(Q),M=-1;else{var mt=Je(re,r,y);U+=mt,Q+=mt,A>=s[c].length-2&&(we&&(U+=Ae.line(r,B)),Q+=Ae.line(r,le)+Ae.line(G,le)+"z",q.push(U),ne.push(Q),M=-1)}}E=r,R=y}return{linePaths:q,areaPaths:ne,pX:E,pY:R,pathState:M,segmentStartX:G,linePath:U,areaPath:Q}}},{key:"handleNullDataPoints",value:function(e,t,s,c,h){var A=this.w;if(e[s][c]===null&&A.config.markers.showNullDataPoints||e[s].length===1){var r=this.strokeWidth-A.config.markers.strokeWidth/2;r>0||(r=0);var y=this.markers.plotChartMarkers({pointsPos:t,seriesIndex:h,j:c+1,pSize:r,alwaysDrawMarker:!0});y!==null&&this.elPointsMain.add(y)}}}]),a}();window.TreemapSquared={},window.TreemapSquared.generate=function(){function a(r,y,b,_){this.xoffset=r,this.yoffset=y,this.height=_,this.width=b,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(B){var I,E=[],R=this.xoffset,M=this.yoffset,G=h(B)/this.height,U=h(B)/this.width;if(this.width>=this.height)for(I=0;I<B.length;I++)E.push([R,M,R+G,M+B[I]/G]),M+=B[I]/G;else for(I=0;I<B.length;I++)E.push([R,M,R+B[I]/U,M+U]),R+=B[I]/U;return E},this.cutArea=function(B){var I;if(this.width>=this.height){var E=B/this.height,R=this.width-E;I=new a(this.xoffset+E,this.yoffset,R,this.height)}else{var M=B/this.width,G=this.height-M;I=new a(this.xoffset,this.yoffset+M,this.width,G)}return I}}function e(r,y,b,_,B){_=_===void 0?0:_,B=B===void 0?0:B;var I=t(function(E,R){var M,G=[],U=R/h(E);for(M=0;M<E.length;M++)G[M]=E[M]*U;return G}(r,y*b),[],new a(_,B,y,b),[]);return function(E){var R,M,G=[];for(R=0;R<E.length;R++)for(M=0;M<E[R].length;M++)G.push(E[R][M]);return G}(I)}function t(r,y,b,_){var B,I,E;if(r.length!==0)return B=b.shortestEdge(),function(R,M,G){var U;if(R.length===0)return!0;(U=R.slice()).push(M);var Q=s(R,G),q=s(U,G);return Q>=q}(y,I=r[0],B)?(y.push(I),t(r.slice(1),y,b,_)):(E=b.cutArea(h(y),_),_.push(b.getCoordinates(y)),t(r,[],E,_)),_;_.push(b.getCoordinates(y))}function s(r,y){var b=Math.min.apply(Math,r),_=Math.max.apply(Math,r),B=h(r);return Math.max(Math.pow(y,2)*_/Math.pow(B,2),Math.pow(B,2)/(Math.pow(y,2)*b))}function c(r){return r&&r.constructor===Array}function h(r){var y,b=0;for(y=0;y<r.length;y++)b+=r[y];return b}function A(r){var y,b=0;if(c(r[0]))for(y=0;y<r.length;y++)b+=A(r[y]);else b=h(r);return b}return function r(y,b,_,B,I){B=B===void 0?0:B,I=I===void 0?0:I;var E,R,M=[],G=[];if(c(y[0])){for(R=0;R<y.length;R++)M[R]=A(y[R]);for(E=e(M,b,_,B,I),R=0;R<y.length;R++)G.push(r(y[R],E[R][2]-E[R][0],E[R][3]-E[R][1],E[R][0],E[R][1]))}else G=e(y,b,_,B,I);return G}}();var tO=function(){function a(e,t){en(this,a),this.ctx=e,this.w=e.w,this.strokeWidth=this.w.config.stroke.width,this.helpers=new wT(e),this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.labels=[]}return tn(a,[{key:"draw",value:function(e){var t=this,s=this.w,c=new hr(this.ctx),h=new qd(this.ctx),A=c.group({class:"apexcharts-treemap"});if(s.globals.noData)return A;var r=[];return e.forEach(function(y){var b=y.map(function(_){return Math.abs(_)});r.push(b)}),this.negRange=this.helpers.checkColorRange(),s.config.series.forEach(function(y,b){y.data.forEach(function(_){Array.isArray(t.labels[b])||(t.labels[b]=[]),t.labels[b].push(_.x)})}),window.TreemapSquared.generate(r,s.globals.gridWidth,s.globals.gridHeight).forEach(function(y,b){var _=c.group({class:"apexcharts-series apexcharts-treemap-series",seriesName:ni.escapeString(s.globals.seriesNames[b]),rel:b+1,"data:realIndex":b});if(s.config.chart.dropShadow.enabled){var B=s.config.chart.dropShadow;new Uc(t.ctx).dropShadow(A,B,b)}var I=c.group({class:"apexcharts-data-labels"}),E={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0};y.forEach(function(Me,Re){var Ze=Me[0],$e=Me[1],ct=Me[2],Qe=Me[3];E.xMin=Math.min(E.xMin,Ze),E.yMin=Math.min(E.yMin,$e),E.xMax=Math.max(E.xMax,ct),E.yMax=Math.max(E.yMax,Qe);var It=t.helpers.getShadeColor(s.config.chart.type,b,Re,t.negRange),Ce=It.color,Je=h.fillPath({color:Ce,seriesNumber:b,dataPointIndex:Re}),lt=c.drawRect(Ze,$e,ct-Ze,Qe-$e,s.config.plotOptions.treemap.borderRadius,"#fff",1,t.strokeWidth,s.config.plotOptions.treemap.useFillColorAsStroke?Ce:s.globals.stroke.colors[b]);lt.attr({cx:Ze,cy:$e,index:b,i:b,j:Re,width:ct-Ze,height:Qe-$e,fill:Je}),lt.node.classList.add("apexcharts-treemap-rect"),t.helpers.addListeners(lt);var mt={x:Ze+(ct-Ze)/2,y:$e+(Qe-$e)/2,width:0,height:0},Bt={x:Ze,y:$e,width:ct-Ze,height:Qe-$e};if(s.config.chart.animations.enabled&&!s.globals.dataChanged){var rt=1;s.globals.resized||(rt=s.config.chart.animations.speed),t.animateTreemap(lt,mt,Bt,rt)}if(s.globals.dataChanged){var St=1;t.dynamicAnim.enabled&&s.globals.shouldAnimate&&(St=t.dynamicAnim.speed,s.globals.previousPaths[b]&&s.globals.previousPaths[b][Re]&&s.globals.previousPaths[b][Re].rect&&(mt=s.globals.previousPaths[b][Re].rect),t.animateTreemap(lt,mt,Bt,St))}var vt=t.getFontSize(Me),Gt=s.config.dataLabels.formatter(t.labels[b][Re],{value:s.globals.series[b][Re],seriesIndex:b,dataPointIndex:Re,w:s});s.config.plotOptions.treemap.dataLabels.format==="truncate"&&(vt=parseInt(s.config.dataLabels.style.fontSize,10),Gt=t.truncateLabels(Gt,vt,Ze,$e,ct,Qe));var mi=null;s.globals.series[b][Re]&&(mi=t.helpers.calculateDataLabels({text:Gt,x:(Ze+ct)/2,y:($e+Qe)/2+t.strokeWidth/2+vt/3,i:b,j:Re,colorProps:It,fontSize:vt,series:e})),s.config.dataLabels.enabled&&mi&&t.rotateToFitLabel(mi,vt,Gt,Ze,$e,ct,Qe),_.add(lt),mi!==null&&_.add(mi)});var R=s.config.plotOptions.treemap.seriesTitle;if(s.config.series.length>1&&R&&R.show){var M=s.config.series[b].name||"";if(M&&E.xMin<1/0&&E.yMin<1/0){var G=R.offsetX,U=R.offsetY,Q=R.borderColor,q=R.borderWidth,ne=R.borderRadius,re=R.style,pe=re.color||s.config.chart.foreColor,Ae={left:re.padding.left,right:re.padding.right,top:re.padding.top,bottom:re.padding.bottom},le=c.getTextRects(M,re.fontSize,re.fontFamily),be=le.width+Ae.left+Ae.right,we=le.height+Ae.top+Ae.bottom,oe=E.xMin+(G||0),me=E.yMin+(U||0),Le=c.drawRect(oe,me,be,we,ne,re.background,1,q,Q),Se=c.drawText({x:oe+Ae.left,y:me+Ae.top+.75*le.height,text:M,fontSize:re.fontSize,fontFamily:re.fontFamily,fontWeight:re.fontWeight,foreColor:pe,cssClass:re.cssClass||""});_.add(Le),_.add(Se)}}_.add(I),A.add(_)}),A}},{key:"getFontSize",value:function(e){var t=this.w,s=function c(h){var A,r=0;if(Array.isArray(h[0]))for(A=0;A<h.length;A++)r+=c(h[A]);else for(A=0;A<h.length;A++)r+=h[A].length;return r}(this.labels)/function c(h){var A,r=0;if(Array.isArray(h[0]))for(A=0;A<h.length;A++)r+=c(h[A]);else for(A=0;A<h.length;A++)r+=1;return r}(this.labels);return function(c,h){var A=c*h,r=Math.pow(A,.5);return Math.min(r/s,parseInt(t.config.dataLabels.style.fontSize,10))}(e[2]-e[0],e[3]-e[1])}},{key:"rotateToFitLabel",value:function(e,t,s,c,h,A,r){var y=new hr(this.ctx),b=y.getTextRects(s,t);if(b.width+this.w.config.stroke.width+5>A-c&&b.width<=r-h){var _=y.rotateAroundCenter(e.node);e.node.setAttribute("transform","rotate(-90 ".concat(_.x," ").concat(_.y,") translate(").concat(b.height/3,")"))}}},{key:"truncateLabels",value:function(e,t,s,c,h,A){var r=new hr(this.ctx),y=r.getTextRects(e,t).width+this.w.config.stroke.width+5>h-s&&A-c>h-s?A-c:h-s,b=r.getTextBasedOnMaxWidth({text:e,maxWidth:y,fontSize:t});return e.length!==b.length&&y/t<5?"":b}},{key:"animateTreemap",value:function(e,t,s,c){var h=new vm(this.ctx);h.animateRect(e,t,s,c,function(){h.animationCompleted(e)})}}]),a}(),ST=86400,iO=10/ST,rO=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w,this.timeScaleArray=[],this.utc=this.w.config.xaxis.labels.datetimeUTC}return tn(a,[{key:"calculateTimeScaleTicks",value:function(e,t){var s=this,c=this.w;if(c.globals.allSeriesCollapsed)return c.globals.labels=[],c.globals.timescaleLabels=[],[];var h=new Oc(this.ctx),A=(t-e)/864e5;this.determineInterval(A),c.globals.disableZoomIn=!1,c.globals.disableZoomOut=!1,A<iO?c.globals.disableZoomIn=!0:A>5e4&&(c.globals.disableZoomOut=!0);var r=h.getTimeUnitsfromTimestamp(e,t,this.utc),y=c.globals.gridWidth/A,b=y/24,_=b/60,B=_/60,I=Math.floor(24*A),E=Math.floor(1440*A),R=Math.floor(A*ST),M=Math.floor(A),G=Math.floor(A/30),U=Math.floor(A/365),Q={minMillisecond:r.minMillisecond,minSecond:r.minSecond,minMinute:r.minMinute,minHour:r.minHour,minDate:r.minDate,minMonth:r.minMonth,minYear:r.minYear},q={firstVal:Q,currentMillisecond:Q.minMillisecond,currentSecond:Q.minSecond,currentMinute:Q.minMinute,currentHour:Q.minHour,currentMonthDate:Q.minDate,currentDate:Q.minDate,currentMonth:Q.minMonth,currentYear:Q.minYear,daysWidthOnXAxis:y,hoursWidthOnXAxis:b,minutesWidthOnXAxis:_,secondsWidthOnXAxis:B,numberOfSeconds:R,numberOfMinutes:E,numberOfHours:I,numberOfDays:M,numberOfMonths:G,numberOfYears:U};switch(this.tickInterval){case"years":this.generateYearScale(q);break;case"months":case"half_year":this.generateMonthScale(q);break;case"months_days":case"months_fortnight":case"days":case"week_days":this.generateDayScale(q);break;case"hours":this.generateHourScale(q);break;case"minutes_fives":case"minutes":this.generateMinuteScale(q);break;case"seconds_tens":case"seconds_fives":case"seconds":this.generateSecondScale(q)}var ne=this.timeScaleArray.map(function(re){var pe={position:re.position,unit:re.unit,year:re.year,day:re.day?re.day:1,hour:re.hour?re.hour:0,month:re.month+1};return re.unit==="month"?Ir(Ir({},pe),{},{day:1,value:re.value+1}):re.unit==="day"||re.unit==="hour"?Ir(Ir({},pe),{},{value:re.value}):re.unit==="minute"?Ir(Ir({},pe),{},{value:re.value,minute:re.value}):re.unit==="second"?Ir(Ir({},pe),{},{value:re.value,minute:re.minute,second:re.second}):re});return ne.filter(function(re){var pe=1,Ae=Math.ceil(c.globals.gridWidth/120),le=re.value;c.config.xaxis.tickAmount!==void 0&&(Ae=c.config.xaxis.tickAmount),ne.length>Ae&&(pe=Math.floor(ne.length/Ae));var be=!1,we=!1;switch(s.tickInterval){case"years":re.unit==="year"&&(be=!0);break;case"half_year":pe=7,re.unit==="year"&&(be=!0);break;case"months":pe=1,re.unit==="year"&&(be=!0);break;case"months_fortnight":pe=15,re.unit!=="year"&&re.unit!=="month"||(be=!0),le===30&&(we=!0);break;case"months_days":pe=10,re.unit==="month"&&(be=!0),le===30&&(we=!0);break;case"week_days":pe=8,re.unit==="month"&&(be=!0);break;case"days":pe=1,re.unit==="month"&&(be=!0);break;case"hours":re.unit==="day"&&(be=!0);break;case"minutes_fives":case"seconds_fives":le%5!=0&&(we=!0);break;case"seconds_tens":le%10!=0&&(we=!0)}if(s.tickInterval==="hours"||s.tickInterval==="minutes_fives"||s.tickInterval==="seconds_tens"||s.tickInterval==="seconds_fives"){if(!we)return!0}else if((le%pe==0||be)&&!we)return!0})}},{key:"recalcDimensionsBasedOnFormat",value:function(e,t){var s=this.w,c=this.formatDates(e),h=this.removeOverlappingTS(c);s.globals.timescaleLabels=h.slice(),new K0(this.ctx).plotCoords()}},{key:"determineInterval",value:function(e){var t=24*e,s=60*t;switch(!0){case e/365>5:this.tickInterval="years";break;case e>800:this.tickInterval="half_year";break;case e>180:this.tickInterval="months";break;case e>90:this.tickInterval="months_fortnight";break;case e>60:this.tickInterval="months_days";break;case e>30:this.tickInterval="week_days";break;case e>2:this.tickInterval="days";break;case t>2.4:this.tickInterval="hours";break;case s>15:this.tickInterval="minutes_fives";break;case s>5:this.tickInterval="minutes";break;case s>1:this.tickInterval="seconds_tens";break;case 60*s>20:this.tickInterval="seconds_fives";break;default:this.tickInterval="seconds"}}},{key:"generateYearScale",value:function(e){var t=e.firstVal,s=e.currentMonth,c=e.currentYear,h=e.daysWidthOnXAxis,A=e.numberOfYears,r=t.minYear,y=0,b=new Oc(this.ctx),_="year";if(t.minDate>1||t.minMonth>0){var B=b.determineRemainingDaysOfYear(t.minYear,t.minMonth,t.minDate);y=(b.determineDaysOfYear(t.minYear)-B+1)*h,r=t.minYear+1,this.timeScaleArray.push({position:y,value:r,unit:_,year:r,month:ni.monthMod(s+1)})}else t.minDate===1&&t.minMonth===0&&this.timeScaleArray.push({position:y,value:r,unit:_,year:c,month:ni.monthMod(s+1)});for(var I=r,E=y,R=0;R<A;R++)I++,E=b.determineDaysOfYear(I-1)*h+E,this.timeScaleArray.push({position:E,value:I,unit:_,year:I,month:1})}},{key:"generateMonthScale",value:function(e){var t=e.firstVal,s=e.currentMonthDate,c=e.currentMonth,h=e.currentYear,A=e.daysWidthOnXAxis,r=e.numberOfMonths,y=c,b=0,_=new Oc(this.ctx),B="month",I=0;if(t.minDate>1){b=(_.determineDaysOfMonths(c+1,t.minYear)-s+1)*A,y=ni.monthMod(c+1);var E=h+I,R=ni.monthMod(y),M=y;y===0&&(B="year",M=E,R=1,E+=I+=1),this.timeScaleArray.push({position:b,value:M,unit:B,year:E,month:R})}else this.timeScaleArray.push({position:b,value:y,unit:B,year:h,month:ni.monthMod(c)});for(var G=y+1,U=b,Q=0,q=1;Q<r;Q++,q++){(G=ni.monthMod(G))===0?(B="year",I+=1):B="month";var ne=this._getYear(h,G,I);U=_.determineDaysOfMonths(G,ne)*A+U;var re=G===0?ne:G;this.timeScaleArray.push({position:U,value:re,unit:B,year:ne,month:G===0?1:G}),G++}}},{key:"generateDayScale",value:function(e){var t=e.firstVal,s=e.currentMonth,c=e.currentYear,h=e.hoursWidthOnXAxis,A=e.numberOfDays,r=new Oc(this.ctx),y="day",b=t.minDate+1,_=b,B=function(q,ne,re){return q>r.determineDaysOfMonths(ne+1,re)&&(_=1,y="month",E=ne+=1),ne},I=(24-t.minHour)*h,E=b,R=B(_,s,c);t.minHour===0&&t.minDate===1?(I=0,E=ni.monthMod(t.minMonth),y="month",_=t.minDate):t.minDate!==1&&t.minHour===0&&t.minMinute===0&&(I=0,b=t.minDate,E=b,R=B(_=b,s,c),E!==1&&(y="day")),this.timeScaleArray.push({position:I,value:E,unit:y,year:this._getYear(c,R,0),month:ni.monthMod(R),day:_});for(var M=I,G=0;G<A;G++){y="day",R=B(_+=1,R,this._getYear(c,R,0));var U=this._getYear(c,R,0);M=24*h+M;var Q=_===1?ni.monthMod(R):_;this.timeScaleArray.push({position:M,value:Q,unit:y,year:U,month:ni.monthMod(R),day:Q})}}},{key:"generateHourScale",value:function(e){var t=e.firstVal,s=e.currentDate,c=e.currentMonth,h=e.currentYear,A=e.minutesWidthOnXAxis,r=e.numberOfHours,y=new Oc(this.ctx),b="hour",_=function(pe,Ae){return pe>y.determineDaysOfMonths(Ae+1,h)&&(G=1,Ae+=1),{month:Ae,date:G}},B=function(pe,Ae){return pe>y.determineDaysOfMonths(Ae+1,h)?Ae+=1:Ae},I=60-(t.minMinute+t.minSecond/60),E=I*A,R=t.minHour+1,M=R;I===60&&(E=0,M=R=t.minHour);var G=s;M>=24&&(M=0,b="day",R=G+=1);var U=_(G,c).month;U=B(G,U),R>31&&(R=G=1),this.timeScaleArray.push({position:E,value:R,unit:b,day:G,hour:M,year:h,month:ni.monthMod(U)}),M++;for(var Q=E,q=0;q<r;q++){b="hour",M>=24&&(M=0,b="day",U=_(G+=1,U).month,U=B(G,U));var ne=this._getYear(h,U,0);Q=60*A+Q;var re=M===0?G:M;this.timeScaleArray.push({position:Q,value:re,unit:b,hour:M,day:G,year:ne,month:ni.monthMod(U)}),M++}}},{key:"generateMinuteScale",value:function(e){for(var t=e.currentMillisecond,s=e.currentSecond,c=e.currentMinute,h=e.currentHour,A=e.currentDate,r=e.currentMonth,y=e.currentYear,b=e.minutesWidthOnXAxis,_=e.secondsWidthOnXAxis,B=e.numberOfMinutes,I=c+1,E=A,R=r,M=y,G=h,U=(60-s-t/1e3)*_,Q=0;Q<B;Q++)I>=60&&(I=0,(G+=1)===24&&(G=0)),this.timeScaleArray.push({position:U,value:I,unit:"minute",hour:G,minute:I,day:E,year:this._getYear(M,R,0),month:ni.monthMod(R)}),U+=b,I++}},{key:"generateSecondScale",value:function(e){for(var t=e.currentMillisecond,s=e.currentSecond,c=e.currentMinute,h=e.currentHour,A=e.currentDate,r=e.currentMonth,y=e.currentYear,b=e.secondsWidthOnXAxis,_=e.numberOfSeconds,B=s+1,I=c,E=A,R=r,M=y,G=h,U=(1e3-t)/1e3*b,Q=0;Q<_;Q++)B>=60&&(B=0,++I>=60&&(I=0,++G===24&&(G=0))),this.timeScaleArray.push({position:U,value:B,unit:"second",hour:G,minute:I,second:B,day:E,year:this._getYear(M,R,0),month:ni.monthMod(R)}),U+=b,B++}},{key:"createRawDateString",value:function(e,t){var s=e.year;return e.month===0&&(e.month=1),s+="-"+("0"+e.month.toString()).slice(-2),e.unit==="day"?s+=e.unit==="day"?"-"+("0"+t).slice(-2):"-01":s+="-"+("0"+(e.day?e.day:"1")).slice(-2),e.unit==="hour"?s+=e.unit==="hour"?"T"+("0"+t).slice(-2):"T00":s+="T"+("0"+(e.hour?e.hour:"0")).slice(-2),e.unit==="minute"?s+=":"+("0"+t).slice(-2):s+=":"+(e.minute?("0"+e.minute).slice(-2):"00"),e.unit==="second"?s+=":"+("0"+t).slice(-2):s+=":00",this.utc&&(s+=".000Z"),s}},{key:"formatDates",value:function(e){var t=this,s=this.w;return e.map(function(c){var h=c.value.toString(),A=new Oc(t.ctx),r=t.createRawDateString(c,h),y=A.getDate(A.parseDate(r));if(t.utc||(y=A.getDate(A.parseDateWithTimezone(r))),s.config.xaxis.labels.format===void 0){var b="dd MMM",_=s.config.xaxis.labels.datetimeFormatter;c.unit==="year"&&(b=_.year),c.unit==="month"&&(b=_.month),c.unit==="day"&&(b=_.day),c.unit==="hour"&&(b=_.hour),c.unit==="minute"&&(b=_.minute),c.unit==="second"&&(b=_.second),h=A.formatDate(y,b)}else h=A.formatDate(y,s.config.xaxis.labels.format);return{dateString:r,position:c.position,value:h,unit:c.unit,year:c.year,month:c.month}})}},{key:"removeOverlappingTS",value:function(e){var t,s=this,c=new hr(this.ctx),h=!1;e.length>0&&e[0].value&&e.every(function(y){return y.value.length===e[0].value.length})&&(h=!0,t=c.getTextRects(e[0].value).width);var A=0,r=e.map(function(y,b){if(b>0&&s.w.config.xaxis.labels.hideOverlappingLabels){var _=h?t:c.getTextRects(e[A].value).width,B=e[A].position;return y.position>B+_+10?(A=b,y):null}return y});return r=r.filter(function(y){return y!==null})}},{key:"_getYear",value:function(e,t,s){return e+Math.floor(t/12)+s}}]),a}(),nO=function(){function a(e,t){en(this,a),this.ctx=t,this.w=t.w,this.el=e}return tn(a,[{key:"setupElements",value:function(){var e=this.w,t=e.globals,s=e.config,c=s.chart.type;t.axisCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].includes(c),t.xyCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble"].includes(c),t.isBarHorizontal=["bar","rangeBar","boxPlot"].includes(c)&&s.plotOptions.bar.horizontal,t.chartClass=".apexcharts".concat(t.chartID),t.dom.baseEl=this.el,t.dom.elWrap=document.createElement("div"),hr.setAttrs(t.dom.elWrap,{id:t.chartClass.substring(1),class:"apexcharts-canvas ".concat(t.chartClass.substring(1))}),this.el.appendChild(t.dom.elWrap),t.dom.Paper=window.SVG().addTo(t.dom.elWrap),t.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:"translate(".concat(s.chart.offsetX,", ").concat(s.chart.offsetY,")")}),t.dom.Paper.node.style.background=s.theme.mode!=="dark"||s.chart.background?s.theme.mode!=="light"||s.chart.background?s.chart.background:"#fff":"#343A3F",this.setSVGDimensions(),t.dom.elLegendForeign=document.createElementNS(t.SVGNS,"foreignObject"),hr.setAttrs(t.dom.elLegendForeign,{x:0,y:0,width:t.svgWidth,height:t.svgHeight}),t.dom.elLegendWrap=document.createElement("div"),t.dom.elLegendWrap.classList.add("apexcharts-legend"),t.dom.elWrap.appendChild(t.dom.elLegendWrap),t.dom.Paper.node.appendChild(t.dom.elLegendForeign),t.dom.elGraphical=t.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),t.dom.elDefs=t.dom.Paper.defs(),t.dom.Paper.add(t.dom.elGraphical),t.dom.elGraphical.add(t.dom.elDefs)}},{key:"plotChartType",value:function(e,t){var s=this.w,c=this.ctx,h=s.config,A=s.globals,r={line:{series:[],i:[]},area:{series:[],i:[]},scatter:{series:[],i:[]},bubble:{series:[],i:[]},bar:{series:[],i:[]},candlestick:{series:[],i:[]},boxPlot:{series:[],i:[]},rangeBar:{series:[],i:[]},rangeArea:{series:[],seriesRangeEnd:[],i:[]}},y=h.chart.type||"line",b=null,_=0;A.series.forEach(function(pe,Ae){var le=e[Ae].type==="column"?"bar":e[Ae].type||(y==="column"?"bar":y);r[le]?(le==="rangeArea"?(r[le].series.push(A.seriesRangeStart[Ae]),r[le].seriesRangeEnd.push(A.seriesRangeEnd[Ae])):r[le].series.push(pe),r[le].i.push(Ae),le==="bar"&&(s.globals.columnSeries=r.bar)):["heatmap","treemap","pie","donut","polarArea","radialBar","radar"].includes(le)?b=le:console.warn("You have specified an unrecognized series type (".concat(le,").")),y!==le&&le!=="scatter"&&_++}),_>0&&(b&&console.warn("Chart or series type ".concat(b," cannot appear with other chart or series types.")),r.bar.series.length>0&&h.plotOptions.bar.horizontal&&(_-=r.bar.series.length,r.bar={series:[],i:[]},s.globals.columnSeries={series:[],i:[]},console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"))),A.comboCharts||(A.comboCharts=_>0);var B=new mb(c,t),I=new pb(c,t);c.pie=new CT(c);var E=new KD(c);c.rangeBar=new qD(c,t);var R=new YD(c),M=[];if(A.comboCharts){var G,U,Q=new sl(c);if(r.area.series.length>0&&(G=M).push.apply(G,Jl(Q.drawSeriesByGroup(r.area,A.areaGroups,"area",B))),r.bar.series.length>0)if(h.chart.stacked){var q=new mE(c,t);M.push(q.draw(r.bar.series,r.bar.i))}else c.bar=new gm(c,t),M.push(c.bar.draw(r.bar.series,r.bar.i));if(r.rangeArea.series.length>0&&M.push(B.draw(r.rangeArea.series,"rangeArea",r.rangeArea.i,r.rangeArea.seriesRangeEnd)),r.line.series.length>0&&(U=M).push.apply(U,Jl(Q.drawSeriesByGroup(r.line,A.lineGroups,"line",B))),r.candlestick.series.length>0&&M.push(I.draw(r.candlestick.series,"candlestick",r.candlestick.i)),r.boxPlot.series.length>0&&M.push(I.draw(r.boxPlot.series,"boxPlot",r.boxPlot.i)),r.rangeBar.series.length>0&&M.push(c.rangeBar.draw(r.rangeBar.series,r.rangeBar.i)),r.scatter.series.length>0){var ne=new mb(c,t,!0);M.push(ne.draw(r.scatter.series,"scatter",r.scatter.i))}if(r.bubble.series.length>0){var re=new mb(c,t,!0);M.push(re.draw(r.bubble.series,"bubble",r.bubble.i))}}else switch(h.chart.type){case"line":M=B.draw(A.series,"line");break;case"area":M=B.draw(A.series,"area");break;case"bar":h.chart.stacked?M=new mE(c,t).draw(A.series):(c.bar=new gm(c,t),M=c.bar.draw(A.series));break;case"candlestick":M=new pb(c,t).draw(A.series,"candlestick");break;case"boxPlot":M=new pb(c,t).draw(A.series,h.chart.type);break;case"rangeBar":M=c.rangeBar.draw(A.series);break;case"rangeArea":M=B.draw(A.seriesRangeStart,"rangeArea",void 0,A.seriesRangeEnd);break;case"heatmap":M=new XD(c,t).draw(A.series);break;case"treemap":M=new tO(c,t).draw(A.series);break;case"pie":case"donut":case"polarArea":M=c.pie.draw(A.series);break;case"radialBar":M=E.draw(A.series);break;case"radar":M=R.draw(A.series);break;default:M=B.draw(A.series)}return M}},{key:"setSVGDimensions",value:function(){var e=this.w,t=e.globals,s=e.config;s.chart.width=s.chart.width||"100%",s.chart.height=s.chart.height||"auto",t.svgWidth=s.chart.width,t.svgHeight=s.chart.height;var c=ni.getDimensions(this.el),h=s.chart.width.toString().split(/[0-9]+/g).pop();h==="%"?ni.isNumber(c[0])&&(c[0].width===0&&(c=ni.getDimensions(this.el.parentNode)),t.svgWidth=c[0]*parseInt(s.chart.width,10)/100):h!=="px"&&h!==""||(t.svgWidth=parseInt(s.chart.width,10));var A=String(s.chart.height).toString().split(/[0-9]+/g).pop();if(t.svgHeight!=="auto"&&t.svgHeight!=="")if(A==="%"){var r=ni.getDimensions(this.el.parentNode);t.svgHeight=r[1]*parseInt(s.chart.height,10)/100}else t.svgHeight=parseInt(s.chart.height,10);else t.svgHeight=t.axisCharts?t.svgWidth/1.61:t.svgWidth/1.2;if(t.svgWidth=Math.max(t.svgWidth,0),t.svgHeight=Math.max(t.svgHeight,0),hr.setAttrs(t.dom.Paper.node,{width:t.svgWidth,height:t.svgHeight}),A!=="%"){var y=s.chart.sparkline.enabled?0:t.axisCharts?s.chart.parentHeightOffset:0;t.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(t.svgHeight+y,"px")}t.dom.elWrap.style.width="".concat(t.svgWidth,"px"),t.dom.elWrap.style.height="".concat(t.svgHeight,"px")}},{key:"shiftGraphPosition",value:function(){var e=this.w.globals,t=e.translateY,s=e.translateX;hr.setAttrs(e.dom.elGraphical.node,{transform:"translate(".concat(s,", ").concat(t,")")})}},{key:"resizeNonAxisCharts",value:function(){var e=this.w,t=e.globals,s=0,c=e.config.chart.sparkline.enabled?1:15;c+=e.config.grid.padding.bottom,["top","bottom"].includes(e.config.legend.position)&&e.config.legend.show&&!e.config.legend.floating&&(s=new vT(this.ctx).legendHelpers.getLegendDimensions().clwh+7);var h=e.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),A=2.05*e.globals.radialSize;if(h&&!e.config.chart.sparkline.enabled&&e.config.plotOptions.radialBar.startAngle!==0){var r=ni.getBoundingClientRect(h);A=r.bottom;var y=r.bottom-r.top;A=Math.max(2.05*e.globals.radialSize,y)}var b=Math.ceil(A+t.translateY+s+c);t.dom.elLegendForeign&&t.dom.elLegendForeign.setAttribute("height",b),e.config.chart.height&&String(e.config.chart.height).includes("%")||(t.dom.elWrap.style.height="".concat(b,"px"),hr.setAttrs(t.dom.Paper.node,{height:b}),t.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(b,"px"))}},{key:"coreCalculations",value:function(){new o1(this.ctx).init()}},{key:"resetGlobals",value:function(){var e=this,t=function(){return e.w.config.series.map(function(){return[]})},s=new pT,c=this.w.globals;s.initGlobalVars(c),c.seriesXvalues=t(),c.seriesYvalues=t()}},{key:"isMultipleY",value:function(){return!!(Array.isArray(this.w.config.yaxis)&&this.w.config.yaxis.length>1)&&(this.w.globals.isMultipleYAxis=!0,!0)}},{key:"xySettings",value:function(){var e=this.w,t=null;if(e.globals.axisCharts){if(e.config.xaxis.crosshairs.position==="back"&&new a1(this.ctx).drawXCrosshairs(),e.config.yaxis[0].crosshairs.position==="back"&&new a1(this.ctx).drawYCrosshairs(),e.config.xaxis.type==="datetime"&&e.config.xaxis.labels.formatter===void 0){this.ctx.timeScale=new rO(this.ctx);var s=[];isFinite(e.globals.minX)&&isFinite(e.globals.maxX)&&!e.globals.isBarHorizontal?s=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minX,e.globals.maxX):e.globals.isBarHorizontal&&(s=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minY,e.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(s)}t=new sl(this.ctx).getCalculatedRatios()}return t}},{key:"updateSourceChart",value:function(e){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:e.w.globals.minX,max:e.w.globals.maxX}}}},!1,!1)}},{key:"setupBrushHandler",value:function(){var e=this,t=this.ctx,s=this.w;if(s.config.chart.brush.enabled&&typeof s.config.chart.events.selection!="function"){var c=Array.isArray(s.config.chart.brush.targets)?s.config.chart.brush.targets:[s.config.chart.brush.target];c.forEach(function(h){var A=t.constructor.getChartByID(h);A.w.globals.brushSource=e.ctx,typeof A.w.config.chart.events.zoomed!="function"&&(A.w.config.chart.events.zoomed=function(){return e.updateSourceChart(A)}),typeof A.w.config.chart.events.scrolled!="function"&&(A.w.config.chart.events.scrolled=function(){return e.updateSourceChart(A)})}),s.config.chart.events.selection=function(h,A){c.forEach(function(r){t.constructor.getChartByID(r).ctx.updateHelpers._updateOptions({xaxis:{min:A.xaxis.min,max:A.xaxis.max}},!1,!1,!1,!1)})}}}}]),a}(),sO=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"_updateOptions",value:function(e){var t=this,s=arguments.length>1&&arguments[1]!==void 0&&arguments[1],c=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],h=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],A=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return new Promise(function(r){var y=[t.ctx];h&&(y=t.ctx.getSyncedCharts()),t.ctx.w.globals.isExecCalled&&(y=[t.ctx],t.ctx.w.globals.isExecCalled=!1),y.forEach(function(b,_){var B=b.w;if(B.globals.shouldAnimate=c,s||(B.globals.resized=!0,B.globals.dataChanged=!0,c&&b.series.getPreviousPaths()),e&&Am(e)==="object"&&(b.config=new qy(e),e=sl.extendArrayProps(b.config,e,B),b.w.globals.chartID!==t.ctx.w.globals.chartID&&delete e.series,B.config=ni.extend(B.config,e),A&&(B.globals.lastXAxis=e.xaxis?ni.clone(e.xaxis):[],B.globals.lastYAxis=e.yaxis?ni.clone(e.yaxis):[],B.globals.initialConfig=ni.extend({},B.config),B.globals.initialSeries=ni.clone(B.config.series),e.series))){for(var I=0;I<B.globals.collapsedSeriesIndices.length;I++){var E=B.config.series[B.globals.collapsedSeriesIndices[I]];B.globals.collapsedSeries[I].data=B.globals.axisCharts?E.data.slice():E}for(var R=0;R<B.globals.ancillaryCollapsedSeriesIndices.length;R++){var M=B.config.series[B.globals.ancillaryCollapsedSeriesIndices[R]];B.globals.ancillaryCollapsedSeries[R].data=B.globals.axisCharts?M.data.slice():M}b.series.emptyCollapsedSeries(B.config.series)}return b.update(e).then(function(){_===y.length-1&&r(b)})})})}},{key:"_updateSeries",value:function(e,t){var s=this,c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return new Promise(function(h){var A,r=s.w;return r.globals.shouldAnimate=t,r.globals.dataChanged=!0,t&&s.ctx.series.getPreviousPaths(),r.globals.axisCharts?((A=e.map(function(y,b){return s._extendSeries(y,b)})).length===0&&(A=[{data:[]}]),r.config.series=A):r.config.series=e.slice(),c&&(r.globals.initialConfig.series=ni.clone(r.config.series),r.globals.initialSeries=ni.clone(r.config.series)),s.ctx.update().then(function(){h(s.ctx)})})}},{key:"_extendSeries",value:function(e,t){var s=this.w,c=s.config.series[t];return Ir(Ir({},s.config.series[t]),{},{name:e.name?e.name:c==null?void 0:c.name,color:e.color?e.color:c==null?void 0:c.color,type:e.type?e.type:c==null?void 0:c.type,group:e.group?e.group:c==null?void 0:c.group,hidden:e.hidden!==void 0?e.hidden:c==null?void 0:c.hidden,data:e.data?e.data:c==null?void 0:c.data,zIndex:e.zIndex!==void 0?e.zIndex:t})}},{key:"toggleDataPointSelection",value:function(e,t){var s=this.w,c=null,h=".apexcharts-series[data\\:realIndex='".concat(e,"']");return s.globals.axisCharts?c=s.globals.dom.Paper.findOne("".concat(h," path[j='").concat(t,"'], ").concat(h," circle[j='").concat(t,"'], ").concat(h," rect[j='").concat(t,"']")):t===void 0&&(c=s.globals.dom.Paper.findOne("".concat(h," path[j='").concat(e,"']")),s.config.chart.type!=="pie"&&s.config.chart.type!=="polarArea"&&s.config.chart.type!=="donut"||this.ctx.pie.pieClicked(e)),c?(new hr(this.ctx).pathMouseDown(c,null),c.node?c.node:null):(console.warn("toggleDataPointSelection: Element not found"),null)}},{key:"forceXAxisUpdate",value:function(e){var t=this.w;if(["min","max"].forEach(function(c){e.xaxis[c]!==void 0&&(t.config.xaxis[c]=e.xaxis[c],t.globals.lastXAxis[c]=e.xaxis[c])}),e.xaxis.categories&&e.xaxis.categories.length&&(t.config.xaxis.categories=e.xaxis.categories),t.config.xaxis.convertedCatToNumeric){var s=new Ky(e);e=s.convertCatToNumericXaxis(e,this.ctx)}return e}},{key:"forceYAxisUpdate",value:function(e){return e.chart&&e.chart.stacked&&e.chart.stackType==="100%"&&(Array.isArray(e.yaxis)?e.yaxis.forEach(function(t,s){e.yaxis[s].min=0,e.yaxis[s].max=100}):(e.yaxis.min=0,e.yaxis.max=100)),e}},{key:"revertDefaultAxisMinMax",value:function(e){var t=this,s=this.w,c=s.globals.lastXAxis,h=s.globals.lastYAxis;e&&e.xaxis&&(c=e.xaxis),e&&e.yaxis&&(h=e.yaxis),s.config.xaxis.min=c.min,s.config.xaxis.max=c.max;var A=function(r){h[r]!==void 0&&(s.config.yaxis[r].min=h[r].min,s.config.yaxis[r].max=h[r].max)};s.config.yaxis.map(function(r,y){s.globals.zoomed||h[y]!==void 0?A(y):t.ctx.opts.yaxis[y]!==void 0&&(r.min=t.ctx.opts.yaxis[y].min,r.max=t.ctx.opts.yaxis[y].max)})}}]),a}();(function(){function a(){for(var h=arguments.length>0&&arguments[0]!==B?arguments[0]:[],A=arguments.length>1?arguments[1]:B,r=arguments.length>2?arguments[2]:B,y=arguments.length>3?arguments[3]:B,b=arguments.length>4?arguments[4]:B,_=arguments.length>5?arguments[5]:B,B=arguments.length>6?arguments[6]:B,I=h.slice(A,r||B),E=y.slice(b,_||B),R=0,M={pos:[0,0],start:[0,0]},G={pos:[0,0],start:[0,0]};I[R]=e.call(M,I[R]),E[R]=e.call(G,E[R]),I[R][0]!=E[R][0]||I[R][0]=="M"||I[R][0]=="A"&&(I[R][4]!=E[R][4]||I[R][5]!=E[R][5])?(Array.prototype.splice.apply(I,[R,1].concat(s.call(M,I[R]))),Array.prototype.splice.apply(E,[R,1].concat(s.call(G,E[R])))):(I[R]=t.call(M,I[R]),E[R]=t.call(G,E[R])),!(++R==I.length&&R==E.length);)R==I.length&&I.push(["C",M.pos[0],M.pos[1],M.pos[0],M.pos[1],M.pos[0],M.pos[1]]),R==E.length&&E.push(["C",G.pos[0],G.pos[1],G.pos[0],G.pos[1],G.pos[0],G.pos[1]]);return{start:I,dest:E}}function e(h){switch(h[0]){case"z":case"Z":h[0]="L",h[1]=this.start[0],h[2]=this.start[1];break;case"H":h[0]="L",h[2]=this.pos[1];break;case"V":h[0]="L",h[2]=h[1],h[1]=this.pos[0];break;case"T":h[0]="Q",h[3]=h[1],h[4]=h[2],h[1]=this.reflection[1],h[2]=this.reflection[0];break;case"S":h[0]="C",h[6]=h[4],h[5]=h[3],h[4]=h[2],h[3]=h[1],h[2]=this.reflection[1],h[1]=this.reflection[0]}return h}function t(h){var A=h.length;return this.pos=[h[A-2],h[A-1]],"SCQT".indexOf(h[0])!=-1&&(this.reflection=[2*this.pos[0]-h[A-4],2*this.pos[1]-h[A-3]]),h}function s(h){var A=[h];switch(h[0]){case"M":return this.pos=this.start=[h[1],h[2]],A;case"L":h[5]=h[3]=h[1],h[6]=h[4]=h[2],h[1]=this.pos[0],h[2]=this.pos[1];break;case"Q":h[6]=h[4],h[5]=h[3],h[4]=1*h[4]/3+2*h[2]/3,h[3]=1*h[3]/3+2*h[1]/3,h[2]=1*this.pos[1]/3+2*h[2]/3,h[1]=1*this.pos[0]/3+2*h[1]/3;break;case"A":A=function(r,y){var b,_,B,I,E,R,M,G,U,Q,q,ne,re,pe,Ae,le,be,we,oe,me,Le,Se,Me,Re,Ze,$e,ct=Math.abs(y[1]),Qe=Math.abs(y[2]),It=y[3]%360,Ce=y[4],Je=y[5],lt=y[6],mt=y[7],Bt=new Go(r),rt=new Go(lt,mt),St=[];if(ct===0||Qe===0||Bt.x===rt.x&&Bt.y===rt.y)return[["C",Bt.x,Bt.y,rt.x,rt.y,rt.x,rt.y]];for(b=new Go((Bt.x-rt.x)/2,(Bt.y-rt.y)/2).transform(new qs().rotate(It)),_=b.x*b.x/(ct*ct)+b.y*b.y/(Qe*Qe),_>1&&(ct*=_=Math.sqrt(_),Qe*=_),B=new qs().rotate(It).scale(1/ct,1/Qe).rotate(-It),Bt=Bt.transform(B),rt=rt.transform(B),I=[rt.x-Bt.x,rt.y-Bt.y],R=I[0]*I[0]+I[1]*I[1],E=Math.sqrt(R),I[0]/=E,I[1]/=E,M=R<4?Math.sqrt(1-R/4):0,Ce===Je&&(M*=-1),G=new Go((rt.x+Bt.x)/2+M*-I[1],(rt.y+Bt.y)/2+M*I[0]),U=new Go(Bt.x-G.x,Bt.y-G.y),Q=new Go(rt.x-G.x,rt.y-G.y),q=Math.acos(U.x/Math.sqrt(U.x*U.x+U.y*U.y)),U.y<0&&(q*=-1),ne=Math.acos(Q.x/Math.sqrt(Q.x*Q.x+Q.y*Q.y)),Q.y<0&&(ne*=-1),Je&&q>ne&&(ne+=2*Math.PI),!Je&&q<ne&&(ne-=2*Math.PI),pe=Math.ceil(2*Math.abs(q-ne)/Math.PI),le=[],be=q,re=(ne-q)/pe,Ae=4*Math.tan(re/4)/3,Le=0;Le<=pe;Le++)oe=Math.cos(be),we=Math.sin(be),me=new Go(G.x+oe,G.y+we),le[Le]=[new Go(me.x+Ae*we,me.y-Ae*oe),me,new Go(me.x-Ae*we,me.y+Ae*oe)],be+=re;for(le[0][0]=le[0][1].clone(),le[le.length-1][2]=le[le.length-1][1].clone(),B=new qs().rotate(It).scale(ct,Qe).rotate(-It),Le=0,Se=le.length;Le<Se;Le++)le[Le][0]=le[Le][0].transform(B),le[Le][1]=le[Le][1].transform(B),le[Le][2]=le[Le][2].transform(B);for(Le=1,Se=le.length;Le<Se;Le++)Me=(me=le[Le-1][2]).x,Re=me.y,Ze=(me=le[Le][0]).x,$e=me.y,lt=(me=le[Le][1]).x,mt=me.y,St.push(["C",Me,Re,Ze,$e,lt,mt]);return St}(this.pos,h),h=A[0]}return h[0]="C",this.pos=[h[5],h[6]],this.reflection=[2*h[5]-h[3],2*h[6]-h[4]],A}function c(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],A=arguments.length>1?arguments[1]:void 0;if(A===!1)return!1;for(var r=A,y=h.length;r<y;++r)if(h[r][0]=="M")return r;return!1}Gn(Xd,{morph:function(h,A,r,y,b){for(var _=this.parse(h),B=this.parse(A),I=0,E=0,R=!1,M=!1;I!==!1||E!==!1;){var G;R=c(_,I!==!1&&I+1),M=c(B,E!==!1&&E+1),I===!1&&(I=(G=new Xd(U.start).bbox()).height==0||G.width==0?_.push(_[0])-1:_.push(["M",G.x+G.width/2,G.y+G.height/2])-1),E===!1&&(E=(G=new Xd(U.dest).bbox()).height==0||G.width==0?B.push(B[0])-1:B.push(["M",G.x+G.width/2,G.y+G.height/2])-1);var U=a(_,I,R,B,E,M);_=_.slice(0,I).concat(U.start,R===!1?[]:_.slice(R)),B=B.slice(0,E).concat(U.dest,M===!1?[]:B.slice(M)),I=R!==!1&&I+U.start.length,E=M!==!1&&E+U.dest.length}this._array=_,this.destination=new Xd,this.destination._array=B;var Q=this.fromArray(_.map(function(q,ne){var re=B[ne].map(function(pe,Ae){return Ae===0?pe:y.step(q[Ae],B[ne][Ae],r,b[ne],b)});return re}));return Q}})})();const yE=a=>(a.changedTouches&&(a=a.changedTouches[0]),{x:a.clientX,y:a.clientY});class oO{constructor(e){e.remember("_draggable",this),this.el=e,this.drag=this.drag.bind(this),this.startDrag=this.startDrag.bind(this),this.endDrag=this.endDrag.bind(this)}init(e){e?(this.el.on("mousedown.drag",this.startDrag),this.el.on("touchstart.drag",this.startDrag,{passive:!1})):(this.el.off("mousedown.drag"),this.el.off("touchstart.drag"))}startDrag(e){const t=!e.type.indexOf("mouse");if(t&&e.which!==1&&e.buttons!==0||this.el.dispatch("beforedrag",{event:e,handler:this}).defaultPrevented)return;e.preventDefault(),e.stopPropagation(),this.init(!1),this.box=this.el.bbox(),this.lastClick=this.el.point(yE(e));const s=(t?"mouseup":"touchend")+".drag";Ef(window,(t?"mousemove":"touchmove")+".drag",this.drag,this,{passive:!1}),Ef(window,s,this.endDrag,this,{passive:!1}),this.el.fire("dragstart",{event:e,handler:this,box:this.box})}drag(e){const{box:t,lastClick:s}=this,c=this.el.point(yE(e)),h=c.x-s.x,A=c.y-s.y;if(!h&&!A)return t;const r=t.x+h,y=t.y+A;this.box=new yc(r,y,t.w,t.h),this.lastClick=c,this.el.dispatch("dragmove",{event:e,handler:this,box:this.box}).defaultPrevented||this.move(r,y)}move(e,t){this.el.type==="svg"?Cp.prototype.move.call(this.el,e,t):this.el.move(e,t)}endDrag(e){this.drag(e),this.el.fire("dragend",{event:e,handler:this,box:this.box}),nd(window,"mousemove.drag"),nd(window,"touchmove.drag"),nd(window,"mouseup.drag"),nd(window,"touchend.drag"),this.init(!0)}}/*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schäfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function l1(a,e,t,s=null){return function(c){c.preventDefault(),c.stopPropagation();var h=c.pageX||c.touches[0].pageX,A=c.pageY||c.touches[0].pageY;e.fire(a,{x:h,y:A,event:c,index:s,points:t})}}function c1([a,e],{a:t,b:s,c,d:h,e:A,f:r}){return[a*t+e*c+A,a*s+e*h+r]}Gn(zc,{draggable(a=!0){return(this.remember("_draggable")||new oO(this)).init(a),this}});let ET=class{constructor(a){this.el=a,a.remember("_selectHandler",this),this.selection=new Cp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=lv();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.createRot=a.createRot||this.createRotFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.updateRot=a.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((a,e,t)=>{const s=this.order[e];this.createHandle.call(this,this.selection,a,e,t,s),this.selection.get(e+1).addClass("svg_select_handle svg_select_handle_"+s).on("mousedown.selection touchstart.selection",l1(s,this.el,this.handlePoints,e))})}createHandleFn(a){a.polyline()}updateHandleFn(a,e,t,s){const c=s.at(t-1),h=s[(t+1)%s.length],A=e,r=[A[0]-c[0],A[1]-c[1]],y=[A[0]-h[0],A[1]-h[1]],b=Math.sqrt(r[0]*r[0]+r[1]*r[1]),_=Math.sqrt(y[0]*y[0]+y[1]*y[1]),B=[r[0]/b,r[1]/b],I=[y[0]/_,y[1]/_],E=[A[0]-10*B[0],A[1]-10*B[1]],R=[A[0]-10*I[0],A[1]-10*I[1]];a.plot([E,A,R])}updateResizeHandles(){this.handlePoints.forEach((a,e,t)=>{const s=this.order[e];this.updateHandle.call(this,this.selection.get(e+1),a,e,t,s)})}createRotFn(a){a.line(),a.circle(5)}getPoint(a){return this.handlePoints[this.order.indexOf(a)]}getPointHandle(a){return this.selection.get(this.order.indexOf(a)+1)}updateRotFn(a,e){const t=this.getPoint("t");a.get(0).plot(t[0],t[1],e[0],e[1]),a.get(1).center(e[0],e[1])}createRotationHandle(){const a=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",l1("rot",this.el,this.handlePoints));this.createRot.call(this,a)}updateRotationHandle(){const a=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(a,this.rotationPoint,this.handlePoints)}updatePoints(){const a=this.el.bbox(),e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(a).map(t=>c1(t,e)),this.rotationPoint=c1(this.getRotationPoint(a),e)}getHandlePoints({x:a,x2:e,y:t,y2:s,cx:c,cy:h}=this.el.bbox()){return[[a,t],[c,t],[e,t],[e,h],[e,s],[c,s],[a,s],[a,h]]}getRotationPoint({y:a,cx:e}=this.el.bbox()){return[e,a-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}};const vE=a=>function(e=!0,t={}){typeof e=="object"&&(t=e,e=!0);let s=this.remember("_"+a.name);return s||(e.prototype instanceof ET?(s=new e(this),e=!0):s=new a(this),this.remember("_"+a.name,s)),s.active(e,t),this};/*!
* @svgdotjs/svg.resize.js - An extension for svg.js which allows to resize elements which are selected
* @version 2.0.4
* https://github.com/svgdotjs/svg.resize.js
*
* @copyright [object Object]
* @license MIT
*
* BUILT: Fri Sep 13 2024 12:43:14 GMT+0200 (Central European Summer Time)
*//*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schäfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function u1(a,e,t,s=null){return function(c){c.preventDefault(),c.stopPropagation();var h=c.pageX||c.touches[0].pageX,A=c.pageY||c.touches[0].pageY;e.fire(a,{x:h,y:A,event:c,index:s,points:t})}}function h1([a,e],{a:t,b:s,c,d:h,e:A,f:r}){return[a*t+e*c+A,a*s+e*h+r]}Gn(zc,{select:vE(ET)}),Gn([ug,hg,cg],{pointSelect:vE(class{constructor(a){this.el=a,a.remember("_pointSelectHandler",this),this.selection=new Cp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=lv();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((a,e,t)=>{this.createHandle.call(this,this.selection,a,e,t),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",l1("point",this.el,this.points,e))})}createHandleFn(a){a.circle(5)}updateHandleFn(a,e){a.center(e[0],e[1])}updatePointHandles(){this.points.forEach((a,e,t)=>{this.updateHandle.call(this,this.selection.get(e+1),a,e,t)})}updatePoints(){const a=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>c1(e,a))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});class IT{constructor(e){this.el=e,e.remember("_selectHandler",this),this.selection=new Cp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const t=lv();this.observer=new t.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.createRot=e.createRot||this.createRotFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.updateRot=e.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(e,t){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(t)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((e,t,s)=>{const c=this.order[t];this.createHandle.call(this,this.selection,e,t,s,c),this.selection.get(t+1).addClass("svg_select_handle svg_select_handle_"+c).on("mousedown.selection touchstart.selection",u1(c,this.el,this.handlePoints,t))})}createHandleFn(e){e.polyline()}updateHandleFn(e,t,s,c){const h=c.at(s-1),A=c[(s+1)%c.length],r=t,y=[r[0]-h[0],r[1]-h[1]],b=[r[0]-A[0],r[1]-A[1]],_=Math.sqrt(y[0]*y[0]+y[1]*y[1]),B=Math.sqrt(b[0]*b[0]+b[1]*b[1]),I=[y[0]/_,y[1]/_],E=[b[0]/B,b[1]/B],R=[r[0]-10*I[0],r[1]-10*I[1]],M=[r[0]-10*E[0],r[1]-10*E[1]];e.plot([R,r,M])}updateResizeHandles(){this.handlePoints.forEach((e,t,s)=>{const c=this.order[t];this.updateHandle.call(this,this.selection.get(t+1),e,t,s,c)})}createRotFn(e){e.line(),e.circle(5)}getPoint(e){return this.handlePoints[this.order.indexOf(e)]}getPointHandle(e){return this.selection.get(this.order.indexOf(e)+1)}updateRotFn(e,t){const s=this.getPoint("t");e.get(0).plot(s[0],s[1],t[0],t[1]),e.get(1).center(t[0],t[1])}createRotationHandle(){const e=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",u1("rot",this.el,this.handlePoints));this.createRot.call(this,e)}updateRotationHandle(){const e=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(e,this.rotationPoint,this.handlePoints)}updatePoints(){const e=this.el.bbox(),t=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(e).map(s=>h1(s,t)),this.rotationPoint=h1(this.getRotationPoint(e),t)}getHandlePoints({x:e,x2:t,y:s,y2:c,cx:h,cy:A}=this.el.bbox()){return[[e,s],[h,s],[t,s],[t,A],[t,c],[h,c],[e,c],[e,A]]}getRotationPoint({y:e,cx:t}=this.el.bbox()){return[t,e-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}}const _E=a=>function(e=!0,t={}){typeof e=="object"&&(t=e,e=!0);let s=this.remember("_"+a.name);return s||(e.prototype instanceof IT?(s=new e(this),e=!0):s=new a(this),this.remember("_"+a.name,s)),s.active(e,t),this};Gn(zc,{select:_E(IT)}),Gn([ug,hg,cg],{pointSelect:_E(class{constructor(a){this.el=a,a.remember("_pointSelectHandler",this),this.selection=new Cp,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const e=lv();this.observer=new e.MutationObserver(this.mutationHandler)}init(a){this.createHandle=a.createHandle||this.createHandleFn,this.updateHandle=a.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(a,e){if(!a)return this.selection.clear().remove(),void this.observer.disconnect();this.init(e)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((a,e,t)=>{this.createHandle.call(this,this.selection,a,e,t),this.selection.get(e+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",u1("point",this.el,this.points,e))})}createHandleFn(a){a.circle(5)}updateHandleFn(a,e){a.center(e[0],e[1])}updatePointHandles(){this.points.forEach((a,e,t)=>{this.updateHandle.call(this,this.selection.get(e+1),a,e,t)})}updatePoints(){const a=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(e=>h1(e,a))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});const A0=a=>(a.changedTouches&&(a=a.changedTouches[0]),{x:a.clientX,y:a.clientY}),xE=a=>{let e=1/0,t=1/0,s=-1/0,c=-1/0;for(let h=0;h<a.length;h++){const A=a[h];e=Math.min(e,A[0]),t=Math.min(t,A[1]),s=Math.max(s,A[0]),c=Math.max(c,A[1])}return new yc(e,t,s-e,c-t)};class bE{constructor(e){this.el=e,e.remember("_ResizeHandler",this),this.lastCoordinates=null,this.eventType="",this.lastEvent=null,this.handleResize=this.handleResize.bind(this),this.resize=this.resize.bind(this),this.endResize=this.endResize.bind(this),this.rotate=this.rotate.bind(this),this.movePoint=this.movePoint.bind(this)}active(e,t){this.preserveAspectRatio=t.preserveAspectRatio??!1,this.aroundCenter=t.aroundCenter??!1,this.grid=t.grid??0,this.degree=t.degree??0,this.el.off(".resize"),e&&(this.el.on(["lt.resize","rt.resize","rb.resize","lb.resize","t.resize","r.resize","b.resize","l.resize","rot.resize","point.resize"],this.handleResize),this.lastEvent&&(this.eventType==="rot"?this.rotate(this.lastEvent):this.eventType==="point"?this.movePoint(this.lastEvent):this.resize(this.lastEvent)))}handleResize(e){this.eventType=e.type;const{event:t,index:s,points:c}=e.detail,h=!t.type.indexOf("mouse");if(h&&(t.which||t.buttons)!==1||this.el.dispatch("beforeresize",{event:e,handler:this}).defaultPrevented)return;this.box=this.el.bbox(),this.startPoint=this.el.point(A0(t)),this.index=s,this.points=c.slice();const A=(h?"mousemove":"touchmove")+".resize",r=(h?"mouseup":"touchcancel.resize touchend")+".resize";e.type==="point"?Ef(window,A,this.movePoint):e.type==="rot"?Ef(window,A,this.rotate):Ef(window,A,this.resize),Ef(window,r,this.endResize)}resize(e){this.lastEvent=e;const t=this.snapToGrid(this.el.point(A0(e)));let s=t.x-this.startPoint.x,c=t.y-this.startPoint.y;this.preserveAspectRatio&&this.aroundCenter&&(s*=2,c*=2);const h=this.box.x+s,A=this.box.y+c,r=this.box.x2+s,y=this.box.y2+c;let b=new yc(this.box);if(this.eventType.includes("l")&&(b.x=Math.min(h,this.box.x2),b.x2=Math.max(h,this.box.x2)),this.eventType.includes("r")&&(b.x=Math.min(r,this.box.x),b.x2=Math.max(r,this.box.x)),this.eventType.includes("t")&&(b.y=Math.min(A,this.box.y2),b.y2=Math.max(A,this.box.y2)),this.eventType.includes("b")&&(b.y=Math.min(y,this.box.y),b.y2=Math.max(y,this.box.y)),b.width=b.x2-b.x,b.height=b.y2-b.y,this.preserveAspectRatio){const _=b.width/this.box.width,B=b.height/this.box.height,I=["lt","t","rt","r","rb","b","lb","l"],E=(I.indexOf(this.eventType)+4)%I.length,R=this.aroundCenter?[this.box.cx,this.box.cy]:this.points[E];let M=this.eventType.includes("t")||this.eventType.includes("b")?B:_;M=this.eventType.length===2?Math.max(_,B):M,b=function(G,U,Q){const q=[[G.x,G.y],[G.x+G.width,G.y],[G.x+G.width,G.y+G.height],[G.x,G.y+G.height]].map(([ne,re])=>{const pe=ne-U[0],Ae=(re-U[1])*Q;return[pe*Q+U[0],Ae+U[1]]});return xE(q)}(this.box,R,M)}this.el.dispatch("resize",{box:new yc(b),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.size(b.width,b.height).move(b.x,b.y)}movePoint(e){this.lastEvent=e;const{x:t,y:s}=this.snapToGrid(this.el.point(A0(e))),c=this.el.array().slice();c[this.index]=[t,s],this.el.dispatch("resize",{box:xE(c),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.plot(c)}rotate(e){this.lastEvent=e;const t=this.startPoint,s=this.el.point(A0(e)),{cx:c,cy:h}=this.box,A=t.x-c,r=t.y-h,y=s.x-c,b=s.y-h,_=Math.sqrt(A*A+r*r)*Math.sqrt(y*y+b*b);if(_===0)return;let B=Math.acos((A*y+r*b)/_)/Math.PI*180;if(!B)return;s.x<t.x&&(B=-B);const I=new qs(this.el),{x:E,y:R}=new Go(c,h).transformO(I),{rotate:M}=I.decompose(),G=this.snapToAngle(M+B)-M;this.el.dispatch("resize",{box:this.box,angle:G,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.transform(I.rotateO(G,E,R))}endResize(e){this.eventType!=="rot"&&this.eventType!=="point"&&this.resize(e),this.lastEvent=null,this.eventType="",nd(window,"mousemove.resize touchmove.resize"),nd(window,"mouseup.resize touchend.resize")}snapToGrid(e){return this.grid&&(e.x=Math.round(e.x/this.grid)*this.grid,e.y=Math.round(e.y/this.grid)*this.grid),e}snapToAngle(e){return this.degree&&(e=Math.round(e/this.degree)*this.degree),e}}Gn(zc,{resize:function(a=!0,e={}){typeof a=="object"&&(e=a,a=!0);let t=this.remember("_ResizeHandler");return t||(a.prototype instanceof bE?(t=new a(this),a=!0):t=new bE(this),this.remember("_resizeHandler",t)),t.active(a,e),this}}),window.SVG===void 0&&(window.SVG=xD),window.Apex===void 0&&(window.Apex={});var wE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"initModules",value:function(){this.ctx.publicMethods=["updateOptions","updateSeries","appendData","appendSeries","isSeriesHidden","highlightSeries","toggleSeries","showSeries","hideSeries","setLocale","resetSeries","zoomX","toggleDataPointSelection","dataURI","exportToCSV","addXaxisAnnotation","addYaxisAnnotation","addPointAnnotation","clearAnnotations","removeAnnotation","paper","destroy"],this.ctx.eventList=["click","mousedown","mousemove","mouseleave","touchstart","touchmove","touchleave","mouseup","touchend"],this.ctx.animations=new vm(this.ctx),this.ctx.axes=new LD(this.ctx),this.ctx.core=new nO(this.ctx.el,this.ctx),this.ctx.config=new qy({}),this.ctx.data=new hw(this.ctx),this.ctx.grid=new mT(this.ctx),this.ctx.graphics=new hr(this.ctx),this.ctx.coreUtils=new sl(this.ctx),this.ctx.crosshairs=new a1(this.ctx),this.ctx.events=new TD(this.ctx),this.ctx.exports=new Ly(this.ctx),this.ctx.fill=new qd(this.ctx),this.ctx.localization=new FD(this.ctx),this.ctx.options=new lg,this.ctx.responsive=new MD(this.ctx),this.ctx.series=new ld(this.ctx),this.ctx.theme=new PD(this.ctx),this.ctx.formatters=new hv(this.ctx),this.ctx.titleSubtitle=new kD(this.ctx),this.ctx.legend=new vT(this.ctx),this.ctx.toolbar=new _T(this.ctx),this.ctx.tooltip=new gE(this.ctx),this.ctx.dimensions=new K0(this.ctx),this.ctx.updateHelpers=new sO(this.ctx),this.ctx.zoomPanSelection=new ND(this.ctx),this.ctx.w.globals.tooltip=new gE(this.ctx)}}]),a}(),BE=function(){function a(e){en(this,a),this.ctx=e,this.w=e.w}return tn(a,[{key:"clear",value:function(e){var t=e.isUpdating;this.ctx.zoomPanSelection&&this.ctx.zoomPanSelection.destroy(),this.ctx.toolbar&&this.ctx.toolbar.destroy(),this.ctx.animations=null,this.ctx.axes=null,this.ctx.annotations=null,this.ctx.core=null,this.ctx.data=null,this.ctx.grid=null,this.ctx.series=null,this.ctx.responsive=null,this.ctx.theme=null,this.ctx.formatters=null,this.ctx.titleSubtitle=null,this.ctx.legend=null,this.ctx.dimensions=null,this.ctx.options=null,this.ctx.crosshairs=null,this.ctx.zoomPanSelection=null,this.ctx.updateHelpers=null,this.ctx.toolbar=null,this.ctx.localization=null,this.ctx.w.globals.tooltip=null,this.clearDomElements({isUpdating:t})}},{key:"killSVG",value:function(e){e.each(function(){this.removeClass("*"),this.off()},!0),e.clear()}},{key:"clearDomElements",value:function(e){var t=this,s=e.isUpdating,c=this.w.globals.dom.Paper.node;c.parentNode&&c.parentNode.parentNode&&!s&&(c.parentNode.parentNode.style.minHeight="unset");var h=this.w.globals.dom.baseEl;h&&this.ctx.eventList.forEach(function(r){h.removeEventListener(r,t.ctx.events.documentEvent)});var A=this.w.globals.dom;if(this.ctx.el!==null)for(;this.ctx.el.firstChild;)this.ctx.el.removeChild(this.ctx.el.firstChild);this.killSVG(A.Paper),A.Paper.remove(),A.elWrap=null,A.elGraphical=null,A.elLegendWrap=null,A.elLegendForeign=null,A.baseEl=null,A.elGridRect=null,A.elGridRectMask=null,A.elGridRectBarMask=null,A.elGridRectMarkerMask=null,A.elForecastMask=null,A.elNonForecastMask=null,A.elDefs=null}}]),a}(),yb=new WeakMap,CE=function(){function a(e,t){en(this,a),this.opts=t,this.ctx=this,this.w=new ID(t).init(),this.el=e,this.w.globals.cuid=ni.randomId(),this.w.globals.chartID=this.w.config.chart.id?ni.escapeString(this.w.config.chart.id):this.w.globals.cuid,new wE(this).initModules(),this.lastUpdateOptions=null,this.create=ni.bind(this.create,this),this.windowResizeHandler=this._windowResizeHandler.bind(this),this.parentResizeHandler=this._parentResizeCallback.bind(this)}return tn(a,[{key:"render",value:function(){var e=this;return new Promise(function(t,s){if(ni.elementExists(e.el)){Apex._chartInstances===void 0&&(Apex._chartInstances=[]),e.w.config.chart.id&&Apex._chartInstances.push({id:e.w.globals.chartID,group:e.w.config.chart.group,chart:e}),e.setLocale(e.w.config.chart.defaultLocale);var c=e.w.config.chart.events.beforeMount;typeof c=="function"&&c(e,e.w),e.events.fireEvent("beforeMount",[e,e.w]),window.addEventListener("resize",e.windowResizeHandler),function(I,E){var R=!1;if(I.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){var M=I.getBoundingClientRect();I.style.display!=="none"&&M.width!==0||(R=!0)}var G=new ResizeObserver(function(U){R&&E.call(I,U),R=!0});I.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(I.children).forEach(function(U){return G.observe(U)}):G.observe(I),yb.set(E,G)}(e.el.parentNode,e.parentResizeHandler);var h=e.el.getRootNode&&e.el.getRootNode(),A=ni.is("ShadowRoot",h),r=e.el.ownerDocument,y=A?h.getElementById("apexcharts-css"):r.getElementById("apexcharts-css");if(!y){var b;(y=document.createElement("style")).id="apexcharts-css",y.textContent=`@keyframes opaque {
  0% {
    opacity: 0
  }

  to {
    opacity: 1
  }
}

@keyframes resizeanim {

  0%,
  to {
    opacity: 0
  }
}

.apexcharts-canvas {
  position: relative;
  direction: ltr !important;
  user-select: none
}

.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5)
}

.apexcharts-inner {
  position: relative
}

.apexcharts-text tspan {
  font-family: inherit
}

rect.legend-mouseover-inactive,
.legend-mouseover-inactive rect,
.legend-mouseover-inactive path,
.legend-mouseover-inactive circle,
.legend-mouseover-inactive line,
.legend-mouseover-inactive text.apexcharts-yaxis-title-text,
.legend-mouseover-inactive text.apexcharts-yaxis-label {
  transition: .15s ease all;
  opacity: .2
}

.apexcharts-legend-text {
  padding-left: 15px;
  margin-left: -15px;
}

.apexcharts-series-collapsed {
  opacity: 0
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: .15s ease all
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, .96)
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, .8)
}

.apexcharts-tooltip * {
  font-family: inherit
}

.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #eceff1;
  border-bottom: 1px solid #ddd
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, .7);
  border-bottom: 1px solid #333
}

.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  margin-left: 5px;
  font-weight: 600
}

.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-z-value:empty,
.apexcharts-tooltip-title:empty {
  display: none
}

.apexcharts-tooltip-text-goals-label,
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px
}

.apexcharts-tooltip-goals-group,
.apexcharts-tooltip-text-goals-label,
.apexcharts-tooltip-text-goals-value {
  display: flex
}

.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px
}

.apexcharts-tooltip-marker {
  display: inline-block;
  position: relative;
  width: 16px;
  height: 16px;
  font-size: 16px;
  line-height: 16px;
  margin-right: 4px;
  text-align: center;
  vertical-align: middle;
  color: inherit;
}

.apexcharts-tooltip-marker::before {
  content: "";
  display: inline-block;
  width: 100%;
  text-align: center;
  color: currentcolor;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  font-size: 26px;
  font-family: Arial, Helvetica, sans-serif;
  line-height: 14px;
  font-weight: 900;
}

.apexcharts-tooltip-marker[shape="circle"]::before {
  content: "\\25CF";
}

.apexcharts-tooltip-marker[shape="square"]::before,
.apexcharts-tooltip-marker[shape="rect"]::before {
  content: "\\25A0";
  transform: translate(-1px, -2px);
}

.apexcharts-tooltip-marker[shape="line"]::before {
  content: "\\2500";
}

.apexcharts-tooltip-marker[shape="diamond"]::before {
  content: "\\25C6";
  font-size: 28px;
}

.apexcharts-tooltip-marker[shape="triangle"]::before {
  content: "\\25B2";
  font-size: 22px;
}

.apexcharts-tooltip-marker[shape="cross"]::before {
  content: "\\2715";
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="plus"]::before {
  content: "\\2715";
  transform: rotate(45deg) translate(-1px, -1px);
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="star"]::before {
  content: "\\2605";
  font-size: 18px;
}

.apexcharts-tooltip-marker[shape="sparkle"]::before {
  content: "\\2726";
  font-size: 20px;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px
}

.apexcharts-custom-tooltip,
.apexcharts-tooltip-box {
  padding: 4px 8px
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse
}

.apexcharts-tooltip-box>div {
  margin: 4px 0
}

.apexcharts-tooltip-box span.value {
  font-weight: 700
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: 700;
  display: block;
  margin-bottom: 5px
}

.apexcharts-xaxistooltip,
.apexcharts-yaxistooltip {
  opacity: 0;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #eceff1;
  border: 1px solid #90a4ae
}

.apexcharts-xaxistooltip {
  padding: 9px 10px;
  transition: .15s ease all
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, .7);
  border: 1px solid rgba(0, 0, 0, .5);
  color: #fff
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none
}

.apexcharts-xaxistooltip:after {
  border-color: transparent;
  border-width: 6px;
  margin-left: -6px
}

.apexcharts-xaxistooltip:before {
  border-color: transparent;
  border-width: 7px;
  margin-left: -7px
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #eceff1
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90a4ae
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after,
.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, .5)
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #eceff1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90a4ae
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after,
.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, .5)
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-yaxistooltip {
  padding: 4px 10px
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, .7);
  border: 1px solid rgba(0, 0, 0, .5);
  color: #fff
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none
}

.apexcharts-yaxistooltip:after {
  border-color: transparent;
  border-width: 6px;
  margin-top: -6px
}

.apexcharts-yaxistooltip:before {
  border-color: transparent;
  border-width: 7px;
  margin-top: -7px
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #eceff1
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90a4ae
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after,
.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, .5)
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #eceff1
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90a4ae
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after,
.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, .5)
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1
}

.apexcharts-yaxistooltip-hidden {
  display: none
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: .15s ease all
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: .15s ease all
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0
}

.apexcharts-selection-rect {
  cursor: move
}

.svg_select_shape {
  stroke-width: 1;
  stroke-dasharray: 10 10;
  stroke: black;
  stroke-opacity: 0.1;
  pointer-events: none;
  fill: none;
}

.svg_select_handle {
  stroke-width: 3;
  stroke: black;
  fill: none;
}

.svg_select_handle_r {
  cursor: e-resize;
}

.svg_select_handle_l {
  cursor: w-resize;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-menu-icon,
.apexcharts-pan-icon,
.apexcharts-reset-icon,
.apexcharts-selection-icon,
.apexcharts-toolbar-custom-icon,
.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6e8192;
  text-align: center
}

.apexcharts-menu-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg {
  fill: #6e8192
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(.76)
}

.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg,
.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg {
  fill: #f3f4f5
}

.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg {
  fill: #008ffb
}

.apexcharts-theme-light .apexcharts-menu-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg {
  fill: #333
}

.apexcharts-menu-icon,
.apexcharts-selection-icon {
  position: relative
}

.apexcharts-reset-icon {
  margin-left: 5px
}

.apexcharts-menu-icon,
.apexcharts-reset-icon,
.apexcharts-zoom-icon {
  transform: scale(.85)
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px
}

.apexcharts-pan-icon {
  transform: scale(.62);
  position: relative;
  left: 1px;
  top: 0
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6e8192;
  stroke-width: 2
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008ffb
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0 6px 2px;
  display: flex;
  justify-content: space-between;
  align-items: center
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: .15s ease all;
  pointer-events: none
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: .15s ease all
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, .7);
  color: #fff
}

@media screen and (min-width:768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1
  }
}

.apexcharts-canvas .apexcharts-element-hidden,
.apexcharts-datalabel.apexcharts-element-hidden,
.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-hidden-element-shown {
  opacity: 1;
  transition: 0.25s ease all;
}

.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value,
.apexcharts-datalabels,
.apexcharts-pie-label {
  cursor: default;
  pointer-events: none
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: .3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease
}

.apexcharts-radialbar-label {
  cursor: pointer;
}

.apexcharts-annotation-rect,
.apexcharts-area-series .apexcharts-area,
.apexcharts-gridline,
.apexcharts-line,
.apexcharts-point-annotation-label,
.apexcharts-radar-series path:not(.apexcharts-marker),
.apexcharts-radar-series polygon,
.apexcharts-toolbar svg,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-xaxis-annotation-label,
.apexcharts-yaxis-annotation-label,
.apexcharts-zoom-rect,
.no-pointer-events {
  pointer-events: none
}

.apexcharts-tooltip-active .apexcharts-marker {
  transition: .15s ease all
}

.apexcharts-radar-series .apexcharts-yaxis {
  pointer-events: none;
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
  height: 100%;
  width: 100%;
  overflow: hidden
}

.contract-trigger:before,
.resize-triggers,
.resize-triggers>div {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0
}

.resize-triggers>div {
  height: 100%;
  width: 100%;
  background: #eee;
  overflow: auto
}

.contract-trigger:before {
  overflow: hidden;
  width: 200%;
  height: 200%
}

.apexcharts-bar-goals-markers {
  pointer-events: none
}

.apexcharts-bar-shadows {
  pointer-events: none
}

.apexcharts-rangebar-goals-markers {
  pointer-events: none
}

.apexcharts-disable-transitions * {
  transition: none !important;
}`;var _=((b=e.opts.chart)===null||b===void 0?void 0:b.nonce)||e.w.config.chart.nonce;_&&y.setAttribute("nonce",_),A?h.prepend(y):r.head.appendChild(y)}var B=e.create(e.w.config.series,{});if(!B)return t(e);e.mount(B).then(function(){typeof e.w.config.chart.events.mounted=="function"&&e.w.config.chart.events.mounted(e,e.w),e.events.fireEvent("mounted",[e,e.w]),t(B)}).catch(function(I){s(I)})}else s(new Error("Element not found"))})}},{key:"create",value:function(e,t){var s=this,c=this.w;new wE(this).initModules();var h=this.w.globals;if(h.noData=!1,h.animationEnded=!1,!ni.elementExists(this.el)||(this.responsive.checkResponsiveConfig(t),c.config.xaxis.convertedCatToNumeric&&new Ky(c.config).convertCatToNumericXaxis(c.config,this.ctx),this.core.setupElements(),c.config.chart.type==="treemap"&&(c.config.grid.show=!1,c.config.yaxis[0].show=!1),h.svgWidth===0))return h.animationEnded=!0,null;var A=e;e.forEach(function(I,E){I.hidden&&(A=s.legend.legendHelpers.getSeriesAfterCollapsing({realIndex:E}))});var r=sl.checkComboSeries(A,c.config.chart.type);h.comboCharts=r.comboCharts,h.comboBarCount=r.comboBarCount;var y=A.every(function(I){return I.data&&I.data.length===0});(A.length===0||y&&h.collapsedSeries.length<1)&&this.series.handleNoData(),this.events.setupEventHandlers(),this.data.parseData(A),this.theme.init(),new wm(this).setGlobalMarkerSize(),this.formatters.setLabelFormatters(),this.titleSubtitle.draw(),h.noData&&h.collapsedSeries.length!==h.series.length&&!c.config.legend.showForSingleSeries||this.legend.init(),this.series.hasAllSeriesEqualX(),h.axisCharts&&(this.core.coreCalculations(),c.config.xaxis.type!=="category"&&this.formatters.setLabelFormatters(),this.ctx.toolbar.minX=c.globals.minX,this.ctx.toolbar.maxX=c.globals.maxX),this.formatters.heatmapLabelFormatters(),new sl(this).getLargestMarkerSize(),this.dimensions.plotCoords();var b=this.core.xySettings();this.grid.createGridMask();var _=this.core.plotChartType(A,b),B=new pm(this);return B.bringForward(),c.config.dataLabels.background.enabled&&B.dataLabelsBackground(),this.core.shiftGraphPosition(),c.globals.dataPoints>50&&c.globals.dom.elWrap.classList.add("apexcharts-disable-transitions"),{elGraph:_,xyRatios:b,dimensions:{plot:{left:c.globals.translateX,top:c.globals.translateY,width:c.globals.gridWidth,height:c.globals.gridHeight}}}}},{key:"mount",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=this,c=s.w;return new Promise(function(h,A){if(s.el===null)return A(new Error("Not enough data to display or target element not found"));(t===null||c.globals.allSeriesCollapsed)&&s.series.handleNoData(),s.grid=new mT(s);var r,y,b=s.grid.drawGrid();if(s.annotations=new ED(s),s.annotations.drawImageAnnos(),s.annotations.drawTextAnnos(),c.config.grid.position==="back"&&(b&&c.globals.dom.elGraphical.add(b.el),b!=null&&(r=b.elGridBorders)!==null&&r!==void 0&&r.node&&c.globals.dom.elGraphical.add(b.elGridBorders)),Array.isArray(t.elGraph))for(var _=0;_<t.elGraph.length;_++)c.globals.dom.elGraphical.add(t.elGraph[_]);else c.globals.dom.elGraphical.add(t.elGraph);c.config.grid.position==="front"&&(b&&c.globals.dom.elGraphical.add(b.el),b!=null&&(y=b.elGridBorders)!==null&&y!==void 0&&y.node&&c.globals.dom.elGraphical.add(b.elGridBorders)),c.config.xaxis.crosshairs.position==="front"&&s.crosshairs.drawXCrosshairs(),c.config.yaxis[0].crosshairs.position==="front"&&s.crosshairs.drawYCrosshairs(),c.config.chart.type!=="treemap"&&s.axes.drawAxis(c.config.chart.type,b);var B=new $y(e.ctx,b),I=new dw(e.ctx,b);if(b!==null&&(B.xAxisLabelCorrections(b.xAxisTickWidth),I.setYAxisTextAlignments(),c.config.yaxis.map(function(R,M){c.globals.ignoreYAxisIndexes.indexOf(M)===-1&&I.yAxisTitleRotate(M,R.opposite)})),s.annotations.drawAxesAnnotations(),!c.globals.noData){if(c.config.tooltip.enabled&&!c.globals.noData&&s.w.globals.tooltip.drawTooltip(t.xyRatios),c.globals.axisCharts&&(c.globals.isXNumeric||c.config.xaxis.convertedCatToNumeric||c.globals.isRangeBar))(c.config.chart.zoom.enabled||c.config.chart.selection&&c.config.chart.selection.enabled||c.config.chart.pan&&c.config.chart.pan.enabled)&&s.zoomPanSelection.init({xyRatios:t.xyRatios});else{var E=c.config.chart.toolbar.tools;["zoom","zoomin","zoomout","selection","pan","reset"].forEach(function(R){E[R]=!1})}c.config.chart.toolbar.show&&!c.globals.allSeriesCollapsed&&s.toolbar.createToolbar()}c.globals.memory.methodsToExec.length>0&&c.globals.memory.methodsToExec.forEach(function(R){R.method(R.params,!1,R.context)}),c.globals.axisCharts||c.globals.noData||s.core.resizeNonAxisCharts(),h(s)})}},{key:"destroy",value:function(){window.removeEventListener("resize",this.windowResizeHandler),function(t,s){var c=yb.get(s);c&&(c.disconnect(),yb.delete(s))}(this.el.parentNode,this.parentResizeHandler);var e=this.w.config.chart.id;e&&Apex._chartInstances.forEach(function(t,s){t.id===ni.escapeString(e)&&Apex._chartInstances.splice(s,1)}),new BE(this.ctx).clear({isUpdating:!1})}},{key:"updateOptions",value:function(e){var t=this,s=arguments.length>1&&arguments[1]!==void 0&&arguments[1],c=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],h=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],r=this.w;return r.globals.selection=void 0,this.lastUpdateOptions&&JSON.stringify(this.lastUpdateOptions)===JSON.stringify(e)?this:(this.lastUpdateOptions=ni.clone(e),e.series&&(this.series.resetSeries(!1,!0,!1),e.series.length&&e.series[0].data&&(e.series=e.series.map(function(y,b){return t.updateHelpers._extendSeries(y,b)})),this.updateHelpers.revertDefaultAxisMinMax()),e.xaxis&&(e=this.updateHelpers.forceXAxisUpdate(e)),e.yaxis&&(e=this.updateHelpers.forceYAxisUpdate(e)),r.globals.collapsedSeriesIndices.length>0&&this.series.clearPreviousPaths(),e.theme&&(e=this.theme.updateThemeOptions(e)),this.updateHelpers._updateOptions(e,s,c,h,A))}},{key:"updateSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];return this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(e,t,s)}},{key:"appendSeries",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],c=this.w.config.series.slice();return c.push(e),this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(c,t,s)}},{key:"appendData",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this;s.w.globals.dataChanged=!0,s.series.getPreviousPaths();for(var c=s.w.config.series.slice(),h=0;h<c.length;h++)if(e[h]!==null&&e[h]!==void 0)for(var A=0;A<e[h].data.length;A++)c[h].data.push(e[h].data[A]);return s.w.config.series=c,t&&(s.w.globals.initialSeries=ni.clone(s.w.config.series)),this.update()}},{key:"update",value:function(e){var t=this;return new Promise(function(s,c){if(t.lastUpdateOptions&&JSON.stringify(t.lastUpdateOptions)===JSON.stringify(e))return s(t);t.lastUpdateOptions=ni.clone(e),new BE(t.ctx).clear({isUpdating:!0});var h=t.create(t.w.config.series,e);if(!h)return s(t);t.mount(h).then(function(){typeof t.w.config.chart.events.updated=="function"&&t.w.config.chart.events.updated(t,t.w),t.events.fireEvent("updated",[t,t.w]),t.w.globals.isDirty=!0,s(t)}).catch(function(A){c(A)})})}},{key:"getSyncedCharts",value:function(){var e=this.getGroupedCharts(),t=[this];return e.length&&(t=[],e.forEach(function(s){t.push(s)})),t}},{key:"getGroupedCharts",value:function(){var e=this;return Apex._chartInstances.filter(function(t){if(t.group)return!0}).map(function(t){return e.w.config.chart.group===t.group?t.chart:e})}},{key:"toggleSeries",value:function(e){return this.series.toggleSeries(e)}},{key:"highlightSeriesOnLegendHover",value:function(e,t){return this.series.toggleSeriesOnHover(e,t)}},{key:"showSeries",value:function(e){this.series.showSeries(e)}},{key:"hideSeries",value:function(e){this.series.hideSeries(e)}},{key:"highlightSeries",value:function(e){this.series.highlightSeries(e)}},{key:"isSeriesHidden",value:function(e){this.series.isSeriesHidden(e)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.series.resetSeries(e,t)}},{key:"addEventListener",value:function(e,t){this.events.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.events.removeEventListener(e,t)}},{key:"addXaxisAnnotation",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addXaxisAnnotationExternal(e,t,c)}},{key:"addYaxisAnnotation",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addYaxisAnnotationExternal(e,t,c)}},{key:"addPointAnnotation",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,c=this;s&&(c=s),c.annotations.addPointAnnotationExternal(e,t,c)}},{key:"clearAnnotations",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,t=this;e&&(t=e),t.annotations.clearAnnotations(t)}},{key:"removeAnnotation",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=this;t&&(s=t),s.annotations.removeAnnotation(s,e)}},{key:"getChartArea",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner")}},{key:"getSeriesTotalXRange",value:function(e,t){return this.coreUtils.getSeriesTotalsXRange(e,t)}},{key:"getHighestValueInSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o1(this.ctx).getMinYMaxY(e).highestY}},{key:"getLowestValueInSeries",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o1(this.ctx).getMinYMaxY(e).lowestY}},{key:"getSeriesTotal",value:function(){return this.w.globals.seriesTotals}},{key:"toggleDataPointSelection",value:function(e,t){return this.updateHelpers.toggleDataPointSelection(e,t)}},{key:"zoomX",value:function(e,t){this.ctx.toolbar.zoomUpdateOptions(e,t)}},{key:"setLocale",value:function(e){this.localization.setCurrentLocaleValues(e)}},{key:"dataURI",value:function(e){return new Ly(this.ctx).dataURI(e)}},{key:"getSvgString",value:function(e){return new Ly(this.ctx).getSvgString(e)}},{key:"exportToCSV",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Ly(this.ctx).exportToCSV(e)}},{key:"paper",value:function(){return this.w.globals.dom.Paper}},{key:"_parentResizeCallback",value:function(){this.w.globals.animationEnded&&this.w.config.chart.redrawOnParentResize&&this._windowResize()}},{key:"_windowResize",value:function(){var e=this;clearTimeout(this.w.globals.resizeTimer),this.w.globals.resizeTimer=window.setTimeout(function(){e.w.globals.resized=!0,e.w.globals.dataChanged=!1,e.ctx.update()},150)}},{key:"_windowResizeHandler",value:function(){var e=this.w.config.chart.redrawOnWindowResize;typeof e=="function"&&(e=e()),e&&this._windowResize()}}],[{key:"getChartByID",value:function(e){var t=ni.escapeString(e);if(Apex._chartInstances){var s=Apex._chartInstances.filter(function(c){return c.id===t})[0];return s&&s.chart}}},{key:"initOnLoad",value:function(){for(var e=document.querySelectorAll("[data-apexcharts]"),t=0;t<e.length;t++)new a(e[t],JSON.parse(e[t].getAttribute("data-options"))).render()}},{key:"exec",value:function(e,t){var s=this.getChartByID(e);if(s){s.w.globals.isExecCalled=!0;var c=null;if(s.publicMethods.indexOf(t)!==-1){for(var h=arguments.length,A=new Array(h>2?h-2:0),r=2;r<h;r++)A[r-2]=arguments[r];c=s[t].apply(s,A)}return c}}},{key:"merge",value:function(e,t){return ni.extend(e,t)}}]),a}();const SE=["animationEnd","beforeMount","mounted","updated","click","mouseMove","mouseLeave","legendClick","markerClick","selection","dataPointSelection","dataPointMouseEnter","dataPointMouseLeave","beforeZoom","beforeResetZoom","zoomed","scrolled","brushScrolled"],Ea=G1({name:"apexchart",props:{options:{type:Object},type:{type:String},series:{type:Array,required:!0},width:{default:"100%"},height:{default:"auto"}},emits:SE,setup(a,{emit:e}){const t=sr(null),s=sr(null),c=oe=>oe&&typeof oe=="object"&&!Array.isArray(oe)&&oe!=null,h=(oe,me)=>{typeof Object.assign!="function"&&function(){Object.assign=function(Se){if(Se==null)throw new TypeError("Cannot convert undefined or null to object");let Me=Object(Se);for(let Re=1;Re<arguments.length;Re++){let Ze=arguments[Re];if(Ze!=null)for(let $e in Ze)Ze.hasOwnProperty($e)&&(Me[$e]=Ze[$e])}return Me}}();let Le=Object.assign({},oe);return c(oe)&&c(me)&&Object.keys(me).forEach(Se=>{c(me[Se])?Se in oe?Le[Se]=h(oe[Se],me[Se]):Object.assign(Le,{[Se]:me[Se]}):Object.assign(Le,{[Se]:me[Se]})}),Le},A=async()=>{if(await rv(),s.value)return;const oe={chart:{type:a.type||a.options.chart.type||"line",height:a.height,width:a.width,events:{}},series:a.series},me=a.options.chart?a.options.chart.events:null;SE.forEach(Se=>{let Me=(...Re)=>e(Se,...Re);oe.chart.events[Se]=(...Re)=>{Me(...Re),me&&me.hasOwnProperty(Se)&&me[Se](...Re)}});const Le=h(a.options,oe);return s.value=new CE(t.value,Le),s.value.render()},r=()=>(y(),A()),y=()=>{s.value.destroy(),s.value=null},b=(oe,me)=>s.value.updateSeries(oe,me),_=(oe,me,Le,Se)=>s.value.updateOptions(oe,me,Le,Se),B=oe=>s.value.toggleSeries(oe),I=oe=>{s.value.showSeries(oe)},E=oe=>{s.value.hideSeries(oe)},R=(oe,me)=>s.value.appendSeries(oe,me),M=()=>{s.value.resetSeries()},G=(oe,me)=>{s.value.toggleDataPointSelection(oe,me)},U=oe=>s.value.appendData(oe),Q=(oe,me)=>s.value.zoomX(oe,me),q=oe=>s.value.dataURI(oe),ne=oe=>s.value.setLocale(oe),re=(oe,me)=>{s.value.addXaxisAnnotation(oe,me)},pe=(oe,me)=>{s.value.addYaxisAnnotation(oe,me)},Ae=(oe,me)=>{s.value.addPointAnnotation(oe,me)},le=(oe,me)=>{s.value.removeAnnotation(oe,me)},be=()=>{s.value.clearAnnotations()};G5(()=>{window.ApexCharts=CE}),Ff(()=>{t.value=Ck().proxy.$el,A()}),W5(()=>{s.value&&y()});const we=D5(a);return QA(we.options,()=>{!s.value&&a.options?A():s.value.updateOptions(a.options)}),QA(we.series,()=>{!s.value&&a.series?A():s.value.updateSeries(a.series)},{deep:!0}),QA(we.type,()=>{r()}),QA(we.width,()=>{r()}),QA(we.height,()=>{r()}),{chart:s,init:A,refresh:r,destroy:y,updateOptions:_,updateSeries:b,toggleSeries:B,showSeries:I,hideSeries:E,resetSeries:M,zoomX:Q,toggleDataPointSelection:G,appendData:U,appendSeries:R,addXaxisAnnotation:re,addYaxisAnnotation:pe,addPointAnnotation:Ae,removeAnnotation:le,clearAnnotations:be,setLocale:ne,dataURI:q}},render(){return K1("div",{class:"vue-apexcharts"})}}),aO=a=>{a.component(Ea.name,Ea)};Ea.install=aO;const lO={class:"picklist"},cO={key:0},uO=["modelValue"],hO=["value"],dO={__name:"Picklist",props:{modelValue:[String,Number],label:String,options:{type:Array,required:!0}},emits:["update:modelValue"],setup(a){return(e,t)=>(yn(),Nn("div",lO,[a.label?(yn(),Nn("label",cO,Hn(a.label),1)):ym("",!0),ot("select",{modelValue:a.modelValue,onChange:t[0]||(t[0]=s=>e.$emit("update:modelValue",s.target.value))},[(yn(!0),Nn(Al,null,$d(a.options,s=>(yn(),Nn("option",{key:s.value,value:s.value},Hn(s.label),9,hO))),128))],40,uO)]))}},vy=ol(dO,[["__scopeId","data-v-85b96b99"]]),AO={class:"dashboard-tiempo-real"},fO={class:"header"},pO={class:"kpi-container"},gO={class:"value"},mO={class:"charts-section"},yO={class:"chart-item"},vO={class:"chart-item"},_O={class:"custom-charts-section"},xO={class:"custom-charts-header"},bO={class:"custom-controls"},wO={class:"custom-charts-container"},BO={class:"chart-item custom-chart"},CO={class:"chart-item custom-chart"},SO={class:"custom-charts-container"},EO={class:"chart-item custom-chart"},IO={class:"chart-item custom-chart"},TO={__name:"EnergiaChart",setup(a){const e=sr([{label:"Energía Total (kWh)",value:0},{label:"Potencia Instantánea (kW)",value:0},{label:"Frecuencia (Hz)",value:0}]),t=sr([{name:"Consumo",data:[]}]),s=sr({chart:{id:"realtime-consumo",animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:1e3}}},xaxis:{type:"datetime"},yaxis:{title:{text:"kWh"}},title:{text:"Consumo Energético"}}),c=sr([{name:"Potencia",data:[]}]),h=sr({chart:{id:"realtime-potencia",animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:1e3}}},xaxis:{type:"datetime"},yaxis:{title:{text:"kW"}},title:{text:"Potencia Activa"}});let A=null;function r(){const le=new Date().getTime(),be=+(Math.random()*10+40).toFixed(2),we=+(Math.random()*5+20).toFixed(2),oe=+(Math.random()*.2+49.8).toFixed(2);t.value[0].data.push({x:le,y:be}),c.value[0].data.push({x:le,y:we}),t.value[0].data.length>20&&t.value[0].data.shift(),c.value[0].data.length>20&&c.value[0].data.shift(),e.value[0].value=be,e.value[1].value=we,e.value[2].value=oe}Ff(()=>{r(),A=setInterval(r,2e3)}),Ny(()=>{clearInterval(A)});const y=[{value:"energia",label:"Energía (kWh)"},{value:"potencia",label:"Potencia (kW)"},{value:"voltaje",label:"Voltaje (V)"},{value:"corriente",label:"Corriente (A)"},{value:"voltaje_conjunto",label:"Conjunto Voltaje"},{value:"corriente_conjunto",label:"Conjunto Corriente"},{value:"potencia_conjunto",label:"Conjunto Potencia"}],b=sr("energia"),_=sr("potencia"),B=sr("voltaje_conjunto"),I=sr("corriente_conjunto"),E=sr([{name:"",data:[]}]),R=sr({chart:{id:"custom-chart-1",height:300},xaxis:{type:"datetime"},title:{text:"Gráfico de Energía (kWh)"}}),M=sr([{name:"",data:[]}]),G=sr({chart:{id:"custom-chart-2",height:300},xaxis:{type:"datetime"},title:{text:"Gráfico de Potencia (kW)"}}),U=sr([{name:"",data:[]}]),Q=sr({chart:{id:"custom-chart-3",height:300},xaxis:{type:"datetime"},title:{text:"Gráfico de Conjunto Voltaje"}}),q=sr([{name:"",data:[]}]),ne=sr({chart:{id:"custom-chart-4",height:300},xaxis:{type:"datetime"},title:{text:"Gráfico de Conjunto Corriente"}});function re(){const le=y.find(me=>me.value===b.value),be=y.find(me=>me.value===_.value),we=y.find(me=>me.value===B.value),oe=y.find(me=>me.value===I.value);E.value=[{name:le.label,data:[]}],M.value=[{name:be.label,data:[]}],U.value=[{name:we.label,data:[]}],q.value=[{name:oe.label,data:[]}],R.value={chart:{id:"custom-chart-1",height:300},xaxis:{type:"datetime"},title:{text:`Gráfico de ${le.label}`}},G.value={chart:{id:"custom-chart-2",height:300},xaxis:{type:"datetime"},title:{text:`Gráfico de ${be.label}`}},Q.value={chart:{id:"custom-chart-3",height:300},xaxis:{type:"datetime"},title:{text:`Gráfico de ${we.label}`}},ne.value={chart:{id:"custom-chart-4",height:300},xaxis:{type:"datetime"},title:{text:`Gráfico de ${oe.label}`}}}function pe(){const le=new Date().getTime();function be($e){switch($e){case"energia":return 100;case"potencia":return 50;case"voltaje":return 220;case"corriente":return 30;case"voltaje_conjunto":return 210;case"corriente_conjunto":return 28;case"potencia_conjunto":return 55;default:return 0}}const we=be(b.value),oe=+(we+(Math.random()*we*.2-we*.1)).toFixed(1);E.value[0].data.push({x:le,y:oe}),E.value[0].data.length>20&&E.value[0].data.shift();const me=be(_.value),Le=+(me+(Math.random()*me*.2-me*.1)).toFixed(1);M.value[0].data.push({x:le,y:Le}),M.value[0].data.length>20&&M.value[0].data.shift();const Se=be(B.value),Me=+(Se+(Math.random()*Se*.2-Se*.1)).toFixed(1);U.value[0].data.push({x:le,y:Me}),U.value[0].data.length>20&&U.value[0].data.shift();const Re=be(I.value),Ze=+(Re+(Math.random()*Re*.2-Re*.1)).toFixed(1);q.value[0].data.push({x:le,y:Ze}),q.value[0].data.length>20&&q.value[0].data.shift()}let Ae=null;return Ff(()=>{Ae=setInterval(pe,2e3)}),Ny(()=>{clearInterval(Ae)}),re(),(le,be)=>(yn(),Nn("div",AO,[ot("header",fO,[be[4]||(be[4]=ot("h2",null,"Dashboard de Tiempo Real – Nivel God",-1)),ot("div",pO,[(yn(!0),Nn(Al,null,$d(e.value,(we,oe)=>(yn(),Nn("div",{class:"kpi-card",key:oe},[ot("h3",null,Hn(we.label),1),ot("p",gO,Hn(we.value),1)]))),128))])]),ot("section",mO,[ot("div",yO,[be[5]||(be[5]=ot("h3",null,"Consumo Energético en Tiempo Real",-1)),Pn(Po(Ea),{type:"line",height:"300",options:s.value,series:t.value},null,8,["options","series"])]),ot("div",vO,[be[6]||(be[6]=ot("h3",null,"Potencia Activa en Tiempo Real",-1)),Pn(Po(Ea),{type:"line",height:"300",options:h.value,series:c.value},null,8,["options","series"])])]),ot("section",_O,[ot("header",xO,[be[7]||(be[7]=ot("h3",null,"Visualización Personalizada de Parámetros en Tiempo Real",-1)),ot("div",bO,[Pn(vy,{modelValue:b.value,"onUpdate:modelValue":be[0]||(be[0]=we=>b.value=we),options:y,label:"Parámetro Gráfico 1"},null,8,["modelValue"]),Pn(vy,{modelValue:_.value,"onUpdate:modelValue":be[1]||(be[1]=we=>_.value=we),options:y,label:"Parámetro Gráfico 2"},null,8,["modelValue"]),Pn(vy,{modelValue:B.value,"onUpdate:modelValue":be[2]||(be[2]=we=>B.value=we),options:y,label:"Parámetro Gráfico 3 (Conjunto)"},null,8,["modelValue"]),Pn(vy,{modelValue:I.value,"onUpdate:modelValue":be[3]||(be[3]=we=>I.value=we),options:y,label:"Parámetro Gráfico 4 (Conjunto)"},null,8,["modelValue"]),ot("button",{onClick:re},"Actualizar Gráficos")])]),ot("div",wO,[ot("div",BO,[(yn(),Wd(Po(Ea),{key:"custom-chart-1-"+b.value.value,type:"line",height:"300",options:R.value,series:E.value},null,8,["options","series"]))]),ot("div",CO,[(yn(),Wd(Po(Ea),{key:"custom-chart-2-"+_.value.value,type:"line",height:"300",options:G.value,series:M.value},null,8,["options","series"]))])]),ot("div",SO,[ot("div",EO,[(yn(),Wd(Po(Ea),{key:"custom-chart-3-"+B.value.value,type:"line",height:"300",options:Q.value,series:U.value},null,8,["options","series"]))]),ot("div",IO,[(yn(),Wd(Po(Ea),{key:"custom-chart-4-"+I.value.value,type:"line",height:"300",options:ne.value,series:q.value},null,8,["options","series"]))])])])]))}},TT=ol(TO,[["__scopeId","data-v-3b390790"]]),FO={class:"tiempo-real"},LO={__name:"TiempoReal",setup(a){return(e,t)=>(yn(),Nn("div",FO,[t[0]||(t[0]=ot("header",{class:"tiempo-real-header"},[ot("h1",null,"Vista en Tiempo Real"),ot("p",null,"Monitorea datos en vivo de tus medidores")],-1)),Pn(TT)]))}},MO=ol(LO,[["__scopeId","data-v-c183e687"]]),PO={__name:"Dashboard",setup(a){return(e,t)=>(yn(),Wd(TT))}},kO={class:"reportes"},RO={class:"filtros"},DO={__name:"Reportes",setup(a){const e=sr(""),t=sr(""),s=sr("");function c(){console.log("Descargando CSV",{desde:e.value,hasta:t.value,dispositivo:s.value})}return(h,A)=>(yn(),Nn("div",kO,[A[6]||(A[6]=ot("h2",null,"Generador de Reportes",-1)),ot("div",RO,[A[4]||(A[4]=ot("label",null,"Desde:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":A[0]||(A[0]=r=>e.value=r)},null,512),[[Zl,e.value]]),A[5]||(A[5]=ot("label",null,"Hasta:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":A[1]||(A[1]=r=>t.value=r)},null,512),[[Zl,t.value]]),ao(ot("select",{"onUpdate:modelValue":A[2]||(A[2]=r=>s.value=r)},A[3]||(A[3]=[ot("option",{value:""},"Todos los dispositivos",-1),ot("option",{value:"medidor1"},"Medidor 1",-1),ot("option",{value:"medidor2"},"Medidor 2",-1)]),512),[[c_,s.value]]),ot("button",{onClick:c},"Descargar CSV")])]))}},OO=ol(DO,[["__scopeId","data-v-0e39b692"]]),UO={};function zO(a,e){return yn(),Nn("div",null,e[0]||(e[0]=[ot("h2",null,"Configuración",-1),ot("p",null,"Ajustes y configuraciones del sistema.",-1)]))}const NO=ol(UO,[["render",zO]]),jO={class:"dashboard-header"},HO={__name:"DashboardHeader",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0}},setup(a){return(e,t)=>(yn(),Nn("header",jO,[ot("h1",null,Hn(a.title),1),ot("p",null,Hn(a.subtitle),1)]))}},FT=ol(HO,[["__scopeId","data-v-9a8a5023"]]),QO={class:"footer-global"},VO={__name:"FooterGlobal",setup(a){return(e,t)=>(yn(),Nn("footer",QO,t[0]||(t[0]=[ot("p",null,"© 2025 ® Derechos Reservados por ENERGÉTICA",-1)])))}},LT=ol(VO,[["__scopeId","data-v-9f6ed1a9"]]),GO={class:"modal-content"},WO={class:"checkbox-grid"},XO=["id","onUpdate:modelValue"],YO=["for"],KO={class:"group-buttons"},qO=["onClick"],$O=["onClick"],ZO={__name:"VariablesToggle",props:{visible:Boolean,initialSelected:Object},emits:["update:selected","close"],setup(a,{emit:e}){const t=a,s=e,c=[{group:"Tensiones",parameters:[{value:"tension1",label:"Tensión Fase 1"},{value:"tension2",label:"Tensión Fase 2"},{value:"tension3",label:"Tensión Fase 3"},{value:"tensionN",label:"Tensión Neutro"}]},{group:"Corrientes",parameters:[{value:"corriente1",label:"Corriente Fase 1"},{value:"corriente2",label:"Corriente Fase 2"},{value:"corriente3",label:"Corriente Fase 3"}]},{group:"Otros",parameters:[{value:"potenciaTotal",label:"Potencia Total"},{value:"energia",label:"Energía"},{value:"factorPotencia",label:"Factor de Potencia"},{value:"distorsion",label:"Distorsión Armónica"}]}],h=Eg({...t.initialSelected});function A(){c.forEach(I=>{I.parameters.forEach(E=>{h[E.value]=!0})})}function r(){c.forEach(I=>{I.parameters.forEach(E=>{h[E.value]=!1})})}function y(I){const E=c.find(R=>R.group===I);E&&E.parameters.forEach(R=>{h[R.value]=!0})}function b(I){const E=c.find(R=>R.group===I);E&&E.parameters.forEach(R=>{h[R.value]=!1})}function _(){s("update:selected",{...h}),B()}function B(){s("close")}return(I,E)=>a.visible?(yn(),Nn("div",{key:0,class:"modal-overlay",onClick:mI(B,["self"])},[ot("div",GO,[E[0]||(E[0]=ot("h2",null,"Selecciona parámetros",-1)),ot("div",{class:"global-buttons"},[ot("button",{onClick:A},"Seleccionar Todo"),ot("button",{onClick:r},"Limpiar Todo")]),(yn(),Nn(Al,null,$d(c,R=>ot("div",{key:R.group,class:"group"},[ot("h3",null,Hn(R.group),1),ot("div",WO,[(yn(!0),Nn(Al,null,$d(R.parameters,M=>(yn(),Nn("div",{key:M.value,class:"checkbox-item"},[ao(ot("input",{type:"checkbox",id:M.value,"onUpdate:modelValue":G=>h[M.value]=G},null,8,XO),[[Zk,h[M.value]]]),ot("label",{for:M.value},Hn(M.label),9,YO)]))),128))]),ot("div",KO,[ot("button",{onClick:M=>y(R.group)},"Seleccionar Todo",8,qO),ot("button",{onClick:M=>b(R.group)},"Limpiar Todo",8,$O)])])),64)),ot("div",{class:"modal-buttons"},[ot("button",{onClick:_},"Aplicar"),ot("button",{onClick:B},"Cancelar")])])])):ym("",!0)}},JO=ol(ZO,[["__scopeId","data-v-6f0f1d94"]]),eU={class:"statistical-chart"},tU={key:1},f0=10,iU={__name:"StatisticalDistributionChart",props:{data:{type:Array,required:!0}},setup(a){const e=a,t=qa(()=>e.data.map(_=>typeof _=="object"&&_!==null&&"y"in _?Number(_.y):Number(_)).filter(_=>!isNaN(_)).sort((_,B)=>_-B)),s=qa(()=>t.value[0]??0),c=qa(()=>{const _=t.value[t.value.length-1];return _!==void 0?_:1}),h=qa(()=>{const _=(c.value-s.value)/f0;return _===0?1:_}),A=qa(()=>{const _=new Array(f0).fill(0);return t.value.forEach(B=>{let I=Math.floor((B-s.value)/h.value);I===f0&&(I=f0-1),_[I]++}),_.map((B,I)=>{const R=s.value+I*h.value+h.value/2;return{x:Number(R.toFixed(2)),y:B}})}),r=qa(()=>{const _=A.value;let B=0;const I=_.map(R=>(B+=R.y,{x:R.x,y:B})),E=B;return I.map(R=>({x:R.x,y:Number((R.y/E*100).toFixed(2))}))}),y=qa(()=>[{name:"Histograma",type:"column",data:A.value,color:"#2980b9"},{name:"CDF",type:"line",data:r.value,color:"#e74c3c"}]),b=qa(()=>({chart:{toolbar:{show:!0},zoom:{enabled:!1}},stroke:{curve:"smooth"},dataLabels:{enabled:!1},xaxis:{type:"numeric",title:{text:"Valor"}},yaxis:[{title:{text:"Frecuencia"},min:0},{opposite:!0,title:{text:"Cumulative (%)"},max:100}],tooltip:{shared:!0},plotOptions:{bar:{columnWidth:"50%"}},legend:{show:!0}}));return(_,B)=>(yn(),Nn("div",eU,[e.data.length>0?(yn(),Wd(Po(Ea),{key:0,type:"line",height:"320",options:b.value,series:y.value},null,8,["options","series"])):(yn(),Nn("p",tU,"No hay datos para mostrar"))]))}},rU=ol(iU,[["__scopeId","data-v-c369d9eb"]]),nU={class:"trends-dashboard"},sU={class:"config-panel"},oU={class:"date-filters"},aU={class:"variable-and-layout"},lU={class:"layout-mode"},cU={key:0,class:"combined-chart"},uU={class:"chart-container"},hU={class:"stats-box"},dU={key:1,class:"separated-charts"},AU={class:"trend-chart"},fU=["onClick"],pU={class:"stats-box"},gU={class:"statistical-chart"},mU={key:2,class:"no-data"},yU={__name:"Tendencias",setup(a){const e=sr([{value:"tension1",label:"Voltage A"},{value:"tension2",label:"Voltage B"},{value:"tension3",label:"Voltage C"},{value:"tensionN",label:"Neutro"},{value:"corriente1",label:"Corriente Fase 1"},{value:"corriente2",label:"Corriente Fase 2"},{value:"corriente3",label:"Corriente Fase 3"},{value:"potenciaTotal",label:"Potencia Total"},{value:"energia",label:"Energía"},{value:"factorPotencia",label:"Factor de Potencia"},{value:"distorsion",label:"Distorsión Armónica"}]),t=sr(ba().subtract(7,"day").format("YYYY-MM-DD")),s=sr(ba().format("YYYY-MM-DD")),c=sr({tension1:!0,tension2:!1,tension3:!1,tensionN:!1,corriente1:!1,corriente2:!1,corriente3:!1,potenciaTotal:!1,energia:!1,factorPotencia:!1,distorsion:!1}),h=sr("combinado"),A=sr(!1),r=sr(null),y={tension1:"#e74c3c",tension2:"#2980b9",tension3:"#27ae60",tensionN:"#8e44ad",corriente1:"#f39c12",corriente2:"#d35400",corriente3:"#16a085",potenciaTotal:"#2ecc71",energia:"#f1c40f",factorPotencia:"#3498db",distorsion:"#95a5a6"},b={tension1:"#f1948a",tension2:"#85c1e9",tension3:"#58d68d"},_=sr([]),B=sr(null),I=sr({});function E(ct,Qe){Qe&&(I.value[ct]=Qe)}const R=sr({chart:{id:"combined-chart",zoom:{enabled:!0},toolbar:{show:!0},events:{zoomed:(ct,{xaxis:Qe})=>{r.value={min:Qe.min,max:Qe.max}},beforeResetZoom:()=>{r.value=null}}},stroke:{curve:"smooth"},xaxis:{type:"datetime"},yaxis:[]}),M=sr({chart:{zoom:{enabled:!0},toolbar:{show:!0},events:{zoomed:(ct,{xaxis:Qe})=>{r.value={min:Qe.min,max:Qe.max}},beforeResetZoom:()=>{r.value=null}}},stroke:{curve:"smooth"},xaxis:{type:"datetime"}}),G=sr([]),U=sr([]),Q=qa(()=>"combined-"+JSON.stringify(G.value)),q=ct=>"separated-"+ct.name+"-"+JSON.stringify(ct.data);function ne(ct,Qe=10){if(!ct.length)return[];const It=2/(Qe+1),Ce=[];let Je=ct[0].y;Ce.push({x:ct[0].x,y:Number(Je.toFixed(2))});for(let lt=1;lt<ct.length;lt++){const mt=ct[lt].y*It+Je*(1-It);Ce.push({x:ct[lt].x,y:Number(mt.toFixed(2))}),Je=mt}return Ce}function re(){_.value=[];const ct=ba(t.value),It=ba(s.value).diff(ct,"day")+1;for(let Ce=0;Ce<It;Ce++)for(let Je=0;Je<24;Je++){const lt=ct.add(Ce,"day").hour(Je).minute(0).second(0).valueOf();_.value.push({timestamp:lt,tension1:+(220+Math.random()*10-5).toFixed(1),tension2:+(220+Math.random()*10-5).toFixed(1),tension3:+(220+Math.random()*10-5).toFixed(1),tensionN:+(110+Math.random()*5-2.5).toFixed(1),corriente1:+(5+Math.random()*2-1).toFixed(1),corriente2:+(5+Math.random()*2-1).toFixed(1),corriente3:+(5+Math.random()*2-1).toFixed(1),potenciaTotal:+(50+Math.random()*20-10).toFixed(1),energia:+(50+Math.random()*20-10).toFixed(1),factorPotencia:+(.8+Math.random()*.2).toFixed(2),distorsion:+(5+Math.random()*3).toFixed(1)})}}function pe(){const ct=[],Qe=Object.values(c.value).filter(Je=>Je).length;for(const Je in c.value)if(c.value[Je]){const lt=e.value.find(rt=>rt.value===Je),mt=lt?lt.label:Je,Bt=_.value.map(rt=>({x:rt.timestamp,y:rt[Je]}));ct.push({name:mt,data:Bt,color:y[Je]}),Qe===1&&ct.push({name:mt+" EMA",data:ne(Bt,10),color:b[Je]||"#bdc3c7",type:"area",fill:{opacity:.3}})}G.value=ct;const It={title:{text:"Magnitudes Básicas"}},Ce={opposite:!0,title:{text:"Magnitudes Eléctricas"}};c.value.tension1||c.value.tension2||c.value.tension3||c.value.corriente1||c.value.corriente2||c.value.corriente3?R.value.yaxis=[It,Ce]:R.value.yaxis=[It]}function Ae(){const ct=[];for(const Qe in c.value)if(c.value[Qe]){const It=e.value.find(lt=>lt.value===Qe),Ce=It?It.label:Qe,Je=_.value.map(lt=>({x:lt.timestamp,y:lt[Qe]}));["tension1","tension2","tension3"].includes(Qe)?ct.push([{name:Ce,data:Je,color:y[Qe]},{name:Ce+" EMA",data:ne(Je,10),color:b[Qe],type:"area",fill:{opacity:.3}}]):ct.push([{name:Ce,data:Je,color:y[Qe]}])}U.value=ct}function le(){re(),pe(),Ae()}function be(){let ct="data:text/csv;charset=utf-8,";ct+=`timestamp,tension1,tension2,tension3,tensionN,corriente1,corriente2,corriente3,potenciaTotal,energia,factorPotencia,distorsion
`,_.value.forEach(Ce=>{ct+=`${Ce.timestamp},${Ce.tension1},${Ce.tension2},${Ce.tension3},${Ce.tensionN},${Ce.corriente1},${Ce.corriente2},${Ce.corriente3},${Ce.potenciaTotal},${Ce.energia},${Ce.factorPotencia},${Ce.distorsion}
`});const Qe=encodeURI(ct),It=document.createElement("a");It.setAttribute("href",Qe),It.setAttribute("download","datos_tendencias.csv"),document.body.appendChild(It),It.click(),document.body.removeChild(It)}function we(){const ct={desde:t.value,hasta:s.value,selectedVariables:{...c.value},layoutMode:h.value};localStorage.setItem("dashboardConfig",JSON.stringify(ct)),alert("Configuración guardada")}function oe(){localStorage.removeItem("dashboardConfig"),c.value={tension1:!0,tension2:!1,tension3:!1,tensionN:!1,corriente1:!1,corriente2:!1,corriente3:!1,potenciaTotal:!1,energia:!1,factorPotencia:!1,distorsion:!1},le(),alert("Configuración limpiada")}function me(ct){c.value=ct,le(),A.value=!1}Ff(()=>{const ct=localStorage.getItem("dashboardConfig");if(ct){const Qe=JSON.parse(ct);t.value=Qe.desde,s.value=Qe.hasta,c.value=Qe.selectedVariables,h.value=Qe.layoutMode}le()});function Le(ct){if(!ct.length)return{min:"-",p5:"-",average:"-",p95:"-",max:"-"};const Qe=[...ct].sort((Bt,rt)=>Bt-rt),It=Qe[0],Ce=Qe[Qe.length-1],Je=Qe.reduce((Bt,rt)=>Bt+rt,0)/Qe.length,lt=Se(Qe,5),mt=Se(Qe,95);return{min:Number(It).toFixed(2),p5:Number(lt).toFixed(2),average:Number(Je).toFixed(2),p95:Number(mt).toFixed(2),max:Number(Ce).toFixed(2)}}function Se(ct,Qe){const It=Qe/100*(ct.length-1),Ce=Math.floor(It),Je=Math.ceil(It);return Ce===Je?ct[Ce]:ct[Ce]+(ct[Je]-ct[Ce])*(It-Ce)}function Me(ct){if(!ct||!ct.data)return{};let Qe=ct.data;r.value&&(Qe=Qe.filter(Ce=>Ce.x>=r.value.min&&Ce.x<=r.value.max));const It=Qe.map(Ce=>Ce.y).filter(Ce=>typeof Ce=="number");return Le(It)}R.value.chart.events={zoomed:(ct,{xaxis:Qe})=>{r.value={min:Qe.min,max:Qe.max}},beforeResetZoom:()=>{r.value=null}},M.value.chart.events={zoomed:(ct,{xaxis:Qe})=>{r.value={min:Qe.min,max:Qe.max}},beforeResetZoom:()=>{r.value=null}};function Re(ct){return r.value&&r.value.min&&r.value.max?ct.filter(Qe=>Qe.x>=r.value.min&&Qe.x<=r.value.max):ct}async function Ze(){try{const It=(await B.value.dataURI()).blob;await navigator.clipboard.write([new ClipboardItem({"image/png":It})]),alert("Imagen copiada al portapapeles")}catch(ct){alert("Error copiando imagen: "+ct)}}async function $e(ct){try{const Qe=I.value[ct.name];if(Qe&&Qe.dataURI){const Ce=(await Qe.dataURI()).blob;await navigator.clipboard.write([new ClipboardItem({"image/png":Ce})]),alert("Imagen copiada al portapapeles")}else alert("No se encontró el gráfico para copiar.")}catch(Qe){alert("Error copiando imagen: "+Qe)}}return(ct,Qe)=>(yn(),Nn("div",nU,[Pn(FT,{title:"Tendencias en Estado Estable",subtitle:"Visualización personalizada de variables"}),ot("div",sU,[ot("div",oU,[ot("label",null,[Qe[6]||(Qe[6]=xp("Desde: ")),ao(ot("input",{type:"date","onUpdate:modelValue":Qe[0]||(Qe[0]=It=>t.value=It)},null,512),[[Zl,t.value]])]),ot("label",null,[Qe[7]||(Qe[7]=xp("Hasta: ")),ao(ot("input",{type:"date","onUpdate:modelValue":Qe[1]||(Qe[1]=It=>s.value=It)},null,512),[[Zl,s.value]])])]),ot("div",aU,[ot("button",{class:"btn-config",onClick:Qe[2]||(Qe[2]=It=>A.value=!0)}," Configurar Variables "),ot("div",lU,[Qe[10]||(Qe[10]=ot("span",null,"Modo:",-1)),ot("label",null,[ao(ot("input",{type:"radio",value:"combinado","onUpdate:modelValue":Qe[3]||(Qe[3]=It=>h.value=It)},null,512),[[PS,h.value]]),Qe[8]||(Qe[8]=xp(" Combinado "))]),ot("label",null,[ao(ot("input",{type:"radio",value:"separado","onUpdate:modelValue":Qe[4]||(Qe[4]=It=>h.value=It)},null,512),[[PS,h.value]]),Qe[9]||(Qe[9]=xp(" Separado "))])])]),ot("div",{class:"config-buttons"},[ot("button",{onClick:le},"Filtrar Datos"),ot("button",{onClick:be},"Exportar CSV"),ot("button",{onClick:we},"Guardar Configuración"),ot("button",{onClick:oe},"Limpiar Configuración")])]),h.value==="combinado"&&G.value.length>0?(yn(),Nn("div",cU,[ot("div",uU,[(yn(),Wd(Po(Ea),{ref_key:"combinedChartRef",ref:B,key:Q.value,type:"line",height:"400",options:R.value,series:G.value},null,8,["options","series"])),ot("button",{class:"copy-button",onClick:Ze}," Copiar imagenes ")]),ot("div",hU,[ot("table",null,[Qe[11]||(Qe[11]=ot("thead",null,[ot("tr",null,[ot("th",null,"Parámetro"),ot("th",null,"Mínimo"),ot("th",null,"Percentil 5"),ot("th",null,"Promedio"),ot("th",null,"Percentil 95"),ot("th",null,"Máximo")])],-1)),ot("tbody",null,[(yn(!0),Nn(Al,null,$d(G.value,It=>(yn(),Nn("tr",{key:It.name},[ot("td",null,Hn(It.name),1),ot("td",null,Hn(Me(It).min),1),ot("td",null,Hn(Me(It).p5),1),ot("td",null,Hn(Me(It).average),1),ot("td",null,Hn(Me(It).p95),1),ot("td",null,Hn(Me(It).max),1)]))),128))])])])])):h.value==="separado"&&U.value.length>0?(yn(),Nn("div",dU,[(yn(!0),Nn(Al,null,$d(U.value,(It,Ce)=>(yn(),Nn("div",{key:Ce,class:"trend-gaussian-container"},[ot("div",AU,[ot("h3",null,Hn(It[0].name),1),(yn(),Wd(Po(Ea),{ref_for:!0,ref:Je=>E(It[0].name,Je),key:q(It[0]),type:"line",height:"320",options:M.value,series:It},null,8,["options","series"])),ot("button",{class:"copy-button",onClick:Je=>$e(It[0])}," Copiar imagenes ",8,fU),ot("div",pU,[ot("table",null,[Qe[12]||(Qe[12]=ot("thead",null,[ot("tr",null,[ot("th",null,"Parámetro"),ot("th",null,"Mínimo"),ot("th",null,"Percentil 5"),ot("th",null,"Promedio"),ot("th",null,"Percentil 95"),ot("th",null,"Máximo")])],-1)),ot("tbody",null,[ot("tr",null,[ot("td",null,Hn(It[0].name),1),ot("td",null,Hn(Me(It[0]).min),1),ot("td",null,Hn(Me(It[0]).p5),1),ot("td",null,Hn(Me(It[0]).average),1),ot("td",null,Hn(Me(It[0]).p95),1),ot("td",null,Hn(Me(It[0]).max),1)])])])])]),ot("div",gU,[Pn(rU,{data:Re(It[0].data)},null,8,["data"])])]))),128))])):(yn(),Nn("div",mU,Qe[13]||(Qe[13]=[ot("p",null,"No hay datos para mostrar.",-1)]))),A.value?(yn(),Wd(JO,{key:3,visible:A.value,initialSelected:c.value,"onUpdate:selected":me,onClose:Qe[5]||(Qe[5]=It=>A.value=!1)},null,8,["visible","initialSelected"])):ym("",!0),Pn(LT)]))}},vU=ol(yU,[["__scopeId","data-v-001c6727"]]),_U={class:"dashboard-anomalias"},xU={class:"header"},bU={class:"controls"},wU={class:"fecha-control"},BU={class:"umbrales"},CU={class:"metrics"},SU={class:"card"},EU={class:"value"},IU={class:"card"},TU={class:"value"},FU={class:"card"},LU={class:"value"},MU={class:"card"},PU={class:"value"},kU={class:"trend-chart"},RU={class:"incidents-table"},DU={class:"heatmap-chart"},OU={__name:"Anomalias",setup(a){const e=sr("energia"),t=sr(ba().subtract(7,"day").format("YYYY-MM-DD")),s=sr(ba().format("YYYY-MM-DD")),c=sr(30),h=sr(70),A=sr(0),r=sr(0),y=sr(0),b=sr(0),_=sr([]),B=sr({chart:{id:"trend-anomalias"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},markers:{size:6,strokeWidth:2,strokeColors:"#fff"},title:{text:"Tendencia del Parámetro con Anomalías"}}),I=sr([]),E=sr([]),R=sr({chart:{id:"heatmap-anomalias"},plotOptions:{heatmap:{shadeIntensity:.5,radius:4}},dataLabels:{enabled:!1},xaxis:{type:"category",categories:Array.from({length:24},(G,U)=>`${U}h`)},title:{text:"Distribución Horaria de Anomalías"}});function M(){I.value=[];const G=[];let U=0,Q=0,q=0,ne=0;const re=ba(t.value),Ae=ba(s.value).diff(re,"day")+1;for(let we=0;we<Ae;we++){const oe=re.add(we,"day"),me=50,Le=Math.random()*20-10,Se=+(me+Le).toFixed(1);if(G.push({x:oe.valueOf(),y:Se}),Se<c.value||Se>h.value){let Me=0,Re="";Se<c.value?(Me=+((c.value-Se)/c.value*100).toFixed(1),Re="Baja"):Se>h.value&&(Me=+((Se-h.value)/h.value*100).toFixed(1),Re="Alta");const Ze=Math.floor(Math.random()*60)+1;I.value.push({fecha:oe.format("YYYY-MM-DD"),valor:Se,umbral:Se<c.value?c.value:h.value,desviacion:Me,duracion:Ze,tipo:Re}),U+=Me,Q+=Ze,q++,Me>ne&&(ne=Me)}}A.value=q,q>0?(r.value=+(U/q).toFixed(1),b.value=Math.floor(Q/q),y.value=ne):(r.value=0,b.value=0,y.value=0),_.value=[{name:e.value,data:G.map(we=>{const oe=we.y<c.value||we.y>h.value;return{x:we.x,y:we.y,marker:oe?{fillColor:"#FF0000",size:8}:{}}})}];const le=[],be=Math.min(Ae,7);for(let we=0;we<be;we++){const oe=[];for(let me=0;me<24;me++)oe.push({x:`${me}h`,y:Math.floor(Math.random()*6)});le.push({name:`Día ${we+1}`,data:oe})}E.value=le}return M(),(G,U)=>(yn(),Nn("div",_U,[ot("header",xU,[U[11]||(U[11]=ot("h2",null,"Dashboard de Anomalías",-1)),ot("div",bU,[U[10]||(U[10]=ot("label",null,"Parámetro:",-1)),ao(ot("select",{"onUpdate:modelValue":U[0]||(U[0]=Q=>e.value=Q)},U[5]||(U[5]=[ot("option",{value:"energia"},"Energía (kWh)",-1),ot("option",{value:"potencia"},"Potencia (kW)",-1),ot("option",{value:"voltaje"},"Voltaje (V)",-1)]),512),[[c_,e.value]]),ot("div",wU,[U[6]||(U[6]=ot("label",null,"Desde:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":U[1]||(U[1]=Q=>t.value=Q)},null,512),[[Zl,t.value]]),U[7]||(U[7]=ot("label",null,"Hasta:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":U[2]||(U[2]=Q=>s.value=Q)},null,512),[[Zl,s.value]])]),ot("div",BU,[U[8]||(U[8]=ot("label",null,"Umbral Inferior:",-1)),ao(ot("input",{type:"number","onUpdate:modelValue":U[3]||(U[3]=Q=>c.value=Q),placeholder:"Valor inferior"},null,512),[[Zl,c.value]]),U[9]||(U[9]=ot("label",null,"Umbral Superior:",-1)),ao(ot("input",{type:"number","onUpdate:modelValue":U[4]||(U[4]=Q=>h.value=Q),placeholder:"Valor superior"},null,512),[[Zl,h.value]])]),ot("button",{onClick:M},"Analizar")])]),ot("section",CU,[ot("div",SU,[U[12]||(U[12]=ot("h3",null,"Total de Anomalías",-1)),ot("p",EU,Hn(A.value),1)]),ot("div",IU,[U[13]||(U[13]=ot("h3",null,"Desviación Promedio",-1)),ot("p",TU,Hn(r.value)+"%",1)]),ot("div",FU,[U[14]||(U[14]=ot("h3",null,"Máxima Desviación",-1)),ot("p",LU,Hn(y.value)+"%",1)]),ot("div",MU,[U[15]||(U[15]=ot("h3",null,"Duración Promedio",-1)),ot("p",PU,Hn(b.value)+" min",1)])]),ot("section",kU,[U[16]||(U[16]=ot("h3",null,"Tendencia del Parámetro con Anomalías",-1)),Pn(Po(Ea),{type:"line",height:"300",options:B.value,series:_.value},null,8,["options","series"])]),ot("section",RU,[U[18]||(U[18]=ot("h3",null,"Tabla de Incidentes",-1)),ot("table",null,[U[17]||(U[17]=ot("thead",null,[ot("tr",null,[ot("th",null,"Fecha y Hora"),ot("th",null,"Valor Medido"),ot("th",null,"Umbral"),ot("th",null,"Desviación (%)"),ot("th",null,"Tipo")])],-1)),ot("tbody",null,[(yn(!0),Nn(Al,null,$d(I.value,(Q,q)=>(yn(),Nn("tr",{key:q},[ot("td",null,Hn(Q.fecha),1),ot("td",null,Hn(Q.valor),1),ot("td",null,Hn(Q.umbral),1),ot("td",null,Hn(Q.desviacion)+"%",1),ot("td",null,Hn(Q.tipo),1)]))),128))])])]),ot("section",DU,[U[19]||(U[19]=ot("h3",null,"Distribución Horaria de Anomalías",-1)),Pn(Po(Ea),{type:"heatmap",height:"300",options:R.value,series:E.value},null,8,["options","series"])])]))}},UU=ol(OU,[["__scopeId","data-v-27bca5b5"]]);var vb={exports:{}};function Wo(a){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wo(a)}var lu=Uint8Array,Uh=Uint16Array,Aw=Int32Array,p_=new lu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),g_=new lu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d1=new lu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MT=function(a,e){for(var t=new Uh(31),s=0;s<31;++s)t[s]=e+=1<<a[s-1];for(var c=new Aw(t[30]),s=1;s<30;++s)for(var h=t[s];h<t[s+1];++h)c[h]=h-t[s]<<5|s;return{b:t,r:c}},PT=MT(p_,2),kT=PT.b,A1=PT.r;kT[28]=258,A1[258]=28;var RT=MT(g_,0),zU=RT.b,EE=RT.r,f1=new Uh(32768);for(var Ia=0;Ia<32768;++Ia){var Ap=(Ia&43690)>>1|(Ia&21845)<<1;Ap=(Ap&52428)>>2|(Ap&13107)<<2,Ap=(Ap&61680)>>4|(Ap&3855)<<4,f1[Ia]=((Ap&65280)>>8|(Ap&255)<<8)>>1}var WA=function(a,e,t){for(var s=a.length,c=0,h=new Uh(e);c<s;++c)a[c]&&++h[a[c]-1];var A=new Uh(e);for(c=1;c<e;++c)A[c]=A[c-1]+h[c-1]<<1;var r;if(t){r=new Uh(1<<e);var y=15-e;for(c=0;c<s;++c)if(a[c])for(var b=c<<4|a[c],_=e-a[c],B=A[a[c]-1]++<<_,I=B|(1<<_)-1;B<=I;++B)r[f1[B]>>y]=b}else for(r=new Uh(s),c=0;c<s;++c)a[c]&&(r[c]=f1[A[a[c]-1]++]>>15-a[c]);return r},Pp=new lu(288);for(var Ia=0;Ia<144;++Ia)Pp[Ia]=8;for(var Ia=144;Ia<256;++Ia)Pp[Ia]=9;for(var Ia=256;Ia<280;++Ia)Pp[Ia]=7;for(var Ia=280;Ia<288;++Ia)Pp[Ia]=8;var Zy=new lu(32);for(var Ia=0;Ia<32;++Ia)Zy[Ia]=5;var NU=WA(Pp,9,0),jU=WA(Pp,9,1),HU=WA(Zy,5,0),QU=WA(Zy,5,1),_b=function(a){for(var e=a[0],t=1;t<a.length;++t)a[t]>e&&(e=a[t]);return e},Hd=function(a,e,t){var s=e/8|0;return(a[s]|a[s+1]<<8)>>(e&7)&t},xb=function(a,e){var t=e/8|0;return(a[t]|a[t+1]<<8|a[t+2]<<16)>>(e&7)},fw=function(a){return(a+7)/8|0},DT=function(a,e,t){return(t==null||t>a.length)&&(t=a.length),new lu(a.subarray(e,t))},VU=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Gd=function(a,e,t){var s=new Error(e||VU[a]);if(s.code=a,Error.captureStackTrace&&Error.captureStackTrace(s,Gd),!t)throw s;return s},GU=function(a,e,t,s){var c=a.length,h=0;if(!c||e.f&&!e.l)return t||new lu(0);var A=!t,r=A||e.i!=2,y=e.i;A&&(t=new lu(c*3));var b=function(mi){var ze=t.length;if(mi>ze){var Ve=new lu(Math.max(ze*2,mi));Ve.set(t),t=Ve}},_=e.f||0,B=e.p||0,I=e.b||0,E=e.l,R=e.d,M=e.m,G=e.n,U=c*8;do{if(!E){_=Hd(a,B,1);var Q=Hd(a,B+1,3);if(B+=3,Q)if(Q==1)E=jU,R=QU,M=9,G=5;else if(Q==2){var pe=Hd(a,B,31)+257,Ae=Hd(a,B+10,15)+4,le=pe+Hd(a,B+5,31)+1;B+=14;for(var be=new lu(le),we=new lu(19),oe=0;oe<Ae;++oe)we[d1[oe]]=Hd(a,B+oe*3,7);B+=Ae*3;for(var me=_b(we),Le=(1<<me)-1,Se=WA(we,me,1),oe=0;oe<le;){var Me=Se[Hd(a,B,Le)];B+=Me&15;var q=Me>>4;if(q<16)be[oe++]=q;else{var Re=0,Ze=0;for(q==16?(Ze=3+Hd(a,B,3),B+=2,Re=be[oe-1]):q==17?(Ze=3+Hd(a,B,7),B+=3):q==18&&(Ze=11+Hd(a,B,127),B+=7);Ze--;)be[oe++]=Re}}var $e=be.subarray(0,pe),ct=be.subarray(pe);M=_b($e),G=_b(ct),E=WA($e,M,1),R=WA(ct,G,1)}else Gd(1);else{var q=fw(B)+4,ne=a[q-4]|a[q-3]<<8,re=q+ne;if(re>c){y&&Gd(0);break}r&&b(I+ne),t.set(a.subarray(q,re),I),e.b=I+=ne,e.p=B=re*8,e.f=_;continue}if(B>U){y&&Gd(0);break}}r&&b(I+131072);for(var Qe=(1<<M)-1,It=(1<<G)-1,Ce=B;;Ce=B){var Re=E[xb(a,B)&Qe],Je=Re>>4;if(B+=Re&15,B>U){y&&Gd(0);break}if(Re||Gd(2),Je<256)t[I++]=Je;else if(Je==256){Ce=B,E=null;break}else{var lt=Je-254;if(Je>264){var oe=Je-257,mt=p_[oe];lt=Hd(a,B,(1<<mt)-1)+kT[oe],B+=mt}var Bt=R[xb(a,B)&It],rt=Bt>>4;Bt||Gd(3),B+=Bt&15;var ct=zU[rt];if(rt>3){var mt=g_[rt];ct+=xb(a,B)&(1<<mt)-1,B+=mt}if(B>U){y&&Gd(0);break}r&&b(I+131072);var St=I+lt;if(I<ct){var vt=h-ct,Gt=Math.min(ct,St);for(vt+I<0&&Gd(3);I<Gt;++I)t[I]=s[vt+I]}for(;I<St;++I)t[I]=t[I-ct]}}e.l=E,e.p=Ce,e.b=I,e.f=_,E&&(_=1,e.m=M,e.d=R,e.n=G)}while(!_);return I!=t.length&&A?DT(t,0,I):t.subarray(0,I)},bf=function(a,e,t){t<<=e&7;var s=e/8|0;a[s]|=t,a[s+1]|=t>>8},Ay=function(a,e,t){t<<=e&7;var s=e/8|0;a[s]|=t,a[s+1]|=t>>8,a[s+2]|=t>>16},bb=function(a,e){for(var t=[],s=0;s<a.length;++s)a[s]&&t.push({s,f:a[s]});var c=t.length,h=t.slice();if(!c)return{t:UT,l:0};if(c==1){var A=new lu(t[0].s+1);return A[t[0].s]=1,{t:A,l:1}}t.sort(function(re,pe){return re.f-pe.f}),t.push({s:-1,f:25001});var r=t[0],y=t[1],b=0,_=1,B=2;for(t[0]={s:-1,f:r.f+y.f,l:r,r:y};_!=c-1;)r=t[t[b].f<t[B].f?b++:B++],y=t[b!=_&&t[b].f<t[B].f?b++:B++],t[_++]={s:-1,f:r.f+y.f,l:r,r:y};for(var I=h[0].s,s=1;s<c;++s)h[s].s>I&&(I=h[s].s);var E=new Uh(I+1),R=p1(t[_-1],E,0);if(R>e){var s=0,M=0,G=R-e,U=1<<G;for(h.sort(function(pe,Ae){return E[Ae.s]-E[pe.s]||pe.f-Ae.f});s<c;++s){var Q=h[s].s;if(E[Q]>e)M+=U-(1<<R-E[Q]),E[Q]=e;else break}for(M>>=G;M>0;){var q=h[s].s;E[q]<e?M-=1<<e-E[q]++-1:++s}for(;s>=0&&M;--s){var ne=h[s].s;E[ne]==e&&(--E[ne],++M)}R=e}return{t:new lu(E),l:R}},p1=function(a,e,t){return a.s==-1?Math.max(p1(a.l,e,t+1),p1(a.r,e,t+1)):e[a.s]=t},IE=function(a){for(var e=a.length;e&&!a[--e];);for(var t=new Uh(++e),s=0,c=a[0],h=1,A=function(y){t[s++]=y},r=1;r<=e;++r)if(a[r]==c&&r!=e)++h;else{if(!c&&h>2){for(;h>138;h-=138)A(32754);h>2&&(A(h>10?h-11<<5|28690:h-3<<5|12305),h=0)}else if(h>3){for(A(c),--h;h>6;h-=6)A(8304);h>2&&(A(h-3<<5|8208),h=0)}for(;h--;)A(c);h=1,c=a[r]}return{c:t.subarray(0,s),n:e}},fy=function(a,e){for(var t=0,s=0;s<e.length;++s)t+=a[s]*e[s];return t},OT=function(a,e,t){var s=t.length,c=fw(e+2);a[c]=s&255,a[c+1]=s>>8,a[c+2]=a[c]^255,a[c+3]=a[c+1]^255;for(var h=0;h<s;++h)a[c+h+4]=t[h];return(c+4+s)*8},TE=function(a,e,t,s,c,h,A,r,y,b,_){bf(e,_++,t),++c[256];for(var B=bb(c,15),I=B.t,E=B.l,R=bb(h,15),M=R.t,G=R.l,U=IE(I),Q=U.c,q=U.n,ne=IE(M),re=ne.c,pe=ne.n,Ae=new Uh(19),le=0;le<Q.length;++le)++Ae[Q[le]&31];for(var le=0;le<re.length;++le)++Ae[re[le]&31];for(var be=bb(Ae,7),we=be.t,oe=be.l,me=19;me>4&&!we[d1[me-1]];--me);var Le=b+5<<3,Se=fy(c,Pp)+fy(h,Zy)+A,Me=fy(c,I)+fy(h,M)+A+14+3*me+fy(Ae,we)+2*Ae[16]+3*Ae[17]+7*Ae[18];if(y>=0&&Le<=Se&&Le<=Me)return OT(e,_,a.subarray(y,y+b));var Re,Ze,$e,ct;if(bf(e,_,1+(Me<Se)),_+=2,Me<Se){Re=WA(I,E,0),Ze=I,$e=WA(M,G,0),ct=M;var Qe=WA(we,oe,0);bf(e,_,q-257),bf(e,_+5,pe-1),bf(e,_+10,me-4),_+=14;for(var le=0;le<me;++le)bf(e,_+3*le,we[d1[le]]);_+=3*me;for(var It=[Q,re],Ce=0;Ce<2;++Ce)for(var Je=It[Ce],le=0;le<Je.length;++le){var lt=Je[le]&31;bf(e,_,Qe[lt]),_+=we[lt],lt>15&&(bf(e,_,Je[le]>>5&127),_+=Je[le]>>12)}}else Re=NU,Ze=Pp,$e=HU,ct=Zy;for(var le=0;le<r;++le){var mt=s[le];if(mt>255){var lt=mt>>18&31;Ay(e,_,Re[lt+257]),_+=Ze[lt+257],lt>7&&(bf(e,_,mt>>23&31),_+=p_[lt]);var Bt=mt&31;Ay(e,_,$e[Bt]),_+=ct[Bt],Bt>3&&(Ay(e,_,mt>>5&8191),_+=g_[Bt])}else Ay(e,_,Re[mt]),_+=Ze[mt]}return Ay(e,_,Re[256]),_+Ze[256]},WU=new Aw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),UT=new lu(0),XU=function(a,e,t,s,c,h){var A=h.z||a.length,r=new lu(s+A+5*(1+Math.ceil(A/7e3))+c),y=r.subarray(s,r.length-c),b=h.l,_=(h.r||0)&7;if(e){_&&(y[0]=h.r>>3);for(var B=WU[e-1],I=B>>13,E=B&8191,R=(1<<t)-1,M=h.p||new Uh(32768),G=h.h||new Uh(R+1),U=Math.ceil(t/3),Q=2*U,q=function(kt){return(a[kt]^a[kt+1]<<U^a[kt+2]<<Q)&R},ne=new Aw(25e3),re=new Uh(288),pe=new Uh(32),Ae=0,le=0,be=h.i||0,we=0,oe=h.w||0,me=0;be+2<A;++be){var Le=q(be),Se=be&32767,Me=G[Le];if(M[Se]=Me,G[Le]=Se,oe<=be){var Re=A-be;if((Ae>7e3||we>24576)&&(Re>423||!b)){_=TE(a,y,0,ne,re,pe,le,we,me,be-me,_),we=Ae=le=0,me=be;for(var Ze=0;Ze<286;++Ze)re[Ze]=0;for(var Ze=0;Ze<30;++Ze)pe[Ze]=0}var $e=2,ct=0,Qe=E,It=Se-Me&32767;if(Re>2&&Le==q(be-It))for(var Ce=Math.min(I,Re)-1,Je=Math.min(32767,be),lt=Math.min(258,Re);It<=Je&&--Qe&&Se!=Me;){if(a[be+$e]==a[be+$e-It]){for(var mt=0;mt<lt&&a[be+mt]==a[be+mt-It];++mt);if(mt>$e){if($e=mt,ct=It,mt>Ce)break;for(var Bt=Math.min(It,mt-2),rt=0,Ze=0;Ze<Bt;++Ze){var St=be-It+Ze&32767,vt=M[St],Gt=St-vt&32767;Gt>rt&&(rt=Gt,Me=St)}}}Se=Me,Me=M[Se],It+=Se-Me&32767}if(ct){ne[we++]=268435456|A1[$e]<<18|EE[ct];var mi=A1[$e]&31,ze=EE[ct]&31;le+=p_[mi]+g_[ze],++re[257+mi],++pe[ze],oe=be+$e,++Ae}else ne[we++]=a[be],++re[a[be]]}}for(be=Math.max(be,oe);be<A;++be)ne[we++]=a[be],++re[a[be]];_=TE(a,y,b,ne,re,pe,le,we,me,be-me,_),b||(h.r=_&7|y[_/8|0]<<3,_-=7,h.h=G,h.p=M,h.i=be,h.w=oe)}else{for(var be=h.w||0;be<A+b;be+=65535){var Ve=be+65535;Ve>=A&&(y[_/8|0]=b,Ve=A),_=OT(y,_+1,a.subarray(be,Ve))}h.i=A}return DT(r,0,s+fw(_)+c)},zT=function(){var a=1,e=0;return{p:function(t){for(var s=a,c=e,h=t.length|0,A=0;A!=h;){for(var r=Math.min(A+2655,h);A<r;++A)c+=s+=t[A];s=(s&65535)+15*(s>>16),c=(c&65535)+15*(c>>16)}a=s,e=c},d:function(){return a%=65521,e%=65521,(a&255)<<24|(a&65280)<<8|(e&255)<<8|e>>8}}},YU=function(a,e,t,s,c){if(!c&&(c={l:1},e.dictionary)){var h=e.dictionary.subarray(-32768),A=new lu(h.length+a.length);A.set(h),A.set(a,h.length),a=A,c.w=h.length}return XU(a,e.level==null?6:e.level,e.mem==null?c.l?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):20:12+e.mem,t,s,c)},NT=function(a,e,t){for(;t;++e)a[e]=t,t>>>=8},KU=function(a,e){var t=e.level,s=t==0?0:t<6?1:t==9?3:2;if(a[0]=120,a[1]=s<<6|(e.dictionary&&32),a[1]|=31-(a[0]<<8|a[1])%31,e.dictionary){var c=zT();c.p(e.dictionary),NT(a,2,c.d())}},qU=function(a,e){return((a[0]&15)!=8||a[0]>>4>7||(a[0]<<8|a[1])%31)&&Gd(6,"invalid zlib data"),(a[1]>>5&1)==1&&Gd(6,"invalid zlib data: "+(a[1]&32?"need":"unexpected")+" dictionary"),(a[1]>>3&4)+2};function g1(a,e){e||(e={});var t=zT();t.p(a);var s=YU(a,e,e.dictionary?6:2,4);return KU(s,e),NT(s,s.length-4,t.d()),s}function $U(a,e){return GU(a.subarray(qU(a),-4),{i:2},e,e)}var ZU=typeof TextDecoder<"u"&&new TextDecoder,JU=0;try{ZU.decode(UT,{stream:!0}),JU=1}catch{}var es=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function wb(){es.console&&typeof es.console.log=="function"&&es.console.log.apply(es.console,arguments)}var da={log:wb,warn:function(a){es.console&&(typeof es.console.warn=="function"?es.console.warn.apply(es.console,arguments):wb.call(null,arguments))},error:function(a){es.console&&(typeof es.console.error=="function"?es.console.error.apply(es.console,arguments):wb(a))}};function Bb(a,e,t){var s=new XMLHttpRequest;s.open("GET",a),s.responseType="blob",s.onload=function(){ag(s.response,e,t)},s.onerror=function(){da.error("could not download file")},s.send()}function FE(a){var e=new XMLHttpRequest;e.open("HEAD",a,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function p0(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(e)}}var My,m1,ag=es.saveAs||((typeof window>"u"?"undefined":Wo(window))!=="object"||window!==es?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(a,e,t){var s=es.URL||es.webkitURL,c=document.createElement("a");e=e||a.name||"download",c.download=e,c.rel="noopener",typeof a=="string"?(c.href=a,c.origin!==location.origin?FE(c.href)?Bb(a,e,t):p0(c,c.target="_blank"):p0(c)):(c.href=s.createObjectURL(a),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){p0(c)},0))}:"msSaveOrOpenBlob"in navigator?function(a,e,t){if(e=e||a.name||"download",typeof a=="string")if(FE(a))Bb(a,e,t);else{var s=document.createElement("a");s.href=a,s.target="_blank",setTimeout(function(){p0(s)})}else navigator.msSaveOrOpenBlob(function(c,h){return h===void 0?h={autoBom:!1}:Wo(h)!=="object"&&(da.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}(a,t),e)}:function(a,e,t,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof a=="string")return Bb(a,e,t);var c=a.type==="application/octet-stream",h=/constructor/i.test(es.HTMLElement)||es.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||c&&h)&&(typeof FileReader>"u"?"undefined":Wo(FileReader))==="object"){var r=new FileReader;r.onloadend=function(){var _=r.result;_=A?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=_:location=_,s=null},r.readAsDataURL(a)}else{var y=es.URL||es.webkitURL,b=y.createObjectURL(a);s?s.location=b:location.href=b,s=null,setTimeout(function(){y.revokeObjectURL(b)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function jT(a){var e;a=a||"",this.ok=!1,a.charAt(0)=="#"&&(a=a.substr(1,6)),a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[a=(a=a.replace(/ /g,"")).toLowerCase()]||a;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(r){return[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(r){return[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(r){return[parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16)]}}],s=0;s<t.length;s++){var c=t[s].re,h=t[s].process,A=c.exec(a);A&&(e=h(A),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var r=this.r.toString(16),y=this.g.toString(16),b=this.b.toString(16);return r.length==1&&(r="0"+r),y.length==1&&(y="0"+y),b.length==1&&(b="0"+b),"#"+r+y+b}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Cb(a,e){var t=a[0],s=a[1],c=a[2],h=a[3];t=iu(t,s,c,h,e[0],7,-680876936),h=iu(h,t,s,c,e[1],12,-389564586),c=iu(c,h,t,s,e[2],17,606105819),s=iu(s,c,h,t,e[3],22,-1044525330),t=iu(t,s,c,h,e[4],7,-176418897),h=iu(h,t,s,c,e[5],12,1200080426),c=iu(c,h,t,s,e[6],17,-1473231341),s=iu(s,c,h,t,e[7],22,-45705983),t=iu(t,s,c,h,e[8],7,1770035416),h=iu(h,t,s,c,e[9],12,-1958414417),c=iu(c,h,t,s,e[10],17,-42063),s=iu(s,c,h,t,e[11],22,-1990404162),t=iu(t,s,c,h,e[12],7,1804603682),h=iu(h,t,s,c,e[13],12,-40341101),c=iu(c,h,t,s,e[14],17,-1502002290),t=ru(t,s=iu(s,c,h,t,e[15],22,1236535329),c,h,e[1],5,-165796510),h=ru(h,t,s,c,e[6],9,-1069501632),c=ru(c,h,t,s,e[11],14,643717713),s=ru(s,c,h,t,e[0],20,-373897302),t=ru(t,s,c,h,e[5],5,-701558691),h=ru(h,t,s,c,e[10],9,38016083),c=ru(c,h,t,s,e[15],14,-660478335),s=ru(s,c,h,t,e[4],20,-405537848),t=ru(t,s,c,h,e[9],5,568446438),h=ru(h,t,s,c,e[14],9,-1019803690),c=ru(c,h,t,s,e[3],14,-187363961),s=ru(s,c,h,t,e[8],20,1163531501),t=ru(t,s,c,h,e[13],5,-1444681467),h=ru(h,t,s,c,e[2],9,-51403784),c=ru(c,h,t,s,e[7],14,1735328473),t=nu(t,s=ru(s,c,h,t,e[12],20,-1926607734),c,h,e[5],4,-378558),h=nu(h,t,s,c,e[8],11,-2022574463),c=nu(c,h,t,s,e[11],16,1839030562),s=nu(s,c,h,t,e[14],23,-35309556),t=nu(t,s,c,h,e[1],4,-1530992060),h=nu(h,t,s,c,e[4],11,1272893353),c=nu(c,h,t,s,e[7],16,-155497632),s=nu(s,c,h,t,e[10],23,-1094730640),t=nu(t,s,c,h,e[13],4,681279174),h=nu(h,t,s,c,e[0],11,-358537222),c=nu(c,h,t,s,e[3],16,-722521979),s=nu(s,c,h,t,e[6],23,76029189),t=nu(t,s,c,h,e[9],4,-640364487),h=nu(h,t,s,c,e[12],11,-421815835),c=nu(c,h,t,s,e[15],16,530742520),t=su(t,s=nu(s,c,h,t,e[2],23,-995338651),c,h,e[0],6,-198630844),h=su(h,t,s,c,e[7],10,1126891415),c=su(c,h,t,s,e[14],15,-1416354905),s=su(s,c,h,t,e[5],21,-57434055),t=su(t,s,c,h,e[12],6,1700485571),h=su(h,t,s,c,e[3],10,-1894986606),c=su(c,h,t,s,e[10],15,-1051523),s=su(s,c,h,t,e[1],21,-2054922799),t=su(t,s,c,h,e[8],6,1873313359),h=su(h,t,s,c,e[15],10,-30611744),c=su(c,h,t,s,e[6],15,-1560198380),s=su(s,c,h,t,e[13],21,1309151649),t=su(t,s,c,h,e[4],6,-145523070),h=su(h,t,s,c,e[11],10,-1120210379),c=su(c,h,t,s,e[2],15,718787259),s=su(s,c,h,t,e[9],21,-343485551),a[0]=bp(t,a[0]),a[1]=bp(s,a[1]),a[2]=bp(c,a[2]),a[3]=bp(h,a[3])}function m_(a,e,t,s,c,h){return e=bp(bp(e,a),bp(s,h)),bp(e<<c|e>>>32-c,t)}function iu(a,e,t,s,c,h,A){return m_(e&t|~e&s,a,e,c,h,A)}function ru(a,e,t,s,c,h,A){return m_(e&s|t&~s,a,e,c,h,A)}function nu(a,e,t,s,c,h,A){return m_(e^t^s,a,e,c,h,A)}function su(a,e,t,s,c,h,A){return m_(t^(e|~s),a,e,c,h,A)}function HT(a){var e,t=a.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=a.length;e+=64)Cb(s,ez(a.substring(e-64,e)));a=a.substring(e-64);var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<a.length;e++)c[e>>2]|=a.charCodeAt(e)<<(e%4<<3);if(c[e>>2]|=128<<(e%4<<3),e>55)for(Cb(s,c),e=0;e<16;e++)c[e]=0;return c[14]=8*t,Cb(s,c),s}function ez(a){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=a.charCodeAt(e)+(a.charCodeAt(e+1)<<8)+(a.charCodeAt(e+2)<<16)+(a.charCodeAt(e+3)<<24);return t}My=es.atob.bind(es),m1=es.btoa.bind(es);var LE="0123456789abcdef".split("");function tz(a){for(var e="",t=0;t<4;t++)e+=LE[a>>8*t+4&15]+LE[a>>8*t&15];return e}function iz(a){return String.fromCharCode((255&a)>>0,(65280&a)>>8,(16711680&a)>>16,(4278190080&a)>>24)}function y1(a){return HT(a).map(iz).join("")}var rz=function(a){for(var e=0;e<a.length;e++)a[e]=tz(a[e]);return a.join("")}(HT("hello"))!="5d41402abc4b2a76b9719d911017c592";function bp(a,e){if(rz){var t=(65535&a)+(65535&e);return(a>>16)+(e>>16)+(t>>16)<<16|65535&t}return a+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function v1(a,e){var t,s,c,h;if(a!==t){for(var A=(c=a,h=1+(256/a.length>>0),new Array(h+1).join(c)),r=[],y=0;y<256;y++)r[y]=y;var b=0;for(y=0;y<256;y++){var _=r[y];b=(b+_+A.charCodeAt(y))%256,r[y]=r[b],r[b]=_}t=a,s=r}else r=s;var B=e.length,I=0,E=0,R="";for(y=0;y<B;y++)E=(E+(_=r[I=(I+1)%256]))%256,r[I]=r[E],r[E]=_,A=r[(r[I]+r[E])%256],R+=String.fromCharCode(e.charCodeAt(y)^A);return R}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ME={print:4,modify:8,copy:16,"annot-forms":32};function im(a,e,t,s){this.v=1,this.r=2;var c=192;a.forEach(function(r){if(ME.perm!==void 0)throw new Error("Invalid permission: "+r);c+=ME[r]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var h=(e+this.padding).substr(0,32),A=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(h,A),this.P=-(1+(255^c)),this.encryptionKey=y1(h+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=v1(this.encryptionKey,this.padding)}function rm(a){if(/[^\u0000-\u00ff]/.test(a))throw new Error("Invalid PDF Name Object: "+a+", Only accept ASCII characters.");for(var e="",t=a.length,s=0;s<t;s++){var c=a.charCodeAt(s);c<33||c===35||c===37||c===40||c===41||c===47||c===60||c===62||c===91||c===93||c===123||c===125||c>126?e+="#"+("0"+c.toString(16)).slice(-2):e+=a[s]}return e}function PE(a){if(Wo(a)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,s,c){if(c=c||!1,typeof t!="string"||typeof s!="function"||typeof c!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var h=Math.random().toString(35);return e[t][h]=[s,!!c],h},this.unsubscribe=function(t){for(var s in e)if(e[s][t])return delete e[s][t],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var s=Array.prototype.slice.call(arguments,1),c=[];for(var h in e[t]){var A=e[t][h];try{A[0].apply(a,s)}catch(r){es.console&&da.error("jsPDF PubSub Error",r.message,r)}A[1]&&c.push(h)}c.length&&c.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Jy(a){if(!(this instanceof Jy))return new Jy(a);var e="opacity,stroke-opacity".split(",");for(var t in a)a.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=a[t]);this.id="",this.objectNumber=-1}function QT(a,e){this.gState=a,this.matrix=e,this.id="",this.objectNumber=-1}function _p(a,e,t,s,c){if(!(this instanceof _p))return new _p(a,e,t,s,c);this.type=a==="axial"?2:3,this.coords=e,this.colors=t,QT.call(this,s,c)}function dg(a,e,t,s,c){if(!(this instanceof dg))return new dg(a,e,t,s,c);this.boundingBox=a,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,QT.call(this,s,c)}function Yn(a){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],c=arguments[2],h=arguments[3],A=[],r=1,y=16,b="S",_=null;Wo(a=a||{})==="object"&&(t=a.orientation,s=a.unit||s,c=a.format||c,h=a.compress||a.compressPdf||h,(_=a.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),r=typeof a.userUnit=="number"?Math.abs(a.userUnit):1,a.precision!==void 0&&(e=a.precision),a.floatPrecision!==void 0&&(y=a.floatPrecision),b=a.defaultPathOperation||"S"),A=a.filters||(h===!0?["FlateEncode"]:A),s=s||"mm",t=(""+(t||"P")).toLowerCase();var B=a.putOnlyUsedFonts||!1,I={},E={internal:{},__private__:{}};E.__private__.PubSub=PE;var R="1.3",M=E.__private__.getPdfVersion=function(){return R};E.__private__.setPdfVersion=function(ie){R=ie};var G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};E.__private__.getPageFormats=function(){return G};var U=E.__private__.getPageFormat=function(ie){return G[ie]};c=c||"a4";var Q={COMPAT:"compat",ADVANCED:"advanced"},q=Q.COMPAT;function ne(){this.saveGraphicsState(),it(new Et(li,0,0,-li,0,sa()*li).toString()+" cm"),this.setFontSize(this.getFontSize()/li),b="n",q=Q.ADVANCED}function re(){this.restoreGraphicsState(),b="S",q=Q.COMPAT}var pe=E.__private__.combineFontStyleAndFontWeight=function(ie,Ue){if(ie=="bold"&&Ue=="normal"||ie=="bold"&&Ue==400||ie=="normal"&&Ue=="italic"||ie=="bold"&&Ue=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ue&&(ie=Ue==400||Ue==="normal"?ie==="italic"?"italic":"normal":Ue!=700&&Ue!=="bold"||ie!=="normal"?(Ue==700?"bold":Ue)+""+ie:"bold"),ie};E.advancedAPI=function(ie){var Ue=q===Q.COMPAT;return Ue&&ne.call(this),typeof ie!="function"||(ie(this),Ue&&re.call(this)),this},E.compatAPI=function(ie){var Ue=q===Q.ADVANCED;return Ue&&re.call(this),typeof ie!="function"||(ie(this),Ue&&ne.call(this)),this},E.isAdvancedAPI=function(){return q===Q.ADVANCED};var Ae,le=function(ie){if(q!==Q.ADVANCED)throw new Error(ie+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},be=E.roundToPrecision=E.__private__.roundToPrecision=function(ie,Ue){var Tt=e||Ue;if(isNaN(ie)||isNaN(Tt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ie.toFixed(Tt).replace(/0+$/,"")};Ae=E.hpf=E.__private__.hpf=typeof y=="number"?function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,y)}:y==="smart"?function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,ie>-1&&ie<1?16:5)}:function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.hpf");return be(ie,16)};var we=E.f2=E.__private__.f2=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.f2");return be(ie,2)},oe=E.__private__.f3=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.f3");return be(ie,3)},me=E.scale=E.__private__.scale=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.scale");return q===Q.COMPAT?ie*li:q===Q.ADVANCED?ie:void 0},Le=function(ie){return q===Q.COMPAT?sa()-ie:q===Q.ADVANCED?ie:void 0},Se=function(ie){return me(Le(ie))};E.__private__.setPrecision=E.setPrecision=function(ie){typeof parseInt(ie,10)=="number"&&(e=parseInt(ie,10))};var Me,Re="00000000000000000000000000000000",Ze=E.__private__.getFileId=function(){return Re},$e=E.__private__.setFileId=function(ie){return Re=ie!==void 0&&/^[a-fA-F0-9]{32}$/.test(ie)?ie.toUpperCase():Re.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(Xo=new im(_.userPermissions,_.userPassword,_.ownerPassword,Re)),Re};E.setFileId=function(ie){return $e(ie),this},E.getFileId=function(){return Ze()};var ct=E.__private__.convertDateToPDFDate=function(ie){var Ue=ie.getTimezoneOffset(),Tt=Ue<0?"+":"-",jt=Math.floor(Math.abs(Ue/60)),hi=Math.abs(Ue%60),Ii=[Tt,lt(jt),"'",lt(hi),"'"].join("");return["D:",ie.getFullYear(),lt(ie.getMonth()+1),lt(ie.getDate()),lt(ie.getHours()),lt(ie.getMinutes()),lt(ie.getSeconds()),Ii].join("")},Qe=E.__private__.convertPDFDateToDate=function(ie){var Ue=parseInt(ie.substr(2,4),10),Tt=parseInt(ie.substr(6,2),10)-1,jt=parseInt(ie.substr(8,2),10),hi=parseInt(ie.substr(10,2),10),Ii=parseInt(ie.substr(12,2),10),mr=parseInt(ie.substr(14,2),10);return new Date(Ue,Tt,jt,hi,Ii,mr,0)},It=E.__private__.setCreationDate=function(ie){var Ue;if(ie===void 0&&(ie=new Date),ie instanceof Date)Ue=ct(ie);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ie))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ue=ie}return Me=Ue},Ce=E.__private__.getCreationDate=function(ie){var Ue=Me;return ie==="jsDate"&&(Ue=Qe(Me)),Ue};E.setCreationDate=function(ie){return It(ie),this},E.getCreationDate=function(ie){return Ce(ie)};var Je,lt=E.__private__.padd2=function(ie){return("0"+parseInt(ie)).slice(-2)},mt=E.__private__.padd2Hex=function(ie){return("00"+(ie=ie.toString())).substr(ie.length)},Bt=0,rt=[],St=[],vt=0,Gt=[],mi=[],ze=!1,Ve=St,kt=function(){Bt=0,vt=0,St=[],rt=[],Gt=[],bt=Ye(),Ut=Ye()};E.__private__.setCustomOutputDestination=function(ie){ze=!0,Ve=ie};var Ft=function(ie){ze||(Ve=ie)};E.__private__.resetCustomOutputDestination=function(){ze=!1,Ve=St};var it=E.__private__.out=function(ie){return ie=ie.toString(),vt+=ie.length+1,Ve.push(ie),Ve},yi=E.__private__.write=function(ie){return it(arguments.length===1?ie.toString():Array.prototype.join.call(arguments," "))},bi=E.__private__.getArrayBuffer=function(ie){for(var Ue=ie.length,Tt=new ArrayBuffer(Ue),jt=new Uint8Array(Tt);Ue--;)jt[Ue]=ie.charCodeAt(Ue);return Tt},Kt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];E.__private__.getStandardFonts=function(){return Kt};var di=a.fontSize||16;E.__private__.setFontSize=E.setFontSize=function(ie){return di=q===Q.ADVANCED?ie/li:ie,this};var fi,Ri=E.__private__.getFontSize=E.getFontSize=function(){return q===Q.COMPAT?di:di*li},Oi=a.R2L||!1;E.__private__.setR2L=E.setR2L=function(ie){return Oi=ie,this},E.__private__.getR2L=E.getR2L=function(){return Oi};var Ji,lr=E.__private__.setZoomMode=function(ie){var Ue=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ie))fi=ie;else if(isNaN(ie)){if(Ue.indexOf(ie)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ie+'" is not recognized.');fi=ie}else fi=parseInt(ie,10)};E.__private__.getZoomMode=function(){return fi};var br,Dr=E.__private__.setPageMode=function(ie){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ie)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ie+'" is not recognized.');Ji=ie};E.__private__.getPageMode=function(){return Ji};var Fr=E.__private__.setLayoutMode=function(ie){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ie)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ie+'" is not recognized.');br=ie};E.__private__.getLayoutMode=function(){return br},E.__private__.setDisplayMode=E.setDisplayMode=function(ie,Ue,Tt){return lr(ie),Fr(Ue),Dr(Tt),this};var Qr={title:"",subject:"",author:"",keywords:"",creator:""};E.__private__.getDocumentProperty=function(ie){if(Object.keys(Qr).indexOf(ie)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Qr[ie]},E.__private__.getDocumentProperties=function(){return Qr},E.__private__.setDocumentProperties=E.setProperties=E.setDocumentProperties=function(ie){for(var Ue in Qr)Qr.hasOwnProperty(Ue)&&ie[Ue]&&(Qr[Ue]=ie[Ue]);return this},E.__private__.setDocumentProperty=function(ie,Ue){if(Object.keys(Qr).indexOf(ie)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Qr[ie]=Ue};var ui,li,Vi,rr,qr,_r={},Zr={},io=[],Ur={},ia={},ps={},ro={},Qn=null,Lr=0,yr=[],qt=new PE(E),Vn=a.hotfixes||[],xs={},ra={},dn=[],Et=function ie(Ue,Tt,jt,hi,Ii,mr){if(!(this instanceof ie))return new ie(Ue,Tt,jt,hi,Ii,mr);isNaN(Ue)&&(Ue=1),isNaN(Tt)&&(Tt=0),isNaN(jt)&&(jt=0),isNaN(hi)&&(hi=1),isNaN(Ii)&&(Ii=0),isNaN(mr)&&(mr=0),this._matrix=[Ue,Tt,jt,hi,Ii,mr]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ie){this._matrix[0]=ie}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ie){this._matrix[1]=ie}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ie){this._matrix[2]=ie}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ie){this._matrix[3]=ie}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ie){this._matrix[4]=ie}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ie){this._matrix[5]=ie}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(ie){this._matrix[0]=ie}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(ie){this._matrix[1]=ie}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(ie){this._matrix[2]=ie}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(ie){this._matrix[3]=ie}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(ie){this._matrix[4]=ie}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(ie){this._matrix[5]=ie}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(ie){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ae).join(ie)},Et.prototype.multiply=function(ie){var Ue=ie.sx*this.sx+ie.shy*this.shx,Tt=ie.sx*this.shy+ie.shy*this.sy,jt=ie.shx*this.sx+ie.sy*this.shx,hi=ie.shx*this.shy+ie.sy*this.sy,Ii=ie.tx*this.sx+ie.ty*this.shx+this.tx,mr=ie.tx*this.shy+ie.ty*this.sy+this.ty;return new Et(Ue,Tt,jt,hi,Ii,mr)},Et.prototype.decompose=function(){var ie=this.sx,Ue=this.shy,Tt=this.shx,jt=this.sy,hi=this.tx,Ii=this.ty,mr=Math.sqrt(ie*ie+Ue*Ue),Vr=(ie/=mr)*Tt+(Ue/=mr)*jt;Tt-=ie*Vr,jt-=Ue*Vr;var cn=Math.sqrt(Tt*Tt+jt*jt);return Vr/=cn,ie*(jt/=cn)<Ue*(Tt/=cn)&&(ie=-ie,Ue=-Ue,Vr=-Vr,mr=-mr),{scale:new Et(mr,0,0,cn,0,0),translate:new Et(1,0,0,1,hi,Ii),rotate:new Et(ie,Ue,-Ue,ie,0,0),skew:new Et(1,0,Vr,1,0,0)}},Et.prototype.toString=function(ie){return this.join(" ")},Et.prototype.inversed=function(){var ie=this.sx,Ue=this.shy,Tt=this.shx,jt=this.sy,hi=this.tx,Ii=this.ty,mr=1/(ie*jt-Ue*Tt),Vr=jt*mr,cn=-Ue*mr,Rn=-Tt*mr,Dn=ie*mr;return new Et(Vr,cn,Rn,Dn,-Vr*hi-Rn*Ii,-cn*hi-Dn*Ii)},Et.prototype.applyToPoint=function(ie){var Ue=ie.x*this.sx+ie.y*this.shx+this.tx,Tt=ie.x*this.shy+ie.y*this.sy+this.ty;return new Gc(Ue,Tt)},Et.prototype.applyToRectangle=function(ie){var Ue=this.applyToPoint(ie),Tt=this.applyToPoint(new Gc(ie.x+ie.w,ie.y+ie.h));return new Cc(Ue.x,Ue.y,Tt.x-Ue.x,Tt.y-Ue.y)},Et.prototype.clone=function(){var ie=this.sx,Ue=this.shy,Tt=this.shx,jt=this.sy,hi=this.tx,Ii=this.ty;return new Et(ie,Ue,Tt,jt,hi,Ii)},E.Matrix=Et;var ye=E.matrixMult=function(ie,Ue){return Ue.multiply(ie)},Ee=new Et(1,0,0,1,0,0);E.unitMatrix=E.identityMatrix=Ee;var He=function(ie,Ue){if(!ia[ie]){var Tt=(Ue instanceof _p?"Sh":"P")+(Object.keys(Ur).length+1).toString(10);Ue.id=Tt,ia[ie]=Tt,Ur[Tt]=Ue,qt.publish("addPattern",Ue)}};E.ShadingPattern=_p,E.TilingPattern=dg,E.addShadingPattern=function(ie,Ue){return le("addShadingPattern()"),He(ie,Ue),this},E.beginTilingPattern=function(ie){le("beginTilingPattern()"),Qh(ie.boundingBox[0],ie.boundingBox[1],ie.boundingBox[2]-ie.boundingBox[0],ie.boundingBox[3]-ie.boundingBox[1],ie.matrix)},E.endTilingPattern=function(ie,Ue){le("endTilingPattern()"),Ue.stream=mi[Je].join(`
`),He(ie,Ue),qt.publish("endTilingPattern",Ue),dn.pop().restore()};var tt=E.__private__.newObject=function(){var ie=Ye();return xt(ie,!0),ie},Ye=E.__private__.newObjectDeferred=function(){return Bt++,rt[Bt]=function(){return vt},Bt},xt=function(ie,Ue){return Ue=typeof Ue=="boolean"&&Ue,rt[ie]=vt,Ue&&it(ie+" 0 obj"),ie},Dt=E.__private__.newAdditionalObject=function(){var ie={objId:Ye(),content:""};return Gt.push(ie),ie},bt=Ye(),Ut=Ye(),ii=E.__private__.decodeColorString=function(ie){var Ue=ie.split(" ");if(Ue.length!==2||Ue[1]!=="g"&&Ue[1]!=="G")Ue.length===5&&(Ue[4]==="k"||Ue[4]==="K")&&(Ue=[(1-Ue[0])*(1-Ue[3]),(1-Ue[1])*(1-Ue[3]),(1-Ue[2])*(1-Ue[3]),"r"]);else{var Tt=parseFloat(Ue[0]);Ue=[Tt,Tt,Tt,"r"]}for(var jt="#",hi=0;hi<3;hi++)jt+=("0"+Math.floor(255*parseFloat(Ue[hi])).toString(16)).slice(-2);return jt},Nt=E.__private__.encodeColorString=function(ie){var Ue;typeof ie=="string"&&(ie={ch1:ie});var Tt=ie.ch1,jt=ie.ch2,hi=ie.ch3,Ii=ie.ch4,mr=ie.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Tt=="string"&&Tt.charAt(0)!=="#"){var Vr=new jT(Tt);if(Vr.ok)Tt=Vr.toHex();else if(!/^\d*\.?\d*$/.test(Tt))throw new Error('Invalid color "'+Tt+'" passed to jsPDF.encodeColorString.')}if(typeof Tt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Tt)&&(Tt="#"+Tt[1]+Tt[1]+Tt[2]+Tt[2]+Tt[3]+Tt[3]),typeof Tt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Tt)){var cn=parseInt(Tt.substr(1),16);Tt=cn>>16&255,jt=cn>>8&255,hi=255&cn}if(jt===void 0||Ii===void 0&&Tt===jt&&jt===hi)if(typeof Tt=="string")Ue=Tt+" "+mr[0];else switch(ie.precision){case 2:Ue=we(Tt/255)+" "+mr[0];break;case 3:default:Ue=oe(Tt/255)+" "+mr[0]}else if(Ii===void 0||Wo(Ii)==="object"){if(Ii&&!isNaN(Ii.a)&&Ii.a===0)return Ue=["1.","1.","1.",mr[1]].join(" ");if(typeof Tt=="string")Ue=[Tt,jt,hi,mr[1]].join(" ");else switch(ie.precision){case 2:Ue=[we(Tt/255),we(jt/255),we(hi/255),mr[1]].join(" ");break;default:case 3:Ue=[oe(Tt/255),oe(jt/255),oe(hi/255),mr[1]].join(" ")}}else if(typeof Tt=="string")Ue=[Tt,jt,hi,Ii,mr[2]].join(" ");else switch(ie.precision){case 2:Ue=[we(Tt),we(jt),we(hi),we(Ii),mr[2]].join(" ");break;case 3:default:Ue=[oe(Tt),oe(jt),oe(hi),oe(Ii),mr[2]].join(" ")}return Ue},Fi=E.__private__.getFilters=function(){return A},er=E.__private__.putStream=function(ie){var Ue=(ie=ie||{}).data||"",Tt=ie.filters||Fi(),jt=ie.alreadyAppliedFilters||[],hi=ie.addLength1||!1,Ii=Ue.length,mr=ie.objectId,Vr=function(Js){return Js};if(_!==null&&mr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(Vr=Xo.encryptor(mr,0));var cn={};Tt===!0&&(Tt=["FlateEncode"]);var Rn=ie.additionalKeyValues||[],Dn=(cn=Yn.API.processDataByFilters!==void 0?Yn.API.processDataByFilters(Ue,Tt):{data:Ue,reverseChain:[]}).reverseChain+(Array.isArray(jt)?jt.join(" "):jt.toString());if(cn.data.length!==0&&(Rn.push({key:"Length",value:cn.data.length}),hi===!0&&Rn.push({key:"Length1",value:Ii})),Dn.length!=0)if(Dn.split("/").length-1==1)Rn.push({key:"Filter",value:Dn});else{Rn.push({key:"Filter",value:"["+Dn+"]"});for(var As=0;As<Rn.length;As+=1)if(Rn[As].key==="DecodeParms"){for(var Zs=[],ts=0;ts<cn.reverseChain.split("/").length-1;ts+=1)Zs.push("null");Zs.push(Rn[As].value),Rn[As].value="["+Zs.join(" ")+"]"}}it("<<");for(var bn=0;bn<Rn.length;bn++)it("/"+Rn[bn].key+" "+Rn[bn].value);it(">>"),cn.data.length!==0&&(it("stream"),it(Vr(cn.data)),it("endstream"))},nr=E.__private__.putPage=function(ie){var Ue=ie.number,Tt=ie.data,jt=ie.objId,hi=ie.contentsObjId;xt(jt,!0),it("<</Type /Page"),it("/Parent "+ie.rootDictionaryObjId+" 0 R"),it("/Resources "+ie.resourceDictionaryObjId+" 0 R"),it("/MediaBox ["+parseFloat(Ae(ie.mediaBox.bottomLeftX))+" "+parseFloat(Ae(ie.mediaBox.bottomLeftY))+" "+Ae(ie.mediaBox.topRightX)+" "+Ae(ie.mediaBox.topRightY)+"]"),ie.cropBox!==null&&it("/CropBox ["+Ae(ie.cropBox.bottomLeftX)+" "+Ae(ie.cropBox.bottomLeftY)+" "+Ae(ie.cropBox.topRightX)+" "+Ae(ie.cropBox.topRightY)+"]"),ie.bleedBox!==null&&it("/BleedBox ["+Ae(ie.bleedBox.bottomLeftX)+" "+Ae(ie.bleedBox.bottomLeftY)+" "+Ae(ie.bleedBox.topRightX)+" "+Ae(ie.bleedBox.topRightY)+"]"),ie.trimBox!==null&&it("/TrimBox ["+Ae(ie.trimBox.bottomLeftX)+" "+Ae(ie.trimBox.bottomLeftY)+" "+Ae(ie.trimBox.topRightX)+" "+Ae(ie.trimBox.topRightY)+"]"),ie.artBox!==null&&it("/ArtBox ["+Ae(ie.artBox.bottomLeftX)+" "+Ae(ie.artBox.bottomLeftY)+" "+Ae(ie.artBox.topRightX)+" "+Ae(ie.artBox.topRightY)+"]"),typeof ie.userUnit=="number"&&ie.userUnit!==1&&it("/UserUnit "+ie.userUnit),qt.publish("putPage",{objId:jt,pageContext:yr[Ue],pageNumber:Ue,page:Tt}),it("/Contents "+hi+" 0 R"),it(">>"),it("endobj");var Ii=Tt.join(`
`);return q===Q.ADVANCED&&(Ii+=`
Q`),xt(hi,!0),er({data:Ii,filters:Fi(),objectId:hi}),it("endobj"),jt},Sr=E.__private__.putPages=function(){var ie,Ue,Tt=[];for(ie=1;ie<=Lr;ie++)yr[ie].objId=Ye(),yr[ie].contentsObjId=Ye();for(ie=1;ie<=Lr;ie++)Tt.push(nr({number:ie,data:mi[ie],objId:yr[ie].objId,contentsObjId:yr[ie].contentsObjId,mediaBox:yr[ie].mediaBox,cropBox:yr[ie].cropBox,bleedBox:yr[ie].bleedBox,trimBox:yr[ie].trimBox,artBox:yr[ie].artBox,userUnit:yr[ie].userUnit,rootDictionaryObjId:bt,resourceDictionaryObjId:Ut}));xt(bt,!0),it("<</Type /Pages");var jt="/Kids [";for(Ue=0;Ue<Lr;Ue++)jt+=Tt[Ue]+" 0 R ";it(jt+"]"),it("/Count "+Lr),it(">>"),it("endobj"),qt.publish("postPutPages")},Mr=function(ie){qt.publish("putFont",{font:ie,out:it,newObject:tt,putStream:er}),ie.isAlreadyPutted!==!0&&(ie.objectNumber=tt(),it("<<"),it("/Type /Font"),it("/BaseFont /"+rm(ie.postScriptName)),it("/Subtype /Type1"),typeof ie.encoding=="string"&&it("/Encoding /"+ie.encoding),it("/FirstChar 32"),it("/LastChar 255"),it(">>"),it("endobj"))},jr=function(){for(var ie in _r)_r.hasOwnProperty(ie)&&(B===!1||B===!0&&I.hasOwnProperty(ie))&&Mr(_r[ie])},nn=function(ie){ie.objectNumber=tt();var Ue=[];Ue.push({key:"Type",value:"/XObject"}),Ue.push({key:"Subtype",value:"/Form"}),Ue.push({key:"BBox",value:"["+[Ae(ie.x),Ae(ie.y),Ae(ie.x+ie.width),Ae(ie.y+ie.height)].join(" ")+"]"}),Ue.push({key:"Matrix",value:"["+ie.matrix.toString()+"]"});var Tt=ie.pages[1].join(`
`);er({data:Tt,additionalKeyValues:Ue,objectId:ie.objectNumber}),it("endobj")},Yr=function(){for(var ie in xs)xs.hasOwnProperty(ie)&&nn(xs[ie])},qn=function(ie,Ue){var Tt,jt=[],hi=1/(Ue-1);for(Tt=0;Tt<1;Tt+=hi)jt.push(Tt);if(jt.push(1),ie[0].offset!=0){var Ii={offset:0,color:ie[0].color};ie.unshift(Ii)}if(ie[ie.length-1].offset!=1){var mr={offset:1,color:ie[ie.length-1].color};ie.push(mr)}for(var Vr="",cn=0,Rn=0;Rn<jt.length;Rn++){for(Tt=jt[Rn];Tt>ie[cn+1].offset;)cn++;var Dn=ie[cn].offset,As=(Tt-Dn)/(ie[cn+1].offset-Dn),Zs=ie[cn].color,ts=ie[cn+1].color;Vr+=mt(Math.round((1-As)*Zs[0]+As*ts[0]).toString(16))+mt(Math.round((1-As)*Zs[1]+As*ts[1]).toString(16))+mt(Math.round((1-As)*Zs[2]+As*ts[2]).toString(16))}return Vr.trim()},gs=function(ie,Ue){Ue||(Ue=21);var Tt=tt(),jt=qn(ie.colors,Ue),hi=[];hi.push({key:"FunctionType",value:"0"}),hi.push({key:"Domain",value:"[0.0 1.0]"}),hi.push({key:"Size",value:"["+Ue+"]"}),hi.push({key:"BitsPerSample",value:"8"}),hi.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),hi.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),er({data:jt,additionalKeyValues:hi,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Tt}),it("endobj"),ie.objectNumber=tt(),it("<< /ShadingType "+ie.type),it("/ColorSpace /DeviceRGB");var Ii="/Coords ["+Ae(parseFloat(ie.coords[0]))+" "+Ae(parseFloat(ie.coords[1]))+" ";ie.type===2?Ii+=Ae(parseFloat(ie.coords[2]))+" "+Ae(parseFloat(ie.coords[3])):Ii+=Ae(parseFloat(ie.coords[2]))+" "+Ae(parseFloat(ie.coords[3]))+" "+Ae(parseFloat(ie.coords[4]))+" "+Ae(parseFloat(ie.coords[5])),it(Ii+="]"),ie.matrix&&it("/Matrix ["+ie.matrix.toString()+"]"),it("/Function "+Tt+" 0 R"),it("/Extend [true true]"),it(">>"),it("endobj")},ms=function(ie,Ue){var Tt=Ye(),jt=tt();Ue.push({resourcesOid:Tt,objectOid:jt}),ie.objectNumber=jt;var hi=[];hi.push({key:"Type",value:"/Pattern"}),hi.push({key:"PatternType",value:"1"}),hi.push({key:"PaintType",value:"1"}),hi.push({key:"TilingType",value:"1"}),hi.push({key:"BBox",value:"["+ie.boundingBox.map(Ae).join(" ")+"]"}),hi.push({key:"XStep",value:Ae(ie.xStep)}),hi.push({key:"YStep",value:Ae(ie.yStep)}),hi.push({key:"Resources",value:Tt+" 0 R"}),ie.matrix&&hi.push({key:"Matrix",value:"["+ie.matrix.toString()+"]"}),er({data:ie.stream,additionalKeyValues:hi,objectId:ie.objectNumber}),it("endobj")},En=function(ie){var Ue;for(Ue in Ur)Ur.hasOwnProperty(Ue)&&(Ur[Ue]instanceof _p?gs(Ur[Ue]):Ur[Ue]instanceof dg&&ms(Ur[Ue],ie))},In=function(ie){for(var Ue in ie.objectNumber=tt(),it("<<"),ie)switch(Ue){case"opacity":it("/ca "+we(ie[Ue]));break;case"stroke-opacity":it("/CA "+we(ie[Ue]))}it(">>"),it("endobj")},Ls=function(){var ie;for(ie in ps)ps.hasOwnProperty(ie)&&In(ps[ie])},bs=function(){for(var ie in it("/XObject <<"),xs)xs.hasOwnProperty(ie)&&xs[ie].objectNumber>=0&&it("/"+ie+" "+xs[ie].objectNumber+" 0 R");qt.publish("putXobjectDict"),it(">>")},hs=function(){Xo.oid=tt(),it("<<"),it("/Filter /Standard"),it("/V "+Xo.v),it("/R "+Xo.r),it("/U <"+Xo.toHexString(Xo.U)+">"),it("/O <"+Xo.toHexString(Xo.O)+">"),it("/P "+Xo.P),it(">>"),it("endobj")},Uo=function(){for(var ie in it("/Font <<"),_r)_r.hasOwnProperty(ie)&&(B===!1||B===!0&&I.hasOwnProperty(ie))&&it("/"+ie+" "+_r[ie].objectNumber+" 0 R");it(">>")},Da=function(){if(Object.keys(Ur).length>0){for(var ie in it("/Shading <<"),Ur)Ur.hasOwnProperty(ie)&&Ur[ie]instanceof _p&&Ur[ie].objectNumber>=0&&it("/"+ie+" "+Ur[ie].objectNumber+" 0 R");qt.publish("putShadingPatternDict"),it(">>")}},So=function(ie){if(Object.keys(Ur).length>0){for(var Ue in it("/Pattern <<"),Ur)Ur.hasOwnProperty(Ue)&&Ur[Ue]instanceof E.TilingPattern&&Ur[Ue].objectNumber>=0&&Ur[Ue].objectNumber<ie&&it("/"+Ue+" "+Ur[Ue].objectNumber+" 0 R");qt.publish("putTilingPatternDict"),it(">>")}},vc=function(){if(Object.keys(ps).length>0){var ie;for(ie in it("/ExtGState <<"),ps)ps.hasOwnProperty(ie)&&ps[ie].objectNumber>=0&&it("/"+ie+" "+ps[ie].objectNumber+" 0 R");qt.publish("putGStateDict"),it(">>")}},ds=function(ie){xt(ie.resourcesOid,!0),it("<<"),it("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Uo(),Da(),So(ie.objectOid),vc(),bs(),it(">>"),it("endobj")},_c=function(){var ie=[];jr(),Ls(),Yr(),En(ie),qt.publish("putResources"),ie.forEach(ds),ds({resourcesOid:Ut,objectOid:Number.MAX_SAFE_INTEGER}),qt.publish("postPutResources")},ch=function(){qt.publish("putAdditionalObjects");for(var ie=0;ie<Gt.length;ie++){var Ue=Gt[ie];xt(Ue.objId,!0),it(Ue.content),it("endobj")}qt.publish("postPutAdditionalObjects")},xc=function(ie){Zr[ie.fontName]=Zr[ie.fontName]||{},Zr[ie.fontName][ie.fontStyle]=ie.id},ec=function(ie,Ue,Tt,jt,hi){var Ii={id:"F"+(Object.keys(_r).length+1).toString(10),postScriptName:ie,fontName:Ue,fontStyle:Tt,encoding:jt,isStandardFont:hi||!1,metadata:{}};return qt.publish("addFont",{font:Ii,instance:this}),_r[Ii.id]=Ii,xc(Ii),Ii.id},Nc=function(ie){for(var Ue=0,Tt=Kt.length;Ue<Tt;Ue++){var jt=ec.call(this,ie[Ue][0],ie[Ue][1],ie[Ue][2],Kt[Ue][3],!0);B===!1&&(I[jt]=!0);var hi=ie[Ue][0].split("-");xc({id:jt,fontName:hi[0],fontStyle:hi[1]||""})}qt.publish("addFonts",{fonts:_r,dictionary:Zr})},yl=function(ie){return ie.foo=function(){try{return ie.apply(this,arguments)}catch(jt){var Ue=jt.stack||"";~Ue.indexOf(" at ")&&(Ue=Ue.split(" at ")[1]);var Tt="Error in function "+Ue.split(`
`)[0].split("<")[0]+": "+jt.message;if(!es.console)throw new Error(Tt);es.console.error(Tt,jt),es.alert&&alert(Tt)}},ie.foo.bar=ie,ie.foo},Eo=function(ie,Ue){var Tt,jt,hi,Ii,mr,Vr,cn,Rn,Dn;if(hi=(Ue=Ue||{}).sourceEncoding||"Unicode",mr=Ue.outputEncoding,(Ue.autoencode||mr)&&_r[ui].metadata&&_r[ui].metadata[hi]&&_r[ui].metadata[hi].encoding&&(Ii=_r[ui].metadata[hi].encoding,!mr&&_r[ui].encoding&&(mr=_r[ui].encoding),!mr&&Ii.codePages&&(mr=Ii.codePages[0]),typeof mr=="string"&&(mr=Ii[mr]),mr)){for(cn=!1,Vr=[],Tt=0,jt=ie.length;Tt<jt;Tt++)(Rn=mr[ie.charCodeAt(Tt)])?Vr.push(String.fromCharCode(Rn)):Vr.push(ie[Tt]),Vr[Tt].charCodeAt(0)>>8&&(cn=!0);ie=Vr.join("")}for(Tt=ie.length;cn===void 0&&Tt!==0;)ie.charCodeAt(Tt-1)>>8&&(cn=!0),Tt--;if(!cn)return ie;for(Vr=Ue.noBOM?[]:[254,255],Tt=0,jt=ie.length;Tt<jt;Tt++){if((Dn=(Rn=ie.charCodeAt(Tt))>>8)>>8)throw new Error("Character at position "+Tt+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Vr.push(Dn),Vr.push(Rn-(Dn<<8))}return String.fromCharCode.apply(void 0,Vr)},Ta=E.__private__.pdfEscape=E.pdfEscape=function(ie,Ue){return Eo(ie,Ue).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ou=E.__private__.beginPage=function(ie){mi[++Lr]=[],yr[Lr]={objId:0,contentsObjId:0,userUnit:Number(r),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ie[0]),topRightY:Number(ie[1])}},ll(Lr),Ft(mi[Je])},vl=function(ie,Ue){var Tt,jt,hi;switch(t=Ue||t,typeof ie=="string"&&(Tt=U(ie.toLowerCase()),Array.isArray(Tt)&&(jt=Tt[0],hi=Tt[1])),Array.isArray(ie)&&(jt=ie[0]*li,hi=ie[1]*li),isNaN(jt)&&(jt=c[0],hi=c[1]),(jt>14400||hi>14400)&&(da.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),jt=Math.min(14400,jt),hi=Math.min(14400,hi)),c=[jt,hi],t.substr(0,1)){case"l":hi>jt&&(c=[hi,jt]);break;case"p":jt>hi&&(c=[hi,jt])}Ou(c),Bl(gu),it(Za),vu!==0&&it(vu+" J"),Er!==0&&it(Er+" j"),qt.publish("addPage",{pageNumber:Lr})},al=function(ie){ie>0&&ie<=Lr&&(mi.splice(ie,1),yr.splice(ie,1),Lr--,Je>Lr&&(Je=Lr),this.setPage(Je))},ll=function(ie){ie>0&&ie<=Lr&&(Je=ie)},bc=E.__private__.getNumberOfPages=E.getNumberOfPages=function(){return mi.length-1},_l=function(ie,Ue,Tt){var jt,hi=void 0;return Tt=Tt||{},ie=ie!==void 0?ie:_r[ui].fontName,Ue=Ue!==void 0?Ue:_r[ui].fontStyle,jt=ie.toLowerCase(),Zr[jt]!==void 0&&Zr[jt][Ue]!==void 0?hi=Zr[jt][Ue]:Zr[ie]!==void 0&&Zr[ie][Ue]!==void 0?hi=Zr[ie][Ue]:Tt.disableWarning===!1&&da.warn("Unable to look up font label for font '"+ie+"', '"+Ue+"'. Refer to getFontList() for available fonts."),hi||Tt.noFallback||(hi=Zr.times[Ue])==null&&(hi=Zr.times.normal),hi},wc=E.__private__.putInfo=function(){var ie=tt(),Ue=function(jt){return jt};for(var Tt in _!==null&&(Ue=Xo.encryptor(ie,0)),it("<<"),it("/Producer ("+Ta(Ue("jsPDF "+Yn.version))+")"),Qr)Qr.hasOwnProperty(Tt)&&Qr[Tt]&&it("/"+Tt.substr(0,1).toUpperCase()+Tt.substr(1)+" ("+Ta(Ue(Qr[Tt]))+")");it("/CreationDate ("+Ta(Ue(Me))+")"),it(">>"),it("endobj")},tc=E.__private__.putCatalog=function(ie){var Ue=(ie=ie||{}).rootDictionaryObjId||bt;switch(tt(),it("<<"),it("/Type /Catalog"),it("/Pages "+Ue+" 0 R"),fi||(fi="fullwidth"),fi){case"fullwidth":it("/OpenAction [3 0 R /FitH null]");break;case"fullheight":it("/OpenAction [3 0 R /FitV null]");break;case"fullpage":it("/OpenAction [3 0 R /Fit]");break;case"original":it("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Tt=""+fi;Tt.substr(Tt.length-1)==="%"&&(fi=parseInt(fi)/100),typeof fi=="number"&&it("/OpenAction [3 0 R /XYZ null null "+we(fi)+"]")}switch(br||(br="continuous"),br){case"continuous":it("/PageLayout /OneColumn");break;case"single":it("/PageLayout /SinglePage");break;case"two":case"twoleft":it("/PageLayout /TwoColumnLeft");break;case"tworight":it("/PageLayout /TwoColumnRight")}Ji&&it("/PageMode /"+Ji),qt.publish("putCatalog"),it(">>"),it("endobj")},ic=E.__private__.putTrailer=function(){it("trailer"),it("<<"),it("/Size "+(Bt+1)),it("/Root "+Bt+" 0 R"),it("/Info "+(Bt-1)+" 0 R"),_!==null&&it("/Encrypt "+Xo.oid+" 0 R"),it("/ID [ <"+Re+"> <"+Re+"> ]"),it(">>")},Uu=E.__private__.putHeader=function(){it("%PDF-"+R),it("%ºß¬à")},hu=E.__private__.putXRef=function(){var ie="0000000000";it("xref"),it("0 "+(Bt+1)),it("0000000000 65535 f ");for(var Ue=1;Ue<=Bt;Ue++)typeof rt[Ue]=="function"?it((ie+rt[Ue]()).slice(-10)+" 00000 n "):rt[Ue]!==void 0?it((ie+rt[Ue]).slice(-10)+" 00000 n "):it("0000000000 00000 n ")},xl=E.__private__.buildDocument=function(){kt(),Ft(St),qt.publish("buildDocument"),Uu(),Sr(),ch(),_c(),_!==null&&hs(),wc(),tc();var ie=vt;return hu(),ic(),it("startxref"),it(""+ie),it("%%EOF"),Ft(mi[Je]),St.join(`
`)},du=E.__private__.getBlob=function(ie){return new Blob([bi(ie)],{type:"application/pdf"})},jc=E.output=E.__private__.output=yl(function(ie,Ue){switch(typeof(Ue=Ue||{})=="string"?Ue={filename:Ue}:Ue.filename=Ue.filename||"generated.pdf",ie){case void 0:return xl();case"save":E.save(Ue.filename);break;case"arraybuffer":return bi(xl());case"blob":return du(xl());case"bloburi":case"bloburl":if(es.URL!==void 0&&typeof es.URL.createObjectURL=="function")return es.URL&&es.URL.createObjectURL(du(xl()))||void 0;da.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Tt="",jt=xl();try{Tt=m1(jt)}catch{Tt=m1(unescape(encodeURIComponent(jt)))}return"data:application/pdf;filename="+Ue.filename+";base64,"+Tt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(es)==="[object Window]"){var hi="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ii=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ue.pdfObjectUrl&&(hi=Ue.pdfObjectUrl,Ii="");var mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+hi+'"'+Ii+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ue)+");<\/script></body></html>",Vr=es.open();return Vr!==null&&Vr.document.write(mr),Vr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(es)==="[object Window]"){var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ue.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ue.filename+'" width="500px" height="400px" /></body></html>',Rn=es.open();if(Rn!==null){Rn.document.write(cn);var Dn=this;Rn.document.documentElement.querySelector("#pdfViewer").onload=function(){Rn.document.title=Ue.filename,Rn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Dn.output("bloburl"))}}return Rn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(es)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var As='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ue)+'"></iframe></body></html>',Zs=es.open();if(Zs!==null&&(Zs.document.write(As),Zs.document.title=Ue.filename),Zs||typeof safari>"u")return Zs;break;case"datauri":case"dataurl":return es.document.location.href=this.output("datauristring",Ue);default:return null}}),ko=function(ie){return Array.isArray(Vn)===!0&&Vn.indexOf(ie)>-1};switch(s){case"pt":li=1;break;case"mm":li=72/25.4;break;case"cm":li=72/2.54;break;case"in":li=72;break;case"px":li=ko("px_scaling")==1?.75:96/72;break;case"pc":case"em":li=12;break;case"ex":li=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);li=s}var Xo=null;It(),$e();var uh=function(ie){return _!==null?Xo.encryptor(ie,0):function(Ue){return Ue}},Au=E.__private__.getPageInfo=E.getPageInfo=function(ie){if(isNaN(ie)||ie%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:yr[ie].objId,pageNumber:ie,pageContext:yr[ie]}},Tn=E.__private__.getPageInfoByObjId=function(ie){if(isNaN(ie)||ie%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ue in yr)if(yr[Ue].objId===ie)break;return Au(Ue)},iA=E.__private__.getCurrentPageInfo=E.getCurrentPageInfo=function(){return{objId:yr[Je].objId,pageNumber:Je,pageContext:yr[Je]}};E.addPage=function(){return vl.apply(this,arguments),this},E.setPage=function(){return ll.apply(this,arguments),Ft.call(this,mi[Je]),this},E.insertPage=function(ie){return this.addPage(),this.movePage(Je,ie),this},E.movePage=function(ie,Ue){var Tt,jt;if(ie>Ue){Tt=mi[ie],jt=yr[ie];for(var hi=ie;hi>Ue;hi--)mi[hi]=mi[hi-1],yr[hi]=yr[hi-1];mi[Ue]=Tt,yr[Ue]=jt,this.setPage(Ue)}else if(ie<Ue){Tt=mi[ie],jt=yr[ie];for(var Ii=ie;Ii<Ue;Ii++)mi[Ii]=mi[Ii+1],yr[Ii]=yr[Ii+1];mi[Ue]=Tt,yr[Ue]=jt,this.setPage(Ue)}return this},E.deletePage=function(){return al.apply(this,arguments),this},E.__private__.text=E.text=function(ie,Ue,Tt,jt,hi){var Ii,mr,Vr,cn,Rn,Dn,As,Zs,ts,bn=(jt=jt||{}).scope||this;if(typeof ie=="number"&&typeof Ue=="number"&&(typeof Tt=="string"||Array.isArray(Tt))){var Js=Tt;Tt=Ue,Ue=ie,ie=Js}if(arguments[3]instanceof Et?(le("The transform parameter of text() with a Matrix value"),ts=hi):(Vr=arguments[4],cn=arguments[5],Wo(As=arguments[3])==="object"&&As!==null||(typeof Vr=="string"&&(cn=Vr,Vr=null),typeof As=="string"&&(cn=As,As=null),typeof As=="number"&&(Vr=As,As=null),jt={flags:As,angle:Vr,align:cn})),isNaN(Ue)||isNaN(Tt)||ie==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ie.length===0)return bn;var vo="",Wr=!1,ji=typeof jt.lineHeightFactor=="number"?jt.lineHeightFactor:$a,eo=bn.internal.scaleFactor;function Pr(wi){return wi=wi.split("	").join(Array(jt.TabLen||9).join(" ")),Ta(wi,As)}function Es(wi){for(var no,bo=wi.concat(),po=[],Gl=bo.length;Gl--;)typeof(no=bo.shift())=="string"?po.push(no):Array.isArray(wi)&&(no.length===1||no[1]===void 0&&no[2]===void 0)?po.push(no[0]):po.push([no[0],no[1],no[2]]);return po}function lo(wi,no){var bo;if(typeof wi=="string")bo=no(wi)[0];else if(Array.isArray(wi)){for(var po,Gl,Bu=wi.concat(),Na=[],ph=Bu.length;ph--;)typeof(po=Bu.shift())=="string"?Na.push(no(po)[0]):Array.isArray(po)&&typeof po[0]=="string"&&(Gl=no(po[0],po[1],po[2]),Na.push([Gl[0],Gl[1],Gl[2]]));bo=Na}return bo}var wr=!1,_o=!0;if(typeof ie=="string")wr=!0;else if(Array.isArray(ie)){var oc=ie.concat();mr=[];for(var fa,Yo=oc.length;Yo--;)(typeof(fa=oc.shift())!="string"||Array.isArray(fa)&&typeof fa[0]!="string")&&(_o=!1);wr=_o}if(wr===!1)throw new Error('Type of text must be string or Array. "'+ie+'" is not recognized.');typeof ie=="string"&&(ie=ie.match(/[\r?\n]/)?ie.split(/\r\n|\r|\n/g):[ie]);var is=di/bn.internal.scaleFactor,Ko=is*(ji-1);switch(jt.baseline){case"bottom":Tt-=Ko;break;case"top":Tt+=is-Ko;break;case"hanging":Tt+=is-2*Ko;break;case"middle":Tt+=is/2-Ko}if((Dn=jt.maxWidth||0)>0&&(typeof ie=="string"?ie=bn.splitTextToSize(ie,Dn):Object.prototype.toString.call(ie)==="[object Array]"&&(ie=ie.reduce(function(wi,no){return wi.concat(bn.splitTextToSize(no,Dn))},[]))),Ii={text:ie,x:Ue,y:Tt,options:jt,mutex:{pdfEscape:Ta,activeFontKey:ui,fonts:_r,activeFontSize:di}},qt.publish("preProcessText",Ii),ie=Ii.text,Vr=(jt=Ii.options).angle,!(ts instanceof Et)&&Vr&&typeof Vr=="number"){Vr*=Math.PI/180,jt.rotationDirection===0&&(Vr=-Vr),q===Q.ADVANCED&&(Vr=-Vr);var Sc=Math.cos(Vr),Io=Math.sin(Vr);ts=new Et(Sc,Io,-Io,Sc,0,0)}else Vr&&Vr instanceof Et&&(ts=Vr);q!==Q.ADVANCED||ts||(ts=Ee),(Rn=jt.charSpace||No)!==void 0&&(vo+=Ae(me(Rn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Zs=jt.horizontalScale)!==void 0&&(vo+=Ae(100*Zs)+` Tz
`),jt.lang;var Ua=-1,cl=jt.renderingMode!==void 0?jt.renderingMode:jt.stroke,qo=bn.internal.getCurrentPageInfo().pageContext;switch(cl){case 0:case!1:case"fill":Ua=0;break;case 1:case!0:case"stroke":Ua=1;break;case 2:case"fillThenStroke":Ua=2;break;case 3:case"invisible":Ua=3;break;case 4:case"fillAndAddForClipping":Ua=4;break;case 5:case"strokeAndAddPathForClipping":Ua=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ua=6;break;case 7:case"addToPathForClipping":Ua=7}var _u=qo.usedRenderingMode!==void 0?qo.usedRenderingMode:-1;Ua!==-1?vo+=Ua+` Tr
`:_u!==-1&&(vo+=`0 Tr
`),Ua!==-1&&(qo.usedRenderingMode=Ua),cn=jt.align||"left";var jo,zl=di*ji,Fa=bn.internal.pageSize.getWidth(),xo=_r[ui];Rn=jt.charSpace||No,Dn=jt.maxWidth||0,As=Object.assign({autoencode:!0,noBOM:!0},jt.flags);var oa=[],Nl=function(wi){return bn.getStringUnitWidth(wi,{font:xo,charSpace:Rn,fontSize:di,doKerning:!1})*di/eo};if(Object.prototype.toString.call(ie)==="[object Array]"){var Ja;mr=Es(ie),cn!=="left"&&(jo=mr.map(Nl));var pa,Ec=0;if(cn==="right"){Ue-=jo[0],ie=[],Yo=mr.length;for(var za=0;za<Yo;za++)za===0?(pa=nc(Ue),Ja=sc(Tt)):(pa=me(Ec-jo[za]),Ja=-zl),ie.push([mr[za],pa,Ja]),Ec=jo[za]}else if(cn==="center"){Ue-=jo[0]/2,ie=[],Yo=mr.length;for(var jl=0;jl<Yo;jl++)jl===0?(pa=nc(Ue),Ja=sc(Tt)):(pa=me((Ec-jo[jl])/2),Ja=-zl),ie.push([mr[jl],pa,Ja]),Ec=jo[jl]}else if(cn==="left"){ie=[],Yo=mr.length;for(var Sl=0;Sl<Yo;Sl++)ie.push(mr[Sl])}else if(cn==="justify"&&xo.encoding==="Identity-H"){ie=[],Yo=mr.length,Dn=Dn!==0?Dn:Fa;for(var Wc=0,$o=0;$o<Yo;$o++)if(Ja=$o===0?sc(Tt):-zl,pa=$o===0?nc(Ue):Wc,$o<Yo-1){var El=me((Dn-jo[$o])/(mr[$o].split(" ").length-1)),La=mr[$o].split(" ");ie.push([La[0]+" ",pa,Ja]),Wc=0;for(var Hl=1;Hl<La.length;Hl++){var xu=(Nl(La[Hl-1]+" "+La[Hl])-Nl(La[Hl]))*eo+El;Hl==La.length-1?ie.push([La[Hl],xu,0]):ie.push([La[Hl]+" ",xu,0]),Wc-=xu}}else ie.push([mr[$o],pa,Ja]);ie.push(["",Wc,0])}else{if(cn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ie=[],Yo=mr.length,Dn=Dn!==0?Dn:Fa,$o=0;$o<Yo;$o++)Ja=$o===0?sc(Tt):-zl,pa=$o===0?nc(Ue):0,$o<Yo-1?oa.push(Ae(me((Dn-jo[$o])/(mr[$o].split(" ").length-1)))):oa.push(0),ie.push([mr[$o],pa,Ja])}}var el=typeof jt.R2L=="boolean"?jt.R2L:Oi;el===!0&&(ie=lo(ie,function(wi,no,bo){return[wi.split("").reverse().join(""),no,bo]})),Ii={text:ie,x:Ue,y:Tt,options:jt,mutex:{pdfEscape:Ta,activeFontKey:ui,fonts:_r,activeFontSize:di}},qt.publish("postProcessText",Ii),ie=Ii.text,Wr=Ii.mutex.isHex||!1;var ju=_r[ui].encoding;ju!=="WinAnsiEncoding"&&ju!=="StandardEncoding"||(ie=lo(ie,function(wi,no,bo){return[Pr(wi),no,bo]})),mr=Es(ie),ie=[];for(var Ho,Ic,Ql,bu=0,ac=1,Vl=Array.isArray(mr[0])?ac:bu,Tc="",wu=function(wi,no,bo){var po="";return bo instanceof Et?(bo=typeof jt.angle=="number"?ye(bo,new Et(1,0,0,1,wi,no)):ye(new Et(1,0,0,1,wi,no),bo),q===Q.ADVANCED&&(bo=ye(new Et(1,0,0,-1,0,0),bo)),po=bo.join(" ")+` Tm
`):po=Ae(wi)+" "+Ae(no)+` Td
`,po},To=0;To<mr.length;To++){switch(Tc="",Vl){case ac:Ql=(Wr?"<":"(")+mr[To][0]+(Wr?">":")"),Ho=parseFloat(mr[To][1]),Ic=parseFloat(mr[To][2]);break;case bu:Ql=(Wr?"<":"(")+mr[To]+(Wr?">":")"),Ho=nc(Ue),Ic=sc(Tt)}oa!==void 0&&oa[To]!==void 0&&(Tc=oa[To]+` Tw
`),To===0?ie.push(Tc+wu(Ho,Ic,ts)+Ql):Vl===bu?ie.push(Tc+Ql):Vl===ac&&ie.push(Tc+wu(Ho,Ic,ts)+Ql)}ie=Vl===bu?ie.join(` Tj
T* `):ie.join(` Tj
`),ie+=` Tj
`;var tl=`BT
/`;return tl+=ui+" "+di+` Tf
`,tl+=Ae(di*ji)+` TL
`,tl+=Cl+`
`,tl+=vo,tl+=ie,it(tl+="ET"),I[ui]=!0,bn};var hh=E.__private__.clip=E.clip=function(ie){return it(ie==="evenodd"?"W*":"W"),this};E.clipEvenOdd=function(){return hh("evenodd")},E.__private__.discardPath=E.discardPath=function(){return it("n"),this};var pn=E.__private__.isValidStyle=function(ie){var Ue=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ie)!==-1&&(Ue=!0),Ue};E.__private__.setDefaultPathOperation=E.setDefaultPathOperation=function(ie){return pn(ie)&&(b=ie),this};var dh=E.__private__.getStyle=E.getStyle=function(ie){var Ue=b;switch(ie){case"D":case"S":Ue="S";break;case"F":Ue="f";break;case"FD":case"DF":Ue="B";break;case"f":case"f*":case"B":case"B*":Ue=ie}return Ue},fu=E.close=function(){return it("h"),this};E.stroke=function(){return it("S"),this},E.fill=function(ie){return Hc("f",ie),this},E.fillEvenOdd=function(ie){return Hc("f*",ie),this},E.fillStroke=function(ie){return Hc("B",ie),this},E.fillStrokeEvenOdd=function(ie){return Hc("B*",ie),this};var Hc=function(ie,Ue){Wo(Ue)==="object"?Qc(Ue,ie):it(ie)},bl=function(ie){ie===null||q===Q.ADVANCED&&ie===void 0||(ie=dh(ie),it(ie))};function zu(ie,Ue,Tt,jt,hi){var Ii=new dg(Ue||this.boundingBox,Tt||this.xStep,jt||this.yStep,this.gState,hi||this.matrix);Ii.stream=this.stream;var mr=ie+"$$"+this.cloneIndex+++"$$";return He(mr,Ii),Ii}var Qc=function(ie,Ue){var Tt=ia[ie.key],jt=Ur[Tt];if(jt instanceof _p)it("q"),it(Bc(Ue)),jt.gState&&E.setGState(jt.gState),it(ie.matrix.toString()+" cm"),it("/"+Tt+" sh"),it("Q");else if(jt instanceof dg){var hi=new Et(1,0,0,-1,0,sa());ie.matrix&&(hi=hi.multiply(ie.matrix||Ee),Tt=zu.call(jt,ie.key,ie.boundingBox,ie.xStep,ie.yStep,hi).id),it("q"),it("/Pattern cs"),it("/"+Tt+" scn"),jt.gState&&E.setGState(jt.gState),it(Ue),it("Q")}},Bc=function(ie){switch(ie){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ah=E.moveTo=function(ie,Ue){return it(Ae(me(ie))+" "+Ae(Se(Ue))+" m"),this},pu=E.lineTo=function(ie,Ue){return it(Ae(me(ie))+" "+Ae(Se(Ue))+" l"),this},wl=E.curveTo=function(ie,Ue,Tt,jt,hi,Ii){return it([Ae(me(ie)),Ae(Se(Ue)),Ae(me(Tt)),Ae(Se(jt)),Ae(me(hi)),Ae(Se(Ii)),"c"].join(" ")),this};E.__private__.line=E.line=function(ie,Ue,Tt,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.line");return q===Q.COMPAT?this.lines([[Tt-ie,jt-Ue]],ie,Ue,[1,1],hi||"S"):this.lines([[Tt-ie,jt-Ue]],ie,Ue,[1,1]).stroke()},E.__private__.lines=E.lines=function(ie,Ue,Tt,jt,hi,Ii){var mr,Vr,cn,Rn,Dn,As,Zs,ts,bn,Js,vo,Wr;if(typeof ie=="number"&&(Wr=Tt,Tt=Ue,Ue=ie,ie=Wr),jt=jt||[1,1],Ii=Ii||!1,isNaN(Ue)||isNaN(Tt)||!Array.isArray(ie)||!Array.isArray(jt)||!pn(hi)||typeof Ii!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ah(Ue,Tt),mr=jt[0],Vr=jt[1],Rn=ie.length,Js=Ue,vo=Tt,cn=0;cn<Rn;cn++)(Dn=ie[cn]).length===2?(Js=Dn[0]*mr+Js,vo=Dn[1]*Vr+vo,pu(Js,vo)):(As=Dn[0]*mr+Js,Zs=Dn[1]*Vr+vo,ts=Dn[2]*mr+Js,bn=Dn[3]*Vr+vo,Js=Dn[4]*mr+Js,vo=Dn[5]*Vr+vo,wl(As,Zs,ts,bn,Js,vo));return Ii&&fu(),bl(hi),this},E.path=function(ie){for(var Ue=0;Ue<ie.length;Ue++){var Tt=ie[Ue],jt=Tt.c;switch(Tt.op){case"m":Ah(jt[0],jt[1]);break;case"l":pu(jt[0],jt[1]);break;case"c":wl.apply(this,jt);break;case"h":fu()}}return this},E.__private__.rect=E.rect=function(ie,Ue,Tt,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.rect");return q===Q.COMPAT&&(jt=-jt),it([Ae(me(ie)),Ae(Se(Ue)),Ae(me(Tt)),Ae(me(jt)),"re"].join(" ")),bl(hi),this},E.__private__.triangle=E.triangle=function(ie,Ue,Tt,jt,hi,Ii,mr){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||isNaN(jt)||isNaN(hi)||isNaN(Ii)||!pn(mr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Tt-ie,jt-Ue],[hi-Tt,Ii-jt],[ie-hi,Ue-Ii]],ie,Ue,[1,1],mr,!0),this},E.__private__.roundedRect=E.roundedRect=function(ie,Ue,Tt,jt,hi,Ii,mr){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||isNaN(jt)||isNaN(hi)||isNaN(Ii)||!pn(mr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Vr=4/3*(Math.SQRT2-1);return hi=Math.min(hi,.5*Tt),Ii=Math.min(Ii,.5*jt),this.lines([[Tt-2*hi,0],[hi*Vr,0,hi,Ii-Ii*Vr,hi,Ii],[0,jt-2*Ii],[0,Ii*Vr,-hi*Vr,Ii,-hi,Ii],[2*hi-Tt,0],[-hi*Vr,0,-hi,-Ii*Vr,-hi,-Ii],[0,2*Ii-jt],[0,-Ii*Vr,hi*Vr,-Ii,hi,-Ii]],ie+hi,Ue,[1,1],mr,!0),this},E.__private__.ellipse=E.ellipse=function(ie,Ue,Tt,jt,hi){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||isNaN(jt)||!pn(hi))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ii=4/3*(Math.SQRT2-1)*Tt,mr=4/3*(Math.SQRT2-1)*jt;return Ah(ie+Tt,Ue),wl(ie+Tt,Ue-mr,ie+Ii,Ue-jt,ie,Ue-jt),wl(ie-Ii,Ue-jt,ie-Tt,Ue-mr,ie-Tt,Ue),wl(ie-Tt,Ue+mr,ie-Ii,Ue+jt,ie,Ue+jt),wl(ie+Ii,Ue+jt,ie+Tt,Ue+mr,ie+Tt,Ue),bl(hi),this},E.__private__.circle=E.circle=function(ie,Ue,Tt,jt){if(isNaN(ie)||isNaN(Ue)||isNaN(Tt)||!pn(jt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ie,Ue,Tt,Tt,jt)},E.setFont=function(ie,Ue,Tt){return Tt&&(Ue=pe(Ue,Tt)),ui=_l(ie,Ue,{disableWarning:!1}),this};var ud=E.__private__.getFont=E.getFont=function(){return _r[_l.apply(E,arguments)]};E.__private__.getFontList=E.getFontList=function(){var ie,Ue,Tt={};for(ie in Zr)if(Zr.hasOwnProperty(ie))for(Ue in Tt[ie]=[],Zr[ie])Zr[ie].hasOwnProperty(Ue)&&Tt[ie].push(Ue);return Tt},E.addFont=function(ie,Ue,Tt,jt,hi){var Ii=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ii.indexOf(arguments[3])!==-1?hi=arguments[3]:arguments[3]&&Ii.indexOf(arguments[3])==-1&&(Tt=pe(Tt,jt)),hi=hi||"Identity-H",ec.call(this,ie,Ue,Tt,hi)};var $a,gu=a.lineWidth||.200025,mu=E.__private__.getLineWidth=E.getLineWidth=function(){return gu},Bl=E.__private__.setLineWidth=E.setLineWidth=function(ie){return gu=ie,it(Ae(me(ie))+" w"),this};E.__private__.setLineDash=Yn.API.setLineDash=Yn.API.setLineDashPattern=function(ie,Ue){if(ie=ie||[],Ue=Ue||0,isNaN(Ue)||!Array.isArray(ie))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ie=ie.map(function(Tt){return Ae(me(Tt))}).join(" "),Ue=Ae(me(Ue)),it("["+ie+"] "+Ue+" d"),this};var zo=E.__private__.getLineHeight=E.getLineHeight=function(){return di*$a};E.__private__.getLineHeight=E.getLineHeight=function(){return di*$a};var Vc=E.__private__.setLineHeightFactor=E.setLineHeightFactor=function(ie){return typeof(ie=ie||1.15)=="number"&&($a=ie),this},rc=E.__private__.getLineHeightFactor=E.getLineHeightFactor=function(){return $a};Vc(a.lineHeight);var nc=E.__private__.getHorizontalCoordinate=function(ie){return me(ie)},sc=E.__private__.getVerticalCoordinate=function(ie){return q===Q.ADVANCED?ie:yr[Je].mediaBox.topRightY-yr[Je].mediaBox.bottomLeftY-me(ie)},yu=E.__private__.getHorizontalCoordinateString=E.getHorizontalCoordinateString=function(ie){return Ae(nc(ie))},na=E.__private__.getVerticalCoordinateString=E.getVerticalCoordinateString=function(ie){return Ae(sc(ie))},Za=a.strokeColor||"0 G";E.__private__.getStrokeColor=E.getDrawColor=function(){return ii(Za)},E.__private__.setStrokeColor=E.setDrawColor=function(ie,Ue,Tt,jt){return Za=Nt({ch1:ie,ch2:Ue,ch3:Tt,ch4:jt,pdfColorType:"draw",precision:2}),it(Za),this};var Ol=a.fillColor||"0 g";E.__private__.getFillColor=E.getFillColor=function(){return ii(Ol)},E.__private__.setFillColor=E.setFillColor=function(ie,Ue,Tt,jt){return Ol=Nt({ch1:ie,ch2:Ue,ch3:Tt,ch4:jt,pdfColorType:"fill",precision:2}),it(Ol),this};var Cl=a.textColor||"0 g",jn=E.__private__.getTextColor=E.getTextColor=function(){return ii(Cl)};E.__private__.setTextColor=E.setTextColor=function(ie,Ue,Tt,jt){return Cl=Nt({ch1:ie,ch2:Ue,ch3:Tt,ch4:jt,pdfColorType:"text",precision:3}),this};var No=a.charSpace,Hh=E.__private__.getCharSpace=E.getCharSpace=function(){return parseFloat(No||0)};E.__private__.setCharSpace=E.setCharSpace=function(ie){if(isNaN(ie))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return No=ie,this};var vu=0;E.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},E.__private__.setLineCap=E.setLineCap=function(ie){var Ue=E.CapJoinStyles[ie];if(Ue===void 0)throw new Error("Line cap style of '"+ie+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return vu=Ue,it(Ue+" J"),this};var Er=0;E.__private__.setLineJoin=E.setLineJoin=function(ie){var Ue=E.CapJoinStyles[ie];if(Ue===void 0)throw new Error("Line join style of '"+ie+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Er=Ue,it(Ue+" j"),this},E.__private__.setLineMiterLimit=E.__private__.setMiterLimit=E.setLineMiterLimit=E.setMiterLimit=function(ie){if(ie=ie||0,isNaN(ie))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return it(Ae(me(ie))+" M"),this},E.GState=Jy,E.setGState=function(ie){(ie=typeof ie=="string"?ps[ro[ie]]:fh(null,ie)).equals(Qn)||(it("/"+ie.id+" gs"),Qn=ie)};var fh=function(ie,Ue){if(!ie||!ro[ie]){var Tt=!1;for(var jt in ps)if(ps.hasOwnProperty(jt)&&ps[jt].equals(Ue)){Tt=!0;break}if(Tt)Ue=ps[jt];else{var hi="GS"+(Object.keys(ps).length+1).toString(10);ps[hi]=Ue,Ue.id=hi}return ie&&(ro[ie]=Ue.id),qt.publish("addGState",Ue),Ue}};E.addGState=function(ie,Ue){return fh(ie,Ue),this},E.saveGraphicsState=function(){return it("q"),io.push({key:ui,size:di,color:Cl}),this},E.restoreGraphicsState=function(){it("Q");var ie=io.pop();return ui=ie.key,di=ie.size,Cl=ie.color,Qn=null,this},E.setCurrentTransformationMatrix=function(ie){return it(ie.toString()+" cm"),this},E.comment=function(ie){return it("#"+ie),this};var Gc=function(ie,Ue){var Tt=ie||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Tt},set:function(Ii){isNaN(Ii)||(Tt=parseFloat(Ii))}});var jt=Ue||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return jt},set:function(Ii){isNaN(Ii)||(jt=parseFloat(Ii))}});var hi="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return hi},set:function(Ii){hi=Ii.toString()}}),this},Cc=function(ie,Ue,Tt,jt){Gc.call(this,ie,Ue),this.type="rect";var hi=Tt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return hi},set:function(mr){isNaN(mr)||(hi=parseFloat(mr))}});var Ii=jt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ii},set:function(mr){isNaN(mr)||(Ii=parseFloat(mr))}}),this},Oa=function(){this.page=Lr,this.currentPage=Je,this.pages=mi.slice(0),this.pagesContext=yr.slice(0),this.x=Vi,this.y=rr,this.matrix=qr,this.width=kn(Je),this.height=sa(Je),this.outputDestination=Ve,this.id="",this.objectNumber=-1};Oa.prototype.restore=function(){Lr=this.page,Je=this.currentPage,yr=this.pagesContext,mi=this.pages,Vi=this.x,rr=this.y,qr=this.matrix,Fn(Je,this.width),Ul(Je,this.height),Ve=this.outputDestination};var Qh=function(ie,Ue,Tt,jt,hi){dn.push(new Oa),Lr=Je=0,mi=[],Vi=ie,rr=Ue,qr=hi,Ou([Tt,jt])},Nu=function(ie){if(ra[ie])dn.pop().restore();else{var Ue=new Oa,Tt="Xo"+(Object.keys(xs).length+1).toString(10);Ue.id=Tt,ra[ie]=Tt,xs[Tt]=Ue,qt.publish("addFormObject",Ue),dn.pop().restore()}};for(var dr in E.beginFormObject=function(ie,Ue,Tt,jt,hi){return Qh(ie,Ue,Tt,jt,hi),this},E.endFormObject=function(ie){return Nu(ie),this},E.doFormObject=function(ie,Ue){var Tt=xs[ra[ie]];return it("q"),it(Ue.toString()+" cm"),it("/"+Tt.id+" Do"),it("Q"),this},E.getFormObject=function(ie){var Ue=xs[ra[ie]];return{x:Ue.x,y:Ue.y,width:Ue.width,height:Ue.height,matrix:Ue.matrix}},E.save=function(ie,Ue){return ie=ie||"generated.pdf",(Ue=Ue||{}).returnPromise=Ue.returnPromise||!1,Ue.returnPromise===!1?(ag(du(xl()),ie),typeof ag.unload=="function"&&es.setTimeout&&setTimeout(ag.unload,911),this):new Promise(function(Tt,jt){try{var hi=ag(du(xl()),ie);typeof ag.unload=="function"&&es.setTimeout&&setTimeout(ag.unload,911),Tt(hi)}catch(Ii){jt(Ii.message)}})},Yn.API)Yn.API.hasOwnProperty(dr)&&(dr==="events"&&Yn.API.events.length?function(ie,Ue){var Tt,jt,hi;for(hi=Ue.length-1;hi!==-1;hi--)Tt=Ue[hi][0],jt=Ue[hi][1],ie.subscribe.apply(ie,[Tt].concat(typeof jt=="function"?[jt]:jt))}(qt,Yn.API.events):E[dr]=Yn.API[dr]);var kn=E.getPageWidth=function(ie){return(yr[ie=ie||Je].mediaBox.topRightX-yr[ie].mediaBox.bottomLeftX)/li},Fn=E.setPageWidth=function(ie,Ue){yr[ie].mediaBox.topRightX=Ue*li+yr[ie].mediaBox.bottomLeftX},sa=E.getPageHeight=function(ie){return(yr[ie=ie||Je].mediaBox.topRightY-yr[ie].mediaBox.bottomLeftY)/li},Ul=E.setPageHeight=function(ie,Ue){yr[ie].mediaBox.topRightY=Ue*li+yr[ie].mediaBox.bottomLeftY};return E.internal={pdfEscape:Ta,getStyle:dh,getFont:ud,getFontSize:Ri,getCharSpace:Hh,getTextColor:jn,getLineHeight:zo,getLineHeightFactor:rc,getLineWidth:mu,write:yi,getHorizontalCoordinate:nc,getVerticalCoordinate:sc,getCoordinateString:yu,getVerticalCoordinateString:na,collections:{},newObject:tt,newAdditionalObject:Dt,newObjectDeferred:Ye,newObjectDeferredBegin:xt,getFilters:Fi,putStream:er,events:qt,scaleFactor:li,pageSize:{getWidth:function(){return kn(Je)},setWidth:function(ie){Fn(Je,ie)},getHeight:function(){return sa(Je)},setHeight:function(ie){Ul(Je,ie)}},encryptionOptions:_,encryption:Xo,getEncryptor:uh,output:jc,getNumberOfPages:bc,pages:mi,out:it,f2:we,f3:oe,getPageInfo:Au,getPageInfoByObjId:Tn,getCurrentPageInfo:iA,getPDFVersion:M,Point:Gc,Rectangle:Cc,Matrix:Et,hasHotfix:ko},Object.defineProperty(E.internal.pageSize,"width",{get:function(){return kn(Je)},set:function(ie){Fn(Je,ie)},enumerable:!0,configurable:!0}),Object.defineProperty(E.internal.pageSize,"height",{get:function(){return sa(Je)},set:function(ie){Ul(Je,ie)},enumerable:!0,configurable:!0}),Nc.call(E,Kt),ui="F1",vl(c,t),qt.publish("initialized"),E}im.prototype.lsbFirstWord=function(a){return String.fromCharCode(a>>0&255,a>>8&255,a>>16&255,a>>24&255)},im.prototype.toHexString=function(a){return a.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},im.prototype.hexToBytes=function(a){for(var e=[],t=0;t<a.length;t+=2)e.push(String.fromCharCode(parseInt(a.substr(t,2),16)));return e.join("")},im.prototype.processOwnerPassword=function(a,e){return v1(y1(e).substr(0,5),a)},im.prototype.encryptor=function(a,e){var t=y1(this.encryptionKey+String.fromCharCode(255&a,a>>8&255,a>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return v1(t,s)}},Jy.prototype.equals=function(a){var e,t="id,objectNumber,equals";if(!a||Wo(a)!==Wo(this))return!1;var s=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!a.hasOwnProperty(e)||this[e]!==a[e])return!1;s++}for(e in a)a.hasOwnProperty(e)&&t.indexOf(e)<0&&s--;return s===0},Yn.API={events:[]},Yn.version="3.0.1";var nl=Yn.API,pw=1,Tg=function(a){return a.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zg=function(a){return a.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_s=function(a){return a.toFixed(2)},fp=function(a){return a.toFixed(5)};nl.__acroform__={};var lh=function(a,e){a.prototype=Object.create(e.prototype),a.prototype.constructor=a},kE=function(a){return a*pw},NA=function(a){var e=new GT,t=mn.internal.getHeight(a)||0,s=mn.internal.getWidth(a)||0;return e.BBox=[0,0,Number(_s(s)),Number(_s(t))],e},nz=nl.__acroform__.setBit=function(a,e){if(a=a||0,e=e||0,isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return a|=1<<e},sz=nl.__acroform__.clearBit=function(a,e){if(a=a||0,e=e||0,isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return a&=~(1<<e)},oz=nl.__acroform__.getBit=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(a&1<<e)==0?0:1},fl=nl.__acroform__.getBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return oz(a,e-1)},pl=nl.__acroform__.setBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return nz(a,e-1)},gl=nl.__acroform__.clearBitForPdf=function(a,e){if(isNaN(a)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sz(a,e-1)},az=nl.__acroform__.calculateCoordinates=function(a,e){var t=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,c=a[0],h=a[1],A=a[2],r=a[3],y={};return y.lowerLeft_X=t(c)||0,y.lowerLeft_Y=s(h+r)||0,y.upperRight_X=t(c+A)||0,y.upperRight_Y=s(h)||0,[Number(_s(y.lowerLeft_X)),Number(_s(y.lowerLeft_Y)),Number(_s(y.upperRight_X)),Number(_s(y.upperRight_Y))]},lz=function(a){if(a.appearanceStreamContent)return a.appearanceStreamContent;if(a.V||a.DV){var e=[],t=a._V||a.DV,s=_1(a,t),c=a.scope.internal.getFont(a.fontName,a.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(a.scope.__private__.encodeColorString(a.color)),e.push("/"+c+" "+_s(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var h=NA(a);return h.scope=a.scope,h.stream=e.join(`
`),h}},_1=function(a,e){var t=a.fontSize===0?a.maxFontSize:a.fontSize,s={text:"",fontSize:""},c=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");c=a.multiline?c.map(function(oe){return oe.split(`
`)}):c.map(function(oe){return[oe]});var h=t,A=mn.internal.getHeight(a)||0;A=A<0?-A:A;var r=mn.internal.getWidth(a)||0;r=r<0?-r:r;var y=function(oe,me,Le){if(oe+1<c.length){var Se=me+" "+c[oe+1][0];return g0(Se,a,Le).width<=r-4}return!1};h++;e:for(;h>0;){e="",h--;var b,_,B=g0("3",a,h).height,I=a.multiline?A-h:(A-B)/2,E=I+=2,R=0,M=0,G=0;if(h<=0){e=`(...) Tj
`,e+="% Width of Text: "+g0(e,a,h=12).width+", FieldWidth:"+r+`
`;break}for(var U="",Q=0,q=0;q<c.length;q++)if(c.hasOwnProperty(q)){var ne=!1;if(c[q].length!==1&&G!==c[q].length-1){if((B+2)*(Q+2)+2>A)continue e;U+=c[q][G],ne=!0,M=q,q--}else{U=(U+=c[q][G]+" ").substr(U.length-1)==" "?U.substr(0,U.length-1):U;var re=parseInt(q),pe=y(re,U,h),Ae=q>=c.length-1;if(pe&&!Ae){U+=" ",G=0;continue}if(pe||Ae){if(Ae)M=re;else if(a.multiline&&(B+2)*(Q+2)+2>A)continue e}else{if(!a.multiline||(B+2)*(Q+2)+2>A)continue e;M=re}}for(var le="",be=R;be<=M;be++){var we=c[be];if(a.multiline){if(be===M){le+=we[G]+" ",G=(G+1)%we.length;continue}if(be===R){le+=we[we.length-1]+" ";continue}}le+=we[0]+" "}switch(le=le.substr(le.length-1)==" "?le.substr(0,le.length-1):le,_=g0(le,a,h).width,a.textAlign){case"right":b=r-_-2;break;case"center":b=(r-_)/2;break;case"left":default:b=2}e+=_s(b)+" "+_s(E)+` Td
`,e+="("+Tg(le)+`) Tj
`,e+=-_s(b)+` 0 Td
`,E=-(h+2),_=0,R=ne?M:M+1,Q++,U=""}break}return s.text=e,s.fontSize=h,s},g0=function(a,e,t){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),c=e.scope.getStringUnitWidth(a,{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:c}},cz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},uz=function(a,e){var t={type:"reference",object:a};e.internal.getPageInfo(a.page).pageContext.annotations.find(function(s){return s.type===t.type&&s.object===t.object})===void 0&&e.internal.getPageInfo(a.page).pageContext.annotations.push(t)},hz=function(a,e){for(var t in a)if(a.hasOwnProperty(t)){var s=t,c=a[t];e.internal.newObjectDeferredBegin(c.objId,!0),Wo(c)==="object"&&typeof c.putStream=="function"&&c.putStream(),delete a[s]}},dz=function(a,e){if(e.scope=a,a.internal!==void 0&&(a.internal.acroformPlugin===void 0||a.internal.acroformPlugin.isInitialized===!1)){if(Jd.FieldNum=0,a.internal.acroformPlugin=JSON.parse(JSON.stringify(cz)),a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");pw=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new WT,a.internal.acroformPlugin.acroFormDictionaryRoot.scope=a,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(a)}),a.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var c in s)if(s.hasOwnProperty(c)){var h=s[c];h.objId=void 0,h.hasAnnotation&&uz(h,t)}})(a)}),a.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(a)}),a.internal.events.subscribe("postPutPages",function(t){(function(s,c){var h=!s;for(var A in s||(c.internal.newObjectDeferredBegin(c.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),c.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||c.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(A)){var r=s[A],y=[],b=r.Rect;if(r.Rect&&(r.Rect=az(r.Rect,c)),c.internal.newObjectDeferredBegin(r.objId,!0),r.DA=mn.createDefaultAppearanceStream(r),Wo(r)==="object"&&typeof r.getKeyValueListForStream=="function"&&(y=r.getKeyValueListForStream()),r.Rect=b,r.hasAppearanceStream&&!r.appearanceStreamContent){var _=lz(r);y.push({key:"AP",value:"<</N "+_+">>"}),c.internal.acroformPlugin.xForms.push(_)}if(r.appearanceStreamContent){var B="";for(var I in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(I)){var E=r.appearanceStreamContent[I];if(B+="/"+I+" ",B+="<<",Object.keys(E).length>=1||Array.isArray(E)){for(var A in E)if(E.hasOwnProperty(A)){var R=E[A];typeof R=="function"&&(R=R.call(c,r)),B+="/"+A+" "+R+" ",c.internal.acroformPlugin.xForms.indexOf(R)>=0||c.internal.acroformPlugin.xForms.push(R)}}else typeof(R=E)=="function"&&(R=R.call(c,r)),B+="/"+A+" "+R,c.internal.acroformPlugin.xForms.indexOf(R)>=0||c.internal.acroformPlugin.xForms.push(R);B+=">>"}y.push({key:"AP",value:`<<
`+B+">>"})}c.internal.putStream({additionalKeyValues:y,objectId:r.objId}),c.internal.out("endobj")}h&&hz(c.internal.acroformPlugin.xForms,c)})(t,a)}),a.internal.acroformPlugin.isInitialized=!0}},VT=nl.__acroform__.arrayToPdfArray=function(a,e,t){var s=function(A){return A};if(Array.isArray(a)){for(var c="[",h=0;h<a.length;h++)switch(h!==0&&(c+=" "),Wo(a[h])){case"boolean":case"number":case"object":c+=a[h].toString();break;case"string":a[h].substr(0,1)!=="/"?(e!==void 0&&t&&(s=t.internal.getEncryptor(e)),c+="("+Tg(s(a[h].toString()))+")"):c+=a[h].toString()}return c+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Sb=function(a,e,t){var s=function(c){return c};return e!==void 0&&t&&(s=t.internal.getEncryptor(e)),(a=a||"").toString(),a="("+Tg(s(a))+")"},VA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(a){this._objId=a}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};VA.prototype.toString=function(){return this.objId+" 0 R"},VA.prototype.putStream=function(){var a=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:a,objectId:this.objId}),this.scope.internal.out("endobj")},VA.prototype.getKeyValueListForStream=function(){var a=[],e=Object.getOwnPropertyNames(this).filter(function(h){return h!="content"&&h!="appearanceStreamContent"&&h!="scope"&&h!="objId"&&h.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var s=e[t],c=this[s];c&&(Array.isArray(c)?a.push({key:s,value:VT(c,this.objId,this.scope)}):c instanceof VA?(c.scope=this.scope,a.push({key:s,value:c.objId+" 0 R"})):typeof c!="function"&&a.push({key:s,value:c}))}return a};var GT=function(){VA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var a,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){a=t.trim()},get:function(){return a||null}})};lh(GT,VA);var WT=function(){VA.call(this);var a,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(a){var t=function(s){return s};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Tg(t(a))+")"}},set:function(t){a=t}})};lh(WT,VA);var Jd=function a(){VA.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute F supplied.');e=U}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fl(e,3)},set:function(U){U?this.F=pl(e,3):this.F=gl(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(U){if(isNaN(U))throw new Error('Invalid value "'+U+'" for attribute Ff supplied.');t=U}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(U){s=U!==void 0?U:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(U){s[0]=U}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(U){s[1]=U}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(U){s[2]=U}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(U){s[3]=U}});var c="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return c},set:function(U){switch(U){case"/Btn":case"/Tx":case"/Ch":case"/Sig":c=U;break;default:throw new Error('Invalid value "'+U+'" for attribute FT supplied.')}}});var h=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!h||h.length<1){if(this instanceof q0)return;h="FieldObject"+a.FieldNum++}var U=function(Q){return Q};return this.scope&&(U=this.scope.internal.getEncryptor(this.objId)),"("+Tg(U(h))+")"},set:function(U){h=U.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return h},set:function(U){h=U}});var A="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return A},set:function(U){A=U}});var r="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return r},set:function(U){r=U}});var y=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return y},set:function(U){y=U}});var b=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return b===void 0?50/pw:b},set:function(U){b=U}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(U){_=U}});var B="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!B||this instanceof q0||this instanceof Sp))return Sb(B,this.objId,this.scope)},set:function(U){U=U.toString(),B=U}});var I=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(I)return this instanceof $l?I:Sb(I,this.objId,this.scope)},set:function(U){U=U.toString(),I=this instanceof $l?U:U.substr(0,1)==="("?Zg(U.substr(1,U.length-2)):Zg(U)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof $l?Zg(I.substr(1,I.length-1)):I},set:function(U){U=U.toString(),I=this instanceof $l?"/"+U:U}});var E=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(E)return E},set:function(U){this.V=U}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof $l?E:Sb(E,this.objId,this.scope)},set:function(U){U=U.toString(),E=this instanceof $l?U:U.substr(0,1)==="("?Zg(U.substr(1,U.length-2)):Zg(U)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof $l?Zg(E.substr(1,E.length-1)):E},set:function(U){U=U.toString(),E=this instanceof $l?"/"+U:U}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var R,M=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return M},set:function(U){U=!!U,M=U}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(R)return R},set:function(U){R=U}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,1)},set:function(U){U?this.Ff=pl(this.Ff,1):this.Ff=gl(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,2)},set:function(U){U?this.Ff=pl(this.Ff,2):this.Ff=gl(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,3)},set:function(U){U?this.Ff=pl(this.Ff,3):this.Ff=gl(this.Ff,3)}});var G=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(G!==null)return G},set:function(U){if([0,1,2].indexOf(U)===-1)throw new Error('Invalid value "'+U+'" for attribute Q supplied.');G=U}}),Object.defineProperty(this,"textAlign",{get:function(){var U;switch(G){case 0:default:U="left";break;case 1:U="center";break;case 2:U="right"}return U},configurable:!0,enumerable:!0,set:function(U){switch(U){case"right":case 2:G=2;break;case"center":case 1:G=1;break;case"left":case 0:default:G=0}}})};lh(Jd,VA);var mg=function(){Jd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var a=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return a},set:function(t){a=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return a},set:function(t){a=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VT(e,this.objId,this.scope)},set:function(t){var s,c;c=[],typeof(s=t)=="string"&&(c=function(h,A,r){r||(r=1);for(var y,b=[];y=A.exec(h);)b.push(y[r]);return b}(s,/\((.*?)\)/g)),e=c}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,s){for(s=s||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,18)},set:function(t){t?this.Ff=pl(this.Ff,18):this.Ff=gl(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=pl(this.Ff,19):this.Ff=gl(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,20)},set:function(t){t?(this.Ff=pl(this.Ff,20),e.sort()):this.Ff=gl(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,22)},set:function(t){t?this.Ff=pl(this.Ff,22):this.Ff=gl(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,23)},set:function(t){t?this.Ff=pl(this.Ff,23):this.Ff=gl(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,27)},set:function(t){t?this.Ff=pl(this.Ff,27):this.Ff=gl(this.Ff,27)}}),this.hasAppearanceStream=!1};lh(mg,Jd);var yg=function(){mg.call(this),this.fontName="helvetica",this.combo=!1};lh(yg,mg);var vg=function(){yg.call(this),this.combo=!0};lh(vg,yg);var Py=function(){vg.call(this),this.edit=!0};lh(Py,vg);var $l=function(){Jd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,15)},set:function(t){t?this.Ff=pl(this.Ff,15):this.Ff=gl(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,16)},set:function(t){t?this.Ff=pl(this.Ff,16):this.Ff=gl(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,17)},set:function(t){t?this.Ff=pl(this.Ff,17):this.Ff=gl(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,26)},set:function(t){t?this.Ff=pl(this.Ff,26):this.Ff=gl(this.Ff,26)}});var a,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(h){return h};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,c=[];for(s in c.push("<<"),e)c.push("/"+s+" ("+Tg(t(e[s]))+")");return c.push(">>"),c.join(`
`)}},set:function(t){Wo(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(t){a=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(t){a="/"+t}})};lh($l,Jd);var ky=function(){$l.call(this),this.pushButton=!0};lh(ky,$l);var _g=function(){$l.call(this),this.radio=!0,this.pushButton=!1;var a=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){a=e!==void 0?e:[]}})};lh(_g,$l);var q0=function(){var a,e;Jd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return a},set:function(c){a=c}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(c){e=c}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var c=function(r){return r};this.scope&&(c=this.scope.internal.getEncryptor(this.objId));var h,A=[];for(h in A.push("<<"),s)A.push("/"+h+" ("+Tg(c(s[h]))+")");return A.push(">>"),A.join(`
`)},set:function(c){Wo(c)==="object"&&(s=c)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(c){typeof c=="string"&&(s.CA=c)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(c){t=c}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(c){t="/"+c}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=mn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};lh(q0,Jd),_g.prototype.setAppearance=function(a){if(!("createAppearanceStream"in a)||!("getCA"in a))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=a.createAppearanceStream(t.optionName),t.caption=a.getCA()}},_g.prototype.createOption=function(a){var e=new q0;return e.Parent=this,e.optionName=a,this.Kids.push(e),Az.call(this.scope,e),e};var Ry=function(){$l.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=mn.CheckBox.createAppearanceStream()};lh(Ry,$l);var Sp=function(){Jd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,13)},set:function(e){e?this.Ff=pl(this.Ff,13):this.Ff=gl(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,21)},set:function(e){e?this.Ff=pl(this.Ff,21):this.Ff=gl(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,23)},set:function(e){e?this.Ff=pl(this.Ff,23):this.Ff=gl(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,24)},set:function(e){e?this.Ff=pl(this.Ff,24):this.Ff=gl(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,25)},set:function(e){e?this.Ff=pl(this.Ff,25):this.Ff=gl(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,26)},set:function(e){e?this.Ff=pl(this.Ff,26):this.Ff=gl(this.Ff,26)}});var a=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){Number.isInteger(e)&&(a=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};lh(Sp,Jd);var Dy=function(){Sp.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fl(this.Ff,14)},set:function(a){a?this.Ff=pl(this.Ff,14):this.Ff=gl(this.Ff,14)}}),this.password=!0};lh(Dy,Sp);var mn={CheckBox:{createAppearanceStream:function(){return{N:{On:mn.CheckBox.YesNormal},D:{On:mn.CheckBox.YesPushDown,Off:mn.CheckBox.OffPushDown}}},YesPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=[],s=a.scope.internal.getFont(a.fontName,a.fontStyle).id,c=a.scope.__private__.encodeColorString(a.color),h=_1(a,a.caption);return t.push("0.749023 g"),t.push("0 0 "+_s(mn.internal.getWidth(a))+" "+_s(mn.internal.getHeight(a))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+s+" "+_s(h.fontSize)+" Tf "+c),t.push("BT"),t.push(h.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(a){var e=NA(a);e.scope=a.scope;var t=a.scope.internal.getFont(a.fontName,a.fontStyle).id,s=a.scope.__private__.encodeColorString(a.color),c=[],h=mn.internal.getHeight(a),A=mn.internal.getWidth(a),r=_1(a,a.caption);return c.push("1 g"),c.push("0 0 "+_s(A)+" "+_s(h)+" re"),c.push("f"),c.push("q"),c.push("0 0 1 rg"),c.push("0 0 "+_s(A-1)+" "+_s(h-1)+" re"),c.push("W"),c.push("n"),c.push("0 g"),c.push("BT"),c.push("/"+t+" "+_s(r.fontSize)+" Tf "+s),c.push(r.text),c.push("ET"),c.push("Q"),e.stream=c.join(`
`),e},OffPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_s(mn.internal.getWidth(a))+" "+_s(mn.internal.getHeight(a))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(a){var e={D:{Off:mn.RadioButton.Circle.OffPushDown},N:{}};return e.N[a]=mn.RadioButton.Circle.YesNormal,e.D[a]=mn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(a){var e=NA(a);e.scope=a.scope;var t=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=mn.internal.Bezier_C,h=Number((s*c).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+fp(mn.internal.getWidth(a)/2)+" "+fp(mn.internal.getHeight(a)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+h+" "+h+" "+s+" 0 "+s+" c"),t.push("-"+h+" "+s+" -"+s+" "+h+" -"+s+" 0 c"),t.push("-"+s+" -"+h+" -"+h+" -"+s+" 0 -"+s+" c"),t.push(h+" -"+s+" "+s+" -"+h+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),h=Number((c*mn.internal.Bezier_C).toFixed(5)),A=Number((s*mn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+fp(mn.internal.getWidth(a)/2)+" "+fp(mn.internal.getHeight(a)/2)+" cm"),t.push(c+" 0 m"),t.push(c+" "+h+" "+h+" "+c+" 0 "+c+" c"),t.push("-"+h+" "+c+" -"+c+" "+h+" -"+c+" 0 c"),t.push("-"+c+" -"+h+" -"+h+" -"+c+" 0 -"+c+" c"),t.push(h+" -"+c+" "+c+" -"+h+" "+c+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+fp(mn.internal.getWidth(a)/2)+" "+fp(mn.internal.getHeight(a)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+A+" "+A+" "+s+" 0 "+s+" c"),t.push("-"+A+" "+s+" -"+s+" "+A+" -"+s+" 0 c"),t.push("-"+s+" -"+A+" -"+A+" -"+s+" 0 -"+s+" c"),t.push(A+" -"+s+" "+s+" -"+A+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=[],s=mn.internal.getWidth(a)<=mn.internal.getHeight(a)?mn.internal.getWidth(a)/4:mn.internal.getHeight(a)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),h=Number((c*mn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+fp(mn.internal.getWidth(a)/2)+" "+fp(mn.internal.getHeight(a)/2)+" cm"),t.push(c+" 0 m"),t.push(c+" "+h+" "+h+" "+c+" 0 "+c+" c"),t.push("-"+h+" "+c+" -"+c+" "+h+" -"+c+" 0 c"),t.push("-"+c+" -"+h+" -"+h+" -"+c+" 0 -"+c+" c"),t.push(h+" -"+c+" "+c+" -"+h+" "+c+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(a){var e={D:{Off:mn.RadioButton.Cross.OffPushDown},N:{}};return e.N[a]=mn.RadioButton.Cross.YesNormal,e.D[a]=mn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(a){var e=NA(a);e.scope=a.scope;var t=[],s=mn.internal.calculateCross(a);return t.push("q"),t.push("1 1 "+_s(mn.internal.getWidth(a)-2)+" "+_s(mn.internal.getHeight(a)-2)+" re"),t.push("W"),t.push("n"),t.push(_s(s.x1.x)+" "+_s(s.x1.y)+" m"),t.push(_s(s.x2.x)+" "+_s(s.x2.y)+" l"),t.push(_s(s.x4.x)+" "+_s(s.x4.y)+" m"),t.push(_s(s.x3.x)+" "+_s(s.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=mn.internal.calculateCross(a),s=[];return s.push("0.749023 g"),s.push("0 0 "+_s(mn.internal.getWidth(a))+" "+_s(mn.internal.getHeight(a))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+_s(mn.internal.getWidth(a)-2)+" "+_s(mn.internal.getHeight(a)-2)+" re"),s.push("W"),s.push("n"),s.push(_s(t.x1.x)+" "+_s(t.x1.y)+" m"),s.push(_s(t.x2.x)+" "+_s(t.x2.y)+" l"),s.push(_s(t.x4.x)+" "+_s(t.x4.y)+" m"),s.push(_s(t.x3.x)+" "+_s(t.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(a){var e=NA(a);e.scope=a.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_s(mn.internal.getWidth(a))+" "+_s(mn.internal.getHeight(a))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(a){var e=a.scope.internal.getFont(a.fontName,a.fontStyle).id,t=a.scope.__private__.encodeColorString(a.color);return"/"+e+" "+a.fontSize+" Tf "+t}};mn.internal={Bezier_C:.551915024494,calculateCross:function(a){var e=mn.internal.getWidth(a),t=mn.internal.getHeight(a),s=Math.min(e,t);return{x1:{x:(e-s)/2,y:(t-s)/2+s},x2:{x:(e-s)/2+s,y:(t-s)/2},x3:{x:(e-s)/2,y:(t-s)/2},x4:{x:(e-s)/2+s,y:(t-s)/2+s}}}},mn.internal.getWidth=function(a){var e=0;return Wo(a)==="object"&&(e=kE(a.Rect[2])),e},mn.internal.getHeight=function(a){var e=0;return Wo(a)==="object"&&(e=kE(a.Rect[3])),e};var Az=nl.addField=function(a){if(dz(this,a),!(a instanceof Jd))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=a).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),a.page=a.scope.internal.getCurrentPageInfo().pageNumber,this};nl.AcroFormChoiceField=mg,nl.AcroFormListBox=yg,nl.AcroFormComboBox=vg,nl.AcroFormEditBox=Py,nl.AcroFormButton=$l,nl.AcroFormPushButton=ky,nl.AcroFormRadioButton=_g,nl.AcroFormCheckBox=Ry,nl.AcroFormTextField=Sp,nl.AcroFormPasswordField=Dy,nl.AcroFormAppearance=mn,nl.AcroForm={ChoiceField:mg,ListBox:yg,ComboBox:vg,EditBox:Py,Button:$l,PushButton:ky,RadioButton:_g,CheckBox:Ry,TextField:Sp,PasswordField:Dy,Appearance:mn},Yn.AcroForm={ChoiceField:mg,ListBox:yg,ComboBox:vg,EditBox:Py,Button:$l,PushButton:ky,RadioButton:_g,CheckBox:Ry,TextField:Sp,PasswordField:Dy,Appearance:mn};var fz=Yn.AcroForm;function XT(a){return a.reduce(function(e,t,s){return e[t]=s,e},{})}(function(a){a.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=a.__addimage__.getImageFileTypeByImageData=function(oe,me){var Le,Se,Me,Re,Ze,$e=e;if((me=me||e)==="RGBA"||oe.data!==void 0&&oe.data instanceof Uint8ClampedArray&&"height"in oe&&"width"in oe)return"RGBA";if(pe(oe))for(Ze in t)for(Me=t[Ze],Le=0;Le<Me.length;Le+=1){for(Re=!0,Se=0;Se<Me[Le].length;Se+=1)if(Me[Le][Se]!==void 0&&Me[Le][Se]!==oe[Se]){Re=!1;break}if(Re===!0){$e=Ze;break}}else for(Ze in t)for(Me=t[Ze],Le=0;Le<Me.length;Le+=1){for(Re=!0,Se=0;Se<Me[Le].length;Se+=1)if(Me[Le][Se]!==void 0&&Me[Le][Se]!==oe.charCodeAt(Se)){Re=!1;break}if(Re===!0){$e=Ze;break}}return $e===e&&me!==e&&($e=me),$e},c=function oe(me){for(var Le=this.internal.write,Se=this.internal.putStream,Me=(0,this.internal.getFilters)();Me.indexOf("FlateEncode")!==-1;)Me.splice(Me.indexOf("FlateEncode"),1);me.objectId=this.internal.newObject();var Re=[];if(Re.push({key:"Type",value:"/XObject"}),Re.push({key:"Subtype",value:"/Image"}),Re.push({key:"Width",value:me.width}),Re.push({key:"Height",value:me.height}),me.colorSpace===G.INDEXED?Re.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(me.palette.length/3-1)+" "+("sMask"in me&&me.sMask!==void 0?me.objectId+2:me.objectId+1)+" 0 R]"}):(Re.push({key:"ColorSpace",value:"/"+me.colorSpace}),me.colorSpace===G.DEVICE_CMYK&&Re.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Re.push({key:"BitsPerComponent",value:me.bitsPerComponent}),"decodeParameters"in me&&me.decodeParameters!==void 0&&Re.push({key:"DecodeParms",value:"<<"+me.decodeParameters+">>"}),"transparency"in me&&Array.isArray(me.transparency)){for(var Ze="",$e=0,ct=me.transparency.length;$e<ct;$e++)Ze+=me.transparency[$e]+" "+me.transparency[$e]+" ";Re.push({key:"Mask",value:"["+Ze+"]"})}me.sMask!==void 0&&Re.push({key:"SMask",value:me.objectId+1+" 0 R"});var Qe=me.filter!==void 0?["/"+me.filter]:void 0;if(Se({data:me.data,additionalKeyValues:Re,alreadyAppliedFilters:Qe,objectId:me.objectId}),Le("endobj"),"sMask"in me&&me.sMask!==void 0){var It="/Predictor "+me.predictor+" /Colors 1 /BitsPerComponent "+me.bitsPerComponent+" /Columns "+me.width,Ce={width:me.width,height:me.height,colorSpace:"DeviceGray",bitsPerComponent:me.bitsPerComponent,decodeParameters:It,data:me.sMask};"filter"in me&&(Ce.filter=me.filter),oe.call(this,Ce)}if(me.colorSpace===G.INDEXED){var Je=this.internal.newObject();Se({data:le(new Uint8Array(me.palette)),objectId:Je}),Le("endobj")}},h=function(){var oe=this.internal.collections.addImage_images;for(var me in oe)c.call(this,oe[me])},A=function(){var oe,me=this.internal.collections.addImage_images,Le=this.internal.write;for(var Se in me)Le("/I"+(oe=me[Se]).index,oe.objectId,"0","R")},r=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",h),this.internal.events.subscribe("putXobjectDict",A))},y=function(){var oe=this.internal.collections.addImage_images;return r.call(this),oe},b=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(oe){return typeof a["process"+oe.toUpperCase()]=="function"},B=function(oe){return Wo(oe)==="object"&&oe.nodeType===1},I=function(oe,me){if(oe.nodeName==="IMG"&&oe.hasAttribute("src")){var Le=""+oe.getAttribute("src");if(Le.indexOf("data:image/")===0)return My(unescape(Le).split("base64,").pop());var Se=a.loadFile(Le,!0);if(Se!==void 0)return Se}if(oe.nodeName==="CANVAS"){if(oe.width===0||oe.height===0)throw new Error("Given canvas must have data. Canvas width: "+oe.width+", height: "+oe.height);var Me;switch(me){case"PNG":Me="image/png";break;case"WEBP":Me="image/webp";break;case"JPEG":case"JPG":default:Me="image/jpeg"}return My(oe.toDataURL(Me,1).split("base64,").pop())}},E=function(oe){var me=this.internal.collections.addImage_images;if(me){for(var Le in me)if(oe===me[Le].alias)return me[Le]}},R=function(oe,me,Le){return oe||me||(oe=-96,me=-96),oe<0&&(oe=-1*Le.width*72/oe/this.internal.scaleFactor),me<0&&(me=-1*Le.height*72/me/this.internal.scaleFactor),oe===0&&(oe=me*Le.width/Le.height),me===0&&(me=oe*Le.height/Le.width),[oe,me]},M=function(oe,me,Le,Se,Me,Re){var Ze=R.call(this,Le,Se,Me),$e=this.internal.getCoordinateString,ct=this.internal.getVerticalCoordinateString,Qe=y.call(this);if(Le=Ze[0],Se=Ze[1],Qe[Me.index]=Me,Re){Re*=Math.PI/180;var It=Math.cos(Re),Ce=Math.sin(Re),Je=function(mt){return mt.toFixed(4)},lt=[Je(It),Je(Ce),Je(-1*Ce),Je(It),0,0,"cm"]}this.internal.write("q"),Re?(this.internal.write([1,"0","0",1,$e(oe),ct(me+Se),"cm"].join(" ")),this.internal.write(lt.join(" ")),this.internal.write([$e(Le),"0","0",$e(Se),"0","0","cm"].join(" "))):this.internal.write([$e(Le),"0","0",$e(Se),$e(oe),ct(me+Se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Me.index+" Do"),this.internal.write("Q")},G=a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var U=a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Q=a.__addimage__.sHashCode=function(oe){var me,Le,Se=0;if(typeof oe=="string")for(Le=oe.length,me=0;me<Le;me++)Se=(Se<<5)-Se+oe.charCodeAt(me),Se|=0;else if(pe(oe))for(Le=oe.byteLength/2,me=0;me<Le;me++)Se=(Se<<5)-Se+oe[me],Se|=0;return Se},q=a.__addimage__.validateStringAsBase64=function(oe){(oe=oe||"").toString().trim();var me=!0;return oe.length===0&&(me=!1),oe.length%4!=0&&(me=!1),/^[A-Za-z0-9+/]+$/.test(oe.substr(0,oe.length-2))===!1&&(me=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(oe.substr(-2))===!1&&(me=!1),me},ne=a.__addimage__.extractImageFromDataUrl=function(oe){if(oe==null||!(oe=oe.trim()).startsWith("data:"))return null;var me=oe.indexOf(",");return me<0?null:oe.substring(0,me).trim().endsWith("base64")?oe.substring(me+1):null},re=a.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};a.__addimage__.isArrayBuffer=function(oe){return re()&&oe instanceof ArrayBuffer};var pe=a.__addimage__.isArrayBufferView=function(oe){return re()&&typeof Uint32Array<"u"&&(oe instanceof Int8Array||oe instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&oe instanceof Uint8ClampedArray||oe instanceof Int16Array||oe instanceof Uint16Array||oe instanceof Int32Array||oe instanceof Uint32Array||oe instanceof Float32Array||oe instanceof Float64Array)},Ae=a.__addimage__.binaryStringToUint8Array=function(oe){for(var me=oe.length,Le=new Uint8Array(me),Se=0;Se<me;Se++)Le[Se]=oe.charCodeAt(Se);return Le},le=a.__addimage__.arrayBufferToBinaryString=function(oe){for(var me="",Le=pe(oe)?oe:new Uint8Array(oe),Se=0;Se<Le.length;Se+=8192)me+=String.fromCharCode.apply(null,Le.subarray(Se,Se+8192));return me};a.addImage=function(){var oe,me,Le,Se,Me,Re,Ze,$e,ct;if(typeof arguments[1]=="number"?(me=e,Le=arguments[1],Se=arguments[2],Me=arguments[3],Re=arguments[4],Ze=arguments[5],$e=arguments[6],ct=arguments[7]):(me=arguments[1],Le=arguments[2],Se=arguments[3],Me=arguments[4],Re=arguments[5],Ze=arguments[6],$e=arguments[7],ct=arguments[8]),Wo(oe=arguments[0])==="object"&&!B(oe)&&"imageData"in oe){var Qe=oe;oe=Qe.imageData,me=Qe.format||me||e,Le=Qe.x||Le||0,Se=Qe.y||Se||0,Me=Qe.w||Qe.width||Me,Re=Qe.h||Qe.height||Re,Ze=Qe.alias||Ze,$e=Qe.compression||$e,ct=Qe.rotation||Qe.angle||ct}var It=this.internal.getFilters();if($e===void 0&&It.indexOf("FlateEncode")!==-1&&($e="SLOW"),isNaN(Le)||isNaN(Se))throw new Error("Invalid coordinates passed to jsPDF.addImage");r.call(this);var Ce=be.call(this,oe,me,Ze,$e);return M.call(this,Le,Se,Me,Re,Ce,ct),this};var be=function(oe,me,Le,Se){var Me,Re,Ze;if(typeof oe=="string"&&s(oe)===e){oe=unescape(oe);var $e=we(oe,!1);($e!==""||($e=a.loadFile(oe,!0))!==void 0)&&(oe=$e)}if(B(oe)&&(oe=I(oe,me)),me=s(oe,me),!_(me))throw new Error("addImage does not support files of type '"+me+"', please ensure that a plugin for '"+me+"' support is added.");if(((Ze=Le)==null||Ze.length===0)&&(Le=function(ct){return typeof ct=="string"||pe(ct)?Q(ct):pe(ct.data)?Q(ct.data):null}(oe)),(Me=E.call(this,Le))||(re()&&(oe instanceof Uint8Array||me==="RGBA"||(Re=oe,oe=Ae(oe))),Me=this["process"+me.toUpperCase()](oe,b.call(this),Le,function(ct){return ct&&typeof ct=="string"&&(ct=ct.toUpperCase()),ct in a.image_compression?ct:U.NONE}(Se),Re)),!Me)throw new Error("An unknown error occurred whilst processing the image.");return Me},we=a.__addimage__.convertBase64ToBinaryString=function(oe,me){me=typeof me!="boolean"||me;var Le,Se="";if(typeof oe=="string"){var Me;Le=(Me=ne(oe))!==null&&Me!==void 0?Me:oe;try{Se=My(Le)}catch(Re){if(me)throw q(Le)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Re.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Se};a.getImageProperties=function(oe){var me,Le,Se="";if(B(oe)&&(oe=I(oe)),typeof oe=="string"&&s(oe)===e&&((Se=we(oe,!1))===""&&(Se=a.loadFile(oe)||""),oe=Se),Le=s(oe),!_(Le))throw new Error("addImage does not support files of type '"+Le+"', please ensure that a plugin for '"+Le+"' support is added.");if(!re()||oe instanceof Uint8Array||(oe=Ae(oe)),!(me=this["process"+Le.toUpperCase()](oe)))throw new Error("An unknown error occurred whilst processing the image");return me.fileType=Le,me}})(Yn.API),function(a){var e=function(t){if(t!==void 0&&t!="")return!0};Yn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),a.events.push(["putPage",function(t){for(var s,c,h,A=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,y=this.internal.getPageInfoByObjId(t.objId),b=t.pageContext.annotations,_=!1,B=0;B<b.length&&!_;B++)switch((s=b[B]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var I=0;I<b.length;I++){s=b[I];var E=this.internal.pdfEscape,R=this.internal.getEncryptor(t.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var M=this.internal.newAdditionalObject(),G=this.internal.newAdditionalObject(),U=this.internal.getEncryptor(M.objId),Q=s.title||"Note";h="<</Type /Annot /Subtype /Text "+(c="/Rect ["+A(s.bounds.x)+" "+r(s.bounds.y+s.bounds.h)+" "+A(s.bounds.x+s.bounds.w)+" "+r(s.bounds.y)+"] ")+"/Contents ("+E(U(s.contents))+")",h+=" /Popup "+G.objId+" 0 R",h+=" /P "+y.objId+" 0 R",h+=" /T ("+E(U(Q))+") >>",M.content=h;var q=M.objId+" 0 R";h="<</Type /Annot /Subtype /Popup "+(c="/Rect ["+A(s.bounds.x+30)+" "+r(s.bounds.y+s.bounds.h)+" "+A(s.bounds.x+s.bounds.w+30)+" "+r(s.bounds.y)+"] ")+" /Parent "+q,s.open&&(h+=" /Open true"),h+=" >>",G.content=h,this.internal.write(M.objId,"0 R",G.objId,"0 R");break;case"freetext":c="/Rect ["+A(s.bounds.x)+" "+r(s.bounds.y)+" "+A(s.bounds.x+s.bounds.w)+" "+r(s.bounds.y+s.bounds.h)+"] ";var ne=s.color||"#000000";h="<</Type /Annot /Subtype /FreeText "+c+"/Contents ("+E(R(s.contents))+")",h+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+ne+")",h+=" /Border [0 0 0]",h+=" >>",this.internal.write(h);break;case"link":if(s.options.name){var re=this.annotations._nameMap[s.options.name];s.options.pageNumber=re.page,s.options.top=re.y}else s.options.top||(s.options.top=0);if(c="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",h="",s.options.url)h="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /A <</S /URI /URI ("+E(R(s.options.url))+") >>";else if(s.options.pageNumber)switch(h="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":h+=" /Fit]";break;case"FitH":h+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,h+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var pe=r(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),h+=" /XYZ "+s.options.left+" "+pe+" "+s.options.zoom+"]"}h!=""&&(h+=" >>",this.internal.write(h))}}this.internal.write("]")}}]),a.createAnnotation=function(t){var s=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":s.pageContext.annotations.push(t)}},a.link=function(t,s,c,h,A){var r=this.internal.getCurrentPageInfo(),y=this.internal.getCoordinateString,b=this.internal.getVerticalCoordinateString;r.pageContext.annotations.push({finalBounds:{x:y(t),y:b(s),w:y(t+c),h:b(s+h)},options:A,type:"link"})},a.textWithLink=function(t,s,c,h){var A,r,y=this.getTextWidth(t),b=this.internal.getLineHeight()/this.internal.scaleFactor;if(h.maxWidth!==void 0){r=h.maxWidth;var _=this.splitTextToSize(t,r).length;A=Math.ceil(b*_)}else r=y,A=b;return this.text(t,s,c,h),c+=.2*b,h.align==="center"&&(s-=y/2),h.align==="right"&&(s-=y),this.link(s,c-b,r,A,h),y},a.getTextWidth=function(t){var s=this.internal.getFontSize();return this.getStringUnitWidth(t)*s/this.internal.scaleFactor}}(Yn.API),function(a){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},c=[1570,1571,1573,1575];a.__arabicParser__={};var h=a.__arabicParser__.isInArabicSubstitutionA=function(M){return e[M.charCodeAt(0)]!==void 0},A=a.__arabicParser__.isArabicLetter=function(M){return typeof M=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(M)},r=a.__arabicParser__.isArabicEndLetter=function(M){return A(M)&&h(M)&&e[M.charCodeAt(0)].length<=2},y=a.__arabicParser__.isArabicAlfLetter=function(M){return A(M)&&c.indexOf(M.charCodeAt(0))>=0};a.__arabicParser__.arabicLetterHasIsolatedForm=function(M){return A(M)&&h(M)&&e[M.charCodeAt(0)].length>=1};var b=a.__arabicParser__.arabicLetterHasFinalForm=function(M){return A(M)&&h(M)&&e[M.charCodeAt(0)].length>=2};a.__arabicParser__.arabicLetterHasInitialForm=function(M){return A(M)&&h(M)&&e[M.charCodeAt(0)].length>=3};var _=a.__arabicParser__.arabicLetterHasMedialForm=function(M){return A(M)&&h(M)&&e[M.charCodeAt(0)].length==4},B=a.__arabicParser__.resolveLigatures=function(M){var G=0,U=t,Q="",q=0;for(G=0;G<M.length;G+=1)U[M.charCodeAt(G)]!==void 0?(q++,typeof(U=U[M.charCodeAt(G)])=="number"&&(Q+=String.fromCharCode(U),U=t,q=0),G===M.length-1&&(U=t,Q+=M.charAt(G-(q-1)),G-=q-1,q=0)):(U=t,Q+=M.charAt(G-q),G-=q,q=0);return Q};a.__arabicParser__.isArabicDiacritic=function(M){return M!==void 0&&s[M.charCodeAt(0)]!==void 0};var I=a.__arabicParser__.getCorrectForm=function(M,G,U){return A(M)?h(M)===!1?-1:!b(M)||!A(G)&&!A(U)||!A(U)&&r(G)||r(M)&&!A(G)||r(M)&&y(G)||r(M)&&r(G)?0:_(M)&&A(G)&&!r(G)&&A(U)&&b(U)?3:r(M)||!A(U)?1:2:-1},E=function(M){var G=0,U=0,Q=0,q="",ne="",re="",pe=(M=M||"").split("\\s+"),Ae=[];for(G=0;G<pe.length;G+=1){for(Ae.push(""),U=0;U<pe[G].length;U+=1)q=pe[G][U],ne=pe[G][U-1],re=pe[G][U+1],A(q)?(Q=I(q,ne,re),Ae[G]+=Q!==-1?String.fromCharCode(e[q.charCodeAt(0)][Q]):q):Ae[G]+=q;Ae[G]=B(Ae[G])}return Ae.join(" ")},R=a.__arabicParser__.processArabic=a.processArabic=function(){var M,G=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,U=[];if(Array.isArray(G)){var Q=0;for(U=[],Q=0;Q<G.length;Q+=1)Array.isArray(G[Q])?U.push([E(G[Q][0]),G[Q][1],G[Q][2]]):U.push([E(G[Q])]);M=U}else M=E(G);return typeof arguments[0]=="string"?M:(arguments[0].text=M,arguments[0])};a.events.push(["preProcessText",R])}(Yn.API),Yn.API.autoPrint=function(a){var e;switch((a=a||{}).variant=a.variant||"non-conform",a.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(a){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(r){t=r}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(r){s=isNaN(r)||Number.isInteger(r)===!1||r<0?150:r,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var c=300;Object.defineProperty(this,"height",{get:function(){return c},set:function(r){c=isNaN(r)||Number.isInteger(r)===!1||r<0?300:r,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=c+1)}});var h=[];Object.defineProperty(this,"childNodes",{get:function(){return h},set:function(r){h=r}});var A={};Object.defineProperty(this,"style",{get:function(){return A},set:function(r){A=r}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,s){var c;if((t=t||"2d")!=="2d")return null;for(c in s)this.pdf.context2d.hasOwnProperty(c)&&(this.pdf.context2d[c]=s[c]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},a.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Yn.API),function(a){var e={left:0,top:0,bottom:0,right:0},t=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),c.call(this))},c=function(){this.internal.__cell__.lastCell=new h,this.internal.__cell__.pages=1},h=function(){var y=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return y},set:function(M){y=M}});var b=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return b},set:function(M){b=M}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(M){_=M}});var B=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return B},set:function(M){B=M}});var I=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return I},set:function(M){I=M}});var E=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return E},set:function(M){E=M}});var R=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return R},set:function(M){R=M}}),this};h.prototype.clone=function(){return new h(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},h.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},a.setHeaderFunction=function(y){return s.call(this),this.internal.__cell__.headerFunction=typeof y=="function"?y:void 0,this},a.getTextDimensions=function(y,b){s.call(this);var _=(b=b||{}).fontSize||this.getFontSize(),B=b.font||this.getFont(),I=b.scaleFactor||this.internal.scaleFactor,E=0,R=0,M=0,G=this;if(!Array.isArray(y)&&typeof y!="string"){if(typeof y!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");y=String(y)}var U=b.maxWidth;U>0?typeof y=="string"?y=this.splitTextToSize(y,U):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(q,ne){return q.concat(G.splitTextToSize(ne,U))},[])):y=Array.isArray(y)?y:[y];for(var Q=0;Q<y.length;Q++)E<(M=this.getStringUnitWidth(y[Q],{font:B})*_)&&(E=M);return E!==0&&(R=y.length),{w:E/=I,h:Math.max((R*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/I,0)}},a.cellAddPage=function(){s.call(this),this.addPage();var y=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new h(y.left,y.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var A=a.cell=function(){var y;y=arguments[0]instanceof h?arguments[0]:new h(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var b=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,B=this.internal.__cell__.margins||e,I=this.internal.__cell__.tableHeaderRow,E=this.internal.__cell__.printHeaders;return b.lineNumber!==void 0&&(b.lineNumber===y.lineNumber?(y.x=(b.x||0)+(b.width||0),y.y=b.y||0):b.y+b.height+y.height+B.bottom>this.getPageHeight()?(this.cellAddPage(),y.y=B.top,E&&I&&(this.printHeaderRow(y.lineNumber,!0),y.y+=I[0].height)):y.y=b.y+b.height||y.y),y.text[0]!==void 0&&(this.rect(y.x,y.y,y.width,y.height,t===!0?"FD":void 0),y.align==="right"?this.text(y.text,y.x+y.width-_,y.y+_,{align:"right",baseline:"top"}):y.align==="center"?this.text(y.text,y.x+y.width/2,y.y+_,{align:"center",baseline:"top",maxWidth:y.width-_-_}):this.text(y.text,y.x+_,y.y+_,{align:"left",baseline:"top",maxWidth:y.width-_-_})),this.internal.__cell__.lastCell=y,this};a.table=function(y,b,_,B,I){if(s.call(this),!_)throw new Error("No data for PDF table.");var E,R,M,G,U=[],Q=[],q=[],ne={},re={},pe=[],Ae=[],le=(I=I||{}).autoSize||!1,be=I.printHeaders!==!1,we=I.css&&I.css["font-size"]!==void 0?16*I.css["font-size"]:I.fontSize||12,oe=I.margins||Object.assign({width:this.getPageWidth()},e),me=typeof I.padding=="number"?I.padding:3,Le=I.headerBackgroundColor||"#c8c8c8",Se=I.headerTextColor||"#000";if(c.call(this),this.internal.__cell__.printHeaders=be,this.internal.__cell__.margins=oe,this.internal.__cell__.table_font_size=we,this.internal.__cell__.padding=me,this.internal.__cell__.headerBackgroundColor=Le,this.internal.__cell__.headerTextColor=Se,this.setFontSize(we),B==null)Q=U=Object.keys(_[0]),q=U.map(function(){return"left"});else if(Array.isArray(B)&&Wo(B[0])==="object")for(U=B.map(function(Qe){return Qe.name}),Q=B.map(function(Qe){return Qe.prompt||Qe.name||""}),q=B.map(function(Qe){return Qe.align||"left"}),E=0;E<B.length;E+=1)re[B[E].name]=B[E].width*(19.049976/25.4);else Array.isArray(B)&&typeof B[0]=="string"&&(Q=U=B,q=U.map(function(){return"left"}));if(le||Array.isArray(B)&&typeof B[0]=="string")for(E=0;E<U.length;E+=1){for(ne[G=U[E]]=_.map(function(Qe){return Qe[G]}),this.setFont(void 0,"bold"),pe.push(this.getTextDimensions(Q[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),R=ne[G],this.setFont(void 0,"normal"),M=0;M<R.length;M+=1)pe.push(this.getTextDimensions(R[M],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);re[G]=Math.max.apply(null,pe)+me+me,pe=[]}if(be){var Me={};for(E=0;E<U.length;E+=1)Me[U[E]]={},Me[U[E]].text=Q[E],Me[U[E]].align=q[E];var Re=r.call(this,Me,re);Ae=U.map(function(Qe){return new h(y,b,re[Qe],Re,Me[Qe].text,void 0,Me[Qe].align)}),this.setTableHeaderRow(Ae),this.printHeaderRow(1,!1)}var Ze=B.reduce(function(Qe,It){return Qe[It.name]=It.align,Qe},{});for(E=0;E<_.length;E+=1){"rowStart"in I&&I.rowStart instanceof Function&&I.rowStart({row:E,data:_[E]},this);var $e=r.call(this,_[E],re);for(M=0;M<U.length;M+=1){var ct=_[E][U[M]];"cellStart"in I&&I.cellStart instanceof Function&&I.cellStart({row:E,col:M,data:ct},this),A.call(this,new h(y,b,re[U[M]],$e,ct,E+2,Ze[U[M]]))}}return this.internal.__cell__.table_x=y,this.internal.__cell__.table_y=b,this};var r=function(y,b){var _=this.internal.__cell__.padding,B=this.internal.__cell__.table_font_size,I=this.internal.scaleFactor;return Object.keys(y).map(function(E){var R=y[E];return this.splitTextToSize(R.hasOwnProperty("text")?R.text:R,b[E]-_-_)},this).map(function(E){return this.getLineHeightFactor()*E.length*B/I+_+_},this).reduce(function(E,R){return Math.max(E,R)},0)};a.setTableHeaderRow=function(y){s.call(this),this.internal.__cell__.tableHeaderRow=y},a.printHeaderRow=function(y,b){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var B=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new h(B[0],B[1],B[2],B[3],void 0,-1)}this.setFont(void 0,"bold");for(var I=[],E=0;E<this.internal.__cell__.tableHeaderRow.length;E+=1){_=this.internal.__cell__.tableHeaderRow[E].clone(),b&&(_.y=this.internal.__cell__.margins.top||0,I.push(_)),_.lineNumber=y;var R=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),A.call(this,_),this.setTextColor(R)}I.length>0&&this.setTableHeaderRow(I),this.setFont(void 0,"normal"),t=!1}}(Yn.API);var YT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},KT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],x1=XT(KT),qT=[100,200,300,400,500,600,700,800,900],pz=XT(qT);function b1(a){var e=a.family.replace(/"|'/g,"").toLowerCase(),t=function(h){return YT[h=h||"normal"]?h:"normal"}(a.style),s=function(h){if(!h)return 400;if(typeof h=="number")return h>=100&&h<=900&&h%100==0?h:400;if(/^\d00$/.test(h))return parseInt(h);switch(h){case"bold":return 700;case"normal":default:return 400}}(a.weight),c=function(h){return typeof x1[h=h||"normal"]=="number"?h:"normal"}(a.stretch);return{family:e,style:t,weight:s,stretch:c,src:a.src||[],ref:a.ref||{name:e,style:[c,t,s].join(" ")}}}function RE(a,e,t,s){var c;for(c=t;c>=0&&c<e.length;c+=s)if(a[e[c]])return a[e[c]];for(c=t;c>=0&&c<e.length;c-=s)if(a[e[c]])return a[e[c]]}var gz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},DE={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function OE(a){return[a.stretch,a.style,a.weight,a.family].join(" ")}function mz(a,e,t){for(var s=(t=t||{}).defaultFontFamily||"times",c=Object.assign({},gz,t.genericFontFamilies||{}),h=null,A=null,r=0;r<e.length;++r)if(c[(h=b1(e[r])).family]&&(h.family=c[h.family]),a.hasOwnProperty(h.family)){A=a[h.family];break}if(!(A=A||a[s]))throw new Error("Could not find a font-family for the rule '"+OE(h)+"' and default family '"+s+"'.");if(A=function(y,b){if(b[y])return b[y];var _=x1[y],B=_<=x1.normal?-1:1,I=RE(b,KT,_,B);if(!I)throw new Error("Could not find a matching font-stretch value for "+y);return I}(h.stretch,A),A=function(y,b){if(b[y])return b[y];for(var _=YT[y],B=0;B<_.length;++B)if(b[_[B]])return b[_[B]];throw new Error("Could not find a matching font-style for "+y)}(h.style,A),!(A=function(y,b){if(b[y])return b[y];if(y===400&&b[500])return b[500];if(y===500&&b[400])return b[400];var _=pz[y],B=RE(b,qT,_,y<400?-1:1);if(!B)throw new Error("Could not find a matching font-weight for value "+y);return B}(h.weight,A)))throw new Error("Failed to resolve a font for the rule '"+OE(h)+"'.");return A}function UE(a){return a.trimLeft()}function yz(a,e){for(var t=0;t<a.length;){if(a.charAt(t)===e)return[a.substring(0,t),a.substring(t+1)];t+=1}return null}function vz(a){var e=a.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],a.substring(e[0].length)]}var m0,zE,NE,Eb=["times"];(function(a){var e,t,s,c,h,A,r,y,b,_=function(Ce){return Ce=Ce||{},this.isStrokeTransparent=Ce.isStrokeTransparent||!1,this.strokeOpacity=Ce.strokeOpacity||1,this.strokeStyle=Ce.strokeStyle||"#000000",this.fillStyle=Ce.fillStyle||"#000000",this.isFillTransparent=Ce.isFillTransparent||!1,this.fillOpacity=Ce.fillOpacity||1,this.font=Ce.font||"10px sans-serif",this.textBaseline=Ce.textBaseline||"alphabetic",this.textAlign=Ce.textAlign||"left",this.lineWidth=Ce.lineWidth||1,this.lineJoin=Ce.lineJoin||"miter",this.lineCap=Ce.lineCap||"butt",this.path=Ce.path||[],this.transform=Ce.transform!==void 0?Ce.transform.clone():new y,this.globalCompositeOperation=Ce.globalCompositeOperation||"normal",this.globalAlpha=Ce.globalAlpha||1,this.clip_path=Ce.clip_path||[],this.currentPoint=Ce.currentPoint||new A,this.miterLimit=Ce.miterLimit||10,this.lastPoint=Ce.lastPoint||new A,this.lineDashOffset=Ce.lineDashOffset||0,this.lineDash=Ce.lineDash||[],this.margin=Ce.margin||[0,0,0,0],this.prevPageLastElemOffset=Ce.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Ce.ignoreClearRect!="boolean"||Ce.ignoreClearRect,this};a.events.push(["initialized",function(){this.context2d=new B(this),e=this.internal.f2,t=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,c=this.internal.getHorizontalCoordinate,h=this.internal.getVerticalCoordinate,A=this.internal.Point,r=this.internal.Rectangle,y=this.internal.Matrix,b=new _}]);var B=function(Ce){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Je=Ce;Object.defineProperty(this,"pdf",{get:function(){return Je}});var lt=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return lt},set:function(Ft){lt=!!Ft}});var mt=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return mt},set:function(Ft){mt=!!Ft}});var Bt=0;Object.defineProperty(this,"posX",{get:function(){return Bt},set:function(Ft){isNaN(Ft)||(Bt=Ft)}});var rt=0;Object.defineProperty(this,"posY",{get:function(){return rt},set:function(Ft){isNaN(Ft)||(rt=Ft)}}),Object.defineProperty(this,"margin",{get:function(){return b.margin},set:function(Ft){var it;typeof Ft=="number"?it=[Ft,Ft,Ft,Ft]:((it=new Array(4))[0]=Ft[0],it[1]=Ft.length>=2?Ft[1]:it[0],it[2]=Ft.length>=3?Ft[2]:it[0],it[3]=Ft.length>=4?Ft[3]:it[1]),b.margin=it}});var St=!1;Object.defineProperty(this,"autoPaging",{get:function(){return St},set:function(Ft){St=Ft}});var vt=0;Object.defineProperty(this,"lastBreak",{get:function(){return vt},set:function(Ft){vt=Ft}});var Gt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Gt},set:function(Ft){Gt=Ft}}),Object.defineProperty(this,"ctx",{get:function(){return b},set:function(Ft){Ft instanceof _&&(b=Ft)}}),Object.defineProperty(this,"path",{get:function(){return b.path},set:function(Ft){b.path=Ft}});var mi=[];Object.defineProperty(this,"ctxStack",{get:function(){return mi},set:function(Ft){mi=Ft}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ft){var it;it=I(Ft),this.ctx.fillStyle=it.style,this.ctx.isFillTransparent=it.a===0,this.ctx.fillOpacity=it.a,this.pdf.setFillColor(it.r,it.g,it.b,{a:it.a}),this.pdf.setTextColor(it.r,it.g,it.b,{a:it.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ft){var it=I(Ft);this.ctx.strokeStyle=it.style,this.ctx.isStrokeTransparent=it.a===0,this.ctx.strokeOpacity=it.a,it.a===0?this.pdf.setDrawColor(255,255,255):(it.a,this.pdf.setDrawColor(it.r,it.g,it.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ft){["butt","round","square"].indexOf(Ft)!==-1&&(this.ctx.lineCap=Ft,this.pdf.setLineCap(Ft))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ft){isNaN(Ft)||(this.ctx.lineWidth=Ft,this.pdf.setLineWidth(Ft))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ft){["bevel","round","miter"].indexOf(Ft)!==-1&&(this.ctx.lineJoin=Ft,this.pdf.setLineJoin(Ft))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ft){isNaN(Ft)||(this.ctx.miterLimit=Ft,this.pdf.setMiterLimit(Ft))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ft){this.ctx.textBaseline=Ft}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ft){["right","end","center","left","start"].indexOf(Ft)!==-1&&(this.ctx.textAlign=Ft)}});var ze=null;function Ve(Ft,it){if(ze===null){var yi=function(bi){var Kt=[];return Object.keys(bi).forEach(function(di){bi[di].forEach(function(fi){var Ri=null;switch(fi){case"bold":Ri={family:di,weight:"bold"};break;case"italic":Ri={family:di,style:"italic"};break;case"bolditalic":Ri={family:di,weight:"bold",style:"italic"};break;case"":case"normal":Ri={family:di}}Ri!==null&&(Ri.ref={name:di,style:fi},Kt.push(Ri))})}),Kt}(Ft.getFontList());ze=function(bi){for(var Kt={},di=0;di<bi.length;++di){var fi=b1(bi[di]),Ri=fi.family,Oi=fi.stretch,Ji=fi.style,lr=fi.weight;Kt[Ri]=Kt[Ri]||{},Kt[Ri][Oi]=Kt[Ri][Oi]||{},Kt[Ri][Oi][Ji]=Kt[Ri][Oi][Ji]||{},Kt[Ri][Oi][Ji][lr]=fi}return Kt}(yi.concat(it))}return ze}var kt=null;Object.defineProperty(this,"fontFaces",{get:function(){return kt},set:function(Ft){ze=null,kt=Ft}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ft){var it;if(this.ctx.font=Ft,(it=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ft))!==null){var yi=it[1];it[2];var bi=it[3],Kt=it[4];it[5];var di=it[6],fi=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Kt)[2];Kt=Math.floor(fi==="px"?parseFloat(Kt)*this.pdf.internal.scaleFactor:fi==="em"?parseFloat(Kt)*this.pdf.getFontSize():parseFloat(Kt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Kt);var Ri=function(Qr){var ui,li,Vi=[],rr=Qr.trim();if(rr==="")return Eb;if(rr in DE)return[DE[rr]];for(;rr!=="";){switch(li=null,ui=(rr=UE(rr)).charAt(0)){case'"':case"'":li=yz(rr.substring(1),ui);break;default:li=vz(rr)}if(li===null||(Vi.push(li[0]),(rr=UE(li[1]))!==""&&rr.charAt(0)!==","))return Eb;rr=rr.replace(/^,/,"")}return Vi}(di);if(this.fontFaces){var Oi=mz(Ve(this.pdf,this.fontFaces),Ri.map(function(Qr){return{family:Qr,stretch:"normal",weight:bi,style:yi}}));this.pdf.setFont(Oi.ref.name,Oi.ref.style)}else{var Ji="";(bi==="bold"||parseInt(bi,10)>=700||yi==="bold")&&(Ji="bold"),yi==="italic"&&(Ji+="italic"),Ji.length===0&&(Ji="normal");for(var lr="",br={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dr=0;Dr<Ri.length;Dr++){if(this.pdf.internal.getFont(Ri[Dr],Ji,{noFallback:!0,disableWarning:!0})!==void 0){lr=Ri[Dr];break}if(Ji==="bolditalic"&&this.pdf.internal.getFont(Ri[Dr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)lr=Ri[Dr],Ji="bold";else if(this.pdf.internal.getFont(Ri[Dr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){lr=Ri[Dr],Ji="normal";break}}if(lr===""){for(var Fr=0;Fr<Ri.length;Fr++)if(br[Ri[Fr]]){lr=br[Ri[Fr]];break}}lr=lr===""?"Times":lr,this.pdf.setFont(lr,Ji)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ft){this.ctx.globalCompositeOperation=Ft}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ft){this.ctx.globalAlpha=Ft}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ft){this.ctx.lineDashOffset=Ft,It.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ft){this.ctx.lineDash=Ft,It.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ft){this.ctx.ignoreClearRect=!!Ft}})};B.prototype.setLineDash=function(Ce){this.lineDash=Ce},B.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},B.prototype.fill=function(){ne.call(this,"fill",!1)},B.prototype.stroke=function(){ne.call(this,"stroke",!1)},B.prototype.beginPath=function(){this.path=[{type:"begin"}]},B.prototype.moveTo=function(Ce,Je){if(isNaN(Ce)||isNaN(Je))throw da.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var lt=this.ctx.transform.applyToPoint(new A(Ce,Je));this.path.push({type:"mt",x:lt.x,y:lt.y}),this.ctx.lastPoint=new A(Ce,Je)},B.prototype.closePath=function(){var Ce=new A(0,0),Je=0;for(Je=this.path.length-1;Je!==-1;Je--)if(this.path[Je].type==="begin"&&Wo(this.path[Je+1])==="object"&&typeof this.path[Je+1].x=="number"){Ce=new A(this.path[Je+1].x,this.path[Je+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new A(Ce.x,Ce.y)},B.prototype.lineTo=function(Ce,Je){if(isNaN(Ce)||isNaN(Je))throw da.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var lt=this.ctx.transform.applyToPoint(new A(Ce,Je));this.path.push({type:"lt",x:lt.x,y:lt.y}),this.ctx.lastPoint=new A(lt.x,lt.y)},B.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),ne.call(this,null,!0)},B.prototype.quadraticCurveTo=function(Ce,Je,lt,mt){if(isNaN(lt)||isNaN(mt)||isNaN(Ce)||isNaN(Je))throw da.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Bt=this.ctx.transform.applyToPoint(new A(lt,mt)),rt=this.ctx.transform.applyToPoint(new A(Ce,Je));this.path.push({type:"qct",x1:rt.x,y1:rt.y,x:Bt.x,y:Bt.y}),this.ctx.lastPoint=new A(Bt.x,Bt.y)},B.prototype.bezierCurveTo=function(Ce,Je,lt,mt,Bt,rt){if(isNaN(Bt)||isNaN(rt)||isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt))throw da.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var St=this.ctx.transform.applyToPoint(new A(Bt,rt)),vt=this.ctx.transform.applyToPoint(new A(Ce,Je)),Gt=this.ctx.transform.applyToPoint(new A(lt,mt));this.path.push({type:"bct",x1:vt.x,y1:vt.y,x2:Gt.x,y2:Gt.y,x:St.x,y:St.y}),this.ctx.lastPoint=new A(St.x,St.y)},B.prototype.arc=function(Ce,Je,lt,mt,Bt,rt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt)||isNaN(Bt))throw da.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(rt=!!rt,!this.ctx.transform.isIdentity){var St=this.ctx.transform.applyToPoint(new A(Ce,Je));Ce=St.x,Je=St.y;var vt=this.ctx.transform.applyToPoint(new A(0,lt)),Gt=this.ctx.transform.applyToPoint(new A(0,0));lt=Math.sqrt(Math.pow(vt.x-Gt.x,2)+Math.pow(vt.y-Gt.y,2))}Math.abs(Bt-mt)>=2*Math.PI&&(mt=0,Bt=2*Math.PI),this.path.push({type:"arc",x:Ce,y:Je,radius:lt,startAngle:mt,endAngle:Bt,counterclockwise:rt})},B.prototype.arcTo=function(Ce,Je,lt,mt,Bt){throw new Error("arcTo not implemented.")},B.prototype.rect=function(Ce,Je,lt,mt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt))throw da.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Ce,Je),this.lineTo(Ce+lt,Je),this.lineTo(Ce+lt,Je+mt),this.lineTo(Ce,Je+mt),this.lineTo(Ce,Je),this.lineTo(Ce+lt,Je),this.lineTo(Ce,Je)},B.prototype.fillRect=function(Ce,Je,lt,mt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt))throw da.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!E.call(this)){var Bt={};this.lineCap!=="butt"&&(Bt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Bt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Ce,Je,lt,mt),this.fill(),Bt.hasOwnProperty("lineCap")&&(this.lineCap=Bt.lineCap),Bt.hasOwnProperty("lineJoin")&&(this.lineJoin=Bt.lineJoin)}},B.prototype.strokeRect=function(Ce,Je,lt,mt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt))throw da.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");R.call(this)||(this.beginPath(),this.rect(Ce,Je,lt,mt),this.stroke())},B.prototype.clearRect=function(Ce,Je,lt,mt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt))throw da.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Ce,Je,lt,mt))},B.prototype.save=function(Ce){Ce=typeof Ce!="boolean"||Ce;for(var Je=this.pdf.internal.getCurrentPageInfo().pageNumber,lt=0;lt<this.pdf.internal.getNumberOfPages();lt++)this.pdf.setPage(lt+1),this.pdf.internal.out("q");if(this.pdf.setPage(Je),Ce){this.ctx.fontSize=this.pdf.internal.getFontSize();var mt=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=mt}},B.prototype.restore=function(Ce){Ce=typeof Ce!="boolean"||Ce;for(var Je=this.pdf.internal.getCurrentPageInfo().pageNumber,lt=0;lt<this.pdf.internal.getNumberOfPages();lt++)this.pdf.setPage(lt+1),this.pdf.internal.out("Q");this.pdf.setPage(Je),Ce&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},B.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var I=function(Ce){var Je,lt,mt,Bt;if(Ce.isCanvasGradient===!0&&(Ce=Ce.getColor()),!Ce)return{r:0,g:0,b:0,a:0,style:Ce};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Ce))Je=0,lt=0,mt=0,Bt=0;else{var rt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Ce);if(rt!==null)Je=parseInt(rt[1]),lt=parseInt(rt[2]),mt=parseInt(rt[3]),Bt=1;else if((rt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Ce))!==null)Je=parseInt(rt[1]),lt=parseInt(rt[2]),mt=parseInt(rt[3]),Bt=parseFloat(rt[4]);else{if(Bt=1,typeof Ce=="string"&&Ce.charAt(0)!=="#"){var St=new jT(Ce);Ce=St.ok?St.toHex():"#000000"}Ce.length===4?(Je=Ce.substring(1,2),Je+=Je,lt=Ce.substring(2,3),lt+=lt,mt=Ce.substring(3,4),mt+=mt):(Je=Ce.substring(1,3),lt=Ce.substring(3,5),mt=Ce.substring(5,7)),Je=parseInt(Je,16),lt=parseInt(lt,16),mt=parseInt(mt,16)}}return{r:Je,g:lt,b:mt,a:Bt,style:Ce}},E=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},R=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};B.prototype.fillText=function(Ce,Je,lt,mt){if(isNaN(Je)||isNaN(lt)||typeof Ce!="string")throw da.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(mt=isNaN(mt)?void 0:mt,!E.call(this)){var Bt=$e(this.ctx.transform.rotation),rt=this.ctx.transform.scaleX;me.call(this,{text:Ce,x:Je,y:lt,scale:rt,angle:Bt,align:this.textAlign,maxWidth:mt})}},B.prototype.strokeText=function(Ce,Je,lt,mt){if(isNaN(Je)||isNaN(lt)||typeof Ce!="string")throw da.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!R.call(this)){mt=isNaN(mt)?void 0:mt;var Bt=$e(this.ctx.transform.rotation),rt=this.ctx.transform.scaleX;me.call(this,{text:Ce,x:Je,y:lt,scale:rt,renderingMode:"stroke",angle:Bt,align:this.textAlign,maxWidth:mt})}},B.prototype.measureText=function(Ce){if(typeof Ce!="string")throw da.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Je=this.pdf,lt=this.pdf.internal.scaleFactor,mt=Je.internal.getFontSize(),Bt=Je.getStringUnitWidth(Ce)*mt/Je.internal.scaleFactor,rt=function(St){var vt=(St=St||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return vt}}),this};return new rt({width:Bt*=Math.round(96*lt/72*1e4)/1e4})},B.prototype.scale=function(Ce,Je){if(isNaN(Ce)||isNaN(Je))throw da.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var lt=new y(Ce,0,0,Je,0,0);this.ctx.transform=this.ctx.transform.multiply(lt)},B.prototype.rotate=function(Ce){if(isNaN(Ce))throw da.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Je=new y(Math.cos(Ce),Math.sin(Ce),-Math.sin(Ce),Math.cos(Ce),0,0);this.ctx.transform=this.ctx.transform.multiply(Je)},B.prototype.translate=function(Ce,Je){if(isNaN(Ce)||isNaN(Je))throw da.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var lt=new y(1,0,0,1,Ce,Je);this.ctx.transform=this.ctx.transform.multiply(lt)},B.prototype.transform=function(Ce,Je,lt,mt,Bt,rt){if(isNaN(Ce)||isNaN(Je)||isNaN(lt)||isNaN(mt)||isNaN(Bt)||isNaN(rt))throw da.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var St=new y(Ce,Je,lt,mt,Bt,rt);this.ctx.transform=this.ctx.transform.multiply(St)},B.prototype.setTransform=function(Ce,Je,lt,mt,Bt,rt){Ce=isNaN(Ce)?1:Ce,Je=isNaN(Je)?0:Je,lt=isNaN(lt)?0:lt,mt=isNaN(mt)?1:mt,Bt=isNaN(Bt)?0:Bt,rt=isNaN(rt)?0:rt,this.ctx.transform=new y(Ce,Je,lt,mt,Bt,rt)};var M=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};B.prototype.drawImage=function(Ce,Je,lt,mt,Bt,rt,St,vt,Gt){var mi=this.pdf.getImageProperties(Ce),ze=1,Ve=1,kt=1,Ft=1;mt!==void 0&&vt!==void 0&&(kt=vt/mt,Ft=Gt/Bt,ze=mi.width/mt*vt/mt,Ve=mi.height/Bt*Gt/Bt),rt===void 0&&(rt=Je,St=lt,Je=0,lt=0),mt!==void 0&&vt===void 0&&(vt=mt,Gt=Bt),mt===void 0&&vt===void 0&&(vt=mi.width,Gt=mi.height);for(var it,yi=this.ctx.transform.decompose(),bi=$e(yi.rotate.shx),Kt=new y,di=(Kt=(Kt=(Kt=Kt.multiply(yi.translate)).multiply(yi.skew)).multiply(yi.scale)).applyToRectangle(new r(rt-Je*kt,St-lt*Ft,mt*ze,Bt*Ve)),fi=G.call(this,di),Ri=[],Oi=0;Oi<fi.length;Oi+=1)Ri.indexOf(fi[Oi])===-1&&Ri.push(fi[Oi]);if(q(Ri),this.autoPaging)for(var Ji=Ri[0],lr=Ri[Ri.length-1],br=Ji;br<lr+1;br++){this.pdf.setPage(br);var Dr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fr=br===1?this.posY+this.margin[0]:this.margin[0],Qr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ui=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],li=br===1?0:Qr+(br-2)*ui;if(this.ctx.clip_path.length!==0){var Vi=this.path;it=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(it,this.posX+this.margin[3],-li+Fr+this.ctx.prevPageLastElemOffset),re.call(this,"fill",!0),this.path=Vi}var rr=JSON.parse(JSON.stringify(di));rr=Q([rr],this.posX+this.margin[3],-li+Fr+this.ctx.prevPageLastElemOffset)[0];var qr=(br>Ji||br<lr)&&M.call(this);qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dr,ui,null).clip().discardPath()),this.pdf.addImage(Ce,"JPEG",rr.x,rr.y,rr.w,rr.h,null,null,bi),qr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Ce,"JPEG",di.x,di.y,di.w,di.h,null,null,bi)};var G=function(Ce,Je,lt){var mt=[];Je=Je||this.pdf.internal.pageSize.width,lt=lt||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Bt=this.posY+this.ctx.prevPageLastElemOffset;switch(Ce.type){default:case"mt":case"lt":mt.push(Math.floor((Ce.y+Bt)/lt)+1);break;case"arc":mt.push(Math.floor((Ce.y+Bt-Ce.radius)/lt)+1),mt.push(Math.floor((Ce.y+Bt+Ce.radius)/lt)+1);break;case"qct":var rt=ct(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ce.x1,Ce.y1,Ce.x,Ce.y);mt.push(Math.floor((rt.y+Bt)/lt)+1),mt.push(Math.floor((rt.y+rt.h+Bt)/lt)+1);break;case"bct":var St=Qe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Ce.x1,Ce.y1,Ce.x2,Ce.y2,Ce.x,Ce.y);mt.push(Math.floor((St.y+Bt)/lt)+1),mt.push(Math.floor((St.y+St.h+Bt)/lt)+1);break;case"rect":mt.push(Math.floor((Ce.y+Bt)/lt)+1),mt.push(Math.floor((Ce.y+Ce.h+Bt)/lt)+1)}for(var vt=0;vt<mt.length;vt+=1)for(;this.pdf.internal.getNumberOfPages()<mt[vt];)U.call(this);return mt},U=function(){var Ce=this.fillStyle,Je=this.strokeStyle,lt=this.font,mt=this.lineCap,Bt=this.lineWidth,rt=this.lineJoin;this.pdf.addPage(),this.fillStyle=Ce,this.strokeStyle=Je,this.font=lt,this.lineCap=mt,this.lineWidth=Bt,this.lineJoin=rt},Q=function(Ce,Je,lt){for(var mt=0;mt<Ce.length;mt++)switch(Ce[mt].type){case"bct":Ce[mt].x2+=Je,Ce[mt].y2+=lt;case"qct":Ce[mt].x1+=Je,Ce[mt].y1+=lt;case"mt":case"lt":case"arc":default:Ce[mt].x+=Je,Ce[mt].y+=lt}return Ce},q=function(Ce){return Ce.sort(function(Je,lt){return Je-lt})},ne=function(Ce,Je){for(var lt,mt,Bt=this.fillStyle,rt=this.strokeStyle,St=this.lineCap,vt=this.lineWidth,Gt=Math.abs(vt*this.ctx.transform.scaleX),mi=this.lineJoin,ze=JSON.parse(JSON.stringify(this.path)),Ve=JSON.parse(JSON.stringify(this.path)),kt=[],Ft=0;Ft<Ve.length;Ft++)if(Ve[Ft].x!==void 0)for(var it=G.call(this,Ve[Ft]),yi=0;yi<it.length;yi+=1)kt.indexOf(it[yi])===-1&&kt.push(it[yi]);for(var bi=0;bi<kt.length;bi++)for(;this.pdf.internal.getNumberOfPages()<kt[bi];)U.call(this);if(q(kt),this.autoPaging)for(var Kt=kt[0],di=kt[kt.length-1],fi=Kt;fi<di+1;fi++){this.pdf.setPage(fi),this.fillStyle=Bt,this.strokeStyle=rt,this.lineCap=St,this.lineWidth=Gt,this.lineJoin=mi;var Ri=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Oi=fi===1?this.posY+this.margin[0]:this.margin[0],Ji=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],br=fi===1?0:Ji+(fi-2)*lr;if(this.ctx.clip_path.length!==0){var Dr=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(lt,this.posX+this.margin[3],-br+Oi+this.ctx.prevPageLastElemOffset),re.call(this,Ce,!0),this.path=Dr}if(mt=JSON.parse(JSON.stringify(ze)),this.path=Q(mt,this.posX+this.margin[3],-br+Oi+this.ctx.prevPageLastElemOffset),Je===!1||fi===0){var Fr=(fi>Kt||fi<di)&&M.call(this);Fr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ri,lr,null).clip().discardPath()),re.call(this,Ce,Je),Fr&&this.pdf.restoreGraphicsState()}this.lineWidth=vt}else this.lineWidth=Gt,re.call(this,Ce,Je),this.lineWidth=vt;this.path=ze},re=function(Ce,Je){if((Ce!=="stroke"||Je||!R.call(this))&&(Ce==="stroke"||Je||!E.call(this))){for(var lt,mt,Bt=[],rt=this.path,St=0;St<rt.length;St++){var vt=rt[St];switch(vt.type){case"begin":Bt.push({begin:!0});break;case"close":Bt.push({close:!0});break;case"mt":Bt.push({start:vt,deltas:[],abs:[]});break;case"lt":var Gt=Bt.length;if(rt[St-1]&&!isNaN(rt[St-1].x)&&(lt=[vt.x-rt[St-1].x,vt.y-rt[St-1].y],Gt>0)){for(;Gt>=0;Gt--)if(Bt[Gt-1].close!==!0&&Bt[Gt-1].begin!==!0){Bt[Gt-1].deltas.push(lt),Bt[Gt-1].abs.push(vt);break}}break;case"bct":lt=[vt.x1-rt[St-1].x,vt.y1-rt[St-1].y,vt.x2-rt[St-1].x,vt.y2-rt[St-1].y,vt.x-rt[St-1].x,vt.y-rt[St-1].y],Bt[Bt.length-1].deltas.push(lt);break;case"qct":var mi=rt[St-1].x+2/3*(vt.x1-rt[St-1].x),ze=rt[St-1].y+2/3*(vt.y1-rt[St-1].y),Ve=vt.x+2/3*(vt.x1-vt.x),kt=vt.y+2/3*(vt.y1-vt.y),Ft=vt.x,it=vt.y;lt=[mi-rt[St-1].x,ze-rt[St-1].y,Ve-rt[St-1].x,kt-rt[St-1].y,Ft-rt[St-1].x,it-rt[St-1].y],Bt[Bt.length-1].deltas.push(lt);break;case"arc":Bt.push({deltas:[],abs:[],arc:!0}),Array.isArray(Bt[Bt.length-1].abs)&&Bt[Bt.length-1].abs.push(vt)}}mt=Je?null:Ce==="stroke"?"stroke":"fill";for(var yi=!1,bi=0;bi<Bt.length;bi++)if(Bt[bi].arc)for(var Kt=Bt[bi].abs,di=0;di<Kt.length;di++){var fi=Kt[di];fi.type==="arc"?le.call(this,fi.x,fi.y,fi.radius,fi.startAngle,fi.endAngle,fi.counterclockwise,void 0,Je,!yi):Le.call(this,fi.x,fi.y),yi=!0}else if(Bt[bi].close===!0)this.pdf.internal.out("h"),yi=!1;else if(Bt[bi].begin!==!0){var Ri=Bt[bi].start.x,Oi=Bt[bi].start.y;Se.call(this,Bt[bi].deltas,Ri,Oi),yi=!0}mt&&be.call(this,mt),Je&&we.call(this)}},pe=function(Ce){var Je=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,lt=Je*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Ce-lt;case"top":return Ce+Je-lt;case"hanging":return Ce+Je-2*lt;case"middle":return Ce+Je/2-lt;case"ideographic":return Ce;case"alphabetic":default:return Ce}},Ae=function(Ce){return Ce+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};B.prototype.createLinearGradient=function(){var Ce=function(){};return Ce.colorStops=[],Ce.addColorStop=function(Je,lt){this.colorStops.push([Je,lt])},Ce.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Ce.isCanvasGradient=!0,Ce},B.prototype.createPattern=function(){return this.createLinearGradient()},B.prototype.createRadialGradient=function(){return this.createLinearGradient()};var le=function(Ce,Je,lt,mt,Bt,rt,St,vt,Gt){for(var mi=Re.call(this,lt,mt,Bt,rt),ze=0;ze<mi.length;ze++){var Ve=mi[ze];ze===0&&(Gt?oe.call(this,Ve.x1+Ce,Ve.y1+Je):Le.call(this,Ve.x1+Ce,Ve.y1+Je)),Me.call(this,Ce,Je,Ve.x2,Ve.y2,Ve.x3,Ve.y3,Ve.x4,Ve.y4)}vt?we.call(this):be.call(this,St)},be=function(Ce){switch(Ce){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},we=function(){this.pdf.clip(),this.pdf.discardPath()},oe=function(Ce,Je){this.pdf.internal.out(t(Ce)+" "+s(Je)+" m")},me=function(Ce){var Je;switch(Ce.align){case"right":case"end":Je="right";break;case"center":Je="center";break;case"left":case"start":default:Je="left"}var lt=this.pdf.getTextDimensions(Ce.text),mt=pe.call(this,Ce.y),Bt=Ae.call(this,mt)-lt.h,rt=this.ctx.transform.applyToPoint(new A(Ce.x,mt)),St=this.ctx.transform.decompose(),vt=new y;vt=(vt=(vt=vt.multiply(St.translate)).multiply(St.skew)).multiply(St.scale);for(var Gt,mi,ze,Ve=this.ctx.transform.applyToRectangle(new r(Ce.x,mt,lt.w,lt.h)),kt=vt.applyToRectangle(new r(Ce.x,Bt,lt.w,lt.h)),Ft=G.call(this,kt),it=[],yi=0;yi<Ft.length;yi+=1)it.indexOf(Ft[yi])===-1&&it.push(Ft[yi]);if(q(it),this.autoPaging)for(var bi=it[0],Kt=it[it.length-1],di=bi;di<Kt+1;di++){this.pdf.setPage(di);var fi=di===1?this.posY+this.margin[0]:this.margin[0],Ri=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Oi=this.pdf.internal.pageSize.height-this.margin[2],Ji=Oi-this.margin[0],lr=this.pdf.internal.pageSize.width-this.margin[1],br=lr-this.margin[3],Dr=di===1?0:Ri+(di-2)*Ji;if(this.ctx.clip_path.length!==0){var Fr=this.path;Gt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Q(Gt,this.posX+this.margin[3],-1*Dr+fi),re.call(this,"fill",!0),this.path=Fr}var Qr=Q([JSON.parse(JSON.stringify(kt))],this.posX+this.margin[3],-Dr+fi+this.ctx.prevPageLastElemOffset)[0];Ce.scale>=.01&&(mi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(mi*Ce.scale),ze=this.lineWidth,this.lineWidth=ze*Ce.scale);var ui=this.autoPaging!=="text";if(ui||Qr.y+Qr.h<=Oi){if(ui||Qr.y>=fi&&Qr.x<=lr){var li=ui?Ce.text:this.pdf.splitTextToSize(Ce.text,Ce.maxWidth||lr-Qr.x)[0],Vi=Q([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Dr+fi+this.ctx.prevPageLastElemOffset)[0],rr=ui&&(di>bi||di<Kt)&&M.call(this);rr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],br,Ji,null).clip().discardPath()),this.pdf.text(li,Vi.x,Vi.y,{angle:Ce.angle,align:Je,renderingMode:Ce.renderingMode}),rr&&this.pdf.restoreGraphicsState()}}else Qr.y<Oi&&(this.ctx.prevPageLastElemOffset+=Oi-Qr.y);Ce.scale>=.01&&(this.pdf.setFontSize(mi),this.lineWidth=ze)}else Ce.scale>=.01&&(mi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(mi*Ce.scale),ze=this.lineWidth,this.lineWidth=ze*Ce.scale),this.pdf.text(Ce.text,rt.x+this.posX,rt.y+this.posY,{angle:Ce.angle,align:Je,renderingMode:Ce.renderingMode,maxWidth:Ce.maxWidth}),Ce.scale>=.01&&(this.pdf.setFontSize(mi),this.lineWidth=ze)},Le=function(Ce,Je,lt,mt){lt=lt||0,mt=mt||0,this.pdf.internal.out(t(Ce+lt)+" "+s(Je+mt)+" l")},Se=function(Ce,Je,lt){return this.pdf.lines(Ce,Je,lt,null,null)},Me=function(Ce,Je,lt,mt,Bt,rt,St,vt){this.pdf.internal.out([e(c(lt+Ce)),e(h(mt+Je)),e(c(Bt+Ce)),e(h(rt+Je)),e(c(St+Ce)),e(h(vt+Je)),"c"].join(" "))},Re=function(Ce,Je,lt,mt){for(var Bt=2*Math.PI,rt=Math.PI/2;Je>lt;)Je-=Bt;var St=Math.abs(lt-Je);St<Bt&&mt&&(St=Bt-St);for(var vt=[],Gt=mt?-1:1,mi=Je;St>1e-5;){var ze=mi+Gt*Math.min(St,rt);vt.push(Ze.call(this,Ce,mi,ze)),St-=Math.abs(ze-mi),mi=ze}return vt},Ze=function(Ce,Je,lt){var mt=(lt-Je)/2,Bt=Ce*Math.cos(mt),rt=Ce*Math.sin(mt),St=Bt,vt=-rt,Gt=St*St+vt*vt,mi=Gt+St*Bt+vt*rt,ze=4/3*(Math.sqrt(2*Gt*mi)-mi)/(St*rt-vt*Bt),Ve=St-ze*vt,kt=vt+ze*St,Ft=Ve,it=-kt,yi=mt+Je,bi=Math.cos(yi),Kt=Math.sin(yi);return{x1:Ce*Math.cos(Je),y1:Ce*Math.sin(Je),x2:Ve*bi-kt*Kt,y2:Ve*Kt+kt*bi,x3:Ft*bi-it*Kt,y3:Ft*Kt+it*bi,x4:Ce*Math.cos(lt),y4:Ce*Math.sin(lt)}},$e=function(Ce){return 180*Ce/Math.PI},ct=function(Ce,Je,lt,mt,Bt,rt){var St=Ce+.5*(lt-Ce),vt=Je+.5*(mt-Je),Gt=Bt+.5*(lt-Bt),mi=rt+.5*(mt-rt),ze=Math.min(Ce,Bt,St,Gt),Ve=Math.max(Ce,Bt,St,Gt),kt=Math.min(Je,rt,vt,mi),Ft=Math.max(Je,rt,vt,mi);return new r(ze,kt,Ve-ze,Ft-kt)},Qe=function(Ce,Je,lt,mt,Bt,rt,St,vt){var Gt,mi,ze,Ve,kt,Ft,it,yi,bi,Kt,di,fi,Ri,Oi,Ji=lt-Ce,lr=mt-Je,br=Bt-lt,Dr=rt-mt,Fr=St-Bt,Qr=vt-rt;for(mi=0;mi<41;mi++)bi=(it=(ze=Ce+(Gt=mi/40)*Ji)+Gt*((kt=lt+Gt*br)-ze))+Gt*(kt+Gt*(Bt+Gt*Fr-kt)-it),Kt=(yi=(Ve=Je+Gt*lr)+Gt*((Ft=mt+Gt*Dr)-Ve))+Gt*(Ft+Gt*(rt+Gt*Qr-Ft)-yi),mi==0?(di=bi,fi=Kt,Ri=bi,Oi=Kt):(di=Math.min(di,bi),fi=Math.min(fi,Kt),Ri=Math.max(Ri,bi),Oi=Math.max(Oi,Kt));return new r(Math.round(di),Math.round(fi),Math.round(Ri-di),Math.round(Oi-fi))},It=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Ce,Je,lt=(Ce=this.ctx.lineDash,Je=this.ctx.lineDashOffset,JSON.stringify({lineDash:Ce,lineDashOffset:Je}));this.prevLineDash!==lt&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=lt)}}})(Yn.API),function(a){var e=function(h){var A,r,y,b,_,B,I,E,R,M;for(r=[],y=0,b=(h+=A="\0\0\0\0".slice(h.length%4||4)).length;b>y;y+=4)(_=(h.charCodeAt(y)<<24)+(h.charCodeAt(y+1)<<16)+(h.charCodeAt(y+2)<<8)+h.charCodeAt(y+3))!==0?(B=(_=((_=((_=((_=(_-(M=_%85))/85)-(R=_%85))/85)-(E=_%85))/85)-(I=_%85))/85)%85,r.push(B+33,I+33,E+33,R+33,M+33)):r.push(122);return function(G,U){for(var Q=U;Q>0;Q--)G.pop()}(r,A.length),String.fromCharCode.apply(String,r)+"~>"},t=function(h){var A,r,y,b,_,B=String,I="length",E=255,R="charCodeAt",M="slice",G="replace";for(h[M](-2),h=h[M](0,-2)[G](/\s/g,"")[G]("z","!!!!!"),y=[],b=0,_=(h+=A="uuuuu"[M](h[I]%5||5))[I];_>b;b+=5)r=52200625*(h[R](b)-33)+614125*(h[R](b+1)-33)+7225*(h[R](b+2)-33)+85*(h[R](b+3)-33)+(h[R](b+4)-33),y.push(E&r>>24,E&r>>16,E&r>>8,E&r);return function(U,Q){for(var q=Q;q>0;q--)U.pop()}(y,A[I]),B.fromCharCode.apply(B,y)},s=function(h){var A=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((h=h.replace(/\s/g,"")).indexOf(">")!==-1&&(h=h.substr(0,h.indexOf(">"))),h.length%2&&(h+="0"),A.test(h)===!1)return"";for(var r="",y=0;y<h.length;y+=2)r+=String.fromCharCode("0x"+(h[y]+h[y+1]));return r},c=function(h){for(var A=new Uint8Array(h.length),r=h.length;r--;)A[r]=h.charCodeAt(r);return h=(A=g1(A)).reduce(function(y,b){return y+String.fromCharCode(b)},"")};a.processDataByFilters=function(h,A){var r=0,y=h||"",b=[];for(typeof(A=A||[])=="string"&&(A=[A]),r=0;r<A.length;r+=1)switch(A[r]){case"ASCII85Decode":case"/ASCII85Decode":y=t(y),b.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":y=e(y),b.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":y=s(y),b.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":y=y.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",b.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":y=c(y),b.push("/FlateDecode");break;default:throw new Error('The filter: "'+A[r]+'" is not implemented')}return{data:y,reverseChain:b.reverse().join(" ")}}}(Yn.API),function(a){a.loadFile=function(e,t,s){return function(c,h,A){h=h!==!1,A=typeof A=="function"?A:function(){};var r=void 0;try{r=function(y,b,_){var B=new XMLHttpRequest,I=0,E=function(R){var M=R.length,G=[],U=String.fromCharCode;for(I=0;I<M;I+=1)G.push(U(255&R.charCodeAt(I)));return G.join("")};if(B.open("GET",y,!b),B.overrideMimeType("text/plain; charset=x-user-defined"),b===!1&&(B.onload=function(){B.status===200?_(E(this.responseText)):_(void 0)}),B.send(null),b&&B.status===200)return E(B.responseText)}(c,h,A)}catch{}return r}(e,t,s)},a.loadImageFile=a.loadFile}(Yn.API),function(a){function e(){return(es.html2canvas?Promise.resolve(es.html2canvas):Qy(()=>import("./html2canvas.esm-CBrSDip1.js"),[],import.meta.url)).catch(function(A){return Promise.reject(new Error("Could not load html2canvas: "+A))}).then(function(A){return A.default?A.default:A})}function t(){return(es.DOMPurify?Promise.resolve(es.DOMPurify):Qy(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(A){return Promise.reject(new Error("Could not load dompurify: "+A))}).then(function(A){return A.default?A.default:A})}var s=function(A){var r=Wo(A);return r==="undefined"?"undefined":r==="string"||A instanceof String?"string":r==="number"||A instanceof Number?"number":r==="function"||A instanceof Function?"function":A&&A.constructor===Array?"array":A&&A.nodeType===1?"element":r==="object"?"object":"unknown"},c=function(A,r){var y=document.createElement(A);for(var b in r.className&&(y.className=r.className),r.innerHTML&&r.dompurify&&(y.innerHTML=r.dompurify.sanitize(r.innerHTML)),r.style)y.style[b]=r.style[b];return y},h=function A(r){var y=Object.assign(A.convert(Promise.resolve()),JSON.parse(JSON.stringify(A.template))),b=A.convert(Promise.resolve(),y);return b=(b=b.setProgress(1,A,1,[A])).set(r)};(h.prototype=Object.create(Promise.prototype)).constructor=h,h.convert=function(A,r){return A.__proto__=r||h.prototype,A},h.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},h.prototype.from=function(A,r){return this.then(function(){switch(r=r||function(y){switch(s(y)){case"string":return"string";case"element":return y.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(A)){case"string":return this.then(t).then(function(y){return this.set({src:c("div",{innerHTML:A,dompurify:y})})});case"element":return this.set({src:A});case"canvas":return this.set({canvas:A});case"img":return this.set({img:A});default:return this.error("Unknown source type.")}})},h.prototype.to=function(A){switch(A){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},h.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var A={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},r=function y(b,_){for(var B=b.nodeType===3?document.createTextNode(b.nodeValue):b.cloneNode(!1),I=b.firstChild;I;I=I.nextSibling)_!==!0&&I.nodeType===1&&I.nodeName==="SCRIPT"||B.appendChild(y(I,_));return b.nodeType===1&&(b.nodeName==="CANVAS"?(B.width=b.width,B.height=b.height,B.getContext("2d").drawImage(b,0,0)):b.nodeName!=="TEXTAREA"&&b.nodeName!=="SELECT"||(B.value=b.value),B.addEventListener("load",function(){B.scrollTop=b.scrollTop,B.scrollLeft=b.scrollLeft},!0)),B}(this.prop.src,this.opt.html2canvas.javascriptEnabled);r.tagName==="BODY"&&(A.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=c("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=c("div",{className:"html2pdf__container",style:A}),this.prop.container.appendChild(r),this.prop.container.firstChild.appendChild(c("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},h.prototype.toCanvas=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(r){var y=Object.assign({},this.opt.html2canvas);return delete y.onrendered,r(this.prop.container,y)}).then(function(r){(this.opt.html2canvas.onrendered||function(){})(r),this.prop.canvas=r,document.body.removeChild(this.prop.overlay)})},h.prototype.toContext2d=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(e).then(function(r){var y=this.opt.jsPDF,b=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,B=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete B.onrendered,y.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,y.context2d.posX=this.opt.x,y.context2d.posY=this.opt.y,y.context2d.margin=this.opt.margin,y.context2d.fontFaces=b,b)for(var I=0;I<b.length;++I){var E=b[I],R=E.src.find(function(M){return M.format==="truetype"});R&&y.addFont(R.url,E.ref.name,E.ref.style)}return B.windowHeight=B.windowHeight||0,B.windowHeight=B.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):B.windowHeight,y.context2d.save(!0),r(this.prop.container,B)}).then(function(r){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(r),this.prop.canvas=r,document.body.removeChild(this.prop.overlay)})},h.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var A=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=A})},h.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},h.prototype.output=function(A,r,y){return(y=y||"pdf").toLowerCase()==="img"||y.toLowerCase()==="image"?this.outputImg(A,r):this.outputPdf(A,r)},h.prototype.outputPdf=function(A,r){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(A,r)})},h.prototype.outputImg=function(A){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(A){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+A+'" is not supported.'}})},h.prototype.save=function(A){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(A?{filename:A}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},h.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},h.prototype.set=function(A){if(s(A)!=="object")return this;var r=Object.keys(A||{}).map(function(y){if(y in h.template.prop)return function(){this.prop[y]=A[y]};switch(y){case"margin":return this.setMargin.bind(this,A.margin);case"jsPDF":return function(){return this.opt.jsPDF=A.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,A.pageSize);default:return function(){this.opt[y]=A[y]}}},this);return this.then(function(){return this.thenList(r)})},h.prototype.get=function(A,r){return this.then(function(){var y=A in h.template.prop?this.prop[A]:this.opt[A];return r?r(y):y})},h.prototype.setMargin=function(A){return this.then(function(){switch(s(A)){case"number":A=[A,A,A,A];case"array":if(A.length===2&&(A=[A[0],A[1],A[0],A[1]]),A.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=A}).then(this.setPageSize)},h.prototype.setPageSize=function(A){function r(y,b){return Math.floor(y*b/72*96)}return this.then(function(){(A=A||Yn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(A.inner={width:A.width-this.opt.margin[1]-this.opt.margin[3],height:A.height-this.opt.margin[0]-this.opt.margin[2]},A.inner.px={width:r(A.inner.width,A.k),height:r(A.inner.height,A.k)},A.inner.ratio=A.inner.height/A.inner.width),this.prop.pageSize=A})},h.prototype.setProgress=function(A,r,y,b){return A!=null&&(this.progress.val=A),r!=null&&(this.progress.state=r),y!=null&&(this.progress.n=y),b!=null&&(this.progress.stack=b),this.progress.ratio=this.progress.val/this.progress.state,this},h.prototype.updateProgress=function(A,r,y,b){return this.setProgress(A?this.progress.val+A:null,r||null,y?this.progress.n+y:null,b?this.progress.stack.concat(b):null)},h.prototype.then=function(A,r){var y=this;return this.thenCore(A,r,function(b,_){return y.updateProgress(null,null,1,[b]),Promise.prototype.then.call(this,function(B){return y.updateProgress(null,b),B}).then(b,_).then(function(B){return y.updateProgress(1),B})})},h.prototype.thenCore=function(A,r,y){y=y||Promise.prototype.then,A&&(A=A.bind(this)),r&&(r=r.bind(this));var b=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:h.convert(Object.assign({},this),Promise.prototype),_=y.call(b,A,r);return h.convert(_,this.__proto__)},h.prototype.thenExternal=function(A,r){return Promise.prototype.then.call(this,A,r)},h.prototype.thenList=function(A){var r=this;return A.forEach(function(y){r=r.thenCore(y)}),r},h.prototype.catch=function(A){A&&(A=A.bind(this));var r=Promise.prototype.catch.call(this,A);return h.convert(r,this)},h.prototype.catchExternal=function(A){return Promise.prototype.catch.call(this,A)},h.prototype.error=function(A){return this.then(function(){throw new Error(A)})},h.prototype.using=h.prototype.set,h.prototype.saveAs=h.prototype.save,h.prototype.export=h.prototype.output,h.prototype.run=h.prototype.then,Yn.getPageSize=function(A,r,y){if(Wo(A)==="object"){var b=A;A=b.orientation,r=b.unit||r,y=b.format||y}r=r||"mm",y=y||"a4",A=(""+(A||"P")).toLowerCase();var _,B=(""+y).toLowerCase(),I={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(r){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+r}var E,R=0,M=0;if(I.hasOwnProperty(B))R=I[B][1]/_,M=I[B][0]/_;else try{R=y[1],M=y[0]}catch{throw new Error("Invalid format: "+y)}if(A==="p"||A==="portrait")A="p",M>R&&(E=M,M=R,R=E);else{if(A!=="l"&&A!=="landscape")throw"Invalid orientation: "+A;A="l",R>M&&(E=M,M=R,R=E)}return{width:M,height:R,unit:r,k:_,orientation:A}},a.html=function(A,r){(r=r||{}).callback=r.callback||function(){},r.html2canvas=r.html2canvas||{},r.html2canvas.canvas=r.html2canvas.canvas||this.canvas,r.jsPDF=r.jsPDF||this,r.fontFaces=r.fontFaces?r.fontFaces.map(b1):null;var y=new h(r);return r.worker?y:y.from(A).doCallback()}}(Yn.API),Yn.API.addJS=function(a){return NE=a,this.internal.events.subscribe("postPutResources",function(){m0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(m0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+NE+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){m0!==void 0&&zE!==void 0&&this.internal.out("/Names <</JavaScript "+m0+" 0 R>>")}),this},function(a){var e;a.events.push(["postPutResources",function(){var t=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var c=t.outline.render().split(/\r\n/),h=0;h<c.length;h++){var A=c[h],r=s.exec(A);if(r!=null){var y=r[1];t.internal.newObjectDeferredBegin(y,!1)}t.internal.write(A)}if(this.outline.createNamedDestinations){var b=this.internal.pages.length,_=[];for(h=0;h<b;h++){var B=t.internal.newObject();_.push(B);var I=t.internal.getPageInfo(h+1);t.internal.write("<< /D["+I.objId+" 0 R /XYZ null null null]>> endobj")}var E=t.internal.newObject();for(t.internal.write("<< /Names [ "),h=0;h<_.length;h++)t.internal.write("(page_"+(h+1)+")"+_[h]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+E+" 0 R"),t.internal.write(">>","endobj")}}]),a.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),a.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(s,c,h){var A={title:c,options:h,children:[]};return s==null&&(s=this.root),s.children.push(A),A},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(s){s.id=t.internal.newObjectDeferred();for(var c=0;c<s.children.length;c++)this.genIds_r(s.children[c])},t.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},t.outline.renderItems=function(s){for(var c=this.ctx.pdf.internal.getVerticalCoordinateString,h=0;h<s.children.length;h++){var A=s.children[h];this.objStart(A),this.line("/Title "+this.makeString(A.title)),this.line("/Parent "+this.makeRef(s)),h>0&&this.line("/Prev "+this.makeRef(s.children[h-1])),h<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[h+1])),A.children.length>0&&(this.line("/First "+this.makeRef(A.children[0])),this.line("/Last "+this.makeRef(A.children[A.children.length-1])));var r=this.count=this.count_r({count:0},A);if(r>0&&this.line("/Count "+r),A.options&&A.options.pageNumber){var y=t.internal.getPageInfo(A.options.pageNumber);this.line("/Dest ["+y.objId+" 0 R /XYZ 0 "+c(0)+" 0]")}this.objEnd()}for(var b=0;b<s.children.length;b++)this.renderItems(s.children[b])},t.outline.line=function(s){this.ctx.val+=s+`\r
`},t.outline.makeRef=function(s){return s.id+" 0 R"},t.outline.makeString=function(s){return"("+t.internal.pdfEscape(s)+")"},t.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(s,c){for(var h=0;h<c.children.length;h++)s.count++,this.count_r(s,c.children[h]);return s.count}}])}(Yn.API),function(a){var e=[192,193,194,195,196,197,198,199];a.processJPEG=function(t,s,c,h,A,r){var y,b=this.decode.DCT_DECODE,_=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=A||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(y=function(B){for(var I,E=256*B.charCodeAt(4)+B.charCodeAt(5),R=B.length,M={width:0,height:0,numcomponents:1},G=4;G<R;G+=2){if(G+=E,e.indexOf(B.charCodeAt(G+1))!==-1){I=256*B.charCodeAt(G+5)+B.charCodeAt(G+6),M={width:256*B.charCodeAt(G+7)+B.charCodeAt(G+8),height:I,numcomponents:B.charCodeAt(G+9)};break}E=256*B.charCodeAt(G+2)+B.charCodeAt(G+3)}return M}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:r=this.color_spaces.DEVICE_GRAY;break;case 4:r=this.color_spaces.DEVICE_CMYK;break;case 3:r=this.color_spaces.DEVICE_RGB}_={data:t,width:y.width,height:y.height,colorSpace:r,bitsPerComponent:8,filter:b,index:s,alias:c}}return _}}(Yn.API);var Jg,y0,jE,HE,QE,_z=function(){var a,e,t;function s(h){var A,r,y,b,_,B,I,E,R,M,G,U,Q,q;for(this.data=h,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},B=null;;){switch(A=this.readUInt32(),R=(function(){var ne,re;for(re=[],ne=0;ne<4;++ne)re.push(String.fromCharCode(this.data[this.pos++]));return re}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(A);break;case"fcTL":B&&this.animation.frames.push(B),this.pos+=4,B={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),b=this.readUInt16()||100,B.delay=1e3*_/b,B.disposeOp=this.data[this.pos++],B.blendOp=this.data[this.pos++],B.data=[];break;case"IDAT":case"fdAT":for(R==="fdAT"&&(this.pos+=4,A-=4),h=(B!=null?B.data:void 0)||this.imgData,U=0;0<=A?U<A:U>A;0<=A?++U:--U)h.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(y=this.palette.length/3,this.transparency.indexed=this.read(A),this.transparency.indexed.length>y)throw new Error("More transparent colors than palette size");if((M=y-this.transparency.indexed.length)>0)for(Q=0;0<=M?Q<M:Q>M;0<=M?++Q:--Q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case"tEXt":I=(G=this.read(A)).indexOf(0),E=String.fromCharCode.apply(String,G.slice(0,I)),this.text[E]=String.fromCharCode.apply(String,G.slice(I+1));break;case"IEND":return B&&this.animation.frames.push(B),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(q=this.colorType)===4||q===6,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=A}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(h){var A,r;for(r=[],A=0;0<=h?A<h:A>h;0<=h?++A:--A)r.push(this.data[this.pos++]);return r},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(h){var A=this.pixelBitlength/8,r=new Uint8Array(this.width*this.height*A),y=0,b=this;if(h==null&&(h=this.imgData),h.length===0)return new Uint8Array(0);function _(B,I,E,R){var M,G,U,Q,q,ne,re,pe,Ae,le,be,we,oe,me,Le,Se,Me,Re,Ze,$e,ct,Qe=Math.ceil((b.width-B)/E),It=Math.ceil((b.height-I)/R),Ce=b.width==Qe&&b.height==It;for(me=A*Qe,we=Ce?r:new Uint8Array(me*It),ne=h.length,oe=0,G=0;oe<It&&y<ne;){switch(h[y++]){case 0:for(Q=Me=0;Me<me;Q=Me+=1)we[G++]=h[y++];break;case 1:for(Q=Re=0;Re<me;Q=Re+=1)M=h[y++],q=Q<A?0:we[G-A],we[G++]=(M+q)%256;break;case 2:for(Q=Ze=0;Ze<me;Q=Ze+=1)M=h[y++],U=(Q-Q%A)/A,Le=oe&&we[(oe-1)*me+U*A+Q%A],we[G++]=(Le+M)%256;break;case 3:for(Q=$e=0;$e<me;Q=$e+=1)M=h[y++],U=(Q-Q%A)/A,q=Q<A?0:we[G-A],Le=oe&&we[(oe-1)*me+U*A+Q%A],we[G++]=(M+Math.floor((q+Le)/2))%256;break;case 4:for(Q=ct=0;ct<me;Q=ct+=1)M=h[y++],U=(Q-Q%A)/A,q=Q<A?0:we[G-A],oe===0?Le=Se=0:(Le=we[(oe-1)*me+U*A+Q%A],Se=U&&we[(oe-1)*me+(U-1)*A+Q%A]),re=q+Le-Se,pe=Math.abs(re-q),le=Math.abs(re-Le),be=Math.abs(re-Se),Ae=pe<=le&&pe<=be?q:le<=be?Le:Se,we[G++]=(M+Ae)%256;break;default:throw new Error("Invalid filter algorithm: "+h[y-1])}if(!Ce){var Je=((I+oe*R)*b.width+B)*A,lt=oe*me;for(Q=0;Q<Qe;Q+=1){for(var mt=0;mt<A;mt+=1)r[Je++]=we[lt++];Je+=(E-1)*A}}oe++}}return h=$U(h),b.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),r},s.prototype.decodePalette=function(){var h,A,r,y,b,_,B,I,E;for(r=this.palette,_=this.transparency.indexed||[],b=new Uint8Array((_.length||0)+r.length),y=0,h=0,A=B=0,I=r.length;B<I;A=B+=3)b[y++]=r[A],b[y++]=r[A+1],b[y++]=r[A+2],b[y++]=(E=_[h++])!=null?E:255;return b},s.prototype.copyToImageData=function(h,A){var r,y,b,_,B,I,E,R,M,G,U;if(y=this.colors,M=null,r=this.hasAlphaChannel,this.palette.length&&(M=(U=this._decodedPalette)!=null?U:this._decodedPalette=this.decodePalette(),y=4,r=!0),R=(b=h.data||h).length,B=M||A,_=I=0,y===1)for(;_<R;)E=M?4*A[_/4]:I,G=B[E++],b[_++]=G,b[_++]=G,b[_++]=G,b[_++]=r?B[E++]:255,I=E;else for(;_<R;)E=M?4*A[_/4]:I,b[_++]=B[E++],b[_++]=B[E++],b[_++]=B[E++],b[_++]=r?B[E++]:255,I=E},s.prototype.decode=function(){var h;return h=new Uint8Array(this.width*this.height*4),this.copyToImageData(h,this.decodePixels()),h};var c=function(){if(Object.prototype.toString.call(es)==="[object Window]"){try{e=es.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return c(),a=function(h){var A;if(c()===!0)return t.width=h.width,t.height=h.height,t.clearRect(0,0,h.width,h.height),t.putImageData(h,0,0),(A=new Image).src=e.toDataURL(),A;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(h){var A,r,y,b,_,B,I,E;if(this.animation){for(E=[],r=_=0,B=(I=this.animation.frames).length;_<B;r=++_)A=I[r],y=h.createImageData(A.width,A.height),b=this.decodePixels(new Uint8Array(A.data)),this.copyToImageData(y,b),A.imageData=y,E.push(A.image=a(y));return E}},s.prototype.renderFrame=function(h,A){var r,y,b;return r=(y=this.animation.frames)[A],b=y[A-1],A===0&&h.clearRect(0,0,this.width,this.height),(b!=null?b.disposeOp:void 0)===1?h.clearRect(b.xOffset,b.yOffset,b.width,b.height):(b!=null?b.disposeOp:void 0)===2&&h.putImageData(b.imageData,b.xOffset,b.yOffset),r.blendOp===0&&h.clearRect(r.xOffset,r.yOffset,r.width,r.height),h.drawImage(r.image,r.xOffset,r.yOffset)},s.prototype.animate=function(h){var A,r,y,b,_,B,I=this;return r=0,B=this.animation,b=B.numFrames,y=B.frames,_=B.numPlays,(A=function(){var E,R;if(E=r++%b,R=y[E],I.renderFrame(h,E),b>1&&r/b<_)return I.animation._timeout=setTimeout(A,R.delay)})()},s.prototype.stopAnimation=function(){var h;return clearTimeout((h=this.animation)!=null?h._timeout:void 0)},s.prototype.render=function(h){var A,r;return h._png&&h._png.stopAnimation(),h._png=this,h.width=this.width,h.height=this.height,A=h.getContext("2d"),this.animation?(this.decodeFrames(A),this.animate(A)):(r=A.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),A.putImageData(r,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function xz(a){var e=0;if(a[e++]!==71||a[e++]!==73||a[e++]!==70||a[e++]!==56||(a[e++]+1&253)!=56||a[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=a[e++]|a[e++]<<8,s=a[e++]|a[e++]<<8,c=a[e++],h=c>>7,A=1<<(7&c)+1;a[e++],a[e++];var r=null,y=null;h&&(r=e,y=A,e+=3*A);var b=!0,_=[],B=0,I=null,E=0,R=null;for(this.width=t,this.height=s;b&&e<a.length;)switch(a[e++]){case 33:switch(a[e++]){case 255:if(a[e]!==11||a[e+1]==78&&a[e+2]==69&&a[e+3]==84&&a[e+4]==83&&a[e+5]==67&&a[e+6]==65&&a[e+7]==80&&a[e+8]==69&&a[e+9]==50&&a[e+10]==46&&a[e+11]==48&&a[e+12]==3&&a[e+13]==1&&a[e+16]==0)e+=14,R=a[e++]|a[e++]<<8,e++;else for(e+=12;;){if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;case 249:if(a[e++]!==4||a[e+4]!==0)throw new Error("Invalid graphics extension block.");var M=a[e++];B=a[e++]|a[e++]<<8,I=a[e++],(1&M)==0&&(I=null),E=M>>2&7,e++;break;case 254:for(;;){if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}break;default:throw new Error("Unknown graphic control label: 0x"+a[e-1].toString(16))}break;case 44:var G=a[e++]|a[e++]<<8,U=a[e++]|a[e++]<<8,Q=a[e++]|a[e++]<<8,q=a[e++]|a[e++]<<8,ne=a[e++],re=ne>>6&1,pe=1<<(7&ne)+1,Ae=r,le=y,be=!1;ne>>7&&(be=!0,Ae=e,le=pe,e+=3*pe);var we=e;for(e++;;){var oe;if(!((oe=a[e++])>=0))throw Error("Invalid block size");if(oe===0)break;e+=oe}_.push({x:G,y:U,width:Q,height:q,has_local_palette:be,palette_offset:Ae,palette_size:le,data_offset:we,data_length:e-we,transparent_index:I,interlaced:!!re,delay:B,disposal:E});break;case 59:b=!1;break;default:throw new Error("Unknown gif block: 0x"+a[e-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return R},this.frameInfo=function(me){if(me<0||me>=_.length)throw new Error("Frame index out of range.");return _[me]},this.decodeAndBlitFrameBGRA=function(me,Le){var Se=this.frameInfo(me),Me=Se.width*Se.height,Re=new Uint8Array(Me);VE(a,Se.data_offset,Re,Me);var Ze=Se.palette_offset,$e=Se.transparent_index;$e===null&&($e=256);var ct=Se.width,Qe=t-ct,It=ct,Ce=4*(Se.y*t+Se.x),Je=4*((Se.y+Se.height)*t+Se.x),lt=Ce,mt=4*Qe;Se.interlaced===!0&&(mt+=4*t*7);for(var Bt=8,rt=0,St=Re.length;rt<St;++rt){var vt=Re[rt];if(It===0&&(It=ct,(lt+=mt)>=Je&&(mt=4*Qe+4*t*(Bt-1),lt=Ce+(ct+Qe)*(Bt<<1),Bt>>=1)),vt===$e)lt+=4;else{var Gt=a[Ze+3*vt],mi=a[Ze+3*vt+1],ze=a[Ze+3*vt+2];Le[lt++]=ze,Le[lt++]=mi,Le[lt++]=Gt,Le[lt++]=255}--It}},this.decodeAndBlitFrameRGBA=function(me,Le){var Se=this.frameInfo(me),Me=Se.width*Se.height,Re=new Uint8Array(Me);VE(a,Se.data_offset,Re,Me);var Ze=Se.palette_offset,$e=Se.transparent_index;$e===null&&($e=256);var ct=Se.width,Qe=t-ct,It=ct,Ce=4*(Se.y*t+Se.x),Je=4*((Se.y+Se.height)*t+Se.x),lt=Ce,mt=4*Qe;Se.interlaced===!0&&(mt+=4*t*7);for(var Bt=8,rt=0,St=Re.length;rt<St;++rt){var vt=Re[rt];if(It===0&&(It=ct,(lt+=mt)>=Je&&(mt=4*Qe+4*t*(Bt-1),lt=Ce+(ct+Qe)*(Bt<<1),Bt>>=1)),vt===$e)lt+=4;else{var Gt=a[Ze+3*vt],mi=a[Ze+3*vt+1],ze=a[Ze+3*vt+2];Le[lt++]=Gt,Le[lt++]=mi,Le[lt++]=ze,Le[lt++]=255}--It}}}function VE(a,e,t,s){for(var c=a[e++],h=1<<c,A=h+1,r=A+1,y=c+1,b=(1<<y)-1,_=0,B=0,I=0,E=a[e++],R=new Int32Array(4096),M=null;;){for(;_<16&&E!==0;)B|=a[e++]<<_,_+=8,E===1?E=a[e++]:--E;if(_<y)break;var G=B&b;if(B>>=y,_-=y,G!==h){if(G===A)break;for(var U=G<r?G:M,Q=0,q=U;q>h;)q=R[q]>>8,++Q;var ne=q;if(I+Q+(U!==G?1:0)>s)return void da.log("Warning, gif stream longer than expected.");t[I++]=ne;var re=I+=Q;for(U!==G&&(t[I++]=ne),q=U;Q--;)q=R[q],t[--re]=255&q,q>>=8;M!==null&&r<4096&&(R[r++]=M<<8|ne,r>=b+1&&y<12&&(++y,b=b<<1|1)),M=G}else r=A+1,b=(1<<(y=c+1))-1,M=null}return I!==s&&da.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ib(a){var e,t,s,c,h,A=Math.floor,r=new Array(64),y=new Array(64),b=new Array(64),_=new Array(64),B=new Array(65535),I=new Array(65535),E=new Array(64),R=new Array(64),M=[],G=0,U=7,Q=new Array(64),q=new Array(64),ne=new Array(64),re=new Array(256),pe=new Array(2048),Ae=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],le=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],be=[0,1,2,3,4,5,6,7,8,9,10,11],we=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],oe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],me=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Le=[0,1,2,3,4,5,6,7,8,9,10,11],Se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Me=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Re(Ce,Je){for(var lt=0,mt=0,Bt=new Array,rt=1;rt<=16;rt++){for(var St=1;St<=Ce[rt];St++)Bt[Je[mt]]=[],Bt[Je[mt]][0]=lt,Bt[Je[mt]][1]=rt,mt++,lt++;lt*=2}return Bt}function Ze(Ce){for(var Je=Ce[0],lt=Ce[1]-1;lt>=0;)Je&1<<lt&&(G|=1<<U),lt--,--U<0&&(G==255?($e(255),$e(0)):$e(G),U=7,G=0)}function $e(Ce){M.push(Ce)}function ct(Ce){$e(Ce>>8&255),$e(255&Ce)}function Qe(Ce,Je,lt,mt,Bt){for(var rt,St=Bt[0],vt=Bt[240],Gt=function(Kt,di){var fi,Ri,Oi,Ji,lr,br,Dr,Fr,Qr,ui,li=0;for(Qr=0;Qr<8;++Qr){fi=Kt[li],Ri=Kt[li+1],Oi=Kt[li+2],Ji=Kt[li+3],lr=Kt[li+4],br=Kt[li+5],Dr=Kt[li+6];var Vi=fi+(Fr=Kt[li+7]),rr=fi-Fr,qr=Ri+Dr,_r=Ri-Dr,Zr=Oi+br,io=Oi-br,Ur=Ji+lr,ia=Ji-lr,ps=Vi+Ur,ro=Vi-Ur,Qn=qr+Zr,Lr=qr-Zr;Kt[li]=ps+Qn,Kt[li+4]=ps-Qn;var yr=.707106781*(Lr+ro);Kt[li+2]=ro+yr,Kt[li+6]=ro-yr;var qt=.382683433*((ps=ia+io)-(Lr=_r+rr)),Vn=.5411961*ps+qt,xs=1.306562965*Lr+qt,ra=.707106781*(Qn=io+_r),dn=rr+ra,Et=rr-ra;Kt[li+5]=Et+Vn,Kt[li+3]=Et-Vn,Kt[li+1]=dn+xs,Kt[li+7]=dn-xs,li+=8}for(li=0,Qr=0;Qr<8;++Qr){fi=Kt[li],Ri=Kt[li+8],Oi=Kt[li+16],Ji=Kt[li+24],lr=Kt[li+32],br=Kt[li+40],Dr=Kt[li+48];var ye=fi+(Fr=Kt[li+56]),Ee=fi-Fr,He=Ri+Dr,tt=Ri-Dr,Ye=Oi+br,xt=Oi-br,Dt=Ji+lr,bt=Ji-lr,Ut=ye+Dt,ii=ye-Dt,Nt=He+Ye,Fi=He-Ye;Kt[li]=Ut+Nt,Kt[li+32]=Ut-Nt;var er=.707106781*(Fi+ii);Kt[li+16]=ii+er,Kt[li+48]=ii-er;var nr=.382683433*((Ut=bt+xt)-(Fi=tt+Ee)),Sr=.5411961*Ut+nr,Mr=1.306562965*Fi+nr,jr=.707106781*(Nt=xt+tt),nn=Ee+jr,Yr=Ee-jr;Kt[li+40]=Yr+Sr,Kt[li+24]=Yr-Sr,Kt[li+8]=nn+Mr,Kt[li+56]=nn-Mr,li++}for(Qr=0;Qr<64;++Qr)ui=Kt[Qr]*di[Qr],E[Qr]=ui>0?ui+.5|0:ui-.5|0;return E}(Ce,Je),mi=0;mi<64;++mi)R[Ae[mi]]=Gt[mi];var ze=R[0]-lt;lt=R[0],ze==0?Ze(mt[0]):(Ze(mt[I[rt=32767+ze]]),Ze(B[rt]));for(var Ve=63;Ve>0&&R[Ve]==0;)Ve--;if(Ve==0)return Ze(St),lt;for(var kt,Ft=1;Ft<=Ve;){for(var it=Ft;R[Ft]==0&&Ft<=Ve;)++Ft;var yi=Ft-it;if(yi>=16){kt=yi>>4;for(var bi=1;bi<=kt;++bi)Ze(vt);yi&=15}rt=32767+R[Ft],Ze(Bt[(yi<<4)+I[rt]]),Ze(B[rt]),Ft++}return Ve!=63&&Ze(St),lt}function It(Ce){Ce=Math.min(Math.max(Ce,1),100),h!=Ce&&(function(Je){for(var lt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],mt=0;mt<64;mt++){var Bt=A((lt[mt]*Je+50)/100);Bt=Math.min(Math.max(Bt,1),255),r[Ae[mt]]=Bt}for(var rt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],St=0;St<64;St++){var vt=A((rt[St]*Je+50)/100);vt=Math.min(Math.max(vt,1),255),y[Ae[St]]=vt}for(var Gt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],mi=0,ze=0;ze<8;ze++)for(var Ve=0;Ve<8;Ve++)b[mi]=1/(r[Ae[mi]]*Gt[ze]*Gt[Ve]*8),_[mi]=1/(y[Ae[mi]]*Gt[ze]*Gt[Ve]*8),mi++}(Ce<50?Math.floor(5e3/Ce):Math.floor(200-2*Ce)),h=Ce)}this.encode=function(Ce,Je){Je&&It(Je),M=new Array,G=0,U=7,ct(65496),ct(65504),ct(16),$e(74),$e(70),$e(73),$e(70),$e(0),$e(1),$e(1),$e(0),ct(1),ct(1),$e(0),$e(0),function(){ct(65499),ct(132),$e(0);for(var Ri=0;Ri<64;Ri++)$e(r[Ri]);$e(1);for(var Oi=0;Oi<64;Oi++)$e(y[Oi])}(),function(Ri,Oi){ct(65472),ct(17),$e(8),ct(Oi),ct(Ri),$e(3),$e(1),$e(17),$e(0),$e(2),$e(17),$e(1),$e(3),$e(17),$e(1)}(Ce.width,Ce.height),function(){ct(65476),ct(418),$e(0);for(var Ri=0;Ri<16;Ri++)$e(le[Ri+1]);for(var Oi=0;Oi<=11;Oi++)$e(be[Oi]);$e(16);for(var Ji=0;Ji<16;Ji++)$e(we[Ji+1]);for(var lr=0;lr<=161;lr++)$e(oe[lr]);$e(1);for(var br=0;br<16;br++)$e(me[br+1]);for(var Dr=0;Dr<=11;Dr++)$e(Le[Dr]);$e(17);for(var Fr=0;Fr<16;Fr++)$e(Se[Fr+1]);for(var Qr=0;Qr<=161;Qr++)$e(Me[Qr])}(),ct(65498),ct(12),$e(3),$e(1),$e(0),$e(2),$e(17),$e(3),$e(17),$e(0),$e(63),$e(0);var lt=0,mt=0,Bt=0;G=0,U=7,this.encode.displayName="_encode_";for(var rt,St,vt,Gt,mi,ze,Ve,kt,Ft,it=Ce.data,yi=Ce.width,bi=Ce.height,Kt=4*yi,di=0;di<bi;){for(rt=0;rt<Kt;){for(mi=Kt*di+rt,Ve=-1,kt=0,Ft=0;Ft<64;Ft++)ze=mi+(kt=Ft>>3)*Kt+(Ve=4*(7&Ft)),di+kt>=bi&&(ze-=Kt*(di+1+kt-bi)),rt+Ve>=Kt&&(ze-=rt+Ve-Kt+4),St=it[ze++],vt=it[ze++],Gt=it[ze++],Q[Ft]=(pe[St]+pe[vt+256>>0]+pe[Gt+512>>0]>>16)-128,q[Ft]=(pe[St+768>>0]+pe[vt+1024>>0]+pe[Gt+1280>>0]>>16)-128,ne[Ft]=(pe[St+1280>>0]+pe[vt+1536>>0]+pe[Gt+1792>>0]>>16)-128;lt=Qe(Q,b,lt,e,s),mt=Qe(q,_,mt,t,c),Bt=Qe(ne,_,Bt,t,c),rt+=32}di+=8}if(U>=0){var fi=[];fi[1]=U+1,fi[0]=(1<<U+1)-1,Ze(fi)}return ct(65497),new Uint8Array(M)},a=a||50,function(){for(var Ce=String.fromCharCode,Je=0;Je<256;Je++)re[Je]=Ce(Je)}(),e=Re(le,be),t=Re(me,Le),s=Re(we,oe),c=Re(Se,Me),function(){for(var Ce=1,Je=2,lt=1;lt<=15;lt++){for(var mt=Ce;mt<Je;mt++)I[32767+mt]=lt,B[32767+mt]=[],B[32767+mt][1]=lt,B[32767+mt][0]=mt;for(var Bt=-(Je-1);Bt<=-Ce;Bt++)I[32767+Bt]=lt,B[32767+Bt]=[],B[32767+Bt][1]=lt,B[32767+Bt][0]=Je-1+Bt;Ce<<=1,Je<<=1}}(),function(){for(var Ce=0;Ce<256;Ce++)pe[Ce]=19595*Ce,pe[Ce+256>>0]=38470*Ce,pe[Ce+512>>0]=7471*Ce+32768,pe[Ce+768>>0]=-11059*Ce,pe[Ce+1024>>0]=-21709*Ce,pe[Ce+1280>>0]=32768*Ce+8421375,pe[Ce+1536>>0]=-27439*Ce,pe[Ce+1792>>0]=-5329*Ce}(),It(a)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Qd(a,e){if(this.pos=0,this.buffer=a,this.datav=new DataView(a.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function GE(a){function e(le){if(!le)throw Error("assert :P")}function t(le,be,we){for(var oe=0;4>oe;oe++)if(le[be+oe]!=we.charCodeAt(oe))return!0;return!1}function s(le,be,we,oe,me){for(var Le=0;Le<me;Le++)le[be+Le]=we[oe+Le]}function c(le,be,we,oe){for(var me=0;me<oe;me++)le[be+me]=we}function h(le){return new Int32Array(le)}function A(le,be){for(var we=[],oe=0;oe<le;oe++)we.push(new be);return we}function r(le,be){var we=[];return function oe(me,Le,Se){for(var Me=Se[Le],Re=0;Re<Me&&(me.push(Se.length>Le+1?[]:new be),!(Se.length<Le+1));Re++)oe(me[Re],Le+1,Se)}(we,0,le),we}var y=function(){var le=this;function be(D,K){for(var se=1<<K-1>>>0;D&se;)se>>>=1;return se?(D&se-1)+se:D}function we(D,K,se,xe,Oe){e(!(xe%se));do D[K+(xe-=se)]=Oe;while(0<xe)}function oe(D,K,se,xe,Oe){if(e(2328>=Oe),512>=Oe)var Ke=h(512);else if((Ke=h(Oe))==null)return 0;return function(et,st,dt,wt,Xt,xi){var Bi,ci,Hi=st,Ni=1<<dt,Zt=h(16),ei=h(16);for(e(Xt!=0),e(wt!=null),e(et!=null),e(0<dt),ci=0;ci<Xt;++ci){if(15<wt[ci])return 0;++Zt[wt[ci]]}if(Zt[0]==Xt)return 0;for(ei[1]=0,Bi=1;15>Bi;++Bi){if(Zt[Bi]>1<<Bi)return 0;ei[Bi+1]=ei[Bi]+Zt[Bi]}for(ci=0;ci<Xt;++ci)Bi=wt[ci],0<wt[ci]&&(xi[ei[Bi]++]=ci);if(ei[15]==1)return(wt=new me).g=0,wt.value=xi[0],we(et,Hi,1,Ni,wt),Ni;var qi,cr=-1,$i=Ni-1,Xr=0,Tr=1,wn=1,zr=1<<dt;for(ci=0,Bi=1,Xt=2;Bi<=dt;++Bi,Xt<<=1){if(Tr+=wn<<=1,0>(wn-=Zt[Bi]))return 0;for(;0<Zt[Bi];--Zt[Bi])(wt=new me).g=Bi,wt.value=xi[ci++],we(et,Hi+Xr,Xt,zr,wt),Xr=be(Xr,Bi)}for(Bi=dt+1,Xt=2;15>=Bi;++Bi,Xt<<=1){if(Tr+=wn<<=1,0>(wn-=Zt[Bi]))return 0;for(;0<Zt[Bi];--Zt[Bi]){if(wt=new me,(Xr&$i)!=cr){for(Hi+=zr,qi=1<<(cr=Bi)-dt;15>cr&&!(0>=(qi-=Zt[cr]));)++cr,qi<<=1;Ni+=zr=1<<(qi=cr-dt),et[st+(cr=Xr&$i)].g=qi+dt,et[st+cr].value=Hi-st-cr}wt.g=Bi-dt,wt.value=xi[ci++],we(et,Hi+(Xr>>dt),Xt,zr,wt),Xr=be(Xr,Bi)}}return Tr!=2*ei[15]-1?0:Ni}(D,K,se,xe,Oe,Ke)}function me(){this.value=this.g=0}function Le(){this.value=this.g=0}function Se(){this.G=A(5,me),this.H=h(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=A(Yo,Le)}function Me(D,K,se,xe){e(D!=null),e(K!=null),e(2147483648>xe),D.Ca=254,D.I=0,D.b=-8,D.Ka=0,D.oa=K,D.pa=se,D.Jd=K,D.Yc=se+xe,D.Zc=4<=xe?se+xe-4+1:se,rt(D)}function Re(D,K){for(var se=0;0<K--;)se|=vt(D,128)<<K;return se}function Ze(D,K){var se=Re(D,K);return St(D)?-se:se}function $e(D,K,se,xe){var Oe,Ke=0;for(e(D!=null),e(K!=null),e(4294967288>xe),D.Sb=xe,D.Ra=0,D.u=0,D.h=0,4<xe&&(xe=4),Oe=0;Oe<xe;++Oe)Ke+=K[se+Oe]<<8*Oe;D.Ra=Ke,D.bb=xe,D.oa=K,D.pa=se}function ct(D){for(;8<=D.u&&D.bb<D.Sb;)D.Ra>>>=8,D.Ra+=D.oa[D.pa+D.bb]<<Sc-8>>>0,++D.bb,D.u-=8;lt(D)&&(D.h=1,D.u=0)}function Qe(D,K){if(e(0<=K),!D.h&&K<=Ko){var se=Je(D)&is[K];return D.u+=K,ct(D),se}return D.h=1,D.u=0}function It(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ce(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Je(D){return D.Ra>>>(D.u&Sc-1)>>>0}function lt(D){return e(D.bb<=D.Sb),D.h||D.bb==D.Sb&&D.u>Sc}function mt(D,K){D.u=K,D.h=lt(D)}function Bt(D){D.u>=Io&&(e(D.u>=Io),ct(D))}function rt(D){e(D!=null&&D.oa!=null),D.pa<D.Zc?(D.I=(D.oa[D.pa++]|D.I<<8)>>>0,D.b+=8):(e(D!=null&&D.oa!=null),D.pa<D.Yc?(D.b+=8,D.I=D.oa[D.pa++]|D.I<<8):D.Ka?D.b=0:(D.I<<=8,D.b+=8,D.Ka=1))}function St(D){return Re(D,1)}function vt(D,K){var se=D.Ca;0>D.b&&rt(D);var xe=D.b,Oe=se*K>>>8,Ke=(D.I>>>xe>Oe)+0;for(Ke?(se-=Oe,D.I-=Oe+1<<xe>>>0):se=Oe+1,xe=se,Oe=0;256<=xe;)Oe+=8,xe>>=8;return xe=7^Oe+Ua[xe],D.b-=xe,D.Ca=(se<<xe)-1,Ke}function Gt(D,K,se){D[K+0]=se>>24&255,D[K+1]=se>>16&255,D[K+2]=se>>8&255,D[K+3]=se>>0&255}function mi(D,K){return D[K+0]<<0|D[K+1]<<8}function ze(D,K){return mi(D,K)|D[K+2]<<16}function Ve(D,K){return mi(D,K)|mi(D,K+2)<<16}function kt(D,K){var se=1<<K;return e(D!=null),e(0<K),D.X=h(se),D.X==null?0:(D.Mb=32-K,D.Xa=K,1)}function Ft(D,K){e(D!=null),e(K!=null),e(D.Xa==K.Xa),s(K.X,0,D.X,0,1<<K.Xa)}function it(){this.X=[],this.Xa=this.Mb=0}function yi(D,K,se,xe){e(se!=null),e(xe!=null);var Oe=se[0],Ke=xe[0];return Oe==0&&(Oe=(D*Ke+K/2)/K),Ke==0&&(Ke=(K*Oe+D/2)/D),0>=Oe||0>=Ke?0:(se[0]=Oe,xe[0]=Ke,1)}function bi(D,K){return D+(1<<K)-1>>>K}function Kt(D,K){return((4278255360&D)+(4278255360&K)>>>0&4278255360)+((16711935&D)+(16711935&K)>>>0&16711935)>>>0}function di(D,K){le[K]=function(se,xe,Oe,Ke,et,st,dt){var wt;for(wt=0;wt<et;++wt){var Xt=le[D](st[dt+wt-1],Oe,Ke+wt);st[dt+wt]=Kt(se[xe+wt],Xt)}}}function fi(){this.ud=this.hd=this.jd=0}function Ri(D,K){return((4278124286&(D^K))>>>1)+(D&K)>>>0}function Oi(D){return 0<=D&&256>D?D:0>D?0:255<D?255:void 0}function Ji(D,K){return Oi(D+(D-K+.5>>1))}function lr(D,K,se){return Math.abs(K-se)-Math.abs(D-se)}function br(D,K,se,xe,Oe,Ke,et){for(xe=Ke[et-1],se=0;se<Oe;++se)Ke[et+se]=xe=Kt(D[K+se],xe)}function Dr(D,K,se,xe,Oe){var Ke;for(Ke=0;Ke<se;++Ke){var et=D[K+Ke],st=et>>8&255,dt=16711935&(dt=(dt=16711935&et)+((st<<16)+st));xe[Oe+Ke]=(4278255360&et)+dt>>>0}}function Fr(D,K){K.jd=D>>0&255,K.hd=D>>8&255,K.ud=D>>16&255}function Qr(D,K,se,xe,Oe,Ke){var et;for(et=0;et<xe;++et){var st=K[se+et],dt=st>>>8,wt=st,Xt=255&(Xt=(Xt=st>>>16)+((D.jd<<24>>24)*(dt<<24>>24)>>>5));wt=255&(wt=(wt=wt+((D.hd<<24>>24)*(dt<<24>>24)>>>5))+((D.ud<<24>>24)*(Xt<<24>>24)>>>5)),Oe[Ke+et]=(4278255360&st)+(Xt<<16)+wt}}function ui(D,K,se,xe,Oe){le[K]=function(Ke,et,st,dt,wt,Xt,xi,Bi,ci){for(dt=xi;dt<Bi;++dt)for(xi=0;xi<ci;++xi)wt[Xt++]=Oe(st[xe(Ke[et++])])},le[D]=function(Ke,et,st,dt,wt,Xt,xi){var Bi=8>>Ke.b,ci=Ke.Ea,Hi=Ke.K[0],Ni=Ke.w;if(8>Bi)for(Ke=(1<<Ke.b)-1,Ni=(1<<Bi)-1;et<st;++et){var Zt,ei=0;for(Zt=0;Zt<ci;++Zt)Zt&Ke||(ei=xe(dt[wt++])),Xt[xi++]=Oe(Hi[ei&Ni]),ei>>=Bi}else le["VP8LMapColor"+se](dt,wt,Hi,Ni,Xt,xi,et,st,ci)}}function li(D,K,se,xe,Oe){for(se=K+se;K<se;){var Ke=D[K++];xe[Oe++]=Ke>>16&255,xe[Oe++]=Ke>>8&255,xe[Oe++]=Ke>>0&255}}function Vi(D,K,se,xe,Oe){for(se=K+se;K<se;){var Ke=D[K++];xe[Oe++]=Ke>>16&255,xe[Oe++]=Ke>>8&255,xe[Oe++]=Ke>>0&255,xe[Oe++]=Ke>>24&255}}function rr(D,K,se,xe,Oe){for(se=K+se;K<se;){var Ke=(et=D[K++])>>16&240|et>>12&15,et=et>>0&240|et>>28&15;xe[Oe++]=Ke,xe[Oe++]=et}}function qr(D,K,se,xe,Oe){for(se=K+se;K<se;){var Ke=(et=D[K++])>>16&248|et>>13&7,et=et>>5&224|et>>3&31;xe[Oe++]=Ke,xe[Oe++]=et}}function _r(D,K,se,xe,Oe){for(se=K+se;K<se;){var Ke=D[K++];xe[Oe++]=Ke>>0&255,xe[Oe++]=Ke>>8&255,xe[Oe++]=Ke>>16&255}}function Zr(D,K,se,xe,Oe,Ke){if(Ke==0)for(se=K+se;K<se;)Gt(xe,((Ke=D[K++])[0]>>24|Ke[1]>>8&65280|Ke[2]<<8&16711680|Ke[3]<<24)>>>0),Oe+=32;else s(xe,Oe,D,K,se)}function io(D,K){le[K][0]=le[D+"0"],le[K][1]=le[D+"1"],le[K][2]=le[D+"2"],le[K][3]=le[D+"3"],le[K][4]=le[D+"4"],le[K][5]=le[D+"5"],le[K][6]=le[D+"6"],le[K][7]=le[D+"7"],le[K][8]=le[D+"8"],le[K][9]=le[D+"9"],le[K][10]=le[D+"10"],le[K][11]=le[D+"11"],le[K][12]=le[D+"12"],le[K][13]=le[D+"13"],le[K][14]=le[D+"0"],le[K][15]=le[D+"0"]}function Ur(D){return D==$A||D==ZA||D==nA||D==yh}function ia(){this.eb=[],this.size=this.A=this.fb=0}function ps(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ro(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ia,this.f.kb=new ps,this.sd=null}function Qn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function yr(D){return alert("todo:WebPSamplerProcessPlane"),D.T}function qt(D,K){var se=D.T,xe=K.ba.f.RGBA,Oe=xe.eb,Ke=xe.fb+D.ka*xe.A,et=Ba[K.ba.S],st=D.y,dt=D.O,wt=D.f,Xt=D.N,xi=D.ea,Bi=D.W,ci=K.cc,Hi=K.dc,Ni=K.Mc,Zt=K.Nc,ei=D.ka,qi=D.ka+D.T,cr=D.U,$i=cr+1>>1;for(ei==0?et(st,dt,null,null,wt,Xt,xi,Bi,wt,Xt,xi,Bi,Oe,Ke,null,null,cr):(et(K.ec,K.fc,st,dt,ci,Hi,Ni,Zt,wt,Xt,xi,Bi,Oe,Ke-xe.A,Oe,Ke,cr),++se);ei+2<qi;ei+=2)ci=wt,Hi=Xt,Ni=xi,Zt=Bi,Xt+=D.Rc,Bi+=D.Rc,Ke+=2*xe.A,et(st,(dt+=2*D.fa)-D.fa,st,dt,ci,Hi,Ni,Zt,wt,Xt,xi,Bi,Oe,Ke-xe.A,Oe,Ke,cr);return dt+=D.fa,D.j+qi<D.o?(s(K.ec,K.fc,st,dt,cr),s(K.cc,K.dc,wt,Xt,$i),s(K.Mc,K.Nc,xi,Bi,$i),se--):1&qi||et(st,dt,null,null,wt,Xt,xi,Bi,wt,Xt,xi,Bi,Oe,Ke+xe.A,null,null,cr),se}function Vn(D,K,se){var xe=D.F,Oe=[D.J];if(xe!=null){var Ke=D.U,et=K.ba.S,st=et==hd||et==nA;K=K.ba.f.RGBA;var dt=[0],wt=D.ka;dt[0]=D.T,D.Kb&&(wt==0?--dt[0]:(--wt,Oe[0]-=D.width),D.j+D.ka+D.T==D.o&&(dt[0]=D.o-D.j-wt));var Xt=K.eb;wt=K.fb+wt*K.A,D=no(xe,Oe[0],D.width,Ke,dt,Xt,wt+(st?0:3),K.A),e(se==dt),D&&Ur(et)&&tl(Xt,wt,st,Ke,dt,K.A)}return 0}function xs(D){var K=D.ma,se=K.ba.S,xe=11>se,Oe=se==gh||se==Is||se==hd||se==Hu||se==12||Ur(se);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!_o(K.Oa,D,Oe?11:12))return 0;if(Oe&&Ur(se)&&mr(),D.da)alert("todo:use_scaling");else{if(xe){if(K.Ib=yr,D.Kb){if(se=D.U+1>>1,K.memory=h(D.U+2*se),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+D.U,K.Mc=K.cc,K.Nc=K.dc+se,K.Ib=qt,mr()}}else alert("todo:EmitYUV");Oe&&(K.Jb=Vn,xe&&hi())}if(xe&&!Gu){for(D=0;256>D;++D)jf[D]=89858*(D-128)+Xh>>Fc,fd[D]=-22014*(D-128)+Xh,AA[D]=-45773*(D-128),Wl[D]=113618*(D-128)+Xh>>Fc;for(D=Kc;D<tf;++D)K=76283*(D-16)+Xh>>Fc,fA[D-Kc]=ji(K,255),rf[D-Kc]=ji(K+8>>4,15);Gu=1}return 1}function ra(D){var K=D.ma,se=D.U,xe=D.T;return e(!(1&D.ka)),0>=se||0>=xe?0:(se=K.Ib(D,K),K.Jb!=null&&K.Jb(D,K,se),K.Dc+=se,1)}function dn(D){D.ma.memory=null}function Et(D,K,se,xe){return Qe(D,8)!=47?0:(K[0]=Qe(D,14)+1,se[0]=Qe(D,14)+1,xe[0]=Qe(D,1),Qe(D,3)!=0?0:!D.h)}function ye(D,K){if(4>D)return D+1;var se=D-2>>1;return(2+(1&D)<<se)+Qe(K,se)+1}function Ee(D,K){return 120<K?K-120:1<=(se=((se=oA[K-1])>>4)*D+(8-(15&se)))?se:1;var se}function He(D,K,se){var xe=Je(se),Oe=D[K+=255&xe].g-8;return 0<Oe&&(mt(se,se.u+8),xe=Je(se),K+=D[K].value,K+=xe&(1<<Oe)-1),mt(se,se.u+D[K].g),D[K].value}function tt(D,K,se){return se.g+=D.g,se.value+=D.value<<K>>>0,e(8>=se.g),D.g}function Ye(D,K,se){var xe=D.xc;return e((K=xe==0?0:D.vc[D.md*(se>>xe)+(K>>xe)])<D.Wb),D.Ya[K]}function xt(D,K,se,xe){var Oe=D.ab,Ke=D.c*K,et=D.C;K=et+K;var st=se,dt=xe;for(xe=D.Ta,se=D.Ua;0<Oe--;){var wt=D.gc[Oe],Xt=et,xi=K,Bi=st,ci=dt,Hi=(dt=xe,st=se,wt.Ea);switch(e(Xt<xi),e(xi<=wt.nc),wt.hc){case 2:_u(Bi,ci,(xi-Xt)*Hi,dt,st);break;case 0:var Ni=Xt,Zt=xi,ei=dt,qi=st,cr=(zr=wt).Ea;Ni==0&&(cl(Bi,ci,null,null,1,ei,qi),br(Bi,ci+1,0,0,cr-1,ei,qi+1),ci+=cr,qi+=cr,++Ni);for(var $i=1<<zr.b,Xr=$i-1,Tr=bi(cr,zr.b),wn=zr.K,zr=zr.w+(Ni>>zr.b)*Tr;Ni<Zt;){var Ms=wn,Vs=zr,Ps=1;for(qo(Bi,ci,ei,qi-cr,1,ei,qi);Ps<cr;){var Ar=(Ps&~Xr)+$i;Ar>cr&&(Ar=cr),(0,oa[Ms[Vs++]>>8&15])(Bi,ci+ +Ps,ei,qi+Ps-cr,Ar-Ps,ei,qi+Ps),Ps=Ar}ci+=cr,qi+=cr,++Ni&Xr||(zr+=Tr)}xi!=wt.nc&&s(dt,st-Hi,dt,st+(xi-Xt-1)*Hi,Hi);break;case 1:for(Hi=Bi,Zt=ci,cr=(Bi=wt.Ea)-(qi=Bi&~(ei=(ci=1<<wt.b)-1)),Ni=bi(Bi,wt.b),$i=wt.K,wt=wt.w+(Xt>>wt.b)*Ni;Xt<xi;){for(Xr=$i,Tr=wt,wn=new fi,zr=Zt+qi,Ms=Zt+Bi;Zt<zr;)Fr(Xr[Tr++],wn),Nl(wn,Hi,Zt,ci,dt,st),Zt+=ci,st+=ci;Zt<Ms&&(Fr(Xr[Tr++],wn),Nl(wn,Hi,Zt,cr,dt,st),Zt+=cr,st+=cr),++Xt&ei||(wt+=Ni)}break;case 3:if(Bi==dt&&ci==st&&0<wt.b){for(Zt=dt,Bi=Hi=st+(xi-Xt)*Hi-(qi=(xi-Xt)*bi(wt.Ea,wt.b)),ci=dt,ei=st,Ni=[],qi=(cr=qi)-1;0<=qi;--qi)Ni[qi]=ci[ei+qi];for(qi=cr-1;0<=qi;--qi)Zt[Bi+qi]=Ni[qi];jo(wt,Xt,xi,dt,Hi,dt,st)}else jo(wt,Xt,xi,Bi,ci,dt,st)}st=xe,dt=se}dt!=se&&s(xe,se,st,dt,Ke)}function Dt(D,K){var se=D.V,xe=D.Ba+D.c*D.C,Oe=K-D.C;if(e(K<=D.l.o),e(16>=Oe),0<Oe){var Ke=D.l,et=D.Ta,st=D.Ua,dt=Ke.width;if(xt(D,Oe,se,xe),Oe=st=[st],e((se=D.C)<(xe=K)),e(Ke.v<Ke.va),xe>Ke.o&&(xe=Ke.o),se<Ke.j){var wt=Ke.j-se;se=Ke.j,Oe[0]+=wt*dt}if(se>=xe?se=0:(Oe[0]+=4*Ke.v,Ke.ka=se-Ke.j,Ke.U=Ke.va-Ke.v,Ke.T=xe-se,se=1),se){if(st=st[0],11>(se=D.ca).S){var Xt=se.f.RGBA,xi=(xe=se.S,Oe=Ke.U,Ke=Ke.T,wt=Xt.eb,Xt.A),Bi=Ke;for(Xt=Xt.fb+D.Ma*Xt.A;0<Bi--;){var ci=et,Hi=st,Ni=Oe,Zt=wt,ei=Xt;switch(xe){case rA:Ja(ci,Hi,Ni,Zt,ei);break;case gh:pa(ci,Hi,Ni,Zt,ei);break;case $A:pa(ci,Hi,Ni,Zt,ei),tl(Zt,ei,0,Ni,1,0);break;case mh:jl(ci,Hi,Ni,Zt,ei);break;case Is:Zr(ci,Hi,Ni,Zt,ei,1);break;case ZA:Zr(ci,Hi,Ni,Zt,ei,1),tl(Zt,ei,0,Ni,1,0);break;case hd:Zr(ci,Hi,Ni,Zt,ei,0);break;case nA:Zr(ci,Hi,Ni,Zt,ei,0),tl(Zt,ei,1,Ni,1,0);break;case Hu:Ec(ci,Hi,Ni,Zt,ei);break;case yh:Ec(ci,Hi,Ni,Zt,ei),wi(Zt,ei,Ni,1,0);break;case Pf:za(ci,Hi,Ni,Zt,ei);break;default:e(0)}st+=dt,Xt+=xi}D.Ma+=Ke}else alert("todo:EmitRescaledRowsYUVA");e(D.Ma<=se.height)}}D.C=K,e(D.C<=D.i)}function bt(D){var K;if(0<D.ua)return 0;for(K=0;K<D.Wb;++K){var se=D.Ya[K].G,xe=D.Ya[K].H;if(0<se[1][xe[1]+0].g||0<se[2][xe[2]+0].g||0<se[3][xe[3]+0].g)return 0}return 1}function Ut(D,K,se,xe,Oe,Ke){if(D.Z!=0){var et=D.qd,st=D.rd;for(e(Yc[D.Z]!=null);K<se;++K)Yc[D.Z](et,st,xe,Oe,xe,Oe,Ke),et=xe,st=Oe,Oe+=Ke;D.qd=et,D.rd=st}}function ii(D,K){var se=D.l.ma,xe=se.Z==0||se.Z==1?D.l.j:D.C;if(xe=D.C<xe?xe:D.C,e(K<=D.l.o),K>xe){var Oe=D.l.width,Ke=se.ca,et=se.tb+Oe*xe,st=D.V,dt=D.Ba+D.c*xe,wt=D.gc;e(D.ab==1),e(wt[0].hc==3),Fa(wt[0],xe,K,st,dt,Ke,et),Ut(se,xe,K,Ke,et,Oe)}D.C=D.Ma=K}function Nt(D,K,se,xe,Oe,Ke,et){var st=D.$/xe,dt=D.$%xe,wt=D.m,Xt=D.s,xi=se+D.$,Bi=xi;Oe=se+xe*Oe;var ci=se+xe*Ke,Hi=280+Xt.ua,Ni=D.Pb?st:16777216,Zt=0<Xt.ua?Xt.Wa:null,ei=Xt.wc,qi=xi<ci?Ye(Xt,dt,st):null;e(D.C<Ke),e(ci<=Oe);var cr=!1;e:for(;;){for(;cr||xi<ci;){var $i=0;if(st>=Ni){var Xr=xi-se;e((Ni=D).Pb),Ni.wd=Ni.m,Ni.xd=Xr,0<Ni.s.ua&&Ft(Ni.s.Wa,Ni.s.vb),Ni=st+vh}if(dt&ei||(qi=Ye(Xt,dt,st)),e(qi!=null),qi.Qb&&(K[xi]=qi.qb,cr=!0),!cr)if(Bt(wt),qi.jc){$i=wt,Xr=K;var Tr=xi,wn=qi.pd[Je($i)&Yo-1];e(qi.jc),256>wn.g?(mt($i,$i.u+wn.g),Xr[Tr]=wn.value,$i=0):(mt($i,$i.u+wn.g-256),e(256<=wn.value),$i=wn.value),$i==0&&(cr=!0)}else $i=He(qi.G[0],qi.H[0],wt);if(wt.h)break;if(cr||256>$i){if(!cr)if(qi.nd)K[xi]=(qi.qb|$i<<8)>>>0;else{if(Bt(wt),cr=He(qi.G[1],qi.H[1],wt),Bt(wt),Xr=He(qi.G[2],qi.H[2],wt),Tr=He(qi.G[3],qi.H[3],wt),wt.h)break;K[xi]=(Tr<<24|cr<<16|$i<<8|Xr)>>>0}if(cr=!1,++xi,++dt>=xe&&(dt=0,++st,et!=null&&st<=Ke&&!(st%16)&&et(D,st),Zt!=null))for(;Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i}else if(280>$i){if($i=ye($i-256,wt),Xr=He(qi.G[4],qi.H[4],wt),Bt(wt),Xr=Ee(xe,Xr=ye(Xr,wt)),wt.h)break;if(xi-se<Xr||Oe-xi<$i)break e;for(Tr=0;Tr<$i;++Tr)K[xi+Tr]=K[xi+Tr-Xr];for(xi+=$i,dt+=$i;dt>=xe;)dt-=xe,++st,et!=null&&st<=Ke&&!(st%16)&&et(D,st);if(e(xi<=Oe),dt&ei&&(qi=Ye(Xt,dt,st)),Zt!=null)for(;Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i}else{if(!($i<Hi))break e;for(cr=$i-280,e(Zt!=null);Bi<xi;)$i=K[Bi++],Zt.X[(506832829*$i&4294967295)>>>Zt.Mb]=$i;$i=xi,e(!(cr>>>(Xr=Zt).Xa)),K[$i]=Xr.X[cr],cr=!0}cr||e(wt.h==lt(wt))}if(D.Pb&&wt.h&&xi<Oe)e(D.m.h),D.a=5,D.m=D.wd,D.$=D.xd,0<D.s.ua&&Ft(D.s.vb,D.s.Wa);else{if(wt.h)break e;et!=null&&et(D,st>Ke?Ke:st),D.a=0,D.$=xi-se}return 1}return D.a=3,0}function Fi(D){e(D!=null),D.vc=null,D.yc=null,D.Ya=null;var K=D.Wa;K!=null&&(K.X=null),D.vb=null,e(D!=null)}function er(){var D=new Nu;return D==null?null:(D.a=0,D.xb=ef,io("Predictor","VP8LPredictors"),io("Predictor","VP8LPredictors_C"),io("PredictorAdd","VP8LPredictorsAdd"),io("PredictorAdd","VP8LPredictorsAdd_C"),_u=Dr,Nl=Qr,Ja=li,pa=Vi,Ec=rr,za=qr,jl=_r,le.VP8LMapColor32b=zl,le.VP8LMapColor8b=xo,D)}function nr(D,K,se,xe,Oe){var Ke=1,et=[D],st=[K],dt=xe.m,wt=xe.s,Xt=null,xi=0;e:for(;;){if(se)for(;Ke&&Qe(dt,1);){var Bi=et,ci=st,Hi=xe,Ni=1,Zt=Hi.m,ei=Hi.gc[Hi.ab],qi=Qe(Zt,2);if(Hi.Oc&1<<qi)Ke=0;else{switch(Hi.Oc|=1<<qi,ei.hc=qi,ei.Ea=Bi[0],ei.nc=ci[0],ei.K=[null],++Hi.ab,e(4>=Hi.ab),qi){case 0:case 1:ei.b=Qe(Zt,3)+2,Ni=nr(bi(ei.Ea,ei.b),bi(ei.nc,ei.b),0,Hi,ei.K),ei.K=ei.K[0];break;case 3:var cr,$i=Qe(Zt,8)+1,Xr=16<$i?0:4<$i?1:2<$i?2:3;if(Bi[0]=bi(ei.Ea,Xr),ei.b=Xr,cr=Ni=nr($i,1,0,Hi,ei.K)){var Tr,wn=$i,zr=ei,Ms=1<<(8>>zr.b),Vs=h(Ms);if(Vs==null)cr=0;else{var Ps=zr.K[0],Ar=zr.w;for(Vs[0]=zr.K[0][0],Tr=1;Tr<1*wn;++Tr)Vs[Tr]=Kt(Ps[Ar+Tr],Vs[Tr-1]);for(;Tr<4*Ms;++Tr)Vs[Tr]=0;zr.K[0]=null,zr.K[0]=Vs,cr=1}}Ni=cr;break;case 2:break;default:e(0)}Ke=Ni}}if(et=et[0],st=st[0],Ke&&Qe(dt,1)&&!(Ke=1<=(xi=Qe(dt,4))&&11>=xi)){xe.a=3;break e}var ys;if(ys=Ke)t:{var co,Kn,$s,Tl=xe,wo=et,aa=st,cs=xi,ja=se,Ha=Tl.m,Ca=Tl.s,uo=[null],Zo=1,Qa=0,cc=JA[cs];i:for(;;){if(ja&&Qe(Ha,1)){var la=Qe(Ha,3)+2,Va=bi(wo,la),Ga=bi(aa,la),Zi=Va*Ga;if(!nr(Va,Ga,0,Tl,uo))break i;for(uo=uo[0],Ca.xc=la,co=0;co<Zi;++co){var Su=uo[co]>>8&65535;uo[co]=Su,Su>=Zo&&(Zo=Su+1)}}if(Ha.h)break i;for(Kn=0;5>Kn;++Kn){var Qo=kf[Kn];!Kn&&0<cs&&(Qo+=1<<cs),Qa<Qo&&(Qa=Qo)}var qc=A(Zo*cc,me),Eu=Zo,Br=A(Eu,Se);if(Br==null)var Wu=null;else e(65536>=Eu),Wu=Br;var gd=h(Qa);if(Wu==null||gd==null||qc==null){Tl.a=1;break i}var md=qc;for(co=$s=0;co<Zo;++co){var Xl=Wu[co],wh=Xl.G,Yh=Xl.H,mA=0,yA=1,yd=0;for(Kn=0;5>Kn;++Kn){Qo=kf[Kn],wh[Kn]=md,Yh[Kn]=$s,!Kn&&0<cs&&(Qo+=1<<cs);n:{var Wa,Bh=Qo,ca=Tl,Fl=gd,Xu=md,vA=$s,Ch=0,hl=ca.m,_A=Qe(hl,1);if(c(Fl,0,0,Bh),_A){var $c=Qe(hl,1)+1,$n=Qe(hl,1),Sh=Qe(hl,$n==0?1:8);Fl[Sh]=1,$c==2&&(Fl[Sh=Qe(hl,8)]=1);var uc=1}else{var vd=h(19),nf=Qe(hl,4)+4;if(19<nf){ca.a=3;var _d=0;break n}for(Wa=0;Wa<nf;++Wa)vd[Vh[Wa]]=Qe(hl,3);var sf=void 0,ua=void 0,Zc=ca,Ei=vd,Gi=Bh,Yu=Fl,Ns=0,Lt=Zc.m,hc=8,xd=A(128,me);r:for(;oe(xd,0,7,Ei,19);){if(Qe(Lt,1)){var xA=2+2*Qe(Lt,3);if((sf=2+Qe(Lt,xA))>Gi)break r}else sf=Gi;for(ua=0;ua<Gi&&sf--;){Bt(Lt);var bA=xd[0+(127&Je(Lt))];mt(Lt,Lt.u+bA.g);var Ku=bA.value;if(16>Ku)Yu[ua++]=Ku,Ku!=0&&(hc=Ku);else{var Hf=Ku==16,Iu=Ku-16,Qf=sA[Iu],Pa=Qe(Lt,Rp[Iu])+Qf;if(ua+Pa>Gi)break r;for(var Kh=Hf?hc:0;0<Pa--;)Yu[ua++]=Kh}}Ns=1;break r}Ns||(Zc.a=3),uc=Ns}(uc=uc&&!hl.h)&&(Ch=oe(Xu,vA,8,Fl,Bh)),uc&&Ch!=0?_d=Ch:(ca.a=3,_d=0)}if(_d==0)break i;if(yA&&Rf[Kn]==1&&(yA=md[$s].g==0),mA+=md[$s].g,$s+=_d,3>=Kn){var qu,bd=gd[0];for(qu=1;qu<Qo;++qu)gd[qu]>bd&&(bd=gd[qu]);yd+=bd}}if(Xl.nd=yA,Xl.Qb=0,yA&&(Xl.qb=(wh[3][Yh[3]+0].value<<24|wh[1][Yh[1]+0].value<<16|wh[2][Yh[2]+0].value)>>>0,mA==0&&256>wh[0][Yh[0]+0].value&&(Xl.Qb=1,Xl.qb+=wh[0][Yh[0]+0].value<<8)),Xl.jc=!Xl.Qb&&6>yd,Xl.jc){var Eh,dc=Xl;for(Eh=0;Eh<Yo;++Eh){var Lc=Eh,Ac=dc.pd[Lc],Jc=dc.G[0][dc.H[0]+Lc];256<=Jc.value?(Ac.g=Jc.g+256,Ac.value=Jc.value):(Ac.g=0,Ac.value=0,Lc>>=tt(Jc,8,Ac),Lc>>=tt(dc.G[1][dc.H[1]+Lc],16,Ac),Lc>>=tt(dc.G[2][dc.H[2]+Lc],0,Ac),tt(dc.G[3][dc.H[3]+Lc],24,Ac))}}}Ca.vc=uo,Ca.Wb=Zo,Ca.Ya=Wu,Ca.yc=qc,ys=1;break t}ys=0}if(!(Ke=ys)){xe.a=3;break e}if(0<xi){if(wt.ua=1<<xi,!kt(wt.Wa,xi)){xe.a=1,Ke=0;break e}}else wt.ua=0;var wd=xe,Tu=et,Xa=st,of=wd.s,Ih=of.xc;if(wd.c=Tu,wd.i=Xa,of.md=bi(Tu,Ih),of.wc=Ih==0?-1:(1<<Ih)-1,se){xe.xb=Uf;break e}if((Xt=h(et*st))==null){xe.a=1,Ke=0;break e}Ke=(Ke=Nt(xe,Xt,0,et,st,st,null))&&!dt.h;break e}return Ke?(Oe!=null?Oe[0]=Xt:(e(Xt==null),e(se)),xe.$=0,se||Fi(wt)):Fi(wt),Ke}function Sr(D,K){var se=D.c*D.i,xe=se+K+16*K;return e(D.c<=K),D.V=h(xe),D.V==null?(D.Ta=null,D.Ua=0,D.a=1,0):(D.Ta=D.V,D.Ua=D.Ba+se+K,1)}function Mr(D,K){var se=D.C,xe=K-se,Oe=D.V,Ke=D.Ba+D.c*se;for(e(K<=D.l.o);0<xe;){var et=16<xe?16:xe,st=D.l.ma,dt=D.l.width,wt=dt*et,Xt=st.ca,xi=st.tb+dt*se,Bi=D.Ta,ci=D.Ua;xt(D,et,Oe,Ke),bo(Bi,ci,Xt,xi,wt),Ut(st,se,se+et,Xt,xi,dt),xe-=et,Oe+=et*D.c,se+=et}e(se==K),D.C=D.Ma=K}function jr(){this.ub=this.yd=this.td=this.Rb=0}function nn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Yr(){this.Fb=this.Bb=this.Cb=0,this.Zb=h(4),this.Lb=h(4)}function qn(){this.Yb=function(){var D=[];return function K(se,xe,Oe){for(var Ke=Oe[xe],et=0;et<Ke&&(se.push(Oe.length>xe+1?[]:0),!(Oe.length<xe+1));et++)K(se[et],xe+1,Oe)}(D,0,[3,11]),D}()}function gs(){this.jb=h(3),this.Wc=r([4,8],qn),this.Xc=r([4,17],qn)}function ms(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new h(4),this.od=new h(4)}function En(){this.ld=this.La=this.dd=this.tc=0}function In(){this.Na=this.la=0}function Ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function bs(){this.ad=h(384),this.Za=0,this.Ob=h(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function hs(){this.uc=this.M=this.Nb=0,this.wa=Array(new En),this.Y=0,this.ya=Array(new bs),this.aa=0,this.l=new So}function Uo(){this.y=h(16),this.f=h(8),this.ea=h(8)}function Da(){this.cb=this.a=0,this.sc="",this.m=new It,this.Od=new jr,this.Kc=new nn,this.ed=new ms,this.Qa=new Yr,this.Ic=this.$c=this.Aa=0,this.D=new hs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=A(8,It),this.ia=0,this.pb=A(4,Ls),this.Pa=new gs,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Uo),this.Hd=0,this.rb=Array(new In),this.sb=0,this.wa=Array(new En),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new bs),this.L=this.aa=0,this.gd=r([4,2],En),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function So(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function vc(){var D=new Da;return D!=null&&(D.a=0,D.sc="OK",D.cb=0,D.Xb=0,Vu||(Vu=xc)),D}function ds(D,K,se){return D.a==0&&(D.a=K,D.sc=se,D.cb=0),0}function _c(D,K,se){return 3<=se&&D[K+0]==157&&D[K+1]==1&&D[K+2]==42}function ch(D,K){if(D==null)return 0;if(D.a=0,D.sc="OK",K==null)return ds(D,2,"null VP8Io passed to VP8GetHeaders()");var se=K.data,xe=K.w,Oe=K.ha;if(4>Oe)return ds(D,7,"Truncated header.");var Ke=se[xe+0]|se[xe+1]<<8|se[xe+2]<<16,et=D.Od;if(et.Rb=!(1&Ke),et.td=Ke>>1&7,et.yd=Ke>>4&1,et.ub=Ke>>5,3<et.td)return ds(D,3,"Incorrect keyframe parameters.");if(!et.yd)return ds(D,4,"Frame not displayable.");xe+=3,Oe-=3;var st=D.Kc;if(et.Rb){if(7>Oe)return ds(D,7,"cannot parse picture header");if(!_c(se,xe,Oe))return ds(D,3,"Bad code word");st.c=16383&(se[xe+4]<<8|se[xe+3]),st.Td=se[xe+4]>>6,st.i=16383&(se[xe+6]<<8|se[xe+5]),st.Ud=se[xe+6]>>6,xe+=7,Oe-=7,D.za=st.c+15>>4,D.Ub=st.i+15>>4,K.width=st.c,K.height=st.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,c((Ke=D.Pa).jb,0,255,Ke.jb.length),e((Ke=D.Qa)!=null),Ke.Cb=0,Ke.Bb=0,Ke.Fb=1,c(Ke.Zb,0,0,Ke.Zb.length),c(Ke.Lb,0,0,Ke.Lb)}if(et.ub>Oe)return ds(D,7,"bad partition length");Me(Ke=D.m,se,xe,et.ub),xe+=et.ub,Oe-=et.ub,et.Rb&&(st.Ld=St(Ke),st.Kd=St(Ke)),st=D.Qa;var dt,wt=D.Pa;if(e(Ke!=null),e(st!=null),st.Cb=St(Ke),st.Cb){if(st.Bb=St(Ke),St(Ke)){for(st.Fb=St(Ke),dt=0;4>dt;++dt)st.Zb[dt]=St(Ke)?Ze(Ke,7):0;for(dt=0;4>dt;++dt)st.Lb[dt]=St(Ke)?Ze(Ke,6):0}if(st.Bb)for(dt=0;3>dt;++dt)wt.jb[dt]=St(Ke)?Re(Ke,8):255}else st.Bb=0;if(Ke.Ka)return ds(D,3,"cannot parse segment header");if((st=D.ed).zd=St(Ke),st.Tb=Re(Ke,6),st.wb=Re(Ke,3),st.Pc=St(Ke),st.Pc&&St(Ke)){for(wt=0;4>wt;++wt)St(Ke)&&(st.vd[wt]=Ze(Ke,6));for(wt=0;4>wt;++wt)St(Ke)&&(st.od[wt]=Ze(Ke,6))}if(D.L=st.Tb==0?0:st.zd?1:2,Ke.Ka)return ds(D,3,"cannot parse filter header");var Xt=Oe;if(Oe=dt=xe,xe=dt+Xt,st=Xt,D.Xb=(1<<Re(D.m,2))-1,Xt<3*(wt=D.Xb))se=7;else{for(dt+=3*wt,st-=3*wt,Xt=0;Xt<wt;++Xt){var xi=se[Oe+0]|se[Oe+1]<<8|se[Oe+2]<<16;xi>st&&(xi=st),Me(D.Jc[+Xt],se,dt,xi),dt+=xi,st-=xi,Oe+=3}Me(D.Jc[+wt],se,dt,st),se=dt<xe?0:5}if(se!=0)return ds(D,se,"cannot parse partitions");for(se=Re(dt=D.m,7),Oe=St(dt)?Ze(dt,4):0,xe=St(dt)?Ze(dt,4):0,st=St(dt)?Ze(dt,4):0,wt=St(dt)?Ze(dt,4):0,dt=St(dt)?Ze(dt,4):0,Xt=D.Qa,xi=0;4>xi;++xi){if(Xt.Cb){var Bi=Xt.Zb[xi];Xt.Fb||(Bi+=se)}else{if(0<xi){D.pb[xi]=D.pb[0];continue}Bi=se}var ci=D.pb[xi];ci.Sc[0]=Qu[ji(Bi+Oe,127)],ci.Sc[1]=Cu[ji(Bi+0,127)],ci.Eb[0]=2*Qu[ji(Bi+xe,127)],ci.Eb[1]=101581*Cu[ji(Bi+st,127)]>>16,8>ci.Eb[1]&&(ci.Eb[1]=8),ci.Qc[0]=Qu[ji(Bi+wt,117)],ci.Qc[1]=Cu[ji(Bi+dt,127)],ci.lc=Bi+dt}if(!et.Rb)return ds(D,4,"Not a key frame.");for(St(Ke),et=D.Pa,se=0;4>se;++se){for(Oe=0;8>Oe;++Oe)for(xe=0;3>xe;++xe)for(st=0;11>st;++st)wt=vt(Ke,lA[se][Oe][xe][st])?Re(Ke,8):Of[se][Oe][xe][st],et.Wc[se][Oe].Yb[xe][st]=wt;for(Oe=0;17>Oe;++Oe)et.Xc[se][Oe]=et.Wc[se][cA[Oe]]}return D.kc=St(Ke),D.kc&&(D.Bd=Re(Ke,8)),D.cb=1}function xc(D,K,se,xe,Oe,Ke,et){var st=K[Oe].Yb[se];for(se=0;16>Oe;++Oe){if(!vt(D,st[se+0]))return Oe;for(;!vt(D,st[se+1]);)if(st=K[++Oe].Yb[0],se=0,Oe==16)return 16;var dt=K[Oe+1].Yb;if(vt(D,st[se+2])){var wt=D,Xt=0;if(vt(wt,(Bi=st)[(xi=se)+3]))if(vt(wt,Bi[xi+6])){for(st=0,xi=2*(Xt=vt(wt,Bi[xi+8]))+(Bi=vt(wt,Bi[xi+9+Xt])),Xt=0,Bi=Gh[xi];Bi[st];++st)Xt+=Xt+vt(wt,Bi[st]);Xt+=3+(8<<xi)}else vt(wt,Bi[xi+7])?(Xt=7+2*vt(wt,165),Xt+=vt(wt,145)):Xt=5+vt(wt,159);else Xt=vt(wt,Bi[xi+4])?3+vt(wt,Bi[xi+5]):2;st=dt[2]}else Xt=1,st=dt[1];dt=et+Df[Oe],0>(wt=D).b&&rt(wt);var xi,Bi=wt.b,ci=(xi=wt.Ca>>1)-(wt.I>>Bi)>>31;--wt.b,wt.Ca+=ci,wt.Ca|=1,wt.I-=(xi+1&ci)<<Bi,Ke[dt]=((Xt^ci)-ci)*xe[(0<Oe)+0]}return 16}function ec(D){var K=D.rb[D.sb-1];K.la=0,K.Na=0,c(D.zc,0,0,D.zc.length),D.ja=0}function Nc(D,K){if(D==null)return 0;if(K==null)return ds(D,2,"NULL VP8Io parameter in VP8Decode().");if(!D.cb&&!ch(D,K))return 0;if(e(D.cb),K.ac==null||K.ac(K)){K.ob&&(D.L=0);var se=xh[D.L];if(D.L==2?(D.yb=0,D.zb=0):(D.yb=K.v-se>>4,D.zb=K.j-se>>4,0>D.yb&&(D.yb=0),0>D.zb&&(D.zb=0)),D.Va=K.o+15+se>>4,D.Hb=K.va+15+se>>4,D.Hb>D.za&&(D.Hb=D.za),D.Va>D.Ub&&(D.Va=D.Ub),0<D.L){var xe=D.ed;for(se=0;4>se;++se){var Oe;if(D.Qa.Cb){var Ke=D.Qa.Lb[se];D.Qa.Fb||(Ke+=xe.Tb)}else Ke=xe.Tb;for(Oe=0;1>=Oe;++Oe){var et=D.gd[se][Oe],st=Ke;if(xe.Pc&&(st+=xe.vd[0],Oe&&(st+=xe.od[0])),0<(st=0>st?0:63<st?63:st)){var dt=st;0<xe.wb&&(dt=4<xe.wb?dt>>2:dt>>1)>9-xe.wb&&(dt=9-xe.wb),1>dt&&(dt=1),et.dd=dt,et.tc=2*st+dt,et.ld=40<=st?2:15<=st?1:0}else et.tc=0;et.La=Oe}}}se=0}else ds(D,6,"Frame setup failed"),se=D.a;if(se=se==0){if(se){D.$c=0,0<D.Aa||(D.Ic=bh);e:{se=D.Ic,xe=4*(dt=D.za);var wt=32*dt,Xt=dt+1,xi=0<D.L?dt*(0<D.Aa?2:1):0,Bi=(D.Aa==2?2:1)*dt;if((et=xe+832+(Oe=3*(16*se+xh[D.L])/2*wt)+(Ke=D.Fa!=null&&0<D.Fa.length?D.Kc.c*D.Kc.i:0))!=et)se=0;else{if(et>D.Vb){if(D.Vb=0,D.Ec=h(et),D.Fc=0,D.Ec==null){se=ds(D,1,"no memory during frame initialization.");break e}D.Vb=et}et=D.Ec,st=D.Fc,D.Ac=et,D.Bc=st,st+=xe,D.Gd=A(wt,Uo),D.Hd=0,D.rb=A(Xt+1,In),D.sb=1,D.wa=xi?A(xi,En):null,D.Y=0,D.D.Nb=0,D.D.wa=D.wa,D.D.Y=D.Y,0<D.Aa&&(D.D.Y+=dt),e(!0),D.oc=et,D.pc=st,st+=832,D.ya=A(Bi,bs),D.aa=0,D.D.ya=D.ya,D.D.aa=D.aa,D.Aa==2&&(D.D.aa+=dt),D.R=16*dt,D.B=8*dt,dt=(wt=xh[D.L])*D.R,wt=wt/2*D.B,D.sa=et,D.ta=st+dt,D.qa=D.sa,D.ra=D.ta+16*se*D.R+wt,D.Ha=D.qa,D.Ia=D.ra+8*se*D.B+wt,D.$c=0,st+=Oe,D.mb=Ke?et:null,D.nb=Ke?st:null,e(st+Ke<=D.Fc+D.Vb),ec(D),c(D.Ac,D.Bc,0,xe),se=1}}if(se){if(K.ka=0,K.y=D.sa,K.O=D.ta,K.f=D.qa,K.N=D.ra,K.ea=D.Ha,K.Vd=D.Ia,K.fa=D.R,K.Rc=D.B,K.F=null,K.J=0,!ph){for(se=-255;255>=se;++se)po[255+se]=0>se?-se:se;for(se=-1020;1020>=se;++se)Gl[1020+se]=-128>se?-128:127<se?127:se;for(se=-112;112>=se;++se)Bu[112+se]=-16>se?-16:15<se?15:se;for(se=-255;510>=se;++se)Na[255+se]=0>se?0:255<se?255:se;ph=1}Sl=wc,Wc=al,El=ll,La=bc,Hl=_l,$o=vl,xu=Ol,el=Cl,ju=Hh,Ho=vu,Ic=jn,Ql=No,bu=Er,ac=fh,Vl=rc,Tc=nc,wu=sc,To=yu,Il[0]=pn,Il[1]=ic,Il[2]=iA,Il[3]=hh,Il[4]=dh,Il[5]=Hc,Il[6]=fu,Il[7]=bl,Il[8]=Qc,Il[9]=zu,Xc[0]=ko,Xc[1]=hu,Xc[2]=xl,Xc[3]=du,Xc[4]=Xo,Xc[5]=uh,Xc[6]=Au,il[0]=wl,il[1]=Uu,il[2]=Bc,il[3]=Ah,il[4]=$a,il[5]=ud,il[6]=gu,se=1}else se=0}se&&(se=function(ci,Hi){for(ci.M=0;ci.M<ci.Va;++ci.M){var Ni,Zt=ci.Jc[ci.M&ci.Xb],ei=ci.m,qi=ci;for(Ni=0;Ni<qi.za;++Ni){var cr=ei,$i=qi,Xr=$i.Ac,Tr=$i.Bc+4*Ni,wn=$i.zc,zr=$i.ya[$i.aa+Ni];if($i.Qa.Bb?zr.$b=vt(cr,$i.Pa.jb[0])?2+vt(cr,$i.Pa.jb[2]):vt(cr,$i.Pa.jb[1]):zr.$b=0,$i.kc&&(zr.Ad=vt(cr,$i.Bd)),zr.Za=!vt(cr,145)+0,zr.Za){var Ms=zr.Ob,Vs=0;for($i=0;4>$i;++$i){var Ps,Ar=wn[0+$i];for(Ps=0;4>Ps;++Ps){Ar=Wh[Xr[Tr+Ps]][Ar];for(var ys=aA[vt(cr,Ar[0])];0<ys;)ys=aA[2*ys+vt(cr,Ar[ys])];Ar=-ys,Xr[Tr+Ps]=Ar}s(Ms,Vs,Xr,Tr,4),Vs+=4,wn[0+$i]=Ar}}else Ar=vt(cr,156)?vt(cr,128)?1:3:vt(cr,163)?2:0,zr.Ob[0]=Ar,c(Xr,Tr,Ar,4),c(wn,0,Ar,4);zr.Dd=vt(cr,142)?vt(cr,114)?vt(cr,183)?1:3:2:0}if(qi.m.Ka)return ds(ci,7,"Premature end-of-partition0 encountered.");for(;ci.ja<ci.za;++ci.ja){if(qi=Zt,cr=(ei=ci).rb[ei.sb-1],Xr=ei.rb[ei.sb+ei.ja],Ni=ei.ya[ei.aa+ei.ja],Tr=ei.kc?Ni.Ad:0)cr.la=Xr.la=0,Ni.Za||(cr.Na=Xr.Na=0),Ni.Hc=0,Ni.Gc=0,Ni.ia=0;else{var co,Kn;if(cr=Xr,Xr=qi,Tr=ei.Pa.Xc,wn=ei.ya[ei.aa+ei.ja],zr=ei.pb[wn.$b],$i=wn.ad,Ms=0,Vs=ei.rb[ei.sb-1],Ar=Ps=0,c($i,Ms,0,384),wn.Za)var $s=0,Tl=Tr[3];else{ys=h(16);var wo=cr.Na+Vs.Na;if(wo=Vu(Xr,Tr[1],wo,zr.Eb,0,ys,0),cr.Na=Vs.Na=(0<wo)+0,1<wo)Sl(ys,0,$i,Ms);else{var aa=ys[0]+3>>3;for(ys=0;256>ys;ys+=16)$i[Ms+ys]=aa}$s=1,Tl=Tr[0]}var cs=15&cr.la,ja=15&Vs.la;for(ys=0;4>ys;++ys){var Ha=1&ja;for(aa=Kn=0;4>aa;++aa)cs=cs>>1|(Ha=(wo=Vu(Xr,Tl,wo=Ha+(1&cs),zr.Sc,$s,$i,Ms))>$s)<<7,Kn=Kn<<2|(3<wo?3:1<wo?2:$i[Ms+0]!=0),Ms+=16;cs>>=4,ja=ja>>1|Ha<<7,Ps=(Ps<<8|Kn)>>>0}for(Tl=cs,$s=ja>>4,co=0;4>co;co+=2){for(Kn=0,cs=cr.la>>4+co,ja=Vs.la>>4+co,ys=0;2>ys;++ys){for(Ha=1&ja,aa=0;2>aa;++aa)wo=Ha+(1&cs),cs=cs>>1|(Ha=0<(wo=Vu(Xr,Tr[2],wo,zr.Qc,0,$i,Ms)))<<3,Kn=Kn<<2|(3<wo?3:1<wo?2:$i[Ms+0]!=0),Ms+=16;cs>>=2,ja=ja>>1|Ha<<5}Ar|=Kn<<4*co,Tl|=cs<<4<<co,$s|=(240&ja)<<co}cr.la=Tl,Vs.la=$s,wn.Hc=Ps,wn.Gc=Ar,wn.ia=43690&Ar?0:zr.ia,Tr=!(Ps|Ar)}if(0<ei.L&&(ei.wa[ei.Y+ei.ja]=ei.gd[Ni.$b][Ni.Za],ei.wa[ei.Y+ei.ja].La|=!Tr),qi.Ka)return ds(ci,7,"Premature end-of-file encountered.")}if(ec(ci),ei=Hi,qi=1,Ni=(Zt=ci).D,cr=0<Zt.L&&Zt.M>=Zt.zb&&Zt.M<=Zt.Va,Zt.Aa==0)e:{if(Ni.M=Zt.M,Ni.uc=cr,lo(Zt,Ni),qi=1,Ni=(Kn=Zt.D).Nb,cr=(Ar=xh[Zt.L])*Zt.R,Xr=Ar/2*Zt.B,ys=16*Ni*Zt.R,aa=8*Ni*Zt.B,Tr=Zt.sa,wn=Zt.ta-cr+ys,zr=Zt.qa,$i=Zt.ra-Xr+aa,Ms=Zt.Ha,Vs=Zt.Ia-Xr+aa,ja=(cs=Kn.M)==0,Ps=cs>=Zt.Va-1,Zt.Aa==2&&lo(Zt,Kn),Kn.uc)for(Ha=(wo=Zt).D.M,e(wo.D.uc),Kn=wo.yb;Kn<wo.Hb;++Kn){$s=Kn,Tl=Ha;var Ca=(uo=(Qo=wo).D).Nb;co=Qo.R;var uo=uo.wa[uo.Y+$s],Zo=Qo.sa,Qa=Qo.ta+16*Ca*co+16*$s,cc=uo.dd,la=uo.tc;if(la!=0)if(e(3<=la),Qo.L==1)0<$s&&Tc(Zo,Qa,co,la+4),uo.La&&To(Zo,Qa,co,la),0<Tl&&Vl(Zo,Qa,co,la+4),uo.La&&wu(Zo,Qa,co,la);else{var Va=Qo.B,Ga=Qo.qa,Zi=Qo.ra+8*Ca*Va+8*$s,Su=Qo.Ha,Qo=Qo.Ia+8*Ca*Va+8*$s;Ca=uo.ld,0<$s&&(el(Zo,Qa,co,la+4,cc,Ca),Ho(Ga,Zi,Su,Qo,Va,la+4,cc,Ca)),uo.La&&(Ql(Zo,Qa,co,la,cc,Ca),ac(Ga,Zi,Su,Qo,Va,la,cc,Ca)),0<Tl&&(xu(Zo,Qa,co,la+4,cc,Ca),ju(Ga,Zi,Su,Qo,Va,la+4,cc,Ca)),uo.La&&(Ic(Zo,Qa,co,la,cc,Ca),bu(Ga,Zi,Su,Qo,Va,la,cc,Ca))}}if(Zt.ia&&alert("todo:DitherRow"),ei.put!=null){if(Kn=16*cs,cs=16*(cs+1),ja?(ei.y=Zt.sa,ei.O=Zt.ta+ys,ei.f=Zt.qa,ei.N=Zt.ra+aa,ei.ea=Zt.Ha,ei.W=Zt.Ia+aa):(Kn-=Ar,ei.y=Tr,ei.O=wn,ei.f=zr,ei.N=$i,ei.ea=Ms,ei.W=Vs),Ps||(cs-=Ar),cs>ei.o&&(cs=ei.o),ei.F=null,ei.J=null,Zt.Fa!=null&&0<Zt.Fa.length&&Kn<cs&&(ei.J=Ul(Zt,ei,Kn,cs-Kn),ei.F=Zt.mb,ei.F==null&&ei.F.length==0)){qi=ds(Zt,3,"Could not decode alpha data.");break e}Kn<ei.j&&(Ar=ei.j-Kn,Kn=ei.j,e(!(1&Ar)),ei.O+=Zt.R*Ar,ei.N+=Zt.B*(Ar>>1),ei.W+=Zt.B*(Ar>>1),ei.F!=null&&(ei.J+=ei.width*Ar)),Kn<cs&&(ei.O+=ei.v,ei.N+=ei.v>>1,ei.W+=ei.v>>1,ei.F!=null&&(ei.J+=ei.v),ei.ka=Kn-ei.j,ei.U=ei.va-ei.v,ei.T=cs-Kn,qi=ei.put(ei))}Ni+1!=Zt.Ic||Ps||(s(Zt.sa,Zt.ta-cr,Tr,wn+16*Zt.R,cr),s(Zt.qa,Zt.ra-Xr,zr,$i+8*Zt.B,Xr),s(Zt.Ha,Zt.Ia-Xr,Ms,Vs+8*Zt.B,Xr))}if(!qi)return ds(ci,6,"Output aborted.")}return 1}(D,K)),K.bc!=null&&K.bc(K),se&=1}return se?(D.cb=0,se):0}function yl(D,K,se,xe,Oe){Oe=D[K+se+32*xe]+(Oe>>3),D[K+se+32*xe]=-256&Oe?0>Oe?0:255:Oe}function Eo(D,K,se,xe,Oe,Ke){yl(D,K,0,se,xe+Oe),yl(D,K,1,se,xe+Ke),yl(D,K,2,se,xe-Ke),yl(D,K,3,se,xe-Oe)}function Ta(D){return(20091*D>>16)+D}function Ou(D,K,se,xe){var Oe,Ke=0,et=h(16);for(Oe=0;4>Oe;++Oe){var st=D[K+0]+D[K+8],dt=D[K+0]-D[K+8],wt=(35468*D[K+4]>>16)-Ta(D[K+12]),Xt=Ta(D[K+4])+(35468*D[K+12]>>16);et[Ke+0]=st+Xt,et[Ke+1]=dt+wt,et[Ke+2]=dt-wt,et[Ke+3]=st-Xt,Ke+=4,K++}for(Oe=Ke=0;4>Oe;++Oe)st=(D=et[Ke+0]+4)+et[Ke+8],dt=D-et[Ke+8],wt=(35468*et[Ke+4]>>16)-Ta(et[Ke+12]),yl(se,xe,0,0,st+(Xt=Ta(et[Ke+4])+(35468*et[Ke+12]>>16))),yl(se,xe,1,0,dt+wt),yl(se,xe,2,0,dt-wt),yl(se,xe,3,0,st-Xt),Ke++,xe+=32}function vl(D,K,se,xe){var Oe=D[K+0]+4,Ke=35468*D[K+4]>>16,et=Ta(D[K+4]),st=35468*D[K+1]>>16;Eo(se,xe,0,Oe+et,D=Ta(D[K+1]),st),Eo(se,xe,1,Oe+Ke,D,st),Eo(se,xe,2,Oe-Ke,D,st),Eo(se,xe,3,Oe-et,D,st)}function al(D,K,se,xe,Oe){Ou(D,K,se,xe),Oe&&Ou(D,K+16,se,xe+4)}function ll(D,K,se,xe){Wc(D,K+0,se,xe,1),Wc(D,K+32,se,xe+128,1)}function bc(D,K,se,xe){var Oe;for(D=D[K+0]+4,Oe=0;4>Oe;++Oe)for(K=0;4>K;++K)yl(se,xe,K,Oe,D)}function _l(D,K,se,xe){D[K+0]&&La(D,K+0,se,xe),D[K+16]&&La(D,K+16,se,xe+4),D[K+32]&&La(D,K+32,se,xe+128),D[K+48]&&La(D,K+48,se,xe+128+4)}function wc(D,K,se,xe){var Oe,Ke=h(16);for(Oe=0;4>Oe;++Oe){var et=D[K+0+Oe]+D[K+12+Oe],st=D[K+4+Oe]+D[K+8+Oe],dt=D[K+4+Oe]-D[K+8+Oe],wt=D[K+0+Oe]-D[K+12+Oe];Ke[0+Oe]=et+st,Ke[8+Oe]=et-st,Ke[4+Oe]=wt+dt,Ke[12+Oe]=wt-dt}for(Oe=0;4>Oe;++Oe)et=(D=Ke[0+4*Oe]+3)+Ke[3+4*Oe],st=Ke[1+4*Oe]+Ke[2+4*Oe],dt=Ke[1+4*Oe]-Ke[2+4*Oe],wt=D-Ke[3+4*Oe],se[xe+0]=et+st>>3,se[xe+16]=wt+dt>>3,se[xe+32]=et-st>>3,se[xe+48]=wt-dt>>3,xe+=64}function tc(D,K,se){var xe,Oe=K-32,Ke=Ma,et=255-D[Oe-1];for(xe=0;xe<se;++xe){var st,dt=Ke,wt=et+D[K-1];for(st=0;st<se;++st)D[K+st]=dt[wt+D[Oe+st]];K+=32}}function ic(D,K){tc(D,K,4)}function Uu(D,K){tc(D,K,8)}function hu(D,K){tc(D,K,16)}function xl(D,K){var se;for(se=0;16>se;++se)s(D,K+32*se,D,K-32,16)}function du(D,K){var se;for(se=16;0<se;--se)c(D,K,D[K-1],16),K+=32}function jc(D,K,se){var xe;for(xe=0;16>xe;++xe)c(K,se+32*xe,D,16)}function ko(D,K){var se,xe=16;for(se=0;16>se;++se)xe+=D[K-1+32*se]+D[K+se-32];jc(xe>>5,D,K)}function Xo(D,K){var se,xe=8;for(se=0;16>se;++se)xe+=D[K-1+32*se];jc(xe>>4,D,K)}function uh(D,K){var se,xe=8;for(se=0;16>se;++se)xe+=D[K+se-32];jc(xe>>4,D,K)}function Au(D,K){jc(128,D,K)}function Tn(D,K,se){return D+2*K+se+2>>2}function iA(D,K){var se,xe=K-32;for(xe=new Uint8Array([Tn(D[xe-1],D[xe+0],D[xe+1]),Tn(D[xe+0],D[xe+1],D[xe+2]),Tn(D[xe+1],D[xe+2],D[xe+3]),Tn(D[xe+2],D[xe+3],D[xe+4])]),se=0;4>se;++se)s(D,K+32*se,xe,0,xe.length)}function hh(D,K){var se=D[K-1],xe=D[K-1+32],Oe=D[K-1+64],Ke=D[K-1+96];Gt(D,K+0,16843009*Tn(D[K-1-32],se,xe)),Gt(D,K+32,16843009*Tn(se,xe,Oe)),Gt(D,K+64,16843009*Tn(xe,Oe,Ke)),Gt(D,K+96,16843009*Tn(Oe,Ke,Ke))}function pn(D,K){var se,xe=4;for(se=0;4>se;++se)xe+=D[K+se-32]+D[K-1+32*se];for(xe>>=3,se=0;4>se;++se)c(D,K+32*se,xe,4)}function dh(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],Ke=D[K-1-32],et=D[K+0-32],st=D[K+1-32],dt=D[K+2-32],wt=D[K+3-32];D[K+0+96]=Tn(xe,Oe,D[K-1+96]),D[K+1+96]=D[K+0+64]=Tn(se,xe,Oe),D[K+2+96]=D[K+1+64]=D[K+0+32]=Tn(Ke,se,xe),D[K+3+96]=D[K+2+64]=D[K+1+32]=D[K+0+0]=Tn(et,Ke,se),D[K+3+64]=D[K+2+32]=D[K+1+0]=Tn(st,et,Ke),D[K+3+32]=D[K+2+0]=Tn(dt,st,et),D[K+3+0]=Tn(wt,dt,st)}function fu(D,K){var se=D[K+1-32],xe=D[K+2-32],Oe=D[K+3-32],Ke=D[K+4-32],et=D[K+5-32],st=D[K+6-32],dt=D[K+7-32];D[K+0+0]=Tn(D[K+0-32],se,xe),D[K+1+0]=D[K+0+32]=Tn(se,xe,Oe),D[K+2+0]=D[K+1+32]=D[K+0+64]=Tn(xe,Oe,Ke),D[K+3+0]=D[K+2+32]=D[K+1+64]=D[K+0+96]=Tn(Oe,Ke,et),D[K+3+32]=D[K+2+64]=D[K+1+96]=Tn(Ke,et,st),D[K+3+64]=D[K+2+96]=Tn(et,st,dt),D[K+3+96]=Tn(st,dt,dt)}function Hc(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],Ke=D[K-1-32],et=D[K+0-32],st=D[K+1-32],dt=D[K+2-32],wt=D[K+3-32];D[K+0+0]=D[K+1+64]=Ke+et+1>>1,D[K+1+0]=D[K+2+64]=et+st+1>>1,D[K+2+0]=D[K+3+64]=st+dt+1>>1,D[K+3+0]=dt+wt+1>>1,D[K+0+96]=Tn(Oe,xe,se),D[K+0+64]=Tn(xe,se,Ke),D[K+0+32]=D[K+1+96]=Tn(se,Ke,et),D[K+1+32]=D[K+2+96]=Tn(Ke,et,st),D[K+2+32]=D[K+3+96]=Tn(et,st,dt),D[K+3+32]=Tn(st,dt,wt)}function bl(D,K){var se=D[K+0-32],xe=D[K+1-32],Oe=D[K+2-32],Ke=D[K+3-32],et=D[K+4-32],st=D[K+5-32],dt=D[K+6-32],wt=D[K+7-32];D[K+0+0]=se+xe+1>>1,D[K+1+0]=D[K+0+64]=xe+Oe+1>>1,D[K+2+0]=D[K+1+64]=Oe+Ke+1>>1,D[K+3+0]=D[K+2+64]=Ke+et+1>>1,D[K+0+32]=Tn(se,xe,Oe),D[K+1+32]=D[K+0+96]=Tn(xe,Oe,Ke),D[K+2+32]=D[K+1+96]=Tn(Oe,Ke,et),D[K+3+32]=D[K+2+96]=Tn(Ke,et,st),D[K+3+64]=Tn(et,st,dt),D[K+3+96]=Tn(st,dt,wt)}function zu(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],Ke=D[K-1+96];D[K+0+0]=se+xe+1>>1,D[K+2+0]=D[K+0+32]=xe+Oe+1>>1,D[K+2+32]=D[K+0+64]=Oe+Ke+1>>1,D[K+1+0]=Tn(se,xe,Oe),D[K+3+0]=D[K+1+32]=Tn(xe,Oe,Ke),D[K+3+32]=D[K+1+64]=Tn(Oe,Ke,Ke),D[K+3+64]=D[K+2+64]=D[K+0+96]=D[K+1+96]=D[K+2+96]=D[K+3+96]=Ke}function Qc(D,K){var se=D[K-1+0],xe=D[K-1+32],Oe=D[K-1+64],Ke=D[K-1+96],et=D[K-1-32],st=D[K+0-32],dt=D[K+1-32],wt=D[K+2-32];D[K+0+0]=D[K+2+32]=se+et+1>>1,D[K+0+32]=D[K+2+64]=xe+se+1>>1,D[K+0+64]=D[K+2+96]=Oe+xe+1>>1,D[K+0+96]=Ke+Oe+1>>1,D[K+3+0]=Tn(st,dt,wt),D[K+2+0]=Tn(et,st,dt),D[K+1+0]=D[K+3+32]=Tn(se,et,st),D[K+1+32]=D[K+3+64]=Tn(xe,se,et),D[K+1+64]=D[K+3+96]=Tn(Oe,xe,se),D[K+1+96]=Tn(Ke,Oe,xe)}function Bc(D,K){var se;for(se=0;8>se;++se)s(D,K+32*se,D,K-32,8)}function Ah(D,K){var se;for(se=0;8>se;++se)c(D,K,D[K-1],8),K+=32}function pu(D,K,se){var xe;for(xe=0;8>xe;++xe)c(K,se+32*xe,D,8)}function wl(D,K){var se,xe=8;for(se=0;8>se;++se)xe+=D[K+se-32]+D[K-1+32*se];pu(xe>>4,D,K)}function ud(D,K){var se,xe=4;for(se=0;8>se;++se)xe+=D[K+se-32];pu(xe>>3,D,K)}function $a(D,K){var se,xe=4;for(se=0;8>se;++se)xe+=D[K-1+32*se];pu(xe>>3,D,K)}function gu(D,K){pu(128,D,K)}function mu(D,K,se){var xe=D[K-se],Oe=D[K+0],Ke=3*(Oe-xe)+ul[1020+D[K-2*se]-D[K+se]],et=gn[112+(Ke+4>>3)];D[K-se]=Ma[255+xe+gn[112+(Ke+3>>3)]],D[K+0]=Ma[255+Oe-et]}function Bl(D,K,se,xe){var Oe=D[K+0],Ke=D[K+se];return lc[255+D[K-2*se]-D[K-se]]>xe||lc[255+Ke-Oe]>xe}function zo(D,K,se,xe){return 4*lc[255+D[K-se]-D[K+0]]+lc[255+D[K-2*se]-D[K+se]]<=xe}function Vc(D,K,se,xe,Oe){var Ke=D[K-3*se],et=D[K-2*se],st=D[K-se],dt=D[K+0],wt=D[K+se],Xt=D[K+2*se],xi=D[K+3*se];return 4*lc[255+st-dt]+lc[255+et-wt]>xe?0:lc[255+D[K-4*se]-Ke]<=Oe&&lc[255+Ke-et]<=Oe&&lc[255+et-st]<=Oe&&lc[255+xi-Xt]<=Oe&&lc[255+Xt-wt]<=Oe&&lc[255+wt-dt]<=Oe}function rc(D,K,se,xe){var Oe=2*xe+1;for(xe=0;16>xe;++xe)zo(D,K+xe,se,Oe)&&mu(D,K+xe,se)}function nc(D,K,se,xe){var Oe=2*xe+1;for(xe=0;16>xe;++xe)zo(D,K+xe*se,1,Oe)&&mu(D,K+xe*se,1)}function sc(D,K,se,xe){var Oe;for(Oe=3;0<Oe;--Oe)rc(D,K+=4*se,se,xe)}function yu(D,K,se,xe){var Oe;for(Oe=3;0<Oe;--Oe)nc(D,K+=4,se,xe)}function na(D,K,se,xe,Oe,Ke,et,st){for(Ke=2*Ke+1;0<Oe--;){if(Vc(D,K,se,Ke,et))if(Bl(D,K,se,st))mu(D,K,se);else{var dt=D,wt=K,Xt=se,xi=dt[wt-2*Xt],Bi=dt[wt-Xt],ci=dt[wt+0],Hi=dt[wt+Xt],Ni=dt[wt+2*Xt],Zt=27*(qi=ul[1020+3*(ci-Bi)+ul[1020+xi-Hi]])+63>>7,ei=18*qi+63>>7,qi=9*qi+63>>7;dt[wt-3*Xt]=Ma[255+dt[wt-3*Xt]+qi],dt[wt-2*Xt]=Ma[255+xi+ei],dt[wt-Xt]=Ma[255+Bi+Zt],dt[wt+0]=Ma[255+ci-Zt],dt[wt+Xt]=Ma[255+Hi-ei],dt[wt+2*Xt]=Ma[255+Ni-qi]}K+=xe}}function Za(D,K,se,xe,Oe,Ke,et,st){for(Ke=2*Ke+1;0<Oe--;){if(Vc(D,K,se,Ke,et))if(Bl(D,K,se,st))mu(D,K,se);else{var dt=D,wt=K,Xt=se,xi=dt[wt-Xt],Bi=dt[wt+0],ci=dt[wt+Xt],Hi=gn[112+((Ni=3*(Bi-xi))+4>>3)],Ni=gn[112+(Ni+3>>3)],Zt=Hi+1>>1;dt[wt-2*Xt]=Ma[255+dt[wt-2*Xt]+Zt],dt[wt-Xt]=Ma[255+xi+Ni],dt[wt+0]=Ma[255+Bi-Hi],dt[wt+Xt]=Ma[255+ci-Zt]}K+=xe}}function Ol(D,K,se,xe,Oe,Ke){na(D,K,se,1,16,xe,Oe,Ke)}function Cl(D,K,se,xe,Oe,Ke){na(D,K,1,se,16,xe,Oe,Ke)}function jn(D,K,se,xe,Oe,Ke){var et;for(et=3;0<et;--et)Za(D,K+=4*se,se,1,16,xe,Oe,Ke)}function No(D,K,se,xe,Oe,Ke){var et;for(et=3;0<et;--et)Za(D,K+=4,1,se,16,xe,Oe,Ke)}function Hh(D,K,se,xe,Oe,Ke,et,st){na(D,K,Oe,1,8,Ke,et,st),na(se,xe,Oe,1,8,Ke,et,st)}function vu(D,K,se,xe,Oe,Ke,et,st){na(D,K,1,Oe,8,Ke,et,st),na(se,xe,1,Oe,8,Ke,et,st)}function Er(D,K,se,xe,Oe,Ke,et,st){Za(D,K+4*Oe,Oe,1,8,Ke,et,st),Za(se,xe+4*Oe,Oe,1,8,Ke,et,st)}function fh(D,K,se,xe,Oe,Ke,et,st){Za(D,K+4,1,Oe,8,Ke,et,st),Za(se,xe+4,1,Oe,8,Ke,et,st)}function Gc(){this.ba=new ro,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Cc(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Oa(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Qh(){this.ua=0,this.Wa=new it,this.vb=new it,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Se,this.yc=new me}function Nu(){this.xb=this.a=0,this.l=new So,this.ca=new ro,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ce,this.Pb=0,this.wd=new Ce,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Qh,this.ab=0,this.gc=A(4,Oa),this.Oc=0}function dr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new So,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function kn(D,K,se,xe,Oe,Ke,et){for(D=D==null?0:D[K+0],K=0;K<et;++K)Oe[Ke+K]=D+se[xe+K]&255,D=Oe[Ke+K]}function Fn(D,K,se,xe,Oe,Ke,et){var st;if(D==null)kn(null,null,se,xe,Oe,Ke,et);else for(st=0;st<et;++st)Oe[Ke+st]=D[K+st]+se[xe+st]&255}function sa(D,K,se,xe,Oe,Ke,et){if(D==null)kn(null,null,se,xe,Oe,Ke,et);else{var st,dt=D[K+0],wt=dt,Xt=dt;for(st=0;st<et;++st)wt=Xt+(dt=D[K+st])-wt,Xt=se[xe+st]+(-256&wt?0>wt?0:255:wt)&255,wt=dt,Oe[Ke+st]=Xt}}function Ul(D,K,se,xe){var Oe=K.width,Ke=K.o;if(e(D!=null&&K!=null),0>se||0>=xe||se+xe>Ke)return null;if(!D.Cc){if(D.ga==null){var et;if(D.ga=new dr,(et=D.ga==null)||(et=K.width*K.o,e(D.Gb.length==0),D.Gb=h(et),D.Uc=0,D.Gb==null?et=0:(D.mb=D.Gb,D.nb=D.Uc,D.rc=null,et=1),et=!et),!et){et=D.ga;var st=D.Fa,dt=D.P,wt=D.qc,Xt=D.mb,xi=D.nb,Bi=dt+1,ci=wt-1,Hi=et.l;if(e(st!=null&&Xt!=null&&K!=null),Yc[0]=null,Yc[1]=kn,Yc[2]=Fn,Yc[3]=sa,et.ca=Xt,et.tb=xi,et.c=K.width,et.i=K.height,e(0<et.c&&0<et.i),1>=wt)K=0;else if(et.$a=st[dt+0]>>0&3,et.Z=st[dt+0]>>2&3,et.Lc=st[dt+0]>>4&3,dt=st[dt+0]>>6&3,0>et.$a||1<et.$a||4<=et.Z||1<et.Lc||dt)K=0;else if(Hi.put=ra,Hi.ac=xs,Hi.bc=dn,Hi.ma=et,Hi.width=K.width,Hi.height=K.height,Hi.Da=K.Da,Hi.v=K.v,Hi.va=K.va,Hi.j=K.j,Hi.o=K.o,et.$a)e:{e(et.$a==1),K=er();t:for(;;){if(K==null){K=0;break e}if(e(et!=null),et.mc=K,K.c=et.c,K.i=et.i,K.l=et.l,K.l.ma=et,K.l.width=et.c,K.l.height=et.i,K.a=0,$e(K.m,st,Bi,ci),!nr(et.c,et.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&bt(K.s)?(et.ic=1,st=K.c*K.i,K.Ta=null,K.Ua=0,K.V=h(st),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):(et.ic=0,K=Sr(K,et.c)),!K))break t;K=1;break e}et.mc=null,K=0}else K=ci>=et.c*et.i;et=!K}if(et)return null;D.ga.Lc!=1?D.Ga=0:xe=Ke-se}e(D.ga!=null),e(se+xe<=Ke);e:{if(K=(st=D.ga).c,Ke=st.l.o,st.$a==0){if(Bi=D.rc,ci=D.Vc,Hi=D.Fa,dt=D.P+1+se*K,wt=D.mb,Xt=D.nb+se*K,e(dt<=D.P+D.qc),st.Z!=0)for(e(Yc[st.Z]!=null),et=0;et<xe;++et)Yc[st.Z](Bi,ci,Hi,dt,wt,Xt,K),Bi=wt,ci=Xt,Xt+=K,dt+=K;else for(et=0;et<xe;++et)s(wt,Xt,Hi,dt,K),Bi=wt,ci=Xt,Xt+=K,dt+=K;D.rc=Bi,D.Vc=ci}else{if(e(st.mc!=null),K=se+xe,e((et=st.mc)!=null),e(K<=et.i),et.C>=K)K=1;else if(st.ic||hi(),st.ic){st=et.V,Bi=et.Ba,ci=et.c;var Ni=et.i,Zt=(Hi=1,dt=et.$/ci,wt=et.$%ci,Xt=et.m,xi=et.s,et.$),ei=ci*Ni,qi=ci*K,cr=xi.wc,$i=Zt<qi?Ye(xi,wt,dt):null;e(Zt<=ei),e(K<=Ni),e(bt(xi));t:for(;;){for(;!Xt.h&&Zt<qi;){if(wt&cr||($i=Ye(xi,wt,dt)),e($i!=null),Bt(Xt),256>(Ni=He($i.G[0],$i.H[0],Xt)))st[Bi+Zt]=Ni,++Zt,++wt>=ci&&(wt=0,++dt<=K&&!(dt%16)&&ii(et,dt));else{if(!(280>Ni)){Hi=0;break t}Ni=ye(Ni-256,Xt);var Xr,Tr=He($i.G[4],$i.H[4],Xt);if(Bt(Xt),!(Zt>=(Tr=Ee(ci,Tr=ye(Tr,Xt)))&&ei-Zt>=Ni)){Hi=0;break t}for(Xr=0;Xr<Ni;++Xr)st[Bi+Zt+Xr]=st[Bi+Zt+Xr-Tr];for(Zt+=Ni,wt+=Ni;wt>=ci;)wt-=ci,++dt<=K&&!(dt%16)&&ii(et,dt);Zt<qi&&wt&cr&&($i=Ye(xi,wt,dt))}e(Xt.h==lt(Xt))}ii(et,dt>K?K:dt);break t}!Hi||Xt.h&&Zt<ei?(Hi=0,et.a=Xt.h?5:3):et.$=Zt,K=Hi}else K=Nt(et,et.V,et.Ba,et.c,et.i,K,Mr);if(!K){xe=0;break e}}se+xe>=Ke&&(D.Cc=1),xe=1}if(!xe)return null;if(D.Cc&&((xe=D.ga)!=null&&(xe.mc=null),D.ga=null,0<D.Ga))return alert("todo:WebPDequantizeLevels"),null}return D.nb+se*Oe}function ie(D,K,se,xe,Oe,Ke){for(;0<Oe--;){var et,st=D,dt=K+(se?1:0),wt=D,Xt=K+(se?0:3);for(et=0;et<xe;++et){var xi=wt[Xt+4*et];xi!=255&&(xi*=32897,st[dt+4*et+0]=st[dt+4*et+0]*xi>>23,st[dt+4*et+1]=st[dt+4*et+1]*xi>>23,st[dt+4*et+2]=st[dt+4*et+2]*xi>>23)}K+=Ke}}function Ue(D,K,se,xe,Oe){for(;0<xe--;){var Ke;for(Ke=0;Ke<se;++Ke){var et=D[K+2*Ke+0],st=15&(wt=D[K+2*Ke+1]),dt=4369*st,wt=(240&wt|wt>>4)*dt>>16;D[K+2*Ke+0]=(240&et|et>>4)*dt>>16&240|(15&et|et<<4)*dt>>16>>4&15,D[K+2*Ke+1]=240&wt|st}K+=Oe}}function Tt(D,K,se,xe,Oe,Ke,et,st){var dt,wt,Xt=255;for(wt=0;wt<Oe;++wt){for(dt=0;dt<xe;++dt){var xi=D[K+dt];Ke[et+4*dt]=xi,Xt&=xi}K+=se,et+=st}return Xt!=255}function jt(D,K,se,xe,Oe){var Ke;for(Ke=0;Ke<Oe;++Ke)se[xe+Ke]=D[K+Ke]>>8}function hi(){tl=ie,wi=Ue,no=Tt,bo=jt}function Ii(D,K,se){le[D]=function(xe,Oe,Ke,et,st,dt,wt,Xt,xi,Bi,ci,Hi,Ni,Zt,ei,qi,cr){var $i,Xr=cr-1>>1,Tr=st[dt+0]|wt[Xt+0]<<16,wn=xi[Bi+0]|ci[Hi+0]<<16;e(xe!=null);var zr=3*Tr+wn+131074>>2;for(K(xe[Oe+0],255&zr,zr>>16,Ni,Zt),Ke!=null&&(zr=3*wn+Tr+131074>>2,K(Ke[et+0],255&zr,zr>>16,ei,qi)),$i=1;$i<=Xr;++$i){var Ms=st[dt+$i]|wt[Xt+$i]<<16,Vs=xi[Bi+$i]|ci[Hi+$i]<<16,Ps=Tr+Ms+wn+Vs+524296,Ar=Ps+2*(Ms+wn)>>3;zr=Ar+Tr>>1,Tr=(Ps=Ps+2*(Tr+Vs)>>3)+Ms>>1,K(xe[Oe+2*$i-1],255&zr,zr>>16,Ni,Zt+(2*$i-1)*se),K(xe[Oe+2*$i-0],255&Tr,Tr>>16,Ni,Zt+(2*$i-0)*se),Ke!=null&&(zr=Ps+wn>>1,Tr=Ar+Vs>>1,K(Ke[et+2*$i-1],255&zr,zr>>16,ei,qi+(2*$i-1)*se),K(Ke[et+2*$i+0],255&Tr,Tr>>16,ei,qi+(2*$i+0)*se)),Tr=Ms,wn=Vs}1&cr||(zr=3*Tr+wn+131074>>2,K(xe[Oe+cr-1],255&zr,zr>>16,Ni,Zt+(cr-1)*se),Ke!=null&&(zr=3*wn+Tr+131074>>2,K(Ke[et+cr-1],255&zr,zr>>16,ei,qi+(cr-1)*se)))}}function mr(){Ba[rA]=zf,Ba[gh]=dd,Ba[mh]=uA,Ba[Is]=Nf,Ba[hd]=hA,Ba[Hu]=Ad,Ba[Pf]=dA,Ba[$A]=dd,Ba[ZA]=Nf,Ba[nA]=hA,Ba[yh]=Ad}function Vr(D){return D&-16384?0>D?0:255:D>>_h}function cn(D,K){return Vr((19077*D>>8)+(26149*K>>8)-14234)}function Rn(D,K,se){return Vr((19077*D>>8)-(6419*K>>8)-(13320*se>>8)+8708)}function Dn(D,K){return Vr((19077*D>>8)+(33050*K>>8)-17685)}function As(D,K,se,xe,Oe){xe[Oe+0]=cn(D,se),xe[Oe+1]=Rn(D,K,se),xe[Oe+2]=Dn(D,K)}function Zs(D,K,se,xe,Oe){xe[Oe+0]=Dn(D,K),xe[Oe+1]=Rn(D,K,se),xe[Oe+2]=cn(D,se)}function ts(D,K,se,xe,Oe){var Ke=Rn(D,K,se);K=Ke<<3&224|Dn(D,K)>>3,xe[Oe+0]=248&cn(D,se)|Ke>>5,xe[Oe+1]=K}function bn(D,K,se,xe,Oe){var Ke=240&Dn(D,K)|15;xe[Oe+0]=240&cn(D,se)|Rn(D,K,se)>>4,xe[Oe+1]=Ke}function Js(D,K,se,xe,Oe){xe[Oe+0]=255,As(D,K,se,xe,Oe+1)}function vo(D,K,se,xe,Oe){Zs(D,K,se,xe,Oe),xe[Oe+3]=255}function Wr(D,K,se,xe,Oe){As(D,K,se,xe,Oe),xe[Oe+3]=255}function ji(D,K){return 0>D?0:D>K?K:D}function eo(D,K,se){le[D]=function(xe,Oe,Ke,et,st,dt,wt,Xt,xi){for(var Bi=Xt+(-2&xi)*se;Xt!=Bi;)K(xe[Oe+0],Ke[et+0],st[dt+0],wt,Xt),K(xe[Oe+1],Ke[et+0],st[dt+0],wt,Xt+se),Oe+=2,++et,++dt,Xt+=2*se;1&xi&&K(xe[Oe+0],Ke[et+0],st[dt+0],wt,Xt)}}function Pr(D,K,se){return se==0?D==0?K==0?6:5:K==0?4:0:se}function Es(D,K,se,xe,Oe){switch(D>>>30){case 3:Wc(K,se,xe,Oe,0);break;case 2:$o(K,se,xe,Oe);break;case 1:La(K,se,xe,Oe)}}function lo(D,K){var se,xe,Oe=K.M,Ke=K.Nb,et=D.oc,st=D.pc+40,dt=D.oc,wt=D.pc+584,Xt=D.oc,xi=D.pc+600;for(se=0;16>se;++se)et[st+32*se-1]=129;for(se=0;8>se;++se)dt[wt+32*se-1]=129,Xt[xi+32*se-1]=129;for(0<Oe?et[st-1-32]=dt[wt-1-32]=Xt[xi-1-32]=129:(c(et,st-32-1,127,21),c(dt,wt-32-1,127,9),c(Xt,xi-32-1,127,9)),xe=0;xe<D.za;++xe){var Bi=K.ya[K.aa+xe];if(0<xe){for(se=-1;16>se;++se)s(et,st+32*se-4,et,st+32*se+12,4);for(se=-1;8>se;++se)s(dt,wt+32*se-4,dt,wt+32*se+4,4),s(Xt,xi+32*se-4,Xt,xi+32*se+4,4)}var ci=D.Gd,Hi=D.Hd+xe,Ni=Bi.ad,Zt=Bi.Hc;if(0<Oe&&(s(et,st-32,ci[Hi].y,0,16),s(dt,wt-32,ci[Hi].f,0,8),s(Xt,xi-32,ci[Hi].ea,0,8)),Bi.Za){var ei=et,qi=st-32+16;for(0<Oe&&(xe>=D.za-1?c(ei,qi,ci[Hi].y[15],4):s(ei,qi,ci[Hi+1].y,0,4)),se=0;4>se;se++)ei[qi+128+se]=ei[qi+256+se]=ei[qi+384+se]=ei[qi+0+se];for(se=0;16>se;++se,Zt<<=2)ei=et,qi=st+pA[se],Il[Bi.Ob[se]](ei,qi),Es(Zt,Ni,16*+se,ei,qi)}else if(ei=Pr(xe,Oe,Bi.Ob[0]),Xc[ei](et,st),Zt!=0)for(se=0;16>se;++se,Zt<<=2)Es(Zt,Ni,16*+se,et,st+pA[se]);for(se=Bi.Gc,ei=Pr(xe,Oe,Bi.Dd),il[ei](dt,wt),il[ei](Xt,xi),Zt=Ni,ei=dt,qi=wt,255&(Bi=se>>0)&&(170&Bi?El(Zt,256,ei,qi):Hl(Zt,256,ei,qi)),Bi=Xt,Zt=xi,255&(se>>=8)&&(170&se?El(Ni,320,Bi,Zt):Hl(Ni,320,Bi,Zt)),Oe<D.Ub-1&&(s(ci[Hi].y,0,et,st+480,16),s(ci[Hi].f,0,dt,wt+224,8),s(ci[Hi].ea,0,Xt,xi+224,8)),se=8*Ke*D.B,ci=D.sa,Hi=D.ta+16*xe+16*Ke*D.R,Ni=D.qa,Bi=D.ra+8*xe+se,Zt=D.Ha,ei=D.Ia+8*xe+se,se=0;16>se;++se)s(ci,Hi+se*D.R,et,st+32*se,16);for(se=0;8>se;++se)s(Ni,Bi+se*D.B,dt,wt+32*se,8),s(Zt,ei+se*D.B,Xt,xi+32*se,8)}}function wr(D,K,se,xe,Oe,Ke,et,st,dt){var wt=[0],Xt=[0],xi=0,Bi=dt!=null?dt.kd:0,ci=dt??new Cc;if(D==null||12>se)return 7;ci.data=D,ci.w=K,ci.ha=se,K=[K],se=[se],ci.gb=[ci.gb];e:{var Hi=K,Ni=se,Zt=ci.gb;if(e(D!=null),e(Ni!=null),e(Zt!=null),Zt[0]=0,12<=Ni[0]&&!t(D,Hi[0],"RIFF")){if(t(D,Hi[0]+8,"WEBP")){Zt=3;break e}var ei=Ve(D,Hi[0]+4);if(12>ei||4294967286<ei){Zt=3;break e}if(Bi&&ei>Ni[0]-8){Zt=7;break e}Zt[0]=ei,Hi[0]+=12,Ni[0]-=12}Zt=0}if(Zt!=0)return Zt;for(ei=0<ci.gb[0],se=se[0];;){e:{var qi=D;Ni=K,Zt=se;var cr=wt,$i=Xt,Xr=Hi=[0];if((zr=xi=[xi])[0]=0,8>Zt[0])Zt=7;else{if(!t(qi,Ni[0],"VP8X")){if(Ve(qi,Ni[0]+4)!=10){Zt=3;break e}if(18>Zt[0]){Zt=7;break e}var Tr=Ve(qi,Ni[0]+8),wn=1+ze(qi,Ni[0]+12);if(2147483648<=wn*(qi=1+ze(qi,Ni[0]+15))){Zt=3;break e}Xr!=null&&(Xr[0]=Tr),cr!=null&&(cr[0]=wn),$i!=null&&($i[0]=qi),Ni[0]+=18,Zt[0]-=18,zr[0]=1}Zt=0}}if(xi=xi[0],Hi=Hi[0],Zt!=0)return Zt;if(Ni=!!(2&Hi),!ei&&xi)return 3;if(Ke!=null&&(Ke[0]=!!(16&Hi)),et!=null&&(et[0]=Ni),st!=null&&(st[0]=0),et=wt[0],Hi=Xt[0],xi&&Ni&&dt==null){Zt=0;break}if(4>se){Zt=7;break}if(ei&&xi||!ei&&!xi&&!t(D,K[0],"ALPH")){se=[se],ci.na=[ci.na],ci.P=[ci.P],ci.Sa=[ci.Sa];e:{Tr=D,Zt=K,ei=se;var zr=ci.gb;cr=ci.na,$i=ci.P,Xr=ci.Sa,wn=22,e(Tr!=null),e(ei!=null),qi=Zt[0];var Ms=ei[0];for(e(cr!=null),e(Xr!=null),cr[0]=null,$i[0]=null,Xr[0]=0;;){if(Zt[0]=qi,ei[0]=Ms,8>Ms){Zt=7;break e}var Vs=Ve(Tr,qi+4);if(4294967286<Vs){Zt=3;break e}var Ps=8+Vs+1&-2;if(wn+=Ps,0<zr&&wn>zr){Zt=3;break e}if(!t(Tr,qi,"VP8 ")||!t(Tr,qi,"VP8L")){Zt=0;break e}if(Ms[0]<Ps){Zt=7;break e}t(Tr,qi,"ALPH")||(cr[0]=Tr,$i[0]=qi+8,Xr[0]=Vs),qi+=Ps,Ms-=Ps}}if(se=se[0],ci.na=ci.na[0],ci.P=ci.P[0],ci.Sa=ci.Sa[0],Zt!=0)break}se=[se],ci.Ja=[ci.Ja],ci.xa=[ci.xa];e:if(zr=D,Zt=K,ei=se,cr=ci.gb[0],$i=ci.Ja,Xr=ci.xa,Tr=Zt[0],qi=!t(zr,Tr,"VP8 "),wn=!t(zr,Tr,"VP8L"),e(zr!=null),e(ei!=null),e($i!=null),e(Xr!=null),8>ei[0])Zt=7;else{if(qi||wn){if(zr=Ve(zr,Tr+4),12<=cr&&zr>cr-12){Zt=3;break e}if(Bi&&zr>ei[0]-8){Zt=7;break e}$i[0]=zr,Zt[0]+=8,ei[0]-=8,Xr[0]=wn}else Xr[0]=5<=ei[0]&&zr[Tr+0]==47&&!(zr[Tr+4]>>5),$i[0]=ei[0];Zt=0}if(se=se[0],ci.Ja=ci.Ja[0],ci.xa=ci.xa[0],K=K[0],Zt!=0)break;if(4294967286<ci.Ja)return 3;if(st==null||Ni||(st[0]=ci.xa?2:1),et=[et],Hi=[Hi],ci.xa){if(5>se){Zt=7;break}st=et,Bi=Hi,Ni=Ke,D==null||5>se?D=0:5<=se&&D[K+0]==47&&!(D[K+4]>>5)?(ei=[0],zr=[0],cr=[0],$e($i=new Ce,D,K,se),Et($i,ei,zr,cr)?(st!=null&&(st[0]=ei[0]),Bi!=null&&(Bi[0]=zr[0]),Ni!=null&&(Ni[0]=cr[0]),D=1):D=0):D=0}else{if(10>se){Zt=7;break}st=Hi,D==null||10>se||!_c(D,K+3,se-3)?D=0:(Bi=D[K+0]|D[K+1]<<8|D[K+2]<<16,Ni=16383&(D[K+7]<<8|D[K+6]),D=16383&(D[K+9]<<8|D[K+8]),1&Bi||3<(Bi>>1&7)||!(Bi>>4&1)||Bi>>5>=ci.Ja||!Ni||!D?D=0:(et&&(et[0]=Ni),st&&(st[0]=D),D=1))}if(!D||(et=et[0],Hi=Hi[0],xi&&(wt[0]!=et||Xt[0]!=Hi)))return 3;dt!=null&&(dt[0]=ci,dt.offset=K-dt.w,e(4294967286>K-dt.w),e(dt.offset==dt.ha-se));break}return Zt==0||Zt==7&&xi&&dt==null?(Ke!=null&&(Ke[0]|=ci.na!=null&&0<ci.na.length),xe!=null&&(xe[0]=et),Oe!=null&&(Oe[0]=Hi),0):Zt}function _o(D,K,se){var xe=K.width,Oe=K.height,Ke=0,et=0,st=xe,dt=Oe;if(K.Da=D!=null&&0<D.Da,K.Da&&(st=D.cd,dt=D.bd,Ke=D.v,et=D.j,11>se||(Ke&=-2,et&=-2),0>Ke||0>et||0>=st||0>=dt||Ke+st>xe||et+dt>Oe))return 0;if(K.v=Ke,K.j=et,K.va=Ke+st,K.o=et+dt,K.U=st,K.T=dt,K.da=D!=null&&0<D.da,K.da){if(!yi(st,dt,se=[D.ib],Ke=[D.hb]))return 0;K.ib=se[0],K.hb=Ke[0]}return K.ob=D!=null&&D.ob,K.Kb=D==null||!D.Sd,K.da&&(K.ob=K.ib<3*xe/4&&K.hb<3*Oe/4,K.Kb=0),1}function oc(D){if(D==null)return 2;if(11>D.S){var K=D.f.RGBA;K.fb+=(D.height-1)*K.A,K.A=-K.A}else K=D.f.kb,D=D.height,K.O+=(D-1)*K.fa,K.fa=-K.fa,K.N+=(D-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(D-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(D-1)*K.lb,K.lb=-K.lb);return 0}function fa(D,K,se,xe){if(xe==null||0>=D||0>=K)return 2;if(se!=null){if(se.Da){var Oe=se.cd,Ke=se.bd,et=-2&se.v,st=-2&se.j;if(0>et||0>st||0>=Oe||0>=Ke||et+Oe>D||st+Ke>K)return 2;D=Oe,K=Ke}if(se.da){if(!yi(D,K,Oe=[se.ib],Ke=[se.hb]))return 2;D=Oe[0],K=Ke[0]}}xe.width=D,xe.height=K;e:{var dt=xe.width,wt=xe.height;if(D=xe.S,0>=dt||0>=wt||!(D>=rA&&13>D))D=2;else{if(0>=xe.Rd&&xe.sd==null){et=Ke=Oe=K=0;var Xt=(st=dt*gA[D])*wt;if(11>D||(Ke=(wt+1)/2*(K=(dt+1)/2),D==12&&(et=(Oe=dt)*wt)),(wt=h(Xt+2*Ke+et))==null){D=1;break e}xe.sd=wt,11>D?((dt=xe.f.RGBA).eb=wt,dt.fb=0,dt.A=st,dt.size=Xt):((dt=xe.f.kb).y=wt,dt.O=0,dt.fa=st,dt.Fd=Xt,dt.f=wt,dt.N=0+Xt,dt.Ab=K,dt.Cd=Ke,dt.ea=wt,dt.W=0+Xt+Ke,dt.Db=K,dt.Ed=Ke,D==12&&(dt.F=wt,dt.J=0+Xt+2*Ke),dt.Tc=et,dt.lb=Oe)}if(K=1,Oe=xe.S,Ke=xe.width,et=xe.height,Oe>=rA&&13>Oe)if(11>Oe)D=xe.f.RGBA,K&=(st=Math.abs(D.A))*(et-1)+Ke<=D.size,K&=st>=Ke*gA[Oe],K&=D.eb!=null;else{D=xe.f.kb,st=(Ke+1)/2,Xt=(et+1)/2,dt=Math.abs(D.fa),wt=Math.abs(D.Ab);var xi=Math.abs(D.Db),Bi=Math.abs(D.lb),ci=Bi*(et-1)+Ke;K&=dt*(et-1)+Ke<=D.Fd,K&=wt*(Xt-1)+st<=D.Cd,K=(K&=xi*(Xt-1)+st<=D.Ed)&dt>=Ke&wt>=st&xi>=st,K&=D.y!=null,K&=D.f!=null,K&=D.ea!=null,Oe==12&&(K&=Bi>=Ke,K&=ci<=D.Tc,K&=D.F!=null)}else K=0;D=K?0:2}}return D!=0||se!=null&&se.fd&&(D=oc(xe)),D}var Yo=64,is=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ko=24,Sc=32,Io=8,Ua=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];di("Predictor0","PredictorAdd0"),le.Predictor0=function(){return 4278190080},le.Predictor1=function(D){return D},le.Predictor2=function(D,K,se){return K[se+0]},le.Predictor3=function(D,K,se){return K[se+1]},le.Predictor4=function(D,K,se){return K[se-1]},le.Predictor5=function(D,K,se){return Ri(Ri(D,K[se+1]),K[se+0])},le.Predictor6=function(D,K,se){return Ri(D,K[se-1])},le.Predictor7=function(D,K,se){return Ri(D,K[se+0])},le.Predictor8=function(D,K,se){return Ri(K[se-1],K[se+0])},le.Predictor9=function(D,K,se){return Ri(K[se+0],K[se+1])},le.Predictor10=function(D,K,se){return Ri(Ri(D,K[se-1]),Ri(K[se+0],K[se+1]))},le.Predictor11=function(D,K,se){var xe=K[se+0];return 0>=lr(xe>>24&255,D>>24&255,(K=K[se-1])>>24&255)+lr(xe>>16&255,D>>16&255,K>>16&255)+lr(xe>>8&255,D>>8&255,K>>8&255)+lr(255&xe,255&D,255&K)?xe:D},le.Predictor12=function(D,K,se){var xe=K[se+0];return(Oi((D>>24&255)+(xe>>24&255)-((K=K[se-1])>>24&255))<<24|Oi((D>>16&255)+(xe>>16&255)-(K>>16&255))<<16|Oi((D>>8&255)+(xe>>8&255)-(K>>8&255))<<8|Oi((255&D)+(255&xe)-(255&K)))>>>0},le.Predictor13=function(D,K,se){var xe=K[se-1];return(Ji((D=Ri(D,K[se+0]))>>24&255,xe>>24&255)<<24|Ji(D>>16&255,xe>>16&255)<<16|Ji(D>>8&255,xe>>8&255)<<8|Ji(D>>0&255,xe>>0&255))>>>0};var cl=le.PredictorAdd0;le.PredictorAdd1=br,di("Predictor2","PredictorAdd2"),di("Predictor3","PredictorAdd3"),di("Predictor4","PredictorAdd4"),di("Predictor5","PredictorAdd5"),di("Predictor6","PredictorAdd6"),di("Predictor7","PredictorAdd7"),di("Predictor8","PredictorAdd8"),di("Predictor9","PredictorAdd9"),di("Predictor10","PredictorAdd10"),di("Predictor11","PredictorAdd11"),di("Predictor12","PredictorAdd12"),di("Predictor13","PredictorAdd13");var qo=le.PredictorAdd2;ui("ColorIndexInverseTransform","MapARGB","32b",function(D){return D>>8&255},function(D){return D}),ui("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(D){return D},function(D){return D>>8&255});var _u,jo=le.ColorIndexInverseTransform,zl=le.MapARGB,Fa=le.VP8LColorIndexInverseTransformAlpha,xo=le.MapAlpha,oa=le.VP8LPredictorsAdd=[];oa.length=16,(le.VP8LPredictors=[]).length=16,(le.VP8LPredictorsAdd_C=[]).length=16,(le.VP8LPredictors_C=[]).length=16;var Nl,Ja,pa,Ec,za,jl,Sl,Wc,$o,El,La,Hl,xu,el,ju,Ho,Ic,Ql,bu,ac,Vl,Tc,wu,To,tl,wi,no,bo,po=h(511),Gl=h(2041),Bu=h(225),Na=h(767),ph=0,ul=Gl,gn=Bu,Ma=Na,lc=po,rA=0,gh=1,mh=2,Is=3,hd=4,Hu=5,Pf=6,$A=7,ZA=8,nA=9,yh=10,Rp=[2,3,7],sA=[3,3,11],kf=[280,256,256,256,40],Rf=[0,1,1,1,0],Vh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],oA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],JA=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],vh=8,Qu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Cu=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vu=null,Gh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Df=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],aA=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Of=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Wh=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],lA=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cA=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Xc=[],Il=[],il=[],Uf=1,ef=2,Yc=[],Ba=[];Ii("UpsampleRgbLinePair",As,3),Ii("UpsampleBgrLinePair",Zs,3),Ii("UpsampleRgbaLinePair",Wr,4),Ii("UpsampleBgraLinePair",vo,4),Ii("UpsampleArgbLinePair",Js,4),Ii("UpsampleRgba4444LinePair",bn,2),Ii("UpsampleRgb565LinePair",ts,2);var zf=le.UpsampleRgbLinePair,uA=le.UpsampleBgrLinePair,dd=le.UpsampleRgbaLinePair,Nf=le.UpsampleBgraLinePair,hA=le.UpsampleArgbLinePair,Ad=le.UpsampleRgba4444LinePair,dA=le.UpsampleRgb565LinePair,Fc=16,Xh=1<<Fc-1,Kc=-227,tf=482,_h=6,Gu=0,jf=h(256),Wl=h(256),AA=h(256),fd=h(256),fA=h(tf-Kc),rf=h(tf-Kc);eo("YuvToRgbRow",As,3),eo("YuvToBgrRow",Zs,3),eo("YuvToRgbaRow",Wr,4),eo("YuvToBgraRow",vo,4),eo("YuvToArgbRow",Js,4),eo("YuvToRgba4444Row",bn,2),eo("YuvToRgb565Row",ts,2);var pA=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xh=[0,2,8],pd=[8,7,6,4,4,2,2,2,1,1,1,1],bh=1;this.WebPDecodeRGBA=function(D,K,se,xe,Oe){var Ke=gh,et=new Gc,st=new ro;et.ba=st,st.S=Ke,st.width=[st.width],st.height=[st.height];var dt=st.width,wt=st.height,Xt=new Qn;if(Xt==null||D==null)var xi=2;else e(Xt!=null),xi=wr(D,K,se,Xt.width,Xt.height,Xt.Pd,Xt.Qd,Xt.format,null);if(xi!=0?dt=0:(dt!=null&&(dt[0]=Xt.width[0]),wt!=null&&(wt[0]=Xt.height[0]),dt=1),dt){st.width=st.width[0],st.height=st.height[0],xe!=null&&(xe[0]=st.width),Oe!=null&&(Oe[0]=st.height);e:{if(xe=new So,(Oe=new Cc).data=D,Oe.w=K,Oe.ha=se,Oe.kd=1,K=[0],e(Oe!=null),((D=wr(Oe.data,Oe.w,Oe.ha,null,null,null,K,null,Oe))==0||D==7)&&K[0]&&(D=4),(K=D)==0){if(e(et!=null),xe.data=Oe.data,xe.w=Oe.w+Oe.offset,xe.ha=Oe.ha-Oe.offset,xe.put=ra,xe.ac=xs,xe.bc=dn,xe.ma=et,Oe.xa){if((D=er())==null){et=1;break e}if(function(Bi,ci){var Hi=[0],Ni=[0],Zt=[0];t:for(;;){if(Bi==null)return 0;if(ci==null)return Bi.a=2,0;if(Bi.l=ci,Bi.a=0,$e(Bi.m,ci.data,ci.w,ci.ha),!Et(Bi.m,Hi,Ni,Zt)){Bi.a=3;break t}if(Bi.xb=ef,ci.width=Hi[0],ci.height=Ni[0],!nr(Hi[0],Ni[0],1,Bi,null))break t;return 1}return e(Bi.a!=0),0}(D,xe)){if(xe=(K=fa(xe.width,xe.height,et.Oa,et.ba))==0){t:{xe=D;i:for(;;){if(xe==null){xe=0;break t}if(e(xe.s.yc!=null),e(xe.s.Ya!=null),e(0<xe.s.Wb),e((se=xe.l)!=null),e((Oe=se.ma)!=null),xe.xb!=0){if(xe.ca=Oe.ba,xe.tb=Oe.tb,e(xe.ca!=null),!_o(Oe.Oa,se,Is)){xe.a=2;break i}if(!Sr(xe,se.width)||se.da)break i;if((se.da||Ur(xe.ca.S))&&hi(),11>xe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),xe.ca.f.kb.F!=null&&hi()),xe.Pb&&0<xe.s.ua&&xe.s.vb.X==null&&!kt(xe.s.vb,xe.s.Wa.Xa)){xe.a=1;break i}xe.xb=0}if(!Nt(xe,xe.V,xe.Ba,xe.c,xe.i,se.o,Dt))break i;Oe.Dc=xe.Ma,xe=1;break t}e(xe.a!=0),xe=0}xe=!xe}xe&&(K=D.a)}else K=D.a}else{if((D=new vc)==null){et=1;break e}if(D.Fa=Oe.na,D.P=Oe.P,D.qc=Oe.Sa,ch(D,xe)){if((K=fa(xe.width,xe.height,et.Oa,et.ba))==0){if(D.Aa=0,se=et.Oa,e((Oe=D)!=null),se!=null){if(0<(dt=0>(dt=se.Md)?0:100<dt?255:255*dt/100)){for(wt=Xt=0;4>wt;++wt)12>(xi=Oe.pb[wt]).lc&&(xi.ia=dt*pd[0>xi.lc?0:xi.lc]>>3),Xt|=xi.ia;Xt&&(alert("todo:VP8InitRandom"),Oe.ia=1)}Oe.Ga=se.Id,100<Oe.Ga?Oe.Ga=100:0>Oe.Ga&&(Oe.Ga=0)}Nc(D,xe)||(K=D.a)}}else K=D.a}K==0&&et.Oa!=null&&et.Oa.fd&&(K=oc(et.ba))}et=K}Ke=et!=0?null:11>Ke?st.f.RGBA.eb:st.f.kb.y}else Ke=null;return Ke};var gA=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function b(le,be){for(var we="",oe=0;oe<4;oe++)we+=String.fromCharCode(le[be++]);return we}function _(le,be){return(le[be+0]<<0|le[be+1]<<8|le[be+2]<<16)>>>0}function B(le,be){return(le[be+0]<<0|le[be+1]<<8|le[be+2]<<16|le[be+3]<<24)>>>0}new y;var I=[0],E=[0],R=[],M=new y,G=a,U=function(le,be){var we={},oe=0,me=!1,Le=0,Se=0;if(we.frames=[],!function(Je,lt,mt,Bt){for(var rt=0;rt<Bt;rt++)if(Je[lt+rt]!=mt.charCodeAt(rt))return!0;return!1}(le,be,"RIFF",4)){for(B(le,be+=4),be+=8;be<le.length;){var Me=b(le,be),Re=B(le,be+=4);be+=4;var Ze=Re+(1&Re);switch(Me){case"VP8 ":case"VP8L":we.frames[oe]===void 0&&(we.frames[oe]={}),(Qe=we.frames[oe]).src_off=me?Se:be-8,Qe.src_size=Le+Re+8,oe++,me&&(me=!1,Le=0,Se=0);break;case"VP8X":(Qe=we.header={}).feature_flags=le[be];var $e=be+4;Qe.canvas_width=1+_(le,$e),$e+=3,Qe.canvas_height=1+_(le,$e),$e+=3;break;case"ALPH":me=!0,Le=Ze+8,Se=be-8;break;case"ANIM":(Qe=we.header).bgcolor=B(le,be),$e=be+4,Qe.loop_count=(It=le)[(Ce=$e)+0]<<0|It[Ce+1]<<8,$e+=2;break;case"ANMF":var ct,Qe;(Qe=we.frames[oe]={}).offset_x=2*_(le,be),be+=3,Qe.offset_y=2*_(le,be),be+=3,Qe.width=1+_(le,be),be+=3,Qe.height=1+_(le,be),be+=3,Qe.duration=_(le,be),be+=3,ct=le[be++],Qe.dispose=1&ct,Qe.blend=ct>>1&1}Me!="ANMF"&&(be+=Ze)}var It,Ce;return we}}(G,0);U.response=G,U.rgbaoutput=!0,U.dataurl=!1;var Q=U.header?U.header:null,q=U.frames?U.frames:null;if(Q){Q.loop_counter=Q.loop_count,I=[Q.canvas_height],E=[Q.canvas_width];for(var ne=0;ne<q.length&&q[ne].blend!=0;ne++);}var re=q[0],pe=M.WebPDecodeRGBA(G,re.src_off,re.src_size,E,I);re.rgba=pe,re.imgwidth=E[0],re.imgheight=I[0];for(var Ae=0;Ae<E[0]*I[0]*4;Ae++)R[Ae]=pe[Ae];return this.width=E,this.height=I,this.data=R,this}(function(a){var e=function(){return typeof g1=="function"},t=function(I,E,R,M){var G=4,U=A;switch(M){case a.image_compression.FAST:G=1,U=h;break;case a.image_compression.MEDIUM:G=6,U=r;break;case a.image_compression.SLOW:G=9,U=y}I=s(I,E,R,U);var Q=g1(I,{level:G});return a.__addimage__.arrayBufferToBinaryString(Q)},s=function(I,E,R,M){for(var G,U,Q,q=I.length/E,ne=new Uint8Array(I.length+q),re=_(),pe=0;pe<q;pe+=1){if(Q=pe*E,G=I.subarray(Q,Q+E),M)ne.set(M(G,R,U),Q+pe);else{for(var Ae,le=re.length,be=[];Ae<le;Ae+=1)be[Ae]=re[Ae](G,R,U);var we=B(be.concat());ne.set(be[we],Q+pe)}U=G}return ne},c=function(I){var E=Array.apply([],I);return E.unshift(0),E},h=function(I,E){var R,M=[],G=I.length;M[0]=1;for(var U=0;U<G;U+=1)R=I[U-E]||0,M[U+1]=I[U]-R+256&255;return M},A=function(I,E,R){var M,G=[],U=I.length;G[0]=2;for(var Q=0;Q<U;Q+=1)M=R&&R[Q]||0,G[Q+1]=I[Q]-M+256&255;return G},r=function(I,E,R){var M,G,U=[],Q=I.length;U[0]=3;for(var q=0;q<Q;q+=1)M=I[q-E]||0,G=R&&R[q]||0,U[q+1]=I[q]+256-(M+G>>>1)&255;return U},y=function(I,E,R){var M,G,U,Q,q=[],ne=I.length;q[0]=4;for(var re=0;re<ne;re+=1)M=I[re-E]||0,G=R&&R[re]||0,U=R&&R[re-E]||0,Q=b(M,G,U),q[re+1]=I[re]-Q+256&255;return q},b=function(I,E,R){if(I===E&&E===R)return I;var M=Math.abs(E-R),G=Math.abs(I-R),U=Math.abs(I+E-R-R);return M<=G&&M<=U?I:G<=U?E:R},_=function(){return[c,h,A,r,y]},B=function(I){var E=I.map(function(R){return R.reduce(function(M,G){return M+Math.abs(G)},0)});return E.indexOf(Math.min.apply(null,E))};a.processPNG=function(I,E,R,M){var G,U,Q,q,ne,re,pe,Ae,le,be,we,oe,me,Le,Se,Me=this.decode.FLATE_DECODE,Re="";if(this.__addimage__.isArrayBuffer(I)&&(I=new Uint8Array(I)),this.__addimage__.isArrayBufferView(I)){if(I=(Q=new _z(I)).imgData,U=Q.bits,G=Q.colorSpace,ne=Q.colors,[4,6].indexOf(Q.colorType)!==-1){if(Q.bits===8){le=(Ae=Q.pixelBitlength==32?new Uint32Array(Q.decodePixels().buffer):Q.pixelBitlength==16?new Uint16Array(Q.decodePixels().buffer):new Uint8Array(Q.decodePixels().buffer)).length,we=new Uint8Array(le*Q.colors),be=new Uint8Array(le);var Ze,$e=Q.pixelBitlength-Q.bits;for(Le=0,Se=0;Le<le;Le++){for(me=Ae[Le],Ze=0;Ze<$e;)we[Se++]=me>>>Ze&255,Ze+=Q.bits;be[Le]=me>>>Ze&255}}if(Q.bits===16){le=(Ae=new Uint32Array(Q.decodePixels().buffer)).length,we=new Uint8Array(le*(32/Q.pixelBitlength)*Q.colors),be=new Uint8Array(le*(32/Q.pixelBitlength)),oe=Q.colors>1,Le=0,Se=0;for(var ct=0;Le<le;)me=Ae[Le++],we[Se++]=me>>>0&255,oe&&(we[Se++]=me>>>16&255,me=Ae[Le++],we[Se++]=me>>>0&255),be[ct++]=me>>>16&255;U=8}M!==a.image_compression.NONE&&e()?(I=t(we,Q.width*Q.colors,Q.colors,M),pe=t(be,Q.width,1,M)):(I=we,pe=be,Me=void 0)}if(Q.colorType===3&&(G=this.color_spaces.INDEXED,re=Q.palette,Q.transparency.indexed)){var Qe=Q.transparency.indexed,It=0;for(Le=0,le=Qe.length;Le<le;++Le)It+=Qe[Le];if((It/=255)===le-1&&Qe.indexOf(0)!==-1)q=[Qe.indexOf(0)];else if(It!==le){for(Ae=Q.decodePixels(),be=new Uint8Array(Ae.length),Le=0,le=Ae.length;Le<le;Le++)be[Le]=Qe[Ae[Le]];pe=t(be,Q.width,1)}}var Ce=function(Je){var lt;switch(Je){case a.image_compression.FAST:lt=11;break;case a.image_compression.MEDIUM:lt=13;break;case a.image_compression.SLOW:lt=14;break;default:lt=12}return lt}(M);return Me===this.decode.FLATE_DECODE&&(Re="/Predictor "+Ce+" "),Re+="/Colors "+ne+" /BitsPerComponent "+U+" /Columns "+Q.width,(this.__addimage__.isArrayBuffer(I)||this.__addimage__.isArrayBufferView(I))&&(I=this.__addimage__.arrayBufferToBinaryString(I)),(pe&&this.__addimage__.isArrayBuffer(pe)||this.__addimage__.isArrayBufferView(pe))&&(pe=this.__addimage__.arrayBufferToBinaryString(pe)),{alias:R,data:I,index:E,filter:Me,decodeParameters:Re,transparency:q,palette:re,sMask:pe,predictor:Ce,width:Q.width,height:Q.height,bitsPerComponent:U,colorSpace:G}}}})(Yn.API),function(a){a.processGIF89A=function(e,t,s,c){var h=new xz(e),A=h.width,r=h.height,y=[];h.decodeAndBlitFrameRGBA(0,y);var b={data:y,width:A,height:r},_=new Ib(100).encode(b,100);return a.processJPEG.call(this,_,t,s,c)},a.processGIF87A=a.processGIF89A}(Yn.API),Qd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var a=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(a);for(var e=0;e<a;e++){var t=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),h=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:c,green:s,blue:t,quad:h}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Qd.prototype.parseBGR=function(){this.pos=this.offset;try{var a="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[a]()}catch(t){da.log("bit decode error:"+t)}},Qd.prototype.bit1=function(){var a,e=Math.ceil(this.width/8),t=e%4;for(a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,c=0;c<e;c++)for(var h=this.datav.getUint8(this.pos++,!0),A=s*this.width*4+8*c*4,r=0;r<8&&8*c+r<this.width;r++){var y=this.palette[h>>7-r&1];this.data[A+4*r]=y.blue,this.data[A+4*r+1]=y.green,this.data[A+4*r+2]=y.red,this.data[A+4*r+3]=255}t!==0&&(this.pos+=4-t)}},Qd.prototype.bit4=function(){for(var a=Math.ceil(this.width/2),e=a%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,c=0;c<a;c++){var h=this.datav.getUint8(this.pos++,!0),A=s*this.width*4+2*c*4,r=h>>4,y=15&h,b=this.palette[r];if(this.data[A]=b.blue,this.data[A+1]=b.green,this.data[A+2]=b.red,this.data[A+3]=255,2*c+1>=this.width)break;b=this.palette[y],this.data[A+4]=b.blue,this.data[A+4+1]=b.green,this.data[A+4+2]=b.red,this.data[A+4+3]=255}e!==0&&(this.pos+=4-e)}},Qd.prototype.bit8=function(){for(var a=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var c=this.datav.getUint8(this.pos++,!0),h=t*this.width*4+4*s;if(c<this.palette.length){var A=this.palette[c];this.data[h]=A.red,this.data[h+1]=A.green,this.data[h+2]=A.blue,this.data[h+3]=255}else this.data[h]=255,this.data[h+1]=255,this.data[h+2]=255,this.data[h+3]=255}a!==0&&(this.pos+=4-a)}},Qd.prototype.bit15=function(){for(var a=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,c=0;c<this.width;c++){var h=this.datav.getUint16(this.pos,!0);this.pos+=2;var A=(h&e)/e*255|0,r=(h>>5&e)/e*255|0,y=(h>>10&e)/e*255|0,b=h>>15?255:0,_=s*this.width*4+4*c;this.data[_]=y,this.data[_+1]=r,this.data[_+2]=A,this.data[_+3]=b}this.pos+=a}},Qd.prototype.bit16=function(){for(var a=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var c=this.bottom_up?s:this.height-1-s,h=0;h<this.width;h++){var A=this.datav.getUint16(this.pos,!0);this.pos+=2;var r=(A&e)/e*255|0,y=(A>>5&t)/t*255|0,b=(A>>11)/e*255|0,_=c*this.width*4+4*h;this.data[_]=b,this.data[_+1]=y,this.data[_+2]=r,this.data[_+3]=255}this.pos+=a}},Qd.prototype.bit24=function(){for(var a=this.height-1;a>=0;a--){for(var e=this.bottom_up?a:this.height-1-a,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),h=this.datav.getUint8(this.pos++,!0),A=e*this.width*4+4*t;this.data[A]=h,this.data[A+1]=c,this.data[A+2]=s,this.data[A+3]=255}this.pos+=this.width%4}},Qd.prototype.bit32=function(){for(var a=this.height-1;a>=0;a--)for(var e=this.bottom_up?a:this.height-1-a,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),h=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),r=e*this.width*4+4*t;this.data[r]=h,this.data[r+1]=c,this.data[r+2]=s,this.data[r+3]=A}},Qd.prototype.getData=function(){return this.data},function(a){a.processBMP=function(e,t,s,c){var h=new Qd(e,!1),A=h.width,r=h.height,y={data:h.getData(),width:A,height:r},b=new Ib(100).encode(y,100);return a.processJPEG.call(this,b,t,s,c)}}(Yn.API),GE.prototype.getData=function(){return this.data},function(a){a.processWEBP=function(e,t,s,c){var h=new GE(e),A=h.width,r=h.height,y={data:h.getData(),width:A,height:r},b=new Ib(100).encode(y,100);return a.processJPEG.call(this,b,t,s,c)}}(Yn.API),Yn.API.processRGBA=function(a,e,t){for(var s=a.data,c=s.length,h=new Uint8Array(c/4*3),A=new Uint8Array(c/4),r=0,y=0,b=0;b<c;b+=4){var _=s[b],B=s[b+1],I=s[b+2],E=s[b+3];h[r++]=_,h[r++]=B,h[r++]=I,A[y++]=E}var R=this.__addimage__.arrayBufferToBinaryString(h);return{alpha:this.__addimage__.arrayBufferToBinaryString(A),data:R,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:a.width,height:a.height}},Yn.API.setLanguage=function(a){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[a]!==void 0&&(this.internal.languageSettings.languageCode=a,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Jg=Yn.API,y0=Jg.getCharWidthsArray=function(a,e){var t,s,c=(e=e||{}).font||this.internal.getFont(),h=e.fontSize||this.internal.getFontSize(),A=e.charSpace||this.internal.getCharSpace(),r=e.widths?e.widths:c.metadata.Unicode.widths,y=r.fof?r.fof:1,b=e.kerning?e.kerning:c.metadata.Unicode.kerning,_=b.fof?b.fof:1,B=e.doKerning!==!1,I=0,E=a.length,R=0,M=r[0]||y,G=[];for(t=0;t<E;t++)s=a.charCodeAt(t),typeof c.metadata.widthOfString=="function"?G.push((c.metadata.widthOfGlyph(c.metadata.characterToGlyph(s))+A*(1e3/h)||0)/1e3):(I=B&&Wo(b[s])==="object"&&!isNaN(parseInt(b[s][R],10))?b[s][R]/_:0,G.push((r[s]||M)/y+I)),R=s;return G},jE=Jg.getStringUnitWidth=function(a,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),c=e.charSpace||this.internal.getCharSpace();return Jg.processArabic&&(a=Jg.processArabic(a)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(a,t,c)/t:y0.apply(this,arguments).reduce(function(h,A){return h+A},0)},HE=function(a,e,t,s){for(var c=[],h=0,A=a.length,r=0;h!==A&&r+e[h]<t;)r+=e[h],h++;c.push(a.slice(0,h));var y=h;for(r=0;h!==A;)r+e[h]>s&&(c.push(a.slice(y,h)),r=0,y=h),r+=e[h],h++;return y!==h&&c.push(a.slice(y,h)),c},QE=function(a,e,t){t||(t={});var s,c,h,A,r,y,b,_=[],B=[_],I=t.textIndent||0,E=0,R=0,M=a.split(" "),G=y0.apply(this,[" ",t])[0];if(y=t.lineIndent===-1?M[0].length+2:t.lineIndent||0){var U=Array(y).join(" "),Q=[];M.map(function(ne){(ne=ne.split(/\s*\n/)).length>1?Q=Q.concat(ne.map(function(re,pe){return(pe&&re.length?`
`:"")+re})):Q.push(ne[0])}),M=Q,y=jE.apply(this,[U,t])}for(h=0,A=M.length;h<A;h++){var q=0;if(s=M[h],y&&s[0]==`
`&&(s=s.substr(1),q=1),I+E+(R=(c=y0.apply(this,[s,t])).reduce(function(ne,re){return ne+re},0))>e||q){if(R>e){for(r=HE.apply(this,[s,c,e-(I+E),e]),_.push(r.shift()),_=[r.pop()];r.length;)B.push([r.shift()]);R=c.slice(s.length-(_[0]?_[0].length:0)).reduce(function(ne,re){return ne+re},0)}else _=[s];B.push(_),I=R+y,E=G}else _.push(s),I+=E+R,E=G}return b=y?function(ne,re){return(re?U:"")+ne.join(" ")}:function(ne){return ne.join(" ")},B.map(b)},Jg.splitTextToSize=function(a,e,t){var s,c=(t=t||{}).fontSize||this.internal.getFontSize(),h=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var B=this.internal.getFont(_.fontName,_.fontStyle);return B.metadata.Unicode?{widths:B.metadata.Unicode.widths||{0:1},kerning:B.metadata.Unicode.kerning||{}}:{font:B.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);s=Array.isArray(a)?a:String(a).split(/\r?\n/);var A=1*this.internal.scaleFactor*e/c;h.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/c:0,h.lineIndent=t.lineIndent;var r,y,b=[];for(r=0,y=s.length;r<y;r++)b=b.concat(QE.apply(this,[s[r],A,h]));return b},function(a){a.__fontmetrics__=a.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},s={},c=0;c<e.length;c++)t[e[c]]="0123456789abcdef"[c],s["0123456789abcdef"[c]]=e[c];var h=function(B){return"0x"+parseInt(B,10).toString(16)},A=a.__fontmetrics__.compress=function(B){var I,E,R,M,G=["{"];for(var U in B){if(I=B[U],isNaN(parseInt(U,10))?E="'"+U+"'":(U=parseInt(U,10),E=(E=h(U).slice(2)).slice(0,-1)+s[E.slice(-1)]),typeof I=="number")I<0?(R=h(I).slice(3),M="-"):(R=h(I).slice(2),M=""),R=M+R.slice(0,-1)+s[R.slice(-1)];else{if(Wo(I)!=="object")throw new Error("Don't know what to do with value type "+Wo(I)+".");R=A(I)}G.push(E+R)}return G.push("}"),G.join("")},r=a.__fontmetrics__.uncompress=function(B){if(typeof B!="string")throw new Error("Invalid argument passed to uncompress.");for(var I,E,R,M,G={},U=1,Q=G,q=[],ne="",re="",pe=B.length-1,Ae=1;Ae<pe;Ae+=1)(M=B[Ae])=="'"?I?(R=I.join(""),I=void 0):I=[]:I?I.push(M):M=="{"?(q.push([Q,R]),Q={},R=void 0):M=="}"?((E=q.pop())[0][E[1]]=Q,R=void 0,Q=E[0]):M=="-"?U=-1:R===void 0?t.hasOwnProperty(M)?(ne+=t[M],R=parseInt(ne,16)*U,U=1,ne=""):ne+=M:t.hasOwnProperty(M)?(re+=t[M],Q[R]=parseInt(re,16)*U,U=1,R=void 0,re=""):re+=M;return G},y={codePages:["WinAnsiEncoding"],WinAnsiEncoding:r("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},b={Unicode:{Courier:y,"Courier-Bold":y,"Courier-BoldOblique":y,"Courier-Oblique":y,Helvetica:y,"Helvetica-Bold":y,"Helvetica-BoldOblique":y,"Helvetica-Oblique":y,"Times-Roman":y,"Times-Bold":y,"Times-BoldItalic":y,"Times-Italic":y}},_={Unicode:{"Courier-Oblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":r("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":r("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:r("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:r("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":r("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":r("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};a.events.push(["addFont",function(B){var I=B.font,E=_.Unicode[I.postScriptName];E&&(I.metadata.Unicode={},I.metadata.Unicode.widths=E.widths,I.metadata.Unicode.kerning=E.kerning);var R=b.Unicode[I.postScriptName];R&&(I.metadata.Unicode.encoding=R,I.encoding=R.codePages[0])}])}(Yn.API),function(a){var e=function(t){for(var s=t.length,c=new Uint8Array(s),h=0;h<s;h++)c[h]=t.charCodeAt(h);return c};a.API.events.push(["addFont",function(t){var s=void 0,c=t.font,h=t.instance;if(!c.isStandardFont){if(h===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");if(typeof(s=h.existsFileInVFS(c.postScriptName)===!1?h.loadFile(c.postScriptName):h.getFileFromVFS(c.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");(function(A,r){r=/^\x00\x01\x00\x00/.test(r)?e(r):e(My(r)),A.metadata=a.API.TTFFont.open(r),A.metadata.Unicode=A.metadata.Unicode||{encoding:{},kerning:{},widths:[]},A.metadata.glyIdsUsed=[0]})(c,s)}}])}(Yn),function(a){function e(){return(es.canvg?Promise.resolve(es.canvg):Qy(()=>import("./index.es-DWREBwjF.js"),[],import.meta.url)).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}Yn.API.addSvgAsImage=function(t,s,c,h,A,r,y,b){if(isNaN(s)||isNaN(c))throw da.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(h)||isNaN(A))throw da.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=h,_.height=A;var B=_.getContext("2d");B.fillStyle="#fff",B.fillRect(0,0,_.width,_.height);var I={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},E=this;return e().then(function(R){return R.fromString(B,t,I)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(I)}).then(function(){E.addImage(_.toDataURL("image/jpeg",1),s,c,h,A,y,b)})}}(),Yn.API.putTotalPages=function(a){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(a,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(a,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var c=0;c<this.internal.pages[s].length;c++)this.internal.pages[s][c]=this.internal.pages[s][c].replace(e,t);return this},Yn.API.viewerPreferences=function(a,e){var t;a=a||{},e=e||!1;var s,c,h,A={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},r=Object.keys(A),y=[],b=0,_=0,B=0;function I(R,M){var G,U=!1;for(G=0;G<R.length;G+=1)R[G]===M&&(U=!0);return U}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(A)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,a==="reset"||e===!0){var E=r.length;for(B=0;B<E;B+=1)t[r[B]].value=t[r[B]].defaultValue,t[r[B]].explicitSet=!1}if(Wo(a)==="object"){for(c in a)if(h=a[c],I(r,c)&&h!==void 0){if(t[c].type==="boolean"&&typeof h=="boolean")t[c].value=h;else if(t[c].type==="name"&&I(t[c].valueSet,h))t[c].value=h;else if(t[c].type==="integer"&&Number.isInteger(h))t[c].value=h;else if(t[c].type==="array"){for(b=0;b<h.length;b+=1)if(s=!0,h[b].length===1&&typeof h[b][0]=="number")y.push(String(h[b]-1));else if(h[b].length>1){for(_=0;_<h[b].length;_+=1)typeof h[b][_]!="number"&&(s=!1);s===!0&&y.push([h[b][0]-1,h[b][1]-1].join(" "))}t[c].value="["+y.join(" ")+"]"}else t[c].value=t[c].defaultValue;t[c].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var R,M=[];for(R in t)t[R].explicitSet===!0&&(t[R].type==="name"?M.push("/"+R+" /"+t[R].value):M.push("/"+R+" "+t[R].value));M.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+M.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(a){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',c=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),h=unescape(encodeURIComponent(s)),A=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),y=unescape(encodeURIComponent("</x:xmpmeta>")),b=h.length+A.length+r.length+c.length+y.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+b+" >>"),this.internal.write("stream"),this.internal.write(c+h+A+r+y),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};a.addMetadata=function(s,c){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:c||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(Yn.API),function(a){var e=a.API,t=e.pdfEscape16=function(h,A){for(var r,y=A.metadata.Unicode.widths,b=["","0","00","000","0000"],_=[""],B=0,I=h.length;B<I;++B){if(r=A.metadata.characterToGlyph(h.charCodeAt(B)),A.metadata.glyIdsUsed.push(r),A.metadata.toUnicode[r]=h.charCodeAt(B),y.indexOf(r)==-1&&(y.push(r),y.push([parseInt(A.metadata.widthOfGlyph(r),10)])),r=="0")return _.join("");r=r.toString(16),_.push(b[4-r.length],r)}return _.join("")},s=function(h){var A,r,y,b,_,B,I;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,y=[],B=0,I=(r=Object.keys(h).sort(function(E,R){return E-R})).length;B<I;B++)A=r[B],y.length>=100&&(_+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar`,y=[]),h[A]!==void 0&&h[A]!==null&&typeof h[A].toString=="function"&&(b=("0000"+h[A].toString(16)).slice(-4),A=("0000"+(+A).toString(16)).slice(-4),y.push("<"+A+"><"+b+">"));return y.length&&(_+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(h){(function(A){var r=A.font,y=A.out,b=A.newObject,_=A.putStream;if(r.metadata instanceof a.API.TTFFont&&r.encoding==="Identity-H"){for(var B=r.metadata.Unicode.widths,I=r.metadata.subset.encode(r.metadata.glyIdsUsed,1),E="",R=0;R<I.length;R++)E+=String.fromCharCode(I[R]);var M=b();_({data:E,addLength1:!0,objectId:M}),y("endobj");var G=b();_({data:s(r.metadata.toUnicode),addLength1:!0,objectId:G}),y("endobj");var U=b();y("<<"),y("/Type /FontDescriptor"),y("/FontName /"+rm(r.fontName)),y("/FontFile2 "+M+" 0 R"),y("/FontBBox "+a.API.PDFObject.convert(r.metadata.bbox)),y("/Flags "+r.metadata.flags),y("/StemV "+r.metadata.stemV),y("/ItalicAngle "+r.metadata.italicAngle),y("/Ascent "+r.metadata.ascender),y("/Descent "+r.metadata.decender),y("/CapHeight "+r.metadata.capHeight),y(">>"),y("endobj");var Q=b();y("<<"),y("/Type /Font"),y("/BaseFont /"+rm(r.fontName)),y("/FontDescriptor "+U+" 0 R"),y("/W "+a.API.PDFObject.convert(B)),y("/CIDToGIDMap /Identity"),y("/DW 1000"),y("/Subtype /CIDFontType2"),y("/CIDSystemInfo"),y("<<"),y("/Supplement 0"),y("/Registry (Adobe)"),y("/Ordering ("+r.encoding+")"),y(">>"),y(">>"),y("endobj"),r.objectNumber=b(),y("<<"),y("/Type /Font"),y("/Subtype /Type0"),y("/ToUnicode "+G+" 0 R"),y("/BaseFont /"+rm(r.fontName)),y("/Encoding /"+r.encoding),y("/DescendantFonts ["+Q+" 0 R]"),y(">>"),y("endobj"),r.isAlreadyPutted=!0}})(h)}]),e.events.push(["putFont",function(h){(function(A){var r=A.font,y=A.out,b=A.newObject,_=A.putStream;if(r.metadata instanceof a.API.TTFFont&&r.encoding==="WinAnsiEncoding"){for(var B=r.metadata.rawData,I="",E=0;E<B.length;E++)I+=String.fromCharCode(B[E]);var R=b();_({data:I,addLength1:!0,objectId:R}),y("endobj");var M=b();_({data:s(r.metadata.toUnicode),addLength1:!0,objectId:M}),y("endobj");var G=b();y("<<"),y("/Descent "+r.metadata.decender),y("/CapHeight "+r.metadata.capHeight),y("/StemV "+r.metadata.stemV),y("/Type /FontDescriptor"),y("/FontFile2 "+R+" 0 R"),y("/Flags 96"),y("/FontBBox "+a.API.PDFObject.convert(r.metadata.bbox)),y("/FontName /"+rm(r.fontName)),y("/ItalicAngle "+r.metadata.italicAngle),y("/Ascent "+r.metadata.ascender),y(">>"),y("endobj"),r.objectNumber=b();for(var U=0;U<r.metadata.hmtx.widths.length;U++)r.metadata.hmtx.widths[U]=parseInt(r.metadata.hmtx.widths[U]*(1e3/r.metadata.head.unitsPerEm));y("<</Subtype/TrueType/Type/Font/ToUnicode "+M+" 0 R/BaseFont/"+rm(r.fontName)+"/FontDescriptor "+G+" 0 R/Encoding/"+r.encoding+" /FirstChar 29 /LastChar 255 /Widths "+a.API.PDFObject.convert(r.metadata.hmtx.widths)+">>"),y("endobj"),r.isAlreadyPutted=!0}})(h)}]);var c=function(h){var A,r=h.text||"",y=h.x,b=h.y,_=h.options||{},B=h.mutex||{},I=B.pdfEscape,E=B.activeFontKey,R=B.fonts,M=E,G="",U=0,Q="",q=R[M].encoding;if(R[M].encoding!=="Identity-H")return{text:r,x:y,y:b,options:_,mutex:B};for(Q=r,M=E,Array.isArray(r)&&(Q=r[0]),U=0;U<Q.length;U+=1)R[M].metadata.hasOwnProperty("cmap")&&(A=R[M].metadata.cmap.unicode.codeMap[Q[U].charCodeAt(0)]),A||Q[U].charCodeAt(0)<256&&R[M].metadata.hasOwnProperty("Unicode")?G+=Q[U]:G+="";var ne="";return parseInt(M.slice(1))<14||q==="WinAnsiEncoding"?ne=I(G,M).split("").map(function(re){return re.charCodeAt(0).toString(16)}).join(""):q==="Identity-H"&&(ne=t(G,R[M])),B.isHex=!0,{text:ne,x:y,y:b,options:_,mutex:B}};e.events.push(["postProcessText",function(h){var A=h.text||"",r=[],y={text:A,x:h.x,y:h.y,options:h.options,mutex:h.mutex};if(Array.isArray(A)){var b=0;for(b=0;b<A.length;b+=1)Array.isArray(A[b])&&A[b].length===3?r.push([c(Object.assign({},y,{text:A[b][0]})).text,A[b][1],A[b][2]]):r.push(c(Object.assign({},y,{text:A[b]})).text);h.text=r}else h.text=c(Object.assign({},y,{text:A})).text}])}(Yn),function(a){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};a.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},a.addFileToVFS=function(t,s){return e.call(this),this.internal.vFS[t]=s,this},a.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(Yn.API),function(a){a.__bidiEngine__=a.prototype.__bidiEngine__=function(s){var c,h,A,r,y,b,_,B=e,I=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],E=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],R={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},M={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},G=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],U=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Q=!1,q=0;this.__bidiEngine__={};var ne=function(oe){var me=oe.charCodeAt(),Le=me>>8,Se=M[Le];return Se!==void 0?B[256*Se+(255&me)]:Le===252||Le===253?"AL":U.test(Le)?"L":Le===8?"R":"N"},re=function(oe){for(var me,Le=0;Le<oe.length;Le++){if((me=ne(oe.charAt(Le)))==="L")return!1;if(me==="R")return!0}return!1},pe=function(oe,me,Le,Se){var Me,Re,Ze,$e,ct=me[Se];switch(ct){case"L":case"R":Q=!1;break;case"N":case"AN":break;case"EN":Q&&(ct="AN");break;case"AL":Q=!0,ct="R";break;case"WS":ct="N";break;case"CS":Se<1||Se+1>=me.length||(Me=Le[Se-1])!=="EN"&&Me!=="AN"||(Re=me[Se+1])!=="EN"&&Re!=="AN"?ct="N":Q&&(Re="AN"),ct=Re===Me?Re:"N";break;case"ES":ct=(Me=Se>0?Le[Se-1]:"B")==="EN"&&Se+1<me.length&&me[Se+1]==="EN"?"EN":"N";break;case"ET":if(Se>0&&Le[Se-1]==="EN"){ct="EN";break}if(Q){ct="N";break}for(Ze=Se+1,$e=me.length;Ze<$e&&me[Ze]==="ET";)Ze++;ct=Ze<$e&&me[Ze]==="EN"?"EN":"N";break;case"NSM":if(A&&!r){for($e=me.length,Ze=Se+1;Ze<$e&&me[Ze]==="NSM";)Ze++;if(Ze<$e){var Qe=oe[Se],It=Qe>=1425&&Qe<=2303||Qe===64286;if(Me=me[Ze],It&&(Me==="R"||Me==="AL")){ct="R";break}}}ct=Se<1||(Me=me[Se-1])==="B"?"N":Le[Se-1];break;case"B":Q=!1,c=!0,ct=q;break;case"S":h=!0,ct="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Q=!1;break;case"BN":ct="N"}return ct},Ae=function(oe,me,Le){var Se=oe.split("");return Le&&le(Se,Le,{hiLevel:q}),Se.reverse(),me&&me.reverse(),Se.join("")},le=function(oe,me,Le){var Se,Me,Re,Ze,$e,ct=-1,Qe=oe.length,It=0,Ce=[],Je=q?E:I,lt=[];for(Q=!1,c=!1,h=!1,Me=0;Me<Qe;Me++)lt[Me]=ne(oe[Me]);for(Re=0;Re<Qe;Re++){if($e=It,Ce[Re]=pe(oe,lt,Ce,Re),Se=240&(It=Je[$e][R[Ce[Re]]]),It&=15,me[Re]=Ze=Je[It][5],Se>0)if(Se===16){for(Me=ct;Me<Re;Me++)me[Me]=1;ct=-1}else ct=-1;if(Je[It][6])ct===-1&&(ct=Re);else if(ct>-1){for(Me=ct;Me<Re;Me++)me[Me]=Ze;ct=-1}lt[Re]==="B"&&(me[Re]=0),Le.hiLevel|=Ze}h&&function(mt,Bt,rt){for(var St=0;St<rt;St++)if(mt[St]==="S"){Bt[St]=q;for(var vt=St-1;vt>=0&&mt[vt]==="WS";vt--)Bt[vt]=q}}(lt,me,Qe)},be=function(oe,me,Le,Se,Me){if(!(Me.hiLevel<oe)){if(oe===1&&q===1&&!c)return me.reverse(),void(Le&&Le.reverse());for(var Re,Ze,$e,ct,Qe=me.length,It=0;It<Qe;){if(Se[It]>=oe){for($e=It+1;$e<Qe&&Se[$e]>=oe;)$e++;for(ct=It,Ze=$e-1;ct<Ze;ct++,Ze--)Re=me[ct],me[ct]=me[Ze],me[Ze]=Re,Le&&(Re=Le[ct],Le[ct]=Le[Ze],Le[Ze]=Re);It=$e}It++}}},we=function(oe,me,Le){var Se=oe.split(""),Me={hiLevel:q};return Le||(Le=[]),le(Se,Le,Me),function(Re,Ze,$e){if($e.hiLevel!==0&&_)for(var ct,Qe=0;Qe<Re.length;Qe++)Ze[Qe]===1&&(ct=G.indexOf(Re[Qe]))>=0&&(Re[Qe]=G[ct+1])}(Se,Le,Me),be(2,Se,me,Le,Me),be(1,Se,me,Le,Me),Se.join("")};return this.__bidiEngine__.doBidiReorder=function(oe,me,Le){if(function(Me,Re){if(Re)for(var Ze=0;Ze<Me.length;Ze++)Re[Ze]=Ze;r===void 0&&(r=re(Me)),b===void 0&&(b=re(Me))}(oe,me),A||!y||b)if(A&&y&&r^b)q=r?1:0,oe=Ae(oe,me,Le);else if(!A&&y&&b)q=r?1:0,oe=we(oe,me,Le),oe=Ae(oe,me);else if(!A||r||y||b){if(A&&!y&&r^b)oe=Ae(oe,me),r?(q=0,oe=we(oe,me,Le)):(q=1,oe=we(oe,me,Le),oe=Ae(oe,me));else if(A&&r&&!y&&b)q=1,oe=we(oe,me,Le),oe=Ae(oe,me);else if(!A&&!y&&r^b){var Se=_;r?(q=1,oe=we(oe,me,Le),q=0,_=!1,oe=we(oe,me,Le),_=Se):(q=0,oe=we(oe,me,Le),oe=Ae(oe,me),q=1,_=!1,oe=we(oe,me,Le),_=Se,oe=Ae(oe,me))}}else q=0,oe=we(oe,me,Le);else q=r?1:0,oe=we(oe,me,Le);return oe},this.__bidiEngine__.setOptions=function(oe){oe&&(A=oe.isInputVisual,y=oe.isOutputVisual,r=oe.isInputRtl,b=oe.isOutputRtl,_=oe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new a.__bidiEngine__({isInputVisual:!0});a.API.events.push(["postProcessText",function(s){var c=s.text;s.x,s.y;var h=s.options||{};s.mutex,h.lang;var A=[];if(h.isInputVisual=typeof h.isInputVisual!="boolean"||h.isInputVisual,t.setOptions(h),Object.prototype.toString.call(c)==="[object Array]"){var r=0;for(A=[],r=0;r<c.length;r+=1)Object.prototype.toString.call(c[r])==="[object Array]"?A.push([t.doBidiReorder(c[r][0]),c[r][1],c[r][2]]):A.push([t.doBidiReorder(c[r])]);s.text=A}else s.text=t.doBidiReorder(c);t.setOptions({isInputVisual:!0})}])}(Yn),Yn.API.TTFFont=function(){function a(e){var t;if(this.rawData=e,t=this.contents=new kp(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Dz(this),this.registerTTF()}return a.open=function(e){return new a(e)},a.prototype.parse=function(){return this.directory=new bz(this.contents),this.head=new Bz(this),this.name=new Tz(this),this.cmap=new $T(this),this.toUnicode={},this.hhea=new Cz(this),this.maxp=new Fz(this),this.hmtx=new Lz(this),this.post=new Ez(this),this.os2=new Sz(this),this.loca=new Rz(this),this.glyf=new Mz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},a.prototype.registerTTF=function(){var e,t,s,c,h;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var A,r,y,b;for(b=[],A=0,r=(y=this.bbox).length;A<r;A++)e=y[A],b.push(Math.round(e*this.scaleFactor));return b}).call(this),this.stemV=0,this.post.exists?(s=255&(c=this.post.italic_angle),(32768&(t=c>>16))!=0&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(h=this.familyClass)===1||h===2||h===3||h===4||h===5||h===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},a.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},a.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},a.prototype.widthOfString=function(e,t,s){var c,h,A,r;for(A=0,h=0,r=(e=""+e).length;0<=r?h<r:h>r;h=0<=r?++h:--h)c=e.charCodeAt(h),A+=this.widthOfGlyph(this.characterToGlyph(c))+s*(1e3/t)||0;return A*(t/1e3)},a.prototype.lineHeight=function(e,t){var s;return t==null&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},a}();var eA,kp=function(){function a(e){this.data=e??[],this.pos=0,this.length=this.data.length}return a.prototype.readByte=function(){return this.data[this.pos++]},a.prototype.writeByte=function(e){return this.data[this.pos++]=e},a.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},a.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},a.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},a.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},a.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},a.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},a.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},a.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},a.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},a.prototype.writeString=function(e){var t,s,c;for(c=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)c.push(this.writeByte(e.charCodeAt(t)));return c},a.prototype.readShort=function(){return this.readInt16()},a.prototype.writeShort=function(e){return this.writeInt16(e)},a.prototype.readLongLong=function(){var e,t,s,c,h,A,r,y;return e=this.readByte(),t=this.readByte(),s=this.readByte(),c=this.readByte(),h=this.readByte(),A=this.readByte(),r=this.readByte(),y=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^c)+16777216*(255^h)+65536*(255^A)+256*(255^r)+(255^y)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*c+16777216*h+65536*A+256*r+y},a.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},a.prototype.readInt=function(){return this.readInt32()},a.prototype.writeInt=function(e){return this.writeInt32(e)},a.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},a.prototype.write=function(e){var t,s,c,h;for(h=[],s=0,c=e.length;s<c;s++)t=e[s],h.push(this.writeByte(t));return h},a}(),bz=function(){var a;function e(t){var s,c,h;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},c=0,h=this.tableCount;0<=h?c<h:c>h;c=0<=h?++c:--c)s={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(t){var s,c,h,A,r,y,b,_,B,I,E,R,M;for(M in E=Object.keys(t).length,y=Math.log(2),B=16*Math.floor(Math.log(E)/y),A=Math.floor(B/y),_=16*E-B,(c=new kp).writeInt(this.scalarType),c.writeShort(E),c.writeShort(B),c.writeShort(A),c.writeShort(_),h=16*E,b=c.pos+h,r=null,R=[],t)for(I=t[M],c.writeString(M),c.writeInt(a(I)),c.writeInt(b),c.writeInt(I.length),R=R.concat(I),M==="head"&&(r=b),b+=I.length;b%4;)R.push(0),b++;return c.write(R),s=2981146554-a(c.data),c.pos=r+8,c.writeUInt32(s),c.data},a=function(t){var s,c,h,A;for(t=ZT.call(t);t.length%4;)t.push(0);for(h=new kp(t),c=0,s=0,A=t.length;s<A;s=s+=4)c+=h.readUInt32();return 4294967295&c},e}(),wz={}.hasOwnProperty,qA=function(a,e){for(var t in e)wz.call(e,t)&&(a[t]=e[t]);function s(){this.constructor=a}return s.prototype=e.prototype,a.prototype=new s,a.__super__=e.prototype,a};eA=function(){function a(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return a.prototype.parse=function(){},a.prototype.encode=function(){},a.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},a}();var Bz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var s;return(s=new kp).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(t),s.writeShort(this.glyphDataFormat),s.data},e}(),WE=function(){function a(e,t){var s,c,h,A,r,y,b,_,B,I,E,R,M,G,U,Q,q;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),B=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(y=0;y<256;++y)this.codeMap[y]=e.readByte();break;case 4:for(E=e.readUInt16(),I=E/2,e.pos+=6,h=function(){var ne,re;for(re=[],y=ne=0;0<=I?ne<I:ne>I;y=0<=I?++ne:--ne)re.push(e.readUInt16());return re}(),e.pos+=2,M=function(){var ne,re;for(re=[],y=ne=0;0<=I?ne<I:ne>I;y=0<=I?++ne:--ne)re.push(e.readUInt16());return re}(),b=function(){var ne,re;for(re=[],y=ne=0;0<=I?ne<I:ne>I;y=0<=I?++ne:--ne)re.push(e.readUInt16());return re}(),_=function(){var ne,re;for(re=[],y=ne=0;0<=I?ne<I:ne>I;y=0<=I?++ne:--ne)re.push(e.readUInt16());return re}(),c=(this.length-e.pos+this.offset)/2,r=function(){var ne,re;for(re=[],y=ne=0;0<=c?ne<c:ne>c;y=0<=c?++ne:--ne)re.push(e.readUInt16());return re}(),y=U=0,q=h.length;U<q;y=++U)for(G=h[y],s=Q=R=M[y];R<=G?Q<=G:Q>=G;s=R<=G?++Q:--Q)_[y]===0?A=s+b[y]:(A=r[_[y]/2+(s-R)-(I-y)]||0)!==0&&(A+=b[y]),this.codeMap[s]=65535&A}e.pos=B}return a.encode=function(e,t){var s,c,h,A,r,y,b,_,B,I,E,R,M,G,U,Q,q,ne,re,pe,Ae,le,be,we,oe,me,Le,Se,Me,Re,Ze,$e,ct,Qe,It,Ce,Je,lt,mt,Bt,rt,St,vt,Gt,mi,ze;switch(Se=new kp,A=Object.keys(e).sort(function(Ve,kt){return Ve-kt}),t){case"macroman":for(M=0,G=function(){var Ve=[];for(R=0;R<256;++R)Ve.push(0);return Ve}(),Q={0:0},h={},Me=0,ct=A.length;Me<ct;Me++)Q[vt=e[c=A[Me]]]==null&&(Q[vt]=++M),h[c]={old:e[c],new:Q[e[c]]},G[c]=Q[e[c]];return Se.writeUInt16(1),Se.writeUInt16(0),Se.writeUInt32(12),Se.writeUInt16(0),Se.writeUInt16(262),Se.writeUInt16(0),Se.write(G),{charMap:h,subtable:Se.data,maxGlyphID:M+1};case"unicode":for(me=[],B=[],q=0,Q={},s={},U=b=null,Re=0,Qe=A.length;Re<Qe;Re++)Q[re=e[c=A[Re]]]==null&&(Q[re]=++q),s[c]={old:re,new:Q[re]},r=Q[re]-c,U!=null&&r===b||(U&&B.push(U),me.push(c),b=r),U=c;for(U&&B.push(U),B.push(65535),me.push(65535),we=2*(be=me.length),le=2*Math.pow(Math.log(be)/Math.LN2,2),I=Math.log(le/2)/Math.LN2,Ae=2*be-le,y=[],pe=[],E=[],R=Ze=0,It=me.length;Ze<It;R=++Ze){if(oe=me[R],_=B[R],oe===65535){y.push(0),pe.push(0);break}if(oe-(Le=s[oe].new)>=32768)for(y.push(0),pe.push(2*(E.length+be-R)),c=$e=oe;oe<=_?$e<=_:$e>=_;c=oe<=_?++$e:--$e)E.push(s[c].new);else y.push(Le-oe),pe.push(0)}for(Se.writeUInt16(3),Se.writeUInt16(1),Se.writeUInt32(12),Se.writeUInt16(4),Se.writeUInt16(16+8*be+2*E.length),Se.writeUInt16(0),Se.writeUInt16(we),Se.writeUInt16(le),Se.writeUInt16(I),Se.writeUInt16(Ae),rt=0,Ce=B.length;rt<Ce;rt++)c=B[rt],Se.writeUInt16(c);for(Se.writeUInt16(0),St=0,Je=me.length;St<Je;St++)c=me[St],Se.writeUInt16(c);for(Gt=0,lt=y.length;Gt<lt;Gt++)r=y[Gt],Se.writeUInt16(r);for(mi=0,mt=pe.length;mi<mt;mi++)ne=pe[mi],Se.writeUInt16(ne);for(ze=0,Bt=E.length;ze<Bt;ze++)M=E[ze],Se.writeUInt16(M);return{charMap:s,subtable:Se.data,maxGlyphID:q+1}}},a}(),$T=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="cmap",e.prototype.parse=function(t){var s,c,h;for(t.pos=this.offset,this.version=t.readUInt16(),h=t.readUInt16(),this.tables=[],this.unicode=null,c=0;0<=h?c<h:c>h;c=0<=h?++c:--c)s=new WE(t,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(t,s){var c,h;return s==null&&(s="macroman"),c=WE.encode(t,s),(h=new kp).writeUInt16(0),h.writeUInt16(1),c.table=h.data.concat(c.subtable),c},e}(),Cz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Sz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var s,c;for(c=[],s=0;s<10;++s)c.push(t.readByte());return c}(),this.charRange=function(){var s,c;for(c=[],s=0;s<4;++s)c.push(t.readInt());return c}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var s,c;for(c=[],s=0;s<2;s=++s)c.push(t.readInt());return c}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Ez=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="post",e.prototype.parse=function(t){var s,c,h;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var A;for(c=t.readUInt16(),this.glyphNameIndex=[],A=0;0<=c?A<c:A>c;A=0<=c?++A:--A)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],h=[];t.pos<this.offset+this.length;)s=t.readByte(),h.push(this.names.push(t.readString(s)));return h;case 151552:return c=t.readUInt16(),this.offsets=t.read(c);case 196608:break;case 262144:return this.map=(function(){var r,y,b;for(b=[],A=r=0,y=this.file.maxp.numGlyphs;0<=y?r<y:r>y;A=0<=y?++r:--r)b.push(t.readUInt32());return b}).call(this)}},e}(),Iz=function(a,e){this.raw=a,this.length=a.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Tz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="name",e.prototype.parse=function(t){var s,c,h,A,r,y,b,_,B,I,E;for(t.pos=this.offset,t.readShort(),s=t.readShort(),y=t.readShort(),c=[],A=0;0<=s?A<s:A>s;A=0<=s?++A:--A)c.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+y+t.readShort()});for(b={},A=B=0,I=c.length;B<I;A=++B)h=c[A],t.pos=h.offset,_=t.readString(h.length),r=new Iz(_,h),b[E=h.nameID]==null&&(b[E]=[]),b[h.nameID].push(r);this.strings=b,this.copyright=b[0],this.fontFamily=b[1],this.fontSubfamily=b[2],this.uniqueSubfamily=b[3],this.fontName=b[4],this.version=b[5];try{this.postscriptName=b[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=b[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=b[7],this.manufacturer=b[8],this.designer=b[9],this.description=b[10],this.vendorUrl=b[11],this.designerUrl=b[12],this.license=b[13],this.licenseUrl=b[14],this.preferredFamily=b[15],this.preferredSubfamily=b[17],this.compatibleFull=b[18],this.sampleText=b[19]},e}(),Fz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Lz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="hmtx",e.prototype.parse=function(t){var s,c,h,A,r,y,b;for(t.pos=this.offset,this.metrics=[],s=0,y=this.file.hhea.numberOfMetrics;0<=y?s<y:s>y;s=0<=y?++s:--s)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(h=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,B;for(B=[],s=_=0;0<=h?_<h:_>h;s=0<=h?++_:--_)B.push(t.readInt16());return B}(),this.widths=(function(){var _,B,I,E;for(E=[],_=0,B=(I=this.metrics).length;_<B;_++)A=I[_],E.push(A.advance);return E}).call(this),c=this.widths[this.widths.length-1],b=[],s=r=0;0<=h?r<h:r>h;s=0<=h?++r:--r)b.push(this.widths.push(c));return b},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),ZT=[].slice,Mz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var s,c,h,A,r,y,b,_,B,I;return t in this.cache?this.cache[t]:(A=this.file.loca,s=this.file.contents,c=A.indexOf(t),(h=A.lengthOf(t))===0?this.cache[t]=null:(s.pos=this.offset+c,r=(y=new kp(s.read(h))).readShort(),_=y.readShort(),I=y.readShort(),b=y.readShort(),B=y.readShort(),this.cache[t]=r===-1?new kz(y,_,I,b,B):new Pz(y,r,_,I,b,B),this.cache[t]))},e.prototype.encode=function(t,s,c){var h,A,r,y,b;for(r=[],A=[],y=0,b=s.length;y<b;y++)h=t[s[y]],A.push(r.length),h&&(r=r.concat(h.encode(c)));return A.push(r.length),{table:r,offsets:A}},e}(),Pz=function(){function a(e,t,s,c,h,A){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=c,this.xMax=h,this.yMax=A,this.compound=!1}return a.prototype.encode=function(){return this.raw.data},a}(),kz=function(){function a(e,t,s,c,h){var A,r;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=c,this.yMax=h,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],A=this.raw;r=A.readShort(),this.glyphOffsets.push(A.pos),this.glyphIDs.push(A.readUInt16()),32&r;)A.pos+=1&r?4:2,128&r?A.pos+=8:64&r?A.pos+=4:8&r&&(A.pos+=2)}return a.prototype.encode=function(){var e,t,s;for(t=new kp(ZT.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},a}(),Rz=function(a){function e(){return e.__super__.constructor.apply(this,arguments)}return qA(e,eA),e.prototype.tag="loca",e.prototype.parse=function(t){var s,c;return t.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?(function(){var h,A;for(A=[],c=0,h=this.length;c<h;c+=2)A.push(2*t.readUInt16());return A}).call(this):(function(){var h,A;for(A=[],c=0,h=this.length;c<h;c+=4)A.push(t.readUInt32());return A}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,s){for(var c=new Uint32Array(this.offsets.length),h=0,A=0,r=0;r<c.length;++r)if(c[r]=h,A<s.length&&s[A]==r){++A,c[r]=h;var y=this.offsets[r],b=this.offsets[r+1]-y;b>0&&(h+=b)}for(var _=new Array(4*c.length),B=0;B<c.length;++B)_[4*B+3]=255&c[B],_[4*B+2]=(65280&c[B])>>8,_[4*B+1]=(16711680&c[B])>>16,_[4*B]=(4278190080&c[B])>>24;return _},e}(),Dz=function(){function a(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return a.prototype.generateCmap=function(){var e,t,s,c,h;for(t in c=this.font.cmap.tables[0].codeMap,e={},h=this.subset)s=h[t],e[t]=c[s];return e},a.prototype.glyphsFor=function(e){var t,s,c,h,A,r,y;for(c={},A=0,r=e.length;A<r;A++)c[h=e[A]]=this.font.glyf.glyphFor(h);for(h in t=[],c)(s=c[h])!=null&&s.compound&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(h in y=this.glyphsFor(t))s=y[h],c[h]=s;return c},a.prototype.encode=function(e,t){var s,c,h,A,r,y,b,_,B,I,E,R,M,G,U;for(c in s=$T.encode(this.generateCmap(),"unicode"),A=this.glyphsFor(e),E={0:0},U=s.charMap)E[(y=U[c]).old]=y.new;for(R in I=s.maxGlyphID,A)R in E||(E[R]=I++);return _=function(Q){var q,ne;for(q in ne={},Q)ne[Q[q]]=q;return ne}(E),B=Object.keys(_).sort(function(Q,q){return Q-q}),M=function(){var Q,q,ne;for(ne=[],Q=0,q=B.length;Q<q;Q++)r=B[Q],ne.push(_[r]);return ne}(),h=this.font.glyf.encode(A,M,E),b=this.font.loca.encode(h.offsets,M),G={cmap:this.font.cmap.raw(),glyf:h.table,loca:b,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(G["OS/2"]=this.font.os2.raw()),this.font.directory.encode(G)},a}();Yn.API.PDFObject=function(){var a;function e(){}return a=function(t,s){return(Array(s+1).join("0")+t).slice(-s)},e.convert=function(t){var s,c,h,A;if(Array.isArray(t))return"["+function(){var r,y,b;for(b=[],r=0,y=t.length;r<y;r++)s=t[r],b.push(e.convert(s));return b}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+a(t.getUTCFullYear(),4)+a(t.getUTCMonth(),2)+a(t.getUTCDate(),2)+a(t.getUTCHours(),2)+a(t.getUTCMinutes(),2)+a(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(c in h=["<<"],t)A=t[c],h.push("/"+c+" "+e.convert(A));return h.push(">>"),h.join(`
`)}return""+t},e}();const Oz=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:fz,AcroFormAppearance:mn,AcroFormButton:$l,AcroFormCheckBox:Ry,AcroFormChoiceField:mg,AcroFormComboBox:vg,AcroFormEditBox:Py,AcroFormListBox:yg,AcroFormPasswordField:Dy,AcroFormPushButton:ky,AcroFormRadioButton:_g,AcroFormTextField:Sp,GState:Jy,ShadingPattern:_p,TilingPattern:dg,default:Yn,jsPDF:Yn},Symbol.toStringTag,{value:"Module"})),Uz=HR(Oz);var F0={exports:{}};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */var zz=F0.exports,XE;function Nz(){return XE||(XE=1,function(a,e){(function(t,s){a.exports=s()})(zz,function(){/*! *****************************************************************************
		    Copyright (c) Microsoft Corporation.

		    Permission to use, copy, modify, and/or distribute this software for any
		    purpose with or without fee is hereby granted.

		    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		    PERFORMANCE OF THIS SOFTWARE.
		    ***************************************************************************** */var t=function(N,O){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,W){X.__proto__=W}||function(X,W){for(var ce in W)Object.prototype.hasOwnProperty.call(W,ce)&&(X[ce]=W[ce])},t(N,O)};function s(N,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");t(N,O);function X(){this.constructor=N}N.prototype=O===null?Object.create(O):(X.prototype=O.prototype,new X)}var c=function(){return c=Object.assign||function(O){for(var X,W=1,ce=arguments.length;W<ce;W++){X=arguments[W];for(var Be in X)Object.prototype.hasOwnProperty.call(X,Be)&&(O[Be]=X[Be])}return O},c.apply(this,arguments)};function h(N,O,X,W){function ce(Be){return Be instanceof X?Be:new X(function(De){De(Be)})}return new(X||(X=Promise))(function(Be,De){function gt(si){try{Ht(W.next(si))}catch(pi){De(pi)}}function pt(si){try{Ht(W.throw(si))}catch(pi){De(pi)}}function Ht(si){si.done?Be(si.value):ce(si.value).then(gt,pt)}Ht((W=W.apply(N,[])).next())})}function A(N,O){var X={label:0,sent:function(){if(Be[0]&1)throw Be[1];return Be[1]},trys:[],ops:[]},W,ce,Be,De;return De={next:gt(0),throw:gt(1),return:gt(2)},typeof Symbol=="function"&&(De[Symbol.iterator]=function(){return this}),De;function gt(Ht){return function(si){return pt([Ht,si])}}function pt(Ht){if(W)throw new TypeError("Generator is already executing.");for(;X;)try{if(W=1,ce&&(Be=Ht[0]&2?ce.return:Ht[0]?ce.throw||((Be=ce.return)&&Be.call(ce),0):ce.next)&&!(Be=Be.call(ce,Ht[1])).done)return Be;switch(ce=0,Be&&(Ht=[Ht[0]&2,Be.value]),Ht[0]){case 0:case 1:Be=Ht;break;case 4:return X.label++,{value:Ht[1],done:!1};case 5:X.label++,ce=Ht[1],Ht=[0];continue;case 7:Ht=X.ops.pop(),X.trys.pop();continue;default:if(Be=X.trys,!(Be=Be.length>0&&Be[Be.length-1])&&(Ht[0]===6||Ht[0]===2)){X=0;continue}if(Ht[0]===3&&(!Be||Ht[1]>Be[0]&&Ht[1]<Be[3])){X.label=Ht[1];break}if(Ht[0]===6&&X.label<Be[1]){X.label=Be[1],Be=Ht;break}if(Be&&X.label<Be[2]){X.label=Be[2],X.ops.push(Ht);break}Be[2]&&X.ops.pop(),X.trys.pop();continue}Ht=O.call(N,X)}catch(si){Ht=[6,si],ce=0}finally{W=Be=0}if(Ht[0]&5)throw Ht[1];return{value:Ht[0]?Ht[1]:void 0,done:!0}}}function r(N,O,X){if(arguments.length===2)for(var W=0,ce=O.length,Be;W<ce;W++)(Be||!(W in O))&&(Be||(Be=Array.prototype.slice.call(O,0,W)),Be[W]=O[W]);return N.concat(Be||O)}for(var y=function(){function N(O,X,W,ce){this.left=O,this.top=X,this.width=W,this.height=ce}return N.prototype.add=function(O,X,W,ce){return new N(this.left+O,this.top+X,this.width+W,this.height+ce)},N.fromClientRect=function(O,X){return new N(X.left+O.windowBounds.left,X.top+O.windowBounds.top,X.width,X.height)},N.fromDOMRectList=function(O,X){var W=Array.from(X).find(function(ce){return ce.width!==0});return W?new N(W.left+O.windowBounds.left,W.top+O.windowBounds.top,W.width,W.height):N.EMPTY},N.EMPTY=new N(0,0,0,0),N}(),b=function(N,O){return y.fromClientRect(N,O.getBoundingClientRect())},_=function(N){var O=N.body,X=N.documentElement;if(!O||!X)throw new Error("Unable to get document size");var W=Math.max(Math.max(O.scrollWidth,X.scrollWidth),Math.max(O.offsetWidth,X.offsetWidth),Math.max(O.clientWidth,X.clientWidth)),ce=Math.max(Math.max(O.scrollHeight,X.scrollHeight),Math.max(O.offsetHeight,X.offsetHeight),Math.max(O.clientHeight,X.clientHeight));return new y(0,0,W,ce)},B=function(N){for(var O=[],X=0,W=N.length;X<W;){var ce=N.charCodeAt(X++);if(ce>=55296&&ce<=56319&&X<W){var Be=N.charCodeAt(X++);(Be&64512)===56320?O.push(((ce&1023)<<10)+(Be&1023)+65536):(O.push(ce),X--)}else O.push(ce)}return O},I=function(){for(var N=[],O=0;O<arguments.length;O++)N[O]=arguments[O];if(String.fromCodePoint)return String.fromCodePoint.apply(String,N);var X=N.length;if(!X)return"";for(var W=[],ce=-1,Be="";++ce<X;){var De=N[ce];De<=65535?W.push(De):(De-=65536,W.push((De>>10)+55296,De%1024+56320)),(ce+1===X||W.length>16384)&&(Be+=String.fromCharCode.apply(String,W),W.length=0)}return Be},E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=typeof Uint8Array>"u"?[]:new Uint8Array(256),M=0;M<E.length;M++)R[E.charCodeAt(M)]=M;for(var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",U=typeof Uint8Array>"u"?[]:new Uint8Array(256),Q=0;Q<G.length;Q++)U[G.charCodeAt(Q)]=Q;for(var q=function(N){var O=N.length*.75,X=N.length,W,ce=0,Be,De,gt,pt;N[N.length-1]==="="&&(O--,N[N.length-2]==="="&&O--);var Ht=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(O):new Array(O),si=Array.isArray(Ht)?Ht:new Uint8Array(Ht);for(W=0;W<X;W+=4)Be=U[N.charCodeAt(W)],De=U[N.charCodeAt(W+1)],gt=U[N.charCodeAt(W+2)],pt=U[N.charCodeAt(W+3)],si[ce++]=Be<<2|De>>4,si[ce++]=(De&15)<<4|gt>>2,si[ce++]=(gt&3)<<6|pt&63;return Ht},ne=function(N){for(var O=N.length,X=[],W=0;W<O;W+=2)X.push(N[W+1]<<8|N[W]);return X},re=function(N){for(var O=N.length,X=[],W=0;W<O;W+=4)X.push(N[W+3]<<24|N[W+2]<<16|N[W+1]<<8|N[W]);return X},pe=5,Ae=11,le=2,be=Ae-pe,we=65536>>pe,oe=1<<pe,me=oe-1,Le=1024>>pe,Se=we+Le,Me=Se,Re=32,Ze=Me+Re,$e=65536>>Ae,ct=1<<be,Qe=ct-1,It=function(N,O,X){return N.slice?N.slice(O,X):new Uint16Array(Array.prototype.slice.call(N,O,X))},Ce=function(N,O,X){return N.slice?N.slice(O,X):new Uint32Array(Array.prototype.slice.call(N,O,X))},Je=function(N,O){var X=q(N),W=Array.isArray(X)?re(X):new Uint32Array(X),ce=Array.isArray(X)?ne(X):new Uint16Array(X),Be=24,De=It(ce,Be/2,W[4]/2),gt=W[5]===2?It(ce,(Be+W[4])/2):Ce(W,Math.ceil((Be+W[4])/4));return new lt(W[0],W[1],W[2],W[3],De,gt)},lt=function(){function N(O,X,W,ce,Be,De){this.initialValue=O,this.errorValue=X,this.highStart=W,this.highValueIndex=ce,this.index=Be,this.data=De}return N.prototype.get=function(O){var X;if(O>=0){if(O<55296||O>56319&&O<=65535)return X=this.index[O>>pe],X=(X<<le)+(O&me),this.data[X];if(O<=65535)return X=this.index[we+(O-55296>>pe)],X=(X<<le)+(O&me),this.data[X];if(O<this.highStart)return X=Ze-$e+(O>>Ae),X=this.index[X],X+=O>>pe&Qe,X=this.index[X],X=(X<<le)+(O&me),this.data[X];if(O<=1114111)return this.data[this.highValueIndex]}return this.errorValue},N}(),mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bt=typeof Uint8Array>"u"?[]:new Uint8Array(256),rt=0;rt<mt.length;rt++)Bt[mt.charCodeAt(rt)]=rt;var St="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",vt=50,Gt=1,mi=2,ze=3,Ve=4,kt=5,Ft=7,it=8,yi=9,bi=10,Kt=11,di=12,fi=13,Ri=14,Oi=15,Ji=16,lr=17,br=18,Dr=19,Fr=20,Qr=21,ui=22,li=23,Vi=24,rr=25,qr=26,_r=27,Zr=28,io=29,Ur=30,ia=31,ps=32,ro=33,Qn=34,Lr=35,yr=36,qt=37,Vn=38,xs=39,ra=40,dn=41,Et=42,ye=43,Ee=[9001,65288],He="!",tt="×",Ye="÷",xt=Je(St),Dt=[Ur,yr],bt=[Gt,mi,ze,kt],Ut=[bi,it],ii=[_r,qr],Nt=bt.concat(Ut),Fi=[Vn,xs,ra,Qn,Lr],er=[Oi,fi],nr=function(N,O){O===void 0&&(O="strict");var X=[],W=[],ce=[];return N.forEach(function(Be,De){var gt=xt.get(Be);if(gt>vt?(ce.push(!0),gt-=vt):ce.push(!1),["normal","auto","loose"].indexOf(O)!==-1&&[8208,8211,12316,12448].indexOf(Be)!==-1)return W.push(De),X.push(Ji);if(gt===Ve||gt===Kt){if(De===0)return W.push(De),X.push(Ur);var pt=X[De-1];return Nt.indexOf(pt)===-1?(W.push(W[De-1]),X.push(pt)):(W.push(De),X.push(Ur))}if(W.push(De),gt===ia)return X.push(O==="strict"?Qr:qt);if(gt===Et||gt===io)return X.push(Ur);if(gt===ye)return Be>=131072&&Be<=196605||Be>=196608&&Be<=262141?X.push(qt):X.push(Ur);X.push(gt)}),[W,X,ce]},Sr=function(N,O,X,W){var ce=W[X];if(Array.isArray(N)?N.indexOf(ce)!==-1:N===ce)for(var Be=X;Be<=W.length;){Be++;var De=W[Be];if(De===O)return!0;if(De!==bi)break}if(ce===bi)for(var Be=X;Be>0;){Be--;var gt=W[Be];if(Array.isArray(N)?N.indexOf(gt)!==-1:N===gt)for(var pt=X;pt<=W.length;){pt++;var De=W[pt];if(De===O)return!0;if(De!==bi)break}if(gt!==bi)break}return!1},Mr=function(N,O){for(var X=N;X>=0;){var W=O[X];if(W===bi)X--;else return W}return 0},jr=function(N,O,X,W,ce){if(X[W]===0)return tt;var Be=W-1;if(Array.isArray(ce)&&ce[Be]===!0)return tt;var De=Be-1,gt=Be+1,pt=O[Be],Ht=De>=0?O[De]:0,si=O[gt];if(pt===mi&&si===ze)return tt;if(bt.indexOf(pt)!==-1)return He;if(bt.indexOf(si)!==-1||Ut.indexOf(si)!==-1)return tt;if(Mr(Be,O)===it)return Ye;if(xt.get(N[Be])===Kt||(pt===ps||pt===ro)&&xt.get(N[gt])===Kt||pt===Ft||si===Ft||pt===yi||[bi,fi,Oi].indexOf(pt)===-1&&si===yi||[lr,br,Dr,Vi,Zr].indexOf(si)!==-1||Mr(Be,O)===ui||Sr(li,ui,Be,O)||Sr([lr,br],Qr,Be,O)||Sr(di,di,Be,O))return tt;if(pt===bi)return Ye;if(pt===li||si===li)return tt;if(si===Ji||pt===Ji)return Ye;if([fi,Oi,Qr].indexOf(si)!==-1||pt===Ri||Ht===yr&&er.indexOf(pt)!==-1||pt===Zr&&si===yr||si===Fr||Dt.indexOf(si)!==-1&&pt===rr||Dt.indexOf(pt)!==-1&&si===rr||pt===_r&&[qt,ps,ro].indexOf(si)!==-1||[qt,ps,ro].indexOf(pt)!==-1&&si===qr||Dt.indexOf(pt)!==-1&&ii.indexOf(si)!==-1||ii.indexOf(pt)!==-1&&Dt.indexOf(si)!==-1||[_r,qr].indexOf(pt)!==-1&&(si===rr||[ui,Oi].indexOf(si)!==-1&&O[gt+1]===rr)||[ui,Oi].indexOf(pt)!==-1&&si===rr||pt===rr&&[rr,Zr,Vi].indexOf(si)!==-1)return tt;if([rr,Zr,Vi,lr,br].indexOf(si)!==-1)for(var pi=Be;pi>=0;){var Ui=O[pi];if(Ui===rr)return tt;if([Zr,Vi].indexOf(Ui)!==-1)pi--;else break}if([_r,qr].indexOf(si)!==-1)for(var pi=[lr,br].indexOf(pt)!==-1?De:Be;pi>=0;){var Ui=O[pi];if(Ui===rr)return tt;if([Zr,Vi].indexOf(Ui)!==-1)pi--;else break}if(Vn===pt&&[Vn,xs,Qn,Lr].indexOf(si)!==-1||[xs,Qn].indexOf(pt)!==-1&&[xs,ra].indexOf(si)!==-1||[ra,Lr].indexOf(pt)!==-1&&si===ra||Fi.indexOf(pt)!==-1&&[Fr,qr].indexOf(si)!==-1||Fi.indexOf(si)!==-1&&pt===_r||Dt.indexOf(pt)!==-1&&Dt.indexOf(si)!==-1||pt===Vi&&Dt.indexOf(si)!==-1||Dt.concat(rr).indexOf(pt)!==-1&&si===ui&&Ee.indexOf(N[gt])===-1||Dt.concat(rr).indexOf(si)!==-1&&pt===br)return tt;if(pt===dn&&si===dn){for(var Gr=X[Be],vr=1;Gr>0&&(Gr--,O[Gr]===dn);)vr++;if(vr%2!==0)return tt}return pt===ps&&si===ro?tt:Ye},nn=function(N,O){O||(O={lineBreak:"normal",wordBreak:"normal"});var X=nr(N,O.lineBreak),W=X[0],ce=X[1],Be=X[2];(O.wordBreak==="break-all"||O.wordBreak==="break-word")&&(ce=ce.map(function(gt){return[rr,Ur,Et].indexOf(gt)!==-1?qt:gt}));var De=O.wordBreak==="keep-all"?Be.map(function(gt,pt){return gt&&N[pt]>=19968&&N[pt]<=40959}):void 0;return[W,ce,De]},Yr=function(){function N(O,X,W,ce){this.codePoints=O,this.required=X===He,this.start=W,this.end=ce}return N.prototype.slice=function(){return I.apply(void 0,this.codePoints.slice(this.start,this.end))},N}(),qn=function(N,O){var X=B(N),W=nn(X,O),ce=W[0],Be=W[1],De=W[2],gt=X.length,pt=0,Ht=0;return{next:function(){if(Ht>=gt)return{done:!0,value:null};for(var si=tt;Ht<gt&&(si=jr(X,Be,ce,++Ht,De))===tt;);if(si!==tt||Ht===gt){var pi=new Yr(X,si,pt,Ht);return pt=Ht,{value:pi,done:!1}}return{done:!0,value:null}}}},gs=1,ms=2,En=4,In=8,Ls=10,bs=47,hs=92,Uo=9,Da=32,So=34,vc=61,ds=35,_c=36,ch=37,xc=39,ec=40,Nc=41,yl=95,Eo=45,Ta=33,Ou=60,vl=62,al=64,ll=91,bc=93,_l=61,wc=123,tc=63,ic=125,Uu=124,hu=126,xl=128,du=65533,jc=42,ko=43,Xo=44,uh=58,Au=59,Tn=46,iA=0,hh=8,pn=11,dh=14,fu=31,Hc=127,bl=-1,zu=48,Qc=97,Bc=101,Ah=102,pu=117,wl=122,ud=65,$a=69,gu=70,mu=85,Bl=90,zo=function(N){return N>=zu&&N<=57},Vc=function(N){return N>=55296&&N<=57343},rc=function(N){return zo(N)||N>=ud&&N<=gu||N>=Qc&&N<=Ah},nc=function(N){return N>=Qc&&N<=wl},sc=function(N){return N>=ud&&N<=Bl},yu=function(N){return nc(N)||sc(N)},na=function(N){return N>=xl},Za=function(N){return N===Ls||N===Uo||N===Da},Ol=function(N){return yu(N)||na(N)||N===yl},Cl=function(N){return Ol(N)||zo(N)||N===Eo},jn=function(N){return N>=iA&&N<=hh||N===pn||N>=dh&&N<=fu||N===Hc},No=function(N,O){return N!==hs?!1:O!==Ls},Hh=function(N,O,X){return N===Eo?Ol(O)||No(O,X):Ol(N)?!0:!!(N===hs&&No(N,O))},vu=function(N,O,X){return N===ko||N===Eo?zo(O)?!0:O===Tn&&zo(X):zo(N===Tn?O:N)},Er=function(N){var O=0,X=1;(N[O]===ko||N[O]===Eo)&&(N[O]===Eo&&(X=-1),O++);for(var W=[];zo(N[O]);)W.push(N[O++]);var ce=W.length?parseInt(I.apply(void 0,W),10):0;N[O]===Tn&&O++;for(var Be=[];zo(N[O]);)Be.push(N[O++]);var De=Be.length,gt=De?parseInt(I.apply(void 0,Be),10):0;(N[O]===$a||N[O]===Bc)&&O++;var pt=1;(N[O]===ko||N[O]===Eo)&&(N[O]===Eo&&(pt=-1),O++);for(var Ht=[];zo(N[O]);)Ht.push(N[O++]);var si=Ht.length?parseInt(I.apply(void 0,Ht),10):0;return X*(ce+gt*Math.pow(10,-De))*Math.pow(10,pt*si)},fh={type:2},Gc={type:3},Cc={type:4},Oa={type:13},Qh={type:8},Nu={type:21},dr={type:9},kn={type:10},Fn={type:11},sa={type:12},Ul={type:14},ie={type:23},Ue={type:1},Tt={type:25},jt={type:24},hi={type:26},Ii={type:27},mr={type:28},Vr={type:29},cn={type:31},Rn={type:32},Dn=function(){function N(){this._value=[]}return N.prototype.write=function(O){this._value=this._value.concat(B(O))},N.prototype.read=function(){for(var O=[],X=this.consumeToken();X!==Rn;)O.push(X),X=this.consumeToken();return O},N.prototype.consumeToken=function(){var O=this.consumeCodePoint();switch(O){case So:return this.consumeStringToken(So);case ds:var X=this.peekCodePoint(0),W=this.peekCodePoint(1),ce=this.peekCodePoint(2);if(Cl(X)||No(W,ce)){var Be=Hh(X,W,ce)?ms:gs,De=this.consumeName();return{type:5,value:De,flags:Be}}break;case _c:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),Oa;break;case xc:return this.consumeStringToken(xc);case ec:return fh;case Nc:return Gc;case jc:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),Ul;break;case ko:if(vu(O,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(O),this.consumeNumericToken();break;case Xo:return Cc;case Eo:var gt=O,pt=this.peekCodePoint(0),Ht=this.peekCodePoint(1);if(vu(gt,pt,Ht))return this.reconsumeCodePoint(O),this.consumeNumericToken();if(Hh(gt,pt,Ht))return this.reconsumeCodePoint(O),this.consumeIdentLikeToken();if(pt===Eo&&Ht===vl)return this.consumeCodePoint(),this.consumeCodePoint(),jt;break;case Tn:if(vu(O,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(O),this.consumeNumericToken();break;case bs:if(this.peekCodePoint(0)===jc)for(this.consumeCodePoint();;){var si=this.consumeCodePoint();if(si===jc&&(si=this.consumeCodePoint(),si===bs))return this.consumeToken();if(si===bl)return this.consumeToken()}break;case uh:return hi;case Au:return Ii;case Ou:if(this.peekCodePoint(0)===Ta&&this.peekCodePoint(1)===Eo&&this.peekCodePoint(2)===Eo)return this.consumeCodePoint(),this.consumeCodePoint(),Tt;break;case al:var pi=this.peekCodePoint(0),Ui=this.peekCodePoint(1),Gr=this.peekCodePoint(2);if(Hh(pi,Ui,Gr)){var De=this.consumeName();return{type:7,value:De}}break;case ll:return mr;case hs:if(No(O,this.peekCodePoint(0)))return this.reconsumeCodePoint(O),this.consumeIdentLikeToken();break;case bc:return Vr;case _l:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),Qh;break;case wc:return Fn;case ic:return sa;case pu:case mu:var vr=this.peekCodePoint(0),Rr=this.peekCodePoint(1);return vr===ko&&(rc(Rr)||Rr===tc)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(O),this.consumeIdentLikeToken();case Uu:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),dr;if(this.peekCodePoint(0)===Uu)return this.consumeCodePoint(),Nu;break;case hu:if(this.peekCodePoint(0)===vc)return this.consumeCodePoint(),kn;break;case bl:return Rn}return Za(O)?(this.consumeWhiteSpace(),cn):zo(O)?(this.reconsumeCodePoint(O),this.consumeNumericToken()):Ol(O)?(this.reconsumeCodePoint(O),this.consumeIdentLikeToken()):{type:6,value:I(O)}},N.prototype.consumeCodePoint=function(){var O=this._value.shift();return typeof O>"u"?-1:O},N.prototype.reconsumeCodePoint=function(O){this._value.unshift(O)},N.prototype.peekCodePoint=function(O){return O>=this._value.length?-1:this._value[O]},N.prototype.consumeUnicodeRangeToken=function(){for(var O=[],X=this.consumeCodePoint();rc(X)&&O.length<6;)O.push(X),X=this.consumeCodePoint();for(var W=!1;X===tc&&O.length<6;)O.push(X),X=this.consumeCodePoint(),W=!0;if(W){var ce=parseInt(I.apply(void 0,O.map(function(pt){return pt===tc?zu:pt})),16),Be=parseInt(I.apply(void 0,O.map(function(pt){return pt===tc?gu:pt})),16);return{type:30,start:ce,end:Be}}var De=parseInt(I.apply(void 0,O),16);if(this.peekCodePoint(0)===Eo&&rc(this.peekCodePoint(1))){this.consumeCodePoint(),X=this.consumeCodePoint();for(var gt=[];rc(X)&&gt.length<6;)gt.push(X),X=this.consumeCodePoint();var Be=parseInt(I.apply(void 0,gt),16);return{type:30,start:De,end:Be}}else return{type:30,start:De,end:De}},N.prototype.consumeIdentLikeToken=function(){var O=this.consumeName();return O.toLowerCase()==="url"&&this.peekCodePoint(0)===ec?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===ec?(this.consumeCodePoint(),{type:19,value:O}):{type:20,value:O}},N.prototype.consumeUrlToken=function(){var O=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===bl)return{type:22,value:""};var X=this.peekCodePoint(0);if(X===xc||X===So){var W=this.consumeStringToken(this.consumeCodePoint());return W.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===bl||this.peekCodePoint(0)===Nc)?(this.consumeCodePoint(),{type:22,value:W.value}):(this.consumeBadUrlRemnants(),ie)}for(;;){var ce=this.consumeCodePoint();if(ce===bl||ce===Nc)return{type:22,value:I.apply(void 0,O)};if(Za(ce))return this.consumeWhiteSpace(),this.peekCodePoint(0)===bl||this.peekCodePoint(0)===Nc?(this.consumeCodePoint(),{type:22,value:I.apply(void 0,O)}):(this.consumeBadUrlRemnants(),ie);if(ce===So||ce===xc||ce===ec||jn(ce))return this.consumeBadUrlRemnants(),ie;if(ce===hs)if(No(ce,this.peekCodePoint(0)))O.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ie;else O.push(ce)}},N.prototype.consumeWhiteSpace=function(){for(;Za(this.peekCodePoint(0));)this.consumeCodePoint()},N.prototype.consumeBadUrlRemnants=function(){for(;;){var O=this.consumeCodePoint();if(O===Nc||O===bl)return;No(O,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},N.prototype.consumeStringSlice=function(O){for(var X=5e4,W="";O>0;){var ce=Math.min(X,O);W+=I.apply(void 0,this._value.splice(0,ce)),O-=ce}return this._value.shift(),W},N.prototype.consumeStringToken=function(O){var X="",W=0;do{var ce=this._value[W];if(ce===bl||ce===void 0||ce===O)return X+=this.consumeStringSlice(W),{type:0,value:X};if(ce===Ls)return this._value.splice(0,W),Ue;if(ce===hs){var Be=this._value[W+1];Be!==bl&&Be!==void 0&&(Be===Ls?(X+=this.consumeStringSlice(W),W=-1,this._value.shift()):No(ce,Be)&&(X+=this.consumeStringSlice(W),X+=I(this.consumeEscapedCodePoint()),W=-1))}W++}while(!0)},N.prototype.consumeNumber=function(){var O=[],X=En,W=this.peekCodePoint(0);for((W===ko||W===Eo)&&O.push(this.consumeCodePoint());zo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());W=this.peekCodePoint(0);var ce=this.peekCodePoint(1);if(W===Tn&&zo(ce))for(O.push(this.consumeCodePoint(),this.consumeCodePoint()),X=In;zo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());W=this.peekCodePoint(0),ce=this.peekCodePoint(1);var Be=this.peekCodePoint(2);if((W===$a||W===Bc)&&((ce===ko||ce===Eo)&&zo(Be)||zo(ce)))for(O.push(this.consumeCodePoint(),this.consumeCodePoint()),X=In;zo(this.peekCodePoint(0));)O.push(this.consumeCodePoint());return[Er(O),X]},N.prototype.consumeNumericToken=function(){var O=this.consumeNumber(),X=O[0],W=O[1],ce=this.peekCodePoint(0),Be=this.peekCodePoint(1),De=this.peekCodePoint(2);if(Hh(ce,Be,De)){var gt=this.consumeName();return{type:15,number:X,flags:W,unit:gt}}return ce===ch?(this.consumeCodePoint(),{type:16,number:X,flags:W}):{type:17,number:X,flags:W}},N.prototype.consumeEscapedCodePoint=function(){var O=this.consumeCodePoint();if(rc(O)){for(var X=I(O);rc(this.peekCodePoint(0))&&X.length<6;)X+=I(this.consumeCodePoint());Za(this.peekCodePoint(0))&&this.consumeCodePoint();var W=parseInt(X,16);return W===0||Vc(W)||W>1114111?du:W}return O===bl?du:O},N.prototype.consumeName=function(){for(var O="";;){var X=this.consumeCodePoint();if(Cl(X))O+=I(X);else if(No(X,this.peekCodePoint(0)))O+=I(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(X),O}},N}(),As=function(){function N(O){this._tokens=O}return N.create=function(O){var X=new Dn;return X.write(O),new N(X.read())},N.parseValue=function(O){return N.create(O).parseComponentValue()},N.parseValues=function(O){return N.create(O).parseComponentValues()},N.prototype.parseComponentValue=function(){for(var O=this.consumeToken();O.type===31;)O=this.consumeToken();if(O.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(O);var X=this.consumeComponentValue();do O=this.consumeToken();while(O.type===31);if(O.type===32)return X;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},N.prototype.parseComponentValues=function(){for(var O=[];;){var X=this.consumeComponentValue();if(X.type===32)return O;O.push(X),O.push()}},N.prototype.consumeComponentValue=function(){var O=this.consumeToken();switch(O.type){case 11:case 28:case 2:return this.consumeSimpleBlock(O.type);case 19:return this.consumeFunction(O)}return O},N.prototype.consumeSimpleBlock=function(O){for(var X={type:O,values:[]},W=this.consumeToken();;){if(W.type===32||Pr(W,O))return X;this.reconsumeToken(W),X.values.push(this.consumeComponentValue()),W=this.consumeToken()}},N.prototype.consumeFunction=function(O){for(var X={name:O.value,values:[],type:18};;){var W=this.consumeToken();if(W.type===32||W.type===3)return X;this.reconsumeToken(W),X.values.push(this.consumeComponentValue())}},N.prototype.consumeToken=function(){var O=this._tokens.shift();return typeof O>"u"?Rn:O},N.prototype.reconsumeToken=function(O){this._tokens.unshift(O)},N}(),Zs=function(N){return N.type===15},ts=function(N){return N.type===17},bn=function(N){return N.type===20},Js=function(N){return N.type===0},vo=function(N,O){return bn(N)&&N.value===O},Wr=function(N){return N.type!==31},ji=function(N){return N.type!==31&&N.type!==4},eo=function(N){var O=[],X=[];return N.forEach(function(W){if(W.type===4){if(X.length===0)throw new Error("Error parsing function args, zero tokens for arg");O.push(X),X=[];return}W.type!==31&&X.push(W)}),X.length&&O.push(X),O},Pr=function(N,O){return O===11&&N.type===12||O===28&&N.type===29?!0:O===2&&N.type===3},Es=function(N){return N.type===17||N.type===15},lo=function(N){return N.type===16||Es(N)},wr=function(N){return N.length>1?[N[0],N[1]]:[N[0]]},_o={type:17,number:0,flags:En},oc={type:16,number:50,flags:En},fa={type:16,number:100,flags:En},Yo=function(N,O,X){var W=N[0],ce=N[1];return[is(W,O),is(typeof ce<"u"?ce:W,X)]},is=function(N,O){if(N.type===16)return N.number/100*O;if(Zs(N))switch(N.unit){case"rem":case"em":return 16*N.number;case"px":default:return N.number}return N.number},Ko="deg",Sc="grad",Io="rad",Ua="turn",cl={name:"angle",parse:function(N,O){if(O.type===15)switch(O.unit){case Ko:return Math.PI*O.number/180;case Sc:return Math.PI/200*O.number;case Io:return O.number;case Ua:return Math.PI*2*O.number}throw new Error("Unsupported angle type")}},qo=function(N){return N.type===15&&(N.unit===Ko||N.unit===Sc||N.unit===Io||N.unit===Ua)},_u=function(N){var O=N.filter(bn).map(function(X){return X.value}).join(" ");switch(O){case"to bottom right":case"to right bottom":case"left top":case"top left":return[_o,_o];case"to top":case"bottom":return jo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[_o,fa];case"to right":case"left":return jo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[fa,fa];case"to bottom":case"top":return jo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[fa,_o];case"to left":case"right":return jo(270)}return 0},jo=function(N){return Math.PI*N/180},zl={name:"color",parse:function(N,O){if(O.type===18){var X=za[O.name];if(typeof X>"u")throw new Error('Attempting to parse an unsupported color function "'+O.name+'"');return X(N,O.values)}if(O.type===5){if(O.value.length===3){var W=O.value.substring(0,1),ce=O.value.substring(1,2),Be=O.value.substring(2,3);return oa(parseInt(W+W,16),parseInt(ce+ce,16),parseInt(Be+Be,16),1)}if(O.value.length===4){var W=O.value.substring(0,1),ce=O.value.substring(1,2),Be=O.value.substring(2,3),De=O.value.substring(3,4);return oa(parseInt(W+W,16),parseInt(ce+ce,16),parseInt(Be+Be,16),parseInt(De+De,16)/255)}if(O.value.length===6){var W=O.value.substring(0,2),ce=O.value.substring(2,4),Be=O.value.substring(4,6);return oa(parseInt(W,16),parseInt(ce,16),parseInt(Be,16),1)}if(O.value.length===8){var W=O.value.substring(0,2),ce=O.value.substring(2,4),Be=O.value.substring(4,6),De=O.value.substring(6,8);return oa(parseInt(W,16),parseInt(ce,16),parseInt(Be,16),parseInt(De,16)/255)}}if(O.type===20){var gt=Sl[O.value.toUpperCase()];if(typeof gt<"u")return gt}return Sl.TRANSPARENT}},Fa=function(N){return(255&N)===0},xo=function(N){var O=255&N,X=255&N>>8,W=255&N>>16,ce=255&N>>24;return O<255?"rgba("+ce+","+W+","+X+","+O/255+")":"rgb("+ce+","+W+","+X+")"},oa=function(N,O,X,W){return(N<<24|O<<16|X<<8|Math.round(W*255)<<0)>>>0},Nl=function(N,O){if(N.type===17)return N.number;if(N.type===16){var X=O===3?1:255;return O===3?N.number/100*X:Math.round(N.number/100*X)}return 0},Ja=function(N,O){var X=O.filter(ji);if(X.length===3){var W=X.map(Nl),ce=W[0],Be=W[1],De=W[2];return oa(ce,Be,De,1)}if(X.length===4){var gt=X.map(Nl),ce=gt[0],Be=gt[1],De=gt[2],pt=gt[3];return oa(ce,Be,De,pt)}return 0};function pa(N,O,X){return X<0&&(X+=1),X>=1&&(X-=1),X<1/6?(O-N)*X*6+N:X<1/2?O:X<2/3?(O-N)*6*(2/3-X)+N:N}var Ec=function(N,O){var X=O.filter(ji),W=X[0],ce=X[1],Be=X[2],De=X[3],gt=(W.type===17?jo(W.number):cl.parse(N,W))/(Math.PI*2),pt=lo(ce)?ce.number/100:0,Ht=lo(Be)?Be.number/100:0,si=typeof De<"u"&&lo(De)?is(De,1):1;if(pt===0)return oa(Ht*255,Ht*255,Ht*255,1);var pi=Ht<=.5?Ht*(pt+1):Ht+pt-Ht*pt,Ui=Ht*2-pi,Gr=pa(Ui,pi,gt+1/3),vr=pa(Ui,pi,gt),Rr=pa(Ui,pi,gt-1/3);return oa(Gr*255,vr*255,Rr*255,si)},za={hsl:Ec,hsla:Ec,rgb:Ja,rgba:Ja},jl=function(N,O){return zl.parse(N,As.create(O).parseComponentValue())},Sl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Wc={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(N,O){return O.map(function(X){if(bn(X))switch(X.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},$o={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},El=function(N,O){var X=zl.parse(N,O[0]),W=O[1];return W&&lo(W)?{color:X,stop:W}:{color:X,stop:null}},La=function(N,O){var X=N[0],W=N[N.length-1];X.stop===null&&(X.stop=_o),W.stop===null&&(W.stop=fa);for(var ce=[],Be=0,De=0;De<N.length;De++){var gt=N[De].stop;if(gt!==null){var pt=is(gt,O);pt>Be?ce.push(pt):ce.push(Be),Be=pt}else ce.push(null)}for(var Ht=null,De=0;De<ce.length;De++){var si=ce[De];if(si===null)Ht===null&&(Ht=De);else if(Ht!==null){for(var pi=De-Ht,Ui=ce[Ht-1],Gr=(si-Ui)/(pi+1),vr=1;vr<=pi;vr++)ce[Ht+vr-1]=Gr*vr;Ht=null}}return N.map(function(Rr,Jn){var An=Rr.color;return{color:An,stop:Math.max(Math.min(1,ce[Jn]/O),0)}})},Hl=function(N,O,X){var W=O/2,ce=X/2,Be=is(N[0],O)-W,De=ce-is(N[1],X);return(Math.atan2(De,Be)+Math.PI*2)%(Math.PI*2)},xu=function(N,O,X){var W=typeof N=="number"?N:Hl(N,O,X),ce=Math.abs(O*Math.sin(W))+Math.abs(X*Math.cos(W)),Be=O/2,De=X/2,gt=ce/2,pt=Math.sin(W-Math.PI/2)*gt,Ht=Math.cos(W-Math.PI/2)*gt;return[ce,Be-Ht,Be+Ht,De-pt,De+pt]},el=function(N,O){return Math.sqrt(N*N+O*O)},ju=function(N,O,X,W,ce){var Be=[[0,0],[0,O],[N,0],[N,O]];return Be.reduce(function(De,gt){var pt=gt[0],Ht=gt[1],si=el(X-pt,W-Ht);return(ce?si<De.optimumDistance:si>De.optimumDistance)?{optimumCorner:gt,optimumDistance:si}:De},{optimumDistance:ce?1/0:-1/0,optimumCorner:null}).optimumCorner},Ho=function(N,O,X,W,ce){var Be=0,De=0;switch(N.size){case 0:N.shape===0?Be=De=Math.min(Math.abs(O),Math.abs(O-W),Math.abs(X),Math.abs(X-ce)):N.shape===1&&(Be=Math.min(Math.abs(O),Math.abs(O-W)),De=Math.min(Math.abs(X),Math.abs(X-ce)));break;case 2:if(N.shape===0)Be=De=Math.min(el(O,X),el(O,X-ce),el(O-W,X),el(O-W,X-ce));else if(N.shape===1){var gt=Math.min(Math.abs(X),Math.abs(X-ce))/Math.min(Math.abs(O),Math.abs(O-W)),pt=ju(W,ce,O,X,!0),Ht=pt[0],si=pt[1];Be=el(Ht-O,(si-X)/gt),De=gt*Be}break;case 1:N.shape===0?Be=De=Math.max(Math.abs(O),Math.abs(O-W),Math.abs(X),Math.abs(X-ce)):N.shape===1&&(Be=Math.max(Math.abs(O),Math.abs(O-W)),De=Math.max(Math.abs(X),Math.abs(X-ce)));break;case 3:if(N.shape===0)Be=De=Math.max(el(O,X),el(O,X-ce),el(O-W,X),el(O-W,X-ce));else if(N.shape===1){var gt=Math.max(Math.abs(X),Math.abs(X-ce))/Math.max(Math.abs(O),Math.abs(O-W)),pi=ju(W,ce,O,X,!1),Ht=pi[0],si=pi[1];Be=el(Ht-O,(si-X)/gt),De=gt*Be}break}return Array.isArray(N.size)&&(Be=is(N.size[0],W),De=N.size.length===2?is(N.size[1],ce):Be),[Be,De]},Ic=function(N,O){var X=jo(180),W=[];return eo(O).forEach(function(ce,Be){if(Be===0){var De=ce[0];if(De.type===20&&De.value==="to"){X=_u(ce);return}else if(qo(De)){X=cl.parse(N,De);return}}var gt=El(N,ce);W.push(gt)}),{angle:X,stops:W,type:1}},Ql=function(N,O){var X=jo(180),W=[];return eo(O).forEach(function(ce,Be){if(Be===0){var De=ce[0];if(De.type===20&&["top","left","right","bottom"].indexOf(De.value)!==-1){X=_u(ce);return}else if(qo(De)){X=(cl.parse(N,De)+jo(270))%jo(360);return}}var gt=El(N,ce);W.push(gt)}),{angle:X,stops:W,type:1}},bu=function(N,O){var X=jo(180),W=[],ce=1,Be=0,De=3,gt=[];return eo(O).forEach(function(pt,Ht){var si=pt[0];if(Ht===0){if(bn(si)&&si.value==="linear"){ce=1;return}else if(bn(si)&&si.value==="radial"){ce=2;return}}if(si.type===18){if(si.name==="from"){var pi=zl.parse(N,si.values[0]);W.push({stop:_o,color:pi})}else if(si.name==="to"){var pi=zl.parse(N,si.values[0]);W.push({stop:fa,color:pi})}else if(si.name==="color-stop"){var Ui=si.values.filter(ji);if(Ui.length===2){var pi=zl.parse(N,Ui[1]),Gr=Ui[0];ts(Gr)&&W.push({stop:{type:16,number:Gr.number*100,flags:Gr.flags},color:pi})}}}}),ce===1?{angle:(X+jo(180))%jo(360),stops:W,type:ce}:{size:De,shape:Be,stops:W,position:gt,type:ce}},ac="closest-side",Vl="farthest-side",Tc="closest-corner",wu="farthest-corner",To="circle",tl="ellipse",wi="cover",no="contain",bo=function(N,O){var X=0,W=3,ce=[],Be=[];return eo(O).forEach(function(De,gt){var pt=!0;if(gt===0){var Ht=!1;pt=De.reduce(function(pi,Ui){if(Ht)if(bn(Ui))switch(Ui.value){case"center":return Be.push(oc),pi;case"top":case"left":return Be.push(_o),pi;case"right":case"bottom":return Be.push(fa),pi}else(lo(Ui)||Es(Ui))&&Be.push(Ui);else if(bn(Ui))switch(Ui.value){case To:return X=0,!1;case tl:return X=1,!1;case"at":return Ht=!0,!1;case ac:return W=0,!1;case wi:case Vl:return W=1,!1;case no:case Tc:return W=2,!1;case wu:return W=3,!1}else if(Es(Ui)||lo(Ui))return Array.isArray(W)||(W=[]),W.push(Ui),!1;return pi},pt)}if(pt){var si=El(N,De);ce.push(si)}}),{size:W,shape:X,stops:ce,position:Be,type:2}},po=function(N,O){var X=0,W=3,ce=[],Be=[];return eo(O).forEach(function(De,gt){var pt=!0;if(gt===0?pt=De.reduce(function(si,pi){if(bn(pi))switch(pi.value){case"center":return Be.push(oc),!1;case"top":case"left":return Be.push(_o),!1;case"right":case"bottom":return Be.push(fa),!1}else if(lo(pi)||Es(pi))return Be.push(pi),!1;return si},pt):gt===1&&(pt=De.reduce(function(si,pi){if(bn(pi))switch(pi.value){case To:return X=0,!1;case tl:return X=1,!1;case no:case ac:return W=0,!1;case Vl:return W=1,!1;case Tc:return W=2,!1;case wi:case wu:return W=3,!1}else if(Es(pi)||lo(pi))return Array.isArray(W)||(W=[]),W.push(pi),!1;return si},pt)),pt){var Ht=El(N,De);ce.push(Ht)}}),{size:W,shape:X,stops:ce,position:Be,type:2}},Gl=function(N){return N.type===1},Bu=function(N){return N.type===2},Na={name:"image",parse:function(N,O){if(O.type===22){var X={url:O.value,type:0};return N.cache.addImage(O.value),X}if(O.type===18){var W=ul[O.name];if(typeof W>"u")throw new Error('Attempting to parse an unsupported image function "'+O.name+'"');return W(N,O.values)}throw new Error("Unsupported image type "+O.type)}};function ph(N){return!(N.type===20&&N.value==="none")&&(N.type!==18||!!ul[N.name])}var ul={"linear-gradient":Ic,"-moz-linear-gradient":Ql,"-ms-linear-gradient":Ql,"-o-linear-gradient":Ql,"-webkit-linear-gradient":Ql,"radial-gradient":bo,"-moz-radial-gradient":po,"-ms-radial-gradient":po,"-o-radial-gradient":po,"-webkit-radial-gradient":po,"-webkit-gradient":bu},gn={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(N,O){if(O.length===0)return[];var X=O[0];return X.type===20&&X.value==="none"?[]:O.filter(function(W){return ji(W)&&ph(W)}).map(function(W){return Na.parse(N,W)})}},Ma={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(N,O){return O.map(function(X){if(bn(X))switch(X.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},lc={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(N,O){return eo(O).map(function(X){return X.filter(lo)}).map(wr)}},rA={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(N,O){return eo(O).map(function(X){return X.filter(bn).map(function(W){return W.value}).join(" ")}).map(gh)}},gh=function(N){switch(N){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},mh;(function(N){N.AUTO="auto",N.CONTAIN="contain",N.COVER="cover"})(mh||(mh={}));var Is={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(N,O){return eo(O).map(function(X){return X.filter(hd)})}},hd=function(N){return bn(N)||lo(N)},Hu=function(N){return{name:"border-"+N+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Pf=Hu("top"),$A=Hu("right"),ZA=Hu("bottom"),nA=Hu("left"),yh=function(N){return{name:"border-radius-"+N,initialValue:"0 0",prefix:!1,type:1,parse:function(O,X){return wr(X.filter(lo))}}},Rp=yh("top-left"),sA=yh("top-right"),kf=yh("bottom-right"),Rf=yh("bottom-left"),Vh=function(N){return{name:"border-"+N+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(O,X){switch(X){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},oA=Vh("top"),JA=Vh("right"),vh=Vh("bottom"),Qu=Vh("left"),Cu=function(N){return{name:"border-"+N+"-width",initialValue:"0",type:0,prefix:!1,parse:function(O,X){return Zs(X)?X.number:0}}},Vu=Cu("top"),Gh=Cu("right"),Df=Cu("bottom"),aA=Cu("left"),Of={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Wh={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(N,O){switch(O){case"rtl":return 1;case"ltr":default:return 0}}},lA={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(N,O){return O.filter(bn).reduce(function(X,W){return X|cA(W.value)},0)}},cA=function(N){switch(N){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Xc={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Il={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(N,O){return O.type===20&&O.value==="normal"?0:O.type===17||O.type===15?O.number:0}},il;(function(N){N.NORMAL="normal",N.STRICT="strict"})(il||(il={}));var Uf={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"strict":return il.STRICT;case"normal":default:return il.NORMAL}}},ef={name:"line-height",initialValue:"normal",prefix:!1,type:4},Yc=function(N,O){return bn(N)&&N.value==="normal"?1.2*O:N.type===17?O*N.number:lo(N)?is(N,O):O},Ba={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(N,O){return O.type===20&&O.value==="none"?null:Na.parse(N,O)}},zf={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(N,O){switch(O){case"inside":return 0;case"outside":default:return 1}}},uA={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},dd=function(N){return{name:"margin-"+N,initialValue:"0",prefix:!1,type:4}},Nf=dd("top"),hA=dd("right"),Ad=dd("bottom"),dA=dd("left"),Fc={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(N,O){return O.filter(bn).map(function(X){switch(X.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Xh={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"break-word":return"break-word";case"normal":default:return"normal"}}},Kc=function(N){return{name:"padding-"+N,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},tf=Kc("top"),_h=Kc("right"),Gu=Kc("bottom"),jf=Kc("left"),Wl={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(N,O){switch(O){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},AA={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(N,O){switch(O){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},fd={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.length===1&&vo(O[0],"none")?[]:eo(O).map(function(X){for(var W={color:Sl.TRANSPARENT,offsetX:_o,offsetY:_o,blur:_o},ce=0,Be=0;Be<X.length;Be++){var De=X[Be];Es(De)?(ce===0?W.offsetX=De:ce===1?W.offsetY=De:W.blur=De,ce++):W.color=zl.parse(N,De)}return W})}},fA={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},rf={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(N,O){if(O.type===20&&O.value==="none")return null;if(O.type===18){var X=pd[O.name];if(typeof X>"u")throw new Error('Attempting to parse an unsupported transform function "'+O.name+'"');return X(O.values)}return null}},pA=function(N){var O=N.filter(function(X){return X.type===17}).map(function(X){return X.number});return O.length===6?O:null},xh=function(N){var O=N.filter(function(pt){return pt.type===17}).map(function(pt){return pt.number}),X=O[0],W=O[1];O[2],O[3];var ce=O[4],Be=O[5];O[6],O[7],O[8],O[9],O[10],O[11];var De=O[12],gt=O[13];return O[14],O[15],O.length===16?[X,W,ce,Be,De,gt]:null},pd={matrix:pA,matrix3d:xh},bh={type:16,number:50,flags:En},gA=[bh,bh],D={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(N,O){var X=O.filter(lo);return X.length!==2?gA:[X[0],X[1]]}},K={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(N,O){switch(O){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},se;(function(N){N.NORMAL="normal",N.BREAK_ALL="break-all",N.KEEP_ALL="keep-all"})(se||(se={}));for(var xe={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"break-all":return se.BREAK_ALL;case"keep-all":return se.KEEP_ALL;case"normal":default:return se.NORMAL}}},Oe={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(N,O){if(O.type===20)return{auto:!0,order:0};if(ts(O))return{auto:!1,order:O.number};throw new Error("Invalid z-index number parsed")}},Ke={name:"time",parse:function(N,O){if(O.type===15)switch(O.unit.toLowerCase()){case"s":return 1e3*O.number;case"ms":return O.number}throw new Error("Unsupported time type")}},et={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(N,O){return ts(O)?O.number:1}},st={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},dt={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(N,O){return O.filter(bn).map(function(X){switch(X.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(X){return X!==0})}},wt={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(N,O){var X=[],W=[];return O.forEach(function(ce){switch(ce.type){case 20:case 0:X.push(ce.value);break;case 17:X.push(ce.number.toString());break;case 4:W.push(X.join(" ")),X.length=0;break}}),X.length&&W.push(X.join(" ")),W.map(function(ce){return ce.indexOf(" ")===-1?ce:"'"+ce+"'"})}},Xt={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},xi={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(N,O){if(ts(O))return O.number;if(bn(O))switch(O.value){case"bold":return 700;case"normal":default:return 400}return 400}},Bi={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.filter(bn).map(function(X){return X.value})}},ci={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(N,O){switch(O){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Hi=function(N,O){return(N&O)!==0},Ni={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(N,O){if(O.length===0)return[];var X=O[0];return X.type===20&&X.value==="none"?[]:O}},Zt={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return null;var X=O[0];if(X.type===20&&X.value==="none")return null;for(var W=[],ce=O.filter(Wr),Be=0;Be<ce.length;Be++){var De=ce[Be],gt=ce[Be+1];if(De.type===20){var pt=gt&&ts(gt)?gt.number:1;W.push({counter:De.value,increment:pt})}}return W}},ei={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return[];for(var X=[],W=O.filter(Wr),ce=0;ce<W.length;ce++){var Be=W[ce],De=W[ce+1];if(bn(Be)&&Be.value!=="none"){var gt=De&&ts(De)?De.number:0;X.push({counter:Be.value,reset:gt})}}return X}},qi={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(N,O){return O.filter(Zs).map(function(X){return Ke.parse(N,X)})}},cr={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(N,O){if(O.length===0)return null;var X=O[0];if(X.type===20&&X.value==="none")return null;var W=[],ce=O.filter(Js);if(ce.length%2!==0)return null;for(var Be=0;Be<ce.length;Be+=2){var De=ce[Be].value,gt=ce[Be+1].value;W.push({open:De,close:gt})}return W}},$i=function(N,O,X){if(!N)return"";var W=N[Math.min(O,N.length-1)];return W?X?W.open:W.close:""},Xr={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(N,O){return O.length===1&&vo(O[0],"none")?[]:eo(O).map(function(X){for(var W={color:255,offsetX:_o,offsetY:_o,blur:_o,spread:_o,inset:!1},ce=0,Be=0;Be<X.length;Be++){var De=X[Be];vo(De,"inset")?W.inset=!0:Es(De)?(ce===0?W.offsetX=De:ce===1?W.offsetY=De:ce===2?W.blur=De:W.spread=De,ce++):W.color=zl.parse(N,De)}return W})}},Tr={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(N,O){var X=[0,1,2],W=[];return O.filter(bn).forEach(function(ce){switch(ce.value){case"stroke":W.push(1);break;case"fill":W.push(0);break;case"markers":W.push(2);break}}),X.forEach(function(ce){W.indexOf(ce)===-1&&W.push(ce)}),W}},wn={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},zr={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(N,O){return Zs(O)?O.number:0}},Ms=function(){function N(O,X){var W,ce;this.animationDuration=Ar(O,qi,X.animationDuration),this.backgroundClip=Ar(O,Wc,X.backgroundClip),this.backgroundColor=Ar(O,$o,X.backgroundColor),this.backgroundImage=Ar(O,gn,X.backgroundImage),this.backgroundOrigin=Ar(O,Ma,X.backgroundOrigin),this.backgroundPosition=Ar(O,lc,X.backgroundPosition),this.backgroundRepeat=Ar(O,rA,X.backgroundRepeat),this.backgroundSize=Ar(O,Is,X.backgroundSize),this.borderTopColor=Ar(O,Pf,X.borderTopColor),this.borderRightColor=Ar(O,$A,X.borderRightColor),this.borderBottomColor=Ar(O,ZA,X.borderBottomColor),this.borderLeftColor=Ar(O,nA,X.borderLeftColor),this.borderTopLeftRadius=Ar(O,Rp,X.borderTopLeftRadius),this.borderTopRightRadius=Ar(O,sA,X.borderTopRightRadius),this.borderBottomRightRadius=Ar(O,kf,X.borderBottomRightRadius),this.borderBottomLeftRadius=Ar(O,Rf,X.borderBottomLeftRadius),this.borderTopStyle=Ar(O,oA,X.borderTopStyle),this.borderRightStyle=Ar(O,JA,X.borderRightStyle),this.borderBottomStyle=Ar(O,vh,X.borderBottomStyle),this.borderLeftStyle=Ar(O,Qu,X.borderLeftStyle),this.borderTopWidth=Ar(O,Vu,X.borderTopWidth),this.borderRightWidth=Ar(O,Gh,X.borderRightWidth),this.borderBottomWidth=Ar(O,Df,X.borderBottomWidth),this.borderLeftWidth=Ar(O,aA,X.borderLeftWidth),this.boxShadow=Ar(O,Xr,X.boxShadow),this.color=Ar(O,Of,X.color),this.direction=Ar(O,Wh,X.direction),this.display=Ar(O,lA,X.display),this.float=Ar(O,Xc,X.cssFloat),this.fontFamily=Ar(O,wt,X.fontFamily),this.fontSize=Ar(O,Xt,X.fontSize),this.fontStyle=Ar(O,ci,X.fontStyle),this.fontVariant=Ar(O,Bi,X.fontVariant),this.fontWeight=Ar(O,xi,X.fontWeight),this.letterSpacing=Ar(O,Il,X.letterSpacing),this.lineBreak=Ar(O,Uf,X.lineBreak),this.lineHeight=Ar(O,ef,X.lineHeight),this.listStyleImage=Ar(O,Ba,X.listStyleImage),this.listStylePosition=Ar(O,zf,X.listStylePosition),this.listStyleType=Ar(O,uA,X.listStyleType),this.marginTop=Ar(O,Nf,X.marginTop),this.marginRight=Ar(O,hA,X.marginRight),this.marginBottom=Ar(O,Ad,X.marginBottom),this.marginLeft=Ar(O,dA,X.marginLeft),this.opacity=Ar(O,et,X.opacity);var Be=Ar(O,Fc,X.overflow);this.overflowX=Be[0],this.overflowY=Be[Be.length>1?1:0],this.overflowWrap=Ar(O,Xh,X.overflowWrap),this.paddingTop=Ar(O,tf,X.paddingTop),this.paddingRight=Ar(O,_h,X.paddingRight),this.paddingBottom=Ar(O,Gu,X.paddingBottom),this.paddingLeft=Ar(O,jf,X.paddingLeft),this.paintOrder=Ar(O,Tr,X.paintOrder),this.position=Ar(O,AA,X.position),this.textAlign=Ar(O,Wl,X.textAlign),this.textDecorationColor=Ar(O,st,(W=X.textDecorationColor)!==null&&W!==void 0?W:X.color),this.textDecorationLine=Ar(O,dt,(ce=X.textDecorationLine)!==null&&ce!==void 0?ce:X.textDecoration),this.textShadow=Ar(O,fd,X.textShadow),this.textTransform=Ar(O,fA,X.textTransform),this.transform=Ar(O,rf,X.transform),this.transformOrigin=Ar(O,D,X.transformOrigin),this.visibility=Ar(O,K,X.visibility),this.webkitTextStrokeColor=Ar(O,wn,X.webkitTextStrokeColor),this.webkitTextStrokeWidth=Ar(O,zr,X.webkitTextStrokeWidth),this.wordBreak=Ar(O,xe,X.wordBreak),this.zIndex=Ar(O,Oe,X.zIndex)}return N.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},N.prototype.isTransparent=function(){return Fa(this.backgroundColor)},N.prototype.isTransformed=function(){return this.transform!==null},N.prototype.isPositioned=function(){return this.position!==0},N.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},N.prototype.isFloating=function(){return this.float!==0},N.prototype.isInlineLevel=function(){return Hi(this.display,4)||Hi(this.display,33554432)||Hi(this.display,268435456)||Hi(this.display,536870912)||Hi(this.display,67108864)||Hi(this.display,134217728)},N}(),Vs=function(){function N(O,X){this.content=Ar(O,Ni,X.content),this.quotes=Ar(O,cr,X.quotes)}return N}(),Ps=function(){function N(O,X){this.counterIncrement=Ar(O,Zt,X.counterIncrement),this.counterReset=Ar(O,ei,X.counterReset)}return N}(),Ar=function(N,O,X){var W=new Dn,ce=X!==null&&typeof X<"u"?X.toString():O.initialValue;W.write(ce);var Be=new As(W.read());switch(O.type){case 2:var De=Be.parseComponentValue();return O.parse(N,bn(De)?De.value:O.initialValue);case 0:return O.parse(N,Be.parseComponentValue());case 1:return O.parse(N,Be.parseComponentValues());case 4:return Be.parseComponentValue();case 3:switch(O.format){case"angle":return cl.parse(N,Be.parseComponentValue());case"color":return zl.parse(N,Be.parseComponentValue());case"image":return Na.parse(N,Be.parseComponentValue());case"length":var gt=Be.parseComponentValue();return Es(gt)?gt:_o;case"length-percentage":var pt=Be.parseComponentValue();return lo(pt)?pt:_o;case"time":return Ke.parse(N,Be.parseComponentValue())}break}},ys="data-html2canvas-debug",co=function(N){var O=N.getAttribute(ys);switch(O){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Kn=function(N,O){var X=co(N);return X===1||O===X},$s=function(){function N(O,X){if(this.context=O,this.textNodes=[],this.elements=[],this.flags=0,Kn(X,3))debugger;this.styles=new Ms(O,window.getComputedStyle(X,null)),Id(X)&&(this.styles.animationDuration.some(function(W){return W>0})&&(X.style.animationDuration="0s"),this.styles.transform!==null&&(X.style.transform="none")),this.bounds=b(this.context,X),Kn(X,4)&&(this.flags|=16)}return N}(),Tl="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",wo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",aa=typeof Uint8Array>"u"?[]:new Uint8Array(256),cs=0;cs<wo.length;cs++)aa[wo.charCodeAt(cs)]=cs;for(var ja=function(N){var O=N.length*.75,X=N.length,W,ce=0,Be,De,gt,pt;N[N.length-1]==="="&&(O--,N[N.length-2]==="="&&O--);var Ht=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(O):new Array(O),si=Array.isArray(Ht)?Ht:new Uint8Array(Ht);for(W=0;W<X;W+=4)Be=aa[N.charCodeAt(W)],De=aa[N.charCodeAt(W+1)],gt=aa[N.charCodeAt(W+2)],pt=aa[N.charCodeAt(W+3)],si[ce++]=Be<<2|De>>4,si[ce++]=(De&15)<<4|gt>>2,si[ce++]=(gt&3)<<6|pt&63;return Ht},Ha=function(N){for(var O=N.length,X=[],W=0;W<O;W+=2)X.push(N[W+1]<<8|N[W]);return X},Ca=function(N){for(var O=N.length,X=[],W=0;W<O;W+=4)X.push(N[W+3]<<24|N[W+2]<<16|N[W+1]<<8|N[W]);return X},uo=5,Zo=11,Qa=2,cc=Zo-uo,la=65536>>uo,Va=1<<uo,Ga=Va-1,Zi=1024>>uo,Su=la+Zi,Qo=Su,qc=32,Eu=Qo+qc,Br=65536>>Zo,Wu=1<<cc,gd=Wu-1,md=function(N,O,X){return N.slice?N.slice(O,X):new Uint16Array(Array.prototype.slice.call(N,O,X))},Xl=function(N,O,X){return N.slice?N.slice(O,X):new Uint32Array(Array.prototype.slice.call(N,O,X))},wh=function(N,O){var X=ja(N),W=Array.isArray(X)?Ca(X):new Uint32Array(X),ce=Array.isArray(X)?Ha(X):new Uint16Array(X),Be=24,De=md(ce,Be/2,W[4]/2),gt=W[5]===2?md(ce,(Be+W[4])/2):Xl(W,Math.ceil((Be+W[4])/4));return new Yh(W[0],W[1],W[2],W[3],De,gt)},Yh=function(){function N(O,X,W,ce,Be,De){this.initialValue=O,this.errorValue=X,this.highStart=W,this.highValueIndex=ce,this.index=Be,this.data=De}return N.prototype.get=function(O){var X;if(O>=0){if(O<55296||O>56319&&O<=65535)return X=this.index[O>>uo],X=(X<<Qa)+(O&Ga),this.data[X];if(O<=65535)return X=this.index[la+(O-55296>>uo)],X=(X<<Qa)+(O&Ga),this.data[X];if(O<this.highStart)return X=Eu-Br+(O>>Zo),X=this.index[X],X+=O>>uo&gd,X=this.index[X],X=(X<<Qa)+(O&Ga),this.data[X];if(O<=1114111)return this.data[this.highValueIndex]}return this.errorValue},N}(),mA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yA=typeof Uint8Array>"u"?[]:new Uint8Array(256),yd=0;yd<mA.length;yd++)yA[mA.charCodeAt(yd)]=yd;var Wa=1,Bh=2,ca=3,Fl=4,Xu=5,vA=7,Ch=8,hl=9,_A=10,$c=11,$n=12,Sh=13,uc=14,vd=15,nf=function(N){for(var O=[],X=0,W=N.length;X<W;){var ce=N.charCodeAt(X++);if(ce>=55296&&ce<=56319&&X<W){var Be=N.charCodeAt(X++);(Be&64512)===56320?O.push(((ce&1023)<<10)+(Be&1023)+65536):(O.push(ce),X--)}else O.push(ce)}return O},_d=function(){for(var N=[],O=0;O<arguments.length;O++)N[O]=arguments[O];if(String.fromCodePoint)return String.fromCodePoint.apply(String,N);var X=N.length;if(!X)return"";for(var W=[],ce=-1,Be="";++ce<X;){var De=N[ce];De<=65535?W.push(De):(De-=65536,W.push((De>>10)+55296,De%1024+56320)),(ce+1===X||W.length>16384)&&(Be+=String.fromCharCode.apply(String,W),W.length=0)}return Be},sf=wh(Tl),ua="×",Zc="÷",Ei=function(N){return sf.get(N)},Gi=function(N,O,X){var W=X-2,ce=O[W],Be=O[X-1],De=O[X];if(Be===Bh&&De===ca)return ua;if(Be===Bh||Be===ca||Be===Fl||De===Bh||De===ca||De===Fl)return Zc;if(Be===Ch&&[Ch,hl,$c,$n].indexOf(De)!==-1||(Be===$c||Be===hl)&&(De===hl||De===_A)||(Be===$n||Be===_A)&&De===_A||De===Sh||De===Xu||De===vA||Be===Wa)return ua;if(Be===Sh&&De===uc){for(;ce===Xu;)ce=O[--W];if(ce===uc)return ua}if(Be===vd&&De===vd){for(var gt=0;ce===vd;)gt++,ce=O[--W];if(gt%2===0)return ua}return Zc},Yu=function(N){var O=nf(N),X=O.length,W=0,ce=0,Be=O.map(Ei);return{next:function(){if(W>=X)return{done:!0,value:null};for(var De=ua;W<X&&(De=Gi(O,Be,++W))===ua;);if(De!==ua||W===X){var gt=_d.apply(null,O.slice(ce,W));return ce=W,{value:gt,done:!1}}return{done:!0,value:null}}}},Ns=function(N){for(var O=Yu(N),X=[],W;!(W=O.next()).done;)W.value&&X.push(W.value.slice());return X},Lt=function(N){var O=123;if(N.createRange){var X=N.createRange();if(X.getBoundingClientRect){var W=N.createElement("boundtest");W.style.height=O+"px",W.style.display="block",N.body.appendChild(W),X.selectNode(W);var ce=X.getBoundingClientRect(),Be=Math.round(ce.height);if(N.body.removeChild(W),Be===O)return!0}}return!1},hc=function(N){var O=N.createElement("boundtest");O.style.width="50px",O.style.display="block",O.style.fontSize="12px",O.style.letterSpacing="0px",O.style.wordSpacing="0px",N.body.appendChild(O);var X=N.createRange();O.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var W=O.firstChild,ce=B(W.data).map(function(pt){return I(pt)}),Be=0,De={},gt=ce.every(function(pt,Ht){X.setStart(W,Be),X.setEnd(W,Be+pt.length);var si=X.getBoundingClientRect();Be+=pt.length;var pi=si.x>De.x||si.y>De.y;return De=si,Ht===0?!0:pi});return N.body.removeChild(O),gt},xd=function(){return typeof new Image().crossOrigin<"u"},xA=function(){return typeof new XMLHttpRequest().responseType=="string"},bA=function(N){var O=new Image,X=N.createElement("canvas"),W=X.getContext("2d");if(!W)return!1;O.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{W.drawImage(O,0,0),X.toDataURL()}catch{return!1}return!0},Ku=function(N){return N[0]===0&&N[1]===255&&N[2]===0&&N[3]===255},Hf=function(N){var O=N.createElement("canvas"),X=100;O.width=X,O.height=X;var W=O.getContext("2d");if(!W)return Promise.reject(!1);W.fillStyle="rgb(0, 255, 0)",W.fillRect(0,0,X,X);var ce=new Image,Be=O.toDataURL();ce.src=Be;var De=Iu(X,X,0,0,ce);return W.fillStyle="red",W.fillRect(0,0,X,X),Qf(De).then(function(gt){W.drawImage(gt,0,0);var pt=W.getImageData(0,0,X,X).data;W.fillStyle="red",W.fillRect(0,0,X,X);var Ht=N.createElement("div");return Ht.style.backgroundImage="url("+Be+")",Ht.style.height=X+"px",Ku(pt)?Qf(Iu(X,X,0,0,Ht)):Promise.reject(!1)}).then(function(gt){return W.drawImage(gt,0,0),Ku(W.getImageData(0,0,X,X).data)}).catch(function(){return!1})},Iu=function(N,O,X,W,ce){var Be="http://www.w3.org/2000/svg",De=document.createElementNS(Be,"svg"),gt=document.createElementNS(Be,"foreignObject");return De.setAttributeNS(null,"width",N.toString()),De.setAttributeNS(null,"height",O.toString()),gt.setAttributeNS(null,"width","100%"),gt.setAttributeNS(null,"height","100%"),gt.setAttributeNS(null,"x",X.toString()),gt.setAttributeNS(null,"y",W.toString()),gt.setAttributeNS(null,"externalResourcesRequired","true"),De.appendChild(gt),gt.appendChild(ce),De},Qf=function(N){return new Promise(function(O,X){var W=new Image;W.onload=function(){return O(W)},W.onerror=X,W.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(N))})},Pa={get SUPPORT_RANGE_BOUNDS(){var N=Lt(document);return Object.defineProperty(Pa,"SUPPORT_RANGE_BOUNDS",{value:N}),N},get SUPPORT_WORD_BREAKING(){var N=Pa.SUPPORT_RANGE_BOUNDS&&hc(document);return Object.defineProperty(Pa,"SUPPORT_WORD_BREAKING",{value:N}),N},get SUPPORT_SVG_DRAWING(){var N=bA(document);return Object.defineProperty(Pa,"SUPPORT_SVG_DRAWING",{value:N}),N},get SUPPORT_FOREIGNOBJECT_DRAWING(){var N=typeof Array.from=="function"&&typeof window.fetch=="function"?Hf(document):Promise.resolve(!1);return Object.defineProperty(Pa,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:N}),N},get SUPPORT_CORS_IMAGES(){var N=xd();return Object.defineProperty(Pa,"SUPPORT_CORS_IMAGES",{value:N}),N},get SUPPORT_RESPONSE_TYPE(){var N=xA();return Object.defineProperty(Pa,"SUPPORT_RESPONSE_TYPE",{value:N}),N},get SUPPORT_CORS_XHR(){var N="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Pa,"SUPPORT_CORS_XHR",{value:N}),N},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var N=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Pa,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:N}),N}},Kh=function(){function N(O,X){this.text=O,this.bounds=X}return N}(),qu=function(N,O,X,W){var ce=Ac(O,X),Be=[],De=0;return ce.forEach(function(gt){if(X.textDecorationLine.length||gt.trim().length>0)if(Pa.SUPPORT_RANGE_BOUNDS){var pt=Eh(W,De,gt.length).getClientRects();if(pt.length>1){var Ht=dc(gt),si=0;Ht.forEach(function(Ui){Be.push(new Kh(Ui,y.fromDOMRectList(N,Eh(W,si+De,Ui.length).getClientRects()))),si+=Ui.length})}else Be.push(new Kh(gt,y.fromDOMRectList(N,pt)))}else{var pi=W.splitText(gt.length);Be.push(new Kh(gt,bd(N,W))),W=pi}else Pa.SUPPORT_RANGE_BOUNDS||(W=W.splitText(gt.length));De+=gt.length}),Be},bd=function(N,O){var X=O.ownerDocument;if(X){var W=X.createElement("html2canvaswrapper");W.appendChild(O.cloneNode(!0));var ce=O.parentNode;if(ce){ce.replaceChild(W,O);var Be=b(N,W);return W.firstChild&&ce.replaceChild(W.firstChild,W),Be}}return y.EMPTY},Eh=function(N,O,X){var W=N.ownerDocument;if(!W)throw new Error("Node has no owner document");var ce=W.createRange();return ce.setStart(N,O),ce.setEnd(N,O+X),ce},dc=function(N){if(Pa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var O=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(O.segment(N)).map(function(X){return X.segment})}return Ns(N)},Lc=function(N,O){if(Pa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var X=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(X.segment(N)).map(function(W){return W.segment})}return wd(N,O)},Ac=function(N,O){return O.letterSpacing!==0?dc(N):Lc(N,O)},Jc=[32,160,4961,65792,65793,4153,4241],wd=function(N,O){for(var X=qn(N,{lineBreak:O.lineBreak,wordBreak:O.overflowWrap==="break-word"?"break-word":O.wordBreak}),W=[],ce,Be=function(){if(ce.value){var De=ce.value.slice(),gt=B(De),pt="";gt.forEach(function(Ht){Jc.indexOf(Ht)===-1?pt+=I(Ht):(pt.length&&W.push(pt),W.push(I(Ht)),pt="")}),pt.length&&W.push(pt)}};!(ce=X.next()).done;)Be();return W},Tu=function(){function N(O,X,W){this.text=Xa(X.data,W.textTransform),this.textBounds=qu(O,this.text,W,X)}return N}(),Xa=function(N,O){switch(O){case 1:return N.toLowerCase();case 3:return N.replace(of,Ih);case 2:return N.toUpperCase();default:return N}},of=/(^|\s|:|-|\(|\))([a-z])/g,Ih=function(N,O,X){return N.length>0?O+X.toUpperCase():N},ks=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.src=W.currentSrc||W.src,ce.intrinsicWidth=W.naturalWidth,ce.intrinsicHeight=W.naturalHeight,ce.context.cache.addImage(ce.src),ce}return O}($s),On=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.canvas=W,ce.intrinsicWidth=W.width,ce.intrinsicHeight=W.height,ce}return O}($s),Vf=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this,Be=new XMLSerializer,De=b(X,W);return W.setAttribute("width",De.width+"px"),W.setAttribute("height",De.height+"px"),ce.svg="data:image/svg+xml,"+encodeURIComponent(Be.serializeToString(W)),ce.intrinsicWidth=W.width.baseVal.value,ce.intrinsicHeight=W.height.baseVal.value,ce.context.cache.addImage(ce.svg),ce}return O}($s),$u=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.value=W.value,ce}return O}($s),Bd=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.start=W.start,ce.reversed=typeof W.reversed=="boolean"&&W.reversed===!0,ce}return O}($s),wA=[{type:15,flags:0,unit:"px",number:3}],qh=[{type:16,flags:0,number:50}],Dp=function(N){return N.width>N.height?new y(N.left+(N.width-N.height)/2,N.top,N.height,N.height):N.width<N.height?new y(N.left,N.top+(N.height-N.width)/2,N.width,N.width):N},Gf=function(N){var O=N.type===Zu?new Array(N.value.length+1).join("•"):N.value;return O.length===0?N.placeholder||"":O},Th="checkbox",BA="radio",Zu="password",Fh=707406591,Cd=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;switch(ce.type=W.type.toLowerCase(),ce.checked=W.checked,ce.value=Gf(W),(ce.type===Th||ce.type===BA)&&(ce.styles.backgroundColor=3739148031,ce.styles.borderTopColor=ce.styles.borderRightColor=ce.styles.borderBottomColor=ce.styles.borderLeftColor=2779096575,ce.styles.borderTopWidth=ce.styles.borderRightWidth=ce.styles.borderBottomWidth=ce.styles.borderLeftWidth=1,ce.styles.borderTopStyle=ce.styles.borderRightStyle=ce.styles.borderBottomStyle=ce.styles.borderLeftStyle=1,ce.styles.backgroundClip=[0],ce.styles.backgroundOrigin=[0],ce.bounds=Dp(ce.bounds)),ce.type){case Th:ce.styles.borderTopRightRadius=ce.styles.borderTopLeftRadius=ce.styles.borderBottomRightRadius=ce.styles.borderBottomLeftRadius=wA;break;case BA:ce.styles.borderTopRightRadius=ce.styles.borderTopLeftRadius=ce.styles.borderBottomRightRadius=ce.styles.borderBottomLeftRadius=qh;break}return ce}return O}($s),af=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this,Be=W.options[W.selectedIndex||0];return ce.value=Be&&Be.text||"",ce}return O}($s),Sd=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.value=W.value,ce}return O}($s),Ed=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;ce.src=W.src,ce.width=parseInt(W.width,10)||0,ce.height=parseInt(W.height,10)||0,ce.backgroundColor=ce.styles.backgroundColor;try{if(W.contentWindow&&W.contentWindow.document&&W.contentWindow.document.documentElement){ce.tree=Wf(X,W.contentWindow.document.documentElement);var Be=W.contentWindow.document.documentElement?jl(X,getComputedStyle(W.contentWindow.document.documentElement).backgroundColor):Sl.TRANSPARENT,De=W.contentWindow.document.body?jl(X,getComputedStyle(W.contentWindow.document.body).backgroundColor):Sl.TRANSPARENT;ce.backgroundColor=Fa(Be)?Fa(De)?ce.styles.backgroundColor:De:Be}}catch{}return ce}return O}($s),Ya=["OL","UL","MENU"],Lh=function(N,O,X,W){for(var ce=O.firstChild,Be=void 0;ce;ce=Be)if(Be=ce.nextSibling,CA(ce)&&ce.data.trim().length>0)X.textNodes.push(new Tu(N,ce,X.styles));else if(Jo(ce))if(Np(ce)&&ce.assignedNodes)ce.assignedNodes().forEach(function(gt){return Lh(N,gt,X,W)});else{var De=Mh(N,ce);De.styles.isVisible()&&(Xf(ce,De,W)?De.flags|=4:Op(De.styles)&&(De.flags|=2),Ya.indexOf(ce.tagName)!==-1&&(De.flags|=8),X.elements.push(De),ce.slot,ce.shadowRoot?Lh(N,ce.shadowRoot,De,W):!uf(ce)&&!cf(ce)&&!Td(ce)&&Lh(N,ce,De,W))}},Mh=function(N,O){return Zh(O)?new ks(N,O):Yf(O)?new On(N,O):cf(O)?new Vf(N,O):Up(O)?new $u(N,O):$h(O)?new Bd(N,O):lf(O)?new Cd(N,O):Td(O)?new af(N,O):uf(O)?new Sd(N,O):IA(O)?new Ed(N,O):new $s(N,O)},Wf=function(N,O){var X=Mh(N,O);return X.flags|=4,Lh(N,O,X,X),X},Xf=function(N,O,X){return O.styles.isPositionedWithZIndex()||O.styles.opacity<1||O.styles.isTransformed()||Ph(N)&&X.styles.isTransparent()},Op=function(N){return N.isPositioned()||N.isFloating()},CA=function(N){return N.nodeType===Node.TEXT_NODE},Jo=function(N){return N.nodeType===Node.ELEMENT_NODE},Id=function(N){return Jo(N)&&typeof N.style<"u"&&!SA(N)},SA=function(N){return typeof N.className=="object"},Up=function(N){return N.tagName==="LI"},$h=function(N){return N.tagName==="OL"},lf=function(N){return N.tagName==="INPUT"},zp=function(N){return N.tagName==="HTML"},cf=function(N){return N.tagName==="svg"},Ph=function(N){return N.tagName==="BODY"},Yf=function(N){return N.tagName==="CANVAS"},EA=function(N){return N.tagName==="VIDEO"},Zh=function(N){return N.tagName==="IMG"},IA=function(N){return N.tagName==="IFRAME"},Kf=function(N){return N.tagName==="STYLE"},qf=function(N){return N.tagName==="SCRIPT"},uf=function(N){return N.tagName==="TEXTAREA"},Td=function(N){return N.tagName==="SELECT"},Np=function(N){return N.tagName==="SLOT"},jp=function(N){return N.tagName.indexOf("-")>0},Fg=function(){function N(){this.counters={}}return N.prototype.getCounterValue=function(O){var X=this.counters[O];return X&&X.length?X[X.length-1]:1},N.prototype.getCounterValues=function(O){var X=this.counters[O];return X||[]},N.prototype.pop=function(O){var X=this;O.forEach(function(W){return X.counters[W].pop()})},N.prototype.parse=function(O){var X=this,W=O.counterIncrement,ce=O.counterReset,Be=!0;W!==null&&W.forEach(function(gt){var pt=X.counters[gt.counter];pt&&gt.increment!==0&&(Be=!1,pt.length||pt.push(1),pt[Math.max(0,pt.length-1)]+=gt.increment)});var De=[];return Be&&ce.forEach(function(gt){var pt=X.counters[gt.counter];De.push(gt.counter),pt||(pt=X.counters[gt.counter]=[]),pt.push(gt.reset)}),De},N}(),Hp={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},$f={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},Lg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Mg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Fd=function(N,O,X,W,ce,Be){return N<O||N>X?Md(N,ce,Be.length>0):W.integers.reduce(function(De,gt,pt){for(;N>=gt;)N-=gt,De+=W.values[pt];return De},"")+Be},Qp=function(N,O,X,W){var ce="";do X||N--,ce=W(N)+ce,N/=O;while(N*O>=O);return ce},ga=function(N,O,X,W,ce){var Be=X-O+1;return(N<0?"-":"")+(Qp(Math.abs(N),Be,W,function(De){return I(Math.floor(De%Be)+O)})+ce)},Jh=function(N,O,X){X===void 0&&(X=". ");var W=O.length;return Qp(Math.abs(N),W,!1,function(ce){return O[Math.floor(ce%W)]})+X},TA=1,ed=2,Fu=4,Gs=8,Ju=function(N,O,X,W,ce,Be){if(N<-9999||N>9999)return Md(N,4,ce.length>0);var De=Math.abs(N),gt=ce;if(De===0)return O[0]+gt;for(var pt=0;De>0&&pt<=4;pt++){var Ht=De%10;Ht===0&&Hi(Be,TA)&&gt!==""?gt=O[Ht]+gt:Ht>1||Ht===1&&pt===0||Ht===1&&pt===1&&Hi(Be,ed)||Ht===1&&pt===1&&Hi(Be,Fu)&&N>100||Ht===1&&pt>1&&Hi(Be,Gs)?gt=O[Ht]+(pt>0?X[pt-1]:"")+gt:Ht===1&&pt>0&&(gt=X[pt-1]+gt),De=Math.floor(De/10)}return(N<0?W:"")+gt},hf="十百千萬",Zf="拾佰仟萬",Vp="マイナス",Ld="마이너스",Md=function(N,O,X){var W=X?". ":"",ce=X?"、":"",Be=X?", ":"",De=X?" ":"";switch(O){case 0:return"•"+De;case 1:return"◦"+De;case 2:return"◾"+De;case 5:var gt=ga(N,48,57,!0,W);return gt.length<4?"0"+gt:gt;case 4:return Jh(N,"〇一二三四五六七八九",ce);case 6:return Fd(N,1,3999,Hp,3,W).toLowerCase();case 7:return Fd(N,1,3999,Hp,3,W);case 8:return ga(N,945,969,!1,W);case 9:return ga(N,97,122,!1,W);case 10:return ga(N,65,90,!1,W);case 11:return ga(N,1632,1641,!0,W);case 12:case 49:return Fd(N,1,9999,$f,3,W);case 35:return Fd(N,1,9999,$f,3,W).toLowerCase();case 13:return ga(N,2534,2543,!0,W);case 14:case 30:return ga(N,6112,6121,!0,W);case 15:return Jh(N,"子丑寅卯辰巳午未申酉戌亥",ce);case 16:return Jh(N,"甲乙丙丁戊己庚辛壬癸",ce);case 17:case 48:return Ju(N,"零一二三四五六七八九",hf,"負",ce,ed|Fu|Gs);case 47:return Ju(N,"零壹貳參肆伍陸柒捌玖",Zf,"負",ce,TA|ed|Fu|Gs);case 42:return Ju(N,"零一二三四五六七八九",hf,"负",ce,ed|Fu|Gs);case 41:return Ju(N,"零壹贰叁肆伍陆柒捌玖",Zf,"负",ce,TA|ed|Fu|Gs);case 26:return Ju(N,"〇一二三四五六七八九","十百千万",Vp,ce,0);case 25:return Ju(N,"零壱弐参四伍六七八九","拾百千万",Vp,ce,TA|ed|Fu);case 31:return Ju(N,"영일이삼사오육칠팔구","십백천만",Ld,Be,TA|ed|Fu);case 33:return Ju(N,"零一二三四五六七八九","十百千萬",Ld,Be,0);case 32:return Ju(N,"零壹貳參四五六七八九","拾百千",Ld,Be,TA|ed|Fu);case 18:return ga(N,2406,2415,!0,W);case 20:return Fd(N,1,19999,Mg,3,W);case 21:return ga(N,2790,2799,!0,W);case 22:return ga(N,2662,2671,!0,W);case 22:return Fd(N,1,10999,Lg,3,W);case 23:return Jh(N,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return Jh(N,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return ga(N,3302,3311,!0,W);case 28:return Jh(N,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",ce);case 29:return Jh(N,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",ce);case 34:return ga(N,3792,3801,!0,W);case 37:return ga(N,6160,6169,!0,W);case 38:return ga(N,4160,4169,!0,W);case 39:return ga(N,2918,2927,!0,W);case 40:return ga(N,1776,1785,!0,W);case 43:return ga(N,3046,3055,!0,W);case 44:return ga(N,3174,3183,!0,W);case 45:return ga(N,3664,3673,!0,W);case 46:return ga(N,3872,3881,!0,W);case 3:default:return ga(N,48,57,!0,W)}},df="data-html2canvas-ignore",FA=function(){function N(O,X,W){if(this.context=O,this.options=W,this.scrolledElements=[],this.referenceElement=X,this.counters=new Fg,this.quoteDepth=0,!X.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(X.ownerDocument.documentElement,!1)}return N.prototype.toIFrame=function(O,X){var W=this,ce=Jf(O,X);if(!ce.contentWindow)return Promise.reject("Unable to find iframe window");var Be=O.defaultView.pageXOffset,De=O.defaultView.pageYOffset,gt=ce.contentWindow,pt=gt.document,Ht=Af(ce).then(function(){return h(W,void 0,void 0,function(){var si,pi;return A(this,function(Ui){switch(Ui.label){case 0:return this.scrolledElements.forEach(Gp),gt&&(gt.scrollTo(X.left,X.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(gt.scrollY!==X.top||gt.scrollX!==X.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(gt.scrollX-X.left,gt.scrollY-X.top,0,0))),si=this.options.onclone,pi=this.clonedReferenceElement,typeof pi>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:pt.fonts&&pt.fonts.ready?[4,pt.fonts.ready]:[3,2];case 1:Ui.sent(),Ui.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,eh(pt)]:[3,4];case 3:Ui.sent(),Ui.label=4;case 4:return typeof si=="function"?[2,Promise.resolve().then(function(){return si(pt,pi)}).then(function(){return ce})]:[2,ce]}})})});return pt.open(),pt.write(Sm(document.doctype)+"<html></html>"),LA(this.referenceElement.ownerDocument,Be,De),pt.replaceChild(pt.adoptNode(this.documentElement),pt.documentElement),pt.close(),Ht},N.prototype.createElementClone=function(O){if(Kn(O,2))debugger;if(Yf(O))return this.createCanvasClone(O);if(EA(O))return this.createVideoClone(O);if(Kf(O))return this.createStyleClone(O);var X=O.cloneNode(!1);return Zh(X)&&(Zh(O)&&O.currentSrc&&O.currentSrc!==O.src&&(X.src=O.currentSrc,X.srcset=""),X.loading==="lazy"&&(X.loading="eager")),jp(X)?this.createCustomElementClone(X):X},N.prototype.createCustomElementClone=function(O){var X=document.createElement("html2canvascustomelement");return tp(O.style,X),X},N.prototype.createStyleClone=function(O){try{var X=O.sheet;if(X&&X.cssRules){var W=[].slice.call(X.cssRules,0).reduce(function(Be,De){return De&&typeof De.cssText=="string"?Be+De.cssText:Be},""),ce=O.cloneNode(!1);return ce.textContent=W,ce}}catch(Be){if(this.context.logger.error("Unable to access cssRules property",Be),Be.name!=="SecurityError")throw Be}return O.cloneNode(!1)},N.prototype.createCanvasClone=function(O){var X;if(this.options.inlineImages&&O.ownerDocument){var W=O.ownerDocument.createElement("img");try{return W.src=O.toDataURL(),W}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",O)}}var ce=O.cloneNode(!1);try{ce.width=O.width,ce.height=O.height;var Be=O.getContext("2d"),De=ce.getContext("2d");if(De)if(!this.options.allowTaint&&Be)De.putImageData(Be.getImageData(0,0,O.width,O.height),0,0);else{var gt=(X=O.getContext("webgl2"))!==null&&X!==void 0?X:O.getContext("webgl");if(gt){var pt=gt.getContextAttributes();(pt==null?void 0:pt.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",O)}De.drawImage(O,0,0)}return ce}catch{this.context.logger.info("Unable to clone canvas as it is tainted",O)}return ce},N.prototype.createVideoClone=function(O){var X=O.ownerDocument.createElement("canvas");X.width=O.offsetWidth,X.height=O.offsetHeight;var W=X.getContext("2d");try{return W&&(W.drawImage(O,0,0,X.width,X.height),this.options.allowTaint||W.getImageData(0,0,X.width,X.height)),X}catch{this.context.logger.info("Unable to clone video as it is tainted",O)}var ce=O.ownerDocument.createElement("canvas");return ce.width=O.offsetWidth,ce.height=O.offsetHeight,ce},N.prototype.appendChildNode=function(O,X,W){(!Jo(X)||!qf(X)&&!X.hasAttribute(df)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(X)))&&(!this.options.copyStyles||!Jo(X)||!Kf(X))&&O.appendChild(this.cloneNode(X,W))},N.prototype.cloneChildNodes=function(O,X,W){for(var ce=this,Be=O.shadowRoot?O.shadowRoot.firstChild:O.firstChild;Be;Be=Be.nextSibling)if(Jo(Be)&&Np(Be)&&typeof Be.assignedNodes=="function"){var De=Be.assignedNodes();De.length&&De.forEach(function(gt){return ce.appendChildNode(X,gt,W)})}else this.appendChildNode(X,Be,W)},N.prototype.cloneNode=function(O,X){if(CA(O))return document.createTextNode(O.data);if(!O.ownerDocument)return O.cloneNode(!1);var W=O.ownerDocument.defaultView;if(W&&Jo(O)&&(Id(O)||SA(O))){var ce=this.createElementClone(O);ce.style.transitionProperty="none";var Be=W.getComputedStyle(O),De=W.getComputedStyle(O,":before"),gt=W.getComputedStyle(O,":after");this.referenceElement===O&&Id(ce)&&(this.clonedReferenceElement=ce),Ph(ce)&&kh(ce);var pt=this.counters.parse(new Ps(this.context,Be)),Ht=this.resolvePseudoContent(O,ce,De,Mc.BEFORE);jp(O)&&(X=!0),EA(O)||this.cloneChildNodes(O,ce,X),Ht&&ce.insertBefore(Ht,ce.firstChild);var si=this.resolvePseudoContent(O,ce,gt,Mc.AFTER);return si&&ce.appendChild(si),this.counters.pop(pt),(Be&&(this.options.copyStyles||SA(O))&&!IA(O)||X)&&tp(Be,ce),(O.scrollTop!==0||O.scrollLeft!==0)&&this.scrolledElements.push([ce,O.scrollLeft,O.scrollTop]),(uf(O)||Td(O))&&(uf(ce)||Td(ce))&&(ce.value=O.value),ce}return O.cloneNode(!1)},N.prototype.resolvePseudoContent=function(O,X,W,ce){var Be=this;if(W){var De=W.content,gt=X.ownerDocument;if(!(!gt||!De||De==="none"||De==="-moz-alt-content"||W.display==="none")){this.counters.parse(new Ps(this.context,W));var pt=new Vs(this.context,W),Ht=gt.createElement("html2canvaspseudoelement");tp(W,Ht),pt.content.forEach(function(pi){if(pi.type===0)Ht.appendChild(gt.createTextNode(pi.value));else if(pi.type===22){var Ui=gt.createElement("img");Ui.src=pi.value,Ui.style.opacity="1",Ht.appendChild(Ui)}else if(pi.type===18){if(pi.name==="attr"){var Gr=pi.values.filter(bn);Gr.length&&Ht.appendChild(gt.createTextNode(O.getAttribute(Gr[0].value)||""))}else if(pi.name==="counter"){var vr=pi.values.filter(ji),Rr=vr[0],Jn=vr[1];if(Rr&&bn(Rr)){var An=Be.counters.getCounterValue(Rr.value),rn=Jn&&bn(Jn)?uA.parse(Be.context,Jn.value):3;Ht.appendChild(gt.createTextNode(Md(An,rn,!1)))}}else if(pi.name==="counters"){var Ys=pi.values.filter(ji),Rr=Ys[0],ns=Ys[1],Jn=Ys[2];if(Rr&&bn(Rr)){var Un=Be.counters.getCounterValues(Rr.value),Kr=Jn&&bn(Jn)?uA.parse(Be.context,Jn.value):3,os=ns&&ns.type===0?ns.value:"",Bs=Un.map(function(fc){return Md(fc,Kr,!1)}).join(os);Ht.appendChild(gt.createTextNode(Bs))}}}else if(pi.type===20)switch(pi.value){case"open-quote":Ht.appendChild(gt.createTextNode($i(pt.quotes,Be.quoteDepth++,!0)));break;case"close-quote":Ht.appendChild(gt.createTextNode($i(pt.quotes,--Be.quoteDepth,!1)));break;default:Ht.appendChild(gt.createTextNode(pi.value))}}),Ht.className=pf+" "+Pd;var si=ce===Mc.BEFORE?" "+pf:" "+Pd;return SA(X)?X.className.baseValue+=si:X.className+=si,Ht}}},N.destroy=function(O){return O.parentNode?(O.parentNode.removeChild(O),!0):!1},N}(),Mc;(function(N){N[N.BEFORE=0]="BEFORE",N[N.AFTER=1]="AFTER"})(Mc||(Mc={}));var Jf=function(N,O){var X=N.createElement("iframe");return X.className="html2canvas-container",X.style.visibility="hidden",X.style.position="fixed",X.style.left="-10000px",X.style.top="0px",X.style.border="0",X.width=O.width.toString(),X.height=O.height.toString(),X.scrolling="no",X.setAttribute(df,"true"),N.body.appendChild(X),X},Fo=function(N){return new Promise(function(O){if(N.complete){O();return}if(!N.src){O();return}N.onload=O,N.onerror=O})},eh=function(N){return Promise.all([].slice.call(N.images,0).map(Fo))},Af=function(N){return new Promise(function(O,X){var W=N.contentWindow;if(!W)return X("No window assigned for iframe");var ce=W.document;W.onload=N.onload=function(){W.onload=N.onload=null;var Be=setInterval(function(){ce.body.childNodes.length>0&&ce.readyState==="complete"&&(clearInterval(Be),O(N))},50)}})},ep=["all","d","content"],tp=function(N,O){for(var X=N.length-1;X>=0;X--){var W=N.item(X);ep.indexOf(W)===-1&&O.style.setProperty(W,N.getPropertyValue(W))}return O},Sm=function(N){var O="";return N&&(O+="<!DOCTYPE ",N.name&&(O+=N.name),N.internalSubset&&(O+=N.internalSubset),N.publicId&&(O+='"'+N.publicId+'"'),N.systemId&&(O+='"'+N.systemId+'"'),O+=">"),O},LA=function(N,O,X){N&&N.defaultView&&(O!==N.defaultView.pageXOffset||X!==N.defaultView.pageYOffset)&&N.defaultView.scrollTo(O,X)},Gp=function(N){var O=N[0],X=N[1],W=N[2];O.scrollLeft=X,O.scrollTop=W},th=":before",ff=":after",pf="___html2canvas___pseudoelement_before",Pd="___html2canvas___pseudoelement_after",kd=`{
    content: "" !important;
    display: none !important;
}`,kh=function(N){Lu(N,"."+pf+th+kd+`
         .`+Pd+ff+kd)},Lu=function(N,O){var X=N.ownerDocument;if(X){var W=X.createElement("style");W.textContent=O,N.appendChild(W)}},Pc=function(){function N(){}return N.getOrigin=function(O){var X=N._link;return X?(X.href=O,X.href=X.href,X.protocol+X.hostname+X.port):"about:blank"},N.isSameOrigin=function(O){return N.getOrigin(O)===N._origin},N.setContext=function(O){N._link=O.document.createElement("a"),N._origin=N.getOrigin(O.location.href)},N._origin="about:blank",N}(),MA=function(){function N(O,X){this.context=O,this._options=X,this._cache={}}return N.prototype.addImage=function(O){var X=Promise.resolve();return this.has(O)||(S(O)||g(O))&&(this._cache[O]=this.loadImage(O)).catch(function(){}),X},N.prototype.match=function(O){return this._cache[O]},N.prototype.loadImage=function(O){return h(this,void 0,void 0,function(){var X,W,ce,Be,De=this;return A(this,function(gt){switch(gt.label){case 0:return X=Pc.isSameOrigin(O),W=!x(O)&&this._options.useCORS===!0&&Pa.SUPPORT_CORS_IMAGES&&!X,ce=!x(O)&&!X&&!S(O)&&typeof this._options.proxy=="string"&&Pa.SUPPORT_CORS_XHR&&!W,!X&&this._options.allowTaint===!1&&!x(O)&&!S(O)&&!ce&&!W?[2]:(Be=O,ce?[4,this.proxy(Be)]:[3,2]);case 1:Be=gt.sent(),gt.label=2;case 2:return this.context.logger.debug("Added image "+O.substring(0,256)),[4,new Promise(function(pt,Ht){var si=new Image;si.onload=function(){return pt(si)},si.onerror=Ht,(w(Be)||W)&&(si.crossOrigin="anonymous"),si.src=Be,si.complete===!0&&setTimeout(function(){return pt(si)},500),De._options.imageTimeout>0&&setTimeout(function(){return Ht("Timed out ("+De._options.imageTimeout+"ms) loading image")},De._options.imageTimeout)})];case 3:return[2,gt.sent()]}})})},N.prototype.has=function(O){return typeof this._cache[O]<"u"},N.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},N.prototype.proxy=function(O){var X=this,W=this._options.proxy;if(!W)throw new Error("No proxy defined");var ce=O.substring(0,256);return new Promise(function(Be,De){var gt=Pa.SUPPORT_RESPONSE_TYPE?"blob":"text",pt=new XMLHttpRequest;pt.onload=function(){if(pt.status===200)if(gt==="text")Be(pt.response);else{var pi=new FileReader;pi.addEventListener("load",function(){return Be(pi.result)},!1),pi.addEventListener("error",function(Ui){return De(Ui)},!1),pi.readAsDataURL(pt.response)}else De("Failed to proxy resource "+ce+" with status code "+pt.status)},pt.onerror=De;var Ht=W.indexOf("?")>-1?"&":"?";if(pt.open("GET",""+W+Ht+"url="+encodeURIComponent(O)+"&responseType="+gt),gt!=="text"&&pt instanceof XMLHttpRequest&&(pt.responseType=gt),X._options.imageTimeout){var si=X._options.imageTimeout;pt.timeout=si,pt.ontimeout=function(){return De("Timed out ("+si+"ms) proxying "+ce)}}pt.send()})},N}(),p=/^data:image\/svg\+xml/i,n=/^data:image\/.*;base64,/i,u=/^data:image\/.*/i,g=function(N){return Pa.SUPPORT_SVG_DRAWING||!L(N)},x=function(N){return u.test(N)},w=function(N){return n.test(N)},S=function(N){return N.substr(0,4)==="blob"},L=function(N){return N.substr(-3).toLowerCase()==="svg"||p.test(N)},P=function(){function N(O,X){this.type=0,this.x=O,this.y=X}return N.prototype.add=function(O,X){return new N(this.x+O,this.y+X)},N}(),V=function(N,O,X){return new P(N.x+(O.x-N.x)*X,N.y+(O.y-N.y)*X)},Y=function(){function N(O,X,W,ce){this.type=1,this.start=O,this.startControl=X,this.endControl=W,this.end=ce}return N.prototype.subdivide=function(O,X){var W=V(this.start,this.startControl,O),ce=V(this.startControl,this.endControl,O),Be=V(this.endControl,this.end,O),De=V(W,ce,O),gt=V(ce,Be,O),pt=V(De,gt,O);return X?new N(this.start,W,De,pt):new N(pt,gt,Be,this.end)},N.prototype.add=function(O,X){return new N(this.start.add(O,X),this.startControl.add(O,X),this.endControl.add(O,X),this.end.add(O,X))},N.prototype.reverse=function(){return new N(this.end,this.endControl,this.startControl,this.start)},N}(),J=function(N){return N.type===1},Z=function(){function N(O){var X=O.styles,W=O.bounds,ce=Yo(X.borderTopLeftRadius,W.width,W.height),Be=ce[0],De=ce[1],gt=Yo(X.borderTopRightRadius,W.width,W.height),pt=gt[0],Ht=gt[1],si=Yo(X.borderBottomRightRadius,W.width,W.height),pi=si[0],Ui=si[1],Gr=Yo(X.borderBottomLeftRadius,W.width,W.height),vr=Gr[0],Rr=Gr[1],Jn=[];Jn.push((Be+pt)/W.width),Jn.push((vr+pi)/W.width),Jn.push((De+Rr)/W.height),Jn.push((Ht+Ui)/W.height);var An=Math.max.apply(Math,Jn);An>1&&(Be/=An,De/=An,pt/=An,Ht/=An,pi/=An,Ui/=An,vr/=An,Rr/=An);var rn=W.width-pt,Ys=W.height-Ui,ns=W.width-pi,Un=W.height-Rr,Kr=X.borderTopWidth,os=X.borderRightWidth,Bs=X.borderBottomWidth,Mn=X.borderLeftWidth,Mo=is(X.paddingTop,O.bounds.width),fc=is(X.paddingRight,O.bounds.width),Ll=is(X.paddingBottom,O.bounds.width),go=is(X.paddingLeft,O.bounds.width);this.topLeftBorderDoubleOuterBox=Be>0||De>0?de(W.left+Mn/3,W.top+Kr/3,Be-Mn/3,De-Kr/3,te.TOP_LEFT):new P(W.left+Mn/3,W.top+Kr/3),this.topRightBorderDoubleOuterBox=Be>0||De>0?de(W.left+rn,W.top+Kr/3,pt-os/3,Ht-Kr/3,te.TOP_RIGHT):new P(W.left+W.width-os/3,W.top+Kr/3),this.bottomRightBorderDoubleOuterBox=pi>0||Ui>0?de(W.left+ns,W.top+Ys,pi-os/3,Ui-Bs/3,te.BOTTOM_RIGHT):new P(W.left+W.width-os/3,W.top+W.height-Bs/3),this.bottomLeftBorderDoubleOuterBox=vr>0||Rr>0?de(W.left+Mn/3,W.top+Un,vr-Mn/3,Rr-Bs/3,te.BOTTOM_LEFT):new P(W.left+Mn/3,W.top+W.height-Bs/3),this.topLeftBorderDoubleInnerBox=Be>0||De>0?de(W.left+Mn*2/3,W.top+Kr*2/3,Be-Mn*2/3,De-Kr*2/3,te.TOP_LEFT):new P(W.left+Mn*2/3,W.top+Kr*2/3),this.topRightBorderDoubleInnerBox=Be>0||De>0?de(W.left+rn,W.top+Kr*2/3,pt-os*2/3,Ht-Kr*2/3,te.TOP_RIGHT):new P(W.left+W.width-os*2/3,W.top+Kr*2/3),this.bottomRightBorderDoubleInnerBox=pi>0||Ui>0?de(W.left+ns,W.top+Ys,pi-os*2/3,Ui-Bs*2/3,te.BOTTOM_RIGHT):new P(W.left+W.width-os*2/3,W.top+W.height-Bs*2/3),this.bottomLeftBorderDoubleInnerBox=vr>0||Rr>0?de(W.left+Mn*2/3,W.top+Un,vr-Mn*2/3,Rr-Bs*2/3,te.BOTTOM_LEFT):new P(W.left+Mn*2/3,W.top+W.height-Bs*2/3),this.topLeftBorderStroke=Be>0||De>0?de(W.left+Mn/2,W.top+Kr/2,Be-Mn/2,De-Kr/2,te.TOP_LEFT):new P(W.left+Mn/2,W.top+Kr/2),this.topRightBorderStroke=Be>0||De>0?de(W.left+rn,W.top+Kr/2,pt-os/2,Ht-Kr/2,te.TOP_RIGHT):new P(W.left+W.width-os/2,W.top+Kr/2),this.bottomRightBorderStroke=pi>0||Ui>0?de(W.left+ns,W.top+Ys,pi-os/2,Ui-Bs/2,te.BOTTOM_RIGHT):new P(W.left+W.width-os/2,W.top+W.height-Bs/2),this.bottomLeftBorderStroke=vr>0||Rr>0?de(W.left+Mn/2,W.top+Un,vr-Mn/2,Rr-Bs/2,te.BOTTOM_LEFT):new P(W.left+Mn/2,W.top+W.height-Bs/2),this.topLeftBorderBox=Be>0||De>0?de(W.left,W.top,Be,De,te.TOP_LEFT):new P(W.left,W.top),this.topRightBorderBox=pt>0||Ht>0?de(W.left+rn,W.top,pt,Ht,te.TOP_RIGHT):new P(W.left+W.width,W.top),this.bottomRightBorderBox=pi>0||Ui>0?de(W.left+ns,W.top+Ys,pi,Ui,te.BOTTOM_RIGHT):new P(W.left+W.width,W.top+W.height),this.bottomLeftBorderBox=vr>0||Rr>0?de(W.left,W.top+Un,vr,Rr,te.BOTTOM_LEFT):new P(W.left,W.top+W.height),this.topLeftPaddingBox=Be>0||De>0?de(W.left+Mn,W.top+Kr,Math.max(0,Be-Mn),Math.max(0,De-Kr),te.TOP_LEFT):new P(W.left+Mn,W.top+Kr),this.topRightPaddingBox=pt>0||Ht>0?de(W.left+Math.min(rn,W.width-os),W.top+Kr,rn>W.width+os?0:Math.max(0,pt-os),Math.max(0,Ht-Kr),te.TOP_RIGHT):new P(W.left+W.width-os,W.top+Kr),this.bottomRightPaddingBox=pi>0||Ui>0?de(W.left+Math.min(ns,W.width-Mn),W.top+Math.min(Ys,W.height-Bs),Math.max(0,pi-os),Math.max(0,Ui-Bs),te.BOTTOM_RIGHT):new P(W.left+W.width-os,W.top+W.height-Bs),this.bottomLeftPaddingBox=vr>0||Rr>0?de(W.left+Mn,W.top+Math.min(Un,W.height-Bs),Math.max(0,vr-Mn),Math.max(0,Rr-Bs),te.BOTTOM_LEFT):new P(W.left+Mn,W.top+W.height-Bs),this.topLeftContentBox=Be>0||De>0?de(W.left+Mn+go,W.top+Kr+Mo,Math.max(0,Be-(Mn+go)),Math.max(0,De-(Kr+Mo)),te.TOP_LEFT):new P(W.left+Mn+go,W.top+Kr+Mo),this.topRightContentBox=pt>0||Ht>0?de(W.left+Math.min(rn,W.width+Mn+go),W.top+Kr+Mo,rn>W.width+Mn+go?0:pt-Mn+go,Ht-(Kr+Mo),te.TOP_RIGHT):new P(W.left+W.width-(os+fc),W.top+Kr+Mo),this.bottomRightContentBox=pi>0||Ui>0?de(W.left+Math.min(ns,W.width-(Mn+go)),W.top+Math.min(Ys,W.height+Kr+Mo),Math.max(0,pi-(os+fc)),Ui-(Bs+Ll),te.BOTTOM_RIGHT):new P(W.left+W.width-(os+fc),W.top+W.height-(Bs+Ll)),this.bottomLeftContentBox=vr>0||Rr>0?de(W.left+Mn+go,W.top+Un,Math.max(0,vr-(Mn+go)),Rr-(Bs+Ll),te.BOTTOM_LEFT):new P(W.left+Mn+go,W.top+W.height-(Bs+Ll))}return N}(),te;(function(N){N[N.TOP_LEFT=0]="TOP_LEFT",N[N.TOP_RIGHT=1]="TOP_RIGHT",N[N.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",N[N.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(te||(te={}));var de=function(N,O,X,W,ce){var Be=4*((Math.sqrt(2)-1)/3),De=X*Be,gt=W*Be,pt=N+X,Ht=O+W;switch(ce){case te.TOP_LEFT:return new Y(new P(N,Ht),new P(N,Ht-gt),new P(pt-De,O),new P(pt,O));case te.TOP_RIGHT:return new Y(new P(N,O),new P(N+De,O),new P(pt,Ht-gt),new P(pt,Ht));case te.BOTTOM_RIGHT:return new Y(new P(pt,O),new P(pt,O+gt),new P(N+De,Ht),new P(N,Ht));case te.BOTTOM_LEFT:default:return new Y(new P(pt,Ht),new P(pt-De,Ht),new P(N,O+gt),new P(N,O))}},he=function(N){return[N.topLeftBorderBox,N.topRightBorderBox,N.bottomRightBorderBox,N.bottomLeftBorderBox]},ge=function(N){return[N.topLeftContentBox,N.topRightContentBox,N.bottomRightContentBox,N.bottomLeftContentBox]},_e=function(N){return[N.topLeftPaddingBox,N.topRightPaddingBox,N.bottomRightPaddingBox,N.bottomLeftPaddingBox]},Te=function(){function N(O,X,W){this.offsetX=O,this.offsetY=X,this.matrix=W,this.type=0,this.target=6}return N}(),je=function(){function N(O,X){this.path=O,this.target=X,this.type=1}return N}(),We=function(){function N(O){this.opacity=O,this.type=2,this.target=6}return N}(),ut=function(N){return N.type===0},at=function(N){return N.type===1},nt=function(N){return N.type===2},qe=function(N,O){return N.length===O.length?N.some(function(X,W){return X===O[W]}):!1},ht=function(N,O,X,W,ce){return N.map(function(Be,De){switch(De){case 0:return Be.add(O,X);case 1:return Be.add(O+W,X);case 2:return Be.add(O+W,X+ce);case 3:return Be.add(O,X+ce)}return Be})},ft=function(){function N(O){this.element=O,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return N}(),Rt=function(){function N(O,X){if(this.container=O,this.parent=X,this.effects=[],this.curves=new Z(this.container),this.container.styles.opacity<1&&this.effects.push(new We(this.container.styles.opacity)),this.container.styles.transform!==null){var W=this.container.bounds.left+this.container.styles.transformOrigin[0].number,ce=this.container.bounds.top+this.container.styles.transformOrigin[1].number,Be=this.container.styles.transform;this.effects.push(new Te(W,ce,Be))}if(this.container.styles.overflowX!==0){var De=he(this.curves),gt=_e(this.curves);qe(De,gt)?this.effects.push(new je(De,6)):(this.effects.push(new je(De,2)),this.effects.push(new je(gt,4)))}}return N.prototype.getEffects=function(O){for(var X=[2,3].indexOf(this.container.styles.position)===-1,W=this.parent,ce=this.effects.slice(0);W;){var Be=W.effects.filter(function(pt){return!at(pt)});if(X||W.container.styles.position!==0||!W.parent){if(ce.unshift.apply(ce,Be),X=[2,3].indexOf(W.container.styles.position)===-1,W.container.styles.overflowX!==0){var De=he(W.curves),gt=_e(W.curves);qe(De,gt)||ce.unshift(new je(gt,6))}}else ce.unshift.apply(ce,Be);W=W.parent}return ce.filter(function(pt){return Hi(pt.target,O)})},N}(),Ot=function(N,O,X,W){N.container.elements.forEach(function(ce){var Be=Hi(ce.flags,4),De=Hi(ce.flags,2),gt=new Rt(ce,N);Hi(ce.styles.display,2048)&&W.push(gt);var pt=Hi(ce.flags,8)?[]:W;if(Be||De){var Ht=Be||ce.styles.isPositioned()?X:O,si=new ft(gt);if(ce.styles.isPositioned()||ce.styles.opacity<1||ce.styles.isTransformed()){var pi=ce.styles.zIndex.order;if(pi<0){var Ui=0;Ht.negativeZIndex.some(function(vr,Rr){return pi>vr.element.container.styles.zIndex.order?(Ui=Rr,!1):Ui>0}),Ht.negativeZIndex.splice(Ui,0,si)}else if(pi>0){var Gr=0;Ht.positiveZIndex.some(function(vr,Rr){return pi>=vr.element.container.styles.zIndex.order?(Gr=Rr+1,!1):Gr>0}),Ht.positiveZIndex.splice(Gr,0,si)}else Ht.zeroOrAutoZIndexOrTransformedOrOpacity.push(si)}else ce.styles.isFloating()?Ht.nonPositionedFloats.push(si):Ht.nonPositionedInlineLevel.push(si);Ot(gt,si,Be?si:X,pt)}else ce.styles.isInlineLevel()?O.inlineLevel.push(gt):O.nonInlineLevel.push(gt),Ot(gt,O,X,pt);Hi(ce.flags,8)&&ti(ce,pt)})},ti=function(N,O){for(var X=N instanceof Bd?N.start:1,W=N instanceof Bd?N.reversed:!1,ce=0;ce<O.length;ce++){var Be=O[ce];Be.container instanceof $u&&typeof Be.container.value=="number"&&Be.container.value!==0&&(X=Be.container.value),Be.listValue=Md(X,Be.container.styles.listStyleType,!0),X+=W?-1:1}},ri=function(N){var O=new Rt(N,null),X=new ft(O),W=[];return Ot(O,X,X,W),ti(O.container,W),X},vi=function(N,O){switch(O){case 0:return zt(N.topLeftBorderBox,N.topLeftPaddingBox,N.topRightBorderBox,N.topRightPaddingBox);case 1:return zt(N.topRightBorderBox,N.topRightPaddingBox,N.bottomRightBorderBox,N.bottomRightPaddingBox);case 2:return zt(N.bottomRightBorderBox,N.bottomRightPaddingBox,N.bottomLeftBorderBox,N.bottomLeftPaddingBox);case 3:default:return zt(N.bottomLeftBorderBox,N.bottomLeftPaddingBox,N.topLeftBorderBox,N.topLeftPaddingBox)}},Pt=function(N,O){switch(O){case 0:return zt(N.topLeftBorderBox,N.topLeftBorderDoubleOuterBox,N.topRightBorderBox,N.topRightBorderDoubleOuterBox);case 1:return zt(N.topRightBorderBox,N.topRightBorderDoubleOuterBox,N.bottomRightBorderBox,N.bottomRightBorderDoubleOuterBox);case 2:return zt(N.bottomRightBorderBox,N.bottomRightBorderDoubleOuterBox,N.bottomLeftBorderBox,N.bottomLeftBorderDoubleOuterBox);case 3:default:return zt(N.bottomLeftBorderBox,N.bottomLeftBorderDoubleOuterBox,N.topLeftBorderBox,N.topLeftBorderDoubleOuterBox)}},Qt=function(N,O){switch(O){case 0:return zt(N.topLeftBorderDoubleInnerBox,N.topLeftPaddingBox,N.topRightBorderDoubleInnerBox,N.topRightPaddingBox);case 1:return zt(N.topRightBorderDoubleInnerBox,N.topRightPaddingBox,N.bottomRightBorderDoubleInnerBox,N.bottomRightPaddingBox);case 2:return zt(N.bottomRightBorderDoubleInnerBox,N.bottomRightPaddingBox,N.bottomLeftBorderDoubleInnerBox,N.bottomLeftPaddingBox);case 3:default:return zt(N.bottomLeftBorderDoubleInnerBox,N.bottomLeftPaddingBox,N.topLeftBorderDoubleInnerBox,N.topLeftPaddingBox)}},Ct=function(N,O){switch(O){case 0:return oi(N.topLeftBorderStroke,N.topRightBorderStroke);case 1:return oi(N.topRightBorderStroke,N.bottomRightBorderStroke);case 2:return oi(N.bottomRightBorderStroke,N.bottomLeftBorderStroke);case 3:default:return oi(N.bottomLeftBorderStroke,N.topLeftBorderStroke)}},oi=function(N,O){var X=[];return J(N)?X.push(N.subdivide(.5,!1)):X.push(N),J(O)?X.push(O.subdivide(.5,!0)):X.push(O),X},zt=function(N,O,X,W){var ce=[];return J(N)?ce.push(N.subdivide(.5,!1)):ce.push(N),J(X)?ce.push(X.subdivide(.5,!0)):ce.push(X),J(W)?ce.push(W.subdivide(.5,!0).reverse()):ce.push(W),J(O)?ce.push(O.subdivide(.5,!1).reverse()):ce.push(O),ce},gi=function(N){var O=N.bounds,X=N.styles;return O.add(X.borderLeftWidth,X.borderTopWidth,-(X.borderRightWidth+X.borderLeftWidth),-(X.borderTopWidth+X.borderBottomWidth))},Li=function(N){var O=N.styles,X=N.bounds,W=is(O.paddingLeft,X.width),ce=is(O.paddingRight,X.width),Be=is(O.paddingTop,X.width),De=is(O.paddingBottom,X.width);return X.add(W+O.borderLeftWidth,Be+O.borderTopWidth,-(O.borderRightWidth+O.borderLeftWidth+W+ce),-(O.borderTopWidth+O.borderBottomWidth+Be+De))},ai=function(N,O){return N===0?O.bounds:N===2?Li(O):gi(O)},Mi=function(N,O){return N===0?O.bounds:N===2?Li(O):gi(O)},ir=function(N,O,X){var W=ai(gr(N.styles.backgroundOrigin,O),N),ce=Mi(gr(N.styles.backgroundClip,O),N),Be=pr(gr(N.styles.backgroundSize,O),X,W),De=Be[0],gt=Be[1],pt=Yo(gr(N.styles.backgroundPosition,O),W.width-De,W.height-gt),Ht=Cr(gr(N.styles.backgroundRepeat,O),pt,Be,W,ce),si=Math.round(W.left+pt[0]),pi=Math.round(W.top+pt[1]);return[Ht,si,pi,De,gt]},tr=function(N){return bn(N)&&N.value===mh.AUTO},Ki=function(N){return typeof N=="number"},pr=function(N,O,X){var W=O[0],ce=O[1],Be=O[2],De=N[0],gt=N[1];if(!De)return[0,0];if(lo(De)&&gt&&lo(gt))return[is(De,X.width),is(gt,X.height)];var pt=Ki(Be);if(bn(De)&&(De.value===mh.CONTAIN||De.value===mh.COVER)){if(Ki(Be)){var Ht=X.width/X.height;return Ht<Be!=(De.value===mh.COVER)?[X.width,X.width/Be]:[X.height*Be,X.height]}return[X.width,X.height]}var si=Ki(W),pi=Ki(ce),Ui=si||pi;if(tr(De)&&(!gt||tr(gt))){if(si&&pi)return[W,ce];if(!pt&&!Ui)return[X.width,X.height];if(Ui&&pt){var Gr=si?W:ce*Be,vr=pi?ce:W/Be;return[Gr,vr]}var Rr=si?W:X.width,Jn=pi?ce:X.height;return[Rr,Jn]}if(pt){var An=0,rn=0;return lo(De)?An=is(De,X.width):lo(gt)&&(rn=is(gt,X.height)),tr(De)?An=rn*Be:(!gt||tr(gt))&&(rn=An/Be),[An,rn]}var Ys=null,ns=null;if(lo(De)?Ys=is(De,X.width):gt&&lo(gt)&&(ns=is(gt,X.height)),Ys!==null&&(!gt||tr(gt))&&(ns=si&&pi?Ys/W*ce:X.height),ns!==null&&tr(De)&&(Ys=si&&pi?ns/ce*W:X.width),Ys!==null&&ns!==null)return[Ys,ns];throw new Error("Unable to calculate background-size for element")},gr=function(N,O){var X=N[O];return typeof X>"u"?N[0]:X},Cr=function(N,O,X,W,ce){var Be=O[0],De=O[1],gt=X[0],pt=X[1];switch(N){case 2:return[new P(Math.round(W.left),Math.round(W.top+De)),new P(Math.round(W.left+W.width),Math.round(W.top+De)),new P(Math.round(W.left+W.width),Math.round(pt+W.top+De)),new P(Math.round(W.left),Math.round(pt+W.top+De))];case 3:return[new P(Math.round(W.left+Be),Math.round(W.top)),new P(Math.round(W.left+Be+gt),Math.round(W.top)),new P(Math.round(W.left+Be+gt),Math.round(W.height+W.top)),new P(Math.round(W.left+Be),Math.round(W.height+W.top))];case 1:return[new P(Math.round(W.left+Be),Math.round(W.top+De)),new P(Math.round(W.left+Be+gt),Math.round(W.top+De)),new P(Math.round(W.left+Be+gt),Math.round(W.top+De+pt)),new P(Math.round(W.left+Be),Math.round(W.top+De+pt))];default:return[new P(Math.round(ce.left),Math.round(ce.top)),new P(Math.round(ce.left+ce.width),Math.round(ce.top)),new P(Math.round(ce.left+ce.width),Math.round(ce.height+ce.top)),new P(Math.round(ce.left),Math.round(ce.height+ce.top))]}},Hr="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",sn="Hidden Text",Zn=function(){function N(O){this._data={},this._document=O}return N.prototype.parseMetrics=function(O,X){var W=this._document.createElement("div"),ce=this._document.createElement("img"),Be=this._document.createElement("span"),De=this._document.body;W.style.visibility="hidden",W.style.fontFamily=O,W.style.fontSize=X,W.style.margin="0",W.style.padding="0",W.style.whiteSpace="nowrap",De.appendChild(W),ce.src=Hr,ce.width=1,ce.height=1,ce.style.margin="0",ce.style.padding="0",ce.style.verticalAlign="baseline",Be.style.fontFamily=O,Be.style.fontSize=X,Be.style.margin="0",Be.style.padding="0",Be.appendChild(this._document.createTextNode(sn)),W.appendChild(Be),W.appendChild(ce);var gt=ce.offsetTop-Be.offsetTop+2;W.removeChild(Be),W.appendChild(this._document.createTextNode(sn)),W.style.lineHeight="normal",ce.style.verticalAlign="super";var pt=ce.offsetTop-W.offsetTop+2;return De.removeChild(W),{baseline:gt,middle:pt}},N.prototype.getMetrics=function(O,X){var W=O+" "+X;return typeof this._data[W]>"u"&&(this._data[W]=this.parseMetrics(O,X)),this._data[W]},N}(),ws=function(){function N(O,X){this.context=O,this.options=X}return N}(),rs=1e4,ss=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce._activeEffects=[],ce.canvas=W.canvas?W.canvas:document.createElement("canvas"),ce.ctx=ce.canvas.getContext("2d"),W.canvas||(ce.canvas.width=Math.floor(W.width*W.scale),ce.canvas.height=Math.floor(W.height*W.scale),ce.canvas.style.width=W.width+"px",ce.canvas.style.height=W.height+"px"),ce.fontMetrics=new Zn(document),ce.ctx.scale(ce.options.scale,ce.options.scale),ce.ctx.translate(-W.x,-W.y),ce.ctx.textBaseline="bottom",ce._activeEffects=[],ce.context.logger.debug("Canvas renderer initialized ("+W.width+"x"+W.height+") with scale "+W.scale),ce}return O.prototype.applyEffects=function(X){for(var W=this;this._activeEffects.length;)this.popEffect();X.forEach(function(ce){return W.applyEffect(ce)})},O.prototype.applyEffect=function(X){this.ctx.save(),nt(X)&&(this.ctx.globalAlpha=X.opacity),ut(X)&&(this.ctx.translate(X.offsetX,X.offsetY),this.ctx.transform(X.matrix[0],X.matrix[1],X.matrix[2],X.matrix[3],X.matrix[4],X.matrix[5]),this.ctx.translate(-X.offsetX,-X.offsetY)),at(X)&&(this.path(X.path),this.ctx.clip()),this._activeEffects.push(X)},O.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},O.prototype.renderStack=function(X){return h(this,void 0,void 0,function(){var W;return A(this,function(ce){switch(ce.label){case 0:return W=X.element.container.styles,W.isVisible()?[4,this.renderStackContent(X)]:[3,2];case 1:ce.sent(),ce.label=2;case 2:return[2]}})})},O.prototype.renderNode=function(X){return h(this,void 0,void 0,function(){return A(this,function(W){switch(W.label){case 0:if(Hi(X.container.flags,16))debugger;return X.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(X)]:[3,3];case 1:return W.sent(),[4,this.renderNodeContent(X)];case 2:W.sent(),W.label=3;case 3:return[2]}})})},O.prototype.renderTextWithLetterSpacing=function(X,W,ce){var Be=this;if(W===0)this.ctx.fillText(X.text,X.bounds.left,X.bounds.top+ce);else{var De=dc(X.text);De.reduce(function(gt,pt){return Be.ctx.fillText(pt,gt,X.bounds.top+ce),gt+Be.ctx.measureText(pt).width},X.bounds.left)}},O.prototype.createFontStyle=function(X){var W=X.fontVariant.filter(function(De){return De==="normal"||De==="small-caps"}).join(""),ce=Rs(X.fontFamily).join(", "),Be=Zs(X.fontSize)?""+X.fontSize.number+X.fontSize.unit:X.fontSize.number+"px";return[[X.fontStyle,W,X.fontWeight,Be,ce].join(" "),ce,Be]},O.prototype.renderTextNode=function(X,W){return h(this,void 0,void 0,function(){var ce,Be,De,gt,pt,Ht,si,pi,Ui=this;return A(this,function(Gr){return ce=this.createFontStyle(W),Be=ce[0],De=ce[1],gt=ce[2],this.ctx.font=Be,this.ctx.direction=W.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",pt=this.fontMetrics.getMetrics(De,gt),Ht=pt.baseline,si=pt.middle,pi=W.paintOrder,X.textBounds.forEach(function(vr){pi.forEach(function(Rr){switch(Rr){case 0:Ui.ctx.fillStyle=xo(W.color),Ui.renderTextWithLetterSpacing(vr,W.letterSpacing,Ht);var Jn=W.textShadow;Jn.length&&vr.text.trim().length&&(Jn.slice(0).reverse().forEach(function(An){Ui.ctx.shadowColor=xo(An.color),Ui.ctx.shadowOffsetX=An.offsetX.number*Ui.options.scale,Ui.ctx.shadowOffsetY=An.offsetY.number*Ui.options.scale,Ui.ctx.shadowBlur=An.blur.number,Ui.renderTextWithLetterSpacing(vr,W.letterSpacing,Ht)}),Ui.ctx.shadowColor="",Ui.ctx.shadowOffsetX=0,Ui.ctx.shadowOffsetY=0,Ui.ctx.shadowBlur=0),W.textDecorationLine.length&&(Ui.ctx.fillStyle=xo(W.textDecorationColor||W.color),W.textDecorationLine.forEach(function(An){switch(An){case 1:Ui.ctx.fillRect(vr.bounds.left,Math.round(vr.bounds.top+Ht),vr.bounds.width,1);break;case 2:Ui.ctx.fillRect(vr.bounds.left,Math.round(vr.bounds.top),vr.bounds.width,1);break;case 3:Ui.ctx.fillRect(vr.bounds.left,Math.ceil(vr.bounds.top+si),vr.bounds.width,1);break}}));break;case 1:W.webkitTextStrokeWidth&&vr.text.trim().length&&(Ui.ctx.strokeStyle=xo(W.webkitTextStrokeColor),Ui.ctx.lineWidth=W.webkitTextStrokeWidth,Ui.ctx.lineJoin=window.chrome?"miter":"round",Ui.ctx.strokeText(vr.text,vr.bounds.left,vr.bounds.top+Ht)),Ui.ctx.strokeStyle="",Ui.ctx.lineWidth=0,Ui.ctx.lineJoin="miter";break}})}),[2]})})},O.prototype.renderReplacedElement=function(X,W,ce){if(ce&&X.intrinsicWidth>0&&X.intrinsicHeight>0){var Be=Li(X),De=_e(W);this.path(De),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(ce,0,0,X.intrinsicWidth,X.intrinsicHeight,Be.left,Be.top,Be.width,Be.height),this.ctx.restore()}},O.prototype.renderNodeContent=function(X){return h(this,void 0,void 0,function(){var W,ce,Be,De,gt,pt,rn,rn,Ht,si,pi,Ui,ns,Gr,vr,Un,Rr,Jn,An,rn,Ys,ns,Un;return A(this,function(Kr){switch(Kr.label){case 0:this.applyEffects(X.getEffects(4)),W=X.container,ce=X.curves,Be=W.styles,De=0,gt=W.textNodes,Kr.label=1;case 1:return De<gt.length?(pt=gt[De],[4,this.renderTextNode(pt,Be)]):[3,4];case 2:Kr.sent(),Kr.label=3;case 3:return De++,[3,1];case 4:if(!(W instanceof ks))return[3,8];Kr.label=5;case 5:return Kr.trys.push([5,7,,8]),[4,this.context.cache.match(W.src)];case 6:return rn=Kr.sent(),this.renderReplacedElement(W,ce,rn),[3,8];case 7:return Kr.sent(),this.context.logger.error("Error loading image "+W.src),[3,8];case 8:if(W instanceof On&&this.renderReplacedElement(W,ce,W.canvas),!(W instanceof Vf))return[3,12];Kr.label=9;case 9:return Kr.trys.push([9,11,,12]),[4,this.context.cache.match(W.svg)];case 10:return rn=Kr.sent(),this.renderReplacedElement(W,ce,rn),[3,12];case 11:return Kr.sent(),this.context.logger.error("Error loading svg "+W.svg.substring(0,255)),[3,12];case 12:return W instanceof Ed&&W.tree?(Ht=new O(this.context,{scale:this.options.scale,backgroundColor:W.backgroundColor,x:0,y:0,width:W.width,height:W.height}),[4,Ht.render(W.tree)]):[3,14];case 13:si=Kr.sent(),W.width&&W.height&&this.ctx.drawImage(si,0,0,W.width,W.height,W.bounds.left,W.bounds.top,W.bounds.width,W.bounds.height),Kr.label=14;case 14:if(W instanceof Cd&&(pi=Math.min(W.bounds.width,W.bounds.height),W.type===Th?W.checked&&(this.ctx.save(),this.path([new P(W.bounds.left+pi*.39363,W.bounds.top+pi*.79),new P(W.bounds.left+pi*.16,W.bounds.top+pi*.5549),new P(W.bounds.left+pi*.27347,W.bounds.top+pi*.44071),new P(W.bounds.left+pi*.39694,W.bounds.top+pi*.5649),new P(W.bounds.left+pi*.72983,W.bounds.top+pi*.23),new P(W.bounds.left+pi*.84,W.bounds.top+pi*.34085),new P(W.bounds.left+pi*.39363,W.bounds.top+pi*.79)]),this.ctx.fillStyle=xo(Fh),this.ctx.fill(),this.ctx.restore()):W.type===BA&&W.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(W.bounds.left+pi/2,W.bounds.top+pi/2,pi/4,0,Math.PI*2,!0),this.ctx.fillStyle=xo(Fh),this.ctx.fill(),this.ctx.restore())),ho(W)&&W.value.length){switch(Ui=this.createFontStyle(Be),ns=Ui[0],Gr=Ui[1],vr=this.fontMetrics.getMetrics(ns,Gr).baseline,this.ctx.font=ns,this.ctx.fillStyle=xo(Be.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ln(W.styles.textAlign),Un=Li(W),Rr=0,W.styles.textAlign){case 1:Rr+=Un.width/2;break;case 2:Rr+=Un.width;break}Jn=Un.add(Rr,0,0,-Un.height/2+1),this.ctx.save(),this.path([new P(Un.left,Un.top),new P(Un.left+Un.width,Un.top),new P(Un.left+Un.width,Un.top+Un.height),new P(Un.left,Un.top+Un.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Kh(W.value,Jn),Be.letterSpacing,vr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Hi(W.styles.display,2048))return[3,20];if(W.styles.listStyleImage===null)return[3,19];if(An=W.styles.listStyleImage,An.type!==0)return[3,18];rn=void 0,Ys=An.url,Kr.label=15;case 15:return Kr.trys.push([15,17,,18]),[4,this.context.cache.match(Ys)];case 16:return rn=Kr.sent(),this.ctx.drawImage(rn,W.bounds.left-(rn.width+10),W.bounds.top),[3,18];case 17:return Kr.sent(),this.context.logger.error("Error loading list-style-image "+Ys),[3,18];case 18:return[3,20];case 19:X.listValue&&W.styles.listStyleType!==-1&&(ns=this.createFontStyle(Be)[0],this.ctx.font=ns,this.ctx.fillStyle=xo(Be.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Un=new y(W.bounds.left,W.bounds.top+is(W.styles.paddingTop,W.bounds.width),W.bounds.width,Yc(Be.lineHeight,Be.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Kh(X.listValue,Un),Be.letterSpacing,Yc(Be.lineHeight,Be.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Kr.label=20;case 20:return[2]}})})},O.prototype.renderStackContent=function(X){return h(this,void 0,void 0,function(){var W,ce,An,Be,De,An,gt,pt,An,Ht,si,An,pi,Ui,An,Gr,vr,An,Rr,Jn,An;return A(this,function(rn){switch(rn.label){case 0:if(Hi(X.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(X.element)];case 1:rn.sent(),W=0,ce=X.negativeZIndex,rn.label=2;case 2:return W<ce.length?(An=ce[W],[4,this.renderStack(An)]):[3,5];case 3:rn.sent(),rn.label=4;case 4:return W++,[3,2];case 5:return[4,this.renderNodeContent(X.element)];case 6:rn.sent(),Be=0,De=X.nonInlineLevel,rn.label=7;case 7:return Be<De.length?(An=De[Be],[4,this.renderNode(An)]):[3,10];case 8:rn.sent(),rn.label=9;case 9:return Be++,[3,7];case 10:gt=0,pt=X.nonPositionedFloats,rn.label=11;case 11:return gt<pt.length?(An=pt[gt],[4,this.renderStack(An)]):[3,14];case 12:rn.sent(),rn.label=13;case 13:return gt++,[3,11];case 14:Ht=0,si=X.nonPositionedInlineLevel,rn.label=15;case 15:return Ht<si.length?(An=si[Ht],[4,this.renderStack(An)]):[3,18];case 16:rn.sent(),rn.label=17;case 17:return Ht++,[3,15];case 18:pi=0,Ui=X.inlineLevel,rn.label=19;case 19:return pi<Ui.length?(An=Ui[pi],[4,this.renderNode(An)]):[3,22];case 20:rn.sent(),rn.label=21;case 21:return pi++,[3,19];case 22:Gr=0,vr=X.zeroOrAutoZIndexOrTransformedOrOpacity,rn.label=23;case 23:return Gr<vr.length?(An=vr[Gr],[4,this.renderStack(An)]):[3,26];case 24:rn.sent(),rn.label=25;case 25:return Gr++,[3,23];case 26:Rr=0,Jn=X.positiveZIndex,rn.label=27;case 27:return Rr<Jn.length?(An=Jn[Rr],[4,this.renderStack(An)]):[3,30];case 28:rn.sent(),rn.label=29;case 29:return Rr++,[3,27];case 30:return[2]}})})},O.prototype.mask=function(X){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(X.slice(0).reverse()),this.ctx.closePath()},O.prototype.path=function(X){this.ctx.beginPath(),this.formatPath(X),this.ctx.closePath()},O.prototype.formatPath=function(X){var W=this;X.forEach(function(ce,Be){var De=J(ce)?ce.start:ce;Be===0?W.ctx.moveTo(De.x,De.y):W.ctx.lineTo(De.x,De.y),J(ce)&&W.ctx.bezierCurveTo(ce.startControl.x,ce.startControl.y,ce.endControl.x,ce.endControl.y,ce.end.x,ce.end.y)})},O.prototype.renderRepeat=function(X,W,ce,Be){this.path(X),this.ctx.fillStyle=W,this.ctx.translate(ce,Be),this.ctx.fill(),this.ctx.translate(-ce,-Be)},O.prototype.resizeImage=function(X,W,ce){var Be;if(X.width===W&&X.height===ce)return X;var De=(Be=this.canvas.ownerDocument)!==null&&Be!==void 0?Be:document,gt=De.createElement("canvas");gt.width=Math.max(1,W),gt.height=Math.max(1,ce);var pt=gt.getContext("2d");return pt.drawImage(X,0,0,X.width,X.height,0,0,W,ce),gt},O.prototype.renderBackgroundImage=function(X){return h(this,void 0,void 0,function(){var W,ce,Be,De,gt,pt;return A(this,function(Ht){switch(Ht.label){case 0:W=X.styles.backgroundImage.length-1,ce=function(si){var pi,Ui,Gr,Mo,kc,Rc,go,Ml,Bs,vr,Mo,kc,Rc,go,Ml,Rr,Jn,An,rn,Ys,ns,Un,Kr,os,Bs,Mn,Mo,fc,Ll,go,Ml,Rd,kc,Rc,PA,pc,Dd,ma,ih,Od,gf,rh;return A(this,function(ip){switch(ip.label){case 0:if(si.type!==0)return[3,5];pi=void 0,Ui=si.url,ip.label=1;case 1:return ip.trys.push([1,3,,4]),[4,Be.context.cache.match(Ui)];case 2:return pi=ip.sent(),[3,4];case 3:return ip.sent(),Be.context.logger.error("Error loading background-image "+Ui),[3,4];case 4:return pi&&(Gr=ir(X,W,[pi.width,pi.height,pi.width/pi.height]),Mo=Gr[0],kc=Gr[1],Rc=Gr[2],go=Gr[3],Ml=Gr[4],Bs=Be.ctx.createPattern(Be.resizeImage(pi,go,Ml),"repeat"),Be.renderRepeat(Mo,Bs,kc,Rc)),[3,6];case 5:Gl(si)?(vr=ir(X,W,[null,null,null]),Mo=vr[0],kc=vr[1],Rc=vr[2],go=vr[3],Ml=vr[4],Rr=xu(si.angle,go,Ml),Jn=Rr[0],An=Rr[1],rn=Rr[2],Ys=Rr[3],ns=Rr[4],Un=document.createElement("canvas"),Un.width=go,Un.height=Ml,Kr=Un.getContext("2d"),os=Kr.createLinearGradient(An,Ys,rn,ns),La(si.stops,Jn).forEach(function(rp){return os.addColorStop(rp.stop,xo(rp.color))}),Kr.fillStyle=os,Kr.fillRect(0,0,go,Ml),go>0&&Ml>0&&(Bs=Be.ctx.createPattern(Un,"repeat"),Be.renderRepeat(Mo,Bs,kc,Rc))):Bu(si)&&(Mn=ir(X,W,[null,null,null]),Mo=Mn[0],fc=Mn[1],Ll=Mn[2],go=Mn[3],Ml=Mn[4],Rd=si.position.length===0?[oc]:si.position,kc=is(Rd[0],go),Rc=is(Rd[Rd.length-1],Ml),PA=Ho(si,kc,Rc,go,Ml),pc=PA[0],Dd=PA[1],pc>0&&Dd>0&&(ma=Be.ctx.createRadialGradient(fc+kc,Ll+Rc,0,fc+kc,Ll+Rc,pc),La(si.stops,pc*2).forEach(function(rp){return ma.addColorStop(rp.stop,xo(rp.color))}),Be.path(Mo),Be.ctx.fillStyle=ma,pc!==Dd?(ih=X.bounds.left+.5*X.bounds.width,Od=X.bounds.top+.5*X.bounds.height,gf=Dd/pc,rh=1/gf,Be.ctx.save(),Be.ctx.translate(ih,Od),Be.ctx.transform(1,0,0,gf,0,0),Be.ctx.translate(-ih,-Od),Be.ctx.fillRect(fc,rh*(Ll-Od)+Od,go,Ml*rh),Be.ctx.restore()):Be.ctx.fill())),ip.label=6;case 6:return W--,[2]}})},Be=this,De=0,gt=X.styles.backgroundImage.slice(0).reverse(),Ht.label=1;case 1:return De<gt.length?(pt=gt[De],[5,ce(pt)]):[3,4];case 2:Ht.sent(),Ht.label=3;case 3:return De++,[3,1];case 4:return[2]}})})},O.prototype.renderSolidBorder=function(X,W,ce){return h(this,void 0,void 0,function(){return A(this,function(Be){return this.path(vi(ce,W)),this.ctx.fillStyle=xo(X),this.ctx.fill(),[2]})})},O.prototype.renderDoubleBorder=function(X,W,ce,Be){return h(this,void 0,void 0,function(){var De,gt;return A(this,function(pt){switch(pt.label){case 0:return W<3?[4,this.renderSolidBorder(X,ce,Be)]:[3,2];case 1:return pt.sent(),[2];case 2:return De=Pt(Be,ce),this.path(De),this.ctx.fillStyle=xo(X),this.ctx.fill(),gt=Qt(Be,ce),this.path(gt),this.ctx.fill(),[2]}})})},O.prototype.renderNodeBackgroundAndBorders=function(X){return h(this,void 0,void 0,function(){var W,ce,Be,De,gt,pt,Ht,si,pi=this;return A(this,function(Ui){switch(Ui.label){case 0:return this.applyEffects(X.getEffects(2)),W=X.container.styles,ce=!Fa(W.backgroundColor)||W.backgroundImage.length,Be=[{style:W.borderTopStyle,color:W.borderTopColor,width:W.borderTopWidth},{style:W.borderRightStyle,color:W.borderRightColor,width:W.borderRightWidth},{style:W.borderBottomStyle,color:W.borderBottomColor,width:W.borderBottomWidth},{style:W.borderLeftStyle,color:W.borderLeftColor,width:W.borderLeftWidth}],De=Jr(gr(W.backgroundClip,0),X.curves),ce||W.boxShadow.length?(this.ctx.save(),this.path(De),this.ctx.clip(),Fa(W.backgroundColor)||(this.ctx.fillStyle=xo(W.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(X.container)]):[3,2];case 1:Ui.sent(),this.ctx.restore(),W.boxShadow.slice(0).reverse().forEach(function(Gr){pi.ctx.save();var vr=he(X.curves),Rr=Gr.inset?0:rs,Jn=ht(vr,-Rr+(Gr.inset?1:-1)*Gr.spread.number,(Gr.inset?1:-1)*Gr.spread.number,Gr.spread.number*(Gr.inset?-2:2),Gr.spread.number*(Gr.inset?-2:2));Gr.inset?(pi.path(vr),pi.ctx.clip(),pi.mask(Jn)):(pi.mask(vr),pi.ctx.clip(),pi.path(Jn)),pi.ctx.shadowOffsetX=Gr.offsetX.number+Rr,pi.ctx.shadowOffsetY=Gr.offsetY.number,pi.ctx.shadowColor=xo(Gr.color),pi.ctx.shadowBlur=Gr.blur.number,pi.ctx.fillStyle=Gr.inset?xo(Gr.color):"rgba(0,0,0,1)",pi.ctx.fill(),pi.ctx.restore()}),Ui.label=2;case 2:gt=0,pt=0,Ht=Be,Ui.label=3;case 3:return pt<Ht.length?(si=Ht[pt],si.style!==0&&!Fa(si.color)&&si.width>0?si.style!==2?[3,5]:[4,this.renderDashedDottedBorder(si.color,si.width,gt,X.curves,2)]:[3,11]):[3,13];case 4:return Ui.sent(),[3,11];case 5:return si.style!==3?[3,7]:[4,this.renderDashedDottedBorder(si.color,si.width,gt,X.curves,3)];case 6:return Ui.sent(),[3,11];case 7:return si.style!==4?[3,9]:[4,this.renderDoubleBorder(si.color,si.width,gt,X.curves)];case 8:return Ui.sent(),[3,11];case 9:return[4,this.renderSolidBorder(si.color,gt,X.curves)];case 10:Ui.sent(),Ui.label=11;case 11:gt++,Ui.label=12;case 12:return pt++,[3,3];case 13:return[2]}})})},O.prototype.renderDashedDottedBorder=function(X,W,ce,Be,De){return h(this,void 0,void 0,function(){var gt,pt,Ht,si,pi,Ui,Gr,vr,Rr,Jn,An,rn,Ys,ns,Un,Kr,Un,Kr;return A(this,function(os){return this.ctx.save(),gt=Ct(Be,ce),pt=vi(Be,ce),De===2&&(this.path(pt),this.ctx.clip()),J(pt[0])?(Ht=pt[0].start.x,si=pt[0].start.y):(Ht=pt[0].x,si=pt[0].y),J(pt[1])?(pi=pt[1].end.x,Ui=pt[1].end.y):(pi=pt[1].x,Ui=pt[1].y),ce===0||ce===2?Gr=Math.abs(Ht-pi):Gr=Math.abs(si-Ui),this.ctx.beginPath(),De===3?this.formatPath(gt):this.formatPath(pt.slice(0,2)),vr=W<3?W*3:W*2,Rr=W<3?W*2:W,De===3&&(vr=W,Rr=W),Jn=!0,Gr<=vr*2?Jn=!1:Gr<=vr*2+Rr?(An=Gr/(2*vr+Rr),vr*=An,Rr*=An):(rn=Math.floor((Gr+Rr)/(vr+Rr)),Ys=(Gr-rn*vr)/(rn-1),ns=(Gr-(rn+1)*vr)/rn,Rr=ns<=0||Math.abs(Rr-Ys)<Math.abs(Rr-ns)?Ys:ns),Jn&&(De===3?this.ctx.setLineDash([0,vr+Rr]):this.ctx.setLineDash([vr,Rr])),De===3?(this.ctx.lineCap="round",this.ctx.lineWidth=W):this.ctx.lineWidth=W*2+1.1,this.ctx.strokeStyle=xo(X),this.ctx.stroke(),this.ctx.setLineDash([]),De===2&&(J(pt[0])&&(Un=pt[3],Kr=pt[0],this.ctx.beginPath(),this.formatPath([new P(Un.end.x,Un.end.y),new P(Kr.start.x,Kr.start.y)]),this.ctx.stroke()),J(pt[1])&&(Un=pt[1],Kr=pt[2],this.ctx.beginPath(),this.formatPath([new P(Un.end.x,Un.end.y),new P(Kr.start.x,Kr.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},O.prototype.render=function(X){return h(this,void 0,void 0,function(){var W;return A(this,function(ce){switch(ce.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=xo(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),W=ri(X),[4,this.renderStack(W)];case 1:return ce.sent(),this.applyEffects([]),[2,this.canvas]}})})},O}(ws),ho=function(N){return N instanceof Sd||N instanceof af?!0:N instanceof Cd&&N.type!==BA&&N.type!==Th},Jr=function(N,O){switch(N){case 0:return he(O);case 2:return ge(O);case 1:default:return _e(O)}},ln=function(N){switch(N){case 1:return"center";case 2:return"right";case 0:default:return"left"}},vn=["-apple-system","system-ui"],Rs=function(N){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?N.filter(function(O){return vn.indexOf(O)===-1}):N},Vo=function(N){s(O,N);function O(X,W){var ce=N.call(this,X,W)||this;return ce.canvas=W.canvas?W.canvas:document.createElement("canvas"),ce.ctx=ce.canvas.getContext("2d"),ce.options=W,ce.canvas.width=Math.floor(W.width*W.scale),ce.canvas.height=Math.floor(W.height*W.scale),ce.canvas.style.width=W.width+"px",ce.canvas.style.height=W.height+"px",ce.ctx.scale(ce.options.scale,ce.options.scale),ce.ctx.translate(-W.x,-W.y),ce.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+W.width+"x"+W.height+" at "+W.x+","+W.y+") with scale "+W.scale),ce}return O.prototype.render=function(X){return h(this,void 0,void 0,function(){var W,ce;return A(this,function(Be){switch(Be.label){case 0:return W=Iu(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,X),[4,Ts(W)];case 1:return ce=Be.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=xo(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(ce,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},O}(ws),Ts=function(N){return new Promise(function(O,X){var W=new Image;W.onload=function(){O(W)},W.onerror=X,W.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(N))})},Xn=function(){function N(O){var X=O.id,W=O.enabled;this.id=X,this.enabled=W,this.start=Date.now()}return N.prototype.debug=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.prototype.getTime=function(){return Date.now()-this.start},N.prototype.info=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,r([this.id,this.getTime()+"ms"],O))},N.prototype.warn=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.prototype.error=function(){for(var O=[],X=0;X<arguments.length;X++)O[X]=arguments[X];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,r([this.id,this.getTime()+"ms"],O)):this.info.apply(this,O))},N.instances={},N}(),to=function(){function N(O,X){var W;this.windowBounds=X,this.instanceName="#"+N.instanceCount++,this.logger=new Xn({id:this.instanceName,enabled:O.logging}),this.cache=(W=O.cache)!==null&&W!==void 0?W:new MA(this,O)}return N.instanceCount=1,N}(),Ln=function(N,O){return O===void 0&&(O={}),Lo(N,O)};typeof window<"u"&&Pc.setContext(window);var Lo=function(N,O){return h(void 0,void 0,void 0,function(){var X,W,ce,Be,De,gt,pt,Ht,si,pi,Ui,Gr,vr,Rr,Jn,An,rn,Ys,ns,Un,os,Kr,os,Bs,Mn,Mo,fc,Ll,go,Ml,Rd,kc,Rc,PA,pc,Dd,ma,ih,Od,gf;return A(this,function(rh){switch(rh.label){case 0:if(!N||typeof N!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(X=N.ownerDocument,!X)throw new Error("Element is not attached to a Document");if(W=X.defaultView,!W)throw new Error("Document is not attached to a Window");return ce={allowTaint:(Bs=O.allowTaint)!==null&&Bs!==void 0?Bs:!1,imageTimeout:(Mn=O.imageTimeout)!==null&&Mn!==void 0?Mn:15e3,proxy:O.proxy,useCORS:(Mo=O.useCORS)!==null&&Mo!==void 0?Mo:!1},Be=c({logging:(fc=O.logging)!==null&&fc!==void 0?fc:!0,cache:O.cache},ce),De={windowWidth:(Ll=O.windowWidth)!==null&&Ll!==void 0?Ll:W.innerWidth,windowHeight:(go=O.windowHeight)!==null&&go!==void 0?go:W.innerHeight,scrollX:(Ml=O.scrollX)!==null&&Ml!==void 0?Ml:W.pageXOffset,scrollY:(Rd=O.scrollY)!==null&&Rd!==void 0?Rd:W.pageYOffset},gt=new y(De.scrollX,De.scrollY,De.windowWidth,De.windowHeight),pt=new to(Be,gt),Ht=(kc=O.foreignObjectRendering)!==null&&kc!==void 0?kc:!1,si={allowTaint:(Rc=O.allowTaint)!==null&&Rc!==void 0?Rc:!1,onclone:O.onclone,ignoreElements:O.ignoreElements,inlineImages:Ht,copyStyles:Ht},pt.logger.debug("Starting document clone with size "+gt.width+"x"+gt.height+" scrolled to "+-gt.left+","+-gt.top),pi=new FA(pt,N,si),Ui=pi.clonedReferenceElement,Ui?[4,pi.toIFrame(X,gt)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Gr=rh.sent(),vr=Ph(Ui)||zp(Ui)?_(Ui.ownerDocument):b(pt,Ui),Rr=vr.width,Jn=vr.height,An=vr.left,rn=vr.top,Ys=Ds(pt,Ui,O.backgroundColor),ns={canvas:O.canvas,backgroundColor:Ys,scale:(pc=(PA=O.scale)!==null&&PA!==void 0?PA:W.devicePixelRatio)!==null&&pc!==void 0?pc:1,x:((Dd=O.x)!==null&&Dd!==void 0?Dd:0)+An,y:((ma=O.y)!==null&&ma!==void 0?ma:0)+rn,width:(ih=O.width)!==null&&ih!==void 0?ih:Math.ceil(Rr),height:(Od=O.height)!==null&&Od!==void 0?Od:Math.ceil(Jn)},Ht?(pt.logger.debug("Document cloned, using foreign object rendering"),os=new Vo(pt,ns),[4,os.render(Ui)]):[3,3];case 2:return Un=rh.sent(),[3,5];case 3:return pt.logger.debug("Document cloned, element located at "+An+","+rn+" with size "+Rr+"x"+Jn+" using computed rendering"),pt.logger.debug("Starting DOM parsing"),Kr=Wf(pt,Ui),Ys===Kr.styles.backgroundColor&&(Kr.styles.backgroundColor=Sl.TRANSPARENT),pt.logger.debug("Starting renderer for element at "+ns.x+","+ns.y+" with size "+ns.width+"x"+ns.height),os=new ss(pt,ns),[4,os.render(Kr)];case 4:Un=rh.sent(),rh.label=5;case 5:return(!((gf=O.removeContainer)!==null&&gf!==void 0)||gf)&&(FA.destroy(Gr)||pt.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),pt.logger.debug("Finished rendering"),[2,Un]}})})},Ds=function(N,O,X){var W=O.ownerDocument,ce=W.documentElement?jl(N,getComputedStyle(W.documentElement).backgroundColor):Sl.TRANSPARENT,Be=W.body?jl(N,getComputedStyle(W.body).backgroundColor):Sl.TRANSPARENT,De=typeof X=="string"?jl(N,X):X===null?Sl.TRANSPARENT:4294967295;return O===W.documentElement?Fa(ce)?Fa(Be)?De:Be:ce:De};return Ln})}(F0)),F0.exports}/*!
 * html2pdf.js v0.10.3
 * Copyright (c) 2025 Erik Koopmans
 * Released under the MIT License.
 */var YE;function jz(){return YE||(YE=1,function(a,e){(function(s,c){a.exports=c(Uz,Nz())})(self,function(t,s){return function(){var c={"./src/plugin/hyperlinks.js":function(y,b,_){_.r(b),_("./node_modules/core-js/modules/web.dom-collections.for-each.js"),_("./node_modules/core-js/modules/es.string.link.js");var B=_("./src/worker.js"),I=_("./src/utils.js"),E=[],R={toContainer:B.default.prototype.toContainer,toPdf:B.default.prototype.toPdf};B.default.prototype.toContainer=function(){return R.toContainer.call(this).then(function(){if(this.opt.enableLinks){var U=this.prop.container,Q=U.querySelectorAll("a"),q=(0,I.unitConvert)(U.getBoundingClientRect(),this.prop.pageSize.k);E=[],Array.prototype.forEach.call(Q,function(ne){for(var re=ne.getClientRects(),pe=0;pe<re.length;pe++){var Ae=(0,I.unitConvert)(re[pe],this.prop.pageSize.k);Ae.left-=q.left,Ae.top-=q.top;var le=Math.floor(Ae.top/this.prop.pageSize.inner.height)+1,be=this.opt.margin[0]+Ae.top%this.prop.pageSize.inner.height,we=this.opt.margin[1]+Ae.left;E.push({page:le,top:be,left:we,clientRect:Ae,link:ne})}},this)}})},B.default.prototype.toPdf=function(){return R.toPdf.call(this).then(function(){if(this.opt.enableLinks){E.forEach(function(Q){this.prop.pdf.setPage(Q.page),this.prop.pdf.link(Q.left,Q.top,Q.clientRect.width,Q.clientRect.height,{url:Q.link.href})},this);var U=this.prop.pdf.internal.getNumberOfPages();this.prop.pdf.setPage(U)}})}},"./src/plugin/jspdf-plugin.js":function(y,b,_){_.r(b),_("./node_modules/core-js/modules/es.symbol.js"),_("./node_modules/core-js/modules/es.symbol.description.js"),_("./node_modules/core-js/modules/es.object.to-string.js"),_("./node_modules/core-js/modules/es.symbol.iterator.js"),_("./node_modules/core-js/modules/es.array.iterator.js"),_("./node_modules/core-js/modules/es.string.iterator.js"),_("./node_modules/core-js/modules/web.dom-collections.iterator.js");var B=_("jspdf");function I(E){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?I=function(M){return typeof M}:I=function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},I(E)}B.jsPDF.getPageSize=function(E,R,M){if(I(E)==="object"){var G=E;E=G.orientation,R=G.unit||R,M=G.format||M}R=R||"mm",M=M||"a4",E=(""+(E||"P")).toLowerCase();var U=(""+M).toLowerCase(),Q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(R){case"pt":var q=1;break;case"mm":var q=72/25.4;break;case"cm":var q=72/2.54;break;case"in":var q=72;break;case"px":var q=72/96;break;case"pc":var q=12;break;case"em":var q=12;break;case"ex":var q=6;break;default:throw"Invalid unit: "+R}if(Q.hasOwnProperty(U))var ne=Q[U][1]/q,re=Q[U][0]/q;else try{var ne=M[1],re=M[0]}catch{throw new Error("Invalid format: "+M)}if(E==="p"||E==="portrait"){if(E="p",re>ne){var pe=re;re=ne,ne=pe}}else if(E==="l"||E==="landscape"){if(E="l",ne>re){var pe=re;re=ne,ne=pe}}else throw"Invalid orientation: "+E;var Ae={width:re,height:ne,unit:R,k:q};return Ae},b.default=B.jsPDF},"./src/plugin/pagebreaks.js":function(y,b,_){_.r(b),_("./node_modules/core-js/modules/es.array.concat.js"),_("./node_modules/core-js/modules/es.array.slice.js"),_("./node_modules/core-js/modules/es.array.join.js"),_("./node_modules/core-js/modules/web.dom-collections.for-each.js"),_("./node_modules/core-js/modules/es.object.keys.js");var B=_("./src/worker.js"),I=_("./src/utils.js"),E={toContainer:B.default.prototype.toContainer};B.default.template.opt.pagebreak={mode:["css","legacy"],before:[],after:[],avoid:[]},B.default.prototype.toContainer=function(){return E.toContainer.call(this).then(function(){var G=this.prop.container,U=this.prop.pageSize.inner.px.height,Q=[].concat(this.opt.pagebreak.mode),q={avoidAll:Q.indexOf("avoid-all")!==-1,css:Q.indexOf("css")!==-1,legacy:Q.indexOf("legacy")!==-1},ne={},re=this;["before","after","avoid"].forEach(function(le){var be=q.avoidAll&&le==="avoid";ne[le]=be?[]:[].concat(re.opt.pagebreak[le]||[]),ne[le].length>0&&(ne[le]=Array.prototype.slice.call(G.querySelectorAll(ne[le].join(", "))))});var pe=G.querySelectorAll(".html2pdf__page-break");pe=Array.prototype.slice.call(pe);var Ae=G.querySelectorAll("*");Array.prototype.forEach.call(Ae,function(be){var we={before:!1,after:q.legacy&&pe.indexOf(be)!==-1,avoid:q.avoidAll};if(q.css){var oe=window.getComputedStyle(be),me=["always","page","left","right"],Le=["avoid","avoid-page"];we={before:we.before||me.indexOf(oe.breakBefore||oe.pageBreakBefore)!==-1,after:we.after||me.indexOf(oe.breakAfter||oe.pageBreakAfter)!==-1,avoid:we.avoid||Le.indexOf(oe.breakInside||oe.pageBreakInside)!==-1}}Object.keys(we).forEach(function(ct){we[ct]=we[ct]||ne[ct].indexOf(be)!==-1});var Se=be.getBoundingClientRect();if(we.avoid&&!we.before){var Me=Math.floor(Se.top/U),Re=Math.floor(Se.bottom/U),Ze=Math.abs(Se.bottom-Se.top)/U;Re!==Me&&Ze<=1&&(we.before=!0)}if(we.before){var $e=(0,I.createElement)("div",{style:{display:"block",height:U-Se.top%U+"px"}});be.parentNode.insertBefore($e,be)}if(we.after){var $e=(0,I.createElement)("div",{style:{display:"block",height:U-Se.bottom%U+"px"}});be.parentNode.insertBefore($e,be.nextSibling)}})})}},"./src/utils.js":function(y,b,_){_.r(b),_.d(b,{objType:function(){return I},createElement:function(){return E},cloneNode:function(){return R},unitConvert:function(){return M},toPx:function(){return G}}),_("./node_modules/core-js/modules/es.number.constructor.js"),_("./node_modules/core-js/modules/es.symbol.js"),_("./node_modules/core-js/modules/es.symbol.description.js"),_("./node_modules/core-js/modules/es.object.to-string.js"),_("./node_modules/core-js/modules/es.symbol.iterator.js"),_("./node_modules/core-js/modules/es.array.iterator.js"),_("./node_modules/core-js/modules/es.string.iterator.js"),_("./node_modules/core-js/modules/web.dom-collections.iterator.js");function B(U){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(q){return typeof q}:B=function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},B(U)}var I=function(Q){var q=B(Q);return q==="undefined"?"undefined":q==="string"||Q instanceof String?"string":q==="number"||Q instanceof Number?"number":q==="function"||Q instanceof Function?"function":Q&&Q.constructor===Array?"array":Q&&Q.nodeType===1?"element":q==="object"?"object":"unknown"},E=function(Q,q){var ne=document.createElement(Q);if(q.className&&(ne.className=q.className),q.innerHTML){ne.innerHTML=q.innerHTML;for(var re=ne.getElementsByTagName("script"),pe=re.length;pe-- >0;null)re[pe].parentNode.removeChild(re[pe])}for(var Ae in q.style)ne.style[Ae]=q.style[Ae];return ne},R=function U(Q,q){for(var ne=Q.nodeType===3?document.createTextNode(Q.nodeValue):Q.cloneNode(!1),re=Q.firstChild;re;re=re.nextSibling)(q===!0||re.nodeType!==1||re.nodeName!=="SCRIPT")&&ne.appendChild(U(re,q));return Q.nodeType===1&&(Q.nodeName==="CANVAS"?(ne.width=Q.width,ne.height=Q.height,ne.getContext("2d").drawImage(Q,0,0)):(Q.nodeName==="TEXTAREA"||Q.nodeName==="SELECT")&&(ne.value=Q.value),ne.addEventListener("load",function(){ne.scrollTop=Q.scrollTop,ne.scrollLeft=Q.scrollLeft},!0)),ne},M=function(Q,q){if(I(Q)==="number")return Q*72/96/q;var ne={};for(var re in Q)ne[re]=Q[re]*72/96/q;return ne},G=function(Q,q){return Math.floor(Q*q/72*96)}},"./src/worker.js":function(y,b,_){_.r(b),_("./node_modules/core-js/modules/es.object.assign.js"),_("./node_modules/core-js/modules/es.array.map.js"),_("./node_modules/core-js/modules/es.object.keys.js"),_("./node_modules/core-js/modules/es.array.concat.js"),_("./node_modules/core-js/modules/es.object.to-string.js"),_("./node_modules/core-js/modules/es.regexp.to-string.js"),_("./node_modules/core-js/modules/es.function.name.js"),_("./node_modules/core-js/modules/web.dom-collections.for-each.js");var B=_("jspdf"),I=_("html2canvas"),E=_("./src/utils.js"),R=_("./node_modules/es6-promise/dist/es6-promise.js"),M=_.n(R),G=M().Promise,U=function Q(q){var ne=Object.assign(Q.convert(G.resolve()),JSON.parse(JSON.stringify(Q.template))),re=Q.convert(G.resolve(),ne);return re=re.setProgress(1,Q,1,[Q]),re=re.set(q),re};U.prototype=Object.create(G.prototype),U.prototype.constructor=U,U.convert=function(q,ne){return q.__proto__=ne||U.prototype,q},U.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],image:{type:"jpeg",quality:.95},enableLinks:!0,html2canvas:{},jsPDF:{}}},U.prototype.from=function(q,ne){function re(pe){switch((0,E.objType)(pe)){case"string":return"string";case"element":return pe.nodeName.toLowerCase&&pe.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}return this.then(function(){switch(ne=ne||re(q),ne){case"string":return this.set({src:(0,E.createElement)("div",{innerHTML:q})});case"element":return this.set({src:q});case"canvas":return this.set({canvas:q});case"img":return this.set({img:q});default:return this.error("Unknown source type.")}})},U.prototype.to=function(q){switch(q){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},U.prototype.toContainer=function(){var q=[function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(q).then(function(){var re={position:"fixed",overflow:"hidden",zIndex:1e3,left:0,right:0,bottom:0,top:0,backgroundColor:"rgba(0,0,0,0.8)"},pe={position:"absolute",width:this.prop.pageSize.inner.width+this.prop.pageSize.unit,left:0,right:0,top:0,height:"auto",margin:"auto",backgroundColor:"white"};re.opacity=0;var Ae=(0,E.cloneNode)(this.prop.src,this.opt.html2canvas.javascriptEnabled);this.prop.overlay=(0,E.createElement)("div",{className:"html2pdf__overlay",style:re}),this.prop.container=(0,E.createElement)("div",{className:"html2pdf__container",style:pe}),this.prop.container.appendChild(Ae),this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay)})},U.prototype.toCanvas=function(){var q=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(q).then(function(){var re=Object.assign({},this.opt.html2canvas);return delete re.onrendered,I(this.prop.container,re)}).then(function(re){var pe=this.opt.html2canvas.onrendered||function(){};pe(re),this.prop.canvas=re,document.body.removeChild(this.prop.overlay)})},U.prototype.toImg=function(){var q=[function(){return this.prop.canvas||this.toCanvas()}];return this.thenList(q).then(function(){var re=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=re})},U.prototype.toPdf=function(){var q=[function(){return this.prop.canvas||this.toCanvas()},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(q).then(function(){var re=this.prop.canvas,pe=this.opt,Ae=re.height,le=Math.floor(re.width*this.prop.pageSize.inner.ratio),be=Math.ceil(Ae/le),we=this.prop.pageSize.inner.height,oe=document.createElement("canvas"),me=oe.getContext("2d");oe.width=re.width,oe.height=le,this.prop.pdf=this.prop.pdf||new B.jsPDF(pe.jsPDF);for(var Le=0;Le<be;Le++){Le===be-1&&Ae%le!==0&&(oe.height=Ae%le,we=oe.height*this.prop.pageSize.inner.width/oe.width);var Se=oe.width,Me=oe.height;me.fillStyle="white",me.fillRect(0,0,Se,Me),me.drawImage(re,0,Le*le,Se,Me,0,0,Se,Me),Le&&this.prop.pdf.addPage();var Re=oe.toDataURL("image/"+pe.image.type,pe.image.quality);this.prop.pdf.addImage(Re,pe.image.type,pe.margin[1],pe.margin[0],this.prop.pageSize.inner.width,we)}})},U.prototype.output=function(q,ne,re){return re=re||"pdf",re.toLowerCase()==="img"||re.toLowerCase()==="image"?this.outputImg(q,ne):this.outputPdf(q,ne)},U.prototype.outputPdf=function(q,ne){var re=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(re).then(function(){return this.prop.pdf.output(q,ne)})},U.prototype.outputImg=function(q,ne){var re=[function(){return this.prop.img||this.toImg()}];return this.thenList(re).then(function(){switch(q){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+q+'" is not supported.'}})},U.prototype.save=function(q){var ne=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(ne).set(q?{filename:q}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},U.prototype.set=function(q){if((0,E.objType)(q)!=="object")return this;var ne=Object.keys(q||{}).map(function(re){switch(re){case"margin":return this.setMargin.bind(this,q.margin);case"jsPDF":return function(){return this.opt.jsPDF=q.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,q.pageSize);default:return re in U.template.prop?function(){this.prop[re]=q[re]}:function(){this.opt[re]=q[re]}}},this);return this.then(function(){return this.thenList(ne)})},U.prototype.get=function(q,ne){return this.then(function(){var pe=q in U.template.prop?this.prop[q]:this.opt[q];return ne?ne(pe):pe})},U.prototype.setMargin=function(q){return this.then(function(){switch((0,E.objType)(q)){case"number":q=[q,q,q,q];case"array":if(q.length===2&&(q=[q[0],q[1],q[0],q[1]]),q.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=q}).then(this.setPageSize)},U.prototype.setPageSize=function(q){return this.then(function(){q=q||B.jsPDF.getPageSize(this.opt.jsPDF),q.hasOwnProperty("inner")||(q.inner={width:q.width-this.opt.margin[1]-this.opt.margin[3],height:q.height-this.opt.margin[0]-this.opt.margin[2]},q.inner.px={width:(0,E.toPx)(q.inner.width,q.k),height:(0,E.toPx)(q.inner.height,q.k)},q.inner.ratio=q.inner.height/q.inner.width),this.prop.pageSize=q})},U.prototype.setProgress=function(q,ne,re,pe){return q!=null&&(this.progress.val=q),ne!=null&&(this.progress.state=ne),re!=null&&(this.progress.n=re),pe!=null&&(this.progress.stack=pe),this.progress.ratio=this.progress.val/this.progress.state,this},U.prototype.updateProgress=function(q,ne,re,pe){return this.setProgress(q?this.progress.val+q:null,ne||null,re?this.progress.n+re:null,pe?this.progress.stack.concat(pe):null)},U.prototype.then=function(q,ne){var re=this;return this.thenCore(q,ne,function(Ae,le){return re.updateProgress(null,null,1,[Ae]),G.prototype.then.call(this,function(we){return re.updateProgress(null,Ae),we}).then(Ae,le).then(function(we){return re.updateProgress(1),we})})},U.prototype.thenCore=function(q,ne,re){re=re||G.prototype.then;var pe=this;q&&(q=q.bind(pe)),ne&&(ne=ne.bind(pe));var Ae=G.toString().indexOf("[native code]")!==-1&&G.name==="Promise",le=Ae?pe:U.convert(Object.assign({},pe),G.prototype),be=re.call(le,q,ne);return U.convert(be,pe.__proto__)},U.prototype.thenExternal=function(q,ne){return G.prototype.then.call(this,q,ne)},U.prototype.thenList=function(q){var ne=this;return q.forEach(function(pe){ne=ne.thenCore(pe)}),ne},U.prototype.catch=function(Q){Q&&(Q=Q.bind(this));var q=G.prototype.catch.call(this,Q);return U.convert(q,this)},U.prototype.catchExternal=function(q){return G.prototype.catch.call(this,q)},U.prototype.error=function(q){return this.then(function(){throw new Error(q)})},U.prototype.using=U.prototype.set,U.prototype.saveAs=U.prototype.save,U.prototype.export=U.prototype.output,U.prototype.run=U.prototype.then,b.default=U},"./node_modules/core-js/internals/a-function.js":function(y){y.exports=function(b){if(typeof b!="function")throw TypeError(String(b)+" is not a function");return b}},"./node_modules/core-js/internals/a-possible-prototype.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js");y.exports=function(I){if(!B(I)&&I!==null)throw TypeError("Can't set "+String(I)+" as a prototype");return I}},"./node_modules/core-js/internals/add-to-unscopables.js":function(y,b,_){var B=_("./node_modules/core-js/internals/well-known-symbol.js"),I=_("./node_modules/core-js/internals/object-create.js"),E=_("./node_modules/core-js/internals/object-define-property.js"),R=B("unscopables"),M=Array.prototype;M[R]==null&&E.f(M,R,{configurable:!0,value:I(null)}),y.exports=function(G){M[R][G]=!0}},"./node_modules/core-js/internals/an-object.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js");y.exports=function(I){if(!B(I))throw TypeError(String(I)+" is not an object");return I}},"./node_modules/core-js/internals/array-for-each.js":function(y,b,_){var B=_("./node_modules/core-js/internals/array-iteration.js").forEach,I=_("./node_modules/core-js/internals/array-method-is-strict.js"),E=I("forEach");y.exports=E?[].forEach:function(M){return B(this,M,arguments.length>1?arguments[1]:void 0)}},"./node_modules/core-js/internals/array-includes.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-indexed-object.js"),I=_("./node_modules/core-js/internals/to-length.js"),E=_("./node_modules/core-js/internals/to-absolute-index.js"),R=function(M){return function(G,U,Q){var q=B(G),ne=I(q.length),re=E(Q,ne),pe;if(M&&U!=U){for(;ne>re;)if(pe=q[re++],pe!=pe)return!0}else for(;ne>re;re++)if((M||re in q)&&q[re]===U)return M||re||0;return!M&&-1}};y.exports={includes:R(!0),indexOf:R(!1)}},"./node_modules/core-js/internals/array-iteration.js":function(y,b,_){var B=_("./node_modules/core-js/internals/function-bind-context.js"),I=_("./node_modules/core-js/internals/indexed-object.js"),E=_("./node_modules/core-js/internals/to-object.js"),R=_("./node_modules/core-js/internals/to-length.js"),M=_("./node_modules/core-js/internals/array-species-create.js"),G=[].push,U=function(Q){var q=Q==1,ne=Q==2,re=Q==3,pe=Q==4,Ae=Q==6,le=Q==7,be=Q==5||Ae;return function(we,oe,me,Le){for(var Se=E(we),Me=I(Se),Re=B(oe,me,3),Ze=R(Me.length),$e=0,ct=Le||M,Qe=q?ct(we,Ze):ne||le?ct(we,0):void 0,It,Ce;Ze>$e;$e++)if((be||$e in Me)&&(It=Me[$e],Ce=Re(It,$e,Se),Q))if(q)Qe[$e]=Ce;else if(Ce)switch(Q){case 3:return!0;case 5:return It;case 6:return $e;case 2:G.call(Qe,It)}else switch(Q){case 4:return!1;case 7:G.call(Qe,It)}return Ae?-1:re||pe?pe:Qe}};y.exports={forEach:U(0),map:U(1),filter:U(2),some:U(3),every:U(4),find:U(5),findIndex:U(6),filterReject:U(7)}},"./node_modules/core-js/internals/array-method-has-species-support.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js"),I=_("./node_modules/core-js/internals/well-known-symbol.js"),E=_("./node_modules/core-js/internals/engine-v8-version.js"),R=I("species");y.exports=function(M){return E>=51||!B(function(){var G=[],U=G.constructor={};return U[R]=function(){return{foo:1}},G[M](Boolean).foo!==1})}},"./node_modules/core-js/internals/array-method-is-strict.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js");y.exports=function(I,E){var R=[][I];return!!R&&B(function(){R.call(null,E||function(){throw 1},1)})}},"./node_modules/core-js/internals/array-species-constructor.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js"),I=_("./node_modules/core-js/internals/is-array.js"),E=_("./node_modules/core-js/internals/well-known-symbol.js"),R=E("species");y.exports=function(M){var G;return I(M)&&(G=M.constructor,typeof G=="function"&&(G===Array||I(G.prototype))?G=void 0:B(G)&&(G=G[R],G===null&&(G=void 0))),G===void 0?Array:G}},"./node_modules/core-js/internals/array-species-create.js":function(y,b,_){var B=_("./node_modules/core-js/internals/array-species-constructor.js");y.exports=function(I,E){return new(B(I))(E===0?0:E)}},"./node_modules/core-js/internals/classof-raw.js":function(y){var b={}.toString;y.exports=function(_){return b.call(_).slice(8,-1)}},"./node_modules/core-js/internals/classof.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-string-tag-support.js"),I=_("./node_modules/core-js/internals/classof-raw.js"),E=_("./node_modules/core-js/internals/well-known-symbol.js"),R=E("toStringTag"),M=I(function(){return arguments}())=="Arguments",G=function(U,Q){try{return U[Q]}catch{}};y.exports=B?I:function(U){var Q,q,ne;return U===void 0?"Undefined":U===null?"Null":typeof(q=G(Q=Object(U),R))=="string"?q:M?I(Q):(ne=I(Q))=="Object"&&typeof Q.callee=="function"?"Arguments":ne}},"./node_modules/core-js/internals/copy-constructor-properties.js":function(y,b,_){var B=_("./node_modules/core-js/internals/has.js"),I=_("./node_modules/core-js/internals/own-keys.js"),E=_("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),R=_("./node_modules/core-js/internals/object-define-property.js");y.exports=function(M,G){for(var U=I(G),Q=R.f,q=E.f,ne=0;ne<U.length;ne++){var re=U[ne];B(M,re)||Q(M,re,q(G,re))}}},"./node_modules/core-js/internals/correct-prototype-getter.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js");y.exports=!B(function(){function I(){}return I.prototype.constructor=null,Object.getPrototypeOf(new I)!==I.prototype})},"./node_modules/core-js/internals/create-html.js":function(y,b,_){var B=_("./node_modules/core-js/internals/require-object-coercible.js"),I=_("./node_modules/core-js/internals/to-string.js"),E=/"/g;y.exports=function(R,M,G,U){var Q=I(B(R)),q="<"+M;return G!==""&&(q+=" "+G+'="'+I(U).replace(E,"&quot;")+'"'),q+">"+Q+"</"+M+">"}},"./node_modules/core-js/internals/create-iterator-constructor.js":function(y,b,_){var B=_("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,I=_("./node_modules/core-js/internals/object-create.js"),E=_("./node_modules/core-js/internals/create-property-descriptor.js"),R=_("./node_modules/core-js/internals/set-to-string-tag.js"),M=_("./node_modules/core-js/internals/iterators.js"),G=function(){return this};y.exports=function(U,Q,q){var ne=Q+" Iterator";return U.prototype=I(B,{next:E(1,q)}),R(U,ne,!1,!0),M[ne]=G,U}},"./node_modules/core-js/internals/create-non-enumerable-property.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/object-define-property.js"),E=_("./node_modules/core-js/internals/create-property-descriptor.js");y.exports=B?function(R,M,G){return I.f(R,M,E(1,G))}:function(R,M,G){return R[M]=G,R}},"./node_modules/core-js/internals/create-property-descriptor.js":function(y){y.exports=function(b,_){return{enumerable:!(b&1),configurable:!(b&2),writable:!(b&4),value:_}}},"./node_modules/core-js/internals/create-property.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-property-key.js"),I=_("./node_modules/core-js/internals/object-define-property.js"),E=_("./node_modules/core-js/internals/create-property-descriptor.js");y.exports=function(R,M,G){var U=B(M);U in R?I.f(R,U,E(0,G)):R[U]=G}},"./node_modules/core-js/internals/define-iterator.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/create-iterator-constructor.js"),E=_("./node_modules/core-js/internals/object-get-prototype-of.js"),R=_("./node_modules/core-js/internals/object-set-prototype-of.js"),M=_("./node_modules/core-js/internals/set-to-string-tag.js"),G=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),U=_("./node_modules/core-js/internals/redefine.js"),Q=_("./node_modules/core-js/internals/well-known-symbol.js"),q=_("./node_modules/core-js/internals/is-pure.js"),ne=_("./node_modules/core-js/internals/iterators.js"),re=_("./node_modules/core-js/internals/iterators-core.js"),pe=re.IteratorPrototype,Ae=re.BUGGY_SAFARI_ITERATORS,le=Q("iterator"),be="keys",we="values",oe="entries",me=function(){return this};y.exports=function(Le,Se,Me,Re,Ze,$e,ct){I(Me,Se,Re);var Qe=function(Gt){if(Gt===Ze&&mt)return mt;if(!Ae&&Gt in Je)return Je[Gt];switch(Gt){case be:return function(){return new Me(this,Gt)};case we:return function(){return new Me(this,Gt)};case oe:return function(){return new Me(this,Gt)}}return function(){return new Me(this)}},It=Se+" Iterator",Ce=!1,Je=Le.prototype,lt=Je[le]||Je["@@iterator"]||Ze&&Je[Ze],mt=!Ae&&lt||Qe(Ze),Bt=Se=="Array"&&Je.entries||lt,rt,St,vt;if(Bt&&(rt=E(Bt.call(new Le)),pe!==Object.prototype&&rt.next&&(!q&&E(rt)!==pe&&(R?R(rt,pe):typeof rt[le]!="function"&&G(rt,le,me)),M(rt,It,!0,!0),q&&(ne[It]=me))),Ze==we&&lt&&lt.name!==we&&(Ce=!0,mt=function(){return lt.call(this)}),(!q||ct)&&Je[le]!==mt&&G(Je,le,mt),ne[Se]=mt,Ze)if(St={values:Qe(we),keys:$e?mt:Qe(be),entries:Qe(oe)},ct)for(vt in St)(Ae||Ce||!(vt in Je))&&U(Je,vt,St[vt]);else B({target:Se,proto:!0,forced:Ae||Ce},St);return St}},"./node_modules/core-js/internals/define-well-known-symbol.js":function(y,b,_){var B=_("./node_modules/core-js/internals/path.js"),I=_("./node_modules/core-js/internals/has.js"),E=_("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),R=_("./node_modules/core-js/internals/object-define-property.js").f;y.exports=function(M){var G=B.Symbol||(B.Symbol={});I(G,M)||R(G,M,{value:E.f(M)})}},"./node_modules/core-js/internals/descriptors.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js");y.exports=!B(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},"./node_modules/core-js/internals/document-create-element.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/is-object.js"),E=B.document,R=I(E)&&I(E.createElement);y.exports=function(M){return R?E.createElement(M):{}}},"./node_modules/core-js/internals/dom-iterables.js":function(y){y.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},"./node_modules/core-js/internals/engine-user-agent.js":function(y,b,_){var B=_("./node_modules/core-js/internals/get-built-in.js");y.exports=B("navigator","userAgent")||""},"./node_modules/core-js/internals/engine-v8-version.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/engine-user-agent.js"),E=B.process,R=B.Deno,M=E&&E.versions||R&&R.version,G=M&&M.v8,U,Q;G?(U=G.split("."),Q=U[0]<4?1:U[0]+U[1]):I&&(U=I.match(/Edge\/(\d+)/),(!U||U[1]>=74)&&(U=I.match(/Chrome\/(\d+)/),U&&(Q=U[1]))),y.exports=Q&&+Q},"./node_modules/core-js/internals/enum-bug-keys.js":function(y){y.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"./node_modules/core-js/internals/export.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,E=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),R=_("./node_modules/core-js/internals/redefine.js"),M=_("./node_modules/core-js/internals/set-global.js"),G=_("./node_modules/core-js/internals/copy-constructor-properties.js"),U=_("./node_modules/core-js/internals/is-forced.js");y.exports=function(Q,q){var ne=Q.target,re=Q.global,pe=Q.stat,Ae,le,be,we,oe,me;if(re?le=B:pe?le=B[ne]||M(ne,{}):le=(B[ne]||{}).prototype,le)for(be in q){if(oe=q[be],Q.noTargetGet?(me=I(le,be),we=me&&me.value):we=le[be],Ae=U(re?be:ne+(pe?".":"#")+be,Q.forced),!Ae&&we!==void 0){if(typeof oe==typeof we)continue;G(oe,we)}(Q.sham||we&&we.sham)&&E(oe,"sham",!0),R(le,be,oe,Q)}}},"./node_modules/core-js/internals/fails.js":function(y){y.exports=function(b){try{return!!b()}catch{return!0}}},"./node_modules/core-js/internals/function-bind-context.js":function(y,b,_){var B=_("./node_modules/core-js/internals/a-function.js");y.exports=function(I,E,R){if(B(I),E===void 0)return I;switch(R){case 0:return function(){return I.call(E)};case 1:return function(M){return I.call(E,M)};case 2:return function(M,G){return I.call(E,M,G)};case 3:return function(M,G,U){return I.call(E,M,G,U)}}return function(){return I.apply(E,arguments)}}},"./node_modules/core-js/internals/get-built-in.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=function(E){return typeof E=="function"?E:void 0};y.exports=function(E,R){return arguments.length<2?I(B[E]):B[E]&&B[E][R]}},"./node_modules/core-js/internals/global.js":function(y){var b=function(_){return _&&_.Math==Math&&_};y.exports=b(typeof globalThis=="object"&&globalThis)||b(typeof window=="object"&&window)||b(typeof self=="object"&&self)||b(typeof h0=="object"&&h0)||function(){return this}()||Function("return this")()},"./node_modules/core-js/internals/has.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-object.js"),I={}.hasOwnProperty;y.exports=Object.hasOwn||function(R,M){return I.call(B(R),M)}},"./node_modules/core-js/internals/hidden-keys.js":function(y){y.exports={}},"./node_modules/core-js/internals/html.js":function(y,b,_){var B=_("./node_modules/core-js/internals/get-built-in.js");y.exports=B("document","documentElement")},"./node_modules/core-js/internals/ie8-dom-define.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/fails.js"),E=_("./node_modules/core-js/internals/document-create-element.js");y.exports=!B&&!I(function(){return Object.defineProperty(E("div"),"a",{get:function(){return 7}}).a!=7})},"./node_modules/core-js/internals/indexed-object.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js"),I=_("./node_modules/core-js/internals/classof-raw.js"),E="".split;y.exports=B(function(){return!Object("z").propertyIsEnumerable(0)})?function(R){return I(R)=="String"?E.call(R,""):Object(R)}:Object},"./node_modules/core-js/internals/inherit-if-required.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js"),I=_("./node_modules/core-js/internals/object-set-prototype-of.js");y.exports=function(E,R,M){var G,U;return I&&typeof(G=R.constructor)=="function"&&G!==M&&B(U=G.prototype)&&U!==M.prototype&&I(E,U),E}},"./node_modules/core-js/internals/inspect-source.js":function(y,b,_){var B=_("./node_modules/core-js/internals/shared-store.js"),I=Function.toString;typeof B.inspectSource!="function"&&(B.inspectSource=function(E){return I.call(E)}),y.exports=B.inspectSource},"./node_modules/core-js/internals/internal-state.js":function(y,b,_){var B=_("./node_modules/core-js/internals/native-weak-map.js"),I=_("./node_modules/core-js/internals/global.js"),E=_("./node_modules/core-js/internals/is-object.js"),R=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),M=_("./node_modules/core-js/internals/has.js"),G=_("./node_modules/core-js/internals/shared-store.js"),U=_("./node_modules/core-js/internals/shared-key.js"),Q=_("./node_modules/core-js/internals/hidden-keys.js"),q="Object already initialized",ne=I.WeakMap,re,pe,Ae,le=function(Me){return Ae(Me)?pe(Me):re(Me,{})},be=function(Me){return function(Re){var Ze;if(!E(Re)||(Ze=pe(Re)).type!==Me)throw TypeError("Incompatible receiver, "+Me+" required");return Ze}};if(B||G.state){var we=G.state||(G.state=new ne),oe=we.get,me=we.has,Le=we.set;re=function(Me,Re){if(me.call(we,Me))throw new TypeError(q);return Re.facade=Me,Le.call(we,Me,Re),Re},pe=function(Me){return oe.call(we,Me)||{}},Ae=function(Me){return me.call(we,Me)}}else{var Se=U("state");Q[Se]=!0,re=function(Me,Re){if(M(Me,Se))throw new TypeError(q);return Re.facade=Me,R(Me,Se,Re),Re},pe=function(Me){return M(Me,Se)?Me[Se]:{}},Ae=function(Me){return M(Me,Se)}}y.exports={set:re,get:pe,has:Ae,enforce:le,getterFor:be}},"./node_modules/core-js/internals/is-array.js":function(y,b,_){var B=_("./node_modules/core-js/internals/classof-raw.js");y.exports=Array.isArray||function(E){return B(E)=="Array"}},"./node_modules/core-js/internals/is-forced.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js"),I=/#|\.prototype\./,E=function(Q,q){var ne=M[R(Q)];return ne==U?!0:ne==G?!1:typeof q=="function"?B(q):!!q},R=E.normalize=function(Q){return String(Q).replace(I,".").toLowerCase()},M=E.data={},G=E.NATIVE="N",U=E.POLYFILL="P";y.exports=E},"./node_modules/core-js/internals/is-object.js":function(y){y.exports=function(b){return typeof b=="object"?b!==null:typeof b=="function"}},"./node_modules/core-js/internals/is-pure.js":function(y){y.exports=!1},"./node_modules/core-js/internals/is-symbol.js":function(y,b,_){var B=_("./node_modules/core-js/internals/get-built-in.js"),I=_("./node_modules/core-js/internals/use-symbol-as-uid.js");y.exports=I?function(E){return typeof E=="symbol"}:function(E){var R=B("Symbol");return typeof R=="function"&&Object(E)instanceof R}},"./node_modules/core-js/internals/iterators-core.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js"),I=_("./node_modules/core-js/internals/object-get-prototype-of.js"),E=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),R=_("./node_modules/core-js/internals/has.js"),M=_("./node_modules/core-js/internals/well-known-symbol.js"),G=_("./node_modules/core-js/internals/is-pure.js"),U=M("iterator"),Q=!1,q=function(){return this},ne,re,pe;[].keys&&(pe=[].keys(),"next"in pe?(re=I(I(pe)),re!==Object.prototype&&(ne=re)):Q=!0);var Ae=ne==null||B(function(){var le={};return ne[U].call(le)!==le});Ae&&(ne={}),(!G||Ae)&&!R(ne,U)&&E(ne,U,q),y.exports={IteratorPrototype:ne,BUGGY_SAFARI_ITERATORS:Q}},"./node_modules/core-js/internals/iterators.js":function(y){y.exports={}},"./node_modules/core-js/internals/native-symbol.js":function(y,b,_){var B=_("./node_modules/core-js/internals/engine-v8-version.js"),I=_("./node_modules/core-js/internals/fails.js");y.exports=!!Object.getOwnPropertySymbols&&!I(function(){var E=Symbol();return!String(E)||!(Object(E)instanceof Symbol)||!Symbol.sham&&B&&B<41})},"./node_modules/core-js/internals/native-weak-map.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/inspect-source.js"),E=B.WeakMap;y.exports=typeof E=="function"&&/native code/.test(I(E))},"./node_modules/core-js/internals/object-assign.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/fails.js"),E=_("./node_modules/core-js/internals/object-keys.js"),R=_("./node_modules/core-js/internals/object-get-own-property-symbols.js"),M=_("./node_modules/core-js/internals/object-property-is-enumerable.js"),G=_("./node_modules/core-js/internals/to-object.js"),U=_("./node_modules/core-js/internals/indexed-object.js"),Q=Object.assign,q=Object.defineProperty;y.exports=!Q||I(function(){if(B&&Q({b:1},Q(q({},"a",{enumerable:!0,get:function(){q(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var ne={},re={},pe=Symbol(),Ae="abcdefghijklmnopqrst";return ne[pe]=7,Ae.split("").forEach(function(le){re[le]=le}),Q({},ne)[pe]!=7||E(Q({},re)).join("")!=Ae})?function(re,pe){for(var Ae=G(re),le=arguments.length,be=1,we=R.f,oe=M.f;le>be;)for(var me=U(arguments[be++]),Le=we?E(me).concat(we(me)):E(me),Se=Le.length,Me=0,Re;Se>Me;)Re=Le[Me++],(!B||oe.call(me,Re))&&(Ae[Re]=me[Re]);return Ae}:Q},"./node_modules/core-js/internals/object-create.js":function(y,b,_){var B=_("./node_modules/core-js/internals/an-object.js"),I=_("./node_modules/core-js/internals/object-define-properties.js"),E=_("./node_modules/core-js/internals/enum-bug-keys.js"),R=_("./node_modules/core-js/internals/hidden-keys.js"),M=_("./node_modules/core-js/internals/html.js"),G=_("./node_modules/core-js/internals/document-create-element.js"),U=_("./node_modules/core-js/internals/shared-key.js"),Q=">",q="<",ne="prototype",re="script",pe=U("IE_PROTO"),Ae=function(){},le=function(Le){return q+re+Q+Le+q+"/"+re+Q},be=function(Le){Le.write(le("")),Le.close();var Se=Le.parentWindow.Object;return Le=null,Se},we=function(){var Le=G("iframe"),Se="java"+re+":",Me;if(Le.style)return Le.style.display="none",M.appendChild(Le),Le.src=String(Se),Me=Le.contentWindow.document,Me.open(),Me.write(le("document.F=Object")),Me.close(),Me.F},oe,me=function(){try{oe=new ActiveXObject("htmlfile")}catch{}me=document.domain&&oe?be(oe):we()||be(oe);for(var Le=E.length;Le--;)delete me[ne][E[Le]];return me()};R[pe]=!0,y.exports=Object.create||function(Se,Me){var Re;return Se!==null?(Ae[ne]=B(Se),Re=new Ae,Ae[ne]=null,Re[pe]=Se):Re=me(),Me===void 0?Re:I(Re,Me)}},"./node_modules/core-js/internals/object-define-properties.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/object-define-property.js"),E=_("./node_modules/core-js/internals/an-object.js"),R=_("./node_modules/core-js/internals/object-keys.js");y.exports=B?Object.defineProperties:function(G,U){E(G);for(var Q=R(U),q=Q.length,ne=0,re;q>ne;)I.f(G,re=Q[ne++],U[re]);return G}},"./node_modules/core-js/internals/object-define-property.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/ie8-dom-define.js"),E=_("./node_modules/core-js/internals/an-object.js"),R=_("./node_modules/core-js/internals/to-property-key.js"),M=Object.defineProperty;b.f=B?M:function(U,Q,q){if(E(U),Q=R(Q),E(q),I)try{return M(U,Q,q)}catch{}if("get"in q||"set"in q)throw TypeError("Accessors not supported");return"value"in q&&(U[Q]=q.value),U}},"./node_modules/core-js/internals/object-get-own-property-descriptor.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/object-property-is-enumerable.js"),E=_("./node_modules/core-js/internals/create-property-descriptor.js"),R=_("./node_modules/core-js/internals/to-indexed-object.js"),M=_("./node_modules/core-js/internals/to-property-key.js"),G=_("./node_modules/core-js/internals/has.js"),U=_("./node_modules/core-js/internals/ie8-dom-define.js"),Q=Object.getOwnPropertyDescriptor;b.f=B?Q:function(ne,re){if(ne=R(ne),re=M(re),U)try{return Q(ne,re)}catch{}if(G(ne,re))return E(!I.f.call(ne,re),ne[re])}},"./node_modules/core-js/internals/object-get-own-property-names-external.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-indexed-object.js"),I=_("./node_modules/core-js/internals/object-get-own-property-names.js").f,E={}.toString,R=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],M=function(G){try{return I(G)}catch{return R.slice()}};y.exports.f=function(U){return R&&E.call(U)=="[object Window]"?M(U):I(B(U))}},"./node_modules/core-js/internals/object-get-own-property-names.js":function(y,b,_){var B=_("./node_modules/core-js/internals/object-keys-internal.js"),I=_("./node_modules/core-js/internals/enum-bug-keys.js"),E=I.concat("length","prototype");b.f=Object.getOwnPropertyNames||function(M){return B(M,E)}},"./node_modules/core-js/internals/object-get-own-property-symbols.js":function(y,b){b.f=Object.getOwnPropertySymbols},"./node_modules/core-js/internals/object-get-prototype-of.js":function(y,b,_){var B=_("./node_modules/core-js/internals/has.js"),I=_("./node_modules/core-js/internals/to-object.js"),E=_("./node_modules/core-js/internals/shared-key.js"),R=_("./node_modules/core-js/internals/correct-prototype-getter.js"),M=E("IE_PROTO"),G=Object.prototype;y.exports=R?Object.getPrototypeOf:function(U){return U=I(U),B(U,M)?U[M]:typeof U.constructor=="function"&&U instanceof U.constructor?U.constructor.prototype:U instanceof Object?G:null}},"./node_modules/core-js/internals/object-keys-internal.js":function(y,b,_){var B=_("./node_modules/core-js/internals/has.js"),I=_("./node_modules/core-js/internals/to-indexed-object.js"),E=_("./node_modules/core-js/internals/array-includes.js").indexOf,R=_("./node_modules/core-js/internals/hidden-keys.js");y.exports=function(M,G){var U=I(M),Q=0,q=[],ne;for(ne in U)!B(R,ne)&&B(U,ne)&&q.push(ne);for(;G.length>Q;)B(U,ne=G[Q++])&&(~E(q,ne)||q.push(ne));return q}},"./node_modules/core-js/internals/object-keys.js":function(y,b,_){var B=_("./node_modules/core-js/internals/object-keys-internal.js"),I=_("./node_modules/core-js/internals/enum-bug-keys.js");y.exports=Object.keys||function(R){return B(R,I)}},"./node_modules/core-js/internals/object-property-is-enumerable.js":function(y,b){var _={}.propertyIsEnumerable,B=Object.getOwnPropertyDescriptor,I=B&&!_.call({1:2},1);b.f=I?function(R){var M=B(this,R);return!!M&&M.enumerable}:_},"./node_modules/core-js/internals/object-set-prototype-of.js":function(y,b,_){var B=_("./node_modules/core-js/internals/an-object.js"),I=_("./node_modules/core-js/internals/a-possible-prototype.js");y.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var E=!1,R={},M;try{M=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,M.call(R,[]),E=R instanceof Array}catch{}return function(U,Q){return B(U),I(Q),E?M.call(U,Q):U.__proto__=Q,U}}():void 0)},"./node_modules/core-js/internals/object-to-string.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-string-tag-support.js"),I=_("./node_modules/core-js/internals/classof.js");y.exports=B?{}.toString:function(){return"[object "+I(this)+"]"}},"./node_modules/core-js/internals/ordinary-to-primitive.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js");y.exports=function(I,E){var R,M;if(E==="string"&&typeof(R=I.toString)=="function"&&!B(M=R.call(I))||typeof(R=I.valueOf)=="function"&&!B(M=R.call(I))||E!=="string"&&typeof(R=I.toString)=="function"&&!B(M=R.call(I)))return M;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/internals/own-keys.js":function(y,b,_){var B=_("./node_modules/core-js/internals/get-built-in.js"),I=_("./node_modules/core-js/internals/object-get-own-property-names.js"),E=_("./node_modules/core-js/internals/object-get-own-property-symbols.js"),R=_("./node_modules/core-js/internals/an-object.js");y.exports=B("Reflect","ownKeys")||function(G){var U=I.f(R(G)),Q=E.f;return Q?U.concat(Q(G)):U}},"./node_modules/core-js/internals/path.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js");y.exports=B},"./node_modules/core-js/internals/redefine.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),E=_("./node_modules/core-js/internals/has.js"),R=_("./node_modules/core-js/internals/set-global.js"),M=_("./node_modules/core-js/internals/inspect-source.js"),G=_("./node_modules/core-js/internals/internal-state.js"),U=G.get,Q=G.enforce,q=String(String).split("String");(y.exports=function(ne,re,pe,Ae){var le=Ae?!!Ae.unsafe:!1,be=Ae?!!Ae.enumerable:!1,we=Ae?!!Ae.noTargetGet:!1,oe;if(typeof pe=="function"&&(typeof re=="string"&&!E(pe,"name")&&I(pe,"name",re),oe=Q(pe),oe.source||(oe.source=q.join(typeof re=="string"?re:""))),ne===B){be?ne[re]=pe:R(re,pe);return}else le?!we&&ne[re]&&(be=!0):delete ne[re];be?ne[re]=pe:I(ne,re,pe)})(Function.prototype,"toString",function(){return typeof this=="function"&&U(this).source||M(this)})},"./node_modules/core-js/internals/regexp-flags.js":function(y,b,_){var B=_("./node_modules/core-js/internals/an-object.js");y.exports=function(){var I=B(this),E="";return I.global&&(E+="g"),I.ignoreCase&&(E+="i"),I.multiline&&(E+="m"),I.dotAll&&(E+="s"),I.unicode&&(E+="u"),I.sticky&&(E+="y"),E}},"./node_modules/core-js/internals/require-object-coercible.js":function(y){y.exports=function(b){if(b==null)throw TypeError("Can't call method on "+b);return b}},"./node_modules/core-js/internals/set-global.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js");y.exports=function(I,E){try{Object.defineProperty(B,I,{value:E,configurable:!0,writable:!0})}catch{B[I]=E}return E}},"./node_modules/core-js/internals/set-to-string-tag.js":function(y,b,_){var B=_("./node_modules/core-js/internals/object-define-property.js").f,I=_("./node_modules/core-js/internals/has.js"),E=_("./node_modules/core-js/internals/well-known-symbol.js"),R=E("toStringTag");y.exports=function(M,G,U){M&&!I(M=U?M:M.prototype,R)&&B(M,R,{configurable:!0,value:G})}},"./node_modules/core-js/internals/shared-key.js":function(y,b,_){var B=_("./node_modules/core-js/internals/shared.js"),I=_("./node_modules/core-js/internals/uid.js"),E=B("keys");y.exports=function(R){return E[R]||(E[R]=I(R))}},"./node_modules/core-js/internals/shared-store.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/set-global.js"),E="__core-js_shared__",R=B[E]||I(E,{});y.exports=R},"./node_modules/core-js/internals/shared.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-pure.js"),I=_("./node_modules/core-js/internals/shared-store.js");(y.exports=function(E,R){return I[E]||(I[E]=R!==void 0?R:{})})("versions",[]).push({version:"3.16.0",mode:B?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/internals/string-html-forced.js":function(y,b,_){var B=_("./node_modules/core-js/internals/fails.js");y.exports=function(I){return B(function(){var E=""[I]('"');return E!==E.toLowerCase()||E.split('"').length>3})}},"./node_modules/core-js/internals/string-multibyte.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-integer.js"),I=_("./node_modules/core-js/internals/to-string.js"),E=_("./node_modules/core-js/internals/require-object-coercible.js"),R=function(M){return function(G,U){var Q=I(E(G)),q=B(U),ne=Q.length,re,pe;return q<0||q>=ne?M?"":void 0:(re=Q.charCodeAt(q),re<55296||re>56319||q+1===ne||(pe=Q.charCodeAt(q+1))<56320||pe>57343?M?Q.charAt(q):re:M?Q.slice(q,q+2):(re-55296<<10)+(pe-56320)+65536)}};y.exports={codeAt:R(!1),charAt:R(!0)}},"./node_modules/core-js/internals/string-trim.js":function(y,b,_){var B=_("./node_modules/core-js/internals/require-object-coercible.js"),I=_("./node_modules/core-js/internals/to-string.js"),E=_("./node_modules/core-js/internals/whitespaces.js"),R="["+E+"]",M=RegExp("^"+R+R+"*"),G=RegExp(R+R+"*$"),U=function(Q){return function(q){var ne=I(B(q));return Q&1&&(ne=ne.replace(M,"")),Q&2&&(ne=ne.replace(G,"")),ne}};y.exports={start:U(1),end:U(2),trim:U(3)}},"./node_modules/core-js/internals/to-absolute-index.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-integer.js"),I=Math.max,E=Math.min;y.exports=function(R,M){var G=B(R);return G<0?I(G+M,0):E(G,M)}},"./node_modules/core-js/internals/to-indexed-object.js":function(y,b,_){var B=_("./node_modules/core-js/internals/indexed-object.js"),I=_("./node_modules/core-js/internals/require-object-coercible.js");y.exports=function(E){return B(I(E))}},"./node_modules/core-js/internals/to-integer.js":function(y){var b=Math.ceil,_=Math.floor;y.exports=function(B){return isNaN(B=+B)?0:(B>0?_:b)(B)}},"./node_modules/core-js/internals/to-length.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-integer.js"),I=Math.min;y.exports=function(E){return E>0?I(B(E),9007199254740991):0}},"./node_modules/core-js/internals/to-object.js":function(y,b,_){var B=_("./node_modules/core-js/internals/require-object-coercible.js");y.exports=function(I){return Object(B(I))}},"./node_modules/core-js/internals/to-primitive.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-object.js"),I=_("./node_modules/core-js/internals/is-symbol.js"),E=_("./node_modules/core-js/internals/ordinary-to-primitive.js"),R=_("./node_modules/core-js/internals/well-known-symbol.js"),M=R("toPrimitive");y.exports=function(G,U){if(!B(G)||I(G))return G;var Q=G[M],q;if(Q!==void 0){if(U===void 0&&(U="default"),q=Q.call(G,U),!B(q)||I(q))return q;throw TypeError("Can't convert object to primitive value")}return U===void 0&&(U="number"),E(G,U)}},"./node_modules/core-js/internals/to-property-key.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-primitive.js"),I=_("./node_modules/core-js/internals/is-symbol.js");y.exports=function(E){var R=B(E,"string");return I(R)?R:String(R)}},"./node_modules/core-js/internals/to-string-tag-support.js":function(y,b,_){var B=_("./node_modules/core-js/internals/well-known-symbol.js"),I=B("toStringTag"),E={};E[I]="z",y.exports=String(E)==="[object z]"},"./node_modules/core-js/internals/to-string.js":function(y,b,_){var B=_("./node_modules/core-js/internals/is-symbol.js");y.exports=function(I){if(B(I))throw TypeError("Cannot convert a Symbol value to a string");return String(I)}},"./node_modules/core-js/internals/uid.js":function(y){var b=0,_=Math.random();y.exports=function(B){return"Symbol("+String(B===void 0?"":B)+")_"+(++b+_).toString(36)}},"./node_modules/core-js/internals/use-symbol-as-uid.js":function(y,b,_){var B=_("./node_modules/core-js/internals/native-symbol.js");y.exports=B&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},"./node_modules/core-js/internals/well-known-symbol-wrapped.js":function(y,b,_){var B=_("./node_modules/core-js/internals/well-known-symbol.js");b.f=B},"./node_modules/core-js/internals/well-known-symbol.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/shared.js"),E=_("./node_modules/core-js/internals/has.js"),R=_("./node_modules/core-js/internals/uid.js"),M=_("./node_modules/core-js/internals/native-symbol.js"),G=_("./node_modules/core-js/internals/use-symbol-as-uid.js"),U=I("wks"),Q=B.Symbol,q=G?Q:Q&&Q.withoutSetter||R;y.exports=function(ne){return(!E(U,ne)||!(M||typeof U[ne]=="string"))&&(M&&E(Q,ne)?U[ne]=Q[ne]:U[ne]=q("Symbol."+ne)),U[ne]}},"./node_modules/core-js/internals/whitespaces.js":function(y){y.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},"./node_modules/core-js/modules/es.array.concat.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/fails.js"),E=_("./node_modules/core-js/internals/is-array.js"),R=_("./node_modules/core-js/internals/is-object.js"),M=_("./node_modules/core-js/internals/to-object.js"),G=_("./node_modules/core-js/internals/to-length.js"),U=_("./node_modules/core-js/internals/create-property.js"),Q=_("./node_modules/core-js/internals/array-species-create.js"),q=_("./node_modules/core-js/internals/array-method-has-species-support.js"),ne=_("./node_modules/core-js/internals/well-known-symbol.js"),re=_("./node_modules/core-js/internals/engine-v8-version.js"),pe=ne("isConcatSpreadable"),Ae=9007199254740991,le="Maximum allowed index exceeded",be=re>=51||!I(function(){var Le=[];return Le[pe]=!1,Le.concat()[0]!==Le}),we=q("concat"),oe=function(Le){if(!R(Le))return!1;var Se=Le[pe];return Se!==void 0?!!Se:E(Le)},me=!be||!we;B({target:"Array",proto:!0,forced:me},{concat:function(Se){var Me=M(this),Re=Q(Me,0),Ze=0,$e,ct,Qe,It,Ce;for($e=-1,Qe=arguments.length;$e<Qe;$e++)if(Ce=$e===-1?Me:arguments[$e],oe(Ce)){if(It=G(Ce.length),Ze+It>Ae)throw TypeError(le);for(ct=0;ct<It;ct++,Ze++)ct in Ce&&U(Re,Ze,Ce[ct])}else{if(Ze>=Ae)throw TypeError(le);U(Re,Ze++,Ce)}return Re.length=Ze,Re}})},"./node_modules/core-js/modules/es.array.iterator.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-indexed-object.js"),I=_("./node_modules/core-js/internals/add-to-unscopables.js"),E=_("./node_modules/core-js/internals/iterators.js"),R=_("./node_modules/core-js/internals/internal-state.js"),M=_("./node_modules/core-js/internals/define-iterator.js"),G="Array Iterator",U=R.set,Q=R.getterFor(G);y.exports=M(Array,"Array",function(q,ne){U(this,{type:G,target:B(q),index:0,kind:ne})},function(){var q=Q(this),ne=q.target,re=q.kind,pe=q.index++;return!ne||pe>=ne.length?(q.target=void 0,{value:void 0,done:!0}):re=="keys"?{value:pe,done:!1}:re=="values"?{value:ne[pe],done:!1}:{value:[pe,ne[pe]],done:!1}},"values"),E.Arguments=E.Array,I("keys"),I("values"),I("entries")},"./node_modules/core-js/modules/es.array.join.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/indexed-object.js"),E=_("./node_modules/core-js/internals/to-indexed-object.js"),R=_("./node_modules/core-js/internals/array-method-is-strict.js"),M=[].join,G=I!=Object,U=R("join",",");B({target:"Array",proto:!0,forced:G||!U},{join:function(q){return M.call(E(this),q===void 0?",":q)}})},"./node_modules/core-js/modules/es.array.map.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/array-iteration.js").map,E=_("./node_modules/core-js/internals/array-method-has-species-support.js"),R=E("map");B({target:"Array",proto:!0,forced:!R},{map:function(G){return I(this,G,arguments.length>1?arguments[1]:void 0)}})},"./node_modules/core-js/modules/es.array.slice.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/is-object.js"),E=_("./node_modules/core-js/internals/is-array.js"),R=_("./node_modules/core-js/internals/to-absolute-index.js"),M=_("./node_modules/core-js/internals/to-length.js"),G=_("./node_modules/core-js/internals/to-indexed-object.js"),U=_("./node_modules/core-js/internals/create-property.js"),Q=_("./node_modules/core-js/internals/well-known-symbol.js"),q=_("./node_modules/core-js/internals/array-method-has-species-support.js"),ne=q("slice"),re=Q("species"),pe=[].slice,Ae=Math.max;B({target:"Array",proto:!0,forced:!ne},{slice:function(be,we){var oe=G(this),me=M(oe.length),Le=R(be,me),Se=R(we===void 0?me:we,me),Me,Re,Ze;if(E(oe)&&(Me=oe.constructor,typeof Me=="function"&&(Me===Array||E(Me.prototype))?Me=void 0:I(Me)&&(Me=Me[re],Me===null&&(Me=void 0)),Me===Array||Me===void 0))return pe.call(oe,Le,Se);for(Re=new(Me===void 0?Array:Me)(Ae(Se-Le,0)),Ze=0;Le<Se;Le++,Ze++)Le in oe&&U(Re,Ze,oe[Le]);return Re.length=Ze,Re}})},"./node_modules/core-js/modules/es.function.name.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/object-define-property.js").f,E=Function.prototype,R=E.toString,M=/^\s*function ([^ (]*)/,G="name";B&&!(G in E)&&I(E,G,{configurable:!0,get:function(){try{return R.call(this).match(M)[1]}catch{return""}}})},"./node_modules/core-js/modules/es.number.constructor.js":function(y,b,_){var B=_("./node_modules/core-js/internals/descriptors.js"),I=_("./node_modules/core-js/internals/global.js"),E=_("./node_modules/core-js/internals/is-forced.js"),R=_("./node_modules/core-js/internals/redefine.js"),M=_("./node_modules/core-js/internals/has.js"),G=_("./node_modules/core-js/internals/classof-raw.js"),U=_("./node_modules/core-js/internals/inherit-if-required.js"),Q=_("./node_modules/core-js/internals/is-symbol.js"),q=_("./node_modules/core-js/internals/to-primitive.js"),ne=_("./node_modules/core-js/internals/fails.js"),re=_("./node_modules/core-js/internals/object-create.js"),pe=_("./node_modules/core-js/internals/object-get-own-property-names.js").f,Ae=_("./node_modules/core-js/internals/object-get-own-property-descriptor.js").f,le=_("./node_modules/core-js/internals/object-define-property.js").f,be=_("./node_modules/core-js/internals/string-trim.js").trim,we="Number",oe=I[we],me=oe.prototype,Le=G(re(me))==we,Se=function(ct){if(Q(ct))throw TypeError("Cannot convert a Symbol value to a number");var Qe=q(ct,"number"),It,Ce,Je,lt,mt,Bt,rt,St;if(typeof Qe=="string"&&Qe.length>2){if(Qe=be(Qe),It=Qe.charCodeAt(0),It===43||It===45){if(Ce=Qe.charCodeAt(2),Ce===88||Ce===120)return NaN}else if(It===48){switch(Qe.charCodeAt(1)){case 66:case 98:Je=2,lt=49;break;case 79:case 111:Je=8,lt=55;break;default:return+Qe}for(mt=Qe.slice(2),Bt=mt.length,rt=0;rt<Bt;rt++)if(St=mt.charCodeAt(rt),St<48||St>lt)return NaN;return parseInt(mt,Je)}}return+Qe};if(E(we,!oe(" 0o1")||!oe("0b1")||oe("+0x1"))){for(var Me=function(Qe){var It=arguments.length<1?0:Qe,Ce=this;return Ce instanceof Me&&(Le?ne(function(){me.valueOf.call(Ce)}):G(Ce)!=we)?U(new oe(Se(It)),Ce,Me):Se(It)},Re=B?pe(oe):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Ze=0,$e;Re.length>Ze;Ze++)M(oe,$e=Re[Ze])&&!M(Me,$e)&&le(Me,$e,Ae(oe,$e));Me.prototype=me,me.constructor=Me,R(I,we,Me)}},"./node_modules/core-js/modules/es.object.assign.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/object-assign.js");B({target:"Object",stat:!0,forced:Object.assign!==I},{assign:I})},"./node_modules/core-js/modules/es.object.keys.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/to-object.js"),E=_("./node_modules/core-js/internals/object-keys.js"),R=_("./node_modules/core-js/internals/fails.js"),M=R(function(){E(1)});B({target:"Object",stat:!0,forced:M},{keys:function(U){return E(I(U))}})},"./node_modules/core-js/modules/es.object.to-string.js":function(y,b,_){var B=_("./node_modules/core-js/internals/to-string-tag-support.js"),I=_("./node_modules/core-js/internals/redefine.js"),E=_("./node_modules/core-js/internals/object-to-string.js");B||I(Object.prototype,"toString",E,{unsafe:!0})},"./node_modules/core-js/modules/es.regexp.to-string.js":function(y,b,_){var B=_("./node_modules/core-js/internals/redefine.js"),I=_("./node_modules/core-js/internals/an-object.js"),E=_("./node_modules/core-js/internals/to-string.js"),R=_("./node_modules/core-js/internals/fails.js"),M=_("./node_modules/core-js/internals/regexp-flags.js"),G="toString",U=RegExp.prototype,Q=U[G],q=R(function(){return Q.call({source:"a",flags:"b"})!="/a/b"}),ne=Q.name!=G;(q||ne)&&B(RegExp.prototype,G,function(){var pe=I(this),Ae=E(pe.source),le=pe.flags,be=E(le===void 0&&pe instanceof RegExp&&!("flags"in U)?M.call(pe):le);return"/"+Ae+"/"+be},{unsafe:!0})},"./node_modules/core-js/modules/es.string.iterator.js":function(y,b,_){var B=_("./node_modules/core-js/internals/string-multibyte.js").charAt,I=_("./node_modules/core-js/internals/to-string.js"),E=_("./node_modules/core-js/internals/internal-state.js"),R=_("./node_modules/core-js/internals/define-iterator.js"),M="String Iterator",G=E.set,U=E.getterFor(M);R(String,"String",function(Q){G(this,{type:M,string:I(Q),index:0})},function(){var q=U(this),ne=q.string,re=q.index,pe;return re>=ne.length?{value:void 0,done:!0}:(pe=B(ne,re),q.index+=pe.length,{value:pe,done:!1})})},"./node_modules/core-js/modules/es.string.link.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/create-html.js"),E=_("./node_modules/core-js/internals/string-html-forced.js");B({target:"String",proto:!0,forced:E("link")},{link:function(M){return I(this,"a","href",M)}})},"./node_modules/core-js/modules/es.symbol.description.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/descriptors.js"),E=_("./node_modules/core-js/internals/global.js"),R=_("./node_modules/core-js/internals/has.js"),M=_("./node_modules/core-js/internals/is-object.js"),G=_("./node_modules/core-js/internals/object-define-property.js").f,U=_("./node_modules/core-js/internals/copy-constructor-properties.js"),Q=E.Symbol;if(I&&typeof Q=="function"&&(!("description"in Q.prototype)||Q().description!==void 0)){var q={},ne=function(){var we=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),oe=this instanceof ne?new Q(we):we===void 0?Q():Q(we);return we===""&&(q[oe]=!0),oe};U(ne,Q);var re=ne.prototype=Q.prototype;re.constructor=ne;var pe=re.toString,Ae=String(Q("test"))=="Symbol(test)",le=/^Symbol\((.*)\)[^)]+$/;G(re,"description",{configurable:!0,get:function(){var we=M(this)?this.valueOf():this,oe=pe.call(we);if(R(q,we))return"";var me=Ae?oe.slice(7,-1):oe.replace(le,"$1");return me===""?void 0:me}}),B({global:!0,forced:!0},{Symbol:ne})}},"./node_modules/core-js/modules/es.symbol.iterator.js":function(y,b,_){var B=_("./node_modules/core-js/internals/define-well-known-symbol.js");B("iterator")},"./node_modules/core-js/modules/es.symbol.js":function(y,b,_){var B=_("./node_modules/core-js/internals/export.js"),I=_("./node_modules/core-js/internals/global.js"),E=_("./node_modules/core-js/internals/get-built-in.js"),R=_("./node_modules/core-js/internals/is-pure.js"),M=_("./node_modules/core-js/internals/descriptors.js"),G=_("./node_modules/core-js/internals/native-symbol.js"),U=_("./node_modules/core-js/internals/fails.js"),Q=_("./node_modules/core-js/internals/has.js"),q=_("./node_modules/core-js/internals/is-array.js"),ne=_("./node_modules/core-js/internals/is-object.js"),re=_("./node_modules/core-js/internals/is-symbol.js"),pe=_("./node_modules/core-js/internals/an-object.js"),Ae=_("./node_modules/core-js/internals/to-object.js"),le=_("./node_modules/core-js/internals/to-indexed-object.js"),be=_("./node_modules/core-js/internals/to-property-key.js"),we=_("./node_modules/core-js/internals/to-string.js"),oe=_("./node_modules/core-js/internals/create-property-descriptor.js"),me=_("./node_modules/core-js/internals/object-create.js"),Le=_("./node_modules/core-js/internals/object-keys.js"),Se=_("./node_modules/core-js/internals/object-get-own-property-names.js"),Me=_("./node_modules/core-js/internals/object-get-own-property-names-external.js"),Re=_("./node_modules/core-js/internals/object-get-own-property-symbols.js"),Ze=_("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),$e=_("./node_modules/core-js/internals/object-define-property.js"),ct=_("./node_modules/core-js/internals/object-property-is-enumerable.js"),Qe=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),It=_("./node_modules/core-js/internals/redefine.js"),Ce=_("./node_modules/core-js/internals/shared.js"),Je=_("./node_modules/core-js/internals/shared-key.js"),lt=_("./node_modules/core-js/internals/hidden-keys.js"),mt=_("./node_modules/core-js/internals/uid.js"),Bt=_("./node_modules/core-js/internals/well-known-symbol.js"),rt=_("./node_modules/core-js/internals/well-known-symbol-wrapped.js"),St=_("./node_modules/core-js/internals/define-well-known-symbol.js"),vt=_("./node_modules/core-js/internals/set-to-string-tag.js"),Gt=_("./node_modules/core-js/internals/internal-state.js"),mi=_("./node_modules/core-js/internals/array-iteration.js").forEach,ze=Je("hidden"),Ve="Symbol",kt="prototype",Ft=Bt("toPrimitive"),it=Gt.set,yi=Gt.getterFor(Ve),bi=Object[kt],Kt=I.Symbol,di=E("JSON","stringify"),fi=Ze.f,Ri=$e.f,Oi=Me.f,Ji=ct.f,lr=Ce("symbols"),br=Ce("op-symbols"),Dr=Ce("string-to-symbol-registry"),Fr=Ce("symbol-to-string-registry"),Qr=Ce("wks"),ui=I.QObject,li=!ui||!ui[kt]||!ui[kt].findChild,Vi=M&&U(function(){return me(Ri({},"a",{get:function(){return Ri(this,"a",{value:7}).a}})).a!=7})?function(Qn,Lr,yr){var qt=fi(bi,Lr);qt&&delete bi[Lr],Ri(Qn,Lr,yr),qt&&Qn!==bi&&Ri(bi,Lr,qt)}:Ri,rr=function(Qn,Lr){var yr=lr[Qn]=me(Kt[kt]);return it(yr,{type:Ve,tag:Qn,description:Lr}),M||(yr.description=Lr),yr},qr=function(Lr,yr,qt){Lr===bi&&qr(br,yr,qt),pe(Lr);var Vn=be(yr);return pe(qt),Q(lr,Vn)?(qt.enumerable?(Q(Lr,ze)&&Lr[ze][Vn]&&(Lr[ze][Vn]=!1),qt=me(qt,{enumerable:oe(0,!1)})):(Q(Lr,ze)||Ri(Lr,ze,oe(1,{})),Lr[ze][Vn]=!0),Vi(Lr,Vn,qt)):Ri(Lr,Vn,qt)},_r=function(Lr,yr){pe(Lr);var qt=le(yr),Vn=Le(qt).concat(ps(qt));return mi(Vn,function(xs){(!M||io.call(qt,xs))&&qr(Lr,xs,qt[xs])}),Lr},Zr=function(Lr,yr){return yr===void 0?me(Lr):_r(me(Lr),yr)},io=function(Lr){var yr=be(Lr),qt=Ji.call(this,yr);return this===bi&&Q(lr,yr)&&!Q(br,yr)?!1:qt||!Q(this,yr)||!Q(lr,yr)||Q(this,ze)&&this[ze][yr]?qt:!0},Ur=function(Lr,yr){var qt=le(Lr),Vn=be(yr);if(!(qt===bi&&Q(lr,Vn)&&!Q(br,Vn))){var xs=fi(qt,Vn);return xs&&Q(lr,Vn)&&!(Q(qt,ze)&&qt[ze][Vn])&&(xs.enumerable=!0),xs}},ia=function(Lr){var yr=Oi(le(Lr)),qt=[];return mi(yr,function(Vn){!Q(lr,Vn)&&!Q(lt,Vn)&&qt.push(Vn)}),qt},ps=function(Lr){var yr=Lr===bi,qt=Oi(yr?br:le(Lr)),Vn=[];return mi(qt,function(xs){Q(lr,xs)&&(!yr||Q(bi,xs))&&Vn.push(lr[xs])}),Vn};if(G||(Kt=function(){if(this instanceof Kt)throw TypeError("Symbol is not a constructor");var Lr=!arguments.length||arguments[0]===void 0?void 0:we(arguments[0]),yr=mt(Lr),qt=function(Vn){this===bi&&qt.call(br,Vn),Q(this,ze)&&Q(this[ze],yr)&&(this[ze][yr]=!1),Vi(this,yr,oe(1,Vn))};return M&&li&&Vi(bi,yr,{configurable:!0,set:qt}),rr(yr,Lr)},It(Kt[kt],"toString",function(){return yi(this).tag}),It(Kt,"withoutSetter",function(Qn){return rr(mt(Qn),Qn)}),ct.f=io,$e.f=qr,Ze.f=Ur,Se.f=Me.f=ia,Re.f=ps,rt.f=function(Qn){return rr(Bt(Qn),Qn)},M&&(Ri(Kt[kt],"description",{configurable:!0,get:function(){return yi(this).description}}),R||It(bi,"propertyIsEnumerable",io,{unsafe:!0}))),B({global:!0,wrap:!0,forced:!G,sham:!G},{Symbol:Kt}),mi(Le(Qr),function(Qn){St(Qn)}),B({target:Ve,stat:!0,forced:!G},{for:function(Qn){var Lr=we(Qn);if(Q(Dr,Lr))return Dr[Lr];var yr=Kt(Lr);return Dr[Lr]=yr,Fr[yr]=Lr,yr},keyFor:function(Lr){if(!re(Lr))throw TypeError(Lr+" is not a symbol");if(Q(Fr,Lr))return Fr[Lr]},useSetter:function(){li=!0},useSimple:function(){li=!1}}),B({target:"Object",stat:!0,forced:!G,sham:!M},{create:Zr,defineProperty:qr,defineProperties:_r,getOwnPropertyDescriptor:Ur}),B({target:"Object",stat:!0,forced:!G},{getOwnPropertyNames:ia,getOwnPropertySymbols:ps}),B({target:"Object",stat:!0,forced:U(function(){Re.f(1)})},{getOwnPropertySymbols:function(Lr){return Re.f(Ae(Lr))}}),di){var ro=!G||U(function(){var Qn=Kt();return di([Qn])!="[null]"||di({a:Qn})!="{}"||di(Object(Qn))!="{}"});B({target:"JSON",stat:!0,forced:ro},{stringify:function(Lr,yr,qt){for(var Vn=[Lr],xs=1,ra;arguments.length>xs;)Vn.push(arguments[xs++]);if(ra=yr,!(!ne(yr)&&Lr===void 0||re(Lr)))return q(yr)||(yr=function(dn,Et){if(typeof ra=="function"&&(Et=ra.call(this,dn,Et)),!re(Et))return Et}),Vn[1]=yr,di.apply(null,Vn)}})}Kt[kt][Ft]||Qe(Kt[kt],Ft,Kt[kt].valueOf),vt(Kt,Ve),lt[ze]=!0},"./node_modules/core-js/modules/web.dom-collections.for-each.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/dom-iterables.js"),E=_("./node_modules/core-js/internals/array-for-each.js"),R=_("./node_modules/core-js/internals/create-non-enumerable-property.js");for(var M in I){var G=B[M],U=G&&G.prototype;if(U&&U.forEach!==E)try{R(U,"forEach",E)}catch{U.forEach=E}}},"./node_modules/core-js/modules/web.dom-collections.iterator.js":function(y,b,_){var B=_("./node_modules/core-js/internals/global.js"),I=_("./node_modules/core-js/internals/dom-iterables.js"),E=_("./node_modules/core-js/modules/es.array.iterator.js"),R=_("./node_modules/core-js/internals/create-non-enumerable-property.js"),M=_("./node_modules/core-js/internals/well-known-symbol.js"),G=M("iterator"),U=M("toStringTag"),Q=E.values;for(var q in I){var ne=B[q],re=ne&&ne.prototype;if(re){if(re[G]!==Q)try{R(re,G,Q)}catch{re[G]=Q}if(re[U]||R(re,U,q),I[q]){for(var pe in E)if(re[pe]!==E[pe])try{R(re,pe,E[pe])}catch{re[pe]=E[pe]}}}}},"./node_modules/es6-promise/dist/es6-promise.js":function(y){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(b,_){y.exports=_()})(this,function(){function b(ui){var li=typeof ui;return ui!==null&&(li==="object"||li==="function")}function _(ui){return typeof ui=="function"}var B=void 0;Array.isArray?B=Array.isArray:B=function(ui){return Object.prototype.toString.call(ui)==="[object Array]"};var I=B,E=0,R=void 0,M=void 0,G=function(li,Vi){Le[E]=li,Le[E+1]=Vi,E+=2,E===2&&(M?M(Se):Re())};function U(ui){M=ui}function Q(ui){G=ui}var q=typeof window<"u"?window:void 0,ne=q||{},re=ne.MutationObserver||ne.WebKitMutationObserver,pe=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",Ae=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function le(){return function(){return process.nextTick(Se)}}function be(){return typeof R<"u"?function(){R(Se)}:me()}function we(){var ui=0,li=new re(Se),Vi=document.createTextNode("");return li.observe(Vi,{characterData:!0}),function(){Vi.data=ui=++ui%2}}function oe(){var ui=new MessageChannel;return ui.port1.onmessage=Se,function(){return ui.port2.postMessage(0)}}function me(){var ui=setTimeout;return function(){return ui(Se,1)}}var Le=new Array(1e3);function Se(){for(var ui=0;ui<E;ui+=2){var li=Le[ui],Vi=Le[ui+1];li(Vi),Le[ui]=void 0,Le[ui+1]=void 0}E=0}function Me(){try{var ui=Function("return this")().require("vertx");return R=ui.runOnLoop||ui.runOnContext,be()}catch{return me()}}var Re=void 0;pe?Re=le():re?Re=we():Ae?Re=oe():q===void 0?Re=Me():Re=me();function Ze(ui,li){var Vi=this,rr=new this.constructor(Qe);rr[ct]===void 0&&di(rr);var qr=Vi._state;if(qr){var _r=arguments[qr-1];G(function(){return it(qr,rr,_r,Vi._result)})}else kt(Vi,rr,ui,li);return rr}function $e(ui){var li=this;if(ui&&typeof ui=="object"&&ui.constructor===li)return ui;var Vi=new li(Qe);return Gt(Vi,ui),Vi}var ct=Math.random().toString(36).substring(2);function Qe(){}var It=void 0,Ce=1,Je=2;function lt(){return new TypeError("You cannot resolve a promise with itself")}function mt(){return new TypeError("A promises callback cannot return that same promise.")}function Bt(ui,li,Vi,rr){try{ui.call(li,Vi,rr)}catch(qr){return qr}}function rt(ui,li,Vi){G(function(rr){var qr=!1,_r=Bt(Vi,li,function(Zr){qr||(qr=!0,li!==Zr?Gt(rr,Zr):ze(rr,Zr))},function(Zr){qr||(qr=!0,Ve(rr,Zr))},"Settle: "+(rr._label||" unknown promise"));!qr&&_r&&(qr=!0,Ve(rr,_r))},ui)}function St(ui,li){li._state===Ce?ze(ui,li._result):li._state===Je?Ve(ui,li._result):kt(li,void 0,function(Vi){return Gt(ui,Vi)},function(Vi){return Ve(ui,Vi)})}function vt(ui,li,Vi){li.constructor===ui.constructor&&Vi===Ze&&li.constructor.resolve===$e?St(ui,li):Vi===void 0?ze(ui,li):_(Vi)?rt(ui,li,Vi):ze(ui,li)}function Gt(ui,li){if(ui===li)Ve(ui,lt());else if(b(li)){var Vi=void 0;try{Vi=li.then}catch(rr){Ve(ui,rr);return}vt(ui,li,Vi)}else ze(ui,li)}function mi(ui){ui._onerror&&ui._onerror(ui._result),Ft(ui)}function ze(ui,li){ui._state===It&&(ui._result=li,ui._state=Ce,ui._subscribers.length!==0&&G(Ft,ui))}function Ve(ui,li){ui._state===It&&(ui._state=Je,ui._result=li,G(mi,ui))}function kt(ui,li,Vi,rr){var qr=ui._subscribers,_r=qr.length;ui._onerror=null,qr[_r]=li,qr[_r+Ce]=Vi,qr[_r+Je]=rr,_r===0&&ui._state&&G(Ft,ui)}function Ft(ui){var li=ui._subscribers,Vi=ui._state;if(li.length!==0){for(var rr=void 0,qr=void 0,_r=ui._result,Zr=0;Zr<li.length;Zr+=3)rr=li[Zr],qr=li[Zr+Vi],rr?it(Vi,rr,qr,_r):qr(_r);ui._subscribers.length=0}}function it(ui,li,Vi,rr){var qr=_(Vi),_r=void 0,Zr=void 0,io=!0;if(qr){try{_r=Vi(rr)}catch(Ur){io=!1,Zr=Ur}if(li===_r){Ve(li,mt());return}}else _r=rr;li._state!==It||(qr&&io?Gt(li,_r):io===!1?Ve(li,Zr):ui===Ce?ze(li,_r):ui===Je&&Ve(li,_r))}function yi(ui,li){try{li(function(rr){Gt(ui,rr)},function(rr){Ve(ui,rr)})}catch(Vi){Ve(ui,Vi)}}var bi=0;function Kt(){return bi++}function di(ui){ui[ct]=bi++,ui._state=void 0,ui._result=void 0,ui._subscribers=[]}function fi(){return new Error("Array Methods must be provided an Array")}var Ri=function(){function ui(li,Vi){this._instanceConstructor=li,this.promise=new li(Qe),this.promise[ct]||di(this.promise),I(Vi)?(this.length=Vi.length,this._remaining=Vi.length,this._result=new Array(this.length),this.length===0?ze(this.promise,this._result):(this.length=this.length||0,this._enumerate(Vi),this._remaining===0&&ze(this.promise,this._result))):Ve(this.promise,fi())}return ui.prototype._enumerate=function(Vi){for(var rr=0;this._state===It&&rr<Vi.length;rr++)this._eachEntry(Vi[rr],rr)},ui.prototype._eachEntry=function(Vi,rr){var qr=this._instanceConstructor,_r=qr.resolve;if(_r===$e){var Zr=void 0,io=void 0,Ur=!1;try{Zr=Vi.then}catch(ps){Ur=!0,io=ps}if(Zr===Ze&&Vi._state!==It)this._settledAt(Vi._state,rr,Vi._result);else if(typeof Zr!="function")this._remaining--,this._result[rr]=Vi;else if(qr===Fr){var ia=new qr(Qe);Ur?Ve(ia,io):vt(ia,Vi,Zr),this._willSettleAt(ia,rr)}else this._willSettleAt(new qr(function(ps){return ps(Vi)}),rr)}else this._willSettleAt(_r(Vi),rr)},ui.prototype._settledAt=function(Vi,rr,qr){var _r=this.promise;_r._state===It&&(this._remaining--,Vi===Je?Ve(_r,qr):this._result[rr]=qr),this._remaining===0&&ze(_r,this._result)},ui.prototype._willSettleAt=function(Vi,rr){var qr=this;kt(Vi,void 0,function(_r){return qr._settledAt(Ce,rr,_r)},function(_r){return qr._settledAt(Je,rr,_r)})},ui}();function Oi(ui){return new Ri(this,ui).promise}function Ji(ui){var li=this;return I(ui)?new li(function(Vi,rr){for(var qr=ui.length,_r=0;_r<qr;_r++)li.resolve(ui[_r]).then(Vi,rr)}):new li(function(Vi,rr){return rr(new TypeError("You must pass an array to race."))})}function lr(ui){var li=this,Vi=new li(Qe);return Ve(Vi,ui),Vi}function br(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Dr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Fr=function(){function ui(li){this[ct]=Kt(),this._result=this._state=void 0,this._subscribers=[],Qe!==li&&(typeof li!="function"&&br(),this instanceof ui?yi(this,li):Dr())}return ui.prototype.catch=function(Vi){return this.then(null,Vi)},ui.prototype.finally=function(Vi){var rr=this,qr=rr.constructor;return _(Vi)?rr.then(function(_r){return qr.resolve(Vi()).then(function(){return _r})},function(_r){return qr.resolve(Vi()).then(function(){throw _r})}):rr.then(Vi,Vi)},ui}();Fr.prototype.then=Ze,Fr.all=Oi,Fr.race=Ji,Fr.resolve=$e,Fr.reject=lr,Fr._setScheduler=U,Fr._setAsap=Q,Fr._asap=G;function Qr(){var ui=void 0;if(typeof h0<"u")ui=h0;else if(typeof self<"u")ui=self;else try{ui=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var li=ui.Promise;if(li){var Vi=null;try{Vi=Object.prototype.toString.call(li.resolve())}catch{}if(Vi==="[object Promise]"&&!li.cast)return}ui.Promise=Fr}return Fr.polyfill=Qr,Fr.Promise=Fr,Fr})},html2canvas:function(y){y.exports=s},jspdf:function(y){y.exports=t}},h={};function A(y){var b=h[y];if(b!==void 0)return b.exports;var _=h[y]={exports:{}};return c[y].call(_.exports,_,_.exports,A),_.exports}(function(){A.n=function(y){var b=y&&y.__esModule?function(){return y.default}:function(){return y};return A.d(b,{a:b}),b}})(),function(){A.d=function(y,b){for(var _ in b)A.o(b,_)&&!A.o(y,_)&&Object.defineProperty(y,_,{enumerable:!0,get:b[_]})}}(),function(){A.o=function(y,b){return Object.prototype.hasOwnProperty.call(y,b)}}(),function(){A.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})}}();var r={};return function(){/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/A.r(r);var y=A("./src/worker.js");A("./src/plugin/jspdf-plugin.js"),A("./src/plugin/pagebreaks.js"),A("./src/plugin/hyperlinks.js");var b=function _(B,I){var E=new _.Worker(I);return B?E.from(B).save():E};b.Worker=y.default,r.default=b}(),r=r.default,r}()})}(vb)),vb.exports}var Hz=jz();const Qz=Z1(Hz),Vz={class:"estadisticas-dashboard"},Gz={class:"barra-controles"},Wz={class:"controles"},Xz={class:"rango-fechas"},Yz={class:"kpi-grid"},Kz={class:"valor"},qz={class:"descripcion"},$z={class:"graficos"},Zz={__name:"Estadisticas",setup(a){const e=sr("energia"),t=sr(ba().subtract(7,"day").format("YYYY-MM-DD")),s=sr(ba().format("YYYY-MM-DD")),c=[{value:"energia",label:"Energía activa (kWh)",unidad:"kWh"},{value:"voltajeA",label:"Voltaje A (V)",unidad:"V"},{value:"corrienteB",label:"Corriente B (A)",unidad:"A"},{value:"potenciaTotal",label:"Potencia activa total (kW)",unidad:"kW"}],h=sr("kWh"),A=sr({}),r=sr({options:{},series:[]}),y=sr({options:{},series:[]}),b=sr({options:{},series:[]}),_=sr({options:{},series:[]}),B=sr({options:{},series:[]}),I=sr({options:{},series:[]});function E(){const U=[["Métrica","Valor"]];for(const pe in A.value)U.push([A.value[pe].desc,A.value[pe].label]);const Q=U.map(pe=>pe.join(",")).join(`
`),q=new Blob([Q],{type:"text/csv"}),ne=URL.createObjectURL(q),re=document.createElement("a");re.href=ne,re.download=`estadisticas_${e.value}.csv`,re.click(),URL.revokeObjectURL(ne)}function R(){const U=document.querySelector(".estadisticas-dashboard");Qz().set({margin:.5,filename:`estadisticas_${e.value}.pdf`,html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}}).from(U).save()}function M(){var ne,re,pe,Ae;const U=parseFloat(((ne=A.value.p95)==null?void 0:ne.label)||0),Q=parseFloat(((re=A.value.prom)==null?void 0:re.label)||0),q=parseFloat(((Ae=(pe=A.value.factorCarga)==null?void 0:pe.label)==null?void 0:Ae.replace("%",""))||0);U>Q*1.5?alert("⚠️ Advertencia: el parámetro muestra picos estadísticos elevados. Verifica anomalías o sobrecargas."):q<40?alert("💡 Bajo factor de carga: podrías optimizar la distribución del consumo."):alert("✅ El comportamiento estadístico del parámetro es estable.")}function G(){const U=c.find(be=>be.value===e.value);h.value=U.unidad;const Q=Array.from({length:100},()=>+(Math.random()*40+10).toFixed(1)).sort((be,we)=>be-we),q=Q.reduce((be,we)=>be+we,0),ne=+(q/Q.length).toFixed(1),re=Q[0],pe=Q[Q.length-1],Ae=Q[Math.floor(.05*Q.length)],le=Q[Math.floor(.95*Q.length)];A.value={min:{label:`${re}`,desc:"Mínimo observado"},max:{label:`${pe}`,desc:"Máximo observado"},prom:{label:`${ne}`,desc:"Promedio del periodo"},p95:{label:`${le}`,desc:"Percentil 95"},p5:{label:`${Ae}`,desc:"Percentil 5"},total:{label:`${+q.toFixed(1)}`,desc:"Total del periodo"},pico:{label:`${pe}`,desc:`Pico simulado a las ${Math.floor(Math.random()*24)}:00`},cargaBase:{label:`${Ae}`,desc:"Carga base estimada"},factorCarga:{label:`${+(ne/pe*100).toFixed(0)}%`,desc:"Factor carga estimado"}},r.value={options:{chart:{id:"histograma"},xaxis:{categories:Q.slice(0,20).map((be,we)=>`Val ${we}`)},title:{text:"Distribución de frecuencias"}},series:[{name:"Frecuencia",data:Q.slice(0,20)}]},y.value={options:{chart:{id:"gauss"},title:{text:"Distribución tipo Gauss simulada"},xaxis:{type:"numeric"}},series:[{name:"Probabilidad",data:Q.map((be,we)=>[we,be])}]},b.value={options:{chart:{stacked:!0},title:{text:"Consumo por dispositivo simulado"},xaxis:{categories:["Zona A","Zona B","Zona C"]}},series:[{name:"Medidor 1",data:[20,35,40]},{name:"Medidor 2",data:[25,30,28]}]},_.value={options:{labels:["Eficiencia"],title:{text:"Cumplimiento"}},series:[+(ne/60*100).toFixed(0)]},B.value={options:{chart:{type:"bar"},title:{text:"Valor vs Meta (Bullet)"},xaxis:{categories:["Objetivo"]}},series:[{name:"Actual",data:[ne]}]},I.value={options:{chart:{type:"line"},xaxis:{categories:Array.from({length:24},(be,we)=>`${we}h`)},title:{text:"Distribución horaria simulada"}},series:[{name:U.label,data:Array.from({length:24},()=>+(Math.random()*20+10).toFixed(1))}]}}return G(),(U,Q)=>{const q=nv("ApexChart");return yn(),Nn("div",Vz,[ot("header",Gz,[Q[5]||(Q[5]=ot("h2",null,"Estadísticas energéticas",-1)),ot("div",Wz,[Pn(vy,{modelValue:e.value,"onUpdate:modelValue":Q[0]||(Q[0]=ne=>e.value=ne),label:"Parámetro",options:c},null,8,["modelValue"]),ot("div",Xz,[Q[3]||(Q[3]=ot("label",null,"Desde",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":Q[1]||(Q[1]=ne=>t.value=ne)},null,512),[[Zl,t.value]]),Q[4]||(Q[4]=ot("label",null,"Hasta",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":Q[2]||(Q[2]=ne=>s.value=ne)},null,512),[[Zl,s.value]])]),ot("button",{onClick:G},"Analizar"),ot("button",{onClick:E},"Exportar CSV"),ot("button",{onClick:R},"Exportar PDF"),ot("button",{onClick:M},"Ver recomendaciones")])]),ot("section",Yz,[(yn(!0),Nn(Al,null,$d(A.value,(ne,re)=>(yn(),Nn("div",{class:"kpi",key:re},[ot("div",Kz,Hn(ne.label),1),ot("div",qz,Hn(ne.desc),1)]))),128))]),ot("section",$z,[Pn(q,{type:"bar",height:"300",options:r.value.options,series:r.value.series},null,8,["options","series"]),Pn(q,{type:"area",height:"300",options:y.value.options,series:y.value.series},null,8,["options","series"]),Pn(q,{type:"bar",height:"300",options:b.value.options,series:b.value.series},null,8,["options","series"]),Pn(q,{type:"radialBar",height:"300",options:_.value.options,series:_.value.series},null,8,["options","series"]),Pn(q,{type:"bullet",height:"100",options:B.value.options,series:B.value.series},null,8,["options","series"]),Pn(q,{type:"line",height:"300",options:I.value.options,series:I.value.series},null,8,["options","series"])])])}}},Jz=ol(Zz,[["__scopeId","data-v-22de458d"]]),eN={class:"dashboard-factor-carga"},tN={class:"header"},iN={class:"controls"},rN={class:"trend-chart"},nN={class:"metrics-table"},sN={class:"factor-carga"},oN={__name:"FactorCarga",setup(a){const e=sr(ba().subtract(7,"day").format("YYYY-MM-DD")),t=sr(ba().format("YYYY-MM-DD")),s=sr(0),c=sr(0),h=sr(0),A=sr(0),r=sr([]),y=sr({chart:{id:"trend-factor-carga"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},yaxis:{title:{text:"Factor de Carga (%)"},min:0,max:100},title:{text:"Tendencia del Factor de Carga"}});function b(){const _=ba(e.value),I=ba(t.value).diff(_,"day")+1;s.value=+(Math.random()*1e3+500).toFixed(1),c.value=+(Math.random()*30+20).toFixed(1),h.value=+(Math.random()*15+10).toFixed(1),A.value=+(h.value/c.value*100).toFixed(0);const E=[];for(let R=0;R<I;R++){const M=_.add(R,"day"),G=+(Math.random()*50+50).toFixed(0);E.push({x:M.valueOf(),y:G})}r.value=[{name:"Factor de Carga",data:E}]}return b(),(_,B)=>{const I=nv("ApexChart");return yn(),Nn("div",eN,[ot("header",tN,[B[4]||(B[4]=ot("h2",null,"Dashboard de Factor de Carga",-1)),ot("div",iN,[B[2]||(B[2]=ot("label",null,"Desde:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":B[0]||(B[0]=E=>e.value=E)},null,512),[[Zl,e.value]]),B[3]||(B[3]=ot("label",null,"Hasta:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":B[1]||(B[1]=E=>t.value=E)},null,512),[[Zl,t.value]]),ot("button",{onClick:b},"Analizar")])]),ot("section",rN,[B[5]||(B[5]=ot("h3",null,"Tendencia del Factor de Carga",-1)),Pn(I,{type:"line",height:"300",options:y.value,series:r.value},null,8,["options","series"])]),ot("section",nN,[B[11]||(B[11]=ot("h3",null,"Métricas del Periodo",-1)),ot("table",null,[B[10]||(B[10]=ot("thead",null,[ot("tr",null,[ot("th",null,"Métrica"),ot("th",null,"Valor")])],-1)),ot("tbody",null,[ot("tr",null,[B[6]||(B[6]=ot("td",null,"Total de Energía Consumida",-1)),ot("td",null,Hn(s.value)+" kWh",1)]),ot("tr",null,[B[7]||(B[7]=ot("td",null,"Demanda Máxima",-1)),ot("td",null,Hn(c.value)+" kW",1)]),ot("tr",null,[B[8]||(B[8]=ot("td",null,"Demanda Promedio",-1)),ot("td",null,Hn(h.value)+" kW",1)]),ot("tr",null,[B[9]||(B[9]=ot("td",null,"Factor de Carga",-1)),ot("td",sN,Hn(A.value)+"%",1)])])])])])}}},aN=ol(oN,[["__scopeId","data-v-44ac7c83"]]),lN={class:"dashboard-patrones"},cN={class:"header"},uN={class:"controls"},hN={class:"section-chart"},dN={class:"section-chart"},AN={class:"section-chart"},fN={class:"section-chart"},pN={class:"insights"},gN={__name:"Patrones",setup(a){const e=sr("energia"),t=sr(ba().subtract(30,"day").format("YYYY-MM-DD")),s=sr(ba().format("YYYY-MM-DD")),c=qa(()=>{switch(e.value){case"energia":return"Energía";case"potencia":return"Potencia";case"voltaje":return"Voltaje";case"corriente":return"Corriente";default:return e.value}});let h=[];function A(){const ne=ba(t.value),pe=ba(s.value).diff(ne,"day")+1;h=[];for(let Ae=0;Ae<pe;Ae++){const le=e.value==="energia"?100:e.value==="potencia"?50:e.value==="voltaje"?220:e.value==="corriente"?30:0,be=Math.random()*le*.2-le*.1,we=+(le+be).toFixed(1),oe=ne.add(Ae,"day").valueOf();h.push({timestamp:oe,value:we})}}A();const r=sr([{name:c.value,data:h.map(ne=>({x:ne.timestamp,y:ne.value}))}]),y=sr({chart:{id:"historical-trend"},xaxis:{type:"datetime"},title:{text:`Tendencia Histórica de ${c.value}`}}),b=sr([{name:"Trend",data:h.map(ne=>({x:ne.timestamp,y:+(ne.value*.9).toFixed(1)}))},{name:"Seasonal",data:h.map((ne,re)=>({x:ne.timestamp,y:+(10*Math.sin(re)).toFixed(1)}))},{name:"Residual",data:h.map((ne,re)=>({x:ne.timestamp,y:+(ne.value-ne.value*.9-10*Math.sin(re)).toFixed(1)}))}]),_=sr({chart:{id:"decomposition-chart"},xaxis:{type:"datetime"},title:{text:"Descomposición Temporal"}}),B=[[1,.8,.5,.3],[.8,1,.4,.35],[.5,.4,1,.6],[.3,.35,.6,1]],I=["Energía","Potencia","Voltaje","Corriente"],E=sr(I.map((ne,re)=>({name:ne,data:B[re].map((pe,Ae)=>({x:I[Ae],y:pe}))}))),R=sr({chart:{id:"correlation-heatmap"},title:{text:"Matriz de Correlación"},plotOptions:{heatmap:{shadeIntensity:.5,colorScale:{ranges:[{from:0,to:.4,color:"#FF3333"},{from:.4,to:.7,color:"#FFCC33"},{from:.7,to:1,color:"#00E396"}]}}},dataLabels:{enabled:!0}}),M=sr([{name:"Forecast",data:[]}]),G=sr({chart:{id:"forecast-chart"},xaxis:{type:"datetime"},title:{text:`Predicción Avanzada de ${c.value}`}});function U(){const ne=h[h.length-1].timestamp,re=[];for(let pe=1;pe<=7;pe++){const Ae=+(h.reduce((le,be)=>le+be.value,0)/h.length*(1+Math.random()*.1-.05)).toFixed(1);re.push({x:ba(ne).add(pe,"day").valueOf(),y:Ae})}M.value=[{name:"Forecast",data:re}]}U();const Q=sr([{titulo:"Tendencia Creciente",descripcion:`El ${c.value} muestra un crecimiento sostenido durante el periodo analizado.`},{titulo:"Patrón Estacional",descripcion:"Se observa un patrón estacional con fl uctuaciones regulares cada semana."},{titulo:"Anomalía Detectada",descripcion:`Un pico atípico se registró el día ${ba(h[Math.floor(h.length/2)].timestamp).format("YYYY-MM-DD")}.`},{titulo:"Buena Correlación",descripcion:`El ${c.value} presenta alta correlación con Potencia (coeficiente 0.8).`}]);function q(){A(),r.value=[{name:c.value,data:h.map(ne=>({x:ne.timestamp,y:ne.value}))}],y.value.title.text=`Tendencia Histórica de ${c.value}`,b.value=[{name:"Trend",data:h.map(ne=>({x:ne.timestamp,y:+(ne.value*.9).toFixed(1)}))},{name:"Seasonal",data:h.map((ne,re)=>({x:ne.timestamp,y:+(10*Math.sin(re)).toFixed(1)}))},{name:"Residual",data:h.map((ne,re)=>({x:ne.timestamp,y:+(ne.value-ne.value*.9-10*Math.sin(re)).toFixed(1)}))}],U(),Q.value=[{titulo:"Tendencia Creciente",descripcion:`El ${c.value} muestra un crecimiento sostenido durante el periodo.`},{titulo:"Patrón Estacional",descripcion:"Se observa un patrón estacional con fl uctuaciones regulares cada semana."},{titulo:"Anomalía Detectada",descripcion:`Pico atípico registrado el día ${ba(h[Math.floor(h.length/2)].timestamp).format("YYYY-MM-DD")}.`},{titulo:"Buena Correlación",descripcion:`${c.value} presenta alta correlación con Potencia (coeficiente 0.8).`}]}return(ne,re)=>(yn(),Nn("div",lN,[ot("header",cN,[re[7]||(re[7]=ot("h2",null,"Dashboard Históricos de Análisis de Patrones de Parámetros",-1)),ot("div",uN,[re[4]||(re[4]=ot("label",null,"Parámetro:",-1)),ao(ot("select",{"onUpdate:modelValue":re[0]||(re[0]=pe=>e.value=pe)},re[3]||(re[3]=[ot("option",{value:"energia"},"Energía (kWh)",-1),ot("option",{value:"potencia"},"Potencia (kW)",-1),ot("option",{value:"voltaje"},"Voltaje (V)",-1),ot("option",{value:"corriente"},"Corriente (A)",-1)]),512),[[c_,e.value]]),re[5]||(re[5]=ot("label",null,"Desde:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":re[1]||(re[1]=pe=>t.value=pe)},null,512),[[Zl,t.value]]),re[6]||(re[6]=ot("label",null,"Hasta:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":re[2]||(re[2]=pe=>s.value=pe)},null,512),[[Zl,s.value]]),ot("button",{onClick:q},"Analizar")])]),ot("section",hN,[ot("h3",null,"Tendencia Histórica del "+Hn(c.value),1),Pn(Po(Ea),{type:"line",height:"300",options:y.value,series:r.value},null,8,["options","series"])]),ot("section",dN,[re[8]||(re[8]=ot("h3",null,"Descomposición de Series Temporales",-1)),Pn(Po(Ea),{type:"line",height:"300",options:_.value,series:b.value},null,8,["options","series"])]),ot("section",AN,[re[9]||(re[9]=ot("h3",null,"Análisis de Correlación de Parámetros",-1)),Pn(Po(Ea),{type:"heatmap",height:"300",options:R.value,series:E.value},null,8,["options","series"])]),ot("section",fN,[ot("h3",null,"Predicción AI Avanzada del "+Hn(c.value),1),Pn(Po(Ea),{type:"area",height:"300",options:G.value,series:M.value},null,8,["options","series"])]),ot("section",pN,[re[11]||(re[11]=ot("h3",null,"Insights Generados por AI",-1)),ot("table",null,[re[10]||(re[10]=ot("thead",null,[ot("tr",null,[ot("th",null,"Insight"),ot("th",null,"Descripción")])],-1)),ot("tbody",null,[(yn(!0),Nn(Al,null,$d(Q.value,(pe,Ae)=>(yn(),Nn("tr",{key:Ae},[ot("td",null,Hn(pe.titulo),1),ot("td",null,Hn(pe.descripcion),1)]))),128))])])])]))}},mN=ol(gN,[["__scopeId","data-v-ba059950"]]),yN={class:"consumo-dashboard"},vN={class:"dashboard-consumo-avanzado"},_N={class:"header"},xN={class:"controls"},bN={class:"kpi-panel"},wN={class:"card"},BN={class:"value"},CN={class:"card"},SN={class:"value"},EN={class:"card"},IN={class:"value"},TN={class:"card"},FN={class:"value"},LN={class:"card"},MN={class:"value"},PN={class:"card"},kN={class:"value"},RN={class:"charts-grid"},DN={class:"chart-item"},ON={class:"chart-item"},UN={class:"chart-item"},zN={class:"chart-item"},NN={class:"chart-item"},jN={class:"chart-item"},HN={__name:"ConsumoEnergetico",setup(a){const e=sr(ba().subtract(7,"day").format("YYYY-MM-DD")),t=sr(ba().format("YYYY-MM-DD")),s=sr(0),c=sr(0),h=sr(0),A=sr(0),r=sr(0),y=sr(0),b=sr([]),_=sr({chart:{id:"trend-chart"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},title:{text:"Tendencia de Consumo (EMA)"}}),B=sr([]),I=sr({chart:{id:"hist-chart"},xaxis:{categories:[]},title:{text:"Histograma del Consumo"}}),E=sr([]),R=sr({chart:{id:"forecast-chart"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},title:{text:"Forecast para Próximas 24 Horas"}}),M=sr([]),G=sr({chart:{id:"daily-bar-chart",type:"bar"},xaxis:{categories:[],title:{text:"Día"}},title:{text:"Consumo Diario (kWh)"}}),U=sr([]),Q=sr({chart:{id:"boxplot-chart",type:"boxPlot"},title:{text:"Box Plot Diario"}}),q=sr([]),ne=sr({chart:{id:"scatter-chart"},xaxis:{title:{text:"Tiempo"}},yaxis:{title:{text:"Consumo (kWh)"}},title:{text:"Scatter de Outliers"}}),re=[],pe=ba(e.value),Ae=ba(t.value).diff(pe,"day")+1;for(let be=0;be<Ae;be++)for(let we=0;we<24;we++){const oe=pe.add(be,"day").hour(we).minute(0).second(0).valueOf(),me=+(50+(Math.random()*30-15)).toFixed(1);re.push({timestamp:oe,value:me})}function le(){const be=re.reduce((ze,Ve)=>ze+Ve.value,0);s.value=be.toFixed(1);const we=be/re.length;c.value=we.toFixed(1),h.value=Math.max(...re.map(ze=>ze.value)).toFixed(1);const oe=re.reduce((ze,Ve)=>ze+Math.pow(Ve.value-we,2),0)/re.length;A.value=Math.sqrt(oe).toFixed(1),r.value=(A.value/c.value*100).toFixed(1),y.value=(we*1.1).toFixed(1);const me=re.map(ze=>({x:ze.timestamp,y:ze.value})),Le=[],Me=2/(12+1);let Re=me[0].y;Le.push({x:me[0].x,y:Re});for(let ze=1;ze<me.length;ze++){const Ve=Me*me[ze].y+(1-Me)*Re;Le.push({x:me[ze].x,y:+Ve.toFixed(1)}),Re=Ve}b.value=[{name:"Consumo Real",data:me},{name:"EMA",data:Le}];const Ze={};re.forEach(ze=>{const Ve=Math.floor(ze.value/5)*5;Ze[Ve]=(Ze[Ve]||0)+1});const $e=Object.keys(Ze).sort((ze,Ve)=>ze-Ve),ct=$e.map(ze=>Ze[ze]);I.value.xaxis.categories=$e.map(ze=>`${ze}-${+ze+5}`),B.value=[{name:"Frecuencia",data:ct}];const Qe=re[re.length-1].timestamp,It=[];for(let ze=1;ze<=24;ze++)It.push({x:Qe+ze*36e5,y:+y.value});E.value=[{name:"Forecast",data:It}];const Ce=[];for(let ze=0;ze<Ae;ze++){const Ve=re.filter(kt=>ba(kt.timestamp).isSame(pe.add(ze,"day"),"day")).reduce((kt,Ft)=>kt+Ft.value,0);Ce.push(+Ve.toFixed(1))}M.value=[{name:"Consumo Diario",data:Ce}],G.value.xaxis.categories=Array.from({length:Ae},(ze,Ve)=>pe.add(Ve,"day").format("YYYY-MM-DD"));const lt=[...re.map(ze=>ze.value)].sort((ze,Ve)=>ze-Ve),mt=lt[Math.floor(lt.length*.25)],Bt=lt[Math.floor(lt.length*.5)],rt=lt[Math.floor(lt.length*.75)],St=rt-mt,vt=Math.max(0,mt-1.5*St),Gt=rt+1.5*St;U.value=[{data:[{x:"Consumo",y:[vt,mt,Bt,rt,Gt]}]}];const mi=re.filter(ze=>ze.value>we+2*A.value||ze.value<we-2*A.value).map(ze=>({x:ze.timestamp,y:ze.value}));q.value=[{name:"Outliers",data:mi}]}return Ff(()=>{le()}),(be,we)=>(yn(),Nn("div",yN,[Pn(FT,{title:"Análisis de Consumo",subtitle:"Desglose por sectores y horarios clave"}),ot("div",vN,[ot("header",_N,[we[4]||(we[4]=ot("h2",null,"Dashboard de Consumo de Energía Avanzado",-1)),ot("div",xN,[we[2]||(we[2]=ot("label",null,"Desde:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":we[0]||(we[0]=oe=>e.value=oe)},null,512),[[Zl,e.value]]),we[3]||(we[3]=ot("label",null,"Hasta:",-1)),ao(ot("input",{type:"date","onUpdate:modelValue":we[1]||(we[1]=oe=>t.value=oe)},null,512),[[Zl,t.value]]),ot("button",{onClick:le},"Analizar")])]),ot("section",bN,[ot("div",wN,[we[5]||(we[5]=ot("h3",null,"Total de Consumo",-1)),ot("p",BN,Hn(s.value)+" kWh",1)]),ot("div",CN,[we[6]||(we[6]=ot("h3",null,"Consumo Promedio",-1)),ot("p",SN,Hn(c.value)+" kWh",1)]),ot("div",EN,[we[7]||(we[7]=ot("h3",null,"Consumo Máximo",-1)),ot("p",IN,Hn(h.value)+" kW",1)]),ot("div",TN,[we[8]||(we[8]=ot("h3",null,"Desviación Estándar",-1)),ot("p",FN,Hn(A.value)+" kWh",1)]),ot("div",LN,[we[9]||(we[9]=ot("h3",null,"Coeficiente de Variación",-1)),ot("p",MN,Hn(r.value)+"%",1)]),ot("div",PN,[we[10]||(we[10]=ot("h3",null,"Predicción Siguiente Día",-1)),ot("p",kN,Hn(y.value)+" kWh",1)])]),ot("section",RN,[ot("div",DN,[we[11]||(we[11]=ot("h3",null,"Tendencia con EMA",-1)),Pn(Po(Ea),{type:"line",height:"300",options:_.value,series:b.value},null,8,["options","series"])]),ot("div",ON,[we[12]||(we[12]=ot("h3",null,"Histograma de Consumo",-1)),Pn(Po(Ea),{type:"bar",height:"300",options:I.value,series:B.value},null,8,["options","series"])]),ot("div",UN,[we[13]||(we[13]=ot("h3",null,"Forecast 24h",-1)),Pn(Po(Ea),{type:"area",height:"300",options:R.value,series:E.value},null,8,["options","series"])]),ot("div",zN,[we[14]||(we[14]=ot("h3",null,"Consumo Diario (kWh)",-1)),Pn(Po(Ea),{type:"bar",height:"300",options:G.value,series:M.value},null,8,["options","series"])]),ot("div",NN,[we[15]||(we[15]=ot("h3",null,"Box Plot Diario",-1)),Pn(Po(Ea),{type:"boxPlot",height:"300",options:Q.value,series:U.value},null,8,["options","series"])]),ot("div",jN,[we[16]||(we[16]=ot("h3",null,"Scatter de Outliers",-1)),Pn(Po(Ea),{type:"scatter",height:"300",options:ne.value,series:q.value},null,8,["options","series"])])])]),Pn(LT)]))}},QN=ol(HN,[["__scopeId","data-v-70479e5b"]]),VN={class:"sidebar-header"},GN={class:"meter-list"},WN=["onClick"],XN={__name:"FleetSidebar",props:{meters:Array,role:String,open:Boolean},emits:["add-meter"],setup(a,{emit:e}){const t=a,s=e,c=NR(),h=y=>{c.push(`/meter/${y}`)},A=qa(()=>["admin","engineer"].includes(t.role)),r=()=>s("add-meter");return(y,b)=>(yn(),Nn("aside",{class:Ep(["sidebar",{open:a.open}])},[ot("header",VN,[b[0]||(b[0]=ot("h3",null,"Mis Medidores",-1)),A.value?(yn(),Nn("button",{key:0,onClick:r},"➕ Nuevo")):ym("",!0)]),ot("ul",GN,[(yn(!0),Nn(Al,null,$d(a.meters,_=>(yn(),Nn("li",{key:_.id,onClick:B=>h(_.id),class:"meter-item"},[ot("span",{class:Ep({active:_.status==="activo"})},"●",2),xp(" "+Hn(_.name),1)],8,WN))),128))])],2))}},YN=ol(XN,[["__scopeId","data-v-4cb41933"]]);var L0={exports:{}},KN=L0.exports,KE;function qN(){return KE||(KE=1,function(a,e){(function(t,s){a.exports=s()})(KN,function(){var t,s,c;function h(r,y){if(!t)t=y;else if(!s)s=y;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",_={};t(_),c=y(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}h(["exports"],function(r){var y=1e-6,b=typeof Float32Array<"u"?Float32Array:Array;function _(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=o*m-f*d;return v?(l[0]=m*(v=1/v),l[1]=-d*v,l[2]=-f*v,l[3]=o*v,l):null}function B(){var l=new b(9);return b!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function I(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=i[4],C=i[5],T=i[6],F=i[7],k=i[8];return l[0]=v*k-C*F,l[1]=f*F-d*k,l[2]=d*C-f*v,l[3]=C*T-m*k,l[4]=o*k-f*T,l[5]=f*m-o*C,l[6]=m*F-v*T,l[7]=d*T-o*F,l[8]=o*v-d*m,l}function E(l,i,o){var d=i[0],f=i[1],m=i[2],v=i[3],C=i[4],T=i[5],F=i[6],k=i[7],z=i[8],H=o[0],$=o[1],ee=o[2],ae=o[3],fe=o[4],ve=o[5],Fe=o[6],Pe=o[7],ue=o[8];return l[0]=H*d+$*v+ee*F,l[1]=H*f+$*C+ee*k,l[2]=H*m+$*T+ee*z,l[3]=ae*d+fe*v+ve*F,l[4]=ae*f+fe*C+ve*k,l[5]=ae*m+fe*T+ve*z,l[6]=Fe*d+Pe*v+ue*F,l[7]=Fe*f+Pe*C+ue*k,l[8]=Fe*m+Pe*T+ue*z,l}function R(){var l=new b(16);return b!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l}function M(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function G(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=i[4],C=i[5],T=i[6],F=i[7],k=i[8],z=i[9],H=i[10],$=i[11],ee=i[12],ae=i[13],fe=i[14],ve=i[15],Fe=o*C-d*v,Pe=o*T-f*v,ue=o*F-m*v,Ie=d*T-f*C,ke=d*F-m*C,Ge=f*F-m*T,yt=k*ae-z*ee,At=k*fe-H*ee,_t=k*ve-$*ee,Mt=z*fe-H*ae,Wt=z*ve-$*ae,Si=H*ve-$*fe,Ai=Fe*Si-Pe*Wt+ue*Mt+Ie*_t-ke*At+Ge*yt;return Ai?(l[0]=(C*Si-T*Wt+F*Mt)*(Ai=1/Ai),l[1]=(f*Wt-d*Si-m*Mt)*Ai,l[2]=(ae*Ge-fe*ke+ve*Ie)*Ai,l[3]=(H*ke-z*Ge-$*Ie)*Ai,l[4]=(T*_t-v*Si-F*At)*Ai,l[5]=(o*Si-f*_t+m*At)*Ai,l[6]=(fe*ue-ee*Ge-ve*Pe)*Ai,l[7]=(k*Ge-H*ue+$*Pe)*Ai,l[8]=(v*Wt-C*_t+F*yt)*Ai,l[9]=(d*_t-o*Wt-m*yt)*Ai,l[10]=(ee*ke-ae*ue+ve*Fe)*Ai,l[11]=(z*ue-k*ke-$*Fe)*Ai,l[12]=(C*At-v*Mt-T*yt)*Ai,l[13]=(o*Mt-d*At+f*yt)*Ai,l[14]=(ae*Pe-ee*Ie-fe*Fe)*Ai,l[15]=(k*Ie-z*Pe+H*Fe)*Ai,l):null}function U(l,i,o){var d=i[0],f=i[1],m=i[2],v=i[3],C=i[4],T=i[5],F=i[6],k=i[7],z=i[8],H=i[9],$=i[10],ee=i[11],ae=i[12],fe=i[13],ve=i[14],Fe=i[15],Pe=o[0],ue=o[1],Ie=o[2],ke=o[3];return l[0]=Pe*d+ue*C+Ie*z+ke*ae,l[1]=Pe*f+ue*T+Ie*H+ke*fe,l[2]=Pe*m+ue*F+Ie*$+ke*ve,l[3]=Pe*v+ue*k+Ie*ee+ke*Fe,l[4]=(Pe=o[4])*d+(ue=o[5])*C+(Ie=o[6])*z+(ke=o[7])*ae,l[5]=Pe*f+ue*T+Ie*H+ke*fe,l[6]=Pe*m+ue*F+Ie*$+ke*ve,l[7]=Pe*v+ue*k+Ie*ee+ke*Fe,l[8]=(Pe=o[8])*d+(ue=o[9])*C+(Ie=o[10])*z+(ke=o[11])*ae,l[9]=Pe*f+ue*T+Ie*H+ke*fe,l[10]=Pe*m+ue*F+Ie*$+ke*ve,l[11]=Pe*v+ue*k+Ie*ee+ke*Fe,l[12]=(Pe=o[12])*d+(ue=o[13])*C+(Ie=o[14])*z+(ke=o[15])*ae,l[13]=Pe*f+ue*T+Ie*H+ke*fe,l[14]=Pe*m+ue*F+Ie*$+ke*ve,l[15]=Pe*v+ue*k+Ie*ee+ke*Fe,l}function Q(l,i,o){var d,f,m,v,C,T,F,k,z,H,$,ee,ae=o[0],fe=o[1],ve=o[2];return i===l?(l[12]=i[0]*ae+i[4]*fe+i[8]*ve+i[12],l[13]=i[1]*ae+i[5]*fe+i[9]*ve+i[13],l[14]=i[2]*ae+i[6]*fe+i[10]*ve+i[14],l[15]=i[3]*ae+i[7]*fe+i[11]*ve+i[15]):(f=i[1],m=i[2],v=i[3],C=i[4],T=i[5],F=i[6],k=i[7],z=i[8],H=i[9],$=i[10],ee=i[11],l[0]=d=i[0],l[1]=f,l[2]=m,l[3]=v,l[4]=C,l[5]=T,l[6]=F,l[7]=k,l[8]=z,l[9]=H,l[10]=$,l[11]=ee,l[12]=d*ae+C*fe+z*ve+i[12],l[13]=f*ae+T*fe+H*ve+i[13],l[14]=m*ae+F*fe+$*ve+i[14],l[15]=v*ae+k*fe+ee*ve+i[15]),l}function q(l,i,o){var d=o[0],f=o[1],m=o[2];return l[0]=i[0]*d,l[1]=i[1]*d,l[2]=i[2]*d,l[3]=i[3]*d,l[4]=i[4]*f,l[5]=i[5]*f,l[6]=i[6]*f,l[7]=i[7]*f,l[8]=i[8]*m,l[9]=i[9]*m,l[10]=i[10]*m,l[11]=i[11]*m,l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15],l}function ne(l,i,o){var d=Math.sin(o),f=Math.cos(o),m=i[4],v=i[5],C=i[6],T=i[7],F=i[8],k=i[9],z=i[10],H=i[11];return i!==l&&(l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[4]=m*f+F*d,l[5]=v*f+k*d,l[6]=C*f+z*d,l[7]=T*f+H*d,l[8]=F*f-m*d,l[9]=k*f-v*d,l[10]=z*f-C*d,l[11]=H*f-T*d,l}function re(l,i,o){var d=Math.sin(o),f=Math.cos(o),m=i[0],v=i[1],C=i[2],T=i[3],F=i[8],k=i[9],z=i[10],H=i[11];return i!==l&&(l[4]=i[4],l[5]=i[5],l[6]=i[6],l[7]=i[7],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=m*f-F*d,l[1]=v*f-k*d,l[2]=C*f-z*d,l[3]=T*f-H*d,l[8]=m*d+F*f,l[9]=v*d+k*f,l[10]=C*d+z*f,l[11]=T*d+H*f,l}function pe(l,i,o){var d=Math.sin(o),f=Math.cos(o),m=i[0],v=i[1],C=i[2],T=i[3],F=i[4],k=i[5],z=i[6],H=i[7];return i!==l&&(l[8]=i[8],l[9]=i[9],l[10]=i[10],l[11]=i[11],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=m*f+F*d,l[1]=v*f+k*d,l[2]=C*f+z*d,l[3]=T*f+H*d,l[4]=F*f-m*d,l[5]=k*f-v*d,l[6]=z*f-C*d,l[7]=H*f-T*d,l}function Ae(l,i){return l[0]=i[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=i[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function le(l,i,o){var d,f,m,v=o[0],C=o[1],T=o[2],F=Math.hypot(v,C,T);return F<y?null:(v*=F=1/F,C*=F,T*=F,d=Math.sin(i),f=Math.cos(i),l[0]=v*v*(m=1-f)+f,l[1]=C*v*m+T*d,l[2]=T*v*m-C*d,l[3]=0,l[4]=v*C*m-T*d,l[5]=C*C*m+f,l[6]=T*C*m+v*d,l[7]=0,l[8]=v*T*m+C*d,l[9]=C*T*m-v*d,l[10]=T*T*m+f,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}function be(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=o+o,C=d+d,T=f+f,F=o*v,k=d*v,z=d*C,H=f*v,$=f*C,ee=f*T,ae=m*v,fe=m*C,ve=m*T;return l[0]=1-z-ee,l[1]=k+ve,l[2]=H-fe,l[3]=0,l[4]=k-ve,l[5]=1-F-ee,l[6]=$+ae,l[7]=0,l[8]=H+fe,l[9]=$-ae,l[10]=1-F-z,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}Math.hypot||(Math.hypot=function(){for(var l=0,i=arguments.length;i--;)l+=arguments[i]*arguments[i];return Math.sqrt(l)});var we=U;function oe(){var l=new b(3);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function me(l){var i=new b(3);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i}function Le(l){return Math.hypot(l[0],l[1],l[2])}function Se(l,i,o){var d=new b(3);return d[0]=l,d[1]=i,d[2]=o,d}function Me(l,i,o){return l[0]=i[0]+o[0],l[1]=i[1]+o[1],l[2]=i[2]+o[2],l}function Re(l,i,o){return l[0]=i[0]-o[0],l[1]=i[1]-o[1],l[2]=i[2]-o[2],l}function Ze(l,i,o){return l[0]=i[0]*o[0],l[1]=i[1]*o[1],l[2]=i[2]*o[2],l}function $e(l,i,o){return l[0]=Math.min(i[0],o[0]),l[1]=Math.min(i[1],o[1]),l[2]=Math.min(i[2],o[2]),l}function ct(l,i,o){return l[0]=Math.max(i[0],o[0]),l[1]=Math.max(i[1],o[1]),l[2]=Math.max(i[2],o[2]),l}function Qe(l,i,o){return l[0]=i[0]*o,l[1]=i[1]*o,l[2]=i[2]*o,l}function It(l,i,o,d){return l[0]=i[0]+o[0]*d,l[1]=i[1]+o[1]*d,l[2]=i[2]+o[2]*d,l}function Ce(l,i){var o=i[0]-l[0],d=i[1]-l[1],f=i[2]-l[2];return o*o+d*d+f*f}function Je(l){var i=l[0],o=l[1],d=l[2];return i*i+o*o+d*d}function lt(l,i){return l[0]=-i[0],l[1]=-i[1],l[2]=-i[2],l}function mt(l,i){var o=i[0],d=i[1],f=i[2],m=o*o+d*d+f*f;return m>0&&(m=1/Math.sqrt(m)),l[0]=i[0]*m,l[1]=i[1]*m,l[2]=i[2]*m,l}function Bt(l,i){return l[0]*i[0]+l[1]*i[1]+l[2]*i[2]}function rt(l,i,o){var d=i[0],f=i[1],m=i[2],v=o[0],C=o[1],T=o[2];return l[0]=f*T-m*C,l[1]=m*v-d*T,l[2]=d*C-f*v,l}function St(l,i,o,d){var f=i[0],m=i[1],v=i[2];return l[0]=f+d*(o[0]-f),l[1]=m+d*(o[1]-m),l[2]=v+d*(o[2]-v),l}function vt(l,i,o){var d=i[0],f=i[1],m=i[2],v=o[3]*d+o[7]*f+o[11]*m+o[15];return l[0]=(o[0]*d+o[4]*f+o[8]*m+o[12])/(v=v||1),l[1]=(o[1]*d+o[5]*f+o[9]*m+o[13])/v,l[2]=(o[2]*d+o[6]*f+o[10]*m+o[14])/v,l}function Gt(l,i,o){var d=i[0],f=i[1],m=i[2];return l[0]=d*o[0]+f*o[3]+m*o[6],l[1]=d*o[1]+f*o[4]+m*o[7],l[2]=d*o[2]+f*o[5]+m*o[8],l}function mi(l,i,o){var d=o[0],f=o[1],m=o[2],v=i[0],C=i[1],T=i[2],F=f*T-m*C,k=m*v-d*T,z=d*C-f*v,H=f*z-m*k,$=m*F-d*z,ee=d*k-f*F,ae=2*o[3];return k*=ae,z*=ae,$*=2,ee*=2,l[0]=v+(F*=ae)+(H*=2),l[1]=C+k+$,l[2]=T+z+ee,l}function ze(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]}var Ve=Re,kt=Ze,Ft=Le;function it(){var l=new b(4);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0),l}function yi(l,i,o){return l[0]=i[0]*o,l[1]=i[1]*o,l[2]=i[2]*o,l[3]=i[3]*o,l}function bi(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=o*o+d*d+f*f+m*m;return v>0&&(v=1/Math.sqrt(v)),l[0]=o*v,l[1]=d*v,l[2]=f*v,l[3]=m*v,l}function Kt(l,i,o){var d=i[0],f=i[1],m=i[2],v=i[3];return l[0]=o[0]*d+o[4]*f+o[8]*m+o[12]*v,l[1]=o[1]*d+o[5]*f+o[9]*m+o[13]*v,l[2]=o[2]*d+o[6]*f+o[10]*m+o[14]*v,l[3]=o[3]*d+o[7]*f+o[11]*m+o[15]*v,l}function di(){var l=new b(4);return b!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function fi(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function Ri(l,i,o){o*=.5;var d=i[0],f=i[1],m=i[2],v=i[3],C=Math.sin(o),T=Math.cos(o);return l[0]=d*T+v*C,l[1]=f*T+m*C,l[2]=m*T-f*C,l[3]=v*T-d*C,l}function Oi(l,i,o){o*=.5;var d=i[0],f=i[1],m=i[2],v=i[3],C=Math.sin(o),T=Math.cos(o);return l[0]=d*T-m*C,l[1]=f*T+v*C,l[2]=m*T+d*C,l[3]=v*T-f*C,l}oe(),it();var Ji,lr,br,Dr,Fr,Qr=bi,ui=(Ji=oe(),lr=Se(1,0,0),br=Se(0,1,0),function(l,i,o){var d=Bt(i,o);return d<-.999999?(rt(Ji,lr,i),Ft(Ji)<1e-6&&rt(Ji,br,i),mt(Ji,Ji),function(f,m,v){v*=.5;var C=Math.sin(v);f[0]=C*m[0],f[1]=C*m[1],f[2]=C*m[2],f[3]=Math.cos(v)}(l,Ji,Math.PI),l):d>.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(rt(Ji,i,o),l[0]=Ji[0],l[1]=Ji[1],l[2]=Ji[2],l[3]=1+d,Qr(l,l))});function li(){var l=new b(2);return b!=Float32Array&&(l[0]=0,l[1]=0),l}function Vi(l,i){var o=new b(2);return o[0]=l,o[1]=i,o}function rr(l,i,o){return l[0]=i[0]+o[0],l[1]=i[1]+o[1],l}function qr(l,i,o){return l[0]=i[0]-o[0],l[1]=i[1]-o[1],l}function _r(l,i,o){return l[0]=i[0]*o,l[1]=i[1]*o,l}function Zr(l){return Math.hypot(l[0],l[1])}function io(l,i){var o=i[0],d=i[1],f=o*o+d*d;return f>0&&(f=1/Math.sqrt(f)),l[0]=i[0]*f,l[1]=i[1]*f,l}function Ur(l,i){return l[0]*i[0]+l[1]*i[1]}function ia(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}di(),di(),B(),li();var ps,ro,Qn=function(){if(Fr)return Dr;function l(i,o,d,f){this.cx=3*i,this.bx=3*(d-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=d,this.p2y=f}return Fr=1,Dr=l,l.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var d=i,f=0;f<8;f++){var m=this.sampleCurveX(d)-i;if(Math.abs(m)<o)return d;var v=this.sampleCurveDerivativeX(d);if(Math.abs(v)<1e-6)break;d-=m/v}var C=0,T=1;for(d=i,f=0;f<20&&(m=this.sampleCurveX(d),!(Math.abs(m-i)<o));f++)i>m?C=d:T=d,d=.5*(T-C)+C;return d},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},Dr}(),Lr=ia(Qn);function yr(){if(ro)return ps;function l(i,o){this.x=i,this.y=o}return ro=1,ps=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,o){return this.clone()._rotateAround(i,o)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var o=i.x-this.x,d=i.y-this.y;return o*o+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,o){return Math.atan2(this.x*o-this.y*i,this.x*i+this.y*o)},_matMult:function(i){var o=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=o,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var o=Math.cos(i),d=Math.sin(i),f=d*this.x+o*this.y;return this.x=o*this.x-d*this.y,this.y=f,this},_rotateAround:function(i,o){var d=Math.cos(i),f=Math.sin(i),m=o.y+f*(this.x-o.x)+d*(this.y-o.y);return this.x=o.x+d*(this.x-o.x)-f*(this.y-o.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(i){return i instanceof l?i:Array.isArray(i)?new l(i[0],i[1]):i},ps}var qt=ia(yr());function Vn(l,i){if(Array.isArray(l)){if(!Array.isArray(i)||l.length!==i.length)return!1;for(let o=0;o<l.length;o++)if(!Vn(l[o],i[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&i!==null){if(typeof i!="object"||Object.keys(l).length!==Object.keys(i).length)return!1;for(const o in l)if(!Vn(l[o],i[o]))return!1;return!0}return l===i}const xs=Math.PI/180,ra=180/Math.PI;function dn(l){return l*xs}function Et(l){return l*ra}const ye=[[0,0],[1,0],[1,1],[0,1]];function Ee(l){if(l<=0)return 0;if(l>=1)return 1;const i=l*l,o=i*l;return 4*(l<.5?o:3*(l-i)+o-.75)}function He(l,i,o,d){const f=new Lr(l,i,o,d);return function(m){return f.solve(m)}}const tt=He(.25,.1,.25,1);function Ye(l,i,o){return Math.min(o,Math.max(i,l))}function xt(l,i,o){return(o=Ye((o-l)/(i-l),0,1))*o*(3-2*o)}function Dt(l,i,o){const d=o-i,f=((l-i)%d+d)%d+i;return f===i?o:f}function bt(l,i,o){if(!l.length)return o(null,[]);let d=l.length;const f=new Array(l.length);let m=null;l.forEach((v,C)=>{i(v,(T,F)=>{T&&(m=T),f[C]=F,--d==0&&o(m,f)})})}function Ut(l,...i){for(const o of i)for(const d in o)l[d]=o[d];return l}let ii=1;function Nt(){return ii++}function Fi(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function er(l,i){l.forEach(o=>{i[o]&&(i[o]=i[o].bind(i))})}function nr(l,i,o){const d={};for(const f in l)d[f]=i.call(this,l[f],f,l);return d}function Sr(l,i,o){const d={};for(const f in l)i.call(this,l[f],f,l)&&(d[f]=l[f]);return d}function Mr(l){return Array.isArray(l)?l.map(Mr):typeof l=="object"&&l?nr(l,Mr):l}function jr(l,i){for(let o=0;o<l.length;o++)if(i.indexOf(l[o])>=0)return!0;return!1}const nn={};function Yr(l){nn[l]||(typeof console<"u"&&console.warn(l),nn[l]=!0)}function qn(l,i,o){return(o.y-l.y)*(i.x-l.x)>(i.y-l.y)*(o.x-l.x)}function gs(l){let i=0;for(let o,d,f=0,m=l.length,v=m-1;f<m;v=f++)o=l[f],d=l[v],i+=(d.x-o.x)*(o.y+d.y);return i}function ms([l,i,o]){const d=dn(i+90),f=dn(o);return{x:l*Math.cos(d)*Math.sin(f),y:l*Math.sin(d)*Math.sin(f),z:l*Math.cos(f),azimuthal:i,polar:o}}function En(l){return(typeof self<"u"||l!==void 0)&&typeof WorkerGlobalScope<"u"&&(l!==void 0?l:self)instanceof WorkerGlobalScope}function In(l){const i={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,d,f,m)=>{const v=f||m;return i[d]=!v||v.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i}let Ls=null;function bs(l,i){return[l[4*i],l[4*i+1],l[4*i+2],l[4*i+3]]}function hs(l,i,o,d){for(;i<o;){const f=i+o>>1;l[f]<d?i=f+1:o=f}return i}function Uo(l,i,o,d){for(;i<o;){const f=i+o>>1;l[f]<=d?i=f+1:o=f}return i}function Da(l){return l>0?1/(1.001-l):1+l}function So(l){return l>0?1-1/(1.001-l):-l}function vc(l,i,o){return(l-i.min)*(o.max-o.min)/(i.max-i.min)+o.min}const ds={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ds.API_URL)return null;try{const l=new URL(ds.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v0.3.0.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function _c(l){return ds.API_URL_REGEX.test(l)}function ch(l){return ds.API_SPRITE_REGEX.test(l)}let xc,ec,Nc,yl,Eo,Ta;function Ou(){return xc==null&&(xc=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xc}const vl={now:()=>yl!==void 0?yl:performance.now(),setNow(l){yl=l},restoreNow(){yl=void 0},frame(l){const i=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(l,i=0){const{width:o,height:d}=l;Eo||(Eo=document.createElement("canvas"));const f=Eo.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>Eo.width||d>Eo.height)&&(Eo.width=o,Eo.height=d),f.clearRect(-i,-i,o+2*i,d+2*i),f.drawImage(l,0,0,o,d),f.getImageData(-i,-i,o+2*i,d+2*i)},resolveURL:l=>(ec||(ec=document.createElement("a")),ec.href=l,ec.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Nc==null&&(Nc=window.matchMedia("(prefers-reduced-motion: reduce)")),Nc.matches)},hasCanvasFingerprintNoise(){if(Ta!==void 0)return Ta;if(!Ou())return Ta=!1,!1;const l=new OffscreenCanvas(85,1),i=l.getContext("2d",{willReadFrequently:!0});let o=0;for(let f=0;f<l.width;++f)i.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,i.fillRect(f,0,1,1);const d=i.getImageData(0,0,l.width,l.height);o=0;for(let f=0;f<d.data.length;++f)if(f%4!=3&&o++!==d.data[f])return Ta=!0,!0;return Ta=!1,!1}};function al(l,i){const o=l.indexOf("?");if(o<0)return`${l}?${new URLSearchParams(i).toString()}`;const d=new URLSearchParams(l.slice(o));for(const f in i)d.set(f,i[f]);return`${l.slice(0,o)}?${d.toString()}`}function ll(l,i={persistentParams:[]}){const o=l.indexOf("?");if(o<0)return l;const d=new URLSearchParams,f=new URLSearchParams(l.slice(o));for(const v of i.persistentParams){const C=f.get(v);C&&d.set(v,C)}const m=d.toString();return`${l.slice(0,o)}${m.length>0?`?${m}`:""}`}const bc="mapbox-tiles";let _l=500,wc=50;const tc=["language","worldview","jobid"];let ic,Uu;function hu(){try{return caches}catch{}}function xl(){const l=hu();l&&ic==null&&(ic=l.open(bc))}let du=1/0;const jc={supported:!1,testSupport:function(l){!uh&&Xo&&(Au?iA(l):ko=l)}};let ko,Xo,uh=!1,Au=!1;const Tn=typeof self<"u"?self:{};function iA(l){const i=l.createTexture();l.bindTexture(l.TEXTURE_2D,i);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Xo),l.isContextLost())return;jc.supported=!0}catch{}l.deleteTexture(i),uh=!0}Tn.document&&(Xo=Tn.document.createElement("img"),Xo.onload=function(){ko&&iA(ko),ko=null,Au=!0},Xo.onerror=function(){uh=!0,ko=null},Xo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const hh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(hh);class pn extends Error{constructor(i,o,d){o===401&&_c(d)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=o,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const dh=En()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,fu=function(l,i){if(!(/^file:/.test(o=l.url)||/^file:/.test(dh())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(d,f){const m=new AbortController,v=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:dh(),referrerPolicy:d.referrerPolicy,signal:m.signal});let C=!1,T=!1;const F=(k=v.url).indexOf("sku=")>0&&_c(k);var k;d.type==="json"&&v.headers.set("Accept","application/json");const z=($,ee,ae)=>{if(T)return;if($&&$.message!=="SecurityError"&&Yr($.toString()),ee&&ae)return H(ee);const fe=Date.now();fetch(v).then(ve=>{if(ve.ok){const Fe=F?ve.clone():null;return H(ve,Fe,fe)}return f(new pn(ve.statusText,ve.status,d.url))}).catch(ve=>{ve.name!=="AbortError"&&f(new Error(`${ve.message} ${d.url}`))})},H=($,ee,ae)=>{(d.type==="arrayBuffer"?$.arrayBuffer():d.type==="json"?$.json():$.text()).then(fe=>{T||(ee&&ae&&function(ve,Fe,Pe){if(xl(),ic==null)return;const ue=In(Fe.headers.get("Cache-Control")||"");if(ue["no-store"])return;const Ie={status:Fe.status,statusText:Fe.statusText,headers:new Headers};Fe.headers.forEach((yt,At)=>Ie.headers.set(At,yt)),ue["max-age"]&&Ie.headers.set("Expires",new Date(Pe+1e3*ue["max-age"]).toUTCString());const ke=Ie.headers.get("Expires");if(!ke||new Date(ke).getTime()-Pe<42e4)return;let Ge=ll(ve.url,{persistentParams:tc});if(Fe.status===206){const yt=ve.headers.get("Range");if(!yt)return;Ie.status=200,Ge=al(Ge,{range:yt})}(function(yt,At){if(Uu===void 0)try{new Response(new ReadableStream),Uu=!0}catch{Uu=!1}Uu?At(yt.body):yt.blob().then(At).catch(_t=>Yr(_t.message))})(Fe,yt=>{const At=new Response((_t=Fe.status)!==200&&_t!==404&&[101,103,204,205,304].includes(_t)?null:yt,Ie);var _t;xl(),ic!=null&&ic.then(Mt=>Mt.put(Ge,At)).catch(Mt=>Yr(Mt.message))})}(v,ee,ae),C=!0,f(null,fe,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(fe=>{T||f(new Error(fe.message))})};return F?function($,ee){if(xl(),ic==null)return ee(null);ic.then(ae=>{let fe=ll($.url,{persistentParams:tc});const ve=$.headers.get("Range");ve&&(fe=al(fe,{range:ve})),ae.match(fe).then(Fe=>{const Pe=function(ue){if(!ue)return!1;const Ie=new Date(ue.headers.get("Expires")||0),ke=In(ue.headers.get("Cache-Control")||"");return Number(Ie)>Date.now()&&!ke["no-cache"]}(Fe);ae.delete(fe).catch(ee),Pe&&ae.put(fe,Fe.clone()).catch(ee),ee(null,Fe,Pe)}).catch(ee)}).catch(ee)}(v,z):z(null,null),{cancel:()=>{T=!0,C||m.abort()}}}(l,i);if(En(self)&&self.worker.actor)return self.worker.actor.send("getResource",l,i,void 0,!0)}var o;return function(d,f){const m=new XMLHttpRequest;m.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const v in d.headers)m.setRequestHeader(v,d.headers[v]);return d.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=d.credentials==="include",m.onerror=()=>{f(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let v=m.response;if(d.type==="json")try{v=JSON.parse(m.response)}catch(C){return f(C)}f(null,v,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new pn(m.statusText,m.status,d.url))},m.send(d.body),{cancel:()=>m.abort()}}(l,i)},Hc=function(l,i){return fu(Ut(l,{type:"arrayBuffer"}),i)};function bl(l){const i=document.createElement("a");return i.href=l,i.protocol===location.protocol&&i.host===location.host}const zu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Qc,Bc;Qc=[],Bc=0;const Ah=function(l,i){if(jc.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Bc>=ds.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:l,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Qc.push(m),m}Bc++;let o=!1;const d=()=>{if(!o)for(o=!0,Bc--;Qc.length&&Bc<ds.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Qc.shift(),{requestParameters:v,callback:C,cancelled:T}=m;T||(m.cancel=Ah(v,C).cancel)}},f=Hc(l,(m,v,C,T)=>{d(),m?i(m):v&&(self.createImageBitmap?function(F,k){const z=new Blob([new Uint8Array(F)],{type:"image/png"});createImageBitmap(z).then(H=>{k(null,H)}).catch(H=>{k(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(F,k)=>i(F,k,C,T)):function(F,k){const z=new Image;z.onload=()=>{k(null,z),URL.revokeObjectURL(z.src),z.onload=null,requestAnimationFrame(()=>{z.src=zu})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new Blob([new Uint8Array(F)],{type:"image/png"});z.src=F.byteLength?URL.createObjectURL(H):zu}(v,(F,k)=>i(F,k,C,T)))});return{cancel:()=>{f.cancel(),d()}}};var pu,wl,ud,$a={exports:{}},gu={exports:{}},mu={exports:{}},Bl=function(){if(ud)return $a.exports;ud=1;var l=(pu||(pu=1,gu.exports=function(o,d){var f,m,v,C,T,F,k,z;for(m=o.length-(f=3&o.length),v=d,T=3432918353,F=461845907,z=0;z<m;)k=255&o.charCodeAt(z)|(255&o.charCodeAt(++z))<<8|(255&o.charCodeAt(++z))<<16|(255&o.charCodeAt(++z))<<24,++z,v=27492+(65535&(C=5*(65535&(v=(v^=k=(65535&(k=(k=(65535&k)*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*F+(((k>>>16)*F&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(k=0,f){case 3:k^=(255&o.charCodeAt(z+2))<<16;case 2:k^=(255&o.charCodeAt(z+1))<<8;case 1:v^=k=(65535&(k=(k=(65535&(k^=255&o.charCodeAt(z)))*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*F+(((k>>>16)*F&65535)<<16)&4294967295}return v^=o.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),gu.exports),i=(wl||(wl=1,mu.exports=function(o,d){for(var f,m=o.length,v=d^m,C=0;m>=4;)f=1540483477*(65535&(f=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24))+((1540483477*(f>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),m-=4,++C;switch(m){case 3:v^=(255&o.charCodeAt(C+2))<<16;case 2:v^=(255&o.charCodeAt(C+1))<<8;case 1:v=1540483477*(65535&(v^=255&o.charCodeAt(C)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),mu.exports);return $a.exports=l,$a.exports.murmur3=l,$a.exports.murmur2=i,$a.exports}(),zo=ia(Bl);class Vc{constructor(i,...o){Ut(this,o[0]||{}),this.type=i}}class rc extends Vc{constructor(i,o={}){super("error",Ut({error:i},o))}}function nc(l,i,o){o[l]&&o[l].indexOf(i)!==-1||(o[l]=o[l]||[],o[l].push(i))}function sc(l,i,o){if(o&&o[l]){const d=o[l].indexOf(i);d!==-1&&o[l].splice(d,1)}}class yu{on(i,o){return this._listeners=this._listeners||{},nc(i,o,this._listeners),this}off(i,o){return sc(i,o,this._listeners),sc(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},nc(i,o,this._oneTimeListeners),this):new Promise(d=>{this.once(i,d)})}fire(i,o){const d=typeof i=="string"?new Vc(i,o):i,f=d.type;if(this.listens(f)){d.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of m)T.call(this,d);const v=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of v)sc(f,T,this._oneTimeListeners),T.call(this,d);const C=this._eventedParent;C&&(Ut(d,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(d))}else d instanceof rc&&console.error(d.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}class na{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new na(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[o,d]=i.split("");return new na({name:o,iconsetId:d})}static isEqual(i,o){return i.name===o.name&&i.iconsetId===o.iconsetId}toString(){return na.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Za,Ol={},Cl=function(){if(Za)return Ol;Za=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(m){return(m=Math.round(m))<0?0:m>255?255:m}function o(m){return i(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function d(m){return(v=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:v>1?1:v;var v}function f(m,v,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?m+(v-m)*C*6:2*C<1?v:3*C<2?m+(v-m)*(2/3-C)*6:m}try{Ol.parseCSSColor=function(m){var v,C=m.replace(/ /g,"").toLowerCase();if(C in l)return l[C].slice();if(C[0]==="#")return C.length===4?(v=parseInt(C.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:C.length===7&&(v=parseInt(C.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var T=C.indexOf("("),F=C.indexOf(")");if(T!==-1&&F+1===C.length){var k=C.substr(0,T),z=C.substr(T+1,F-(T+1)).split(","),H=1;switch(k){case"rgba":if(z.length!==4)return null;H=d(z.pop());case"rgb":return z.length!==3?null:[o(z[0]),o(z[1]),o(z[2]),H];case"hsla":if(z.length!==4)return null;H=d(z.pop());case"hsl":if(z.length!==3)return null;var $=(parseFloat(z[0])%360+360)%360/360,ee=d(z[1]),ae=d(z[2]),fe=ae<=.5?ae*(ee+1):ae+ee-ae*ee,ve=2*ae-fe;return[i(255*f(ve,fe,$+1/3)),i(255*f(ve,fe,$)),i(255*f(ve,fe,$-1/3)),H];default:return null}}return null}}catch{}return Ol}();class jn{constructor(i,o,d,f=1){this.r=i,this.g=o,this.b=d,this.a=f}static parse(i){if(!i)return;if(i instanceof jn)return i;if(typeof i!="string")return;const o=Cl.parseCSSColor(i);return o?new jn(o[0]/255,o[1]/255,o[2]/255,o[3]):void 0}toString(){const[i,o,d,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*o)},${Math.round(255*d)},${f})`}toNonPremultipliedRenderColor(i){const{r:o,g:d,b:f,a:m}=this;return new Hh(i,o,d,f,m)}toPremultipliedRenderColor(i){const{r:o,g:d,b:f,a:m}=this;return new vu(i,o*m,d*m,f*m,m)}clone(){return new jn(this.r,this.g,this.b,this.a)}}class No{constructor(i,o,d,f,m,v=!1){if(this.premultiplied=!1,this.premultiplied=v,i){const C=i.image.height,T=C*C;this.premultiplied?(o=m===0?0:o/m*(C-1),d=m===0?0:d/m*(C-1),f=m===0?0:f/m*(C-1)):(o*=C-1,d*=C-1,f*=C-1);const F=Math.floor(o),k=Math.floor(d),z=Math.floor(f),H=Math.ceil(o),$=Math.ceil(d),ee=Math.ceil(f),ae=o-F,fe=d-k,ve=f-z,Fe=i.image.data,Pe=4*(F+k*T+z*C),ue=4*(F+k*T+ee*C),Ie=4*(F+$*T+z*C),ke=4*(F+$*T+ee*C),Ge=4*(H+k*T+z*C),yt=4*(H+k*T+ee*C),At=4*(H+$*T+z*C),_t=4*(H+$*T+ee*C);if(Pe<0||_t>=Fe.length)throw new Error("out of range");this.r=Er(Er(Er(Fe[Pe],Fe[ue],ve),Er(Fe[Ie],Fe[ke],ve),fe),Er(Er(Fe[Ge],Fe[yt],ve),Er(Fe[At],Fe[_t],ve),fe),ae)/255*(this.premultiplied?m:1),this.g=Er(Er(Er(Fe[Pe+1],Fe[ue+1],ve),Er(Fe[Ie+1],Fe[ke+1],ve),fe),Er(Er(Fe[Ge+1],Fe[yt+1],ve),Er(Fe[At+1],Fe[_t+1],ve),fe),ae)/255*(this.premultiplied?m:1),this.b=Er(Er(Er(Fe[Pe+2],Fe[ue+2],ve),Er(Fe[Ie+2],Fe[ke+2],ve),fe),Er(Er(Fe[Ge+2],Fe[yt+2],ve),Er(Fe[At+2],Fe[_t+2],ve),fe),ae)/255*(this.premultiplied?m:1),this.a=m}else this.r=o,this.g=d,this.b=f,this.a=m}toArray(){const{r:i,g:o,b:d,a:f}=this;return[255*i,255*o,255*d,f]}toHslaArray(){let{r:i,g:o,b:d,a:f}=this;if(this.premultiplied){if(f===0)return[0,0,0,0];i/=f,o/=f,d/=f}const m=Math.min(Math.max(i,0),1),v=Math.min(Math.max(o,0),1),C=Math.min(Math.max(d,0),1),T=Math.min(m,v,C),F=Math.max(m,v,C),k=(T+F)/2;if(T===F)return[0,0,100*k,f];const z=F-T,H=k>.5?z/(2-F-T):z/(F+T);let $=0;return F===m?$=(v-C)/z+(v<C?6:0):F===v?$=(C-m)/z+2:F===C&&($=(m-v)/z+4),$*=60,[Math.min(Math.max($,0),360),Math.min(Math.max(100*H,0),100),Math.min(Math.max(100*k,0),100),f]}toArray01(){const{r:i,g:o,b:d,a:f}=this;return[i,o,d,f]}toArray01Scaled(i){const{r:o,g:d,b:f}=this;return[o*i,d*i,f*i]}toArray01Linear(){const{r:i,g:o,b:d,a:f}=this;return[Math.pow(i,2.2),Math.pow(o,2.2),Math.pow(d,2.2),f]}}class Hh extends No{constructor(i,o,d,f,m){super(i,o,d,f,m,!1)}}class vu extends No{constructor(i,o,d,f,m){super(i,o,d,f,m,!0)}}function Er(l,i,o){return l*(1-o)+i*o}function fh(l,i,o){return l.map((d,f)=>Er(d,i[f],o))}jn.black=new jn(0,0,0,1),jn.white=new jn(1,1,1,1),jn.transparent=new jn(0,0,0,0),jn.red=new jn(1,0,0,1),jn.blue=new jn(0,0,1,1);var Gc=Object.freeze({__proto__:null,array:fh,color:function(l,i,o){return new jn(Er(l.r,i.r,o),Er(l.g,i.g,o),Er(l.b,i.b,o),Er(l.a,i.a,o))},number:Er});function Cc(l,...i){for(const o of i)for(const d in o)l[d]=o[d];return l}class Oa extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class Qh{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[d,f]of o)this.bindings[d]=f}concat(i){return new Qh(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const Nu={kind:"null"},dr={kind:"number"},kn={kind:"string"},Fn={kind:"boolean"},sa={kind:"color"},Ul={kind:"object"},ie={kind:"value"},Ue={kind:"collator"},Tt={kind:"formatted"},jt={kind:"resolvedImage"};function hi(l,i){return{kind:"array",itemType:l,N:i}}function Ii(l){if(l.kind==="array"){const i=Ii(l.itemType);return typeof l.N=="number"?`array<${i}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${i}>`}return l.kind}const mr=[Nu,dr,kn,Fn,sa,Tt,Ul,hi(ie),jt];function Vr(l,i){if(i.kind==="error")return null;if(l.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Vr(l.itemType,i.itemType))&&(typeof l.N!="number"||l.N===i.N))return null}else{if(l.kind===i.kind)return null;if(l.kind==="value"){for(const o of mr)if(!Vr(o,i))return null}}return`Expected ${Ii(l)} but found ${Ii(i)} instead.`}function cn(l,i){return i.some(o=>o.kind===l.kind)}function Rn(l,i){return i.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}function Dn(l,i){return l.kind==="array"&&i.kind==="array"?l.N===i.N&&Dn(l.itemType,i.itemType):l.kind===i.kind}class As{constructor(i,o,d){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zs{constructor(i,o,d,f,m){this.text=i.normalize?i.normalize():i,this.image=o,this.scale=d,this.fontStack=f,this.textColor=m}}class ts{constructor(i){this.sections=i}static fromString(i){return new ts([new Zs(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||!!i.image&&i.image.hasPrimary())}static factory(i){return i instanceof ts?i:ts.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const o of this.sections){if(o.image){const f=o.image.getPrimary().id.toString();i.push(["image",f]);continue}i.push(o.text);const d={};o.fontStack&&(d["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(d["font-scale"]=o.scale),o.textColor&&(d["text-color"]=["rgba"].concat(o.textColor.toNonPremultipliedRenderColor(null).toArray())),i.push(d)}return i}}class bn{constructor(i,o={}){if(this.id=na.from(i),this.options=Object.assign({},o),o.transform){const{a:d,b:f,c:m,d:v,e:C,f:T}=o.transform;this.options.transform=new DOMMatrix([d,f,m,v,C,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:o,c:d,d:f,e:m,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:o,c:d,d:f,e:m,f:v}})}static parse(i){let o,d,f,m;try{({name:o,iconsetId:d,params:f,transform:m}=JSON.parse(i)||{})}catch{return null}if(!o)return null;const{a:v,b:C,c:T,d:F,e:k,f:z}=m||{};return new bn({name:o,iconsetId:d},{params:f,transform:new DOMMatrix([v,C,T,F,k,z])})}scaleSelf(i,o){return this.options.transform.scaleSelf(i,o),this}}class Js{constructor(i,o,d,f,m=!1){this.primaryId=na.from(i),this.primaryOptions=o,d&&(this.secondaryId=na.from(d)),this.secondaryOptions=f,this.available=m}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new bn(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new bn(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?Js.build({name:i}):i}static build(i,o,d,f){return!i||typeof i=="object"&&!("name"in i)?null:new Js(i,d,o,f)}}function vo(l,i,o,d){return typeof l=="number"&&l>=0&&l<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[l,i,o,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[l,i,o,d]:[l,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wr(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof jn||l instanceof As||l instanceof ts||l instanceof Js)return!0;if(Array.isArray(l)){for(const i of l)if(!Wr(i))return!1;return!0}if(typeof l=="object"){for(const i in l)if(!Wr(l[i]))return!1;return!0}return!1}function ji(l){if(l===null)return Nu;if(typeof l=="string")return kn;if(typeof l=="boolean")return Fn;if(typeof l=="number")return dr;if(l instanceof jn)return sa;if(l instanceof As)return Ue;if(l instanceof ts)return Tt;if(l instanceof Js)return jt;if(Array.isArray(l)){const i=l.length;let o;for(const d of l){const f=ji(d);if(o){if(o===f)continue;o=ie;break}o=f}return hi(o||ie,i)}return Ul}function eo(l){const i=typeof l;return l===null?"":i==="string"||i==="number"||i==="boolean"?String(l):l instanceof ts||l instanceof Js||l instanceof jn?l.toString():JSON.stringify(l)}class Pr{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Wr(i[1]))return o.error("invalid value");const d=i[1];let f=ji(d);const m=o.expectedType;return f.kind!=="array"||f.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(f=m),new Pr(f,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof jn?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof ts?this.value.serialize():this.value}}class Es{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const lo={string:kn,number:dr,boolean:Fn,object:Ul};class wr{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let d,f=1;const m=i[0];if(m==="array"){let C,T;if(i.length>2){const F=i[1];if(typeof F!="string"||!(F in lo)||F==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);C=lo[F],f++}else C=ie;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=i[2],f++}d=hi(C,T)}else d=lo[m];const v=[];for(;f<i.length;f++){const C=o.parse(i[f],f,ie);if(!C)return null;v.push(C)}return new wr(d,v)}evaluate(i){for(let o=0;o<this.args.length;o++){const d=this.args[o].evaluate(i);if(!Vr(this.type,ji(d)))return d;if(o===this.args.length-1)throw new Es(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${Ii(ji(d))} but was expected to be of type ${Ii(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,o=[i.kind];if(i.kind==="array"){const d=i.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){o.push(d.kind);const f=i.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(d=>d.serialize()))}}class _o{constructor(i){this.type=Tt,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const d=i[1];if(!Array.isArray(d)&&typeof d=="object")return o.error("First argument must be an image or text section.");const f=[];let m=!1;for(let v=1;v<=i.length-1;++v){const C=i[v];if(m&&typeof C=="object"&&!Array.isArray(C)){m=!1;let T=null;if(C["font-scale"]&&(T=o.parseObjectValue(C["font-scale"],v,"font-scale",dr),!T))return null;let F=null;if(C["text-font"]&&(F=o.parseObjectValue(C["text-font"],v,"text-font",hi(kn)),!F))return null;let k=null;if(C["text-color"]&&(k=o.parseObjectValue(C["text-color"],v,"text-color",sa),!k))return null;const z=f[f.length-1];z.scale=T,z.font=F,z.textColor=k}else{const T=o.parse(i[v],v,ie);if(!T)return null;const F=T.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,f.push({content:T,scale:null,font:null,textColor:null})}}return new _o(f)}evaluate(i){return new ts(this.sections.map(o=>{const d=o.content.evaluate(i);return Dn(ji(d),jt)?new Zs("",d,null,null,null):new Zs(eo(d),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const o of this.sections){i.push(o.content.serialize());const d={};o.scale&&(d["font-scale"]=o.scale.serialize()),o.font&&(d["text-font"]=o.font.serialize()),o.textColor&&(d["text-color"]=o.textColor.serialize()),i.push(d)}return i}}class oc{constructor(i,o,d,f){this._imageWarnHistory={},this.type=jt,this.namePrimary=i,this.nameSecondary=o,d&&(this.paramsPrimary=d.params,this.iconsetIdPrimary=d.iconset?d.iconset.id:void 0),f&&(this.paramsSecondary=f.params,this.iconsetIdSecondary=f.iconset?f.iconset.id:void 0)}static parse(i,o){if(i.length<2)return o.error("Expected two or more arguments.");let d=1;const f=[];function m(){if(d<i.length){const C=o.parse(i[d],d++,kn);return C?(f.push({image:C,options:{}}),!0):(o.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(d<i.length){const T=i[d];if((C=T)===null||typeof C!="object"||Array.isArray(C))return!0;const F=T.params,k=T.iconset,z=o.concat(d);if(!F&&!k)return d++,!0;if(F){if(typeof F!="object"||F.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const H={},$=z.concat(void 0,"params");for(const ee in F){if(!ee)return $.error("Image parameter name should be non-empty"),!1;const ae=$.concat(void 0,ee).parse(F[ee],void 0,sa,void 0,{typeAnnotation:"coerce"});if(!ae)return!1;H[ee]=ae}f[f.length-1].options.params=H}if(k){if(typeof k!="object"||k.constructor!==Object)return z.error('Image options "iconset" should be an object'),!1;if(!k.id)return z.error('Image options "iconset" should have an "id" property'),!1;f[f.length-1].options.iconset=k}return d++,!0}var C;return!0}for(let C=0;C<2;C++)if(!m()||!v())return;return new oc(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(i,o){const d={};if(o){for(const f in o)if(o[f])try{d[f]=o[f].evaluate(i)}catch{continue}if(Object.keys(d).length!==0)return{params:d}}}evaluate(i){const o={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},d=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,f=Js.build(o,d,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(f&&i.availableImages){const m=f.getPrimary().id;if(f.available=i.availableImages.some(v=>na.isEqual(v,m)),f.available){const v=f.getSecondary()?f.getSecondary().id:null;v&&(f.available=i.availableImages.some(C=>na.isEqual(C,v)))}}return f}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&i(this.paramsPrimary[o]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&i(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(i,o){const d={};if(o&&(d.iconset={id:o}),i){d.params={};for(const f in i)i[f]&&(d.params[f]=i[f].serialize())}return Object.keys(d).length>0?d:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&i.push(o)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&i.push(o)}return i}}function fa(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const Yo={"to-boolean":Fn,"to-color":sa,"to-number":dr,"to-string":kn};class is{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const d=i[0],f=[];let m=Nu;if(d==="to-array"){if(!Array.isArray(i[1]))return null;const v=i[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);m=hi(o.expectedType.itemType,v)}else{if(!(v>0&&Wr(i[1][0])))return null;m=hi(ji(i[1][0]),v)}for(let C=0;C<v;C++){const T=i[1][C];let F;if(fa(T)==="array")F=o.parse(T,void 0,m.itemType);else{const k=fa(T);if(k!==m.itemType.kind)return o.error(`Expected ${m.itemType.kind} but found ${k}.`);F=o.registry.literal.parse(["literal",T===void 0?null:T],o)}if(!F)return null;f.push(F)}}else{if((d==="to-boolean"||d==="to-string")&&i.length!==2)return o.error("Expected one argument.");m=Yo[d];for(let v=1;v<i.length;v++){const C=o.parse(i[v],v,ie);if(!C)return null;f.push(C)}}return new is(m,f)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let o,d;for(const f of this.args){if(o=f.evaluate(i),d=null,o instanceof jn)return o;if(typeof o=="string"){const m=i.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(d=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:vo(o[0],o[1],o[2],o[3]),!d))return new jn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Es(d||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const d of this.args){if(o=d.evaluate(i),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Es(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?ts.fromString(eo(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Js.build(eo(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(o=>o.evaluate(i)):eo(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new _o([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new oc(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{i.push(o.serialize())}),i}}const Ko=["Unknown","Point","LineString","Polygon"];class Sc{constructor(i,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ko[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:d,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(d*o-i[0])+this.featureDistanceData.bearing[1]*(f*o-i[1])}return 0}parseColor(i){let o=this._parseColorCache[i];return o||(o=this._parseColorCache[i]=jn.parse(i)),o}getConfig(i){return this.options?this.options.get(i):null}}class Io{constructor(i,o,d,f,m){this.name=i,this.type=o,this._evaluate=d,this.args=f,this._overloadIndex=m}evaluate(i){if(!this._evaluate){const o=Io.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,o){const d=i[0],f=Io.definitions[d];if(!f)return o.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,C=[];let T=null,F=-1;for(const[k,z]of v){if(Array.isArray(k)&&k.length!==i.length-1)continue;C.push(k),F++,T=new cA(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const H=[];let $=!1;for(let ee=1;ee<i.length;ee++){const ae=i[ee],fe=Array.isArray(k)?k[ee-1]:k.type,ve=T.parse(ae,1+H.length,fe);if(!ve){$=!0;break}H.push(ve)}if(!$)if(Array.isArray(k)&&k.length!==H.length)T.error(`Expected ${k.length} arguments, but found ${H.length} instead.`);else{for(let ee=0;ee<H.length;ee++){const ae=Array.isArray(k)?k[ee]:k.type,fe=H[ee];T.concat(ee+1).checkSubtype(ae,fe.type)}if(T.errors.length===0)return new Io(d,m,z,H,F)}}if(C.length===1)o.errors.push(...T.errors);else{const k=(C.length?C:v.map(([H])=>H)).map(Ua).join(" | "),z=[];for(let H=1;H<i.length;H++){const $=o.parse(i[H],1+z.length);if(!$)return null;z.push(Ii($.type))}o.error(`Expected arguments of type ${k}, but found (${z.join(", ")}) instead.`)}return null}static register(i,o){Io.definitions=o;for(const d in o)i[d]=Io}}function Ua(l){return Array.isArray(l)?`(${l.map(Ii).join(", ")})`:`(${Ii(l.type)}...)`}class cl{constructor(i,o,d){this.type=Ue,this.locale=d,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const d=i[1];if(typeof d!="object"||Array.isArray(d))return o.error("Collator options argument must be an object.");const f=d["case-sensitive"]===void 0?o.parse(!1,1,Fn):o.parseObjectValue(d["case-sensitive"],1,"case-sensitive",Fn);if(!f)return null;const m=d["diacritic-sensitive"]===void 0?o.parse(!1,1,Fn):o.parseObjectValue(d["diacritic-sensitive"],1,"diacritic-sensitive",Fn);if(!m)return null;let v=null;return d.locale&&(v=o.parseObjectValue(d.locale,1,"locale",kn),!v)?null:new cl(f,m,v)}evaluate(i){return new As(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function qo(l,i,o=0,d=l.length-1,f=jo){for(;d>o;){if(d-o>600){const T=d-o+1,F=i-o+1,k=Math.log(T),z=.5*Math.exp(2*k/3),H=.5*Math.sqrt(k*z*(T-z)/T)*(F-T/2<0?-1:1);qo(l,i,Math.max(o,Math.floor(i-F*z/T+H)),Math.min(d,Math.floor(i+(T-F)*z/T+H)),f)}const m=l[i];let v=o,C=d;for(_u(l,o,i),f(l[d],m)>0&&_u(l,o,d);v<C;){for(_u(l,v,C),v++,C--;f(l[v],m)<0;)v++;for(;f(l[C],m)>0;)C--}f(l[o],m)===0?_u(l,o,C):(C++,_u(l,C,d)),C<=i&&(o=C+1),i<=C&&(d=C-1)}}function _u(l,i,o){const d=l[i];l[i]=l[o],l[o]=d}function jo(l,i){return l<i?-1:l>i?1:0}function zl(l){let i=0;for(let o,d,f=0,m=l.length,v=m-1;f<m;v=f++)o=l[f],d=l[v],i+=(d.x-o.x)*(o.y+d.y);return i}function Fa(l,i){l[0]=Math.min(l[0],i[0]),l[1]=Math.min(l[1],i[1]),l[2]=Math.max(l[2],i[0]),l[3]=Math.max(l[3],i[1])}function xo(l,i){return!(l[0]<=i[0]||l[2]>=i[2]||l[1]<=i[1]||l[3]>=i[3])}function oa(l,i,o){const d=l[0]-i[0],f=l[1]-i[1],m=l[0]-o[0],v=l[1]-o[1];return d*v-m*f==0&&d*m<=0&&f*v<=0}function Nl(l,i,o=!1){let d=!1;for(let C=0,T=i.length;C<T;C++){const F=i[C];for(let k=0,z=F.length,H=z-1;k<z;H=k++){const $=F[H],ee=F[k];if(oa(l,$,ee))return o;(m=$)[1]>(f=l)[1]!=(v=ee)[1]>f[1]&&f[0]<(v[0]-m[0])*(f[1]-m[1])/(v[1]-m[1])+m[0]&&(d=!d)}}var f,m,v;return d}function Ja(l,i,o,d){const f=d[0]-o[0],m=d[1]-o[1],v=(l[0]-o[0])*m-f*(l[1]-o[1]),C=(i[0]-o[0])*m-f*(i[1]-o[1]);return v>0&&C<0||v<0&&C>0}function pa(l,i,o,d){return(f=[d[0]-o[0],d[1]-o[1]])[0]*(m=[i[0]-l[0],i[1]-l[1]])[1]-f[1]*m[0]!=0&&!(!Ja(l,i,o,d)||!Ja(o,d,l,i));var f,m}function Ec(l){const i=new qt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new qt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const d of l[0])i.x>d.x&&(i.x=d.x),i.y>d.y&&(i.y=d.y),o.x<d.x&&(o.x=d.x),o.y<d.y&&(o.y=d.y);return{min:i,max:o}}const za=8192;function jl(l,i){const o=(180+l[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,f=Math.pow(2,i.z);return[Math.round(o*f*za),Math.round(d*f*za)]}function Sl(l,i){for(let o=0;o<i.length;o++)if(Nl(l,i[o]))return!0;return!1}function Wc(l,i,o){for(const d of o)for(let f=0,m=d.length,v=m-1;f<m;v=f++)if(pa(l,i,d[v],d[f]))return!0;return!1}function $o(l,i){for(let o=0;o<l.length;++o)if(!Nl(l[o],i))return!1;for(let o=0;o<l.length-1;++o)if(Wc(l[o],l[o+1],i))return!1;return!0}function El(l,i){for(let o=0;o<i.length;o++)if($o(l,i[o]))return!0;return!1}function La(l,i,o){const d=[];for(let f=0;f<l.length;f++){const m=[];for(let v=0;v<l[f].length;v++){const C=jl(l[f][v],o);Fa(i,C),m.push(C)}d.push(m)}return d}function Hl(l,i,o){const d=[];for(let f=0;f<l.length;f++){const m=La(l[f],i,o);d.push(m)}return d}function xu(l,i,o,d){if(l[0]<o[0]||l[0]>o[2]){const f=.5*d;let m=l[0]-o[0]>f?-d:o[0]-l[0]>f?d:0;m===0&&(m=l[0]-o[2]>f?-d:o[2]-l[0]>f?d:0),l[0]+=m}Fa(i,l)}function el(l,i,o,d){const f=Math.pow(2,d.z)*za,m=[d.x*za,d.y*za],v=[];if(!l)return v;for(const C of l)for(const T of C){const F=[T.x+m[0],T.y+m[1]];xu(F,i,o,f),v.push(F)}return v}function ju(l,i,o,d){const f=Math.pow(2,d.z)*za,m=[d.x*za,d.y*za],v=[];if(!l)return v;for(const T of l){const F=[];for(const k of T){const z=[k.x+m[0],k.y+m[1]];Fa(i,z),F.push(z)}v.push(F)}if(i[2]-i[0]<=f/2){(C=i)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const T of v)for(const F of T)xu(F,i,o,f)}var C;return v}class Ho{constructor(i,o){this.type=Fn,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Wr(i[1])){const d=i[1];if(d.type==="FeatureCollection")for(let f=0;f<d.features.length;++f){const m=d.features[f].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ho(d,d.features[f].geometry)}else if(d.type==="Feature"){const f=d.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Ho(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Ho(d,d)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,d){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(d.type==="Polygon"){const C=La(d.coordinates,m,v),T=el(o.geometry(),f,m,v);if(!xo(f,m))return!1;for(const F of T)if(!Nl(F,C))return!1}if(d.type==="MultiPolygon"){const C=Hl(d.coordinates,m,v),T=el(o.geometry(),f,m,v);if(!xo(f,m))return!1;for(const F of T)if(!Sl(F,C))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,d){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(d.type==="Polygon"){const C=La(d.coordinates,m,v),T=ju(o.geometry(),f,m,v);if(!xo(f,m))return!1;for(const F of T)if(!$o(F,C))return!1}if(d.type==="MultiPolygon"){const C=Hl(d.coordinates,m,v),T=ju(o.geometry(),f,m,v);if(!xo(f,m))return!1;for(const F of T)if(!El(F,C))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Ic={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Ql=1/298.257223563,bu=Ql*(2-Ql),ac=Math.PI/180;class Vl{static fromTile(i,o,d){const f=Math.PI*(1-2*(i+.5)/Math.pow(2,o)),m=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/ac;return new Vl(m,d)}static get units(){return Ic}constructor(i,o){if(i===void 0)throw new Error("No latitude given.");if(o&&!Ic[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(Ic).join(", ")}`);const d=6378.137*ac*(o?Ic[o]:1),f=Math.cos(i*ac),m=1/(1-bu*(1-f*f)),v=Math.sqrt(m);this.kx=d*v*f,this.ky=d*v*m*(1-bu)}distance(i,o){const d=To(i[0]-o[0])*this.kx,f=(i[1]-o[1])*this.ky;return Math.sqrt(d*d+f*f)}bearing(i,o){const d=To(o[0]-i[0])*this.kx;return Math.atan2(d,(o[1]-i[1])*this.ky)/ac}destination(i,o,d){const f=d*ac;return this.offset(i,Math.sin(f)*o,Math.cos(f)*o)}offset(i,o,d){return[i[0]+o/this.kx,i[1]+d/this.ky]}lineDistance(i){let o=0;for(let d=0;d<i.length-1;d++)o+=this.distance(i[d],i[d+1]);return o}area(i){let o=0;for(let d=0;d<i.length;d++){const f=i[d];for(let m=0,v=f.length,C=v-1;m<v;C=m++)o+=To(f[m][0]-f[C][0])*(f[m][1]+f[C][1])*(d?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(i,o){let d=0;if(o<=0)return i[0];for(let f=0;f<i.length-1;f++){const m=i[f],v=i[f+1],C=this.distance(m,v);if(d+=C,d>o)return wu(m,v,(o-(d-C))/C)}return i[i.length-1]}pointToSegmentDistance(i,o,d){let[f,m]=o,v=To(d[0]-f)*this.kx,C=(d[1]-m)*this.ky;if(v!==0||C!==0){const T=(To(i[0]-f)*this.kx*v+(i[1]-m)*this.ky*C)/(v*v+C*C);T>1?(f=d[0],m=d[1]):T>0&&(f+=v/this.kx*T,m+=C/this.ky*T)}return v=To(i[0]-f)*this.kx,C=(i[1]-m)*this.ky,Math.sqrt(v*v+C*C)}pointOnLine(i,o){let d=1/0,f=i[0][0],m=i[0][1],v=0,C=0;for(let T=0;T<i.length-1;T++){let F=i[T][0],k=i[T][1],z=To(i[T+1][0]-F)*this.kx,H=(i[T+1][1]-k)*this.ky,$=0;z===0&&H===0||($=(To(o[0]-F)*this.kx*z+(o[1]-k)*this.ky*H)/(z*z+H*H),$>1?(F=i[T+1][0],k=i[T+1][1]):$>0&&(F+=z/this.kx*$,k+=H/this.ky*$)),z=To(o[0]-F)*this.kx,H=(o[1]-k)*this.ky;const ee=z*z+H*H;ee<d&&(d=ee,f=F,m=k,v=T,C=$)}return{point:[f,m],index:v,t:Math.max(0,Math.min(1,C))}}lineSlice(i,o,d){let f=this.pointOnLine(d,i),m=this.pointOnLine(d,o);if(f.index>m.index||f.index===m.index&&f.t>m.t){const F=f;f=m,m=F}const v=[f.point],C=f.index+1,T=m.index;!Tc(d[C],v[0])&&C<=T&&v.push(d[C]);for(let F=C+1;F<=T;F++)v.push(d[F]);return Tc(d[T],m.point)||v.push(m.point),v}lineSliceAlong(i,o,d){let f=0;const m=[];for(let v=0;v<d.length-1;v++){const C=d[v],T=d[v+1],F=this.distance(C,T);if(f+=F,f>i&&m.length===0&&m.push(wu(C,T,(i-(f-F))/F)),f>=o)return m.push(wu(C,T,(o-(f-F))/F)),m;f>i&&m.push(T)}return m}bufferPoint(i,o){const d=o/this.ky,f=o/this.kx;return[i[0]-f,i[1]-d,i[0]+f,i[1]+d]}bufferBBox(i,o){const d=o/this.ky,f=o/this.kx;return[i[0]-f,i[1]-d,i[2]+f,i[3]+d]}insideBBox(i,o){return To(i[0]-o[0])>=0&&To(i[0]-o[2])<=0&&i[1]>=o[1]&&i[1]<=o[3]}}function Tc(l,i){return l[0]===i[0]&&l[1]===i[1]}function wu(l,i,o){const d=To(i[0]-l[0]);return[l[0]+d*o,l[1]+(i[1]-l[1])*o]}function To(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class tl{constructor(i=[],o=(d,f)=>d<f?-1:d>f?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:d}=this,f=o[i];for(;i>0;){const m=i-1>>1,v=o[m];if(d(f,v)>=0)break;o[i]=v,i=m}o[i]=f}_down(i){const{data:o,compare:d}=this,f=this.length>>1,m=o[i];for(;i<f;){let v=1+(i<<1);const C=v+1;if(C<this.length&&d(o[C],o[v])<0&&(v=C),d(o[v],m)>=0)break;o[i]=o[v],i=v}o[i]=m}}var wi=8192;function no(l,i){return i.dist-l.dist}const bo=100,po=50;function Gl(l){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==l.length)return!1;for(let o=0;o<i.length;o++)if(i[o]!==l[o])return!1;return!0}function Bu(l){return l[1]-l[0]+1}function Na(l,i){const o=l[1]>=l[0]&&l[1]<i;return o||console.warn("Distance Expression: Index is out of range"),o}function ph(l,i){if(l[0]>l[1])return[null,null];const o=Bu(l);if(i){if(o===2)return[l,null];const d=Math.floor(o/2);return[[l[0],l[0]+d],[l[0]+d,l[1]]]}{if(o===1)return[l,null];const d=Math.floor(o/2)-1;return[[l[0],l[0]+d],[l[0]+d+1,l[1]]]}}function ul(l,i){const o=[1/0,1/0,-1/0,-1/0];if(!Na(i,l.length))return o;for(let d=i[0];d<=i[1];++d)Fa(o,l[d]);return o}function gn(l){const i=[1/0,1/0,-1/0,-1/0];for(let o=0;o<l.length;++o)for(let d=0;d<l[o].length;++d)Fa(i,l[o][d]);return i}function Ma(l,i,o){if(Gl(l)||Gl(i))return NaN;let d=0,f=0;return l[2]<i[0]&&(d=i[0]-l[2]),l[0]>i[2]&&(d=l[0]-i[2]),l[1]>i[3]&&(f=l[1]-i[3]),l[3]<i[1]&&(f=i[1]-l[3]),o.distance([0,0],[d,f])}function lc(l){return 360*l-180}function rA(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function gh(l,i){const o=Math.pow(2,i.z),d=(l.y/wi+i.y)/o;return[lc((l.x/wi+i.x)/o),rA(d)]}function mh(l,i){const o=[];for(let d=0;d<l.length;++d)o.push(gh(l[d],i));return o}function Is(l,i,o){const d=o.pointOnLine(i,l).point;return o.distance(l,d)}function hd(l,i,o,d,f){const m=o.slice(d[0],d[1]+1);let v=1/0;for(let C=i[0];C<=i[1];++C)if((v=Math.min(v,Is(l[C],m,f)))===0)return 0;return v}function Hu(l,i,o,d,f){const m=Math.min(f.pointToSegmentDistance(l,o,d),f.pointToSegmentDistance(i,o,d)),v=Math.min(f.pointToSegmentDistance(o,l,i),f.pointToSegmentDistance(d,l,i));return Math.min(m,v)}function Pf(l,i,o,d,f){if(!Na(i,l.length)||!Na(d,o.length))return NaN;let m=1/0;for(let v=i[0];v<i[1];++v)for(let C=d[0];C<d[1];++C){if(pa(l[v],l[v+1],o[C],o[C+1]))return 0;m=Math.min(m,Hu(l[v],l[v+1],o[C],o[C+1],f))}return m}function $A(l,i,o,d,f){if(!Na(i,l.length)||!Na(d,o.length))return NaN;let m=1/0;for(let v=i[0];v<=i[1];++v)for(let C=d[0];C<=d[1];++C)if((m=Math.min(m,f.distance(l[v],o[C])))===0)return m;return m}function ZA(l,i,o){if(Nl(l,i,!0))return 0;let d=1/0;for(const f of i){const m=f.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[m-1]&&(d=Math.min(d,o.pointToSegmentDistance(l,f[m-1],f[0])))===0||(d=Math.min(d,Is(l,f,o)))===0)return d}return d}function nA(l,i,o,d){if(!Na(i,l.length))return NaN;for(let m=i[0];m<=i[1];++m)if(Nl(l[m],o,!0))return 0;let f=1/0;for(let m=i[0];m<i[1];++m)for(const v of o)for(let C=0,T=v.length,F=T-1;C<T;F=C++){if(pa(l[m],l[m+1],v[F],v[C]))return 0;f=Math.min(f,Hu(l[m],l[m+1],v[F],v[C],d))}return f}function yh(l,i){for(const o of l)for(let d=0;d<=o.length-1;++d)if(Nl(o[d],i,!0))return!0;return!1}function Rp(l,i,o,d=1/0){const f=gn(l),m=gn(i);if(d!==1/0&&Ma(f,m,o)>=d)return d;if(xo(f,m)){if(yh(l,i))return 0}else if(yh(i,l))return 0;let v=d;for(const C of l)for(let T=0,F=C.length,k=F-1;T<F;k=T++)for(const z of i)for(let H=0,$=z.length,ee=$-1;H<$;ee=H++){if(pa(C[k],C[T],z[ee],z[H]))return 0;v=Math.min(v,Hu(C[k],C[T],z[ee],z[H],o))}return v}function sA(l,i,o,d,f,m,v){if(m===null||v===null)return;const C=Ma(ul(d,m),ul(f,v),o);C<i&&l.push({dist:C,range1:m,range2:v})}function kf(l,i,o,d,f=1/0){let m=Math.min(d.distance(l[0],o[0][0]),f);if(m===0)return m;const v=new tl([{dist:0,range1:[0,l.length-1],range2:[0,0]}],no),C=i?po:bo,T=gn(o);for(;v.length;){const F=v.pop();if(F.dist>=m)continue;const k=F.range1;if(Bu(k)<=C){if(!Na(k,l.length))return NaN;if(i){const z=nA(l,k,o,d);if((m=Math.min(m,z))===0)return m}else for(let z=k[0];z<=k[1];++z){const H=ZA(l[z],o,d);if((m=Math.min(m,H))===0)return m}}else{const z=ph(k,i);if(z[0]!==null){const H=Ma(ul(l,z[0]),T,d);H<m&&v.push({dist:H,range1:z[0],range2:[0,0]})}if(z[1]!==null){const H=Ma(ul(l,z[1]),T,d);H<m&&v.push({dist:H,range1:z[1],range2:[0,0]})}}}return m}function Rf(l,i,o,d,f,m=1/0){let v=Math.min(m,f.distance(l[0],o[0]));if(v===0)return v;const C=new tl([{dist:0,range1:[0,l.length-1],range2:[0,o.length-1]}],no),T=i?po:bo,F=d?po:bo;for(;C.length;){const k=C.pop();if(k.dist>=v)continue;const z=k.range1,H=k.range2;if(Bu(z)<=T&&Bu(H)<=F){if(!Na(z,l.length)||!Na(H,o.length))return NaN;if(i&&d?v=Math.min(v,Pf(l,z,o,H,f)):i||d?i&&!d?v=Math.min(v,hd(o,H,l,z,f)):!i&&d&&(v=Math.min(v,hd(l,z,o,H,f))):v=Math.min(v,$A(l,z,o,H,f)),v===0)return v}else{const $=ph(z,i),ee=ph(H,d);sA(C,v,f,l,o,$[0],ee[0]),sA(C,v,f,l,o,$[0],ee[1]),sA(C,v,f,l,o,$[1],ee[0]),sA(C,v,f,l,o,$[1],ee[1])}}return v}function Vh(l,i,o,d,f=1/0){let m=f;const v=ul(l,[0,l.length-1]);for(const C of o)if(!(m!==1/0&&Ma(v,ul(C,[0,C.length-1]),d)>=m)&&(m=Math.min(m,Rf(l,i,C,!0,d,m)),m===0))return m;return m}function oA(l,i,o,d,f=1/0){let m=f;const v=ul(l,[0,l.length-1]);for(const C of o){if(m!==1/0&&Ma(v,gn(C),d)>=m)continue;const T=kf(l,i,C,d,m);if(isNaN(T))return T;if((m=Math.min(m,T))===0)return m}return m}function JA(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class vh{constructor(i,o){this.type=dr,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(Wr(i[1])){const d=i[1];if(d.type==="FeatureCollection"){for(let f=0;f<d.features.length;++f)if(JA(d.features[f].geometry.type))return new vh(d,d.features[f].geometry)}else if(d.type==="Feature"){if(JA(d.geometry.type))return new vh(d,d.geometry)}else if(JA(d.type))return new vh(d,d)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const o=i.geometry(),d=i.canonicalID();if(o!=null&&d!=null){if(i.geometryType()==="Point")return function(f,m,v){const C=[];for(const F of f)for(const k of F)C.push(gh(k,m));const T=new Vl(C[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?Rf(C,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T):v.type==="MultiLineString"?Vh(C,!1,v.coordinates,T):v.type==="Polygon"||v.type==="MultiPolygon"?oA(C,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,T):null}(o,d,this.geometries);if(i.geometryType()==="LineString")return function(f,m,v){const C=[];for(const F of f){const k=[];for(const z of F)k.push(gh(z,m));C.push(k)}const T=new Vl(C[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Vh(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,T);if(v.type==="MultiLineString"){let F=1/0;for(let k=0;k<v.coordinates.length;k++){const z=Vh(v.coordinates[k],!0,C,T,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}if(v.type==="Polygon"||v.type==="MultiPolygon"){let F=1/0;for(let k=0;k<C.length;k++){const z=oA(C[k],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,T,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}return null}(o,d,this.geometries);if(i.geometryType()==="Polygon")return function(f,m,v){const C=[];for(const F of function(k,z){const H=k.length;if(H<=1)return[k];const $=[];let ee,ae;for(let fe=0;fe<H;fe++){const ve=zl(k[fe]);ve!==0&&(k[fe].area=Math.abs(ve),ae===void 0&&(ae=ve<0),ae===ve<0?(ee&&$.push(ee),ee=[k[fe]]):ee.push(k[fe]))}return ee&&$.push(ee),$}(f)){const k=[];for(let z=0;z<F.length;++z)k.push(mh(F[z],m));C.push(k)}const T=new Vl(C[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return oA(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,T);if(v.type==="MultiLineString"){let F=1/0;for(let k=0;k<v.coordinates.length;k++){const z=oA(v.coordinates[k],!0,C,T,F);if(isNaN(z))return z;if((F=Math.min(F,z))===0)return F}return F}return v.type==="Polygon"||v.type==="MultiPolygon"?function(F,k,z){let H=1/0;for(const $ of F)for(const ee of k){const ae=Rp($,ee,z,H);if(isNaN(ae))return ae;if((H=Math.min(H,ae))===0)return H}return H}(v.type==="Polygon"?[v.coordinates]:v.coordinates,C,T):null}(o,d,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Qu(l){if(l instanceof Io&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Ho||l instanceof vh)return!1;if(l instanceof Wh)return l.featureConstant;let i=!0;return l.eachChild(o=>{i&&!Qu(o)&&(i=!1)}),i}function Cu(l){if(l instanceof Io&&l.name==="feature-state")return!1;let i=!0;return l.eachChild(o=>{i&&!Cu(o)&&(i=!1)}),i}function Vu(l){if(l instanceof Wh)return new Set([l.key]);let i=new Set;return l.eachChild(o=>{i=new Set([...i,...Vu(o)])}),i}function Gh(l,i){if(l instanceof Io&&i.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(d=>{o&&!Gh(d,i)&&(o=!1)}),o}function Df(l,i,o){return[l,i,o].filter(Boolean).join("")}function aA(l,i){switch(l){case"string":return eo(i);case"number":return+i;case"boolean":return!!i;case"color":return jn.parse(i);case"formatted":return ts.fromString(eo(i));case"resolvedImage":return Js.build(eo(i))}return i}function Of(l,i,o,d){return d!==void 0&&(l=d*Math.round(l/d)),i!==void 0&&l<i&&(l=i),o!==void 0&&l>o&&(l=o),l}class Wh{constructor(i,o,d,f=!1){this.type=i,this.key=o,this.scope=d,this.featureConstant=f}static parse(i,o){let d=o.expectedType;if(d==null&&(d=ie),i.length<2||i.length>3)return o.error("Invalid number of arguments for 'config' expression.");const f=o.parse(i[1],1);if(!(f instanceof Pr))return o.error("Key name of 'config' expression must be a string literal.");let m,v=!0;const C=eo(f.value);if(i.length>=3){const T=o.parse(i[2],2);if(!(T instanceof Pr))return o.error("Scope of 'config' expression must be a string literal.");m=eo(T.value)}if(o.options){const T=Df(C,m,o._scope),F=o.options.get(T);F&&(v=Qu(F.value||F.default))}return new Wh(d,C,m,v)}evaluate(i){const o=Df(this.key,this.scope,i.scope),d=i.getConfig(o);if(!d)return null;const{type:f,value:m,values:v,minValue:C,maxValue:T,stepValue:F}=d,k=d.default.evaluate(i);let z=k;if(m){const H=i.scope;i.scope=(H||"").split("").slice(1).join(""),z=m.evaluate(i),i.scope=H}return f&&(z=aA(f,z)),z===void 0||C===void 0&&T===void 0&&F===void 0||(typeof z=="number"?z=Of(z,C,T,F):Array.isArray(z)&&(z=z.map(H=>typeof H=="number"?Of(H,C,T,F):H))),m!==void 0&&z!==void 0&&v&&!v.includes(z)&&(z=k,f&&(z=aA(f,z))),(f&&f!==this.type||z!==void 0&&!Dn(ji(z),this.type))&&(z=aA(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.scope),i}}class lA{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const d=i[1];return o.scope.has(d)?new lA(d,o.scope.get(d)):o.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class cA{constructor(i,o=[],d,f=new Qh,m=[],v,C){this.registry=i,this.path=o,this.key=o.map(T=>typeof T=="string"?`['${T}']`:`[${T}]`).join(""),this.scope=f,this.errors=m,this.expectedType=d,this._scope=v,this.options=C}parse(i,o,d,f,m={}){return o||d?this.concat(o,null,d,f)._parse(i,m):this._parse(i,m)}parseObjectValue(i,o,d,f,m,v={}){return this.concat(o,d,f,m)._parse(i,v)}_parse(i,o){function d(f,m,v){return v==="assert"?new wr(m,[f]):v==="coerce"?new is(m,[f]):f}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(f){let m=f.parse(i,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,C=m.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||C.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(v,C))return null}else m=d(m,v,o.typeAnnotation||"coerce");else m=d(m,v,o.typeAnnotation||"assert")}if(!(m instanceof Pr)&&m.type.kind!=="resolvedImage"&&Xc(m)){const v=new Sc(this._scope,this.options);try{m=new Pr(m.type,m.evaluate(v))}catch(C){return this.error(C.message),null}}return m}return is.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,d,f){let m=typeof i=="number"?this.path.concat(i):this.path;m=typeof o=="string"?m.concat(o):m;const v=f?this.scope.concat(f):this.scope;return new cA(this.registry,m,d||null,v,this.errors,this._scope,this.options)}error(i,...o){const d=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new Oa(d,i))}checkSubtype(i,o){const d=Vr(i,o);return d&&this.error(d),d}}function Xc(l){if(l instanceof lA)return Xc(l.boundExpression);if(l instanceof Io&&l.name==="error"||l instanceof cl||l instanceof Ho||l instanceof vh||l instanceof Wh)return!1;const i=l instanceof is||l instanceof wr;let o=!0;return l.eachChild(d=>{o=i?o&&Xc(d):o&&d instanceof Pr}),!!o&&Qu(l)&&Gh(l,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Il(l,i){const o=l.length-1;let d,f,m=0,v=o,C=0;for(;m<=v;)if(C=Math.floor((m+v)/2),d=l[C],f=l[C+1],d<=i){if(C===o||i<f)return C;m=C+1}else{if(!(d>i))throw new Es("Input is not a number.");v=C-1}return 0}class il{constructor(i,o,d){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[f,m]of d)this.labels.push(f),this.outputs.push(m)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const d=o.parse(i[1],1,dr);if(!d)return null;const f=[];let m=null;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);for(let v=1;v<i.length;v+=2){const C=v===1?-1/0:i[v],T=i[v+1],F=v,k=v+1;if(typeof C!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(f.length&&f[f.length-1][0]>=C)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const z=o.parse(T,k,m);if(!z)return null;m=m||z.type,f.push([C,z])}return new il(m,d,f)}evaluate(i){const o=this.labels,d=this.outputs;if(o.length===1)return d[0].evaluate(i);const f=this.input.evaluate(i);if(f<=o[0])return d[0].evaluate(i);const m=o.length;return f>=o[m-1]?d[m-1].evaluate(i):d[Il(o,f)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&i.push(this.labels[o]),i.push(this.outputs[o].serialize());return i}}const Uf=.95047,ef=1.08883,Yc=4/29,Ba=6/29,zf=3*Ba*Ba,uA=Ba*Ba*Ba,dd=Math.PI/180,Nf=180/Math.PI;function hA(l){return l>uA?Math.pow(l,1/3):l/zf+Yc}function Ad(l){return l>Ba?l*l*l:zf*(l-Yc)}function dA(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Fc(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Xh(l){const i=Fc(l.r),o=Fc(l.g),d=Fc(l.b),f=hA((.4124564*i+.3575761*o+.1804375*d)/Uf),m=hA((.2126729*i+.7151522*o+.072175*d)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-hA((.0193339*i+.119192*o+.9503041*d)/ef)),alpha:l.a}}function Kc(l){let i=(l.l+16)/116,o=isNaN(l.a)?i:i+l.a/500,d=isNaN(l.b)?i:i-l.b/200;return i=1*Ad(i),o=Uf*Ad(o),d=ef*Ad(d),new jn(dA(3.2404542*o-1.5371385*i-.4985314*d),dA(-.969266*o+1.8760108*i+.041556*d),dA(.0556434*o-.2040259*i+1.0572252*d),l.alpha)}function tf(l,i,o){const d=i-l;return l+o*(d>180||d<-180?d-360*Math.round(d/360):d)}const _h={forward:Xh,reverse:Kc,interpolate:function(l,i,o){return{l:Er(l.l,i.l,o),a:Er(l.a,i.a,o),b:Er(l.b,i.b,o),alpha:Er(l.alpha,i.alpha,o)}}},Gu={forward:function(l){const{l:i,a:o,b:d}=Xh(l),f=Math.atan2(d,o)*Nf;return{h:f<0?f+360:f,c:Math.sqrt(o*o+d*d),l:i,alpha:l.a}},reverse:function(l){const i=l.h*dd,o=l.c;return Kc({l:l.l,a:Math.cos(i)*o,b:Math.sin(i)*o,alpha:l.alpha})},interpolate:function(l,i,o){return{h:tf(l.h,i.h,o),c:Er(l.c,i.c,o),l:Er(l.l,i.l,o),alpha:Er(l.alpha,i.alpha,o)}}};var jf=Object.freeze({__proto__:null,hcl:Gu,lab:_h});class Wl{constructor(i,o,d,f,m){this.type=i,this.operator=o,this.interpolation=d,this.input=f,this.labels=[],this.outputs=[];for(const[v,C]of m)this.labels.push(v),this.outputs.push(C)}static interpolationFactor(i,o,d,f){let m=0;if(i.name==="exponential")m=AA(o,i.base,d,f);else if(i.name==="linear")m=AA(o,1,d,f);else if(i.name==="cubic-bezier"){const v=i.controlPoints;m=new Lr(v[0],v[1],v[2],v[3]).solve(AA(o,1,d,f))}return m}static parse(i,o){let[d,f,m,...v]=i;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const F=f[1];if(typeof F!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:F}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const F=f.slice(1);if(F.length!==4||F.some(k=>typeof k!="number"||k<0||k>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:F}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,dr),!m)return null;const C=[];let T=null;d==="interpolate-hcl"||d==="interpolate-lab"?T=sa:o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let F=0;F<v.length;F+=2){const k=v[F],z=v[F+1],H=F+3,$=F+4;if(typeof k!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(C.length&&C[C.length-1][0]>=k)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const ee=o.parse(z,$,T);if(!ee)return null;T=T||ee.type,C.push([k,ee])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Wl(T,d,f,m,C):o.error(`Type ${Ii(T)} is not interpolatable.`)}evaluate(i){const o=this.labels,d=this.outputs;if(o.length===1)return d[0].evaluate(i);const f=this.input.evaluate(i);if(f<=o[0])return d[0].evaluate(i);const m=o.length;if(f>=o[m-1])return d[m-1].evaluate(i);const v=Il(o,f),C=Wl.interpolationFactor(this.interpolation,f,o[v],o[v+1]),T=d[v].evaluate(i),F=d[v+1].evaluate(i);return this.operator==="interpolate"?Gc[this.type.kind.toLowerCase()](T,F,C):this.operator==="interpolate-hcl"?Gu.reverse(Gu.interpolate(Gu.forward(T),Gu.forward(F),C)):_h.reverse(_h.interpolate(_h.forward(T),_h.forward(F),C))}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,i,this.input.serialize()];for(let d=0;d<this.labels.length;d++)o.push(this.labels[d],this.outputs[d].serialize());return o}}function AA(l,i,o,d){const f=d-o,m=l-o;return f===0?0:i===1?m/f:(Math.pow(i,m)-1)/(Math.pow(i,f)-1)}class fd{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expectected at least one argument.");let d=null;const f=o.expectedType;f&&f.kind!=="value"&&(d=f);const m=[];for(const C of i.slice(1)){const T=o.parse(C,1+m.length,d,void 0,{typeAnnotation:"omit"});if(!T)return null;d=d||T.type,m.push(T)}const v=f&&m.some(C=>Vr(f,C.type));return new fd(v?ie:d,m)}evaluate(i){let o,d=null,f=0;for(const m of this.args){if(f++,d=m.evaluate(i),d&&d instanceof Js&&!d.available&&(o||(o=d),d=null,f===this.args.length))return o;if(d!==null)break}return d}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class fA{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const d=[];for(let m=1;m<i.length-1;m+=2){const v=i[m];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,m);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const C=o.parse(i[m+1],m+1);if(!C)return null;d.push([v,C])}const f=o.parse(i[i.length-1],i.length-1,o.expectedType,d);return f?new fA(d,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[o,d]of this.bindings)i.push(o,d.serialize());return i.push(this.result.serialize()),i}}class rf{constructor(i,o,d){this.type=i,this.index=o,this.input=d}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=o.parse(i[1],1,dr),f=o.parse(i[2],2,hi(o.expectedType||ie));return d&&f?new rf(f.type.itemType,d,f):null}evaluate(i){const o=this.index.evaluate(i),d=this.input.evaluate(i);if(o<0)throw new Es(`Array index out of bounds: ${o} < 0.`);if(o>=d.length)throw new Es(`Array index out of bounds: ${o} > ${d.length-1}.`);if(o!==Math.floor(o))throw new Es(`Array index must be an integer, but found ${o} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return d[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class pA{constructor(i,o,d){this.type=i,this.index=o,this.input=d}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=o.parse(i[1],1,dr),f=o.parse(i[2],2,hi(o.expectedType||ie));return d&&f?new pA(f.type.itemType,d,f):null}evaluate(i){const o=this.index.evaluate(i),d=this.input.evaluate(i);if(o<0)throw new Es(`Array index out of bounds: ${o} < 0.`);if(o>d.length-1)throw new Es(`Array index out of bounds: ${o} > ${d.length-1}.`);if(o===Math.floor(o))return d[o];const f=Math.floor(o),m=Math.ceil(o),v=d[f],C=d[m];if(typeof v!="number"||typeof C!="number")throw new Es(`Cannot interpolate between non-number values at index ${o}.`);const T=o-f;return v*(1-T)+C*T}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class xh{constructor(i,o){this.type=Fn,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=o.parse(i[1],1,ie),f=o.parse(i[2],2,ie);return d&&f?cn(d.type,[Fn,kn,dr,Nu,ie])?new xh(d,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(d.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(d==null)return!1;if(!Rn(o,["boolean","string","number","null"]))throw new Es(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(ji(o))} instead.`);if(!Rn(d,["string","array"]))throw new Es(`Expected second argument to be of type array or string, but found ${Ii(ji(d))} instead.`);return d.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class pd{constructor(i,o,d){this.type=dr,this.needle=i,this.haystack=o,this.fromIndex=d}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=o.parse(i[1],1,ie),f=o.parse(i[2],2,ie);if(!d||!f)return null;if(!cn(d.type,[Fn,kn,dr,Nu,ie]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(d.type)} instead`);if(i.length===4){const m=o.parse(i[3],3,dr);return m?new pd(d,f,m):null}return new pd(d,f)}evaluate(i){const o=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!Rn(o,["boolean","string","number","null"]))throw new Es(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(ji(o))} instead.`);if(!Rn(d,["string","array"]))throw new Es(`Expected second argument to be of type array or string, but found ${Ii(ji(d))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(i);return d.indexOf(o,f)}return d.indexOf(o)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class bh{constructor(i,o,d,f,m,v){this.inputType=i,this.type=o,this.input=d,this.cases=f,this.outputs=m,this.otherwise=v}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let d,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const m={},v=[];for(let F=2;F<i.length-1;F+=2){let k=i[F];const z=i[F+1];Array.isArray(k)||(k=[k]);const H=o.concat(F);if(k.length===0)return H.error("Expected at least one branch label.");for(const ee of k){if(typeof ee!="number"&&typeof ee!="string")return H.error("Branch labels must be numbers or strings.");if(typeof ee=="number"&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ee=="number"&&Math.floor(ee)!==ee)return H.error("Numeric branch labels must be integer values.");if(d){if(H.checkSubtype(d,ji(ee)))return null}else d=ji(ee);if(m[String(ee)]!==void 0)return H.error("Branch labels must be unique.");m[String(ee)]=v.length}const $=o.parse(z,F,f);if(!$)return null;f=f||$.type,v.push($)}const C=o.parse(i[1],1,ie);if(!C)return null;const T=o.parse(i[i.length-1],i.length-1,f);return T?C.type.kind!=="value"&&o.concat(1).checkSubtype(d,C.type)?null:new bh(d,f,C,m,v,T):null}evaluate(i){const o=this.input.evaluate(i);return(Dn(ji(o),this.inputType)&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),d=[],f={};for(const v of o){const C=f[this.cases[v]];C===void 0?(f[this.cases[v]]=d.length,d.push([this.cases[v],[v]])):d[C][1].push(v)}const m=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,C]of d)i.push(C.length===1?m(C[0]):C.map(m)),i.push(this.outputs[v].serialize());return i.push(this.otherwise.serialize()),i}}class gA{constructor(i,o,d){this.type=i,this.branches=o,this.otherwise=d}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);const f=[];for(let v=1;v<i.length-1;v+=2){const C=o.parse(i[v],v,Fn);if(!C)return null;const T=o.parse(i[v+1],v+1,d);if(!T)return null;f.push([C,T]),d=d||T.type}const m=o.parse(i[i.length-1],i.length-1,d);return m?new gA(d,f,m):null}evaluate(i){for(const[o,d]of this.branches)if(o.evaluate(i))return d.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,d]of this.branches)i(o),i(d);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class D{constructor(i,o,d,f){this.type=i,this.input=o,this.beginIndex=d,this.endIndex=f}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=o.parse(i[1],1,ie),f=o.parse(i[2],2,dr);if(!d||!f)return null;if(!cn(d.type,[hi(ie),kn,ie]))return o.error(`Expected first argument to be of type array or string, but found ${Ii(d.type)} instead`);if(i.length===4){const m=o.parse(i[3],3,dr);return m?new D(d.type,d,f,m):null}return new D(d.type,d,f)}evaluate(i){const o=this.input.evaluate(i),d=this.beginIndex.evaluate(i);if(!Rn(o,["string","array"]))throw new Es(`Expected first argument to be of type array or string, but found ${Ii(ji(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(i);return o.slice(d,f)}return o.slice(d)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function K(l,i){return l==="=="||l==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function se(l,i,o,d){return d.compare(i,o)===0}function xe(l,i,o){const d=l!=="=="&&l!=="!=";return class JT{constructor(m,v,C){this.type=Fn,this.lhs=m,this.rhs=v,this.collator=C,this.hasUntypedArgument=m.type.kind==="value"||v.type.kind==="value"}static parse(m,v){if(m.length!==3&&m.length!==4)return v.error("Expected two or three arguments.");const C=m[0];let T=v.parse(m[1],1,ie);if(!T)return null;if(!K(C,T.type))return v.concat(1).error(`"${C}" comparisons are not supported for type '${Ii(T.type)}'.`);let F=v.parse(m[2],2,ie);if(!F)return null;if(!K(C,F.type))return v.concat(2).error(`"${C}" comparisons are not supported for type '${Ii(F.type)}'.`);if(T.type.kind!==F.type.kind&&T.type.kind!=="value"&&F.type.kind!=="value")return v.error(`Cannot compare types '${Ii(T.type)}' and '${Ii(F.type)}'.`);d&&(T.type.kind==="value"&&F.type.kind!=="value"?T=new wr(F.type,[T]):T.type.kind!=="value"&&F.type.kind==="value"&&(F=new wr(T.type,[F])));let k=null;if(m.length===4){if(T.type.kind!=="string"&&F.type.kind!=="string"&&T.type.kind!=="value"&&F.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(k=v.parse(m[3],3,Ue),!k)return null}return new JT(T,F,k)}evaluate(m){const v=this.lhs.evaluate(m),C=this.rhs.evaluate(m);if(d&&this.hasUntypedArgument){const T=ji(v),F=ji(C);if(T.kind!==F.kind||T.kind!=="string"&&T.kind!=="number")throw new Es(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${T.kind}, ${F.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const T=ji(v),F=ji(C);if(T.kind!=="string"||F.kind!=="string")return i(m,v,C)}return this.collator?o(m,v,C,this.collator.evaluate(m)):i(m,v,C)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[l];return this.eachChild(v=>{m.push(v.serialize())}),m}}}const Oe=xe("==",function(l,i,o){return i===o},se),Ke=xe("!=",function(l,i,o){return i!==o},function(l,i,o,d){return!se(0,i,o,d)}),et=xe("<",function(l,i,o){return i<o},function(l,i,o,d){return d.compare(i,o)<0}),st=xe(">",function(l,i,o){return i>o},function(l,i,o,d){return d.compare(i,o)>0}),dt=xe("<=",function(l,i,o){return i<=o},function(l,i,o,d){return d.compare(i,o)<=0}),wt=xe(">=",function(l,i,o){return i>=o},function(l,i,o,d){return d.compare(i,o)>=0});class Xt{constructor(i,o,d,f,m,v){this.type=kn,this.number=i,this.locale=o,this.currency=d,this.unit=f,this.minFractionDigits=m,this.maxFractionDigits=v}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const d=o.parse(i[1],1,dr);if(!d)return null;const f=i[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let m=null;if(f.locale&&(m=o.parseObjectValue(f.locale,2,"locale",kn),!m))return null;let v=null;if(f.currency&&(v=o.parseObjectValue(f.currency,2,"currency",kn),!v))return null;let C=null;if(f.unit&&(C=o.parseObjectValue(f.unit,2,"unit",kn),!C))return null;let T=null;if(f["min-fraction-digits"]&&(T=o.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",dr),!T))return null;let F=null;return f["max-fraction-digits"]&&(F=o.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",dr),!F)?null:new Xt(d,m,v,C,T,F)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class xi{constructor(i){this.type=dr,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const d=o.parse(i[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Ii(d.type)} instead.`):new xi(d):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Es(`Expected value to be of type string or array, but found ${Ii(ji(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(o=>{i.push(o.serialize())}),i}}function Bi(l){return function(){l=1831565813+(l|=0)|0;let i=Math.imul(l^l>>>15,1|l);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const ci={"==":Oe,"!=":Ke,">":st,"<":et,">=":wt,"<=":dt,array:wr,at:rf,"at-interpolated":pA,boolean:wr,case:gA,coalesce:fd,collator:cl,format:_o,image:oc,in:xh,"index-of":pd,interpolate:Wl,"interpolate-hcl":Wl,"interpolate-lab":Wl,length:xi,let:fA,literal:Pr,match:bh,number:wr,"number-format":Xt,object:wr,slice:D,step:il,string:wr,"to-boolean":is,"to-color":is,"to-number":is,"to-string":is,var:lA,within:Ho,distance:vh,config:Wh};function Hi(l,[i,o,d,f]){i=i.evaluate(l),o=o.evaluate(l),d=d.evaluate(l);const m=f?f.evaluate(l):1,v=vo(i,o,d,m);if(v)throw new Es(v);return new jn(i/255,o/255,d/255,m)}function Ni(l,[i,o,d,f]){i=i.evaluate(l),o=o.evaluate(l),d=d.evaluate(l);const m=f?f.evaluate(l):1,v=function(F,k,z,H){return typeof F=="number"&&F>=0&&F<=360?typeof k=="number"&&k>=0&&k<=100&&typeof z=="number"&&z>=0&&z<=100?H===void 0||typeof H=="number"&&H>=0&&H<=1?null:`Invalid hsla value [${[F,k,z,H].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof H=="number"?[F,k,z,H]:[F,k,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof H=="number"?[F,k,z,H]:[F,k,z]).join(", ")}]: 'h' must be between 0 and 360.`}(i,o,d,m);if(v)throw new Es(v);const C=`hsla(${i}, ${o}%, ${d}%, ${m})`,T=jn.parse(C);if(!T)throw new Es(`Failed to parse HSLA color: ${C}`);return T}function Zt(l,i){return l in i}function ei(l,i){const o=i[l];return o===void 0?null:o}function qi(l){return{type:l}}function cr(l){return{result:"success",value:l}}function $i(l){return{result:"error",value:l}}function Xr(l,i){return!!l&&!!l.parameters&&l.parameters.indexOf(i)>-1}function Tr(l){return l["property-type"]==="data-driven"}function wn(l){return Xr(l.expression,"measure-light")}function zr(l){return Xr(l.expression,"zoom")}function Ms(l){return!!l.expression&&l.expression.interpolated}function Vs(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function Ps(l){return l}function Ar(l,i){const o=i.type==="color",d=l.stops&&typeof l.stops[0][0]=="object",f=d||!(d||l.property!==void 0),m=l.type||(Ms(i)?"exponential":"interval");if(o&&((l=Cc({},l)).stops&&(l.stops=l.stops.map(F=>[F[0],jn.parse(F[1])])),l.default=jn.parse(l.default?l.default:i.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!jf[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let v,C,T;if(m==="exponential")v=$s;else if(m==="interval")v=Kn;else if(m==="categorical"){v=co,C=Object.create(null);for(const F of l.stops)C[F[0]]=F[1];T=typeof l.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=Tl}if(d){const F={},k=[];for(let $=0;$<l.stops.length;$++){const ee=l.stops[$],ae=ee[0].zoom;F[ae]===void 0&&(F[ae]={zoom:ae,type:l.type,property:l.property,default:l.default,stops:[]},k.push(ae)),F[ae].stops.push([ee[0].value,ee[1]])}const z=[];for(const $ of k)z.push([F[$].zoom,Ar(F[$],i)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Wl.interpolationFactor.bind(void 0,H),zoomStops:z.map($=>$[0]),evaluate:({zoom:$},ee)=>$s({stops:z,base:l.base},i,$).evaluate($,ee)}}if(f){const F=m==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Wl.interpolationFactor.bind(void 0,F),zoomStops:l.stops.map(k=>k[0]),evaluate:({zoom:k})=>v(l,i,k,C,T)}}return{kind:"source",evaluate(F,k){const z=k&&k.properties?k.properties[l.property]:void 0;return z===void 0?ys(l.default,i.default):v(l,i,z,C,T)}}}function ys(l,i,o){return l!==void 0?l:i!==void 0?i:o!==void 0?o:void 0}function co(l,i,o,d,f){return ys(typeof o===f?d[o]:void 0,l.default,i.default)}function Kn(l,i,o){if(fa(o)!=="number")return ys(l.default,i.default);const d=l.stops.length;if(d===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[d-1][0])return l.stops[d-1][1];const f=Il(l.stops.map(m=>m[0]),o);return l.stops[f][1]}function $s(l,i,o){const d=l.base!==void 0?l.base:1;if(fa(o)!=="number")return ys(l.default,i.default);const f=l.stops.length;if(f===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[f-1][0])return l.stops[f-1][1];const m=Il(l.stops.map(k=>k[0]),o),v=function(k,z,H,$){const ee=$-H,ae=k-H;return ee===0?0:z===1?ae/ee:(Math.pow(z,ae)-1)/(Math.pow(z,ee)-1)}(o,d,l.stops[m][0],l.stops[m+1][0]),C=l.stops[m][1],T=l.stops[m+1][1];let F=Gc[i.type]||Ps;if(l.colorSpace&&l.colorSpace!=="rgb"){const k=jf[l.colorSpace];F=(z,H)=>k.reverse(k.interpolate(k.forward(z),k.forward(H),v))}return typeof C.evaluate=="function"?{evaluate(...k){const z=C.evaluate.apply(void 0,k),H=T.evaluate.apply(void 0,k);if(z!==void 0&&H!==void 0)return F(z,H,v)}}:F(C,T,v)}function Tl(l,i,o){return i.type==="color"?o=jn.parse(o):i.type==="formatted"?o=ts.fromString(o.toString()):i.type==="resolvedImage"?o=Js.build(o.toString()):fa(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0),ys(o,l.default,i.default)}Io.register(ci,{error:[{kind:"error"},[kn],(l,[i])=>{throw new Es(i.evaluate(l))}],typeof:[kn,[ie],(l,[i])=>Ii(ji(i.evaluate(l)))],"to-rgba":[hi(dr,4),[sa],(l,[i])=>i.evaluate(l).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[hi(dr,4),[sa],(l,[i])=>i.evaluate(l).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[sa,[dr,dr,dr],Hi],rgba:[sa,[dr,dr,dr,dr],Hi],hsl:[sa,[dr,dr,dr],Ni],hsla:[sa,[dr,dr,dr,dr],Ni],has:{type:Fn,overloads:[[[kn],(l,[i])=>Zt(i.evaluate(l),l.properties())],[[kn,Ul],(l,[i,o])=>Zt(i.evaluate(l),o.evaluate(l))]]},get:{type:ie,overloads:[[[kn],(l,[i])=>ei(i.evaluate(l),l.properties())],[[kn,Ul],(l,[i,o])=>ei(i.evaluate(l),o.evaluate(l))]]},"feature-state":[ie,[kn],(l,[i])=>ei(i.evaluate(l),l.featureState||{})],properties:[Ul,[],l=>l.properties()],"geometry-type":[kn,[],l=>l.geometryType()],worldview:[kn,[],l=>l.globals.worldview||""],id:[ie,[],l=>l.id()],zoom:[dr,[],l=>l.globals.zoom],pitch:[dr,[],l=>l.globals.pitch||0],"distance-from-center":[dr,[],l=>l.distanceFromCenter()],"measure-light":[dr,[kn],(l,[i])=>l.measureLight(i.evaluate(l))],"heatmap-density":[dr,[],l=>l.globals.heatmapDensity||0],"line-progress":[dr,[],l=>l.globals.lineProgress||0],"raster-value":[dr,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[dr,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[dr,[],l=>l.globals.skyRadialProgress||0],accumulated:[ie,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[dr,qi(dr),(l,i)=>{let o=0;for(const d of i)o+=d.evaluate(l);return o}],"*":[dr,qi(dr),(l,i)=>{let o=1;for(const d of i)o*=d.evaluate(l);return o}],"-":{type:dr,overloads:[[[dr,dr],(l,[i,o])=>i.evaluate(l)-o.evaluate(l)],[[dr],(l,[i])=>-i.evaluate(l)]]},"/":[dr,[dr,dr],(l,[i,o])=>i.evaluate(l)/o.evaluate(l)],"%":[dr,[dr,dr],(l,[i,o])=>i.evaluate(l)%o.evaluate(l)],ln2:[dr,[],()=>Math.LN2],pi:[dr,[],()=>Math.PI],e:[dr,[],()=>Math.E],"^":[dr,[dr,dr],(l,[i,o])=>Math.pow(i.evaluate(l),o.evaluate(l))],sqrt:[dr,[dr],(l,[i])=>Math.sqrt(i.evaluate(l))],log10:[dr,[dr],(l,[i])=>Math.log(i.evaluate(l))/Math.LN10],ln:[dr,[dr],(l,[i])=>Math.log(i.evaluate(l))],log2:[dr,[dr],(l,[i])=>Math.log(i.evaluate(l))/Math.LN2],sin:[dr,[dr],(l,[i])=>Math.sin(i.evaluate(l))],cos:[dr,[dr],(l,[i])=>Math.cos(i.evaluate(l))],tan:[dr,[dr],(l,[i])=>Math.tan(i.evaluate(l))],asin:[dr,[dr],(l,[i])=>Math.asin(i.evaluate(l))],acos:[dr,[dr],(l,[i])=>Math.acos(i.evaluate(l))],atan:[dr,[dr],(l,[i])=>Math.atan(i.evaluate(l))],min:[dr,qi(dr),(l,i)=>Math.min(...i.map(o=>o.evaluate(l)))],max:[dr,qi(dr),(l,i)=>Math.max(...i.map(o=>o.evaluate(l)))],abs:[dr,[dr],(l,[i])=>Math.abs(i.evaluate(l))],round:[dr,[dr],(l,[i])=>{const o=i.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[dr,[dr],(l,[i])=>Math.floor(i.evaluate(l))],ceil:[dr,[dr],(l,[i])=>Math.ceil(i.evaluate(l))],"filter-==":[Fn,[kn,ie],(l,[i,o])=>l.properties()[i.value]===o.value],"filter-id-==":[Fn,[ie],(l,[i])=>l.id()===i.value],"filter-type-==":[Fn,[kn],(l,[i])=>l.geometryType()===i.value],"filter-<":[Fn,[kn,ie],(l,[i,o])=>{const d=l.properties()[i.value],f=o.value;return typeof d==typeof f&&d<f}],"filter-id-<":[Fn,[ie],(l,[i])=>{const o=l.id(),d=i.value;return typeof o==typeof d&&o<d}],"filter->":[Fn,[kn,ie],(l,[i,o])=>{const d=l.properties()[i.value],f=o.value;return typeof d==typeof f&&d>f}],"filter-id->":[Fn,[ie],(l,[i])=>{const o=l.id(),d=i.value;return typeof o==typeof d&&o>d}],"filter-<=":[Fn,[kn,ie],(l,[i,o])=>{const d=l.properties()[i.value],f=o.value;return typeof d==typeof f&&d<=f}],"filter-id-<=":[Fn,[ie],(l,[i])=>{const o=l.id(),d=i.value;return typeof o==typeof d&&o<=d}],"filter->=":[Fn,[kn,ie],(l,[i,o])=>{const d=l.properties()[i.value],f=o.value;return typeof d==typeof f&&d>=f}],"filter-id->=":[Fn,[ie],(l,[i])=>{const o=l.id(),d=i.value;return typeof o==typeof d&&o>=d}],"filter-has":[Fn,[ie],(l,[i])=>i.value in l.properties()],"filter-has-id":[Fn,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Fn,[hi(kn)],(l,[i])=>i.value.indexOf(l.geometryType())>=0],"filter-id-in":[Fn,[hi(ie)],(l,[i])=>i.value.indexOf(l.id())>=0],"filter-in-small":[Fn,[kn,hi(ie)],(l,[i,o])=>o.value.indexOf(l.properties()[i.value])>=0],"filter-in-large":[Fn,[kn,hi(ie)],(l,[i,o])=>function(d,f,m,v){for(;m<=v;){const C=m+v>>1;if(f[C]===d)return!0;f[C]>d?v=C-1:m=C+1}return!1}(l.properties()[i.value],o.value,0,o.value.length-1)],all:{type:Fn,overloads:[[[Fn,Fn],(l,[i,o])=>i.evaluate(l)&&o.evaluate(l)],[qi(Fn),(l,i)=>{for(const o of i)if(!o.evaluate(l))return!1;return!0}]]},any:{type:Fn,overloads:[[[Fn,Fn],(l,[i,o])=>i.evaluate(l)||o.evaluate(l)],[qi(Fn),(l,i)=>{for(const o of i)if(o.evaluate(l))return!0;return!1}]]},"!":[Fn,[Fn],(l,[i])=>!i.evaluate(l)],"is-supported-script":[Fn,[kn],(l,[i])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(i.evaluate(l))}],upcase:[kn,[kn],(l,[i])=>i.evaluate(l).toUpperCase()],downcase:[kn,[kn],(l,[i])=>i.evaluate(l).toLowerCase()],concat:[kn,qi(ie),(l,i)=>i.map(o=>eo(o.evaluate(l))).join("")],"resolved-locale":[kn,[Ue],(l,[i])=>i.evaluate(l).resolvedLocale()],random:[dr,[dr,dr,ie],(l,i)=>{const[o,d,f]=i.map(v=>v.evaluate(l));if(o>d||o===d)return o;let m;if(typeof f=="string")m=function(v){let C=0;if(v.length===0)return C;for(let T=0;T<v.length;T++)C=(C<<5)-C+v.charCodeAt(T),C|=0;return C}(f);else{if(typeof f!="number")throw new Es(`Invalid seed input: ${f}`);m=f}return o+Bi(m)()*(d-o)}]});class wo{constructor(i,o,d,f){this.expression=i,this._warningHistory={},this._evaluator=new Sc(d,f),this._defaultValue=o?function(m){return m.type==="color"&&(Vs(m.default)||Array.isArray(m.default))?new jn(0,0,0,0):m.type==="color"?jn.parse(m.default)||null:m.default===void 0?null:m.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=Vu(i)}evaluateWithoutErrorHandling(i,o,d,f,m,v,C,T){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=d,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(i,o,d,f,m,v,C,T){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=d||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=T||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Es(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${F.message}`)),this._defaultValue}}}function aa(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in ci}function cs(l,i,o,d){const f=new cA(ci,[],i?function(v){const C={color:sa,string:kn,number:dr,enum:kn,boolean:Fn,formatted:Tt,resolvedImage:jt};return v.type==="array"?hi(C[v.value]||ie,v.length):C[v.type]}(i):void 0,void 0,void 0,o,d),m=f.parse(l,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?cr(new wo(m,i,o,d)):$i(f.errors)}class ja{constructor(i,o,d,f){this.kind=i,this._styleExpression=o,this.isLightConstant=d,this.isLineProgressConstant=f,this.isStateDependent=i!=="constant"&&!Cu(o.expression),this.configDependencies=Vu(o.expression)}evaluateWithoutErrorHandling(i,o,d,f,m,v){return this._styleExpression.evaluateWithoutErrorHandling(i,o,d,f,m,v)}evaluate(i,o,d,f,m,v){return this._styleExpression.evaluate(i,o,d,f,m,v)}}class Ha{constructor(i,o,d,f,m,v){this.kind=i,this.zoomStops=d,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!Cu(o.expression),this.isLightConstant=m,this.isLineProgressConstant=v,this.configDependencies=Vu(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(i,o,d,f,m,v){return this._styleExpression.evaluateWithoutErrorHandling(i,o,d,f,m,v)}evaluate(i,o,d,f,m,v){return this._styleExpression.evaluate(i,o,d,f,m,v)}interpolationFactor(i,o,d){return this.interpolationType?Wl.interpolationFactor(this.interpolationType,i,o,d):0}}function Ca(l,i,o,d){if((l=cs(l,i,o,d)).result==="error")return l;const f=l.value.expression,m=Qu(f);if(!m&&!Tr(i))return $i([new Oa("","data expressions not supported")]);const v=Gh(f,["zoom","pitch","distance-from-center"]);if(!v&&!zr(i))return $i([new Oa("","zoom expressions not supported")]);const C=Gh(f,["measure-light"]);if(!C&&!wn(i))return $i([new Oa("","measure-light expression not supported")]);const T=Gh(f,["line-progress"]);if(!T&&!function(z){return Xr(z.expression,"line-progress")}(i))return $i([new Oa("","line-progress expression not supported")]);const F=i.expression&&i.expression.relaxZoomRestriction,k=Zo(f);return k||v||F?k instanceof Oa?$i([k]):k instanceof Wl&&!Ms(i)?$i([new Oa("",'"interpolate" expressions cannot be used with this property')]):cr(k?new Ha(m&&T?"camera":"composite",l.value,k.labels,k instanceof Wl?k.interpolation:void 0,C,T):new ja(m&&T?"constant":"source",l.value,C,T)):$i([new Oa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class uo{constructor(i,o){this._parameters=i,this._specification=o,Cc(this,Ar(this._parameters,this._specification))}static deserialize(i){return new uo(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Zo(l){let i=null;if(l instanceof fA)i=Zo(l.result);else if(l instanceof fd){for(const o of l.args)if(i=Zo(o),i)break}else(l instanceof il||l instanceof Wl)&&l.input instanceof Io&&l.input.name==="zoom"&&(i=l);return i instanceof Oa||l.eachChild(o=>{const d=Zo(o);d instanceof Oa?i=d:i&&d&&i!==d&&(i=new Oa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var Qa,cc,la=function(){if(cc)return Qa;cc=1,Qa=i;var l=3;function i(o,d,f){var m=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var v=new Int32Array(this.arrayBuffer);o=v[0],this.d=(d=v[1])+2*(f=v[2]);for(var C=0;C<this.d*this.d;C++){var T=v[l+C],F=v[l+C+1];m.push(T===F?null:v.subarray(T,F))}var k=v[l+m.length+1];this.keys=v.subarray(v[l+m.length],k),this.bboxes=v.subarray(k),this.insert=this._insertReadonly}else{this.d=d+2*f;for(var z=0;z<this.d*this.d;z++)m.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=o,this.padding=f,this.scale=d/o,this.uid=0;var H=f/d*o;this.min=-H,this.max=o+H}return i.prototype.insert=function(o,d,f,m,v){this._forEachCell(d,f,m,v,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(v)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(o,d,f,m,v,C){this.cells[v].push(C)},i.prototype.query=function(o,d,f,m,v){var C=this.min,T=this.max;if(o<=C&&d<=C&&T<=f&&T<=m&&!v)return Array.prototype.slice.call(this.keys);var F=[];return this._forEachCell(o,d,f,m,this._queryCell,F,{},v),F},i.prototype._queryCell=function(o,d,f,m,v,C,T,F){var k=this.cells[v];if(k!==null)for(var z=this.keys,H=this.bboxes,$=0;$<k.length;$++){var ee=k[$];if(T[ee]===void 0){var ae=4*ee;(F?F(H[ae+0],H[ae+1],H[ae+2],H[ae+3]):o<=H[ae+2]&&d<=H[ae+3]&&f>=H[ae+0]&&m>=H[ae+1])?(T[ee]=!0,C.push(z[ee])):T[ee]=!1}}},i.prototype._forEachCell=function(o,d,f,m,v,C,T,F){for(var k=this._convertToCellCoord(o),z=this._convertToCellCoord(d),H=this._convertToCellCoord(f),$=this._convertToCellCoord(m),ee=k;ee<=H;ee++)for(var ae=z;ae<=$;ae++){var fe=this.d*ae+ee;if((!F||F(this._convertFromCellCoord(ee),this._convertFromCellCoord(ae),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(ae+1)))&&v.call(this,o,d,f,m,fe,C,T,F))return}},i.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},i.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,d=l+this.cells.length+1+1,f=0,m=0;m<this.cells.length;m++)f+=this.cells[m].length;var v=new Int32Array(d+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var C=d,T=0;T<o.length;T++){var F=o[T];v[l+T]=C,v.set(F,C),C+=F.length}return v[l+o.length]=C,v.set(this.keys,C),v[l+o.length+1]=C+=this.keys.length,v.set(this.bboxes,C),C+=this.bboxes.length,v.buffer},Qa}(),Va=ia(la);const Ga={};function Zi(l,i,o={}){Object.defineProperty(l,"_classRegistryKey",{value:i,writable:!1}),Ga[i]={klass:l,omit:o.omit||[]}}Zi(Object,"Object"),Va.serialize=function(l,i){const o=l.toArrayBuffer();return i&&i.add(o),{buffer:o}},Va.deserialize=function(l){return new Va(l.buffer)},Object.defineProperty(Va,"name",{value:"Grid"}),Zi(Va,"Grid"),typeof DOMMatrix<"u"&&Zi(DOMMatrix,"DOMMatrix"),Zi(jn,"Color"),Zi(Error,"Error"),Zi(ts,"Formatted"),Zi(Zs,"FormattedSection"),Zi(pn,"AJAXError"),Zi(Js,"ResolvedImage"),Zi(uo,"StylePropertyFunction"),Zi(wo,"StyleExpression",{omit:["_evaluator"]}),Zi(na,"ImageId"),Zi(bn,"ImageVariant"),Zi(Ha,"ZoomDependentExpression"),Zi(ja,"ZoomConstantExpression"),Zi(Io,"CompoundExpression",{omit:["_evaluate"]});for(const l in ci)Ga[ci[l]._classRegistryKey]||Zi(ci[l],`Expression${l}`);function Su(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Qo(l){return self.ImageBitmap&&l instanceof ImageBitmap}function qc(l,i){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(Su(l)||Qo(l))return i&&i.add(l),l;if(ArrayBuffer.isView(l))return i&&i.add(l.buffer),l;if(l instanceof ImageData)return i&&i.add(l.data.buffer),l;if(Array.isArray(l)){const o=[];for(const d of l)o.push(qc(d,i));return o}if(l instanceof Map){const o={$name:"Map",entries:[]};for(const[d,f]of l.entries())o.entries.push(qc(d),qc(f,i));return o}if(l instanceof Set){const o={$name:"Set"};let d=0;for(const f of l.values())o[++d]=qc(f);return o}if(l instanceof DOMMatrix){const o={$name:"DOMMatrix"},d=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const f of d)o[f]=l[f];return o}if(typeof l=="bigint")return{$name:"BigInt",value:l.toString()};if(typeof l=="object"){const o=l.constructor,d=o._classRegistryKey;if(!d)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const f=o.serialize?o.serialize(l,i):{};if(!o.serialize){for(const m in l)l.hasOwnProperty(m)&&(Ga[d].omit.indexOf(m)>=0||(f[m]=qc(l[m],i)));l instanceof Error&&(f.message=l.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(f.$name=d),f}throw new Error("can't serialize object of type "+typeof l)}function Eu(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Su(l)||Qo(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(Eu);if(typeof l=="object"){const i=l.$name||"Object";if(i==="Map"){const f=l.entries||[],m=new Map;for(let v=0;v<f.length;v+=2)m.set(Eu(f[v]),Eu(f[v+1]));return m}if(i==="Set"){const f=new Set;for(const m of Object.keys(l))m!=="$name"&&f.add(Eu(l[m]));return f}if(i==="DOMMatrix"){let f;return f=l.is2D?[l.a,l.b,l.c,l.d,l.e,l.f]:[l.m11,l.m12,l.m13,l.m14,l.m21,l.m22,l.m23,l.m24,l.m31,l.m32,l.m33,l.m34,l.m41,l.m42,l.m43,l.m44],new DOMMatrix(f)}if(i==="BigInt")return BigInt(l.value);const{klass:o}=Ga[i];if(!o)throw new Error(`Can't deserialize unregistered class "${i}".`);if(o.deserialize)return o.deserialize(l);const d=Object.create(o.prototype);for(const f of Object.keys(l))f!=="$name"&&(d[f]=Eu(l[f]));return d}throw new Error("can't deserialize object of type "+typeof l)}const Br={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function Wu(l){for(const i of l)if(Xl(i.charCodeAt(0)))return!0;return!1}function gd(l){for(const i of l)if(!md(i.charCodeAt(0)))return!1;return!0}function md(l){return!(Br.Arabic(l)||Br["Arabic Supplement"](l)||Br["Arabic Extended-A"](l)||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l))}function Xl(l){return!(l!==746&&l!==747&&(l<4352||!(Br["Bopomofo Extended"](l)||Br.Bopomofo(l)||Br["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Br["CJK Compatibility Ideographs"](l)||Br["CJK Compatibility"](l)||Br["CJK Radicals Supplement"](l)||Br["CJK Strokes"](l)||!(!Br["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Br["CJK Unified Ideographs Extension A"](l)||Br["CJK Unified Ideographs"](l)||Br["Enclosed CJK Letters and Months"](l)||Br["Hangul Compatibility Jamo"](l)||Br["Hangul Jamo Extended-A"](l)||Br["Hangul Jamo Extended-B"](l)||Br["Hangul Jamo"](l)||Br["Hangul Syllables"](l)||Br.Hiragana(l)||Br["Ideographic Description Characters"](l)||Br.Kanbun(l)||Br["Kangxi Radicals"](l)||Br["Katakana Phonetic Extensions"](l)||Br.Katakana(l)&&l!==12540||!(!Br["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Br["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Br["Unified Canadian Aboriginal Syllabics"](l)||Br["Unified Canadian Aboriginal Syllabics Extended"](l)||Br["Vertical Forms"](l)||Br["Yijing Hexagram Symbols"](l)||Br["Yi Syllables"](l)||Br["Yi Radicals"](l))))}function wh(l){return!(Xl(l)||function(i){return!!(Br["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Br["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Br["Letterlike Symbols"](i)||Br["Number Forms"](i)||Br["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Br["Control Pictures"](i)&&i!==9251||Br["Optical Character Recognition"](i)||Br["Enclosed Alphanumerics"](i)||Br["Geometric Shapes"](i)||Br["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Br["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Br["CJK Symbols and Punctuation"](i)||Br.Katakana(i)||Br["Private Use Area"](i)||Br["CJK Compatibility Forms"](i)||Br["Small Form Variants"](i)||Br["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(l))}function Yh(l){return Br.Arabic(l)||Br["Arabic Supplement"](l)||Br["Arabic Extended-A"](l)||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l)}function mA(l){return l>=1424&&l<=2303||Br["Arabic Presentation Forms-A"](l)||Br["Arabic Presentation Forms-B"](l)}function yA(l,i){return!(!i&&mA(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Br.Khmer(l))}function yd(l){for(const i of l)if(mA(i.charCodeAt(0)))return!0;return!1}const Wa={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Bh=null,ca=Wa.unavailable,Fl=null;const Xu=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(ca=Wa.error),Bh&&Bh(l)};function vA(){Ch.fire(new Vc("pluginStateChange",{pluginStatus:ca,pluginURL:Fl}))}const Ch=new yu,hl=function(){return ca},_A=function(){if(ca!==Wa.deferred||!Fl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ca=Wa.loading,vA(),Fl&&Hc({url:Fl},l=>{l?Xu(l):(ca=Wa.loaded,vA())})},$c={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ca===Wa.loaded||$c.applyArabicShaping!=null,isLoading:()=>ca===Wa.loading,setState(l){ca=l.pluginStatus,Fl=l.pluginURL},isParsing:()=>ca===Wa.parsing,isParsed:()=>ca===Wa.parsed,getPluginURL:()=>Fl};class $n{constructor(i,o){this.zoom=i,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness,this.worldview=o.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(o,d){for(const f of o)if(!yA(f.charCodeAt(0),d))return!1;return!0}(i,$c.isLoaded())}}class Sh{constructor(i,o,d,f){this.property=i,this.value=o,this.expression=function(m,v,C,T){if(Vs(m))return new uo(m,v);if(aa(m)||Array.isArray(m)&&m.length>0){const F=Ca(m,v,C,T);if(F.result==="error")throw new Error(F.value.map(k=>`${k.key}: ${k.message}`).join(", "));return F.value}{let F=m;return typeof m=="string"&&v.type==="color"&&(F=jn.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>F}}}(o===void 0?i.specification.default:o,i.specification,d,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,o,d){return this.property.possiblyEvaluate(this,i,o,d)}}class uc{constructor(i,o,d){this.property=i,this.value=new Sh(i,void 0,o,d)}transitioned(i,o){return new nf(this.property,this.value,o,Ut({},i.transition,this.transition),i.now)}untransitioned(){return new nf(this.property,this.value,null,{},0)}}class vd{constructor(i,o,d){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=o,this._options=d,this.configDependencies=new Set}getValue(i){return Mr(this._values[i].value.value)}setValue(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new uc(this._values[i].property,this._scope,this._options)),this._values[i].value=new Sh(this._values[i].property,o===null?void 0:Mr(o),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,o){o&&(this._options=o);const d=this._properties.properties;if(i)for(const f in i){const m=i[f];if(f.endsWith("-transition")){const v=f.slice(0,-11);d[v]&&this.setTransition(v,m)}else d.hasOwnProperty(f)&&this.setValue(f,m)}}getTransition(i){return Mr(this._values[i].transition)}setTransition(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new uc(this._values[i].property)),this._values[i].transition=Mr(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const d=this.getValue(o);d!==void 0&&(i[o]=d);const f=this.getTransition(o);f!==void 0&&(i[`${o}-transition`]=f)}return i}transitioned(i,o){const d=new _d(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].transitioned(i,o._values[f]);return d}untransitioned(){const i=new _d(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class nf{constructor(i,o,d,f,m){const v=f.delay||0,C=f.duration||0;m=m||0,this.property=i,this.value=o,this.begin=m+v,this.end=this.begin+C,i.specification.transition&&(f.delay||f.duration)&&(this.prior=d)}possiblyEvaluate(i,o,d){const f=i.now||0,m=this.value.possiblyEvaluate(i,o,d),v=this.prior;if(v){if(f>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(f<this.begin)return v.possiblyEvaluate(i,o,d);{const C=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(i,o,d),m,Ee(C))}}return m}}class _d{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,d){const f=new Zc(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(i,o,d);return f}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class sf{constructor(i,o,d){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=o,this._options=d,this.configDependencies=new Set}getValue(i){return Mr(this._values[i].value)}setValue(i,o){this._values[i]=new Sh(this._values[i].property,o===null?void 0:Mr(o),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const o of Object.keys(this._values)){const d=this.getValue(o);d!==void 0&&(i[o]=d)}return i}possiblyEvaluate(i,o,d){const f=new Zc(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(i,o,d);return f}}class ua{constructor(i,o,d){this.property=i,this.value=o,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,d,f){return this.property.evaluate(this.value,this.parameters,i,o,d,f)}}class Zc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Ei{constructor(i){this.specification=i}possiblyEvaluate(i,o){return i.expression.evaluate(o)}interpolate(i,o,d){const f=Gc[this.specification.type];return f?f(i,o,d):i}}class Gi{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,d,f){return new ua(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},d,f)}:i.expression,o)}interpolate(i,o,d){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new ua(this,{kind:"constant",value:void 0},i.parameters);const f=Gc[this.specification.type];return f?new ua(this,{kind:"constant",value:f(i.value.value,o.value.value,d)},i.parameters):i}evaluate(i,o,d,f,m,v){return i.kind==="constant"?i.value:i.evaluate(o,d,f,m,v)}}class Yu{constructor(i){this.specification=i}possiblyEvaluate(i,o,d,f){return!!i.expression.evaluate(o,null,{},d,f)}interpolate(){return!1}}class Ns{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new $n(0,{});for(const d in i){const f=i[d];f.specification.overridable&&this.overridableProperties.push(d);const m=this.defaultPropertyValues[d]=new Sh(f,void 0),v=this.defaultTransitionablePropertyValues[d]=new uc(f);this.defaultTransitioningPropertyValues[d]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=m.possiblyEvaluate(o)}}}Zi(Gi,"DataDrivenProperty"),Zi(Ei,"DataConstantProperty"),Zi(Yu,"ColorRampProperty");var Lt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function hc(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function xd(l){if(Array.isArray(l))return l.map(xd);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const i={};for(const o in l)i[o]=xd(l[o]);return i}return hc(l)}function xA(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const i of l.slice(1))if(!xA(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function bA(l,i="",o=null,d="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};xA(l)||(l=qu(l));const f=l;let m=!0;try{m=function(k){if(!Iu(k))return k;let z=xd(k);return Hf(z),z=Ku(z),z}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let v=null,C=null;if(d!=="background"&&d!=="sky"&&d!=="slot"){C=Lt[`filter_${d}`];const k=cs(m,C,i,o);if(k.result==="error")throw new Error(k.value.map(z=>`${z.key}: ${z.message}`).join(", "));v=(z,H,$)=>k.value.evaluate(z,H,{},$)}let T=null,F=null;if(m!==f){const k=cs(f,C,i,o);if(k.result==="error")throw new Error(k.value.map(z=>`${z.key}: ${z.message}`).join(", "));T=(z,H,$,ee,ae)=>k.value.evaluate(z,H,{},$,void 0,void 0,ee,ae),F=!Qu(k.value.expression)}return{filter:v,dynamicFilter:T||void 0,needGeometry:Kh(m),needFeature:!!F}}function Ku(l){if(!Array.isArray(l))return l;const i=function(o){if(Qf.has(o[0])){for(let d=1;d<o.length;d++)if(Iu(o[d]))return!0}return o}(l);return i===!0?i:i.map(o=>Ku(o))}function Hf(l){let i=!1;const o=[];if(l[0]==="case"){for(let d=1;d<l.length-1;d+=2)i=i||Iu(l[d]),o.push(l[d+1]);o.push(l[l.length-1])}else if(l[0]==="match"){i=i||Iu(l[1]);for(let d=2;d<l.length-1;d+=2)o.push(l[d+1]);o.push(l[l.length-1])}else if(l[0]==="step"){i=i||Iu(l[1]);for(let d=1;d<l.length-1;d+=2)o.push(l[d+1])}i&&(l.length=0,l.push("any",...o));for(let d=1;d<l.length;d++)Hf(l[d])}function Iu(l){if(!Array.isArray(l))return!1;if((i=l[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let o=1;o<l.length;o++)if(Iu(l[o]))return!0;return!1}const Qf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Pa(l,i){return l<i?-1:l>i?1:0}function Kh(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let i=1;i<l.length;i++)if(Kh(l[i]))return!0;return!1}function qu(l){if(!l)return!0;const i=l[0];return l.length<=1?i!=="any":i==="=="?bd(l[1],l[2],"=="):i==="!="?Lc(bd(l[1],l[2],"==")):i==="<"||i===">"||i==="<="||i===">="?bd(l[1],l[2],i):i==="any"?(o=l.slice(1),["any"].concat(o.map(qu))):i==="all"?["all"].concat(l.slice(1).map(qu)):i==="none"?["all"].concat(l.slice(1).map(qu).map(Lc)):i==="in"?Eh(l[1],l.slice(2)):i==="!in"?Lc(Eh(l[1],l.slice(2))):i==="has"?dc(l[1]):i!=="!has"||Lc(dc(l[1]));var o}function bd(l,i,o){switch(l){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,l,i]}}function Eh(l,i){if(i.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",l,["literal",i.sort(Pa)]]:["filter-in-small",l,["literal",i]]}}function dc(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Lc(l){return["!",l]}const Ac="";function Jc(l,i){return i?`${l}${Ac}${i}`:l}const wd="-transition",Tu=new Set(["fill","line","background","hillshade","raster"]);class Xa extends yu{constructor(i,o,d,f,m){if(super(),this.id=i.id,this.fqid=Jc(this.id,d),this.type=i.type,this.scope=d,this.lut=f,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const v=cs(this.filter,Lt[`filter_${i.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),o.layout&&(this._unevaluatedLayout=new sf(o.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new vd(o.paint,this.scope,m);for(const v in i.paint)this.setPaintProperty(v,i.paint[v]);for(const v in i.layout)this.setLayoutProperty(v,i.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zc(o.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&Tu.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,o){if(this.type==="custom"&&i==="visibility")return void(this.visibility=o);const d=this._unevaluatedLayout;d._properties.properties[i]&&(d.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(wd)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o){const d=this._transitionablePaint,f=d._properties.properties;if(i.endsWith(wd)){const z=i.slice(0,-11);return f[z]&&d.setTransition(z,o||void 0),!1}if(!f[i])return!1;const m=d._values[i],v=m.value.isDataDriven(),C=m.value;d.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...d.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const T=d._values[i].value,F=T.isDataDriven(),k=i.endsWith("pattern")||i==="line-dasharray";return F||v||k||this._handleOverridablePaintPropertyUpdate(i,C,T)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,o,d){return null}_handleOverridablePaintPropertyUpdate(i,o,d){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){return Sr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof ua&&Tr(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=bA(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,o,d,f,m,v,C,T,F){}}const of={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ih{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ks{constructor(){this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&o.add(i.arrayBuffer),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function On(l,i=1){let o=0,d=0;return{members:l.map(f=>{const m=of[f.type].BYTES_PER_ELEMENT,v=o=Vf(o,Math.max(i,m)),C=f.components||1;return d=Math.max(d,m),o+=m*C,{name:f.name,type:f.type,components:C,offset:v}}),size:Vf(o,Math.max(d,i)),alignment:i}}function Vf(l,i){return Math.ceil(l/i)*i}class $u extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const d=this.length;return this.resize(d+1),this.emplace(d,i,o)}emplace(i,o,d){const f=2*i;return this.int16[f+0]=o,this.int16[f+1]=d,i}}$u.prototype.bytesPerElement=4,Zi($u,"StructArrayLayout2i4");class Bd extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d){const f=this.length;return this.resize(f+1),this.emplace(f,i,o,d)}emplace(i,o,d,f){const m=3*i;return this.int16[m+0]=o,this.int16[m+1]=d,this.int16[m+2]=f,i}}Bd.prototype.bytesPerElement=6,Zi(Bd,"StructArrayLayout3i6");class wA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,d,f)}emplace(i,o,d,f,m){const v=4*i;return this.int16[v+0]=o,this.int16[v+1]=d,this.int16[v+2]=f,this.int16[v+3]=m,i}}wA.prototype.bytesPerElement=8,Zi(wA,"StructArrayLayout4i8");class qh extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}qh.prototype.bytesPerElement=4,Zi(qh,"StructArrayLayout1f4");class Dp extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d){const f=this.length;return this.resize(f+1),this.emplace(f,i,o,d)}emplace(i,o,d,f){const m=4*i,v=2*i;return this.int16[m+0]=o,this.int16[m+1]=d,this.float32[v+1]=f,i}}Dp.prototype.bytesPerElement=8,Zi(Dp,"StructArrayLayout2i1f8");class Gf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d){const f=this.length;return this.resize(f+1),this.emplace(f,i,o,d)}emplace(i,o,d,f){const m=4*i;return this.int16[m+0]=o,this.int16[m+1]=d,this.int16[m+2]=f,i}}Gf.prototype.bytesPerElement=8,Zi(Gf,"StructArrayLayout3i8");class Th extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,d,f,m)}emplace(i,o,d,f,m,v){const C=5*i;return this.int16[C+0]=o,this.int16[C+1]=d,this.int16[C+2]=f,this.int16[C+3]=m,this.int16[C+4]=v,i}}Th.prototype.bytesPerElement=10,Zi(Th,"StructArrayLayout5i10");class BA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,d,f,m,v,C)}emplace(i,o,d,f,m,v,C,T){const F=6*i,k=12*i,z=3*i;return this.int16[F+0]=o,this.int16[F+1]=d,this.uint8[k+4]=f,this.uint8[k+5]=m,this.uint8[k+6]=v,this.uint8[k+7]=C,this.float32[z+2]=T,i}}BA.prototype.bytesPerElement=12,Zi(BA,"StructArrayLayout2i4ub1f12");class Zu extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d){const f=this.length;return this.resize(f+1),this.emplace(f,i,o,d)}emplace(i,o,d,f){const m=3*i;return this.float32[m+0]=o,this.float32[m+1]=d,this.float32[m+2]=f,i}}Zu.prototype.bytesPerElement=12,Zi(Zu,"StructArrayLayout3f12");class Fh extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,d,f,m)}emplace(i,o,d,f,m,v){const C=6*i,T=3*i;return this.uint16[C+0]=o,this.uint16[C+1]=d,this.uint16[C+2]=f,this.uint16[C+3]=m,this.float32[T+2]=v,i}}Fh.prototype.bytesPerElement=12,Zi(Fh,"StructArrayLayout4ui1f12");class Cd extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,d,f)}emplace(i,o,d,f,m){const v=4*i;return this.uint16[v+0]=o,this.uint16[v+1]=d,this.uint16[v+2]=f,this.uint16[v+3]=m,i}}Cd.prototype.bytesPerElement=8,Zi(Cd,"StructArrayLayout4ui8");class af extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,d,f,m,v)}emplace(i,o,d,f,m,v,C){const T=6*i;return this.int16[T+0]=o,this.int16[T+1]=d,this.int16[T+2]=f,this.int16[T+3]=m,this.int16[T+4]=v,this.int16[T+5]=C,i}}af.prototype.bytesPerElement=12,Zi(af,"StructArrayLayout6i12");class Sd extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z,H){const $=this.length;return this.resize($+1),this.emplace($,i,o,d,f,m,v,C,T,F,k,z,H)}emplace(i,o,d,f,m,v,C,T,F,k,z,H,$){const ee=12*i;return this.int16[ee+0]=o,this.int16[ee+1]=d,this.int16[ee+2]=f,this.int16[ee+3]=m,this.uint16[ee+4]=v,this.uint16[ee+5]=C,this.uint16[ee+6]=T,this.uint16[ee+7]=F,this.int16[ee+8]=k,this.int16[ee+9]=z,this.int16[ee+10]=H,this.int16[ee+11]=$,i}}Sd.prototype.bytesPerElement=24,Zi(Sd,"StructArrayLayout4i4ui4i24");class Ed extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,d,f,m,v)}emplace(i,o,d,f,m,v,C){const T=10*i,F=5*i;return this.int16[T+0]=o,this.int16[T+1]=d,this.int16[T+2]=f,this.float32[F+2]=m,this.float32[F+3]=v,this.float32[F+4]=C,i}}Ed.prototype.bytesPerElement=20,Zi(Ed,"StructArrayLayout3i3f20");class Ya extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,d,f)}emplace(i,o,d,f,m){const v=4*i;return this.float32[v+0]=o,this.float32[v+1]=d,this.float32[v+2]=f,this.float32[v+3]=m,i}}Ya.prototype.bytesPerElement=16,Zi(Ya,"StructArrayLayout4f16");class Lh extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}Lh.prototype.bytesPerElement=4,Zi(Lh,"StructArrayLayout1ul4");class Mh extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const d=this.length;return this.resize(d+1),this.emplace(d,i,o)}emplace(i,o,d){const f=2*i;return this.uint16[f+0]=o,this.uint16[f+1]=d,i}}Mh.prototype.bytesPerElement=4,Zi(Mh,"StructArrayLayout2ui4");class Wf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z,H,$){const ee=this.length;return this.resize(ee+1),this.emplace(ee,i,o,d,f,m,v,C,T,F,k,z,H,$)}emplace(i,o,d,f,m,v,C,T,F,k,z,H,$,ee){const ae=20*i,fe=10*i;return this.int16[ae+0]=o,this.int16[ae+1]=d,this.int16[ae+2]=f,this.int16[ae+3]=m,this.int16[ae+4]=v,this.float32[fe+3]=C,this.float32[fe+4]=T,this.float32[fe+5]=F,this.float32[fe+6]=k,this.int16[ae+14]=z,this.uint32[fe+8]=H,this.uint16[ae+18]=$,this.uint16[ae+19]=ee,i}}Wf.prototype.bytesPerElement=40,Zi(Wf,"StructArrayLayout5i4f1i1ul2ui40");class Xf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,d,f,m,v,C)}emplace(i,o,d,f,m,v,C,T){const F=8*i;return this.int16[F+0]=o,this.int16[F+1]=d,this.int16[F+2]=f,this.int16[F+4]=m,this.int16[F+5]=v,this.int16[F+6]=C,this.int16[F+7]=T,i}}Xf.prototype.bytesPerElement=16,Zi(Xf,"StructArrayLayout3i2i2i16");class Op extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,d,f,m)}emplace(i,o,d,f,m,v){const C=4*i,T=8*i;return this.float32[C+0]=o,this.float32[C+1]=d,this.float32[C+2]=f,this.int16[T+6]=m,this.int16[T+7]=v,i}}Op.prototype.bytesPerElement=16,Zi(Op,"StructArrayLayout2f1f2i16");class CA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,d,f,m,v)}emplace(i,o,d,f,m,v,C){const T=20*i,F=5*i;return this.uint8[T+0]=o,this.uint8[T+1]=d,this.float32[F+1]=f,this.float32[F+2]=m,this.float32[F+3]=v,this.float32[F+4]=C,i}}CA.prototype.bytesPerElement=20,Zi(CA,"StructArrayLayout2ub4f20");class Jo extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,d){const f=this.length;return this.resize(f+1),this.emplace(f,i,o,d)}emplace(i,o,d,f){const m=3*i;return this.uint16[m+0]=o,this.uint16[m+1]=d,this.uint16[m+2]=f,i}}Jo.prototype.bytesPerElement=6,Zi(Jo,"StructArrayLayout3ui6");class Id extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie){const ke=this.length;return this.resize(ke+1),this.emplace(ke,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie)}emplace(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie,ke){const Ge=30*i,yt=15*i,At=60*i;return this.int16[Ge+0]=o,this.int16[Ge+1]=d,this.int16[Ge+2]=f,this.float32[yt+2]=m,this.float32[yt+3]=v,this.uint16[Ge+8]=C,this.uint16[Ge+9]=T,this.uint32[yt+5]=F,this.uint32[yt+6]=k,this.uint32[yt+7]=z,this.uint16[Ge+16]=H,this.uint16[Ge+17]=$,this.uint16[Ge+18]=ee,this.float32[yt+10]=ae,this.float32[yt+11]=fe,this.uint8[At+48]=ve,this.uint8[At+49]=Fe,this.uint8[At+50]=Pe,this.uint32[yt+13]=ue,this.int16[Ge+28]=Ie,this.uint8[At+58]=ke,i}}Id.prototype.bytesPerElement=60,Zi(Id,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class SA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie,ke,Ge,yt,At,_t,Mt,Wt,Si,Ai,Ci,Ti,$t){const _i=this.length;return this.resize(_i+1),this.emplace(_i,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie,ke,Ge,yt,At,_t,Mt,Wt,Si,Ai,Ci,Ti,$t)}emplace(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe,ue,Ie,ke,Ge,yt,At,_t,Mt,Wt,Si,Ai,Ci,Ti,$t,_i){const Vt=20*i,Yt=40*i,ki=80*i;return this.float32[Vt+0]=o,this.float32[Vt+1]=d,this.int16[Yt+4]=f,this.int16[Yt+5]=m,this.int16[Yt+6]=v,this.int16[Yt+7]=C,this.int16[Yt+8]=T,this.int16[Yt+9]=F,this.int16[Yt+10]=k,this.int16[Yt+11]=z,this.int16[Yt+12]=H,this.uint16[Yt+13]=$,this.uint16[Yt+14]=ee,this.uint16[Yt+15]=ae,this.uint16[Yt+16]=fe,this.uint16[Yt+17]=ve,this.uint16[Yt+18]=Fe,this.uint16[Yt+19]=Pe,this.uint16[Yt+20]=ue,this.uint16[Yt+21]=Ie,this.uint16[Yt+22]=ke,this.uint16[Yt+23]=Ge,this.uint16[Yt+24]=yt,this.uint16[Yt+25]=At,this.uint16[Yt+26]=_t,this.uint16[Yt+27]=Mt,this.uint32[Vt+14]=Wt,this.float32[Vt+15]=Si,this.float32[Vt+16]=Ai,this.float32[Vt+17]=Ci,this.float32[Vt+18]=Ti,this.uint8[ki+76]=$t,this.uint16[Yt+39]=_i,i}}SA.prototype.bytesPerElement=80,Zi(SA,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Up extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v){const C=this.length;return this.resize(C+1),this.emplace(C,i,o,d,f,m,v)}emplace(i,o,d,f,m,v,C){const T=6*i;return this.float32[T+0]=o,this.float32[T+1]=d,this.float32[T+2]=f,this.float32[T+3]=m,this.float32[T+4]=v,this.float32[T+5]=C,i}}Up.prototype.bytesPerElement=24,Zi(Up,"StructArrayLayout6f24");class $h extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,o,d,f,m)}emplace(i,o,d,f,m,v){const C=5*i;return this.float32[C+0]=o,this.float32[C+1]=d,this.float32[C+2]=f,this.float32[C+3]=m,this.float32[C+4]=v,i}}$h.prototype.bytesPerElement=20,Zi($h,"StructArrayLayout5f20");class lf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,d,f,m,v,C)}emplace(i,o,d,f,m,v,C,T){const F=7*i;return this.float32[F+0]=o,this.float32[F+1]=d,this.float32[F+2]=f,this.float32[F+3]=m,this.float32[F+4]=v,this.float32[F+5]=C,this.float32[F+6]=T,i}}lf.prototype.bytesPerElement=28,Zi(lf,"StructArrayLayout7f28");class zp extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z){const H=this.length;return this.resize(H+1),this.emplace(H,i,o,d,f,m,v,C,T,F,k,z)}emplace(i,o,d,f,m,v,C,T,F,k,z,H){const $=11*i;return this.float32[$+0]=o,this.float32[$+1]=d,this.float32[$+2]=f,this.float32[$+3]=m,this.float32[$+4]=v,this.float32[$+5]=C,this.float32[$+6]=T,this.float32[$+7]=F,this.float32[$+8]=k,this.float32[$+9]=z,this.float32[$+10]=H,i}}zp.prototype.bytesPerElement=44,Zi(zp,"StructArrayLayout11f44");class cf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F){const k=this.length;return this.resize(k+1),this.emplace(k,i,o,d,f,m,v,C,T,F)}emplace(i,o,d,f,m,v,C,T,F,k){const z=9*i;return this.float32[z+0]=o,this.float32[z+1]=d,this.float32[z+2]=f,this.float32[z+3]=m,this.float32[z+4]=v,this.float32[z+5]=C,this.float32[z+6]=T,this.float32[z+7]=F,this.float32[z+8]=k,i}}cf.prototype.bytesPerElement=36,Zi(cf,"StructArrayLayout9f36");class Ph extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const d=this.length;return this.resize(d+1),this.emplace(d,i,o)}emplace(i,o,d){const f=2*i;return this.float32[f+0]=o,this.float32[f+1]=d,i}}Ph.prototype.bytesPerElement=8,Zi(Ph,"StructArrayLayout2f8");class Yf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,d,f)}emplace(i,o,d,f,m){const v=6*i;return this.uint32[3*i+0]=o,this.uint16[v+2]=d,this.uint16[v+3]=f,this.uint16[v+4]=m,i}}Yf.prototype.bytesPerElement=12,Zi(Yf,"StructArrayLayout1ul3ui12");class EA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}EA.prototype.bytesPerElement=2,Zi(EA,"StructArrayLayout1ui2");class Zh extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe){const ve=this.length;return this.resize(ve+1),this.emplace(ve,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe)}emplace(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve){const Fe=16*i;return this.float32[Fe+0]=o,this.float32[Fe+1]=d,this.float32[Fe+2]=f,this.float32[Fe+3]=m,this.float32[Fe+4]=v,this.float32[Fe+5]=C,this.float32[Fe+6]=T,this.float32[Fe+7]=F,this.float32[Fe+8]=k,this.float32[Fe+9]=z,this.float32[Fe+10]=H,this.float32[Fe+11]=$,this.float32[Fe+12]=ee,this.float32[Fe+13]=ae,this.float32[Fe+14]=fe,this.float32[Fe+15]=ve,i}}Zh.prototype.bytesPerElement=64,Zi(Zh,"StructArrayLayout16f64");class IA extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,d,f,m,v,C){const T=this.length;return this.resize(T+1),this.emplace(T,i,o,d,f,m,v,C)}emplace(i,o,d,f,m,v,C,T){const F=10*i,k=5*i;return this.uint16[F+0]=o,this.uint16[F+1]=d,this.uint16[F+2]=f,this.uint16[F+3]=m,this.float32[k+2]=v,this.float32[k+3]=C,this.float32[k+4]=T,i}}IA.prototype.bytesPerElement=20,Zi(IA,"StructArrayLayout4ui3f20");class Kf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.int16[1*i+0]=o,i}}Kf.prototype.bytesPerElement=2,Zi(Kf,"StructArrayLayout1i2");class qf extends ks{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint8[1*i+0]=o,i}}qf.prototype.bytesPerElement=1,Zi(qf,"StructArrayLayout1ub1");class uf extends Ih{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}uf.prototype.size=40;class Td extends Wf{get(i){return new uf(this,i)}}Zi(Td,"CollisionBoxArray");class Np extends Ih{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Np.prototype.size=60;class jp extends Id{get(i){return new Np(this,i)}}Zi(jp,"PlacedSymbolArray");class Fg extends Ih{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Fg.prototype.size=80;class Hp extends SA{get(i){return new Fg(this,i)}}Zi(Hp,"SymbolInstanceArray");class $f extends qh{getoffsetX(i){return this.float32[1*i+0]}}Zi($f,"GlyphOffsetArray");class Lg extends $u{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}Zi(Lg,"SymbolLineVertexArray");class Mg extends Ih{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Mg.prototype.size=12;class Fd extends Yf{get(i){return new Mg(this,i)}}Zi(Fd,"FeatureIndexArray");class Qp extends Mh{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}Zi(Qp,"FillExtrusionCentroidArray");class ga extends Ih{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ga.prototype.size=6;class Jh extends Bd{get(i){return new ga(this,i)}}Zi(Jh,"FillExtrusionWallArray");const TA=On([{name:"a_pos",components:2,type:"Int16"}],4),ed=On([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),Fu=On([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Gs{constructor(i=[]){this.segments=i}_prepareSegment(i,o,d,f){let m=this.segments[this.segments.length-1];return i>Gs.MAX_VERTEX_ARRAY_LENGTH&&Yr(`Max vertices per segment is ${Gs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!m||m.vertexLength+i>Gs.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==f)&&(m={vertexOffset:o,primitiveOffset:d,vertexLength:0,primitiveLength:0},f!==void 0&&(m.sortKey=f),this.segments.push(m)),m}prepareSegment(i,o,d,f){return this._prepareSegment(i,o.length,d.length,f)}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,d,f){return new Gs([{vertexOffset:i,primitiveOffset:o,vertexLength:d,primitiveLength:f,vaos:{},sortKey:0}])}}function Ju(l,i){return 256*(l=Ye(Math.floor(l),0,255))+Ye(Math.floor(i),0,255)}Gs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zi(Gs,"SegmentVector");const hf=On([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Zf=On([{name:"a_pattern_b",components:4,type:"Uint16"}]),Vp=On([{name:"a_dash",components:4,type:"Uint16"}]);class Ld{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,o,d,f){this.ids.push(Md(i)),this.positions.push(o,d,f)}eachPosition(i,o){const d=Md(i);let f=0,m=this.ids.length-1;for(;f<m;){const v=f+m>>1;this.ids[v]>=d?m=v:f=v+1}for(;this.ids[f]===d;)o(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(i,o){const d=new Float64Array(i.ids),f=new Uint32Array(i.positions);return df(d,f,0,d.length-1),o&&(o.add(d.buffer),o.add(f.buffer)),{ids:d,positions:f}}static deserialize(i){const o=new Ld;let d;o.ids=i.ids,o.positions=i.positions;for(const f of o.ids)f!==d&&o.uniqueIds.push(f),d=f;return o.indexed=!0,o}}function Md(l){const i=+l;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:zo(String(l))}function df(l,i,o,d){for(;o<d;){const f=l[o+d>>1];let m=o-1,v=d+1;for(;;){do m++;while(l[m]<f);do v--;while(l[v]>f);if(m>=v)break;FA(l,m,v),FA(i,3*m,3*v),FA(i,3*m+1,3*v+1),FA(i,3*m+2,3*v+2)}v-o<d-v?(df(l,i,o,v),o=v+1):(df(l,i,v+1,d),d=v)}}function FA(l,i,o){const d=l[i];l[i]=l[o],l[o]=d}Zi(Ld,"FeaturePositionMap");class Mc{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,o),this.initialized=!0),!!this.location}set(i,o,d){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Jf extends Mc{constructor(i){super(i),this.current=0}set(i,o,d){this.fetchUniformLocation(i,o)&&this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}}class Fo extends Mc{constructor(i){super(i),this.current=0}set(i,o,d){this.fetchUniformLocation(i,o)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class eh extends Mc{constructor(i){super(i),this.current=[0,0]}set(i,o,d){this.fetchUniformLocation(i,o)&&(d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1])))}}class Af extends Mc{constructor(i){super(i),this.current=[0,0,0]}set(i,o,d){this.fetchUniformLocation(i,o)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2])))}}class ep extends Mc{constructor(i){super(i),this.current=[0,0,0,0]}set(i,o,d){this.fetchUniformLocation(i,o)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class tp extends Mc{constructor(i){super(i),this.current=jn.transparent.toPremultipliedRenderColor(null)}set(i,o,d){this.fetchUniformLocation(i,o)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const Sm=new Float32Array(16);class LA extends Mc{constructor(i){super(i),this.current=Sm}set(i,o,d){if(this.fetchUniformLocation(i,o)){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let f=1;f<16;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}}}const Gp=new Float32Array(9),th=new Float32Array(4);class ff extends Mc{constructor(i){super(i),this.current=th}set(i,o,d){if(this.fetchUniformLocation(i,o)){for(let f=0;f<4;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix2fv(this.location,!1,d);break}}}}function pf(l){return[Ju(255*l.r,255*l.g),Ju(255*l.b,255*l.a)]}class Pd{constructor(i,o,d,f){this.value=i,this.uniformNames=o.map(m=>`u_${m}`),this.type=d,this.context=f}setUniform(i,o,d,f,m){const v=f.constantOr(this.value);o.set(i,m,v instanceof jn?v.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(i,o){return this.type==="color"?new tp(i):new Fo(i)}}class kd{constructor(i,o){this.uniformNames=o.map(d=>`u_${d}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,o){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(i,o,d,f,m){let v=null;m!=="u_pattern"&&m!=="u_dash"||(v=this.pattern),m==="u_pattern_b"&&(v=this.patternTransition),m==="u_pixel_ratio"&&(v=this.pixelRatio),v&&o.set(i,m,v)}getBinding(i,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new ep(i):new Fo(i)}}class kh{constructor(i,o,d,f){this.expression=i,this.type=d,this.maxValue=0,this.paintVertexAttributes=o.map(m=>({name:`a_${m}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(i,o,d,f,m,v,C,T){const F=this.paintVertexArray.length,k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new $n(0,{brightness:v,worldview:T}),o,{},m,f,C):this.expression.kind==="constant"&&this.expression.value,z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:v,worldview:T}),o,{},m,f,C):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(F,i,k,z?null:this.context.lut)}updatePaintArray(i,o,d,f,m,v,C,T){const F=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:C,worldview:T},d,f,void 0,m):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:C,worldview:T}),d,f,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(i,o,F,k?null:this.context.lut)}_setPaintValue(i,o,d,f){if(this.type==="color"){const m=pf(d.toPremultipliedRenderColor(f));for(let v=i;v<o;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=i;m<o;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lu{constructor(i,o,d,f,m,v){this.expression=i,this.uniformNames=o.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=f,this.context=m,this.maxValue=0,this.paintVertexAttributes=o.map(C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,o,d,f,m,v,C,T){const F=this.expression.evaluate(new $n(this.context.zoom,{brightness:v,worldview:T}),o,{},m,f,C),k=this.expression.evaluate(new $n(this.context.zoom+1,{brightness:v,worldview:T}),o,{},m,f,C),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:v,worldview:T}),o,{},m,f,C):this.lutExpression.value)==="none",H=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(H,i,F,k,z?null:this.context.lut)}updatePaintArray(i,o,d,f,m,v,C,T){const F=this.expression.evaluate({zoom:this.context.zoom,brightness:C,worldview:T},d,f,void 0,m),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:C,worldview:T},d,f,void 0,m),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $n(0,{brightness:C,worldview:T}),d,f,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(i,o,F,k,z?null:this.context.lut)}_setPaintValue(i,o,d,f,m){if(this.type==="color"){const v=pf(d.toPremultipliedRenderColor(m)),C=pf(d.toPremultipliedRenderColor(m));for(let T=i;T<o;T++)this.paintVertexArray.emplace(T,v[0],v[1],C[0],C[1])}else{for(let v=i;v<o;v++)this.paintVertexArray.emplace(v,d,f);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o,d,f,m){const v=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,C=Ye(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);o.set(i,m,C)}getBinding(i,o){return new Fo(i)}}class Pc{constructor(i,o,d,f,m){this.expression=i,this.layerId=m,this.paintVertexAttributes=(d==="array"?Vp:hf).members;for(let v=0;v<o.length;++v);this.paintVertexArray=new f,this.paintTransitionVertexArray=new Cd}populatePaintArray(i,o,d,f){const m=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(m,i,o.patterns&&o.patterns[this.layerId],d)}updatePaintArray(i,o,d,f,m,v,C){this._setPaintValues(i,o,d.patterns&&d.patterns[this.layerId],v)}_setPaintValues(i,o,d,f){if(!f||!d)return;const m=f[d[0]],v=f[d[1]];if(m){if(m){const{tl:C,br:T,pixelRatio:F}=m;for(let k=i;k<o;k++)this.paintVertexArray.emplace(k,C[0],C[1],T[0],T[1],F)}if(v){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:C,br:T}=v;for(let F=i;F<o;F++)this.paintTransitionVertexArray.emplace(F,C[0],C[1],T[0],T[1])}}}upload(i){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,Zf.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class MA{constructor(i,o,d=()=>!0){this.binders={},this._buffers=[],this.context=o;const f=[];for(const m in i.paint._values){const v=i.paint.get(m);if(m.endsWith("-use-theme")||!d(m)||!(v instanceof ua&&Tr(v.property.specification)))continue;const C=u(m,i.type),T=v.value,F=v.property.specification.type,k=!!v.property.useIntegerZoom,z=m==="line-dasharray"||m.endsWith("pattern"),H=i.paint.get(`${m}-use-theme`),$=m==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||H&&H.value.kind!=="constant";if(T.kind!=="constant"||$)if(T.kind==="source"||$||z){const ee=w(m,F,"source");this.binders[m]=z?new Pc(T,C,F,ee,i.id):new kh(T,C,F,ee),f.push(`/a_${m}`)}else{const ee=w(m,F,"composite");this.binders[m]=new Lu(T,C,F,k,o,ee),f.push(`/z_${m}`)}else this.binders[m]=z?new kd(T.value,C):new Pd(T.value,C,F,o),f.push(`/u_${m}`);H&&(this.binders[m].lutExpression=H.value)}this.cacheKey=f.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof kh||o instanceof Lu?o.maxValue:0}populatePaintArrays(i,o,d,f,m,v,C,T){for(const F in this.binders){const k=this.binders[F];k.context=this.context,(k instanceof kh||k instanceof Lu||k instanceof Pc)&&k.populatePaintArray(i,o,d,f,m,v,C,T)}}setConstantPatternPositions(i,o){for(const d in this.binders){const f=this.binders[d];f instanceof kd&&f.setConstantPatternPositions(i,o)}}getPatternTransitionVertexBuffer(i){const o=this.binders[i];return o instanceof Pc?o.paintTransitionVertexBuffer:null}updatePaintArrays(i,o,d,f,m,v,C,T,F,k){let z=!1;const H=Object.keys(i),$=H.length!==0&&!T,ee=$?H:o.uniqueIds;this.context.lut=m.lut;for(const ae in this.binders){const fe=this.binders[ae];if(fe.context=this.context,(fe instanceof kh||fe instanceof Lu||fe instanceof Pc)&&fe.expression&&fe.expression.kind&&fe.expression.kind!=="constant"&&(fe.expression.isStateDependent===!0||fe.expression.isLightConstant===!1)){const ve=m.paint.get(ae);fe.expression=ve.value;for(const Fe of ee){const Pe=i[Fe.toString()];o.eachPosition(Fe,(ue,Ie,ke)=>{const Ge=f.feature(ue);fe.updatePaintArray(Ie,ke,Ge,Pe,v,C,F,k)})}if(!$)for(const Fe of d.uniqueIds){const Pe=i[Fe.toString()];d.eachPosition(Fe,(ue,Ie,ke)=>{const Ge=f.feature(ue);fe.updatePaintArray(Ie,ke,Ge,Pe,v,C,F,k)})}z=!0}}return z}defines(){const i=[];for(const o in this.binders){const d=this.binders[o];(d instanceof Pd||d instanceof kd)&&i.push(...d.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const d=this.binders[o];if(d instanceof kh||d instanceof Lu||d instanceof Pc)for(let f=0;f<d.paintVertexAttributes.length;f++)i.push(d.paintVertexAttributes[f].name);if(d instanceof Pc)for(let f=0;f<Zf.members.length;f++)i.push(Zf.members[f].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const d=this.binders[o];if(d instanceof Pd||d instanceof kd||d instanceof Lu)for(const f of d.uniformNames)i.push(f)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const o=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof Pd||f instanceof kd||f instanceof Lu)for(const m of f.uniformNames)o.push({name:m,property:d,binding:f.getBinding(i,m)})}return o}setUniforms(i,o,d,f,m){for(const{name:v,property:C,binding:T}of d)this.binders[C].setUniform(i,T,m,f.get(C),v)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const o=this.binders[i];(o instanceof kh||o instanceof Lu||o instanceof Pc)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof Pc&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(i){for(const o in this.binders){const d=this.binders[o];(d instanceof kh||d instanceof Lu||d instanceof Pc)&&d.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof kh||o instanceof Lu||o instanceof Pc)&&o.destroy()}}}class p{constructor(i,o,d=()=>!0){this.programConfigurations={};for(const f of i)this.programConfigurations[f.id]=new MA(f,o,d);this.needsUpload=!1,this._featureMap=new Ld,this._featureMapWithoutIds=new Ld,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,o,d,f,m,v,C,T,F){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(i,o,f,m,v,C,T,F);o.id!==void 0?this._featureMap.add(o.id,d,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,d,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,d,f,m,v,C,T){for(const F of d)this.needsUpload=this.programConfigurations[F.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,o,F,f,m,v,C||0,T)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const n={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function u(l,i){return n[l]||[l.replace(`${i}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:Fh,composite:Fh},"fill-pattern":{source:Fh,composite:Fh},"fill-extrusion-pattern":{source:Fh,composite:Fh},"line-dasharray":{source:Cd,composite:Cd}},x={color:{source:Ph,composite:Ya},number:{source:qh,composite:Ph}};function w(l,i,o){const d=g[l];return d&&d[o]||x[i][o]}Zi(Pd,"ConstantBinder"),Zi(kd,"PatternConstantBinder"),Zi(kh,"SourceExpressionBinder"),Zi(Pc,"PatternCompositeBinder"),Zi(Lu,"CompositeExpressionBinder"),Zi(MA,"ProgramConfiguration",{omit:["_buffers"]}),Zi(p,"ProgramConfigurationSet");const S=wi/Math.PI/2,L=5,P=6,V=16383,Y=64,J=[Y,32,16],Z=-S,te=S;function de(l,i,o,d=S){return o=dn(o),[l*Math.sin(o)*d,-i*d,l*Math.cos(o)*d]}function he(l,i,o){return de(Math.cos(dn(l)),Math.sin(dn(l)),i,o)}const ge=63710088e-1,_e=2*Math.PI*ge;class Te{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Te(Dt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,d=this.lat*o,f=i.lat*o,m=Math.sin(d)*Math.sin(f)+Math.cos(d)*Math.cos(f)*Math.cos((i.lng-this.lng)*o);return ge*Math.acos(Math.min(m,1))}toBounds(i=0){const o=360*i/40075017,d=o/Math.cos(Math.PI/180*this.lat);return new je({lng:this.lng-d,lat:this.lat-o},{lng:this.lng+d,lat:this.lat+o})}toEcef(i){return he(this.lat,this.lng,S+i*S/ge)}static convert(i){if(i instanceof Te)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Te(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Te(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class je{constructor(i,o){if(i)if(o)this.setSouthWest(i).setNorthEast(o);else if(i.length===4){const d=i;this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]])}else{const d=i;this.setSouthWest(d[0]).setNorthEast(d[1])}}setNorthEast(i){return this._ne=i instanceof Te?new Te(i.lng,i.lat):Te.convert(i),this}setSouthWest(i){return this._sw=i instanceof Te?new Te(i.lng,i.lat):Te.convert(i),this}extend(i){const o=this._sw,d=this._ne;let f,m;if(i instanceof Te)f=i,m=i;else{if(!(i instanceof je))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(je.convert(i)):this.extend(Te.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(Te.convert(i)):this;if(f=i._sw,m=i._ne,!f||!m)return this}return o||d?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),d.lng=Math.max(m.lng,d.lng),d.lat=Math.max(m.lat,d.lat)):(this._sw=new Te(f.lng,f.lat),this._ne=new Te(m.lng,m.lat)),this}getCenter(){return new Te((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Te(this.getWest(),this.getNorth())}getSouthEast(){return new Te(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:o,lat:d}=Te.convert(i);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(i){if(i)return i instanceof je?i:new je(i)}}const We=0,ut=25.5;function at(l){return _e*Math.cos(l*Math.PI/180)}function nt(l){return(180+l)/360}function qe(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function ht(l,i){return l/at(i)}function ft(l){return 360*l-180}function Rt(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Ot(l,i){return l*at(Rt(i))}const ti=85.051129;function ri(l){return Math.cos(dn(Ye(l,-85.051129,ti)))}function vi(l,i){const o=Ye(i,We,ut),d=Math.pow(2,o);return ri(l)*_e/(512*d)}function Pt(l){return 1/Math.cos(l*Math.PI/180)}function Qt(l,i=0){const o=Math.exp(Math.PI*(1-(l.y+i/wi)/(1<<l.z)*2));return 80150034*o/(o*o+1)/wi/(1<<l.z)}class Ct{constructor(i,o,d=0){this.x=+i,this.y=+o,this.z=+d}static fromLngLat(i,o=0){const d=Te.convert(i);return new Ct(nt(d.lng),qe(d.lat),ht(o,d.lat))}toLngLat(){return new Te(ft(this.x),Rt(this.y))}toAltitude(){return Ot(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/_e*Pt(Rt(this.y))}}function oi(l,i,o,d,f,m,v,C,T){const F=(i+d)/2,k=(o+f)/2,z=new qt(F,k);C(z),function(H,$,ee,ae,fe,ve){const Fe=ee-fe,Pe=ae-ve;return Math.abs((ae-$)*Fe-(ee-H)*Pe)/Math.hypot(Fe,Pe)}(z.x,z.y,m.x,m.y,v.x,v.y)>=T?(oi(l,i,o,F,k,m,z,C,T),oi(l,F,k,d,f,z,v,C,T)):l.push(v)}function zt(l,i,o){let d=l[0],f=d.x,m=d.y;i(d);const v=[d];for(let C=1;C<l.length;C++){const T=l[C],{x:F,y:k}=T;i(T),oi(v,f,m,F,k,d,T,i,o),f=F,m=k,d=T}return v}function gi(l,i,o,d){if(d(i,o)){const f=i.add(o)._mult(.5);gi(l,i,f,d),gi(l,f,o,d)}else l.push(o)}function Li(l,i){let o=l[0];const d=[o];for(let f=1;f<l.length;f++){const m=l[f];gi(d,o,m,i),o=m}return d}const ai=Math.pow(2,14)-1,Mi=-ai-1;function ir(l,i){const o=Math.round(l.x*i),d=Math.round(l.y*i);return l.x=Ye(o,Mi,ai),l.y=Ye(d,Mi,ai),(o<l.x||o>l.x+1||d<l.y||d>l.y+1)&&Yr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function tr(l,i,o){const d=l.loadGeometry(),f=l.extent,m=wi/f;if(i&&o&&o.projection.isReprojectedInTileSpace){const v=1<<i.z,{scale:C,x:T,y:F,projection:k}=o,z=H=>{const $=ft((i.x+H.x/f)/v),ee=Rt((i.y+H.y/f)/v),ae=k.project($,ee);H.x=(ae.x*C-T)*f,H.y=(ae.y*C-F)*f};for(let H=0;H<d.length;H++)if(l.type!==1)d[H]=zt(d[H],z,1);else{const $=[];for(const ee of d[H])ee.x<0||ee.x>=f||ee.y<0||ee.y>=f||(z(ee),$.push(ee));d[H]=$}}for(const v of d)for(const C of v)ir(C,m);return d}function Ki(l,i){return{type:l.type,id:l.id,properties:l.properties,geometry:i?tr(l):[]}}var pr,gr,Cr,Hr,sn,Zn,ws,rs={};function ss(){if(gr)return pr;gr=1;var l=yr();function i(f,m,v,C,T){this.properties={},this.extent=v,this.type=0,this._pbf=f,this._geometry=-1,this._keys=C,this._values=T,f.readFields(o,this,m)}function o(f,m,v){f==1?m.id=v.readVarint():f==2?function(C,T){for(var F=C.readVarint()+C.pos;C.pos<F;){var k=T._keys[C.readVarint()],z=T._values[C.readVarint()];T.properties[k]=z}}(v,m):f==3?m.type=v.readVarint():f==4&&(m._geometry=v.pos)}function d(f){for(var m,v,C=0,T=0,F=f.length,k=F-1;T<F;k=T++)C+=((v=f[k]).x-(m=f[T]).x)*(m.y+v.y);return C}return pr=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var m,v=f.readVarint()+f.pos,C=1,T=0,F=0,k=0,z=[];f.pos<v;){if(T<=0){var H=f.readVarint();C=7&H,T=H>>3}if(T--,C===1||C===2)F+=f.readSVarint(),k+=f.readSVarint(),C===1&&(m&&z.push(m),m=[]),m.push(new l(F,k));else{if(C!==7)throw new Error("unknown command "+C);m&&m.push(m[0].clone())}}return m&&z.push(m),z},i.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var m=f.readVarint()+f.pos,v=1,C=0,T=0,F=0,k=1/0,z=-1/0,H=1/0,$=-1/0;f.pos<m;){if(C<=0){var ee=f.readVarint();v=7&ee,C=ee>>3}if(C--,v===1||v===2)(T+=f.readSVarint())<k&&(k=T),T>z&&(z=T),(F+=f.readSVarint())<H&&(H=F),F>$&&($=F);else if(v!==7)throw new Error("unknown command "+v)}return[k,H,z,$]},i.prototype.toGeoJSON=function(f,m,v){var C,T,F=this.extent*Math.pow(2,v),k=this.extent*f,z=this.extent*m,H=this.loadGeometry(),$=i.types[this.type];function ee(ve){for(var Fe=0;Fe<ve.length;Fe++){var Pe=ve[Fe];ve[Fe]=[360*(Pe.x+k)/F-180,360/Math.PI*Math.atan(Math.exp((180-360*(Pe.y+z)/F)*Math.PI/180))-90]}}switch(this.type){case 1:var ae=[];for(C=0;C<H.length;C++)ae[C]=H[C][0];ee(H=ae);break;case 2:for(C=0;C<H.length;C++)ee(H[C]);break;case 3:for(H=function(ve){var Fe=ve.length;if(Fe<=1)return[ve];for(var Pe,ue,Ie=[],ke=0;ke<Fe;ke++){var Ge=d(ve[ke]);Ge!==0&&(ue===void 0&&(ue=Ge<0),ue===Ge<0?(Pe&&Ie.push(Pe),Pe=[ve[ke]]):Pe.push(ve[ke]))}return Pe&&Ie.push(Pe),Ie}(H),C=0;C<H.length;C++)for(T=0;T<H[C].length;T++)ee(H[C][T])}H.length===1?H=H[0]:$="Multi"+$;var fe={type:"Feature",geometry:{type:$,coordinates:H},properties:this.properties};return"id"in this&&(fe.id=this.id),fe},pr}function ho(){if(Hr)return Cr;Hr=1;var l=ss();function i(d,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(o,this,f),this.length=this._features.length}function o(d,f,m){d===15?f.version=m.readVarint():d===1?f.name=m.readString():d===5?f.extent=m.readVarint():d===2?f._features.push(m.pos):d===3?f._keys.push(m.readString()):d===4&&f._values.push(function(v){for(var C=null,T=v.readVarint()+v.pos;v.pos<T;){var F=v.readVarint()>>3;C=F===1?v.readString():F===2?v.readFloat():F===3?v.readDouble():F===4?v.readVarint64():F===5?v.readVarint():F===6?v.readSVarint():F===7?v.readBoolean():null}return C}(m))}return Cr=i,i.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var f=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,f,this.extent,this._keys,this._values)},Cr}function Jr(){return ws||(ws=1,rs.VectorTile=function(){if(Zn)return sn;Zn=1;var l=ho();function i(o,d,f){if(o===3){var m=new l(f,f.readVarint()+f.pos);m.length&&(d[m.name]=m)}}return sn=function(o,d){this.layers=o.readFields(i,{},d)},sn}(),rs.VectorTileFeature=ss(),rs.VectorTileLayer=ho()),rs}var ln=Jr();const vn="3d_elevation_id",Rs="level";class Vo{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,o){return this._valid&&i(o(this._geometry)),this}require(i,o,d){return this.get(i,!0,o,d)}optional(i,o,d){return this.get(i,!1,o,d)}success(){return this._valid}get(i,o,d,f){const m=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&m!==void 0&&!Number.isNaN(m)?d(f?f(m):m):o&&(this._valid=!1),this}}class Ts{constructor(i,o){this.featureFunc=i,this.vertexFunc=o}parseFeature(i,o,d){return this.featureFunc(i,o,d)}parseVertex(i,o,d){return this.vertexFunc(i,o,d)}}const Xn=new Ts((l,i,o)=>l.reset(i).require(vn,d=>{o.id=d}).optional("fixed_height_relative",d=>{o.constantHeight=d},Ln.decodeRelativeHeight).geometry(d=>{o.bounds=d},Ec).success(),(l,i,o)=>l.reset(i).require(vn,d=>{o.id=d}).require("elevation_idx",d=>{o.idx=d}).require("extent",d=>{o.extent=d}).require("height_relative",d=>{o.height=d},Ln.decodeRelativeHeight).geometry(d=>{o.position=d},Ln.getPoint).success()),to=new Ts((l,i,o)=>l.reset(i).require(vn,d=>{o.id=d}).optional("fixed_height",d=>{o.constantHeight=d},Ln.decodeMetricHeight).geometry(d=>{o.bounds=d},Ec).success(),(l,i,o)=>l.reset(i).require(vn,d=>{o.id=d}).require("elevation_idx",d=>{o.idx=d}).require("extent",d=>{o.extent=d}).require("height",d=>{o.height=d},Ln.decodeMetricHeight).geometry(d=>{o.position=d},Ln.getPoint).success());class Ln{static getPoint(i){return Vi(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static parse(i){const o=[],d=[],f=i.length,m=new Vo;for(let C=0;C<f;C++){const T=i.feature(C),F=T.properties.hasOwnProperty("version")?String(T.properties.version):void 0,k=(v=F)?v==="1.0.1"?to:void 0:Xn;if(k===void 0){Yr(`Unknown elevation feature version number ${F||"(unknown)"}`);continue}const z=T.properties.hasOwnProperty("type")?T.properties.type:void 0;if(z){if(ln.VectorTileFeature.types[T.type]==="Point"&&z==="curve_point"){const H={};k.parseVertex(m,T,H)&&o.push(H)}else if(ln.VectorTileFeature.types[T.type]==="Polygon"&&z==="curve_meta"){const H={};k.parseFeature(m,T,H)&&d.push(H)}}}var v;return{vertices:o,features:d}}}class Lo{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,d){const f=Ur(o,this.dir);if(Math.abs(f)<1e-6)return!1;const m=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1])/f;return d[0]=this.pos[0]+this.dir[0]*m,d[1]=this.pos[1]+this.dir[1]*m,!0}}class Ds{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,d){const f=Bt(o,this.dir);if(Math.abs(f)<1e-6)return!1;const m=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1]+(i[2]-this.pos[2])*o[2])/f;return d[0]=this.pos[0]+this.dir[0]*m,d[1]=this.pos[1]+this.dir[1]*m,d[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(i,o,d){if(function($,ee){var ae=$[0],fe=$[1],ve=$[2],Fe=ee[0],Pe=ee[1],ue=ee[2];return Math.abs(ae-Fe)<=y*Math.max(1,Math.abs(ae),Math.abs(Fe))&&Math.abs(fe-Pe)<=y*Math.max(1,Math.abs(fe),Math.abs(Pe))&&Math.abs(ve-ue)<=y*Math.max(1,Math.abs(ve),Math.abs(ue))}(this.pos,i)||o===0)return d[0]=d[1]=d[2]=0,!1;const[f,m,v]=this.dir,C=this.pos[0]-i[0],T=this.pos[1]-i[1],F=this.pos[2]-i[2],k=f*f+m*m+v*v,z=2*(C*f+T*m+F*v),H=z*z-4*k*(C*C+T*T+F*F-o*o);if(H<0){const $=Math.max(-z/2,0),ee=C+f*$,ae=T+m*$,fe=F+v*$,ve=Math.hypot(ee,ae,fe);return d[0]=ee*o/ve,d[1]=ae*o/ve,d[2]=fe*o/ve,!1}{const $=(-z-Math.sqrt(H))/(2*k);if($<0){const ee=Math.hypot(C,T,F);return d[0]=C*o/ee,d[1]=T*o/ee,d[2]=F*o/ee,!1}return d[0]=C+f*$,d[1]=T+m*$,d[2]=F+v*$,!0}}}class N{constructor(i,o,d,f,m){this.TL=i,this.TR=o,this.BR=d,this.BL=f,this.horizon=m}static fromInvProjectionMatrix(i,o,d){const f=[-1,1,1],m=[1,1,1],v=[1,-1,1],C=[-1,-1,1],T=vt(f,f,i),F=vt(m,m,i),k=vt(v,v,i),z=vt(C,C,i);return new N(T,F,k,z,o/d)}}function O(l,i,o){let d=1/0,f=-1/0;const m=[];for(const v of l){Ve(m,v,i);const C=Bt(m,o);d=Math.min(d,C),f=Math.max(f,C)}return[d,f]}function X(l,i){let o=!0;for(let d=0;d<l.planes.length;d++){const f=l.planes[d];let m=0;for(let v=0;v<i.length;v++)m+=Bt(f,i[v])+f[3]>=0;if(m===0)return 0;m!==i.length&&(o=!1)}return o?2:1}function W(l,i){for(const o of l.projections){const d=O(i,l.points[0],o.axis);if(o.projection[1]<d[0]||o.projection[0]>d[1])return 0}return 1}function ce(l,i){let o=0;const d=[0,0,0,0];for(let v=0;v<l.length;v++)d[0]=l[v][0],d[1]=l[v][1],d[2]=l[v][2],d[3]=1,(f=d)[0]*(m=i)[0]+f[1]*m[1]+f[2]*m[2]+f[3]*m[3]>=0&&o++;var f,m;return o}class Be{constructor(i,o){this.points=i||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=De.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ve([],this.points[2],this.points[3]),Ve([],this.points[0],this.points[3]),Ve([],this.points[4],this.points[0]),Ve([],this.points[5],this.points[1]),Ve([],this.points[6],this.points[2]),Ve([],this.points[7],this.points[3])];for(const d of this.frustumEdges){const f=[0,-d[2],d[1]],m=[d[2],0,-d[0]];this.projections.push({axis:f,projection:O(this.points,this.points[0],f)}),this.projections.push({axis:m,projection:O(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(i,o,d,f){const m=Math.pow(2,d),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>{const k=Kt([],F,i),z=1/k[3]/o*m;return(H=k)[0]=($=k)[0]*(ee=[z,z,f?1/k[3]:z,z])[0],H[1]=$[1]*ee[1],H[2]=$[2]*ee[2],H[3]=$[3]*ee[3],H;var H,$,ee}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const k=mt([],rt([],Ve([],v[F[0]],v[F[1]]),Ve([],v[F[2]],v[F[1]]))),z=-Bt(k,v[F[1]]);return k.concat(z)}),T=[];for(let F=0;F<v.length;F++)T.push([v[F][0],v[F][1],v[F][2]]);return new Be(T,C)}intersectsPrecise(i,o,d){for(let f=0;f<o.length;f++)if(!ce(i,o[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!ce(i,this.planes[f]))return 0;for(const f of d)for(const m of this.frustumEdges){const v=rt([],f,m),C=Le(v);if(C===0)continue;Qe(v,v,1/C);const T=O(this.points,this.points[0],v),F=O(i,this.points[0],v);if(T[0]>F[1]||F[0]>T[1])return 0}return 1}containsPoint(i){for(const o of this.planes){const d=o[3];if(Bt([o[0],o[1],o[2]],i)+d<0)return!1}return!0}}class De{static fromPoints(i){const o=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const f of i)$e(o,o,f),ct(d,d,f);return new De(o,d)}static fromTileIdAndHeight(i,o,d){const f=1<<i.canonical.z,m=i.canonical.x,v=i.canonical.y;return new De([m/f,v/f,o],[(m+1)/f,(v+1)/f,d])}static applyTransform(i,o){const d=i.getCorners();for(let f=0;f<d.length;++f)vt(d[f],d[f],o);return De.fromPoints(d)}static applyTransformFast(i,o){const d=[o[12],o[13],o[14]],f=[...d];for(let m=0;m<3;m++)for(let v=0;v<3;v++){const C=o[4*v+m],T=C*i.min[v],F=C*i.max[v];d[m]+=Math.min(T,F),f[m]+=Math.max(T,F)}return new De(d,f)}static projectAabbCorners(i,o){const d=i.getCorners();for(let f=0;f<d.length;++f)vt(d[f],d[f],o);return d}constructor(i,o){this.min=i,this.max=o,this.center=Qe([],Me([],this.min,this.max),.5)}quadrant(i){const o=[i%2==0,i<2],d=me(this.min),f=me(this.max);for(let m=0;m<o.length;m++)d[m]=o[m]?this.min[m]:this.center[m],f[m]=o[m]?this.center[m]:this.max[m];return f[2]=this.max[2],new De(d,f)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,o=this.max;return[[i[0],i[1],i[2]],[o[0],i[1],i[2]],[o[0],o[1],i[2]],[i[0],o[1],i[2]],[i[0],i[1],o[2]],[o[0],i[1],o[2]],[o[0],o[1],o[2]],[i[0],o[1],o[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?X(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?X(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,o){return o||this.intersects(i)?W(i,this.getCorners()):0}intersectsPreciseFlat(i,o){return o||this.intersectsFlat(i)?W(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let o=0;o<3;++o)if(this.min[o]>i.max[o]||i.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i.min[o]),this.max[o]=Math.max(this.max[o],i.max[o])}encapsulatePoint(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i[o]),this.max[o]=Math.max(this.max[o],i[o])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}Zi(De,"Aabb");class gt{constructor(i,o){this.feature=i,this.metersToTile=o,this.index=0}get(){const i=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,d=o[1],f=-o[0],m=(i.extent+1)*this.metersToTile;return[new qt(Math.trunc(i.position[0]+d*m),Math.trunc(i.position[1]+f*m)),new qt(Math.trunc(i.position[0]-d*m),Math.trunc(i.position[1]-f*m))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class pt{constructor(i,o,d,f,m,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=i,this.heightRange={min:d,max:d},this.safeArea=o,this.constantHeight=d,this.constantHeight==null&&(this.constantHeight!=null||f.length!==0)){this.vertices=f,this.edges=m,this.edges=this.edges.filter(C=>{return C.a<this.vertices.length&&C.b<this.vertices.length&&!((T=this.vertices[C.a].position)[0]===(F=this.vertices[C.b].position)[0]&&T[1]===F[1]);var T,F}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const C of this.vertices)this.vertexProps.push({dir:Vi(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,C.height),this.heightRange.max=Math.max(this.heightRange.max,C.height);for(const C of this.edges){const T=this.vertices[C.a].position,F=this.vertices[C.b].position,k=qr(li(),F,T),z=Zr(k),H=_r(li(),k,1/z);this.edgeProps.push({vec:k,dir:H,len:z});const $=this.vertexProps[C.a].dir,ee=this.vertexProps[C.b].dir;rr($,$,H),rr(ee,ee,H)}for(const C of this.vertexProps)C.dir[0]===0&&C.dir[1]===0||io(C.dir,C.dir);this.tessellate(v)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(i);if(o==null)return 0;const[d,f]=o;return Er(this.vertices[this.edges[d].a].height,this.vertices[this.edges[d].b].height,f)}computeSlopeNormal(i,o){const d=this.getClosestEdge(i);if(!d)return Se(0,0,1);const f=d[0],m=this.edges[f],v=this.edgeProps[f].vec,C=Se(v[0],v[1],(this.vertices[m.b].height-this.vertices[m.a].height)*o),T=Se(C[1],-C[0],0);rt(T,T,C);const F=Le(T);return F>0?Qe(T,T,1/F):Se(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let o=0,d=Number.POSITIVE_INFINITY,f=0;const m=Vi(i.x,i.y);for(let v=0;v<this.edges.length;v++){const C=this.edges[v],T=this.edgeProps[v].dir,F=new Lo(m,this.edgeProps[v].dir),k=this.vertices[C.a].position,z=this.vertices[C.b].position,H=li(),$=li(),ee=F.intersectsPlane(k,this.vertexProps[C.a].dir,H),ae=F.intersectsPlane(z,this.vertexProps[C.b].dir,$);if(!ee||!ae)continue;const fe=qr(li(),$,H),ve=qr(li(),m,H),Fe=Ur(fe,fe),Pe=Fe>0?Ur(ve,fe)/Fe:0,ue=Ye(Pe,0,1),Ie=Math.abs((Pe-ue)*this.edgeProps[v].len),ke=qr(li(),m,k),Ge=Ie+Math.abs(Ur(ke,Vi(T[1],-T[0])));Ge<d&&(o=v,d=Ge,f=ue)}return[o,f]}tessellate(i){for(let o=this.edges.length-1;o>=0;--o){const d=this.edges[o].a,f=this.edges[o].b,{position:m,height:v,extent:C}=this.vertices[d],{position:T,height:F,extent:k}=this.vertices[f],z=this.vertexProps[d].dir,H=this.vertexProps[f].dir,$=Se(m[0]/i,m[1]/i,v),ee=Se(T[0]/i,T[1]/i,F),ae=Se(z[1],-z[0],0);Qe(ae,ae,C);const fe=Se(H[1],-H[0],0);if(Qe(fe,fe,k),this.distSqLines(Se($[0]+.5*ae[0],$[1]+.5*ae[1],$[2]+.5*ae[2]),Se(ee[0]-.5*fe[0],ee[1]-.5*fe[1],ee[2]-.5*fe[2]),Se($[0]-.5*ae[0],$[1]-.5*ae[1],$[2]-.5*ae[2]),Se(ee[0]+.5*fe[0],ee[1]+.5*fe[1],ee[2]+.5*fe[2]))<=.0025000000000000005)continue;const ve=this.vertices.length,Fe=rr(li(),m,T);this.vertices.push({position:_r(Fe,Fe,.5),height:.5*(v+F),extent:.5*(C+k)});const Pe=rr(li(),z,H);this.vertexProps.push({dir:io(Pe,Pe)}),this.edges.splice(o,1),this.edgeProps.splice(o,1),this.edges.push({a:d,b:ve}),this.edges.push({a:ve,b:f});const ue=qr(li(),this.vertices[ve].position,m),Ie=Zr(ue),ke={vec:ue,dir:_r(li(),ue,1/Ie),len:Ie};this.edgeProps.push(ke),this.edgeProps.push(ke)}}distSqLines(i,o,d,f){const m=Re(oe(),o,i),v=Re(oe(),f,d),C=Re(oe(),i,d),T=Bt(m,m),F=Bt(m,v),k=Bt(m,C),z=Bt(v,v),H=Bt(v,C),$=T*z-F*F;if($===0){const fe=Bt(C,v)/Bt(v,v);return Ce(St(oe(),d,f,fe),i)}const ee=(F*H-k*z)/$,ae=(T*H-F*k)/$;return Ce(St(oe(),i,o,ee),St(oe(),d,f,ae))}}class Ht{static parseFrom(i,o){const d=Ln.parse(i);if(!d)return[];let{vertices:f,features:m}=d;const v=1/Qt(o);m.sort((k,z)=>k.id-z.id),f.sort((k,z)=>k.id-z.id||k.idx-z.idx),f=f.filter((k,z,H)=>z===H.findIndex($=>$.id===k.id&&$.idx===k.idx));const C=new Array;let T=0;const F=f.length;for(const k of m){if(k.constantHeight){C.push(new pt(k.id,k.bounds,k.constantHeight));continue}for(;T!==F&&f[T].id<k.id;)T++;if(T===F||f[T].id!==k.id)continue;const z=new Array,H=new Array,$=T;for(;T!==F&&f[T].id===k.id;){const ee=f[T];if(z.push({position:ee.position,height:ee.height,extent:ee.extent}),T!==$&&f[T-1].idx===ee.idx-1){const ae=T-$;H.push({a:ae-1,b:ae})}T++}C.push(new pt(k.id,k.bounds,void 0,z,H,v))}return C}static getElevationFeature(i,o){if(!o)return;const d=+i.properties[vn];return Number.isNaN(d)?void 0:o.find(f=>f.id===d)}}class si{constructor(i,o){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(o)||(this.zScale=Math.pow(2,o.z-i.z),this.xOffset=(i.x*this.zScale-o.x)*wi,this.yOffset=(i.y*this.zScale-o.y)*wi)}constantElevation(i,o){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,o)}pointElevation(i,o,d){const f=this.constantElevation(o,d);return f??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(i),d))}computeBiasedHeight(i,o){return o<=0?i:i+o*xt(0,o,i>=0?i:Math.abs(.5*i))}}Zi(pt,"ElevationFeature");class pi{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new $u,this.indexArray=new Jo,this.segments=new Gs,this.programConfigurations=new p(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new qh),this.worldview=i.worldview}updateFootprints(i,o){}populate(i,o,d,f){const m=this.layers[0],v=[];let C=null;m.type==="circle"&&(C=m.layout.get("circle-sort-key"));for(const{feature:F,id:k,index:z,sourceLayerIndex:H}of i){const $=this.layers[0]._featureFilter.needGeometry,ee=Ki(F,$);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),ee,d))continue;const ae=C?C.evaluate(ee,{},d):void 0,fe={id:k,properties:F.properties,type:F.type,sourceLayerIndex:H,index:z,geometry:$?ee.geometry:tr(F,d,f),patterns:{},sortKey:ae};v.push(fe)}C&&v.sort((F,k)=>F.sortKey-k.sortKey);let T=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new af,T=f.projection);for(const F of v){const{geometry:k,index:z,sourceLayerIndex:H}=F,$=i[z].feature;this.addFeature(F,k,z,o.availableImages,d,T,o.brightness,o.elevationFeatures),o.featureIndex.insert($,k,z,H,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(i,o,d,f,m,v,C){this.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,TA.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Fu.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,ed.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(i,o,d,f,m,v,C,T){let F;this.elevationMode!=="none"&&(F=Ht.getElevationFeature(i,T));for(const k of o)for(const z of k){const H=z.x,$=z.y;if(H<0||H>=wi||$<0||$>=wi)continue;if(v){const fe=v.projectTilePoint(H,$,m),ve=v.upVector(m,H,$);this.addGlobeExtVertex(fe,ve),this.addGlobeExtVertex(fe,ve),this.addGlobeExtVertex(fe,ve),this.addGlobeExtVertex(fe,ve)}const ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),ae=ee.vertexLength;if(this.addCircleVertex(H,$,-1,-1),this.addCircleVertex(H,$,1,-1),this.addCircleVertex(H,$,1,1),this.addCircleVertex(H,$,-1,1),this.elevationMode!=="none"){const fe=F?F.pointElevation(new qt(H,$)):0;this.hasElevation=this.hasElevation||fe!==0;for(let ve=0;ve<4;ve++)this.elevatedLayoutVertexArray.emplaceBack(fe)}this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+2,ae+3),ee.vertexLength+=4,ee.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,{},f,m,C,void 0,this.worldview)}addCircleVertex(i,o,d,f){this.layoutVertexArray.emplaceBack(2*i+(d+1)/2,2*o+(f+1)/2)}addGlobeExtVertex(i,o){this.globeExtVertexArray.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}}function Ui(l,i){for(let o=0;o<l.length;o++)if(os(i,l[o]))return!0;for(let o=0;o<i.length;o++)if(os(l,i[o]))return!0;return!!Jn(l,i)}function Gr(l,i,o){return!!os(l,i)||!!ns(i,l,o)}function vr(l,i){if(l.length===1)return Kr(i,l[0]);for(let o=0;o<i.length;o++){const d=i[o];for(let f=0;f<d.length;f++)if(os(l,d[f]))return!0}for(let o=0;o<l.length;o++)if(Kr(i,l[o]))return!0;for(let o=0;o<i.length;o++)if(Jn(l,i[o]))return!0;return!1}function Rr(l,i,o){if(l.length>1){if(Jn(l,i))return!0;for(let d=0;d<i.length;d++)if(ns(i[d],l,o))return!0}for(let d=0;d<l.length;d++)if(ns(l[d],i,o))return!0;return!1}function Jn(l,i){if(l.length===0||i.length===0)return!1;for(let o=0;o<l.length-1;o++){const d=l[o],f=l[o+1];for(let m=0;m<i.length-1;m++)if(An(d,f,i[m],i[m+1]))return!0}return!1}function An(l,i,o,d){return qn(l,o,d)!==qn(i,o,d)&&qn(l,i,o)!==qn(l,i,d)}function rn(l,i,o){return(l.x-o.x)*(i.y-o.y)-(l.y-o.y)*(i.x-o.x)}function Ys(l,i,o,d){const f=rn(l,i,d),m=rn(l,i,o);if(Math.sign(f)===Math.sign(m))return;const v=rn(o,d,l),C=v+m-f;return Math.sign(v)!==Math.sign(C)?[v/(v-C),m/(m-f)]:void 0}function ns(l,i,o){const d=o*o;if(i.length===1)return l.distSqr(i[0])<d;for(let f=1;f<i.length;f++)if(Un(l,i[f-1],i[f])<d)return!0;return!1}function Un(l,i,o){const d=i.distSqr(o);if(d===0)return l.distSqr(i);const f=((l.x-i.x)*(o.x-i.x)+(l.y-i.y)*(o.y-i.y))/d;return l.distSqr(f<0?i:f>1?o:o.sub(i)._mult(f)._add(i))}function Kr(l,i){let o,d,f,m=!1;for(let v=0;v<l.length;v++){o=l[v];for(let C=0,T=o.length-1;C<o.length;T=C++)d=o[C],f=o[T],d.y>i.y!=f.y>i.y&&i.x<(f.x-d.x)*(i.y-d.y)/(f.y-d.y)+d.x&&(m=!m)}return m}function os(l,i){let o=!1;for(let d=0,f=l.length-1;d<l.length;f=d++){const m=l[d],v=l[f];m.y>i.y!=v.y>i.y&&i.x<(v.x-m.x)*(i.y-m.y)/(v.y-m.y)+m.x&&(o=!o)}return o}function Bs(l,i,o,d,f){for(const v of l)if(i<=v.x&&o<=v.y&&d>=v.x&&f>=v.y)return!0;const m=[new qt(i,o),new qt(i,f),new qt(d,f),new qt(d,o)];if(l.length>2){for(const v of m)if(os(l,v))return!0}for(let v=0;v<l.length-1;v++)if(Mn(l[v],l[v+1],m))return!0;return!1}function Mn(l,i,o){const d=o[0],f=o[2];if(l.x<d.x&&i.x<d.x||l.x>f.x&&i.x>f.x||l.y<d.y&&i.y<d.y||l.y>f.y&&i.y>f.y)return!1;const m=qn(l,i,o[0]);return m!==qn(l,i,o[1])||m!==qn(l,i,o[2])||m!==qn(l,i,o[3])}function Mo(l,i,o,d,f,m){let v=i.y-l.y,C=l.x-i.x;if(m=m||0){const T=v*v+C*C;if(T===0)return!0;const F=Math.sqrt(T);v/=F,C/=F}return!((o.x-l.x)*v+(o.y-l.y)*C-m<0||(d.x-l.x)*v+(d.y-l.y)*C-m<0||(f.x-l.x)*v+(f.y-l.y)*C-m<0)}function fc(l,i,o,d,f,m,v){return!(Mo(l,i,d,f,m,v)||Mo(i,o,d,f,m,v)||Mo(o,l,d,f,m,v)||Mo(d,f,l,i,o,v)||Mo(f,m,l,i,o,v)||Mo(m,d,l,i,o,v))}function Ll(l,i,o){const d=i.paint.get(l).value;return d.kind==="constant"?d.value:o.programConfigurations.get(i.id).getMaxValue(l)}function go(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Ml(l,i,o,d,f){if(!i[0]&&!i[1])return l;const m=qt.convert(i)._mult(f);o==="viewport"&&m._rotate(-d);const v=[];for(let C=0;C<l.length;C++)v.push(l[C].sub(m));return v}function Rd(l,i,o,d){const f=qt.convert(l)._mult(d);return i==="viewport"&&f._rotate(-o),f}let kc,Rc;function PA(l,i,o){var d=2*Math.PI*6378137/256/Math.pow(2,o);return[l*d-2*Math.PI*6378137/2,i*d-2*Math.PI*6378137/2]}Zi(pi,"CircleBucket",{omit:["layers"]});class pc{constructor(i,o,d){this.z=i,this.x=o,this.y=d,this.key=ih(0,i,i,o,d)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o){const d=function(m,v,C){var T=PA(256*m,256*(v=Math.pow(2,C)-v-1),C),F=PA(256*(m+1),256*(v+1),C);return T[0]+","+T[1]+","+F[0]+","+F[1]}(this.x,this.y,this.z),f=function(m,v,C){let T,F="";for(let k=m;k>0;k--)T=1<<k-1,F+=(v&T?1:0)+(C&T?2:0);return F}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dd{constructor(i,o){this.wrap=i,this.canonical=o,this.key=ih(i,o.z,o.z,o.x,o.y)}}class ma{constructor(i,o,d,f,m){this.overscaledZ=i,this.wrap=o,this.canonical=new pc(d,+f,+m),this.key=o===0&&i===d?this.canonical.key:ih(o,i,d,f,m)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const o=this.canonical.z-i;return i>this.canonical.z?new ma(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ma(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o=!0){if(this.overscaledZ===i&&o)return this.key;if(i>this.canonical.z)return ih(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-i;return ih(this.wrap*+o,i,i,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,d=2*this.canonical.x,f=2*this.canonical.y;return[new ma(o,this.wrap,o,d,f),new ma(o,this.wrap,o,d+1,f),new ma(o,this.wrap,o,d,f+1),new ma(o,this.wrap,o,d+1,f+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new ma(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ih(l,i,o,d,f){const m=1<<Math.min(o,22);let v=m*(f%m)+d%m;return l&&o<22&&(v+=m*m*((l<0?-2*l-1:2*l)%(1<<2*(22-o)))),16*(32*v+o)+(i-o)}const Od=[l=>{let i=l.canonical.x-1,o=l.wrap;return i<0&&(i=(1<<l.canonical.z)-1,o--),new ma(l.overscaledZ,o,l.canonical.z,i,l.canonical.y)},l=>{let i=l.canonical.x+1,o=l.wrap;return i===1<<l.canonical.z&&(i=0,o++),new ma(l.overscaledZ,o,l.canonical.z,i,l.canonical.y)},l=>new ma(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new ma(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];Zi(pc,"CanonicalTileID"),Zi(ma,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const gf=On([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:rh}=gf,ip=On([{name:"a_pos_3",components:3,type:"Int16"}]);var rp=On([{name:"a_pos",type:"Int16",components:2}]);function fv(l){return l*S/ge}const SF=[new De([Z,Z,Z],[te,te,te]),new De([Z,Z,Z],[0,0,te]),new De([0,Z,Z],[te,0,te]),new De([Z,0,Z],[0,te,te]),new De([0,0,Z],[te,te,te])];function vw(l,i,o,d=!0){const f=Qe([],l._camera.position,l.worldSize),m=[i,o,1,1];Kt(m,m,l.pixelMatrixInverse),yi(m,m,1/m[3]);const v=mt([],Ve([],m,f)),C=l.globeMatrix,T=[C[12],C[13],C[14]],F=Ve([],T,f),k=Le(F),z=mt([],F),H=l.worldSize/(2*Math.PI),$=Bt(z,v),ee=Math.asin(H/k);if(ee<Math.acos($)){if(!d)return null;const _t=[],Mt=[];Qe(_t,v,k/$),mt(Mt,Ve(Mt,_t,F)),mt(v,Me(v,F,Qe(v,Mt,Math.tan(ee)*k)))}const ae=[];new Ds(f,v).closestPointOnSphere(T,H,ae);const fe=mt([],bs(C,0)),ve=mt([],bs(C,1)),Fe=mt([],bs(C,2)),Pe=Bt(fe,ae),ue=Bt(ve,ae),Ie=Bt(Fe,ae),ke=Et(Math.asin(-ue/H));let Ge=Et(Math.atan2(Pe,Ie));Ge=l.center.lng+function(_t,Mt){const Wt=(Mt-_t+180)%360-180;return Wt<-180?Wt+360:Wt}(l.center.lng,Ge);const yt=nt(Ge),At=Ye(qe(ke),0,1);return new Ct(yt,At)}class EF{constructor(i,o,d){this.a=Ve([],i,d),this.b=Ve([],o,d),this.center=d;const f=mt([],this.a),m=mt([],this.b);this.angle=Math.acos(Bt(f,m))}}function S_(l,i){if(l.angle===0)return null;let o;return o=l.a[i]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[i]/l.a[i]/Math.sin(l.angle)-1/Math.tan(l.angle)),o<0||o>1?null:function(d,f,m,v){const C=Math.sin(m);return d*(Math.sin((1-v)*m)/C)+f*(Math.sin(v*m)/C)}(l.a[i],l.b[i],l.angle,Ye(o,0,1))+l.center[i]}function kA(l){if(l.z<=1)return SF[l.z+2*l.y+l.x];const i=E_(pv(l));return De.fromPoints(i)}function mf(l,i,o){return Qe(l,l,1-o),It(l,l,i,o)}function _w(l,i,o){for(const d of l)vt(d,d,i),Qe(d,d,o)}function xw(l,i,o,d){const f=i/l.worldSize,m=l.globeMatrix;if(o.z<=1){const At=kA(o).getCorners();return _w(At,m,f),De.fromPoints(At)}const v=pv(o,d),C=E_(v,S+fv(l._tileCoverLift));_w(C,m,f);const T=Number.MAX_VALUE,F=[-T,-T,-T],k=[T,T,T];if(v.contains(l.center)){for(const Mt of C)$e(k,k,Mt),ct(F,F,Mt);F[2]=0;const At=l.point,_t=[At.x*f,At.y*f,0];return $e(k,k,_t),ct(F,F,_t),new De(k,F)}if(l._tileCoverLift>0){for(const At of C)$e(k,k,At),ct(F,F,At);return new De(k,F)}const z=[m[12]*f,m[13]*f,m[14]*f],H=v.getCenter(),$=Ye(l.center.lat,-85.051129,ti),ee=Ye(H.lat,-85.051129,ti),ae=nt(l.center.lng),fe=qe($);let ve=ae-nt(H.lng);const Fe=fe-qe(ee);ve>.5?ve-=1:ve<-.5&&(ve+=1);let Pe=0;Math.abs(ve)>Math.abs(Fe)?Pe=ve>=0?1:3:(Pe=Fe>=0?0:2,It(z,z,[m[4]*f,m[5]*f,m[6]*f],-Math.sin(dn(Fe>=0?v.getSouth():v.getNorth()))*S));const ue=C[Pe],Ie=C[(Pe+1)%4],ke=new EF(ue,Ie,z),Ge=[S_(ke,0)||ue[0],S_(ke,1)||ue[1],S_(ke,2)||ue[2]],yt=np(l.zoom);if(yt>0){const At=function({x:Mt,y:Wt,z:Si},Ai,Ci,Ti,$t){const _i=1/(1<<Si);let Vt=Mt*_i,Yt=Vt+_i,ki=Wt*_i,Di=ki+_i,xr=0;const ur=(Vt+Yt)/2-Ti;return ur>.5?xr=-1:ur<-.5&&(xr=1),Vt=((Vt+xr)*Ai-(Ti*=Ai))*Ci+Ti,Yt=((Yt+xr)*Ai-Ti)*Ci+Ti,ki=(ki*Ai-($t*=Ai))*Ci+$t,Di=(Di*Ai-$t)*Ci+$t,[[Vt,Di,0],[Yt,Di,0],[Yt,ki,0],[Vt,ki,0]]}(o,i,l._pixelsPerMercatorPixel,ae,fe);for(let Mt=0;Mt<C.length;Mt++)mf(C[Mt],At[Mt],yt);const _t=Me([],At[Pe],At[(Pe+1)%4]);Qe(_t,_t,.5),mf(Ge,_t,yt)}for(const At of C)$e(k,k,At),ct(F,F,At);return k[2]=Math.min(ue[2],Ie[2]),$e(k,k,Ge),ct(F,F,Ge),new De(k,F)}function pv({x:l,y:i,z:o},d=!1){const f=1/(1<<o),m=new Te(ft(l*f),i===(1<<o)-1&&d?-90:Rt((i+1)*f)),v=new Te(ft((l+1)*f),i===0&&d?90:Rt(i*f));return new je(m,v)}function E_(l,i=S){const o=dn(l.getNorth()),d=dn(l.getSouth()),f=Math.cos(o),m=Math.cos(d),v=Math.sin(o),C=Math.sin(d),T=l.getWest(),F=l.getEast();return[de(m,C,T,i),de(m,C,F,i),de(f,v,F,i),de(f,v,T,i)]}function Em(l,i,o,d){const f=1<<o.z,m=(l/wi+o.x)/f;return he(Rt((i/wi+o.y)/f),ft(m),d)}function gv({min:l,max:i}){return V/Math.max(i[0]-l[0],i[1]-l[1],i[2]-l[2])}const bw=new Float64Array(16);function mv(l){const i=gv(l),o=Ae(bw,[i,i,i]);return Q(o,o,lt([],l.min))}function I_(l){const i=(d=l.min,(o=bw)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=d[0],o[13]=d[1],o[14]=d[2],o[15]=1,o);var o,d;const f=1/gv(l);return q(i,i,[f,f,f])}function T_(l){const i=wi/(2*Math.PI);return l/(2*Math.PI)/i}function ww(l,i){return wi/(512*Math.pow(2,l))*gv(kA(i))}function Bw(l,i,o,d,f){const m=T_(o),v=[l,i,-o/(2*Math.PI)],C=M(new Float64Array(16));return Q(C,C,v),q(C,C,[m,m,m]),ne(C,C,dn(-f)),re(C,C,dn(-d)),C}function np(l){return xt(L,P,l)}function Cw(l,i){const o=he(i.lat,i.lng),d=function(ee){const ae=he(ee._center.lat,ee._center.lng);let fe=rt([],Se(0,1,0),ae);const ve=le([],-ee.angle,ae);fe=vt(fe,fe,ve),le(ve,-ee._pitch,fe);const Fe=mt([],ae);return Qe(Fe,Fe,fv(ee.cameraToCenterDistance/ee.pixelsPerMeter)),vt(Fe,Fe,ve),Me([],ae,Fe)}(l);return v=(f=Re([],d,o))[0],C=f[1],T=f[2],F=(m=o)[0],k=m[1],z=m[2],$=(H=Math.sqrt(v*v+C*C+T*T)*Math.sqrt(F*F+k*k+z*z))&&Bt(f,m)/H,Math.acos(Math.min(Math.max($,-1),1));var f,m,v,C,T,F,k,z,H,$}function F_(l,i){return Cw(l,i)>Math.PI/2*1.01}const Sw=dn(85),IF=Math.cos(Sw),TF=Math.sin(Sw),FF=R(),Ew=l=>{const i=[];return l.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function Iw(l,i,o,d,f,m,v,C,T){if(m&&l.queryGeometry.isAboveHorizon)return!1;m&&(T*=l.pixelToTileUnitsFactor);const F=l.tileID.canonical,k=o.projection.upVectorScale(F,o.center.lat,o.worldSize).metersToTile;for(const z of i)for(const H of z){const $=H.add(C),ee=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt($.x,$.y,!0):0,ae=o.projection.projectTilePoint($.x,$.y,F);if(ee>0){const Pe=o.projection.upVector(F,$.x,$.y);ae.x+=Pe[0]*k*ee,ae.y+=Pe[1]*k*ee,ae.z+=Pe[2]*k*ee}const fe=m?$:LF(ae.x,ae.y,ae.z,d),ve=m?l.tilespaceRays.map(Pe=>PF(Pe,ee)):l.queryGeometry.screenGeometry,Fe=Kt([],[ae.x,ae.y,ae.z,1],d);if(!v&&m?T*=Fe[3]/o.cameraToCenterDistance:v&&!m&&(T*=o.cameraToCenterDistance/Fe[3]),m){const Pe=Rt((H.y/wi+F.y)/(1<<F.z));T/=o.projection.pixelsPerMeter(Pe,1)/ht(1,Pe)}if(Gr(ve,fe,T))return!0}return!1}function LF(l,i,o,d){const f=Kt([],[l,i,o,1],d);return new qt(f[0]/f[3],f[1]/f[3])}const Tw=Se(0,0,0),MF=Se(0,0,1);function PF(l,i){const o=oe();return Tw[2]=i,l.intersectsPlane(Tw,MF,o),new qt(o[0],o[1])}class Fw extends pi{}let Lw,Mw,Pw,kw;function Rw(l,{width:i,height:o},d,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==i*o*d)throw new RangeError("mismatched image size")}else f=new Uint8Array(i*o*d);return l.width=i,l.height=o,l.data=f,l}function Dw(l,i,o){const{width:d,height:f}=i;d===l.width&&f===l.height||(L_(l,i,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,d),height:Math.min(l.height,f)},o,null),l.width=d,l.height=f,l.data=i.data)}function L_(l,i,o,d,f,m,v,C){if(f.width===0||f.height===0)return i;if(f.width>l.width||f.height>l.height||o.x>l.width-f.width||o.y>l.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>i.width||f.height>i.height||d.x>i.width-f.width||d.y>i.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const T=l.data,F=i.data,k=m===4&&C;for(let z=0;z<f.height;z++){const H=((o.y+z)*l.width+o.x)*m,$=((d.y+z)*i.width+d.x)*m;if(k)for(let ee=0;ee<f.width;ee++){const ae=H+ee*m+3,fe=$+ee*m;F[fe+0]=255,F[fe+1]=255,F[fe+2]=255,F[fe+3]=T[ae]}else if(v)for(let ee=0;ee<f.width;ee++){const ae=H+ee*m,fe=$+ee*m,ve=new jn(T[ae+0]/255,T[ae+1]/255,T[ae+2]/255,T[ae+3]).toNonPremultipliedRenderColor(v).toArray();F[fe+0]=ve[0],F[fe+1]=ve[1],F[fe+2]=ve[2],F[fe+3]=ve[3]}else for(let ee=0;ee<f.width*m;ee++)F[$+ee]=T[H+ee]}return i}Zi(Fw,"HeatmapBucket",{omit:["layers"]});class sp{constructor(i,o){Rw(this,i,1,o)}resize(i){Dw(this,new sp(i),1)}clone(){return new sp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,d,f,m){L_(i,o,d,f,m,1,null)}}class Pl{constructor(i,o){Rw(this,i,4,o)}resize(i){Dw(this,new Pl(i),4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Pl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,d,f,m,v,C){L_(i,o,d,f,m,4,v,C)}}class Ow{constructor(i,o){this.width=i.width,this.height=i.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Im(l){const i={},o=l.resolution||256,d=l.clips?l.clips.length:1,f=l.image||new Pl({width:o,height:d}),m=(v,C,T)=>{i[l.evaluationKey]=T;const F=l.expression.evaluate(i),k=F?F.toNonPremultipliedRenderColor(null):null;k&&(f.data[v+C+0]=Math.floor(255*k.r),f.data[v+C+1]=Math.floor(255*k.g),f.data[v+C+2]=Math.floor(255*k.b),f.data[v+C+3]=Math.floor(255*k.a))};if(l.clips)for(let v=0,C=0;v<d;++v,C+=4*o)for(let T=0,F=0;T<o;T++,F+=4){const k=T/(o-1),{start:z,end:H}=l.clips[v];m(C,F,z*(1-k)+H*k)}else for(let v=0,C=0;v<o;v++,C+=4)m(0,C,v/(o-1));return f}Zi(sp,"AlphaImage"),Zi(Pl,"RGBAImage");const kF=On([{name:"a_pos",components:2,type:"Int16"}],4),RF=On([{name:"a_road_z_offset",components:1,type:"Float32"}],4),DF=On([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),OF=On([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Tm(l,i,o=2){const d=i&&i.length,f=d?i[0]*o:l.length;let m=Uw(l,0,f,o,!0);const v=[];if(!m||m.next===m.prev)return v;let C,T,F;if(d&&(m=function(k,z,H,$){const ee=[];for(let ae=0,fe=z.length;ae<fe;ae++){const ve=Uw(k,z[ae]*$,ae<fe-1?z[ae+1]*$:k.length,$,!1);ve===ve.next&&(ve.steiner=!0),ee.push(GF(ve))}ee.sort(HF);for(let ae=0;ae<ee.length;ae++)H=QF(ee[ae],H);return H}(l,i,m,o)),l.length>80*o){C=1/0,T=1/0;let k=-1/0,z=-1/0;for(let H=o;H<f;H+=o){const $=l[H],ee=l[H+1];$<C&&(C=$),ee<T&&(T=ee),$>k&&(k=$),ee>z&&(z=ee)}F=Math.max(k-C,z-T),F=F!==0?32767/F:0}return Fm(m,v,o,C,T,F,0),v}function Uw(l,i,o,d,f){let m;if(f===function(v,C,T,F){let k=0;for(let z=C,H=T-F;z<T;z+=F)k+=(v[H]-v[z])*(v[z+1]+v[H+1]),H=z;return k}(l,i,o,d)>0)for(let v=i;v<o;v+=d)m=Hw(v/d|0,l[v],l[v+1],m);else for(let v=o-d;v>=i;v-=d)m=Hw(v/d|0,l[v],l[v+1],m);return m&&Pg(m,m.next)&&(Pm(m),m=m.next),m}function Wp(l,i){if(!l)return l;i||(i=l);let o,d=l;do if(o=!1,d.steiner||!Pg(d,d.next)&&Ka(d.prev,d,d.next)!==0)d=d.next;else{if(Pm(d),d=i=d.prev,d===d.next)break;o=!0}while(o||d!==i);return i}function Fm(l,i,o,d,f,m,v){if(!l)return;!v&&m&&function(T,F,k,z){let H=T;do H.z===0&&(H.z=M_(H.x,H.y,F,k,z)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==T);H.prevZ.nextZ=null,H.prevZ=null,function($){let ee,ae=1;do{let fe,ve=$;$=null;let Fe=null;for(ee=0;ve;){ee++;let Pe=ve,ue=0;for(let ke=0;ke<ae&&(ue++,Pe=Pe.nextZ,Pe);ke++);let Ie=ae;for(;ue>0||Ie>0&&Pe;)ue!==0&&(Ie===0||!Pe||ve.z<=Pe.z)?(fe=ve,ve=ve.nextZ,ue--):(fe=Pe,Pe=Pe.nextZ,Ie--),Fe?Fe.nextZ=fe:$=fe,fe.prevZ=Fe,Fe=fe;ve=Pe}Fe.nextZ=null,ae*=2}while(ee>1)}(H)}(l,d,f,m);let C=l;for(;l.prev!==l.next;){const T=l.prev,F=l.next;if(m?zF(l,d,f,m):UF(l))i.push(T.i,l.i,F.i),Pm(l),l=F.next,C=F.next;else if((l=F)===C){v?v===1?Fm(l=NF(Wp(l),i),i,o,d,f,m,2):v===2&&jF(l,i,o,d,f,m):Fm(Wp(l),i,o,d,f,m,1);break}}}function UF(l){const i=l.prev,o=l,d=l.next;if(Ka(i,o,d)>=0)return!1;const f=i.x,m=o.x,v=d.x,C=i.y,T=o.y,F=d.y,k=Math.min(f,m,v),z=Math.min(C,T,F),H=Math.max(f,m,v),$=Math.max(C,T,F);let ee=d.next;for(;ee!==i;){if(ee.x>=k&&ee.x<=H&&ee.y>=z&&ee.y<=$&&Lm(f,C,m,T,v,F,ee.x,ee.y)&&Ka(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function zF(l,i,o,d){const f=l.prev,m=l,v=l.next;if(Ka(f,m,v)>=0)return!1;const C=f.x,T=m.x,F=v.x,k=f.y,z=m.y,H=v.y,$=Math.min(C,T,F),ee=Math.min(k,z,H),ae=Math.max(C,T,F),fe=Math.max(k,z,H),ve=M_($,ee,i,o,d),Fe=M_(ae,fe,i,o,d);let Pe=l.prevZ,ue=l.nextZ;for(;Pe&&Pe.z>=ve&&ue&&ue.z<=Fe;){if(Pe.x>=$&&Pe.x<=ae&&Pe.y>=ee&&Pe.y<=fe&&Pe!==f&&Pe!==v&&Lm(C,k,T,z,F,H,Pe.x,Pe.y)&&Ka(Pe.prev,Pe,Pe.next)>=0||(Pe=Pe.prevZ,ue.x>=$&&ue.x<=ae&&ue.y>=ee&&ue.y<=fe&&ue!==f&&ue!==v&&Lm(C,k,T,z,F,H,ue.x,ue.y)&&Ka(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;Pe&&Pe.z>=ve;){if(Pe.x>=$&&Pe.x<=ae&&Pe.y>=ee&&Pe.y<=fe&&Pe!==f&&Pe!==v&&Lm(C,k,T,z,F,H,Pe.x,Pe.y)&&Ka(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.prevZ}for(;ue&&ue.z<=Fe;){if(ue.x>=$&&ue.x<=ae&&ue.y>=ee&&ue.y<=fe&&ue!==f&&ue!==v&&Lm(C,k,T,z,F,H,ue.x,ue.y)&&Ka(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function NF(l,i){let o=l;do{const d=o.prev,f=o.next.next;!Pg(d,f)&&Nw(d,o,o.next,f)&&Mm(d,f)&&Mm(f,d)&&(i.push(d.i,o.i,f.i),Pm(o),Pm(o.next),o=l=f),o=o.next}while(o!==l);return Wp(o)}function jF(l,i,o,d,f,m){let v=l;do{let C=v.next.next;for(;C!==v.prev;){if(v.i!==C.i&&WF(v,C)){let T=jw(v,C);return v=Wp(v,v.next),T=Wp(T,T.next),Fm(v,i,o,d,f,m,0),void Fm(T,i,o,d,f,m,0)}C=C.next}v=v.next}while(v!==l)}function HF(l,i){let o=l.x-i.x;return o===0&&(o=l.y-i.y,o===0)&&(o=(l.next.y-l.y)/(l.next.x-l.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function QF(l,i){const o=function(f,m){let v=m;const C=f.x,T=f.y;let F,k=-1/0;if(Pg(f,v))return v;do{if(Pg(f,v.next))return v.next;if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){const ae=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(ae<=C&&ae>k&&(k=ae,F=v.x<v.next.x?v:v.next,ae===C))return F}v=v.next}while(v!==m);if(!F)return null;const z=F,H=F.x,$=F.y;let ee=1/0;v=F;do{if(C>=v.x&&v.x>=H&&C!==v.x&&zw(T<$?C:k,T,H,$,T<$?k:C,T,v.x,v.y)){const ae=Math.abs(T-v.y)/(C-v.x);Mm(v,f)&&(ae<ee||ae===ee&&(v.x>F.x||v.x===F.x&&VF(F,v)))&&(F=v,ee=ae)}v=v.next}while(v!==z);return F}(l,i);if(!o)return i;const d=jw(o,l);return Wp(d,d.next),Wp(o,o.next)}function VF(l,i){return Ka(l.prev,l,i.prev)<0&&Ka(i.next,l,l.next)<0}function M_(l,i,o,d,f){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*f|0)|l<<8))|l<<4))|l<<2))|l<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-d)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function GF(l){let i=l,o=l;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==l);return o}function zw(l,i,o,d,f,m,v,C){return(f-v)*(i-C)>=(l-v)*(m-C)&&(l-v)*(d-C)>=(o-v)*(i-C)&&(o-v)*(m-C)>=(f-v)*(d-C)}function Lm(l,i,o,d,f,m,v,C){return!(l===v&&i===C)&&zw(l,i,o,d,f,m,v,C)}function WF(l,i){return l.next.i!==i.i&&l.prev.i!==i.i&&!function(o,d){let f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==d.i&&f.next.i!==d.i&&Nw(f,f.next,o,d))return!0;f=f.next}while(f!==o);return!1}(l,i)&&(Mm(l,i)&&Mm(i,l)&&function(o,d){let f=o,m=!1;const v=(o.x+d.x)/2,C=(o.y+d.y)/2;do f.y>C!=f.next.y>C&&f.next.y!==f.y&&v<(f.next.x-f.x)*(C-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==o);return m}(l,i)&&(Ka(l.prev,l,i.prev)||Ka(l,i.prev,i))||Pg(l,i)&&Ka(l.prev,l,l.next)>0&&Ka(i.prev,i,i.next)>0)}function Ka(l,i,o){return(i.y-l.y)*(o.x-i.x)-(i.x-l.x)*(o.y-i.y)}function Pg(l,i){return l.x===i.x&&l.y===i.y}function Nw(l,i,o,d){const f=vv(Ka(l,i,o)),m=vv(Ka(l,i,d)),v=vv(Ka(o,d,l)),C=vv(Ka(o,d,i));return f!==m&&v!==C||!(f!==0||!yv(l,o,i))||!(m!==0||!yv(l,d,i))||!(v!==0||!yv(o,l,d))||!(C!==0||!yv(o,i,d))}function yv(l,i,o){return i.x<=Math.max(l.x,o.x)&&i.x>=Math.min(l.x,o.x)&&i.y<=Math.max(l.y,o.y)&&i.y>=Math.min(l.y,o.y)}function vv(l){return l>0?1:l<0?-1:0}function Mm(l,i){return Ka(l.prev,l,l.next)<0?Ka(l,i,l.next)>=0&&Ka(l,l.prev,i)>=0:Ka(l,i,l.prev)<0||Ka(l,l.next,i)<0}function jw(l,i){const o=P_(l.i,l.x,l.y),d=P_(i.i,i.x,i.y),f=l.next,m=i.prev;return l.next=i,i.prev=l,o.next=f,f.prev=o,d.next=o,o.prev=d,m.next=d,d.prev=m,d}function Hw(l,i,o,d){const f=P_(l,i,o);return d?(f.next=d.next,f.prev=d,d.next.prev=f,d.next=f):(f.prev=f,f.next=f),f}function Pm(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function P_(l,i,o){return{i:l,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function _v(l,i){const o=l.length;if(o<=1)return[l];const d=[];let f,m;for(let v=0;v<o;v++){const C=gs(l[v]);C!==0&&(l[v].area=Math.abs(C),m===void 0&&(m=C<0),m===C<0?(f&&d.push(f),f=[l[v]]):f.push(l[v]))}if(f&&d.push(f),i>1)for(let v=0;v<d.length;v++)d[v].length<=i||(qo(d[v],i,1,d[v].length-1,XF),d[v]=d[v].slice(0,i));return d}function XF(l,i){return i.area-l.area}function Qw(l,i,o=1){if(!l)return null;const d=typeof l=="string"?Js.from(l).getPrimary():l.getPrimary(),f=typeof l=="string"?null:l.getSecondary();for(const m of[d,f]){if(!m)continue;const v=m.id.toString();i.has(v)||i.set(v,[]),m.scaleSelf(o),i.get(v).push(m)}return{primary:d.toString(),secondary:f?f.toString():null}}function k_(l,i,o,d){const f=d.patternDependencies;let m=!1;for(const v of i){const C=v.paint.get(`${l}-pattern`);C.isConstant()||(m=!0),Qw(C.constantOr(null),f,o)&&(m=!0)}return m}function R_(l,i,o,d,f,m){const v=m.patternDependencies;for(const C of i){const T=C.paint.get(`${l}-pattern`).value;if(T.kind!=="constant"){let F=T.evaluate({zoom:d},o,{},m.availableImages);F=F&&F.name?F.name:F;const k=Qw(F,v,f);if(!k)continue;const{primary:z,secondary:H}=k;z&&(o.patterns[C.id]=[z,H].filter(Boolean))}}return o}class Vw{constructor(){this.polygons=new Map}add(i,...o){this.polygons.has(i)?this.polygons.get(i).push(...o):this.polygons.set(i,o)}merge(i){for(const[o,d]of i.polygons)this.add(o,...d)}}class Xp{constructor(){this.portals=[]}static evaluate(i){if(i.length===0)return new Xp;let o=[];for(const F of i)o.push(...F.portals);if(o.length===0)return new Xp;const d=(F,k)=>F<=0&&k<=0||F>=wi&&k>=wi;for(const F of o){const k=F.va,z=F.vb;(d(k.x,z.x)||d(k.y,z.y))&&(F.type="border")}const f=o.filter(F=>F.type!=="unevaluated"),m=o.filter(F=>F.type==="unevaluated");if(m.length===0)return new Xp;m.sort((F,k)=>F.hash===k.hash?F.isTunnel===k.isTunnel?0:F.isTunnel?-1:1:F.hash<k.hash?1:-1),o=f.concat(m);let v=f.length,C=v,T=v;do if(C++,C===o.length||o[v].hash!==o[C].hash){if(C-v==2){T<v&&(o[T]=o[v],o[v]=null);const F=o[T],k=o[C-1];F.type=F.isTunnel!==k.isTunnel?"tunnel":"polygon",F.connection={a:F.connection.a,b:k.connection.a},T++}v=C}while(v!==o.length);return o.splice(T),o.sort((F,k)=>F.hash<k.hash?1:-1),{portals:o}}}Zi(Xp,"ElevationPortalGraph"),Zi(Vw,"ElevationPolygons");class YF{constructor(i,o,d){this.outPositions=i,this.outNormals=o,this.outIndices=d,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(i,o,d){let f=i[2];d!=null&&(f*=d);const m=this.getVec3Bits(i)<<96n|this.getVec3Bits(o),v=this.vertexLookup.get(m);if(v!=null)return v;const C=this.outPositions.length;this.vertexLookup.set(m,C);const T=Math.trunc(16384*o[0]),F=Math.trunc(16384*o[1]),k=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(i[0],i[1],f),this.outNormals.emplaceBack(T,F,k),C}addVertices(i,o,...d){const f=[];for(const m of d){const v=this.addVertex(m,i,o);f.push(v)}return f}addTriangles(i,o,d){if(o&&d){const f=d.length===1,m=Se(0,0,0);for(let v=0;v<i.length;v+=3){const C=o[i[v+0]],T=o[i[v+1]],F=o[i[v+2]],k=f?d[0]:d[i[v+1]],z=f?d[0]:d[i[v+2]],H=this.addVertex(Se(C.x,C.y,f?d[0]:d[i[v+0]]),m),$=this.addVertex(Se(T.x,T.y,k),m),ee=this.addVertex(Se(F.x,F.y,z),m);this.outIndices.emplaceBack(H,$,ee)}}else for(let f=0;f<i.length;f+=3)this.outIndices.emplaceBack(i[f+0],i[f+1],i[f+2])}addQuad(i,o){const d=this.addVertices(o,void 0,...i.map(T=>Se(T.coord.x,T.coord.y,T.height))),[f,m,v,C]=d;this.addTriangles([f,m,v,v,C,f])}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(i){return this.view.setFloat32(0,i),BigInt(this.view.getUint32(0))}getVec3Bits(i){return this.getBits(i[0])<<64n|this.getBits(i[1])<<32n|this.getBits(i[2])}}class nh{constructor(i,o,d,f){this.unevaluatedPortals=new Xp,this.portalPolygons=new Vw,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Dp,this.vertexNormals=new Gf,this.indexArray=new Jo,this.tileToMeters=Qt(i),this.bridgeProgramConfigurations=new p(o,{zoom:d,lut:f},m=>m!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new p(o,{zoom:d,lut:f},m=>m!=="fill-bridge-guard-rail-color")}addVertices(i,o){const d=this.unevalVertices.length;for(let f=0;f<i.length;f++)this.unevalVertices.push(i[f]),this.unevalHeights.push(o[f]);return d}addTriangles(i,o,d){const f=d?this.unevalTunnelTriangles:this.unevalTriangles;for(const m of i)f.push(m+o)}addRenderableRing(i,o,d,f,m,v){const C=[new qt(m.min.x,m.min.y),new qt(m.max.x,m.min.y),new qt(m.max.x,m.max.y),new qt(m.min.x,m.max.y)];for(let T=0;T<d-1;T++){const F=o+T,k=F+1,z=this.unevalVertices[F],H=this.unevalVertices[k];if(!(z.x>=m.min.x&&z.x<=m.max.x&&z.y>=m.min.y&&z.y<=m.max.y||H.x>=m.min.x&&H.x<=m.max.x&&H.y>=m.min.y&&H.y<=m.max.y||Mn(z,H,C))||this.isOnBorder(z.x,H.x)||this.isOnBorder(z.y,H.y))continue;const $=nh.computeEdgeHash(this.unevalVertices[F],this.unevalVertices[k]);let ee,ae=this.vertexHashLookup.get(nh.computePosHash(z));ae!=null?ee=ae.next:(ae=this.vertexHashLookup.get(nh.computePosHash(H)),ee=ae!=null?ae.prev:$),this.unevalEdges.push({polygonIdx:i,a:F,b:k,hash:$,portalHash:ee,isTunnel:f,type:"unevaluated",featureInfo:v})}}addPortalCandidates(i,o,d,f,m){if(o.length===0)return;this.portalPolygons.add(i,{geometry:o,zLevel:m});const v=o[0];this.vertexHashLookup.clear();let C=nh.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let T=0;T<v.length-1;T++){const F=v[T+0],k=v[T+1],z=Vi(k.x-F.x,k.y-F.y),H=Zr(z);if(H===0)continue;let $="unevaluated";const ee=f.pointElevation(F),ae=f.pointElevation(k);Math.abs(ee)<.01&&Math.abs(ae)<.01?$="entrance":(this.isOnBorder(F.x,k.x)||this.isOnBorder(F.y,k.y))&&($="border");const fe=nh.computeEdgeHash(F,k);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:F,vb:k,vab:z,length:H,hash:fe,isTunnel:d,type:$});const ve=nh.computePosHash(F);this.vertexHashLookup.set(ve,{prev:C,next:fe}),C=fe}}construct(i){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),d=H=>{H.primitiveLength=this.indexArray.length-H.primitiveOffset},f=new YF(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const m=o(),v=o(),C=o(),T=(H,$)=>{H.sort((ae,fe)=>ae.type===$&&fe.type!==$?-1:ae.type!==$&&fe.type===$?1:0);const ee=H.findIndex(ae=>ae.type!==$);return ee>=0?ee:H.length};let F=0;this.unevalEdges.length>0&&(F=T(this.unevalEdges,"none"),this.constructBridgeStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:F},this.tileToMeters)),d(C);const k=o(),z=o();if(this.unevalEdges.length>0){const H=this.unevalEdges.splice(F),$=T(H,"tunnel")+F;this.unevalEdges.push(...H),this.constructTunnelStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:F},{min:F,max:$})}d(k),f.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),d(z),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),d(v),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),d(m),this.maskSegments=Gs.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=Gs.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableBridgeSegments=Gs.simpleSegment(0,C.primitiveOffset,0,C.primitiveLength),this.renderableTunnelSegments=Gs.simpleSegment(0,k.primitiveOffset,0,k.primitiveLength),this.shadowCasterSegments=Gs.simpleSegment(0,m.primitiveOffset,0,m.primitiveLength)}update(i,o,d,f,m,v,C,T){this.bridgeProgramConfigurations.updatePaintArrays(i,o,m,d,f,v,C,T),this.tunnelProgramConfigurations.updatePaintArrays(i,o,m,d,f,v,C,T)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,DF.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,OF.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(i),this.tunnelProgramConfigurations.upload(i))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(i,o,d,f,m){const v=(C,T)=>{for(let F=0;F<T.length-1;F++){const k=T[F].featureIndex,z=T[F+1].vertexStart,H=i.feature(k);C.populatePaintArrays(z,H,k,{},d,o,f,void 0,m)}};v(this.bridgeProgramConfigurations,this.bridgeFeatureSections),v(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(i,o,d,f,m){const v=new Map;for(let C=f;C<m;C++){const T=d[C],F=T.a,k=T.b,z=nh.computePosHash(i[F]),H=nh.computePosHash(i[k]);v.has(z)||v.set(z,{}),v.has(H)||v.set(H,{});const $=v.get(z),ee=v.get(H);o[F]<=0&&o[k]<=0||($.to=k,ee.from=F)}return v}constructBridgeStructures(i,o,d,f,m,v){i.clearVertexLookup();const C=this.computeVertexConnections(o,d,f,m.min,m.max),T=1/v,F=.5*T,k=$=>Se(o[$].x,o[$].y,d[$]*T),z=$=>{const ee=C.get(nh.computePosHash(o[$])),ae=ee.from,fe=ee.to;if(!ae||!fe)return;const ve=k(ae),Fe=k($),Pe=k(fe),ue=Se(0,0,0);if(!ze(ve,Fe)){const ke=Ve(oe(),Fe,ve);Me(ue,ue,mt(ke,ke))}if(!ze(Pe,Fe)){const ke=Ve(oe(),Pe,Fe);Me(ue,ue,mt(ke,ke))}const Ie=Ft(ue);return Ie>0?Qe(ue,ue,1/Ie):void 0};let H=Number.POSITIVE_INFINITY;this.sortSubarray(f,m.min,m.max,($,ee)=>$.featureInfo.featureIndex-ee.featureInfo.featureIndex);for(let $=m.min;$<m.max;$++){const ee=f[$];if(!ee.featureInfo.guardRailEnabled)continue;const ae=this.prepareEdgePoints(o,d,ee,($r,ar)=>$r>ar);if(ae==null)continue;const fe=ae[0],ve=ae[1],Fe=Se(fe.coord.x,fe.coord.y,T*fe.height),Pe=Se(ve.coord.x,ve.coord.y,T*ve.height);if(ze(Fe,Pe))continue;const ue=Ve(oe(),Pe,Fe);mt(ue,ue);const Ie=$r=>mt($r,$r),ke=z(ee.a)||ue,Ge=z(ee.b)||ue,yt=Ie(Se(ke[1],-ke[0],0)),At=Ie(Se(Ge[1],-Ge[0],0)),_t=Ie(rt(oe(),yt,ke)),Mt=Ie(rt(oe(),At,Ge)),Wt=oe(),Si=[Me(oe(),Fe,Qe(Wt,Ve(Wt,yt,_t),F)),Me(oe(),Fe,Qe(Wt,Me(Wt,yt,_t),F)),Me(oe(),Fe,Qe(Wt,_t,F)),Fe],Ai=[Me(oe(),Pe,Qe(Wt,Ve(Wt,At,Mt),F)),Me(oe(),Pe,Qe(Wt,Me(Wt,At,Mt),F)),Me(oe(),Pe,Qe(Wt,Mt,F)),Pe];H=this.addFeatureSection(ee.featureInfo.featureIndex,H,this.bridgeFeatureSections,i);const[Ci,Ti]=i.addVertices(yt,v,Si[0],Si[1]),[$t,_i]=i.addVertices(At,v,Ai[0],Ai[1]);i.addTriangles([Ci,Ti,$t,Ti,_i,$t]);const[Vt,Yt]=i.addVertices(_t,v,Si[1],Si[2]),[ki,Di]=i.addVertices(Mt,v,Ai[1],Ai[2]);i.addTriangles([Vt,Yt,ki,Yt,Di,ki]);const[xr,ur]=i.addVertices(lt(yt,yt),v,Si[2],Si[3]),[Xi,Pi]=i.addVertices(lt(At,At),v,Ai[2],Ai[3]);i.addTriangles([xr,ur,Xi,ur,Pi,Xi])}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}constructTunnelStructures(i,o,d,f,m,v){i.clearVertexLookup();let C=Number.POSITIVE_INFINITY;const T=(k,z)=>k.featureInfo.featureIndex-z.featureInfo.featureIndex;this.sortSubarray(f,m.min,m.max,T),this.sortSubarray(f,v.min,v.max,T);const F=k=>mt(k,k);for(let k=m.min;k<m.max;k++){const z=this.prepareEdgePoints(o,d,f[k],(ae,fe)=>ae<fe);if(z==null)continue;const[H,$]=z,ee=F(Se(-($.coord.y-H.coord.y),$.coord.x-H.coord.x,0));C=this.addFeatureSection(f[k].featureInfo.featureIndex,C,this.tunnelFeatureSections,i),i.addQuad([H,$,{coord:$.coord,height:f[k].isTunnel?-.1:0},{coord:H.coord,height:f[k].isTunnel?-.1:0}],ee)}for(let k=v.min;k<v.max;k++){const z=f[k];z.isTunnel&&([z.a,z.b]=[z.b,z.a]);const H=o[z.a],$=o[z.b],ee=F(Se(-($.y-H.y),$.x-H.x,0));C=this.addFeatureSection(z.featureInfo.featureIndex,C,this.tunnelFeatureSections,i),i.addQuad([{coord:$,height:0},{coord:H,height:0},{coord:H,height:d[z.a]+4},{coord:$,height:d[z.b]+4}],ee),i.addQuad([{coord:H,height:0},{coord:$,height:0},{coord:$,height:d[z.b]+4},{coord:H,height:d[z.a]+4}],ee)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}prepareEdgePoints(i,o,d,f){let m=o[d.a],v=o[d.b];const C=f(m,0),T=f(v,0);if(C&&T)return[{coord:i[d.a],height:m},{coord:i[d.b],height:v}];if(!C&&!T)return;const F=i[d.a].clone(),k=i[d.b].clone();if(C){if(!T){const z=v/(v-m);k.x=Er(k.x,F.x,z),k.y=Er(k.y,F.y,z),v=Er(v,m,z)}}else{const z=m/(m-v);F.x=Er(F.x,k.x,z),F.y=Er(F.y,k.y,z),m=Er(m,v,z)}return[{coord:F,height:m},{coord:k,height:v}]}prepareEdges(i,o){if(o.length===0)return;o.sort((C,T)=>C.hash===T.hash?T.polygonIdx-C.polygonIdx:T.hash>C.hash?1:-1);let d=0,f=0,m=0,v=o[d].polygonIdx;do f++,(f===o.length||o[d].hash!==o[f].hash)&&((f-d==1||o[f-1].polygonIdx!==v)&&(m<d&&(o[m]=o[d],o[d]=null),o[m].type="none",m++),d=f,d!==o.length&&(v=o[d].polygonIdx));while(d!==o.length);if(o.splice(m),o.length!==0&&i.length!==0){o.sort((F,k)=>F.portalHash<k.portalHash?1:-1);let C=0,T=0;for(;C!==o.length&&T!==i.length;){const F=o[C],k=i[T];F.portalHash>k.hash?C++:k.hash>F.portalHash?T++:(F.type=k.type,C++)}}}isOnBorder(i,o){return i<=0&&o<=0||i>=wi&&o>=wi}addFeatureSection(i,o,d,f){return i!==o&&(o=i,d.push({featureIndex:i,vertexStart:f.getVertexCount()}),f.clearVertexLookup()),o}sortSubarray(i,o,d,f){const m=i.slice(o,d);m.sort(f),i.splice(o,m.length,...m)}static computeEdgeHash(i,o){return(i.y===o.y&&i.x>o.x||i.y>o.y)&&([i,o]=[o,i]),BigInt(nh.computePosHash(i))<<32n|BigInt(nh.computePosHash(o))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var Gw,Ww={exports:{}},Xw=(Gw||(Gw=1,function(l,i){(function(o){function d(Ne,Xe){return Ne>Xe?1:Ne<Xe?-1:0}var f=function(Ne,Xe){Ne===void 0&&(Ne=d),Xe===void 0&&(Xe=!1),this._compare=Ne,this._root=null,this._size=0,this._noDuplicates=!!Xe},m={size:{configurable:!0}};function v(Ne,Xe,Jt,zi,Yi){var Wi=Yi-zi;if(Wi>0){var or=zi+Math.floor(Wi/2),Or={key:Xe[or],data:Jt[or],parent:Ne};return Or.left=v(Or,Xe,Jt,zi,or),Or.right=v(Or,Xe,Jt,or+1,Yi),Or}return null}function C(Ne,Xe,Jt,zi,Yi){if(!(Jt>=zi)){for(var Wi=Ne[Jt+zi>>1],or=Jt-1,Or=zi+1;;){do or++;while(Yi(Ne[or],Wi)<0);do Or--;while(Yi(Ne[Or],Wi)>0);if(or>=Or)break;var Bn=Ne[or];Ne[or]=Ne[Or],Ne[Or]=Bn,Bn=Xe[or],Xe[or]=Xe[Or],Xe[Or]=Bn}C(Ne,Xe,Jt,Or,Yi),C(Ne,Xe,Or+1,zi,Yi)}}f.prototype.rotateLeft=function(Ne){var Xe=Ne.right;Xe&&(Ne.right=Xe.left,Xe.left&&(Xe.left.parent=Ne),Xe.parent=Ne.parent),Ne.parent?Ne===Ne.parent.left?Ne.parent.left=Xe:Ne.parent.right=Xe:this._root=Xe,Xe&&(Xe.left=Ne),Ne.parent=Xe},f.prototype.rotateRight=function(Ne){var Xe=Ne.left;Xe&&(Ne.left=Xe.right,Xe.right&&(Xe.right.parent=Ne),Xe.parent=Ne.parent),Ne.parent?Ne===Ne.parent.left?Ne.parent.left=Xe:Ne.parent.right=Xe:this._root=Xe,Xe&&(Xe.right=Ne),Ne.parent=Xe},f.prototype._splay=function(Ne){for(;Ne.parent;){var Xe=Ne.parent;Xe.parent?Xe.left===Ne&&Xe.parent.left===Xe?(this.rotateRight(Xe.parent),this.rotateRight(Xe)):Xe.right===Ne&&Xe.parent.right===Xe?(this.rotateLeft(Xe.parent),this.rotateLeft(Xe)):Xe.left===Ne&&Xe.parent.right===Xe?(this.rotateRight(Xe),this.rotateLeft(Xe)):(this.rotateLeft(Xe),this.rotateRight(Xe)):Xe.left===Ne?this.rotateRight(Xe):this.rotateLeft(Xe)}},f.prototype.splay=function(Ne){for(var Xe,Jt,zi,Yi,Wi;Ne.parent;)(Jt=(Xe=Ne.parent).parent)&&Jt.parent?((zi=Jt.parent).left===Jt?zi.left=Ne:zi.right=Ne,Ne.parent=zi):(Ne.parent=null,this._root=Ne),Yi=Ne.left,Wi=Ne.right,Ne===Xe.left?(Jt&&(Jt.left===Xe?(Xe.right?(Jt.left=Xe.right,Jt.left.parent=Jt):Jt.left=null,Xe.right=Jt,Jt.parent=Xe):(Yi?(Jt.right=Yi,Yi.parent=Jt):Jt.right=null,Ne.left=Jt,Jt.parent=Ne)),Wi?(Xe.left=Wi,Wi.parent=Xe):Xe.left=null,Ne.right=Xe,Xe.parent=Ne):(Jt&&(Jt.right===Xe?(Xe.left?(Jt.right=Xe.left,Jt.right.parent=Jt):Jt.right=null,Xe.left=Jt,Jt.parent=Xe):(Wi?(Jt.left=Wi,Wi.parent=Jt):Jt.left=null,Ne.right=Jt,Jt.parent=Ne)),Yi?(Xe.right=Yi,Yi.parent=Xe):Xe.right=null,Ne.left=Xe,Xe.parent=Ne)},f.prototype.replace=function(Ne,Xe){Ne.parent?Ne===Ne.parent.left?Ne.parent.left=Xe:Ne.parent.right=Xe:this._root=Xe,Xe&&(Xe.parent=Ne.parent)},f.prototype.minNode=function(Ne){if(Ne===void 0&&(Ne=this._root),Ne)for(;Ne.left;)Ne=Ne.left;return Ne},f.prototype.maxNode=function(Ne){if(Ne===void 0&&(Ne=this._root),Ne)for(;Ne.right;)Ne=Ne.right;return Ne},f.prototype.insert=function(Ne,Xe){var Jt=this._root,zi=null,Yi=this._compare;if(this._noDuplicates)for(;Jt;){if(zi=Jt,Yi(Jt.key,Ne)===0)return;Jt=Yi(Jt.key,Ne)<0?Jt.right:Jt.left}else for(;Jt;)zi=Jt,Jt=Yi(Jt.key,Ne)<0?Jt.right:Jt.left;return Jt={key:Ne,data:Xe,left:null,right:null,parent:zi},zi?Yi(zi.key,Jt.key)<0?zi.right=Jt:zi.left=Jt:this._root=Jt,this.splay(Jt),this._size++,Jt},f.prototype.find=function(Ne){for(var Xe=this._root,Jt=this._compare;Xe;){var zi=Jt(Xe.key,Ne);if(zi<0)Xe=Xe.right;else{if(!(zi>0))return Xe;Xe=Xe.left}}return null},f.prototype.contains=function(Ne){for(var Xe=this._root,Jt=this._compare;Xe;){var zi=Jt(Ne,Xe.key);if(zi===0)return!0;Xe=zi<0?Xe.left:Xe.right}return!1},f.prototype.remove=function(Ne){var Xe=this.find(Ne);if(!Xe)return!1;if(this.splay(Xe),Xe.left)if(Xe.right){var Jt=this.minNode(Xe.right);Jt.parent!==Xe&&(this.replace(Jt,Jt.right),Jt.right=Xe.right,Jt.right.parent=Jt),this.replace(Xe,Jt),Jt.left=Xe.left,Jt.left.parent=Jt}else this.replace(Xe,Xe.left);else this.replace(Xe,Xe.right);return this._size--,!0},f.prototype.removeNode=function(Ne){if(!Ne)return!1;if(this.splay(Ne),Ne.left)if(Ne.right){var Xe=this.minNode(Ne.right);Xe.parent!==Ne&&(this.replace(Xe,Xe.right),Xe.right=Ne.right,Xe.right.parent=Xe),this.replace(Ne,Xe),Xe.left=Ne.left,Xe.left.parent=Xe}else this.replace(Ne,Ne.left);else this.replace(Ne,Ne.right);return this._size--,!0},f.prototype.erase=function(Ne){var Xe=this.find(Ne);if(Xe){this.splay(Xe);var Jt=Xe.left,zi=Xe.right,Yi=null;Jt&&(Jt.parent=null,Yi=this.maxNode(Jt),this.splay(Yi),this._root=Yi),zi&&(Jt?Yi.right=zi:this._root=zi,zi.parent=Yi),this._size--}},f.prototype.pop=function(){var Ne=this._root,Xe=null;if(Ne){for(;Ne.left;)Ne=Ne.left;Xe={key:Ne.key,data:Ne.data},this.remove(Ne.key)}return Xe},f.prototype.next=function(Ne){var Xe=Ne;if(Xe)if(Xe.right)for(Xe=Xe.right;Xe&&Xe.left;)Xe=Xe.left;else for(Xe=Ne.parent;Xe&&Xe.right===Ne;)Ne=Xe,Xe=Xe.parent;return Xe},f.prototype.prev=function(Ne){var Xe=Ne;if(Xe)if(Xe.left)for(Xe=Xe.left;Xe&&Xe.right;)Xe=Xe.right;else for(Xe=Ne.parent;Xe&&Xe.left===Ne;)Ne=Xe,Xe=Xe.parent;return Xe},f.prototype.forEach=function(Ne){for(var Xe=this._root,Jt=[],zi=!1,Yi=0;!zi;)Xe?(Jt.push(Xe),Xe=Xe.left):Jt.length>0?(Ne(Xe=Jt.pop(),Yi++),Xe=Xe.right):zi=!0;return this},f.prototype.range=function(Ne,Xe,Jt,zi){for(var Yi=[],Wi=this._compare,or=this._root;Yi.length!==0||or;)if(or)Yi.push(or),or=or.left;else{if(Wi((or=Yi.pop()).key,Xe)>0)break;if(Wi(or.key,Ne)>=0&&Jt.call(zi,or))return this;or=or.right}return this},f.prototype.keys=function(){for(var Ne=this._root,Xe=[],Jt=[],zi=!1;!zi;)Ne?(Xe.push(Ne),Ne=Ne.left):Xe.length>0?(Ne=Xe.pop(),Jt.push(Ne.key),Ne=Ne.right):zi=!0;return Jt},f.prototype.values=function(){for(var Ne=this._root,Xe=[],Jt=[],zi=!1;!zi;)Ne?(Xe.push(Ne),Ne=Ne.left):Xe.length>0?(Ne=Xe.pop(),Jt.push(Ne.data),Ne=Ne.right):zi=!0;return Jt},f.prototype.at=function(Ne){for(var Xe=this._root,Jt=[],zi=!1,Yi=0;!zi;)if(Xe)Jt.push(Xe),Xe=Xe.left;else if(Jt.length>0){if(Xe=Jt.pop(),Yi===Ne)return Xe;Yi++,Xe=Xe.right}else zi=!0;return null},f.prototype.load=function(Ne,Xe,Jt){if(Ne===void 0&&(Ne=[]),Xe===void 0&&(Xe=[]),Jt===void 0&&(Jt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var zi=Ne.length;return Jt&&C(Ne,Xe,0,zi-1,this._compare),this._root=v(null,Ne,Xe,0,zi),this._size=zi,this},f.prototype.min=function(){var Ne=this.minNode(this._root);return Ne?Ne.key:null},f.prototype.max=function(){var Ne=this.maxNode(this._root);return Ne?Ne.key:null},f.prototype.isEmpty=function(){return this._root===null},m.size.get=function(){return this._size},f.createTree=function(Ne,Xe,Jt,zi,Yi){return new f(Jt,Yi).load(Ne,Xe,zi)},Object.defineProperties(f.prototype,m);var T=0,F=1,k=2,z=3,H=0,$=1,ee=2,ae=3;function fe(Ne,Xe,Jt){Xe===null?(Ne.inOut=!1,Ne.otherInOut=!0):(Ne.isSubject===Xe.isSubject?(Ne.inOut=!Xe.inOut,Ne.otherInOut=Xe.otherInOut):(Ne.inOut=!Xe.otherInOut,Ne.otherInOut=Xe.isVertical()?!Xe.inOut:Xe.inOut),Xe&&(Ne.prevInResult=!ve(Xe,Jt)||Xe.isVertical()?Xe.prevInResult:Xe));var zi=ve(Ne,Jt);Ne.resultTransition=zi?function(Yi,Wi){var or,Or=!Yi.inOut,Bn=!Yi.otherInOut;switch(Wi){case H:or=Or&&Bn;break;case $:or=Or||Bn;break;case ae:or=Or^Bn;break;case ee:or=Yi.isSubject?Or&&!Bn:Bn&&!Or}return or?1:-1}(Ne,Jt):0}function ve(Ne,Xe){switch(Ne.type){case T:switch(Xe){case H:return!Ne.otherInOut;case $:return Ne.otherInOut;case ee:return Ne.isSubject&&Ne.otherInOut||!Ne.isSubject&&!Ne.otherInOut;case ae:return!0}break;case k:return Xe===H||Xe===$;case z:return Xe===ee;case F:return!1}return!1}var Fe=function(Ne,Xe,Jt,zi,Yi){this.left=Xe,this.point=Ne,this.otherEvent=Jt,this.isSubject=zi,this.type=Yi||T,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Pe={inResult:{configurable:!0}};function ue(Ne,Xe){return Ne[0]===Xe[0]&&Ne[1]===Xe[1]}Fe.prototype.isBelow=function(Ne){var Xe=this.point,Jt=this.otherEvent.point;return this.left?(Xe[0]-Ne[0])*(Jt[1]-Ne[1])-(Jt[0]-Ne[0])*(Xe[1]-Ne[1])>0:(Jt[0]-Ne[0])*(Xe[1]-Ne[1])-(Xe[0]-Ne[0])*(Jt[1]-Ne[1])>0},Fe.prototype.isAbove=function(Ne){return!this.isBelow(Ne)},Fe.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Pe.inResult.get=function(){return this.resultTransition!==0},Fe.prototype.clone=function(){var Ne=new Fe(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ne.contourId=this.contourId,Ne.resultTransition=this.resultTransition,Ne.prevInResult=this.prevInResult,Ne.isExteriorRing=this.isExteriorRing,Ne.inOut=this.inOut,Ne.otherInOut=this.otherInOut,Ne},Object.defineProperties(Fe.prototype,Pe);var Ie=11102230246251565e-32,ke=134217729,Ge=(3+8*Ie)*Ie;function yt(Ne,Xe,Jt,zi,Yi){var Wi,or,Or,Bn,Cn=Xe[0],hn=zi[0],us=0,Os=0;hn>Cn==hn>-Cn?(Wi=Cn,Cn=Xe[++us]):(Wi=hn,hn=zi[++Os]);var Sn=0;if(us<Ne&&Os<Jt)for(hn>Cn==hn>-Cn?(Or=Wi-((or=Cn+Wi)-Cn),Cn=Xe[++us]):(Or=Wi-((or=hn+Wi)-hn),hn=zi[++Os]),Wi=or,Or!==0&&(Yi[Sn++]=Or);us<Ne&&Os<Jt;)hn>Cn==hn>-Cn?(Or=Wi-((or=Wi+Cn)-(Bn=or-Wi))+(Cn-Bn),Cn=Xe[++us]):(Or=Wi-((or=Wi+hn)-(Bn=or-Wi))+(hn-Bn),hn=zi[++Os]),Wi=or,Or!==0&&(Yi[Sn++]=Or);for(;us<Ne;)Or=Wi-((or=Wi+Cn)-(Bn=or-Wi))+(Cn-Bn),Cn=Xe[++us],Wi=or,Or!==0&&(Yi[Sn++]=Or);for(;Os<Jt;)Or=Wi-((or=Wi+hn)-(Bn=or-Wi))+(hn-Bn),hn=zi[++Os],Wi=or,Or!==0&&(Yi[Sn++]=Or);return Wi===0&&Sn!==0||(Yi[Sn++]=Wi),Sn}function At(Ne){return new Float64Array(Ne)}var _t=33306690738754716e-32,Mt=22204460492503146e-32,Wt=11093356479670487e-47,Si=At(4),Ai=At(8),Ci=At(12),Ti=At(16),$t=At(4);function _i(Ne,Xe,Jt){var zi=function(Yi,Wi,or,Or,Bn,Cn){var hn=(Wi-Cn)*(or-Bn),us=(Yi-Bn)*(Or-Cn),Os=hn-us;if(hn===0||us===0||hn>0!=us>0)return Os;var Sn=Math.abs(hn+us);return Math.abs(Os)>=_t*Sn?Os:-function(so,Hs,ls,Bo,Ws,Us,Qs){var fs,fn,vs,oo,kr,zn,Xs,mo,Ks,ya,Cs,ha,eu,kl,dl,tu,OA,va,ka=so-Ws,Rl=ls-Ws,gc=Hs-Us,Yl=Bo-Us;Si[0]=(dl=(mo=ka-(Xs=(zn=ke*ka)-(zn-ka)))*(ya=Yl-(Ks=(zn=ke*Yl)-(zn-Yl)))-((kl=ka*Yl)-Xs*Ks-mo*Ks-Xs*ya))-((Cs=dl-(OA=(mo=gc-(Xs=(zn=ke*gc)-(zn-gc)))*(ya=Rl-(Ks=(zn=ke*Rl)-(zn-Rl)))-((tu=gc*Rl)-Xs*Ks-mo*Ks-Xs*ya)))+(kr=dl-Cs))+(kr-OA),Si[1]=(eu=kl-((ha=kl+Cs)-(kr=ha-kl))+(Cs-kr))-((Cs=eu-tu)+(kr=eu-Cs))+(kr-tu),Si[2]=ha-((va=ha+Cs)-(kr=va-ha))+(Cs-kr),Si[3]=va;var hp=function(Zj,iS){for(var rS=iS[0],Nx=1;Nx<4;Nx++)rS+=iS[Nx];return rS}(0,Si),ay=Mt*Qs;if(hp>=ay||-hp>=ay||(fs=so-(ka+(kr=so-ka))+(kr-Ws),vs=ls-(Rl+(kr=ls-Rl))+(kr-Ws),fn=Hs-(gc+(kr=Hs-gc))+(kr-Us),oo=Bo-(Yl+(kr=Bo-Yl))+(kr-Us),fs===0&&fn===0&&vs===0&&oo===0)||(ay=Wt*Qs+Ge*Math.abs(hp),(hp+=ka*oo+Yl*fs-(gc*vs+Rl*fn))>=ay||-hp>=ay))return hp;$t[0]=(dl=(mo=fs-(Xs=(zn=ke*fs)-(zn-fs)))*(ya=Yl-(Ks=(zn=ke*Yl)-(zn-Yl)))-((kl=fs*Yl)-Xs*Ks-mo*Ks-Xs*ya))-((Cs=dl-(OA=(mo=fn-(Xs=(zn=ke*fn)-(zn-fn)))*(ya=Rl-(Ks=(zn=ke*Rl)-(zn-Rl)))-((tu=fn*Rl)-Xs*Ks-mo*Ks-Xs*ya)))+(kr=dl-Cs))+(kr-OA),$t[1]=(eu=kl-((ha=kl+Cs)-(kr=ha-kl))+(Cs-kr))-((Cs=eu-tu)+(kr=eu-Cs))+(kr-tu),$t[2]=ha-((va=ha+Cs)-(kr=va-ha))+(Cs-kr),$t[3]=va;var D3=yt(4,Si,4,$t,Ai);$t[0]=(dl=(mo=ka-(Xs=(zn=ke*ka)-(zn-ka)))*(ya=oo-(Ks=(zn=ke*oo)-(zn-oo)))-((kl=ka*oo)-Xs*Ks-mo*Ks-Xs*ya))-((Cs=dl-(OA=(mo=gc-(Xs=(zn=ke*gc)-(zn-gc)))*(ya=vs-(Ks=(zn=ke*vs)-(zn-vs)))-((tu=gc*vs)-Xs*Ks-mo*Ks-Xs*ya)))+(kr=dl-Cs))+(kr-OA),$t[1]=(eu=kl-((ha=kl+Cs)-(kr=ha-kl))+(Cs-kr))-((Cs=eu-tu)+(kr=eu-Cs))+(kr-tu),$t[2]=ha-((va=ha+Cs)-(kr=va-ha))+(Cs-kr),$t[3]=va;var O3=yt(D3,Ai,4,$t,Ci);$t[0]=(dl=(mo=fs-(Xs=(zn=ke*fs)-(zn-fs)))*(ya=oo-(Ks=(zn=ke*oo)-(zn-oo)))-((kl=fs*oo)-Xs*Ks-mo*Ks-Xs*ya))-((Cs=dl-(OA=(mo=fn-(Xs=(zn=ke*fn)-(zn-fn)))*(ya=vs-(Ks=(zn=ke*vs)-(zn-vs)))-((tu=fn*vs)-Xs*Ks-mo*Ks-Xs*ya)))+(kr=dl-Cs))+(kr-OA),$t[1]=(eu=kl-((ha=kl+Cs)-(kr=ha-kl))+(Cs-kr))-((Cs=eu-tu)+(kr=eu-Cs))+(kr-tu),$t[2]=ha-((va=ha+Cs)-(kr=va-ha))+(Cs-kr),$t[3]=va;var U3=yt(O3,Ci,4,$t,Ti);return Ti[U3-1]}(Yi,Wi,or,Or,Bn,Cn,Sn)}(Ne[0],Ne[1],Xe[0],Xe[1],Jt[0],Jt[1]);return zi>0?-1:zi<0?1:0}function Vt(Ne,Xe){var Jt=Ne.point,zi=Xe.point;return Jt[0]>zi[0]?1:Jt[0]<zi[0]?-1:Jt[1]!==zi[1]?Jt[1]>zi[1]?1:-1:function(Yi,Wi,or,Or){return Yi.left!==Wi.left?Yi.left?1:-1:_i(or,Yi.otherEvent.point,Wi.otherEvent.point)!==0?Yi.isBelow(Wi.otherEvent.point)?-1:1:!Yi.isSubject&&Wi.isSubject?1:-1}(Ne,Xe,Jt)}function Yt(Ne,Xe,Jt){var zi=new Fe(Xe,!1,Ne,Ne.isSubject),Yi=new Fe(Xe,!0,Ne.otherEvent,Ne.isSubject);return ue(Ne.point,Ne.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ne),zi.contourId=Yi.contourId=Ne.contourId,Vt(Yi,Ne.otherEvent)>0&&(Ne.otherEvent.left=!0,Yi.left=!1),Ne.otherEvent.otherEvent=Yi,Ne.otherEvent=zi,Jt.push(Yi),Jt.push(zi),Jt}function ki(Ne,Xe){return Ne[0]*Xe[1]-Ne[1]*Xe[0]}function Di(Ne,Xe){return Ne[0]*Xe[0]+Ne[1]*Xe[1]}function xr(Ne,Xe,Jt){var zi=function(Bn,Cn,hn,us,Os){var Sn=[Cn[0]-Bn[0],Cn[1]-Bn[1]],so=[us[0]-hn[0],us[1]-hn[1]];function Hs(zn,Xs,mo){return[zn[0]+Xs*mo[0],zn[1]+Xs*mo[1]]}var ls=[hn[0]-Bn[0],hn[1]-Bn[1]],Bo=ki(Sn,so),Ws=Bo*Bo,Us=Di(Sn,Sn);if(Ws>0){var Qs=ki(ls,so)/Bo;if(Qs<0||Qs>1)return null;var fs=ki(ls,Sn)/Bo;return fs<0||fs>1?null:Qs===0||Qs===1?[Hs(Bn,Qs,Sn)]:fs===0||fs===1?[Hs(hn,fs,so)]:[Hs(Bn,Qs,Sn)]}if((Ws=(Bo=ki(ls,Sn))*Bo)>0)return null;var fn=Di(Sn,ls)/Us,vs=fn+Di(Sn,so)/Us,oo=Math.min(fn,vs),kr=Math.max(fn,vs);return oo<=1&&kr>=0?oo===1?[Hs(Bn,oo>0?oo:0,Sn)]:kr===0?[Hs(Bn,kr<1?kr:1,Sn)]:[Hs(Bn,oo>0?oo:0,Sn),Hs(Bn,kr<1?kr:1,Sn)]:null}(Ne.point,Ne.otherEvent.point,Xe.point,Xe.otherEvent.point),Yi=zi?zi.length:0;if(Yi===0||Yi===1&&(ue(Ne.point,Xe.point)||ue(Ne.otherEvent.point,Xe.otherEvent.point))||Yi===2&&Ne.isSubject===Xe.isSubject)return 0;if(Yi===1)return ue(Ne.point,zi[0])||ue(Ne.otherEvent.point,zi[0])||Yt(Ne,zi[0],Jt),ue(Xe.point,zi[0])||ue(Xe.otherEvent.point,zi[0])||Yt(Xe,zi[0],Jt),1;var Wi=[],or=!1,Or=!1;return ue(Ne.point,Xe.point)?or=!0:Vt(Ne,Xe)===1?Wi.push(Xe,Ne):Wi.push(Ne,Xe),ue(Ne.otherEvent.point,Xe.otherEvent.point)?Or=!0:Vt(Ne.otherEvent,Xe.otherEvent)===1?Wi.push(Xe.otherEvent,Ne.otherEvent):Wi.push(Ne.otherEvent,Xe.otherEvent),or&&Or||or?(Xe.type=F,Ne.type=Xe.inOut===Ne.inOut?k:z,or&&!Or&&Yt(Wi[1].otherEvent,Wi[0].point,Jt),2):Or?(Yt(Wi[0],Wi[1].point,Jt),3):Wi[0]!==Wi[3].otherEvent?(Yt(Wi[0],Wi[1].point,Jt),Yt(Wi[1],Wi[2].point,Jt),3):(Yt(Wi[0],Wi[1].point,Jt),Yt(Wi[3].otherEvent,Wi[2].point,Jt),3)}function ur(Ne,Xe){if(Ne===Xe)return 0;if(_i(Ne.point,Ne.otherEvent.point,Xe.point)!==0||_i(Ne.point,Ne.otherEvent.point,Xe.otherEvent.point)!==0)return ue(Ne.point,Xe.point)?Ne.isBelow(Xe.otherEvent.point)?-1:1:Ne.point[0]===Xe.point[0]?Ne.point[1]<Xe.point[1]?-1:1:Vt(Ne,Xe)===1?Xe.isAbove(Ne.point)?-1:1:Ne.isBelow(Xe.point)?-1:1;if(Ne.isSubject!==Xe.isSubject)return Ne.isSubject?-1:1;var Jt=Ne.point,zi=Xe.point;return Jt[0]===zi[0]&&Jt[1]===zi[1]?(Jt=Ne.otherEvent.point)[0]===(zi=Xe.otherEvent.point)[0]&&Jt[1]===zi[1]?0:Ne.contourId>Xe.contourId?1:-1:Vt(Ne,Xe)===1?1:-1}var Xi=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Pi(Ne,Xe,Jt,zi){var Yi,Wi=Ne+1,or=Xe[Ne].point,Or=Xe.length;for(Wi<Or&&(Yi=Xe[Wi].point);Wi<Or&&Yi[0]===or[0]&&Yi[1]===or[1];){if(!Jt[Wi])return Wi;++Wi<Or&&(Yi=Xe[Wi].point)}for(Wi=Ne-1;Jt[Wi]&&Wi>zi;)Wi--;return Wi}Xi.prototype.isExterior=function(){return this.holeOf==null};var $r=fr,ar=fr;function fr(Ne,Xe){if(!(this instanceof fr))return new fr(Ne,Xe);if(this.data=Ne||[],this.length=this.data.length,this.compare=Xe||Nr,this.length>0)for(var Jt=(this.length>>1)-1;Jt>=0;Jt--)this._down(Jt)}function Nr(Ne,Xe){return Ne<Xe?-1:Ne>Xe?1:0}fr.prototype={push:function(Ne){this.data.push(Ne),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ne=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ne}},peek:function(){return this.data[0]},_up:function(Ne){for(var Xe=this.data,Jt=this.compare,zi=Xe[Ne];Ne>0;){var Yi=Ne-1>>1,Wi=Xe[Yi];if(Jt(zi,Wi)>=0)break;Xe[Ne]=Wi,Ne=Yi}Xe[Ne]=zi},_down:function(Ne){for(var Xe=this.data,Jt=this.compare,zi=this.length>>1,Yi=Xe[Ne];Ne<zi;){var Wi=1+(Ne<<1),or=Wi+1,Or=Xe[Wi];if(or<this.length&&Jt(Xe[or],Or)<0&&(Wi=or,Or=Xe[or]),Jt(Or,Yi)>=0)break;Xe[Ne]=Or,Ne=Wi}Xe[Ne]=Yi}},$r.default=ar;var an=Math.max,on=Math.min,_n=0;function un(Ne,Xe,Jt,zi,Yi,Wi){var or,Or,Bn,Cn,hn,us;for(or=0,Or=Ne.length-1;or<Or;or++)if(Cn=Ne[or+1],hn=new Fe(Bn=Ne[or],!1,void 0,Xe),us=new Fe(Cn,!1,hn,Xe),hn.otherEvent=us,Bn[0]!==Cn[0]||Bn[1]!==Cn[1]){hn.contourId=us.contourId=Jt,Wi||(hn.isExteriorRing=!1,us.isExteriorRing=!1),Vt(hn,us)>0?us.left=!0:hn.left=!0;var Os=Bn[0],Sn=Bn[1];Yi[0]=on(Yi[0],Os),Yi[1]=on(Yi[1],Sn),Yi[2]=an(Yi[2],Os),Yi[3]=an(Yi[3],Sn),zi.push(hn),zi.push(us)}}var xn=[];function as(Ne,Xe,Jt){typeof Ne[0][0][0]=="number"&&(Ne=[Ne]),typeof Xe[0][0][0]=="number"&&(Xe=[Xe]);var zi=function(Sn,so,Hs){var ls=null;return Sn.length*so.length==0&&(Hs===H?ls=xn:Hs===ee?ls=Sn:Hs!==$&&Hs!==ae||(ls=Sn.length===0?so:Sn)),ls}(Ne,Xe,Jt);if(zi)return zi===xn?null:zi;var Yi=[1/0,1/0,-1/0,-1/0],Wi=[1/0,1/0,-1/0,-1/0],or=function(Sn,so,Hs,ls,Bo){var Ws,Us,Qs,fs,fn,vs,oo=new $r(null,Vt);for(Qs=0,fs=Sn.length;Qs<fs;Qs++)for(fn=0,vs=(Ws=Sn[Qs]).length;fn<vs;fn++)(Us=fn===0)&&_n++,un(Ws[fn],!0,_n,oo,Hs,Us);for(Qs=0,fs=so.length;Qs<fs;Qs++)for(fn=0,vs=(Ws=so[Qs]).length;fn<vs;fn++)Us=fn===0,Bo===ee&&(Us=!1),Us&&_n++,un(Ws[fn],!1,_n,oo,ls,Us);return oo}(Ne,Xe,Yi,Wi,Jt);if(zi=function(Sn,so,Hs,ls,Bo){var Ws=null;return(Hs[0]>ls[2]||ls[0]>Hs[2]||Hs[1]>ls[3]||ls[1]>Hs[3])&&(Bo===H?Ws=xn:Bo===ee?Ws=Sn:Bo!==$&&Bo!==ae||(Ws=Sn.concat(so))),Ws}(Ne,Xe,Yi,Wi,Jt))return zi===xn?null:zi;for(var Or=function(Sn){var so,Hs,ls=function(Qs){var fs,fn,vs,oo,kr=[];for(fn=0,vs=Qs.length;fn<vs;fn++)((fs=Qs[fn]).left&&fs.inResult||!fs.left&&fs.otherEvent.inResult)&&kr.push(fs);for(var zn=!1;!zn;)for(zn=!0,fn=0,vs=kr.length;fn<vs;fn++)fn+1<vs&&Vt(kr[fn],kr[fn+1])===1&&(oo=kr[fn],kr[fn]=kr[fn+1],kr[fn+1]=oo,zn=!1);for(fn=0,vs=kr.length;fn<vs;fn++)(fs=kr[fn]).otherPos=fn;for(fn=0,vs=kr.length;fn<vs;fn++)(fs=kr[fn]).left||(oo=fs.otherPos,fs.otherPos=fs.otherEvent.otherPos,fs.otherEvent.otherPos=oo);return kr}(Sn),Bo={},Ws=[],Us=function(){if(!Bo[so]){var Qs=Ws.length,fs=function(kr,zn,Xs){var mo=new Xi;if(kr.prevInResult!=null){var Ks=kr.prevInResult,ya=Ks.outputContourId;if(Ks.resultTransition>0){var Cs=zn[ya];if(Cs.holeOf!=null){var ha=Cs.holeOf;zn[ha].holeIds.push(Xs),mo.holeOf=ha,mo.depth=zn[ya].depth}else zn[ya].holeIds.push(Xs),mo.holeOf=ya,mo.depth=zn[ya].depth+1}else mo.holeOf=null,mo.depth=zn[ya].depth}else mo.holeOf=null,mo.depth=0;return mo}(ls[so],Ws,Qs),fn=function(kr){Bo[kr]=!0,kr<ls.length&&ls[kr]&&(ls[kr].outputContourId=Qs)},vs=so,oo=so;for(fs.points.push(ls[so].point);fn(vs),fn(vs=ls[vs].otherPos),fs.points.push(ls[vs].point),!((vs=Pi(vs,ls,Bo,oo))==oo||vs>=ls.length)&&ls[vs];);Ws.push(fs)}};for(so=0,Hs=ls.length;so<Hs;so++)Us();return Ws}(function(Sn,so,Hs,ls,Bo,Ws){for(var Us,Qs,fs,fn=new f(ur),vs=[],oo=Math.min(ls[2],Bo[2]);Sn.length!==0;){var kr=Sn.pop();if(vs.push(kr),Ws===H&&kr.point[0]>oo||Ws===ee&&kr.point[0]>ls[2])break;if(kr.left){Qs=Us=fn.insert(kr),Us=Us!==(fs=fn.minNode())?fn.prev(Us):null,Qs=fn.next(Qs);var zn=Us?Us.key:null;if(fe(kr,zn,Ws),Qs&&xr(kr,Qs.key,Sn)===2&&(fe(kr,zn,Ws),fe(Qs.key,kr,Ws)),Us&&xr(Us.key,kr,Sn)===2){var Xs=Us;fe(zn,(Xs=Xs!==fs?fn.prev(Xs):null)?Xs.key:null,Ws),fe(kr,zn,Ws)}}else Qs=Us=fn.find(kr=kr.otherEvent),Us&&Qs&&(Us=Us!==fs?fn.prev(Us):null,Qs=fn.next(Qs),fn.remove(kr),Qs&&Us&&xr(Us.key,Qs.key,Sn))}return vs}(or,0,0,Yi,Wi,Jt)),Bn=[],Cn=0;Cn<Or.length;Cn++){var hn=Or[Cn];if(hn.isExterior()){for(var us=[hn.points],Os=0;Os<hn.holeIds.length;Os++)us.push(Or[hn.holeIds[Os]].points);Bn.push(us)}}return Bn}var js={UNION:$,DIFFERENCE:ee,INTERSECTION:H,XOR:ae};o.diff=function(Ne,Xe){return as(Ne,Xe,ee)},o.intersection=function(Ne,Xe){return as(Ne,Xe,H)},o.operations=js,o.union=function(Ne,Xe){return as(Ne,Xe,$)},o.xor=function(Ne,Xe){return as(Ne,Xe,ae)},Object.defineProperty(o,"__esModule",{value:!0})})(i)}(0,Ww.exports)),Ww.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function xv(l,i,o,d){const f=[],m=d===0?(v,C,T,F,k,z)=>{v.push(new qt(z,T+(z-C)/(F-C)*(k-T)))}:(v,C,T,F,k,z)=>{v.push(new qt(C+(z-T)/(k-T)*(F-C),z))};for(const v of l){const C=[];for(const T of v){if(T.length<=2)continue;const F=[];for(let H=0;H<T.length-1;H++){const $=T[H].x,ee=T[H].y,ae=T[H+1].x,fe=T[H+1].y,ve=d===0?$:ee,Fe=d===0?ae:fe;ve<i?Fe>i&&m(F,$,ee,ae,fe,i):ve>o?Fe<o&&m(F,$,ee,ae,fe,o):F.push(T[H]),Fe<i&&ve>=i&&m(F,$,ee,ae,fe,i),Fe>o&&ve<=o&&m(F,$,ee,ae,fe,o)}let k=T[T.length-1];const z=d===0?k.x:k.y;z>=i&&z<=o&&F.push(k),F.length&&(k=F[F.length-1],F[0].x===k.x&&F[0].y===k.y||F.push(F[0]),C.push(F))}C.length&&f.push(C)}return f}function KF(l,i){const o=D_(l),d=D_([i]),f=Xw.intersection(o,d);return f==null?[]:Yw(f)}function qF(l,i){let d=D_(l,65536);for(;i.valid();i.next()){const[f,m]=i.get(),v=f.x*65536,C=f.y*65536,T=m.x*65536,F=m.y*65536,k=T-v,z=F-C,H=Math.hypot(k,z),$=Math.trunc(z/H*3),ee=-Math.trunc(k/H*3);d=Xw.diff(d,[[[v,C],[T,F],[T+$,F+ee],[v+$,C+ee],[v,C]]])}return Yw(d,1/65536)}function D_(l,i=1){return[l.map(o=>o.map(d=>[d.x*i,d.y*i]))]}function Yw(l,i=1){return l.map(o=>o.map((d,f)=>{const m=d.map(v=>new qt(v[0]*i,v[1]*i).round());return f>0&&m.reverse(),m}))}class O_{constructor(i,o){this.layoutVertexArray=new $u,this.indexArray=new Jo,this.lineIndexArray=new Mh,this.triangleSegments=new Gs,this.lineSegments=new Gs,this.programConfigurations=new p(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new qh)}update(i,o,d,f,m,v,C,T){this.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,kF.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,RF.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,o,d,f,m,v,C){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,o,d,f,m,v,void 0,C)}}class U_{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=i.lut,this.bufferData=new O_(i,!1),this.elevationBufferData=new O_(i,!0),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=i.sourceLayerIndex,this.worldview=i.worldview}updateFootprints(i,o){}populate(i,o,d,f){this.hasPattern=k_("fill",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:C,id:T,index:F,sourceLayerIndex:k}of i){const z=this.layers[0]._featureFilter.needGeometry,H=Ki(C,z);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),H,d))continue;const $=m?m.evaluate(H,{},d,o.availableImages):void 0,ee={id:T,properties:C.properties,type:C.type,sourceLayerIndex:k,index:F,geometry:z?H.geometry:tr(C,d,f),patterns:{},sortKey:$};v.push(ee)}m&&v.sort((C,T)=>C.sortKey-T.sortKey);for(const C of v){const{geometry:T,index:F,sourceLayerIndex:k}=C;if(this.hasPattern){const z=R_("fill",this.layers,C,this.zoom,this.pixelRatio,o);this.patternFeatures.push(z)}else this.addFeature(C,T,F,d,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(i[F].feature,T,F,k,this.index)}}update(i,o,d,f,m,v,C){this.bufferData.update(i,o,d,f,m,v,C,this.worldview),this.elevationBufferData.update(i,o,d,f,m,v,C,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(i,o,d,f,m,v,C,this.worldview)}addFeatures(i,o,d,f,m,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,d,f,v,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,o,d,f,m,v=[],C,T){const F=_v(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,F,f,d,T):this.addGeometry(F,this.bufferData),this.bufferData.populatePaintArrays(i,d,m,v,f,C,this.worldview),this.elevationBufferData.populatePaintArrays(i,d,m,v,f,C,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i,o,d,f,m){this.elevatedStructures&&(this.elevatedStructures.construct(i),this.elevatedStructures.populatePaintArrays(o,d,f,m,this.worldview))}addElevatedRoadFeature(i,o,d,f,m){const v=new Array,C=Ht.getElevationFeature(i,m);if(!C)return void this.addGeometry(o,this.bufferData);{const F=this.clipPolygonsToTile(o,1);F.length>0&&v.push({polygons:F,elevationFeature:C,elevationTileID:d})}const T={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(i,{},d),featureIndex:f};for(const F of v)if(F.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new nh(F.elevationTileID,this.layers,this.zoom,this.lut));const z=F.elevationFeature.isTunnel();let H=0;i.properties.hasOwnProperty(Rs)&&(H=+i.properties[Rs]);for(const $ of F.polygons)this.elevatedStructures.addPortalCandidates(F.elevationFeature.id,$,z,F.elevationFeature,H)}F.elevationFeature.constantHeight==null&&(F.polygons=this.prepareElevatedPolygons(F.polygons,F.elevationFeature,F.elevationTileID));const k=new si(d,F.elevationTileID);this.addElevatedGeometry(F.polygons,k,F.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,f,T)}}addElevatedGeometry(i,o,d,f,m,v){const C={elevation:d,elevationSampler:o,bias:f,index:m,featureInfo:v},[T,F]=this.addGeometry(i,this.elevationBufferData,C);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:F}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,F))}addGeometry(i,o,d){let f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=null;d&&(v=d.elevationSampler.constantElevation(d.elevation,d.bias),v!=null&&(f=v,m=v));const C=(T,F,k)=>{if(d!=null)if(F.push(T),v!=null)o.elevatedLayoutVertexArray.emplaceBack(v),k.push(v);else{const z=d.elevationSampler.pointElevation(T,d.elevation,d.bias);o.elevatedLayoutVertexArray.emplaceBack(z),k.push(z),f=Math.min(f,z),m=Math.max(m,z)}};for(const T of i){let F=0;for(const Pe of T)F+=Pe.length;const k=o.triangleSegments.prepareSegment(F,o.layoutVertexArray,o.indexArray),z=k.vertexLength,H=[],$=[],ee=[],ae=[],fe=[],ve=o.layoutVertexArray.length;for(const Pe of T){if(Pe.length===0)continue;Pe!==T[0]&&$.push(H.length/2);const ue=o.lineSegments.prepareSegment(Pe.length,o.layoutVertexArray,o.lineIndexArray),Ie=ue.vertexLength;d&&fe.push(o.layoutVertexArray.length-ve),C(Pe[0],ee,ae),o.layoutVertexArray.emplaceBack(Pe[0].x,Pe[0].y),o.lineIndexArray.emplaceBack(Ie+Pe.length-1,Ie),H.push(Pe[0].x),H.push(Pe[0].y);for(let ke=1;ke<Pe.length;ke++)C(Pe[ke],ee,ae),o.layoutVertexArray.emplaceBack(Pe[ke].x,Pe[ke].y),o.lineIndexArray.emplaceBack(Ie+ke-1,Ie+ke),H.push(Pe[ke].x),H.push(Pe[ke].y);ue.vertexLength+=Pe.length,ue.primitiveLength+=Pe.length}const Fe=Tm(H,$);for(let Pe=0;Pe<Fe.length;Pe+=3)o.indexArray.emplaceBack(z+Fe[Pe],z+Fe[Pe+1],z+Fe[Pe+2]);if(Fe.length>0&&d&&this.elevationMode==="hd-road-base"){const Pe=d.elevation.isTunnel(),ue=d.elevation.safeArea,Ie=this.elevatedStructures.addVertices(ee,ae);this.elevatedStructures.addTriangles(Fe,Ie,Pe);const ke=fe.length;if(ke>0){for(let Ge=0;Ge<ke-1;Ge++)this.elevatedStructures.addRenderableRing(d.index,fe[Ge]+Ie,fe[Ge+1]-fe[Ge],Pe,ue,d.featureInfo);this.elevatedStructures.addRenderableRing(d.index,fe[ke-1]+Ie,ee.length-fe[ke-1],Pe,ue,d.featureInfo)}}k.vertexLength+=F,k.primitiveLength+=Fe.length/3}return[f,m]}prepareElevatedPolygons(i,o,d){const f=1/Qt(d),m=[];for(const v of i){const C=qF(v,new gt(o,f));m.push(...C)}return m}clipPolygonsToTile(i,o){const d=-o,f=-o,m=wi+o,v=wi+o;let C=0;const T=[],F=[];for(;C<i.length;C++){const H=i[C],$=Ec(H);($.min.x>=d&&$.max.x<=m&&$.min.y>=f&&$.max.y<=v?T:F).push(H)}if(T.length===i.length)return i;const k=[new qt(d,f),new qt(m,f),new qt(m,v),new qt(d,v),new qt(d,f)],z=T;for(const H of F)z.push(...KF(H,k));return z}}let Kw,qw,$w,Zw;Zi(U_,"FillBucket",{omit:["layers","patternFeatures"]}),Zi(O_,"FillBufferData"),Zi(nh,"ElevatedStructures");class z_{constructor(i,o,d,f){if(this.triangleCount=o.length/3,this.min=new qt(0,0),this.max=new qt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[m,v]=[i[0].clone(),i[0].clone()];for(let z=1;z<i.length;++z){const H=i[z];m.x=Math.min(m.x,H.x),m.y=Math.min(m.y,H.y),v.x=Math.max(v.x,H.x),v.y=Math.max(v.y,H.y)}if(f){const z=Math.ceil(Math.max(v.x-m.x,v.y-m.y)/f);d=Math.max(d,z)}if(d===0)return;this.min=m,this.max=v;const C=this.max.sub(this.min);C.x=Math.max(C.x,1),C.y=Math.max(C.y,1);const T=Math.max(C.x,C.y)/d;this.cellsX=Math.max(1,Math.ceil(C.x/T)),this.cellsY=Math.max(1,Math.ceil(C.y/T)),this.xScale=1/T,this.yScale=1/T;const F=[];for(let z=0;z<this.triangleCount;z++){const H=i[o[3*z+0]].sub(this.min),$=i[o[3*z+1]].sub(this.min),ee=i[o[3*z+2]].sub(this.min),ae=RA(Math.floor(Math.min(H.x,$.x,ee.x)),this.xScale,this.cellsX),fe=RA(Math.floor(Math.max(H.x,$.x,ee.x)),this.xScale,this.cellsX),ve=RA(Math.floor(Math.min(H.y,$.y,ee.y)),this.yScale,this.cellsY),Fe=RA(Math.floor(Math.max(H.y,$.y,ee.y)),this.yScale,this.cellsY),Pe=new qt(0,0),ue=new qt(0,0),Ie=new qt(0,0),ke=new qt(0,0);for(let Ge=ve;Ge<=Fe;++Ge){Pe.y=ue.y=Ge*T,Ie.y=ke.y=(Ge+1)*T;for(let yt=ae;yt<=fe;++yt)Pe.x=Ie.x=yt*T,ue.x=ke.x=(yt+1)*T,(fc(H,$,ee,Pe,ue,ke)||fc(H,$,ee,Pe,ke,Ie))&&F.push({cellIdx:Ge*this.cellsX+yt,triIdx:z})}}if(F.length===0)return;F.sort((z,H)=>z.cellIdx-H.cellIdx||z.triIdx-H.triIdx);let k=0;for(;k<F.length;){const z=F[k].cellIdx,H={start:this.payload.length,len:0};for(;k<F.length&&F[k].cellIdx===z;)++H.len,this.payload.push(F[k++].triIdx);this.cells[z]=H}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,o){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const d=RA(i.x-this.min.x,this.xScale,this.cellsX),f=RA(i.y-this.min.y,this.yScale,this.cellsY),m=this.cells[f*this.cellsX+d];if(m){this._lazyInitLookup();for(let v=0;v<m.len;v++){const C=this.payload[m.start+v],T=Math.floor(C/8),F=1<<C%8;if(!(this.lookup[T]&F)&&(this.lookup[T]|=F,o.push(C),o.length===this.triangleCount))return}}}query(i,o,d){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>o.x||i.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const f=RA(i.x-this.min.x,this.xScale,this.cellsX),m=RA(o.x-this.min.x,this.xScale,this.cellsX),v=RA(i.y-this.min.y,this.yScale,this.cellsY),C=RA(o.y-this.min.y,this.yScale,this.cellsY);for(let T=v;T<=C;T++)for(let F=f;F<=m;F++){const k=this.cells[T*this.cellsX+F];if(k)for(let z=0;z<k.len;z++){const H=this.payload[k.start+z],$=Math.floor(H/8),ee=1<<H%8;if(!(this.lookup[$]&ee)&&(this.lookup[$]|=ee,d.push(H),d.length===this.triangleCount))return}}}}function RA(l,i,o){return Math.max(0,Math.min(o-1,Math.floor(l*i)))}Zi(z_,"TriangleGridIndex");class Jw{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[],this.worldview=i.worldview}updateFootprints(i,o){for(const d of this.footprints)o.push({footprint:d,id:i})}populate(i,o,d,f){const m=[];for(const{feature:v,id:C,index:T,sourceLayerIndex:F}of i){const k=this.layers[0]._featureFilter.needGeometry,z=Ki(v,k);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),z,d))continue;const H={id:C,properties:v.properties,type:v.type,sourceLayerIndex:F,index:T,geometry:k?z.geometry:tr(v,d,f),patterns:{}};m.push(H)}for(const v of m){const{geometry:C,index:T,sourceLayerIndex:F}=v;this.addFeature(v,C,T,d,{},o.availableImages,o.brightness),o.featureIndex.insert(i[T].feature,C,T,F,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,o,d,f,m,v,C){}destroy(){}addFeature(i,o,d,f,m,v=[],C){for(const T of _v(o,2)){const F=[],k=[],z=[],H=new qt(1/0,1/0),$=new qt(-1/0,-1/0);for(const fe of T)if(fe.length!==0){fe!==T[0]&&z.push(k.length/2);for(let ve=0;ve<fe.length;ve++)k.push(fe[ve].x),k.push(fe[ve].y),F.push(fe[ve]),H.x=Math.min(H.x,fe[ve].x),H.y=Math.min(H.y,fe[ve].y),$.x=Math.max($.x,fe[ve].x),$.y=Math.max($.y,fe[ve].y)}const ee=Tm(k,z),ae=new z_(F,ee,8,256);this.footprints.push({vertices:F,indices:ee,grid:ae,min:H,max:$})}}}Zi(Jw,"ClipBucket",{omit:["layers"]});const $F=On([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ZF=On([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),JF=On([{name:"a_centroid_pos",components:2,type:"Uint16"}]),eL=On([{name:"a_join_normal_inside",components:3,type:"Int16"}]),tL=On([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),iL=On([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:rL}=$F,bv=Number.MAX_SAFE_INTEGER;function e2(l,i,o,d){return l.order<i||l.order===bv||!(l.clipMask&o)||function(f,m){return m.length!==0&&m.find(v=>v===f)===void 0}(d,l.clipScope)}function wv(l,i){return l.x-i.x||l.y-i.y}function t2(l,i){return wv(l.min,i.min)===0&&wv(l.max,i.max)===0}function N_(l,i){return!(l.min.x>i.max.x||l.max.x<i.min.x||l.min.y>i.max.y||l.max.y<i.min.y)}function j_(l,i){if(l.length!==i.length)return!1;for(let o=0;o<l.length;o++)if(l[o].sourceId!==i[o].sourceId||!t2(l[o],i[o])||l[o].order!==i[o].order||l[o].clipMask!==i[o].clipMask||!Vn(l[o].clipScope,i[o].clipScope))return!1;return!0}function i2(l,i,o){const d=1/wi,f=1/(1<<o.canonical.z),m=(i.x*d+o.canonical.x)*f+o.wrap,v=(i.y*d+o.canonical.y)*f;return{min:new qt((l.x*d+o.canonical.x)*f+o.wrap,(l.y*d+o.canonical.y)*f),max:new qt(m,v)}}function nL(l,i,o){const d=1<<o.canonical.z,f=((i.x-o.wrap)*d-o.canonical.x)*wi,m=(i.y*d-o.canonical.y)*wi;return{min:new qt(((l.x-o.wrap)*d-o.canonical.x)*wi,(l.y*d-o.canonical.y)*wi),max:new qt(f,m)}}function r2(l,i,o,d,f,m,v){const C=l.indices,T=l.vertices,F=[];for(let k=d;k<d+f;k+=3){const z=i[o[k+0]+m],H=i[o[k+1]+m],$=i[o[k+2]+m],ee=Math.min(z.x,H.x,$.x),ae=Math.max(z.x,H.x,$.x),fe=Math.min(z.y,H.y,$.y),ve=Math.max(z.y,H.y,$.y);F.length=0,l.grid.query(new qt(ee,fe),new qt(ae,ve),F);for(let Fe=0;Fe<F.length;Fe++){const Pe=F[Fe];if(fc(T[C[3*Pe+0]],T[C[3*Pe+1]],T[C[3*Pe+2]],z,H,$,v))return!0}}return!1}function n2(l,i,o,d){if(!l||!o)return!1;let f=l.vertices;if(!i.canonical.equals(d.canonical)||i.wrap!==d.wrap){if(o.vertices.length<l.vertices.length)return n2(o,d,l,i);const m=i.canonical,v=d.canonical,C=Math.pow(2,v.z-m.z);f=l.vertices.map(T=>new qt((T.x+m.x*wi)*C-v.x*wi,(T.y+m.y*wi)*C-v.y*wi))}return r2(o,f,l.indices,0,l.indices.length,0,0)}function s2(l,i,o,d){const f=Math.pow(2,d.z-o.z);return new qt((l+o.x*wi)*f-d.x*wi,(i+o.y*wi)*f-d.y*wi)}function o2(l,i){const o=[];i.grid.queryPoint(l,o);const d=i.indices,f=i.vertices;for(let m=0;m<o.length;m++){const v=o[m];if(os([f[d[3*v+0]],f[d[3*v+1]],f[d[3*v+2]]],l))return!0}return!1}const H_=[new qt(0,0),new qt(wi,0),new qt(wi,wi),new qt(0,wi)];function a2(l,i){const o=[];let d=[];if(!i||l.length<2)return[l];if(l.length===2)return Mn(l[0],l[1],H_)?[l]:[];for(let f=0;f<l.length+2;f++){const m=l[f%l.length],v=l[(f+1)%l.length],C=Mn(f===0?l[l.length-1]:l[(f-1)%l.length],m,H_),T=Mn(m,v,H_),F=C||T;F&&d.push(m),F&&T||d.length>0&&(d.length>1&&o.push(d),d=[])}return d.length>1&&o.push(d),o}const Q_=ln.VectorTileFeature.types,sL=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],oL=["fill-extrusion-flood-light-ground-radius"],aL=Math.pow(2,13),lL=Math.pow(2,15)-1,l2=new qt(0,1),op=2147483648;function km(l,i,o,d,f,m,v,C){l.emplaceBack((i<<1)+v,(o<<1)+m,(Math.floor(d*aL)<<1)+f,Math.round(C))}function Rm(l,i,o){l.emplaceBack(i.x*wi,i.y*wi,o?1:0)}function Bv(l,i,o,d,f,m){l.emplaceBack(i.x,i.y,(o.x<<1)+d,(o.y<<1)+f,m)}function Dm(l,i,o){l.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class c2{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class u2{constructor(){this.centroidXY=new qt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new qt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new qt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new qt(this.max.x-this.min.x,this.max.y-this.min.y)}}class h2{constructor(){this.acc=new qt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,o){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=o.x,i.min.y=i.max.y=o.y)}appendEdge(i,o,d){this.accCount++,this.acc._add(o);let f=!!this.borders;o.x<i.min.x?(i.min.x=o.x,f=!0):o.x>i.max.x&&(i.max.x=o.x,f=!0),o.y<i.min.y?(i.min.y=o.y,f=!0):o.y>i.max.y&&(i.max.y=o.y,f=!0),((o.x===0||o.x===wi)&&o.x===d.x)!=((o.y===0||o.y===wi)&&o.y===d.y)&&this.processBorderOverlap(o,d),f&&this.checkBorderIntersection(o,d)}checkBorderIntersection(i,o){o.x<0!=i.x<0&&this.addBorderIntersection(0,Er(o.y,i.y,(0-o.x)/(i.x-o.x))),o.x>wi!=i.x>wi&&this.addBorderIntersection(1,Er(o.y,i.y,(wi-o.x)/(i.x-o.x))),o.y<0!=i.y<0&&this.addBorderIntersection(2,Er(o.x,i.x,(0-o.y)/(i.y-o.y))),o.y>wi!=i.y>wi&&this.addBorderIntersection(3,Er(o.x,i.x,(wi-o.y)/(i.y-o.y)))}addBorderIntersection(i,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[i];o<d[0]&&(d[0]=o),o>d[1]&&(d[1]=o)}processBorderOverlap(i,o){if(i.x===o.x){if(i.y===o.y)return;const d=i.x===0?0:1;this.addBorderIntersection(d,o.y),this.addBorderIntersection(d,i.y)}else{const d=i.y===0?2:3;this.addBorderIntersection(d,o.x),this.addBorderIntersection(d,i.x)}}centroid(){return this.accCount===0?new qt(0,0):new qt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,o)=>i+ +(o[0]!==Number.MAX_VALUE),0):0}}function d2(l,i){const o=l.add(i)._unit(),d=Ye(l.x*o.x+l.y*o.y,-1,1);var f,m,v;return f=Math.acos(d),Math.min(4,Math.max(-4,Math.tan(f)))/4*lL*((m=l).x*(v=i).y-m.y*v.x<0?-1:1)}const cL=[l=>l.x<0,l=>l.x>wi,l=>l.y<0,l=>l.y>wi];function uL(l,i,o,d){const f=[4];if(d===0)return f;o._mult(d);const m=l.sub(o),v=i.sub(o),C=[l,i,m,v];for(let T=0;T<4;T++)for(const F of C)if(cL[T](F)){f.push(T);break}return f}class A2{constructor(i){this.vertexArray=new Th,this.indexArray=new Jo,this.programConfigurations=new p(i.layers,{zoom:i.zoom,lut:i.lut},o=>oL.includes(o)),this._segments=new Gs,this.hiddenByLandmarkVertexArray=new qf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Gs}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,o,d,f=!1){const m=i.length;if(m>2){let v=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let T;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const F=i[0],k=i[1];T=d2(F.sub(i[m-1])._perp()._unit(),k.sub(F)._perp()._unit())}for(let F=0;F<m;F++){const k=F===m-1?0:F+1,z=i[F],H=i[k],$=i[k===m-1?0:k+1],ee=H.sub(z)._perp()._unit(),ae=d2(ee,$.sub(H)._perp()._unit()),fe=T,ve=ae;if(V_(z,H,o)||f&&g2(z,o)&&g2(H,o)){T=ae;continue}const Fe=C.vertexLength;Bv(this.vertexArray,z,H,1,1,fe),Bv(this.vertexArray,z,H,1,0,fe),Bv(this.vertexArray,z,H,0,1,ve),Bv(this.vertexArray,z,H,0,0,ve),C.vertexLength+=4;const Pe=uL(z,H,ee,d);for(const ue of Pe)this._segmentToGroundQuads[v].push({id:Fe,region:ue}),this._segmentToRegionTriCounts[v][ue]+=2,C.primitiveLength+=2;T=ae}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),o=i.length;for(let d=0;d<o;d++)this._segmentToGroundQuads[d].sort((f,m)=>f.region-m.region);for(let d=0;d<o;d++){const f=this._segmentToGroundQuads[d],m=i[d],v=this._segmentToRegionTriCounts[d];v.reduce((T,F)=>T+F,0);let C=0;for(let T=0;T<=4;T++){const F=v[T];if(F!==0){let k=this.regionSegments[T];k||(k=this.regionSegments[T]=new Gs);const z={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+C,vertexLength:m.vertexLength,primitiveLength:F};k.get().push(z)}C+=F}for(let T=0;T<f.length;T++){const F=f[T].id;this.indexArray.emplaceBack(F,F+1,F+3),this.indexArray.emplaceBack(F,F+3,F+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,o,d,f,m,v,C){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,o,d,f,m,v,void 0,C)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,ZF.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,o,d,f,m,v,C,T){this.hasData()&&this.programConfigurations.updatePaintArrays(i,o,d,f,m,v,C,T)}updateHiddenByLandmark(i){if(!this.hasData())return;const o=i.groundVertexCount+i.groundVertexArrayOffset;if(i.groundVertexCount===0)return;const d=i.flags&op?1:0;for(let f=i.groundVertexArrayOffset;f<o;++f)this.hiddenByLandmarkVertexArray.emplace(f,d);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,tL.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const o=this.regionSegments[i];o&&o.destroy()}}}}class Cv{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Jo,this.footprintVertices=new $u,this.footprintSegments=[],this.layoutVertexArray=new wA,this.centroidVertexArray=new Qp,this.wallVertexArray=new Jh,this.indexArray=new Jo,this.programConfigurations=new p(i.layers,{zoom:i.zoom,lut:i.lut},o=>sL.includes(o)),this.segments=new Gs,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new A2(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=i.worldview}updateFootprints(i,o){}populate(i,o,d,f){this.features=[],this.hasPattern=k_("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Qt(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:v,index:C,sourceLayerIndex:T}of i){const F=this.layers[0]._featureFilter.needGeometry,k=Ki(m,F);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),k,d))continue;const z={id:v,sourceLayerIndex:T,index:C,geometry:F?k.geometry:tr(m,d,f),properties:m.properties,type:m.type,patterns:{}},H=this.layoutVertexArray.length,$=Q_[z.type]==="Polygon";if(this.hasPattern)this.features.push(R_("fill-extrusion",this.layers,z,this.zoom,this.pixelRatio,o));else if(this.wallMode)for(const ee of z.geometry)for(const ae of a2(ee,$))this.addFeature(z,[ae],C,d,{},o.availableImages,f,o.brightness);else this.addFeature(z,z.geometry,C,d,{},o.availableImages,f,o.brightness);o.featureIndex.insert(m,z.geometry,C,T,this.index,H)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,o,d,f,m,v){for(const C of this.features){const T=Q_[C.type]==="Polygon",{geometry:F}=C;if(this.wallMode)for(const k of F)for(const z of a2(k,T))this.addFeature(C,[z],C.index,o,d,f,m,v);else this.addFeature(C,F,C.index,o,d,f,m,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,o,d,f,m,v,C){this.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,this.worldview),this.groundEffect.update(i,o,m,d,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,rL),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,eL.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,iL.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,JF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,d,f,m,v,C,T){const F=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,k=[new qt(0,0),new qt(wi,wi)],z=C.projection,H=z.name==="globe",$=this.wallMode||Q_[i.type]==="Polygon",ee=new h2;ee.centroidDataIndex=this.centroidData.length;const ae=new u2,fe=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},f)<=0,ve=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},f);let Fe;if(ae.height=ve,ae.vertexArrayOffset=this.layoutVertexArray.length,ae.groundVertexArrayOffset=this.groundEffect.vertexArray.length,H&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new af),this.wallMode){if(H)return void Yr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;Fe=function(_t){const Mt=_t[0].x===_t[_t.length-1].x&&_t[0].y===_t[_t.length-1].y;(function(Xi){let Pi=0;const $r=Xi.length;for(let ar=0;ar<$r;ar++)Pi+=(Xi[(ar+1)%$r].x-Xi[ar].x)*(Xi[(ar+1)%$r].y+Xi[ar].y);return Pi>=0})(_t)||(_t=_t.reverse());const Si={geometry:[],joinNormals:[],indices:[]},Ai=[],Ci=[],Ti=[];let $t=_t.length;for(;$t>=2&&_t[$t-1].equals(_t[$t-2]);)$t--;if($t<(Mt?3:2))return Si;let _i,Vt,Yt,ki,Di,xr=0;for(;xr<$t-1&&_t[xr].equals(_t[xr+1]);)xr++;Mt&&(_i=_t[$t-2],Di=_t[xr].sub(_i)._unit()._perp());for(let Xi=xr;Xi<$t;Xi++){if(Yt=Xi===$t-1?Mt?_t[xr+1]:void 0:_t[Xi+1],Yt&&_t[Xi].equals(Yt))continue;Di&&(ki=Di),_i&&(Vt=_i),_i=_t[Xi],Di=Yt?Yt.sub(_i)._unit()._perp():ki,ki=ki||Di;let Pi=ki.add(Di);Pi.x===0&&Pi.y===0||Pi._unit();const $r=Pi.x*Di.x+Pi.y*Di.y,ar=$r!==0?1/$r:1/0,fr=ki.x*Di.y-ki.y*Di.x>0;let Nr="miter";const an=2;Nr==="miter"&&ar>an&&(Nr="bevel"),Nr==="bevel"&&(ar>100&&(Nr="flipbevel"),ar<an&&(Nr="miter"));const on=(_n,un,xn,as)=>{const js=new qt(_n.x,_n.y),Ne=new qt(_n.x,_n.y);js.x+=un.x*as,js.y+=un.y*as,Ne.x-=un.x*Math.max(xn,1),Ne.y-=un.y*Math.max(xn,1),Ti.push(un),Ai.push(js),Ci.push(Ne)};if(Nr==="miter")Pi._mult(ar),on(_i,Pi,0,0);else if(Nr==="flipbevel")Pi=Di.mult(-1),on(_i,Pi,0,0),on(_i,Pi.mult(-1),0,0);else{const _n=-Math.sqrt(ar*ar-1),un=fr?_n:0,xn=fr?0:_n;Vt&&on(_i,ki,un,xn),Yt&&on(_i,Di,un,xn)}}Si.geometry=[...Ai,...Ci.reverse(),Ai[0]],Si.joinNormals=[...Ti,...Ti.reverse(),Ti[Ti.length-1]];const ur=Si.geometry.length-1;for(let Xi=0;Xi<ur/2;Xi++)if(Xi+1<ur/2){let Pi=Xi,$r=Xi+1,ar=ur-1-Xi,fr=ur-2-Xi;Pi=Pi===0?ur-1:Pi-1,$r=$r===0?ur-1:$r-1,ar=ar===0?ur-1:ar-1,fr=fr===0?ur-1:fr-1,Si.indices.push(ar),Si.indices.push($r),Si.indices.push(Pi),Si.indices.push(ar),Si.indices.push(fr),Si.indices.push($r)}return Si}(o[0]),o=[Fe.geometry]}const Pe=(_t,Mt)=>_t<(Mt.length-1)/2||_t===Mt.length-1,ue=this.wallMode?[o]:_v(o,500);for(let _t=ue.length-1;_t>=0;_t--){const Mt=ue[_t];(Mt.length===0||(Ie=Mt[0]).every(Wt=>Wt.x<=0)||Ie.every(Wt=>Wt.x>=wi)||Ie.every(Wt=>Wt.y<=0)||Ie.every(Wt=>Wt.y>=wi))&&ue.splice(_t,1)}var Ie;let ke;if(H)ke=_2(ue,k,f);else{ke=[];for(const _t of ue)ke.push({polygon:_t,bounds:k})}const Ge=$?this.edgeRadius:0,yt=Ge>0&&this.zoom<17,At=(_t,Mt)=>{if(_t.length===0)return!1;const Wt=_t[_t.length-1];return Mt.x===Wt.x&&Mt.y===Wt.y};for(const{polygon:_t,bounds:Mt}of ke){let Wt=0,Si=0;for(const $t of _t)$&&!$t[0].equals($t[$t.length-1])&&$t.push($t[0]),Si+=$?$t.length-1:$t.length;const Ai=this.segments.prepareSegment(($?5:4)*Si,this.layoutVertexArray,this.indexArray);ae.footprintSegIdx<0&&(ae.footprintSegIdx=this.footprintSegments.length),ae.polygonSegIdx<0&&(ae.polygonSegIdx=this.polygonSegments.length);const Ci={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ti=new c2;if(Ti.vertexOffset=this.footprintVertices.length,Ti.indexOffset=3*this.footprintIndices.length,Ti.ringIndices=[],$){const $t=[],_i=[];Wt=Ai.vertexLength;for(let Yt=0;Yt<_t.length;Yt++){const ki=_t[Yt];ki.length&&Yt!==0&&_i.push($t.length/2);const Di=[];let xr,ur;xr=ki[1].sub(ki[0])._perp()._unit(),Ti.ringIndices.push(ki.length-1);for(let Xi=1;Xi<ki.length;Xi++){const Pi=ki[Xi],$r=ki[Xi===ki.length-1?1:Xi+1],ar=Pi.clone();if(Ge){ur=$r.sub(Pi)._perp()._unit();const fr=xr.add(ur)._unit(),Nr=Ge*Math.min(4,1/(xr.x*fr.x+xr.y*fr.y));ar.x+=Nr*fr.x,ar.y+=Nr*fr.y,ar.x=Math.round(ar.x),ar.y=Math.round(ar.y),xr=ur}if(!fe||Ge!==0&&!yt||At(Di,ar)||Di.push(ar),km(this.layoutVertexArray,ar.x,ar.y,0,0,1,1,0),this.wallMode){const fr=Pe(Xi,ki);Rm(this.wallVertexArray,Fe.joinNormals[Xi],!fr)}Ai.vertexLength++,this.footprintVertices.emplaceBack(Pi.x,Pi.y),$t.push(Pi.x,Pi.y),H&&Dm(this.layoutVertexExtArray,z.projectTilePoint(ar.x,ar.y,f),z.upVector(f,ar.x,ar.y))}fe&&(Ge===0||yt)&&(Di.length!==0&&At(Di,Di[0])&&Di.pop(),this.groundEffect.addData(Di,Mt,F))}const Vt=this.wallMode?Fe.indices:Tm($t,_i);for(let Yt=0;Yt<Vt.length;Yt+=3)this.footprintIndices.emplaceBack(Ti.vertexOffset+Vt[Yt+0],Ti.vertexOffset+Vt[Yt+1],Ti.vertexOffset+Vt[Yt+2]),this.indexArray.emplaceBack(Wt+Vt[Yt],Wt+Vt[Yt+2],Wt+Vt[Yt+1]),Ai.primitiveLength++;Ti.indexCount+=Vt.length,Ti.vertexCount+=this.footprintVertices.length-Ti.vertexOffset}for(let $t=0;$t<_t.length;$t++){const _i=_t[$t];ee.startRing(ae,_i[0]);let Vt=_i.length>4&&m2(_i[_i.length-2],_i[0],_i[1]),Yt=Ge?hL(_i[_i.length-2],_i[0],_i[1],Ge):0;const ki=[];let Di,xr,ur;xr=_i[1].sub(_i[0])._perp()._unit();let Xi=!0;for(let Pi=1,$r=0;Pi<_i.length;Pi++){let ar=_i[Pi-1],fr=_i[Pi];const Nr=_i[Pi===_i.length-1?1:Pi+1];if(ee.appendEdge(ae,fr,ar),V_(fr,ar,Mt)){Ge&&(xr=Nr.sub(fr)._perp()._unit(),Xi=!Xi);continue}const an=fr.sub(ar)._perp(),on=an.x/(Math.abs(an.x)+Math.abs(an.y)),_n=an.y>0?1:0,un=ar.dist(fr);if($r+un>32768&&($r=0),Ge){ur=Nr.sub(fr)._perp()._unit();let Ne=p2(ar,fr,Nr,f2(xr,ur),Ge);isNaN(Ne)&&(Ne=0);const Xe=fr.sub(ar)._unit();ar=ar.add(Xe.mult(Yt))._round(),fr=fr.add(Xe.mult(-Ne))._round(),Yt=Ne,xr=ur,fe&&this.zoom>=17&&(At(ki,ar)||ki.push(ar),At(ki,fr)||ki.push(fr))}const xn=Ai.vertexLength,as=_i.length>4&&m2(ar,fr,Nr);let js=y2($r,Vt,Xi);if(km(this.layoutVertexArray,ar.x,ar.y,on,_n,0,0,js),km(this.layoutVertexArray,ar.x,ar.y,on,_n,0,1,js),this.wallMode){const Ne=Pe(Pi-1,_i),Xe=Fe.joinNormals[Pi-1];Rm(this.wallVertexArray,Xe,Ne),Rm(this.wallVertexArray,Xe,Ne)}if($r+=un,js=y2($r,as,!Xi),Vt=as,km(this.layoutVertexArray,fr.x,fr.y,on,_n,0,0,js),km(this.layoutVertexArray,fr.x,fr.y,on,_n,0,1,js),this.wallMode){const Ne=Pe(Pi,_i),Xe=Fe.joinNormals[Pi];Rm(this.wallVertexArray,Xe,Ne),Rm(this.wallVertexArray,Xe,Ne)}if(Ai.vertexLength+=4,this.indexArray.emplaceBack(xn+0,xn+1,xn+2),this.indexArray.emplaceBack(xn+1,xn+3,xn+2),Ai.primitiveLength+=2,Ge){const Ne=Wt+(Pi===1?_i.length-2:Pi-2),Xe=Pi===1?Wt:Ne+1;if(this.indexArray.emplaceBack(xn+1,Ne,xn+3),this.indexArray.emplaceBack(Ne,Xe,xn+3),Ai.primitiveLength+=2,Di===void 0&&(Di=xn),!V_(Nr,_i[Pi],Mt)){const Jt=Pi===_i.length-1?Di:Ai.vertexLength;this.indexArray.emplaceBack(xn+2,xn+3,Jt),this.indexArray.emplaceBack(xn+3,Jt+1,Jt),this.indexArray.emplaceBack(xn+3,Xe,Jt+1),Ai.primitiveLength+=3}Xi=!Xi}if(H){const Ne=this.layoutVertexExtArray,Xe=z.projectTilePoint(ar.x,ar.y,f),Jt=z.projectTilePoint(fr.x,fr.y,f),zi=z.upVector(f,ar.x,ar.y),Yi=z.upVector(f,fr.x,fr.y);Dm(Ne,Xe,zi),Dm(Ne,Xe,zi),Dm(Ne,Jt,Yi),Dm(Ne,Jt,Yi)}}$&&(Wt+=_i.length-1),fe&&Ge&&this.zoom>=17&&(ki.length!==0&&At(ki,ki[0])&&ki.pop(),this.groundEffect.addData(ki,Mt,F,Ge>0))}this.footprintSegments.push(Ti),Ci.triangleCount=this.indexArray.length-Ci.triangleArrayOffset,this.polygonSegments.push(Ci),++ae.footprintSegLen,++ae.polygonSegLen}if(ae.vertexCount=this.layoutVertexArray.length-ae.vertexArrayOffset,ae.groundVertexCount=this.groundEffect.vertexArray.length-ae.groundVertexArrayOffset,ae.vertexCount!==0){if(ae.centroidXY=ee.borders?l2:this.encodeCentroid(ee,ae),this.centroidData.push(ae),ee.borders){this.featuresOnBorder.push(ee);const _t=this.featuresOnBorder.length-1;for(let Mt=0;Mt<ee.borders.length;Mt++)ee.borders[Mt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Mt].push(_t)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,m,v,f,T,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(i,d,m,v,f,T,this.worldview),this.maxHeight=Math.max(this.maxHeight,ve)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((o,d)=>this.featuresOnBorder[o].borders[i][0]-this.featuresOnBorder[d].borders[i][0])}splitToSubtiles(){const i=[];for(let C=0;C<this.centroidData.length;C++){const T=this.centroidData[C],F=+(T.min.y+T.max.y>wi),k=2*F+(+(T.min.x+T.max.x>wi)^F);for(let z=0;z<T.polygonSegLen;z++){const H=T.polygonSegIdx+z;i.push({centroidIdx:C,subtile:k,polygonSegmentIdx:H,triangleSegmentIdx:this.polygonSegments[H].triangleSegIdx})}}const o=new Jo;i.sort((C,T)=>C.triangleSegmentIdx===T.triangleSegmentIdx?C.subtile-T.subtile:C.triangleSegmentIdx-T.triangleSegmentIdx);let d=0,f=0,m=0;for(const C of i){if(C.triangleSegmentIdx!==d)break;m++}const v=i.length;for(;f!==i.length;){d=i[f].triangleSegmentIdx;let C=0,T=f,F=f;for(let k=T;k<m&&i[k].subtile===C;k++)F++;for(;T!==m;){const k=i[T];C=k.subtile;const z=this.centroidData[k.centroidIdx].min.clone(),H=this.centroidData[k.centroidIdx].max.clone(),$={vertexOffset:this.segments.segments[d].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[d].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let ee=T;ee<F;ee++){const ae=i[ee],fe=this.polygonSegments[ae.polygonSegmentIdx],ve=this.centroidData[ae.centroidIdx].min,Fe=this.centroidData[ae.centroidIdx].max,Pe=this.indexArray.uint16;for(let ue=fe.triangleArrayOffset;ue<fe.triangleArrayOffset+fe.triangleCount;ue++)o.emplaceBack(Pe[3*ue],Pe[3*ue+1],Pe[3*ue+2]);$.primitiveLength+=fe.triangleCount,z.x=Math.min(z.x,ve.x),z.y=Math.min(z.y,ve.y),H.x=Math.max(H.x,Fe.x),H.y=Math.max(H.y,Fe.y)}$.primitiveLength>0&&this.triangleSubSegments.push({segment:$,min:z,max:H}),T=F;for(let ee=T;ee<m&&i[ee].subtile===i[T].subtile;ee++)F++}f=m;for(let k=f;k<v&&i[k].triangleSegmentIdx===i[f].triangleSegmentIdx;k++)m++}o._trim(),this.indexArray=o}getVisibleSegments(i,o,d){const f=new Gs;if(this.wallMode){for(const ae of this.triangleSubSegments)f.segments.push(ae.segment);return f}let m=0,v=0;const C=1<<i.canonical.z;if(o){const ae=o.getMinMaxForTile(i);ae&&(m=ae.min,v=ae.max)}v+=this.maxHeight;const T=i.toUnwrapped();let F;const k=[T.canonical.x/C+T.wrap,T.canonical.y/C],z=[(T.canonical.x+1)/C+T.wrap,(T.canonical.y+1)/C],H=(ae,fe,ve)=>[ae[0]*(1-ve[0])+fe[0]*ve[0],ae[1]*(1-ve[1])+fe[1]*ve[1]],$=[],ee=[];for(const ae of this.triangleSubSegments){$[0]=ae.min.x/wi,$[1]=ae.min.y/wi,ee[0]=ae.max.x/wi,ee[1]=ae.max.y/wi;const fe=H(k,z,$),ve=H(k,z,ee);if(new De([fe[0],fe[1],m],[ve[0],ve[1],v]).intersectsPrecise(d)===0){F&&(f.segments.push(F),F=void 0);continue}const Fe=ae.segment;F&&F.vertexOffset!==Fe.vertexOffset&&(f.segments.push(F),F=void 0),F?(F.vertexLength+=Fe.vertexLength,F.primitiveLength+=Fe.primitiveLength):F={vertexOffset:Fe.vertexOffset,primitiveLength:Fe.primitiveLength,vertexLength:Fe.vertexLength,primitiveOffset:Fe.primitiveOffset,sortKey:void 0,vaos:{}}}return F&&f.segments.push(F),f}encodeCentroid(i,o){const d=i.centroid(),f=o.span(),m=Math.min(7,Math.round(f.x*this.tileToMeter/10)),v=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new qt(Ye(d.x,1,wi-1)<<3|m,Ye(d.y,1,wi-1)<<3|v)}encodeBorderCentroid(i){if(!i.borders)return new qt(0,0);const o=i.borders,d=Number.MAX_VALUE;if(o[0][0]!==d||o[1][0]!==d){const f=o[0][0]!==d?0:1;return new qt(6|(o[0][0]!==d?0:65528),(o[f][0]+o[f][1])/2<<3|6)}{const f=o[2][0]!==d?2:3;return new qt((o[f][0]+o[f][1])/2<<3|6,6|(o[2][0]!==d?0:65528))}}showCentroid(i){const o=this.centroidData[i.centroidDataIndex];o.flags&=op,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const o=i.vertexArrayOffset,d=i.vertexCount+i.vertexArrayOffset,f=i.flags&op?l2:i.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==f.y||m!==f.x){for(let v=o;v<d;++v)this.centroidVertexArray.emplace(v,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,o,d){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(i.toUnwrapped());if(j_(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const m=[];for(const v of this.activeReplacements){if(v.order<d)continue;const C=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-i.canonical.z));for(const T of this.centroidData)if(!(T.flags&op||v.min.x>T.max.x||T.min.x>v.max.x||v.min.y>T.max.y||T.min.y>v.max.y))for(let F=0;F<T.footprintSegLen;F++){const k=this.footprintSegments[T.footprintSegIdx+F];if(m.length=0,dL(this.footprintVertices,k.vertexOffset,k.vertexCount,v.footprintTileId.canonical,i.canonical,m),r2(v.footprint,m,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-C)){T.flags|=op;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,o,d){let f=!1;for(let m=0;m<d.footprintSegLen;m++){const v=this.footprintSegments[d.footprintSegIdx+m];let C=0;for(const T of v.ringIndices){for(let F=C,k=T+C-1;F<T+C;k=F++){const z=this.footprintVertices.int16[2*(F+v.vertexOffset)+0],H=this.footprintVertices.int16[2*(F+v.vertexOffset)+1],$=this.footprintVertices.int16[2*(k+v.vertexOffset)+1];H>o!=$>o&&i<(this.footprintVertices.int16[2*(k+v.vertexOffset)+0]-z)*(o-H)/($-H)+z&&(f=!f)}C=T}}return f}getHeightAtTileCoord(i,o){let d=Number.NEGATIVE_INFINITY,f=!0;const m=4*(i+wi)*wi+(o+wi);if(this.partLookup.hasOwnProperty(m)){const v=this.partLookup[m];return v?{height:v.height,hidden:!!(v.flags&op)}:void 0}for(const v of this.centroidData)i>v.max.x||v.min.x>i||o>v.max.y||v.min.y>o||this.footprintContainsPoint(i,o,v)&&v&&v.height>d&&(d=v.height,this.partLookup[m]=v,f=!!(v.flags&op));if(d!==Number.NEGATIVE_INFINITY)return{height:d,hidden:f};this.partLookup[m]=void 0}}function f2(l,i){const o=l.add(i)._unit();return l.x*o.x+l.y*o.y}function hL(l,i,o,d){const f=i.sub(l)._perp()._unit(),m=o.sub(i)._perp()._unit();return p2(l,i,o,f2(f,m),d)}function p2(l,i,o,d,f){const m=Math.sqrt(1-d*d);return Math.min(l.dist(i)/3,i.dist(o)/3,f*m/d)}function V_(l,i,o){return l.x<o[0].x&&i.x<o[0].x||l.x>o[1].x&&i.x>o[1].x||l.y<o[0].y&&i.y<o[0].y||l.y>o[1].y&&i.y>o[1].y}function g2(l,i){return l.x<i[0].x||l.x>i[1].x||l.y<i[0].y||l.y>i[1].y}function m2(l,i,o){if(l.x<0||l.x>=wi||i.x<0||i.x>=wi||o.x<0||o.x>=wi)return!1;const d=o.sub(i),f=d.perp(),m=l.sub(i);return(d.x*m.x+d.y*m.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(m.x*m.x+m.y*m.y))>-.866&&f.x*m.x+f.y*m.y<0}function y2(l,i,o){const d=i?2|l:-3&l;return o?1|d:-2&d}function v2(){const l=Math.PI/32,i=Math.tan(l),o=ge;return o*Math.sqrt(1+2*i*i)-o}function _2(l,i,o){const d=1<<o.z,f=ft(o.x/d),m=ft((o.x+1)/d),v=Rt(o.y/d),C=Rt((o.y+1)/d);return function(T,F,k,z,H=0,$){const ee=[];if(!T.length||!k||!z)return ee;const ae=(ke,Ge)=>{for(const yt of ke)ee.push({polygon:yt,bounds:Ge})},fe=Math.ceil(Math.log2(k)),ve=Math.ceil(Math.log2(z)),Fe=fe-ve,Pe=[];for(let ke=0;ke<Math.abs(Fe);ke++)Pe.push(Fe>0?0:1);for(let ke=0;ke<Math.min(fe,ve);ke++)Pe.push(0),Pe.push(1);let ue=T;if(ue=xv(ue,F[0].y-H,F[1].y+H,1),ue=xv(ue,F[0].x-H,F[1].x+H,0),!ue.length)return ee;const Ie=[];for(Pe.length?Ie.push({polygons:ue,bounds:F,depth:0}):ae(ue,F);Ie.length;){const ke=Ie.pop(),Ge=ke.depth,yt=Pe[Ge],At=ke.bounds[0],_t=ke.bounds[1],Mt=yt===0?At.x:At.y,Wt=yt===0?_t.x:_t.y,Si=$?$(yt,Mt,Wt):.5*(Mt+Wt),Ai=xv(ke.polygons,Mt-H,Si+H,yt),Ci=xv(ke.polygons,Si-H,Wt+H,yt);if(Ai.length){const Ti=[At,new qt(yt===0?Si:_t.x,yt===1?Si:_t.y)];Pe.length>Ge+1?Ie.push({polygons:Ai,bounds:Ti,depth:Ge+1}):ae(Ai,Ti)}if(Ci.length){const Ti=[new qt(yt===0?Si:At.x,yt===1?Si:At.y),_t];Pe.length>Ge+1?Ie.push({polygons:Ci,bounds:Ti,depth:Ge+1}):ae(Ci,Ti)}}return ee}(l,i,Math.ceil((m-f)/11.25),Math.ceil((v-C)/11.25),1,(T,F,k)=>{if(T===0)return .5*(F+k);{const z=Rt((o.y+F/wi)/d);return(qe(.5*(Rt((o.y+k/wi)/d)+z))*d-o.y)*wi}})}function dL(l,i,o,d,f,m){const v=Math.pow(2,d.z-f.z);for(let C=0;C<o;C++){let T=l.int16[2*(C+i)+0],F=l.int16[2*(C+i)+1];T=(T+f.x*wi)*v-d.x*wi,F=(F+f.y*wi)*v-d.y*wi,m.push(new qt(T,F))}}let x2,b2;Zi(Cv,"FillExtrusionBucket",{omit:["layers","features"]}),Zi(u2,"PartData"),Zi(c2,"FootprintSegment"),Zi(h2,"BorderCentroidData"),Zi(A2,"GroundEffect");class Yp extends qt{constructor(i,o,d){super(i,o),this.z=d}}class w2 extends Yp{constructor(i,o,d,f){super(i,o,d),this.w=f}}function B2(l,i,o,d){const f=o==="x"?"y":"x",m=(d-l[o])/(i[o]-l[o]);l[f]=Math.round(l[f]+(i[f]-l[f])*m),l[o]=d,l.hasOwnProperty("z")&&(l.z=Er(l.z,i.z,m)),l.hasOwnProperty("w")&&(l.w=Er(l.w,i.w,m))}function C2(l,i,o,d){const f=o,m=d;for(const v of["x","y"]){let C=l,T=i;C[v]>=T[v]&&(C=i,T=l),C[v]<f&&T[v]>f&&B2(C,T,v,f),C[v]<m&&T[v]>m&&B2(T,C,v,m)}}function Sv(l,i,o,d,f,m){const v=[];for(let C=0;C<l.length;C++){const T=l[C];let F;const k=v.length;let z=0;for(let H=0;H<T.length-1;H++){let $=T[H],ee=T[H+1],ae=0;const fe=z;let ve,Fe;m&&(ae=Math.hypot(ee.x-$.x,ee.y-$.y),z+=ae,ve=$,Fe=ee),$.x<i&&ee.x<i||($.x<i?$=new qt(i,$.y+(i-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x<i&&(ee=new qt(i,$.y+(i-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y<o&&ee.y<o||($.y<o?$=new qt($.x+(o-$.y)/(ee.y-$.y)*(ee.x-$.x),o)._round():ee.y<o&&(ee=new qt($.x+(o-$.y)/(ee.y-$.y)*(ee.x-$.x),o)._round()),$.x>=d&&ee.x>=d||($.x>=d?$=new qt(d,$.y+(d-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x>=d&&(ee=new qt(d,$.y+(d-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y>=f&&ee.y>=f||($.y>=f?$=new qt($.x+(f-$.y)/(ee.y-$.y)*(ee.x-$.x),f)._round():ee.y>=f&&(ee=new qt($.x+(f-$.y)/(ee.y-$.y)*(ee.x-$.x),f)._round()),F&&$.equals(F[F.length-1])||(F=[$],v.push(F),m&&m.push({progress:{min:fe+S2(ve,Fe,$)*ae,max:1},parentIndex:C,prevPoint:ve,nextPoint:Fe})),F.push(ee),m&&(m[m.length-1].progress.max=fe+S2(ve,Fe,ee)*ae,m[m.length-1].nextPoint=Fe)))))}if(m&&z>0)for(let H=k;H<v.length;H++)m[H].progress.min/=z,m[H].progress.max/=z}return v}function AL(l,i,o,d,f){if(l.length<2)return void d.push(l);const m=[];for(;i.valid();){const[F,k]=i.get();for(let z=0;z<l.length-1;z++){const H=l[z],$=l[z+1],ee=Ys(H,$,F,k);if(ee){const[ae]=ee,fe=new qt(Er(H.x,$.x,ae),Er(H.y,$.y,ae));m.push({t:z+ae,distance:0,point:fe})}}i.next()}if(m.length===0)return void d.push(l);m.sort((F,k)=>F.t-k.t);let v=0,C=0,T=[];for(d.push(T);v!==l.length;){if(C===m.length){for(;v!==l.length;)T.length!==0&&T[T.length-1].equals(l[v])||T.push(l[v]),v++;break}m[C].t<=v?(T.length!==0&&T[T.length-1].equals(m[C].point)||T.push(m[C].point),Math.trunc(m[C].t),C++):(T.length!==0&&T[T.length-1].equals(l[v])||T.push(l[v]),v++)}}function S2(l,i,o){return l.x!==i.x?(o.x-l.x)/(i.x-l.x):l.y!==i.y?(o.y-l.y)/(i.y-l.y):0}function Om(l,i){return l.x*i.x+l.y*i.y}function E2(l,i){if(l.length===1){let o=0;const d=i[o++];let f;for(;!f||d.equals(f);)if(f=i[o++],!f)return 1/0;for(;o<i.length;o++){const m=i[o],v=l[0],C=f.sub(d),T=m.sub(d),F=v.sub(d),k=Om(C,C),z=Om(C,T),H=Om(T,T),$=Om(F,C),ee=Om(F,T),ae=k*H-z*z,fe=(H*$-z*ee)/ae,ve=(k*ee-z*$)/ae,Fe=d.z*(1-fe-ve)+f.z*fe+m.z*ve;if(isFinite(Fe))return Fe}return 1/0}{let o=1/0;for(const d of i)o=Math.min(o,d.z);return o}}function I2(l,i,o,d,f,m,v,C){const T=v*f.getElevationAt(l,i,!0,!0),F=m[0]!==0,k=F?m[1]===0?v*(m[0]/7-450):v*function(z,H,$){const ee=Math.floor(H[0]/8),ae=Math.floor(H[1]/8),fe=10*(H[0]-8*ee),ve=10*(H[1]-8*ae),Fe=z.getElevationAt(ee,ae,!0,!0),Pe=z.getMeterToDEM($),ue=Math.floor(.5*(fe*Pe-1)),Ie=Math.floor(.5*(ve*Pe-1)),ke=z.tileCoordToPixel(ee,ae),Ge=2*ue+1,yt=2*Ie+1,At=function(Ci,Ti,$t,_i,Vt){return[Ci.getElevationAtPixel(Ti,$t,!0),Ci.getElevationAtPixel(Ti+Vt,$t,!0),Ci.getElevationAtPixel(Ti,$t+Vt,!0),Ci.getElevationAtPixel(Ti+_i,$t+Vt,!0)]}(z,ke.x-ue,ke.y-Ie,Ge,yt),_t=Math.abs(At[0]-At[1]),Mt=Math.abs(At[2]-At[3]),Wt=Math.abs(At[0]-At[2])+Math.abs(At[1]-At[3]),Si=Math.min(.25,.5*Pe*(_t+Mt)/Ge),Ai=Math.min(.25,.5*Pe*Wt/yt);return Fe+Math.max(Si*fe,Ai*ve)}(f,m,C):T;return{base:T+(o===0?-1:o),top:F?Math.max(k+d,T+o+2):T+d}}class fL{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class pL{constructor(){this.tasks={},this.taskQueue=[],er(["process"],this),this.invoker=new fL(this.process),this.nextId=0}add(i,o){const d=this.nextId++,f=function({type:m,isSymbolTile:v,zoom:C}){return C=C||0,m==="message"?0:m!=="maybePrepare"||v?m!=="parseTile"||v?m==="parseTile"&&v?300-C:m==="maybePrepare"&&v?400-C:500:200-C:100-C}(o);if(f===0){try{i()}finally{}return null}return this.tasks[d]={fn:i,metadata:o,priority:f,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const o=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let i=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const m=this.tasks[this.taskQueue[f]];m.priority<o&&(o=m.priority,i=f)}if(i===null)return null;const d=this.taskQueue[i];return this.taskQueue.splice(i,1),d}remove(){this.invoker.remove()}}class T2{constructor(i,o,d){this.target=i,this.parent=o,this.mapId=d,this.callbacks={},this.cancelCallbacks={},er(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new pL}send(i,o,d,f,m=!1,v){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(d.metadata=v,this.callbacks[C]=d);const T=new Set;return this.target.postMessage({id:C,type:i,hasCallback:!!d,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:qc(o,T)},T),{cancel:()=>{d&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(i){const o=i.data;if(!o)return;const d=o.id;if(d&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[d];delete this.cancelCallbacks[d],f&&f.cancel()}else if(o.mustQueue||En(self)){const f=this.callbacks[d],m=this.scheduler.add(()=>this.processTask(d,o),f&&f.metadata||{type:"message"});m&&(this.cancelCallbacks[d]=m)}else this.processTask(d,o)}processTask(i,o){if(delete this.cancelCallbacks[i],o.type==="<response>"){const d=this.callbacks[i];delete this.callbacks[i],d&&(o.error?d(Eu(o.error)):d(null,Eu(o.data)))}else{const d=new Set,f=o.hasCallback?(v,C)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:v?qc(v):null,data:qc(C,d)},d)}:()=>{},m=Eu(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,m,f);else if(this.parent.getWorkerSource){const v=o.type.split("."),{source:C,scope:T}=m;this.parent.getWorkerSource(o.sourceMapId,v[0],C,T)[v[1]](m,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Um={workerUrl:"",workerClass:null,workerParams:void 0};const G_="mapboxgl_preloaded_worker_pool";class Kp{constructor(){this.active={}}acquire(i,o=Kp.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(Um.workerClass!=null?new Um.workerClass:new self.Worker(Um.workerUrl,Um.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[G_]}numActive(){return Object.keys(this.active).length}}Kp.workerCount=2;class kg{constructor(i,o,d="Worker",f=Kp.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=Nt();const m=this.workerPool.acquire(this.id,f);for(let v=0;v<m.length;v++){const C=new kg.Actor(m[v],o,this.id);C.name=`${d} ${v}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,o,d){bt(this.actors,(f,m)=>{f.send(i,o,m)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}let zm,W_;function Ev(){return zm||(zm=new Kp),zm}kg.Actor=T2;class gL{constructor(i){this.module=i}createIntArray(i){const o=new Int32Array(i),d=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heap32.set(o,d/o.BYTES_PER_ELEMENT),d}createFloatArray(i){const o=new Float32Array(i),d=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heapF32.set(o,d/o.BYTES_PER_ELEMENT),d}createStringBuffer(i){const o=this.module.malloc(i.length+1);for(let d=0;d<i.length;++d)this.module.heapU8[o+d]=i.charCodeAt(d);return this.module.heapU8[o+i.length]=0,o}readStringBuffer(i){let o="";for(;this.module.heapU8[i]!==0;)o+=String.fromCharCode(this.module.heapU8[i]),++i;return o}setStyle(i){const o=i.entranceColorRgb,d=i.facadeGlazingColorRgb,f=i.roofColorRgb,m=i.wallColorRgb,v=i.normalScale;this.module.setStyle(o[0],o[1],o[2],d[0],d[1],d[2],f[0],f[1],f[2],m[0],m[1],m[2],v[0],v[1],v[2],i.tileToMeters)}setAOOptions(i,o){this.module.setAOOptions(i?1:0,o)}setMetricOptions(i,o){this.module.setMetricOptions(i?1:0,o)}setFacadeOptions(i,o,d){this.module.setFacadeOptions(i,o,d)}generateMesh(i,o){for(const C of i){const T=this.createStringBuffer(C.roofType),F=[0],k=[];for(const $ of C.coordinates)if(Array.isArray($)){for(const ee of $)k.push(ee.x),k.push(ee.y);F.push(k.length)}const z=this.createIntArray(F),H=this.createFloatArray(k);this.module.addFeature(C.id,C.sourceId,C.minHeight,C.height,T,C.roofType.length,H,z,F.length-1),this.module.free(T),this.module.free(z),this.module.free(H)}for(const C of o){let T;T=C.entrances?JSON.parse(C.entrances):[];const F=this.createFloatArray(T),k=[];for(const H of C.coordinates)k.push(H.x),k.push(H.y);const z=this.createFloatArray(k);this.module.addFacade(C.sourceId,C.crossPerc,C.distanceToRoad,F,T.length,z,k.length),this.module.free(F),this.module.free(z)}if(!this.module.generateMesh()){const C=this.module.getLastError();return this.readStringBuffer(C)}const d=this.module.getMeshCount(),f=new Array(d);for(let C=0;C<d;C++){const T=this.module.getPositionsPtr(C),F=this.module.getPositionsLength(C),k=new Float32Array(this.module.heapF32.buffer,T,F),z=this.module.getNormalsPtr(C),H=this.module.getNormalsLength(C),$=new Float32Array(this.module.heapF32.buffer,z,H),ee=this.module.getColorsPtr(C),ae=this.module.getColorsLength(C),fe=new Uint8Array(this.module.heapU8.buffer,ee,ae),ve=this.module.getAOPtr(C),Fe=this.module.getAOLength(C),Pe=new Float32Array(this.module.heapF32.buffer,ve,Fe),ue=this.module.getIndicesPtr(C),Ie=this.module.getIndicesLength(C),ke=new Int32Array(this.module.heap32.buffer,ue,Ie),Ge=this.module.getBuildingPart(C),yt=this.readStringBuffer(Ge);f[C]={positions:k,normals:$,colors:fe,ao:Pe,indices:ke,buildingPart:yt}}const m=this.module.getRingCount(),v=[];for(let C=0;C<m;C++){const T=this.module.getRingPtr(C),F=this.module.getRingLength(C),k=new Float32Array(this.module.heapF32.buffer,T,F);v.push(k)}return{meshes:f,modifiedPolygonRings:v}}}let Nm,X_,Ud,Rg,Y_,Dg=null,Og=null,F2=null,K_=null;function L2(){return En(self)&&self.worker.dracoUrl?self.worker.dracoUrl:X_||ds.DRACO_URL}function M2(){if(En(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Rg)return Rg;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Rg=WebAssembly.validate(l)?ds.MESHOPT_SIMD_URL:ds.MESHOPT_URL,Rg}const Iv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},mL={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},jm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function P2(l,i,o){const d=o.json.bufferViews.length,f=o.buffers.length;i.bufferView=d,o.json.bufferViews[d]={buffer:f,byteLength:l.byteLength},o.buffers[f]=l}const q_="KHR_draco_mesh_compression";function yL(l,i){const o=l.extensions&&l.extensions[q_];if(!o)return;const d=new Ud.Decoder,f=O2(i,o.bufferView),m=new Ud.Mesh;if(!d.DecodeArrayToMesh(f,f.byteLength,m))throw new Error("Failed to decode Draco mesh");const v=i.json.accessors[l.indices],C=Iv[v.componentType],T=v.count*C.BYTES_PER_ELEMENT,F=Ud._malloc(T);C===Uint16Array?d.GetTrianglesUInt16Array(m,T,F):d.GetTrianglesUInt32Array(m,T,F),P2(Ud.memory.buffer.slice(F,F+T),v,i),Ud._free(F);for(const k of Object.keys(o.attributes)){const z=d.GetAttributeByUniqueId(m,o.attributes[k]),H=i.json.accessors[l.attributes[k]],$=mL[H.componentType],ee=H.count*jm[H.type]*Iv[H.componentType].BYTES_PER_ELEMENT,ae=Ud._malloc(ee);d.GetAttributeDataArrayForAllPoints(m,z,Ud[$],ee,ae),P2(Ud.memory.buffer.slice(ae,ae+ee),H,i),Ud._free(ae)}d.destroy(),m.destroy(),delete l.extensions[q_]}const Tv="EXT_meshopt_compression";function vL(l,i){if(!l.extensions||!l.extensions[Tv])return;const o=l.extensions[Tv],d=new Uint8Array(i.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),f=new Uint8Array(o.count*o.byteStride);Y_.decodeGltfBuffer(f,o.count,o.byteStride,d,o.mode,o.filter),l.buffer=i.buffers.length,l.byteOffset=0,i.buffers[l.buffer]=f.buffer,delete l.extensions[Tv]}const k2=1179937895,R2=new TextDecoder("utf8");function D2(l,i){return new URL(l,i).href}function _L(l,i,o,d){return fetch(D2(l.uri,d)).then(f=>f.arrayBuffer()).then(f=>{i.buffers[o]=f})}function O2(l,i){const o=l.json.bufferViews[i];return new Uint8Array(l.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function xL(l,i,o,d){if(l.uri){const f=D2(l.uri,d);return fetch(f).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{i.images[o]=m})}if(l.bufferView!==void 0){const f=O2(i,l.bufferView),m=new Blob([f],{type:l.mimeType});return createImageBitmap(m).then(v=>{i.images[o]=v})}}function U2(l,i=0,o){const d={json:null,images:[],buffers:[]};if(new Uint32Array(l,i,1)[0]===k2){const k=new Uint32Array(l,i);let z=2;const H=(k[z++]>>2)-3,$=k[z++]>>2;if(z++,d.json=JSON.parse(R2.decode(k.subarray(z,z+$))),z+=$,z<H){const ee=k[z++];z++;const ae=i+(z<<2);d.buffers[0]=l.slice(ae,ae+ee)}}else d.json=JSON.parse(R2.decode(new Uint8Array(l,i)));const{buffers:f,images:m,meshes:v,extensionsUsed:C,bufferViews:T}=d.json;let F=Promise.resolve();if(f){const k=[];for(let z=0;z<f.length;z++){const H=f[z];H.uri?k.push(_L(H,d,z,o)):d.buffers[z]||(d.buffers[z]=null)}F=Promise.all(k)}return F.then(()=>{const k=[],z=C&&C.includes(q_),H=C&&C.includes(Tv);if(z&&k.push(function(){if(!Ud)return Nm??(Nm=function($){let ee,ae=null;function fe(){ee=new Uint8Array(ae.buffer)}function ve(){throw new Error("Unexpected Draco error.")}const Fe={a:{a:ve,d:function(Pe,ue,Ie){return ee.copyWithin(Pe,ue,ue+Ie)},c:function(Pe){const ue=ee.length,Ie=Math.max(Pe>>>0,Math.ceil(1.2*ue)),ke=Math.ceil((Ie-ue)/65536);try{return ae.grow(ke),fe(),!0}catch{return!1}},b:ve}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming($,Fe):$.then(Pe=>Pe.arrayBuffer()).then(Pe=>WebAssembly.instantiate(Pe,Fe))).then(Pe=>{const{Rb:ue,Qb:Ie,P:ke,T:Ge,X:yt,Ja:At,La:_t,Qa:Mt,Va:Wt,Wa:Si,eb:Ai,jb:Ci,f:Ti,e:$t,yb:_i,zb:Vt,Ab:Yt,Bb:ki,Db:Di,Gb:xr}=Pe.instance.exports;ae=$t;const ur=(()=>{let Xi=0,Pi=0,$r=0,ar=0;return fr=>{$r&&(ue(ar),ue(Xi),Pi+=$r,$r=Xi=0),Xi||(Pi+=128,Xi=Ie(Pi));const Nr=fr.length+7&-8;let an=Xi;Nr>=Pi&&($r=Nr,an=ar=Ie(Nr));for(let on=0;on<fr.length;on++)ee[an+on]=fr[on];return an}})();return fe(),Ti(),{memory:$t,_free:ue,_malloc:Ie,Mesh:class{constructor(){this.ptr=ke()}destroy(){Ge(this.ptr)}},Decoder:class{constructor(){this.ptr=At()}destroy(){Ci(this.ptr)}DecodeArrayToMesh(Xi,Pi,$r){const ar=ur(Xi),fr=_t(this.ptr,ar,Pi,$r.ptr);return!!yt(fr)}GetAttributeByUniqueId(Xi,Pi){return{ptr:Mt(this.ptr,Xi.ptr,Pi)}}GetTrianglesUInt16Array(Xi,Pi,$r){Wt(this.ptr,Xi.ptr,Pi,$r)}GetTrianglesUInt32Array(Xi,Pi,$r){Si(this.ptr,Xi.ptr,Pi,$r)}GetAttributeDataArrayForAllPoints(Xi,Pi,$r,ar,fr){Ai(this.ptr,Xi.ptr,Pi.ptr,$r,ar,fr)}},DT_INT8:_i(),DT_UINT8:Vt(),DT_INT16:Yt(),DT_UINT16:ki(),DT_UINT32:Di(),DT_FLOAT32:xr()}})}(fetch(L2())),Nm.then($=>{Ud=$,Nm=void 0}))}()),H&&k.push(function(){if(Y_)return;const $=function(ee){let ae;const fe=WebAssembly.instantiateStreaming(ee,{}).then(Pe=>{ae=Pe.instance,ae.exports.__wasm_call_ctors()}),ve={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Fe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:fe,supported:!0,decodeGltfBuffer(Pe,ue,Ie,ke,Ge,yt){(function(At,_t,Mt,Wt,Si,Ai,Ci){const Ti=At.exports.sbrk,$t=Wt+3&-4,_i=Ti($t*Si),Vt=Ti(Ai.length),Yt=new Uint8Array(At.exports.memory.buffer);Yt.set(Ai,Vt);const ki=_t(_i,Wt,Si,Vt,Ai.length);if(ki===0&&Ci&&Ci(_i,$t,Si),Mt.set(Yt.subarray(_i,_i+Wt*Si)),Ti(_i-Ti(0)),ki!==0)throw new Error(`Malformed buffer data: ${ki}`)})(ae,ae.exports[Fe[Ge]],Pe,ue,Ie,ke,ae.exports[ve[yt]])}}}(fetch(M2()));return $.ready.then(()=>{Y_=$})}()),m)for(let $=0;$<m.length;$++)k.push(xL(m[$],d,$,o));return(k.length?Promise.all(k):Promise.resolve()).then(()=>{if(z&&v)for(const{primitives:$}of v)for(const ee of $)yL(ee,d);if(H&&v&&T)for(const $ of T)vL($,d);return d})})}class z2{constructor(i){this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.hasPattern=!1,this.worldview=i.worldview}updateFootprints(i,o){}prepare(){return function(){if(K_!=null||F2!=null)return null;if(Og!=null)return Og;const i=fetch(ds.BUILDING_GEN_URL);return Og=function(o){let d,f,m,v;function C(){d=new Uint8Array(v.buffer),f=new Int32Array(v.buffer),m=new Float32Array(v.buffer)}function T(){throw new Error("Unexpected BuildingGen error.")}const F=()=>{},k={a:{a:T,f:function(z){const H=d.length,$=Math.max(z>>>0,Math.ceil(1.2*H)),ee=Math.ceil(($-H)/65536);try{return v.grow(ee),C(),!0}catch{return!1}},g:T,b:F,c:F,d:F,e:F}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,k):o.then(z=>z.arrayBuffer()).then(z=>WebAssembly.instantiate(z,k))).then(z=>{const H=z.instance.exports;return(0,H.g)(),v=H.f,C(),new gL({setStyle:H.h,setAOOptions:H.i,setMetricOptions:H.j,setFacadeOptions:H.k,addFeature:H.l,addFacade:H.m,generateMesh:H.n,getLastError:H.o,getMeshCount:H.p,getPositionsPtr:H.q,getPositionsLength:H.r,getNormalsPtr:H.s,getNormalsLength:H.t,getColorsPtr:H.u,getColorsLength:H.v,getAOPtr:H.w,getAOLength:H.x,getIndicesPtr:H.y,getIndicesLength:H.z,getBuildingPart:H.A,getRingCount:H.B,getRingPtr:H.C,getRingLength:H.D,free:H.E,malloc:H.F,heapU8:d,heap32:f,heapF32:m})})}(i).then(o=>(Og=null,K_=o,K_)).catch(o=>{Yr("Could not load building-gen"),Og=null,F2=o}),Og}()}populate(i,o,d,f){}update(i,o,d,f,m,v,C){}isEmpty(){return!1}uploadPending(){return!1}upload(i){}destroy(){}getHeightAtTileCoord(i,o){return{height:Number.NEGATIVE_INFINITY,hidden:!0}}}let N2,j2;Zi(z2,"BuildingBucket",{omit:["layers"]});const bL=On([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),wL=On([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:BL}=bL,CL=On([{name:"a_packed",components:3,type:"Float32"}]),{members:SL}=CL,EL=On([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:IL}=EL;class H2{constructor(i,o){this.width=i,this.height=o,this.nextRow=0,this.image=new sp({width:i,height:o}),this.positions={},this.uploaded=!1}getDash(i,o){const d=this.getKey(i,o);return this.positions[d]}trim(){const i=this.width,o=this.height=Fi(this.nextRow);this.image.resize({width:i,height:o})}getKey(i,o){return i.join(",")+o}getDashRanges(i,o,d){const f=[];let m=i.length%2==1?-i[i.length-1]*d:0,v=i[0]*d,C=!0;f.push({left:m,right:v,isDash:C,zeroLength:i[0]===0});let T=i[0];for(let F=1;F<i.length;F++){C=!C;const k=i[F];m=T*d,T+=k,v=T*d,f.push({left:m,right:v,isDash:C,zeroLength:k===0})}return f}addRoundDash(i,o,d){const f=o/2;for(let m=-d;m<=d;m++){const v=this.width*(this.nextRow+d+m);let C=0,T=i[C];for(let F=0;F<this.width;F++){F/T.right>1&&(T=i[++C]);const k=Math.abs(F-T.left),z=Math.abs(F-T.right),H=Math.min(k,z);let $;const ee=m/d*(f+1);if(T.isDash){const ae=f-Math.abs(ee);$=Math.sqrt(H*H+ae*ae)}else $=f-Math.sqrt(H*H+ee*ee);this.image.data[v+F]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(i,o){for(let T=i.length-1;T>=0;--T){const F=i[T],k=i[T+1];F.zeroLength?i.splice(T,1):k&&k.isDash===F.isDash&&(k.left=F.left,i.splice(T,1))}const d=i[0],f=i[i.length-1];d.isDash===f.isDash&&(d.left=f.left-this.width,f.right=d.right+this.width);const m=this.width*this.nextRow;let v=0,C=i[v];for(let T=0;T<this.width;T++){T/C.right>1&&(C=i[++v]);const F=Math.abs(T-C.left),k=Math.abs(T-C.right),z=Math.min(F,k);this.image.data[m+T]=Math.max(0,Math.min(255,(C.isDash?z:-z)+o+128))}}addDash(i,o){const d=this.getKey(i,o);if(this.positions[d])return this.positions[d];const f=o==="round",m=f?7:0,v=2*m+1;if(this.nextRow+v>this.height)return Yr("LineAtlas out of space"),null;i.length===0&&i.push(1);let C=0;for(let k=0;k<i.length;k++)i[k]<0&&(Yr("Negative value is found in line dasharray, replacing values with 0"),i[k]=0),C+=i[k];if(C!==0){const k=this.width/C,z=this.getDashRanges(i,this.width,k);f?this.addRoundDash(z,k,m):this.addRegularDash(z,o==="square"?.5*k:0)}const T=this.nextRow+m;this.nextRow+=v;const F={tl:[T,m],br:[C,0]};return this.positions[d]=F,F}}Zi(H2,"LineAtlas");const TL=ln.VectorTileFeature.types,FL=Math.cos(Math.PI/180*37.5),LL=Math.cos(Math.PI/180*5);class $_{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new BA,this.layoutVertexArray2=new Zu,this.patternVertexArray=new Zu,this.indexArray=new Jo,this.programConfigurations=new p(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new Gs,this.maxLineLength=0,this.zOffsetVertexArray=new Zu,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:wi/64,this.worldview=i.worldview}updateFootprints(i,o){}populate(i,o,d,f){this.hasPattern=k_("line",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Qt(d);const v=this.layers[0].layout.get("line-elevation-reference");if(v==="hd-road-markup")this.elevationType="road";else{const H=this.layers[0].layout.get("line-z-offset"),$=H.isConstant()&&!H.constantOr(0);this.elevationType=v!=="sea"&&v!=="ground"&&$?"none":"offset",this.elevationType==="offset"&&v==="none"&&Yr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const C=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&C!==void 0;const T=[];for(const{feature:H,id:$,index:ee,sourceLayerIndex:ae}of i){const fe=this.layers[0]._featureFilter.needGeometry,ve=Ki(H,fe);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),ve,d))continue;const Fe=m?m.evaluate(ve,{},d):void 0,Pe={id:$,properties:H.properties,type:H.type,sourceLayerIndex:ae,index:ee,geometry:fe?ve.geometry:tr(H,d,f),patterns:{},sortKey:Fe};T.push(Pe)}m&&T.sort((H,$)=>H.sortKey-$.sortKey);const{lineAtlas:F,featureIndex:k}=o,z=this.addConstantDashes(F);for(const H of T){const{geometry:$,index:ee,sourceLayerIndex:ae}=H;if(z&&this.addFeatureDashes(H,F),this.hasPattern){const fe=R_("line",this.layers,H,this.zoom,this.pixelRatio,o);this.patternFeatures.push(fe)}else this.addFeature(H,$,ee,d,F.positions,o.availableImages,o.brightness,o.elevationFeatures);k.insert(i[ee].feature,$,ee,ae,this.index)}}addConstantDashes(i){let o=!1;for(const d of this.layers){const f=d.paint.get("line-dasharray").value,m=d.layout.get("line-cap").value;if(f.kind!=="constant"||m.kind!=="constant")o=!0;else{const v=m.value,C=f.value;if(!C)continue;i.addDash(C,v)}}return o}addFeatureDashes(i,o){const d=this.zoom;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(m.kind==="constant"&&v.kind==="constant")continue;let C,T;if(m.kind==="constant"){if(C=m.value,!C)continue}else C=m.evaluate({zoom:d},i);T=v.kind==="constant"?v.value:v.evaluate({zoom:d},i),o.addDash(C,T),i.patterns[f.id]=[o.getKey(C,T)]}}update(i,o,d,f,m,v,C,T){this.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,T)}addFeatures(i,o,d,f,m,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,d,f,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,SL)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,IL)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,wL.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,BL),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,d,f,m,v,C,T){const F=this.layers[0].layout,k=F.get("line-join").evaluate(i,{}),z=F.get("line-cap").evaluate(i,{}),H=F.get("line-miter-limit"),$=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i,this.zOffsetValue=F.get("line-z-offset").value;const ee=this.layers[0].paint.get("line-width").value;if(ee.kind!=="constant"&&ee.isLineProgressConstant===!1&&(this.variableWidthValue=ee),this.elevationType==="road"){const ae=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,o,f,T,k,z,H,$)){const[fe,ve]=this.clipRuntimeLinesToTile(o,1);for(let Fe=0;Fe<fe.length;Fe++){const Pe=fe[Fe],ue=ve[Fe],Ie={progress:{min:ue.progress.min,max:ue.progress.max},nextDir:this.computeSegNextDir(ue,Pe),prevDir:this.computeSegPrevDir(ue,Pe)};this.addLine(Pe,i,f,k,z,H,$,Ie)}this.fillNonElevatedRoadSegment(ae)}}else for(const ae of o)this.addLine(ae,i,f,k,z,H,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,m,v,f,C,void 0,this.worldview)}computeSegNextDir(i,o){return i.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(i,o){return o[1].sub(i.prevPoint).unit()}clipLinesToTile(i,o){return Sv(i,-o,-o,wi+o,wi+o)}clipRuntimeLinesToTile(i,o){const d=[];return[Sv(i,-o,-o,wi+o,wi+o,d),d]}addElevatedRoadFeature(i,o,d,f,m,v,C,T){const F=[],k=Ht.getElevationFeature(i,f);if(k){const z=this.clipLinesToTile(o,1),H=this.prepareElevatedLines(z,k,d);for(const $ of H)F.push({geometry:$,elevation:k,elevationTileID:d,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(F.length===0)return!1;for(const z of F){const H=this.layoutVertexArray.length;this.addLine(z.geometry,i,d,m,v,C,T);const $=new si(d,z.elevationTileID);if(z.elevation)for(let ee=H;ee<this.layoutVertexArray.length;ee++){const ae=new qt(this.layoutVertexArray.int16[6*ee]>>1,this.layoutVertexArray.int16[6*ee+1]>>1),fe=$.pointElevation(ae,z.elevation,.05);this.updateHeightRange(fe),this.zOffsetVertexArray.emplaceBack(fe,0,0)}else this.fillNonElevatedRoadSegment(H)}return!0}prepareElevatedLines(i,o,d){if(o.constantHeight!=null)return i;const f=[],m=1/Qt(d);for(const v of i)AL(v,new gt(o,m),0,f);return f}fillNonElevatedRoadSegment(i){for(let o=i;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,o,d,f,m,v,C,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const F=f==="none";this.patternJoinNone=this.hasPattern&&F,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const k=T&&T.progress.min>0,z=T&&T.progress.max<1;if(this.lineClips){let yt={min:this.lineClips.start,max:this.lineClips.end},At=1;if(T){const Wt=this.lineClips.end-this.lineClips.start;yt=function(Si,Ai,Ci){return{min:vc(Si.min,Ai,Ci),max:vc(Si.max,Ai,Ci)}}(T.progress,{min:0,max:1},yt),Wt>0&&(At=(yt.max-yt.min)/Wt)}const _t=+o.properties.mapbox_clip_feature_len,Mt=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(_t)||Number.isNaN(Mt)){for(let Si=0;Si<i.length-1;Si++)this.totalDistance+=i[Si].dist(i[Si+1]);const Wt=this.totalDistance/(yt.max-yt.min);this.totalFeatureLength=Number.isFinite(Wt)?Wt:0,this.lineClips.start=yt.min,this.lineClips.end=yt.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=_t,this.distance=Mt*At,this.lineClips.start=yt.min,this.lineClips.end=yt.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const H=TL[o.type]==="Polygon";let $=i.length;for(;$>=2&&i[$-1].equals(i[$-2]);)$--;let ee=0;for(;ee<$-1&&i[ee].equals(i[ee+1]);)ee++;if($<(H?3:2))return;f==="bevel"&&(v=1.05);const ae=this.segments.prepareSegment(10*$,this.layoutVertexArray,this.indexArray);let fe,ve,Fe,Pe,ue,Ie,ke,Ge;T&&T.prevDir&&(Ie=T.prevDir.perp()),T&&T.nextDir&&(ke=T.nextDir.perp()),this.e1=this.e2=-1,H&&(fe=i[$-2],ue=i[ee].sub(fe)._unit()._perp());for(let yt=ee;yt<$;yt++){if(Fe=yt===$-1?H?i[ee+1]:void 0:i[yt+1],Fe&&i[yt].equals(Fe))continue;ue&&(Pe=ue),fe&&(ve=fe),fe=i[yt],Ge=this.evaluateLineProgressFeatures(ve?ve.dist(fe):0),ue=Fe?Fe.sub(fe)._unit()._perp():Pe,Pe=Pe||ue;const At=ve&&Fe;let _t=At?f:H||F?"butt":m;const Mt=Pe.x*ue.x+Pe.y*ue.y;if(F){const Vt=function(Yt){if(Yt.patternJoinNone){const ki=Yt.segmentPoints.length/2,Di=Yt.lineSoFar-Yt.segmentStart;for(let xr=0;xr<ki;++xr){const ur=Yt.segmentPoints[2*xr+1],Xi=Math.round(Yt.segmentPoints[2*xr])+.5+.25*ur;Yt.patternVertexArray.emplaceBack(Xi,Di,Yt.segmentStart),Yt.patternVertexArray.emplaceBack(Xi,Di,Yt.segmentStart)}Yt.segmentPoints.length=0}Yt.e1=Yt.e2=-1};if(At&&Mt<LL){this.updateDistance(ve,fe),this.addCurrentVertex(fe,Pe,1,1,ae,Ge),Vt(this),this.addCurrentVertex(fe,ue,-1,-1,ae,Ge);continue}if(ve){if(!Fe){this.updateDistance(ve,fe),this.addCurrentVertex(fe,Pe,1,1,ae,Ge),Vt(this);continue}_t="miter"}}let Wt=Pe.add(ue);Wt.x===0&&Wt.y===0||Wt._unit();const Si=Wt.x*ue.x+Wt.y*ue.y,Ai=Si!==0?1/Si:1/0,Ci=2*Math.sqrt(2-2*Si),Ti=Si<FL&&ve&&Fe,$t=Pe.x*ue.y-Pe.y*ue.x>0,_i=this.overscaling<=16?15*wi/(512*this.overscaling):0;if(At&&_t==="round"){if(Ai<C)_t="miter";else if(Ai<=2){const Vt=Z_(fe,-10,wi+10);_t=this.elevationType==="offset"&&(Vt||this.hasCrossSlope)?"miter":"fakeround"}}if(_t==="miter"&&Ai>v&&(_t="bevel"),_t==="bevel"&&(Ai>2&&(_t="flipbevel"),Ai<v&&(_t="miter")),ve&&!(_t==="miter"&&Ti)&&this.updateDistance(ve,fe),_t==="miter")if(Ti){const Vt=fe.dist(ve);if(Vt>2*_i){const ki=fe.sub(fe.sub(ve)._mult(_i/Vt)._round());this.updateDistance(ve,ki),this.addCurrentVertex(ki,Pe,0,0,ae,Ge),ve=ki}this.updateDistance(ve,fe),Wt._mult(Ai),this.addCurrentVertex(fe,Wt,0,0,ae,Ge);const Yt=fe.dist(Fe);if(Yt>2*_i){const ki=fe.add(Fe.sub(fe)._mult(_i/Yt)._round());this.updateDistance(fe,ki),this.addCurrentVertex(ki,ue,0,0,ae,Ge),fe=ki}}else Wt._mult(Ai),this.addCurrentVertex(fe,Wt,0,0,ae,Ge);else if(_t==="flipbevel"){if(Ai>100)Wt=ue.mult(-1);else{const Vt=Ai*Pe.add(ue).mag()/Pe.sub(ue).mag();Wt._perp()._mult(Vt*($t?-1:1))}this.addCurrentVertex(fe,Wt,0,0,ae,Ge),this.addCurrentVertex(fe,Wt.mult(-1),0,0,ae,Ge)}else if(_t==="bevel"||_t==="fakeround"){Ge!=null&&ve&&this.addCurrentVertex(fe,ke||Pe,-1,-1,ae,Ge);const Vt=fe.dist(ve)<=2*_i&&_t!=="bevel",Yt=Wt.mult($t?1:-1);Yt._mult(Ai);const ki=ue.mult($t?-1:1),Di=Pe.mult($t?-1:1),xr=this.evaluateLineProgressFeatures(this.distance);if(Ge==null&&(this.addHalfVertex(fe,Yt.x,Yt.y,!1,!$t,0,ae,xr),Vt||this.addHalfVertex(fe,Yt.x+2*Di.x,Yt.y+2*Di.y,!1,$t,0,ae,xr)),_t==="fakeround"){const ur=Math.round(180*Ci/Math.PI/20);this.addHalfVertex(fe,Di.x,Di.y,!1,$t,0,ae,xr);for(let Xi=0;Xi<ur;Xi++){let Pi=Xi/ur;if(Pi!==.5){const ar=Pi-.5;Pi+=Pi*ar*(Pi-1)*((1.0904+Mt*(Mt*(3.55645-1.43519*Mt)-3.2452))*ar*ar+(.848013+Mt*(.215638*Mt-1.06021)))}const $r=ki.sub(Di)._mult(Pi)._add(Di)._unit();this.addHalfVertex(fe,$r.x,$r.y,!1,$t,0,ae,xr)}this.addHalfVertex(fe,ki.x,ki.y,!1,$t,0,ae,xr)}Vt||Ge!=null||this.addHalfVertex(fe,Yt.x+2*ki.x,Yt.y+2*ki.y,!1,$t,0,ae,xr),Ge!=null&&Fe&&this.addCurrentVertex(fe,Ie||ue,1,1,ae,Ge)}else if(_t==="butt")this.addCurrentVertex(fe,Wt,0,0,ae,Ge);else if(_t==="square"){if(!ve){const Vt=k?0:-1;this.addCurrentVertex(fe,Wt,Vt,Vt,ae,Ge)}if(this.addCurrentVertex(fe,Wt,0,0,ae,Ge),ve){const Vt=z?0:1;this.addCurrentVertex(fe,Wt,Vt,Vt,ae,Ge)}}else if(_t==="round"){if(ve){const Vt=!At&&ke?ke:Pe;this.addCurrentVertex(fe,Vt,0,0,ae,Ge),!At&&z||this.addCurrentVertex(fe,Vt,1,1,ae,Ge,!0)}if(Fe){const Vt=!At&&Ie?Ie:ue;!At&&k||this.addCurrentVertex(fe,Vt,-1,-1,ae,Ge,!0),this.addCurrentVertex(fe,Vt,0,0,ae,Ge)}}}}addVerticesTo(i,o,d,f,m,v,C,T,F,k){const z=(o.w-i.w)/this.tessellationStep|0;let H=0;const $=this.scaledDistance;if(z>1){this.lineSoFar=i.w;const ae=(o.x-i.x)/z,fe=(o.y-i.y)/z,ve=(o.z-i.z)/z,Fe=(o.w-i.w)/z;for(let Pe=1;Pe<z;++Pe){i.x+=ae,i.y+=fe,i.z+=ve,this.lineSoFar+=Fe,H+=Fe;const ue=this.evaluateLineProgressFeatures(this.prevDistance+H);this.scaledDistance=(this.prevDistance+H)/this.totalDistance,this.addHalfVertex(i,d,f,k,!1,C,F,ue),this.addHalfVertex(i,m,v,k,!0,-T,F,ue)}}this.lineSoFar=o.w,this.scaledDistance=$;const ee=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,d,f,k,!1,C,F,ee),this.addHalfVertex(o,m,v,k,!0,-T,F,ee)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):Yr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(i,o,d,f,m,v,C=!1){const T=o.x+o.y*d,F=o.y-o.x*d,k=o.y*f-o.x,z=-o.y-o.x*f;if(v!=null){const H=this.elevationType==="offset",$=-10,ee=wi+10,ae=v.zOffset,fe=new w2(i.x,i.y,ae,this.lineSoFar),ve=!!H&&Z_(i,$,ee),Fe=this.lineSoFar,Pe=this.distance;if(this.currentVertex)if(ve){const ue=this.currentVertexIsOutside,Ie=this.currentVertex,ke=new w2(i.x,i.y,ae,this.lineSoFar);if(C2(Ie,ke,$,ee),!Z_(ke,$,ee)){if(ue){this.e1=this.e2=-1,this.distance-=Ie.dist(fe),this.lineSoFar=Ie.w;const Ge=this.evaluateLineProgressFeatures(Ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ie,T,F,C,!1,d,m,Ge),this.addHalfVertex(Ie,k,z,C,!0,-f,m,Ge),this.prevDistance=this.distance}this.distance=this.prevDistance+Ie.dist(ke),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ie,ke,T,F,k,z,d,f,m,C),this.distance=Pe,this.scaledDistance=this.distance/this.totalDistance}}else{const ue=this.currentVertex;if(this.currentVertexIsOutside){C2(ue,fe,$,ee),this.e1=this.e2=-1,this.distance-=ue.dist(fe),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ue.w;const Ie=this.evaluateLineProgressFeatures(ue.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ue,T,F,C,!1,d,m,Ie),this.addHalfVertex(ue,k,z,C,!0,-f,m,Ie),this.prevDistance=this.distance,this.distance=Pe,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ue,fe,T,F,k,z,d,f,m,C)}else ve||(this.addHalfVertex(i,T,F,C,!1,d,m,v),this.addHalfVertex(i,k,z,C,!0,-f,m,v));this.currentVertex=fe,this.currentVertexIsOutside=ve,this.lineSoFar=Fe}else this.addHalfVertex(i,T,F,C,!1,d,m,v),this.addHalfVertex(i,k,z,C,!0,-f,m,v)}addHalfVertex({x:i,y:o},d,f,m,v,C,T,F){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,C)),this.layoutVertexArray.emplaceBack((i<<1)+(m?1:0),(o<<1)+(v?1:0),Math.round(63*d)+128,Math.round(63*f)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const z=Er(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,z)}const k=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),T.primitiveLength++),v?this.e2=k:this.e1=k,F!=null&&this.zOffsetVertexArray.emplaceBack(F.zOffset,F.variableWidth,F.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,o){this.prevDistance=this.distance,this.distance+=i.dist(o),this.updateScaledDistance()}}function Z_(l,i,o){return l.x<i||l.x>o||l.y<i||l.y>o}let Q2,V2;function G2(l,i,o){return i*(wi/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}Zi($_,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const W2=(l,i,o)=>(1-o)*l+o*i;function X2(l,i){return 1/G2(l,1,i.tileZoom)}function Y2(l,i,o,d){return l.translatePosMatrix(d||i.tileID.projMatrix,i,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const K2=l=>{const i=[];q2(l)&&i.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const o=l.paint.get("line-trim-offset");o[0]===0&&o[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const d=l.layout.get("line-join").constantOr("miter")==="none",f=!!l.paint.get("line-pattern").constantOr(1);return d&&f&&i.push("LINE_JOIN_NONE"),i};function q2(l){const i=l.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let J_;const $2=()=>J_||(J_={layout:Q2||(Q2=new Ns({"line-cap":new Gi(Lt.layout_line["line-cap"]),"line-join":new Gi(Lt.layout_line["line-join"]),"line-miter-limit":new Ei(Lt.layout_line["line-miter-limit"]),"line-round-limit":new Ei(Lt.layout_line["line-round-limit"]),"line-sort-key":new Gi(Lt.layout_line["line-sort-key"]),"line-z-offset":new Gi(Lt.layout_line["line-z-offset"]),"line-elevation-reference":new Ei(Lt.layout_line["line-elevation-reference"]),"line-cross-slope":new Ei(Lt.layout_line["line-cross-slope"]),visibility:new Ei(Lt.layout_line.visibility),"line-width-unit":new Ei(Lt.layout_line["line-width-unit"])})),paint:V2||(V2=new Ns({"line-opacity":new Gi(Lt.paint_line["line-opacity"]),"line-color":new Gi(Lt.paint_line["line-color"]),"line-translate":new Ei(Lt.paint_line["line-translate"]),"line-translate-anchor":new Ei(Lt.paint_line["line-translate-anchor"]),"line-width":new Gi(Lt.paint_line["line-width"]),"line-gap-width":new Gi(Lt.paint_line["line-gap-width"]),"line-offset":new Gi(Lt.paint_line["line-offset"]),"line-blur":new Gi(Lt.paint_line["line-blur"]),"line-dasharray":new Gi(Lt.paint_line["line-dasharray"]),"line-pattern":new Gi(Lt.paint_line["line-pattern"]),"line-pattern-cross-fade":new Ei(Lt.paint_line["line-pattern-cross-fade"]),"line-gradient":new Yu(Lt.paint_line["line-gradient"]),"line-trim-offset":new Ei(Lt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ei(Lt.paint_line["line-trim-fade-range"]),"line-trim-color":new Ei(Lt.paint_line["line-trim-color"]),"line-emissive-strength":new Ei(Lt.paint_line["line-emissive-strength"]),"line-border-width":new Gi(Lt.paint_line["line-border-width"]),"line-border-color":new Gi(Lt.paint_line["line-border-color"]),"line-occlusion-opacity":new Ei(Lt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},J_);class ML extends Gi{possiblyEvaluate(i,o){return o=new $n(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition,worldview:o.worldview}),super.possiblyEvaluate(i,o)}evaluate(i,o,d,f){return o=Ut({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,d,f)}}let Hm;function Z2(l,i){return i>0?i+2*l:l}const PL=On([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),kL=On([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),RL=On([{name:"a_projected_pos",components:4,type:"Float32"}],4);On([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const DL=On([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),OL=On([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),UL=On([{name:"a_texb",components:2,type:"Uint16"}]),zL=On([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),NL=On([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);On([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const J2=On([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jL=On([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);On([{name:"triangle",components:3,type:"Uint16"}]),On([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),On([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),On([{type:"Float32",name:"offsetX"}]),On([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var rl=24;function HL(l,i,o){return l.sections.forEach(d=>{d.text=function(f,m,v){const C=m.layout.get("text-transform").evaluate(v,{});return C==="uppercase"?f=f.toLocaleUpperCase():C==="lowercase"&&(f=f.toLocaleLowerCase()),$c.applyArabicShaping&&(f=$c.applyArabicShaping(f)),f}(d.text,i,o)}),l}const Qm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function QL(l){return l==="︶"||l==="﹈"||l==="︸"||l==="﹄"||l==="﹂"||l==="︾"||l==="︼"||l==="︺"||l==="︘"||l==="﹀"||l==="︐"||l==="︓"||l==="︔"||l==="｀"||l==="￣"||l==="︑"||l==="︒"}function VL(l){return l==="︵"||l==="﹇"||l==="︷"||l==="﹃"||l==="﹁"||l==="︽"||l==="︻"||l==="︹"||l==="︗"||l==="︿"}var eB,ex,tB,tx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function GL(){return eB||(eB=1,tx.read=function(l,i,o,d,f){var m,v,C=8*f-d-1,T=(1<<C)-1,F=T>>1,k=-7,z=o?f-1:0,H=o?-1:1,$=l[i+z];for(z+=H,m=$&(1<<-k)-1,$>>=-k,k+=C;k>0;m=256*m+l[i+z],z+=H,k-=8);for(v=m&(1<<-k)-1,m>>=-k,k+=d;k>0;v=256*v+l[i+z],z+=H,k-=8);if(m===0)m=1-F;else{if(m===T)return v?NaN:1/0*($?-1:1);v+=Math.pow(2,d),m-=F}return($?-1:1)*v*Math.pow(2,m-d)},tx.write=function(l,i,o,d,f,m){var v,C,T,F=8*m-f-1,k=(1<<F)-1,z=k>>1,H=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=d?0:m-1,ee=d?1:-1,ae=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(C=isNaN(i)?1:0,v=k):(v=Math.floor(Math.log(i)/Math.LN2),i*(T=Math.pow(2,-v))<1&&(v--,T*=2),(i+=v+z>=1?H/T:H*Math.pow(2,1-z))*T>=2&&(v++,T/=2),v+z>=k?(C=0,v=k):v+z>=1?(C=(i*T-1)*Math.pow(2,f),v+=z):(C=i*Math.pow(2,z-1)*Math.pow(2,f),v=0));f>=8;l[o+$]=255&C,$+=ee,C/=256,f-=8);for(v=v<<f|C,F+=f;F>0;l[o+$]=255&v,$+=ee,v/=256,F-=8);l[o+$-ee]|=128*ae}),tx}function iB(){if(tB)return ex;tB=1,ex=i;var l=GL();function i(ue){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ue)?ue:new Uint8Array(ue||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,d=1/o,f=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ue){return ue.type===i.Bytes?ue.readVarint()+ue.pos:ue.pos+1}function v(ue,Ie,ke){return ke?4294967296*Ie+(ue>>>0):4294967296*(Ie>>>0)+(ue>>>0)}function C(ue,Ie,ke){var Ge=Ie<=16383?1:Ie<=2097151?2:Ie<=268435455?3:Math.floor(Math.log(Ie)/(7*Math.LN2));ke.realloc(Ge);for(var yt=ke.pos-1;yt>=ue;yt--)ke.buf[yt+Ge]=ke.buf[yt]}function T(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeVarint(ue[ke])}function F(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeSVarint(ue[ke])}function k(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeFloat(ue[ke])}function z(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeDouble(ue[ke])}function H(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeBoolean(ue[ke])}function $(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeFixed32(ue[ke])}function ee(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeSFixed32(ue[ke])}function ae(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeFixed64(ue[ke])}function fe(ue,Ie){for(var ke=0;ke<ue.length;ke++)Ie.writeSFixed64(ue[ke])}function ve(ue,Ie){return(ue[Ie]|ue[Ie+1]<<8|ue[Ie+2]<<16)+16777216*ue[Ie+3]}function Fe(ue,Ie,ke){ue[ke]=Ie,ue[ke+1]=Ie>>>8,ue[ke+2]=Ie>>>16,ue[ke+3]=Ie>>>24}function Pe(ue,Ie){return(ue[Ie]|ue[Ie+1]<<8|ue[Ie+2]<<16)+(ue[Ie+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(ue,Ie,ke){for(ke=ke||this.length;this.pos<ke;){var Ge=this.readVarint(),yt=Ge>>3,At=this.pos;this.type=7&Ge,ue(yt,Ie,this),this.pos===At&&this.skip(Ge)}return Ie},readMessage:function(ue,Ie){return this.readFields(ue,Ie,this.readVarint()+this.pos)},readFixed32:function(){var ue=ve(this.buf,this.pos);return this.pos+=4,ue},readSFixed32:function(){var ue=Pe(this.buf,this.pos);return this.pos+=4,ue},readFixed64:function(){var ue=ve(this.buf,this.pos)+ve(this.buf,this.pos+4)*o;return this.pos+=8,ue},readSFixed64:function(){var ue=ve(this.buf,this.pos)+Pe(this.buf,this.pos+4)*o;return this.pos+=8,ue},readFloat:function(){var ue=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ue},readDouble:function(){var ue=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ue},readVarint:function(ue){var Ie,ke,Ge=this.buf;return Ie=127&(ke=Ge[this.pos++]),ke<128?Ie:(Ie|=(127&(ke=Ge[this.pos++]))<<7,ke<128?Ie:(Ie|=(127&(ke=Ge[this.pos++]))<<14,ke<128?Ie:(Ie|=(127&(ke=Ge[this.pos++]))<<21,ke<128?Ie:function(yt,At,_t){var Mt,Wt,Si=_t.buf;if(Mt=(112&(Wt=Si[_t.pos++]))>>4,Wt<128||(Mt|=(127&(Wt=Si[_t.pos++]))<<3,Wt<128)||(Mt|=(127&(Wt=Si[_t.pos++]))<<10,Wt<128)||(Mt|=(127&(Wt=Si[_t.pos++]))<<17,Wt<128)||(Mt|=(127&(Wt=Si[_t.pos++]))<<24,Wt<128)||(Mt|=(1&(Wt=Si[_t.pos++]))<<31,Wt<128))return v(yt,Mt,At);throw new Error("Expected varint not more than 10 bytes")}(Ie|=(15&(ke=Ge[this.pos]))<<28,ue,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ue=this.readVarint();return ue%2==1?(ue+1)/-2:ue/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ue=this.readVarint()+this.pos,Ie=this.pos;return this.pos=ue,ue-Ie>=12&&f?function(ke,Ge,yt){return f.decode(ke.subarray(Ge,yt))}(this.buf,Ie,ue):function(ke,Ge,yt){for(var At="",_t=Ge;_t<yt;){var Mt,Wt,Si,Ai=ke[_t],Ci=null,Ti=Ai>239?4:Ai>223?3:Ai>191?2:1;if(_t+Ti>yt)break;Ti===1?Ai<128&&(Ci=Ai):Ti===2?(192&(Mt=ke[_t+1]))==128&&(Ci=(31&Ai)<<6|63&Mt)<=127&&(Ci=null):Ti===3?(Wt=ke[_t+2],(192&(Mt=ke[_t+1]))==128&&(192&Wt)==128&&((Ci=(15&Ai)<<12|(63&Mt)<<6|63&Wt)<=2047||Ci>=55296&&Ci<=57343)&&(Ci=null)):Ti===4&&(Wt=ke[_t+2],Si=ke[_t+3],(192&(Mt=ke[_t+1]))==128&&(192&Wt)==128&&(192&Si)==128&&((Ci=(15&Ai)<<18|(63&Mt)<<12|(63&Wt)<<6|63&Si)<=65535||Ci>=1114112)&&(Ci=null)),Ci===null?(Ci=65533,Ti=1):Ci>65535&&(Ci-=65536,At+=String.fromCharCode(Ci>>>10&1023|55296),Ci=56320|1023&Ci),At+=String.fromCharCode(Ci),_t+=Ti}return At}(this.buf,Ie,ue)},readBytes:function(){var ue=this.readVarint()+this.pos,Ie=this.buf.subarray(this.pos,ue);return this.pos=ue,Ie},readPackedVarint:function(ue,Ie){if(this.type!==i.Bytes)return ue.push(this.readVarint(Ie));var ke=m(this);for(ue=ue||[];this.pos<ke;)ue.push(this.readVarint(Ie));return ue},readPackedSVarint:function(ue){if(this.type!==i.Bytes)return ue.push(this.readSVarint());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readSVarint());return ue},readPackedBoolean:function(ue){if(this.type!==i.Bytes)return ue.push(this.readBoolean());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readBoolean());return ue},readPackedFloat:function(ue){if(this.type!==i.Bytes)return ue.push(this.readFloat());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readFloat());return ue},readPackedDouble:function(ue){if(this.type!==i.Bytes)return ue.push(this.readDouble());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readDouble());return ue},readPackedFixed32:function(ue){if(this.type!==i.Bytes)return ue.push(this.readFixed32());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readFixed32());return ue},readPackedSFixed32:function(ue){if(this.type!==i.Bytes)return ue.push(this.readSFixed32());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readSFixed32());return ue},readPackedFixed64:function(ue){if(this.type!==i.Bytes)return ue.push(this.readFixed64());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readFixed64());return ue},readPackedSFixed64:function(ue){if(this.type!==i.Bytes)return ue.push(this.readSFixed64());var Ie=m(this);for(ue=ue||[];this.pos<Ie;)ue.push(this.readSFixed64());return ue},skip:function(ue){var Ie=7&ue;if(Ie===i.Varint)for(;this.buf[this.pos++]>127;);else if(Ie===i.Bytes)this.pos=this.readVarint()+this.pos;else if(Ie===i.Fixed32)this.pos+=4;else{if(Ie!==i.Fixed64)throw new Error("Unimplemented type: "+Ie);this.pos+=8}},writeTag:function(ue,Ie){this.writeVarint(ue<<3|Ie)},realloc:function(ue){for(var Ie=this.length||16;Ie<this.pos+ue;)Ie*=2;if(Ie!==this.length){var ke=new Uint8Array(Ie);ke.set(this.buf),this.buf=ke,this.length=Ie}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ue){this.realloc(4),Fe(this.buf,ue,this.pos),this.pos+=4},writeSFixed32:function(ue){this.realloc(4),Fe(this.buf,ue,this.pos),this.pos+=4},writeFixed64:function(ue){this.realloc(8),Fe(this.buf,-1&ue,this.pos),Fe(this.buf,Math.floor(ue*d),this.pos+4),this.pos+=8},writeSFixed64:function(ue){this.realloc(8),Fe(this.buf,-1&ue,this.pos),Fe(this.buf,Math.floor(ue*d),this.pos+4),this.pos+=8},writeVarint:function(ue){(ue=+ue||0)>268435455||ue<0?function(Ie,ke){var Ge,yt;if(Ie>=0?(Ge=Ie%4294967296|0,yt=Ie/4294967296|0):(yt=~(-Ie/4294967296),4294967295^(Ge=~(-Ie%4294967296))?Ge=Ge+1|0:(Ge=0,yt=yt+1|0)),Ie>=18446744073709552e3||Ie<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ke.realloc(10),function(At,_t,Mt){Mt.buf[Mt.pos++]=127&At|128,At>>>=7,Mt.buf[Mt.pos++]=127&At|128,At>>>=7,Mt.buf[Mt.pos++]=127&At|128,At>>>=7,Mt.buf[Mt.pos++]=127&At|128,Mt.buf[Mt.pos]=127&(At>>>=7)}(Ge,0,ke),function(At,_t){var Mt=(7&At)<<4;_t.buf[_t.pos++]|=Mt|((At>>>=3)?128:0),At&&(_t.buf[_t.pos++]=127&At|((At>>>=7)?128:0),At&&(_t.buf[_t.pos++]=127&At|((At>>>=7)?128:0),At&&(_t.buf[_t.pos++]=127&At|((At>>>=7)?128:0),At&&(_t.buf[_t.pos++]=127&At|((At>>>=7)?128:0),At&&(_t.buf[_t.pos++]=127&At)))))}(yt,ke)}(ue,this):(this.realloc(4),this.buf[this.pos++]=127&ue|(ue>127?128:0),ue<=127||(this.buf[this.pos++]=127&(ue>>>=7)|(ue>127?128:0),ue<=127||(this.buf[this.pos++]=127&(ue>>>=7)|(ue>127?128:0),ue<=127||(this.buf[this.pos++]=ue>>>7&127))))},writeSVarint:function(ue){this.writeVarint(ue<0?2*-ue-1:2*ue)},writeBoolean:function(ue){this.writeVarint(!!ue)},writeString:function(ue){ue=String(ue),this.realloc(4*ue.length),this.pos++;var Ie=this.pos;this.pos=function(Ge,yt,At){for(var _t,Mt,Wt=0;Wt<yt.length;Wt++){if((_t=yt.charCodeAt(Wt))>55295&&_t<57344){if(!Mt){_t>56319||Wt+1===yt.length?(Ge[At++]=239,Ge[At++]=191,Ge[At++]=189):Mt=_t;continue}if(_t<56320){Ge[At++]=239,Ge[At++]=191,Ge[At++]=189,Mt=_t;continue}_t=Mt-55296<<10|_t-56320|65536,Mt=null}else Mt&&(Ge[At++]=239,Ge[At++]=191,Ge[At++]=189,Mt=null);_t<128?Ge[At++]=_t:(_t<2048?Ge[At++]=_t>>6|192:(_t<65536?Ge[At++]=_t>>12|224:(Ge[At++]=_t>>18|240,Ge[At++]=_t>>12&63|128),Ge[At++]=_t>>6&63|128),Ge[At++]=63&_t|128)}return At}(this.buf,ue,this.pos);var ke=this.pos-Ie;ke>=128&&C(Ie,ke,this),this.pos=Ie-1,this.writeVarint(ke),this.pos+=ke},writeFloat:function(ue){this.realloc(4),l.write(this.buf,ue,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ue){this.realloc(8),l.write(this.buf,ue,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ue){var Ie=ue.length;this.writeVarint(Ie),this.realloc(Ie);for(var ke=0;ke<Ie;ke++)this.buf[this.pos++]=ue[ke]},writeRawMessage:function(ue,Ie){this.pos++;var ke=this.pos;ue(Ie,this);var Ge=this.pos-ke;Ge>=128&&C(ke,Ge,this),this.pos=ke-1,this.writeVarint(Ge),this.pos+=Ge},writeMessage:function(ue,Ie,ke){this.writeTag(ue,i.Bytes),this.writeRawMessage(Ie,ke)},writePackedVarint:function(ue,Ie){Ie.length&&this.writeMessage(ue,T,Ie)},writePackedSVarint:function(ue,Ie){Ie.length&&this.writeMessage(ue,F,Ie)},writePackedBoolean:function(ue,Ie){Ie.length&&this.writeMessage(ue,H,Ie)},writePackedFloat:function(ue,Ie){Ie.length&&this.writeMessage(ue,k,Ie)},writePackedDouble:function(ue,Ie){Ie.length&&this.writeMessage(ue,z,Ie)},writePackedFixed32:function(ue,Ie){Ie.length&&this.writeMessage(ue,$,Ie)},writePackedSFixed32:function(ue,Ie){Ie.length&&this.writeMessage(ue,ee,Ie)},writePackedFixed64:function(ue,Ie){Ie.length&&this.writeMessage(ue,ae,Ie)},writePackedSFixed64:function(ue,Ie){Ie.length&&this.writeMessage(ue,fe,Ie)},writeBytesField:function(ue,Ie){this.writeTag(ue,i.Bytes),this.writeBytes(Ie)},writeFixed32Field:function(ue,Ie){this.writeTag(ue,i.Fixed32),this.writeFixed32(Ie)},writeSFixed32Field:function(ue,Ie){this.writeTag(ue,i.Fixed32),this.writeSFixed32(Ie)},writeFixed64Field:function(ue,Ie){this.writeTag(ue,i.Fixed64),this.writeFixed64(Ie)},writeSFixed64Field:function(ue,Ie){this.writeTag(ue,i.Fixed64),this.writeSFixed64(Ie)},writeVarintField:function(ue,Ie){this.writeTag(ue,i.Varint),this.writeVarint(Ie)},writeSVarintField:function(ue,Ie){this.writeTag(ue,i.Varint),this.writeSVarint(Ie)},writeStringField:function(ue,Ie){this.writeTag(ue,i.Bytes),this.writeString(Ie)},writeFloatField:function(ue,Ie){this.writeTag(ue,i.Fixed32),this.writeFloat(Ie)},writeDoubleField:function(ue,Ie){this.writeTag(ue,i.Fixed64),this.writeDouble(Ie)},writeBooleanField:function(ue,Ie){this.writeVarintField(ue,!!Ie)}},ex}var Fv=ia(iB());const ix=3;function WL(l,i,o){i.glyphs=[],l===1&&o.readMessage(XL,i)}function XL(l,i,o){if(l===3){const{id:d,bitmap:f,width:m,height:v,left:C,top:T,advance:F}=o.readMessage(YL,{});i.glyphs.push({id:d,bitmap:new sp({width:m+2*ix,height:v+2*ix},f),metrics:{width:m,height:v,left:C,top:T,advance:F}})}else l===4?i.ascender=o.readSVarint():l===5&&(i.descender=o.readSVarint())}function YL(l,i,o){l===1?i.id=o.readVarint():l===2?i.bitmap=o.readBytes():l===3?i.width=o.readVarint():l===4?i.height=o.readVarint():l===5?i.left=o.readSVarint():l===6?i.top=o.readSVarint():l===7&&(i.advance=o.readVarint())}const KL=ix,Mu={horizontal:1,vertical:2,horizontalOnly:3};class Vm{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,o){const d=new Vm;return d.scale=i||1,d.fontStack=o,d}static forImage(i){const o=new Vm;return o.image=i,o}}class Ug{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o,d){const f=new Ug;for(let m=0;m<i.sections.length;m++){const v=i.sections[m];v.image?f.addImageSection(v,d):f.addTextSection(v,o)}return f}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(o,d){let f="";for(let m=0;m<o.length;m++){const v=o.charCodeAt(m+1)||null,C=o.charCodeAt(m-1)||null;f+=!d&&(v&&wh(v)&&!Qm[o[m+1]]||C&&wh(C)&&!Qm[o[m-1]])||!Qm[o[m]]?o[m]:Qm[o[m]]}return f}(this.text,i)}trim(){let i=0;for(let d=0;d<this.text.length&&Lv[this.text.charCodeAt(d)];d++)i++;let o=this.text.length;for(let d=this.text.length-1;d>=0&&d>=i&&Lv[this.text.charCodeAt(d)];d--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const d=new Ug;return d.text=this.text.substring(i,o),d.sectionIndex=this.sectionIndex.slice(i,o),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}addTextSection(i,o){this.text+=i.text,this.sections.push(Vm.forText(i.scale,i.fontStack||o));const d=this.sections.length-1;for(let f=0;f<i.text.length;++f)this.sectionIndex.push(d)}addImageSection(i,o){const d=i.image?i.image.getPrimary():null;if(!d)return void Yr("Can't add FormattedSection with an empty image.");d.scaleSelf(o);const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(Vm.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Yr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function rx(l,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae=1){const fe=Ug.fromFeature(l,f,ae);z===Mu.vertical&&fe.verticalizePunctuation(H);let ve=[];const Fe=function(Ge,yt,At,_t,Mt,Wt){if(!Ge)return[];const Si=[],Ai=function(_i,Vt,Yt,ki,Di,xr){let ur=0;for(let Xi=0;Xi<_i.length();Xi++){const Pi=_i.getSection(Xi);ur+=rB(_i.getCodePoint(Xi),Pi,ki,Di,Vt,xr)}return ur/Math.max(1,Math.ceil(ur/Yt))}(Ge,yt,At,_t,Mt,Wt),Ci=Ge.text.indexOf("​")>=0;let Ti=0;for(let _i=0;_i<Ge.length();_i++){const Vt=Ge.getSection(_i),Yt=Ge.getCodePoint(_i);if(Lv[Yt]||(Ti+=rB(Yt,Vt,_t,Mt,yt,Wt)),_i<Ge.length()-1){const ki=!(($t=Yt)<11904||!(Br["Bopomofo Extended"]($t)||Br.Bopomofo($t)||Br["CJK Compatibility Forms"]($t)||Br["CJK Compatibility Ideographs"]($t)||Br["CJK Compatibility"]($t)||Br["CJK Radicals Supplement"]($t)||Br["CJK Strokes"]($t)||Br["CJK Symbols and Punctuation"]($t)||Br["CJK Unified Ideographs Extension A"]($t)||Br["CJK Unified Ideographs"]($t)||Br["Enclosed CJK Letters and Months"]($t)||Br["Halfwidth and Fullwidth Forms"]($t)||Br.Hiragana($t)||Br["Ideographic Description Characters"]($t)||Br["Kangxi Radicals"]($t)||Br["Katakana Phonetic Extensions"]($t)||Br.Katakana($t)||Br["Vertical Forms"]($t)||Br["Yi Radicals"]($t)||Br["Yi Syllables"]($t)));(qL[Yt]||ki||Vt.image)&&Si.push(sB(_i+1,Ti,Ai,Si,$L(Yt,Ge.getCodePoint(_i+1),ki&&Ci),!1))}}var $t;return oB(sB(Ge.length(),Ti,Ai,Si,0,!0))}(fe,F,m,i,d,$),{processBidirectionalText:Pe,processStyledBidirectionalText:ue}=$c;if(Pe&&fe.sections.length===1){const Ge=Pe(fe.toString(),Fe);for(const yt of Ge){const At=new Ug;At.text=yt,At.sections=fe.sections;for(let _t=0;_t<yt.length;_t++)At.sectionIndex.push(0);ve.push(At)}}else if(ue){const Ge=ue(fe.text,fe.sectionIndex,Fe);for(const yt of Ge){const At=new Ug;At.text=yt[0],At.sectionIndex=yt[1],At.sections=fe.sections,ve.push(At)}}else ve=function(Ge,yt){const At=[],_t=Ge.text;let Mt=0;for(const Wt of yt)At.push(Ge.substring(Mt,Wt)),Mt=Wt;return Mt<_t.length&&At.push(Ge.substring(Mt,_t.length)),At}(fe,Fe);const Ie=[],ke={positionedLines:Ie,text:fe.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Ge,yt,At,_t,Mt,Wt,Si,Ai,Ci,Ti,$t,_i){let Vt=0,Yt=0,ki=0;const Di=Ai==="right"?1:Ai==="left"?0:.5;let xr=!1;for(const fr of Mt){const Nr=fr.getSections();for(const an of Nr){if(an.image)continue;const on=yt[an.fontStack];if(on&&(xr=on.ascender!==void 0&&on.descender!==void 0,!xr))break}if(!xr)break}let ur=0;for(const fr of Mt){fr.trim();const Nr=fr.getMaxScale(),an=(Nr-1)*rl,on={positionedGlyphs:[],lineOffset:0};Ge.positionedLines[ur]=on;const _n=on.positionedGlyphs;let un=0;if(!fr.length()){Yt+=Wt,++ur;continue}let xn=0,as=0;for(let Ne=0;Ne<fr.length();Ne++){const Xe=fr.getSection(Ne),Jt=fr.getSectionIndex(Ne),zi=fr.getCodePoint(Ne);let Yi=Xe.scale,Wi=null,or=null,Or=null,Bn=rl,Cn=0;Ci===Mu.vertical&&((Xi=zi)===12312||Xi===12313||Xi===12316||Xi===12540||Xi===12448)&&(Ci=Mu.horizontal);const hn=!(Ci===Mu.horizontal||!$t&&!Xl(zi)||$t&&(Lv[zi]||Yh(zi)));if(Xe.image){const us=_t.get(Xe.image.toString());if(!us)continue;Or=Xe.image,Ge.iconsInText=Ge.iconsInText||!0,or=us.paddedRect;const Os=us.displaySize;Yi=Yi*rl/_i,Wi={width:Os[0],height:Os[1],left:0,top:-3,advance:hn?Os[1]:Os[0],localGlyph:!1},Cn=xr?-Wi.height*Yi:Nr*rl-17-Os[1]*Yi,Bn=Wi.advance;const Sn=(hn?Os[0]:Os[1])*Yi-rl*Nr;Sn>0&&Sn>un&&(un=Sn)}else{const us=At[Xe.fontStack];if(!us)continue;us[zi]&&(or=us[zi]);const Os=yt[Xe.fontStack];if(!Os)continue;const Sn=Os.glyphs[zi];if(!Sn)continue;if(Wi=Sn.metrics,Bn=zi!==8203?rl:0,xr){const so=Os.ascender!==void 0?Math.abs(Os.ascender):0,Hs=Os.descender!==void 0?Math.abs(Os.descender):0,ls=(so+Hs)*Yi;xn<ls&&(xn=ls,as=(so-Hs)/2*Yi),Cn=-so*Yi}else Cn=(Nr-Yi)*rl-17}hn?(Ge.verticalizable=!0,_n.push({glyph:zi,image:Or,x:Vt,y:Yt+Cn,vertical:hn,scale:Yi,localGlyph:Wi.localGlyph,fontStack:Xe.fontStack,sectionIndex:Jt,metrics:Wi,rect:or}),Vt+=Bn*Yi+Ti):(_n.push({glyph:zi,image:Or,x:Vt,y:Yt+Cn,vertical:hn,scale:Yi,localGlyph:Wi.localGlyph,fontStack:Xe.fontStack,sectionIndex:Jt,metrics:Wi,rect:or}),Vt+=Wi.advance*Yi+Ti)}_n.length!==0&&(ki=Math.max(Vt-Ti,ki),xr?aB(_n,Di,un,as,Wt*Nr/2):aB(_n,Di,un,0,Wt/2)),Vt=0;const js=Wt*Nr+un;on.lineOffset=Math.max(un,an),Yt+=js,++ur}var Xi;const Pi=Yt,{horizontalAlign:$r,verticalAlign:ar}=nx(Si);(function(fr,Nr,an,on,_n,un){const xn=(Nr-an)*_n,as=-un*on;for(const js of fr)for(const Ne of js.positionedGlyphs)Ne.x+=xn,Ne.y+=as})(Ge.positionedLines,Di,$r,ar,ki,Pi),Ge.top+=-ar*Pi,Ge.bottom=Ge.top+Pi,Ge.left+=-$r*ki,Ge.right=Ge.left+ki,Ge.hasBaseline=xr}(ke,i,o,d,ve,v,C,T,z,F,H,ee),!function(Ge){for(const yt of Ge)if(yt.positionedGlyphs.length!==0)return!1;return!0}(Ie))return ke}const Lv={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qL={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function rB(l,i,o,d,f,m){if(i.image){const v=d.get(i.image.toString());return v?v.displaySize[0]*i.scale*rl/m+f:0}{const v=o[i.fontStack],C=v&&v.glyphs[l];return C?C.metrics.advance*i.scale+f:0}}function nB(l,i,o,d){const f=Math.pow(l-i,2);return d?l<i?f/2:2*f:f+Math.abs(o)*o}function $L(l,i,o){let d=0;return l===10&&(d-=1e4),o&&(d+=150),l!==40&&l!==65288||(d+=50),i!==41&&i!==65289||(d+=50),d}function sB(l,i,o,d,f,m){let v=null,C=nB(i,o,f,m);for(const T of d){const F=nB(i-T.x,o,f,m)+T.badness;F<=C&&(v=T,C=F)}return{index:l,x:i,priorBreak:v,badness:C}}function oB(l){return l?oB(l.priorBreak).concat(l.index):[]}function nx(l){let i=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function aB(l,i,o,d,f){if(!(i||o||d||f))return;const m=l.length-1,v=l[m],C=(v.x+v.metrics.advance*v.scale)*i;for(let T=0;T<=m;T++)l[T].x-=C,l[T].y+=o+d+f}function lB(l){return l.imagePrimary!==void 0&&l.top!==void 0&&l.bottom!==void 0&&l.left!==void 0&&l.right!==void 0}function ZL(l,i,o,d){const{horizontalAlign:f,verticalAlign:m}=nx(d),v=o[0]-l.displaySize[0]*f,C=o[1]-l.displaySize[1]*m;return{imagePrimary:l,imageSecondary:i,top:C,bottom:C+l.displaySize[1],left:v,right:v+l.displaySize[0]}}function cB(l,i,o,d,f,m){const v=l.imagePrimary;let C;if(v.content){const fe=v.content,ve=v.pixelRatio||1;C=[fe[0]/ve,fe[1]/ve,v.displaySize[0]-fe[2]/ve,v.displaySize[1]-fe[3]/ve]}const T=i.left*m,F=i.right*m;let k,z,H,$;o==="width"||o==="both"?($=f[0]+T-d[3],z=f[0]+F+d[1]):($=f[0]+(T+F-v.displaySize[0])/2,z=$+v.displaySize[0]);const ee=i.top*m,ae=i.bottom*m;return o==="height"||o==="both"?(k=f[1]+ee-d[0],H=f[1]+ae+d[2]):(k=f[1]+(ee+ae-v.displaySize[1])/2,H=k+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:k,right:z,bottom:H,left:$,collisionPadding:C}}function uB(l){return!l.imagePrimary.stretchX}function hB(l){return!l.imagePrimary.stretchY}function dB(l){return{width:l.right-l.left,height:l.bottom-l.top}}const DA=128;function AB(l,i,o){const{expression:d}=i;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new $n(l+1,{worldview:o}))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=d;let v=0;for(;v<f.length&&f[v]<=l;)v++;v=Math.max(0,v-1);let C=v;for(;C<f.length&&f[C]<l+1;)C++;C=Math.min(f.length-1,C);const T=f[v],F=f[C];return d.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:F,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:F,minSize:d.evaluate(new $n(T,{worldview:o})),maxSize:d.evaluate(new $n(F,{worldview:o})),interpolationType:m}}}function sx(l,{uSize:i,uSizeT:o},{lowerSize:d,upperSize:f}){return l.kind==="source"?d/DA:l.kind==="composite"?Er(d/DA,f/DA,o):i}function Gm(l,i,o=1){let d=0,f=0;if(l.kind==="constant")f=l.layoutSize*o;else if(l.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:C}=l,T=m?Ye(Wl.interpolationFactor(m,i,v,C),0,1):0;l.kind==="camera"?f=Er(l.minSize,l.maxSize,T)*o:d=T*o}return{uSizeT:d,uSize:f}}class yf extends qt{constructor(i,o,d,f,m){super(i,o),this.angle=f,this.z=d,m!==void 0&&(this.segment=m)}clone(){return new yf(this.x,this.y,this.z,this.angle,this.segment)}}function fB(l,i,o,d,f){if(i.segment===void 0)return!0;let m=i,v=i.segment+1,C=0;for(;C>-o/2;){if(v--,v<0)return!1;C-=l[v].dist(m),m=l[v]}C+=l[v].dist(l[v+1]),v++;const T=[];let F=0;for(;C<o/2;){const k=l[v],z=l[v+1];if(!z)return!1;let H=l[v-1].angleTo(k)-k.angleTo(z);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:C,angleDelta:H}),F+=H;C-T[0].distance>d;)F-=T.shift().angleDelta;if(F>f)return!1;v++,C+=k.dist(z)}return!0}function pB(l){let i=0;for(let o=0;o<l.length-1;o++)i+=l[o].dist(l[o+1]);return i}function gB(l,i,o){return l?.6*i*o:0}function mB(l,i){return Math.max(l?l.right-l.left:0,i?i.right-i.left:0)}function JL(l,i,o,d,f,m){const v=gB(o,f,m),C=mB(o,d)*m;let T=0;const F=pB(l)/2;for(let k=0;k<l.length-1;k++){const z=l[k],H=l[k+1],$=z.dist(H);if(T+$>F){const ee=(F-T)/$,ae=Er(z.x,H.x,ee),fe=Er(z.y,H.y,ee),ve=new yf(ae,fe,0,H.angleTo(z),k);return!v||fB(l,ve,C,v,i)?ve:void 0}T+=$}}function eM(l,i,o,d,f,m,v,C,T){const F=gB(d,m,v),k=mB(d,f),z=k*v,H=l[0].x===0||l[0].x===T||l[0].y===0||l[0].y===T;return i-z<i/4&&(i=z+i/4),yB(l,H?i/2*C%i:(k/2+2*m)*v*C%i,i,F,o,z,H,!1,T)}function yB(l,i,o,d,f,m,v,C,T){const F=m/2,k=pB(l);let z=0,H=i-o,$=[];for(let ee=0;ee<l.length-1;ee++){const ae=l[ee],fe=l[ee+1],ve=ae.dist(fe),Fe=fe.angleTo(ae);for(;H+o<z+ve;){H+=o;const Pe=(H-z)/ve,ue=Er(ae.x,fe.x,Pe),Ie=Er(ae.y,fe.y,Pe);if(ue>=0&&ue<T&&Ie>=0&&Ie<T&&H-F>=0&&H+F<=k){const ke=new yf(ue,Ie,0,Fe,ee);d&&!fB(l,ke,m,d,f)||$.push(ke)}}z+=ve}return C||$.length||v||($=yB(l,z/2,o,d,f,m,v,!0,T)),$}function vB(l){let i=0,o=0;for(const v of l)i+=v.w*v.h,o=Math.max(o,v.w);l.sort((v,C)=>C.h-v.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let f=0,m=0;for(const v of l)for(let C=d.length-1;C>=0;C--){const T=d[C];if(!(v.w>T.w||v.h>T.h)){if(v.x=T.x,v.y=T.y,m=Math.max(m,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===T.w&&v.h===T.h){const F=d.pop();C<d.length&&(d[C]=F)}else v.h===T.h?(T.x+=v.w,T.w-=v.w):v.w===T.w?(T.y+=v.h,T.h-=v.h):(d.push({x:T.x+v.w,y:T.y,w:T.w-v.w,h:v.h}),T.y+=v.h,T.h-=v.h);break}}return{w:f,h:m,fill:i/(f*m)||0}}Zi(yf,"Anchor");const qp=1;class Wm{static getImagePositionScale(i,o,d){if(o&&i&&i.options&&i.options.transform){const f=i.options.transform;return{x:f.a,y:f.d}}return{x:d,y:d}}constructor(i,o,d,f){this.paddedRect=i;const{pixelRatio:m,version:v,stretchX:C,stretchY:T,content:F,sdf:k,usvg:z}=o;this.pixelRatio=m,this.stretchX=C,this.stretchY=T,this.content=F,this.version=v,this.padding=d,this.sdf=k,this.usvg=z,this.scale=Wm.getImagePositionScale(f,z,m)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function ox(l,i,o){const d=bn.parse(l),f=function(m,v,C=[1,1]){return{x:0,y:0,w:(m.data?m.data.width:m.width*C[0])+2*v,h:(m.data?m.data.height:m.height*C[1])+2*v}}(i,o,[d.options.transform.a,d.options.transform.d]);return{bin:f,imagePosition:new Wm(f,i,o,d),imageVariant:d}}class _B{constructor(i,o,d){const f=new Map,m=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(i,f,qp,v),this.addImages(o,m,2,v);const{w:C,h:T}=vB(v),F=new Pl({width:C||1,height:T||1});for(const[k,z]of i.entries()){const H=f.get(k).paddedRect;Pl.copy(z.data,F,{x:0,y:0},{x:H.x+qp,y:H.y+qp},z.data,d,z.sdf)}for(const[k,z]of o.entries()){const H=m.get(k),$=H.paddedRect;let ee=H.padding;const ae=$.x+ee,fe=$.y+ee,ve=z.data.width,Fe=z.data.height;ee=ee>1?ee-1:ee,Pl.copy(z.data,F,{x:0,y:0},{x:ae,y:fe},z.data,d),Pl.copy(z.data,F,{x:0,y:Fe-ee},{x:ae,y:fe-ee},{width:ve,height:ee},d),Pl.copy(z.data,F,{x:0,y:0},{x:ae,y:fe+Fe},{width:ve,height:ee},d),Pl.copy(z.data,F,{x:ve-ee,y:0},{x:ae-ee,y:fe},{width:ee,height:Fe},d),Pl.copy(z.data,F,{x:0,y:0},{x:ae+ve,y:fe},{width:ee,height:Fe},d),Pl.copy(z.data,F,{x:ve-ee,y:Fe-ee},{x:ae-ee,y:fe-ee},{width:ee,height:ee},d),Pl.copy(z.data,F,{x:0,y:Fe-ee},{x:ae+ve,y:fe-ee},{width:ee,height:ee},d),Pl.copy(z.data,F,{x:0,y:0},{x:ae+ve,y:fe+Fe},{width:ee,height:ee},d),Pl.copy(z.data,F,{x:ve-ee,y:0},{x:ae-ee,y:fe+Fe},{width:ee,height:ee},d)}this.lut=d,this.image=F,this.iconPositions=f,this.patternPositions=m}addImages(i,o,d,f){for(const[m,v]of i.entries()){const{bin:C,imagePosition:T,imageVariant:F}=ox(m,v,d);o.set(m,T),f.push(C),v.hasRenderCallback&&this.haveRenderCallbacks.push(F.id)}}patchUpdatedImages(i,o,d){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>i.hasImage(f,d)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,d);for(const f of i.getUpdatedImages(d)){for(const m of this.iconPositions.keys()){const v=bn.parse(m);if(na.isEqual(v.id,f)){const C=i.getImage(f,d);this.patchUpdatedImage(this.iconPositions.get(m),C,o)}}for(const m of this.patternPositions.keys()){const v=bn.parse(m);if(na.isEqual(v.id,f)){const C=i.getImage(f,d);this.patchUpdatedImage(this.patternPositions.get(m),C,o)}}}}patchUpdatedImage(i,o,d){if(!i||!o||i.version===o.version)return;i.version=o.version;const[f,m]=i.tl,v=i.sdf;if(this.lut||v){const C={width:o.data.width,height:o.data.height},T=new Pl(C);Pl.copy(o.data,T,{x:0,y:0},{x:0,y:0},C,this.lut,v),d.update(T,{position:{x:f,y:m}})}else d.update(o.data,{position:{x:f,y:m}})}}Zi(Wm,"ImagePosition"),Zi(_B,"ImageAtlas");const Mv=1e20;function xB(l,i,o,d,f,m,v,C,T){for(let F=i;F<i+d;F++)bB(l,o*m+F,m,f,v,C,T);for(let F=o;F<o+f;F++)bB(l,F*m+i,1,d,v,C,T)}function bB(l,i,o,d,f,m,v){m[0]=0,v[0]=-1e20,v[1]=Mv,f[0]=l[i];for(let C=1,T=0,F=0;C<d;C++){f[C]=l[i+C*o];const k=C*C;do{const z=m[T];F=(f[C]-f[z]+k-z*z)/(C-z)/2}while(F<=v[T]&&--T>-1);T++,m[T]=C,v[T]=F,v[T+1]=Mv}for(let C=0,T=0;C<d;C++){for(;v[T+1]<C;)T++;const F=m[T],k=C-F;l[i+C*o]=f[F]+k*k}}const zd=2,ax={none:0,ideographs:1,all:2};class zg{constructor(i,o,d){this.requestManager=i,this.localGlyphMode=o,this.localFontFamily=d,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,o){this.urls[o]=i}getGlyphs(i,o,d){const f=[],m=this.urls[o]||ds.GLYPHS_URL;for(const v in i)for(const C of i[v])f.push({stack:v,id:C});bt(f,({stack:v,id:C},T)=>{let F=this.entries[v];F||(F=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=F.glyphs[C];if(k!==void 0)return void T(null,{stack:v,id:C,glyph:k});if(k=this._tinySDF(F,v,C),k)return F.glyphs[C]=k,void T(null,{stack:v,id:C,glyph:k});const z=Math.floor(C/256);if(256*z>65535)return Yr("glyphs > 65535 not supported"),void T(null,{stack:v,id:C,glyph:k});if(F.ranges[z])return void T(null,{stack:v,id:C,glyph:k});let H=F.requests[z];H||(H=F.requests[z]=[],zg.loadGlyphRange(v,z,m,this.requestManager,($,ee)=>{if(ee){F.ascender=ee.ascender,F.descender=ee.descender;for(const ae in ee.glyphs)this._doesCharSupportLocalGlyph(+ae)||(F.glyphs[+ae]=ee.glyphs[+ae]);F.ranges[z]=!0}for(const ae of H)ae($,ee);delete F.requests[z]})),H.push(($,ee)=>{$?T($):ee&&T(null,{stack:v,id:C,glyph:ee.glyphs[C]||null})})},(v,C)=>{if(v)d(v);else if(C){const T={};for(const{stack:F,id:k,glyph:z}of C)T[F]===void 0&&(T[F]={}),T[F].glyphs===void 0&&(T[F].glyphs={}),T[F].glyphs[k]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},T[F].ascender=this.entries[F].ascender,T[F].descender=this.entries[F].descender;d(null,T)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==ax.none&&(this.localGlyphMode===ax.all?!!this.localFontFamily:!!this.localFontFamily&&(Br["CJK Unified Ideographs"](i)||Br["Hangul Syllables"](i)||Br.Hiragana(i)||Br.Katakana(i)||Br["CJK Symbols and Punctuation"](i)||Br["CJK Unified Ideographs Extension A"](i)||Br["CJK Unified Ideographs Extension B"](i)||Br.Osage(i)))}_tinySDF(i,o,d){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let m=i.tinySDF;if(!m){let ae="400";/bold/i.test(o)?ae="900":/medium/i.test(o)?ae="500":/light/i.test(o)&&(ae="200"),m=i.tinySDF=new zg.TinySDF({fontFamily:f,fontWeight:ae,fontSize:24*zd,buffer:3*zd,radius:8*zd}),m.fontWeight=ae}if(this.localGlyphs[m.fontWeight][d])return this.localGlyphs[m.fontWeight][d];const v=String.fromCodePoint(d),{data:C,width:T,height:F,glyphWidth:k,glyphHeight:z,glyphLeft:H,glyphTop:$,glyphAdvance:ee}=m.draw(v);return this.localGlyphs[m.fontWeight][d]={id:d,bitmap:new sp({width:T,height:F},C),metrics:{width:k/zd,height:z/zd,left:H/zd,top:$/zd-27,advance:ee/zd,localGlyph:!0}}}}zg.loadGlyphRange=function(l,i,o,d,f){const m=256*i,v=m+255,C=d.transformRequest(d.normalizeGlyphsURL(o).replace("{fontstack}",l).replace("{range}",`${m}-${v}`),hh.Glyphs);Hc(C,(T,F)=>{if(T)f(T);else if(F){const k={},z=function(H){return new Fv(H).readFields(WL,{})}(F);for(const H of z.glyphs)k[H.id]=H;f(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},zg.TinySDF=class{constructor({fontSize:l=24,buffer:i=3,radius:o=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:m="normal",fontStyle:v="normal"}={}){this.buffer=i,this.cutoff=d,this.radius=o;const C=this.size=l+4*i,T=this._createCanvas(C),F=this.ctx=T.getContext("2d",{willReadFrequently:!0});F.font=`${v} ${m} ${l}px ${f}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(l){const i=document.createElement("canvas");return i.width=i.height=l,i}draw(l){const{width:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:m}=this.ctx.measureText(l),v=Math.ceil(o),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-f))),T=Math.min(this.size-this.buffer,v+Math.ceil(d)),F=C+2*this.buffer,k=T+2*this.buffer,z=Math.max(F*k,0),H=new Uint8ClampedArray(z),$={data:H,width:F,height:k,glyphWidth:C,glyphHeight:T,glyphTop:v,glyphLeft:0,glyphAdvance:i};if(C===0||T===0)return $;const{ctx:ee,buffer:ae,gridInner:fe,gridOuter:ve}=this;ee.clearRect(ae,ae,C,T),ee.fillText(l,ae,ae+v);const Fe=ee.getImageData(ae,ae,C,T);ve.fill(Mv,0,z),fe.fill(0,0,z);for(let Pe=0;Pe<T;Pe++)for(let ue=0;ue<C;ue++){const Ie=Fe.data[4*(Pe*C+ue)+3]/255;if(Ie===0)continue;const ke=(Pe+ae)*F+ue+ae;if(Ie===1)ve[ke]=0,fe[ke]=Mv;else{const Ge=.5-Ie;ve[ke]=Ge>0?Ge*Ge:0,fe[ke]=Ge<0?Ge*Ge:0}}xB(ve,0,0,F,k,F,this.f,this.v,this.z),xB(fe,ae,ae,C,T,F,this.f,this.v,this.z);for(let Pe=0;Pe<z;Pe++){const ue=Math.sqrt(ve[Pe])-Math.sqrt(fe[Pe]);H[Pe]=Math.round(255-255*(ue/this.radius+this.cutoff))}return $}};const $p=qp;function wB(l,i){return l+i[1]-i[0]}function BB(l,i,o,d,f=1){const m=[],v=l.imagePrimary,C=v.pixelRatio,T=v.paddedRect.w-2*$p,F=v.paddedRect.h-2*$p,k=(l.right-l.left)*f,z=(l.bottom-l.top)*f,H=v.stretchX||[[0,T]],$=v.stretchY||[[0,F]],ee=H.reduce(wB,0),ae=$.reduce(wB,0),fe=T-ee,ve=F-ae;let Fe=0,Pe=ee,ue=0,Ie=ae,ke=0,Ge=fe,yt=0,At=ve;if(v.content&&d){const Mt=v.content;Fe=Pv(H,0,Mt[0]),ue=Pv($,0,Mt[1]),Pe=Pv(H,Mt[0],Mt[2]),Ie=Pv($,Mt[1],Mt[3]),ke=Mt[0]-Fe,yt=Mt[1]-ue,Ge=Mt[2]-Mt[0]-Pe,At=Mt[3]-Mt[1]-Ie}const _t=(Mt,Wt,Si,Ai)=>{const Ci=kv(Mt.stretch-Fe,Pe,k,l.left*f),Ti=Rv(Mt.fixed-ke,Ge,Mt.stretch,ee),$t=kv(Wt.stretch-ue,Ie,z,l.top*f),_i=Rv(Wt.fixed-yt,At,Wt.stretch,ae),Vt=kv(Si.stretch-Fe,Pe,k,l.left*f),Yt=Rv(Si.fixed-ke,Ge,Si.stretch,ee),ki=kv(Ai.stretch-ue,Ie,z,l.top*f),Di=Rv(Ai.fixed-yt,At,Ai.stretch,ae),xr=new qt(Ci,$t),ur=new qt(Vt,$t),Xi=new qt(Vt,ki),Pi=new qt(Ci,ki),$r=new qt(Ti/C,_i/C),ar=new qt(Yt/C,Di/C),fr=i*Math.PI/180;if(fr){const xn=Math.sin(fr),as=Math.cos(fr),js=[as,-xn,xn,as];xr._matMult(js),ur._matMult(js),Pi._matMult(js),Xi._matMult(js)}const Nr=Mt.stretch+Mt.fixed,an=Si.stretch+Si.fixed,on=Wt.stretch+Wt.fixed,_n=Ai.stretch+Ai.fixed,un=l.imageSecondary;return{tl:xr,tr:ur,bl:Pi,br:Xi,texPrimary:{x:v.paddedRect.x+$p+Nr,y:v.paddedRect.y+$p+on,w:an-Nr,h:_n-on},texSecondary:un?{x:un.paddedRect.x+$p+Nr,y:un.paddedRect.y+$p+on,w:an-Nr,h:_n-on}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$r,pixelOffsetBR:ar,minFontScaleX:Ge/C/k,minFontScaleY:At/C/z,isSDF:o}};if(d&&(v.stretchX||v.stretchY)){const Mt=CB(H,fe,ee),Wt=CB($,ve,ae);for(let Si=0;Si<Mt.length-1;Si++){const Ai=Mt[Si],Ci=Mt[Si+1];for(let Ti=0;Ti<Wt.length-1;Ti++)m.push(_t(Ai,Wt[Ti],Ci,Wt[Ti+1]))}}else m.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:F+1}));return m}function Pv(l,i,o){let d=0;for(const f of l)d+=Math.max(i,Math.min(o,f[1]))-Math.max(i,Math.min(o,f[0]));return d}function CB(l,i,o){const d=[{fixed:-1,stretch:0}];for(const[f,m]of l){const v=d[d.length-1];d.push({fixed:f-v.stretch,stretch:v.stretch}),d.push({fixed:f-v.stretch,stretch:v.stretch+(m-f)})}return d.push({fixed:i+$p,stretch:o}),d}function kv(l,i,o,d){return l/i*o+d}function Rv(l,i,o,d){return l-i*o/d}function tM(l,i,o,d){const f=i+l.positionedLines[d].lineOffset;return d===0?o+f/2:o+(f+(i+l.positionedLines[d-1].lineOffset))/2}function iM(l,i=1,o=!1){let d=1/0,f=1/0,m=-1/0,v=-1/0;const C=l[0];for(let $=0;$<C.length;$++){const ee=C[$];(!$||ee.x<d)&&(d=ee.x),(!$||ee.y<f)&&(f=ee.y),(!$||ee.x>m)&&(m=ee.x),(!$||ee.y>v)&&(v=ee.y)}const T=Math.min(m-d,v-f);let F=T/2;const k=new tl([],rM);if(T===0)return new qt(d,f);for(let $=d;$<m;$+=T)for(let ee=f;ee<v;ee+=T)k.push(new Ng($+F,ee+F,F,l));let z=function($){let ee=0,ae=0,fe=0;const ve=$[0];for(let Fe=0,Pe=ve.length,ue=Pe-1;Fe<Pe;ue=Fe++){const Ie=ve[Fe],ke=ve[ue],Ge=Ie.x*ke.y-ke.x*Ie.y;ae+=(Ie.x+ke.x)*Ge,fe+=(Ie.y+ke.y)*Ge,ee+=3*Ge}return new Ng(ae/ee,fe/ee,0,$)}(l),H=k.length;for(;k.length;){const $=k.pop();($.d>z.d||!z.d)&&(z=$,o&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,H)),$.max-z.d<=i||(F=$.h/2,k.push(new Ng($.p.x-F,$.p.y-F,F,l)),k.push(new Ng($.p.x+F,$.p.y-F,F,l)),k.push(new Ng($.p.x-F,$.p.y+F,F,l)),k.push(new Ng($.p.x+F,$.p.y+F,F,l)),H+=4)}return o&&(console.log(`num probes: ${H}`),console.log(`best distance: ${z.d}`)),z.p}function rM(l,i){return i.max-l.max}class Ng{constructor(i,o,d,f){this.p=new qt(i,o),this.h=d,this.d=function(m,v){let C=!1,T=1/0;for(let F=0;F<v.length;F++){const k=v[F];for(let z=0,H=k.length,$=H-1;z<H;$=z++){const ee=k[z],ae=k[$];ee.y>m.y!=ae.y>m.y&&m.x<(ae.x-ee.x)*(m.y-ee.y)/(ae.y-ee.y)+ee.x&&(C=!C),T=Math.min(T,Un(m,ee,ae))}}return(C?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const nM=Object.keys,lx=Number.POSITIVE_INFINITY,sM=Math.sqrt(2);function SB(l,[i,o]){let d=0,f=0;if(o===lx){i<0&&(i=0);const m=i/sM;switch(l){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-i;break;case"top":f=i-7}switch(l){case"top-right":case"bottom-right":d=-m;break;case"top-left":case"bottom-left":d=m;break;case"left":d=i;break;case"right":d=-i}}else{switch(i=Math.abs(i),o=Math.abs(o),l){case"top-right":case"top-left":case"top":f=o-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-o}switch(l){case"top-right":case"bottom-right":case"right":d=-i;break;case"top-left":case"bottom-left":case"left":d=i}}return[d,f]}function Dv(l,i,o,d,f,m,v,C,T){if(!i||!i.usvg)return;const F=dB(d),k=dB(f),z=m!=="both"&&m!=="width"||!uB(d)?1:k.width/F.width,H=m!=="both"&&m!=="height"||!hB(d)?1:k.height/F.height;o.scaleSelf(z,H);const $=o.toString();v.set($,o),C.set($,i);const{imagePosition:ee}=ox($,i,qp);T.set($,ee)}function EB(l,i,o,d,f,m,v,C,T){if(!l)return;const F=function(k,z,H,$,ee,ae){if(k.kind==="camera")return k.maxSize;if(k.kind==="composite"){const fe=z.possiblyEvaluate(new $n(k.maxZoom,{worldview:ae}),H).evaluate(ee,{},H),ve=z.possiblyEvaluate(new $n(k.minZoom,{worldview:ae}),H).evaluate(ee,{},H);return Math.max(fe,ve)}return z.possiblyEvaluate(new $n($,{worldview:ae})).evaluate(ee,{},H)}(i,o,d,f,m,T);return l.scaleSelf(F*C*v)}function IB(l,i,o,d,f,m,v,C,T){return{iconPrimary:EB(l.getPrimary(),i,o,d,f,m,v,C,T),iconSecondary:EB(l.getSecondary(),i,o,d,f,m,v,C,T)}}function oM(l,i,o){if(!i)return;const d=o.get(l.toString()),f=o.get(i.toString());f&&(d.paddedRect.w===f.paddedRect.w&&d.paddedRect.h===f.paddedRect.h||Yr(`Mismatch in icon variant sizes: ${l.toString()} and ${i.toString()}`),d.usvg!==f.usvg&&Yr(`Mismatch in icon variant image types: ${l.id} and ${i.id}`))}function TB(l,i,o,d){if(!l)return;const f=i.get(o.toString());if(l.imagePrimary=f,d){const m=i.get(d.toString());l.imageSecondary=m}}function aM(l,i){for(const o in l.horizontal)FB(l.horizontal[o],i);FB(l.vertical,i)}function FB(l,i){if(l){for(const o of l.positionedLines)for(const d of o.positionedGlyphs)if(d.image!==null){const f=d.image.toString();d.rect=i.get(f).paddedRect}}}function cx(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lM(l,i,o,d,f,m,v,C,T){const F=ux(m.horizontal)||m.vertical,k=o.get("icon-text-fit-padding").evaluate(d,{},f);let z,H=i;return i&&T!=="none"&&(l.allowVerticalPlacement&&m.vertical&&(z=cB(i,m.vertical,T,k,C,v)),F&&(H=cB(i,F,T,k,C,v))),{defaultShapedIcon:H,verticallyShapedIcon:z}}function cM(l,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve,Fe,Pe){let ue=v.textMaxSize.evaluate(i,{},H);ue===void 0?ue=C*v.textScaleFactor:ue*=v.textScaleFactor;const Ie=l.layers[0].layout,ke=ux(o.horizontal)||o.vertical,Ge=$.name==="globe",yt=rl,At=l.tilePixelRatio*ue/yt,_t=(Ti=l.overscaling,l.zoom>18&&Ti>2&&(Ti>>=1),Math.max(wi/(512*Ti),1)*Ie.get("symbol-spacing")),Mt=Ie.get("text-padding")*l.tilePixelRatio,Wt=Ie.get("icon-padding")*l.tilePixelRatio,Si=dn(Ie.get("text-max-angle")),Ai=Ie.get("icon-rotation-alignment")==="map"&&Pe!=="point",Ci=_t/2;var Ti;l.hasAnyIconTextFit===!1&&fe!=="none"&&(l.hasAnyIconTextFit=!0);const $t=i.properties?+i.properties[vn]:null,_i=$t&&l.elevationFeatureIdToIndex?l.elevationFeatureIdToIndex.get($t):65535,Vt=(Yt,ki,Di)=>{if(ki.x<0||ki.x>=wi||ki.y<0||ki.y>=wi)return;let xr=null;if(Ge){const{x:ur,y:Xi,z:Pi}=$.projectTilePoint(ki.x,ki.y,Di);xr={anchor:new yf(ur,Xi,Pi,0,void 0),up:$.upVector(Di,ki.x,ki.y)}}(function(ur,Xi,Pi,$r,ar,fr,Nr,an,on,_n,un,xn,as,js,Ne,Xe,Jt,zi,Yi,Wi,or,Or,Bn,Cn,hn,us,Os,Sn,so){const Hs=ur.addToLineVertexArray(Xi,$r);let ls,Bo,Ws,Us,Qs,fs,fn,vs=0,oo=0,kr=0,zn=0,Xs=-1,mo=-1;const Ks={};let ya=zo("");const Cs=Pi?Pi.anchor:Xi,ha=Sn!=="none";let eu=0,kl=0;if(on._unevaluatedLayout.getValue("text-radial-offset")===void 0){const va=on.layout.get("text-offset").evaluate(or,{},hn);eu=va[0]*rl,kl=va[1]*rl}else eu=on.layout.get("text-radial-offset").evaluate(or,{},hn)*rl,kl=lx;if(ur.allowVerticalPlacement&&ar.vertical){const va=ar.vertical;if(Ne)fs=hx(va),an&&(fn=hx(an));else{const ka=on.layout.get("text-rotate").evaluate(or,{},hn)+90;Ws=Ov(_n,Cs,Xi,un,xn,as,va,js,ka,Xe),an&&(Us=Ov(_n,Cs,Xi,un,xn,as,an,zi,ka))}}if(fr){const va=ur.iconSizeData,ka=on.layout.get("icon-rotate").evaluate(or,{},hn),Rl=BB(fr,ka,Bn,ha,Or.iconScaleFactor),gc=an?BB(an,ka,Bn,ha,Or.iconScaleFactor):void 0;Bo=Ov(_n,Cs,Xi,un,xn,as,fr,zi,ka,null),vs=4*Rl.length;let Yl=null;va.kind==="source"?(Yl=[DA*on.layout.get("icon-size").evaluate(or,{},hn)*Or.iconScaleFactor],Yl[0]>ap&&Yr(`${ur.layerIds[0]}: Value for "icon-size" is >= ${Xm}. Reduce your "icon-size".`)):va.kind==="composite"&&(Yl=[DA*Or.compositeIconSizes[0].evaluate(or,{},hn)*Or.iconScaleFactor,DA*Or.compositeIconSizes[1].evaluate(or,{},hn)*Or.iconScaleFactor],(Yl[0]>ap||Yl[1]>ap)&&Yr(`${ur.layerIds[0]}: Value for "icon-size" is >= ${Xm}. Reduce your "icon-size".`)),ur.addSymbols(ur.icon,Rl,Yl,Wi,Yi,or,void 0,Pi,Xi,Hs.lineStartIndex,Hs.lineLength,-1,Cn,hn,us,Os),Xs=ur.icon.placedSymbolArray.length-1,gc&&(oo=4*gc.length,ur.addSymbols(ur.icon,gc,Yl,Wi,Yi,or,Mu.vertical,Pi,Xi,Hs.lineStartIndex,Hs.lineLength,-1,Cn,hn,us,Os),mo=ur.icon.placedSymbolArray.length-1)}for(const va in ar.horizontal){const ka=va,Rl=ar.horizontal[ka];ls||(ya=zo(Rl.text),Ne?Qs=hx(Rl):ls=Ov(_n,Cs,Xi,un,xn,as,Rl,js,on.layout.get("text-rotate").evaluate(or,{},hn),Xe));const gc=Rl.positionedLines.length===1;if(kr+=LB(ur,Pi,Xi,Rl,Nr,on,Ne,or,Xe,Hs,ar.vertical?Mu.horizontal:Mu.horizontalOnly,gc?nM(ar.horizontal):[ka],Ks,Xs,Or,Cn,hn,us),gc)break}ar.vertical&&(zn+=LB(ur,Pi,Xi,ar.vertical,Nr,on,Ne,or,Xe,Hs,Mu.vertical,["vertical"],Ks,mo,Or,Cn,hn,us));let dl=-1;const tu=(va,ka)=>va?Math.max(va,ka):ka;dl=tu(Qs,dl),dl=tu(fs,dl),dl=tu(fn,dl);const OA=dl>-1?1:0;ur.glyphOffsetArray.length>=65535&&Yr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),or.sortKey!==void 0&&ur.addToSortKeyRanges(ur.symbolInstances.length,or.sortKey),ur.symbolInstances.emplaceBack(Xi.x,Xi.y,Cs.x,Cs.y,Cs.z,Ks.right>=0?Ks.right:-1,Ks.center>=0?Ks.center:-1,Ks.left>=0?Ks.left:-1,Ks.vertical>=0?Ks.vertical:-1,Xs,mo,ya,ls!==void 0?ls:ur.collisionBoxArray.length,ls!==void 0?ls+1:ur.collisionBoxArray.length,Ws!==void 0?Ws:ur.collisionBoxArray.length,Ws!==void 0?Ws+1:ur.collisionBoxArray.length,Bo!==void 0?Bo:ur.collisionBoxArray.length,Bo!==void 0?Bo+1:ur.collisionBoxArray.length,Us||ur.collisionBoxArray.length,Us?Us+1:ur.collisionBoxArray.length,un,kr,zn,vs,oo,OA,0,eu,kl,dl,0,ha?1:0,so)})(l,ki,xr,Yt,o,d,m,f,l.layers[0],l.collisionBoxArray,i.index,i.sourceLayerIndex,l.index,Mt,Fe,F,0,Wt,Ai,ve,i,v,k,z,H,ee,ae,fe,_i)};if(Pe==="line")for(const Yt of Sv(i.geometry,0,0,wi,wi)){const ki=eM(Yt,_t,Si,o.vertical||ke,d,yt,At,l.overscaling,wi);for(const Di of ki)ke&&uM(l,ke.text,Ci,Di)||Vt(Yt,Di,H)}else if(Pe==="line-center"){for(const Yt of i.geometry)if(Yt.length>1){const ki=JL(Yt,Si,o.vertical||ke,d,yt,At);ki&&Vt(Yt,ki,H)}}else if(i.type==="Polygon")for(const Yt of _v(i.geometry,0)){const ki=iM(Yt,16);Vt(Yt[0],new yf(ki.x,ki.y,0,0,void 0),H)}else if(i.type==="LineString")for(const Yt of i.geometry)Vt(Yt,new yf(Yt[0].x,Yt[0].y,0,0,void 0),H);else if(i.type==="Point")for(const Yt of i.geometry)for(const ki of Yt)Vt([ki],new yf(ki.x,ki.y,0,0,void 0),H)}const Xm=255,ap=Xm*DA;function LB(l,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe,ve){const Fe=function(Ie,ke,Ge,yt,At,_t,Mt,Wt){const Si=[];if(ke.positionedLines.length===0)return Si;const Ai=yt.layout.get("text-rotate").evaluate(_t,{})*Math.PI/180,Ci=function(Yt){const ki=Yt[0],Di=Yt[1],xr=ki*Di;return xr>0?[ki,-Di]:xr<0?[-ki,Di]:ki===0?[Di,ki]:[Di,-ki]}(Ge);let Ti=Math.abs(ke.top-ke.bottom);for(const Yt of ke.positionedLines)Ti-=Yt.lineOffset;const $t=ke.positionedLines.length,_i=Ti/$t;let Vt=ke.top-Ge[1];for(let Yt=0;Yt<$t;++Yt){const ki=ke.positionedLines[Yt];Vt=tM(ke,_i,Vt,Yt);for(const Di of ki.positionedGlyphs){if(!Di.rect)continue;const xr=Di.rect||{};let ur=KL+1,Xi=!0,Pi=1,$r=0;if(Di.image){const or=Mt.get(Di.image.toString());if(!or)continue;if(or.sdf){Yr("SDF images are not supported in formatted text and will be ignored.");continue}Xi=!1,Pi=or.pixelRatio,ur=qp/Pi}const ar=(At||Wt)&&Di.vertical,fr=Di.metrics.advance*Di.scale/2,Nr=Di.metrics,an=Di.rect;if(an===null)continue;Wt&&ke.verticalizable&&($r=Di.image?fr-Di.metrics.width*Di.scale/2:0);const on=At?[Di.x+fr,Di.y]:[0,0];let _n=[0,0],un=[0,0],xn=!1;At||(ar?(un=[Di.x+fr+Ci[0],Di.y+Ci[1]-$r],xn=!0):_n=[Di.x+fr+Ge[0],Di.y+Ge[1]-$r]);const as=an.w*Di.scale/(Pi*(Di.localGlyph?zd:1)),js=an.h*Di.scale/(Pi*(Di.localGlyph?zd:1));let Ne,Xe,Jt,zi;if(ar){const or=Di.y-Vt,Or=new qt(-fr,fr-or),Bn=-Math.PI/2,Cn=new qt(...un);Ne=new qt(-fr+_n[0],_n[1]),Ne._rotateAround(Bn,Or)._add(Cn),Ne.x+=-or+fr,Ne.y-=(Nr.left-ur)*Di.scale;const hn=Di.image?Nr.advance*Di.scale:rl*Di.scale,us=String.fromCodePoint(Di.glyph);QL(us)?Ne.x+=(1-ur)*Di.scale:VL(us)?Ne.x+=hn-Nr.height*Di.scale+(-ur-1)*Di.scale:Ne.x+=Di.image||Nr.width+2*ur===an.w&&Nr.height+2*ur===an.h?(hn-js)/2:(hn-(Nr.height+2*ur)*Di.scale)/2,Xe=new qt(Ne.x,Ne.y-as),Jt=new qt(Ne.x+js,Ne.y),zi=new qt(Ne.x+js,Ne.y-as)}else{const or=(Nr.left-ur)*Di.scale-fr+_n[0],Or=(-Nr.top-ur)*Di.scale+_n[1],Bn=or+as,Cn=Or+js;Ne=new qt(or,Or),Xe=new qt(Bn,Or),Jt=new qt(or,Cn),zi=new qt(Bn,Cn)}if(Ai){let or;or=At?new qt(0,0):xn?new qt(Ci[0],Ci[1]):new qt(Ge[0],Ge[1]),Ne._rotateAround(Ai,or),Xe._rotateAround(Ai,or),Jt._rotateAround(Ai,or),zi._rotateAround(Ai,or)}const Yi=new qt(0,0),Wi=new qt(0,0);Si.push({tl:Ne,tr:Xe,bl:Jt,br:zi,texPrimary:xr,texSecondary:void 0,writingMode:ke.writingMode,glyphOffset:on,sectionIndex:Di.sectionIndex,isSDF:Xi,pixelOffsetTL:Yi,pixelOffsetBR:Wi,minFontScaleX:0,minFontScaleY:0})}}return Si}(0,d,T,m,v,C,f,l.allowVerticalPlacement),Pe=l.textSizeData;let ue=null;Pe.kind==="source"?(ue=[DA*m.layout.get("text-size").evaluate(C,{},fe)*ee.textScaleFactor],ue[0]>ap&&Yr(`${l.layerIds[0]}: Value for "text-size" is >= ${Xm}. Reduce your "text-size".`)):Pe.kind==="composite"&&(ue=[DA*ee.compositeTextSizes[0].evaluate(C,{},fe)*ee.textScaleFactor,DA*ee.compositeTextSizes[1].evaluate(C,{},fe)*ee.textScaleFactor],(ue[0]>ap||ue[1]>ap)&&Yr(`${l.layerIds[0]}: Value for "text-size" is >= ${Xm}. Reduce your "text-size".`)),l.addSymbols(l.text,Fe,ue,T,v,C,k,i,o,F.lineStartIndex,F.lineLength,$,ae,fe,ve,!1);for(const Ie of z)H[Ie]=l.text.placedSymbolArray.length-1;return 4*Fe.length}function ux(l){for(const i in l)return l[i];return null}function Ov(l,i,o,d,f,m,v,C,T,F){let k=v.top,z=v.bottom,H=v.left,$=v.right;if(lB(v)&&v.collisionPadding){const ee=v.collisionPadding;H-=ee[0],k-=ee[1],$+=ee[2],z+=ee[3]}if(T){const ee=new qt(H,k),ae=new qt($,k),fe=new qt(H,z),ve=new qt($,z),Fe=dn(T);let Pe=new qt(0,0);F&&(Pe=new qt(F[0],F[1])),ee._rotateAround(Fe,Pe),ae._rotateAround(Fe,Pe),fe._rotateAround(Fe,Pe),ve._rotateAround(Fe,Pe),H=Math.min(ee.x,ae.x,fe.x,ve.x),$=Math.max(ee.x,ae.x,fe.x,ve.x),k=Math.min(ee.y,ae.y,fe.y,ve.y),z=Math.max(ee.y,ae.y,fe.y,ve.y)}return l.emplaceBack(i.x,i.y,i.z,o.x,o.y,H,k,$,z,C,d,f,m),l.length-1}function hx(l){lB(l)&&l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const i=l.bottom-l.top;return i>0?Math.max(10,i):null}function uM(l,i,o,d){const f=l.compareText;if(i in f){const m=f[i];for(let v=m.length-1;v>=0;v--)if(d.dist(m[v])<o)return!0}else f[i]=[];return f[i].push(d),!1}function MB(l,i){const o=l.fovAboveCenter,d=l.elevation?l.elevation.getMinElevationBelowMSL()*i:0,f=(l._camera.position[2]*l.worldSize-d)/Math.cos(l._pitch),m=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-l._pitch-o,.01));let v=Math.sin(l._pitch)*m+f;const C=f*(1/l._horizonShift);if(!l.elevation||l.elevation.exaggeration()===0){let T=Math.max(l.zoom-17,0);l.isOrthographic&&(T/=10),v*=1+T}return Math.min(1.01*v,C)}function Ym(l,i){if(!i.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:i};const o=Math.pow(2,-l.z),d=l.x*o,f=(l.x+1)*o,m=l.y*o,v=(l.y+1)*o,C=ft(d),T=ft(f),F=Rt(m),k=Rt(v),z=i.project(C,F),H=i.project(T,F),$=i.project(T,k),ee=i.project(C,k);let ae=Math.min(z.x,H.x,$.x,ee.x),fe=Math.min(z.y,H.y,$.y,ee.y),ve=Math.max(z.x,H.x,$.x,ee.x),Fe=Math.max(z.y,H.y,$.y,ee.y);const Pe=o/16;function ue(ke,Ge,yt,At,_t,Mt){const Wt=(yt+_t)/2,Si=(At+Mt)/2,Ai=i.project(ft(Wt),Rt(Si)),Ci=Math.max(0,ae-Ai.x,fe-Ai.y,Ai.x-ve,Ai.y-Fe);ae=Math.min(ae,Ai.x),ve=Math.max(ve,Ai.x),fe=Math.min(fe,Ai.y),Fe=Math.max(Fe,Ai.y),Ci>Pe&&(ue(ke,Ai,yt,At,Wt,Si),ue(Ai,Ge,Wt,Si,_t,Mt))}ue(z,H,d,m,f,m),ue(H,$,f,m,f,v),ue($,ee,f,v,d,v),ue(ee,z,d,v,d,m),ae-=Pe,fe-=Pe,ve+=Pe,Fe+=Pe;const Ie=1/Math.max(ve-ae,Fe-fe);return{scale:Ie,x:ae*Ie,y:fe*Ie,x2:ve*Ie,y2:Fe*Ie,projection:i}}function PB(l,{x:i,y:o},d=0){return new qt(((i-d)*l.scale-l.x)*wi,(o*l.scale-l.y)*wi)}const hM=M(new Float32Array(16));class lp{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,o){return{x:0,y:0,z:0}}unproject(i,o){return new Te(0,0)}projectTilePoint(i,o,d){return{x:i,y:o,z:0}}locationPoint(i,o,d,f=!0){return i._coordinatePoint(i.locationCoordinate(o,d),f)}pixelsPerMeter(i,o){return ht(1,i)*o}pixelSpaceConversion(i,o,d){return 1}farthestPixelDistance(i){return MB(i,i.pixelsPerMeter)}pointCoordinate(i,o,d,f){const m=i.horizonLineFromTop(!1),v=new qt(o,Math.max(m,d));return i.rayIntersectionCoordinate(i.pointRayIntersection(v,f))}pointCoordinate3D(i,o,d){const f=new qt(o,d);if(i.elevation)return i.elevation.pointCoordinate(f);{const m=this.pointCoordinate(i,f.x,f.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(i,o){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,o.x,o.y);const d=i.horizonLineFromTop();return o.y<d}createInversionMatrix(i,o){return hM}createTileMatrix(i,o,d){let f,m,v;const C=d.canonical,T=M(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=Ym(C,this);f=1,m=F.x+d.wrap*F.scale,v=F.y,q(T,T,[f/F.scale,f/F.scale,i.pixelsPerMeter/o])}else f=o/i.zoomScale(C.z),m=(C.x+Math.pow(2,C.z)*d.wrap)*f,v=C.y*f;return Q(T,T,[m,v,0]),q(T,T,[f/wi,f/wi,1]),T}upVector(i,o,d){return[0,0,1]}upVectorScale(i,o,d){return{metersToTile:1}}}class dM extends lp{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[o,d]=this.parallels=i.parallels||[29.5,45.5],f=Math.sin(dn(o));this.n=(f+Math.sin(dn(d)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(i,o){const{n:d,c:f,r0:m}=this,v=dn(i-this.center[0]),C=dn(o),T=Math.sqrt(f-2*d*Math.sin(C))/d;return{x:T*Math.sin(v*d),y:T*Math.cos(v*d)-m,z:0}}unproject(i,o){const{n:d,c:f,r0:m}=this,v=m+o;let C=Math.atan2(i,Math.abs(v))*Math.sign(v);v*d<0&&(C-=Math.PI*Math.sign(i)*Math.sign(v));const T=dn(this.center[0])*d;C=Dt(C,-Math.PI-T,Math.PI-T);const F=Ye(Et(C/d)+this.center[0],-180,180),k=Math.asin(Ye((f-(i*i+v*v)*d*d)/(2*d),-1,1)),z=Ye(Et(k),-85.051129,ti);return new Te(F,z)}}const Km=1.340264,qm=-.081106,$m=893e-6,Zm=.003796,Uv=Math.sqrt(3)/2;class AM extends lp{project(i,o){o=o/180*Math.PI,i=i/180*Math.PI;const d=Math.asin(Uv*Math.sin(o)),f=d*d,m=f*f*f;return{x:.5*(i*Math.cos(d)/(Uv*(Km+3*qm*f+m*(7*$m+9*Zm*f)))/Math.PI+.5),y:1-.5*(d*(Km+qm*f+m*($m+Zm*f))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let d=o=(2*(1-o)-1)*Math.PI,f=d*d,m=f*f*f;for(let k,z,H,$=0;$<12&&(z=d*(Km+qm*f+m*($m+Zm*f))-o,H=Km+3*qm*f+m*(7*$m+9*Zm*f),k=z/H,d=Ye(d-k,-Math.PI/3,Math.PI/3),f=d*d,m=f*f*f,!(Math.abs(k)<1e-12));++$);const v=Uv*i*(Km+3*qm*f+m*(7*$m+9*Zm*f))/Math.cos(d),C=Math.asin(Math.sin(d)/Uv),T=Ye(180*v/Math.PI,-180,180),F=Ye(180*C/Math.PI,-85.051129,ti);return new Te(T,F)}}class fM extends lp{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){return{x:.5+i/360,y:.5-o/360,z:0}}unproject(i,o){const d=360*(i-.5),f=Ye(360*(.5-o),-85.051129,ti);return new Te(d,f)}}const jg=Math.PI/2;function zv(l){return Math.tan((jg+l)/2)}class pM extends lp{constructor(i){super(i),this.center=i.center||[0,30];const[o,d]=this.parallels=i.parallels||[30,30];let f=dn(o),m=dn(d);this.southernCenter=f+m<0,this.southernCenter&&(f=-f,m=-m);const v=Math.cos(f),C=zv(f);this.n=f===m?Math.sin(f):Math.log(v/Math.cos(m))/Math.log(zv(m)/C),this.f=v*Math.pow(zv(f),this.n)/this.n}project(i,o){o=dn(o),this.southernCenter&&(o=-o),i=dn(i-this.center[0]);const d=1e-6,{n:f,f:m}=this;m>0?o<-jg+d&&(o=-jg+d):o>jg-d&&(o=jg-d);const v=m/Math.pow(zv(o),f);let C=v*Math.sin(f*i),T=m-v*Math.cos(f*i);return C=.5*(C/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:C,y:this.southernCenter?T:1-T,z:0}}unproject(i,o){i=(2*i-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:d,f}=this,m=f-o,v=Math.sign(m),C=Math.sign(d)*Math.sqrt(i*i+m*m);let T=Math.atan2(i,Math.abs(m))*v;m*d<0&&(T-=Math.PI*Math.sign(i)*v);const F=Ye(Et(T/d)+this.center[0],-180,180),k=Ye(Et(2*Math.atan(Math.pow(f/C,1/d))-jg),-85.051129,ti);return new Te(F,this.southernCenter?-k:k)}}class kB extends lp{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,o){return{x:nt(i),y:qe(o),z:0}}unproject(i,o){const d=ft(i),f=Rt(o);return new Te(d,f)}}const RB=dn(ti);class gM extends lp{project(i,o){const d=(o=dn(o))*o,f=d*d;return{x:.5*((i=dn(i))*(.8707-.131979*d+f*(f*(.003971*d-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+d*(.015085+f*(.028874*d-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let d=o=(2*(1-o)-1)*Math.PI,f=25,m=0,v=d*d;do{v=d*d;const F=v*v;m=(d*(1.007226+v*(.015085+F*(.028874*v-.044475-.005916*F)))-o)/(1.007226+v*(.045255+F*(.259866*v-.311325-.005916*11*F))),d=Ye(d-m,-RB,RB)}while(Math.abs(m)>1e-6&&--f>0);v=d*d;const C=Ye(Et(i/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),T=Et(d);return new Te(C,T)}}const DB=dn(ti);class mM extends lp{project(i,o){o=dn(o),i=dn(i);const d=Math.cos(o),f=2/Math.PI,m=Math.acos(d*Math.cos(i/2)),v=Math.sin(m)/m,C=.5*(i*f+2*d*Math.sin(i/2)/v)||0,T=.5*(o+Math.sin(o)/v)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(i,o){let d=i=(2*i-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,m=25;const v=1e-6;let C=0,T=0;do{const F=Math.cos(f),k=Math.sin(f),z=2*k*F,H=k*k,$=F*F,ee=Math.cos(d/2),ae=Math.sin(d/2),fe=2*ee*ae,ve=ae*ae,Fe=1-$*ee*ee,Pe=Fe?1/Fe:0,ue=Fe?Math.acos(F*ee)*Math.sqrt(1/Fe):0,Ie=.5*(2*ue*F*ae+2*d/Math.PI)-i,ke=.5*(ue*k+f)-o,Ge=.5*Pe*($*ve+ue*F*ee*H)+1/Math.PI,yt=Pe*(fe*z/4-ue*k*ae),At=.125*Pe*(z*ae-ue*k*$*fe),_t=.5*Pe*(H*ee+ue*ve*F)+.5,Mt=yt*At-_t*Ge;C=(ke*yt-Ie*_t)/Mt,T=(Ie*At-ke*Ge)/Mt,d=Ye(d-C,-Math.PI,Math.PI),f=Ye(f-T,-DB,DB)}while((Math.abs(C)>v||Math.abs(T)>v)&&--m>0);return new Te(Et(d),Et(f))}}class OB extends lp{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(dn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){const{scale:d,cosPhi:f}=this;return{x:dn(i)*f*d+.5,y:-Math.sin(dn(o))/f*d+.5,z:0}}unproject(i,o){const{scale:d,cosPhi:f}=this,m=-(o-.5)/d,v=Ye(Et((i-.5)/d)/f,-180,180),C=Math.asin(Ye(m*f,-1,1)),T=Ye(Et(C),-85.051129,ti);return new Te(v,T)}}class yM extends kB{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,o,d){const f=Em(i,o,d);return vt(f,f,mv(kA(d))),{x:f[0],y:f[1],z:f[2]}}locationPoint(i,o,d){const f=he(o.lat,o.lng),m=mt([],f),v=d?i._centerAltitude+d:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(o),i._centerAltitude):i._centerAltitude;It(f,f,m,ht(1,0)*wi*v);const C=M(new Float64Array(16));return U(C,i.pixelMatrix,i.globeMatrix),vt(f,f,C),new qt(f[0],f[1])}pixelsPerMeter(i,o){return ht(1,0)*o}pixelSpaceConversion(i,o,d){const f=ht(1,i)*o,m=Er(ht(1,45)*o,f,d);return this.pixelsPerMeter(i,o)/m}createTileMatrix(i,o,d){const f=I_(kA(d.canonical));return U(new Float64Array(16),i.globeMatrix,f)}createInversionMatrix(i,o){const{center:d}=i,f=mv(kA(o));return re(f,f,dn(d.lng)),ne(f,f,dn(d.lat)),q(f,f,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(i,o,d,f){return vw(i,o,d,!0)||new Ct(0,0)}pointCoordinate3D(i,o,d){const f=this.pointCoordinate(i,o,d,0);return[f.x,f.y,f.z]}isPointAboveHorizon(i,o){return!vw(i,o.x,o.y,!1)}farthestPixelDistance(i){const o=function(f,m){const v=f.cameraToCenterDistance,C=f._centerAltitude*m,T=f._camera,F=f._camera.forward(),k=Me([],Qe([],F,-v),[0,0,C]),z=f.worldSize/(2*Math.PI),H=[0,0,-z],$=f.width/f.height,ee=Math.tan(f.fovAboveCenter),ae=Qe([],T.up(),ee),fe=Qe([],T.right(),ee*$),ve=mt([],Me([],Me([],F,ae),fe)),Fe=[];let Pe;if(new Ds(k,ve).closestPointOnSphere(H,z,Fe)){const ue=Me([],Fe,H),Ie=Ve([],ue,k);Pe=Math.cos(f.fovAboveCenter)*Le(Ie)}else{const ue=Ve([],k,H),Ie=Ve([],H,k);mt(Ie,Ie);const ke=Le(ue)-z;Pe=Math.sqrt(ke*(ke+2*z));const Ge=Math.acos(Pe/(z+ke))-Math.acos(Bt(F,Ie));Pe*=Math.cos(Ge)}return 1.01*Pe}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),d=np(i.zoom);if(d>0){const f=MB(i,ht(1,i.center.lat)*i.worldSize),m=i.worldSize/(2*Math.PI),v=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Er(o,f+m*(1-Math.cos(v)),Math.pow(d,10))}return o}upVector(i,o,d){return Em(o,d,i,1)}upVectorScale(i){return{metersToTile:fv(gv(kA(i)))}}}function UB(l){const i=l.parallels,o=!!i&&Math.abs(i[0]+i[1])<.01;switch(l.name){case"mercator":return new kB(l);case"equirectangular":return new fM(l);case"naturalEarth":return new gM(l);case"equalEarth":return new AM(l);case"winkelTripel":return new mM(l);case"albers":return o?new OB(l):new dM(l);case"lambertConformalConic":return o?new OB(l):new pM(l);case"globe":return new yM(l)}throw new Error(`Invalid projection name: ${l.name}`)}const vM=ln.VectorTileFeature.types,_M=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Nv(l,i,o,d,f,m,v,C,T,F,k,z,H){const $=C?Math.min(ap,Math.round(C[0])):0,ee=C?Math.min(ap,Math.round(C[1])):0;l.emplaceBack(i,o,Math.round(32*d),Math.round(32*f),m,v,($<<1)+(T?1:0),ee,16*F,16*k,256*z,256*H)}function jv(l,i,o){l.emplaceBack(i,o)}function Hv(l,i,o,d,f,m,v){l.emplaceBack(i,o,d,f,m,v)}const Qv=(l,i,o,d)=>{for(let f=0;f<i;f++)l.emplaceBack(o[0],o[1],o[2],d[0],d[1],d[2])};function Vv(l,i,o,d,f){l.emplaceBack(i,o,d,f),l.emplaceBack(i,o,d,f),l.emplaceBack(i,o,d,f),l.emplaceBack(i,o,d,f)}function xM(l){for(const i of l.sections)if(yd(i.text))return!0;return!1}class dx{constructor(i){this.layoutVertexArray=new Sd,this.indexArray=new Jo,this.programConfigurations=i,this.segments=new Gs,this.dynamicLayoutVertexArray=new Ya,this.opacityVertexArray=new Lh,this.placedSymbolArray=new jp,this.iconTransitioningVertexArray=new Mh,this.globeExtVertexArray=new Ed,this.zOffsetVertexArray=new qh,this.orientationVertexArray=new Up}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,o,d,f,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,PL.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,RL.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,_M,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,UL.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,kL.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,DL.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=i.createVertexBuffer(this.orientationVertexArray,OL.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||f)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Zi(dx,"SymbolBuffers");class Ax{constructor(i,o,d){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new d,this.segments=new Gs,this.collisionVertexArray=new CA,this.collisionVertexArrayExt=new Ya}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,zL.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,NL.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Zi(Ax,"CollisionBuffers");class Gv{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=M([]),this.placementViewportMatrix=M([]);const o=this.layers[0]._unevaluatedLayout._values;this.worldview=i.worldview,this.textSizeData=AB(this.zoom,o["text-size"],this.worldview),this.iconSizeData=AB(this.zoom,o["icon-size"],this.worldview);const d=this.layers[0].layout,f=d.get("symbol-sort-key"),m=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(v=>Mu[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new dx(new p(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new dx(new p(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new $f,this.lineVertexArray=new Lg,this.symbolInstances=new Hp}calculateGlyphDependencies(i,o,d,f,m){for(const v of i){const C=v.codePointAt(0);if(C===void 0)break;if(o[C]=!0,f&&m&&C<=65535){const T=Qm[v];T&&(o[T.charCodeAt(0)]=!0)}}}updateFootprints(i,o){}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!j_(this.activeReplacements,d)&&(this.activeReplacements=d,!0)}populate(i,o,d,f){const m=this.layers[0],v=m.layout,C=this.projection.name==="globe",T=v.get("text-font"),F=v.get("text-field"),k=v.get("icon-image"),[z,H]=v.get("icon-size-scale-range"),$=Ye(o.scaleFactor||1,z,H),ee=(F.value.kind!=="constant"||F.value.value instanceof ts&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),ae=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,fe=v.get("symbol-sort-key");if(this.features=[],!ee&&!ae)return;const ve=o.iconDependencies,Fe=o.glyphDependencies,Pe=o.availableImages,ue=new $n(this.zoom,{worldview:this.worldview});for(const{feature:Ie,id:ke,index:Ge,sourceLayerIndex:yt}of i){const At=m._featureFilter.needGeometry,_t=Ki(Ie,At);if(!m._featureFilter.filter(ue,_t,d))continue;if(At||(_t.geometry=tr(Ie,d,f)),C&&Ie.type!==1&&d.z<=5){const Ci=_t.geometry,Ti=.98078528056,$t=(_i,Vt)=>Bt(Em(_i.x,_i.y,d,1),Em(Vt.x,Vt.y,d,1))<Ti;for(let _i=0;_i<Ci.length;_i++)Ci[_i]=Li(Ci[_i],$t)}let Mt,Wt;if(ee){const Ci=m.getValueAndResolveTokens("text-field",_t,d,Pe),Ti=ts.factory(Ci);xM(Ti)&&(this.hasRTLText=!0),(!this.hasRTLText||hl()==="unavailable"||this.hasRTLText&&$c.isParsed())&&(Mt=HL(Ti,m,_t))}if(ae){const Ci=m.getValueAndResolveTokens("icon-image",_t,d,Pe);Wt=typeof Ci=="string"?Js.build(Ci):Ci}if(!Mt&&!Wt)continue;const Si=this.sortFeaturesByKey?fe.evaluate(_t,{},d):void 0,Ai={id:ke,text:Mt,icon:Wt,index:Ge,sourceLayerIndex:yt,geometry:_t.geometry,properties:Ie.properties,type:vM[Ie.type],sortKey:Si};if(this.features.push(Ai),Wt){const Ci=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Ti,iconSecondary:$t}=IB(Wt,this.iconSizeData,Ci["icon-size"],d,this.zoom,Ai,this.pixelRatio,$,this.worldview),_i=Ti.id.toString();if(ve.has(_i)?ve.get(_i).push(Ti):ve.set(_i,[Ti]),$t){const Vt=$t.id.toString();ve.has(Vt)?ve.get(Vt).push($t):ve.set(Vt,[$t])}}if(Mt){const Ci=T.evaluate(_t,{},d).join(","),Ti=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Mu.vertical)>=0;for(const $t of Mt.sections)if($t.image){const _i=$t.image.getPrimary().scaleSelf(this.pixelRatio),Vt=_i.id.toString(),Yt=ve.get(Vt)||[];Yt.push(_i),ve.set(Vt,Yt)}else{const _i=Wu(Mt.toString()),Vt=$t.fontStack||Ci,Yt=Fe[Vt]=Fe[Vt]||{};this.calculateGlyphDependencies($t.text,Yt,Ti,this.allowVerticalPlacement,_i)}}}if(v.get("symbol-placement")==="line"&&(this.features=function(Ie){const ke={},Ge={},yt=[];let At=0;function _t(Ai){yt.push(Ie[Ai]),At++}function Mt(Ai,Ci,Ti){const $t=Ge[Ai];return delete Ge[Ai],Ge[Ci]=$t,yt[$t].geometry[0].pop(),yt[$t].geometry[0]=yt[$t].geometry[0].concat(Ti[0]),$t}function Wt(Ai,Ci,Ti){const $t=ke[Ci];return delete ke[Ci],ke[Ai]=$t,yt[$t].geometry[0].shift(),yt[$t].geometry[0]=Ti[0].concat(yt[$t].geometry[0]),$t}function Si(Ai,Ci,Ti){const $t=Ti?Ci[0][Ci[0].length-1]:Ci[0][0];return`${Ai}:${$t.x}:${$t.y}`}for(let Ai=0;Ai<Ie.length;Ai++){const Ci=Ie[Ai],Ti=Ci.geometry,$t=Ci.text?Ci.text.toString():null;if(!$t){_t(Ai);continue}const _i=Si($t,Ti),Vt=Si($t,Ti,!0);if(_i in Ge&&Vt in ke&&Ge[_i]!==ke[Vt]){const Yt=Wt(_i,Vt,Ti),ki=Mt(_i,Vt,yt[Yt].geometry);delete ke[_i],delete Ge[Vt],Ge[Si($t,yt[ki].geometry,!0)]=ki,yt[Yt].geometry=null}else _i in Ge?Mt(_i,Vt,Ti):Vt in ke?Wt(_i,Vt,Ti):(_t(Ai),ke[_i]=At-1,Ge[Vt]=At-1)}return yt.filter(Ai=>Ai.geometry)}(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ie of o.elevationFeatures)this.elevationFeatureIdToIndex.set(Ie.id,this.elevationFeatures.length),this.elevationFeatures.push(Ie)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Ie,ke)=>Ie.sortKey-ke.sortKey)}update(i,o,d,f,m,v,C){this.text.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,this.worldview),this.icon.programConfigurations.updatePaintArrays(i,o,m,d,f,v,C,this.worldview)}updateRoadElevation(i){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;const d=Qt(i),f=1/d;let m=!1,v=!1;for(let C=0;C<this.symbolInstances.length;C++){const T=this.symbolInstances.get(C),F=Se(1,0,0),k=Se(0,1,0),{numHorizontalGlyphVertices:z,numVerticalGlyphVertices:H,numIconVertices:$,numVerticalIconVertices:ee}=T,ae=z>0||H>0,fe=$>0,ve=this.elevationFeatures[T.elevationFeatureIndex];if(ve){const Fe=new qt(T.tileAnchorX,T.tileAnchorY),Pe=.075+ve.pointElevation(Fe);T.zOffset!==Pe&&(o=!0,T.zOffset=Pe);const ue=ve.computeSlopeNormal(Fe,f),Ie=ui(di(),Se(0,0,1),ue);mi(F,F,Ie),mi(k,k,Ie),F[2]*=d,k[2]*=d,F[0]===1&&F[1]===0&&F[2]===0&&k[0]===0&&k[1]===1&&k[2]===0||(m=m||ae,v=v||fe)}if(ae&&(Qv(this.text.orientationVertexArray,z,F,k),Qv(this.text.orientationVertexArray,H,F,k)),fe){const{placedIconSymbolIndex:Fe,verticalPlacedIconSymbolIndex:Pe}=T;Fe>=0&&Qv(this.icon.orientationVertexArray,$,F,k),Pe>=0&&Qv(this.icon.orientationVertexArray,ee,F,k)}}m||(this.text.orientationVertexArray=void 0),v||(this.icon.orientationVertexArray=void 0),o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(m,v,C)=>{d+=v,d>m.length&&m.resize(d);for(let T=-v;T<0;T++)m.emplace(T+d,C)},o=(m,v,C)=>{f+=v,f>m.length&&m.resize(f);for(let T=-v;T<0;T++)m.emplace(T+f,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let d=0,f=0;for(let m=0;m<this.symbolInstances.length;m++){const v=this.symbolInstances.get(m),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:T,numIconVertices:F}=v,k=v.zOffset,z=F>0;if((C>0||T>0)&&(i(this.text.zOffsetVertexArray,C,k),i(this.text.zOffsetVertexArray,T,k)),z){const{placedIconSymbolIndex:H,verticalPlacedIconSymbolIndex:$}=v;H>=0&&o(this.icon.zOffsetVertexArray,F,k),$>=0&&o(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,k)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=UB(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const d=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:f,y:m}of o)this.lineVertexArray.emplaceBack(f,m);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae,fe){const ve=i.indexArray,Fe=i.layoutVertexArray,Pe=i.globeExtVertexArray,ue=i.segments.prepareSegment(4*o.length,Fe,ve,this.canOverlap?v.sortKey:void 0),Ie=this.glyphOffsetArray.length,ke=ue.vertexLength,Ge=this.allowVerticalPlacement&&C===Mu.vertical?Math.PI/2:0,yt=v.text&&v.text.sections;for(let _t=0;_t<o.length;_t++){const{tl:Mt,tr:Wt,bl:Si,br:Ai,texPrimary:Ci,texSecondary:Ti,pixelOffsetTL:$t,pixelOffsetBR:_i,minFontScaleX:Vt,minFontScaleY:Yt,glyphOffset:ki,isSDF:Di,sectionIndex:xr}=o[_t],ur=ue.vertexLength,Xi=ki[1];if(Nv(Fe,F.x,F.y,Mt.x,Xi+Mt.y,Ci.x,Ci.y,d,Di,$t.x,$t.y,Vt,Yt),Nv(Fe,F.x,F.y,Wt.x,Xi+Wt.y,Ci.x+Ci.w,Ci.y,d,Di,_i.x,$t.y,Vt,Yt),Nv(Fe,F.x,F.y,Si.x,Xi+Si.y,Ci.x,Ci.y+Ci.h,d,Di,$t.x,_i.y,Vt,Yt),Nv(Fe,F.x,F.y,Ai.x,Xi+Ai.y,Ci.x+Ci.w,Ci.y+Ci.h,d,Di,_i.x,_i.y,Vt,Yt),T){const{x:Pi,y:$r,z:ar}=T.anchor,[fr,Nr,an]=T.up;Hv(Pe,Pi,$r,ar,fr,Nr,an),Hv(Pe,Pi,$r,ar,fr,Nr,an),Hv(Pe,Pi,$r,ar,fr,Nr,an),Hv(Pe,Pi,$r,ar,fr,Nr,an),Vv(i.dynamicLayoutVertexArray,Pi,$r,ar,Ge)}else Vv(i.dynamicLayoutVertexArray,F.x,F.y,F.z,Ge);if(fe){const Pi=Ti||Ci;jv(i.iconTransitioningVertexArray,Pi.x,Pi.y),jv(i.iconTransitioningVertexArray,Pi.x+Pi.w,Pi.y),jv(i.iconTransitioningVertexArray,Pi.x,Pi.y+Pi.h),jv(i.iconTransitioningVertexArray,Pi.x+Pi.w,Pi.y+Pi.h)}ve.emplaceBack(ur,ur+1,ur+2),ve.emplaceBack(ur+1,ur+2,ur+3),ue.vertexLength+=4,ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ki[0]),_t!==o.length-1&&xr===o[_t+1].sectionIndex||i.programConfigurations.populatePaintArrays(Fe.length,v,v.index,{},$,ee,ae,yt&&yt[xr],this.worldview)}const At=T?T.anchor:F;i.placedSymbolArray.emplaceBack(At.x,At.y,At.z,F.x,F.y,Ie,this.glyphOffsetArray.length-Ie,ke,k,z,F.segment,d?d[0]:0,d?d[1]:0,f[0],f[1],C,0,0,0,H,0)}_commitLayoutVertex(i,o,d,f,m,v,C){i.emplaceBack(o,d,f,m,v,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(i,o,d,f,m,v,C){const T=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),F=T.vertexLength,k=C.tileAnchorX,z=C.tileAnchorY;for(let $=0;$<4;$++)d.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(d.collisionVertexArrayExt,o,i.padding,C.zOffset),this._commitLayoutVertex(d.layoutVertexArray,f,m,v,k,z,new qt(i.x1,i.y1)),this._commitLayoutVertex(d.layoutVertexArray,f,m,v,k,z,new qt(i.x2,i.y1)),this._commitLayoutVertex(d.layoutVertexArray,f,m,v,k,z,new qt(i.x2,i.y2)),this._commitLayoutVertex(d.layoutVertexArray,f,m,v,k,z,new qt(i.x1,i.y2)),T.vertexLength+=4;const H=d.indexArray;H.emplaceBack(F,F+1),H.emplaceBack(F+1,F+2),H.emplaceBack(F+2,F+3),H.emplaceBack(F+3,F),T.primitiveLength+=4}_addTextDebugCollisionBoxes(i,o,d,f,m,v){for(let C=f;C<m;C++){const T=d.get(C),F=this.getSymbolInstanceTextSize(i,v,o,C);this._addCollisionDebugVertices(T,F,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(i,o,d,f,m,v){for(let C=f;C<m;C++){const T=d.get(C),F=this.getSymbolInstanceIconSize(i,o,v.placedIconSymbolIndex);this._addCollisionDebugVertices(T,F,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,v)}}generateCollisionDebugBuffers(i,o,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ax(Xf,J2.members,Mh),this.iconCollisionBox=new Ax(Xf,J2.members,Mh);const f=Gm(this.iconSizeData,i),m=Gm(this.textSizeData,i,d);for(let v=0;v<this.symbolInstances.length;v++){const C=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,i,o,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(m,i,o,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,i,o,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,i,o,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(i,o,d,f){const m=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),v=sx(this.textSizeData,i,m)/rl;return this.tilePixelRatio*v}getSymbolInstanceIconSize(i,o,d){const f=this.icon.placedSymbolArray.get(d),m=sx(this.iconSizeData,i,f);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(i,o,d,f){i.emplaceBack(o,-d,-d,f),i.emplaceBack(o,d,-d,f),i.emplaceBack(o,d,d,f),i.emplaceBack(o,-d,d,f)}_updateTextDebugCollisionBoxes(i,o,d,f,m,v,C){for(let T=f;T<m;T++){const F=d.get(T),k=this.getSymbolInstanceTextSize(i,v,o,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,F.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(i,o,d,f,m,v,C){for(let T=f;T<m;T++){const F=d.get(T),k=this.getSymbolInstanceIconSize(i,o,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,F.padding,v.zOffset)}}updateCollisionDebugBuffers(i,o,d,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=Gm(this.iconSizeData,i,f),v=Gm(this.textSizeData,i,d);for(let C=0;C<this.symbolInstances.length;C++){const T=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(v,i,o,T.textBoxStartIndex,T.textBoxEndIndex,T,d),this._updateTextDebugCollisionBoxes(v,i,o,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,d),this._updateIconDebugCollisionBoxes(m,i,o,T.iconBoxStartIndex,T.iconBoxEndIndex,T,f),this._updateIconDebugCollisionBoxes(m,i,o,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,o,d,f,m,v,C,T,F){const k={};if(o<d){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue,featureIndex:Ie}=i.get(o);k.textBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue},k.textFeatureIndex=Ie}if(f<m){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue,featureIndex:Ie}=i.get(f);k.verticalTextBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue},k.verticalTextFeatureIndex=Ie}if(v<C){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue,featureIndex:Ie}=i.get(v);k.iconBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue},k.iconFeatureIndex=Ie}if(T<F){const{x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue,featureIndex:Ie}=i.get(T);k.verticalIconBox={x1:z,y1:H,x2:$,y2:ee,padding:ae,projectedAnchorX:fe,projectedAnchorY:ve,projectedAnchorZ:Fe,tileAnchorX:Pe,tileAnchorY:ue},k.verticalIconFeatureIndex=Ie}return k}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const d=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,o){const d=i.placedSymbolArray.get(o),f=d.vertexStartIndex+4*d.numGlyphs;for(let m=d.vertexStartIndex;m<f;m+=4)i.indexArray.emplaceBack(m,m+1,m+2),i.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),d=Math.cos(i),f=[],m=[],v=[];for(let C=0;C<this.symbolInstances.length;++C){v.push(C);const T=this.symbolInstances.get(C);f.push(0|Math.round(o*T.tileAnchorX+d*T.tileAnchorY)),m.push(T.featureIndex)}return v.sort((C,T)=>f[C]-f[T]||m[T]-m[C]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,o){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===o?d.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const d=this.symbolInstances.get(o);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:F}=d;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),m>=0&&m!==f&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),F>=0&&this.addIndicesForPlacedSymbol(this.icon,F)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let zB,NB,fx;Zi(Gv,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Gv.addDynamicAttributes=Vv;class jB{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Nu,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zi(jB,"FormatSectionOverride",{omit:["defaultValue"]});const px=()=>fx||(fx={layout:zB||(zB=new Ns({"symbol-placement":new Ei(Lt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ei(Lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ei(Lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gi(Lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ei(Lt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ei(Lt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Ei(Lt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Ei(Lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ei(Lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ei(Lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ei(Lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gi(Lt.layout_symbol["icon-size"]),"icon-size-scale-range":new Ei(Lt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Gi(Lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gi(Lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gi(Lt.layout_symbol["icon-image"]),"icon-rotate":new Gi(Lt.layout_symbol["icon-rotate"]),"icon-padding":new Ei(Lt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ei(Lt.layout_symbol["icon-keep-upright"]),"icon-offset":new Gi(Lt.layout_symbol["icon-offset"]),"icon-anchor":new Gi(Lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ei(Lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ei(Lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ei(Lt.layout_symbol["text-rotation-alignment"]),"text-field":new Gi(Lt.layout_symbol["text-field"]),"text-font":new Gi(Lt.layout_symbol["text-font"]),"text-size":new Gi(Lt.layout_symbol["text-size"]),"text-size-scale-range":new Ei(Lt.layout_symbol["text-size-scale-range"]),"text-max-width":new Gi(Lt.layout_symbol["text-max-width"]),"text-line-height":new Gi(Lt.layout_symbol["text-line-height"]),"text-letter-spacing":new Gi(Lt.layout_symbol["text-letter-spacing"]),"text-justify":new Gi(Lt.layout_symbol["text-justify"]),"text-radial-offset":new Gi(Lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ei(Lt.layout_symbol["text-variable-anchor"]),"text-anchor":new Gi(Lt.layout_symbol["text-anchor"]),"text-max-angle":new Ei(Lt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ei(Lt.layout_symbol["text-writing-mode"]),"text-rotate":new Gi(Lt.layout_symbol["text-rotate"]),"text-padding":new Ei(Lt.layout_symbol["text-padding"]),"text-keep-upright":new Ei(Lt.layout_symbol["text-keep-upright"]),"text-transform":new Gi(Lt.layout_symbol["text-transform"]),"text-offset":new Gi(Lt.layout_symbol["text-offset"]),"text-allow-overlap":new Ei(Lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ei(Lt.layout_symbol["text-ignore-placement"]),"text-optional":new Ei(Lt.layout_symbol["text-optional"]),visibility:new Ei(Lt.layout_symbol.visibility)})),paint:NB||(NB=new Ns({"icon-opacity":new Gi(Lt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Gi(Lt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Gi(Lt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Gi(Lt.paint_symbol["text-emissive-strength"]),"icon-color":new Gi(Lt.paint_symbol["icon-color"]),"icon-halo-color":new Gi(Lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gi(Lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gi(Lt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ei(Lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ei(Lt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ei(Lt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Gi(Lt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Gi(Lt.paint_symbol["text-occlusion-opacity"]),"text-color":new Gi(Lt.paint_symbol["text-color"],{runtimeType:sa,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Gi(Lt.paint_symbol["text-halo-color"]),"text-halo-width":new Gi(Lt.paint_symbol["text-halo-width"]),"text-halo-blur":new Gi(Lt.paint_symbol["text-halo-blur"]),"text-translate":new Ei(Lt.paint_symbol["text-translate"]),"text-translate-anchor":new Ei(Lt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ei(Lt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ei(Lt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ei(Lt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ei(Lt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Gi(Lt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},fx);class Wv extends Xa{constructor(i,o,d,f){super(i,px(),o,d,f),this._colorAdjustmentMatrix=M([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,o){super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const f=[];for(const m of d)f.indexOf(m)<0&&f.push(m);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,o,d,f){return this._saturation===i&&this._contrast===o&&this._brightnessMin===d&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(m,v,C,T){m=So(m),v=Da(v);const F=R(),k=m/3,z=1-2*k,H=[z,k,k,0,k,z,k,0,k,k,z,0,0,0,0,1],$=.5-.5*v,ee=T-C;return U(F,[ee,0,0,0,0,ee,0,0,0,0,ee,0,C,C,C,1],[v,0,0,0,0,v,0,0,0,0,v,0,$,$,$,1]),U(F,F,H),F}(i,o,d,f),this._saturation=i,this._contrast=o,this._brightnessMin=d,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,o,d,f){const m=this.layout.get(i).evaluate(o,{},d,f),v=this._unevaluatedLayout._values[i];return v.isDataDriven()||aa(v.value)||!m?m:function(C,T){return T.replace(/{([^{}]+)}/g,(F,k)=>k in C?String(C[k]):"")}(o.properties,m)}createBucket(i){return new Gv(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of px().paint.overridableProperties){if(!Wv.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),d=new jB(o),f=new wo(d,o.property.specification,this.scope,this.options);let m=null;m=o.value.kind==="constant"||o.value.kind==="source"?new ja("source",f):new Ha("composite",f,o.value.zoomStops,o.value.interpolationType),this.paint._values[i]=new ua(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,d){return!(!this.layout||o.isDataDriven()||d.isDataDriven())&&Wv.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const d=i.get("text-field"),f=px().paint.properties[o];let m=!1;const v=C=>{for(const T of C)if(f.overrides&&f.overrides.hasOverride(T))return void(m=!0)};if(d.value.kind==="constant"&&d.value.value instanceof ts)v(d.value.value.sections);else if(d.value.kind==="source"){const C=F=>{m||(F instanceof Pr&&ji(F.value)===Tt?v(F.value.sections):F instanceof _o?v(F.sections):F.eachChild(C))},T=d.value;T._styleExpression&&C(T._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,o,d){return{config:new MA(this,{zoom:o,lut:d}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let HB,QB,VB,GB;var gx=On([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function mx(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function yx(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class vx{constructor(i,o,d,f){this.context=i,this.format=d,this.useMipmap=f&&f.useMipmap,this.texture=i.gl.createTexture(),this.update(o,{premultiply:f&&f.premultiply})}update(i,o){const d=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,f=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:m}=this,{gl:v}=m,{x:C,y:T}=o&&o.position?o.position:{x:0,y:0},F=C+d,k=T+f;!this.size||this.size[0]===F&&this.size[1]===k||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!o||o.premultiply!==!1));const z=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&F>0&&k>0){const H=this.useMipmap?Math.floor(Math.log2(Math.max(F,k)))+1:1;v.texStorage2D(v.TEXTURE_2D,H,this.format,F,k),this.size=[F,k]}if(this.size)if(z)v.texSubImage2D(v.TEXTURE_2D,0,C,T,mx(this.format),yx(this.format),i);else{const H=i.data;H&&v.texSubImage2D(v.TEXTURE_2D,0,C,T,d,f,mx(this.format),yx(this.format),H)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(i,o,d=!1){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),i!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,i),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!d?i===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),o!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(i,o,d,f,m){const{context:v}=this,{gl:C}=v;C.bindTexture(C.TEXTURE_2D,this.texture),o!==this.magFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,o),this.magFilter=o),i!==this.minFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,this.useMipmap?i===C.NEAREST?C.NEAREST_MIPMAP_NEAREST:C.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),d!==this.wrapS&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,d),this.wrapS=d),f!==this.wrapT&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,f),this.wrapT=f),m!==this.compareMode&&(m?(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.COMPARE_REF_TO_TEXTURE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_FUNC,m)):C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.NONE),this.compareMode=m)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Xv{constructor(i,o){this.context=i,this.texture=o}bind(i,o){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),i!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,i),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,i),this.minFilter=i),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}}function Yv(l,i,o,d,f,m,v,C){const T=[l,i,1,o,d,1,f,m,1],F=[v,C,1],k=I([],T),[z,H,$]=Gt(F,F,k);return E(T,T,[z,0,0,0,H,0,0,0,$])}function WB(l,i,o,d,f,m,v,C){const T=function(F,k,z,H,$,ee,ae,fe){const ve=Yv(0,0,1,0,1,1,0,1),Fe=Yv(F,k,z,H,$,ee,ae,fe);return E(Fe,Fe,I([],ve))}(l,i,o,d,f,m,v,C);return[T[2]/T[8]/wi,T[5]/T[8]/wi]}function Kv(l){return[l[0],Math.min(Math.max(l[1],-85.051129),ti)]}class XB extends yu{constructor(i,o,d,f){super(),this.id=i,this.dispatcher=d,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=o,this._dirty=!1}load(i,o){if(this._loaded=o||!1,this.fire(new Vc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=Ah(this.map._requestManager.transformRequest(this.url,hh.Image),(d,f)=>{this._imageRequest=null,this._loaded=!0,d?this.fire(new rc(d)):f&&(this.image=f instanceof HTMLImageElement?vl.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Xv(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Vc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Xv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=i[0][1],d=i[0][1];for(const m of i)m[1]>d&&(d=m[1]),m[1]<o&&(o=m[1]);const f=(d+o)/2;if(f>ti?this.onNorthPole=!0:f<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=i.map(Ct.fromLngLat);this.tileID=function(v){let C=1/0,T=1/0,F=-1/0,k=-1/0;for(const ae of v)C=Math.min(C,ae.x),T=Math.min(T,ae.y),F=Math.max(F,ae.x),k=Math.max(k,ae.y);const z=Math.max(F-C,k-T),H=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),$=Math.pow(2,H);let ee=Math.floor((C+F)/2*$);return ee>1&&(ee-=1),new pc(H,ee,Math.floor((T+k)/2*$))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Vc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const ve in this.tiles){const Fe=this.tiles[ve];Fe.state!=="loaded"&&(Fe.state="loaded",Fe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Ym(new pc(0,0,0),this.map.transform.projection),d=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ve){const Fe=ve[1].x-ve[0].x,Pe=ve[1].y-ve[0].y,ue=ve[2].x-ve[1].x,Ie=ve[2].y-ve[1].y,ke=ve[3].x-ve[2].x,Ge=ve[3].y-ve[2].y,yt=ve[0].x-ve[3].x,At=ve[0].y-ve[3].y,_t=Fe*Ie-ue*Pe,Mt=ue*Ge-ke*Ie,Wt=ke*At-yt*Ge,Si=yt*Pe-Fe*At;return _t>0&&Mt>0&&Wt>0&&Si>0||_t<0&&Mt<0&&Wt<0&&Si<0}(d))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Ym(this.tileID,this.map.transform.projection),[m,v,C,T]=this.coordinates.map(ve=>{const Fe=f.projection.project(ve[0],ve[1]);return PB(f,Fe)._round()});this.perspectiveTransform=WB(m.x,m.y,v.x,v.y,C.x,C.y,T.x,T.y);const F=this._boundsArray=new wA;F.emplaceBack(m.x,m.y,0,0),F.emplaceBack(v.x,v.y,wi,0),F.emplaceBack(T.x,T.y,0,wi),F.emplaceBack(C.x,C.y,wi,wi),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(F,gx.members),this.boundsSegments=Gs.simpleSegment(0,0,4,2);const k=[],z=[Kv((H=this.coordinates)[0]),Kv(H[1]),Kv(H[2]),Kv(H[3])];var H;const[$,ee,ae,fe]=function(ve){let Fe=ve[0][0],Pe=Fe,ue=ve[0][1],Ie=ue;for(let ke=1;ke<ve.length;ke++)ve[ke][0]<Fe?Fe=ve[ke][0]:ve[ke][0]>Pe&&(Pe=ve[ke][0]),ve[ke][1]<ue?ue=ve[ke][1]:ve[ke][1]>Ie&&(Ie=ve[ke][1]);return[Fe,ue,Pe-Fe,Ie-ue]}(z);{const ve=new wA,[Fe,Pe,ue,Ie]=function($t){let _i=$t[0].x,Vt=_i,Yt=$t[0].y,ki=Yt;for(let Di=1;Di<$t.length;Di++)$t[Di].x<_i?_i=$t[Di].x:$t[Di].x>Vt&&(Vt=$t[Di].x),$t[Di].y<Yt?Yt=$t[Di].y:$t[Di].y>ki&&(ki=$t[Di].y);return[_i,Yt,Vt-_i,ki-Yt]}(d),ke=$t=>[($t.x-Fe)/ue,($t.y-Pe)/Ie],[Ge,yt,At,_t]=d.map(ke),Mt=function($t,_i,Vt,Yt,ki,Di,xr,ur){const Xi=Yv(0,0,1,0,1,1,0,1);return E(Xi,Xi,I([],Yv($t,_i,Vt,Yt,ki,Di,xr,ur)))}(Ge[0],Ge[1],yt[0],yt[1],At[0],At[1],_t[0],_t[1]);this.elevatedGlobePerspectiveTransform=WB(Ge[0],Ge[1],yt[0],yt[1],At[0],At[1],_t[0],_t[1]);const Wt=($t,_i)=>{k.push($t.lng);const Vt=Math.round(($t.lng-$)/ae*wi),Yt=Math.round(($t.lat-ee)/fe*wi),ki=ke(_i),Di=Gt([],[ki[0],ki[1],1],Mt),xr=Math.round(Di[0]/Di[2]*wi),ur=Math.round(Di[1]/Di[2]*wi);ve.emplaceBack(Vt,Yt,xr,ur)},Si=d[3].x-d[0].x,Ai=d[3].y-d[0].y,Ci=d[2].x-d[1].x,Ti=d[2].y-d[1].y;for(let $t=0;$t<65;$t++){const _i=$t/64,Vt=[d[0].x+_i*Si,d[0].y+_i*Ai],Yt=[d[1].x+_i*Ci,d[1].y+_i*Ti],ki=Yt[0]-Vt[0],Di=Yt[1]-Vt[1];for(let xr=0;xr<65;xr++){const ur=xr/64,Xi={x:Vt[0]+ki*ur,y:Vt[1]+Di*ur};Wt(o.projection.unproject(Xi.x,Xi.y),Xi)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(ve,gx.members)}{this.maxLongitudeTriangleSize=0;let ve=[],Fe=new Jo;const Pe=(ue,Ie,ke)=>{Fe.emplaceBack(ue,Ie,ke);const Ge=k[ue],yt=k[Ie],At=k[ke],_t=Math.min(Math.min(Ge,yt),At),Mt=Math.max(Math.max(Ge,yt),At)-_t;Mt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Mt),ve.push(_t+Mt/2)};for(let ue=0;ue<64;ue++)for(let Ie=0;Ie<64;Ie++){const ke=65*ue+Ie,Ge=ke+1,yt=ke+65,At=yt+1;Pe(ke,yt,Ge),Pe(Ge,yt,At)}[ve,Fe]=function(ue,Ie){const ke=Array.from({length:ue.length},(At,_t)=>_t);ke.sort((At,_t)=>ue[At]-ue[_t]);const Ge=[],yt=new Jo;for(let At=0;At<ke.length;At++){const _t=ke[At];Ge.push(ue[_t]);const Mt=3*_t,Wt=Mt+1;yt.emplaceBack(Ie.uint16[Mt],Ie.uint16[Wt],Ie.uint16[Wt+1])}return[Ge,yt]}(ve,Fe),this.elevatedGlobeTrianglesCenterLongitudes=ve,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(Fe)}this.elevatedGlobeSegments=Gs.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ae/wi,0,fe/wi,0,0,ee,$,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const o=this.map.painter.context,d=o.gl;!this._dirty||this.texture instanceof Xv||(this.texture?this.texture.update(this.image):(this.texture=new vx(o,this.image,d.RGBA8),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(o)}loadTile(i,o){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},o(null)):(i.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const d=this.elevatedGlobeTrianglesCenterLongitudes;let f=(m=i+180)+360*Math.round((d[0]-m)/360);var m;const v=new Gs,C=(z,H)=>{v.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:o.segments[0].vertexLength,primitiveLength:H,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(d[0]-f)<=T){const z=Uo(d,0,d.length,f+T);return z===d.length||C(z,hs(d,z+1,d.length,f+360-T)-z),v}f<d[0]&&(f+=360);const F=hs(d,0,d.length,f-T);if(F===d.length)return C(0,d.length),v;C(0,F-0);const k=Uo(d,F+1,d.length,f+T);return k!==d.length&&C(k,d.length-k),v}}const bM=(Math.pow(256,2)-1)/16907520;class YB extends Xa{constructor(i,o,d,f){super(i,{layout:VB||(VB=new Ns({visibility:new Ei(Lt.layout_raster.visibility)})),paint:GB||(GB=new Ns({"raster-opacity":new Ei(Lt.paint_raster["raster-opacity"]),"raster-color":new Yu(Lt.paint_raster["raster-color"]),"raster-color-mix":new Ei(Lt.paint_raster["raster-color-mix"]),"raster-color-range":new Ei(Lt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ei(Lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ei(Lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ei(Lt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ei(Lt.paint_raster["raster-saturation"]),"raster-contrast":new Ei(Lt.paint_raster["raster-contrast"]),"raster-resampling":new Ei(Lt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ei(Lt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ei(Lt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ei(Lt.paint_raster["raster-array-band"]),"raster-elevation":new Ei(Lt.paint_raster["raster-elevation"]),"raster-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},o,d,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof XB&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[d,f]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(d)&&isNaN(f)||d===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=Im({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:d,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[d,f])}}let KB,qB,$B,ZB,JB;class eC extends Xa{constructor(i,o,d,f){super(i,{layout:KB||(KB=new Ns({visibility:new Ei(Lt["layout_raster-particle"].visibility)})),paint:qB||(qB=new Ns({"raster-particle-array-band":new Ei(Lt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ei(Lt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Yu(Lt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ei(Lt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ei(Lt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ei(Lt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ei(Lt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ei(Lt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},o,d,f),this._updateColorRamp(),this.lastInvalidatedAt=vl.now()}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Im({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=vl.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class wM extends Xa{constructor(i,o){super(i,{},o,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function _x(l,i,o){const d=[0,0,1],f=fi([]);return Oi(f,f,o?-dn(l)+Math.PI:dn(l)),Ri(f,f,-dn(i)),mi(d,d,f),mt(d,d)}function tC(l,i){const o=qv(l.projection,l.zoom,l.width,l.height),d=function(m,v,C,T,F){const k=new Te(C.lng-180*cp,C.lat),z=new Te(C.lng+180*cp,C.lat),H=m.project(k.lng,k.lat),$=m.project(z.lng,z.lat),ee=-Math.atan2($.y-H.y,$.x-H.x),ae=Ct.fromLngLat(C);ae.y=Ye(ae.y,-1+cp,1-cp);const fe=ae.toLngLat(),ve=m.project(fe.lng,fe.lat),Fe=Ct.fromLngLat(fe);Fe.x+=cp;const Pe=Fe.toLngLat(),ue=m.project(Pe.lng,Pe.lat),Ie=rC(ue.x-ve.x,ue.y-ve.y,ee),ke=Ct.fromLngLat(fe);ke.y+=cp;const Ge=ke.toLngLat(),yt=m.project(Ge.lng,Ge.lat),At=rC(yt.x-ve.x,yt.y-ve.y,ee),_t=Math.abs(Ie.x)/Math.abs(At.y),Mt=M([]);pe(Mt,Mt,-ee*(1-(F?0:T)));const Wt=M([]);return q(Wt,Wt,[1,1-(1-_t)*T,1]),Wt[4]=-At.x/At.y*T,pe(Wt,Wt,ee),U(Wt,Mt,Wt),Wt}(l.projection,0,l.center,o,i),f=iC(l);return q(d,d,[f,f,1]),d}function iC(l){const i=l.projection,o=qv(l.projection,l.zoom,l.width,l.height),d=xx(i,l.center),f=xx(i,Te.convert(i.center));return Math.pow(2,d*o+(1-o)*f)}function qv(l,i,o,d,f=1/0){const m=l.range;if(!m)return 0;const v=Math.min(f,Math.max(o,d)),C=Math.log(v/1024)/Math.LN2;return xt(m[0]+C,m[1]+C,i)}const cp=1/4e4;function xx(l,i){const o=Ye(i.lat,-85.051129,ti),d=new Te(i.lng-180*cp,o),f=new Te(i.lng+180*cp,o),m=l.project(d.lng,o),v=l.project(f.lng,o),C=Ct.fromLngLat(d),T=Ct.fromLngLat(f),F=v.x-m.x,k=v.y-m.y,z=T.x-C.x,H=T.y-C.y,$=Math.sqrt((z*z+H*H)/(F*F+k*k));return Math.log($)/Math.LN2}function rC(l,i,o){const d=Math.cos(o),f=Math.sin(o);return{x:l*d-i*f,y:l*f+i*d}}function nC(l,i,o){M(l),pe(l,l,dn(i[2])),ne(l,l,dn(i[0])),re(l,l,dn(i[1])),q(l,l,o),U(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function $v(l,i,o,d,f,m,v,C){const T=[o[0]-i[0],o[1]-i[1],0],F=[d[0]-i[0],d[1]-i[1],0];if(Le(T)<1e-12||Le(F)<1e-12)return fi(l);const k=rt([],T,F);mt(k,k),Re(F,d,i),T[2]=(m-f)*C,F[2]=(v-f)*C;const z=T;return rt(z,T,F),mt(z,z),ui(l,k,z)}function bx(l,i,o=!1){const d=np(i.zoom),f=function(m,v,C){const T=v.worldSize,F=[m[12],m[13],m[14]],k=Rt(F[1]/T),z=ft(F[0]/T),H=M([]),$=ht(1,k)*T,ee=ht(1,0)*T*vi(k,v.zoom),ae=1/T_(T);let fe=ee*ae;if(C){const ue=qv(v.projection,v.zoom,v.width,v.height,1024);fe=ae*v.projection.pixelSpaceConversion(v.center.lat,T,ue)}const ve=he(k,z);Me(ve,ve,Qe([],mt([],ve),$*fe*F[2]));const Fe=function(ue){const Ie=[ue[0],ue[1],ue[2]];let ke=[0,1,0];const Ge=rt([],ke,Ie);return rt(ke,Ie,Ge),Je(ke)===0&&(ke=[0,1,0],rt(Ge,Ie,ke)),mt(Ge,Ge),mt(ke,ke),mt(Ie,Ie),[Ge[0],Ge[1],Ge[2],0,ke[0],ke[1],ke[2],0,Ie[0],Ie[1],Ie[2],0,ue[0],ue[1],ue[2],1]}(ve);q(H,H,[fe,fe,fe*$]),Q(H,H,[-F[0],-F[1],-F[2]]);const Pe=U([],v.globeMatrix,Fe);return U(Pe,Pe,H),U(Pe,Pe,m),Pe}(l,i,o);if(d>0){const m=function(v,C){const T=C.worldSize,F=ht(1,0)*T*vi(C.center.lat,C.zoom)/T_(T),k=ht(1,C.center.lat)*T,z=M([]);return re(z,z,dn(C.center.lng)),ne(z,z,dn(C.center.lat)),Q(z,z,[0,0,S]),q(z,z,[F,F,F*k]),Q(z,z,[C.point.x-.5*T,C.point.y-.5*T,0]),U(z,z,v),U(z,C.globeMatrix,z)}(l,i);return function(v,C,T){const F=(ee,ae,fe)=>{const ve=Le(ee),Fe=Le(ae),Pe=mf(ee,ae,fe);return Qe(Pe,Pe,1/Le(Pe)*Er(ve,Fe,fe))},k=F([v[0],v[1],v[2]],[C[0],C[1],C[2]],T),z=F([v[4],v[5],v[6]],[C[4],C[5],C[6]],T),H=F([v[8],v[9],v[10]],[C[8],C[9],C[10]],T),$=mf([v[12],v[13],v[14]],[C[12],C[13],C[14]],T);return[k[0],k[1],k[2],0,z[0],z[1],z[2],0,H[0],H[1],H[2],0,$[0],$[1],$[2],1]}(f,m,d)}return f}function sC(l,i,o,d){const f=De.projectAabbCorners(d,o);let m=Number.MAX_VALUE,v=-1;for(let F=0;F<f.length;++F){const k=f[F];k[0]=(.5*k[0]+.5)*i.width,k[1]=(.5-.5*k[1])*i.height,k[2]<m&&(v=F,m=k[2])}const C=F=>new qt(f[F][0],f[F][1]);let T;switch(v){case 0:case 6:T=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:T=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:T=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:T=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(Ui(l,T))return m}const BM=On([{name:"a_pos_3f",components:3,type:"Float32"}]),CM=On([{name:"a_color_3f",components:3,type:"Float32"}]),SM=On([{name:"a_color_4f",components:4,type:"Float32"}]),EM=On([{name:"a_uv_2f",components:2,type:"Float32"}]),IM=On([{name:"a_normal_3f",components:3,type:"Float32"}]),TM=On([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),FM=On([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),oC={None:0,Model:1,Symbol:2,FillExtrusion:4};class Zv{constructor(i,o,d,f){this.message=(i?`${i}: `:"")+d,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function wx(l,i){const o=l.indexOf("://")===-1;try{return new URL(l,o&&i?"http://example.com":void 0),!0}catch{return!1}}class aC{constructor(i,o){this.feature=i,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class lC{constructor(){this.instancedDataArray=new Zh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Bx{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=i.projection,this.index=i.index,this.worldview=i.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,o){}populate(i,o,d,f){this.tileToMeter=Qt(d);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:C,index:T,sourceLayerIndex:F}of i){const k=C??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),z=Ki(v,m);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom,{worldview:this.worldview}),z,d))continue;const H={id:k,sourceLayerIndex:F,index:T,geometry:m?z.geometry:tr(v,d,f),properties:v.properties,type:v.type,patterns:{}},$=this.addFeature(H,H.geometry,z);$&&o.featureIndex.insert(v,H.geometry,T,F,this.index,this.instancesPerModel[$].instancedDataArray.length,wi/32)}this.lookup=null}update(i,o,d,f){for(const m in this.instancesPerModel){const v=this.instancesPerModel[m];for(const C in i)v.idToFeaturesIndex.hasOwnProperty(C)&&(this.evaluate(v.features[v.idToFeaturesIndex[C]],i[C],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const o in this.instancesPerModel){const d=this.instancesPerModel[o];for(const f of d.features){const m=this.layers[0],v=f.feature,C=this.canonical,T=m.paint.get("model-rotation").evaluate(v,{},C),F=m.paint.get("model-scale").evaluate(v,{},C),k=m.paint.get("model-translation").evaluate(v,{},C);ze(f.rotation,T)&&ze(f.scale,F)&&ze(f.translation,k)||(this.evaluate(f,f.featureStates,d,!0),i=!0)}}return i}updateReplacement(i,o,d,f){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const m=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(j_(this.activeReplacements,m))return!1;this.activeReplacements=m;let v=!1;for(const C in this.instancesPerModel){const T=this.instancesPerModel[C],F=T.instancedDataArray;for(const k of T.features){const z=k.instancedDataOffset,H=k.instancedDataCount;for(let $=0;$<H;$++){const ee=16*($+z);let ae=F.float32[ee+0];const fe=ae>wi;ae=fe?ae-wi:ae;const ve=Math.floor(ae),Fe=F.float32[ee+1];let Pe=!1;for(const ue of this.activeReplacements)if(!e2(ue,d,oC.Model,f)&&!(ue.min.x>ve||ve>ue.max.x||ue.min.y>Fe||Fe>ue.max.y)&&(Pe=o2(s2(ve,Fe,i.canonical,ue.footprintTileId.canonical),ue.footprint),Pe))break;F.float32[ee]=Pe?ae+wi:ae,v=v||Pe!==fe}}}return v}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const o in this.instancesPerModel){const d=this.instancesPerModel[o];d.instancedDataArray.length<0||d.instancedDataArray.length===0||(d.instancedDataBuffer?d.instancedDataBuffer.updateData(d.instancedDataArray):d.instancedDataBuffer=i.createVertexBuffer(d.instancedDataArray,TM.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const d=this.instancesPerModel[o];d.instancedDataArray.length!==0&&d.instancedDataBuffer&&d.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)i.removeModel(o,"",!0)}addFeature(i,o,d){const f=this.layers[0],m=f.layout.get("model-id").evaluate(d,{},this.canonical);if(!m)return Yr(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),m;(wx(m,!1)||this.styleDefinedModelURLs[m]!==void 0)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new lC);const v=this.instancesPerModel[m],C=v.instancedDataArray,T=new aC(d,C.length);for(const F of o)for(const k of F){if(k.x<0||k.x>=wi||k.y<0||k.y>=wi)continue;const z=(this.lookupDim-1)/wi,H=this.lookupDim*(k.y*z|0)+k.x*z|0;if(this.lookup){if(this.lookup[H]!==0)continue;this.lookup[H]=1}this.instanceCount++;const $=C.length;C.resize($+1),v.instancesEvaluatedElevation.push(0),C.float32[16*$]=k.x,C.float32[16*$+1]=k.y}return T.instancedDataCount=v.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(i.id&&(v.idToFeaturesIndex[i.id]=v.features.length),v.features.push(T),this.evaluate(T,{},v,!1)),m}getModelUris(){return this.modelUris}evaluate(i,o,d,f){const m=this.layers[0],v=i.feature,C=this.canonical,T=i.rotation=m.paint.get("model-rotation").evaluate(v,o,C),F=i.scale=m.paint.get("model-scale").evaluate(v,o,C),k=i.translation=m.paint.get("model-translation").evaluate(v,o,C),z=m.paint.get("model-color").evaluate(v,o,C);z.a=m.paint.get("model-color-mix-intensity").evaluate(v,o,C);const H=[];this.maxVerticalOffset<k[2]&&(this.maxVerticalOffset=k[2]),this.maxScale=Math.max(Math.max(this.maxScale,F[0]),Math.max(F[1],F[2])),nC(H,T,F);const $=Math.round(100*z.a)+z.b/1.05;for(let ee=0;ee<i.instancedDataCount;++ee){const ae=i.instancedDataOffset+ee,fe=16*ae,ve=d.instancedDataArray.float32;let Fe=0;f&&(Fe=ve[fe+6]-d.instancesEvaluatedElevation[ae]);const Pe=0|ve[fe+1];ve[fe]=(0|ve[fe])+z.r/1.05,ve[fe+1]=Pe+z.g/1.05,ve[fe+2]=$,ve[fe+3]=1/(C.z>10?this.tileToMeter:Qt(C,Pe)),ve[fe+4]=k[0],ve[fe+5]=k[1],ve[fe+6]=k[2]+Fe,ve[fe+7]=H[0],ve[fe+8]=H[1],ve[fe+9]=H[2],ve[fe+10]=H[4],ve[fe+11]=H[5],ve[fe+12]=H[6],ve[fe+13]=H[8],ve[fe+14]=H[9],ve[fe+15]=H[10],d.instancesEvaluatedElevation[ae]=k[2]}}}let cC,uC;Zi(Bx,"ModelBucket",{omit:["layers"]}),Zi(lC,"PerModelAttributes"),Zi(aC,"ModelFeature");const Zp=64,Hg={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function hC(l,i,o,d,f,m,v,C,T,F=!1){const k=o.zoom,z=o.project(d),H=vi(d.lat,k),$=1/H;M(l),Q(l,l,[z.x+v[0]*$,z.y+v[1]*$,v[2]]);let ee=1,ae=1;const fe=o.worldSize;if(F){if(o.projection.name==="mercator"){let ue=0;o.elevation&&(ue=o.elevation.getAtPointOrZero(new Ct(z.x/fe,z.y/fe),0));const Ie=Kt([],[z.x,z.y,ue,1],o.projMatrix)[3]/o.cameraToCenterDistance;ee=Ie,ae=Ie*vi(o.center.lat,k)}else if(o.projection.name==="globe"){const ue=bx(l,o),Ie=[0,0,0,1];Kt(Ie,Ie,U([],o.projMatrix,ue));const ke=Ie[3]/o.cameraToCenterDistance,Ge=np(k),yt=o.projection.pixelsPerMeter(d.lat,fe)*vi(d.lat,k),At=o.projection.pixelsPerMeter(o.center.lat,fe)*vi(o.center.lat,k);ee=ke/Er(yt,ri(o.center.lat),Ge),ae=ke*H/yt,ee*=At,ae*=At}}else ee=$;q(l,l,[ee,ee,ae]);const ve=[...l],Fe=i.orientation,Pe=[];if(nC(Pe,[Fe[0]+f[0],Fe[1]+f[1],Fe[2]+f[2]],m),U(l,ve,Pe),C&&o.elevation){let ue=0;const Ie=[];if(T&&o.elevation){ue=function(Ge,yt,At,_t,Mt){const Wt=yt.elevation;if(!Wt)return 0;const Si=De.projectAabbCorners(At,_t),Ai=ht(1,Mt.lat)*yt.worldSize,Ci=function(Pi,$r){const ar=[0,0,1],fr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Nr of fr){const an=Pi[Nr.corners[0]],on=Pi[Nr.corners[1]],_n=Pi[Nr.corners[2]],un=[on[0]-an[0],on[1]-an[1],$r*(on[2]-an[2])],xn=rt(un,un,[_n[0]-an[0],_n[1]-an[1],$r*(_n[2]-an[2])]);mt(xn,xn),Nr.dotProductWithUp=Bt(xn,ar)}return fr.sort((Nr,an)=>Nr.dotProductWithUp-an.dotProductWithUp),fr[0].corners}(Si,Ai),Ti=Si[Ci[0]],$t=Si[Ci[1]],_i=Si[Ci[2]],Vt=Si[Ci[3]],Yt=Wt.getAtPointOrZero(new Ct(Ti[0]/yt.worldSize,Ti[1]/yt.worldSize),0),ki=Wt.getAtPointOrZero(new Ct($t[0]/yt.worldSize,$t[1]/yt.worldSize),0),Di=Wt.getAtPointOrZero(new Ct(_i[0]/yt.worldSize,_i[1]/yt.worldSize),0),xr=Wt.getAtPointOrZero(new Ct(Vt[0]/yt.worldSize,Vt[1]/yt.worldSize),0),ur=(Yt+xr)/2,Xi=(ki+Di)/2;return ur>Xi?ki<Di?$v(Ge,$t,Vt,Ti,ki,xr,Yt,Ai):$v(Ge,_i,Ti,Vt,Di,Yt,xr,Ai):Yt<xr?$v(Ge,Ti,$t,_i,Yt,ki,Di,Ai):$v(Ge,Vt,_i,$t,xr,Di,ki,Ai),Math.max(ur,Xi)}(Ie,o,i.aabb,l,d);const ke=U([],be([],Ie),Pe);U(l,ve,ke)}else ue=o.elevation.getAtPointOrZero(new Ct(z.x/fe,z.y/fe),0);ue!==0&&(l[14]+=ue)}}function Jm(l,i,o=!1){l.uploaded||(l.gfxTexture=new vx(i,l.image,o?i.gl.R8:i.gl.RGBA8,{useMipmap:l.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function LM(l,i,o){l.indexBuffer=i.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=i.createVertexBuffer(l.vertexArray,BM.members,!1,!0),l.normalArray&&(l.normalBuffer=i.createVertexBuffer(l.normalArray,IM.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=i.createVertexBuffer(l.texcoordArray,EM.members,!1,!0)),l.colorArray&&(l.colorBuffer=i.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?CM:SM).members,!1,!0)),l.featureArray&&(l.pbrBuffer=i.createVertexBuffer(l.featureArray,FM.members,!0)),l.segments=Gs.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const d=l.material;d.pbrMetallicRoughness.baseColorTexture&&Jm(d.pbrMetallicRoughness.baseColorTexture,i),d.pbrMetallicRoughness.metallicRoughnessTexture&&Jm(d.pbrMetallicRoughness.metallicRoughnessTexture,i),d.normalTexture&&Jm(d.normalTexture,i),d.occlusionTexture&&Jm(d.occlusionTexture,i,o),d.emissionTexture&&Jm(d.emissionTexture,i)}function Cx(l,i,o){if(l.meshes)for(const d of l.meshes)LM(d,i,o);if(l.children)for(const d of l.children)Cx(d,i,o)}function Jv(l){if(l.meshes)for(const i of l.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(l.children)for(const i of l.children)Jv(i)}function Sx(l){if(l.meshes)for(const o of l.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((i=o.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(l.children)for(const o of l.children)Sx(o)}class Qg{constructor(i,o,d){this._demTile=i,this._dem=this._demTile.dem,this._scale=o,this._offset=d}static create(i,o,d){const f=d||i.findDEMTileFor(o);if(!f||!f.dem)return;const m=f.dem,v=f.tileID,C=1<<o.canonical.z-v.canonical.z;return new Qg(f,m.dim/wi/C,[(o.canonical.x/C-v.canonical.x)*m.dim,(o.canonical.y/C-v.canonical.y)*m.dim])}tileCoordToPixel(i,o){const d=o*this._scale+this._offset[1],f=Math.floor(i*this._scale+this._offset[0]),m=Math.floor(d);return new qt(f,m)}getElevationAt(i,o,d,f){const m=i*this._scale+this._offset[0],v=o*this._scale+this._offset[1],C=Math.floor(m),T=Math.floor(v),F=this._dem;return f=!!f,d?Er(Er(F.get(C,T,f),F.get(C,T+1,f),v-T),Er(F.get(C+1,T,f),F.get(C+1,T+1,f),v-T),m-C):F.get(C,T,f)}getElevationAtPixel(i,o,d){return this._dem.get(i,o,!!d)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*ht(1,i)*this._dem.stride}}const Ex=new Float32Array(262144),Jp=new Uint8Array(262144);function dC(l){let i=0;if(l.meshes)for(const o of l.meshes)i=Math.max(i,o.aabb.max[2]);if(l.children)for(const o of l.children)i=Math.max(i,dC(o));return i}function AC(l,i,o){if(l.meshes)for(const d of l.meshes){if(d.aabb.min[0]===1/0)continue;const f=De.applyTransform(d.aabb,l.matrix);o.insert(i,f.min[0],f.min[1],f.max[0],f.max[1])}if(l.children)for(const d of l.children)AC(d,i,o)}const fC=["","wall","door","roof","window","lamp","logo"];class pC{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:dC(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new De([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const o=new De([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const d of this.node.meshes)this.node.lightMeshIndex!==i&&(d.transformedAabb=De.applyTransformFast(d.aabb,this.node.matrix),o.encapsulate(d.transformedAabb)),i++;this.aabb=o}return this.aabb}}class e0{constructor(i,o,d,f,m,v,C,T){this.id=d,this.layers=i,this.layerIds=this.layers.map(F=>F.fqid),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.modelTraits|=Hg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=Hg.HasMapboxMeshFeatures),m&&(this.modelTraits|=Hg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.worldview=T,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const F of o)this.nodesInfo.push(new pC(F)),AC(F,C.featureIndexArray.length,C.grid),C.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,C.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,o){for(const d of this.getNodesInfo()){const f=d.node;f.footprint&&o.push({footprint:f.footprint,id:i})}}update(i){const o=Object.keys(i).length!==0;if(o&&!this.stateDependentLayers.length)return;const d=o?this.stateDependentLayers:this.layers;if(!Vn(i,this.states))for(const f of d)this.evaluate(f,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const d of o){const f=d.node;this.uploaded?this.updatePbrBuffer(f):Cx(f,i,!0)}for(const d of o)Jv(d.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let o=!1;if(!i.meshes)return o;for(const d of i.meshes)d.pbrBuffer&&(d.pbrBuffer.updateData(d.featureArray),o=!0);return o}needsReEvaluation(i,o,d){const f=i.transform.projectionOptions,m=i.style.getBrightness(),v=this.brightness!==m;if(!this.uploaded||this.dirty||f.name!==this.projection.name||ey(d.paint.get("model-color").value,v)||ey(d.paint.get("model-color-mix-intensity").value,v)||ey(d.paint.get("model-roughness").value,v)||ey(d.paint.get("model-emissive-strength").value,v)||ey(d.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=f,this.brightness=m;const C=this.getNodesInfo();for(const T of C)T.state=null;return!0}return!1}evaluateTransform(i,o){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const d=this.getNodesInfo(),f=this.id.canonical;for(const m of d){const v=m.feature;m.evaluatedTranslation=o.paint.get("model-translation").evaluate(v,{},f),m.evaluatedScale=o.paint.get("model-scale").evaluate(v,{},f)}}evaluate(i,o){const d=this.getNodesInfo();for(const f of d){if(!f.node.meshes)continue;const m=f.feature,v=o&&o[m.id];if(Vn(v,f.state))continue;f.state=structuredClone(v);const C=f.node.meshes&&f.node.meshes[0].featureData,T=f.evaluatedColor[2],F=f.evaluatedRMEA[2],k=this.id.canonical;if(f.hasTranslucentParts=!1,C){for(let z=0;z<fC.length;z++){const H=fC[z];H.length&&(m.properties.part=H);const $=i.paint.get("model-color").evaluate(m,v,k).toPremultipliedRenderColor(null),ee=i.paint.get("model-color-mix-intensity").evaluate(m,v,k);f.evaluatedColor[z]=[$.r,$.g,$.b,ee],f.evaluatedRMEA[z][0]=i.paint.get("model-roughness").evaluate(m,v,k),f.evaluatedRMEA[z][2]=i.paint.get("model-emissive-strength").evaluate(m,v,k),f.evaluatedRMEA[z][3]=$.a,f.emissionHeightBasedParams[z]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,v,k),!f.hasTranslucentParts&&$.a<1&&(f.hasTranslucentParts=!0)}delete m.properties.part,PM(f,T!==f.evaluatedColor[2]||F!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(m,v,k);f.evaluatedTranslation=i.paint.get("model-translation").evaluate(m,v,k),f.evaluatedScale=i.paint.get("model-scale").evaluate(m,v,k),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,o,d,f){const m=i.findDEMTileFor(d);if(m&&(m.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const v=Qg.create(i,d,m);if(!v)return;this.modelTraits&Hg.HasMapboxMeshFeatures&&this.updateDEM(i,v,d,f);for(const C of this.getNodesInfo()){const T=C.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const F=T.footprint.vertices;let k=v.getElevationAt(F[0].x,F[0].y,!0,!0);for(let z=1;z<F.length;z++)k=Math.min(k,v.getElevationAt(F[z].x,F[z].y,!0,!0));T.elevation=k}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=o}}updateDEM(i,o,d,f){let m=o._dem._modifiedForSources[f];if(m===void 0&&(o._dem._modifiedForSources[f]=[],m=o._dem._modifiedForSources[f]),m.includes(d.canonical))return;const v=o._dem.dim;m.push(d.canonical);let C=!1;for(const T of this.getNodesInfo()){const F=T.node;if(!F.footprint||!F.footprint.grid)continue;const k=F.footprint.grid,z=o.tileCoordToPixel(k.min.x,k.min.y),H=o.tileCoordToPixel(k.max.x,k.max.y),$=Math.min(Math.min(v-H.y,z.x),Math.min(z.y,v-H.x));if($<0)continue;const ee=Ye($,2,5);let ae=Math.max(0,z.x-ee),fe=Math.max(0,z.y-ee),ve=Math.min(H.x+ee,v-1),Fe=Math.min(H.y+ee,v-1);for(let ke=fe;ke<=Fe;++ke)for(let Ge=ae;Ge<=ve;++Ge)Jp[ke*v+Ge]=255;let Pe=0,ue=0;for(let ke=0;ke<k.cellsY;++ke)for(let Ge=0;Ge<k.cellsX;++Ge){if(!k.cells[ke*k.cellsX+Ge])continue;const yt=o.tileCoordToPixel(k.min.x+Ge/k.xScale,k.min.y+ke/k.yScale),At=o.tileCoordToPixel(k.min.x+(Ge+1)/k.xScale,k.min.y+(ke+1)/k.yScale);for(let _t=yt.y;_t<=Math.min(At.y+1,v-1);++_t)for(let Mt=yt.x;Mt<=Math.min(At.x+1,v-1);++Mt)Jp[_t*v+Mt]===255&&(Jp[_t*v+Mt]=0,Pe+=o.getElevationAtPixel(Mt,_t),ue++)}const Ie=Pe/ue;ae=Math.max(1,z.x-ee),fe=Math.max(1,z.y-ee),ve=Math.min(H.x+ee,v-2),Fe=Math.min(H.y+ee,v-2),C=!0;for(let ke=fe;ke<=Fe;++ke)for(let Ge=ae;Ge<=ve;++Ge)Jp[ke*v+Ge]===0&&(Ex[ke*v+Ge]=o._dem.set(Ge,ke,Ie));for(let ke=1;ke<ee;++ke){ae=Math.max(1,z.x-ke),fe=Math.max(1,z.y-ke),ve=Math.min(H.x+ke,v-2),Fe=Math.min(H.y+ke,v-2);for(let Ge=fe;Ge<=Fe;++Ge)for(let yt=ae;yt<=ve;++yt){const At=Ge*v+yt;if(Jp[At]===255){let _t=0,Mt=0,Wt=-1,Si=-1;for(let Ai=-1;Ai<=1;++Ai)for(let Ci=-1;Ci<=1;++Ci){const Ti=(Ge+Ai)*v+yt+Ci;if(Jp[Ti]>=ke)continue;const $t=Ex[Ti],_i=Math.abs($t);_i>Mt&&(_t=$t,Mt=_i,Wt=Ci,Si=Ai)}if(Mt>.1){const Ai=1-(ke+.5*Math.abs(Wt*Si))/ee;let Ci=o._dem.get(yt,Ge)+_t*Ai;const Ti=o._dem.get(yt+Wt,Ge+Si),$t=o._dem.get(yt-Wt,Ge-Si,!0);(Ci-Ti)*(Ci-$t)>0&&(Ci=(Ti+$t)/2),Ex[At]=o._dem.set(yt,Ge,Ci),Jp[At]=ke}}}}}C&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=vl.now())}setFilter(i){this.filter=i?bA(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(i=>this.filter.filter(new $n(this.id.overscaledZ,{worldview:this.worldview}),i.feature,this.id.canonical)):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const o of i)Jv(o.node),Sx(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(i.toUnwrapped());for(const f of this.getNodesInfo()){const m=f.node.footprint;f.hiddenByReplacement=!!m&&!d.find(v=>v.footprint===m)}}getHeightAtTileCoord(i,o){const d=[],f=[0,0,0],m=M([]);for(const v of this.getNodesInfo()){const C=v.node.meshes[0],T=C.transformedAabb;if(i<T.min[0]||o<T.min[1]||i>T.max[0]||o>T.max[1])continue;if(v.node.hidden===!0)return{height:1/0,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};G(m,v.node.matrix),f[0]=i,f[1]=o,vt(f,f,m);const F=(f[0]-C.aabb.min[0])/(C.aabb.max[0]-C.aabb.min[0])*Zp|0,k=Math.min(63,(f[1]-C.aabb.min[1])/(C.aabb.max[1]-C.aabb.min[1])*Zp|0)*Zp+Math.min(63,F),z=C.heightmap[k];if(!(z<0&&v.node.footprint))return v.hiddenByReplacement?void 0:{height:z,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};if(v.node.footprint.grid.query(new qt(i,o),new qt(i,o),d),d.length>0)return{height:void 0,maxHeight:v.feature.properties.height,hidden:v.hiddenByReplacement,verticalScale:v.evaluatedScale[2]}}}}function ey(l,i){return l instanceof ja&&!l.isLightConstant&&i}function MM(l,i,o,d,f,m,v,C){let T=(61440&i|(61440&i)>>4)>>8,F=(3840&i|(3840&i)>>4)>>4,k=240&i|(240&i)>>4;o[3]>0&&(T=Er(T,255*o[0],o[3]),F=Er(F,255*o[1],o[3]),k=Er(k,255*o[2],o[3]));const z=T<<8|F,H=k<<8|Math.floor(255*d[3]),$=function(ke){const Ge=Ye(ke,0,2);return Math.min(Math.round(.5*Ge*255),255)}(d[2])<<8|15*d[0]<<4|15*d[1],ee=Ye(f[0],0,1),ae=Ye(f[1],0,1),fe=Ye(f[2],0,1),ve=Ye(f[3],0,1);let Fe,Pe,ue,Ie;if(ee!==ae&&v!==m&&ae!==ee){const ke=v-m;Pe=1/(ke*(ae-ee)),ue=-(m+ke*ee)/(ke*(ae-ee));const Ge=Ye(f[4],-1,1);Ie=Math.pow(10,Ge),Fe=255*fe<<8|255*ve}else Fe=65535,Pe=0,ue=1,Ie=1;if(l.emplaceBack(z,H,$,Fe,Pe,ue,Ie),C){const ke=C.length;C.clear();for(let Ge=0;Ge<ke;Ge++)C.emplaceBack(z,H,$,Fe,Pe,ue,Ie)}}function PM(l,i,o){const d=l.node;let f=0;const m=o&Hg.HasMeshoptCompression;for(const v of d.meshes){if(d.lights&&d.lightMeshIndex===f||!v.featureData)continue;v.featureArray=new IA,v.featureArray.reserve(v.featureData.length);let C=i;for(const T of v.featureData){const F=m?65535&T:T>>16&65535,k=m?T>>16&65535:65535&T,z=(15&k)<8?15&k:0,H=l.evaluatedRMEA[z],$=l.evaluatedColor[z],ee=l.emissionHeightBasedParams[z];let ae;if(C&&z===2&&d.lights&&(ae=new IA,ae.resize(10*d.lights.length)),MM(v.featureArray,F,$,H,ee,v.aabb.min[2],v.aabb.max[2],ae),ae&&C){C=!1;const fe=d.meshes[d.lightMeshIndex];fe.featureArray=ae,fe.featureArray._trim()}}v.featureArray._trim(),f++}}function gC(l,i,o,d){const f=1<<l.z;i.lat=Rt((d/wi+l.y)/f),i.lng=ft((o/wi+l.x)/f)}function kM(l,i,o,d){const f=l.getNodesInfo()[i];if(!f||f.hiddenByReplacement||!f.node.meshes)return;let m=Number.MAX_VALUE;const v=f.node,C=o.tile,T=d.calculatePosMatrix(C.tileID.toUnwrapped(),d.worldSize),F=f.evaluatedScale;let k=0;d.elevation&&v.elevation&&(k=v.elevation*d.elevation.exaggeration()),Q(T,T,[(v.anchor?v.anchor[0]:0)*(F[0]-1),(v.anchor?v.anchor[1]:0)*(F[1]-1),k]),q(T,T,F);const z=o.queryGeometry,H=z.isPointQuery()?z.screenBounds:z.screenGeometry,$=function(ae){const fe=U([],T,ae.matrix);U(fe,d.expandedFarZProjMatrix,fe);for(let ve=0;ve<ae.meshes.length;++ve){const Fe=ae.meshes[ve];if(ve===ae.lightMeshIndex)continue;const Pe=sC(H,d,fe,Fe.aabb);Pe!=null&&(m=Math.min(Pe,m))}if(ae.children)for(const ve of ae.children)$(ve)};if($(v),m===Number.MAX_VALUE)return;const ee=new Te(0,0);return gC(C.tileID.canonical,ee,f.node.anchor[0],f.node.anchor[1]),{intersectionZ:m,position:ee,feature:f.feature}}Zi(e0,"Tiled3dModelBucket",{omit:["layers"]}),Zi(pC,"Tiled3dModelFeature");const RM={circle:class extends Xa{constructor(l,i,o,d){super(l,{layout:kc||(kc=new Ns({"circle-sort-key":new Gi(Lt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Ei(Lt.layout_circle["circle-elevation-reference"]),visibility:new Ei(Lt.layout_circle.visibility)})),paint:Rc||(Rc=new Ns({"circle-radius":new Gi(Lt.paint_circle["circle-radius"]),"circle-color":new Gi(Lt.paint_circle["circle-color"]),"circle-blur":new Gi(Lt.paint_circle["circle-blur"]),"circle-opacity":new Gi(Lt.paint_circle["circle-opacity"]),"circle-translate":new Ei(Lt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ei(Lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ei(Lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ei(Lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gi(Lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gi(Lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gi(Lt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ei(Lt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d)}createBucket(l){return new pi(l)}queryRadius(l){const i=l;return Ll("circle-radius",this,i)+Ll("circle-stroke-width",this,i)+go(this.paint.get("circle-translate"))}queryIntersectsFeature(l,i,o,d,f,m,v,C){const T=Rd(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o);return Iw(l,d,m,v,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,F)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,i,o){const d=Ew(this);return{config:new MA(this,{zoom:i,lut:o}),defines:d,overrideFog:!1}}is3D(l){return!l&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Xa{createBucket(l){return new Fw(l)}constructor(l,i,o,d){super(l,{layout:Lw||(Lw=new Ns({visibility:new Ei(Lt.layout_heatmap.visibility)})),paint:Mw||(Mw=new Ns({"heatmap-radius":new Gi(Lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gi(Lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ei(Lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Yu(Lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ei(Lt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Im({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return Ll("heatmap-radius",this,l)}queryIntersectsFeature(l,i,o,d,f,m,v,C){const T=this.paint.get("heatmap-radius").evaluate(i,o);return Iw(l,d,m,v,C,!0,!0,new qt(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,i,o){return l==="heatmap"?{config:new MA(this,{zoom:i,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Xa{constructor(l,i,o,d){super(l,{layout:Pw||(Pw=new Ns({visibility:new Ei(Lt.layout_hillshade.visibility)})),paint:kw||(kw=new Ns({"hillshade-illumination-direction":new Ei(Lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ei(Lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ei(Lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ei(Lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ei(Lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ei(Lt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ei(Lt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,i,o){return{overrideFog:!1}}},fill:class extends Xa{constructor(l,i,o,d){super(l,{layout:Kw||(Kw=new Ns({"fill-sort-key":new Gi(Lt.layout_fill["fill-sort-key"]),visibility:new Ei(Lt.layout_fill.visibility),"fill-elevation-reference":new Ei(Lt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Gi(Lt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:qw||(qw=new Ns({"fill-antialias":new Ei(Lt.paint_fill["fill-antialias"]),"fill-opacity":new Gi(Lt.paint_fill["fill-opacity"]),"fill-color":new Gi(Lt.paint_fill["fill-color"]),"fill-outline-color":new Gi(Lt.paint_fill["fill-outline-color"]),"fill-translate":new Ei(Lt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ei(Lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Gi(Lt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Ei(Lt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Ei(Lt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Gi(Lt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Gi(Lt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Gi(Lt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d)}getProgramIds(){const l=this.paint.get("fill-pattern"),i=l&&l.constantOr(1),o=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(l,i,o){return{config:new MA(this,{zoom:i,lut:o}),overrideFog:!1}}recalculate(l,i){super.recalculate(l,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new U_(l)}queryRadius(){return go(this.paint.get("fill-translate"))}queryIntersectsFeature(l,i,o,d,f,m){return!l.queryGeometry.isAboveHorizon&&vr(Ml(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),d)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(l){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return l!=null?i&&!l:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Xa{constructor(l,i,o,d){super(l,{layout:x2||(x2=new Ns({visibility:new Ei(Lt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ei(Lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:b2||(b2=new Ns({"fill-extrusion-opacity":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Gi(Lt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ei(Lt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new Cv(l)}queryRadius(){return go(this.paint.get("fill-extrusion-translate"))}is3D(l){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,i,o,d,f,m,v,C,T){const F=Rd(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(i,o),z=this.paint.get("fill-extrusion-base").evaluate(i,o),H=[0,0],$=C&&m.elevation,ee=m.elevation?m.elevation.exaggeration():1,ae=l.tile.getBucket(this);if($&&ae instanceof Cv){const ue=ae.centroidVertexArray,Ie=T+1;Ie<ue.length&&(H[0]=ue.geta_centroid_pos0(Ie),H[1]=ue.geta_centroid_pos1(Ie))}if(H[0]===0&&H[1]===1)return!1;m.projection.name==="globe"&&(d=_2([d],[new qt(0,0),new qt(wi,wi)],l.tileID.canonical).map(ue=>ue.polygon).flat());const fe=$?C:null,[ve,Fe]=function(ue,Ie,ke,Ge,yt,At,_t,Mt,Wt,Si,Ai){return ue.projection.name==="globe"?function(Ci,Ti,$t,_i,Vt,Yt,ki,Di,xr,ur,Xi){const Pi=[],$r=[],ar=Ci.projection.upVectorScale(Xi,Ci.center.lat,Ci.worldSize).metersToTile,fr=[0,0,0,1],Nr=[0,0,0,1],an=(_n,un,xn,as)=>{_n[0]=un,_n[1]=xn,_n[2]=as,_n[3]=1},on=v2();$t>0&&($t+=on),_i+=on;for(const _n of Ti){const un=[],xn=[];for(const as of _n){const js=as.x+Vt.x,Ne=as.y+Vt.y,Xe=Ci.projection.projectTilePoint(js,Ne,Xi),Jt=Ci.projection.upVector(Xi,as.x,as.y);let zi=$t,Yi=_i;if(ki){const Wi=I2(js,Ne,$t,_i,ki,Di,xr,ur);zi+=Wi.base,Yi+=Wi.top}$t!==0?an(fr,Xe.x+Jt[0]*ar*zi,Xe.y+Jt[1]*ar*zi,Xe.z+Jt[2]*ar*zi):an(fr,Xe.x,Xe.y,Xe.z),an(Nr,Xe.x+Jt[0]*ar*Yi,Xe.y+Jt[1]*ar*Yi,Xe.z+Jt[2]*ar*Yi),vt(fr,fr,Yt),vt(Nr,Nr,Yt),un.push(new Yp(fr[0],fr[1],fr[2])),xn.push(new Yp(Nr[0],Nr[1],Nr[2]))}Pi.push(un),$r.push(xn)}return[Pi,$r]}(ue,Ie,ke,Ge,yt,At,_t,Mt,Wt,Si,Ai):_t?function(Ci,Ti,$t,_i,Vt,Yt,ki,Di,xr){const ur=[],Xi=[],Pi=[0,0,0,1];for(const $r of Ci){const ar=[],fr=[];for(const Nr of $r){const an=Nr.x+_i.x,on=Nr.y+_i.y,_n=I2(an,on,Ti,$t,Yt,ki,Di,xr);Pi[0]=an,Pi[1]=on,Pi[2]=_n.base,Pi[3]=1,Kt(Pi,Pi,Vt),Pi[3]=Math.max(Pi[3],1e-5);const un=new Yp(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);Pi[0]=an,Pi[1]=on,Pi[2]=_n.top,Pi[3]=1,Kt(Pi,Pi,Vt),Pi[3]=Math.max(Pi[3],1e-5);const xn=new Yp(Pi[0]/Pi[3],Pi[1]/Pi[3],Pi[2]/Pi[3]);ar.push(un),fr.push(xn)}ur.push(ar),Xi.push(fr)}return[ur,Xi]}(Ie,ke,Ge,yt,At,_t,Mt,Wt,Si):function(Ci,Ti,$t,_i,Vt){const Yt=[],ki=[],Di=Vt[8]*Ti,xr=Vt[9]*Ti,ur=Vt[10]*Ti,Xi=Vt[11]*Ti,Pi=Vt[8]*$t,$r=Vt[9]*$t,ar=Vt[10]*$t,fr=Vt[11]*$t;for(const Nr of Ci){const an=[],on=[];for(const _n of Nr){const un=_n.x+_i.x,xn=_n.y+_i.y,as=Vt[0]*un+Vt[4]*xn+Vt[12],js=Vt[1]*un+Vt[5]*xn+Vt[13],Ne=Vt[2]*un+Vt[6]*xn+Vt[14],Xe=Vt[3]*un+Vt[7]*xn+Vt[15],Jt=as+Di,zi=js+xr,Yi=Ne+ur,Wi=Math.max(Xe+Xi,1e-5),or=as+Pi,Or=js+$r,Bn=Ne+ar,Cn=Math.max(Xe+fr,1e-5);an.push(new Yp(Jt/Wi,zi/Wi,Yi/Wi)),on.push(new Yp(or/Cn,Or/Cn,Bn/Cn))}Yt.push(an),ki.push(on)}return[Yt,ki]}(Ie,ke,Ge,yt,At)}(m,d,z,k,F,v,fe,H,ee,m.center.lat,l.tileID.canonical),Pe=l.queryGeometry;return function(ue,Ie,ke){let Ge=1/0;vr(ke,Ie)&&(Ge=E2(ke,Ie[0]));for(let yt=0;yt<Ie.length;yt++){const At=Ie[yt],_t=ue[yt];for(let Mt=0;Mt<At.length-1;Mt++){const Wt=At[Mt],Si=[Wt,At[Mt+1],_t[Mt+1],_t[Mt],Wt];Ui(ke,Si)&&(Ge=Math.min(Ge,E2(ke,Si)))}}return Ge!==1/0&&Ge}(ve,Fe,Pe.isPointQuery()?Pe.screenBounds:Pe.screenGeometry)}},building:class extends Xa{constructor(l,i,o,d){super(l,{layout:N2||(N2=new Ns({visibility:new Ei(Lt.layout_building.visibility),"building-roof-shape":new Gi(Lt.layout_building["building-roof-shape"]),"building-height":new Gi(Lt.layout_building["building-height"]),"building-base":new Gi(Lt.layout_building["building-base"])})),paint:j2||(j2=new Ns({"building-opacity":new Ei(Lt.paint_building["building-opacity"]),"building-ambient-occlusion-wall-intensity":new Ei(Lt.paint_building["building-ambient-occlusion-wall-intensity"]),"building-ambient-occlusion-ground-intensity":new Ei(Lt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Ei(Lt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Ei(Lt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Ei(Lt.paint_building["building-vertical-scale"]),"building-cast-shadows":new Ei(Lt.paint_building["building-cast-shadows"]),"building-color":new Gi(Lt.paint_building["building-color"]),"building-emissive-strength":new Gi(Lt.paint_building["building-emissive-strength"]),"building-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new z2(l)}},line:class extends Xa{constructor(l,i,o,d){const f=$2();super(l,f,i,o,d),f.layout&&(this.layout=new Zc(f.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof il,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,i){super.recalculate(l,i),this.paint._values["line-floorwidth"]=(()=>{if(Hm)return Hm;const o=$2();return Hm=new ML(o.paint.properties["line-width"].specification),Hm.useIntegerZoom=!0,Hm})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new $_(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,i,o){const d=K2(this);return{config:new MA(this,{zoom:i,lut:o}),defines:d,overrideFog:!1}}queryRadius(l){const i=l,o=Z2(Ll("line-width",this,i),Ll("line-gap-width",this,i)),d=Ll("line-offset",this,i);return o/2+Math.abs(d)+go(this.paint.get("line-translate"))}queryIntersectsFeature(l,i,o,d,f,m){if(l.queryGeometry.isAboveHorizon)return!1;const v=Ml(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,l.pixelToTileUnitsFactor),C=l.pixelToTileUnitsFactor/2*Z2(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),T=this.paint.get("line-offset").evaluate(i,o);return T&&(d=function(F,k){const z=[],H=new qt(0,0);for(let $=0;$<F.length;$++){const ee=F[$],ae=[];for(let fe=0;fe<ee.length;fe++){const ve=ee[fe],Fe=ee[fe+1],Pe=fe===0?H:ve.sub(ee[fe-1])._unit()._perp(),ue=fe===ee.length-1?H:Fe.sub(ve)._unit()._perp(),Ie=Pe._add(ue)._unit();Ie._mult(1/(Ie.x*ue.x+Ie.y*ue.y)),ae.push(Ie._mult(k)._add(ve))}z.push(ae)}return z}(d,T*l.pixelToTileUnitsFactor)),function(F,k,z){for(let H=0;H<k.length;H++){const $=k[H];if(F.length>=3){for(let ee=0;ee<$.length;ee++)if(os(F,$[ee]))return!0}if(Rr(F,$,z))return!0}return!1}(v,d,C)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(l){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:Wv,background:class extends Xa{constructor(l,i,o,d){super(l,{layout:HB||(HB=new Ns({visibility:new Ei(Lt.layout_background.visibility)})),paint:QB||(QB=new Ns({"background-pitch-alignment":new Ei(Lt.paint_background["background-pitch-alignment"]),"background-color":new Ei(Lt.paint_background["background-color"]),"background-pattern":new Ei(Lt.paint_background["background-pattern"]),"background-opacity":new Ei(Lt.paint_background["background-opacity"]),"background-emissive-strength":new Ei(Lt.paint_background["background-emissive-strength"]),"background-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,i,o){return{overrideFog:!1}}is3D(l){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:YB,"raster-particle":eC,sky:class extends Xa{constructor(l,i,o,d){super(l,{layout:$B||($B=new Ns({visibility:new Ei(Lt.layout_sky.visibility)})),paint:ZB||(ZB=new Ns({"sky-type":new Ei(Lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ei(Lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ei(Lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ei(Lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ei(Lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Yu(Lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ei(Lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ei(Lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ei(Lt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Im({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(l,i){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),f=!d,m=l.style.light,v=m.properties.get("position");return f&&m.properties.get("anchor")==="viewport"&&Yr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?_x(v.azimuthal,90-v.polar,i):_x(d[0],90-d[1],i)}const o=this.paint.get("sky-gradient-center");return _x(o[0],90-o[1],i)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends Xa{constructor(l,i,o,d){super(l,{paint:JB||(JB=new Ns({}))},i,null)}},model:class extends Xa{constructor(l,i,o,d){super(l,{layout:cC||(cC=new Ns({visibility:new Ei(Lt.layout_model.visibility),"model-id":new Gi(Lt.layout_model["model-id"])})),paint:uC||(uC=new Ns({"model-opacity":new Gi(Lt.paint_model["model-opacity"]),"model-rotation":new Gi(Lt.paint_model["model-rotation"]),"model-scale":new Gi(Lt.paint_model["model-scale"]),"model-translation":new Gi(Lt.paint_model["model-translation"]),"model-color":new Gi(Lt.paint_model["model-color"]),"model-color-mix-intensity":new Gi(Lt.paint_model["model-color-mix-intensity"]),"model-type":new Ei(Lt.paint_model["model-type"]),"model-cast-shadows":new Ei(Lt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ei(Lt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ei(Lt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Gi(Lt.paint_model["model-emissive-strength"]),"model-roughness":new Gi(Lt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Gi(Lt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ei(Lt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ei(Lt.paint_model["model-front-cutoff"]),"model-color-use-theme":new Gi({type:"string",default:"default","property-type":"data-driven"})}))},i,o,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new Bx(l)}getProgramIds(){return["model"]}is3D(l){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof e0?wi-1:0}queryIntersectsFeature(l,i,o,d,f,m){if(!this.modelManager)return!1;const v=this.modelManager,C=l.tile.getBucket(this);if(!(C&&C instanceof Bx))return!1;for(const T in C.instancesPerModel){const F=C.instancesPerModel[T],k=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(F.idToFeaturesIndex.hasOwnProperty(k)){const z=F.features[F.idToFeaturesIndex[k]],H=v.getModel(T,this.scope);if(!H)return!1;let $=R();const ee=new Te(0,0),ae=C.canonical;let fe=Number.MAX_VALUE;for(let ve=0;ve<z.instancedDataCount;++ve){const Fe=16*(z.instancedDataOffset+ve),Pe=F.instancedDataArray.float32,ue=[Pe[Fe+4],Pe[Fe+5],Pe[Fe+6]];gC(ae,ee,Pe[Fe],0|Pe[Fe+1]),hC($,H,m,ee,z.rotation,z.scale,ue,!1,!1,!1),m.projection.name==="globe"&&($=bx($,m));const Ie=U([],m.projMatrix,$),ke=l.queryGeometry,Ge=sC(ke.isPointQuery()?ke.screenBounds:ke.screenGeometry,m,Ie,H.aabb);Ge!=null&&(fe=Math.min(Ge,fe))}return fe!==Number.MAX_VALUE&&fe}}return!1}_handleOverridablePaintPropertyUpdate(l,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const i=this._transitionablePaint._values[l];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof Ha}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Xa{constructor(l,i,o,d){super(l,{layout:$w||($w=new Ns({"clip-layer-types":new Ei(Lt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ei(Lt.layout_clip["clip-layer-scope"])})),paint:Zw||(Zw=new Ns({}))},i,o,d)}recalculate(l,i){super.recalculate(l,i)}createBucket(l){return new Jw(l)}is3D(l){return!0}}},Ix=new jn(0,0,0),Tx={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},Fx={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},t0={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},DM={PAINT_ORDER_FILL_AND_STROKE:1},ty={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},mC={MASK_TYPE_LUMINANCE:1};function OM(l,i,o){l===1&&i.icons.push(function(d,f){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:v}=m;if(v.content_area){const{content_area:C}=v;C.top==null&&(C.top=C.left),C.width==null&&(C.width=m.usvg_tree.width),C.height==null&&(C.height=C.width)}return v.stretch_x&&v.stretch_x.length&&yC(v,"x"),v.stretch_y&&v.stretch_y.length&&yC(v,"y"),m}(d.readFields(UM,{name:void 0},f))}(o,o.readVarint()+o.pos))}function yC(l,i){const o=[],d=l[`stretch_${i}`];let f=null;for(let m=0;m<d.length;m++)f===null?f=o.length===0?d[0]:o[o.length-1][1]+d[m]:(o.push([f,f+d[m]]),f=null);l[`stretch_${i}_areas`]=o}function UM(l,i,o){l===1?i.name=o.readString():l===2?i.metadata=function(d,f){return d.readFields(zM,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)}(o,o.readVarint()+o.pos):l===3&&(i.usvg_tree=function(d,f){return d.readFields(HM,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)}(o,o.readVarint()+o.pos),i.data="usvg_tree")}function zM(l,i,o){l===1?i.stretch_x=o.readPackedVarint():l===2?i.stretch_y=o.readPackedVarint():l===3?i.content_area=function(d,f){return d.readFields(NM,{left:0},f)}(o,o.readVarint()+o.pos):l===4&&i.variables.push(function(d,f){return d.readFields(jM,{name:void 0},f)}(o,o.readVarint()+o.pos))}function NM(l,i,o){l===1?i.left=o.readVarint():l===2?i.width=o.readVarint():l===3?i.top=o.readVarint():l===4&&(i.height=o.readVarint())}function jM(l,i,o){l===1?i.name=o.readString():l===2&&(i.rgb_color=n0(o.readVarint()),i.value="rgb_color")}function HM(l,i,o){l===1?i.width=i.height=o.readVarint():l===2?i.height=o.readVarint():l===3?i.children.push(i0(o,o.readVarint()+o.pos)):l===4?i.linear_gradients.push(function(d,f){return d.readFields(KM,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)}(o,o.readVarint()+o.pos)):l===5?i.radial_gradients.push(function(d,f){return d.readFields($M,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)}(o,o.readVarint()+o.pos)):l===7?i.clip_paths.push(function(d,f){return d.readFields(ZM,{children:[]},f)}(o,o.readVarint()+o.pos)):l===8&&i.masks.push(function(d,f){const m=d.readFields(JM,{left:0,width:20,mask_type:mC.MASK_TYPE_LUMINANCE,children:[]},f);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(o,o.readVarint()+o.pos))}function i0(l,i){return l.readFields(QM,{},i)}function QM(l,i,o){l===1?(i.group=function(d,f){return d.readFields(VM,{opacity:255,children:[]},f)}(o,o.readVarint()+o.pos),i.node="group"):l===2&&(i.path=function(d,f){return d.readFields(WM,{paint_order:1,commands:[],step:1,diffs:[],rule:Tx.PATH_RULE_NON_ZERO},f)}(o,o.readVarint()+o.pos),i.node="path")}function VM(l,i,o){l===1?i.transform=r0(o,o.readVarint()+o.pos):l===2?i.opacity=o.readVarint():l===5?i.clip_path_idx=o.readVarint():l===6?i.mask_idx=o.readVarint():l===7&&i.children.push(i0(o,o.readVarint()+o.pos))}function r0(l,i){return l.readFields(GM,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function GM(l,i,o){l===1?i.sx=o.readFloat():l===2?i.ky=o.readFloat():l===3?i.kx=o.readFloat():l===4?i.sy=o.readFloat():l===5?i.tx=o.readFloat():l===6&&(i.ty=o.readFloat())}function WM(l,i,o){l===1?i.fill=function(d,f){return d.readFields(XM,{rgb_color:Ix,paint:"rgb_color",opacity:255},f)}(o,o.readVarint()+o.pos):l===2?i.stroke=function(d,f){return d.readFields(YM,{rgb_color:Ix,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)}(o,o.readVarint()+o.pos):l===3?i.paint_order=o.readVarint():l===5?o.readPackedVarint(i.commands):l===6?i.step=o.readFloat():l===7?o.readPackedSVarint(i.diffs):l===8&&(i.rule=o.readVarint())}function XM(l,i,o){l===1?(i.rgb_color=n0(o.readVarint()),i.paint="rgb_color"):l===2?(i.linear_gradient_idx=o.readVarint(),i.paint="linear_gradient_idx"):l===3?(i.radial_gradient_idx=o.readVarint(),i.paint="radial_gradient_idx"):l===5&&(i.opacity=o.readVarint())}function n0(l){return new jn((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function YM(l,i,o){l===1?(i.rgb_color=n0(o.readVarint()),i.paint="rgb_color"):l===2?(i.linear_gradient_idx=o.readVarint(),i.paint="linear_gradient_idx"):l===3?(i.radial_gradient_idx=o.readVarint(),i.paint="radial_gradient_idx"):l===5?o.readPackedFloat(i.dasharray):l===6?i.dashoffset=o.readFloat():l===7?i.miterlimit=o.readFloat():l===8?i.opacity=o.readVarint():l===9?i.width=o.readFloat():l===10?i.linecap=o.readVarint():l===11&&(i.linejoin=o.readVarint())}function KM(l,i,o){l===1?i.transform=r0(o,o.readVarint()+o.pos):l===2?i.spread_method=o.readVarint():l===3?i.stops.push(vC(o,o.readVarint()+o.pos)):l===4?i.x1=o.readFloat():l===5?i.y1=o.readFloat():l===6?i.x2=o.readFloat():l===7&&(i.y2=o.readFloat())}function vC(l,i){return l.readFields(qM,{offset:0,opacity:255,rgb_color:Ix},i)}function qM(l,i,o){l===1?i.offset=o.readFloat():l===2?i.opacity=o.readVarint():l===3&&(i.rgb_color=n0(o.readVarint()))}function $M(l,i,o){l===1?i.transform=r0(o,o.readVarint()+o.pos):l===2?i.spread_method=o.readVarint():l===3?i.stops.push(vC(o,o.readVarint()+o.pos)):l===4?i.cx=o.readFloat():l===5?i.cy=o.readFloat():l===6?i.r=o.readFloat():l===7?i.fx=o.readFloat():l===8?i.fy=o.readFloat():l===9&&(i.fr=o.readFloat())}function ZM(l,i,o){l===1?i.transform=r0(o,o.readVarint()+o.pos):l===2?i.clip_path_idx=o.readVarint():l===3&&i.children.push(i0(o,o.readVarint()+o.pos))}function JM(l,i,o){l===1?i.left=i.top=o.readFloat():l===2?i.width=i.height=o.readFloat():l===3?i.top=o.readFloat():l===4?i.height=o.readFloat():l===5?i.mask_type=o.readVarint():l===6?i.mask_idx=o.readVarint():l===7&&i.children.push(i0(o,o.readVarint()+o.pos))}class e3{static calculate(i={},o=[]){const d=new Map,f=new Map;if(Object.keys(i).length===0)return d;o.forEach(m=>{f.set(m.name,m.rgb_color||new jn(0,0,0))});for(const[m,v]of Object.entries(i))f.has(m)?d.set(f.get(m).toString(),v):console.warn(`Ignoring unknown image variable "${m}"`);return d}}function Vg(l,i=255,o){const d=i/255,f=l.toString(),m=o.has(f)?o.get(f).clone():l.clone();return m.a*=d,m.toString()}function iy(l,i){if(!Ou()){const o=document.createElement("canvas");return o.width=l,o.height=i,o}return new OffscreenCanvas(l,i)}function t3(l,i){const o=e3.calculate(i.params,l.metadata?l.metadata.variables:[]),d=l.usvg_tree,f=d.width,m=d.height,v=i.transform?i.transform:new DOMMatrix,C=Math.max(1,Math.round(f*v.a)),T=Math.max(1,Math.round(m*v.d)),F=new DOMMatrix([C/f,0,0,T/m,0,0]),k=iy(C,T).getContext("2d");return Lx(k,F,d,d,o),k.getImageData(0,0,C,T)}function Lx(l,i,o,d,f){for(const m of d.children)_C(l,i,o,m,f)}function _C(l,i,o,d,f){d.group?(l.save(),function(m,v,C,T,F){const k=T.mask_idx!=null?C.masks[T.mask_idx]:null,z=T.clip_path_idx!=null?C.clip_paths[T.clip_path_idx]:null;if(T.transform&&(v=Gg(T.transform).preMultiplySelf(v)),!function(ee,ae,fe){return ee.opacity!==255||ae||fe}(T,z!=null,k!=null))return void Lx(m,v,C,T,F);const H=iy(m.canvas.width,m.canvas.height),$=H.getContext("2d");Lx($,v,C,T,F),z&&EC($,v,C,z),k&&IC($,v,C,k,F),m.globalAlpha=T.opacity/255,m.drawImage(H,0,0)}(l,i,o,d.group,f),l.restore()):d.path&&(l.save(),function(m,v,C,T,F){m.setTransform(v),T.paint_order===DM.PAINT_ORDER_FILL_AND_STROKE?(xC(m,C,T,F),wC(m,C,T,F)):(wC(m,C,T,F),xC(m,C,T,F))}(l,i,o,d.path,f),l.restore())}function xC(l,i,o,d){const f=o.fill;if(!f)return;const m=f.opacity/255;switch(l.save(),l.beginPath(),TC(o,l),f.paint){case"rgb_color":l.fillStyle=Vg(f.rgb_color,f.opacity,d);break;case"linear_gradient_idx":{const v=i.linear_gradients[f.linear_gradient_idx];v.transform&&l.setTransform(Gg(v.transform).preMultiplySelf(l.getTransform())),l.fillStyle=BC(l,v,m,d);break}case"radial_gradient_idx":{const v=i.radial_gradients[f.radial_gradient_idx];v.transform&&l.setTransform(Gg(v.transform).preMultiplySelf(l.getTransform())),l.fillStyle=CC(l,v,m,d)}}l.fill(bC(o)),l.restore()}function bC(l){return l.rule===Tx.PATH_RULE_NON_ZERO?"nonzero":l.rule===Tx.PATH_RULE_EVEN_ODD?"evenodd":void 0}function wC(l,i,o,d){const f=o.stroke;if(!f)return;const m=FC(o);l.lineWidth=f.width,l.miterLimit=f.miterlimit,l.setLineDash(f.dasharray),l.lineDashOffset=f.dashoffset;const v=f.opacity/255;switch(f.paint){case"rgb_color":l.strokeStyle=Vg(f.rgb_color,f.opacity,d);break;case"linear_gradient_idx":l.strokeStyle=BC(l,i.linear_gradients[f.linear_gradient_idx],v,d,!0);break;case"radial_gradient_idx":l.strokeStyle=CC(l,i.radial_gradients[f.radial_gradient_idx],v,d,!0)}switch(f.linejoin){case t0.LINE_JOIN_MITER_CLIP:case t0.LINE_JOIN_MITER:l.lineJoin="miter";break;case t0.LINE_JOIN_ROUND:l.lineJoin="round";break;case t0.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(f.linecap){case Fx.LINE_CAP_BUTT:l.lineCap="butt";break;case Fx.LINE_CAP_ROUND:l.lineCap="round";break;case Fx.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(m)}function BC(l,i,o,d,f=!1){if(i.stops.length===1){const H=i.stops[0];return Vg(H.rgb_color,H.opacity*o,d)}const{x1:m,y1:v,x2:C,y2:T}=i;let F=new DOMPoint(m,v),k=new DOMPoint(C,T);if(f){const H=Gg(i.transform);F=H.transformPoint(F),k=H.transformPoint(k)}const z=l.createLinearGradient(F.x,F.y,k.x,k.y);for(const H of i.stops)z.addColorStop(H.offset,Vg(H.rgb_color,H.opacity*o,d));return z}function CC(l,i,o,d,f=!1){if(i.stops.length===1){const ve=i.stops[0];return Vg(ve.rgb_color,ve.opacity*o,d)}const m=Gg(i.transform),{fx:v,fy:C,fr:T,cx:F,cy:k,r:z}=i;let H=new DOMPoint(v,C),$=new DOMPoint(F,k),ee=T,ae=z;if(f){H=m.transformPoint(H),$=m.transformPoint($);const ve=(m.a+m.d)/2;ee=T*ve,ae=i.r*ve}const fe=l.createRadialGradient(H.x,H.y,ee,$.x,$.y,ae);for(const ve of i.stops)fe.addColorStop(ve.offset,Vg(ve.rgb_color,ve.opacity*o,d));return fe}function SC(l,i,o,d){const f=d.transform?Gg(d.transform).preMultiplySelf(i):i,m=iy(l.canvas.width,l.canvas.height),v=m.getContext("2d");for(const T of d.children)if(T.group)SC(v,f,o,T.group);else if(T.path){const F=T.path,k=new Path2D;k.addPath(FC(F),f),v.fill(k,bC(F))}const C=d.clip_path_idx!=null?o.clip_paths[d.clip_path_idx]:null;C&&EC(v,f,o,C),l.globalCompositeOperation="source-over",l.drawImage(m,0,0)}function EC(l,i,o,d){const f=iy(l.canvas.width,l.canvas.height);SC(f.getContext("2d"),i,o,d),l.globalCompositeOperation="destination-in",l.drawImage(f,0,0)}function IC(l,i,o,d,f){if(d.children.length===0)return;const m=d.mask_idx!=null?o.masks[d.mask_idx]:null;m&&IC(l,i,o,m,f);const v=l.canvas.width,C=l.canvas.height,T=iy(v,C),F=T.getContext("2d"),k=d.width,z=d.height,H=d.left,$=d.top,ee=new Path2D,ae=new Path2D;ae.rect(H,$,k,z),ee.addPath(ae,i),F.clip(ee);for(const Fe of d.children)_C(F,i,o,Fe,f);const fe=F.getImageData(0,0,v,C),ve=fe.data;if(d.mask_type===mC.MASK_TYPE_LUMINANCE)for(let Fe=0;Fe<ve.length;Fe+=4)ve[Fe+3]=ve[Fe+3]/255*(.2126*ve[Fe]+.7152*ve[Fe+1]+.0722*ve[Fe+2]);F.putImageData(fe,0,0),l.globalCompositeOperation="destination-in",l.drawImage(T,0,0)}function Gg(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function TC(l,i){const o=l.step;let d=l.diffs[0]*o,f=l.diffs[1]*o;i.moveTo(d,f);for(let m=0,v=2;m<l.commands.length;m++)switch(l.commands[m]){case ty.PATH_COMMAND_MOVE:d+=l.diffs[v++]*o,f+=l.diffs[v++]*o,i.moveTo(d,f);break;case ty.PATH_COMMAND_LINE:d+=l.diffs[v++]*o,f+=l.diffs[v++]*o,i.lineTo(d,f);break;case ty.PATH_COMMAND_QUAD:{const C=d+l.diffs[v++]*o,T=f+l.diffs[v++]*o;d=C+l.diffs[v++]*o,f=T+l.diffs[v++]*o,i.quadraticCurveTo(C,T,d,f);break}case ty.PATH_COMMAND_CUBIC:{const C=d+l.diffs[v++]*o,T=f+l.diffs[v++]*o,F=C+l.diffs[v++]*o,k=T+l.diffs[v++]*o;d=F+l.diffs[v++]*o,f=k+l.diffs[v++]*o,i.bezierCurveTo(C,T,F,k,d,f);break}case ty.PATH_COMMAND_CLOSE:i.closePath()}return i}function FC(l){return TC(l,new Path2D)}class s0{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const o=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,o),o}put(i,o){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,o)}delete(i){this.cache.delete(i)}}Zi(s0,"LRUCache");class Mx{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new Pl(i,i.data)}getFromCache(i,o,d){return this.cacheMap.has(d)||this.cacheMap.set(d,new s0(150)),this.cacheMap.get(d).get(Jc(i.toString(),o))}setInCache(i,o,d,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new s0(150));const m=this.cacheDependenciesMap.get(f),v=Jc(i.id.toString(),d);m.get(v)||m.set(v,new Set);const C=this.cacheMap.get(f),T=i.toString();m.get(v).add(T),C.put(Jc(i.toString(),d),o)}removeImagesFromCacheByIds(i,o,d=0){if(!this.cacheMap.has(d)||!this.cacheDependenciesMap.has(d))return;const f=this.cacheMap.get(d),m=this.cacheDependenciesMap.get(d);for(const v of i){const C=Jc(v.toString(),o);if(m.has(C)){for(const T of m.get(C))f.delete(T);m.delete(C)}}}rasterize(i,o,d,f,m=t3){const v=this.getFromCache(i,d,f);if(v)return v.clone();const C=m(o.icon,i.options),T=Mx._getImage(C);return this.setInCache(i,T,d,f),T.clone()}}class LC{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,o){const d=this.toIdx(i,o);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(i,o){return this.leaves[this.toIdx(i,o)]}toIdx(i,o){return o*this.size+i}}function MC(l,i,o,d){let f=0,m=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(d[v])<1e-15){if(o[v]<l[v]||o[v]>i[v])return null}else{const C=1/d[v];let T=(l[v]-o[v])*C,F=(i[v]-o[v])*C;if(T>F){const k=T;T=F,F=k}if(T>f&&(f=T),F<m&&(m=F),f>m)return null}return f}function PC(l,i,o,d,f,m,v,C,T,F,k){const z=d-l,H=f-i,$=m-o,ee=v-l,ae=C-i,fe=T-o,ve=k[1]*fe-k[2]*ae,Fe=k[2]*ee-k[0]*fe,Pe=k[0]*ae-k[1]*ee,ue=z*ve+H*Fe+$*Pe;if(Math.abs(ue)<1e-15)return null;const Ie=1/ue,ke=F[0]-l,Ge=F[1]-i,yt=F[2]-o,At=(ke*ve+Ge*Fe+yt*Pe)*Ie;if(At<0||At>1)return null;const _t=Ge*$-yt*H,Mt=yt*z-ke*$,Wt=ke*H-Ge*z,Si=(k[0]*_t+k[1]*Mt+k[2]*Wt)*Ie;return Si<0||At+Si>1?null:(ee*_t+ae*Mt+fe*Wt)*Ie}function kC(l,i,o){return(l-i)/(o-i)}function RC(l,i,o,d,f,m,v,C,T){const F=1<<o,k=m-d,z=v-f,H=(l+1)/F*k+d,$=(i+0)/F*z+f,ee=(i+1)/F*z+f;C[0]=(l+0)/F*k+d,C[1]=$,T[0]=H,T[1]=ee}class DC{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(m){const v=Math.ceil(Math.log2(m.dim/8)),C=[];let T=Math.ceil(Math.pow(2,v));const F=1/T,k=($,ee,ae,fe,ve)=>{const Fe=fe?1:0,Pe=($+1)*ae-Fe,ue=ee*ae,Ie=(ee+1)*ae-Fe;ve[0]=$*ae,ve[1]=ue,ve[2]=Pe,ve[3]=Ie};let z=new LC(T);const H=[];for(let $=0;$<T*T;$++){k($%T,Math.floor($/T),F,!1,H);const ee=up(H[0],H[1],m),ae=up(H[2],H[1],m),fe=up(H[2],H[3],m),ve=up(H[0],H[3],m);z.minimums.push(Math.min(ee,ae,fe,ve)),z.maximums.push(Math.max(ee,ae,fe,ve)),z.leaves.push(1)}for(C.push(z),T/=2;T>=1;T/=2){const $=C[C.length-1];z=new LC(T);for(let ee=0;ee<T*T;ee++){k(ee%T,Math.floor(ee/T),2,!0,H);const ae=$.getElevation(H[0],H[1]),fe=$.getElevation(H[2],H[1]),ve=$.getElevation(H[2],H[3]),Fe=$.getElevation(H[0],H[3]),Pe=$.isLeaf(H[0],H[1]),ue=$.isLeaf(H[2],H[1]),Ie=$.isLeaf(H[2],H[3]),ke=$.isLeaf(H[0],H[3]),Ge=Math.min(ae.min,fe.min,ve.min,Fe.min),yt=Math.max(ae.max,fe.max,ve.max,Fe.max),At=Pe&&ue&&Ie&&ke;z.maximums.push(yt),z.minimums.push(Ge),z.leaves.push(yt-Ge<=5&&At?1:0)}C.push(z)}return C}(this.dem),d=o.length-1,f=o[d];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,d,0)}raycastRoot(i,o,d,f,m,v,C=1){return MC([i,o,-100],[d,f,this.maximums[0]*C],m,v)}raycast(i,o,d,f,m,v,C=1){if(!this.nodeCount)return null;const T=this.raycastRoot(i,o,d,f,m,v,C);if(T==null)return null;const F=[],k=[],z=[],H=[],$=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:ee,t:ae,nodex:fe,nodey:ve,depth:Fe}=$.pop();if(this.leaves[ee]){RC(fe,ve,Fe,i,o,d,f,z,H);const ue=1<<Fe,Ie=(fe+0)/ue,ke=(fe+1)/ue,Ge=(ve+0)/ue,yt=(ve+1)/ue,At=up(Ie,Ge,this.dem)*C,_t=up(ke,Ge,this.dem)*C,Mt=up(ke,yt,this.dem)*C,Wt=up(Ie,yt,this.dem)*C,Si=PC(z[0],z[1],At,H[0],z[1],_t,H[0],H[1],Mt,m,v),Ai=PC(H[0],H[1],Mt,z[0],H[1],Wt,z[0],z[1],At,m,v),Ci=Math.min(Si!==null?Si:Number.MAX_VALUE,Ai!==null?Ai:Number.MAX_VALUE);if(Ci!==Number.MAX_VALUE)return Ci;{const Ti=It([],m,v,ae);if(OC(At,_t,Wt,Mt,kC(Ti[0],z[0],H[0]),kC(Ti[1],z[1],H[1]))>=Ti[2])return ae}continue}let Pe=0;for(let ue=0;ue<this._siblingOffset.length;ue++){RC((fe<<1)+this._siblingOffset[ue][0],(ve<<1)+this._siblingOffset[ue][1],Fe+1,i,o,d,f,z,H),z[2]=-100,H[2]=this.maximums[this.childOffsets[ee]+ue]*C;const Ie=MC(z,H,m,v);if(Ie!=null){const ke=Ie;F[ue]=ke;let Ge=!1;for(let yt=0;yt<Pe&&!Ge;yt++)ke>=F[k[yt]]&&(k.splice(yt,0,ue),Ge=!0);Ge||(k[Pe]=ue),Pe++}}for(let ue=0;ue<Pe;ue++){const Ie=k[ue];$.push({idx:this.childOffsets[ee]+Ie,t:F[Ie],nodex:(fe<<1)+this._siblingOffset[Ie][0],nodey:(ve<<1)+this._siblingOffset[Ie][1],depth:Fe+1})}}return null}_addNode(i,o,d){return this.minimums.push(i),this.maximums.push(o),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(i,o,d,f,m){if(i[f].isLeaf(o,d)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const v=f-1,C=i[v];let T=0,F=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*o+this._siblingOffset[k][0],H=2*d+this._siblingOffset[k][1],$=C.getElevation(z,H),ee=C.isLeaf(z,H),ae=this._addNode($.min,$.max,ee);ee&&(T|=1<<k),F||(F=ae)}for(let k=0;k<this._siblingOffset.length;k++)T&1<<k||this._construct(i,2*o+this._siblingOffset[k][0],2*d+this._siblingOffset[k][1],v,F+k)}}function OC(l,i,o,d,f,m){return Er(Er(l,o,m),Er(i,d,m),f)}function up(l,i,o){const d=o.dim,f=Ye(l*d-.5,0,d-1),m=Ye(i*d-.5,0,d-1),v=Math.floor(f),C=Math.floor(m),T=Math.min(v+1,d-1),F=Math.min(C+1,d-1);return OC(o.get(v,C),o.get(T,C),o.get(v,F),o.get(T,F),f-v,m-C)}const i3={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function r3(l,i,o){return(256*l*256+256*i+o)/10-1e4}function n3(l,i,o){return 256*l+i+o/256-32768}class o0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,o,d,f=!1){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return void Yr(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2,v=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let T=0;T<m;T++)v[this._idx(-1,T)]=v[this._idx(0,T)],v[this._idx(m,T)]=v[this._idx(m-1,T)],v[this._idx(T,-1)]=v[this._idx(T,0)],v[this._idx(T,m)]=v[this._idx(T,m-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(m,-1)]=v[this._idx(m-1,0)],v[this._idx(-1,m)]=v[this._idx(0,m-1)],v[this._idx(m,m)]=v[this._idx(m-1,m-1)]}const C=d==="terrarium"?n3:r3;for(let T=0;T<v.length;++T){const F=4*T;this.floatView[T]=C(this.pixels[F],this.pixels[F+1],this.pixels[F+2])}this._timestamp=vl.now()}_buildQuadTree(){this._tree=new DC(this)}get(i,o,d=!1){d&&(i=Ye(i,-1,this.dim),o=Ye(o,-1,this.dim));const f=this._idx(i,o);return this.floatView[f]}set(i,o,d){const f=this._idx(i,o),m=this.floatView[f];return this.floatView[f]=d,d-m}static getUnpackVector(i){return i3[i]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}static pack(i,o){const d=[0,0,0,0],f=o0.getUnpackVector(o);let m=Math.floor((i+f[3])/f[2]);return d[2]=m%256,m=Math.floor(m/256),d[1]=m%256,m=Math.floor(m/256),d[0]=m,d}getPixels(){return new Ow({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,o,d){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,m=o*this.dim+this.dim,v=d*this.dim,C=d*this.dim+this.dim;switch(o){case-1:f=m-1;break;case 1:m=f+1}switch(d){case-1:v=C-1;break;case 1:C=v+1}const T=-o*this.dim,F=-d*this.dim;for(let k=v;k<C;k++)for(let z=f;z<m;z++){const H=4*this._idx(z,k),$=4*this._idx(z+T,k+F);this.pixels[H+0]=i.pixels[$+0],this.pixels[H+1]=i.pixels[$+1],this.pixels[H+2]=i.pixels[$+2],this.pixels[H+3]=i.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function s3(l,i,o){l===1?i.headerLength=o.readFixed32():l===2?i.x=o.readVarint():l===3?i.y=o.readVarint():l===4?i.z=o.readVarint():l===5&&i.layers.push(function(d,f){return d.readFields(u3,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)}(o,o.readVarint()+o.pos))}function o3(l,i,o){l===1?(i.delta_filter=function(d,f){return d.readFields(a3,{blockSize:0},f)}(o,o.readVarint()+o.pos),i.filter="delta_filter"):l===2?(o.readVarint(),i.filter="zigzag_filter"):l===3?(o.readVarint(),i.filter="bitshuffle_filter"):l===4&&(o.readVarint(),i.filter="byteshuffle_filter")}function a3(l,i,o){l===1&&(i.blockSize=o.readVarint())}function l3(l,i,o){l===1?(o.readVarint(),i.codec="gzip_data"):l===2?(o.readVarint(),i.codec="jpeg_image"):l===3?(o.readVarint(),i.codec="webp_image"):l===4&&(o.readVarint(),i.codec="png_image")}function c3(l,i,o){let d=0,f=0;l===1?i.firstByte=o.readFixed64():l===2?i.lastByte=o.readFixed64():l===3?i.filters.push(function(m,v){return m.readFields(o3,{},v)}(o,o.readVarint()+o.pos)):l===4?i.codec=function(m,v){return m.readFields(l3,{},v)}(o,o.readVarint()+o.pos):l===5?f=o.readFloat():l===6?d=o.readFloat():l===7?i.bands.push(o.readString()):l===8?i.offset=o.readDouble():l===9&&(i.scale=o.readDouble()),i.offset===0&&(i.offset=f),i.scale===0&&(i.scale=d)}function u3(l,i,o){l===1?i.version=o.readVarint():l===2?i.name=o.readString():l===3?i.units=o.readString():l===4?i.tileSize=o.readVarint():l===5?i.buffer=o.readVarint():l===6?i.pixelFormat=o.readVarint():l===7&&i.dataIndex.push(function(d,f){return d.readFields(c3,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)}(o,o.readVarint()+o.pos))}function h3(l,i,o){if(l===2)(function(d,f,m){d.readFields(d3,m,f)})(o,o.readVarint()+o.pos,i);else if(l===3)throw new Error("Not implemented")}function d3(l,i,o){if(l===1){let d=0;const f=o.readVarint()+o.pos;for(;o.pos<f;)i[d++]=o.readVarint()}}function A3(l,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let o=i[3];for(let d=2;d>=1;d--){const f=d===1?1:0,m=d===2?1:0;for(let v=0;v<i[0];v++){const C=i[1]*v;for(let T=f;T<i[1];T++){const F=i[2]*(T+C);for(let k=m;k<i[2];k++){const z=i[3]*(k+F);for(let H=0;H<i[3];H++){const $=z+H;l[$]+=l[$-o]}}}}o*=i[d]}return l}function f3(l){for(let i=0,o=l.length;i<o;i++)l[i]=l[i]>>>1^-(1&l[i]);return l}function p3(l,i){switch(i){case"uint32":return l;case"uint16":for(let o=0;o<l.length;o+=2){const d=l[o],f=l[o+1];l[o]=(240&d)>>4|(61440&d)>>8|(240&f)<<4|61440&f,l[o+1]=15&d|(3840&d)>>4|(15&f)<<8|(3840&f)<<4}return l;case"uint8":for(let o=0;o<l.length;o+=4){const d=l[o],f=l[o+1],m=l[o+2],v=l[o+3];l[o+0]=(192&d)>>6|(192&f)>>4|(192&m)>>2|192&v,l[o+1]=(48&d)>>4|(48&f)>>2|48&m|(48&v)<<2,l[o+2]=(12&d)>>2|12&f|(12&m)<<2|(12&v)<<4,l[o+3]=3&d|(3&f)<<2|(3&m)<<4|(3&v)<<6}return l;default:throw new Error(`Invalid pixel format, "${i}"`)}}Zi(o0,"DEMData"),Zi(DC,"DemMinMaxQuadTree",{omit:["dem"]});var Rh=Uint8Array,ry=Uint16Array,g3=Int32Array,UC=new Rh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zC=new Rh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),m3=new Rh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),NC=function(l,i){for(var o=new ry(31),d=0;d<31;++d)o[d]=i+=1<<l[d-1];var f=new g3(o[30]);for(d=1;d<30;++d)for(var m=o[d];m<o[d+1];++m)f[m]=m-o[d]<<5|d;return{b:o,r:f}},jC=NC(UC,2),HC=jC.b,y3=jC.r;HC[28]=258,y3[258]=28;for(var v3=NC(zC,0).b,QC=new ry(32768),Sa=0;Sa<32768;++Sa){var Wg=(43690&Sa)>>1|(21845&Sa)<<1;QC[Sa]=((65280&(Wg=(61680&(Wg=(52428&Wg)>>2|(13107&Wg)<<2))>>4|(3855&Wg)<<4))>>8|(255&Wg)<<8)>>1}var ny=function(l,i,o){for(var d=l.length,f=0,m=new ry(i);f<d;++f)l[f]&&++m[l[f]-1];var v,C=new ry(i);for(f=1;f<i;++f)C[f]=C[f-1]+m[f-1]<<1;v=new ry(1<<i);var T=15-i;for(f=0;f<d;++f)if(l[f])for(var F=f<<4|l[f],k=i-l[f],z=C[l[f]-1]++<<k,H=z|(1<<k)-1;z<=H;++z)v[QC[z]>>T]=F;return v},sy=new Rh(288);for(Sa=0;Sa<144;++Sa)sy[Sa]=8;for(Sa=144;Sa<256;++Sa)sy[Sa]=9;for(Sa=256;Sa<280;++Sa)sy[Sa]=7;for(Sa=280;Sa<288;++Sa)sy[Sa]=8;var VC=new Rh(32);for(Sa=0;Sa<32;++Sa)VC[Sa]=5;var _3=ny(sy,9),x3=ny(VC,5),Px=function(l){for(var i=l[0],o=1;o<l.length;++o)l[o]>i&&(i=l[o]);return i},Nd=function(l,i,o){var d=i/8|0;return(l[d]|l[d+1]<<8)>>(7&i)&o},kx=function(l,i){var o=i/8|0;return(l[o]|l[o+1]<<8|l[o+2]<<16)>>(7&i)},b3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],jd=function(l,i,o){var d=new Error(i||b3[l]);if(d.code=l,Error.captureStackTrace&&Error.captureStackTrace(d,jd),!o)throw d;return d},w3=new Rh(0),B3=typeof TextDecoder<"u"&&new TextDecoder;try{B3.decode(w3,{stream:!0})}catch{}const C3={gzip_data:"gzip"};class td extends Error{constructor(i){super(i),this.name="MRTError"}}const S3={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},GC={uint32:1,uint16:2,uint8:4},E3={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Rx;class a0{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const o=this.layers[i];if(!o)throw new td(`Layer '${i}' not found`);return o}getHeaderLength(i){const o=new Uint8Array(i),d=new DataView(i);if(o[0]!==13)throw new td("File is not a valid MRT.");return d.getUint32(1,!0)}parseHeader(i){const o=new Uint8Array(i),d=this.getHeaderLength(i);if(o.length<d)throw new td(`Expected header with length >= ${d} but got buffer of length ${o.length}`);const f=function(m,v){return m.readFields(s3,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Rx(o.subarray(0,d)));if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new td(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const m of f.layers)this.layers[m.name]=new WC(m,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const o=[],d=this.getLayer(i.layerName);for(let f of i.blockIndices){const m=d.dataIndex[f],v=m.firstByte-i.firstByte,C=m.lastByte-i.firstByte;if(d._blocksInProgress.has(f))continue;const T={layerName:d.name,firstByte:v,lastByte:C,pixelFormat:d.pixelFormat,blockIndex:f,blockShape:[m.bands.length].concat(d.bandShape),buffer:d.buffer,codec:m.codec.codec,filters:m.filters.map(F=>F.filter)};d._blocksInProgress.add(f),o.push(T)}return new XC(o,()=>{o.forEach(f=>d._blocksInProgress.delete(f.blockIndex))},(f,m)=>{if(o.forEach(v=>d._blocksInProgress.delete(v.blockIndex)),f)throw f;m.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class WC{constructor({version:i,name:o,units:d,tileSize:f,pixelFormat:m,buffer:v,dataIndex:C},T){if(this.version=i,this.version!==1)throw new td(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=o,this.units=d,this.tileSize=f,this.buffer=v,this.pixelFormat=S3[m],this.dataIndex=C,this.bandShape=[f+2*v,f+2*v,GC[this.pixelFormat]],this._decodedBlocks=new s0(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return GC[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const o=i.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,i.data)}getBlockForBand(i){let o=0;switch(typeof i){case"string":for(const[d,f]of this.dataIndex.entries()){for(const[m,v]of f.bands.entries())if(v===i)return{bandIndex:o+m,blockIndex:d,blockBandIndex:m};o+=f.bands.length}break;case"number":for(const[d,f]of this.dataIndex.entries()){if(i>=o&&i<o+f.bands.length)return{bandIndex:i,blockIndex:d,blockBandIndex:i-o};o+=f.bands.length}break;default:throw new td(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let o=1/0,d=-1/0;const f=[],m=new Set;for(const v of i){const{blockIndex:C}=this.getBlockForBand(v);if(C<0)throw new td(`Invalid band: ${JSON.stringify(v)}`);const T=this.dataIndex[C];f.includes(C)||f.push(C),m.add(C),o=Math.min(o,T.firstByte),d=Math.max(d,T.lastByte)}if(m.size>this.cacheSize)throw new td(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:d,blockIndices:f}}hasBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0}hasDataForBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(i){const{blockIndex:o,blockBandIndex:d}=this.getBlockForBand(i);if(o<0)throw new td(`Band not found: ${JSON.stringify(i)}`);const f=this._decodedBlocks.get(o.toString());if(!f)throw new td(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[o],v=this.bandShape.reduce((F,k)=>F*k,1),C=d*v,T=f.subarray(C,C+v);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}a0.setPbf=function(l){Rx=l};class XC{constructor(i,o,d){this.tasks=i,this._onCancel=o,this._onComplete=d,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,o){this._finalized||(this._onComplete(i,o),this._finalized=!0)}}function eg(l,i){const o=l.json.bufferViews[i.bufferView],d=Iv[i.componentType];return new d(l.buffers[o.buffer],(i.byteOffset||0)+(o.byteOffset||0),i.count*(o.byteStride&&o.byteStride!==jm[i.type]*d.BYTES_PER_ELEMENT?o.byteStride/d.BYTES_PER_ELEMENT:jm[i.type]))}function Dx(l,i,o,d){const f=Iv[i.componentType],m=function(k){switch(k){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),v=l.json.bufferViews[i.bufferView],C=v.byteStride?v.byteStride/f.BYTES_PER_ELEMENT:jm[i.type],T=o.float32,F=T.length/o.capacity;for(let k=0,z=0;k<i.count*C;k+=C,z+=F)for(let H=0;H<F;H++)T[z+H]=d[k+H]*m;o._trim()}function I3(l,i,o){const d=l.indices,f=l.attributes,m={};m.indexArray=new Jo;const v=i.json.accessors[d],C=v.count/3;m.indexArray.reserve(C);const T=eg(i,v);for(let H=0;H<C;H++)m.indexArray.emplaceBack(T[3*H],T[3*H+1],T[3*H+2]);m.indexArray._trim(),m.vertexArray=new Zu;const F=i.json.accessors[f.POSITION];m.vertexArray.reserve(F.count);const k=eg(i,F);for(let H=0;H<F.count;H++)m.vertexArray.emplaceBack(k[3*H],k[3*H+1],k[3*H+2]);if(m.vertexArray._trim(),m.aabb=new De(F.min,F.max),m.centroid=function(H,$){const ee=[0,0,0],ae=H.length;if(ae>0){for(let fe=0;fe<ae;fe++){const ve=3*H[fe];ee[0]+=$[ve],ee[1]+=$[ve+1],ee[2]+=$[ve+2]}ee[0]/=ae,ee[1]/=ae,ee[2]/=ae}return ee}(T,k),f.COLOR_0!==void 0){const H=i.json.accessors[f.COLOR_0],$=jm[H.type],ee=eg(i,H);m.colorArray=$===3?new Zu:new Ya,m.colorArray.resize(H.count),Dx(i,H,m.colorArray,ee)}if(f.NORMAL!==void 0){m.normalArray=new Zu;const H=i.json.accessors[f.NORMAL];m.normalArray.resize(H.count);const $=eg(i,H);Dx(i,H,m.normalArray,$)}if(f.TEXCOORD_0!==void 0&&o.length>0){m.texcoordArray=new Ph;const H=i.json.accessors[f.TEXCOORD_0];m.texcoordArray.resize(H.count);const $=eg(i,H);Dx(i,H,m.texcoordArray,$)}if(f._FEATURE_ID_RGBA4444!==void 0){const H=i.json.accessors[f._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=eg(i,H))}f._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(eg(i,i.json.accessors[f._FEATURE_RGBA4444]).buffer));const z=l.material;return m.material=function(H,$){const{emissiveFactor:ee=[0,0,0],alphaMode:ae="OPAQUE",alphaCutoff:fe=.5,normalTexture:ve,occlusionTexture:Fe,emissiveTexture:Pe,doubleSided:ue}=H,{baseColorFactor:Ie=[1,1,1,1],metallicFactor:ke=1,roughnessFactor:Ge=1,baseColorTexture:yt,metallicRoughnessTexture:At}=H.pbrMetallicRoughness||{},_t=Fe?$[Fe.index]:void 0;if(Fe&&Fe.extensions&&Fe.extensions.KHR_texture_transform&&_t){const Mt=Fe.extensions.KHR_texture_transform;_t.offsetScale=[Mt.offset[0],Mt.offset[1],Mt.scale[0],Mt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new jn(...Ie),metallicFactor:ke,roughnessFactor:Ge,baseColorTexture:yt?$[yt.index]:void 0,metallicRoughnessTexture:At?$[At.index]:void 0},doubleSided:ue,emissiveFactor:new jn(...ee),alphaMode:ae,alphaCutoff:fe,normalTexture:ve?$[ve.index]:void 0,occlusionTexture:_t,emissionTexture:Pe?$[Pe.index]:void 0,defined:H.defined===void 0}}(z!==void 0?i.json.materials[z]:{defined:!1},o),m}function YC(l,i,o){const{matrix:d,rotation:f,translation:m,scale:v,mesh:C,extras:T,children:F}=l,k={};if(k.matrix=d||function(z,H,$,ee){var ae=H[0],fe=H[1],ve=H[2],Fe=H[3],Pe=ae+ae,ue=fe+fe,Ie=ve+ve,ke=ae*Pe,Ge=ae*ue,yt=ae*Ie,At=fe*ue,_t=fe*Ie,Mt=ve*Ie,Wt=Fe*Pe,Si=Fe*ue,Ai=Fe*Ie,Ci=ee[0],Ti=ee[1],$t=ee[2];return z[0]=(1-(At+Mt))*Ci,z[1]=(Ge+Ai)*Ci,z[2]=(yt-Si)*Ci,z[3]=0,z[4]=(Ge-Ai)*Ti,z[5]=(1-(ke+Mt))*Ti,z[6]=(_t+Wt)*Ti,z[7]=0,z[8]=(yt+Si)*$t,z[9]=(_t-Wt)*$t,z[10]=(1-(ke+At))*$t,z[11]=0,z[12]=$[0],z[13]=$[1],z[14]=$[2],z[15]=1,z}([],f||[0,0,0,1],m||[0,0,0],v||[1,1,1]),C!==void 0){k.meshes=o[C];const z=k.anchor=[0,0];for(const H of k.meshes){const{min:$,max:ee}=H.aabb;z[0]+=$[0]+ee[0],z[1]+=$[1]+ee[1]}z[0]=Math.floor(z[0]/k.meshes.length/2),z[1]=Math.floor(z[1]/k.meshes.length/2)}if(T&&(T.id&&(k.id=T.id),T.lights&&(k.lights=function(z){if(!z.length)return[];const H=function(ve){const Fe=atob(ve),Pe=new Uint8Array(Fe.length);for(let ue=0;ue<Fe.length;ue++)Pe[ue]=Fe.codePointAt(ue);return Pe}(z),$=[],ee=H.length/24,ae=new Uint16Array(H.buffer),fe=new Float32Array(H.buffer);for(let ve=0;ve<ee;ve++){const Fe=ae[2*ve*6]/30,Pe=ae[2*ve*6+1]/30,ue=ae[2*ve*6+10]/100,Ie=fe[6*ve+1],ke=fe[6*ve+2],Ge=fe[6*ve+3],yt=fe[6*ve+4],At=Ge-Ie,_t=yt-ke,Mt=Math.hypot(At,_t);$.push({pos:[Ie+.5*At,ke+.5*_t,Pe],normal:[_t/Mt,-At/Mt,0],width:Mt,height:Fe,depth:ue,points:[Ie,ke,Ge,yt]})}return $}(T.lights))),F){const z=[];for(const H of F)z.push(YC(i.json.nodes[H],i,o));k.children=z}return k}function T3(l){if(l.vertices.length===0||l.indices.length===0)return null;const i=new z_(l.vertices,l.indices,8,256),[o,d]=[i.min.clone(),i.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:i,min:o,max:d}}function F3(l){if(!l.extras||!l.extras.ground)return null;const i=l.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const o=i[0];if(!o||!Array.isArray(o)||o.length===0)return null;const d=[];for(const v of o){if(!Array.isArray(v)||v.length!==2)continue;const C=v[0],T=v[1];typeof C=="number"&&typeof T=="number"&&d.push(new qt(C,T))}if(d.length<3)return null;d.length>1&&d[d.length-1].equals(d[0])&&d.pop();let f=0;for(let v=0;v<d.length;v++){const C=d[v],T=d[(v+1)%d.length],F=d[(v+2)%d.length];f+=(C.x-T.x)*(F.y-T.y)-(F.x-T.x)*(C.y-T.y)}f>0&&d.reverse();const m=Tm(d.flatMap(v=>[v.x,v.y]),[]);return m.length===0?null:{vertices:d,indices:m}}function L3(l,i){const o=[],d=[];let f=0;const m=[];for(const v of l){f=o.length;const C=v.vertexArray.float32,T=v.indexArray.uint16;for(let F=0;F<v.vertexArray.length;F++)m[0]=C[3*F+0],m[1]=C[3*F+1],m[2]=C[3*F+2],vt(m,m,i),o.push(new qt(m[0],m[1]));for(let F=0;F<3*v.indexArray.length;F++)d.push(T[F]+f)}if(d.length%3!=0)return null;for(let v=0;v<d.length;v+=3){const C=o[d[v+0]],T=o[d[v+1]],F=o[d[v+2]];(C.x-T.x)*(F.y-T.y)-(F.x-T.x)*(C.y-T.y)>0&&([d[v+1],d[v+2]]=[d[v+2],d[v+1]])}return{vertices:o,indices:d}}function KC(l){const i=function(T,F){const k=[],z=WebGL2RenderingContext;if(T.json.textures)for(const H of T.json.textures){const $={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};H.sampler!==void 0&&Object.assign($,T.json.samplers[H.sampler]),k.push({image:F[H.source],sampler:$,uploaded:!1})}return k}(l,l.images),o=function(T,F){const k=[];for(const z of T.json.meshes){const H=[];for(const $ of z.primitives)H.push(I3($,T,F));k.push(H)}return k}(l,i),{scenes:d,scene:f,nodes:m}=l.json,v=d?d[f||0].nodes:m,C=[];for(const T of v)C.push(YC(m[T],l,o));return function(T,F,k){const z={},H=new Set;for(let $=0;$<T.length;$++){const ee=k[F[$]];if(!ee.extras)continue;const ae=ee.extras["mapbox:footprint:version"],fe=ee.extras["mapbox:footprint:id"];(ae||fe)&&H.add($),ae==="1.0.0"&&fe&&(z[fe]=$)}for(let $=0;$<T.length;$++){if(H.has($))continue;const ee=T[$],ae=k[F[$]];if(!ae.extras)continue;let fe=null;ee.id in z&&(fe=L3(T[z[ee.id]].meshes,ee.matrix)),fe||(fe=F3(ae)),fe&&(ee.footprint=T3(fe))}if(H.size>0){const $=Array.from(H.values()).sort((ee,ae)=>ee-ae);for(let ee=$.length-1;ee>=0;ee--)T.splice($[ee],1)}}(C,v,l.json.nodes),C}function M3(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const i=l.vertexArray.float32,o=l.aabb.min[0]-1,d=l.aabb.min[1]-1,f=Zp/(l.aabb.max[0]-o+2),m=Zp/(l.aabb.max[1]-d+2);for(let v=0;v<i.length;v+=3){const C=i[v+2],T=(i[v+0]-o)*f|0,F=(i[v+1]-d)*m|0;C>l.heightmap[F*Zp+T]&&(l.heightmap[F*Zp+T]=C)}}function P3(l,i){const o={};o.indexArray=new Jo,o.indexArray.reserve(4*l.length),o.vertexArray=new Zu,o.vertexArray.reserve(10*l.length),o.colorArray=new Ya,o.vertexArray.reserve(10*l.length);let d=0;for(const v of l){const C=Math.min(10,Math.max(4,1.3*v.height))*i,T=[-v.normal[1],v.normal[0],0],F=Math.min(.29,.1*v.width/v.depth),k=v.width-2*v.depth*i*(F+.01),z=It([],v.pos,T,k/2),H=It([],v.pos,T,-k/2),$=[z[0],z[1],z[2]+v.height],ee=[H[0],H[1],H[2]+v.height],ae=It([],v.normal,T,F);Qe(ae,ae,C);const fe=It([],v.normal,T,-F);Qe(fe,fe,C),Me(ae,z,ae),Me(fe,H,fe),z[2]+=.1,H[2]+=.1,o.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),o.vertexArray.emplaceBack(fe[0],fe[1],fe[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]),o.vertexArray.emplaceBack(H[0],H[1],H[2]),o.vertexArray.emplaceBack($[0],$[1],$[2]),o.vertexArray.emplaceBack(ee[0],ee[1],ee[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]),o.vertexArray.emplaceBack(H[0],H[1],H[2]),o.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),o.vertexArray.emplaceBack(fe[0],fe[1],fe[2]);const ve=k/C/2;o.colorArray.emplaceBack(-ve-F,-1,ve,.8),o.colorArray.emplaceBack(ve+F,-1,ve,.8),o.colorArray.emplaceBack(-ve,0,ve,1.3),o.colorArray.emplaceBack(ve,0,ve,1.3),o.colorArray.emplaceBack(ve+F,-.8,ve,.7),o.colorArray.emplaceBack(ve+F,-.8,ve,.7),o.colorArray.emplaceBack(0,0,ve,1.3),o.colorArray.emplaceBack(0,0,ve,1.3),o.colorArray.emplaceBack(ve+F,-1.2,ve,.8),o.colorArray.emplaceBack(ve+F,-1.2,ve,.8),o.indexArray.emplaceBack(6+d,4+d,8+d),o.indexArray.emplaceBack(7+d,9+d,5+d),o.indexArray.emplaceBack(0+d,1+d,2+d),o.indexArray.emplaceBack(1+d,3+d,2+d),d+=10}const f={defined:!0};f.emissiveFactor=jn.black;const m={};return m.baseColorFactor=jn.white,f.pbrMetallicRoughness=m,o.material=f,o.aabb=new De([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}a0.performDecoding=function(l,i){const o=new Uint8Array(l);return Promise.all(i.tasks.map(d=>{const{layerName:f,firstByte:m,lastByte:v,pixelFormat:C,blockShape:T,blockIndex:F,filters:k,codec:z}=d,H=o.subarray(m,v+1),$=new Uint32Array(T[0]*T[1]*T[2]);let ee;if(z!=="gzip_data")throw new td(`Unhandled codec: ${z}`);return ee=function(ae,fe){if(!globalThis.DecompressionStream&&fe==="gzip_data")return Promise.resolve(((ue=function(Ge){Ge[0]==31&&Ge[1]==139&&Ge[2]==8||jd(6,"invalid gzip data");var yt=Ge[3],At=10;4&yt&&(At+=2+(Ge[10]|Ge[11]<<8));for(var _t=(yt>>3&1)+(yt>>4&1);_t>0;_t-=!Ge[At++]);return At+(2&yt)}(Pe=ae))+8>Pe.length&&jd(6,"invalid gzip data"),function(Ge,yt,At,_t){var Mt=Ge.length;if(!Mt||yt.f&&!yt.l)return At||new Rh(0);var Wt=!At,Si=Wt||yt.i!=2,Ai=yt.i;Wt&&(At=new Rh(3*Mt));var Ci,Ti,$t=function(Bo){var Ws=At.length;if(Bo>Ws){var Us=new Rh(Math.max(2*Ws,Bo));Us.set(At),At=Us}},_i=yt.f||0,Vt=yt.p||0,Yt=yt.b||0,ki=yt.l,Di=yt.d,xr=yt.m,ur=yt.n,Xi=8*Mt;do{if(!ki){_i=Nd(Ge,Vt,1);var Pi=Nd(Ge,Vt+1,3);if(Vt+=3,!Pi){var $r=Ge[(Ne=4+((Vt+7)/8|0))-4]|Ge[Ne-3]<<8,ar=Ne+$r;if(ar>Mt){Ai&&jd(0);break}Si&&$t(Yt+$r),At.set(Ge.subarray(Ne,ar),Yt),yt.b=Yt+=$r,yt.p=Vt=8*ar,yt.f=_i;continue}if(Pi==1)ki=_3,Di=x3,xr=9,ur=5;else if(Pi==2){var fr=Nd(Ge,Vt,31)+257,Nr=Nd(Ge,Vt+10,15)+4,an=fr+Nd(Ge,Vt+5,31)+1;Vt+=14;for(var on=new Rh(an),_n=new Rh(19),un=0;un<Nr;++un)_n[m3[un]]=Nd(Ge,Vt+3*un,7);Vt+=3*Nr;var xn=Px(_n),as=(1<<xn)-1,js=ny(_n,xn);for(un=0;un<an;){var Ne,Xe=js[Nd(Ge,Vt,as)];if(Vt+=15&Xe,(Ne=Xe>>4)<16)on[un++]=Ne;else{var Jt=0,zi=0;for(Ne==16?(zi=3+Nd(Ge,Vt,3),Vt+=2,Jt=on[un-1]):Ne==17?(zi=3+Nd(Ge,Vt,7),Vt+=3):Ne==18&&(zi=11+Nd(Ge,Vt,127),Vt+=7);zi--;)on[un++]=Jt}}var Yi=on.subarray(0,fr),Wi=on.subarray(fr);xr=Px(Yi),ur=Px(Wi),ki=ny(Yi,xr),Di=ny(Wi,ur)}else jd(1);if(Vt>Xi){Ai&&jd(0);break}}Si&&$t(Yt+131072);for(var or=(1<<xr)-1,Or=(1<<ur)-1,Bn=Vt;;Bn=Vt){var Cn=(Jt=ki[kx(Ge,Vt)&or])>>4;if((Vt+=15&Jt)>Xi){Ai&&jd(0);break}if(Jt||jd(2),Cn<256)At[Yt++]=Cn;else{if(Cn==256){Bn=Vt,ki=null;break}var hn=Cn-254;Cn>264&&(hn=Nd(Ge,Vt,(1<<(Sn=UC[un=Cn-257]))-1)+HC[un],Vt+=Sn);var us=Di[kx(Ge,Vt)&Or],Os=us>>4;if(us||jd(3),Vt+=15&us,Wi=v3[Os],Os>3){var Sn=zC[Os];Wi+=kx(Ge,Vt)&(1<<Sn)-1,Vt+=Sn}if(Vt>Xi){Ai&&jd(0);break}Si&&$t(Yt+131072);var so=Yt+hn;if(Yt<Wi){var Hs=0-Wi,ls=Math.min(Wi,so);for(Hs+Yt<0&&jd(3);Yt<ls;++Yt)At[Yt]=(void 0)[Hs+Yt]}for(;Yt<so;++Yt)At[Yt]=At[Yt-Wi]}}yt.l=ki,yt.p=Bn,yt.b=Yt,yt.f=_i,ki&&(_i=1,yt.m=xr,yt.d=Di,yt.n=ur)}while(!_i);return Yt!=At.length&&Wt?(Ci=At,((Ti=Yt)==null||Ti>Ci.length)&&(Ti=Ci.length),new Rh(Ci.subarray(0,Ti))):At.subarray(0,Yt)}(Pe.subarray(ue,-8),{i:2},new Rh(((ve=Pe)[(Fe=ve.length)-4]|ve[Fe-3]<<8|ve[Fe-2]<<16|ve[Fe-1]<<24)>>>0))));var ve,Fe,Pe,ue;const Ie=C3[fe];if(!Ie)throw new Error(`Unhandled codec: ${fe}`);const ke=new globalThis.DecompressionStream(Ie);return new Response(new Blob([ae]).stream().pipeThrough(ke)).arrayBuffer().then(Ge=>new Uint8Array(Ge))}(H,z).then(ae=>(function(fe,ve){fe.readFields(h3,ve)}(new Rx(ae),$),new E3[C]($.buffer))),ee.then(ae=>{for(let fe=k.length-1;fe>=0;fe--)switch(k[fe]){case"delta_filter":A3(ae,T);break;case"zigzag_filter":f3(ae);break;case"bitshuffle_filter":p3(ae,C);break;default:throw new td(`Unhandled filter "${k[fe]}"`)}return{layerName:f,blockIndex:F,data:ae}}).catch(ae=>{throw ae})}))},Zi(XC,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Zi(a0,"MapboxRasterTile"),Zi(WC,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class qC{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const d=i[o];this._stringToNumber[d]=o,this._numberToString[o]=d}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const k3=["id","tile","layer","source","sourceLayer","state"];class Xg{constructor(i,o,d,f,m){this.type="Feature",this._vectorTileFeature=i,this._z=o,this._x=d,this._y=f,this.properties=i.properties,this.id=m}clone(){const i=new Xg(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of k3)this[o]!==void 0&&(i[o]=this[o]);return i}}class $C{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Va(wi,16,0),this.featureIndexArray=new Fd,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,o,d,f,m,v=0,C=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,f,m,v);const F=this.grid;for(let k=0;k<o.length;k++){const z=o[k],H=[1/0,1/0,-1/0,-1/0];for(let $=0;$<z.length;$++){const ee=z[$];H[0]=Math.min(H[0],ee.x),H[1]=Math.min(H[1],ee.y),H[2]=Math.max(H[2],ee.x),H[3]=Math.max(H[3],ee.y)}C!==0&&(H[0]-=C,H[1]-=C,H[2]+=C,H[3]+=C),H[0]<wi&&H[1]<wi&&H[2]>=0&&H[3]>=0&&F.insert(T,H[0],H[1],H[2],H[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ln.VectorTile(new Fv(this.rawTileData)).layers,this.sourceLayerCoder=new qC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,o){const{tilespaceGeometry:d,transform:f,tileTransform:m,pixelPosMatrix:v,availableImages:C,worldview:T}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const F=d.bufferedTilespaceBounds,k=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(ee,ae,fe,ve)=>Bs(d.bufferedTilespaceGeometry,ee,ae,fe,ve));k.sort(R3);let z=null;f.elevation&&k.length>0&&(z=Qg.create(f.elevation,this.tileID));const H={};let $;for(let ee=0;ee<k.length;ee++){const ae=k[ee];if(ae===$)continue;$=ae;const fe=this.featureIndexArray.get(ae);let ve=null;this.is3DTile?this.loadMatchingModelFeature(H,fe,i,d,f,T):this.loadMatchingFeature(H,fe,i,C,T,(Fe,Pe,ue,Ie=0)=>(ve||(ve=tr(Fe,this.tileID.canonical,m)),Pe.queryIntersectsFeature(d,Fe,ue,ve,this.z,f,v,z,Ie)))}return H}loadMatchingFeature(i,o,d,f,m,v){const{featureIndex:C,bucketIndex:T,sourceLayerIndex:F,layoutVertexArrayOffset:k}=o,z=this.bucketLayerIDs[T],H=d.layers,$=Object.keys(H);if($.length&&!jr($,z))return;const ee=d.sourceCache,ae=this.sourceLayerCoder.decode(F),fe=this.vtLayers[ae].feature(C),ve=this.getId(fe,ae);for(let Fe=0;Fe<z.length;Fe++){const Pe=z[Fe];if(!H[Pe])continue;const{styleLayer:ue,targets:Ie}=H[Pe];let ke={};ve!==void 0&&(ke=ee.getFeatureState(ue.sourceLayer,ve));const Ge=!v||v(fe,ue,ke,k);if(!Ge)continue;const yt=new Xg(fe,this.z,this.x,this.y,ve);yt.tile=this.tileID.canonical,yt.state=ke;let At=this.serializedLayersCache.get(Pe);At||(At=ue.serialize(),At.id=Pe,this.serializedLayersCache.set(Pe,At)),yt.source=At.source,yt.sourceLayer=At["source-layer"],yt.layer=Ut({},At),yt.layer.paint=ZC(At.paint,ue.paint,fe,ke,f),yt.layer.layout=ZC(At.layout,ue.layout,fe,ke,f);let _t=!1;for(const Mt of Ie){this.updateFeatureProperties(yt,Mt);const{filter:Wt}=Mt;if(Wt){if(fe.properties=yt.properties,Wt.needGeometry){const Si=Ki(fe,!0);if(!Wt.filter(new $n(this.tileID.overscaledZ,{worldview:m}),Si,this.tileID.canonical))continue}else if(!Wt.filter(new $n(this.tileID.overscaledZ,{worldview:m}),fe))continue}_t=!0,Mt.targetId&&this.addFeatureVariant(yt,Mt)}_t&&this.appendToResult(i,Pe,C,yt,Ge)}}loadMatchingModelFeature(i,o,d,f,m,v){const{featureIndex:C,bucketIndex:T}=o,F=this.bucketLayerIDs[T],k=d.layers,z=Object.keys(k);if(!z.length||jr(z,F))for(let H=0;H<F.length;H++){const $=F[H],{styleLayer:ee,targets:ae}=k[$];if(ee.type!=="model")continue;const fe=f.tile,ve=fe.getBucket(ee);if(!(ve&&ve instanceof e0))continue;const Fe=kM(ve,C,f,m);if(!Fe)continue;const{z:Pe,x:ue,y:Ie}=fe.tileID.canonical,{feature:ke,intersectionZ:Ge,position:yt}=Fe;let At={};ke.id!==void 0&&(At=d.sourceCache.getFeatureState(ee.sourceLayer,ke.id));const _t=new Xg({},Pe,ue,Ie,ke.id);_t.tile=this.tileID.canonical,_t.state=At,_t.properties=ke.properties,_t.geometry={type:"Point",coordinates:[yt.lng,yt.lat]};let Mt=this.serializedLayersCache.get($);Mt||(Mt=ee.serialize(),Mt.id=$,this.serializedLayersCache.set($,Mt)),_t.source=Mt.source,_t.sourceLayer=Mt["source-layer"],_t.layer=Ut({},Mt);let Wt=!1;for(const Si of ae){this.updateFeatureProperties(_t,Si);const{filter:Ai}=Si;if(Ai){if(ke.properties=_t.properties,Ai.needGeometry){if(!Ai.filter(new $n(this.tileID.overscaledZ,{worldview:v}),ke,this.tileID.canonical))continue}else if(!Ai.filter(new $n(this.tileID.overscaledZ,{worldview:v}),ke))continue}Wt=!0,Si.targetId&&this.addFeatureVariant(_t,Si)}Wt&&this.appendToResult(i,$,C,_t,Ge)}}updateFeatureProperties(i,o,d){if(o.properties){const f={};for(const m in o.properties){const v=o.properties[m].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,d);v!=null&&(f[m]=v)}i.properties=f}}addFeatureVariant(i,o,d){const f={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(f.properties=i.properties),i.variants=i.variants||{},i.variants[o.targetId]=i.variants[o.targetId]||[],i.variants[o.targetId].push(f)}appendToResult(i,o,d,f,m){let v=i[o];v===void 0&&(v=i[o]=[]),v.push({featureIndex:d,feature:f,intersectionZ:m})}lookupSymbolFeatures(i,o,d,f,m,v){const C={};this.loadVTLayers();for(const T of i)this.loadMatchingFeature(C,{bucketIndex:o,sourceLayerIndex:d,featureIndex:T,layoutVertexArrayOffset:0},f,m,v);return C}loadFeature(i){const{featureIndex:o,sourceLayerIndex:d}=i;this.loadVTLayers();const f=this.sourceLayerCoder.decode(d),m=this.vtFeatures[f];if(m[o])return m[o];const v=this.vtLayers[f].feature(o);return m[o]=v,v}hasLayer(i){for(const o of this.bucketLayerIDs)for(const d of o)if(i===d)return!0;return!1}getId(i,o){let d=i.id;if(this.promoteId){const f=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(f!=null)if(Array.isArray(f)){if(!this.promoteIdExpression){const m=cs(f);if(m.result!=="success"){const v=m.value.map(C=>`${C.key}: ${C.message}`).join(", ");return void Yr(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Sc),d=this.promoteIdExpression.evaluate({zoom:0},i)}else d=i.properties[f];typeof d=="boolean"&&(d=Number(d))}return d}}function ZC(l,i,o,d,f){return nr(l,(m,v)=>{const C=i instanceof Zc?i.get(v):null;return C&&C.evaluate?C.evaluate(o,d,void 0,f):C})}function R3(l,i){return i-l}Zi($C,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const JC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ox{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,d]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=d>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const m=JC[15&d];if(!m)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(i,2,1),[C]=new Uint32Array(i,4,1);return new Ox(C,v,m,i)}constructor(i,o=64,d=Float64Array,f){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=d,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const m=JC.indexOf(this.ArrayType),v=2*i*this.ArrayType.BYTES_PER_ELEMENT,C=i*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-C%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${d}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+T,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+v+C+T),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+C+T,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=i,this.coords[this._pos++]=o,d}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return Ux(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,d,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:C}=this,T=[0,m.length-1,0],F=[];for(;T.length;){const k=T.pop()||0,z=T.pop()||0,H=T.pop()||0;if(z-H<=C){for(let fe=H;fe<=z;fe++){const ve=v[2*fe],Fe=v[2*fe+1];ve>=i&&ve<=d&&Fe>=o&&Fe<=f&&F.push(m[fe])}continue}const $=H+z>>1,ee=v[2*$],ae=v[2*$+1];ee>=i&&ee<=d&&ae>=o&&ae<=f&&F.push(m[$]),(k===0?i<=ee:o<=ae)&&(T.push(H),T.push($-1),T.push(1-k)),(k===0?d>=ee:f>=ae)&&(T.push($+1),T.push(z),T.push(1-k))}return F}within(i,o,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:m,nodeSize:v}=this,C=[0,f.length-1,0],T=[],F=d*d;for(;C.length;){const k=C.pop()||0,z=C.pop()||0,H=C.pop()||0;if(z-H<=v){for(let fe=H;fe<=z;fe++)tS(m[2*fe],m[2*fe+1],i,o)<=F&&T.push(f[fe]);continue}const $=H+z>>1,ee=m[2*$],ae=m[2*$+1];tS(ee,ae,i,o)<=F&&T.push(f[$]),(k===0?i-d<=ee:o-d<=ae)&&(C.push(H),C.push($-1),C.push(1-k)),(k===0?i+d>=ee:o+d>=ae)&&(C.push($+1),C.push(z),C.push(1-k))}return T}}function Ux(l,i,o,d,f,m){if(f-d<=o)return;const v=d+f>>1;eS(l,i,v,d,f,m),Ux(l,i,o,d,v-1,1-m),Ux(l,i,o,v+1,f,1-m)}function eS(l,i,o,d,f,m){for(;f>d;){if(f-d>600){const F=f-d+1,k=o-d+1,z=Math.log(F),H=.5*Math.exp(2*z/3),$=.5*Math.sqrt(z*H*(F-H)/F)*(k-F/2<0?-1:1);eS(l,i,o,Math.max(d,Math.floor(o-k*H/F+$)),Math.min(f,Math.floor(o+(F-k)*H/F+$)),m)}const v=i[2*o+m];let C=d,T=f;for(oy(l,i,d,o),i[2*f+m]>v&&oy(l,i,d,f);C<T;){for(oy(l,i,C,T),C++,T--;i[2*C+m]<v;)C++;for(;i[2*T+m]>v;)T--}i[2*d+m]===v?oy(l,i,d,T):(T++,oy(l,i,T,f)),T<=o&&(d=T+1),o<=T&&(f=T-1)}}function oy(l,i,o,d){zx(l,o,d),zx(i,2*o,2*d),zx(i,2*o+1,2*d+1)}function zx(l,i,o){const d=l[i];l[i]=l[o],l[o]=d}function tS(l,i,o,d){const f=l-o,m=i-d;return f*f+m*m}r.$=Io,r.A=Vc,r.B=bn,r.C=Jc,r.D=kg,r.E=yu,r.F=2,r.G=Wm,r.H=vB,r.I=na,r.J=fa,r.K=class extends Zv{},r.L=Cc,r.M=hc,r.N=Ms,r.O=Tr,r.P=qt,r.Q=zr,r.R=hh,r.S=aa,r.T=vx,r.U=xd,r.V=Zv,r.W=Ca,r.X=cs,r.Y=Cu,r.Z=Gh,r._=Qu,r.a=function(l){return ds.API_CDN_URL_REGEX.test(l)},r.a$=Nt,r.a0=Cl,r.a1=xA,r.a2=Vs,r.a3=wn,r.a4=function(l){const i=l.value;let o=[];if(!i)return o;const d=fa(i);return d!=="string"?(o=o.concat([new Zv(l.key,i,`string expected, "${d}" found`)]),o):(wx(i,!0)||(o=o.concat([new Zv(l.key,i,`invalid url "${i}"`)])),o)},r.a5=Lt,r.a6=vd,r.a7=Ns,r.a8=Ei,r.a9=class{constructor(l){this.specification=l}possiblyEvaluate(l,i){return ms(l.expression.evaluate(i))}interpolate(l,i,o){return{x:Er(l.x,i.x,o),y:Er(l.y,i.y,o),z:Er(l.z,i.z,o),azimuthal:Er(l.azimuthal,i.azimuthal,o),polar:Er(l.polar,i.polar,o)}}},r.aA=Kt,r.aB=S,r.aC=os,r.aD=nt,r.aE=zt,r.aF=function(l,i){const o={};for(let d=0;d<i.length;d++){const f=i[d];f in l&&(o[f]=l[f])}return o},r.aG=je,r.aH=qe,r.aI=class{constructor(l){this.entries={},this.scheduler=l}request(l,i,o,d){const f=this.entries[l]=this.entries[l]||{callbacks:[]};if(f.result){const[m,v]=f.result;return this.scheduler?this.scheduler.add(()=>{d(m,v)},i):d(m,v),()=>{}}return f.callbacks.push(d),f.cancel||(f.cancel=o((m,v)=>{f.result=[m,v];for(const C of f.callbacks)this.scheduler?this.scheduler.add(()=>{C(m,v)},i):C(m,v);setTimeout(()=>delete this.entries[l],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==d),f.callbacks.length||(f.cancel(),delete this.entries[l]))}}},r.aJ=function(l,i,o){const d=JSON.stringify(l.request);return l.data&&(this.deduped.entries[d]={result:[null,l.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},f=>{const m=Hc(l.request,(v,C,T,F)=>{v?f(v):C&&f(null,{vectorTile:o?void 0:new ln.VectorTile(new Fv(C)),rawData:C,cacheControl:T,expires:F})});return()=>{m.cancel(),f()}},i)},r.aK=function(l){du++,du>wc&&(l.getActor().send("enforceCacheSizeLimit",_l),du=0)},r.aL=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},r.aM=ma,r.aN=YB,r.aO=eC,r.aP=XB,r.aQ=function(l,i){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let d=0;d<l.length;d++){const f=document.createElement("source");bl(l[d])||(o.crossOrigin="Anonymous"),f.src=l[d],o.appendChild(f)}return{cancel:()=>{}}},r.aR=Xv,r.aS=function(l){return fetch(l).then(i=>i.arrayBuffer()).then(i=>U2(i,0,l))},r.aT=KC,r.aU=class{constructor(l,i,o,d){this.id=l,this.position=i!=null?new Te(i[0],i[1]):new Te(0,0),this.orientation=o??[0,0,0],this.nodes=d,this.uploaded=!1,this.aabb=new De([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,i){if(U(l.matrix,i,l.matrix),l.meshes)for(const o of l.meshes){const d=De.applyTransformFast(o.aabb,l.matrix);this.aabb.encapsulate(d)}if(l.children)for(const o of l.children)this._applyTransformations(o,l.matrix)}computeBoundsAndApplyParent(){const l=M([]);for(const i of this.nodes)this._applyTransformations(i,l)}computeModelMatrix(l,i,o,d,f,m,v=!1){hC(this.matrix,this,l.transform,this.position,i,o,d,f,m,v)}upload(l){if(!this.uploaded){for(const i of this.nodes)Cx(i,l);for(const i of this.nodes)Jv(i);this.uploaded=!0}}destroy(){for(const l of this.nodes)Sx(l)}},r.aV=er,r.aW=Ym,r.aX=ft,r.aY=Rt,r.aZ=wA,r.a_=Jo,r.aa=$n,r.ab=Ha,r.ac=Ct,r.ad=vt,r.ae=Le,r.af=xt,r.ag=Zc,r.ah=np,r.ai=Er,r.aj=wi,r.ak=fh,r.al=dn,r.am=jn,r.an=class{constructor(l){this.specification=l}possiblyEvaluate(l,i){return function([o,d]){const f=ms([1,o,d]);return{x:f.x,y:f.y,z:f.z}}(l.expression.evaluate(i))}interpolate(l,i,o){return{x:Er(l.x,i.x,o),y:Er(l.y,i.y,o),z:Er(l.z,i.z,o)}}},r.ao=function(l,i,o=0,d=!0){const f=new qt(o,o),m=l.sub(f),v=i.add(f),C=[m,new qt(v.x,m.y),v,new qt(m.x,v.y)];return d&&C.push(m.clone()),C},r.ap=function(l,i){const o=[];for(let d=0;d<l.length;d++){const f=Dt(d-1,-1,l.length-1),m=Dt(d+1,-1,l.length-1),v=l[d],C=l[m],T=l[f].sub(v).unit(),F=C.sub(v).unit(),k=F.angleWithSep(T.x,T.y),z=T.add(F).unit().mult(-1*i/Math.sin(k/2));o.push(v.add(z))}return o},r.aq=PB,r.ar=Bs,r.as=function(l,i,o=0){return Se(((i.x-o)*l.scale-l.x)*wi,(i.y*l.scale-l.y)*wi,Ot(i.z,i.y))},r.at=Ve,r.au=mt,r.av=Ds,r.aw=G2,r.ax=function(l){let i=1/0,o=1/0,d=-1/0,f=-1/0;for(const m of l)i=Math.min(i,m.x),o=Math.min(o,m.y),d=Math.max(d,m.x),f=Math.max(f,m.y);return{min:new qt(i,o),max:new qt(d,f)}},r.ay=Ye,r.az=U,r.b=function(l){return ds.API_FONTS_REGEX.test(l)},r.b$=function(l,i,o){o*=.5;var d=i[0],f=i[1],m=i[2],v=i[3],C=Math.sin(o),T=Math.cos(o);return l[0]=d*T+f*C,l[1]=f*T-d*C,l[2]=m*T+v*C,l[3]=v*T-m*C,l},r.b0=Td,r.b1=Gv,r.b2=function(){$c.isLoading()||$c.isLoaded()||hl()!=="deferred"||_A()},r.b3=bA,r.b4=Ki,r.b5=Xg,r.b6=In,r.b7=$_,r.b8=U_,r.b9=tr,r.bA=function(l,i){const{x:o,y:d}=l.point,f=Bw(o,d,l.worldSize/l._pixelsPerMercatorPixel,0,0);return U(f,f,I_(kA(i)))},r.bB=_,r.bC=function(l){return l[0]=0,l[1]=0,l[2]=0,l},r.bD=function(l,i){return Math.hypot(i[0]-l[0],i[1]-l[1],i[2]-l[2])},r.bE=It,r.bF=rt,r.bG=Bt,r.bH=Gm,r.bI=Mu,r.bJ=sx,r.bK=function(l,i,o,d,f){const m=5*i+2;l.float32[m+0]=o,l.float32[m+1]=d,l.float32[m+2]=f},r.bL=Vv,r.bM=Sv,r.bN=Ui,r.bO=rl,r.bP=e2,r.bQ=oC,r.bR=s2,r.bS=o2,r.bT=nx,r.bU=SB,r.bV=cx,r.bW=Ox,r.bX=Dt,r.bY=Qe,r.bZ=Ft,r.b_=fi,r.ba=$u,r.bb=EA,r.bc=rp,r.bd=Gs,r.be=Tm,r.bf=gx,r.bg=function(l,i){const o=np(i.zoom);if(o===0)return kA(l);const d=pv(l),f=E_(d),m=nt(d.getWest())*i.worldSize,v=nt(d.getEast())*i.worldSize,C=qe(d.getNorth())*i.worldSize,T=qe(d.getSouth())*i.worldSize,F=[m,C,0],k=[v,C,0],z=[m,T,0],H=[v,T,0],$=G([],i.globeMatrix);return vt(F,F,$),vt(k,k,$),vt(z,z,$),vt(H,H,$),f[0]=mf(f[0],z,o),f[1]=mf(f[1],H,o),f[2]=mf(f[2],k,o),f[3]=mf(f[3],F,o),De.fromPoints(f)},r.bh=mv,r.bi=G,r.bj=Em,r.bk=mf,r.bl=Bd,r.bm=ip,r.bn=Ae,r.bo=Q,r.bp=a0,r.bq=Fv,r.br=Hc,r.bs=function(l,i){const o=[];for(const d in l)d in i||o.push(d);return o},r.bt=bt,r.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bv=Vn,r.bw=function(l){var i=new b(16);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i[6]=l[6],i[7]=l[7],i[8]=l[8],i[9]=l[9],i[10]=l[10],i[11]=l[11],i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15],i},r.bx=M,r.by=pe,r.bz=R,r.c=ch,r.c$=Ev,r.c0=Ri,r.c1=bs,r.c2=function(l,i){return l[0]=-i[0],l[1]=-i[1],l[2]=-i[2],l[3]=i[3],l},r.c3=be,r.c4=function(l,i,o,d,f){var m,v=1/Math.tan(i/2);return l[0]=v/o,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=v,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,f!=null&&f!==1/0?(l[10]=(f+d)*(m=1/(d-f)),l[14]=2*f*d*m):(l[10]=-1,l[14]=-2*d),l},r.c5=function(l,i,o,d,f,m,v){var C=1/(i-o),T=1/(d-f),F=1/(m-v);return l[0]=-2*C,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*T,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*F,l[11]=0,l[12]=(i+o)*C,l[13]=(f+d)*T,l[14]=(v+m)*F,l[15]=1,l},r.c6=ht,r.c7=function(l,i,o){l[4*i+0]=o[0],l[4*i+1]=o[1],l[4*i+2]=o[2],l[4*i+3]=o[3]},r.c8=Jf,r.c9=Af,r.cA=qv,r.cB=we,r.cC=tC,r.cD=function(l){const i=tC(l,!0);return _([],[i[0],i[1],i[4],i[5]])},r.cE=q,r.cF=N,r.cG=ne,r.cH=function(l){const{x:i,y:o}=l.point,{lng:d,lat:f}=l._center;return Bw(i,o,l.worldSize,d,f)},r.cI=Ze,r.cJ=Et,r.cK=ih,r.cL=L,r.cM=function(l,i,o){let d=0;for(let f=0;f<2;++f)l[f]>0&&(d+=(l[f]-0)*(l[f]-0)),i[f]<0&&(d+=(0-i[f])*(0-i[f]));return d},r.cN=function(l){return l*l*l*l*l},r.cO=at,r.cP=45,r.cQ=ep,r.cR=function(l,i,o){const d=Math.sqrt(l*l+i*i+o*o),f=d>0?Math.acos(o/d)*ra:0;let m=l!==0||i!==0?Math.atan2(-i,-l)*ra+90:0;return m<0&&(m+=360),[d,m,f]},r.cS=Se,r.cT=ms,r.cU=Qt,r.cV=Me,r.cW=De,r.cX=Re,r.cY=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},r.cZ=wx,r.c_=function(l,i){return l.readFields(OM,{icons:[]},i)},r.ca=Fo,r.cb=eh,r.cc=LA,r.cd=Te,r.ce=UB,r.cf=function(){var l=new b(4);return b!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l},r.cg=function(l,i,o){var d=i[0],f=i[1],m=i[2],v=i[3],C=Math.sin(o),T=Math.cos(o);return l[0]=d*T+m*C,l[1]=f*T+v*C,l[2]=d*-C+m*T,l[3]=f*-C+v*T,l},r.ch=function(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]&&l[3]===i[3]},r.ci=ze,r.cj=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},r.ck=Qr,r.cl=mi,r.cm=Dd,r.cn=Be,r.co=iC,r.cp=pc,r.cq=xw,r.cr=function(l,i,o,d,f,m,v,C,T){if(T.name==="globe")return xw(l,i,new pc(o,d,f),!1);const F=Ym({z:o,x:d,y:f},T);return new De([(m+F.x/F.scale)*i,i*(F.y/F.scale),v],[(m+F.x2/F.scale)*i,i*(F.y2/F.scale),C])},r.cs=function(l,i,o){return l[0]=Math.min(i[0],o[0]),l[1]=Math.min(i[1],o[1]),l[2]=Math.min(i[2],o[2]),l[3]=Math.min(i[3],o[3]),l},r.ct=function(l,i,o){return l[0]=Math.max(i[0],o[0]),l[1]=Math.max(i[1],o[1]),l[2]=Math.max(i[2],o[2]),l[3]=Math.max(i[3],o[3]),l},r.cu=function(l){const i=Math.round((l+45+360)%360/90)%4;return ye[i]},r.cv=ti,r.cw=yi,r.cx=P,r.cy=function(l){const i=M(new Float64Array(16));U(i,l.pixelMatrix,l.globeMatrix);const o=[0,Z,0],d=[0,te,0];return vt(o,o,i),vt(d,d,i),[o[0]>0&&o[0]<=l.width&&o[1]>0&&o[1]<=l.height&&!F_(l,new Te(l.center.lat,90)),d[0]>0&&d[0]<=l.width&&d[1]>0&&d[1]<=l.height&&!F_(l,new Te(l.center.lat,-90))]},r.cz=function(l,i){const{scale:o}=l.tileTransform,d=o*wi/(l.tileSize*Math.pow(2,i.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return function(f,m,v){var C=m[1],T=m[2],F=m[3],k=v[0],z=v[1];return f[0]=m[0]*k,f[1]=C*k,f[2]=T*z,f[3]=F*z,f}(new Float32Array(4),i.inverseAdjustmentMatrix,[d,d])},r.d=function(l){return ds.API_TILEJSON_REGEX.test(l)},r.d$=Kf,r.d0=zg,r.d1=ax,r.d2=dh,r.d3=Xu,r.d4=ll,r.d5=zo,r.d6=Mr,r.d7=function(l){const i=l.indexOf(Ac);return i>=0?l.slice(0,i):l},r.d8=function(l){return l.indexOf(Ac)>=0},r.d9=function(l){const i=l.lastIndexOf(Ac);return i>=0?l.slice(i+1):""},r.dA=ww,r.dB=Da,r.dC=So,r.dD=256,r.dE=function(l,i){const o=[0,0,0];return vt(o,o,mv(kA(i.canonical))),vt(o,o,l),o},r.dF=l=>({u_matrix:new LA(l),u_texsize:new eh(l),u_pixels_to_tile_units:new ff(l),u_device_pixel_ratio:new Fo(l),u_width_scale:new Fo(l),u_floor_width_scale:new Fo(l),u_image:new Jf(l),u_units_to_pixels:new eh(l),u_tile_units_to_pixels:new Fo(l),u_alpha_discard_threshold:new Fo(l),u_trim_offset:new eh(l),u_trim_fade_range:new eh(l),u_trim_color:new ep(l),u_emissive_strength:new Fo(l),u_zbias_factor:new Fo(l),u_tile_to_meter:new Fo(l),u_ground_shadow_factor:new Af(l),u_pattern_transition:new Fo(l)}),r.dG=l=>({u_matrix:new LA(l),u_pixels_to_tile_units:new ff(l),u_device_pixel_ratio:new Fo(l),u_width_scale:new Fo(l),u_floor_width_scale:new Fo(l),u_units_to_pixels:new eh(l),u_dash_image:new Jf(l),u_gradient_image:new Jf(l),u_image_height:new Fo(l),u_texsize:new eh(l),u_tile_units_to_pixels:new Fo(l),u_alpha_discard_threshold:new Fo(l),u_trim_offset:new eh(l),u_trim_fade_range:new eh(l),u_trim_color:new ep(l),u_emissive_strength:new Fo(l),u_zbias_factor:new Fo(l),u_tile_to_meter:new Fo(l),u_ground_shadow_factor:new Af(l)}),r.dH=l=>({u_camera_to_center_distance:new Fo(l),u_extrude_scale:new ff(l),u_device_pixel_ratio:new Fo(l),u_matrix:new LA(l),u_inv_rot_matrix:new LA(l),u_merc_center:new eh(l),u_tile_id:new Af(l),u_zoom_transition:new Fo(l),u_up_dir:new Af(l),u_emissive_strength:new Fo(l)}),r.dI=Op,r.dJ=jL,r.dK=Ew,r.dL=(l,i,o,d,f,m)=>{const v=l.transform,C=v.projection.name==="globe";let T;if(m.paint.get("circle-pitch-alignment")==="map")if(C){const k=ww(v.zoom,i.canonical)*v._pixelsPerMercatorPixel;T=Float32Array.from([k,0,0,k])}else T=v.calculatePixelsToTileUnitsMatrix(o);else T=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const F={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(v.projection),u_matrix:l.translatePosMatrix(i.projMatrix,o,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:vl.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:FF,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(C){F.u_inv_rot_matrix=d,F.u_merc_center=f,F.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],F.u_zoom_transition=np(v.zoom);const k=f[0]*wi,z=f[1]*wi;F.u_up_dir=v.projection.upVector(new pc(0,0,0),k,z)}return F},r.dM=K2,r.dN=Js,r.dO=(l,i,o,d,f,m,v,C,T,F)=>{const k=l.transform,z=k.pitch<15?W2(.07,.7,Ye((14-k.zoom)/5,0,1)):.07,H=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Y2(l,i,o,d),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:f,u_width_scale:m,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:X2(i,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(H?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:Qt(i.tileID.canonical,0),u_ground_shadow_factor:T,u_pattern_transition:F}},r.dP=(l,i,o,d,f,m,v,C,T,F)=>{const k=l.transform,z=k.calculatePixelsToTileUnitsMatrix(i),H=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",$=k.pitch<15?W2(.07,.7,Ye((14-k.zoom)/5,0,1)):.07;return{u_matrix:Y2(l,i,o,d),u_pixels_to_tile_units:z,u_device_pixel_ratio:m,u_width_scale:v,u_floor_width_scale:C,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:q2(o)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:X2(i,l.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(H?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:$,u_tile_to_meter:Qt(i.tileID.canonical,0),u_ground_shadow_factor:F}},r.dQ=Fi,r.dR=Im,r.dS=Ot,r.dT=Od,r.dU=Cv,r.dV=v2,r.dW=op,r.dX=450,r.dY=7,r.dZ=bM,r.d_=On,r.da=function(l){const i=[],o=l.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},r.db=function(l,i,o,d){return l.type==="custom"?new wM(l,i):new RM[l.type](l,i,o,d)},r.dc=Sr,r.dd=function(l){const i=l.indexOf(Ac);return i>=0?l.slice(i+1):""},r.de=class extends Xg{constructor(l,i){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state=Object.assign({},l.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},r.df=Ch,r.dg=fu,r.dh=function(l){return l({pluginStatus:ca,pluginURL:Fl}),Ch.on("pluginStateChange",l),l},r.di=tp,r.dj=class extends Mc{constructor(l){super(l),this.current=Gp}set(l,i,o){if(this.fetchUniformLocation(l,i)){for(let d=0;d<9;d++)if(o[d]!==this.current[d]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},r.dk=Ee,r.dl=function(l,i,o){const d=np(o.zoom),f=l.style.map._antialias,m=l.terrain&&l.terrain.exaggeration()>0;return d===0&&!f&&!m},r.dm=function(l){const i=l.pixelsPerMeter,o=i/ht(1,l.center.lat),d=M(new Float64Array(16));return Q(d,d,[l.point.x,l.point.y,0]),q(d,d,[o,o,i]),Float32Array.from(d)},r.dn=pv,r.dp=function(l){const i=ti-5;l=Ye(l,-80.051129,i)/i*90;const o=Math.pow(Math.abs(Math.sin(dn(l))),3);return Math.round(o*(J.length-1))},r.dq=function(l,i,o,d){const f=i.getNorth(),m=i.getSouth(),v=i.getWest(),C=i.getEast(),T=1<<l.z,F=C-v,k=f-m,z=F/Y,H=-k/J[o],$=[0,z,0,H,0,0,f,v,0];if(l.z>0){const ee=180/d;E($,$,[ee/F+1,0,0,0,ee/k+1,0,-.5*ee/z,.5*ee/H,1])}return $[2]=T,$[5]=l.x,$[8]=l.y,$},r.dr=kA,r.ds=function(l,i,o){const d=M(new Float64Array(16)),f=(i/(1<<l)-.5)*Math.PI*2;return re(d,o.globeMatrix,f),Float32Array.from(d)},r.dt=class{isDataAvailableAtPoint(l){const i=this._source();if(this.isUsingMockSource()||!i||l.y<0||l.y>1)return!1;const o=i.getSource().maxzoom,d=1<<o,f=Math.floor(l.x),m=Math.floor((l.x-f)*d),v=Math.floor(l.y*d),C=this.findDEMTileFor(new ma(o,f,o,m,v));return!(!C||!C.dem)}getAtPointOrZero(l,i=0){return this.getAtPoint(l,i)||0}getAtPoint(l,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const d=this._source();if(!d||l.y<0||l.y>1)return i;const f=d.getSource().maxzoom,m=1<<f,v=Math.floor(l.x),C=l.x-v,T=new ma(f,v,f,Math.floor(C*m),Math.floor(l.y*m)),F=this.findDEMTileFor(T);if(!F||!F.dem)return i;const k=F.dem,z=1<<F.tileID.canonical.z,H=(C*z-F.tileID.canonical.x)*k.dim,$=(l.y*z-F.tileID.canonical.y)*k.dim,ee=Math.floor(H),ae=Math.floor($);return(o?this.exaggeration():1)*Er(Er(k.get(ee,ae),k.get(ee,ae+1),$-ae),Er(k.get(ee+1,ae),k.get(ee+1,ae+1),$-ae),H-ee)}getAtTileOffset(l,i,o){const d=1<<l.canonical.z;return this.getAtPointOrZero(new Ct(l.wrap+(l.canonical.x+i/wi)/d,(l.canonical.y+o/wi)/d))}getAtTileOffsetFunc(l,i,o,d){return f=>{const m=this.getAtTileOffset(l,f.x,f.y),v=d.upVector(l.canonical,f.x,f.y);return Qe(v,v,m*d.upVectorScale(l.canonical,i,o).metersToTile),v}}getForTilePoints(l,i,o,d){if(this.isUsingMockSource())return!1;const f=Qg.create(this,l,d);return!!f&&(i.forEach(m=>{m[2]=this.exaggeration()*f.getElevationAt(m[0],m[1],o)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(l);if(!i||!i.dem)return null;const o=i.dem.tree,d=i.tileID,f=1<<l.canonical.z-d.canonical.z;let m=l.canonical.x/f-d.canonical.x,v=l.canonical.y/f-d.canonical.y,C=0;for(let T=0;T<l.canonical.z-d.canonical.z&&!o.leaves[C];T++){m*=2,v*=2;const F=2*Math.floor(v)+Math.floor(m);C=o.childOffsets[C]+F,m%=1,v%=1}return{min:this.exaggeration()*o.minimums[C],max:this.exaggeration()*o.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let i=!1,o=Number.MAX_VALUE,d=Number.MIN_VALUE;for(const f of l){const m=this.getMinMaxForTile(f.tileID);m&&(o=Math.min(o,m.min),d=Math.max(d,m.max),i=!0)}return i?{min:o,max:d}:null}},r.du=Ow,r.dv=fv,r.dw=function(l,i){return[Math.pow(l[0],2.2)*i,Math.pow(l[1],2.2)*i,Math.pow(l[2],2.2)*i]},r.dx=B,r.dy=function(l,i){var o=Math.sin(i),d=Math.cos(i);return l[0]=d,l[1]=o,l[2]=0,l[3]=-o,l[4]=d,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},r.dz=Gt,r.e=ds,r.e$=qC,r.e0=256,r.e1=I_,r.e2=Zu,r.e3=re,r.e4=function(l,i){return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[4],l[4]=i[5],l[5]=i[6],l[6]=i[8],l[7]=i[9],l[8]=i[10],l},r.e5=$h,r.e6=lf,r.e7=Bi,r.e8=function(l,i,o,d,f){return Ye((l-i)/(o-i)*(f-d)+d,d,f)},r.e9=Oi,r.eA=function(l,i,o){return l[0]=i[0]/o[0],l[1]=i[1]/o[1],l[2]=i[2]/o[2],l},r.eB=kt,r.eC=he,r.eD=Je,r.eE=function(l,i,o,d){return l[0]=i,l[1]=o,l[2]=d,l},r.eF=function([l,i,o]){const d=Math.hypot(l,i,o),f=Math.atan2(l,o),m=.5*Math.PI-Math.acos(-i/d);return new Te(Et(f),Et(m))},r.eG=bi,r.eH=xx,r.eI=function(l){const i=l.navigator?l.navigator.userAgent:null;return!!function(o){if(Ls==null){const d=o.navigator?o.navigator.userAgent:null;Ls=!!o.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Ls}(l)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},r.eJ=function(l,i){_l=l,wc=i},r.eK=F_,r.eL=Cw,r.eM=function(l){const i=[0,0,0],o=M(new Float64Array(16));return U(o,l.pixelMatrix,l.globeMatrix),vt(i,i,o),new qt(i[0],i[1])},r.eN=function(){const l=zm;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(G_),zm=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.eO=function(){Ev().acquire(G_)},r.eP=hl,r.eQ=function(l,i,o=!1){if(ca===Wa.deferred||ca===Wa.loading||ca===Wa.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fl=vl.resolveURL(l),ca=Wa.deferred,Bh=i,vA(),o||_A()},r.eR=function(l){Rg=vl.resolveURL(l),Dg||(Dg=new kg(Ev(),new yu)),Dg.broadcast("setMeshoptUrl",Rg)},r.eS=M2,r.eT=function(l){X_=vl.resolveURL(l),Dg||(Dg=new kg(Ev(),new yu)),Dg.broadcast("setDracoUrl",X_)},r.eU=L2,r.eV=Um,r.eW=function(l){const i=hu();if(!i)return;const o=i.delete(bc);l&&o.then(()=>l()).catch(l)},r.eX=Kp,r.eY=Zi,r.eZ=sp,r.e_=zd,r.ea=function(l,i){var o=i[0],d=i[1],f=i[2],m=i[3],v=i[4],C=i[5],T=i[6],F=i[7],k=i[8],z=k*v-C*F,H=-k*m+C*T,$=F*m-v*T,ee=o*z+d*H+f*$;return ee?(l[0]=z*(ee=1/ee),l[1]=(-k*d+f*F)*ee,l[2]=(C*d-f*v)*ee,l[3]=H*ee,l[4]=(k*o-f*T)*ee,l[5]=(-C*o+f*m)*ee,l[6]=$*ee,l[7]=(-F*o+d*T)*ee,l[8]=(v*o-d*m)*ee,l):null},r.eb=lt,r.ec=vi,r.ed=bx,r.ee=function(l,i){if(l===i){var o=i[1],d=i[2],f=i[3],m=i[6],v=i[7],C=i[11];l[1]=i[4],l[2]=i[8],l[3]=i[12],l[4]=o,l[6]=i[9],l[7]=i[13],l[8]=d,l[9]=m,l[11]=i[14],l[12]=f,l[13]=v,l[14]=C}else l[0]=i[0],l[1]=i[4],l[2]=i[8],l[3]=i[12],l[4]=i[1],l[5]=i[5],l[6]=i[9],l[7]=i[13],l[8]=i[2],l[9]=i[6],l[10]=i[10],l[11]=i[14],l[12]=i[3],l[13]=i[7],l[14]=i[11],l[15]=i[15];return l},r.ef=oe,r.eg=[1,1,1],r.eh=class{constructor(l,i,o,d){this.context=l,this.format=d,this.size=o,this.texture=l.gl.createTexture();const[f,m,v]=this.size,{gl:C}=l;C.bindTexture(C.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),C.texImage3D(C.TEXTURE_3D,0,this.format,f,m,v,0,mx(this.format),yx(this.format),i.data)}bind(l,i){const{context:o}=this,{gl:d}=o;d.bindTexture(d.TEXTURE_3D,this.texture),l!==this.minFilter&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MAG_FILTER,l),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_MIN_FILTER,l),this.minFilter=l),i!==this.wrapS&&(d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_3D,d.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},r.ei=Qg,r.ej=function(l,i,o,d){var f=new b(4);return f[0]=l,f[1]=i,f[2]=o,f[3]=d,f},r.ek=it,r.el=function(l,i,o,d){var f=i[0],m=i[1],v=i[2],C=i[3];return l[0]=f+d*(o[0]-f),l[1]=m+d*(o[1]-m),l[2]=v+d*(o[2]-v),l[3]=C+d*(o[3]-C),l},r.em=Hg,r.en=Mh,r.eo=Ph,r.ep=function(l,i,o,d,f,m,v,C,T,F,k,z,H,$,ee,ae){var fe=new b(16);return fe[0]=l,fe[1]=i,fe[2]=o,fe[3]=d,fe[4]=f,fe[5]=m,fe[6]=v,fe[7]=C,fe[8]=T,fe[9]=F,fe[10]=k,fe[11]=z,fe[12]=H,fe[13]=$,fe[14]=ee,fe[15]=ae,fe},r.eq=ge,r.er=cf,r.es=zp,r.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new qt(1/0,1/0),max:new qt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,i=!1){const o=i2(new qt(0,0),new qt(wi,wi),l),d=[];if(i&&!N_(o,this._globalClipBounds))return d;for(const f of this._activeRegions){if(f.hiddenByOverlap||!N_(o,f))continue;const m=nL(f.min,f.max,l);d.push({min:m.min,max:m.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return d}setSources(l){this._setSources(l.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const o=[];for(const d of i.cache.getVisibleCoordinates()){const f=i.cache.getTile(d).buckets[i.layer];f&&f.updateFootprints(d.toUnwrapped(),o)}return o},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(l){const i=l.getFootprints();if(i.length===0)return;const o=l.getOrder(),d=l.getClipMask(),f=l.getClipScope();for(const m of i){if(!m.footprint)continue;const v=i2(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:o,clipMask:d,clipScope:f})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,o)=>i.priority-o.priority||wv(i.min,o.min)||wv(i.max,o.max)||i.order-o.order||i.clipMask-o.clipMask||function(d,f){const m=(v,C)=>v+C;return d.length-f.length||d.reduce(m,"").localeCompare(f.reduce(m,""))}(i.clipScope,o.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let i=0;for(;!l&&i!==this._activeRegions.length;){const o=this._activeRegions[i],d=this._prevRegions[i];l=o.priority!==d.priority||!t2(o,d)||o.order!==d.order||o.clipMask!==d.clipMask||!Vn(o.clipScope,d.clipScope),++i}}if(l){++this._updateTime;for(const o of this._activeRegions)o.order!==bv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const i=o=>{const d=this._activeRegions;if(o>=d.length)return o;const f=d[o].priority;for(;o<d.length&&d[o].priority===f;)++o;return o};if(this._sourceIds.length>1){let o=0,d=i(o);for(;o!==d;){let f=o;const m=o;for(;f!==d;){const v=this._activeRegions[f];v.hiddenByOverlap=!1;for(let C=0;C<m;C++){const T=this._activeRegions[C];if(!T.hiddenByOverlap&&v.order===bv&&N_(v,T)&&(v.hiddenByOverlap=n2(v.footprint,v.tileId,T.footprint,T.tileId),v.hiddenByOverlap))break}++f}o=d,d=i(o)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=l.length-1;i>=0;i--)this._addSource(l[i]);this._computeReplacement()}},r.eu=bv,r.ev=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,i){const o=new $u,d=new Jo,f=[],m=l+1+2,v=i[0]+1,C=i[0]+1+(1+i.length),T=(F,k,z)=>{let H=F===m-1?F-2:F===0?F:F-1;return H+=z?24575:0,[H,k]};for(let F=0;F<m;++F)o.emplaceBack(...T(F,0,!0));for(let F=0;F<v;++F)for(let k=0;k<m;++k)o.emplaceBack(...T(k,F,(k===0||k===m-1)&&!0));for(let F=0;F<i.length;++F){const k=i[F];for(let z=0;z<m;++z)o.emplaceBack(...T(z,k,!0))}for(let F=0;F<i.length;++F){const k=d.length,z=i[F]+1+2,H=new Jo;for(let ae=0;ae<z-1;ae++){const fe=ae===z-2,ve=fe?m*(C-i.length+F-ae):m;for(let Fe=0;Fe<m-1;Fe++){const Pe=ae*m+Fe;ae===0||fe||Fe===0||Fe===m-2?(H.emplaceBack(Pe+1,Pe,Pe+ve),H.emplaceBack(Pe+ve,Pe+ve+1,Pe+1)):(d.emplaceBack(Pe+1,Pe,Pe+ve),d.emplaceBack(Pe+ve,Pe+ve+1,Pe+1))}}const $=Gs.simpleSegment(0,k,o.length,d.length-k);for(let ae=0;ae<H.uint16.length;ae+=3)d.emplaceBack(H.uint16[ae],H.uint16[ae+1],H.uint16[ae+2]);const ee=Gs.simpleSegment(0,k,o.length,d.length-k);f.push({withoutSkirts:$,withSkirts:ee})}return{vertices:o,indices:d,segments:f}}_createGrid(l){const i=this._fillGridMeshWithLods(Y,J);this._gridSegments=i.segments,this._gridBuffer=l.createVertexBuffer(i.vertices,rp.members),this._gridIndexBuffer=l.createIndexBuffer(i.indices,!0)}_createPoles(l){const i=new Jo;for(let v=0;v<=Y;v++)i.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=l.createIndexBuffer(i,!0);const o=new $h,d=new $h,f=new $h,m=new $h;this._poleSegments=[];for(let v=0,C=0;v<L;v++){const T=360/(1<<v);o.emplaceBack(0,-S,0,.5,0),d.emplaceBack(0,-S,0,.5,1),f.emplaceBack(0,-S,0,.5,.5),m.emplaceBack(0,-S,0,.5,.5);for(let F=0;F<=Y;F++){let k=F/Y,z=0;const H=Er(0,T,k),[$,ee,ae]=de(IF,TF,H,S);o.emplaceBack($,ee,ae,k,z),d.emplaceBack($,ee,ae,k,1-z);const fe=dn(H);k=.5+.5*Math.sin(fe),z=.5+.5*Math.cos(fe),f.emplaceBack($,ee,ae,k,z),m.emplaceBack($,ee,ae,k,1-z)}this._poleSegments.push(Gs.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(o,rh,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(d,rh,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(f,rh,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(m,rh,!1)}getGridBuffers(l,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},r.ew=He,r.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.ey=tt,r.ez=Pt,r.f=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(i,o)=>String.fromCharCode(+("0x"+o))))},r.f0=$C,r.f1=H2,r.f2=vn,r.f3="hd_road_elevation",r.f4=Ht,r.f5=nr,r.f6=Xp,r.f7=ox,r.f8=qp,r.f9=function(l,i,o,d,f,m,v,C=1,T,F,k){l.createArrays(),l.tilePixelRatio=wi/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const z=l.layers[0].layout,H=l.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=C,$.textSizeScaleRange=z.get("text-size-scale-range"),$.iconSizeScaleRange=z.get("icon-size-scale-range");const[ee,ae]=$.textSizeScaleRange,[fe,ve]=$.iconSizeScaleRange;$.textScaleFactor=Ye($.scaleFactor,ee,ae),$.iconScaleFactor=Ye($.scaleFactor,fe,ve);const Fe=H["text-size"],Pe=H["icon-size"];if(l.textSizeData.kind==="composite"){const{minZoom:At,maxZoom:_t}=l.textSizeData;$.compositeTextSizes=[Fe.possiblyEvaluate(new $n(At,{worldview:k}),m),Fe.possiblyEvaluate(new $n(_t,{worldview:k}),m)]}if(l.iconSizeData.kind==="composite"){const{minZoom:At,maxZoom:_t}=l.iconSizeData;$.compositeIconSizes=[Pe.possiblyEvaluate(new $n(At,{worldview:k}),m),Pe.possiblyEvaluate(new $n(_t,{worldview:k}),m)]}$.layoutTextSize=Fe.possiblyEvaluate(new $n(v+1,{worldview:k}),m),$.layoutIconSize=Pe.possiblyEvaluate(new $n(v+1,{worldview:k}),m),$.textMaxSize=Fe.possiblyEvaluate(new $n(18,{worldview:k}),m);const ue=z.get("symbol-placement"),Ie=z.get("text-rotation-alignment")==="map"&&ue!=="point",ke=z.get("text-size");let Ge=!1;const yt=[];for(const At of l.features){const _t=z.get("text-font").evaluate(At,{},m).join(","),Mt=ke.evaluate(At,{},m)*$.textScaleFactor,Wt=$.layoutTextSize.evaluate(At,{},m)*$.textScaleFactor,Si=$.layoutIconSize.evaluate(At,{},m)*$.iconScaleFactor,Ai={horizontal:{},vertical:void 0},Ci=At.text;let Ti,$t=[0,0];if(Ci){const Nr=Ci.toString(),an=z.get("text-letter-spacing").evaluate(At,{},m)*rl,on=z.get("text-line-height").evaluate(At,{},m)*rl,_n=gd(Nr)?an:0,un=z.get("text-anchor").evaluate(At,{},m),xn=z.get("text-variable-anchor");if(!xn){const Jt=z.get("text-radial-offset").evaluate(At,{},m);if(Jt)$t=SB(un,[Jt*rl,lx]);else{const zi=z.get("text-offset").evaluate(At,{},m);$t=[zi[0]*rl,zi[1]*rl]}}let as=Ie?"center":z.get("text-justify").evaluate(At,{},m);const js=ue==="point",Ne=js?z.get("text-max-width").evaluate(At,{},m)*rl:1/0,Xe=Jt=>{l.allowVerticalPlacement&&Wu(Nr)&&(Ai.vertical=rx(Ci,i,o,f,_t,Ne,on,un,Jt,_n,$t,Mu.vertical,!0,Wt,Mt,T))};if(!Ie&&xn){const Jt=as==="auto"?xn.map(Yi=>cx(Yi)):[as];let zi=!1;for(let Yi=0;Yi<Jt.length;Yi++){const Wi=Jt[Yi];if(!Ai.horizontal[Wi])if(zi)Ai.horizontal[Wi]=Ai.horizontal[0];else{const or=rx(Ci,i,o,f,_t,Ne,on,"center",Wi,_n,$t,Mu.horizontal,!1,Wt,Mt,T);or&&(Ai.horizontal[Wi]=or,zi=or.positionedLines.length===1)}}Xe("left")}else{if(as==="auto"&&(as=cx(un)),js||z.get("text-writing-mode").indexOf("horizontal")>=0||!Wu(Nr)){const Jt=rx(Ci,i,o,f,_t,Ne,on,un,as,_n,$t,Mu.horizontal,!1,Wt,Mt,T);Jt&&(Ai.horizontal[as]=Jt)}Xe(js?"left":as)}}let _i,Vt,Yt,ki,Di,xr,ur=!1;const Xi=z.get("icon-text-fit").evaluate(At,{},m);if(At.icon&&At.icon.hasPrimary()){const Nr=IB(At.icon,l.iconSizeData,H["icon-size"],m,l.zoom,At,T,$.iconScaleFactor,k);_i=Nr.iconPrimary,Yt=Nr.iconSecondary;const an=_i.toString();if(Vt=d.get(an),Vt&&(Di=z.get("icon-offset").evaluate(At,{},m),xr=z.get("icon-anchor").evaluate(At,{},m),Ti=ZL(f.get(an),Yt?f.get(Yt.toString()):void 0,Di,xr),ur=Vt.sdf,l.sdfIcons===void 0?l.sdfIcons=Vt.sdf:l.sdfIcons!==Vt.sdf&&Yr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vt.pixelRatio!==l.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0)),Yt){const on=Yt.toString();ki=d.get(on)}}Ge=Ge||!(!At.icon||!At.icon.hasSecondary());const Pi=ux(Ai.horizontal)||Ai.vertical;l.iconsInText||(l.iconsInText=!!Pi&&Pi.iconsInText);const $r=Wt*$.textScaleFactor/rl,{defaultShapedIcon:ar,verticallyShapedIcon:fr}=lM(l,Ti,z,At,m,Ai,$r,Di,Xi);Xi!=="none"&&Ti&&(uB(Ti)||hB(Ti))&&(Dv(0,Vt,_i,Ti,ar,Xi,F,d,f),Dv(0,ki,Yt,Ti,ar,Xi,F,d,f),fr&&(Dv(0,Vt,_i,Ti,fr,Xi,F,d,f),Dv(0,ki,Yt,Ti,fr,Xi,F,d,f))),Ti=ar,yt.push({feature:At,shapedTextOrientations:Ai,shapedText:Pi,shapedIcon:Ti,iconPrimary:_i,iconSecondary:Yt,iconOffset:Di,iconAnchor:xr,verticallyShapedIcon:fr,layoutTextSize:Wt,layoutIconSize:Si,textOffset:$t,isSDFIcon:ur,iconTextFit:Xi})}return{featureData:yt,sizes:$,hasAnySecondaryIcon:Ge,textAlongLine:Ie,symbolPlacement:ue}},r.fa=_B,r.fb=function(l,i,o,d,f,m,v,C,T,F){const{featureData:k,hasAnySecondaryIcon:z,sizes:H,textAlongLine:$,symbolPlacement:ee}=i;for(const ae of k){const{shapedIcon:fe,verticallyShapedIcon:ve,feature:Fe,shapedTextOrientations:Pe,shapedText:ue,layoutTextSize:Ie,textOffset:ke,isSDFIcon:Ge,iconPrimary:yt,iconSecondary:At,iconTextFit:_t,iconOffset:Mt}=ae;TB(fe,F.iconPositions,yt,At),TB(ve,F.iconPositions,yt,At),aM(Pe,F.iconPositions),oM(yt,At,F.iconPositions),(ue||fe)&&cM(l,Fe,Pe,fe,ve,T,H,Ie,0,ke,Ge,d,f,v,C,z,_t,Mt,$,ee)}o&&l.generateCollisionDebugBuffers(m,l.collisionBoxArray,H.textScaleFactor)},r.fc=ln,r.fd=o0,r.fe=yr,r.ff=Jr,r.fg=iB,r.fh=ia,r.fi=function(l){let i=0;if(new Uint32Array(l,0,1)[0]!==k2){const o=new Uint32Array(l,0,7),[,,d,f,m,v]=o;i=o.byteLength+f+m+v+m,(d!==l.byteLength||i>=l.byteLength)&&Yr("Invalid b3dm header information.")}return U2(l,i)},r.fj=function(l,i){const o=KC(l);for(const d of o){for(const f of d.meshes)M3(f);d.lights&&(d.lightMeshIndex=d.meshes.length,d.meshes.push(P3(d.lights,i)))}return o},r.fk=e0,r.fl=En,r.fm=T2,r.fn=$c,r.fo=Wa,r.fp=function(l){xl(),ic!=null&&ic.then(i=>{i.keys().then(o=>{for(let d=0;d<o.length-l;d++)i.delete(o[d]).catch(f=>Yr(f.message))}).catch(o=>Yr(o.message))}).catch(i=>Yr(i.message))},r.g=function(l,i){return fu(Ut(l,{method:"GET"}),i)},r.h=Ut,r.i=function(l){return ds.API_STYLE_REGEX.test(l)&&!ch(l)},r.j=function(l){return l.indexOf("mapbox:")===0},r.k=_c,r.l=jc,r.m=function(l){return decodeURIComponent(atob(l).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.n=function(l,i){return fu(Ut(l,{type:"json"}),i)},r.o=Ah,r.p=function(l,i){return fu(Ut(l,{method:"POST"}),i)},r.q=vl,r.r=Pl,r.s=function(l){try{const i=self[l];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=Ou,r.u=function(){return function l(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},r.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},r.w=Yr,r.x=function(){return W_||(W_=new Kp),W_},r.y=Mx,r.z=rc}),h(["./shared"],function(r){function y(Et){const ye=Et?Et.url.toString():void 0;return ye?performance.getEntriesByName(ye):[]}function b(Et){if(typeof Et=="number"||typeof Et=="boolean"||typeof Et=="string"||Et==null)return JSON.stringify(Et);if(Array.isArray(Et)){let Ee="[";for(const He of Et)Ee+=`${b(He)},`;return`${Ee}]`}let ye="{";for(const Ee of Object.keys(Et).sort())ye+=`${Ee}:${b(Et[Ee])},`;return`${ye}}`}function _(Et){let ye="";for(const Ee of r.bu)ye+=`/${b(Et[Ee])}`;return ye}class B{constructor(ye){this.keyCache={},this._layers={},this._layerConfigs={},ye&&this.replace(ye)}replace(ye,Ee){this._layerConfigs={},this._layers={},this.update(ye,[],Ee)}update(ye,Ee,He){this._options=He;for(const Ye of ye)this._layerConfigs[Ye.id]=Ye,(this._layers[Ye.id]=r.db(Ye,this.scope,null,this._options)).compileFilter(He),this.keyCache[Ye.id]&&delete this.keyCache[Ye.id];for(const Ye of Ee)delete this.keyCache[Ye],delete this._layerConfigs[Ye],delete this._layers[Ye];this.familiesBySource={};const tt=function(Ye,xt){const Dt={};for(let Ut=0;Ut<Ye.length;Ut++){const ii=Ye[Ut];let Nt=xt&&xt[ii.id];Nt||(ii.type==="symbol"?Nt=ii.id:(Nt=_(ii),ii.type==="line"&&ii.paint&&function er(nr){return typeof nr=="string"&&nr==="line-progress"||(Array.isArray(nr)?nr.some(er):!(!nr||typeof nr!="object")&&Object.values(nr).some(er))}(ii.paint["line-width"])&&(Nt+=`/${b(ii.paint["line-width"])}`))),xt&&(xt[ii.id]=Nt);let Fi=Dt[Nt];Fi||(Fi=Dt[Nt]=[]),Fi.push(ii)}const bt=[];for(const Ut in Dt)bt.push(Dt[Ut]);return bt}(Object.values(this._layerConfigs),this.keyCache);for(const Ye of tt){const xt=Ye.map(Fi=>this._layers[Fi.id]),Dt=xt[0];if(Dt.visibility==="none")continue;const bt=Dt.source||"";let Ut=this.familiesBySource[bt];Ut||(Ut=this.familiesBySource[bt]={});const ii=Dt.sourceLayer||"_geojsonTileLayer";let Nt=Ut[ii];Nt||(Nt=Ut[ii]=[]),Nt.push(xt)}}}const I=1*r.e_;class E{constructor(ye){const Ee={},He=[];for(const Dt in ye){const bt=ye[Dt],Ut=Ee[Dt]={};for(const ii in bt.glyphs){const Nt=bt.glyphs[+ii];if(!Nt||Nt.bitmap.width===0||Nt.bitmap.height===0)continue;const Fi=Nt.metrics.localGlyph?I:1,er={x:0,y:0,w:Nt.bitmap.width+2*Fi,h:Nt.bitmap.height+2*Fi};He.push(er),Ut[ii]=er}}const{w:tt,h:Ye}=r.H(He),xt=new r.eZ({width:tt||1,height:Ye||1});for(const Dt in ye){const bt=ye[Dt];for(const Ut in bt.glyphs){const ii=bt.glyphs[+Ut];if(!ii||ii.bitmap.width===0||ii.bitmap.height===0)continue;const Nt=Ee[Dt][Ut],Fi=ii.metrics.localGlyph?I:1;r.eZ.copy(ii.bitmap,xt,{x:0,y:0},{x:Nt.x+Fi,y:Nt.y+Fi},ii.bitmap)}}this.image=xt,this.positions=Ee}}r.eY(E,"GlyphAtlas");class R{constructor(ye){this.tileID=new r.aM(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.lut=ye.lut,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.scope=ye.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ye.showCollisionBoxes,this.collectResourceTiming=!!ye.request&&ye.request.collectResourceTiming,this.promoteId=ye.promoteId,this.isSymbolTile=ye.isSymbolTile,this.tileTransform=r.aW(ye.tileID.canonical,ye.projection),this.projection=ye.projection,this.worldview=ye.worldview,this.localizableLayerIds=ye.localizableLayerIds,this.brightness=ye.brightness,this.extraShadowCaster=!!ye.extraShadowCaster,this.tessellationStep=ye.tessellationStep,this.scaleFactor=ye.scaleFactor,this.worldview=ye.worldview}parse(ye,Ee,He,tt,Ye,xt){this.status="parsing",this.data=ye,this.collisionBoxArray=new r.b0;const Dt=new r.e$(Object.keys(ye.layers).sort()),bt=new r.f0(this.tileID,this.promoteId);bt.bucketLayerIDs=[];const Ut={},ii=new r.f1(256,256),Nt={featureIndex:bt,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:ii,availableImages:He,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Fi=[],er=Ee.familiesBySource[this.source];for(const Sr in er){const Mr=ye.layers[Sr];if(!Mr)continue;let jr=!1,nn=!1,Yr=!1;for(const En of er[Sr])En[0].type==="symbol"?jr=!0:nn=!0,En[0].is3D()&&En[0].type!=="model"&&(Yr=!0);if(this.extraShadowCaster&&!Yr||this.isSymbolTile===!0&&!jr||this.isSymbolTile===!1&&!nn)continue;Mr.version===1&&r.w(`Vector tile source "${this.source}" layer "${Sr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qn=Dt.encode(Sr),gs=[];let ms=!1;for(let En=0,In=0;En<Mr.length;En++){const Ls=Mr.feature(En),bs=bt.getId(Ls,Sr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Sr)){const hs=Ls.properties?Ls.properties.worldview:null;if(this.worldview&&typeof hs=="string")if(hs==="all")Ls.properties.$localized=!0;else{if(!hs.split(",").includes(this.worldview))continue;Ls.properties.$localized=!0,Ls.properties.worldview=this.worldview}}!ms&&Ls.properties&&Ls.properties.hasOwnProperty(r.f2)&&(ms=!0),gs.push({feature:Ls,id:bs,index:In,sourceLayerIndex:qn}),In++}ms&&!Nt.elevationFeatures&&ye.layers.hasOwnProperty(r.f3)&&(Nt.elevationFeatures=r.f4.parseFrom(ye.layers[r.f3],this.canonical));for(const En of er[Sr]){const In=En[0];if(this.extraShadowCaster&&(!In.is3D()||In.type==="model")||this.isSymbolTile!==void 0&&In.type==="symbol"!==this.isSymbolTile||In.minzoom&&this.zoom<Math.floor(In.minzoom)||In.maxzoom&&this.zoom>=In.maxzoom||In.visibility==="none")continue;M(En,this.zoom,Nt.brightness,He,this.worldview);const Ls=Ut[In.id]=In.createBucket({index:bt.bucketLayerIDs.length,layers:En,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:tt,worldview:this.worldview});bt.bucketLayerIDs.push(En.map(hs=>r.C(hs.id,hs.scope)));let bs=Ls.prepare?Ls.prepare():null;bs!=null?(bs=bs.then(()=>Ls.populate(gs,Nt,this.tileID.canonical,this.tileTransform)),Fi.push(bs)):Ls.populate(gs,Nt,this.tileID.canonical,this.tileTransform)}}const nr=()=>{let Sr,Mr,jr,nn,Yr,qn;ii.trim();const gs={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ms=()=>{if(Sr)return this.status="done",xt(Sr);if(this.extraShadowCaster)this.status="done",xt(null,{buckets:Object.values(Ut).filter(In=>!In.isEmpty()),featureIndex:bt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Nt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Mr&&jr&&nn){const In=new E(Mr),Ls=new Map;for(const[Uo,Da]of jr.entries()){const{imagePosition:So}=r.f7(Uo,Da,r.f8);Ls.set(Uo,So)}const bs={};for(const Uo in Ut){const Da=Ut[Uo];Da instanceof r.b1&&(M(Da.layers,this.zoom,Nt.brightness,He,this.worldview),bs[Uo]=r.f9(Da,Mr,In.positions,jr,Ls,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Yr,this.worldview))}const hs={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ye,jr,Yr,()=>{hs.iconsPending=!1,En(bs,In,hs)}),this.rasterizeIfNeeded(Ye,nn,qn,()=>{hs.patternsPending=!1,En(bs,In,hs)})}},En=(In,Ls,bs,hs)=>{if(bs.iconsPending||bs.patternsPending)return;const Uo=new r.fa(jr,nn,this.lut);for(const Da in Ut){const So=Ut[Da];if(Da in In)r.fb(So,In[Da],this.showCollisionBoxes,He,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,jr,Uo);else if(So.hasPattern&&(So instanceof r.b7||So instanceof r.b8||So instanceof r.dU)){M(So.layers,this.zoom,Nt.brightness,He,this.worldview);const vc=Object.fromEntries(Uo.patternPositions);So.addFeatures(Nt,this.tileID.canonical,vc,He,this.tileTransform,this.brightness)}}this.status="done",xt(null,{buckets:Object.values(Ut).filter(Da=>!Da.isEmpty()),featureIndex:bt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ls.image,lineAtlas:ii,imageAtlas:Uo,brightness:Nt.brightness})};if(!this.extraShadowCaster){const In=r.f5(Nt.glyphDependencies,hs=>Object.keys(hs).map(Number));Object.keys(In).length?Ye.send("getGlyphs",{uid:this.uid,stacks:In,scope:this.scope},(hs,Uo)=>{Sr||(Sr=hs,Mr=Uo,ms())},void 0,!1,gs):Mr={};const Ls=Array.from(Nt.iconDependencies.keys()).map(hs=>r.I.parse(hs));Ls.length?Ye.send("getImages",{images:Ls,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(hs,Uo)=>{Sr||(Sr=hs,jr=new Map,Yr=this.updateImageMapAndGetImageTaskQueue(jr,Uo,Nt.iconDependencies),ms())},void 0,!1,gs):(jr=new Map,Yr=new Map);const bs=Array.from(Nt.patternDependencies.keys()).map(hs=>r.I.parse(hs));bs.length?Ye.send("getImages",{images:bs,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(hs,Uo)=>{Sr||(Sr=hs,nn=new Map,qn=this.updateImageMapAndGetImageTaskQueue(nn,Uo,Nt.patternDependencies),ms())},void 0,!1,gs):(nn=new Map,qn=new Map)}if(Nt.elevationFeatures&&Nt.elevationFeatures.length>0){const In=[];for(const bs of Object.values(Ut))if(bs instanceof r.b8){const hs=bs.getUnevaluatedPortalGraph();hs&&In.push(hs)}const Ls=r.f6.evaluate(In);for(const bs of Object.values(Ut))if(bs instanceof r.b8){const hs=ye.layers[Dt.decode(bs.sourceLayerIndex)];bs.setEvaluatedPortalGraph(Ls,hs,this.tileID.canonical,Nt.availableImages,Nt.brightness)}}ms()};Fi.length>0?Promise.allSettled(Fi).then(nr).catch(xt):nr()}rasterizeIfNeeded(ye,Ee,He,tt){Array.from(Ee.values()).some(Ye=>Ye.usvg)?this.rasterize(ye,Ee,He,tt):tt()}updateImageMapAndGetImageTaskQueue(ye,Ee,He){const tt=new Map;for(const Ye of Ee.keys()){const xt=He.get(Ye)||[];for(const Dt of xt){const bt=Dt.toString(),Ut=Ee.get(Dt.id.toString());Ut.usvg?tt.has(bt)||(tt.set(bt,Dt),ye.set(bt,Object.assign({},Ut))):ye.set(bt,Ut)}}return tt}rasterize(ye,Ee,He,tt){this.rasterizeTask=ye.send("rasterizeImages",{scope:this.scope,tasks:He},(Ye,xt)=>{if(!Ye)for(const[Dt,bt]of xt.entries()){const Ut=Object.assign(Ee.get(Dt),{data:bt});Ee.set(Dt,Ut)}tt()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function M(Et,ye,Ee,He,tt){const Ye=new r.aa(ye,{brightness:Ee,worldview:tt});for(const xt of Et)xt.recalculate(Ye,He)}class G extends r.E{constructor(ye,Ee,He,tt,Ye,xt,Dt){super(),this.actor=ye,this.layerIndex=Ee,this.availableImages=He,this.availableModels=tt,this.loadVectorData=xt||r.aJ,this.loading={},this.loaded={},this.deduped=new r.aI(ye.scheduler),this.isSpriteLoaded=Ye,this.scheduler=ye.scheduler,this.brightness=Dt}loadTile(ye,Ee){const He=ye.uid,tt=ye&&ye.request,Ye=tt&&tt.collectResourceTiming,xt=this.loading[He]=new R(ye);xt.abort=this.loadVectorData(ye,(Dt,bt)=>{const Ut=!this.loading[He];if(delete this.loading[He],xt.cancelRasterize(),Ut||Dt||!bt)return xt.status="done",Ut||(this.loaded[He]=xt),Ee(Dt);const ii=bt.rawData,Nt={};bt.expires&&(Nt.expires=bt.expires),bt.cacheControl&&(Nt.cacheControl=bt.cacheControl),xt.vectorTile=bt.vectorTile||new r.fc.VectorTile(new r.bq(ii));const Fi=()=>{xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(er,nr)=>{if(er||!nr)return Ee(er);const Sr={};if(Ye){const Mr=y(tt);Mr.length>0&&(Sr.resourceTiming=JSON.parse(JSON.stringify(Mr)))}Ee(null,r.h({rawTileData:ii.slice(0)},nr,Nt,Sr))})};this.isSpriteLoaded?Fi():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Fi,{type:"parseTile",isSymbolTile:ye.isSymbolTile,zoom:ye.tileZoom}):Fi()}),this.loaded=this.loaded||{},this.loaded[He]=xt})}reloadTile(ye,Ee){const He=this.loaded,tt=ye.uid;if(He&&He[tt]){const Ye=He[tt];Ye.scaleFactor=ye.scaleFactor,Ye.showCollisionBoxes=ye.showCollisionBoxes,Ye.projection=ye.projection,Ye.brightness=ye.brightness,Ye.tileTransform=r.aW(ye.tileID.canonical,ye.projection),Ye.extraShadowCaster=ye.extraShadowCaster,Ye.lut=ye.lut,Ye.worldview=ye.worldview;const xt=(Dt,bt)=>{const Ut=Ye.reloadCallback;Ut&&(delete Ye.reloadCallback,Ye.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ut)),Ee(Dt,bt)};Ye.status==="parsing"?Ye.reloadCallback=xt:Ye.status==="done"&&(Ye.vectorTile?Ye.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,xt):xt())}else Ee(null,void 0)}abortTile(ye,Ee){const He=ye.uid,tt=this.loading[He];tt&&(tt.abort&&tt.abort(),delete this.loading[He]),Ee()}removeTile(ye,Ee){const He=this.loaded,tt=ye.uid;He&&He[tt]&&delete He[tt],Ee()}}class U{loadTile(ye,Ee){const{uid:He,encoding:tt,rawImageData:Ye,padding:xt}=ye,Dt=ImageBitmap&&Ye instanceof ImageBitmap?this.getImageData(Ye,xt):Ye;Ee(null,new r.fd(He,Dt,tt,xt<1))}reloadTile(ye,Ee){Ee(null,null)}abortTile(ye,Ee){Ee()}removeTile(ye,Ee){Ee()}getImageData(ye,Ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ye.width,ye.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ye.width,this.offscreenCanvas.height=ye.height,this.offscreenCanvasContext.drawImage(ye,0,0,ye.width,ye.height);const He=this.offscreenCanvasContext.getImageData(-Ee,-Ee,ye.width+2*Ee,ye.height+2*Ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),He}}r.bp.setPbf(r.bq);class Q{constructor(ye){this._mrt=new r.bp(ye.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ye.uid,this.tileID=ye.tileID,this.source=ye.source}parse(ye,Ee){const He=this._mrt;this.status="parsing",this._entireBuffer=ye;try{He.parseHeader(ye),this._isHeaderLoaded=!0;const tt=[];for(const Ye in He.layers){const xt=He.getLayer(Ye),Dt=xt.getDataRange(xt.getBandList()),bt=He.createDecodingTask(Dt),Ut=ye.slice(Dt.firstByte,Dt.lastByte+1),ii=r.bp.performDecoding(Ut,bt).then(Nt=>bt.complete(null,Nt)).catch(Nt=>bt.complete(Nt,null));tt.push(ii)}Promise.allSettled(tt).then(()=>Ee(null,He)).catch(Ye=>Ee(Ye))}catch(tt){Ee(tt)}}}class q{constructor(ye){this.actor=ye,this.loading={},this.loaded={}}loadTile(ye,Ee){const He=ye.uid,tt=ye.request,Ye=this.loading[He]=new Q(ye),{cancel:xt}=r.br(tt,(Dt,bt,Ut,ii)=>{const Nt=!this.loading[He];if(delete this.loading[He],Nt||Dt||!bt)return Ye.status="done",Nt||(this.loaded[He]=Ye),Ee(Dt);Ye.parse(bt,(Fi,er)=>{if(Fi||!er)return Ee(Fi);Ee(null,er,Ut,ii)}),this.loaded[He]=Ye});Ye.abort=xt}reloadTile(ye,Ee){Ee(null,void 0)}abortTile(ye,Ee){const He=ye.uid,tt=this.loading[He];tt&&(tt.abort&&tt.abort(),delete this.loading[He]),Ee()}removeTile(ye,Ee){const He=ye.uid;this.loaded[He]&&delete this.loaded[He],Ee()}decodeRasterArray(ye,Ee){r.bp.performDecoding(ye.buffer,ye.task).then(He=>Ee(null,He)).catch(He=>Ee(He))}}const ne=r.fc.VectorTileFeature.prototype.toGeoJSON;class re{constructor(ye){this._feature=ye,this.extent=r.aj,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Ee of this._feature.geometry)ye.push([new r.P(Ee[0],Ee[1])]);return ye}{const ye=[];for(const Ee of this._feature.geometry){const He=[];for(const tt of Ee)He.push(new r.P(tt[0],tt[1]));ye.push(He)}return ye}}toGeoJSON(ye,Ee,He){return ne.call(this,ye,Ee,He)}}class pe{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.aj,this.length=ye.length,this._features=ye}feature(ye){return new re(this._features[ye])}}class Ae{constructor(ye,Ee){this.name=ye,this.extent=r.aj,this.length=Ee.length,this._features=Ee}feature(ye){return new re(this._features[ye])}}class le extends pe{constructor(ye){super([]),this.layers={};for(const Ee in ye)this.layers[Ee]=new Ae(Ee,ye[Ee])}}const be=64/4096,we=128;class oe{constructor(){this.features=new Map}clear(){this.features.clear()}load(ye=[],Ee){for(const He of ye){const tt=He.id;if(tt==null)continue;let Ye=this.features.get(tt);Ye&&this.updateCache(Ye,Ee),He.geometry?(Ye=Le(He),this.updateCache(Ye,Ee),this.features.set(tt,Ye)):this.features.delete(tt),this.updateCache(Ye,Ee)}}updateCache(ye,Ee){for(const{canonical:He,uid:tt}of Object.values(Ee)){const{z:Ye,x:xt,y:Dt}=He;me(ye,Math.pow(2,Ye),xt,Dt)&&delete Ee[tt]}}getTile(ye,Ee,He){const tt=Math.pow(2,ye),Ye=[];for(const xt of this.features.values())me(xt,tt,Ee,He)&&Ye.push(Ze(xt,tt,Ee,He));return{features:Ye}}getFeatures(){return[...this.features.values()]}}function me({minX:Et,minY:ye,maxX:Ee,maxY:He},tt,Ye,xt){return Et<(Ye+1+be)/tt&&ye<(xt+1+be)/tt&&Ee>(Ye-be)/tt&&He>(xt-be)/tt}function Le(Et){const{id:ye,geometry:Ee,properties:He}=Et;if(!Ee)return;if(Ee.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:tt,coordinates:Ye}=Ee,xt={id:ye,type:1,geometry:[],tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Dt=xt.geometry;if(tt==="Point")Se(Ye,Dt,xt);else if(tt==="MultiPoint")for(const bt of Ye)Se(bt,Dt,xt);else if(tt==="LineString")xt.type=2,Me(Ye,Dt,xt);else if(tt==="MultiLineString")xt.type=2,Re(Ye,Dt,xt);else if(tt==="Polygon")xt.type=3,Re(Ye,Dt,xt,!0);else{if(tt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xt.type=3;for(const bt of Ye)Re(bt,Dt,xt,!0)}return xt}function Se([Et,ye],Ee,He){const tt=r.aD(Et);let Ye=r.aH(ye);Ye=Ye<0?0:Ye>1?1:Ye,Ee.push(tt,Ye),He.minX=Math.min(He.minX,tt),He.minY=Math.min(He.minY,Ye),He.maxX=Math.max(He.maxX,tt),He.maxY=Math.max(He.maxY,Ye)}function Me(Et,ye,Ee,He=!1,tt=!1){const Ye=[];for(const xt of Et)Se(xt,Ye,Ee);ye.push(Ye),He&&function(xt,Dt){let bt=0;for(let Ut=0,ii=xt.length,Nt=ii-2;Ut<ii;Nt=Ut,Ut+=2)bt+=(xt[Ut]-xt[Nt])*(xt[Ut+1]+xt[Nt+1]);if(bt>0===Dt)for(let Ut=0,ii=xt.length;Ut<ii/2;Ut+=2){const Nt=xt[Ut],Fi=xt[Ut+1];xt[Ut]=xt[ii-2-Ut],xt[Ut+1]=xt[ii-1-Ut],xt[ii-2-Ut]=Nt,xt[ii-1-Ut]=Fi}}(Ye,tt)}function Re(Et,ye,Ee,He=!1){for(let tt=0;tt<Et.length;tt++)Me(Et[tt],ye,Ee,He,tt===0)}function Ze(Et,ye,Ee,He){const{id:tt,type:Ye,geometry:xt,tags:Dt}=Et,bt=[];if(Ye===1)(function(Ut,ii,Nt,Fi,er){for(let nr=0;nr<Ut.length;nr+=2){const Sr=Math.round(r.aj*(Ut[nr+0]*ii-Nt)),Mr=Math.round(r.aj*(Ut[nr+1]*ii-Fi));er.push([Sr,Mr])}})(xt,ye,Ee,He,bt);else for(const Ut of xt)$e(Ut,ye,Ee,He,bt);return{id:tt,type:Ye,geometry:bt,tags:Dt}}function $e(Et,ye,Ee,He,tt){const xt=r.aj+we;let Dt;for(let bt=0;bt<Et.length-2;bt+=2){let Ut=Math.round(r.aj*(Et[bt+0]*ye-Ee)),ii=Math.round(r.aj*(Et[bt+1]*ye-He)),Nt=Math.round(r.aj*(Et[bt+2]*ye-Ee)),Fi=Math.round(r.aj*(Et[bt+3]*ye-He));const er=Nt-Ut,nr=Fi-ii;Ut<-128&&Nt<-128||(Ut<-128?(ii+=Math.round(nr*((-128-Ut)/er)),Ut=-128):Nt<-128&&(Fi=ii+Math.round(nr*((-128-Ut)/er)),Nt=-128),ii<-128&&Fi<-128||(ii<-128?(Ut+=Math.round(er*((-128-ii)/nr)),ii=-128):Fi<-128&&(Nt=Ut+Math.round(er*((-128-ii)/nr)),Fi=-128),Ut>=xt&&Nt>=xt||(Ut>=xt?(ii+=Math.round(nr*((xt-Ut)/er)),Ut=xt):Nt>=xt&&(Fi=ii+Math.round(nr*((xt-Ut)/er)),Nt=xt),ii>=xt&&Fi>=xt||(ii>=xt?(Ut+=Math.round(er*((xt-ii)/nr)),ii=xt):Fi>=xt&&(Nt=Ut+Math.round(er*((xt-ii)/nr)),Fi=xt),Dt&&Ut===Dt[Dt.length-1][0]&&ii===Dt[Dt.length-1][1]||(Dt=[[Ut,ii]],tt.push(Dt)),Dt.push([Nt,Fi])))))}}var ct,Qe,It,Ce={exports:{}},Je=function(){if(It)return Ce.exports;It=1;var Et=r.fg(),ye=function(){if(Qe)return ct;Qe=1;var ii=r.fe(),Nt=r.ff().VectorTileFeature;function Fi(nr,Sr){this.options=Sr||{},this.features=nr,this.length=nr.length}function er(nr,Sr){this.id=typeof nr.id=="number"?nr.id:void 0,this.type=nr.type,this.rawGeometry=nr.type===1?[nr.geometry]:nr.geometry,this.properties=nr.tags,this.extent=Sr||4096}return ct=Fi,Fi.prototype.feature=function(nr){return new er(this.features[nr],this.options.extent)},er.prototype.loadGeometry=function(){var nr=this.rawGeometry;this.geometry=[];for(var Sr=0;Sr<nr.length;Sr++){for(var Mr=nr[Sr],jr=[],nn=0;nn<Mr.length;nn++)jr.push(new ii(Mr[nn][0],Mr[nn][1]));this.geometry.push(jr)}return this.geometry},er.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var nr=this.geometry,Sr=1/0,Mr=-1/0,jr=1/0,nn=-1/0,Yr=0;Yr<nr.length;Yr++)for(var qn=nr[Yr],gs=0;gs<qn.length;gs++){var ms=qn[gs];Sr=Math.min(Sr,ms.x),Mr=Math.max(Mr,ms.x),jr=Math.min(jr,ms.y),nn=Math.max(nn,ms.y)}return[Sr,jr,Mr,nn]},er.prototype.toGeoJSON=Nt.prototype.toGeoJSON,ct}();function Ee(ii){var Nt=new Et;return function(Fi,er){for(var nr in Fi.layers)er.writeMessage(3,He,Fi.layers[nr])}(ii,Nt),Nt.finish()}function He(ii,Nt){var Fi;Nt.writeVarintField(15,ii.version||1),Nt.writeStringField(1,ii.name||""),Nt.writeVarintField(5,ii.extent||4096);var er={keys:[],values:[],keycache:{},valuecache:{}};for(Fi=0;Fi<ii.length;Fi++)er.feature=ii.feature(Fi),Nt.writeMessage(2,tt,er);var nr=er.keys;for(Fi=0;Fi<nr.length;Fi++)Nt.writeStringField(3,nr[Fi]);var Sr=er.values;for(Fi=0;Fi<Sr.length;Fi++)Nt.writeMessage(4,Ut,Sr[Fi])}function tt(ii,Nt){var Fi=ii.feature;Fi.id!==void 0&&Nt.writeVarintField(1,Fi.id),Nt.writeMessage(2,Ye,ii),Nt.writeVarintField(3,Fi.type),Nt.writeMessage(4,bt,Fi)}function Ye(ii,Nt){var Fi=ii.feature,er=ii.keys,nr=ii.values,Sr=ii.keycache,Mr=ii.valuecache;for(var jr in Fi.properties){var nn=Fi.properties[jr],Yr=Sr[jr];if(nn!==null){Yr===void 0&&(er.push(jr),Sr[jr]=Yr=er.length-1),Nt.writeVarint(Yr);var qn=typeof nn;qn!=="string"&&qn!=="boolean"&&qn!=="number"&&(nn=JSON.stringify(nn));var gs=qn+":"+nn,ms=Mr[gs];ms===void 0&&(nr.push(nn),Mr[gs]=ms=nr.length-1),Nt.writeVarint(ms)}}}function xt(ii,Nt){return(Nt<<3)+(7&ii)}function Dt(ii){return ii<<1^ii>>31}function bt(ii,Nt){for(var Fi=ii.loadGeometry(),er=ii.type,nr=0,Sr=0,Mr=Fi.length,jr=0;jr<Mr;jr++){var nn=Fi[jr],Yr=1;er===1&&(Yr=nn.length),Nt.writeVarint(xt(1,Yr));for(var qn=er===3?nn.length-1:nn.length,gs=0;gs<qn;gs++){gs===1&&er!==1&&Nt.writeVarint(xt(2,qn-1));var ms=nn[gs].x-nr,En=nn[gs].y-Sr;Nt.writeVarint(Dt(ms)),Nt.writeVarint(Dt(En)),nr+=ms,Sr+=En}er===3&&Nt.writeVarint(xt(7,1))}}function Ut(ii,Nt){var Fi=typeof ii;Fi==="string"?Nt.writeStringField(1,ii):Fi==="boolean"?Nt.writeBooleanField(7,ii):Fi==="number"&&(ii%1!=0?Nt.writeDoubleField(3,ii):ii<0?Nt.writeSVarintField(6,ii):Nt.writeVarintField(5,ii))}return Ce.exports=Ee,Ce.exports.fromVectorTileJs=Ee,Ce.exports.fromGeojsonVt=function(ii,Nt){Nt=Nt||{};var Fi={};for(var er in ii)Fi[er]=new ye(ii[er].features,Nt),Fi[er].name=er,Fi[er].version=Nt.version,Fi[er].extent=Nt.extent;return Ee({layers:Fi})},Ce.exports.GeoJSONWrapper=ye,Ce.exports}(),lt=r.fh(Je);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Et=>Et},Bt=Math.fround||(rt=new Float32Array(1),Et=>(rt[0]=+Et,rt[0]));var rt;const St=3,vt=5,Gt=6;class mi{constructor(ye){this.options=Object.assign(Object.create(mt),ye),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ye){const{log:Ee,minZoom:He,maxZoom:tt}=this.options;Ee&&console.time("total time");const Ye=`prepare ${ye.length} points`;Ee&&console.time(Ye),this.points=ye;const xt=[];for(let bt=0;bt<ye.length;bt++){const Ut=ye[bt];if(!Ut.geometry)continue;const[ii,Nt]=Ut.geometry.coordinates,Fi=Bt(kt(ii)),er=Bt(Ft(Nt));xt.push(Fi,er,1/0,bt,-1,1),this.options.reduce&&xt.push(0)}let Dt=this.trees[tt+1]=this._createTree(xt);Ee&&console.timeEnd(Ye);for(let bt=tt;bt>=He;bt--){const Ut=+Date.now();Dt=this.trees[bt]=this._createTree(this._cluster(Dt,bt)),Ee&&console.log("z%d: %d clusters in %dms",bt,Dt.numItems,+Date.now()-Ut)}return Ee&&console.timeEnd("total time"),this}getClusters(ye,Ee){let He=((ye[0]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,ye[1]));let Ye=ye[2]===180?180:((ye[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,ye[3]));if(ye[2]-ye[0]>=360)He=-180,Ye=180;else if(He>Ye){const Nt=this.getClusters([He,tt,180,xt],Ee),Fi=this.getClusters([-180,tt,Ye,xt],Ee);return Nt.concat(Fi)}const Dt=this.trees[this._limitZoom(Ee)],bt=Dt.range(kt(He),Ft(xt),kt(Ye),Ft(tt)),Ut=Dt.data,ii=[];for(const Nt of bt){const Fi=this.stride*Nt;ii.push(Ut[Fi+vt]>1?ze(Ut,Fi,this.clusterProps):this.points[Ut[Fi+St]])}return ii}getChildren(ye){const Ee=this._getOriginId(ye),He=this._getOriginZoom(ye),tt="No cluster with the specified id.",Ye=this.trees[He];if(!Ye)throw new Error(tt);const xt=Ye.data;if(Ee*this.stride>=xt.length)throw new Error(tt);const Dt=this.options.radius/(this.options.extent*Math.pow(2,He-1)),bt=Ye.within(xt[Ee*this.stride],xt[Ee*this.stride+1],Dt),Ut=[];for(const ii of bt){const Nt=ii*this.stride;xt[Nt+4]===ye&&Ut.push(xt[Nt+vt]>1?ze(xt,Nt,this.clusterProps):this.points[xt[Nt+St]])}if(Ut.length===0)throw new Error(tt);return Ut}getLeaves(ye,Ee,He){const tt=[];return this._appendLeaves(tt,ye,Ee=Ee||10,He=He||0,0),tt}getTile(ye,Ee,He){const tt=this.trees[this._limitZoom(ye)],Ye=Math.pow(2,ye),{extent:xt,radius:Dt}=this.options,bt=Dt/xt,Ut=(He-bt)/Ye,ii=(He+1+bt)/Ye,Nt={features:[]};return this._addTileFeatures(tt.range((Ee-bt)/Ye,Ut,(Ee+1+bt)/Ye,ii),tt.data,Ee,He,Ye,Nt),Ee===0&&this._addTileFeatures(tt.range(1-bt/Ye,Ut,1,ii),tt.data,Ye,He,Ye,Nt),Ee===Ye-1&&this._addTileFeatures(tt.range(0,Ut,bt/Ye,ii),tt.data,-1,He,Ye,Nt),Nt.features.length?Nt:null}getClusterExpansionZoom(ye){let Ee=this._getOriginZoom(ye)-1;for(;Ee<=this.options.maxZoom;){const He=this.getChildren(ye);if(Ee++,He.length!==1)break;ye=He[0].properties.cluster_id}return Ee}_appendLeaves(ye,Ee,He,tt,Ye){const xt=this.getChildren(Ee);for(const Dt of xt){const bt=Dt.properties;if(bt&&bt.cluster?Ye+bt.point_count<=tt?Ye+=bt.point_count:Ye=this._appendLeaves(ye,bt.cluster_id,He,tt,Ye):Ye<tt?Ye++:ye.push(Dt),ye.length===He)break}return Ye}_createTree(ye){const Ee=new r.bW(ye.length/this.stride|0,this.options.nodeSize,Float32Array);for(let He=0;He<ye.length;He+=this.stride)Ee.add(ye[He],ye[He+1]);return Ee.finish(),Ee.data=ye,Ee}_addTileFeatures(ye,Ee,He,tt,Ye,xt){for(const Dt of ye){const bt=Dt*this.stride,Ut=Ee[bt+vt]>1;let ii,Nt,Fi;if(Ut)ii=Ve(Ee,bt,this.clusterProps),Nt=Ee[bt],Fi=Ee[bt+1];else{const Sr=this.points[Ee[bt+St]];ii=Sr.properties;const[Mr,jr]=Sr.geometry.coordinates;Nt=kt(Mr),Fi=Ft(jr)}const er={type:1,geometry:[[Math.round(this.options.extent*(Nt*Ye-He)),Math.round(this.options.extent*(Fi*Ye-tt))]],tags:ii};let nr;nr=Ut||this.options.generateId?Ee[bt+St]:this.points[Ee[bt+St]].id,nr!==void 0&&(er.id=nr),xt.features.push(er)}}_limitZoom(ye){return Math.max(this.options.minZoom,Math.min(Math.floor(+ye),this.options.maxZoom+1))}_cluster(ye,Ee){const{radius:He,extent:tt,reduce:Ye,minPoints:xt}=this.options,Dt=He/(tt*Math.pow(2,Ee)),bt=ye.data,Ut=[],ii=this.stride;for(let Nt=0;Nt<bt.length;Nt+=ii){if(bt[Nt+2]<=Ee)continue;bt[Nt+2]=Ee;const Fi=bt[Nt],er=bt[Nt+1],nr=ye.within(bt[Nt],bt[Nt+1],Dt),Sr=bt[Nt+vt];let Mr=Sr;for(const jr of nr){const nn=jr*ii;bt[nn+2]>Ee&&(Mr+=bt[nn+vt])}if(Mr>Sr&&Mr>=xt){let jr,nn=Fi*Sr,Yr=er*Sr,qn=-1;const gs=(Nt/ii<<5)+(Ee+1)+this.points.length;for(const ms of nr){const En=ms*ii;if(bt[En+2]<=Ee)continue;bt[En+2]=Ee;const In=bt[En+vt];nn+=bt[En]*In,Yr+=bt[En+1]*In,bt[En+4]=gs,Ye&&(jr||(jr=this._map(bt,Nt,!0),qn=this.clusterProps.length,this.clusterProps.push(jr)),Ye(jr,this._map(bt,En)))}bt[Nt+4]=gs,Ut.push(nn/Mr,Yr/Mr,1/0,gs,-1,Mr),Ye&&Ut.push(qn)}else{for(let jr=0;jr<ii;jr++)Ut.push(bt[Nt+jr]);if(Mr>1)for(const jr of nr){const nn=jr*ii;if(!(bt[nn+2]<=Ee)){bt[nn+2]=Ee;for(let Yr=0;Yr<ii;Yr++)Ut.push(bt[nn+Yr])}}}}return Ut}_getOriginId(ye){return ye-this.points.length>>5}_getOriginZoom(ye){return(ye-this.points.length)%32}_map(ye,Ee,He){if(ye[Ee+vt]>1){const xt=this.clusterProps[ye[Ee+Gt]];return He?Object.assign({},xt):xt}const tt=this.points[ye[Ee+St]].properties,Ye=this.options.map(tt);return He&&Ye===tt?Object.assign({},Ye):Ye}}function ze(Et,ye,Ee){return{type:"Feature",id:Et[ye+St],properties:Ve(Et,ye,Ee),geometry:{type:"Point",coordinates:[(He=Et[ye],360*(He-.5)),it(Et[ye+1])]}};var He}function Ve(Et,ye,Ee){const He=Et[ye+vt],tt=He>=1e4?`${Math.round(He/1e3)}k`:He>=1e3?Math.round(He/100)/10+"k":He,Ye=Et[ye+Gt],xt=Ye===-1?{}:Object.assign({},Ee[Ye]);return Object.assign(xt,{cluster:!0,cluster_id:Et[ye+St],point_count:He,point_count_abbreviated:tt})}function kt(Et){return Et/360+.5}function Ft(Et){const ye=Math.sin(Et*Math.PI/180),Ee=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return Ee<0?0:Ee>1?1:Ee}function it(Et){const ye=(180-360*Et)*Math.PI/180;return 360*Math.atan(Math.exp(ye))/Math.PI-90}function yi(Et,ye,Ee,He){let tt=He;const Ye=ye+(Ee-ye>>1);let xt,Dt=Ee-ye;const bt=Et[ye],Ut=Et[ye+1],ii=Et[Ee],Nt=Et[Ee+1];for(let Fi=ye+3;Fi<Ee;Fi+=3){const er=bi(Et[Fi],Et[Fi+1],bt,Ut,ii,Nt);if(er>tt)xt=Fi,tt=er;else if(er===tt){const nr=Math.abs(Fi-Ye);nr<Dt&&(xt=Fi,Dt=nr)}}tt>He&&(xt-ye>3&&yi(Et,ye,xt,He),Et[xt+2]=tt,Ee-xt>3&&yi(Et,xt,Ee,He))}function bi(Et,ye,Ee,He,tt,Ye){let xt=tt-Ee,Dt=Ye-He;if(xt!==0||Dt!==0){const bt=((Et-Ee)*xt+(ye-He)*Dt)/(xt*xt+Dt*Dt);bt>1?(Ee=tt,He=Ye):bt>0&&(Ee+=xt*bt,He+=Dt*bt)}return xt=Et-Ee,Dt=ye-He,xt*xt+Dt*Dt}function Kt(Et,ye,Ee,He){const tt={id:Et??null,type:ye,geometry:Ee,tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")di(tt,Ee);else if(ye==="Polygon")di(tt,Ee[0]);else if(ye==="MultiLineString")for(const Ye of Ee)di(tt,Ye);else if(ye==="MultiPolygon")for(const Ye of Ee)di(tt,Ye[0]);return tt}function di(Et,ye){for(let Ee=0;Ee<ye.length;Ee+=3)Et.minX=Math.min(Et.minX,ye[Ee]),Et.minY=Math.min(Et.minY,ye[Ee+1]),Et.maxX=Math.max(Et.maxX,ye[Ee]),Et.maxY=Math.max(Et.maxY,ye[Ee+1])}function fi(Et,ye,Ee,He){if(!ye.geometry)return;const tt=ye.geometry.coordinates;if(tt&&tt.length===0)return;const Ye=ye.geometry.type,xt=Math.pow(Ee.tolerance/((1<<Ee.maxZoom)*Ee.extent),2);let Dt=[],bt=ye.id;if(Ee.promoteId?bt=ye.properties[Ee.promoteId]:Ee.generateId&&(bt=He||0),Ye==="Point")Ri(tt,Dt);else if(Ye==="MultiPoint")for(const Ut of tt)Ri(Ut,Dt);else if(Ye==="LineString")Oi(tt,Dt,xt,!1);else if(Ye==="MultiLineString"){if(Ee.lineMetrics){for(const Ut of tt)Dt=[],Oi(Ut,Dt,xt,!1),Et.push(Kt(bt,"LineString",Dt,ye.properties));return}Ji(tt,Dt,xt,!1)}else if(Ye==="Polygon")Ji(tt,Dt,xt,!0);else{if(Ye!=="MultiPolygon"){if(Ye==="GeometryCollection"){for(const Ut of ye.geometry.geometries)fi(Et,{id:bt,geometry:Ut,properties:ye.properties},Ee,He);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ut of tt){const ii=[];Ji(Ut,ii,xt,!0),Dt.push(ii)}}Et.push(Kt(bt,Ye,Dt,ye.properties))}function Ri(Et,ye){ye.push(lr(Et[0]),br(Et[1]),0)}function Oi(Et,ye,Ee,He){let tt,Ye,xt=0;for(let bt=0;bt<Et.length;bt++){const Ut=lr(Et[bt][0]),ii=br(Et[bt][1]);ye.push(Ut,ii,0),bt>0&&(xt+=He?(tt*ii-Ut*Ye)/2:Math.sqrt(Math.pow(Ut-tt,2)+Math.pow(ii-Ye,2))),tt=Ut,Ye=ii}const Dt=ye.length-3;ye[2]=1,yi(ye,0,Dt,Ee),ye[Dt+2]=1,ye.size=Math.abs(xt),ye.start=0,ye.end=ye.size}function Ji(Et,ye,Ee,He){for(let tt=0;tt<Et.length;tt++){const Ye=[];Oi(Et[tt],Ye,Ee,He),ye.push(Ye)}}function lr(Et){return Et/360+.5}function br(Et){const ye=Math.sin(Et*Math.PI/180),Ee=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return Ee<0?0:Ee>1?1:Ee}function Dr(Et,ye,Ee,He,tt,Ye,xt,Dt){if(He/=ye,Ye>=(Ee/=ye)&&xt<He)return Et;if(xt<Ee||Ye>=He)return null;const bt=[];for(const Ut of Et){const ii=Ut.geometry;let Nt=Ut.type;const Fi=tt===0?Ut.minX:Ut.minY,er=tt===0?Ut.maxX:Ut.maxY;if(Fi>=Ee&&er<He){bt.push(Ut);continue}if(er<Ee||Fi>=He)continue;let nr=[];if(Nt==="Point"||Nt==="MultiPoint")Fr(ii,nr,Ee,He,tt);else if(Nt==="LineString")Qr(ii,nr,Ee,He,tt,!1,Dt.lineMetrics);else if(Nt==="MultiLineString")li(ii,nr,Ee,He,tt,!1);else if(Nt==="Polygon")li(ii,nr,Ee,He,tt,!0);else if(Nt==="MultiPolygon")for(const Sr of ii){const Mr=[];li(Sr,Mr,Ee,He,tt,!0),Mr.length&&nr.push(Mr)}if(nr.length){if(Dt.lineMetrics&&Nt==="LineString"){for(const Sr of nr)bt.push(Kt(Ut.id,Nt,Sr,Ut.tags));continue}Nt!=="LineString"&&Nt!=="MultiLineString"||(nr.length===1?(Nt="LineString",nr=nr[0]):Nt="MultiLineString"),Nt!=="Point"&&Nt!=="MultiPoint"||(Nt=nr.length===3?"Point":"MultiPoint"),bt.push(Kt(Ut.id,Nt,nr,Ut.tags))}}return bt.length?bt:null}function Fr(Et,ye,Ee,He,tt){for(let Ye=0;Ye<Et.length;Ye+=3){const xt=Et[Ye+tt];xt>=Ee&&xt<=He&&Vi(ye,Et[Ye],Et[Ye+1],Et[Ye+2])}}function Qr(Et,ye,Ee,He,tt,Ye,xt){let Dt=ui(Et);const bt=tt===0?rr:qr;let Ut,ii,Nt=Et.start;for(let Mr=0;Mr<Et.length-3;Mr+=3){const jr=Et[Mr],nn=Et[Mr+1],Yr=Et[Mr+2],qn=Et[Mr+3],gs=Et[Mr+4],ms=tt===0?jr:nn,En=tt===0?qn:gs;let In=!1;xt&&(Ut=Math.sqrt(Math.pow(jr-qn,2)+Math.pow(nn-gs,2))),ms<Ee?En>Ee&&(ii=bt(Dt,jr,nn,qn,gs,Ee),xt&&(Dt.start=Nt+Ut*ii)):ms>He?En<He&&(ii=bt(Dt,jr,nn,qn,gs,He),xt&&(Dt.start=Nt+Ut*ii)):Vi(Dt,jr,nn,Yr),En<Ee&&ms>=Ee&&(ii=bt(Dt,jr,nn,qn,gs,Ee),In=!0),En>He&&ms<=He&&(ii=bt(Dt,jr,nn,qn,gs,He),In=!0),!Ye&&In&&(xt&&(Dt.end=Nt+Ut*ii),ye.push(Dt),Dt=ui(Et)),xt&&(Nt+=Ut)}let Fi=Et.length-3;const er=Et[Fi],nr=Et[Fi+1],Sr=tt===0?er:nr;Sr>=Ee&&Sr<=He&&Vi(Dt,er,nr,Et[Fi+2]),Fi=Dt.length-3,Ye&&Fi>=3&&(Dt[Fi]!==Dt[0]||Dt[Fi+1]!==Dt[1])&&Vi(Dt,Dt[0],Dt[1],Dt[2]),Dt.length&&ye.push(Dt)}function ui(Et){const ye=[];return ye.size=Et.size,ye.start=Et.start,ye.end=Et.end,ye}function li(Et,ye,Ee,He,tt,Ye){for(const xt of Et)Qr(xt,ye,Ee,He,tt,Ye,!1)}function Vi(Et,ye,Ee,He){Et.push(ye,Ee,He)}function rr(Et,ye,Ee,He,tt,Ye){const xt=(Ye-ye)/(He-ye);return Vi(Et,Ye,Ee+(tt-Ee)*xt,1),xt}function qr(Et,ye,Ee,He,tt,Ye){const xt=(Ye-Ee)/(tt-Ee);return Vi(Et,ye+(He-ye)*xt,Ye,1),xt}function _r(Et,ye){const Ee=[];for(let He=0;He<Et.length;He++){const tt=Et[He],Ye=tt.type;let xt;if(Ye==="Point"||Ye==="MultiPoint"||Ye==="LineString")xt=Zr(tt.geometry,ye);else if(Ye==="MultiLineString"||Ye==="Polygon"){xt=[];for(const Dt of tt.geometry)xt.push(Zr(Dt,ye))}else if(Ye==="MultiPolygon"){xt=[];for(const Dt of tt.geometry){const bt=[];for(const Ut of Dt)bt.push(Zr(Ut,ye));xt.push(bt)}}Ee.push(Kt(tt.id,Ye,xt,tt.tags))}return Ee}function Zr(Et,ye){const Ee=[];Ee.size=Et.size,Et.start!==void 0&&(Ee.start=Et.start,Ee.end=Et.end);for(let He=0;He<Et.length;He+=3)Ee.push(Et[He]+ye,Et[He+1],Et[He+2]);return Ee}function io(Et,ye){if(Et.transformed)return Et;const Ee=1<<Et.z,He=Et.x,tt=Et.y;for(const Ye of Et.features){const xt=Ye.geometry,Dt=Ye.type;if(Ye.geometry=[],Dt===1)for(let bt=0;bt<xt.length;bt+=2)Ye.geometry.push(Ur(xt[bt],xt[bt+1],ye,Ee,He,tt));else for(let bt=0;bt<xt.length;bt++){const Ut=[];for(let ii=0;ii<xt[bt].length;ii+=2)Ut.push(Ur(xt[bt][ii],xt[bt][ii+1],ye,Ee,He,tt));Ye.geometry.push(Ut)}}return Et.transformed=!0,Et}function Ur(Et,ye,Ee,He,tt,Ye){return[Math.round(Ee*(Et*He-tt)),Math.round(Ee*(ye*He-Ye))]}function ia(Et,ye,Ee,He,tt){const Ye=ye===tt.maxZoom?0:tt.tolerance/((1<<ye)*tt.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:Et.length,source:null,x:Ee,y:He,z:ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Dt of Et)ps(xt,Dt,Ye,tt);return xt}function ps(Et,ye,Ee,He){const tt=ye.geometry,Ye=ye.type,xt=[];if(Et.minX=Math.min(Et.minX,ye.minX),Et.minY=Math.min(Et.minY,ye.minY),Et.maxX=Math.max(Et.maxX,ye.maxX),Et.maxY=Math.max(Et.maxY,ye.maxY),Ye==="Point"||Ye==="MultiPoint")for(let Dt=0;Dt<tt.length;Dt+=3)xt.push(tt[Dt],tt[Dt+1]),Et.numPoints++,Et.numSimplified++;else if(Ye==="LineString")ro(xt,tt,Et,Ee,!1,!1);else if(Ye==="MultiLineString"||Ye==="Polygon")for(let Dt=0;Dt<tt.length;Dt++)ro(xt,tt[Dt],Et,Ee,Ye==="Polygon",Dt===0);else if(Ye==="MultiPolygon")for(let Dt=0;Dt<tt.length;Dt++){const bt=tt[Dt];for(let Ut=0;Ut<bt.length;Ut++)ro(xt,bt[Ut],Et,Ee,!0,Ut===0)}if(xt.length){let Dt=ye.tags||null;if(Ye==="LineString"&&He.lineMetrics){Dt={};for(const Ut in ye.tags)Dt[Ut]=ye.tags[Ut];Dt.mapbox_clip_start=tt.start/tt.size,Dt.mapbox_clip_end=tt.end/tt.size}const bt={geometry:xt,type:Ye==="Polygon"||Ye==="MultiPolygon"?3:Ye==="LineString"||Ye==="MultiLineString"?2:1,tags:Dt};ye.id!==null&&(bt.id=ye.id),Et.features.push(bt)}}function ro(Et,ye,Ee,He,tt,Ye){const xt=He*He;if(He>0&&ye.size<(tt?xt:He))return void(Ee.numPoints+=ye.length/3);const Dt=[];for(let bt=0;bt<ye.length;bt+=3)(He===0||ye[bt+2]>xt)&&(Ee.numSimplified++,Dt.push(ye[bt],ye[bt+1])),Ee.numPoints++;tt&&function(bt,Ut){let ii=0;for(let Nt=0,Fi=bt.length,er=Fi-2;Nt<Fi;er=Nt,Nt+=2)ii+=(bt[Nt]-bt[er])*(bt[Nt+1]+bt[er+1]);if(ii>0===Ut)for(let Nt=0,Fi=bt.length;Nt<Fi/2;Nt+=2){const er=bt[Nt],nr=bt[Nt+1];bt[Nt]=bt[Fi-2-Nt],bt[Nt+1]=bt[Fi-1-Nt],bt[Fi-2-Nt]=er,bt[Fi-1-Nt]=nr}}(Dt,Ye),Et.push(Dt)}const Qn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Lr{constructor(ye,Ee){const He=(Ee=this.options=function(Ye,xt){for(const Dt in xt)Ye[Dt]=xt[Dt];return Ye}(Object.create(Qn),Ee)).debug;if(He&&console.time("preprocess data"),Ee.maxZoom<0||Ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ee.promoteId&&Ee.generateId)throw new Error("promoteId and generateId cannot be used together.");let tt=function(Ye,xt){const Dt=[];if(Ye.type==="FeatureCollection")for(let bt=0;bt<Ye.features.length;bt++)fi(Dt,Ye.features[bt],xt,bt);else fi(Dt,Ye.type==="Feature"?Ye:{geometry:Ye},xt);return Dt}(ye,Ee);this.tiles={},this.tileCoords=[],He&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ee.indexMaxZoom,Ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),tt=function(Ye,xt){const Dt=xt.buffer/xt.extent;let bt=Ye;const Ut=Dr(Ye,1,-1-Dt,Dt,0,-1,2,xt),ii=Dr(Ye,1,1-Dt,2+Dt,0,-1,2,xt);return(Ut||ii)&&(bt=Dr(Ye,1,-Dt,1+Dt,0,-1,2,xt)||[],Ut&&(bt=_r(Ut,1).concat(bt)),ii&&(bt=bt.concat(_r(ii,-1)))),bt}(tt,Ee),tt.length&&this.splitTile(tt,0,0,0),He&&(tt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ye,Ee,He,tt,Ye,xt,Dt){const bt=[ye,Ee,He,tt],Ut=this.options,ii=Ut.debug;for(;bt.length;){tt=bt.pop(),He=bt.pop(),Ee=bt.pop(),ye=bt.pop();const Nt=1<<Ee,Fi=yr(Ee,He,tt);let er=this.tiles[Fi];if(!er&&(ii>1&&console.time("creation"),er=this.tiles[Fi]=ia(ye,Ee,He,tt,Ut),this.tileCoords.push({z:Ee,x:He,y:tt}),ii)){ii>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ee,He,tt,er.numFeatures,er.numPoints,er.numSimplified),console.timeEnd("creation"));const In=`z${Ee}`;this.stats[In]=(this.stats[In]||0)+1,this.total++}if(er.source=ye,Ye==null){if(Ee===Ut.indexMaxZoom||er.numPoints<=Ut.indexMaxPoints)continue}else{if(Ee===Ut.maxZoom||Ee===Ye)continue;if(Ye!=null){const In=Ye-Ee;if(He!==xt>>In||tt!==Dt>>In)continue}}if(er.source=null,ye.length===0)continue;ii>1&&console.time("clipping");const nr=.5*Ut.buffer/Ut.extent,Sr=.5-nr,Mr=.5+nr,jr=1+nr;let nn=null,Yr=null,qn=null,gs=null,ms=Dr(ye,Nt,He-nr,He+Mr,0,er.minX,er.maxX,Ut),En=Dr(ye,Nt,He+Sr,He+jr,0,er.minX,er.maxX,Ut);ye=null,ms&&(nn=Dr(ms,Nt,tt-nr,tt+Mr,1,er.minY,er.maxY,Ut),Yr=Dr(ms,Nt,tt+Sr,tt+jr,1,er.minY,er.maxY,Ut),ms=null),En&&(qn=Dr(En,Nt,tt-nr,tt+Mr,1,er.minY,er.maxY,Ut),gs=Dr(En,Nt,tt+Sr,tt+jr,1,er.minY,er.maxY,Ut),En=null),ii>1&&console.timeEnd("clipping"),bt.push(nn||[],Ee+1,2*He,2*tt),bt.push(Yr||[],Ee+1,2*He,2*tt+1),bt.push(qn||[],Ee+1,2*He+1,2*tt),bt.push(gs||[],Ee+1,2*He+1,2*tt+1)}}getTile(ye,Ee,He){ye=+ye,Ee=+Ee,He=+He;const tt=this.options,{extent:Ye,debug:xt}=tt;if(ye<0||ye>24)return null;const Dt=1<<ye,bt=yr(ye,Ee=Ee+Dt&Dt-1,He);if(this.tiles[bt])return io(this.tiles[bt],Ye);xt>1&&console.log("drilling down to z%d-%d-%d",ye,Ee,He);let Ut,ii=ye,Nt=Ee,Fi=He;for(;!Ut&&ii>0;)ii--,Nt>>=1,Fi>>=1,Ut=this.tiles[yr(ii,Nt,Fi)];return Ut&&Ut.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",ii,Nt,Fi),console.time("drilling down")),this.splitTile(Ut.source,ii,Nt,Fi,ye,Ee,He),xt>1&&console.timeEnd("drilling down"),this.tiles[bt]?io(this.tiles[bt],Ye):null):null}}function yr(Et,ye,Ee){return 32*((1<<Et)*Ee+ye)+Et}function qt(Et,ye){const Ee=Et.tileID.canonical;if(!this._geoJSONIndex)return void ye(null,null);const He=this._geoJSONIndex.getTile(Ee.z,Ee.x,Ee.y);if(!He)return void ye(null,null);const tt=bt=>bt.tags&&"3d_elevation_id"in bt.tags&&"source"in bt.tags&&bt.tags.source==="elevation",Ye=He.features.filter(bt=>tt(bt));let xt;if(Ye.length>0){const bt=He.features.filter(Ut=>!tt(Ut));xt=new le({_geojsonTileLayer:bt,hd_road_elevation:Ye})}else xt=new pe(He.features);let Dt=lt(xt);Dt.byteOffset===0&&Dt.byteLength===Dt.buffer.byteLength||(Dt=new Uint8Array(Dt)),ye(null,{vectorTile:xt,rawData:Dt.buffer})}class Vn extends G{constructor(ye,Ee,He,tt,Ye,xt,Dt){super(ye,Ee,He,tt,Ye,qt,Dt),xt&&(this.loadGeoJSON=xt),this._dynamicIndex=new oe}loadData(ye,Ee){const He=ye&&ye.request,tt=He&&He.collectResourceTiming;this.loadGeoJSON(ye,(Ye,xt)=>{if(Ye||!xt)return Ee(Ye);if(typeof xt!="object")return Ee(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));{try{if(ye.filter){const bt=r.X(ye.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(bt.result==="error")throw new Error(bt.value.map(Ut=>`${Ut.key}: ${Ut.message}`).join(", "));xt.features=xt.features.filter(Ut=>bt.value.evaluate({zoom:0},Ut))}ye.dynamic?(xt.type==="Feature"&&(xt={type:"FeatureCollection",features:[xt]}),ye.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xt.features,this.loaded),ye.cluster&&(xt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ye.cluster?new mi(function({superclusterOptions:bt,clusterProperties:Ut}){if(!Ut||!bt)return bt;const ii={},Nt={},Fi={accumulated:null,zoom:0},er={properties:null},nr=Object.keys(Ut);for(const Sr of nr){const[Mr,jr]=Ut[Sr],nn=r.X(jr),Yr=r.X(typeof Mr=="string"?[Mr,["accumulated"],["get",Sr]]:Mr);ii[Sr]=nn.value,Nt[Sr]=Yr.value}return bt.map=Sr=>{er.properties=Sr;const Mr={};for(const jr of nr)Mr[jr]=ii[jr].evaluate(Fi,er);return Mr},bt.reduce=(Sr,Mr)=>{er.properties=Mr;for(const jr of nr)Fi.accumulated=Sr[jr],Sr[jr]=Nt[jr].evaluate(Fi,er)},bt}(ye)).load(xt.features):ye.dynamic?this._dynamicIndex:function(bt,Ut){return new Lr(bt,Ut)}(xt,ye.geojsonVtOptions)}catch(bt){return Ee(bt)}const Dt={};if(tt){const bt=y(He);bt&&(Dt.resourceTiming={},Dt.resourceTiming[ye.source]=JSON.parse(JSON.stringify(bt)))}Ee(null,Dt)}})}reloadTile(ye,Ee){const He=this.loaded;return He&&He[ye.uid]?ye.partial?Ee(null,void 0):super.reloadTile(ye,Ee):this.loadTile(ye,Ee)}loadGeoJSON(ye,Ee){if(ye.request)r.n(ye.request,Ee);else{if(typeof ye.data!="string")return Ee(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));try{return Ee(null,JSON.parse(ye.data))}catch{return Ee(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ye,Ee){try{Ee(null,this._geoJSONIndex.getClusterExpansionZoom(ye.clusterId))}catch(He){Ee(He)}}getClusterChildren(ye,Ee){try{Ee(null,this._geoJSONIndex.getChildren(ye.clusterId))}catch(He){Ee(He)}}getClusterLeaves(ye,Ee){try{Ee(null,this._geoJSONIndex.getLeaves(ye.clusterId,ye.limit,ye.offset))}catch(He){Ee(He)}}}class xs{constructor(ye,Ee,He){this.tileID=new r.aM(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ye.projection,this.brightness=Ee,this.worldview=He}parse(ye,Ee,He,tt){this.status="parsing";const Ye=new r.aM(He.tileID.overscaledZ,He.tileID.wrap,He.tileID.canonical.z,He.tileID.canonical.x,He.tileID.canonical.y),xt=[],Dt=Ee.familiesBySource[He.source],bt=new r.f0(Ye,He.promoteId);bt.bucketLayerIDs=[],bt.is3DTile=!0,r.fi(ye).then(Ut=>{if(!Ut)return tt(new Error("Could not parse tile"));const ii=Ut.json.extensionsUsed&&Ut.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ut.json.asset.extras&&Ut.json.asset.extras.MAPBOX_mesh_features,Nt=Ut.json.extensionsUsed&&Ut.json.extensionsUsed.includes("EXT_meshopt_compression"),Fi=new r.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const er in Dt)for(const nr of Dt[er]){const Sr=nr[0];bt.bucketLayerIDs.push(nr.map(nn=>r.C(nn.id,nn.scope))),Sr.recalculate(Fi,[]);const Mr=r.fj(Ut,1/r.cU(He.tileID.canonical)),jr=new r.fk(nr,Mr,Ye,ii,Nt,this.brightness,bt,this.worldview);ii||(jr.needsUpload=!0),xt.push(jr),jr.evaluate(Sr)}this.status="done",tt(null,{buckets:xt,featureIndex:bt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Ut=>tt(new Error(Ut.message)))}}class ra{constructor(ye,Ee,He,tt,Ye,xt,Dt,bt){this.actor=ye,this.layerIndex=Ee,this.availableImages=He,this.availableModels=tt,this.brightness=Dt,this.loading={},this.loaded={},this.worldview=bt}loadTile(ye,Ee){const He=ye.uid,tt=this.loading[He]=new xs(ye,this.brightness,this.worldview);r.br(ye.request,(Ye,xt)=>{const Dt=!this.loading[He];return delete this.loading[He],Dt||Ye?(tt.status="done",Dt||(this.loaded[He]=tt),Ee(Ye)):xt&&xt.byteLength!==0?void tt.parse(xt,this.layerIndex,ye,(bt,Ut)=>{tt.status="done",this.loaded=this.loaded||{},this.loaded[He]=tt,bt||!Ut?Ee(bt):Ee(null,Ut)}):(tt.status="done",this.loaded[He]=tt,Ee())})}reloadTile(ye,Ee){const He=this.loaded,tt=ye.uid;if(He&&He[tt]){const Ye=He[tt];Ye.projection=ye.projection,Ye.brightness=ye.brightness;const xt=(Dt,bt)=>{Ye.reloadCallback&&(delete Ye.reloadCallback,this.loadTile(ye,Ee)),Ee(Dt,bt)};Ye.status==="parsing"?Ye.reloadCallback=xt:Ye.status==="done"&&this.loadTile(ye,Ee)}}abortTile(ye,Ee){const He=ye.uid;this.loading[He]&&delete this.loading[He],Ee()}removeTile(ye,Ee){const He=this.loaded,tt=ye.uid;He&&He[tt]&&delete He[tt],Ee()}}class dn{constructor(ye){this.self=ye,this.actor=new r.fm(ye,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new r.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=r.ce({name:"mercator"}),this.workerSourceTypes={vector:G,geojson:Vn,"raster-dem":U,"raster-array":q,"batched-model":ra},this.workerSources={},this.self.registerWorkerSource=(Ee,He)=>{if(this.workerSourceTypes[Ee])throw new Error(`Worker source with name "${Ee}" already registered.`);this.workerSourceTypes[Ee]=He},this.self.registerRTLTextPlugin=Ee=>{if(r.fn.isParsed())throw new Error("RTL text plugin already registered.");r.fn.setState({pluginStatus:r.fo.parsed,pluginURL:r.fn.getPluginURL()}),r.fn.applyArabicShaping=Ee.applyArabicShaping,r.fn.processBidirectionalText=Ee.processBidirectionalText,r.fn.processStyledBidirectionalText=Ee.processStyledBidirectionalText;for(const He of this.rtlPluginParsingListeners)He(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(ye,Ee,He){delete this.layerIndexes[ye],delete this.availableImages[ye],delete this.availableModels[ye],delete this.workerSources[ye],He()}checkIfReady(ye,Ee,He){He()}setReferrer(ye,Ee){this.referrer=Ee}spriteLoaded(ye,Ee){this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={});const{scope:He,isLoaded:tt}=Ee;if(this.isSpriteLoaded[ye][He]=tt,this.workerSources[ye]&&this.workerSources[ye][He])for(const Ye in this.workerSources[ye][He]){const xt=this.workerSources[ye][He][Ye];for(const Dt in xt){const bt=xt[Dt];bt instanceof G&&(bt.isSpriteLoaded=tt,bt.fire(new r.A("isSpriteLoaded")))}}}setImages(ye,Ee,He){this.availableImages[ye]||(this.availableImages[ye]={});const{scope:tt,images:Ye}=Ee;if(this.availableImages[ye][tt]=Ye,this.workerSources[ye]&&this.workerSources[ye][tt]){for(const xt in this.workerSources[ye][tt]){const Dt=this.workerSources[ye][tt][xt];for(const bt in Dt)Dt[bt].availableImages=Ye}He()}else He()}setModels(ye,{scope:Ee,models:He},tt){if(this.availableModels[ye]||(this.availableModels[ye]={}),this.availableModels[ye][Ee]=He,this.workerSources[ye]&&this.workerSources[ye][Ee]){for(const Ye in this.workerSources[ye][Ee]){const xt=this.workerSources[ye][Ee][Ye];for(const Dt in xt)xt[Dt].availableModels=He}tt()}else tt()}setProjection(ye,Ee){this.projections[ye]=r.ce(Ee)}setBrightness(ye,Ee,He){this.brightness=Ee,He()}setWorldview(ye,Ee,He){this.worldview=Ee,He()}setLayers(ye,Ee,He){this.getLayerIndex(ye,Ee.scope).replace(Ee.layers,Ee.options),He()}updateLayers(ye,Ee,He){this.getLayerIndex(ye,Ee.scope).update(Ee.layers,Ee.removedIds,Ee.options),He()}loadTile(ye,Ee,He){Ee.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,Ee.type,Ee.source,Ee.scope).loadTile(Ee,He)}decodeRasterArray(ye,Ee,He){this.getWorkerSource(ye,Ee.type,Ee.source,Ee.scope).decodeRasterArray(Ee,He)}reloadTile(ye,Ee,He){Ee.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,Ee.type,Ee.source,Ee.scope).reloadTile(Ee,He)}abortTile(ye,Ee,He){this.getWorkerSource(ye,Ee.type,Ee.source,Ee.scope).abortTile(Ee,He)}removeTile(ye,Ee,He){this.getWorkerSource(ye,Ee.type,Ee.source,Ee.scope).removeTile(Ee,He)}removeSource(ye,Ee,He){if(!(this.workerSources[ye]&&this.workerSources[ye][Ee.scope]&&this.workerSources[ye][Ee.scope][Ee.type]&&this.workerSources[ye][Ee.scope][Ee.type][Ee.source]))return;const tt=this.workerSources[ye][Ee.scope][Ee.type][Ee.source];delete this.workerSources[ye][Ee.scope][Ee.type][Ee.source],tt.removeSource!==void 0?tt.removeSource(Ee,He):He()}loadWorkerSource(ye,Ee,He){try{this.self.importScripts(Ee.url),He()}catch(tt){He(tt.toString())}}syncRTLPluginState(ye,Ee,He){if(r.fn.isParsed())He(null,!0);else if(r.fn.isParsing())this.rtlPluginParsingListeners.push(He);else try{r.fn.setState(Ee);const tt=r.fn.getPluginURL();!r.fn.isLoaded()||r.fn.isParsed()||r.fn.isParsing()||tt==null||(r.fn.setState({pluginStatus:r.fo.parsing,pluginURL:r.fn.getPluginURL()}),this.self.importScripts(tt),r.fn.isParsed()?He(null,!0):this.rtlPluginParsingListeners.push(He))}catch(tt){He(tt.toString())}}setDracoUrl(ye,Ee){this.dracoUrl=Ee}getAvailableImages(ye,Ee){this.availableImages[ye]||(this.availableImages[ye]={});let He=this.availableImages[ye][Ee];return He||(He=[]),He}getAvailableModels(ye,Ee){this.availableModels[ye]||(this.availableModels[ye]={});let He=this.availableModels[ye][Ee];return He||(He={}),He}getLayerIndex(ye,Ee){this.layerIndexes[ye]||(this.layerIndexes[ye]={});let He=this.layerIndexes[ye][Ee];return He||(He=this.layerIndexes[ye][Ee]=new B,He.scope=Ee),He}getWorkerSource(ye,Ee,He,tt){const Ye=this.workerSources;return Ye[ye]||(Ye[ye]={}),Ye[ye][tt]||(Ye[ye][tt]={}),Ye[ye][tt][Ee]||(Ye[ye][tt][Ee]={}),this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={}),Ye[ye][tt][Ee][He]||(Ye[ye][tt][Ee][He]=new this.workerSourceTypes[Ee]({send:(xt,Dt,bt,Ut,ii,Nt)=>this.actor.send(xt,Dt,bt,ye,ii,Nt),scheduler:this.actor.scheduler},this.getLayerIndex(ye,tt),this.getAvailableImages(ye,tt),this.getAvailableModels(ye,tt),this.isSpriteLoaded[ye][tt],void 0,this.brightness,this.worldview)),Ye[ye][tt][Ee][He]}rasterizeImagesWorker(ye,Ee,He){const tt=new Map;for(const[Ye,{image:xt,imageVariant:Dt}]of Ee.tasks.entries()){const bt=this.imageRasterizer.rasterize(Dt,xt,Ee.scope,ye);tt.set(Ye,bt)}He(void 0,tt)}removeRasterizedImages(ye,Ee,He){this.imageRasterizer.removeImagesFromCacheByIds(Ee.imageIds,Ee.scope,ye),He()}enforceCacheSizeLimit(ye,Ee){r.fp(Ee)}getWorkerPerformanceMetrics(ye,Ee,He){He(void 0,void 0)}}return r.fl(self)&&(self.worker=new dn(self)),dn}),h(["./shared"],function(r){var y="3.13.0";const b={create:"create",load:"load",fullLoad:"fullLoad"},_={mark(p){performance.mark(p)},measure(p,n,u){performance.measure(p,n,u)}};function B(p){const n=p.name.split("?")[0];return r.a(n)&&n.includes("mapbox-gl.js")?"javascript":r.a(n)&&n.includes("mapbox-gl.css")?"css":r.b(n)?"fontRange":r.c(n)?"sprite":r.i(n)?"style":r.d(n)?"tilejson":"other"}var I,E={},R=function(){if(I)return E;function p(g){return!n(g)}function n(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,S,L=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(L);try{S=new Worker(P),w=!0}catch{w=!1}return S&&S.terminate(),URL.revokeObjectURL(P),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var S=w.getContext("2d");if(!S)return!1;var L=S.getImageData(0,0,1,1);return L&&L.width===w.width}()?(u[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(u[x]=function(w){var S,L=function(P){var V=document.createElement("canvas"),Y=Object.create(p.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=P,V.getContext("webgl2",Y)}(w);if(!L)return!1;try{S=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!S||L.isContextLost())&&(L.shaderSource(S,"void main() {}"),L.compileShader(S),L.getShaderParameter(S,L.COMPILE_STATUS)===!0)}(x)),u[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}I=1,E.supported=p,E.notSupportedReason=n;var u={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},E}();function M(p,n,u){const g=document.createElement(p);return n!=null&&(g.className=n),u&&u.appendChild(g),g}function G(p,n,u){const g=document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(n))g.setAttributeNS(null,x,String(n[x]));return u&&u.appendChild(g),g}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Q=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;function ne(){U&&Q&&(q=U[Q],U[Q]="none")}function re(){U&&Q&&(U[Q]=q)}function pe(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",pe,!0)}function Ae(){window.addEventListener("click",pe,!0),window.setTimeout(()=>{window.removeEventListener("click",pe,!0)},0)}function le(p,n){const u=p.getBoundingClientRect();return oe(p,u,n)}function be(p,n){const u=p.getBoundingClientRect(),g=[];for(let x=0;x<n.length;x++)g.push(oe(p,u,n[x]));return g}function we(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function oe(p,n,u){const g=p.offsetWidth===n.width?1:p.offsetWidth/n.width;return new r.P((u.clientX-n.left)*g,(u.clientY-n.top)*g)}const me="01",Le="NO_ACCESS_TOKEN";class Se{constructor(n,u,g){this._transformRequestFn=n,this._customAccessToken=u,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const n=function(){let u="";for(let g=0;g<10;g++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",me,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}normalizeStyleURL(n,u){if(!r.j(n))return n;const g=Re(n);return g.params.push(`sdk=js-${y}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeGlyphsURL(n,u){if(!r.j(n))return n;const g=Re(n);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeModelURL(n,u){if(!r.j(n))return n;const g=Re(n);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||u)}normalizeSourceURL(n,u,g,x){if(!r.j(n))return n;const w=Re(n);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),g&&w.params.push(`language=${g}`),x&&w.params.push(`worldview=${x}`),this._makeAPIURL(w,this._customAccessToken||u)}normalizeIconsetURL(n,u){const g=Re(n);return r.j(n)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||u)):Ze(g)}normalizeSpriteURL(n,u,g,x){const w=Re(n);return r.j(n)?(w.path=`/styles/v1${w.path}/sprite${u}${g}`,this._makeAPIURL(w,this._customAccessToken||x)):(w.path+=`${u}${g}`,Ze(w))}normalizeTileURL(n,u,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!r.j(n))return n;const x=Re(n);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||g&&x.authority!=="raster"&&g===512?"@2x":""}${r.l.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${r.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${r.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${r.e.TILE_URL_VERSION}${x.path}`);const w=this._customAccessToken||function(S){for(const L of S){const P=L.match(/^access_token=(.*)$/);if(P)return P[1]}return null}(x.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,w)}canonicalizeTileURL(n,u){const g=Re(n);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return n;let x="mapbox://";g.path.match(/^\/raster\/v1\//)?x+=`raster/${g.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${g.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${g.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let w=g.params;return u&&(w=w.filter(S=>!S.match(/^access_token=/))),w.length&&(x+=`?${w.join("&")}`),x}canonicalizeTileset(n,u){const g=!!u&&r.j(u),x=[];for(const w of n.tiles||[])r.k(w)?x.push(this.canonicalizeTileURL(w,g)):x.push(w);return x}_makeAPIURL(n,u){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=Re(r.e.API_URL);if(n.protocol=x.protocol,n.authority=x.authority,n.protocol==="http"){const w=n.params.indexOf("secure");w>=0&&n.params.splice(w,1)}if(x.path!=="/"&&(n.path=`${x.path}${n.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Ze(n);if(u=u||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return n.params=n.params.filter(w=>w.indexOf("access_token")===-1),n.params.push(`access_token=${u||""}`),Ze(n)}}const Me=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Re(p){const n=p.match(Me);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function Ze(p){const n=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${n}`}const $e="mapbox.eventData";function ct(p){if(!p)return null;const n=p.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(r.m(n[1]))}catch{return null}}class Qe{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const u=ct(r.e.ACCESS_TOKEN);let g="";return g=u&&u.u?r.f(u.u):r.e.ACCESS_TOKEN||"",n?`${$e}.${n}:${g}`:`${$e}:${g}`}fetchEventData(){const n=r.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid");if(n)try{const x=localStorage.getItem(u);x&&(this.eventData=JSON.parse(x));const w=localStorage.getItem(g);w&&(this.anonId=w)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const n=r.s("localStorage"),u=this.getStorageKey(),g=this.getStorageKey("uuid"),x=this.anonId;if(n&&x)try{localStorage.setItem(g,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,u,g,x){if(!r.e.EVENTS_URL)return;const w=Re(r.e.EVENTS_URL);w.params.push(`access_token=${x||r.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(n).toISOString()},L=u?r.h(S,u):S,P={url:Ze(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=r.p(P,V=>{this.pendingRequest=null,g(V),this.saveEventData(),this.processRequests(x)})}queueRequest(n,u){this.queue.push(n),this.processRequests(u)}}const It=new class extends Qe{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,n){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(u=>r.j(u)||r.k(u))&&this.queueRequest(Date.now(),n)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=ct(r.e.ACCESS_TOKEN),u=n?n.u:r.e.ACCESS_TOKEN;let g=u!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),g=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),S=new Date(x),L=(x-this.eventData.lastSuccess)/864e5;g=g||L>=1||L<-1||w.getDate()!==S.getDate()}else g=!0;g?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:me,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=x,this.eventData.tokenU=u)},p):this.processRequests()}},Ce=It.postTurnstileEvent.bind(It),Je=new class extends Qe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,n,u,g){this.skuToken=n,this.errorCb=g,r.e.EVENTS_URL&&(u||r.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(Le)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:me,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):n&&(this.success[n]=!0)},p))}remove(){this.errorCb=null}},lt=Je.postMapLoadEvent.bind(Je),mt=new class extends Qe{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let n=this.mapInstanceIdMap.get(p);return n||(n=r.u(),this.mapInstanceIdMap.set(p,n)),n}getEventId(p){const n=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,n+1),n}postStyleLoadEvent(p,n){const{map:u,style:g,importedStyles:x}=n;if(!r.e.EVENTS_URL||!p&&!r.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(u),S={mapInstanceId:w,eventId:this.getEventId(w),style:g};x.length&&(S.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:S},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:u}=this.queue.shift();this.postEvent(n,u,()=>{},p)}},Bt=mt.postStyleLoadEvent.bind(mt),rt=new class extends Qe{constructor(){super("gljs.performance")}postPerformanceEvent(p,n){r.e.EVENTS_URL&&(p||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:u}=this.queue.shift(),g=function(x){const w=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),L=function(te){const de={};if(te){for(const he in te)if(he!=="other")for(const ge of te[he]){const _e=`${he}ResolveRangeMin`,Te=`${he}ResolveRangeMax`,je=`${he}RequestCount`,We=`${he}RequestCachedCount`;de[_e]=Math.min(de[_e]||1/0,ge.startTime),de[Te]=Math.max(de[Te]||-1/0,ge.responseEnd);const ut=at=>{de[at]===void 0&&(de[at]=0),++de[at]};ge.transferSize!==void 0&&ge.transferSize===0&&ut(We),ut(je)}}return de}(function(te,de){const he={};if(te)for(const ge of te){const _e=de(ge);he[_e]===void 0&&(he[_e]=[]),he[_e].push(ge)}return he}(w,B)),P=window.devicePixelRatio,V=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=V?V.effectiveType:void 0,J={counters:[],metadata:[],attributes:[]},Z=(te,de,he)=>{he!=null&&te.push({name:de,value:he.toString()})};for(const te in L)Z(J.counters,te,L[te]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(Z(J.counters,"interactionRangeMin",x.interactionRange[0]),Z(J.counters,"interactionRangeMax",x.interactionRange[1])),S)for(const te of Object.keys(b)){const de=b[te],he=S.find(ge=>ge.name===de);he&&Z(J.counters,de,he.startTime)}return Z(J.counters,"visibilityHidden",x.visibilityHidden),Z(J.attributes,"style",function(te){if(te)for(const de of te){const he=de.name.split("?")[0];if(r.i(he)){const ge=he.split("/").slice(-2);if(ge.length===2)return`mapbox://styles/${ge[0]}/${ge[1]}`}}}(w)),Z(J.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),Z(J.attributes,"fogEnabled",x.fogEnabled?"true":"false"),Z(J.attributes,"projection",x.projection),Z(J.attributes,"zoom",x.zoom),Z(J.metadata,"devicePixelRatio",P),Z(J.metadata,"connectionEffectiveType",Y),Z(J.metadata,"navigatorUserAgent",navigator.userAgent),Z(J.metadata,"screenWidth",window.screen.width),Z(J.metadata,"screenHeight",window.screen.height),Z(J.metadata,"windowWidth",window.innerWidth),Z(J.metadata,"windowHeight",window.innerHeight),Z(J.metadata,"mapWidth",x.width/P),Z(J.metadata,"mapHeight",x.height/P),Z(J.metadata,"webglRenderer",x.renderer),Z(J.metadata,"webglVendor",x.vendor),Z(J.metadata,"sdkVersion",y),Z(J.metadata,"sdkIdentifier","mapbox-gl-js"),J}(u);for(const x of g.metadata);for(const x of g.counters);for(const x of g.attributes);this.postEvent(n,g,()=>{},p)}},St=rt.postPerformanceEvent.bind(rt),vt=new class extends Qe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,n,u,g){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const x=Re(r.e.API_URL+r.e.SESSION_PATH);x.params.push(`sku=${n||""}`),x.params.push(`access_token=${g||r.e.ACCESS_TOKEN||""}`);const w={url:Ze(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(w,S=>{this.pendingRequest=null,u(S),this.saveEventData(),this.processRequests(g)})}getSessionAPI(p,n,u,g){this.skuToken=n,this.errorCb=g,r.e.SESSION_PATH&&r.e.API_URL&&(u||r.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(Le)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||this.getSession(u,this.skuToken,g=>{g?this.errorCb(g):n&&(this.success[n]=!0)},p)}remove(){this.errorCb=null}},Gt=vt.getSessionAPI.bind(vt),mi=new Set;function ze(p,n){n?mi.add(p):mi.delete(p)}class Ve{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,u){this._updatedSourceCaches[n]=u,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const u=n.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(n.id),this.setDirty()}removeLayer(n){const u=n.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][n.id]=n,this._updatedLayers[u].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const u in this._updatedLayers)n[u]=n[u]||{},n[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)n[u]=n[u]||{},n[u].removedIds=Object.keys(this._removedLayers[u]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(n){return this._updatedImages[n]?Array.from(this._updatedImages[n].values()):[]}updateImage(n,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(r.I.toString(n)),this.setDirty()}resetUpdatedImages(n){this._updatedImages[n]&&this._updatedImages[n].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function kt(p){const{userImage:n}=p;return!!(n&&n.render&&n.render())&&(p.data.replace(new Uint8Array(n.data.buffer)),!0)}class Ft extends r.E{constructor(n){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=n,n!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}addScope(n){this.loaded.set(n,!1),this.imageProviders.set(n,new Map),this.images.set(n,new Map),this.updatedImages.set(n,new Set),this.callbackDispatchedThisFrame.set(n,new Set),this.patterns.set(n,new Map),this.atlasImage.set(n,new r.r({width:1,height:1}))}removeScope(n){this.loaded.delete(n),this.imageProviders.delete(n),this.images.delete(n),this.updatedImages.delete(n),this.callbackDispatchedThisFrame.delete(n),this.patterns.delete(n),this.atlasImage.delete(n);const u=this.atlasTexture.get(n);u&&(u.destroy(),this.atlasTexture.delete(n))}addImageProvider(n,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(n.id,n)}removeImageProvider(n,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(n)}getPendingImageProviders(){const n=[];for(const u of this.imageProviders.values())for(const g of u.values())g.hasPendingRequests()&&n.push(g);return n}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.y),this._imageRasterizer}isLoaded(){for(const n of this.loaded.keys())if(!this.loaded.get(n))return!1;return!0}setLoaded(n,u){if(this.loaded.get(u)!==n&&(this.loaded.set(u,n),n)){for(const{ids:g,callback:x}of this.requestors)this._notify(g,u,x);this.requestors=[]}}hasImage(n,u){return!!this.getImage(n,u)}getImage(n,u){return this.images.get(u).get(n.toString())}addImage(n,u,g){this._validate(n,g)&&this.images.get(u).set(n.toString(),g)}_validate(n,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new r.z(new Error(`Image "${n.name}" has invalid "content" value`))),g=!1),g}_validateStretch(n,u){if(!n)return!0;let g=0;for(const x of n){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(n,u){return n?n.length!==4||!u.usvg&&(n[0]<0||u.data.width<n[0]||n[1]<0||u.data.height<n[1]||n[2]<0||u.data.width<n[2]||n[3]<0||u.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,u,g){const x=this.images.get(u).get(n.toString());g.version=x.version+1,this.images.get(u).set(n.toString(),g),this.updatedImages.get(u).add(n),this.removeFromImageRasterizerCache(n,u)}clearUpdatedImages(n){this.updatedImages.get(n).clear()}removeFromImageRasterizerCache(n,u){this.spriteFormat!=="raster"&&(r.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([n],u))}removeImage(n,u){const g=this.images.get(u),x=g.get(n.toString());g.delete(n.toString()),this.patterns.get(u).delete(n.toString()),this.removeFromImageRasterizerCache(n,u),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(n){return Array.from(this.images.get(n).keys()).map(u=>r.I.from(u))}getImages(n,u,g){const x=[],w=[],S=this.imageProviders.get(u);for(const Y of n){if(!Y.iconsetId){x.push(Y);continue}const J=S.get(Y.iconsetId);J&&(this.getImage(Y,u)?w.push(Y):J.addPendingRequest(Y))}if(x.length===0)return void this._notify(w,u,g);let L=!0;const P=!!this.loaded.get(u),V=this.images.get(u);if(!P)for(const Y of x)V.has(Y.toString())||(L=!1);P||L?this._notify(x,u,g):this.requestors.push({ids:x,scope:u,callback:g})}rasterizeImages(n,u){const g=new Map,{tasks:x,scope:w}=n;for(const[S,L]of x.entries()){const P=this.getImage(L.id,w);P&&g.set(S,{image:P,imageVariant:L})}this._rasterizeImages(w,g,u)}_rasterizeImages(n,u,g){if(r.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:n},g);else{const x=new Map;for(const[w,{image:S,imageVariant:L}]of u.entries())x.set(w,this.imageRasterizer.rasterize(L,S,n,0));g(void 0,x)}}getUpdatedImages(n){return this.updatedImages.get(n)||new Set}_notify(n,u,g){const x=this.images.get(u),w=new Map;for(const S of n){if(!x.get(S.toString())){if(S.iconsetId)continue;this.fire(new r.A("styleimagemissing",{id:S.name}))}const L=x.get(S.toString());if(!L){r.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const P={data:L.usvg?null:L.data.clone(),pixelRatio:L.pixelRatio,sdf:L.sdf,usvg:L.usvg,version:L.version,stretchX:L.stretchX,stretchY:L.stretchY,content:L.content,hasRenderCallback:!!(L.userImage&&L.userImage.render)};L.usvg&&Object.assign(P,{width:L.icon.usvg_tree.width,height:L.icon.usvg_tree.height}),w.set(r.I.toString(S),P)}g(null,w)}getPixelSize(n){const{width:u,height:g}=this.atlasImage.get(n);return{width:u,height:g}}getPattern(n,u,g){const x=n.toString(),w=this.patterns.get(u),S=w.get(x),L=this.getImage(n,u);if(!L)return null;if(S){if(S.position.version===L.version)return S.position;S.position.version=L.version}else{if(L.usvg&&!L.data){const P=this.getPatternInFlightId(x,u);if(this.patternsInFlight.has(P))return null;this.patternsInFlight.add(P);const V=new r.B(n).scaleSelf(r.q.devicePixelRatio),Y=new Map([[V.toString(),{image:L,imageVariant:V}]]);return this._rasterizeImages(u,Y,(J,Z)=>this.storePatternImage(V,u,L,g,Z)),null}this.storePattern(n,u,L)}return this._updatePatternAtlas(u,g),w.get(x).position}getPatternInFlightId(n,u){return r.C(n,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(n,u,g,x,w){const S=n.toString(),L=w?w.get(S):void 0;L&&(g.data=L,this.storePattern(n.id,u,g),this._updatePatternAtlas(u,x),this.patternsInFlight.delete(this.getPatternInFlightId(n.id.toString(),u)))}storePattern(n,u,g){const x={w:g.data.width+2*r.F,h:g.data.height+2*r.F,x:0,y:0},w=new r.G(x,g,r.F);this.patterns.get(u).set(n.toString(),{bin:x,position:w})}bind(n,u){const g=n.gl;let x=this.atlasTexture.get(u);x?this.dirty&&(x.update(this.atlasImage.get(u)),this.dirty=!1):(x=new r.T(n,this.atlasImage.get(u),g.RGBA8),this.atlasTexture.set(u,x)),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(n,u){const g=this.patterns.get(n),x=Array.from(g.values()).map(({bin:V})=>V),{w,h:S}=r.H(x),L=this.atlasImage.get(n);L.resize({width:w||1,height:S||1});const P=this.images.get(n);for(const[V,{bin:Y,position:J}]of g.entries()){let Z=J.padding;const te=Y.x+Z,de=Y.y+Z,he=P.get(V).data,ge=he.width,_e=he.height;Z=Z>1?Z-1:Z,r.r.copy(he,L,{x:0,y:0},{x:te,y:de},{width:ge,height:_e},u),r.r.copy(he,L,{x:0,y:_e-Z},{x:te,y:de-Z},{width:ge,height:Z},u),r.r.copy(he,L,{x:0,y:0},{x:te,y:de+_e},{width:ge,height:Z},u),r.r.copy(he,L,{x:ge-Z,y:0},{x:te-Z,y:de},{width:Z,height:_e},u),r.r.copy(he,L,{x:0,y:0},{x:te+ge,y:de},{width:Z,height:_e},u),r.r.copy(he,L,{x:ge-Z,y:_e-Z},{x:te-Z,y:de-Z},{width:Z,height:Z},u),r.r.copy(he,L,{x:0,y:_e-Z},{x:te+ge,y:de-Z},{width:Z,height:Z},u),r.r.copy(he,L,{x:0,y:0},{x:te+ge,y:de+_e},{width:Z,height:Z},u),r.r.copy(he,L,{x:ge-Z,y:0},{x:te-Z,y:de+_e},{width:Z,height:Z},u)}this.dirty=!0}beginFrame(){for(const n of this.images.keys())this.callbackDispatchedThisFrame.set(n,new Set)}dispatchRenderCallbacks(n,u){const g=this.images.get(u);for(const x of n){if(this.callbackDispatchedThisFrame.get(u).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(x.toString());const w=g.get(x.toString());kt(w)&&this.updateImage(x,u,w)}}}function it(p){const n=p.key,u=p.value,g=p.valueSpec||{},x=p.objectElementValidators||{},w=p.style,S=p.styleSpec;let L=[];const P=r.J(u);if(P!=="object")return[new r.V(n,u,`object expected, ${P} found`)];for(const V in u){const Y=V.split(".")[0];let J;x[Y]?J=x[Y]:g[Y]?J=Ur:x["*"]?J=x["*"]:g["*"]&&(J=Ur),J?L=L.concat(J({key:(n&&`${n}.`)+V,value:u[V],valueSpec:g[Y]||g["*"],style:w,styleSpec:S,object:u,objectKey:V},u)):L.push(new r.K(n,u[V],`unknown property "${V}"`))}for(const V in g)x[V]||g[V].required&&g[V].default===void 0&&u[V]===void 0&&L.push(new r.V(n,u,`missing required property "${V}"`));return L}function yi(p){const n=p.value,u=p.valueSpec,g=p.style,x=p.styleSpec,w=p.key,S=p.arrayElementValidator||Ur;if(r.J(n)!=="array")return[new r.V(w,n,`array expected, ${r.J(n)} found`)];if(u.length&&n.length!==u.length)return[new r.V(w,n,`array length ${u.length} expected, length ${n.length} found`)];if(u["min-length"]&&n.length<u["min-length"])return[new r.V(w,n,`array length at least ${u["min-length"]} expected, length ${n.length} found`)];let L={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};x.$version<7&&(L.function=u.function),r.J(u.value)==="object"&&(L=u.value);let P=[];for(let V=0;V<n.length;V++)P=P.concat(S({array:n,arrayIndex:V,value:n[V],valueSpec:L,style:g,styleSpec:x,key:`${w}[${V}]`},!0));return P}function bi(p){const n=p.key,u=p.value,g=p.valueSpec;let x=r.J(u);if(x==="number"&&u!=u&&(x="NaN"),x!=="number")return[new r.V(n,u,`number expected, ${x} found`)];if("minimum"in g){let w=g.minimum;if(r.J(g.minimum)==="array"&&(w=g.minimum[p.arrayIndex]),u<w)return[new r.V(n,u,`${u} is less than the minimum value ${w}`)]}if("maximum"in g){let w=g.maximum;if(r.J(g.maximum)==="array"&&(w=g.maximum[p.arrayIndex]),u>w)return[new r.V(n,u,`${u} is greater than the maximum value ${w}`)]}return[]}function Kt(p){const n=p.valueSpec,u=r.M(p.value.type);let g,x,w,S={};const L=u!=="categorical"&&p.value.property===void 0,P=!L,V=r.J(p.value.stops)==="array"&&r.J(p.value.stops[0])==="array"&&r.J(p.value.stops[0][0])==="object",Y=it({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(te){if(u==="identity")return[new r.V(te.key,te.value,'identity function may not have a "stops" property')];let de=[];const he=te.value;return de=de.concat(yi({key:te.key,value:he,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:J})),r.J(he)==="array"&&he.length===0&&de.push(new r.V(te.key,he,"array must have at least one stop")),de},default:function(te){return Ur({key:te.key,value:te.value,valueSpec:n,style:te.style,styleSpec:te.styleSpec})}}});return u==="identity"&&L&&Y.push(new r.V(p.key,p.value,'missing required property "property"')),u==="identity"||p.value.stops||Y.push(new r.V(p.key,p.value,'missing required property "stops"')),u==="exponential"&&p.valueSpec.expression&&!r.N(p.valueSpec)&&Y.push(new r.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(P&&!r.O(p.valueSpec)?Y.push(new r.V(p.key,p.value,"property functions not supported")):L&&!r.Q(p.valueSpec)&&Y.push(new r.V(p.key,p.value,"zoom functions not supported"))),u!=="categorical"&&!V||p.value.property!==void 0||Y.push(new r.V(p.key,p.value,'"property" property is required')),Y;function J(te){let de=[];const he=te.value,ge=te.key;if(r.J(he)!=="array")return[new r.V(ge,he,`array expected, ${r.J(he)} found`)];if(he.length!==2)return[new r.V(ge,he,`array length 2 expected, length ${he.length} found`)];if(V){if(r.J(he[0])!=="object")return[new r.V(ge,he,`object expected, ${r.J(he[0])} found`)];if(he[0].zoom===void 0)return[new r.V(ge,he,"object stop key must have zoom")];if(he[0].value===void 0)return[new r.V(ge,he,"object stop key must have value")];const _e=r.M(he[0].zoom);if(typeof _e!="number")return[new r.V(ge,he[0].zoom,"stop zoom values must be numbers")];if(w&&w>_e)return[new r.V(ge,he[0].zoom,"stop zoom values must appear in ascending order")];_e!==w&&(w=_e,x=void 0,S={}),de=de.concat(it({key:`${ge}[0]`,value:he[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:bi,value:Z}}))}else de=de.concat(Z({key:`${ge}[0]`,value:he[0],style:te.style,styleSpec:te.styleSpec},he));return r.S(r.U(he[1]))?de.concat([new r.V(`${ge}[1]`,he[1],"expressions are not allowed in function stops.")]):de.concat(Ur({key:`${ge}[1]`,value:he[1],valueSpec:n,style:te.style,styleSpec:te.styleSpec}))}function Z(te,de){const he=r.J(te.value),ge=r.M(te.value),_e=te.value!==null?te.value:de;if(g){if(he!==g)return[new r.V(te.key,_e,`${he} stop domain type must match previous stop domain type ${g}`)]}else g=he;if(he!=="number"&&he!=="string"&&he!=="boolean"&&typeof ge!="number"&&typeof ge!="string"&&typeof ge!="boolean")return[new r.V(te.key,_e,"stop domain value must be a number, string, or boolean")];if(he!=="number"&&u!=="categorical"){let Te=`number expected, ${he} found`;return r.O(n)&&u===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(te.key,_e,Te)]}return u!=="categorical"||he!=="number"||typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge?u!=="categorical"&&he==="number"&&typeof ge=="number"&&typeof x=="number"&&x!==void 0&&ge<x?[new r.V(te.key,_e,"stop domain values must appear in ascending order")]:(x=ge,u==="categorical"&&ge in S?[new r.V(te.key,_e,"stop domain values must be unique")]:(S[ge]=!0,[])):[new r.V(te.key,_e,`integer expected, found ${String(ge)}`)]}}function di(p){const n=(p.expressionContext==="property"?r.W:r.X)(r.U(p.value),p.valueSpec);if(n.result==="error")return n.value.map(g=>new r.V(`${p.key}${g.key}`,p.value,g.message));const u=n.value.expression||n.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!u.outputDefined())return[new r.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!r.Y(u))return[new r.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return fi(u,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!r.Z(u,["zoom","feature-state"]))return[new r.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!r._(u))return[new r.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fi(p,n){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const x of n.valueSpec.expression.parameters)u.delete(x);if(u.size===0)return[];const g=[];return p instanceof r.$&&u.has(p.name)?[new r.V(n.key,n.value,`["${p.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(p.eachChild(x=>{g.push(...fi(x,n))}),g)}function Ri(p){const n=p.key,u=p.value,g=p.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(r.M(u))===-1&&x.push(new r.V(n,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(r.M(u))===-1&&x.push(new r.V(n,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),x}function Oi(p){return r.a1(r.U(p.value))?di(r.L({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Ji(p)}function Ji(p){const n=p.value,u=p.key;if(r.J(n)!=="array")return[new r.V(u,n,`array expected, ${r.J(n)} found`)];const g=p.styleSpec;let x,w=[];if(n.length<1)return[new r.V(u,n,"filter array must have at least 1 element")];switch(w=w.concat(Ri({key:`${u}[0]`,value:n[0],valueSpec:g.filter_operator,style:p.style,styleSpec:p.styleSpec})),r.M(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&r.M(n[1])==="$type"&&w.push(new r.V(u,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&w.push(new r.V(u,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(x=r.J(n[1]),x!=="string"&&w.push(new r.V(`${u}[1]`,n[1],`string expected, ${x} found`)));for(let S=2;S<n.length;S++)x=r.J(n[S]),r.M(n[1])==="$type"?w=w.concat(Ri({key:`${u}[${S}]`,value:n[S],valueSpec:g.geometry_type,style:p.style,styleSpec:p.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&w.push(new r.V(`${u}[${S}]`,n[S],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let S=1;S<n.length;S++)w=w.concat(Ji({key:`${u}[${S}]`,value:n[S],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":x=r.J(n[1]),n.length!==2?w.push(new r.V(u,n,`filter array for "${n[0]}" operator must have 2 elements`)):x!=="string"&&w.push(new r.V(`${u}[1]`,n[1],`string expected, ${x} found`))}return w}function lr(p,n){const u=p.key,g=p.style,x=p.layer,w=p.styleSpec,S=p.value,L=p.objectKey,P=w[`${n}_${p.layerType}`];if(!P)return[];const V=L.match(/^(.*)-use-theme$/);if(n==="paint"&&V&&P[V[1]])return r.S(S)?[].concat(Ur({key:p.key,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:g,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:L})):Ur({key:u,value:S,valueSpec:{type:"string"},style:g,styleSpec:w});const Y=L.match(/^(.*)-transition$/);if(n==="paint"&&Y&&P[Y[1]]&&P[Y[1]].transition)return Ur({key:u,value:S,valueSpec:w.transition,style:g,styleSpec:w});const J=p.valueSpec||P[L];if(!J)return[new r.K(u,S,`unknown property "${L}"`)];let Z;if(r.J(S)==="string"&&r.O(J)&&!J.tokens&&(Z=/^{([^}]+)}$/.exec(S))){const de=`\`{ "type": "identity", "property": ${Z?JSON.stringify(Z[1]):'"_"'} }\``;return[new r.V(u,S,`"${L}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const te=[];if(p.layerType==="symbol")L!=="text-field"||!g||g.glyphs||g.imports||te.push(new r.V(u,S,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&r.a2(r.U(S))&&r.M(S.type)==="identity"&&te.push(new r.V(u,S,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&n==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&r.O(J)&&(r.a3(J)||r.Q(J))){const de=r.W(r.U(S),J),he=de.value.expression||de.value._styleExpression.expression;he&&!r.Z(he,["measure-light"])&&(L==="model-emissive-strength"&&r._(he)&&r.Y(he)||te.push(new r.V(u,S,`${L} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return te.concat(Ur({key:p.key,value:S,valueSpec:J,style:g,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:L}))}function br(p){return lr(p,"paint")}function Dr(p){return lr(p,"layout")}function Fr(p){let n=[];const u=p.value,g=p.key,x=p.style,w=p.styleSpec;u.type||u.ref||n.push(new r.V(g,u,'either "type" or "ref" is required'));let S=r.M(u.type);const L=r.M(u.ref);if(u.id){const P=r.M(u.id);for(let V=0;V<p.arrayIndex;V++){const Y=x.layers[V];r.M(Y.id)===P&&n.push(new r.V(g,u.id,`duplicate layer id "${u.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in u){let P;["type","source","source-layer","filter","layout"].forEach(V=>{V in u&&n.push(new r.V(g,u[V],`"${V}" is prohibited for ref layers`))}),x.layers.forEach(V=>{r.M(V.id)===L&&(P=V)}),P?P.ref?n.push(new r.V(g,u.ref,"ref cannot reference another ref layer")):S=r.M(P.type):typeof L=="string"&&n.push(new r.V(g,u.ref,`ref layer "${L}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(u.source){const P=x.sources&&x.sources[u.source],V=P&&r.M(P.type);P?V==="vector"&&S==="raster"?n.push(new r.V(g,u.source,`layer "${u.id}" requires a raster source`)):V==="raster"&&S!=="raster"?n.push(new r.V(g,u.source,`layer "${u.id}" requires a vector source`)):V!=="vector"||u["source-layer"]?V==="raster-dem"&&S!=="hillshade"?n.push(new r.V(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):V!=="raster-array"||["raster","raster-particle"].includes(S)?S==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&V==="geojson"&&!P.lineMetrics?n.push(new r.V(g,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):S==="raster-particle"&&V!=="raster-array"&&n.push(new r.V(g,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):n.push(new r.V(g,u.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new r.V(g,u,`layer "${u.id}" must specify a "source-layer"`)):n.push(new r.V(g,u.source,`source "${u.source}" not found`))}else n.push(new r.V(g,u,'missing required property "source"'));return n=n.concat(it({key:g,value:u,valueSpec:w.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ur({key:`${g}.type`,value:u.type,valueSpec:w.layer.type,style:p.style,styleSpec:p.styleSpec,object:u,objectKey:"type"}),filter:P=>Oi(r.L({layerType:S},P)),layout:P=>it({layer:u,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":V=>Dr(r.L({layerType:S},V))}}),paint:P=>it({layer:u,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":V=>br(r.L({layerType:S,layer:u},V))}})}})),n}function Qr(p){const n=p.value,u=p.key,g=r.J(n);return g!=="string"?[new r.V(u,n,`string expected, ${g} found`)]:[]}const ui={promoteId:function p({key:n,value:u}){if(r.J(u)==="string")return Qr({key:n,value:u});if(Array.isArray(u)){const g=[],x=r.U(u),w=r.X(x);return w.result==="error"&&w.value.forEach(S=>{g.push(new r.V(`${n}${S.key}`,null,`${S.message}`))}),r.Z(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||g.push(new r.V(`${n}`,null,"promoteId expression should be only feature dependent")),g}{const g=[];for(const x in u)g.push(...p({key:`${n}.${x}`,value:u[x]}));return g}}};function li(p){const n=p.value,u=p.key,g=p.styleSpec,x=p.style;if(!n.type)return[new r.V(u,n,'"type" is required')];const w=r.M(n.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(n.url||n.tiles||S.push(new r.K(u,n,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(it({key:u,value:n,valueSpec:g[`source_${w.replace("-","_")}`],style:p.style,styleSpec:g,objectElementValidators:ui})),S;case"geojson":if(S=it({key:u,value:n,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:ui}),n.cluster)for(const L in n.clusterProperties){const[P,V]=n.clusterProperties[L],Y=typeof P=="string"?[P,["accumulated"],["get",L]]:P;S.push(...di({key:`${u}.${L}.map`,value:V,expressionContext:"cluster-map"})),S.push(...di({key:`${u}.${L}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return S;case"video":return it({key:u,value:n,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return it({key:u,value:n,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new r.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ri({key:`${u}.type`,value:n.type,valueSpec:{values:Vi(g)}})}}function Vi(p){return p.source.reduce((n,u)=>{const g=p[u];return g.type.type==="enum"&&(n=n.concat(Object.keys(g.type.values))),n},[])}function rr(p){const n=p.value,u=p.styleSpec,g=u.light,x=p.style;let w=[];const S=r.J(n);if(n===void 0)return w;if(S!=="object")return w=w.concat([new r.V("light",n,`object expected, ${S} found`)]),w;for(const L in n){const P=L.match(/^(.*)-transition$/),V=L.match(/^(.*)-use-theme$/);w=w.concat(V&&g[V[1]]?Ur({key:L,value:n[L],valueSpec:{type:"string"},style:x,styleSpec:u}):P&&g[P[1]]&&g[P[1]].transition?Ur({key:L,value:n[L],valueSpec:u.transition,style:x,styleSpec:u}):g[L]?Ur({key:L,value:n[L],valueSpec:g[L],style:x,styleSpec:u}):[new r.V(L,n[L],`unknown property "${L}"`)])}return w}function qr(p){const n=p.value;let u=[];if(!n)return u;const g=r.J(n);if(g!=="object")return u=u.concat([new r.V("light-3d",n,`object expected, ${g} found`)]),u;const x=p.styleSpec,w=x["light-3d"],S=p.key,L=p.style,P=p.style.lights;for(const J of["type","id"])if(!(J in n))return u=u.concat([new r.V("light-3d",n,`missing property ${J} on light`)]),u;if(n.type&&P)for(let J=0;J<p.arrayIndex;J++){const Z=r.M(n.type),te=P[J];r.M(te.type)===Z&&u.push(new r.V(S,n.id,`duplicate light type "${n.type}", previously defined at line ${te.id.__line__}`))}const V=`properties_light_${n.type}`;if(!(V in x))return u=u.concat([new r.V("light-3d",n,`Invalid light type ${n.type}`)]),u;const Y=x[V];for(const J in n)if(J==="properties"){const Z=n[J],te=r.J(Z);if(te!=="object")return u=u.concat([new r.V("properties",Z,`object expected, ${te} found`)]),u;for(const de in Z){const he=de.match(/^(.*)-transition$/),ge=de.match(/^(.*)-use-theme$/);u=u.concat(ge&&Y[ge[1]]?Ur({key:J,value:Z[de],valueSpec:{type:"string"},style:L,styleSpec:x}):he&&Y[he[1]]&&Y[he[1]].transition?Ur({key:J,value:n[J],valueSpec:x.transition,style:L,styleSpec:x}):Y[de]?Ur({key:de,value:Z[de],valueSpec:Y[de],style:L,styleSpec:x}):[new r.K(p.key,Z[de],`unknown property "${de}"`)])}}else u=u.concat(w[J]?Ur({key:J,value:n[J],valueSpec:w[J],style:L,styleSpec:x}):[new r.K(J,n[J],`unknown property "${J}"`)]);return u}function _r(p){const n=p.value,u=p.key,g=p.style,x=p.styleSpec,w=x.terrain;let S=[];const L=r.J(n);if(n===void 0||L==="null")return S;if(L!=="object")return S=S.concat([new r.V("terrain",n,`object expected, ${L} found`)]),S;for(const P in n){const V=P.match(/^(.*)-transition$/),Y=P.match(/^(.*)-use-theme$/);S=S.concat(Y&&w[Y[1]]?Ur({key:P,value:n[P],valueSpec:{type:"string"},style:g,styleSpec:x}):V&&w[V[1]]&&w[V[1]].transition?Ur({key:P,value:n[P],valueSpec:x.transition,style:g,styleSpec:x}):w[P]?Ur({key:P,value:n[P],valueSpec:w[P],style:g,styleSpec:x}):[new r.K(P,n[P],`unknown property "${P}"`)])}if(n.source){const P=g.sources&&g.sources[n.source],V=P&&r.M(P.type);P?V!=="raster-dem"&&S.push(new r.V(u,n.source,`terrain cannot be used with a source of type ${String(V)}, it only be used with a "raster-dem" source type`)):S.push(new r.V(u,n.source,`source "${n.source}" not found`))}else S.push(new r.V(u,n,'terrain is missing required property "source"'));return S}function Zr(p){const n=p.value,u=p.style,g=p.styleSpec,x=g.fog;let w=[];const S=r.J(n);if(n===void 0)return w;if(S!=="object")return w=w.concat([new r.V("fog",n,`object expected, ${S} found`)]),w;for(const L in n){const P=L.match(/^(.*)-transition$/),V=L.match(/^(.*)-use-theme$/);w=w.concat(V&&x[V[1]]?Ur({key:L,value:n[L],valueSpec:{type:"string"},style:u,styleSpec:g}):P&&x[P[1]]&&x[P[1]].transition?Ur({key:L,value:n[L],valueSpec:g.transition,style:u,styleSpec:g}):x[L]?Ur({key:L,value:n[L],valueSpec:x[L],style:u,styleSpec:g}):[new r.K(L,n[L],`unknown property "${L}"`)])}return w}const io={"*":()=>[],array:yi,boolean:function(p){const n=p.value,u=p.key,g=r.J(n);return g!=="boolean"?[new r.V(u,n,`boolean expected, ${g} found`)]:[]},number:bi,color:function(p){const n=p.key,u=p.value,g=r.J(u);return g!=="string"?[new r.V(n,u,`color expected, ${g} found`)]:r.a0.parseCSSColor(u)===null?[new r.V(n,u,`color expected, "${u}" found`)]:[]},enum:Ri,filter:Oi,function:Kt,layer:Fr,object:it,source:li,model:r.a4,light:rr,"light-3d":qr,terrain:_r,fog:Zr,string:Qr,formatted:function(p){return Qr(p).length===0?[]:di(p)},resolvedImage:function(p){return Qr(p).length===0?[]:di(p)},projection:function(p){const n=p.value,u=p.styleSpec,g=u.projection,x=p.style;let w=[];const S=r.J(n);if(S==="object")for(const L in n)w=w.concat(Ur({key:L,value:n[L],valueSpec:g[L],style:x,styleSpec:u}));else S!=="string"&&(w=w.concat([new r.V("projection",n,`object or string expected, ${S} found`)]));return w},import:function(p){const{value:n,styleSpec:u}=p,{data:g,...x}=n;Object.defineProperty(x,"__line__",{value:n.__line__,enumerable:!1});let w=it(r.L({},p,{value:x,valueSpec:u.import}));return r.M(x.id)===""&&w.push(new r.V(`${p.key}.id`,x,"import id can't be an empty string")),g&&(w=w.concat(ps(g,u,{key:`${p.key}.data`}))),w},iconset:function(p){const n=p.value,u=p.key,g=p.styleSpec,x=p.style;if(!n.type)return[new r.V(u,n,'"type" is required')];const w=r.M(n.type);let S=[];if(S=S.concat(it({key:u,value:n,valueSpec:g[`iconset_${w}`],style:x,styleSpec:g})),w==="source"&&n.source){const L=x.sources&&x.sources[n.source],P=L&&r.M(L.type);L?P!=="raster-array"&&S.push(new r.V(u,n.source,`iconset cannot be used with a source of type ${String(P)}, it only be used with a "raster-array" source type`)):S.push(new r.V(u,n.source,`source "${n.source}" not found`))}return S}};function Ur(p,n=!1){const u=p.value,g=p.valueSpec,x=p.styleSpec;if(g.expression&&r.a2(r.M(u)))return Kt(p);if(g.expression&&r.S(r.U(u)))return di(p);if(g.type&&io[g.type]){const w=io[g.type](p);return n===!0&&w.length>0&&r.J(p.value)==="array"?di(p):w}return it(r.L({},p,{valueSpec:g.type?x[g.type]:g}))}function ia(p){const n=p.value,u=p.key,g=Qr(p);return g.length||(n.indexOf("{fontstack}")===-1&&g.push(new r.V(u,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&g.push(new r.V(u,n,'"glyphs" url must include a "{range}" token'))),g}function ps(p,n=r.a5,u={}){return Ur({key:u.key||"",value:p,valueSpec:n.$root,styleSpec:n,style:p,objectElementValidators:{glyphs:ia,"*":()=>[]}})}function ro(p,n=r.a5){return tt(ps(p,n))}const Qn=p=>tt(li(p)),Lr=p=>tt(rr(p)),yr=p=>tt(qr(p)),qt=p=>tt(_r(p)),Vn=p=>tt(Zr(p)),xs=p=>tt(function(n){const u=n.value,g=n.style,x=n.styleSpec,w=x.snow;let S=[];const L=r.J(u);if(u===void 0)return S;if(L!=="object")return S=S.concat([new r.V("snow",u,`object expected, ${L} found`)]),S;for(const P in u){const V=P.match(/^(.*)-transition$/);S=S.concat(V&&w[V[1]]&&w[V[1]].transition?Ur({key:P,value:u[P],valueSpec:x.transition,style:g,styleSpec:x}):w[P]?Ur({key:P,value:u[P],valueSpec:w[P],style:g,styleSpec:x}):[new r.K(P,u[P],`unknown property "${P}"`)])}return S}(p)),ra=p=>tt(function(n){const u=n.value,g=n.style,x=n.styleSpec,w=x.rain;let S=[];const L=r.J(u);if(u===void 0)return S;if(L!=="object")return S=S.concat([new r.V("rain",u,`object expected, ${L} found`)]),S;for(const P in u){const V=P.match(/^(.*)-transition$/);S=S.concat(V&&w[V[1]]&&w[V[1]].transition?Ur({key:P,value:u[P],valueSpec:x.transition,style:g,styleSpec:x}):w[P]?Ur({key:P,value:u[P],valueSpec:w[P],style:g,styleSpec:x}):[new r.K(P,u[P],`unknown property "${P}"`)])}return S}(p)),dn=p=>tt(Fr(p)),Et=p=>tt(Oi(p)),ye=p=>tt(br(p)),Ee=p=>tt(Dr(p)),He=p=>tt(r.a4(p));function tt(p){return p.slice().sort((n,u)=>n.line&&u.line?n.line-u.line:0)}function Ye(p,n){let u=!1;if(n&&n.length)for(const g of n)g instanceof r.K?r.w(g.message):(p.fire(new r.z(new Error(g.message))),u=!0);return u}let xt;class Dt extends r.E{constructor(n,u="flat"){super(),this._transitionable=new r.a6(xt||(xt=new r.a7({anchor:new r.a8(r.a5.light.anchor),position:new r.a9(r.a5.light.position),color:new r.a8(r.a5.light.color),intensity:new r.a8(r.a5.light.intensity)}))),this.setLight(n,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u,g={}){this._validate(Lr,n,g)||(this._transitionable.setTransitionOrValue(n),this.id=u)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g){return(!g||g.validate!==!1)&&Ye(this,n.call(ro,r.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let bt=class extends r.E{constructor(p,n,u,g,x){super(),this.scope=u,this._transitionable=new r.a6(new r.a7({source:new r.a8(r.a5.terrain.source),exaggeration:new r.a8(r.a5.terrain.exaggeration)}),u,g),this._transitionable.setTransitionOrValue(p,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n,this.worldview=x}get(){return this._transitionable.serialize()}set(p,n){this._transitionable.setTransitionOrValue(p,n)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new r.aa(p,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const n=p.value.expression;if(!n)return null;let u=-1,g=-1,x=1;for(const w of n.zoomStops)x=n.evaluate(new r.aa(w,{worldview:this.worldview})),x>.01?(u=w,g=-1):g=w;return x<.01&&u>0&&g>u?[u,g]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof r.ab}};const Ut=45,ii=65,Nt=.05;function Fi(p,n,u,g){const x=r.af(Ut,ii,u),[w,S]=er(p,g);let L=1-Math.min(1,Math.exp((n-w)/(S-w)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*x*p.alpha}function er(p,n){const u=.5/Math.tan(.5*n);return[p.range[0]+u,p.range[1]+u]}function nr(p,n,u,g,x){const w=r.ad([],[n,u,g],x.mercatorFogMatrix);return Fi(p,r.ae(w),x.pitch,x._fov)}function Sr(p,n,u,g,x,w,S){const L=[[u,g,0],[x,g,0],[x,w,0],[u,w,0]];let P=Number.MAX_VALUE,V=-Number.MAX_VALUE;for(const Y of L){const J=r.ad([],Y,n),Z=r.ae(J);P=Math.min(P,Z),V=Math.max(V,Z)}return[Fi(p,P,S.pitch,S._fov),Fi(p,V,S.pitch,S._fov)]}class Mr extends r.E{constructor(n,u,g,x){super();const w=new r.a7({range:new r.a8(r.a5.fog.range),color:new r.a8(r.a5.fog.color),"color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a8(r.a5.fog["high-color"]),"high-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a8(r.a5.fog["space-color"]),"space-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a8(r.a5.fog["horizon-blend"]),"star-intensity":new r.a8(r.a5.fog["star-intensity"]),"vertical-range":new r.a8(r.a5.fog["vertical-range"])});this._transitionable=new r.a6(w,g,new Map(x)),this.set(n,x),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new r.ag(w),this.scope=g}get state(){const n=this._transform,u=n.projection.name==="globe",g=r.ah(n.zoom),x=this.properties.get("range"),w=[.5,3];return{range:u?[r.ai(w[0],x[0],g),r.ai(w[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,u,g={}){if(this._validate(Vn,n,g))return;const x=r.h({},n);for(const w of Object.keys(r.a5.fog))x[w]===void 0&&(x[w]=r.a5.fog[w].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.af(Ut,ii,n))*u.a}getOpacityAtLatLng(n,u){return this._transform.projection.supportsFog?function(g,x,w){const S=r.ac.fromLngLat(x),L=w.elevation?w.elevation.getAtPointOrZero(S):0;return nr(g,S.x,S.y,L,w)}(this.state,n,u):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Sr(this.state,u,0,0,r.aj,r.aj,this._transform)}getOpacityForBounds(n,u,g,x,w){return this._transform.projection.supportsFog?Sr(this.state,n,u,g,x,w,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?er(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const g of u){const x=n.points[g];let w;if(x[2]>=0)w=x;else{const S=n.points[g-4];w=r.ak(S,x,S[2]/(S[2]-x[2]))}if(nr(this.state,w[0],w[1],0,this._transform)>=Nt)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,g){return(!g||g.validate!==!1)&&Ye(this,n.call(ro,r.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let jr,nn,Yr,qn,gs=class extends r.E{constructor(p,n,u,g){super();const x=jr||(jr=new r.a7({density:new r.a8(r.a5.snow.density),intensity:new r.a8(r.a5.snow.intensity),color:new r.a8(r.a5.snow.color),opacity:new r.a8(r.a5.snow.opacity),vignette:new r.a8(r.a5.snow.vignette),"vignette-color":new r.a8(r.a5.snow["vignette-color"]),"center-thinning":new r.a8(r.a5.snow["center-thinning"]),direction:new r.a8(r.a5.snow.direction),"flake-size":new r.a8(r.a5.snow["flake-size"])}));this._transitionable=new r.a6(x,u,new Map(g)),this.set(p,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(x),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),g=r.al(u[0]),x=-Math.max(r.al(u[1]),.01),w=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],S=this.properties.get("vignette"),L=this.properties.get("vignette-color");return L.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(n.r,n.g,n.b,n.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:L}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(xs,p,u))return;const g=r.h({},p);for(const x of Object.keys(r.a5.snow))g[x]===void 0&&(g[x]=r.a5.snow[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Ye(this,p.call(ro,r.h({value:n,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}},ms=class extends r.E{constructor(p,n,u,g){super();const x=nn||(nn=new r.a7({density:new r.a8(r.a5.rain.density),intensity:new r.a8(r.a5.rain.intensity),color:new r.a8(r.a5.rain.color),opacity:new r.a8(r.a5.rain.opacity),vignette:new r.a8(r.a5.rain.vignette),"vignette-color":new r.a8(r.a5.rain["vignette-color"]),"center-thinning":new r.a8(r.a5.rain["center-thinning"]),direction:new r.a8(r.a5.rain.direction),"droplet-size":new r.a8(r.a5.rain["droplet-size"]),"distortion-strength":new r.a8(r.a5.rain["distortion-strength"])}));this._transitionable=new r.a6(x,u,new Map(g)),this.set(p,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(x),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),g=r.al(u[0]),x=-Math.max(r.al(u[1]),.01),w=[Math.cos(g)*Math.cos(x),Math.sin(g)*Math.cos(x),Math.sin(x)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(n.r,n.g,n.b,n.a*p),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(ra,p,u))return;const g=r.h({},p);for(const x of Object.keys(r.a5.rain))g[x]===void 0&&(g[x]=r.a5.rain[x].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Ye(this,p.call(ro,r.h({value:n,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}};class En extends r.E{constructor(n,u,g,x){super(),this.scope=g,this._options=n,this.properties=new r.ag(u),this._transitionable=new r.a6(u,g,new Map(x)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,u){this._options=n,this._transitionable.setTransitionOrValue(n.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class In{constructor(n,u,g,x){this.screenBounds=n,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(n,u){let g,x;if(n instanceof r.P||typeof n[0]=="number"){const w=r.P.convert(n);g=[w],x=u.isPointAboveHorizon(w)}else{const w=r.P.convert(n[0]),S=r.P.convert(n[1]),L=w.add(S)._div(2);g=[w,S],x=r.ao(w,S).every(P=>u.isPointAboveHorizon(P))&&u.isPointAboveHorizon(L)}return new In(g,u.getCameraPoint(),x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return r.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],x=r.ao(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),r.ap(x,n)}bufferedCameraGeometryGlobe(n){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],x=r.ao(u,g,n),w=this.cameraPoint.clone();switch(3*((w.y>u.y)+(w.y>g.y))+((w.x>u.x)+(w.x>g.x))){case 0:x[0]=w,x[4]=w.clone();break;case 1:x.splice(1,0,w);break;case 2:x[1]=w;break;case 3:x.splice(4,0,w);break;case 5:x.splice(2,0,w);break;case 6:x[3]=w;break;case 7:x.splice(3,0,w);break;case 8:x[2]=w}return x}containsTile(n,u,g,x=0){const w=n.queryPadding/u._pixelsPerMercatorPixel+1,S=g?this._bufferedCameraMercator(w,u):this._bufferedScreenMercator(w,u);let L=n.tileID.wrap+(S.unwrapped?x:0);const P=S.polygon.map(ge=>r.aq(n.tileTransform,ge,L));if(!r.ar(P,0,0,r.aj,r.aj))return;L=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const V=this.screenGeometryMercator.polygon.map(ge=>r.as(n.tileTransform,ge,L)),Y=V.map(ge=>new r.P(ge[0],ge[1])),J=u.getFreeCameraOptions().position||new r.ac(0,0,0),Z=r.as(n.tileTransform,J,L),te=V.map(ge=>{const _e=r.at(ge,ge,Z);return r.au(_e,_e),new r.av(Z,_e)}),de=r.aw(n,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:te,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(he=r.ax(P),he.min.x=r.ay(he.min.x,0,r.aj),he.min.y=r.ay(he.min.y,0,r.aj),he.max.x=r.ay(he.max.x,0,r.aj),he.max.y=r.ay(he.max.y,0,r.aj),he),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:de};var he}_bufferedScreenMercator(n,u){const g=hs(n);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),u):{polygon:this.bufferedScreenGeometry(n).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(n,u){const g=hs(n);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),u):{polygon:this.bufferedCameraGeometry(n).map(w=>u.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(n,u){const g=function(w,S){const L=r.az([],S.pixelMatrix,S.globeMatrix),P=[0,-r.aB,0,1],V=[0,r.aB,0,1],Y=[0,0,0,1];r.aA(P,P,L),r.aA(V,V,L),r.aA(Y,Y,L);const J=new r.P(P[0]/P[3],P[1]/P[3]),Z=new r.P(V[0]/V[3],V[1]/V[3]),te=r.aC(w,J)&&P[3]<Y[3],de=r.aC(w,Z)&&V[3]<Y[3];if(!te&&!de)return null;const he=function(nt,qe,ht){for(let ft=1;ft<nt.length;ft++){const Rt=bs(qe.pointCoordinate3D(nt[ft-1]).x),Ot=bs(qe.pointCoordinate3D(nt[ft]).x);if(ht<0){if(Rt<Ot)return{idx:ft,t:-Rt/(Ot-1-Rt)}}else if(Ot<Rt)return{idx:ft,t:(1-Rt)/(Ot+1-Rt)}}return null}(w,S,te?-1:1);if(!he)return null;const{idx:ge,t:_e}=he;let Te=ge>1?Ls(w.slice(0,ge),S):[],je=ge<w.length?Ls(w.slice(ge),S):[];Te=Te.map(nt=>new r.P(bs(nt.x),nt.y)),je=je.map(nt=>new r.P(bs(nt.x),nt.y));const We=[...Te];We.length===0&&We.push(je[je.length-1]);const ut=r.ai(We[We.length-1].y,(je.length===0?Te[0]:je[0]).y,_e);let at;return at=te?[new r.P(0,ut),new r.P(0,0),new r.P(1,0),new r.P(1,ut)]:[new r.P(1,ut),new r.P(1,1),new r.P(0,1),new r.P(0,ut)],We.push(...at),je.length===0?We.push(Te[0]):We.push(...je),{polygon:We.map(nt=>new r.ac(nt.x,nt.y)),unwrapped:!1}}(n,u);if(g)return g;const x=function(w,S){let L=!1,P=-1/0,V=0;for(let J=0;J<w.length-1;J++)w[J].x>P&&(P=w[J].x,V=J);for(let J=0;J<w.length-1;J++){const Z=(V+J)%(w.length-1),te=w[Z],de=w[Z+1];Math.abs(te.x-de.x)>.5&&(te.x<de.x?(te.x+=1,Z===0&&(w[w.length-1].x+=1)):(de.x+=1,Z+1===w.length-1&&(w[0].x+=1)),L=!0)}const Y=r.aD(S.center.lng);return L&&Y<Math.abs(Y-1)&&w.forEach(J=>{J.x-=1}),{polygon:w,unwrapped:L}}(Ls(n,u).map(w=>new r.P(bs(w.x),w.y)),u);return{polygon:x.polygon.map(w=>new r.ac(w.x,w.y)),unwrapped:x.unwrapped}}}function Ls(p,n){return r.aE(p,u=>{const g=n.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function bs(p){return p<0?1+p%1:p%1}function hs(p){return 100*p|0}function Uo(p,n,u,g,x){const w=function(L,P){if(L)return x(L);if(P){if(p.url&&P.tiles&&p.tiles&&delete p.tiles,P.variants){if(!Array.isArray(P.variants))return x(new Error("variants must be an array"));for(const Y of P.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return x(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){P=r.h(P,Y);break}}}const V=r.aF(r.h({},P,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);V.tiles=n.canonicalizeTileset(V,p.url),x(null,V)}},S=function(L,P,V){if(!L)return null;if(!P&&!V)return L;V=V||L.worldview_default;const Y=Object.values(L.language||{});if(Y.length===0)return null;const J=Object.values(L.worldview||{});if(J.length===0)return null;const Z=Y.every(de=>de===P),te=J.every(de=>de===V);return Z&&te?L:P in(L.language_options||{})||V in(L.worldview_options||{})?null:L.language_options&&L.worldview_options?L:null}(p.data,u,g);return S?r.q.frame(()=>w(null,S)):p.url?r.n(n.transformRequest(n.normalizeSourceURL(p.url,null,u,g),r.R.Source),w):r.q.frame(()=>{const{data:L,...P}=p;w(null,P)})}function Da(p,n){const u=Math.pow(2,n.z),g=Math.floor(r.aD(p.getWest())*u),x=Math.floor(r.aH(p.getNorth())*u),w=Math.ceil(r.aD(p.getEast())*u),S=Math.ceil(r.aH(p.getSouth())*u);return n.x>=g&&n.x<w&&n.y>=x&&n.y<S}class So{constructor(n,u,g){this.bounds=n?r.aG.convert(this.validateBounds(n)):null,this.minzoom=u||0,this.maxzoom=g||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}addExtraBounds(n){if(n){this.extraBounds||(this.extraBounds=[]);for(const u of n)this.extraBounds.push(r.aG.convert(this.validateBounds(u)))}}contains(n){if(n.z>this.maxzoom||n.z<this.minzoom||this.bounds&&!Da(this.bounds,n))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(Da(u,n))return!0;return!1}static fromTileJSON(n){if(!n.bounds&&!n.extra_bounds)return null;const u=new So(n.bounds,n.minzoom,n.maxzoom);return u.addExtraBounds(n.extra_bounds),u}}class vc extends r.E{constructor(n,u,g,x){if(super(),this.id=n,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.h(this,r.aF(u,["url","scheme","tileSize","promoteId"])),this._options=r.h({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new r.aI}load(n){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=Uo(this._options,this.map._requestManager,u,g,(x,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new r.z(x));else if(w){if(r.h(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of w.vector_layers)this.vectorLayerIds.push(S.id),w.worldview&&w.worldview[S.source]&&this.localizableLayerIds.add(S.id)}this.tileBounds=So.fromTileJSON(w),Ce(w.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}n&&n(x)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}loadTile(n,u){const g=n.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(g),w=this.map._requestManager.transformRequest(x,r.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,L=S?{image:S.image.clone()}:null,P={request:w,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:L,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&r.j(g)&&(P.localizableLayerIds=this.localizableLayerIds),P.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=u:n.request=n.actor.send("reloadTile",P,V.bind(this));else if(n.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",P,V.bind(this),void 0,!0);else{const Y=r.aJ.call({deduped:this._deduped},P,(J,Z)=>{J||!Z?V.call(this,J):(P.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},n.actor&&n.actor.send("loadTile",P,V.bind(this),void 0,!0))},!0);n.request={cancel:Y}}function V(Y,J){return delete n.request,n.aborted?u(null):Y&&Y.status!==404?u(Y):(J&&J.resourceTiming&&(n.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&n.setExpiryData(J),n.loadVectorData(J,this.map.painter),r.aK(this.dispatcher),u(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ds extends r.E{constructor(n,u,g,x){super(),this.id=n,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.h({type:"raster"},u),r.h(this,r.aF(u,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=Uo(this._options,this.map._requestManager,null,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new r.z(g)):x&&(r.h(this,x),x.raster_layers&&(this.rasterLayers=x.raster_layers,this.rasterLayerIds=this.rasterLayers.map(w=>w.id)),this.tileBounds=So.fromTileJSON(x),Ce(x.tiles),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),n&&n(g)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,u){const g=r.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);n.request=r.o(this.map._requestManager.transformRequest(x,r.R.Tile),(w,S,L,P)=>(delete n.request,n.aborted?(n.state="unloaded",u(null)):w?(n.state="errored",u(w)):S?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:L,expires:P}),n.setTexture(S,this.map.painter),n.state="loaded",r.aK(this.dispatcher),void u(null)):u(null)))}abortTile(n,u){n.request&&(n.request.cancel(),delete n.request),u&&u()}unloadTile(n,u){n.texture&&n.texture instanceof r.T?(n.destroy(!0),n.texture&&n.texture instanceof r.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class _c extends ds{constructor(n,u,g,x){super(n,u,g,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=r.h({type:"raster-array"},u)}triggerRepaint(n){const u=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);u&&u.enabled&&g&&u._clearRenderCacheForTile(g.id,n.tileID),this.map.triggerRepaint()}loadTile(n,u){const g=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,r.R.Tile),w={request:x,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};n.source=this.id,n.scope=this.scope,n.requestParams=x,n.actor||(n.actor=this.dispatcher.getActor());const S=(L,P,V,Y)=>{if(delete n.request,n.aborted)return n.state="unloaded",u(null);if(L)return L.name==="AbortError"?void 0:(n.state="errored",u(L));if(this.map._refreshExpiredTiles&&P&&n.setExpiryData({cacheControl:V,expires:Y}),this.partial)n.state="empty";else{if(!P)return u(null);n.state="loaded",n._isHeaderLoaded=!0,n._mrt=P}u(null)};n.request=this.partial?n.fetchHeader(void 0,S.bind(this)):n.actor.send("loadTile",w,S.bind(this),void 0,!0)}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){const g=n.texture;g&&g instanceof r.T?(n.destroy(!0),this.map.painter.saveTileTexture(g)):(n.destroy(),n.flushQueues(),n._isHeaderLoaded=!1,delete n._mrt,delete n.textureDescriptor),n.fbo&&(n.fbo.destroy(),delete n.fbo),delete n.request,delete n.requestParams,delete n.neighboringTiles,n.state="unloaded"}prepareTile(n,u,g){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBand(u,g,(x,w)=>{if(x)return n.state="errored",this.fire(new r.z(x)),void this.triggerRepaint(n);w&&(n._isHeaderLoaded=!0,n.setTexture(w,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:w})=>w===n),g=u&&u.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(n,u,g){if(!n)return;const x=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let w=null;u instanceof r.aN?w=u.paint.get("raster-array-band"):u instanceof r.aO&&(w=u.paint.get("raster-particle-array-band"));const S=w||this.getInitialBand(x);if(S!=null)if(n.textureDescriptor){if(!n.updateNeeded(x,S)||g)return Object.assign({},n.textureDescriptor,{texture:n.texture})}else this.prepareTile(n,x,S)}getImages(n,u){const g=new Map;for(const x of n)for(const w of u){const[S,L]=w.split("/"),P=x.getLayer(S);if(!P||!P.hasBand(L)||!P.hasDataForBand(L))continue;const{bytes:V,tileSize:Y,buffer:J}=P.getBandView(L),Z=Y+2*J,te={data:new r.r({width:Z,height:Z},V),pixelRatio:2,sdf:!1,usvg:!1,version:0};g.set(w,te)}return g}}const ch={vector:vc,raster:ds,"raster-dem":class extends ds{constructor(p,n,u,g){super(p,n,u,g),this.type="raster-dem",this.maxzoom=22,this._options=r.h({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,w){x&&(p.state="errored",n(x)),w&&(p.dem=w,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",n(null))}p.request=r.o(this.map._requestManager.transformRequest(u,r.R.Tile),(function(x,w,S,L){if(delete p.request,p.aborted)p.state="unloaded",n(null);else if(x)p.state="errored",n(x);else if(w){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:S,expires:L});const P=ImageBitmap&&w instanceof ImageBitmap&&r.t(),V=1-(w.width-r.aL(w.width))/2;V<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const Y=P?w:r.q.getImageData(w,V),J={uid:p.uid,tileID:p.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:V};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadTile",J,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const n=p.canonical,u=Math.pow(2,n.z),g=(n.x-1+u)%u,x=n.x===0?p.wrap-1:p.wrap,w=(n.x+1+u)%u,S=n.x+1===u?p.wrap+1:p.wrap,L={};return L[new r.aM(p.overscaledZ,x,n.z,g,n.y).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y).key]={backfilled:!1},n.y>0&&(L[new r.aM(p.overscaledZ,x,n.z,g,n.y-1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,p.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y-1).key]={backfilled:!1}),n.y+1<u&&(L[new r.aM(p.overscaledZ,x,n.z,g,n.y+1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,p.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},L[new r.aM(p.overscaledZ,S,n.z,w,n.y+1).key]={backfilled:!1}),L}},"raster-array":_c,geojson:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=n.data,this._options=r.h({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const x=r.aj/this.tileSize;this.workerOptions=r.h({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*x,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*x,extent:r.aj,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:r.aj,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*x,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new r.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new r.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const u of this._data.features)n.set(u.id,u);for(const u of p.features)n.set(u.id,u);this._data.features=[...n.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterChildren(p,n){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterLeaves(p,n,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:n,offset:u},g),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.A("dataloading",{dataType:"source"})),this._loaded=!1;const n=r.h({append:p},this.workerOptions);n.scope=this.scope;const u=this._data;typeof u=="string"?(n.request=this.map._requestManager.transformRequest(r.q.resolveURL(u),r.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new r.z(g));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(w.resourceTiming=x.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new r.A("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=r.C(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,n){const u=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,x=g?{image:g.image.clone()}:null,w=this._partialReload,S={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:p.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:w,worldview:this.map.getWorldview()};p.request=this.actor.send(u,S,(L,P)=>w&&!P?(p.state="loaded",n(null)):(delete p.request,p.destroy(),p.aborted?n(null):L?n(L):(p.loadVectorData(P,this.map.painter,u==="reloadTile"),n(null))),void 0,u==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,n){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aP{constructor(p,n,u,g){super(p,n,u,g),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const n of p.urls)this.urls.push(this.map._requestManager.transformRequest(n,r.R.Source).url);r.aQ(this.urls,(n,u)=>{this._loaded=!0,n?this.fire(new r.z(n)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const n=this.video.seekable;p<n.start(0)||p>n.end(0)?this.fire(new r.z(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,n=p.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(p,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aP,model:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const p=[];for(const n in this._options.models){const u=this._options.models[n],g=r.aS(this.map._requestManager.transformRequest(u.uri,r.R.Model).url).then(x=>{if(!x)return;const w=r.aT(x),S=new r.aU(n,u.position,u.orientation,w);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(x=>{this.fire(new r.z(new Error(`Could not load model ${n} from ${u.uri}: ${x.message}`)))});p.push(g)}Promise.allSettled(p).then(()=>{this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(n=>{this._loaded=!0,this.fire(new r.z(new Error(`Could not load models: ${n.message}`)))})}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,n){}serialize(){return this._options}},"batched-model":class extends r.E{constructor(p,n,u,g){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Uo(this._options,this.map._requestManager,n,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new r.z(g))):x&&(r.h(this,x),x.bounds&&(this.tileBounds=new So(x.bounds,this.minzoom,this.maxzoom)),Ce(x.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),p&&p(g)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,r.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:r.q.devicePixelRatio,promoteId:this.promoteId};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=n;else{if(p.buckets){const w=Object.values(p.buckets);for(const S of w)S.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",g,x.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(w,S){return p.aborted?n(null):w&&w.status!==404?n(w):(this.map._refreshExpiredTiles&&S&&p.setExpiryData(S),p.loadModelData(S,this.map.painter),p.state="loaded",void n(null))}}serialize(){return r.h({},this._options)}},canvas:class extends r.aP{constructor(p,n,u,g){super(p,n,u,g),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(w=>typeof w!="number"))||this.fire(new r.z(new r.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.z(new r.V(`sources.${p}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new r.z(new r.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new r.z(new r.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.z(new r.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof r.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends r.E{constructor(p,n,u,g){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=n,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new So(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),r.h(this,r.aF(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:n,y:u,z:g}=p.canonical;return this._implementation.hasTile({x:n,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,n){const{x:u,y:g,z:x}=p.tileID.canonical,w=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:x},{signal:w.signal})).then((function(S){return delete p.request,p.aborted?(p.state="unloaded",n(null)):S===void 0?(p.state="errored",n(null)):S===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",n(null)):function(L){return L instanceof ImageData||L instanceof HTMLCanvasElement||L instanceof ImageBitmap||L instanceof HTMLImageElement}(S)?(this.loadTileData(p,S),p.state="loaded",void n(null)):(p.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.name!=="AbortError"&&(p.state="errored",n(S))}),p.request.cancel=()=>w.abort()}loadTileData(p,n){p.setTexture(n,this.map.painter)}unloadTile(p,n){if(p.texture&&p.texture instanceof r.T?(p.destroy(!0),p.texture&&p.texture instanceof r.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:u,y:g,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:x})}n&&n()}abortTile(p,n){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=r.C(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}}},xc=function(p,n,u,g){const x=new ch[n.type](p,n,u,g);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return r.aV(["load","abort","unload","serialize","prepare"],x),x};function ec(p,n,u=""){return`${u}:${n.id||""}:${n.layer.id}:${function(g){if("layerId"in g)return`layer:${g.layerId}`;{const{featuresetId:x,importId:w}=g;return`featureset:${x}${w?`:import:${w}`:""}`}}(p.target)}`}function Nc(p,n,u,g=""){if(p.uniqueFeatureID){const x=ec(p,n,g);if(u.has(x))return!0;u.add(x)}return!1}function yl(p,n,u,g,x=!1){const w=n.sourceCache.transform,S=n.sourceCache.tilesIn(p,n.has3DLayers,x);S.sort(Ou);const L=[];for(const P of S){const V=P.tile.queryRenderedFeatures(n,P,u,g,w,x);Object.keys(V).length&&L.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:V})}return L.length===0?{}:function(P){const V={},Y={};for(const J of P){const Z=J.queryResults,te=J.wrappedTileID,de=Y[te]=Y[te]||{};for(const he in Z){const ge=Z[he],_e=de[he]=de[he]||{},Te=V[he]=V[he]||[];for(const je of ge)_e[je.featureIndex]||(_e[je.featureIndex]=!0,Te.push(je))}}return V}(L)}function Eo(p,n,u,g,x,w){const S={},L=g.queryRenderedSymbols(p),P=[];for(const V of Object.keys(L).map(Number))P.push(x[V]);P.sort(Ou);for(const V of P){const Y=V.featureIndex.lookupSymbolFeatures(L[V.bucketInstanceId],V.bucketIndex,V.sourceLayerIndex,n,u,w);for(const J in Y){const Z=S[J]=S[J]||[],te=Y[J];te.sort((de,he)=>{const ge=V.featureSortOrder;if(ge){const _e=ge.indexOf(de.featureIndex);return ge.indexOf(he.featureIndex)-_e}return he.featureIndex-de.featureIndex});for(const de of te)Z.push(de)}}return S}function Ta(p,n){const u=p.getRenderableIds().map(w=>p.getTileByID(w)),g=[],x={};for(let w=0;w<u.length;w++){const S=u[w],L=S.tileID.canonical.key;x[L]||(x[L]=!0,S.querySourceFeatures(g,n))}return g}function Ou(p,n){const u=p.tileID,g=n.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function vl(p,n){const u={};if(!n)return u;for(const g of p){const x=g.layerIds.map(w=>n.getLayer(w)).filter(Boolean);if(x.length!==0){g.layers=x,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(w=>x.filter(S=>S.id===w)[0]));for(const w of x)u[w.fqid]=g}}return u}const al=32,ll=33,bc=new Uint16Array(8184);for(let p=0;p<2046;p++){let n=p+2,u=0,g=0,x=0,w=0,S=0,L=0;for(1&n?x=w=S=al:u=g=L=al;(n>>=1)>1;){const V=u+x>>1,Y=g+w>>1;1&n?(x=u,w=g,u=S,g=L):(u=x,g=w,x=S,w=L),S=V,L=Y}const P=4*p;bc[P+0]=u,bc[P+1]=g,bc[P+2]=x,bc[P+3]=w}const _l=new Uint16Array(2178),wc=new Uint8Array(1089),tc=new Uint16Array(1089);function ic(p){return p===0?-.03125:p===32?.03125:0}const Uu={type:2,extent:r.aj,loadGeometry:()=>[[new r.P(0,0),new r.P(r.aj+1,0),new r.P(r.aj+1,r.aj+1),new r.P(0,r.aj+1),new r.P(0,0)]]};class hu{constructor(n,u,g,x,w,S){this.tileID=n,this.uid=r.a$(),this.uses=0,this.tileSize=u,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection),this.worldview=S}registerFadeDuration(n){const u=n+this.timeAdded;u<r.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,u,g){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=vl(n.buckets,u.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const w=this.buckets[x];if(w instanceof r.b1){if(this.hasSymbolBuckets=!0,!g)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const w=this.buckets[x];if(w instanceof r.b1&&w.hasRTLText){this.hasRTLText=!0,r.b2();break}}this.queryPadding=0;for(const x in this.buckets){const w=this.buckets[x],S=u.style.getOwnLayer(x);if(!S)continue;const L=S.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,L)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new r.b0}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,u,g){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets=Object.assign({},this.buckets,vl(n.buckets,u.style)),n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const x in this.buckets){const w=this.buckets[x];w.uploadPending()&&w.upload(n)}const u=n.gl,g=this.imageAtlas;g&&!g.uploaded&&(this.imageAtlasTexture=new r.T(n,g.image,u.RGBA8,{useMipmap:!!g.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(n,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(n,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(n,u,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,g),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=u.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(n,u,g,x,w,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const L=function(P,V){const Y=r.bn([],[.5*P.width,.5*-P.height,1]);return r.bo(Y,Y,[1,-1,0]),r.az(Y,Y,P.calculateProjMatrix(V.toUnwrapped())),Float32Array.from(Y)}(w,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:u,pixelPosMatrix:L,transform:x,availableImages:g,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(n,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),w=u?u.sourceLayer:"",S=x._geojsonTileLayer||x[w];if(!S)return;const L=r.b3(u&&u.filter),{z:P,x:V,y:Y}=this.tileID.canonical,J={z:P,x:V,y:Y};for(let Z=0;Z<S.length;Z++){const te=S.feature(Z);if(L.needGeometry){const ge=r.b4(te,!0);if(!L.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),ge,this.tileID.canonical))continue}else if(!L.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),te))continue;const de=g.getId(te,w),he=new r.b5(te,P,V,Y,de);he.tile=J,n.push(he)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const g=r.b6(n.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const w=this.expirationTime-u;w?this.expirationTime=g+Math.max(w,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}updateBuckets(n,u){if(!this.latestFeatureIndex||!n.style)return;const g=this.latestFeatureIndex.loadVTLayers(),x=n.style.listImages(),w=n.style.getBrightness();for(const S in this.buckets){if(!n.style.hasLayer(S))continue;const L=this.buckets[S],P=L.layers[0],V=P.sourceLayer||"_geojsonTileLayer",Y=g[V],J=n.style.getLayerSourceCache(P);let Z={};J&&(Z=J._state.getState(V,void 0));const te=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},de=Object.keys(Z).length>0&&!u;de&&!L.stateDependentLayers.length&&!u||L.update(Z,Y,x,te,de?L.stateDependentLayers:L.layers,u,w),(L instanceof r.b7||L instanceof r.b8)&&n._terrain&&n._terrain.enabled&&J&&L.uploadPending()&&n._terrain._clearRenderCacheForTile(J.id,this.tileID);const he=n&&n.style&&n.style.getOwnLayer(S);he&&(this.queryPadding=Math.max(this.queryPadding,he.queryRadius(L)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=r.q.now()+n}setTexture(n,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(n.width),this.texture&&this.texture instanceof r.T?this.texture.update(n):(this.texture=new r.T(g,n,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(n,u){const g={};for(const x of u)g[x]=!0;this.dependencies[n]=g}hasDependency(n,u){for(const g of n){const x=this.dependencies[g];if(x){for(const w of u)if(x[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const g=r.b9(Uu,this.tileID.canonical,this.tileTransform)[0],x=new r.ba,w=new r.bb;for(let S=0;S<g.length;S++){const{x:L,y:P}=g[S];x.emplaceBack(L,P),w.emplaceBack(S)}w.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(w),this._tileDebugBuffer=n.createVertexBuffer(x,r.bc.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,x.length,w.length)}_makeTileBoundsBuffers(n,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const g=r.b9(Uu,this.tileID.canonical,this.tileTransform)[0];let x,w;if(this.isRaster){const S=function(L,P){const V=r.aW(L,P),Y=Math.pow(2,L.z);for(let ge=0;ge<ll;ge++)for(let _e=0;_e<ll;_e++){const Te=r.aX((L.x+(_e+ic(_e))/al)/Y),je=r.aY((L.y+(ge+ic(ge))/al)/Y),We=P.project(Te,je),ut=ge*ll+_e;_l[2*ut+0]=Math.round((We.x*V.scale-V.x)*r.aj),_l[2*ut+1]=Math.round((We.y*V.scale-V.y)*r.aj)}wc.fill(0),tc.fill(0);for(let ge=2045;ge>=0;ge--){const _e=4*ge,Te=bc[_e+0],je=bc[_e+1],We=bc[_e+2],ut=bc[_e+3],at=Te+We>>1,nt=je+ut>>1,qe=at+nt-je,ht=nt+Te-at,ft=je*ll+Te,Rt=ut*ll+We,Ot=nt*ll+at,ti=Math.hypot((_l[2*ft+0]+_l[2*Rt+0])/2-_l[2*Ot+0],(_l[2*ft+1]+_l[2*Rt+1])/2-_l[2*Ot+1])>=16;wc[Ot]=wc[Ot]||(ti?1:0),ge<1022&&(wc[Ot]=wc[Ot]||wc[(je+ht>>1)*ll+(Te+qe>>1)]||wc[(ut+ht>>1)*ll+(We+qe>>1)])}const J=new r.aZ,Z=new r.a_;let te=0;function de(ge,_e){const Te=_e*ll+ge;return tc[Te]===0&&(J.emplaceBack(_l[2*Te+0],_l[2*Te+1],ge*r.aj/al,_e*r.aj/al),tc[Te]=++te),tc[Te]-1}function he(ge,_e,Te,je,We,ut){const at=ge+Te>>1,nt=_e+je>>1;if(Math.abs(ge-We)+Math.abs(_e-ut)>1&&wc[nt*ll+at])he(We,ut,ge,_e,at,nt),he(Te,je,We,ut,at,nt);else{const qe=de(ge,_e),ht=de(Te,je),ft=de(We,ut);Z.emplaceBack(qe,ht,ft)}}return he(0,0,al,al,al,0),he(al,al,0,0,0,al),{vertices:J,indices:Z}}(this.tileID.canonical,u);x=S.vertices,w=S.indices}else{x=new r.aZ,w=new r.a_;for(const{x:L,y:P}of g)x.emplaceBack(L,P,0,0);const S=r.be(x.int16.subarray(0,4*x.length),void 0,4);for(let L=0;L<S.length;L+=3)w.emplaceBack(S[L],S[L+1],S[L+2])}this._tileBoundsBuffer=n.createVertexBuffer(x,r.bf.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(w),this._tileBoundsSegments=r.bd.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugBuffers(n,u){const g=u.projection;if(!g||g.name!=="globe"||u.freezeTileCoverage)return;const x=this.tileID.canonical,w=r.bg(x,u),S=r.bh(w),L=r.ah(u.zoom);let P;L>0&&(P=r.bi(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,x,u,S,P,L),this._makeGlobeTileDebugTextBuffer(n,x,u,S,P,L)}_globePoint(n,u,g,x,w,S,L){let P=r.bj(n,u,g);if(S){const V=1<<g.z,Y=r.aD(x.center.lng),J=r.aH(x.center.lat),Z=(g.x+.5)/V-Y;let te=0;Z>.5?te=-1:Z<-.5&&(te=1);let de=(n/r.aj+g.x)/V+te,he=(u/r.aj+g.y)/V;de=(de-Y)*x._pixelsPerMercatorPixel+Y,he=(he-J)*x._pixelsPerMercatorPixel+J;const ge=[de*x.worldSize,he*x.worldSize,0];r.ad(ge,ge,S),P=r.bk(P,ge,L)}return r.ad(P,P,w)}_makeGlobeTileDebugBorderBuffer(n,u,g,x,w,S){const L=new r.ba,P=new r.bb,V=new r.bl,Y=(Z,te,de,he,ge)=>{const _e=(de-Z)/(ge-1),Te=(he-te)/(ge-1),je=L.length;for(let We=0;We<ge;We++){const ut=Z+We*_e,at=te+We*Te;L.emplaceBack(ut,at);const nt=this._globePoint(ut,at,u,g,x,w,S);V.emplaceBack(nt[0],nt[1],nt[2]),P.emplaceBack(je+We)}},J=r.aj;Y(0,0,J,0,16),Y(J,0,J,J,16),Y(J,J,0,J,16),Y(0,J,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(P),this._tileDebugBuffer=n.createVertexBuffer(L,r.bc.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(V,r.bm.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,L.length,P.length)}_makeGlobeTileDebugTextBuffer(n,u,g,x,w,S){const L=r.aj/4,P=new r.ba,V=new r.a_,Y=new r.bl,J=25;V.reserve(32),P.reserve(J),Y.reserve(J);const Z=(te,de)=>J*te+de;for(let te=0;te<J;te++){const de=te*L;for(let he=0;he<J;he++){const ge=he*L;P.emplaceBack(ge,de);const _e=this._globePoint(ge,de,u,g,x,w,S);Y.emplaceBack(_e[0],_e[1],_e[2])}}for(let te=0;te<4;te++)for(let de=0;de<4;de++){const he=Z(te,de),ge=Z(te,de+1),_e=Z(te+1,de),Te=Z(te+1,de+1);V.emplaceBack(he,ge,_e),V.emplaceBack(_e,ge,Te)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(V),this._tileDebugTextBuffer=n.createVertexBuffer(P,r.bc.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(Y,r.bm.members),this._tileDebugTextSegments=r.bd.simpleSegment(0,0,J,32)}destroy(n=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bp.setPbf(r.bq);class xl extends hu{constructor(n,u,g,x,w){super(n,u,g,x,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(n){return this._mrt&&this._mrt.getLayer(n)}setTexture(n,u){const g=u.context,x=g.gl;this.texture=this.texture||u.getTileTexture(n.width),this.texture&&this.texture instanceof r.T?this.texture.update(n,{premultiply:!1}):this.texture=new r.T(g,n,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(n=16384,u){const g=this._mrt=new r.bp(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=r.br(x,(w,S,L,P)=>{if(w)u(w);else try{const V=g.getHeaderLength(S);if(V>n)return void(this.request=this.fetchHeader(V,u));g.parseHeader(S),this._isHeaderLoaded=!0;let Y=0;for(const J of Object.values(g.layers))Y=Math.max(Y,J.dataIndex[J.dataIndex.length-1].lastByte);S.byteLength>=Y&&(this.entireBuffer=S),u(null,this.entireBuffer||S,L,P)}catch(V){u(V)}}),this.request}fetchBand(n,u,g){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void g(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void g(new Error("Can't fetch tile band without an actor"));let S;const L=(J,Z)=>{S.complete(J,Z),J?g(J):(this.updateTextureDescriptor(n,u),g(null,this.textureDescriptor&&this.textureDescriptor.img))},P=(J,Z)=>{if(J)return g(J);const te=w.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Z,task:S},L,void 0,!0);this._workQueue.push(()=>{te&&te.cancel(),S.cancel()})},V=x.getLayer(n);if(!V)return void g(new Error(`Unknown sourceLayer "${n}"`));if(V.hasDataForBand(u))return this.updateTextureDescriptor(n,u),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=V.getDataRange([u]);if(S=x.createDecodingTask(Y),!S||S.tasks.length)if(this.flushQueues(),this.entireBuffer)P(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const J=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),Z=r.br(J,P);this._fetchQueue.push(()=>{Z.cancel(),S.cancel()})}else g(null)}updateNeeded(n,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==n)&&this.state!=="errored"}updateTextureDescriptor(n,u){if(!this._mrt)return;const g=this._mrt.getLayer(n);if(!g||!g.hasBand(u)||!g.hasDataForBand(u))return;const{bytes:x,tileSize:w,buffer:S,offset:L,scale:P}=g.getBandView(u),V=w+2*S,Y=new r.r({width:V,height:V},x),J=this.texture;J&&J instanceof r.T&&J.update(Y,{premultiply:!1}),this.textureDescriptor={layer:n,band:u,img:Y,buffer:S,offset:L,tileSize:w,format:g.pixelFormat,mix:[P,256*P,65536*P,16777216*P]}}}class du{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,g){const x=n.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const w={value:u,timeout:void 0};if(g!==void 0&&(w.timeout=setTimeout(()=>{this.remove(n,w)},g)),this.data[x].push(w),this.order.push(x),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const g=n.wrapped().key,x=u===void 0?0:this.data[g].indexOf(u),w=this.data[g][x];return this.data[g].splice(x,1),w.timeout&&clearTimeout(w.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(w.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const g in this.data)for(const x of this.data[g])n(x.value)||u.push(x);for(const g of u)this.remove(g.value.tileID,g)}}class jc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,g){const x=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][x]=this.stateChanges[n][x]||{},r.h(this.stateChanges[n][x],g),this.deletedStates[n]===null){this.deletedStates[n]={};for(const w in this.state[n])w!==x&&(this.deletedStates[n][w]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][x]===null){this.deletedStates[n][x]={};for(const w in this.state[n][x])g[w]||(this.deletedStates[n][x][w]=null)}else for(const w in g)this.deletedStates[n]&&this.deletedStates[n][x]&&this.deletedStates[n][x][w]===null&&delete this.deletedStates[n][x][w]}removeFeatureState(n,u,g){if(this.deletedStates[n]===null)return;const x=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},g&&u!==void 0)this.deletedStates[n][x]!==null&&(this.deletedStates[n][x]=this.deletedStates[n][x]||{},this.deletedStates[n][x][g]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][x])for(g in this.deletedStates[n][x]={},this.stateChanges[n][x])this.deletedStates[n][x][g]=null;else this.deletedStates[n][x]=null;else this.deletedStates[n]=null}getState(n,u){const g=this.state[n]||{},x=this.stateChanges[n]||{},w=this.deletedStates[n];if(w===null)return{};if(u!==void 0){const L=String(u),P=r.h({},g[L],x[L]);if(w){const V=w[u];if(V===null)return{};for(const Y in V)delete P[Y]}return P}const S=r.h({},g,x);if(w)for(const L in w)delete S[L];return S}initializeTileState(n,u){n.refreshFeatureState(u)}coalesceChanges(n,u){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const w={};for(const S in this.stateChanges[x])this.state[x][S]||(this.state[x][S]={}),r.h(this.state[x][S],this.stateChanges[x][S]),w[S]=this.state[x][S];g[x]=w}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const w={};if(this.deletedStates[x]===null)for(const S in this.state[x])w[S]={},this.state[x][S]={};else for(const S in this.deletedStates[x]){if(this.deletedStates[x][S]===null)this.state[x][S]={};else if(this.state[x][S])for(const L of Object.keys(this.deletedStates[x][S]))delete this.state[x][S][L];w[S]=this.state[x][S]}g[x]=g[x]||{},r.h(g[x],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in n)n[x].refreshFeatureState(u)}}class ko extends r.E{constructor(n,u,g){super(),this.id=n,this._onlySymbols=g,u.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new du(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new jc,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles)if(!this._tiles[n].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,u){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,u)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(n),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Xo).map(n=>n.key)}getRenderableIds(n,u){const g=[];for(const x in this._tiles)this._isIdRenderable(+x,n,u)&&g.push(this._tiles[x]);return n?g.sort((x,w)=>{const S=x.tileID,L=w.tileID,P=new r.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),V=new r.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-L.overscaledZ||V.y-P.y||V.x-P.x}).map(x=>x.tileID.key):g.map(x=>x.tileID).sort(Xo).map(x=>x.key)}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u,g){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())&&(g||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,u){const g=this._tiles[n];g&&(g.state!=="loading"&&(g.state=u),this._loadTile(g,this._tileLoaded.bind(this,g,n,u)))}_tileLoaded(n,u,g,x){if(x)if(n.state="errored",x.status!==404)this._source.fire(new r.z(x,{tile:n}));else{if(this._source.fire(new r.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=r.q.now(),g==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new r.A("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const w=u[x];if(n.neighboringTiles&&n.neighboringTiles[w]){const S=this.getTileByID(w);g(n,S),g(S,n)}}function g(x,w){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let S=w.tileID.canonical.x-x.tileID.canonical.x;const L=w.tileID.canonical.y-x.tileID.canonical.y,P=Math.pow(2,x.tileID.canonical.z),V=w.tileID.key;S===0&&L===0||Math.abs(L)>1||(Math.abs(S)>1&&(Math.abs(S+P)===1?S+=P:Math.abs(S-P)===1&&(S-=P)),w.dem&&x.dem&&(x.dem.backfillBorder(w.dem,S,L),x.neighboringTiles&&x.neighboringTiles[V]&&(x.neighboringTiles[V].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,g,x){for(const w in this._tiles){let S=this._tiles[w];if(x[w]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>g)continue;let L=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const V=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[V.key],S&&S.hasData()&&(L=V)}let P=L;for(;P.overscaledZ>u;)if(P=P.scaledTo(P.overscaledZ-1),n[P.key]){x[L.key]=L;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const g=this._loadedParentTiles[n.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=n.overscaledZ-1;g>=u;g--){const x=n.scaledTo(g),w=this._getLoadedTile(x);if(w)return w}}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,u){u=u||this._source.tileSize;const g=Math.ceil(n.width/u)+1,x=Math.ceil(n.height/u)+1,w=Math.floor(g*x*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(L)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const g={};for(const x in this._tiles){const w=this._tiles[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+u),g[w.tileID.key]=w}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(n,u,g,x,w){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(n,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let L,P=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const Z=V.attenuationRange()[0],te=Math.floor(Z)-Math.log2(V.getDemUpscale());P>te&&(P=te)}if(this.used||this.usedForTerrain){if(this._source.tileID)L=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new r.aM(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=n.clone();Z.tileCoverLift=this.tileCoverLift,L=Z.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:P,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&n.projection.name==="globe"&&(L.push(new r.aM(1,0,1,0,0)),L.push(new r.aM(1,0,1,1,0)),L.push(new r.aM(1,0,1,0,1)),L.push(new r.aM(1,0,1,1,1)))}else if(L=n.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:P,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);L=L.filter(te=>Z(te))}}else L=[];if(L.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!uh(this._source.type)){const Z=n.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),te=Math.min(Z,this._source.maxzoom);if(S){const de=n.extendTileCover(L,te);for(const he of de)L.push(he)}else if(w){const de=n.extendTileCover(L,te,this.transform._camera.forward());for(const he of de)L.push(he)}else if(this.castsShadows&&x){const de=n.extendTileCover(L,te,x);for(const he of de)this._shadowCasterTiles[he.key]=!0,L.push(he)}}const Y=this._updateRetainedTiles(L);if(uh(this._source.type)&&L.length!==0){const Z={},te={},de=Object.keys(Y);for(const ge of de){const _e=Y[ge],Te=this._tiles[ge];if(!Te||Te.fadeEndTime&&Te.fadeEndTime<=r.q.now())continue;const je=this.findLoadedParent(_e,Math.max(_e.overscaledZ-ko.maxOverzooming,this._source.minzoom));je&&(this._addTile(je.tileID),Z[je.tileID.key]=je.tileID),te[ge]=_e}const he=L[L.length-1].overscaledZ;for(const ge in this._tiles){const _e=this._tiles[ge];if(Y[ge]||!_e.hasData())continue;let Te=_e.tileID;for(;Te.overscaledZ>he;){Te=Te.scaledTo(Te.overscaledZ-1);const je=this._tiles[Te.key];if(je&&je.hasData()&&te[Te.key]){Y[ge]=_e.tileID;break}}}for(const ge in Z)Y[ge]||(this._coveredTiles[ge]=!0,Y[ge]=Z[ge])}for(const Z in Y)this._tiles[Z].clearFadeHold();const J=r.bs(this._tiles,Y);for(const Z of J){const te=this._tiles[Z];te.hasSymbolBuckets&&!te.holdingForFade()?te.setHoldDuration(this.map._fadeDuration):te.hasSymbolBuckets&&!te.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const u={};if(n.length===0)return u;const g={},x=n.reduce((V,Y)=>Math.min(V,Y.overscaledZ),1/0),w=n[0].overscaledZ,S=Math.max(w-ko.maxOverzooming,this._source.minzoom),L=Math.max(w+ko.maxUnderzooming,this._source.minzoom),P={};for(const V of n){const Y=this._addTile(V);u[V.key]=V,Y.hasData()||x<this._source.maxzoom&&(P[V.key]=V)}this._retainLoadedChildren(P,x,L,u);for(const V of n){let Y=this._tiles[V.key];if(Y.hasData())continue;if(V.canonical.z>=this._source.maxzoom){const Z=V.children(this._source.maxzoom)[0],te=this.getTile(Z);if(te&&te.hasData()){u[Z.key]=Z;continue}}else{const Z=V.children(this._source.maxzoom);if(u[Z[0].key]&&u[Z[1].key]&&u[Z[2].key]&&u[Z[3].key])continue}let J=Y.wasRequested();for(let Z=V.overscaledZ-1;Z>=S;--Z){const te=V.scaledTo(Z);if(g[te.key]||(g[te.key]=!0,Y=this.getTile(te),!Y&&J&&(Y=this._addTile(te)),Y&&(u[te.key]=te,J=Y.wasRequested(),Y.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let g,x=this._tiles[n].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}u.push(x.key);const w=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(w),g)break;x=w}for(const w of u)this._loadedParentTiles[w]=g}}_addTile(n){let u=this._tiles[n.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const g=!!u;if(!g){const x=this.map?this.map.painter:null,w=this._source.tileSize*n.overscaleFactor();u=this._source.type==="raster-array"?new xl(n,w,this.transform.tileZoom,x,this._isRaster):new hu(n,w,this.transform.tileZoom,x,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,n.key,u.state))}return u.uses++,this._tiles[n.key]=u,g||this._source.fire(new r.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const g=u.getExpiryTimeout();g&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},g))}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,u,g){const x=[],w=this.transform;if(!w)return x;const S=w.projection.name==="globe",L=r.aD(w.center.lng);for(const P in this._tiles){const V=this._tiles[P];if(g&&V.clearQueryDebugViz(),V.holdingForFade())continue;let Y;if(S){const J=V.tileID.canonical;if(J.z===0){const Z=[Math.abs(r.ay(L,...Au(J,-1))-L),Math.abs(r.ay(L,...Au(J,1))-L)];Y=[0,2*Z.indexOf(Math.min(...Z))-1]}else{const Z=[Math.abs(r.ay(L,...Au(J,-1))-L),Math.abs(r.ay(L,...Au(J,0))-L),Math.abs(r.ay(L,...Au(J,1))-L)];Y=[Z.indexOf(Math.min(...Z))-1]}}else Y=[0];for(const J of Y){const Z=n.containsTile(V,w,u,J);Z&&x.push(Z)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,u){const g=this.getRenderableIds(n,u).map(w=>this._tiles[w].tileID),x=this.transform.projection.name==="globe";for(const w of g)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=x?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return g}sortCoordinatesByDistance(n){const u=n.slice(),g=this.transform._camera.position,x=this.transform._camera.forward(),w={};for(const S of u){const L=1/(1<<S.canonical.z);w[S.key]=((S.canonical.x+.5)*L+S.wrap-g[0])*x[0]+((S.canonical.y+.5)*L-g[1])*x[1]-g[2]*x[2]}return u.sort((S,L)=>w[S.key]-w[L.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(uh(this._source.type))for(const n in this._tiles){const u=this._tiles[n];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(n,u,g){this._state.updateState(n=n||"_geojsonTileLayer",u,g)}removeFeatureState(n,u,g){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,g)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,g){const x=this._tiles[n];x&&x.setDependencies(u,g)}reloadTilesForDependencies(n,u){for(const g in this._tiles)this._tiles[g].hasDependency(n,u)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(n,u))}_preloadTiles(n,u){if(!this._sourceLoaded){const P=()=>{this._sourceLoaded&&(this._source.off("data",P),this._preloadTiles(n,u))};return void this._source.on("data",P)}const g=new Map,x=Array.isArray(n)?n:[n],w=this.map.painter.terrain,S=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const P of x){const V=P.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of V)g.set(Y.key,Y);this.usedForTerrain&&P.updateElevation(!1)}const L=Array.from(g.values());r.bt(L,(P,V)=>{const Y=new hu(P,this._source.tileSize*P.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(Y,J=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),V(J,Y)})},u)}}function Xo(p,n){const u=Math.abs(2*p.wrap)-+(p.wrap<0),g=Math.abs(2*n.wrap)-+(n.wrap<0);return p.overscaledZ-n.overscaledZ||g-u||n.canonical.y-p.canonical.y||n.canonical.x-p.canonical.x}function uh(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Au(p,n){const u=1<<p.z;return[p.x/u+n,(p.x+1)/u+n]}ko.maxOverzooming=10,ko.maxUnderzooming=3;class Tn{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,u=!1;for(const g in this.style._mergedLayers){const x=this.style._mergedLayers[g];if(x.type==="fill-extrusion"||x.type==="building")this.layers.push({layer:x,visible:n,visibilityChanged:u});else if(x.type==="model"){const w=this.style.getLayerSource(x);w&&w.type==="batched-model"&&this.layers.push({layer:x,visible:n,visibilityChanged:u})}}}onNewFrame(n){this.layersGotHidden=!1;for(const u of this.layers){const g=u.layer;let x=!1;g.type==="fill-extrusion"?x=!g.isHidden(n)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="building"?x=!g.isHidden(n)&&g.paint.get("building-opacity")>0:g.type==="model"&&(x=!g.isHidden(n)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&u.visible,u.visible=x}}updateZOffset(n,u){this.currentBuildingBuckets=[];for(const x of this.layers){const w=x.layer,S=this.style.getLayerSourceCache(w);let L=1;w.type==="fill-extrusion"?L=x.visible?w.paint.get("fill-extrusion-vertical-scale"):0:w.type==="building"&&(L=x.visible?w.paint.get("building-vertical-scale"):0);let P=S?S.getTile(u):null;if(!P&&S&&u.canonical.z>S.getSource().minzoom){let V=u.scaledTo(Math.min(S.getSource().maxzoom,u.overscaledZ-1));for(;V.overscaledZ>=S.getSource().minzoom&&(P=S.getTile(V),!P&&V.overscaledZ!==0);)V=V.scaledTo(V.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:P?P.getBucket(w):null,tileID:P?P.tileID:u,verticalScale:L})}n.hasAnyZOffset=!1;let g=!1;for(let x=0;x<n.symbolInstances.length;x++){const w=n.symbolInstances.get(x),S=w.zOffset,L=this._getHeightAtTileOffset(u,w.tileAnchorX,w.tileAnchorY);w.zOffset=L!==Number.NEGATIVE_INFINITY?L:S,g||S===w.zOffset||(g=!0),n.hasAnyZOffset||w.zOffset===0||(n.hasAnyZOffset=!0)}g&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,u,g,x){let w=u,S=g;if(n.canonical.z!==x.canonical.z){const L=x.canonical,P=1/(1<<n.canonical.z-L.z);w=(u+n.canonical.x*r.aj)*P-L.x*r.aj|0,S=(g+n.canonical.y*r.aj)*P-L.y*r.aj|0}return{tileX:w,tileY:S}}_getHeightAtTileOffset(n,u,g){let x,w;for(let S=0;S<this.layers.length;++S){const L=this.layers[S].layer;if(L.type!=="fill-extrusion"&&L.type!=="building")continue;const{bucket:P,tileID:V,verticalScale:Y}=this.currentBuildingBuckets[S];if(!P)continue;const{tileX:J,tileY:Z}=this._mapCoordToOverlappingTile(n,u,g,V),te=P.getHeightAtTileCoord(J,Z);te&&te.height!==void 0&&(te.hidden?x=te.height:w=Math.max(te.height*Y,w||0))}if(w!==void 0)return w;for(let S=0;S<this.layers.length;++S){const L=this.layers[S];if(L.layer.type!=="model"||!L.visible)continue;const{bucket:P,tileID:V}=this.currentBuildingBuckets[S];if(!P)continue;const{tileX:Y,tileY:J}=this._mapCoordToOverlappingTile(n,u,g,V),Z=P.getHeightAtTileCoord(Y,J);if(Z&&!Z.hidden)return Z.height===void 0&&x!==void 0?Math.min(Z.maxHeight,x)*Z.verticalScale:Z.height?Z.height*Z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function iA(p,n){const u={};for(const g in p)g!=="ref"&&(u[g]=p[g]);return r.bu.forEach(g=>{g in n&&(u[g]=n[g])}),u}function hh(p){p=p.slice();const n=Object.create(null);for(let u=0;u<p.length;u++)n[p[u].id]=p[u];for(let u=0;u<p.length;u++)"ref"in p[u]&&(p[u]=iA(p[u],n[p[u].ref]));return p}const pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function dh(p,n,u){u.push({command:pn.addSource,args:[p,n[p]]})}function fu(p,n,u){n.push({command:pn.removeSource,args:[p]}),u[p]=!0}function Hc(p,n,u,g){fu(p,u,g),dh(p,n,u)}function bl(p,n,u){let g;for(g in p[u])if(p[u].hasOwnProperty(g)&&g!=="data"&&!r.bv(p[u][g],n[u][g]))return!1;for(g in n[u])if(n[u].hasOwnProperty(g)&&g!=="data"&&!r.bv(p[u][g],n[u][g]))return!1;return!0}function zu(p,n,u,g,x,w){let S;for(S in n=n||{},p=p||{})p.hasOwnProperty(S)&&(r.bv(p[S],n[S])||u.push({command:w,args:[g,S,n[S],x]}));for(S in n)n.hasOwnProperty(S)&&!p.hasOwnProperty(S)&&(r.bv(p[S],n[S])||u.push({command:w,args:[g,S,n[S],x]}))}function Qc(p){return p.id}function Bc(p,n){return p[n.id]=n,p}class Ah{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=r.ay(n,0,1);let u=1,g=this._distances[u];const x=n*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const w=u-1,S=this._distances[w],L=g-S,P=L>0?(x-S)/L:0;return this.points[w].mult(1-P).add(this.points[u].mult(P))}}class pu{constructor(n,u,g){const x=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/g),this.yCellCount=Math.ceil(u/g);for(let S=0;S<this.xCellCount*this.yCellCount;S++)x.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,g,x,w){this._forEachCell(u,g,x,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(w)}insertCircle(n,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(n,u,g,x,w,S){this.boxCells[w].push(S)}_insertCircleCell(n,u,g,x,w,S){this.circleCells[w].push(S)}_query(n,u,g,x,w,S){if(g<0||n>this.width||x<0||u>this.height)return!w&&[];const L=[];if(n<=0&&u<=0&&this.width<=g&&this.height<=x){if(w)return!0;for(let P=0;P<this.boxKeys.length;P++)L.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const V=this.circles[3*P],Y=this.circles[3*P+1],J=this.circles[3*P+2];L.push({key:this.circleKeys[P],x1:V-J,y1:Y-J,x2:V+J,y2:Y+J})}return S?L.filter(S):L}return this._forEachCell(n,u,g,x,this._queryCell,L,{hitTest:w,seenUids:{box:{},circle:{}}},S),w?L.length>0:L}_queryCircle(n,u,g,x,w){const S=n-g,L=n+g,P=u-g,V=u+g;if(L<0||S>this.width||V<0||P>this.height)return!x&&[];const Y=[];return this._forEachCell(S,P,L,V,this._queryCellCircle,Y,{hitTest:x,circle:{x:n,y:u,radius:g},seenUids:{box:{},circle:{}}},w),x?Y.length>0:Y}query(n,u,g,x,w){return this._query(n,u,g,x,!1,w)}hitTest(n,u,g,x,w){return this._query(n,u,g,x,!0,w)}hitTestCircle(n,u,g,x){return this._queryCircle(n,u,g,!0,x)}_queryCell(n,u,g,x,w,S,L,P){const V=L.seenUids,Y=this.boxCells[w];if(Y!==null){const Z=this.bboxes;for(const te of Y)if(!V.box[te]){V.box[te]=!0;const de=4*te;if(n<=Z[de+2]&&u<=Z[de+3]&&g>=Z[de+0]&&x>=Z[de+1]&&(!P||P(this.boxKeys[te]))){if(L.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[te],x1:Z[de],y1:Z[de+1],x2:Z[de+2],y2:Z[de+3]})}}}const J=this.circleCells[w];if(J!==null){const Z=this.circles;for(const te of J)if(!V.circle[te]){V.circle[te]=!0;const de=3*te;if(this._circleAndRectCollide(Z[de],Z[de+1],Z[de+2],n,u,g,x)&&(!P||P(this.circleKeys[te]))){if(L.hitTest)return S.push(!0),!0;{const he=Z[de],ge=Z[de+1],_e=Z[de+2];S.push({key:this.circleKeys[te],x1:he-_e,y1:ge-_e,x2:he+_e,y2:ge+_e})}}}}}_queryCellCircle(n,u,g,x,w,S,L,P){const V=L.circle,Y=L.seenUids,J=this.boxCells[w];if(J!==null){const te=this.bboxes;for(const de of J)if(!Y.box[de]){Y.box[de]=!0;const he=4*de;if(this._circleAndRectCollide(V.x,V.y,V.radius,te[he+0],te[he+1],te[he+2],te[he+3])&&(!P||P(this.boxKeys[de])))return S.push(!0),!0}}const Z=this.circleCells[w];if(Z!==null){const te=this.circles;for(const de of Z)if(!Y.circle[de]){Y.circle[de]=!0;const he=3*de;if(this._circlesCollide(te[he],te[he+1],te[he+2],V.x,V.y,V.radius)&&(!P||P(this.circleKeys[de])))return S.push(!0),!0}}}_forEachCell(n,u,g,x,w,S,L,P){const V=this._convertToXCellCoord(n),Y=this._convertToYCellCoord(u),J=this._convertToXCellCoord(g),Z=this._convertToYCellCoord(x);for(let te=V;te<=J;te++)for(let de=Y;de<=Z;de++)if(w.call(this,n,u,g,x,this.xCellCount*de+te,S,L,P))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,g,x,w,S){const L=x-n,P=w-u,V=g+S;return V*V>L*L+P*P}_circleAndRectCollide(n,u,g,x,w,S,L){const P=(S-x)/2,V=Math.abs(n-(x+P));if(V>P+g)return!1;const Y=(L-w)/2,J=Math.abs(u-(w+Y));if(J>Y+g)return!1;if(V<=P||J<=Y)return!0;const Z=V-P,te=J-Y;return Z*Z+te*te<=g*g}}const wl={unknown:0,flipRequired:1,flipNotRequired:2},ud=Math.tan(85*Math.PI/180);function $a(p,n,u,g,x,w,S){const L=r.bz();if(u)if(w.name==="globe"){const P=r.bA(x,n);r.az(L,L,P)}else{const P=r.bB([],S);L[0]=P[0],L[1]=P[1],L[4]=P[2],L[5]=P[3],g||r.by(L,L,x.angle)}else r.az(L,x.labelPlaneMatrix,p);return L}function gu(p,n,u,g,x,w,S){const L=$a(p,n,u,g,x,w,S);return w.name==="globe"&&u||(L[2]=L[6]=L[10]=L[14]=0),L}function mu(p,n,u,g,x,w,S){if(u){if(w.name==="globe"){const L=$a(p,n,u,g,x,w,S);return r.bi(L,L),r.az(L,p,L),L}{const L=r.bw(p),P=r.bx([]);return P[0]=S[0],P[1]=S[1],P[4]=S[2],P[5]=S[3],r.az(L,L,P),g||r.by(L,L,-x.angle),L}}return x.glCoordMatrix}function Bl(p,n,u,g){const x=[p,n,u,1];u?r.aA(x,x,g):jn(x,x,g);const w=x[3];return x[0]/=w,x[1]/=w,x[2]/=w,x}function zo(p,n){return Math.min(.5+p/n*.5,1.5)}function Vc(p,n){const u=p[0]/p[3],g=p[1]/p[3];return u>=-n[0]&&u<=n[0]&&g>=-n[1]&&g<=n[1]}function rc(p,n,u,g,x,w,S,L,P,V){const Y=u.transform,J=g?p.textSizeData:p.iconSizeData,Z=r.bH(J,u.transform.zoom),te=Y.projection.name==="globe",de=[256/u.width*2+1,256/u.height*2+1],he=g?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;he.clear();let ge=null;te&&(ge=g?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const _e=p.lineVertexArray,Te=g?p.text.placedSymbolArray:p.icon.placedSymbolArray,je=u.transform.width/u.transform.height;let We,ut=!1;for(let at=0;at<Te.length;at++){const nt=Te.get(at),{numGlyphs:qe,writingMode:ht}=nt;if(ht!==r.bI.vertical||ut||We===r.bI.horizontal||(ut=!0),We=ht,(nt.hidden||ht===r.bI.vertical)&&!ut){Cl(qe,he);continue}ut=!1;const ft=new r.P(nt.tileAnchorX,nt.tileAnchorY);let{x:Rt,y:Ot,z:ti}=Y.projection.projectTilePoint(ft.x,ft.y,V.canonical);if(P){const[ir,tr,Ki]=P(ft);Rt+=ir,Ot+=tr,ti+=Ki}const ri=[Rt,Ot,ti,1];if(r.aA(ri,ri,n),!Vc(ri,de)){Cl(qe,he);continue}const vi=ri[3],Pt=zo(u.transform.getCameraToCenterDistance(Y.projection),vi),Qt=r.bJ(J,Z,nt),Ct=S?Qt/Pt:Qt*Pt,oi=Bl(Rt,Ot,ti,x);if(oi[3]<=0){Cl(qe,he);continue}let zt={};const gi=r.al(p.layers[0].layout.get("text-max-angle")),Li=Math.cos(gi),ai=S?null:P,Mi=yu(nt,Ct,!1,L,n,x,w,p.glyphOffsetArray,_e,he,ge,oi,ft,zt,je,ai,Y.projection,V,S,Li);ut=Mi.useVertical,ai&&Mi.needsFlipping&&(zt={}),(Mi.notEnoughRoom||ut||Mi.needsFlipping&&yu(nt,Ct,!0,L,n,x,w,p.glyphOffsetArray,_e,he,ge,oi,ft,zt,je,ai,Y.projection,V,S,Li).notEnoughRoom)&&Cl(qe,he)}g?(p.text.dynamicLayoutVertexBuffer.updateData(he),ge&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(ge)):(p.icon.dynamicLayoutVertexBuffer.updateData(he),ge&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(ge))}function nc(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge){const{lineStartIndex:_e,glyphStartIndex:Te,segment:je}=L,We=Te+L.numGlyphs,ut=_e+L.lineLength,at=n.getoffsetX(Te),nt=n.getoffsetX(We-1),qe=Ol(p*at,u,g,x,w,S,je,_e,ut,P,V,Y,J,Z,!0,te,de,he,ge);if(!qe)return null;const ht=Ol(p*nt,u,g,x,w,S,je,_e,ut,P,V,Y,J,Z,!0,te,de,he,ge);return ht?{first:qe,last:ht}:null}function sc(p,n,u,g){return p===r.bI.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:p===r.bI.vertical?g>0?{needsFlipping:!0}:null:n!==wl.unknown&&function(x,w){return x===0||Math.abs(w/x)>ud}(u,g)?n===wl.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function yu(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te,je){const We=n/24,ut=p.lineOffsetX*We,at=p.lineOffsetY*We,{lineStartIndex:nt,glyphStartIndex:qe,numGlyphs:ht,segment:ft,writingMode:Rt,flipState:Ot}=p,ti=nt+p.lineLength,ri=vi=>{if(Y){const[oi,zt,gi]=vi.up,Li=V.length;r.bK(Y,Li+0,oi,zt,gi),r.bK(Y,Li+1,oi,zt,gi),r.bK(Y,Li+2,oi,zt,gi),r.bK(Y,Li+3,oi,zt,gi)}const[Pt,Qt,Ct]=vi.point;r.bL(V,Pt,Qt,Ct,vi.angle)};if(ht>1){const vi=nc(We,L,ut,at,u,J,Z,p,P,w,te,he,!1,ge,_e,Te,je);if(!vi)return{notEnoughRoom:!0};if(g&&!u){let[Pt,Qt,Ct]=vi.first.point,[oi,zt,gi]=vi.last.point;[Pt,Qt]=Bl(Pt,Qt,Ct,S),[oi,zt]=Bl(oi,zt,gi,S);const Li=sc(Rt,Ot,(oi-Pt)*de,zt-Qt);if(p.flipState=Li&&Li.needsFlipping?wl.flipRequired:wl.flipNotRequired,Li)return Li}ri(vi.first);for(let Pt=qe+1;Pt<qe+ht-1;Pt++){const Qt=Ol(We*L.getoffsetX(Pt),ut,at,u,J,Z,ft,nt,ti,P,w,te,he,!1,!1,ge,_e,Te,je);if(!Qt)return V.length-=4*(Pt-qe),{notEnoughRoom:!0};ri(Qt)}ri(vi.last)}else{if(g&&!u){const Pt=Bl(Z.x,Z.y,0,x),Qt=nt+ft+1,Ct=new r.P(P.getx(Qt),P.gety(Qt)),oi=Bl(Ct.x,Ct.y,0,x),zt=oi[3]>0?oi:Za(Z,Ct,Pt,1,x,void 0,ge,_e.canonical),gi=sc(Rt,Ot,(zt[0]-Pt[0])*de,zt[1]-Pt[1]);if(p.flipState=gi&&gi.needsFlipping?wl.flipRequired:wl.flipNotRequired,gi)return gi}const vi=Ol(We*L.getoffsetX(qe),ut,at,u,J,Z,ft,nt,ti,P,w,te,he,!1,!1,ge,_e,Te,je);if(!vi)return{notEnoughRoom:!0};ri(vi)}return{}}function na(p,n,u,g,x){const{x:w,y:S,z:L}=g.projectTilePoint(p.x,p.y,n);if(!x)return Bl(w,S,L,u);const[P,V,Y]=x(p);return Bl(w+P,S+V,L+Y,u)}function Za(p,n,u,g,x,w,S,L){const P=na(p.sub(n)._unit()._add(p),L,x,S,w);return r.at(P,u,P),r.au(P,P),r.bE(P,u,P,g)}function Ol(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te){const je=g?p-n:p+n;let We=je>0?1:-1,ut=0;g&&(We*=-1,ut=Math.PI),We<0&&(ut+=Math.PI);let at=L+S+(We>0?0:1)|0,nt=x,qe=x,ht=0,ft=0;const Rt=Math.abs(je),Ot=[],ti=[];let ri=w,vi=ri,Pt=r.bC([]);const Qt=()=>Za(vi,ri,qe,Rt-ht+1,Y,Z,he,ge.canonical);for(;ht+ft<=Rt;){if(at+=We,at<L||at>=P)return null;if(qe=nt,vi=ri,Ot.push(qe),te&&ti.push(vi),ri=new r.P(V.getx(at),V.gety(at)),nt=J[at],!nt){const Ki=na(ri,ge.canonical,Y,he,Z);nt=Ki[3]>0?J[at]=Ki:Qt()}ht+=ft;const ir=r.at([],nt,qe),tr=r.bD(qe,nt);if(u&&tr>0&&ft>0&&r.bG(Pt,ir)/(ft*tr)<Te)return null;ft=tr,Pt=ir}de&&Z&&(J[at]&&(nt=Qt(),ft=r.bD(qe,nt),Pt=r.at([],nt,qe)),J[at]=nt);const Ct=(Rt-ht)/ft,oi=ri.sub(vi)._mult(Ct)._add(vi),zt=r.bE([],qe,Pt,Ct);let gi=[0,0,1],Li=Pt[0],ai=Pt[1];if(_e&&(gi=he.upVector(ge.canonical,oi.x,oi.y),gi[0]!==0||gi[1]!==0||gi[2]!==1)){const ir=[gi[2],0,-gi[0]],tr=r.bF([],gi,ir);r.au(ir,ir),r.au(tr,tr),Li=r.bG(Pt,ir),ai=r.bG(Pt,tr)}if(u){const ir=r.bF([],gi,Pt);r.au(ir,ir),r.bE(zt,zt,ir,u*We)}const Mi=ut+Math.atan2(ai,Li);return Ot.push(zt),te&&ti.push(oi),{point:zt,angle:Mi,path:Ot,tilePath:ti,up:gi}}function Cl(p,n){const u=n.length,g=u+4*p;n.resize(g),n.float32.fill(-1/0,4*u,4*g)}function jn(p,n,u){const g=n[0],x=n[1];return p[0]=u[0]*g+u[4]*x+u[12],p[1]=u[1]*g+u[5]*x+u[13],p[3]=u[3]*g+u[7]*x+u[15],p}const No=100;class Hh{constructor(n,u,g=new pu(n.width+200,n.height+200,25),x=new pu(n.width+200,n.height+200,25)){this.transform=n,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+No,this.screenBottomBoundary=n.height+No,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=u}placeCollisionBox(n,u,g,x,w,S,L,P){let V=g.projectedAnchorX,Y=g.projectedAnchorY,J=g.projectedAnchorZ;const Z=g.elevation,te=g.tileID,de=n.getProjection();if(Z&&te){const[at,nt,qe]=de.upVector(te.canonical,g.tileAnchorX,g.tileAnchorY),ht=de.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;V+=at*Z*ht,Y+=nt*Z*ht,J+=qe*Z*ht}const he=this.projectAndGetPerspectiveRatio(L,V,Y,J,g.tileID,de.name==="globe"||!!Z||this.transform.pitch>0,de),ge=S*he.perspectiveRatio,_e=(g.x1*u+x.x-g.padding)*ge+he.point.x,Te=(g.y1*u+x.y-g.padding)*ge+he.point.y,je=(g.x2*u+x.x+g.padding)*ge+he.point.x,We=(g.y2*u+x.y+g.padding)*ge+he.point.y,ut=he.perspectiveRatio<=.55||he.occluded;return!this.isInsideGrid(_e,Te,je,We)||!w&&this.grid.hitTest(_e,Te,je,We,P)||ut?{box:[],offscreen:!1,occluded:he.occluded}:{box:[_e,Te,je,We],offscreen:this.isOffscreen(_e,Te,je,We),occluded:!1}}placeCollisionCircles(n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he){const ge=[],_e=this.transform.elevation,Te=n.getProjection(),je=_e?_e.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,Te):null,We=new r.P(g.tileAnchorX,g.tileAnchorY);let{x:ut,y:at,z:nt}=Te.projectTilePoint(We.x,We.y,he.canonical);if(je){const[gi,Li,ai]=je(We);ut+=gi,at+=Li,nt+=ai}const qe=Te.name==="globe",ht=this.projectAndGetPerspectiveRatio(L,ut,at,nt,he,qe||!!_e||this.transform.pitch>0,Te),{perspectiveRatio:ft}=ht,Rt=(J?S/ft:S*ft)/r.bO,Ot=Bl(ut,at,nt,P),ti=g.lineOffsetX*Rt,ri=g.lineOffsetY*Rt,vi=r.al(n.layers[0].layout.get("text-max-angle")),Pt=Math.cos(vi),Qt=ht.signedDistanceFromCamera>0?nc(Rt,w,ti,ri,!1,Ot,We,g,x,P,{},_e&&!J?je:null,J&&!!_e,Te,he,J,Pt):null;let Ct=!1,oi=!1,zt=!0;if(Qt&&!ht.occluded){const gi=.5*te*ft+de,Li=new r.P(-100,-100),ai=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Mi=new Ah,{first:ir,last:tr}=Qt,Ki=ir.path.length;let pr=[];for(let Hr=Ki-1;Hr>=1;Hr--)pr.push(ir.path[Hr]);for(let Hr=1;Hr<tr.path.length;Hr++)pr.push(tr.path[Hr]);const gr=2.5*gi;V&&(pr=pr.map(([Hr,sn,Zn],ws)=>(je&&!qe&&(Zn=je(ws<Ki-1?ir.tilePath[Ki-1-ws]:tr.tilePath[ws-Ki+2])[2]),Bl(Hr,sn,Zn,V))),pr.some(Hr=>Hr[3]<=0)&&(pr=[]));let Cr=[];if(pr.length>0){let Hr=1/0,sn=-1/0,Zn=1/0,ws=-1/0;for(const rs of pr)Hr=Math.min(Hr,rs[0]),Zn=Math.min(Zn,rs[1]),sn=Math.max(sn,rs[0]),ws=Math.max(ws,rs[1]);sn>=Li.x&&Hr<=ai.x&&ws>=Li.y&&Zn<=ai.y&&(Cr=[pr.map(rs=>new r.P(rs[0],rs[1]))],(Hr<Li.x||sn>ai.x||Zn<Li.y||ws>ai.y)&&(Cr=r.bM(Cr,Li.x,Li.y,ai.x,ai.y)))}for(const Hr of Cr){Mi.reset(Hr,.25*gi);let sn=0;sn=Mi.length<=.5*gi?1:Math.ceil(Mi.paddedLength/gr)+1;for(let Zn=0;Zn<sn;Zn++){const ws=Zn/Math.max(sn-1,1),rs=Mi.lerp(ws),ss=rs.x+No,ho=rs.y+No;ge.push(ss,ho,gi,0);const Jr=ss-gi,ln=ho-gi,vn=ss+gi,Rs=ho+gi;if(zt=zt&&this.isOffscreen(Jr,ln,vn,Rs),oi=oi||this.isInsideGrid(Jr,ln,vn,Rs),!u&&this.grid.hitTestCircle(ss,ho,gi,Z)&&(Ct=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:Ct,occluded:!1}}}}return{circles:!Y&&Ct||!oi?[]:ge,offscreen:zt,collisionDetected:Ct,occluded:ht.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,x=1/0,w=-1/0,S=-1/0;for(const Y of n){const J=new r.P(Y.x+No,Y.y+No);g=Math.min(g,J.x),x=Math.min(x,J.y),w=Math.max(w,J.x),S=Math.max(S,J.y),u.push(J)}const L=this.grid.query(g,x,w,S).concat(this.ignoredGrid.query(g,x,w,S)),P={},V={};for(const Y of L){const J=Y.key;if(P[J.bucketInstanceId]===void 0&&(P[J.bucketInstanceId]={}),P[J.bucketInstanceId][J.featureIndex])continue;const Z=[new r.P(Y.x1,Y.y1),new r.P(Y.x2,Y.y1),new r.P(Y.x2,Y.y2),new r.P(Y.x1,Y.y2)];r.bN(u,Z)&&(P[J.bucketInstanceId][J.featureIndex]=!0,V[J.bucketInstanceId]===void 0&&(V[J.bucketInstanceId]=[]),V[J.bucketInstanceId].push(J.featureIndex))}return V}insertCollisionBox(n,u,g,x,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:w},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,g,x,w){const S=u?this.ignoredGrid:this.grid,L={bucketInstanceId:g,featureIndex:x,collisionGroupID:w};for(let P=0;P<n.length;P+=4)S.insertCircle(L,n[P],n[P+1],n[P+2])}projectAndGetPerspectiveRatio(n,u,g,x,w,S,L){const P=[u,g,x,1];let V=!1;x||this.transform.pitch>0?(r.aA(P,P,n),this.fogState&&w&&L.name!=="globe"&&(V=function(Z,te,de,he,ge,_e){const Te=_e.calculateFogTileMatrix(ge),je=[te,de,he];return r.ad(je,je,Te),Fi(Z,r.ae(je),_e.pitch,_e._fov)}(this.fogState,u,g,x,w.toUnwrapped(),this.transform)>.9)):jn(P,P,n);const Y=P[3];return{point:new r.P((P[0]/Y+1)/2*this.transform.width+No,(-P[1]/Y+1)/2*this.transform.height+No),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:S&&P[2]>Y||V}}isOffscreen(n,u,g,x){return g<No||n>=this.screenRightBoundary||x<No||u>this.screenBottomBoundary}isInsideGrid(n,u,g,x){return g>=0&&n<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=r.bx([]);return r.bo(n,n,[-100,-100,0]),n}}function vu(p,n,u){const g=n.createTileMatrix(p,p.worldSize,u.toUnwrapped());return r.az(new Float32Array(16),p.projMatrix,g)}function Er(p,n,u){if(n.projection.name===u.projection.name)return p.projMatrix;const g=u.clone();return g.setProjection(n.projection),vu(g,n.getProjection(),p)}function fh(p,n,u){return n.name===u.projection.name?p.projMatrix:vu(u,n,p)}class Gc{constructor(n,u,g,x){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Cc{constructor(n,u,g,x,w,S=!1){this.text=new Gc(n?n.text:null,u,g,w),this.icon=new Gc(n?n.icon:null,u,x,w),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Oa{constructor(n,u,g,x=!1){this.text=n,this.icon=u,this.skipFade=g,this.clipped=x}}class Qh{constructor(){this.invProjMatrix=r.bz(),this.viewportMatrix=r.bz(),this.circles=[]}}class Nu{constructor(n,u,g,x,w){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=w}}class dr{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[n]}}function kn(p,n,u,g,x){const{horizontalAlign:w,verticalAlign:S}=r.bT(p),L=-(w-.5)*n,P=-(S-.5)*u,V=r.bU(p,g);return new r.P(L+V[0]*x,P+V[1]*x)}function Fn(p,n,u,g,x){const w=new r.P(p,n);return u&&w._rotate(g?x:-x),w}class sa{constructor(n,u,g,x,w,S){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new Hh(this.transform,w),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new dr(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,u,g,x,w=1){const S=g.getBucket(u),L=g.latestFeatureIndex;if(!S||!L||u.fqid!==S.layerIds[0])return;const P=S.layers[0].layout,V=S.layers[0].paint,Y=g.collisionBoxArray,J=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),Z=g.tileSize/r.aj,te=g.tileID.toUnwrapped();this.transform.setProjection(S.projection);const de=(he=g.tileID,ge=S.getProjection(),_e=this.transform,ge.name===this.projection?_e.calculateProjMatrix(he.toUnwrapped()):vu(_e,ge,he));var he,ge,_e;const Te=P.get("text-pitch-alignment")==="map",je=P.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const We=u.dynamicFilter(),ut=u.dynamicFilterNeedsFeature(),at=this.transform.calculatePixelsToTileUnitsMatrix(g),nt=gu(de,g.tileID.canonical,Te,je,this.transform,S.getProjection(),at);let qe=null;if(Te){const Qt=mu(de,g.tileID.canonical,Te,je,this.transform,S.getProjection(),at);qe=r.az([],this.transform.labelPlaneMatrix,Qt)}let ht=null;We&&g.latestFeatureIndex&&(ht={unwrappedTileID:te,dynamicFilter:We,dynamicFilterNeedsFeature:ut}),this.retainedQueryData[S.bucketInstanceId]=new Nu(S.bucketInstanceId,L,S.sourceLayerIndex,S.index,g.tileID);const[ft,Rt]=S.layers[0].layout.get("text-size-scale-range"),Ot=r.ay(w,ft,Rt),[ti,ri]=P.get("icon-size-scale-range"),vi=r.ay(w,ti,ri),Pt={bucket:S,layout:P,paint:V,posMatrix:de,textLabelPlaneMatrix:nt,labelToScreenMatrix:qe,clippingData:ht,scale:J,textPixelRatio:Z,holdingForFade:g.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:r.bH(S.textSizeData,this.transform.zoom,Ot),partiallyEvaluatedIconSize:r.bH(S.iconSizeData,this.transform.zoom,vi),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(x)for(const Qt of S.sortKeyRanges){const{sortKey:Ct,symbolInstanceStart:oi,symbolInstanceEnd:zt}=Qt;n.push({sortKey:Ct,symbolInstanceStart:oi,symbolInstanceEnd:zt,parameters:Pt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Pt})}attemptAnchorPlacement(n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te){const{textOffset0:je,textOffset1:We,crossTileID:ut}=Z,at=[je,We],nt=kn(n,g,x,at,w),qe=this.collisionIndex.placeCollisionBox(de,w,u,Fn(nt.x,nt.y,S,L,this.transform.angle),J,P,V,Y.predicate);if(ge){const ht=de.getSymbolInstanceIconSize(Te,this.transform.zoom,Z.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,ht,ge,Fn(nt.x,nt.y,S,L,this.transform.angle),J,P,V,Y.predicate).box.length===0)return}if(qe.box.length>0){let ht;return this.prevPlacement&&this.prevPlacement.variableOffsets[ut]&&this.prevPlacement.placements[ut]&&this.prevPlacement.placements[ut].text&&(ht=this.prevPlacement.variableOffsets[ut].anchor),this.variableOffsets[ut]={textOffset:at,width:g,height:x,anchor:n,textScale:w,prevAnchor:ht},this.markUsedJustification(de,n,Z,he),de.allowVerticalPlacement&&(this.markUsedOrientation(de,he,Z),this.placedOrientations[ut]=he),{shift:nt,placedGlyphBoxes:qe}}}placeLayerBucketPart(n,u,g,x,w=1){const{bucket:S,layout:L,paint:P,posMatrix:V,textLabelPlaneMatrix:Y,labelToScreenMatrix:J,clippingData:Z,textPixelRatio:te,holdingForFade:de,collisionBoxArray:he,partiallyEvaluatedTextSize:ge,partiallyEvaluatedIconSize:_e,collisionGroup:Te,latestFeatureIndex:je}=n.parameters,We=L.get("text-optional"),ut=L.get("icon-optional"),at=L.get("text-allow-overlap"),nt=L.get("icon-allow-overlap"),qe=L.get("text-rotation-alignment")==="map",ht=L.get("text-pitch-alignment")==="map",ft=P.get("symbol-z-offset"),Rt=L.get("symbol-elevation-reference")==="sea",[Ot,ti]=L.get("text-size-scale-range"),[ri,vi]=L.get("icon-size-scale-range"),Pt=r.ay(w,Ot,ti),Qt=r.ay(w,ri,vi);this.transform.setProjection(S.projection);let Ct=at&&(nt||!S.hasIconData()||ut),oi=nt&&(at||!S.hasTextData()||We);const zt=!ft.isConstant();!S.collisionArrays&&he&&S.deserializeCollisionBoxes(he),g&&x&&S.updateCollisionDebugBuffers(this.transform.zoom,he,Pt,Qt);const gi=(ai,Mi,ir)=>{const{crossTileID:tr,numVerticalGlyphVertices:Ki}=ai;let pr=null;if(Z&&Z.dynamicFilterNeedsFeature||zt){const N=this.retainedQueryData[S.bucketInstanceId];pr=je.loadFeature({featureIndex:ai.featureIndex,bucketIndex:N.bucketIndex,sourceLayerIndex:N.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Z&&!(0,Z.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},pr,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new r.P(ai.tileAnchorX,ai.tileAnchorY),this.transform.calculateDistanceTileData(Z.unwrappedTileID)))return this.placements[tr]=new Oa(!1,!1,!1,!0),void u.add(tr);const gr=ft.evaluate(pr,{});if(u.has(tr))return;if(de)return void(this.placements[tr]=new Oa(!1,!1,!1));let Cr=!1,Hr=!1,sn=!0,Zn=!1,ws=!1,rs=null,ss={box:null,offscreen:null,occluded:null},ho={box:null},Jr=null,ln=null,vn=null,Rs=0,Vo=0,Ts=0;ir.textFeatureIndex?Rs=ir.textFeatureIndex:ai.useRuntimeCollisionCircles&&(Rs=ai.featureIndex),ir.verticalTextFeatureIndex&&(Vo=ir.verticalTextFeatureIndex);const Xn=N=>{N.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const O=this.transform.elevation;N.elevation=Rt?gr:gr+(O?O.getAtTileOffset(N.tileID,N.tileAnchorX,N.tileAnchorY):0),N.elevation+=ai.zOffset},to=ir.textBox;if(to){Xn(to);const N=X=>{let W=r.bI.horizontal;if(S.allowVerticalPlacement&&!X&&this.prevPlacement){const ce=this.prevPlacement.placedOrientations[tr];ce&&(this.placedOrientations[tr]=ce,W=ce,this.markUsedOrientation(S,W,ai))}return W},O=(X,W)=>{if(S.allowVerticalPlacement&&Ki>0&&ir.verticalTextBox){for(const ce of S.writingModes)if(ce===r.bI.vertical?(ss=W(),ho=ss):ss=X(),ss&&ss.box&&ss.box.length)break}else ss=X()};if(L.get("text-variable-anchor")){let X=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[tr]){const Be=this.prevPlacement.variableOffsets[tr];X.indexOf(Be.anchor)>0&&(X=X.filter(De=>De!==Be.anchor),X.unshift(Be.anchor))}const W=(Be,De,gt)=>{const pt=S.getSymbolInstanceTextSize(ge,ai,this.transform.zoom,Mi),Ht=(Be.x2-Be.x1)*pt+2*Be.padding,si=(Be.y2-Be.y1)*pt+2*Be.padding,pi=ai.hasIconTextFit&&!nt?De:null;pi&&Xn(pi);let Ui={box:[],offscreen:!1,occluded:!1};const Gr=at?2*X.length:X.length;for(let vr=0;vr<Gr;++vr){const Rr=this.attemptAnchorPlacement(X[vr%X.length],Be,Ht,si,pt,qe,ht,te,V,Te,vr>=X.length,ai,Mi,S,gt,pi,ge,_e);if(Rr&&(Ui=Rr.placedGlyphBoxes,Ui&&Ui.box&&Ui.box.length)){Cr=!0,rs=Rr.shift;break}}return Ui};O(()=>W(to,ir.iconBox,r.bI.horizontal),()=>{const Be=ir.verticalTextBox;return Be&&Xn(Be),S.allowVerticalPlacement&&!(ss&&ss.box&&ss.box.length)&&Ki>0&&Be?W(Be,ir.verticalIconBox,r.bI.vertical):{box:null,offscreen:null,occluded:null}}),ss&&(Cr=ss.box,sn=ss.offscreen,Zn=ss.occluded);const ce=N(!(!ss||!ss.box));if(!Cr&&this.prevPlacement){const Be=this.prevPlacement.variableOffsets[tr];Be&&(this.variableOffsets[tr]=Be,this.markUsedJustification(S,Be.anchor,ai,ce))}}else{const X=(W,ce)=>{const Be=S.getSymbolInstanceTextSize(ge,ai,this.transform.zoom,Mi,w),De=this.collisionIndex.placeCollisionBox(S,Be,W,new r.P(0,0),at,te,V,Te.predicate);return De&&De.box&&De.box.length&&(this.markUsedOrientation(S,ce,ai),this.placedOrientations[tr]=ce),De};O(()=>X(to,r.bI.horizontal),()=>{const W=ir.verticalTextBox;return S.allowVerticalPlacement&&Ki>0&&W?(Xn(W),X(W,r.bI.vertical)):{box:null,offscreen:null,occluded:null}}),N(!!(ss&&ss.box&&ss.box.length))}}if(Jr=ss,Cr=Jr&&Jr.box&&Jr.box.length>0,sn=Jr&&Jr.offscreen,Zn=Jr&&Jr.occluded,ai.useRuntimeCollisionCircles){const N=S.text.placedSymbolArray.get(ai.centerJustifiedTextSymbolIndex>=0?ai.centerJustifiedTextSymbolIndex:ai.verticalPlacedTextSymbolIndex),O=r.bJ(S.textSizeData,ge,N),X=L.get("text-padding");ln=this.collisionIndex.placeCollisionCircles(S,at,N,S.lineVertexArray,S.glyphOffsetArray,O,V,Y,J,g,ht,Te.predicate,ai.collisionCircleDiameter*O/r.bO,X,this.retainedQueryData[S.bucketInstanceId].tileID),Cr=at||ln.circles.length>0&&!ln.collisionDetected,sn=sn&&ln.offscreen,Zn=ln.occluded}if(ir.iconFeatureIndex&&(Ts=ir.iconFeatureIndex),ir.iconBox){const N=O=>{Xn(O);const X=ai.hasIconTextFit&&rs?Fn(rs.x,rs.y,qe,ht,this.transform.angle):new r.P(0,0),W=S.getSymbolInstanceIconSize(_e,this.transform.zoom,ai.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,W,O,X,nt,te,V,Te.predicate)};ho&&ho.box&&ho.box.length&&ir.verticalIconBox?(vn=N(ir.verticalIconBox),Hr=vn.box.length>0):(vn=N(ir.iconBox),Hr=vn.box.length>0),sn=sn&&vn.offscreen,ws=vn.occluded}const Ln=We||ai.numHorizontalGlyphVertices===0&&Ki===0,Lo=ut||ai.numIconVertices===0;if(Ln||Lo?Lo?Ln||(Hr=Hr&&Cr):Cr=Hr&&Cr:Hr=Cr=Hr&&Cr,Cr&&Jr&&Jr.box&&this.collisionIndex.insertCollisionBox(Jr.box,L.get("text-ignore-placement"),S.bucketInstanceId,ho&&ho.box&&Vo?Vo:Rs,Te.ID),Hr&&vn&&this.collisionIndex.insertCollisionBox(vn.box,L.get("icon-ignore-placement"),S.bucketInstanceId,Ts,Te.ID),ln&&(Cr&&this.collisionIndex.insertCollisionCircles(ln.circles,L.get("text-ignore-placement"),S.bucketInstanceId,Rs,Te.ID),g)){const N=S.bucketInstanceId;let O=this.collisionCircleArrays[N];O===void 0&&(O=this.collisionCircleArrays[N]=new Qh);for(let X=0;X<ln.circles.length;X+=4)O.circles.push(ln.circles[X+0]),O.circles.push(ln.circles[X+1]),O.circles.push(ln.circles[X+2]),O.circles.push(ln.collisionDetected?1:0)}const Ds=S.projection.name!=="globe";Ct=Ct&&(Ds||!Zn),oi=oi&&(Ds||!ws),this.placements[tr]=new Oa(Cr||Ct,Hr||oi,sn||S.justReloaded),u.add(tr)},Li=this.retainedQueryData[S.bucketInstanceId].tileID;if(S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,Li),S.elevationType==="road"&&S.updateRoadElevation(Li.canonical),S.updateZOffset(),S.sortFeaturesByY){const ai=S.getSortedSymbolIndexes(this.transform.angle);for(let Mi=ai.length-1;Mi>=0;--Mi){const ir=ai[Mi];gi(S.symbolInstances.get(ir),ir,S.collisionArrays[ir])}S.hasAnyZOffset&&r.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const ai=S.getSortedIndexesByZOffset();for(let Mi=0;Mi<ai.length;++Mi){const ir=ai[Mi];gi(S.symbolInstances.get(ir),ir,S.collisionArrays[ir])}}else for(let ai=n.symbolInstanceStart;ai<n.symbolInstanceEnd;ai++)gi(S.symbolInstances.get(ai),ai,S.collisionArrays[ai]);if(g&&S.bucketInstanceId in this.collisionCircleArrays){const ai=this.collisionCircleArrays[S.bucketInstanceId];r.bi(ai.invProjMatrix,V),ai.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(n,u,g,x){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:P,crossTileID:V}=g,Y=r.bV(u),J=x===r.bI.vertical?P:Y==="left"?w:Y==="center"?S:Y==="right"?L:-1;w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=J>=0&&w!==J?0:V),S>=0&&(n.text.placedSymbolArray.get(S).crossTileID=J>=0&&S!==J?0:V),L>=0&&(n.text.placedSymbolArray.get(L).crossTileID=J>=0&&L!==J?0:V),P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=J>=0&&P!==J?0:V)}markUsedOrientation(n,u,g){const x=u===r.bI.horizontal||u===r.bI.horizontalOnly?u:0,w=u===r.bI.vertical?u:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:V}=g,Y=n.text.placedSymbolArray;S>=0&&(Y.get(S).placedOrientation=x),L>=0&&(Y.get(L).placedOrientation=x),P>=0&&(Y.get(P).placedOrientation=x),V>=0&&(Y.get(V).placedOrientation=w)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(n):1,w=u?u.opacities:{},S=u?u.variableOffsets:{},L=u?u.placedOrientations:{};for(const P in this.placements){const V=this.placements[P],Y=w[P];Y?(this.opacities[P]=new Cc(Y,x,V.text,V.icon,null,V.clipped),g=g||V.text!==Y.text.placed||V.icon!==Y.icon.placed):(this.opacities[P]=new Cc(null,x,V.text,V.icon,V.skipFade,V.clipped),g=g||V.text||V.icon)}for(const P in w){const V=w[P];if(!this.opacities[P]){const Y=new Cc(V,x,!1,!1);Y.isHidden()||(this.opacities[P]=Y,g=g||V.text.placed||V.icon.placed)}}for(const P in S)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=S[P]);for(const P in L)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=L[P]);g?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u,g,x){const w=new Set;for(const S of u){const L=S.getBucket(n);L&&S.latestFeatureIndex&&n.fqid===L.layerIds[0]&&(this.updateBucketOpacities(L,w,S,S.collisionBoxArray,g,x,S.tileID,n.scope),L.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(L,S.tileID),L.elevationType==="road"&&L.updateRoadElevation(S.tileID.canonical),L.updateZOffset())}}updateBucketOpacities(n,u,g,x,w,S,L,P){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const V=n.layers[0].layout,Y=n.layers[0].paint,J=!!n.layers[0].dynamicFilter(),Z=new Cc(null,0,!1,!1,!0),te=V.get("text-allow-overlap"),de=V.get("icon-allow-overlap"),he=V.get("text-variable-anchor"),ge=V.get("text-rotation-alignment")==="map",_e=V.get("text-pitch-alignment")==="map",Te=Y.get("symbol-z-offset"),je=V.get("symbol-elevation-reference")==="sea",We=!Te.isConstant(),ut=new Cc(null,0,te&&(de||!n.hasIconData()||V.get("icon-optional")),de&&(te||!n.hasTextData()||V.get("text-optional")),!0);!n.collisionArrays&&x&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(x);const at=(qe,ht,ft)=>{for(let Rt=0;Rt<ht/4;Rt++)qe.opacityVertexArray.emplaceBack(ft)};let nt=0;S&&n.updateReplacement(L,S);for(let qe=0;qe<n.symbolInstances.length;qe++){const ht=n.symbolInstances.get(qe),{numHorizontalGlyphVertices:ft,numVerticalGlyphVertices:Rt,crossTileID:Ot,numIconVertices:ti,tileAnchorX:ri,tileAnchorY:vi}=ht;let Pt=null;const Qt=this.retainedQueryData[n.bucketInstanceId];We&&ht&&Qt&&(Pt=g.latestFeatureIndex.loadFeature({featureIndex:ht.featureIndex,bucketIndex:Qt.bucketIndex,sourceLayerIndex:Qt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ct=Te.evaluate(Pt,{}),oi=u.has(Ot);let zt=this.opacities[Ot];oi?zt=Z:zt||(zt=ut,this.opacities[Ot]=zt),u.add(Ot);const gi=ft>0||Rt>0,Li=ti>0,ai=this.placedOrientations[Ot],Mi=ai===r.bI.vertical,ir=ai===r.bI.horizontal||ai===r.bI.horizontalOnly;!gi&&!Li||zt.isHidden()||nt++;let tr=!1;if((gi||Li)&&S)for(const Ki of n.activeReplacements){if(r.bP(Ki,w,r.bQ.Symbol,P)||Ki.min.x>ri||ri>Ki.max.x||Ki.min.y>vi||vi>Ki.max.y)continue;const pr=r.bR(ri,vi,L.canonical,Ki.footprintTileId.canonical);if(tr=r.bS(pr,Ki.footprint),tr)break}if(gi){const Ki=tr?cn:Vr(zt.text);at(n.text,ft,Mi?cn:Ki),at(n.text,Rt,ir?cn:Ki);const pr=zt.text.isHidden(),{leftJustifiedTextSymbolIndex:gr,centerJustifiedTextSymbolIndex:Cr,rightJustifiedTextSymbolIndex:Hr,verticalPlacedTextSymbolIndex:sn}=ht,Zn=n.text.placedSymbolArray,ws=pr||Mi?1:0;gr>=0&&(Zn.get(gr).hidden=ws),Cr>=0&&(Zn.get(Cr).hidden=ws),Hr>=0&&(Zn.get(Hr).hidden=ws),sn>=0&&(Zn.get(sn).hidden=pr||ir?1:0);const rs=this.variableOffsets[Ot];rs&&this.markUsedJustification(n,rs.anchor,ht,ai);const ss=this.placedOrientations[Ot];ss&&(this.markUsedJustification(n,"left",ht,ss),this.markUsedOrientation(n,ss,ht))}if(Li){const Ki=tr?cn:Vr(zt.icon),{placedIconSymbolIndex:pr,verticalPlacedIconSymbolIndex:gr}=ht,Cr=n.icon.placedSymbolArray,Hr=zt.icon.isHidden()?1:0;pr>=0&&(at(n.icon,ti,Mi?cn:Ki),Cr.get(pr).hidden=Hr),gr>=0&&(at(n.icon,ht.numVerticalIconVertices,ir?cn:Ki),Cr.get(gr).hidden=Hr)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ki=n.collisionArrays[qe];if(Ki){let pr=new r.P(0,0),gr=!0;if(Ki.textBox||Ki.verticalTextBox){if(he){const Hr=this.variableOffsets[Ot];Hr?(pr=kn(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textScale),ge&&pr._rotate(_e?this.transform.angle:-this.transform.angle)):gr=!1}J&&(gr=!zt.clipped),Ki.textBox&&Ul(n.textCollisionBox.collisionVertexArray,zt.text.placed,!gr||Mi,Ct,je,pr.x,pr.y),Ki.verticalTextBox&&Ul(n.textCollisionBox.collisionVertexArray,zt.text.placed,!gr||ir,Ct,je,pr.x,pr.y)}const Cr=gr&&!!(!ir&&Ki.verticalIconBox);Ki.iconBox&&Ul(n.iconCollisionBox.collisionVertexArray,zt.icon.placed,Cr,Ct,je,ht.hasIconTextFit?pr.x:0,ht.hasIconTextFit?pr.y:0),Ki.verticalIconBox&&Ul(n.iconCollisionBox.collisionVertexArray,zt.icon.placed,!Cr,Ct,je,ht.hasIconTextFit?pr.x:0,ht.hasIconTextFit?pr.y:0)}}}if(n.fullyClipped=nt===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const qe=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=qe.invProjMatrix,n.placementViewportMatrix=qe.viewportMatrix,n.collisionCircleArray=qe.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>n}setStale(){this.stale=!0}}function Ul(p,n,u,g,x,w,S){p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,x?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,x?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,x?1:0),p.emplaceBack(n?1:0,u?1:0,w||0,S||0,g,x?1:0)}const ie=Math.pow(2,25),Ue=Math.pow(2,24),Tt=Math.pow(2,17),jt=Math.pow(2,16),hi=Math.pow(2,9),Ii=Math.pow(2,8),mr=Math.pow(2,1);function Vr(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const n=p.placed?1:0,u=Math.floor(127*p.opacity);return u*ie+n*Ue+u*Tt+n*jt+u*hi+n*Ii+u*mr+n}const cn=0;class Rn{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,u,g,x,w,S){const L=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(L,x,n[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((P,V)=>P.sortKey-V.sortKey));this._currentPartIndex<L.length;){const P=L[this._currentPartIndex];if(u.placeLayerBucketPart(P,this._seenCrossTileIDs,g,P.symbolInstanceStart===0,S),this._currentPartIndex++,w())return!0}return!1}}class Dn{constructor(n,u,g,x,w,S,L,P,V){this.placement=new sa(n,w,S,L,P,V),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(n,u,g,x,w){const S=r.q.now(),L=()=>{const P=r.q.now()-S;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=u[n[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=V)&&(!P.maxzoom||P.maxzoom>V)){const Y=P,J=Y.layout.get("symbol-z-elevate"),Z=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,te=Y.layout.get("symbol-z-order"),de=te==="viewport-y"||te==="auto"&&!(te!=="viewport-y"&&Z),he=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),ge=de&&he,_e=this._inProgressLayer=this._inProgressLayer||new Rn(Y),Te=r.C(P.source,P.scope);if(_e.continuePlacement(J||ge?x[Te]:g[Te],this.placement,this._showCollisionBoxes,P,L,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const As=512/r.aj/2;class Zs{constructor(n,u,g){this.tileID=n,this.bucketInstanceId=g,this.index=new r.bW(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=n.canonical.x*r.aj,w=n.canonical.y*r.aj;for(let S=0;S<u.length;S++){const{key:L,crossTileID:P,tileAnchorX:V,tileAnchorY:Y}=u.get(S),J=Math.floor((x+V)*As),Z=Math.floor((w+Y)*As);this.index.add(J,Z),this.keys.push(L),this.crossTileIDs.push(P)}this.index.finish()}findMatches(n,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),w=As/Math.pow(2,u.canonical.z-this.tileID.canonical.z),S=u.canonical.x*r.aj,L=u.canonical.y*r.aj;for(let P=0;P<n.length;P++){const V=n.get(P);if(V.crossTileID)continue;const{key:Y,tileAnchorX:J,tileAnchorY:Z}=V,te=Math.floor((S+J)*w),de=Math.floor((L+Z)*w),he=this.index.range(te-x,de-x,te+x,de+x).sort((ge,_e)=>ge-_e);for(const ge of he){const _e=this.crossTileIDs[ge];if(this.keys[ge]===Y&&!g.has(_e)){g.add(_e),V.crossTileID=_e;break}}}}}class ts{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],w={};for(const S in x){const L=x[S];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+u),w[L.tileID.key]=L}this.indexes[g]=w}this.lng=n}addBucket(n,u,g){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const x=this.usedCrossTileIDs[n.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>n.overscaledZ)for(const L in S){const P=S[L];P.tileID.isChildOf(n)&&P.findMatches(u.symbolInstances,n,x)}else{const L=S[n.scaledTo(Number(w)).key];L&&L.findMatches(u.symbolInstances,n,x)}}for(let w=0;w<u.symbolInstances.length;w++){const S=u.symbolInstances.get(w);S.crossTileID||(S.crossTileID=g.generate(),x.add(S.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Zs(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[n].delete(g)}removeStaleBuckets(n){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const w in x)n[x[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[w]),delete x[w],u=!0)}return u}}class Js{constructor(){this.layerIndexes={},this.crossTileIDs=new ts,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,g,x){let w=this.layerIndexes[n.fqid];w===void 0&&(w=this.layerIndexes[n.fqid]=new bn);let S=!1;const L={};x.name!=="globe"&&w.handleWrapJump(g);for(const P of u){const V=P.getBucket(n);V&&n.fqid===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(P.tileID,V,this.crossTileIDs)&&(S=!0),L[V.bucketInstanceId]=!0)}return w.removeStaleBuckets(L)&&(S=!0),S}pruneUnusedLayers(n){const u={};n.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const vo=771;class Wr{constructor(n,u,g,x){this.blendFunction=n,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=g,this.blendEquation=x}}Wr.Replace=[1,0,1,0],Wr.disabled=new Wr(Wr.Replace,r.am.transparent,[!1,!1,!1,!1]),Wr.unblended=new Wr(Wr.Replace,r.am.transparent,[!0,!0,!0,!0]),Wr.alphaBlended=new Wr([1,vo,1,vo],r.am.transparent,[!0,!0,!0,!0]),Wr.alphaBlendedNonPremultiplied=new Wr([770,vo,770,vo],r.am.transparent,[!0,!0,!0,!0]),Wr.multiply=new Wr([774,0,774,0],r.am.transparent,[!0,!0,!0,!0]);class ji{constructor(n,u,g){this.func=n,this.mask=u,this.range=g}}ji.ReadOnly=!1,ji.ReadWrite=!0,ji.disabled=new ji(519,ji.ReadOnly,[0,1]);const eo=7680;class Pr{constructor(n,u,g,x,w,S){this.test=n,this.ref=u,this.mask=g,this.fail=x,this.depthFail=w,this.pass=S}}Pr.disabled=new Pr({func:519,mask:0},0,0,eo,eo,eo);const Es=1029,lo=2305;class wr{constructor(n,u,g){this.enable=n,this.mode=u,this.frontFace=g}}function _o(p,n){const u=r.c1(p,3);r.c3(p,n),r.c7(p,3,u)}function oc(p,n){const u=r.b_([]);return r.b$(u,u,-n),r.c0(u,u,-p),u}function fa(p,n){const u=[p[0],p[1],0],g=[n[0],n[1],0];if(r.ae(u)>=1e-15){const S=r.au([],u);r.bY(g,S,r.bG(g,S)),n[0]=g[0],n[1]=g[1]}const x=r.bF([],n,p);if(r.bZ(x)<1e-15)return null;const w=Math.atan2(-x[1],x[0]);return oc(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),w)}wr.disabled=new wr(!1,Es,lo),wr.backCCW=new wr(!0,Es,lo),wr.backCW=new wr(!0,Es,2304),wr.frontCW=new wr(!0,1028,2304),wr.frontCCW=new wr(!0,1028,lo);class Yo{constructor(n,u){this.position=n,this.orientation=u}get position(){return this._position}set position(n){if(n){const u=n instanceof r.ac?n:new r.ac(n[0],n[1],n[2]);this._renderWorldCopies&&(u.x=r.bX(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(n,u){if(this.orientation=null,!this.position)return;const g=this.position,x=this._elevation?this._elevation.getAtPointOrZero(r.ac.fromLngLat(n)):0,w=r.ac.fromLngLat(n,x),S=[w.x-g.x,w.y-g.y,w.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=fa(S,u)}setPitchBearing(n,u){this.orientation=oc(r.al(n),r.al(-u))}}class is{constructor(n,u){this._transform=r.bx([]),this.orientation=u,this.position=n}get mercatorPosition(){const n=this.position;return new r.ac(n[0],n[1],n[2])}get position(){const n=r.c1(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var u;n&&r.c7(this._transform,3,[(u=n)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||r.b_([]),n&&_o(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,u){this._orientation=oc(n,u),_o(this._transform,this._orientation)}forward(){const n=r.c1(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=r.c1(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=r.c1(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,u){const g=new Float64Array(16);return r.bi(g,this.getWorldToCamera(n,u)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,u,g){const x=this.position;r.bY(x,x,-n);const w=new Float64Array(16);return r.bn(w,[g,g,g]),r.bo(w,w,x),w[10]*=u,w}getWorldToCamera(n,u){const g=new Float64Array(16),x=new Float64Array(4),w=this.position;return r.c2(x,this._orientation),r.bY(w,w,-n),r.c3(g,x),r.bo(g,g,w),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(n,u,g,x){const w=new Float64Array(16);return r.c4(w,n,u,g,x),w}getCameraToClipOrthographic(n,u,g,x,w,S){const L=new Float64Array(16);return r.c5(L,n,u,g,x,w,S),L}getDistanceToElevation(n,u=!1){const g=n===0?0:r.c6(n,u?r.aY(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new is([...this.position],[...this.orientation])}}const Ko={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Sc{constructor(n=0,u=0,g=0,x=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=g,this.right=x}interpolate(n,u,g){return u.top!=null&&n.top!=null&&(this.top=r.ai(n.top,u.top,g)),u.bottom!=null&&n.bottom!=null&&(this.bottom=r.ai(n.bottom,u.bottom,g)),u.left!=null&&n.left!=null&&(this.left=r.ai(n.left,u.left,g)),u.right!=null&&n.right!=null&&(this.right=r.ai(n.right,u.right,g)),this}getCenter(n,u){const g=r.ay((this.left+n-this.right)/2,0,n),x=r.ay((this.top+u-this.bottom)/2,0,u);return new r.P(g,x)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Sc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Io=15;class Ua{constructor(n,u,g,x,w,S,L){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(S),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new r.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Sc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new is,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const n=new Ua(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n._allowWorldUnderZoom=this._allowWorldUnderZoom,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Io}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(n||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return r.aF(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=r.ce(this.projectionOptions);const g=this.getProjection(),x=!r.bv(u,g);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.ce({name:"mercator"});const u=n!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bX(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const u=-n*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=r.cf(),r.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const u=r.ay(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=r.al(n),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const n=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,w=0;for(let S=0;S<u.length;S++){const L=new r.P(u[S][0]*this.width,g+u[S][1]*(this.height-g)),P=n.pointCoordinate(L);if(!P)continue;const V=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);x+=P[3]*V,w+=V}return w===0?NaN:x/w}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(n),w=this._mercatorZfromZoom(this._maxZoom),S=Math.max(x-g,w);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let g;g=n.z<this._camera.position[2]?[u.x,u.y,u.z]:[n.x,n.y,n.z];const x=r.ae(r.at([],this._camera.position,g));return r.ay(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let u=!1;if(n.orientation&&!r.ch(n.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(n.orientation)),n.position){const g=[n.position.x,n.position.y,n.position.z];r.ci(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,u=new Yo;return u.position=new r.ac(n[0],n[1],n[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(n){if(!r.cj(n))return!1;r.ck(n,n);const u=r.cl([],[0,0,-1],n),g=r.cl([],[0,-1,0],n);if(g[2]<0)return!1;const x=fa(u,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(n){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;n[2]=r.ay(n[2],x/g,x/u),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,g){this._unmodified=!1,this._edgeInsets.interpolate(n,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(n){const u=[new r.cm(0,n)];if(this.renderWorldCopies){const g=this.pointCoordinate(new r.P(0,0)),x=this.pointCoordinate(new r.P(this.width,0)),w=this.pointCoordinate(new r.P(this.width,this.height)),S=this.pointCoordinate(new r.P(0,this.height)),L=Math.floor(Math.min(g.x,x.x,w.x,S.x)),P=Math.floor(Math.max(g.x,x.x,w.x,S.x)),V=1;for(let Y=L-V;Y<=P+V;Y++)Y!==0&&u.push(new r.cm(Y,n))}return u}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,u,g){let x=[];const w=g!=null,S=!w;if(S&&this.zoom<u||w&&g[0]===0&&g[1]===0)return x;const L=new Set,P=(Y,J,Z,te,de)=>{const he=r.cK(J,Y,Z,te,de);L.has(he)||(x.push(new r.aM(Y,J,Z,te,de)),L.add(he))};for(let Y=0;Y<n.length;Y++){const J=n[Y];if(S&&J.canonical.z!==u)continue;const Z=J.canonical,te=J.overscaledZ,de=J.wrap,he=1<<Z.z,ge=Z.x+1<he,_e=Z.x>0,Te=Z.y+1<he,je=Z.y>0,We=J.wrap-(_e?0:1),ut=J.wrap+(ge?0:1),at=_e?Z.x-1:he-1,nt=ge?Z.x+1:0;if(w)g[0]<0?(P(te,ut,Z.z,nt,Z.y),g[1]<0&&Te&&(P(te,de,Z.z,Z.x,Z.y+1),P(te,ut,Z.z,nt,Z.y+1)),g[1]>0&&je&&(P(te,de,Z.z,Z.x,Z.y-1),P(te,ut,Z.z,nt,Z.y-1))):g[0]>0?(P(te,We,Z.z,at,Z.y),g[1]<0&&Te&&(P(te,de,Z.z,Z.x,Z.y+1),P(te,We,Z.z,at,Z.y+1)),g[1]>0&&je&&(P(te,de,Z.z,Z.x,Z.y-1),P(te,We,Z.z,at,Z.y-1))):g[1]<0&&Te?P(te,de,Z.z,Z.x,Z.y+1):je&&P(te,de,Z.z,Z.x,Z.y-1);else{const qe=J.visibleQuadrants;1&qe&&(P(te,We,Z.z,at,Z.y),je&&(P(te,de,Z.z,Z.x,Z.y-1),P(te,We,Z.z,at,Z.y-1))),2&qe&&(P(te,ut,Z.z,nt,Z.y),je&&(P(te,de,Z.z,Z.x,Z.y-1),P(te,ut,Z.z,nt,Z.y-1))),4&qe&&(P(te,We,Z.z,at,Z.y),Te&&(P(te,de,Z.z,Z.x,Z.y+1),P(te,We,Z.z,at,Z.y+1))),8&qe&&(P(te,ut,Z.z,nt,Z.y),Te&&(P(te,de,Z.z,Z.x,Z.y+1),P(te,ut,Z.z,nt,Z.y+1)))}}const V=[];for(const Y of x)x.some(J=>Y.isChildOf(J))||V.push(Y);if(x=V.filter(Y=>!n.some(J=>!!(Y.overscaledZ<u&&J.isChildOf(Y))||Y.equals(J)||Y.isChildOf(J))),S){const Y=1<<u,J=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Z=[Y*J.x,Y*J.y],te=4,de=te*te;x=x.filter(he=>{const ge=he.canonical.x+.5-Z[0],_e=he.canonical.y+.5-Z[1];return ge*ge+_e*_e<de})}return x}coveringTiles(n){let u=this.coveringZoomLevel(n);const g=u,x=this.elevation&&this.elevation.exaggeration(),w=x&&!n.isTerrainDEM,S=this.projection.name==="mercator";if(n.minzoom!==void 0&&u<n.minzoom)return[];n.maxzoom!==void 0&&u>n.maxzoom&&(u=n.maxzoom);const L=this.locationCoordinate(this.center),P=this.center.lat,V=1<<u,Y=[V*L.x,V*L.y,0],J=this.projection.name==="globe",Z=!J,te=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,Z),de=J?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),he=V*r.c6(1,this.center.lat),ge=this._camera.position[2]/r.c6(1,this.center.lat),_e=[V*de.x,V*de.y,ge*(Z?1:he)],Te=J||x,je=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),We=this.isLODDisabled(!0)?u:0;let ut;if(this._elevation&&n.isTerrainDEM)ut=1e4*this._elevation.exaggeration();else if(this._elevation){const Ct=this._elevation.getMinMaxForVisibleTiles();ut=Ct?Ct.max:this._centerAltitude}else ut=this._centerAltitude;const at=n.isTerrainDEM?-ut:this._elevation?this._elevation.getMinElevationBelowMSL():0,nt=this.projection.isReprojectedInTileSpace?r.co(this):1,qe=Ct=>{const zt=new r.ac(Ct.x+25e-6,Ct.y,Ct.z),gi=new r.ac(Ct.x,Ct.y+25e-6,Ct.z),Li=Ct.toLngLat(),ai=zt.toLngLat(),Mi=gi.toLngLat(),ir=this.locationCoordinate(Li),tr=this.locationCoordinate(ai),Ki=this.locationCoordinate(Mi),pr=Math.hypot(tr.x-ir.x,tr.y-ir.y),gr=Math.hypot(Ki.x-ir.x,Ki.y-ir.y);return Math.sqrt(pr*gr)*nt/25e-6},ht=Ct=>{const oi=ut,zt=at;return{aabb:r.cr(this,V,0,0,0,Ct,zt,oi,this.projection),zoom:0,x:0,y:0,minZ:zt,maxZ:oi,wrap:Ct,fullyVisible:!1}},ft=[];let Rt=[];const Ot=u,ti=n.reparseOverscaled?g:u,ri=(ge-this._centerAltitude)*he,vi=Ct=>{if(!this._elevation||!Ct.tileID||!S)return;const oi=this._elevation.getMinMaxForTile(Ct.tileID),zt=Ct.aabb;oi?(zt.min[2]=oi.min,zt.max[2]=oi.max,zt.center[2]=(zt.min[2]+zt.max[2])/2):(Ct.shouldSplit=Qt(Ct),Ct.shouldSplit||(zt.min[2]=zt.max[2]=zt.center[2]=this._centerAltitude))},Pt=(Ct,oi)=>{if(.707*oi<Ct)return 1;const zt=oi/Ct;return zt/(1.4144271570014144+(Math.pow(1.1,zt-1.4144271570014144+1)-1)/(1.1-1)-1)},Qt=Ct=>{if(Ct.zoom<We)return!0;if(Ct.zoom===Ot)return!1;if(Ct.shouldSplit!=null)return Ct.shouldSplit;const oi=Ct.aabb.distanceX(_e),zt=Ct.aabb.distanceY(_e);let gi=ri,Li=1;if(J){gi=Ct.aabb.distanceZ(_e);const gr=Math.pow(2,Ct.zoom),Cr=r.aY((Ct.y+1)/gr),Hr=r.aY(Ct.y/gr),sn=Math.min(Math.max(P,Cr),Hr),Zn=r.cO(sn)/r.cO(P);if(Li=sn===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Zn/this._mercatorScaleRatio),this.zoom<=r.cL&&Ct.zoom===Ot-1&&Zn>=.9)return!0}else if(w&&(gi=Ct.aabb.distanceZ(_e)*he),this.projection.isReprojectedInTileSpace&&g<=5){const gr=Math.pow(2,Ct.zoom),Cr=qe(new r.ac((Ct.x+.5)/gr,(Ct.y+.5)/gr));Li=Cr>.85?1:Cr}if(!S){const gr=Math.sqrt(oi*oi+zt*zt+gi*gi);let Cr=(1<<Ot-Ct.zoom)*je*Li;return Cr*=Pt(Math.max(gi,ri),gr),gr<Cr}let ai=Number.MAX_VALUE,Mi=0;const ir=Ct.aabb.getCorners(),tr=[];for(const gr of ir){r.at(tr,gr,_e),J||(w?tr[2]*=he:tr[2]=ri);const Cr=r.bG(tr,this._camera.forward());Cr<ai&&(ai=Cr,Mi=Math.abs(tr[2]))}let Ki=(1<<Ot-Ct.zoom)*je*Li;if(Ki*=Pt(Math.max(Mi,ri),ai),ai<Ki)return!0;const pr=Ct.aabb.closestPoint(Y);return pr[0]===Y[0]&&pr[1]===Y[1]};if(this.renderWorldCopies)for(let Ct=1;Ct<=3;Ct++)ft.push(ht(-Ct)),ft.push(ht(Ct));for(ft.push(ht(0));ft.length>0;){const Ct=ft.pop(),oi=Ct.x,zt=Ct.y;let gi=Ct.fullyVisible;const Li=()=>this.projection.name==="globe"&&(Ct.y===0||Ct.y===(1<<Ct.zoom)-1);if(!gi){let ai=Te?Ct.aabb.intersects(te):Ct.aabb.intersectsFlat(te);if(ai===0&&Li()){const Mi=new r.cp(Ct.zoom,oi,zt);ai=r.cq(this,V,Mi,!0).intersects(te)}if(ai===0)continue;gi=ai===2}if(Ct.zoom!==Ot&&Qt(Ct))for(let ai=0;ai<4;ai++){const Mi=(oi<<1)+ai%2,ir=(zt<<1)+(ai>>1),tr={aabb:S?Ct.aabb.quadrant(ai):r.cr(this,V,Ct.zoom+1,Mi,ir,Ct.wrap,Ct.minZ,Ct.maxZ,this.projection),zoom:Ct.zoom+1,x:Mi,y:ir,wrap:Ct.wrap,fullyVisible:gi,tileID:void 0,shouldSplit:void 0,minZ:Ct.minZ,maxZ:Ct.maxZ};w&&!J&&(tr.tileID=new r.aM(Ct.zoom+1===Ot?ti:Ct.zoom+1,Ct.wrap,Ct.zoom+1,Mi,ir),vi(tr)),ft.push(tr)}else{const ai=Ct.zoom===Ot?ti:Ct.zoom;if(n.minzoom&&n.minzoom>ai)continue;let Mi=0;if(!gi){let pr=Te?Ct.aabb.intersectsPrecise(te):Ct.aabb.intersectsPreciseFlat(te);if(pr===0&&Li()){const gr=new r.cp(Ct.zoom,oi,zt);pr=r.cq(this,V,gr,!0).intersectsPrecise(te)}if(pr===0)continue;if(n.calculateQuadrantVisibility)if(te.containsPoint(Ct.aabb.center))Mi=15;else for(let gr=0;gr<4;gr++)Ct.aabb.quadrant(gr).intersects(te)!==0&&(Mi|=1<<gr)}const ir=Y[0]-(.5+oi+(Ct.wrap<<Ct.zoom))*(1<<u-Ct.zoom),tr=Y[1]-.5-zt,Ki=Ct.tileID?Ct.tileID:new r.aM(ai,Ct.wrap,Ct.zoom,oi,zt);n.calculateQuadrantVisibility&&(Ki.visibleQuadrants=Mi),Rt.push({tileID:Ki,distanceSq:ir*ir+tr*tr})}}if(this.fogCullDistSq){const Ct=this.fogCullDistSq,oi=this.horizonLineFromTop();Rt=Rt.filter(zt=>{const gi=[0,0,0,1],Li=[r.aj,r.aj,0,1],ai=this.calculateFogTileMatrix(zt.tileID.toUnwrapped());r.aA(gi,gi,ai),r.aA(Li,Li,ai);const Mi=r.cs([],gi,Li),ir=r.ct([],gi,Li),tr=r.cM(Mi,ir);if(tr===0)return!0;let Ki=!1;const pr=this._elevation;if(pr&&tr>Ct&&oi!==0){const gr=this.calculateProjMatrix(zt.tileID.toUnwrapped());let Cr;n.isTerrainDEM||(Cr=pr.getMinMaxForTile(zt.tileID)),Cr||(Cr={min:at,max:ut});const Hr=r.cu(this.rotation),sn=[Hr[0]*r.aj,Hr[1]*r.aj,Cr.max];r.ad(sn,sn,gr),Ki=(1-sn[1])*this.height*.5<oi}return tr<Ct||Ki})}return Rt.sort((Ct,oi)=>Ct.distanceSq-oi.distanceSq).map(Ct=>Ct.tileID)}resize(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const u=r.ay(n.lat,-85.051129,r.cv),g=this.projection.project(n.lng,u);return new r.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,u){let g,x;const w=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;g=(u.x-w.x)/L,x=(u.y-w.y)/L}else{const L=this.pointCoordinate(u),P=this.pointCoordinate(w);g=L.x-P.x,x=L.y-P.y}const S=this.locationCoordinate(n);this.setLocation(new r.ac(S.x-g,S.y-x))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n,u){return this.projection.locationPoint(this,n,u)}locationPoint3D(n,u){return this.projection.locationPoint(this,n,u,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n,u){return this.coordinateLocation(this.pointCoordinate3D(n,u))}locationCoordinate(n,u){const g=u?r.c6(u,n.lat):void 0,x=this.projection.project(n.lng,n.lat);return new r.ac(x.x,x.y,g)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,u){const g=u??this._centerAltitude,x=[n.x,n.y,0,1],w=[n.x,n.y,1,1];r.aA(x,x,this.pixelMatrixInverse),r.aA(w,w,this.pixelMatrixInverse);const S=w[3];r.cw(x,x,1/x[3]),r.cw(w,w,1/S);const L=x[2],P=w[2];return{p0:x,p1:w,t:L===P?0:(g-L)/(P-L)}}screenPointToMercatorRay(n){const u=[n.x,n.y,0,1],g=[n.x,n.y,1,1];return r.aA(u,u,this.pixelMatrixInverse),r.aA(g,g,this.pixelMatrixInverse),r.cw(u,u,1/u[3]),r.cw(g,g,1/g[3]),u[2]=r.c6(u[2],this._center.lat)*this.worldSize,g[2]=r.c6(g[2],this._center.lat)*this.worldSize,r.cw(u,u,1/this.worldSize),r.cw(g,g,1/this.worldSize),new r.av([u[0],u[1],u[2]],r.au([],r.at([],g,u)))}rayIntersectionCoordinate(n){const{p0:u,p1:g,t:x}=n,w=r.c6(u[2],this._center.lat),S=r.c6(g[2],this._center.lat);return new r.ac(r.ai(u[0],g[0],x)/this.worldSize,r.ai(u[1],g[1],x)/this.worldSize,r.ai(w,S,x))}pointCoordinate(n,u=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,u)}pointCoordinate3D(n,u){if(!this.elevation)return this.pointCoordinate(n,u);let g=this.projection.pointCoordinate3D(this,n.x,n.y);if(g)return new r.ac(g[0],g[1],g[2]);let x=0,w=this.horizonLineFromTop();if(n.y>w)return this.pointCoordinate(n,u);const S=.02*w,L=n.clone();for(let P=0;P<10&&w-x>S;P++){L.y=r.ai(x,w,.66);const V=this.projection.pointCoordinate3D(this,L.x,L.y);V?(w=L.y,g=V):x=L.y}return g?new r.ac(g[0],g[1],g[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=r.cx)return!this.isPointAboveHorizon(n);const u=this.pointCoordinate(n);return u.y>=0&&u.y<=1}_coordinatePoint(n,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,x=[n.x*this.worldSize,n.y*this.worldSize,g+n.toAltitude(),1];return r.aA(x,x,this.pixelMatrix),x[3]>0?new r.P(x[0]/x[3],x[1]/x[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,w=this.pointLocation3D(new r.P(u,n)),S=this.pointLocation3D(new r.P(x,n)),L=this.pointLocation3D(new r.P(x,g)),P=this.pointLocation3D(new r.P(u,g));let V=Math.min(w.lng,S.lng,L.lng,P.lng),Y=Math.max(w.lng,S.lng,L.lng,P.lng),J=Math.min(w.lat,S.lat,L.lat,P.lat),Z=Math.max(w.lat,S.lat,L.lat,P.lat);const te=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,he=(ge,_e,Te,je,We)=>{const ut=(ge+Te)/2,at=(_e+je)/2,nt=new r.P(ut,at),{lng:qe,lat:ht}=this.pointLocation3D(nt),ft=Math.max(0,V-qe,J-ht,qe-Y,ht-Z);V=Math.min(V,qe),Y=Math.max(Y,qe),J=Math.min(J,ht),Z=Math.max(Z,ht),(We<de||ft>te)&&(he(ge,_e,ut,at,We+1),he(ut,at,Te,je,We+1))};if(he(u,n,x,n,1),he(x,n,x,g,1),he(x,g,u,g,1),he(u,g,u,n,1),this.projection.name==="globe"){const[ge,_e]=r.cy(this);ge?(Z=90,Y=180,V=-180):_e&&(J=-90,Y=180,V=-180)}return new r.aG(new r.cd(V,J),new r.cd(Y,Z))}_getBoundsRectangular(n,u){const{top:g,left:x}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,L=new r.P(x,g),P=new r.P(S,g),V=new r.P(S,w),Y=new r.P(x,w);let J=this.pointCoordinate(L,n),Z=this.pointCoordinate(P,n);const te=this.pointCoordinate(V,u),de=this.pointCoordinate(Y,u),he=(ge,_e)=>(_e.y-ge.y)/(_e.x-ge.x);return J.y>1&&Z.y>=0?J=new r.ac((1-de.y)/he(de,J)+de.x,1):J.y<0&&Z.y<=1&&(J=new r.ac(-de.y/he(de,J)+de.x,0)),Z.y>1&&J.y>=0?Z=new r.ac((1-te.y)/he(te,Z)+te.x,1):Z.y<0&&J.y<=1&&(Z=new r.ac(-te.y/he(te,Z)+te.x,0)),new r.aG().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=n.visibleDemTiles.reduce((g,x)=>{if(x.dem){const w=x.dem.tree;g.min=Math.min(g.min,w.minimums[0]),g.max=Math.max(g.max,w.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*n.exaggeration(),u.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return n?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-85.051129,this.maxLat=r.cv,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.aD(this.minLng)*this.tileSize,this.worldMaxX=r.aD(this.maxLng)*this.tileSize,this.worldMinY=r.aH(this.maxLat)*this.tileSize,this.worldMaxY=r.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,u){return this.projection.createTileMatrix(this,u,n)}calculateDistanceTileData(n){const u=n.key,g=this._distanceTileDataCache;if(g[u])return g[u];const x=n.canonical,w=1/this.height,S=this.cameraWorldSize,L=S/this.zoomScale(x.z),P=(x.x+Math.pow(2,x.z)*n.wrap)*L,V=x.y*L,Y=this.point;Y.x*=S/this.worldSize,Y.y*=S/this.worldSize;const J=this.angle,Z=Math.sin(-J),te=-Math.cos(-J);return g[u]={bearing:[Z,te],center:[(Y.x-P)*w,(Y.y-V)*w],scale:L/r.aj*w},g[u]}calculateFogTileMatrix(n){const u=n.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return r.az(x,this.worldToFogMatrix,x),g[u]=new Float32Array(x),g[u]}calculateProjMatrix(n,u=!1,g=!1){const x=n.key;let w;if(w=g?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,w[x])return w[x];const S=this.calculatePosMatrix(n,this.worldSize);let L;return L=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,r.az(S,L,S),w[x]=new Float32Array(S),w[x]}calculatePixelsToTileUnitsMatrix(n){const u=n.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const x=r.cz(n,this);return g[u]=x,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,u=r.bn([],[n,n,n]);return r.az(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const u=r.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=this._camera.forward(),w=r.c6(1,this._center.lat);g[2]/=w,x[2]/=w,r.au(x,x);const S=n.raycast(g,x,n.exaggeration());if(S){const L=r.bE([],g,x,S),P=new r.ac(L[0],L[1],r.c6(L[2],r.aY(L[1]))),V=(P.z+r.ae([P.x-g[0],P.y-g[1],P.z-g[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const u=this._elevation,g=r.c6(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),w=u.getAtPointOrZero(new r.ac(...x)),S=this.pixelsPerMeter/this.worldSize*w,L=this._minimumHeightOverTerrain(),P=x[2]-S;if(P<=L)if(P<0||n){const V=this.locationCoordinate(this._center,this._centerAltitude),Y=[x[0],x[1],V.z-x[2]],J=r.ae(Y);Y[2]-=(L-P)/this._pixelsPerMercatorPixel;const Z=r.ae(Y);if(Z===0)return;r.bY(Y,Y,J/Z*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],V.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const Z=this.center;return Z.lat=r.ay(Z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(Z.lng=r.ay(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:x}=this.point;let w=0,S=g,L=x;const P=this.width/2,V=this.height/2,Y=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(x-V<Y&&(L=Y+V),x+V>J&&(L=J-V),J-Y<this.height&&(w=Math.max(w,this.height/(J-Y)),L=(J+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,de=this.worldSize/2-(Z+te)/2;S=(g+de+this.worldSize)%this.worldSize-de,S-P<Z&&(S=Z+P),S+P>te&&(S=te-P),te-Z<this.width&&(w=Math.max(w,this.width/(te-Z)),S=(te+Z)/2)}S===g&&L===x||this._allowWorldUnderZoom||(this.center=this.unproject(new r.P(S,L))),w&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,u=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.c6(1,this.center.lat)/r.c6(1,r.cP));const x=r.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?g:1,S=this._camera.getWorldToCamera(this.worldSize,w);let L;const P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(P[8]=2*-n.x/this.width,P[9]=2*n.y/this.height,this.isOrthographic){let ht=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ft=ht*this.aspect,Rt=-ft,Ot=-ht;ft-=n.x,Rt-=n.x,ht+=n.y,Ot+=n.y,L=this._camera.getCameraToClipOrthographic(Rt,ft,Ot,ht,this._nearZ,this._farZ),((ti,ri,vi,Pt)=>{for(let Qt=0;Qt<16;Qt++)ti[Qt]=r.ai(ri[Qt],vi[Qt],Pt)})(L,L,P,r.cN(this.pitch>=Io?1:this.pitch/Io))}else L=P;const V=r.cB([],P,S);let Y=r.cB([],L,S);if(this.projection.isReprojectedInTileSpace){const ht=this.locationCoordinate(this.center),ft=r.bx([]);r.bo(ft,ft,[ht.x*this.worldSize,ht.y*this.worldSize,0]),r.az(ft,ft,r.cC(this)),r.bo(ft,ft,[-ht.x*this.worldSize,-ht.y*this.worldSize,0]),r.az(Y,Y,ft),r.az(V,V,ft),this.inverseAdjustmentMatrix=r.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.cE([],Y,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=Y,this.invProjMatrix=r.bi(new Float64Array(16),this.projMatrix),u){const ht=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ht[8]=2*-n.x/this.width,ht[9]=2*n.y/this.height,this.expandedFarZProjMatrix=r.cB([],ht,S)}else this.expandedFarZProjMatrix=this.projMatrix;const J=r.bi([],L);this.frustumCorners=r.cF.fromInvProjectionMatrix(J,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const Z=new Float32Array(16);r.bx(Z),r.cE(Z,Z,[1,-1,1]),r.cG(Z,Z,this._pitch),r.by(Z,Z,this.angle);const te=r.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.bw(te);const de=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-n.x/this.width,te[9]=2*(n.y+de)/this.height,this.skyboxMatrix=r.az(Z,te,Z);const he=this.point,ge=he.x,_e=he.y,Te=this.width%2/2,je=this.height%2/2,We=Math.cos(this.angle),ut=Math.sin(this.angle),at=ge-Math.round(ge)+We*Te+ut*je,nt=_e-Math.round(_e)+We*je+ut*Te,qe=new Float64Array(Y);if(r.bo(qe,qe,[at>.5?at-1:at,nt>.5?nt-1:nt,0]),this.alignedProjMatrix=qe,Y=r.bz(),r.cE(Y,Y,[this.width/2,-this.height/2,1]),r.bo(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=r.bz(),r.cE(Y,Y,[1,-1,1]),r.bo(Y,Y,[-1,-1,0]),r.cE(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=r.az(new Float64Array(16),this.labelPlaneMatrix,V),this._calcFogMatrices(),this._distanceTileDataCache={},Y=r.bi(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.cH(this);const ht=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ad(ht,ht,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,w=[n,n,u];r.bY(w,w,x),r.bY(g,g,-1),r.cI(g,g,w);const S=r.bz();r.bo(S,S,g),r.cE(S,S,w),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,u,x)}_computeCameraPosition(n){const u=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-n/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*w,x.y/this.worldSize-g[1]*w,n/this.worldSize*this._centerAltitude-g[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=n[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(w=Math.min((u-g)/x,1)),this._camera.position=r.bE([],this._camera.position,n,w),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),w=r.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.al(this._maxPitch)),L=Math.max((n[2]-w)/Math.cos(g),S),P=this._zoomFromMercatorZ(L);r.bE(n,n,u,L),this._pitch=r.ay(g,r.al(this.minPitch),r.al(this.maxPitch)),this.angle=r.bX(x,-Math.PI,Math.PI),this._setZoom(r.ay(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.ac(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,n)*this.tileSize))}zoomFromMercatorZAdjusted(n){let u=0,g=r.cx,x=0,w=1/0;for(;g-u>1e-6&&g>u;){const S=u+.5*(g-u),L=this.tileSize*Math.pow(2,S),P=this.getCameraToCenterDistance(this.projection,S,L),V=this.scaleZoom(P/(Math.max(0,n)*this.tileSize)),Y=Math.abs(S-V);Y<w&&(w=Y,x=S),S<V?u=S:g=S}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,u){const g=Math.min(n.x,u.x),x=Math.max(n.x,u.x),w=Math.min(n.y,u.y),S=Math.max(n.y,u.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new r.P(g,w),new r.P(x,S),new r.P(g,S),new r.P(x,w)],P=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const Y of L){const J=this.pointRayIntersection(Y);if(J.t<0)return!0;const Z=this.rayIntersectionCoordinate(J);if(Z.x<P||Z.y<0||Z.x>V||Z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(n,u){const g=r.ae(r.at([],this._camera.position,n)),x=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([u,g,x],w){const S=[u,g,x,1];r.aA(S,S,w);const L=S[3]=Math.max(S[3],1e-6);return S[0]/=L,S[1]/=L,S[2]/=L,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,n))}}getCameraToCenterDistance(n,u=this.zoom,g=this.worldSize){const x=r.cA(n,u,this.width,this.height,1024),w=n.pixelSpaceConversion(this.center.lat,g,x);let S=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(S=r.ai(1,S,r.cN(this.pitch>=Io?1:this.pitch/Io))),S}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.az(n,n,this.globeMatrix),n}getFrustum(n){return r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const cl=(p,n)=>{if(n>0&&p.terrain&&r.w("Cutoff is currently disabled on terrain"),n<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=p.transform,g=Math.max(Math.abs(u._zoom-(p.minCutoffZoom-1)),1),x=u.isLODDisabled(!1)?r.af(60,45,u.pitch):r.af(30,15,u.pitch),w=u._farZ-u._nearZ,S=n*u.height,L=((1-(P=x))*u.cameraToCenterDistance+P*(u._farZ+S))*g;var P;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(L-u._nearZ)/w,(L-S-u._nearZ)/w]}}},qo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class _u{constructor(n,u){this.aabb=n,this.lastCascade=u}}class jo{add(n,u){const g=this.receivers[n.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],u.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],u.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],u.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],u.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],u.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],u.max[2])):this.receivers[n.key]=new _u(u,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,u,g){const x=r.cW.fromPoints(n.points);let w=0;for(const S in this.receivers){const L=this.receivers[S];if(!L||!x.intersectsAabb(L.aabb))continue;L.aabb.min=x.closestPoint(L.aabb.min),L.aabb.max=x.closestPoint(L.aabb.max);const P=L.aabb.getCorners();for(let V=0;V<g.length;V++){let Y=!0;for(const J of P){const Z=[J[0]*u,J[1]*u,J[2]];if(r.ad(Z,Z,g[V].matrix),Z[0]<-1||Z[0]>1||Z[1]<-1||Z[1]>1){Y=!1;break}}if(L.lastCascade=V,w=Math.max(w,V),Y)break}}return w+1}}class zl{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new jo,this._depthMode=new ji(n.context.gl.LEQUAL,ji.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),n.tp.registerParameter(qo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(qo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(qo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,u){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const x=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((de,he)=>{const ge=g.style._mergedLayers[he];return de+(ge.hasShadowPass()&&!ge.isHidden(n.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=g.context,S=qo.shadowMapResolution,L=qo.shadowMapResolution;if(this._cascades.length===0||qo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let de=0;de<qo.cascadeCount;++de){const he=g._shadowMapDebug,ge=w.gl,_e=w.createFramebuffer(S,L,he,"texture"),Te=new r.T(w,{width:S,height:L,data:null},ge.DEPTH_COMPONENT16);if(_e.depthAttachment.set(Te.texture),he){const je=new r.T(w,{width:S,height:L,data:null},ge.RGBA8);_e.colorAttachment.set(je.texture)}this._cascades.push({framebuffer:_e,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.cn,scale:0})}}this.shadowDirection=xo(u);let P=0;if(n.elevation){const de=n.elevation,he=[1e4,-1e4];de.visibleDemTiles.filter(ge=>ge.dem).forEach(ge=>{const _e=ge.dem.tree;he[0]=Math.min(he[0],_e.minimums[0]),he[1]=Math.max(he[1],_e.maximums[0])}),he[0]!==1e4&&(P=(he[1]-he[0])*de.exaggeration())}const V=1.5*n.cameraToCenterDistance,Y=3*V,J=new Float64Array(16);for(let de=0;de<this._cascades.length;++de){const he=this._cascades[de];let ge=n.height/50,_e=1;qo.cascadeCount===1?_e=Y:de===0?_e=V:(ge=V,_e=Y);const[Te,je]=Nl(n,this.shadowDirection,ge,_e,qo.shadowMapResolution,P);he.scale=n.scale,he.matrix=Te,he.boundingSphereRadius=je,r.bi(J,he.matrix),he.frustum=r.cn.fromInvProjectionMatrix(J,1,0,!0),he.far=_e}const Z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Z].far,this._cascades[Z].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/qo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=qo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ko.ShadowMap0,this._uniformValues.u_shadowmap_1=Ko.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const te=g.transform.elevation;for(const de of this._groundShadowTiles){let he={min:0,max:0};if(te){const ge=te.getMinMaxForTile(de);ge&&(he=ge)}this.addShadowReceiver(de.toUnwrapped(),he.min,he.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,u){if(!this.enabled)return;const g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,qo.shadowMapResolution,qo.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){g.currentShadowCascade=w,x.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),x.clear({color:r.am.white,depth:1});for(const S of n.order){const L=n._mergedLayers[S];if(!L.hasShadowPass()||L.isHidden(g.transform.zoom))continue;const P=n.getLayerSourceCache(L),V=P?u[P.id]:void 0;(L.type==="model"||V&&V.length)&&g.renderLayer(g,P,L,V)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,u=n.style,g=n.context,x=g.gl,w=u.directionalLight,S=u.ambientLight;if(!w||!S)return;const L=[],P=cl(n,n.longestCutoffRange);P.shouldRenderCutoff&&L.push("RENDER_CUTOFF"),L.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&L.push("NORMAL_OFFSET");const V=oa(u,w,S),Y=new ji(x.LEQUAL,ji.ReadOnly,n.depthRangeFor3D),J=new Pr({func:x.EQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.KEEP);for(const Z of this._groundShadowTiles){const te=Z.toUnwrapped(),de=n.isTileAffectedByFog(Z),he=n.getOrCreateProgram("groundShadow",{defines:L,overrideFog:de});this.setupShadows(te,he),n.uploadCommonUniforms(g,he,te,null,P);const ge={u_matrix:n.transform.calculateProjMatrix(te),u_ground_shadow_factor:V};he.draw(n,x.TRIANGLES,Y,J,Wr.multiply,wr.disabled,ge,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,null,n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Wr.unblended:Wr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const u=this.painter.transform,g=u.calculatePosMatrix(n,u.worldSize);return r.az(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(n){return r.az(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,u,g,x=0){if(!this.enabled)return;const w=this.painter.transform,S=this.painter.context,L=S.gl,P=this._uniformValues,V=new Float64Array(16),Y=w.calculatePosMatrix(n,w.worldSize);for(let J=0;J<this._cascades.length;J++)r.az(V,this._cascades[J].matrix,Y),P[J===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(V),S.activeTexture.set(L.TEXTURE0+Ko.ShadowMap0+J),this._cascades[J].texture.bindExtraParam(L.LINEAR,L.LINEAR,L.CLAMP_TO_EDGE,L.CLAMP_TO_EDGE,L.GREATER);if(this.useNormalOffset=!!g,this.useNormalOffset){const J=r.cU(n.canonical),Z=2/w.tileSize*r.aj/qo.shadowMapResolution,te=Z*this._cascades[0].boundingSphereRadius,de=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,he=(g==="vector-tile"?1:3)/Math.pow(2,x-n.canonical.z-(1-w.zoom+Math.floor(w.zoom)));P.u_shadow_normal_offset=[J,te*he,de*he],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(S,P)}setupShadowsFromMatrix(n,u,g=!1){if(!this.enabled)return;const x=this.painter.context,w=x.gl,S=this._uniformValues,L=new Float64Array(16);for(let P=0;P<qo.cascadeCount;P++)r.az(L,this._cascades[P].matrix,n),S[P===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),x.activeTexture.set(w.TEXTURE0+Ko.ShadowMap0+P),this._cascades[P].texture.bindExtraParam(w.LINEAR,w.LINEAR,w.CLAMP_TO_EDGE,w.CLAMP_TO_EDGE,w.GREATER);if(this.useNormalOffset=g,g){const P=qo.normalOffset;S.u_shadow_normal_offset=[1,P,P],S.u_shadow_bias=[6e-5,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(x,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,u,g,x){if(x[2]>=0)return{};const w=function(P,V,Y){const J=Y/(1<<P.canonical.z);return new r.cW([P.canonical.x*J+P.wrap*Y,P.canonical.y*J+P.wrap*Y,0],[(P.canonical.x+1)*J+P.wrap*Y,(P.canonical.y+1)*J+P.wrap*Y,V])}(n,u,g).getCorners(),S=u/-x[2];x[0]<0?(r.cV(w[0],w[0],[x[0]*S,0,0]),r.cV(w[3],w[3],[x[0]*S,0,0])):x[0]>0&&(r.cV(w[1],w[1],[x[0]*S,0,0]),r.cV(w[2],w[2],[x[0]*S,0,0])),x[1]<0?(r.cV(w[0],w[0],[0,x[1]*S,0]),r.cV(w[1],w[1],[0,x[1]*S,0])):x[1]>0&&(r.cV(w[2],w[2],[0,x[1]*S,0]),r.cV(w[3],w[3],[0,x[1]*S,0]));const L={};return L.vertices=w,L.planes=[Fa(w[1],w[0],w[4]),Fa(w[2],w[1],w[5]),Fa(w[3],w[2],w[6]),Fa(w[0],w[3],w[7])],L}addShadowReceiver(n,u,g){this._receivers.add(n,r.cW.fromTileIdAndHeight(n,u,g))}getMaxCascadeForTile(n){const u=this._receivers.get(n);return u&&u.lastCascade?u.lastCascade:0}}function Fa(p,n,u){const g=r.at([],u,n),x=r.at([],p,n),w=r.bF([],g,x),S=r.ae(w);return S===0?[0,0,1,0]:(r.bY(w,w,1/S),[w[0],w[1],w[2],-r.bG(w,n)])}function xo(p){const n=p.properties.get("direction"),u=r.cR(n.x,n.y,n.z);u[2]=r.ay(u[2],0,75);const g=r.cT([u[0],u[1],u[2]]);return r.cS(g.x,g.y,g.z)}function oa(p,n,u){const g=n.properties.get("color-use-theme")==="none",x=n.properties.get("color"),w=n.properties.get("intensity"),S=n.properties.get("direction"),L=[S.x,S.y,S.z],P=u.properties.get("color-use-theme")==="none",V=u.properties.get("color"),Y=u.properties.get("intensity"),J=Math.max(r.bG([0,0,1],L),0),Z=[0,0,0];r.bY(Z,V.toPremultipliedRenderColor(P?null:p.getLut(n.scope)).toArray01Linear().slice(0,3),Y);const te=[0,0,0];return r.bY(te,x.toPremultipliedRenderColor(g?null:p.getLut(u.scope)).toArray01Linear().slice(0,3),J*w),r.cY([Z[0]>0?Z[0]/(Z[0]+te[0]):0,Z[1]>0?Z[1]/(Z[1]+te[1]):0,Z[2]>0?Z[2]/(Z[2]+te[2]):0])}function Nl(p,n,u,g,x,w){const S=p.zoom,L=p.scale,P=p.worldSize,V=1/P,Y=p.aspect,J=Math.sqrt(1+Y*Y)*Math.tan(.5*p.fovX),Z=J*J,te=g-u,de=g+u;let he,ge;Z>te/de?(he=g,ge=g*J):(he=.5*de*(1+Z),ge=.5*Math.sqrt(te*te+2*(g*g+u*u)*Z+de*de*Z*Z));const _e=p.projection.pixelsPerMeter(p.center.lat,P),Te=p._camera.getCameraToWorldMercator(),je=[0,0,-he*V];r.ad(je,je,Te);let We=ge*V;const ut=p._edgeInsets;if(!(ut.left===0&&ut.top===0&&ut.right===0&&ut.bottom===0||ut.left===ut.right&&ut.top===ut.bottom)){const gi=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?_e:1),Li=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,u,g);Li[8]=2*-p.centerOffset.x/p.width,Li[9]=2*p.centerOffset.y/p.height;const ai=new Float64Array(16);r.cB(ai,Li,gi);const Mi=new Float64Array(16);r.bi(Mi,ai);const ir=r.cn.fromInvProjectionMatrix(Mi,P,S,!0);for(const tr of ir.points){const Ki=((at=tr)[0]/=L,at[1]/=L,at[2]=r.c6(at[2],p._center.lat),at);We=Math.max(We,r.bZ(r.cX([],je,Ki)))}}var at;We*=x/(x-1);const nt=Math.acos(n[2]),qe=Math.atan2(-n[0],-n[1]),ht=new is;ht.position=je,ht.setPitchBearing(nt,qe);const ft=ht.getWorldToCamera(P,_e),Rt=We*P,Ot=Math.min(p._mercatorZfromZoom(17)*P*-2,-2*Rt),ti=ht.getCameraToClipOrthographic(-Rt,Rt,-Rt,Rt,Ot,(Rt+w*_e)/n[2]),ri=new Float64Array(16);r.az(ri,ti,ft);const vi=r.cS(Math.floor(1e6*je[0])/1e6*P,Math.floor(1e6*je[1])/1e6*P,0),Pt=.5*x,Qt=[0,0,0];r.ad(Qt,vi,ri),r.bY(Qt,Qt,Pt);const Ct=[Math.floor(Qt[0]),Math.floor(Qt[1]),Math.floor(Qt[2])],oi=[0,0,0];r.at(oi,Qt,Ct),r.bY(oi,oi,-1/Pt);const zt=new Float64Array(16);return r.bx(zt),r.bo(zt,zt,oi),r.az(ri,zt,ri),[ri,Rt]}class Ja extends r.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(n,u){return r.aS(this.requestManager.transformRequest(u,r.R.Model).url).then(g=>{if(!g)return;const x=r.aT(g),w=new r.aU(n,void 0,void 0,x);return w.computeBoundsAndApplyParent(),w}).catch(g=>{if(g&&g.status===404)return null;this.fire(new r.z(new Error(`Could not load model ${n} from ${u}: ${g.message}`)))})}load(n,u,g={forceReload:!1}){this.models[u]||(this.models[u]={});const x=Object.keys(n),w=[],S=[];for(const L of x){const P=n[L];this.hasURLBeenRequested(P)&&!g.forceReload||(this.modelByURL[P]={modelId:L,scope:u},w.push(this.loadModel(L,P)),S.push(L)),this.models[u][L]||(this.models[u][L]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+S.length,Promise.allSettled(w).then(L=>{for(let P=0;P<L.length;P++){const{status:V}=L[P];if(V==="rejected")continue;const{value:Y}=L[P];this.models[u][S[P]]||(this.models[u][S[P]]={model:null,numReferences:1}),this.models[u][S[P]].model=Y}this.numModelsLoading[u]-=S.length,this.fire(new r.A("data",{dataType:"style"}))}).catch(L=>{this.fire(new r.z(new Error(`Could not load models: ${L.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,u,g={exactIdMatch:!1}){return!!(g.exactIdMatch?this.getModel(n,u):this.getModelByURL(this.modelUris[u][n]))}getModel(n,u){return this.models[u]||(this.models[u]={}),this.models[u][n]?this.models[u][n].model:void 0}getModelByURL(n){if(!n)return null;const u=this.modelByURL[n];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(n,u){return this.models[u]&&this.models[u][n]!==void 0}getModelURIs(n){return this.modelUris[n]||{}}addModel(n,u,g){this.models[g]||(this.models[g]={}),this.modelUris[g]||(this.modelUris[g]={});const x=this.requestManager.normalizeModelURL(u);if((this.hasModel(n,g,{exactIdMatch:!0})||this.hasModelBeenAdded(n,g))&&this.modelUris[g][n]===x)this.models[g][n].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:w,modelId:S}=this.modelByURL[x];this.models[w][S].numReferences++}else this.modelUris[g][n]=x,this.load({[n]:this.modelUris[g][n]},g)}addModelURLs(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g=this.modelUris[u];for(const x in n)g[x]=this.requestManager.normalizeModelURL(n[x])}reloadModels(n){this.load(this.modelUris[n],n,{forceReload:!0})}addModelsFromBucket(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const g={};for(const x of n)this.hasModel(x,u,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[u][x].numReferences++:this.modelUris[u][x]&&!this.hasURLBeenRequested(x)?g[x]=this.modelUris[u][x]:!this.hasURLBeenRequested(x)&&r.cZ(x,!1)&&(this.modelUris[u][x]=this.requestManager.normalizeModelURL(x),g[x]=this.modelUris[u][x]);this.load(g,u)}hasURLBeenRequested(n){return this.modelByURL[n]!==void 0}removeModel(n,u,g=!1){if(this.models[u]&&this.models[u][n]&&(this.models[u][n].numReferences--,this.models[u][n].numReferences===0)){const x=this.modelUris[u][n];g||delete this.modelUris[u][n],delete this.modelByURL[x];const w=this.models[u][n].model;if(!w)return;delete this.models[u][n],w.destroy()}}destroy(){for(const n of Object.keys(this.models))for(const u of Object.keys(this.models[n])){const g=this.models[n][u].model;delete this.models[n][u],g&&g.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,u){this.models[u]||(this.models[u]={});for(const g in this.models[u])this.models[u][g].model&&this.models[u][g].model.upload(n.context)}}const pa=new r.a7({data:new r.a8(r.a5.colorTheme.data)}),Ec={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function za(p){return p=p||{},Object.assign(p,Ec)}class jl extends r.E{constructor(n){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._floorplanStates={},r.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=n,this._checkFloorplanVisible(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(n=>{n.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=n.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=n.stylesheet.indoor.buildingFeaturesetId,this._scope=n.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:n=>(n.feature&&n.feature.properties.floorplan&&this.selectFloorplan(n.feature.properties.floorplan),!0)}),this._checkFloorplanVisible()}_onMove(){this._checkFloorplanVisible()}_checkFloorplanVisible(){if(!this._queryFeatureSetId||!this._map.isStyleLoaded())return;const n=()=>{this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.A("floorplangone"))};if(this._map.transform.zoom<13)return void n();const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=this._map.transform.width,x=this._map.transform.height,w=g*(2/3),S=x*(2/3),L=.5*(g-w),P=.5*(x-S),V=[new r.P(L,P),new r.P(L+w,P+S)],Y=this._map.queryRenderedFeatures(V,u);Y.length>0?this._selectedFloorplan&&Y[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=Y[0],this._floorplanSelected()):n()}_floorplanSelected(){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._floorplanStates[this._indoorData.id]=this._floorplanStates[this._indoorData.id]||{},this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[this._indoorData.id]]);const n=this._floorplanStates[this._indoorData.id].selectedBuilding,u=n?this._indoorData.buildings.find(L=>L.id===n):this._indoorData.buildings.length>0?this._indoorData.buildings[0]:null,g=this._floorplanStates[this._indoorData.id].selectedLevel,x=this._indoorData.levels.find(L=>L.id===g),w=this._indoorData.levels.find(L=>!(!u||!u.levels)&&Number(L.levelOrder)===0&&u.levels.includes(L.id)),S=x?x.id:w?w.id:void 0;this.fire(new r.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),u&&this._buildingSelected(u,!1),S&&this._levelSelected(S)}_buildingSelected(n,u){if(!n||!n.id)return void console.warn("IndoorManager: Building or building id is undefined");u&&n.extent&&this._map.fitBounds(n.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=n?n.id:void 0;const g=this._indoorData.levels.filter(x=>n.levels.includes(x.id));this.fire(new r.A("buildingselected",{buildingId:n.id,levels:g}))}_levelSelected(n){const u=this._indoorData.levels.find(g=>g.id===n);u?(this._updateLevels(u,!0),this.fire(new r.A("levelselected",{levelId:u.id}))):console.warn(`IndoorManager: Level with ID ${n} not found in the current floorplan.`)}_updateLevels(n,u){if(!n||!n.id)throw new Error("IndoorManager: Selected level or level ID is undefined");function g(V){const Y=V.indexOf("/floor/");if(Y===-1)return V;const J=Y+7,Z=V.indexOf("/",J);return Z===-1?V.slice(J):V.slice(J,Z)}this._floorplanStates[this._indoorData.id].selectedLevel=n.id;const x=[],w={},S={},L={},P={};for(const V of this._indoorData.levels){if(x.push(V.id),w[V.id]=V.levelOrder>=0?3*Math.abs(V.levelOrder+1):3*Math.abs(V.levelOrder),S[V.id]=V.levelOrder>=0?3*V.levelOrder:0,this.mergeFloors){const Y=g(n.id),J=g(V.id);L[V.id]=J===Y?"true":"false"}else L[V.id]=V.id===n.id?"true":"false";P[V.id]=V.levelOrder<n.levelOrder?"true":"false"}this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",L]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",n.levelOrder<0)}selectFloorplan(n){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(g,u);if(x.length>0){for(const w of x)if(JSON.parse(w.properties["indoor-data"]).id===n){this._selectedFloorplan=w,this._floorplanSelected();break}}}selectBuilding(n){const u=this._indoorData.buildings.find(g=>g.id===n);this._buildingSelected(u,!0)}selectLevel(n){this._levelSelected(n)}}function Sl(p){if(!p.metadata||!p.metadata.content_area)return;const n=r.q.devicePixelRatio,{left:u,top:g,width:x,height:w}=p.metadata.content_area,S=u*n,L=g*n;return[S,L,S+x*n,L+w*n]}function Wc(p){if(p)return p.map(([n,u])=>[n*r.q.devicePixelRatio,u*r.q.devicePixelRatio])}class $o{constructor(n,u,g){this.id=n,this.scope=u,this.sourceCache=g,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(n){this.missingRequests.has(n.name)||this.pendingRequests.has(n.name)||this.pendingRequests.add(n.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const n=new Map;if(!this.sourceCache.loaded())return n;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return n;const g=this.sourceCache.getSource();if(!(g instanceof _c))return n;const x=u.map(S=>this.sourceCache.getTile(S)),w=g.getImages(x,Array.from(this.pendingRequests));for(const[S,L]of w)n.set(r.I.from({name:S,iconsetId:this.id}),L),this.pendingRequests.delete(S);for(const S of this.pendingRequests)this.missingRequests.add(S);return this.pendingRequests.clear(),n}}const El=(p,n)=>Ye(p,n&&n.filter(u=>u.identifier!=="source.canvas")),La=r.aF(pn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Hl=r.aF(pn,["setCenter","setZoom","setBearing","setPitch"]),xu=new Set(["background","sky","slot","custom"]),el={version:8,layers:[],sources:{}},ju={duration:300,delay:0};class Ho extends r.E{constructor(n,u={}){super(),this.map=n,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=r.h({},ju),this._buildingIndex=new Tn(this),this.crossTileSymbolIndex=new Js,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Ve,this.dispatcher=u.dispatcher?u.dispatcher:new r.D(r.c$(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new Ft(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new r.d0(n._requestManager,u.localFontFamily?r.d1.all:u.localIdeographFontFamily?r.d1.ideographs:r.d1.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new Ja(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",r.d2());const g=this;this._rtlTextPluginCallback=Ho.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(w,S)=>{if(r.d3(w),S&&S.every(L=>L))for(const L in g._sourceCaches){const P=g._sourceCaches[L],V=P.getSource().type;V!=="vector"&&V!=="geojson"||P.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const w=this.getOwnSource(x.sourceId);if(w&&w.vectorLayerIds)for(const S in this._layers){const L=this._layers[S];L.source===w.id&&this._validateLayer(L)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(r.j(n))return n;const u=r.d4(n);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${r.d5(JSON.stringify(n))}`}_diffStyle(n,u,g){this.globalId=this._getGlobalId(n);const x=(w,S)=>{try{S(null,this.setState(w,g))}catch(L){S(L,!1)}};if(typeof n=="string"){const w=this.map._requestManager.normalizeStyleURL(n),S=this.map._requestManager.transformRequest(w,r.R.Style);r.n(S,(L,P)=>{L?this.fire(new r.z(L)):P&&x(P,u)})}else typeof n=="object"&&x(n,u)}loadURL(n,u={}){this.fire(new r.A("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!r.j(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,u.accessToken),this.resolvedImports.add(n);const x=this.importsCache.get(n);if(x)return this._load(x,g);const w=this.map._requestManager.transformRequest(n,r.R.Style);this._request=r.n(w,(S,L)=>{if(this._request=null,S)this.fire(new r.z(S));else if(L)return this.importsCache.set(n,L),this._load(L,g)})}loadJSON(n,u={}){this.fire(new r.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=r.q.frame(()=>{this._request=null,this._load(n,u.validate!==!1)})}loadEmpty(){this.fire(new r.A("dataloading",{dataType:"style"})),this._load(el,!1)}_loadImports(n,u,g){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const w of n){const S=this._createFragmentStyle(w),L=new Promise(Y=>{S.once("style.import.load",Y),S.once("error",Y)}).then(()=>this.mergeAll());if(x.push(L),this.resolvedImports.has(w.url)){S.loadEmpty();continue}const P=w.data||this.importsCache.get(w.url);P?(S.loadJSON(P,{validate:u}),this._isInternalStyle(P)&&(S.globalId=null)):w.url?S.loadURL(w.url,{validate:u}):S.loadEmpty();const V={style:S,id:w.id,config:w.config};if(g){const Y=this.fragments.findIndex(({id:J})=>J===g);this.fragments=this.fragments.slice(0,Y).concat(V).concat(this.fragments.slice(Y))}else this.fragments.push(V)}return Promise.allSettled(x)}getImportGlobalIds(n=this,u=new Set){for(const g of n.fragments)g.style.globalId&&u.add(g.style.globalId),this.getImportGlobalIds(g.style,u);return[...u.values()]}_createFragmentStyle(n){const u=this.scope?r.C(n.id,this.scope):n.id;let g;const x=this._initialConfig&&this._initialConfig[u];(n.config||x)&&(g=r.h({},n.config,x));const w=new Ho(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,u){const g=n.indoor?za(n.schema):n.schema;if(this._isInternalStyle(n)){const S=r.h({},el,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(S,u)}if(this.updateConfig(this._config,g),u&&El(this,ro(n)))return;this._loaded=!0,this.stylesheet=r.d6(n);const x=()=>{for(const V in n.sources)this.addSource(V,n.sources[V],{validate:!1,isInitialLoad:!0});if(n.iconsets)for(const V in n.iconsets)this.addIconset(V,n.iconsets[V]);n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(n.glyphs);const S=hh(this.stylesheet.layers);if(this._order=S.map(V=>V.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const V=this.stylesheet.lights[0];this.light=new Dt(V.properties,V.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Dt(this.stylesheet.light)),this._layers={};for(const V of S){const Y=r.db(V,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const J=this.getOwnLayerSourceCache(Y),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();J&&Y.canCastShadows()&&Z&&(J.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const L=this.stylesheet.terrain;L&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(L,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.A("data",{dataType:"style"}));const P=this.isRootStyle();n.imports?this._loadImports(n.imports,u).then(()=>{this._reloadImports(),this.fire(new r.A(P?"style.load":"style.import.load"))}).catch(V=>{this.fire(new r.z(new Error("Failed to load imports",V))),this.fire(new r.A(P?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.A(P?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const S=this._evaluateColorThemeData(w);this._loadColorTheme(S).then(()=>{x()}).catch(L=>{r.w(`Couldn't load color theme from the stylesheet: ${L}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,u,g,x,w,S,L,P,V,Y;const J={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Z=>{if(Z.stylesheet){if(Z.light!=null&&(n=Z.light),Z.stylesheet.lights)for(const te of Z.stylesheet.lights)te.type==="ambient"&&Z.ambientLight!=null&&(u=Z.ambientLight),te.type==="directional"&&Z.directionalLight!=null&&(g=Z.directionalLight);x=this._prioritizeTerrain(x,Z.terrain,Z.stylesheet.terrain),Z.stylesheet.fog&&Z.fog!=null&&(w=Z.fog),Z.stylesheet.snow&&Z.snow!=null&&(S=Z.snow),Z.stylesheet.rain&&Z.rain!=null&&(L=Z.rain),Z.stylesheet.camera!=null&&(Y=Z.stylesheet.camera),Z.stylesheet.projection!=null&&(P=Z.stylesheet.projection),Z.stylesheet.transition!=null&&(V=Z.stylesheet.transition),J[Z.scope]=Z._styleColorTheme}}),this.light=n,this.ambientLight=u,this.directionalLight=g,this.fog=w,this.snow=S,this.rain=L,this._styleColorThemeForScope=J,x===null?delete this.terrain:this.terrain=x,this.camera=Y||{"camera-projection":"perspective"},this.projection=P||{name:"mercator"},this.transition=r.h({},ju,V),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const u=g=>{for(const x of g.fragments)u(x.style);n(g)};u(this)}_prioritizeTerrain(n,u,g){const x=n&&n.drapeRenderMode===0;return g===null?u&&u.drapeRenderMode===0?u:x?n:null:u!=null&&(!n||x||u&&u.drapeRenderMode===1)?u:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{n=this._prioritizeTerrain(n,u.terrain,u.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(n=u.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},u={},g={};this.forEachFragmentStyle(x=>{for(const w in x._sourceCaches){const S=r.C(w,x.scope);n[S]=x._sourceCaches[w]}for(const w in x._otherSourceCaches){const S=r.C(w,x.scope);u[S]=x._otherSourceCaches[w]}for(const w in x._symbolSourceCaches){const S=r.C(w,x.scope);g[S]=x._symbolSourceCaches[w]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=g}mergeLayers(){const n={},u=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const S of w._order){const L=w._layers[S];if(L.type==="slot"){const P=r.d7(S);if(n[P])continue;n[P]=[]}L.slot&&n[L.slot]?n[L.slot].push(L):u.push(L)}}),this._mergedOrder=[];const x=(w=[])=>{for(const S of w)if(S.type==="slot"){const L=r.d7(S.id);n[L]&&x(n[L]),this._mergedSlots.push(L)}else{const L=r.C(S.id,S.scope);this._mergedOrder.push(L),g[L]=S,S.is3D(!!this.terrain)&&(this._has3DLayers=!0),S.type==="circle"&&(this._hasCircleLayers=!0),S.type==="symbol"&&(this._hasSymbolLayers=!0),S.type==="clip"&&(this._clipLayerPresent=!0)}};x(u),this._mergedOrder.sort((w,S)=>{const L=g[w],P=g[S];return L.hasInitialOcclusionOpacityProperties?P.is3D(!!this.terrain)?1:0:L.is3D(!!this.terrain)&&P.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=r.h({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?function(u,g,x,w){const S=r.h({},g);for(const P of Object.keys(r.a5.colorTheme))S[P]===void 0&&(S[P]=r.a5.colorTheme[P].default);const L=new r.a6(pa,u,new Map(x));return L.setTransitionOrValue(S,x),L.untransitioned().possiblyEvaluate(new r.aa(0,{worldview:void 0}))}(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,x)=>{const w="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let S=n;S.startsWith(w)||(S=w+S);const L=r.I.from("mapbox-reserved-lut"),P=new Image;P.src=S,P.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},P.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void g();this._styleColorTheme.lutLoading=!1;const{width:V,height:Y,data:J}=r.q.getImageData(P);if(Y>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(V!==Y*Y)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(L)&&this.removeImage(L),this.addImage(L,{data:new r.r({width:V,height:Y},J),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Z=this.imageManager.getImage(L,this.scope);Z?(this._styleColorTheme.lut={image:Z.data,data:n},g()):x(new Error("Missing LUT image."))}})}getLut(n){const u=this._styleColorThemeForScope[n];return u?u.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=function(u,g,x){let w,S,L;const P=r.q.devicePixelRatio>1?"@2x":"";let V=r.n(g.transformRequest(g.normalizeSpriteURL(u,P,".json"),r.R.SpriteJSON),(Z,te)=>{V=null,L||(L=Z,w=te,J())}),Y=r.o(g.transformRequest(g.normalizeSpriteURL(u,P,".png"),r.R.SpriteImage),(Z,te)=>{Y=null,L||(L=Z,S=te,J())});function J(){if(L)x(L);else if(w&&S){const Z=r.q.getImageData(S),te={};for(const de in w){const{width:he,height:ge,x:_e,y:Te,sdf:je,pixelRatio:We,stretchX:ut,stretchY:at,content:nt}=w[de],qe=new r.r({width:he,height:ge});r.r.copy(Z,qe,{x:_e,y:Te},{x:0,y:0},{width:he,height:ge},null),te[de]={data:qe,pixelRatio:We,sdf:je,stretchX:ut,stretchY:at,content:nt,usvg:!1}}x(null,te)}}return{cancel(){V&&(V.cancel(),V=null),Y&&(Y.cancel(),Y=null)}}}(n,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new r.z(u));else if(g){const x=new Map;for(const w in g)x.set(r.I.from(w),g[w]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))})}addIconset(n,u){if(u.type==="sprite")return void this._loadSprite(u.url);const g=this.getOwnSourceCache(u.source);if(!g)return void this.fire(new r.z(new Error(`Source "${u.source}" as specified by iconset "${n}" does not exist and cannot be used as an iconset source`)));const x=g.getSource();if(x.type!=="raster-array")return void this.fire(new r.z(new Error(`Source "${u.source}" as specified by iconset "${n}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const w=new $o(n,this.scope,g);this.imageManager.addImageProvider(w,this.scope)}removeIconset(n){this.imageManager.removeImageProvider(n,this.scope)}_loadIconset(n){if(!r.j(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const u=this.map._spriteFormat==="auto";var g,x;this._spriteRequest=(x=(w,S)=>{if(this._spriteRequest=null,w)u?this._loadSprite(n):this.fire(new r.z(w));else if(S){const L=new Map;for(const P in S)L.set(r.I.from(P),S[P]);this.addImages(L)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))},r.br((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(n),r.R.Iconset),(w,S)=>{if(w)return void x(w);const L={},P=r.c_(new r.bq(S));for(const V of P.icons){const Y={version:1,pixelRatio:r.q.devicePixelRatio,content:Sl(V),stretchX:V.metadata?Wc(V.metadata.stretch_x_areas):void 0,stretchY:V.metadata?Wc(V.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:V};L[V.name]=Y}x(null,L)}))}_validateLayer(n){const u=this.getOwnSource(n.source);if(!u)return;const g=n.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new r.z(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,u)=>{const g=this.fragments[u];return g&&g.style&&(n.data=g.style.serialize()),n})}_serializeSources(){const n={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();n[g.id]||(n[g.id]=g.serialize())}return n}_serializeLayers(n){const u=[];for(const g of n){const x=this._layers[g];x&&x.type!=="custom"&&u.push(x.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const u=this.getOwnLayer(n);if(u)return u;this.fire(new r.z(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const u=this.getOwnSource(n);if(u)return u;this.fire(new r.z(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,u){const g=this.map.painter;if(g)for(let x=n.minzoom||0;x<(n.maxzoom||25.5);x++){const w=n.getProgramIds();if(w)for(const S of w){const L=n.getDefaultProgramParams(S,u.zoom,this._styleColorTheme.lut);L&&(g.style=this,this.fog&&(g._fogVisible=!0,L.overrideFog=!0,g.getOrCreateProgram(S,L)),g._fogVisible=!1,L.overrideFog=!1,g.getOrCreateProgram(S,L),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(L.overrideRtt=!0,g.getOrCreateProgram(S,L)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const u=this.calculateLightsBrightness();n.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),n.worldview!==this._worldview&&(this._worldview=n.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const g=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const L=this._changes.getLayerUpdatesByScope();for(const P in L){const{updatedIds:V,removedIds:Y}=L[P];(V||Y)&&(this._updateWorkerLayers(P,V,Y),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const w={};for(const L in this._mergedSourceCaches){const P=this._mergedSourceCaches[L];w[L]=P.used,P.used=!1,P.tileCoverLift=0}for(const L of this._mergedOrder){const P=this._mergedLayers[L];if(P.recalculate(n,this._availableImages),!P.isHidden(n.zoom)){const V=this.getLayerSourceCache(P);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,P.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(P,n)}):this.precompilePrograms(P,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const S=this.imageManager.getPendingImageProviders();for(const L of S)L.sourceCache.used=!0;for(const L in w){const P=this._mergedSourceCaches[L];w[L]!==P.used&&P.getSource().fire(new r.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),g&&this.fire(new r.A("data",{dataType:"style"}))}updateImageProviders(){const n=this.imageManager.getPendingImageProviders();for(const u of n){const g=u.resolvePendingRequests(),x=this.getFragmentStyle(u.scope);x&&x.addImages(g)}}_updateTilesForChangedImages(){const n={};for(const u in this._mergedSourceCaches){const g=this._mergedSourceCaches[u].getSource().scope;n[g]=n[g]||this._changes.getUpdatedImages(g),n[g].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n[g])}for(const u in n)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(n,u,g){const x=this.getFragmentStyle(n);x&&this.dispatcher.broadcast("updateLayers",{layers:u?x._serializeLayers(u):[],scope:n,removedIds:g||[],options:x.options})}setState(n,u){if(this._checkLoaded(),El(this,ro(n)))return!1;(n=r.d6(n)).layers=hh(n.layers);const g=function(S,L){if(!S)return[{command:pn.setStyle,args:[L]}];let P=[];try{if(!r.bv(S.version,L.version))return[{command:pn.setStyle,args:[L]}];if(r.bv(S.center,L.center)||P.push({command:pn.setCenter,args:[L.center]}),r.bv(S.zoom,L.zoom)||P.push({command:pn.setZoom,args:[L.zoom]}),r.bv(S.bearing,L.bearing)||P.push({command:pn.setBearing,args:[L.bearing]}),r.bv(S.pitch,L.pitch)||P.push({command:pn.setPitch,args:[L.pitch]}),r.bv(S.sprite,L.sprite)||P.push({command:pn.setSprite,args:[L.sprite]}),r.bv(S.glyphs,L.glyphs)||P.push({command:pn.setGlyphs,args:[L.glyphs]}),r.bv(S.imports,L.imports)||function(te=[],de=[],he){de=de||[];const ge=(te=te||[]).map(Qc),_e=de.map(Qc),Te=te.reduce(Bc,{}),je=de.reduce(Bc,{}),We=ge.slice();let ut,at,nt,qe;for(ut=0,at=0;ut<ge.length;ut++)nt=ge[ut],je.hasOwnProperty(nt)?at++:(he.push({command:pn.removeImport,args:[nt]}),We.splice(We.indexOf(nt,at),1));for(ut=0,at=0;ut<_e.length;ut++)nt=_e[_e.length-1-ut],We[We.length-1-ut]!==nt&&(Te.hasOwnProperty(nt)?(he.push({command:pn.removeImport,args:[nt]}),We.splice(We.lastIndexOf(nt,We.length-at),1)):at++,qe=We[We.length-ut],he.push({command:pn.addImport,args:[je[nt],qe]}),We.splice(We.length-ut,0,nt));for(const ht of de){const ft=Te[ht.id];ft&&(delete ft.data,r.bv(ft,ht)||he.push({command:pn.updateImport,args:[ht.id,ht]}))}}(S.imports,L.imports,P),r.bv(S.transition,L.transition)||P.push({command:pn.setTransition,args:[L.transition]}),r.bv(S.light,L.light)||P.push({command:pn.setLight,args:[L.light]}),r.bv(S.fog,L.fog)||P.push({command:pn.setFog,args:[L.fog]}),r.bv(S.snow,L.snow)||P.push({command:pn.setSnow,args:[L.snow]}),r.bv(S.rain,L.rain)||P.push({command:pn.setRain,args:[L.rain]}),r.bv(S.projection,L.projection)||P.push({command:pn.setProjection,args:[L.projection]}),r.bv(S.lights,L.lights)||P.push({command:pn.setLights,args:[L.lights]}),r.bv(S.camera,L.camera)||P.push({command:pn.setCamera,args:[L.camera]}),r.bv(S.iconsets,L.iconsets)||function(te,de,he){let ge;for(ge in de=de||{},te=te||{})te.hasOwnProperty(ge)&&(de.hasOwnProperty(ge)||he.push({command:pn.removeIconset,args:[ge]}));for(ge in de){if(!de.hasOwnProperty(ge))continue;const _e=de[ge];te.hasOwnProperty(ge)?r.bv(te[ge],_e)||(he.push({command:pn.removeIconset,args:[ge]}),he.push({command:pn.addIconset,args:[ge,_e]})):he.push({command:pn.addIconset,args:[ge,_e]})}}(S.iconsets,L.iconsets,P),!r.bv(S["color-theme"],L["color-theme"]))return[{command:pn.setStyle,args:[L]}];const V={},Y=[];(function(te,de,he,ge){let _e;for(_e in de=de||{},te=te||{})te.hasOwnProperty(_e)&&(de.hasOwnProperty(_e)||fu(_e,he,ge));for(_e in de){if(!de.hasOwnProperty(_e))continue;const Te=de[_e];te.hasOwnProperty(_e)?r.bv(te[_e],Te)||(te[_e].type==="geojson"&&Te.type==="geojson"&&bl(te,de,_e)?he.push({command:pn.setGeoJSONSourceData,args:[_e,Te.data]}):Hc(_e,de,he,ge)):dh(_e,de,he)}})(S.sources,L.sources,Y,V);const J=[];S.layers&&S.layers.forEach(te=>{te.source&&V[te.source]?P.push({command:pn.removeLayer,args:[te.id]}):J.push(te)});let Z=S.terrain;Z&&V[Z.source]&&(P.push({command:pn.setTerrain,args:[void 0]}),Z=void 0),P=P.concat(Y),r.bv(Z,L.terrain)||P.push({command:pn.setTerrain,args:[L.terrain]}),function(te,de,he){de=de||[];const ge=(te=te||[]).map(Qc),_e=de.map(Qc),Te=te.reduce(Bc,{}),je=de.reduce(Bc,{}),We=ge.slice(),ut=Object.create(null);let at,nt,qe,ht,ft,Rt,Ot;for(at=0,nt=0;at<ge.length;at++)qe=ge[at],je.hasOwnProperty(qe)?nt++:(he.push({command:pn.removeLayer,args:[qe]}),We.splice(We.indexOf(qe,nt),1));for(at=0,nt=0;at<_e.length;at++)qe=_e[_e.length-1-at],We[We.length-1-at]!==qe&&(Te.hasOwnProperty(qe)?(he.push({command:pn.removeLayer,args:[qe]}),We.splice(We.lastIndexOf(qe,We.length-nt),1)):nt++,Rt=We[We.length-at],he.push({command:pn.addLayer,args:[je[qe],Rt]}),We.splice(We.length-at,0,qe),ut[qe]=!0);for(at=0;at<_e.length;at++)if(qe=_e[at],ht=Te[qe],ft=je[qe],!ut[qe]&&!r.bv(ht,ft))if(r.bv(ht.source,ft.source)&&r.bv(ht["source-layer"],ft["source-layer"])&&r.bv(ht.type,ft.type)){for(Ot in zu(ht.layout,ft.layout,he,qe,null,pn.setLayoutProperty),zu(ht.paint,ft.paint,he,qe,null,pn.setPaintProperty),r.bv(ht.slot,ft.slot)||he.push({command:pn.setSlot,args:[qe,ft.slot]}),r.bv(ht.filter,ft.filter)||he.push({command:pn.setFilter,args:[qe,ft.filter]}),r.bv(ht.minzoom,ft.minzoom)&&r.bv(ht.maxzoom,ft.maxzoom)||he.push({command:pn.setLayerZoomRange,args:[qe,ft.minzoom,ft.maxzoom]}),ht)ht.hasOwnProperty(Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&Ot!=="slot"&&(Ot.indexOf("paint.")===0?zu(ht[Ot],ft[Ot],he,qe,Ot.slice(6),pn.setPaintProperty):r.bv(ht[Ot],ft[Ot])||he.push({command:pn.setLayerProperty,args:[qe,Ot,ft[Ot]]}));for(Ot in ft)ft.hasOwnProperty(Ot)&&!ht.hasOwnProperty(Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&Ot!=="slot"&&(Ot.indexOf("paint.")===0?zu(ht[Ot],ft[Ot],he,qe,Ot.slice(6),pn.setPaintProperty):r.bv(ht[Ot],ft[Ot])||he.push({command:pn.setLayerProperty,args:[qe,Ot,ft[Ot]]}))}else he.push({command:pn.removeLayer,args:[qe]}),Rt=We[We.lastIndexOf(qe)+1],he.push({command:pn.addLayer,args:[ft,Rt]})}(J,L.layers,P)}catch(V){console.warn("Unable to compute style diff:",V),P=[{command:pn.setStyle,args:[L]}]}return P}(this.serialize(),n).filter(S=>!(S.command in Hl));if(g.length===0)return!1;const x=g.filter(S=>!(S.command in La));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);const w=[];return g.forEach(S=>{w.push(this[S.command](...S.args))}),u&&Promise.all(w).then(u).catch(u),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(n){for(const[u,g]of n.entries()){if(this.getImage(u))return this.fire(new r.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,g),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this}addImage(n,u){return this.getImage(n)?this.fire(new r.z(new Error(`An image with the name "${n.name}" already exists.`))):(this.imageManager.addImage(n,this.scope,u),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this)}updateImage(n,u,g=!1){this.imageManager.updateImage(n,this.scope,u),g&&(this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})))}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(n){return this.modelManager.addModelURLs(n,this.scope),this._updateWorkerModels(),this.fire(new r.A("data",{dataType:"style"})),this}addModel(n,u,g={}){return this._checkLoaded(),this._validate(He,`models.${n}`,u,null,g)||(this.modelManager.addModel(n,u,this.scope),this.fire(new r.A("data",{dataType:"style"}))),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,u,g={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Qn,`sources.${n}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=xc(n,u,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const w=S=>{const L=(S?"symbol:":"other:")+x.id,P=r.C(L,this.scope),V=this._sourceCaches[L]=new ko(P,x,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=V,V.onAdd(this.map)};w(!1),u.type!=="vector"&&u.type!=="geojson"||w(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const u=this.getOwnSource(n);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===n)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find(([w,S])=>S.type==="source"&&S.source===n);if(x)return this.fire(new r.z(new Error(`Source "${n}" cannot be removed while iconset "${x[0]}" is using it.`)))}const g=this.getOwnSourceCaches(n);for(const x of g){const w=r.d7(x.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(x.id),x.fire(new r.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,u){this._checkLoaded(),this.getOwnSource(n).setData(u),this._changes.setDirty()}getOwnSource(n){const u=this.getOwnSourceCache(n);return u&&u.getSource()}getOwnSources(){const n=[];for(const u in this._otherSourceCaches){const g=this.getOwnSourceCache(u);g&&n.push(g.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const u in n){const g=n[u]._tiles;for(const x in g){const w=g[x];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const w of n){if(this._validate(yr,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(w),S.updateTransitions(u)}else this.ambientLight=new En(w,Yr||(Yr=new r.a7({color:new r.a8(r.a5.properties_light_ambient.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(w),S.updateTransitions(u)}else this.directionalLight=new En(w,qn||(qn=new r.a7({direction:new r.an(r.a5.properties_light_directional.direction),color:new r.a8(r.a5.properties_light_directional.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_directional.intensity),"cast-shadows":new r.a8(r.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a8(r.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a8(r.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=Object.assign(u,{worldview:this.map.getWorldview()}),x=new r.aa(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,u=this.ambientLight;if(!n||!u)return;const g=Z=>.2126*(Z[0]<=.03928?Z[0]/12.92:Math.pow((Z[0]+.055)/1.055,2.4))+.7152*(Z[1]<=.03928?Z[1]/12.92:Math.pow((Z[1]+.055)/1.055,2.4))+.0722*(Z[2]<=.03928?Z[2]/12.92:Math.pow((Z[2]+.055)/1.055,2.4)),x=n.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),w=n.properties.get("intensity"),S=n.properties.get("direction"),L=1-r.cR(S.x,S.y,S.z)[2]/90,P=g(x)*w*L,V=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),Y=u.properties.get("intensity"),J=g(V)*Y;return Number(((P+J)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(n==null||n===""&&this.isRootStyle())return this;if(r.d8(n)){const u=r.d9(n),g=this.fragments.find(({id:w})=>w===u);if(!g)return;const x=r.d7(n);return g.style.getFragmentStyle(x)}{const u=this.fragments.find(({id:g})=>g===n);return u?u.style:void 0}}setFeaturesetSelectors(n){if(!n)return;const u={},g=(x,w="")=>`${x}::${w}`;this._featuresetSelectors={};for(const x in n){const w=this._featuresetSelectors[x]=[];for(const S of n[x].selectors){if(S.featureNamespace){const P=this.getOwnLayer(S.layer);if(!P){r.w(`Layer is undefined for selector: ${S.layer}`);continue}const V=g(P.source,P.sourceLayer);if(V in u&&u[V]!==S.featureNamespace){r.w(`"featureNamespace ${S.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}u[V]=S.featureNamespace}let L;if(S.properties)for(const P in S.properties){const V=r.X(S.properties[P]);V.result==="success"&&(L=L||{},L[P]=V.value)}w.push({layerId:S.layer,namespace:S.featureNamespace,properties:L,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(n){const u=this.getFragmentStyle(n);if(!u||!u.stylesheet.featuresets)return[];const g=[];for(const x in u.stylesheet.featuresets)g.push({featuresetId:x,importId:u.scope?u.scope:void 0});return g}getFeaturesetLayers(n,u){const g=this.getFragmentStyle(u),x=g.stylesheet.featuresets;if(!x||!x[n])return this.fire(new r.z(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const S of x[n].selectors){const L=g.getOwnLayer(S.layer);L&&w.push(L)}return w}getConfigProperty(n,u){const g=this.getFragmentStyle(n);if(!g)return null;const x=r.C(u,g.scope),w=g.options.get(x),S=w?w.value||w.default:null;return S?S.serialize():null}setConfigProperty(n,u,g){const x=this.getFragmentStyle(n);if(!x)return;const w=x.stylesheet.indoor?za(x.stylesheet.schema):x.stylesheet.schema;if(!w||!w[u])return;const S=r.X(g);if(S.result!=="success")return void El(this,S.value);const L=S.value.expression,P=r.C(u,x.scope),V=x.options.get(P);if(!V)return;let Y;const{minValue:J,maxValue:Z,stepValue:te,type:de,values:he}=w[u],ge=r.X(w[u].default);ge.result==="success"&&(Y=ge.value.expression),Y?(this.options.set(P,Object.assign({},V,{value:L,default:Y,minValue:J,maxValue:Z,stepValue:te,type:de,values:he})),this.updateConfigDependencies(u)):this.fire(new r.z(new Error(`No schema defined for the config option "${u}" in the "${n}" fragment.`)))}getConfig(n){const u=this.getFragmentStyle(n);if(!u)return null;const g=u.stylesheet.schema;if(!g)return null;const x={};for(const w in g){const S=r.C(w,u.scope),L=u.options.get(S),P=L?L.value||L.default:null;x[w]=P?P.serialize():null}return x}setConfig(n,u){const g=this.getFragmentStyle(n);g&&(g.updateConfig(u,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const u=this.getFragmentStyle(n);return u?u.stylesheet.schema:null}setSchema(n,u){const g=this.getFragmentStyle(n);g&&(g.stylesheet.schema=u,g.updateConfig(g._config,u),this.updateConfigDependencies())}updateConfig(n,u){if(this._config=n,n||u)if(u)for(const g in u){let x,w;const S=r.X(u[g].default);if(S.result==="success"&&(x=S.value.expression),n&&n[g]!==void 0){const Z=r.X(n[g]);Z.result==="success"&&(w=Z.value.expression)}const{minValue:L,maxValue:P,stepValue:V,type:Y,values:J}=u[g];if(x){const Z=r.C(g,this.scope);this.options.set(Z,{default:x,value:w,minValue:L,maxValue:P,stepValue:V,type:Y,values:J})}else this.fire(new r.z(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new r.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const u of this._configDependentLayers){const g=this.getLayer(u);if(g){if(n&&!g.configDependencies.has(n))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const g=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(g){const x=u._evaluateColorThemeData(g);(!u._styleColorTheme.lut&&x!==""||u._styleColorTheme.lut&&x!==u._styleColorTheme.lut.data)&&u.setColorTheme(g)}}),this._changes.setDirty()}addLayer(n,u,g={}){this._checkLoaded();const x=n.id;if(this._layers[x])return void this.fire(new r.z(new Error(`Layer with id "${x}" already exists on this map`)));let w;if(n.type==="custom"){if(El(this,r.da(n)))return;w=r.db(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(x,n.source),n=r.d6(n),n=r.h(n,{source:x})),this._validate(dn,`layers.${x}`,n,{arrayIndex:-1},g))return;w=r.db(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:x}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let S=this._order.length;if(u){const Y=this._order.indexOf(u);if(Y===-1)return void this.fire(new r.z(new Error(`Layer with id "${u}" does not exist on this map.`)));w.slot===this._layers[u].slot?S=Y:r.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,x),this._layerOrderChanged=!0,this._layers[x]=w;const L=this.getOwnLayerSourceCache(w),P=!!this.directionalLight&&this.directionalLight.shadowsEnabled();L&&w.canCastShadows()&&P&&(L.castsShadows=!0);const V=this._changes.getRemovedLayer(w);if(V&&w.source&&L&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const Y=r.C(w.source,w.scope);V.type!==w.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),L.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(n,u){this._checkLoaded();const g=this._checkLayer(n);if(!g||n===u)return;const x=this._order.indexOf(n);this._order.splice(x,1);let w=this._order.length;if(u){const S=this._order.indexOf(u);if(S===-1)return void this.fire(new r.z(new Error(`Layer with id "${u}" does not exist on this map.`)));g.slot===this._layers[u].slot?w=S:r.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const u=this._checkLayer(n);if(!u)return;u.setEventedParent(null);const g=this._order.indexOf(n);this._order.splice(g,1),delete this._layers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const x=this.getOwnLayerSourceCache(u);if(x&&x.castsShadows){let w=!1;for(const S in this._layers)if(this._layers[S].source===u.source&&this._layers[S].canCastShadows()){w=!0;break}x.castsShadows=w}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const u in this._layers)if(this._layers[u].type===n)return!0;return!1}setLayerZoomRange(n,u,g){this._checkLoaded();const x=this._checkLayer(n);x&&(x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,u){this._checkLoaded();const g=this._checkLayer(n);g&&g.slot!==u&&(g.slot=u,this._updateLayer(g))}setFilter(n,u,g={}){this._checkLoaded();const x=this._checkLayer(n);if(x&&!r.bv(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(Et,`layers.${x.id}.filter`,u,{layerType:x.type},g)||(x.filter=r.d6(u),this._updateLayer(x)))}getFilter(n){const u=this._checkLayer(n);if(u)return r.d6(u.filter)}setLayoutProperty(n,u,g,x={}){this._checkLoaded();const w=this._checkLayer(n);if(w&&!r.bv(w.getLayoutProperty(u),g)){if(g!=null&&(!x||x.validate!==!1)&&El(w,Ee.call(ro,{key:`layers.${n}.layout.${u}`,layerType:w.type,objectKey:u,value:g,styleSpec:r.a5,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(u,g),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(n,u){const g=this._checkLayer(n);if(g)return g.getLayoutProperty(u)}setPaintProperty(n,u,g,x={}){this._checkLoaded();const w=this._checkLayer(n);if(!w||r.bv(w.getPaintProperty(u),g)||g!=null&&(!x||x.validate!==!1)&&El(w,ye.call(ro,{key:`layers.${n}.paint.${u}`,layerType:w.type,objectKey:u,value:g,styleSpec:r.a5})))return;const S=w.setPaintProperty(u,g);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),S&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(n,u){const g=this._checkLayer(n);if(g)return g.getPaintProperty(u)}setFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:P,importId:V}=n.target,Y=this.getFragmentStyle(V),J=Y.getFeaturesetLayers(P);for(const{source:Z,sourceLayer:te}of J)Y.setFeatureState({id:n.id,source:Z,sourceLayer:te},u)}else if("layerId"in n.target){const{layerId:P}=n.target,V=this.getLayer(P);this.setFeatureState({id:n.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=n.source,x=n.sourceLayer,w=this._checkSource(g);if(!w)return;const S=w.type;if(S==="geojson"&&x)return void this.fire(new r.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!x)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided.")));const L=this.getOwnSourceCaches(g);for(const P of L)P.setFeatureState(x,n.id,u)}removeFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:P,importId:V}=n.target,Y=this.getFragmentStyle(V),J=Y.getFeaturesetLayers(P);for(const{source:Z,sourceLayer:te}of J)Y.removeFeatureState({id:n.id,source:Z,sourceLayer:te},u)}else if("layerId"in n.target){const{layerId:P}=n.target,V=this.getLayer(P);this.removeFeatureState({id:n.id,source:V.source,sourceLayer:V.sourceLayer},u)}return}const g=n.source,x=this._checkSource(g);if(!x)return;const w=x.type,S=w==="vector"?n.sourceLayer:void 0;if(w==="vector"&&!S)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new r.z(new Error("A feature id is required to remove its specific state property.")));const L=this.getOwnSourceCaches(g);for(const P of L)P.removeFeatureState(S,n.id,u)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let w;if("featuresetId"in n.target){const{featuresetId:S,importId:L}=n.target,P=this.getFragmentStyle(L),V=P.getFeaturesetLayers(S);for(const{source:Y,sourceLayer:J}of V){const Z=P.getFeatureState({id:n.id,source:Y,sourceLayer:J});if(Z&&!w)w=Z;else if(!r.bv(w,Z))return void this.fire(new r.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:S}=n.target,L=this.getLayer(S);w=this.getFeatureState({id:n.id,source:L.source,sourceLayer:L.sourceLayer})}return w}const u=n.source,g=n.sourceLayer,x=this._checkSource(u);if(x){if(x.type!=="vector"||g)return n.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(g,n.id);this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=r.h({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return r.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),u=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return r.dc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateFilteredLayers(n){for(const u of Object.values(this._mergedLayers))n(u)&&this._updateLayer(u)}_updateLayer(n){this._changes.updateLayer(n);const u=this.getLayerSourceCache(n),g=r.C(n.source,n.scope),x=this._changes.getUpdatedSourceCaches();n.source&&!x[g]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),u.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const u=L=>this._mergedLayers[L].is3D(!!this.terrain),g=this.order,x={},w=[];for(let L=g.length-1;L>=0;L--){const P=g[L];if(u(P)){x[P]=L;for(const V of n){const Y=V[P];if(Y)for(const J of Y)w.push(J)}}}w.sort((L,P)=>P.intersectionZ-L.intersectionZ);const S=[];for(let L=g.length-1;L>=0;L--){const P=g[L];if(u(P))for(let V=w.length-1;V>=0;V--){const Y=w[V].feature;if(Y.layer&&x[Y.layer.id]<L)break;S.push(Y),w.pop()}else for(const V of n){const Y=V[P];if(Y)for(const J of Y)S.push(J.feature)}}return S}queryRenderedFeatures(n,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(Et,"queryRenderedFeatures.filter",u.filter,null,u),x=r.b3(u.filter));const w={},S=Y=>{if(xu.has(Y.type))return;const J=this.getOwnLayerSourceCache(Y),Z=w[J.id]=w[J.id]||{sourceCache:J,layers:{},has3DLayers:!1};Y.is3D(!!this.terrain)&&(Z.has3DLayers=!0),Z.layers[Y.fqid]=Z.layers[Y.fqid]||{styleLayer:Y,targets:[]},Z.layers[Y.fqid].targets.push({filter:x})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new r.z(new Error("parameters.layers must be an Array."))),[];for(const Y of u.layers){const J=this._layers[Y];if(!J)return this.fire(new r.z(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];S(J)}}else for(const Y in this._layers)S(this._layers[Y]);const L=this._queryRenderedFeatures(n,w,g),P=this._flattenAndSortRenderedFeatures(L),V=[];for(const Y of P)r.dd(Y.layer.id)===this.scope&&V.push(Y);return V}queryRenderedFeatureset(n,u,g){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(Et,"queryRenderedFeatures.filter",u.filter,null,u),x=r.b3(u.filter));const w="mock",S=[];if(u&&u.target)S.push(Object.assign({},u,{targetId:w,filter:x}));else{const Y=this.getFeaturesetDescriptors();for(const J of Y)S.push({targetId:w,filter:x,target:J});for(const{style:J}of this.fragments){const Z=J.getFeaturesetDescriptors();for(const te of Z)S.push({targetId:w,filter:x,target:te})}}const L=this.queryRenderedTargets(n,S,g),P=[],V=new Set;for(const Y of L)for(const J of Y.variants[w])Nc(J,Y,V)||P.push(new r.de(Y,J));return P}queryRenderedTargets(n,u,g){const x={},w=(L,P,V,Y)=>{const J=x[P.id]=x[P.id]||{sourceCache:P,layers:{},has3DLayers:!1};if(J.layers[L.fqid]=J.layers[L.fqid]||{styleLayer:L,targets:[]},L.is3D(!!this.terrain)&&(J.has3DLayers=!0),!Y)return V.uniqueFeatureID=!1,void J.layers[L.fqid].targets.push(V);J.layers[L.fqid].targets.push(Object.assign({},V,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const L of u)if("featuresetId"in L.target){const{featuresetId:P,importId:V}=L.target,Y=this.getFragmentStyle(V);if(!Y||!Y._featuresetSelectors)continue;const J=Y._featuresetSelectors[P];if(!J){this.fire(new r.z(new Error(`The featureset '${P}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Z of J){const te=Y.getOwnLayer(Z.layerId);te&&!xu.has(te.type)&&w(te,Y.getOwnLayerSourceCache(te),L,Z)}}else if("layerId"in L.target){const{layerId:P}=L.target,V=this.getLayer(P);if(!V||xu.has(V.type))continue;w(V,this.getLayerSourceCache(V),L)}const S=this._queryRenderedFeatures(n,x,g);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(n,u,g){const x=[],w=!!this.map._showQueryGeometry,S=In.createFromScreenPoints(n,g);for(const L in u){const P=yl(S,u[L],this._availableImages,g,w);Object.keys(P).length&&x.push(P)}if(this.placement)for(const L in u){if(!u[L].sourceCache._onlySymbols)continue;const P=Eo(S.screenGeometry,u[L],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(P).length&&x.push(P)}return x}querySourceFeatures(n,u){const g=u&&u.filter;g&&this._validate(Et,"querySourceFeatures.filter",g,null,u);let x=[];const w=this.getOwnSourceCaches(n);for(const S of w)x=x.concat(Ta(S,u));return x}addSourceType(n,u,g){return Ho.getSourceType(n)?g(new Error(`A source type called "${n}" already exists.`)):(Ho.setSourceType(n,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:u.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,u,g={}){this._checkLoaded();const x=this.light.getLight();let w=!1;for(const L in n)if(!r.bv(n[L],x[L])){w=!0;break}if(!w)return;const S=this._getTransitionParameters();this.light.setLight(n,u,g),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,u=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=n;const x=n.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){const L="terrain-dem-src";this.addSource(L,g.source),g=r.d6(g),g=r.h(g,{source:L})}const w=r.h({},g),S={};if(this.terrain&&x){w.source=this.terrain.get().source;const L=this.terrain?this.getFragmentStyle(this.terrain.scope):null;L&&(S.style=L.serialize())}if(this._validate(qt,"terrain",w,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u),this.fire(new r.A("data",{dataType:"style"}))}else{const w=this.terrain,S=w.get();for(const L of Object.keys(r.a5.terrain))!g.hasOwnProperty(L)&&r.a5.terrain[L].default&&(g[L]=r.a5.terrain[L].default);for(const L in n)if(!r.bv(n[L],S[L])){w.set(n,this.options),this.stylesheet.terrain=n;const P=this._getTransitionParameters({duration:0});w.updateTransitions(P),this.fire(new r.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const u=this.fog=new Mr(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createSnow(n){const u=this.snow=new gs(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_createRain(n){const u=this.rain=new ms(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.fog=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.snow=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!r.bv(u.get(),n)){u.set(n,this.options),this.stylesheet.rain=u.get();const g=this._getTransitionParameters({duration:0});u.updateTransitions(g)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void n();const g=this._evaluateColorThemeData(u);this._loadColorTheme(g).then(()=>{this.fire(new r.A("colorthemeset")),n()}).catch(x=>{r.w(`Couldn't set color theme: ${x}`)})}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,u){const g=this.getFragmentStyle(n);g&&(g._styleColorTheme.colorThemeOverride=u,g._reloadColorTheme())}_getTransitionParameters(n){return{now:r.q.now(),transition:r.h(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],u=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?n.push(g):u.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...u)}_createTerrain(n,u){const g=this.terrain=new bt(n,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="symbol"&&this._updateLayer(u)}}_validate(n,u,g,x,w={}){if(w&&w.validate===!1)return!1;const S=r.h({},this.serialize());return El(this,n.call(ro,r.h({key:u,style:S,value:g,styleSpec:r.a5},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.df.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(n){const u=this.getSourceCaches(n);for(const g of u)g.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}reloadSource(n){const u=this.getSourceCaches(n);for(const g of u)g.resume(),g.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(n=>{n.modelManager.reloadModels(n.scope)})}updateSources(n){let u;this.directionalLight&&(u=xo(this.directionalLight));const g=new Set;for(const x in this._mergedLayers){const w=this._mergedLayers[x];w.hasElevation()&&!g.has(w.source)&&g.add(w.source)}for(const x in this._mergedSourceCaches){const w=this._mergedSourceCaches[x],S=g.has(w._source.id);w.update(n,void 0,void 0,u,S)}}_generateCollisionBoxes(){for(const n in this._sourceCaches){const u=this._sourceCaches[n];u.resume(),u.reload()}}_updatePlacement(n,u,g,x,w,S,L=!1){let P=!1,V=!1;const Y={},J={};for(const Z of this._mergedOrder){const te=this._mergedLayers[Z];if(te.type!=="symbol")continue;const de=r.C(te.source,te.scope);let he=Y[de];if(!he){const _e=this.getLayerSourceCache(te);if(!_e)continue;const Te=_e.getRenderableIds(!0).map(je=>_e.getTileByID(je));J[de]=Te.slice(),he=Y[de]=Te.sort((je,We)=>We.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(We.tileID)?-1:1))}const ge=this.crossTileSymbolIndex.addLayer(te,he,u.center.lng,u.projection);P=P||ge}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),L=L||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new r.A("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),u.zoom))&&(this.pauseablePlacement=new Dn(u,this._mergedOrder,L,g,x,w,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,J,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),V=!0),P&&this.pauseablePlacement.placement.setStale()),V||P){this._buildingIndex.onNewFrame(u.zoom);for(let Z=0;Z<this._mergedOrder.length;Z++){const te=this._mergedLayers[this._mergedOrder[Z]];if(te.type!=="symbol")continue;const de=this.isLayerClipped(te);this.placement.updateLayerOpacities(te,Y[r.C(te.source,te.scope)],Z,de?S:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,u){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:w})=>w===n.id)!==-1)return void this.fire(new r.z(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!u)return g.push(n),this._loadImports([n],!0);const x=g.findIndex(({id:w})=>w===u);return x===-1&&this.fire(new r.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(n).concat(g.slice(x)),this._loadImports([n],!0,u)}updateImport(n,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(n);return x===-1?this:typeof u=="string"?(this.setImportUrl(n,u),this):(u.url&&u.url!==g[x].url&&this.setImportUrl(n,u.url),r.bv(u.config,g[x].config)||this.setImportConfig(n,u.config,u.data.schema),r.bv(u.data,g[x].data)||this.setImportData(n,u.data),this)}moveImport(n,u){this._checkLoaded();let g=this.stylesheet.imports||[];const x=this.getImportIndex(n);if(x===-1)return this;const w=this.getImportIndex(u);if(w===-1)return this;const S=g[x],L=this.fragments[x];return g=g.filter(({id:P})=>P!==n),this.fragments=this.fragments.filter(({id:P})=>P!==n),this.stylesheet.imports=g.slice(0,w).concat(S).concat(g.slice(w)),this.fragments=this.fragments.slice(0,w).concat(L).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(n,u){this._checkLoaded();const g=this.stylesheet.imports||[],x=this.getImportIndex(n);if(x===-1)return this;g[x].url=u;const w=this.fragments[x];return w.style=this._createFragmentStyle(g[x]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(u),this}setImportData(n,u){this._checkLoaded();const g=this.getImportIndex(n),x=this.stylesheet.imports||[];return g===-1?this:u?(this.fragments[g].style.setState(u),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(n,x[g].url))}setImportConfig(n,u,g){this._checkLoaded();const x=this.getImportIndex(n),w=this.stylesheet.imports||[];if(x===-1)return this;u?w[x].config=u:delete w[x].config;const S=this.fragments[x];g&&S.style.stylesheet&&(S.style.stylesheet.schema=g);const L=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=u,S.style.updateConfig(u,L),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const u=this.stylesheet.imports||[],g=this.getImportIndex(n);g!==-1&&(u.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(n){const u=(this.stylesheet.imports||[]).findIndex(g=>g.id===n);return u===-1&&this.fire(new r.z(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),u}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const u in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[u];g&&n.push(g.getSource())}return n}getSource(n,u){const g=this.getSourceCache(n,u);return g&&g.getSource()}getLayerSource(n){const u=this.getLayerSourceCache(n);return u&&u.getSource()}getSourceCache(n,u){const g=r.C(n,u);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(n){const u=r.C(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[n]&&u.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&u.push(this._mergedSymbolSourceCaches[n]),u}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const u in n){const g=n[u];g==="reload"?this.reloadSource(u):g==="clear"&&this.clearSource(u)}}updateLayers(n){const u=this._changes.getUpdatedPaintProperties();for(const g of u){const x=this.getLayer(g);x&&x.updateTransitions(n)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(n){this.stylesheet.glyphs=n,this.glyphManager.setURL(n,this.scope)}getImages(n,u,g){this.imageManager.getImages(u.images,u.scope,g),this._updateTilesForChangedImages();const x=S=>{if(S){const L=u.images.map(P=>r.I.toString(P));S.setDependencies(u.tileID.key,u.type,L)}},w=r.C(u.source,u.scope);x(this._mergedOtherSourceCaches[w]),x(this._mergedSymbolSourceCaches[w])}rasterizeImages(n,u,g){this.imageManager.rasterizeImages(u,g)}getGlyphs(n,u,g){this.glyphManager.getGlyphs(u.stacks,u.scope,g)}getResource(n,u,g){return r.dg(u,g)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const u=[];return this._otherSourceCaches[n]&&u.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&u.push(this._symbolSourceCaches[n]),u}_isSourceCacheLoaded(n){const u=this.getOwnSourceCaches(n);return u.length===0?(this.fire(new r.z(new Error(`There is no source with ID '${n}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,u){if(!this._clipLayerPresent&&n.type!=="fill-extrusion"&&n.type!=="building")return!1;const g=n.type==="fill-extrusion"&&n.sourceLayer==="building",x=n.type==="building";if(n.is3D(!!this.terrain)){if(g||x||u&&u.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ho.getSourceType=function(p){return ch[p]},Ho.setSourceType=function(p,n){ch[p]=n},Ho.registerForPluginStateChange=r.dh;var Ic=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Ql=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,bu=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,ac="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Vl=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Tc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,wu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,To=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,tl=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,wi=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,no=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const bo=[];ul(Ic,bo),ul(bu,bo),ul(Ql,bo);const po={"_prelude_fog.vertex.glsl":Tc,"_prelude_terrain.vertex.glsl":Vl,"_prelude_shadow.vertex.glsl":wi,"_prelude_fog.fragment.glsl":wu,"_prelude_shadow.fragment.glsl":no,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":To,"_prelude_raster_particle.glsl":tl},Gl={};gn("",Vl),gn(wu,Tc),gn(no,wi),gn(To,""),gn(tl,"");const Bu=gn(Ql,bu),Na=Ic;var ph={background:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:gn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:gn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:gn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:gn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:gn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:gn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:gn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:gn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:gn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:gn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:gn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ac),skyboxGradient:gn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ac),skyboxCapture:gn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:gn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:gn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:gn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:gn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:gn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ul(p,n){const u=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const w of x)n.includes(w)||n.push(w)}}function gn(p,n){const u=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=n.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(V=>{const Y=V.split(" ");return Y[Y.length-1]}),x=[...new Set(x)]);const w={},S=[],L=[];if(p=p.replace(u,(V,Y)=>(L.push(Y),"")),(n=n.replace(u,(V,Y)=>(S.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let P=[...bo];ul(p,P),ul(n,P);for(const V of[...S,...L])po[V]||console.error(`Undefined include: ${V}`),Gl[V]||(Gl[V]=[],ul(po[V],Gl[V])),P=[...P,...Gl[V]];return{fragmentSource:p=p.replace(g,(V,Y,J,Z,te)=>(w[te]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
in ${J} ${Z} ${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = u_${te};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${J} ${Z} ${te};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(g,(V,Y,J,Z,te)=>{const de=Z==="float"?"vec2":Z,he=te.match(/color/)?"color":de;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${te}
in ${J} ${Z} a_${te};
#endif
`:w[te]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${J} ${de} a_${te};
out ${J} ${Z} ${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize"?he==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = a_${te};
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = unpack_mix_${he}(a_${te}, u_${te}_t);
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    in ${J} ${Z} a_${te};
    out ${J} ${Z} ${te};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${te} = a_${te};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
in ${J} ${de} a_${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="define-instanced"?he==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${te}0;
in vec4 a_${te}1;
in vec4 a_${te}2;
in vec4 a_${te}3;
#else
uniform ${J} ${Z} u_${te};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${J} ${de} a_${te};
#else
uniform ${J} ${Z} u_${te};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${te}
    ${J} ${Z} ${te} = a_${te};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = a_${te};
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${J} ${Z} ${te} = unpack_mix_${he}(a_${te}, u_${te}_t);
#else
    ${J} ${Z} ${te} = u_${te};
#endif
`}),staticAttributes:x,usedDefines:P,vertexIncludes:S,fragmentIncludes:L}}class Ma{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,u,g,x,w,S,L,P){this.context=n;let V=this.boundPaintVertexBuffers.length!==x.length;for(let J=0;!V&&J<x.length;J++)this.boundPaintVertexBuffers[J]!==x[J]&&(V=!0);let Y=this.boundDynamicVertexBuffers.length!==L.length;for(let J=0;!Y&&J<L.length;J++)this.boundDynamicVertexBuffers[J]!==L[J]&&(Y=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||V||Y||this.boundIndexBuffer!==w||this.boundVertexOffset!==S)this.freshBind(u,g,x,w,S,L,P);else{n.bindVertexArrayOES.set(this.vao);for(const J of L)J&&(J.bind(),P&&J.instanceCount&&J.setVertexAttribDivisor(n.gl,u,P));w&&w.dynamicDraw&&w.bind()}}freshBind(n,u,g,x,w,S,L){const P=n.numAttributes,V=this.context,Y=V.gl;this.vao&&this.destroy(),this.vao=V.gl.createVertexArray(),V.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=S,u.enableAttributes(Y,n),u.bind(),u.setVertexAttribPointers(Y,n,w);for(const J of g)J.enableAttributes(Y,n),J.bind(),J.setVertexAttribPointers(Y,n,w);for(const J of S)J&&(J.enableAttributes(Y,n),J.bind(),J.setVertexAttribPointers(Y,n,w),L&&J.instanceCount&&J.setVertexAttribDivisor(Y,n,L));x&&x.bind(),V.currentNumAttributes=P}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function lc(p,n){const u=Math.pow(2,n.canonical.z),g=n.canonical.y;return[new r.ac(0,g/u).toLngLat().lat,new r.ac(0,(g+1)/u).toLngLat().lat]}function rA(p,n,u,g,x,w,S){const L=p.context,P=L.gl,V=u.hillshadeFBO;if(!V)return;p.prepareDrawTile();const Y=p.isTileAffectedByFog(n),J=p.getOrCreateProgram("hillshade",{overrideFog:Y});L.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,V.colorAttachment.get());const Z=((ge,_e,Te,je)=>{const We=Te.paint.get("hillshade-shadow-color"),ut=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",at=Te.paint.get("hillshade-highlight-color"),nt=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",qe=Te.paint.get("hillshade-accent-color"),ht=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",ft=Te.paint.get("hillshade-emissive-strength");let Rt=r.al(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")Rt-=ge.transform.angle;else if(ge.style&&ge.style.enable3dLights()&&ge.style.directionalLight){const ti=ge.style.directionalLight.properties.get("direction"),ri=r.cR(ti.x,ti.y,ti.z);Rt=r.al(ri[1])}const Ot=!ge.options.moving;return{u_matrix:je||ge.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),Ot),u_image:0,u_latrange:lc(0,_e.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),Rt],u_shadow:We.toPremultipliedRenderColor(ut?null:Te.lut),u_highlight:at.toPremultipliedRenderColor(nt?null:Te.lut),u_emissive_strength:ft,u_accent:qe.toPremultipliedRenderColor(ht?null:Te.lut)}})(p,u,g,p.terrain?n.projMatrix:null);p.uploadCommonUniforms(L,J,n.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:de,tileBoundsSegments:he}=p.getTileBoundsBuffers(u);J.draw(p,P.TRIANGLES,x,w,S,wr.disabled,Z,g.id,te,de,he)}function gh(p,n,u){if(!n.needsDEMTextureUpload)return;const g=p.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||p.getTileTexture(u.stride);const w=u.getPixels();n.demTexture?n.demTexture.update(w,{premultiply:!1}):n.demTexture=new r.T(g,w,x.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function mh(p,n,u){const g=p.context,x=g.gl;if(!n.dem)return;const w=n.dem;if(g.activeTexture.set(x.TEXTURE1),gh(p,n,w),!n.demTexture)return;n.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const S=w.dim;g.activeTexture.set(x.TEXTURE0);let L=n.hillshadeFBO;if(!L){const Z=new r.T(g,{width:S,height:S,data:null},x.RGBA8);Z.bind(x.LINEAR,x.CLAMP_TO_EDGE),L=n.hillshadeFBO=g.createFramebuffer(S,S,!0,"renderbuffer"),L.colorAttachment.set(Z.texture)}g.bindFramebuffer.set(L.framebuffer),g.viewport.set([0,0,S,S]);const{tileBoundsBuffer:P,tileBoundsIndexBuffer:V,tileBoundsSegments:Y}=p.getMercatorTileBoundsBuffers(),J=[];p.linearFloatFilteringSupported()&&J.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:J}).draw(p,x.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.disabled,((Z,te)=>{const de=te.stride,he=r.bz();return r.c5(he,0,r.aj,-8192,0,0,1),r.bo(he,he,[0,-8192,0]),{u_matrix:he,u_image:1,u_dimension:[de,de],u_zoom:Z.overscaledZ}})(n.tileID,w),u.id,P,V,Y),n.needsHillshadePrepare=!1}class Is{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hd extends Is{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hu extends Is{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Pf extends Is{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class $A extends Is{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ZA extends Is{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class nA extends Is{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class yh extends Is{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Rp extends Is{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class sA extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class kf extends Is{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Rf extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Vh extends Is{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class oA extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class JA extends Is{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class vh extends Is{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Qu extends Is{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class Cu extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Vu extends Is{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Gh extends Is{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let Df=class extends Is{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class aA extends Is{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Of extends Is{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Wh extends Is{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class lA extends Is{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class cA extends Is{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Xc extends Is{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Il extends Is{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class il extends Is{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class Uf extends Is{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class ef extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Yc extends Is{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Ba extends Is{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class zf extends Ba{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class uA extends Ba{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class dd extends Ba{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Nf extends uA{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const hA=(p,n,u)=>({u_matrix:p,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:u}),Ad=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:w,u_image0:0,u_frustum_tl:S,u_frustum_tr:L,u_frustum_br:P,u_frustum_bl:V,u_globe_pos:Y,u_globe_radius:J,u_viewport:Z,u_grid_matrix:he?Float32Array.from(he):new Float32Array(9),u_skirt_height:te,u_far_z_cutoff:de});function dA(p,n){return p!=null&&n!=null&&!(!p.hasData()||!n.hasData())&&p.demTexture!=null&&n.demTexture!=null&&p.tileID.key!==n.tileID.key}const Fc=new class{constructor(){this.operations={}}newMorphing(p,n,u,g,x){if(p in this.operations){const w=this.operations[p];w.to.tileID.key!==u.tileID.key&&(w.queued=u)}else this.operations[p]={startTime:g,phase:0,duration:x,from:n,to:u,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const n=this.operations[p];return{from:n.from,to:n.to,phase:n.phase}}update(p){for(const n in this.operations){const u=this.operations[n];for(u.phase=(p-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,p)){delete this.operations[n];break}}}_nextOp(p,n){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=n,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Xh={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Kc(p,n,u){if(n===0)return 0;const g=n<1&&u===514?.25/n:1;return 6*Math.pow(1.5,22-p)*Math.max(n,1)*g}function tf(p,n){const u=1<<p.z;return!n&&(p.x===0||p.x===u-1)||p.y===0||p.y===u-1}const _h=p=>({u_matrix:p});function Gu(p,n,u,g,x){if(x>0){const w=r.q.now(),S=(w-p.timeAdded)/x,L=n?(w-n.timeAdded)/x:-1,P=u.getSource(),V=g.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),Y=!n||Math.abs(n.tileID.overscaledZ-V)>Math.abs(p.tileID.overscaledZ-V),J=Y&&p.refreshedUponExpiration?1:r.ay(Y?S:1-L,0,1);return p.refreshedUponExpiration&&S>=1&&(p.refreshedUponExpiration=!1),n?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class jf extends ko{constructor(n){const u={type:"raster-dem",maxzoom:n.transform.maxZoom},g=new r.D(r.c$(),null),x=xc("mock-dem",u,g,n.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,u){n.state="loaded",u(null)}}class Wl extends ko{constructor(n){const u=xc("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new r.D(r.c$(),null),n.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,u,g){if(n.freezeTileCoverage)return;this.transform=n;const x=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,S)=>{if(w[S.key]="",!this._tiles[S.key]){const L=new hu(S,this._source.tileSize*S.overscaleFactor(),n.tileZoom,void 0,void 0,this._source.worldview);L.state="loaded",this._tiles[S.key]=L}return w},{});for(const w in this._tiles)w in x||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(n){const u=this.proxyCachedFBO[n];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class AA extends r.aM{constructor(n,u,g){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class fd extends r.dt{constructor(n,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,w]=function(P){const V=new r.ba,Y=new r.a_,J=131;V.reserve(17161),Y.reserve(33800);const Z=r.aj/128,te=r.aj+Z/2,de=te+Z;for(let ge=-64;ge<de;ge+=Z)for(let _e=-64;_e<de;_e+=Z){const Te=_e<0||_e>te||ge<0||ge>te?24575:0,je=r.ay(Math.round(_e),0,r.aj),We=r.ay(Math.round(ge),0,r.aj);V.emplaceBack(je+Te,We)}const he=(ge,_e)=>{const Te=_e*J+ge;Y.emplaceBack(Te+1,Te,Te+J),Y.emplaceBack(Te+J,Te+J+1,Te+1)};for(let ge=1;ge<129;ge++)for(let _e=1;_e<129;_e++)he(_e,ge);return[0,129].forEach(ge=>{for(let _e=0;_e<130;_e++)he(_e,ge),he(ge,_e)}),[V,Y,32768]}(),S=n.context;this.gridBuffer=S.createVertexBuffer(g,r.bc.members),this.gridIndexBuffer=S.createIndexBuffer(x),this.gridSegments=r.bd.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=r.bd.simpleSegment(0,0,g.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Wl(u.map),this.orthoMatrix=r.bz(),r.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.aj,0,r.aj,0,1);const L=S.gl;this._overlapStencilMode=new Pr({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new jf(u.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,u,g){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const x=n.terrain.properties,w=n.terrain.drapeRenderMode===0,S=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const L=n.terrain&&n.terrain.scope,P=x.get("source"),V=w?this._mockSourceCache:n.getSourceCache(P,L);if(!V)return void r.w(`Couldn't find terrain source "${P}".`);if(this.sourceCache=V,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(u):x.get("exaggeration"),!u.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const J=this.getScaledDemTileSize();this.sourceCache.update(u,J,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const u=this._previousCameraAltitude,g=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=g;const x=u!=null?g-u:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const w=n.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(w);let L=w-this._previousZoom;const P=this._previousUpdateTimestamp;let V=w;this._evaluationZoom!=null&&(V=this._evaluationZoom,Math.abs(w-V)>.5&&(L=.5*(w-V+L)),L*x<0&&(V+=L)),this._evaluationZoom=V;const Y=S.getExaggeration(V),J=Y===S.getExaggeration(Math.max(0,V-.1));if(J&&Math.abs(Y-this._exaggeration)<.01)return Y;let Z=Math.min(.1,.00375*(this._updateTimestamp-P));return(J||Y<.1||Math.abs(L)<1e-4)&&(Z=Math.min(.2,4*Z)),r.ai(this._exaggeration,Y,Z)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(r.ac.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(P=>{const V=u.getTileByID(P).tileID;return V.projMatrix=g.calculateProjMatrix(V.toUnwrapped()),V});(function(P,V){const Y=V.transform.pointCoordinate(V.transform.getCameraPoint()),J=new r.P(Y.x,Y.y);P.sort((Z,te)=>{if(te.overscaledZ-Z.overscaledZ)return te.overscaledZ-Z.overscaledZ;const de=new r.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),he=new r.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ge=J.mult(1<<Z.canonical.z);return ge.x-=.5,ge.y-=.5,ge.distSqr(de)-ge.distSqr(he)})})(x,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},x.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const P in S){const V=S[P];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,n[P],w),V.usedForTerrain))continue;const Y=n[P];V.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[u.id]=x.map(P=>new AA(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const L={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const V=this.terrainTileForTile[P.key];if(!V)continue;const Y=V.tileID.key;Y in L||(this._visibleDemTiles.push(V),L[Y]=Y)}}_assignTerrainTiles(n){this._initializing||n.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const n=this.painter.context,u=n.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],w=x.dem;!w||x.demTexture&&!x.needsDEMTextureUpload||(n.activeTexture.set(u.TEXTURE1),gh(this.painter,x,w))}}_prepareDemTileUniforms(n,u,g,x){if(!u||u.demTexture==null)return!1;const w=n.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-w.z),L=x||"";return g[`u_dem_tl${L}`]=[w.x*S%1,w.y*S%1],g[`u_dem_scale${L}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const u=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const w=x.dem.tree.minimums[0];return w>0&&n++,g+w},0);return n?u/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,u=n.gl;n.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new r.du({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(x,{premultiply:!1}):w=this._emptyDEMTexture=new r.T(n,x,u.R32F,{premultiply:!1}),w}setupElevationDraw(n,u,g){const x=this.painter.context,w=x.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let L=null,P=null,V=1;if(g&&g.morphing&&this._useVertexMorphing){const te=g.morphing.srcDemTile,de=g.morphing.dstDemTile;V=g.morphing.phase,te&&de&&(this._prepareDemTileUniforms(n,te,S,"_prev")&&(P=te),this._prepareDemTileUniforms(n,de,S)&&(L=de))}const Y=te=>te&&te.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let J=null;var Z;if(this.enabled?P&&L?(J=L.demTexture,x.activeTexture.set(w.TEXTURE4),P.demTexture.bind(Y(P),w.CLAMP_TO_EDGE),S.u_dem_lerp=V):(L=this.terrainTileForTile[n.tileID.key],J=this._prepareDemTileUniforms(n,L,S)?L.demTexture:this.emptyDEMTexture):J=this.emptyDEMTexture,x.activeTexture.set(w.TEXTURE2),J&&(S.u_dem_size=(Z=J).size[0]===1?1:Z.size[0]-2,J.bind(Y(L),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,u,S),g&&g.useMeterToDem&&L){const te=(1<<L.tileID.canonical.z)*r.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=te}if(g&&g.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(x,S),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,n.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(x,te)}}globeUniformValues(n,u,g){const x=n.projection;return{u_tile_tl_up:x.upVector(u,0,0),u_tile_tr_up:x.upVector(u,r.aj,0),u_tile_br_up:x.upVector(u,r.aj,r.aj),u_tile_bl_up:x.upVector(u,0,r.aj),u_tile_up_scale:g?r.dv(1):x.upVectorScale(u,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const u=this.painter,g=this.painter.context;n.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,w,S,L,P){if(x.transform.projection.name==="globe")(function(V,Y,J,Z,te){const de=V.context,he=de.gl;let ge,_e;const Te=V.transform,je=r.dl(V,de,Te),We=(ti,ri)=>{if(_e===ri)return;const vi=[Xh[ri],"PROJECTION_GLOBE_VIEW"];je&&vi.push("CUSTOM_ANTIALIASING");const Pt=V.isTileAffectedByFog(ti);ge=V.getOrCreateProgram("globeRaster",{defines:vi,overrideFog:Pt}),_e=ri},ut=V.colorModeForRenderPass(),at=new ji(he.LEQUAL,ji.ReadWrite,V.depthRangeFor3D);Fc.update(te);const nt=r.dm(Te),qe=[r.aD(Te.center.lng),r.aH(Te.center.lat)],ht=V.globeSharedBuffers,ft=[Te.width*r.q.devicePixelRatio,Te.height*r.q.devicePixelRatio],Rt=Float32Array.from(Te.globeMatrix),Ot={useDenormalizedUpVectorScale:!0};{const ti=V.transform,ri=Kc(ti.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);_e=-1;const vi=he.TRIANGLES;for(const Pt of Z){const Qt=J.getTile(Pt),Ct=Pr.disabled,oi=Y.prevTerrainTileForTile[Pt.key],zt=Y.terrainTileForTile[Pt.key];dA(oi,zt)&&Fc.newMorphing(Pt.key,oi,zt,te,250),de.activeTexture.set(he.TEXTURE0),Qt.texture&&Qt.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);const gi=Fc.getMorphValuesForProxy(Pt.key),Li=gi?1:0;gi&&r.L(Ot,{morphing:{srcDemTile:gi.from,dstDemTile:gi.to,phase:r.dk(gi.phase)}});const ai=r.dn(Pt.canonical),Mi=r.dp(ai.getCenter().lat),ir=r.dq(Pt.canonical,ai,Mi,ti.worldSize/ti._pixelsPerMercatorPixel),tr=r.bh(r.dr(Pt.canonical)),Ki=Ad(ti.expandedFarZProjMatrix,Rt,nt,tr,r.ah(ti.zoom),qe,ti.frustumCorners.TL,ti.frustumCorners.TR,ti.frustumCorners.BR,ti.frustumCorners.BL,ti.globeCenterInViewSpace,ti.globeRadius,ft,ri,ti._farZ,ir);if(We(Pt,Li),ge&&(Y.setupElevationDraw(Qt,ge,Ot),V.uploadCommonUniforms(de,ge,Pt.toUnwrapped()),ht)){const[pr,gr,Cr]=ht.getGridBuffers(Mi,ri!==0);ge.draw(V,vi,at,Ct,ut,wr.backCCW,Ki,"globe_raster",pr,gr,Cr)}}}if(ht&&(V.renderDefaultNorthPole||V.renderDefaultSouthPole)){const ti=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];je&&ti.push("CUSTOM_ANTIALIASING"),ge=V.getOrCreateProgram("globeRaster",{defines:ti});for(const ri of Z){const{x:vi,y:Pt,z:Qt}=ri.canonical,Ct=Pt===0,oi=Pt===(1<<Qt)-1,[zt,gi,Li,ai]=ht.getPoleBuffers(Qt,!1);if(ai&&(Ct||oi)){const Mi=J.getTile(ri);de.activeTexture.set(he.TEXTURE0),Mi.texture&&Mi.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let ir=r.ds(Qt,vi,Te);const tr=r.bh(r.dr(ri.canonical)),Ki=(pr,gr)=>pr.draw(V,he.TRIANGLES,at,Pr.disabled,ut,wr.disabled,Ad(Te.expandedFarZProjMatrix,ir,ir,tr,0,qe,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,ft,0,Te._farZ),"globe_pole_raster",gr,Li,ai);Y.setupElevationDraw(Mi,ge,Ot),V.uploadCommonUniforms(de,ge,ri.toUnwrapped()),Ct&&V.renderDefaultNorthPole&&Ki(ge,zt),oi&&V.renderDefaultSouthPole&&(ir=r.cE(r.bz(),ir,[1,-1,1]),Ki(ge,gi))}}}})(x,w,S,L,P);else{const V=x.context,Y=V.gl;let J,Z;const te=x.shadowRenderer,de=cl(x,x.longestCutoffRange),he=ut=>{if(Z===ut)return;const at=[];at.push(Xh[ut]),de.shouldRenderCutoff&&at.push("RENDER_CUTOFF"),te&&(at.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&at.push("NORMAL_OFFSET")),J=x.getOrCreateProgram("terrainRaster",{defines:at}),Z=ut},ge=x.colorModeForRenderPass(),_e=new ji(Y.LEQUAL,ji.ReadWrite,x.depthRangeFor3D);Fc.update(P);const Te=x.transform,je=Kc(Te.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let We=[0,0,0];if(te){const ut=x.style.directionalLight,at=x.style.ambientLight;ut&&at&&(We=oa(x.style,ut,at))}{Z=-1;const ut=Y.TRIANGLES,[at,nt]=[w.gridIndexBuffer,w.gridSegments];for(const qe of L){const ht=S.getTile(qe),ft=Pr.disabled,Rt=w.prevTerrainTileForTile[qe.key],Ot=w.terrainTileForTile[qe.key];dA(Rt,Ot)&&Fc.newMorphing(qe.key,Rt,Ot,P,250),V.activeTexture.set(Y.TEXTURE0),ht.texture&&ht.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const ti=Fc.getMorphValuesForProxy(qe.key),ri=ti?1:0;let vi;ti&&(vi={morphing:{srcDemTile:ti.from,dstDemTile:ti.to,phase:r.dk(ti.phase)}});const Pt=hA(qe.projMatrix,tf(qe.canonical,Te.renderWorldCopies)?je/10:je,We);if(he(ri),!J)continue;w.setupElevationDraw(ht,J,vi);const Qt=qe.toUnwrapped();te&&te.setupShadows(Qt,J),x.uploadCommonUniforms(V,J,Qt,null,de),J.draw(x,ut,_e,ft,ge,wr.backCCW,Pt,"terrain_raster",w.gridBuffer,at,nt)}}}}(u,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,x=this.proxySourceCache,w=this.proxiedCoords[x.id],S=this._drapedRenderBatches.shift(),L=u.style.order,P=[];let V=0;for(const Y of w){const J=x.getTileByID(Y.proxyTileKey),Z=x.proxyCachedFBO[Y.key]?x.proxyCachedFBO[Y.key][n]:void 0,te=Z!==void 0?x.renderCache[Z]:this.pool[V++],de=Z!==void 0;if(J.texture=te.tex,de&&!te.dirty){P.push(J.tileID);continue}let he;g.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(g.clear({color:r.am.transparent,stencil:0}),te.dirty=!1);for(let ge=S.start;ge<=S.end;++ge){const _e=u.style._mergedLayers[L[ge]];if(_e.isHidden(u.transform.zoom))continue;const Te=u.style.getLayerSourceCache(_e),je=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!je)continue;const We=je;g.viewport.set([0,0,te.fb.width,te.fb.height]),he!==(Te?Te.id:null)&&(this._setupStencil(te,je,_e,Te),he=Te?Te.id:null),u.renderLayer(u,Te,_e,We)}if(this._drapedRenderBatches.length===0)for(const ge of this._pendingGroundEffectLayers){const _e=u.style._mergedLayers[L[ge]];if(_e.isHidden(u.transform.zoom))continue;const Te=u.style.getLayerSourceCache(_e),je=Te?this.proxyToSource[Y.key][Te.id]:[Y];if(!je)continue;const We=je;g.viewport.set([0,0,te.fb.width,te.fb.height]),he!==(Te?Te.id:null)&&(this._setupStencil(te,je,_e,Te),he=Te?Te.id:null),u.renderLayer(u,Te,_e,We)}this.renderedToTile?(te.dirty=!0,P.push(J.tileID)):de||--V,V===5&&(V=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}isLayerOrderingCorrect(n){const u=n.order.length;let g=-1,x=u;for(let w=0;w<u;++w)this._style.isLayerDraped(n._mergedLayers[n.order[w]])?g=Math.max(g,w):x=Math.min(x,w);return x>g}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{n=Math.min(n,u.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,u,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const S=w.tileID,L=1<<S.overscaledZ,{x:P,y:V}=S.canonical,Y=P/L,J=(P+1)/L,Z=V/L,te=(V+1)/L;return{minx:Y,miny:Z,maxx:J,maxy:te,t:w.dem.tree.raycastRoot(Y,Z,J,te,n,u,g),tile:w}});x.sort((w,S)=>(w.t!==null?w.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const w of x){if(w.t==null)return null;const S=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,n,u,g);if(S!=null)return S}return null}_createFBO(){const n=this.painter.context,u=n.gl,g=this.drapeBufferSize;n.activeTexture.set(u.TEXTURE0);const x=new r.T(n,{width:g[0],height:g[1],data:null},u.RGBA8);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const w=n.createFramebuffer(g[0],g[1],!0,null);return w.colorAttachment.set(x.texture),w.depthAttachment=new Nf(n,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:w,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const u=this._style._mergedLayers[n],g=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const g of this._style.getSources())if(g instanceof vc){n=!0;break}if(!n)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(x);if(w&&!u[w.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof r.ab){u[w.id]=!0;for(const S of this.proxyCoords){const L=this.proxyToSource[S.key][w.id];if(L)for(const P of L)this._clearRenderCacheForTile(w.id,P)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof ds){n=!0;break}if(!n)return;const u={};for(let g=0;g<this._style.order.length;++g){const x=this._style._mergedLayers[this._style.order[g]],w=this._style.getLayerSourceCache(x);if(!w||u[w.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const S=x.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const P=this.proxyToSource[L.key][w.id];if(P)for(const V of P){const Y=Gu(w.getTile(V),w.findLoadedParent(V,0),w,this.painter.transform,S);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(w.id,V)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,u=n.length;if(u===0)return;const g=[];this._pendingGroundEffectLayers=[];let x,w=0,S=this._style._mergedLayers[n[w]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++w<u;)S=this._style._mergedLayers[n[w]];for(;w<u;++w){const L=this._style._mergedLayers[n[w]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?x===void 0&&(x=w):(L.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),x!==void 0&&(g.push({start:x,end:w-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:w-1}),g.length!==0){const L=g[g.length-1];this._pendingGroundEffectLayers.every(P=>P>L.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(n){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let L=0;L<S.length;++L){const P=Object.values(S[L]);u.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let S=g.length-1;S>=0;S--){const L=g[S];if(u.getTileByID(L.key),u.proxyCachedFBO[L.key]!==void 0){const P=n[L.key],V=this.proxyToSource[L.key];let Y=0;for(const J in V){const Z=V[J],te=P[J];if(!te||te.length!==Z.length||Z.some((de,he)=>de!==te[he]||x[J]&&x[J].hasOwnProperty(de.key))){Y=-1;break}++Y}for(const J in u.proxyCachedFBO[L.key])u.renderCache[u.proxyCachedFBO[L.key][J]].dirty=Y<0||Y!==Object.values(P).length}}const w=[...this._drapedRenderBatches];w.sort((S,L)=>L.end-L.start-(S.end-S.start));for(const S of w)for(const L of g){if(u.proxyCachedFBO[L.key])continue;let P=u.renderCachePool.pop();P===void 0&&u.renderCache.length<50&&(P=u.renderCache.length,u.renderCache.push(this._createFBO())),P!==void 0&&(u.proxyCachedFBO[L.key]={},u.proxyCachedFBO[L.key][S.start]=P,u.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(n,u,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,S=w.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let L;if(g.isTileClipped())L=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):Pr.disabled}_renderTileClippingMasks(n,u){const g=this.painter,x=this.painter.context,w=x.gl;g._tileClippingMaskIDs={},x.setColorMode(Wr.disabled),x.setDepthMode(ji.disabled);const S=g.getOrCreateProgram("clippingMask");for(const L of n){const P=g._tileClippingMaskIDs[L.key]=--u;S.draw(g,w.TRIANGLES,ji.disabled,new Pr({func:w.ALWAYS,mask:0},P,255,w.KEEP,w.KEEP,w.REPLACE),Wr.disabled,wr.disabled,_h(L.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(n){const u=this.painter.transform;if(n.x<0||n.x>u.width||n.y<0||n.y>u.height)return null;const g=[n.x,n.y,1,1];r.aA(g,g,u.pixelMatrixInverse),r.cw(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const x=u._camera.position,w=r.c6(1,u.center.lat),S=[x[0],x[1],x[2]/w,0],L=r.cX([],g.slice(0,3),S);r.au(L,L);const P=this.raycast(S,L,this._exaggeration);return P!==null&&P?(r.bE(S,S,L,P),S[3]=S[2],S[2]*=w,S):null}_setupProxiedCoordsForOrtho(n,u,g){if(n.getSource()instanceof r.aP)return this._setupProxiedCoordsForImageSource(n,u,g);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const x=this.proxiedCoords[n.id]=[],w=this.proxyCoords;for(let P=0;P<w.length;P++){const V=w[P],Y=this._findTileCoveringTileID(V,n);if(Y){const J=this._createProxiedId(V,Y,g[V.key]&&g[V.key][n.id]);x.push(J),this.proxyToSource[V.key][n.id]=[J]}}let S=!1;const L=new Set;for(let P=0;P<u.length;P++){const V=n.getTile(u[P]);if(!V||!V.hasData())continue;const Y=this._findTileCoveringTileID(V.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==V.tileID.canonical.z){const J=this.proxyToSource[Y.tileID.key][n.id],Z=this._createProxiedId(Y.tileID,V,g[Y.tileID.key]&&g[Y.tileID.key][n.id]);J?J.splice(J.length-1,0,Z):this.proxyToSource[Y.tileID.key][n.id]=[Z];const te=this.proxyToSource[Y.tileID.key][n.id];L.has(te)||L.add(te),x.push(Z),S=!0}}if(this._sourceTilesOverlap[n.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const P of L)P.sort((V,Y)=>Y.overscaledZ-V.overscaledZ)}_setupProxiedCoordsForImageSource(n,u,g){if(!n.getSource().loaded())return;const x=this.proxiedCoords[n.id]=[],w=this.proxyCoords,S=n.getSource(),L=S.tileID;if(!L)return;const P=new r.P(L.x,L.y)._div(1<<L.z),V=S.coordinates.map(r.ac.fromLngLat).reduce((J,Z)=>(J.min.x=Math.min(J.min.x,Z.x-P.x),J.min.y=Math.min(J.min.y,Z.y-P.y),J.max.x=Math.max(J.max.x,Z.x-P.x),J.max.y=Math.max(J.max.y,Z.y-P.y),J),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(J,Z)=>{const te=J.wrap+J.canonical.x/(1<<J.canonical.z),de=J.canonical.y/(1<<J.canonical.z),he=r.aj/(1<<J.canonical.z),ge=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),_e=Z.canonical.y/(1<<Z.canonical.z);return te+he<ge+V.min.x||te>ge+V.max.x||de+he<_e+V.min.y||de>_e+V.max.y};for(let J=0;J<w.length;J++){const Z=w[J];for(let te=0;te<u.length;te++){const de=n.getTile(u[te]);if(!de||!de.hasData()||Y(Z,de.tileID))continue;const he=this._createProxiedId(Z,de,g[Z.key]&&g[Z.key][n.id]),ge=this.proxyToSource[Z.key][n.id];ge?ge.push(he):this.proxyToSource[Z.key][n.id]=[he],x.push(he)}}}_createProxiedId(n,u,g){let x=this.orthoMatrix;if(g){const w=g.find(S=>S.key===u.tileID.key);if(w)return w}if(u.tileID.key!==n.key){const w=n.canonical.z-u.tileID.canonical.z;let S,L,P;x=r.bz();const V=u.tileID.wrap-n.wrap<<n.overscaledZ;w>0?(S=r.aj>>w,L=S*((u.tileID.canonical.x<<w)-n.canonical.x+V),P=S*((u.tileID.canonical.y<<w)-n.canonical.y)):(S=r.aj<<-w,L=r.aj*(u.tileID.canonical.x-(n.canonical.x+V<<-w)),P=r.aj*(u.tileID.canonical.y-(n.canonical.y<<-w))),r.c5(x,0,S,0,S,0,1),r.bo(x,x,[L,P,0])}return new AA(u.tileID,n.key,x)}_findTileCoveringTileID(n,u){let g=u.getTile(n);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[u.id],w=x[n.key];if(g=w?u.getTileByID(w):null,g&&g.hasData()||w===null)return g;let S=g?g.tileID:n,L=S.overscaledZ;const P=u.getSource().minzoom,V=[];if(!w){const J=u.getSource().maxzoom;if(n.canonical.z>=J){const Z=n.canonical.z-J;u.getSource().reparseOverscaled?(L=Math.max(n.canonical.z+2,u.transform.tileZoom),S=new r.aM(L,n.wrap,J,n.canonical.x>>Z,n.canonical.y>>Z)):Z!==0&&(L=J,S=new r.aM(L,n.wrap,J,n.canonical.x>>Z,n.canonical.y>>Z))}S.key!==n.key&&(V.push(S.key),g=u.getTile(S))}const Y=J=>{V.forEach(Z=>{x[Z]=J}),V.length=0};for(L-=1;L>=P&&(!g||!g.hasData());L--){g&&Y(g.tileID.key);const J=S.calculateScaledKey(L);if(g=u.getTileByID(J),g&&g.hasData())break;const Z=x[J];if(Z===null)break;Z===void 0?V.push(J):g=u.getTileByID(Z)}return Y(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,u){let g=this._tilesDirty[n];g||(g=this._tilesDirty[n]={}),g[u.key]=!0}}function fA(p,n,u){const g=function(L,P,V){const Y=r.bG(P,L),J=r.bG(V,[.2126,.7152,.0722]),Z=(de,he,ge)=>(1-ge)*de+ge*he,te=Z(1-.3*Math.min(J,1),1,Math.min(Y+1,1));return Z(.92,1,Math.asin(r.ay(P[2],-1,1))/Math.PI+.5)*te}(p,[0,0,1],n),x=[0,0,0];r.bY(x,u.slice(0,3),g);const w=[0,0,0];r.bY(w,n.slice(0,3),p[2]);const S=[0,0,0];return r.cV(S,x,w),r.cY(S)}const rf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],pA=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class xh{static cacheKey(n,u,g,x){let w=`${u}${x?x.cacheKey:""}`;for(const S of g)n.usedDefines.includes(S)&&(w+=`/${S}`);return w}constructor(n,u,g,x,w,S){const L=n.gl;this.program=L.createProgram(),this.configuration=x,this.name=u,this.fixedDefines=[...S];const P=x?x.getBinderAttributes():[],V=(g.staticAttributes||[]).concat(P);let Y=x?x.defines():[];Y=Y.concat(S.map(ge=>`#define ${ge}`));const J=`#version 300 es
`;let Z=J+Y.concat("precision mediump float;",Na,Bu.fragmentSource).join(`
`);for(const ge of g.fragmentIncludes)Z+=`
${po[ge]}`;Z+=`
${g.fragmentSource}`;let te=J+Y.concat("precision highp float;",Na,Bu.vertexSource).join(`
`);for(const ge of g.vertexIncludes)te+=`
${po[ge]}`;this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&g.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(te+=`
uniform int u_instanceID;
`),te+=`
${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(te=te.replaceAll("gl_InstanceID","u_instanceID"));const de=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(de,Z),L.compileShader(de),L.attachShader(this.program,de);const he=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(he,te),L.compileShader(he),L.attachShader(this.program,he),this.attributes={},this.numAttributes=V.length;for(let ge=0;ge<this.numAttributes;ge++)if(V[ge]){const _e=V[ge].startsWith("a_")?V[ge]:`a_${V[ge]}`;L.bindAttribLocation(this.program,ge,_e),this.attributes[_e]=ge}L.linkProgram(this.program),L.deleteShader(he),L.deleteShader(de),this.fixedUniforms=w(n),this.binderUniforms=x?x.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ge=>({u_instanceID:new r.c8(ge)}))(n)),(S.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(ge=>({u_dem:new r.c8(ge),u_dem_prev:new r.c8(ge),u_dem_tl:new r.cb(ge),u_dem_scale:new r.ca(ge),u_dem_tl_prev:new r.cb(ge),u_dem_scale_prev:new r.ca(ge),u_dem_size:new r.ca(ge),u_dem_lerp:new r.ca(ge),u_exaggeration:new r.ca(ge),u_depth:new r.c8(ge),u_depth_size_inv:new r.cb(ge),u_depth_range_unpack:new r.cb(ge),u_occluder_half_size:new r.ca(ge),u_occlusion_depth_offset:new r.ca(ge),u_meter_to_dem:new r.ca(ge),u_label_plane_matrix_inv:new r.cc(ge)}))(n)),S.includes("GLOBE")&&(this.globeUniforms=(ge=>({u_tile_tl_up:new r.c9(ge),u_tile_tr_up:new r.c9(ge),u_tile_br_up:new r.c9(ge),u_tile_bl_up:new r.c9(ge),u_tile_up_scale:new r.ca(ge)}))(n)),S.includes("FOG")&&(this.fogUniforms=(ge=>({u_fog_matrix:new r.cc(ge),u_fog_range:new r.cb(ge),u_fog_color:new r.cQ(ge),u_fog_horizon_blend:new r.ca(ge),u_fog_vertical_limit:new r.cb(ge),u_fog_temporal_offset:new r.ca(ge),u_frustum_tl:new r.c9(ge),u_frustum_tr:new r.c9(ge),u_frustum_br:new r.c9(ge),u_frustum_bl:new r.c9(ge),u_globe_pos:new r.c9(ge),u_globe_radius:new r.ca(ge),u_globe_transition:new r.ca(ge),u_is_globe:new r.c8(ge),u_viewport:new r.cb(ge)}))(n)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ge=>({u_cutoff_params:new r.cQ(ge)}))(n)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ge=>({u_lighting_ambient_color:new r.c9(ge),u_lighting_directional_dir:new r.c9(ge),u_lighting_directional_color:new r.c9(ge),u_ground_radiance:new r.c9(ge)}))(n)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ge=>({u_light_matrix_0:new r.cc(ge),u_light_matrix_1:new r.cc(ge),u_fade_range:new r.cb(ge),u_shadow_normal_offset:new r.c9(ge),u_shadow_intensity:new r.ca(ge),u_shadow_texel_size:new r.ca(ge),u_shadow_map_resolution:new r.ca(ge),u_shadow_direction:new r.c9(ge),u_shadow_bias:new r.c9(ge),u_shadowmap_0:new r.c8(ge),u_shadowmap_1:new r.c8(ge)}))(n))}}setTerrainUniformValues(n,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setGlobeUniformValues(n,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)g[x]&&g[x].set(this.program,x,u[x])}}setFogUniformValues(n,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setCutoffUniformValues(n,u){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setLightsUniformValues(n,u){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setShadowUniformValues(n,u){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;n.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}_drawDebugWireframe(n,u,g,x,w,S,L,P,V,Y){const J=n.options.wireframe;if(J.terrain===!1&&J.layers2D===!1&&J.layers3D===!1)return;const Z=n.context;if(!(!(!J.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!J.layers2D||n._terrain&&n._terrain.renderingToTexture||!rf.includes(this.name))||!(!J.layers3D||!pA.includes(this.name))))return;const te=Z.gl,de=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,w,Z);if(!de)return;const he=[...this.fixedDefines];he.push("DEBUG_WIREFRAME");const ge=n.getOrCreateProgram(this.name,{config:this.configuration,defines:he});Z.program.set(ge.program);const _e=(We,ut,at)=>{if(ut[We]&&at[We])for(const nt in ut[We])at[We][nt]&&at[We][nt].set(at.program,nt,ut[We][nt].current)};V&&V.setUniforms(ge.program,Z,ge.binderUniforms,L,{zoom:P}),_e("fixedUniforms",this,ge),_e("terrainUniforms",this,ge),_e("globeUniforms",this,ge),_e("fogUniforms",this,ge),_e("lightsUniforms",this,ge),_e("shadowUniforms",this,ge),de.bind(),Z.setColorMode(new Wr([te.ONE,te.ONE_MINUS_SRC_ALPHA,te.ZERO,te.ONE],r.am.transparent,[!0,!0,!0,!1])),Z.setDepthMode(new ji(u.func===te.LESS?te.LEQUAL:u.func,ji.ReadOnly,u.range)),Z.setStencilMode(Pr.disabled);const Te=3*S.primitiveLength*2,je=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const We=Y||1;for(let ut=0;ut<We;++ut)ge.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ut),te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,je)}else Y&&Y>1?te.drawElementsInstanced(te.LINES,Te,te.UNSIGNED_SHORT,je,Y):te.drawElements(te.LINES,Te,te.UNSIGNED_SHORT,je);w.bind(),Z.program.set(this.program),Z.setDepthMode(u),Z.setStencilMode(g),Z.setColorMode(x)}checkUniforms(n,u,g){if(this.fixedDefines.includes(u)){for(const x of Object.keys(g))if(!g[x].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${x} not set but required by ${u} being defined`)}}draw(n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge){const _e=n.context,Te=_e.gl;if(this.failedToCreate)return;_e.program.set(this.program),_e.setDepthMode(g),_e.setStencilMode(x),_e.setColorMode(w),_e.setCullFace(S);for(const ut of Object.keys(this.fixedUniforms))this.fixedUniforms[ut].set(this.program,ut,L[ut]);de&&de.setUniforms(this.program,_e,this.binderUniforms,Z,{zoom:te});const je={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[u];this.checkUniforms(P,"RENDER_SHADOWS",this.shadowUniforms);const We=ge&&ge>0?1:void 0;for(const ut of J.get()){const at=ut.vaos||(ut.vaos={});if((at[P]||(at[P]=new Ma)).bind(_e,this,V,de?de.getPaintVertexBuffers():[],Y,ut.vertexOffset,he||[],We),this.forceManualRenderingForInstanceIDShaders){const nt=ge||1;for(let qe=0;qe<nt;++qe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",qe),Y?Te.drawElements(u,ut.primitiveLength*je,Te.UNSIGNED_SHORT,ut.primitiveOffset*je*2):Te.drawArrays(u,ut.vertexOffset,ut.vertexLength)}else ge&&ge>1?Te.drawElementsInstanced(u,ut.primitiveLength*je,Te.UNSIGNED_SHORT,ut.primitiveOffset*je*2,ge):Y?Te.drawElements(u,ut.primitiveLength*je,Te.UNSIGNED_SHORT,ut.primitiveOffset*je*2):Te.drawArrays(u,ut.vertexOffset,ut.vertexLength);u===Te.TRIANGLES&&Y&&this._drawDebugWireframe(n,g,x,w,Y,ut,Z,te,de,ge)}}}function pd(p,n,u=0){const g=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,p.transform.tileZoom)/g,w=x*(n.tileID.canonical.x+n.tileID.wrap*g),S=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.aw(n,1,p.transform.tileZoom),u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S],u_pattern_transition:u}}const bh={terrain:0,flat:1},gA=r.bz(),D=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e)=>{const Te=n.style.light,je=Te.properties.get("position"),We=[je.x,je.y,je.z],ut=r.dx();Te.properties.get("anchor")==="viewport"&&(r.dy(ut,-n.transform.angle),r.dz(We,We,ut));const at=Te.properties.get("color").toPremultipliedRenderColor(null),nt=n.transform,qe={u_matrix:p,u_lightpos:We,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[at.r,at.g,at.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gA,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:bh[V],u_base_type:bh[Y],u_ao:x,u_edge_radius:w,u_width_scale:S,u_flood_light_color:de,u_vertical_scale:he,u_flood_light_intensity:ge,u_ground_shadow_factor:_e};return nt.projection.name==="globe"&&(qe.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],qe.u_zoom_transition=J,qe.u_inv_rot_matrix=te,qe.u_merc_center=Z,qe.u_up_dir=nt.projection.upVector(new r.cp(0,0,0),Z[0]*r.aj,Z[1]*r.aj),qe.u_height_lift=P),qe},K=(p,n,u,g,x,w)=>({u_matrix:p,u_edge_radius:n,u_width_scale:u,u_vertical_scale:g,u_height_type:bh[x],u_base_type:bh[w]}),se=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e)=>{const Te=D(p,n,u,g,x,w,S,L,V,Y,J,Z,te,de,he,ge,1,[0,0,0]),je={u_height_factor:-Math.pow(2,L.overscaledZ)/P.tileSize/8};return r.h(Te,pd(n,P,_e),je)},xe=(p,n,u)=>({u_matrix:p,u_emissive_strength:n,u_ground_shadow_factor:u}),Oe=(p,n,u,g,x,w=0)=>r.h(xe(p,n,x),pd(u,g,w)),Ke=(p,n,u,g)=>({u_matrix:p,u_world:u,u_emissive_strength:n,u_ground_shadow_factor:g}),et=(p,n,u,g,x,w,S=0)=>r.h(Oe(p,n,u,g,w,S),{u_world:x}),st=(p,n)=>({u_matrix:p,u_ground_shadow_factor:n}),dt=(p,n,u,g,x)=>({u_matrix:p,u_camera_pos:[n[0],n[1],n[2]],u_depth_bias:u,u_height_scale:g,u_reset_depth:x}),wt=(p,n,u,g)=>{const x=r.aj/u.tileSize;return{u_matrix:p,u_camera_to_center_distance:n.getCameraToCenterDistance(g),u_extrude_scale:[n.pixelsToGLUnits[0]/x,n.pixelsToGLUnits[1]/x]}},Xt=(p,n,u=1)=>({u_matrix:p,u_color:n,u_overlay:0,u_overlay_scale:u}),xi=r.bz(),Bi=(p,n,u,g,x,w,S)=>{const L=p.transform,P=L.projection.name==="globe",V=P?r.dA(L.zoom,n.canonical)*L._pixelsPerMercatorPixel:r.aw(u,1,w),Y={u_matrix:n.projMatrix,u_extrude_scale:V,u_intensity:S,u_inv_rot_matrix:xi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){Y.u_inv_rot_matrix=g,Y.u_merc_center=x,Y.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],Y.u_zoom_transition=r.ah(L.zoom);const J=x[0]*r.aj,Z=x[1]*r.aj;Y.u_up_dir=L.projection.upVector(new r.cp(0,0,0),J,Z)}return Y};function ci(p,[n,u,g,x],[w,S]){if(w===S)return[0,0,0,0];const L=255*(p-1)/(p*(S-w));return[n*L,u*L,g*L,x*L]}function Hi(p,n,[u,g]){return u===g?0:.5/p+(n-u)*(p-1)/(p*(g-u))}const Ni=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te,je,We)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:V,u_fade_t:Y.mix,u_opacity:Y.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:r.dC(J.paint.get("raster-saturation")),u_contrast_factor:r.dB(J.paint.get("raster-contrast")),u_spin_weights:Zt(J.paint.get("raster-hue-rotate")),u_perspective_transform:Z,u_raster_elevation:te,u_zoom_transition:S,u_merc_center:L,u_cutoff_params:P,u_colorization_mix:ci(r.dD,he,_e),u_colorization_offset:Hi(r.dD,ge,_e),u_color_ramp:de,u_texture_offset:[je/(Te+2*je),Te/(Te+2*je)],u_texture_res:[Te+2*je,Te+2*je],u_emissive_strength:We});function Zt(p){p*=Math.PI/180;const n=Math.sin(p),u=Math.cos(p);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const ei=.05,qi=(p,n,u,g,x,w,S,L,P,V,Y,J)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:w,u_scale_parent:V,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:J,u_zoom_transition:S,u_merc_center:L,u_cutoff_params:P}),cr=(p,n,u,g,x,w,S,L,P,V)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_tile_offset:u,u_velocity:g,u_color_ramp:w,u_velocity_res:x,u_max_speed:S,u_uv_offset:L,u_data_scale:[255*P[0],255*P[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[ei,ei]}),$i=(p,n,u,g,x,w,S,L,P,V)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_velocity:u,u_velocity_res:g,u_max_speed:x,u_speed_factor:w,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:L,u_data_scale:[255*P[0],255*P[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[ei,ei]}),Xr=r.bz(),Tr=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te,je,We,ut,at,nt)=>{const qe=x.transform,ht={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:qe.getCameraToCenterDistance(Te),u_rotate_symbol:+u,u_aspect_ratio:qe.width/qe.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:L,u_is_text:+V,u_elevation_from_sea:P?1:0,u_pitch_with_map:+g,u_texsize:Y,u_texsize_icon:J,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xr,u_up_vector:[0,-1,0],u_color_adj_mat:ut,u_icon_transition:at||0,u_gamma_scale:g?x.transform.getCameraToCenterDistance(Te)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:1,u_scale_factor:nt||1,u_ground_shadow_factor:je,u_inv_matrix:r.bi(r.bz(),S),u_normal_scale:We};return Te.name==="globe"&&(ht.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],ht.u_zoom_transition=de,ht.u_inv_rot_matrix=ge,ht.u_merc_center=he,ht.u_camera_forward=qe._camera.forward(),ht.u_ecef_origin=r.dE(qe.globeMatrix,te.toUnwrapped()),ht.u_tile_matrix=Float32Array.from(qe.globeMatrix),ht.u_up_vector=_e),ht},wn=(p,n,u,g)=>({u_matrix:p,u_emissive_strength:n,u_opacity:u,u_color:g}),zr=(p,n,u,g,x,w,S,L,P)=>r.h(function(V,Y,J,Z,te,de){const{width:he,height:ge}=Z.imageManager.getPixelSize(Y),_e=Math.pow(2,de.tileID.overscaledZ),Te=de.tileSize*Math.pow(2,Z.transform.tileZoom)/_e,je=Te*(de.tileID.canonical.x+de.tileID.wrap*_e),We=Te*de.tileID.canonical.y;return{u_image:0,u_pattern_tl:J.tl,u_pattern_br:J.br,u_texsize:[he,ge],u_pattern_size:J.displaySize,u_pattern_units_to_pixels:te?[Z.transform.width,-1*Z.transform.height]:[1/r.aw(de,1,Z.transform.tileZoom),1/r.aw(de,1,Z.transform.tileZoom)],u_pixel_coord_upper:[je>>16,We>>16],u_pixel_coord_lower:[65535&je,65535&We]}}(0,w,S,g,L,P),{u_matrix:p,u_emissive_strength:n,u_opacity:u}),Ms=new Float32Array(r.bx([])),Vs=(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te=[0,0,0],de)=>{const he=x.style.light,ge=he.properties.get("position"),_e=[-ge.x,-ge.y,ge.z],Te=r.dx();he.properties.get("anchor")==="viewport"&&(r.dy(Te,-x.transform.angle),r.dz(_e,_e,Te));const je=Y.alphaMode==="MASK",We=he.properties.get("color").toNonPremultipliedRenderColor(null),ut=Z.paint.get("model-ambient-occlusion-intensity"),at=Z.paint.get("model-color").constantOr(r.am.white).toNonPremultipliedRenderColor(null);return at.a=Z.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:p,u_lighting_matrix:n,u_normal_matrix:u,u_node_matrix:g||Ms,u_lightpos:_e,u_lightintensity:he.properties.get("intensity"),u_lightcolor:[We.r,We.g,We.b],u_camera_pos:te,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+je,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:L.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:P,u_roughnessFactor:V,u_baseColorTexture:Ko.BaseColor,u_metallicRoughnessTexture:Ko.MetallicRoughness,u_normalTexture:Ko.Normal,u_occlusionTexture:Ko.Occlusion,u_emissionTexture:Ko.Emission,u_lutTexture:Ko.LUT,u_color_mix:at.toArray01(),u_aoIntensity:ut,u_emissive_strength:J,u_occlusionTextureTransform:de||[0,0,0,0]}},Ps=(p,n=Ms,u=Ms)=>({u_matrix:p,u_instance:n,u_node_matrix:u}),Ar={fillExtrusion:p=>({u_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_vertical_gradient:new r.ca(p),u_opacity:new r.ca(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_ao:new r.cb(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_up_dir:new r.c9(p),u_height_lift:new r.ca(p),u_flood_light_color:new r.c9(p),u_vertical_scale:new r.ca(p),u_flood_light_intensity:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),fillExtrusionDepth:p=>({u_matrix:new r.cc(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_vertical_scale:new r.ca(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p)}),fillExtrusionPattern:p=>({u_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_vertical_gradient:new r.ca(p),u_height_factor:new r.ca(p),u_edge_radius:new r.ca(p),u_width_scale:new r.ca(p),u_ao:new r.cb(p),u_height_type:new r.c8(p),u_base_type:new r.c8(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_up_dir:new r.c9(p),u_height_lift:new r.ca(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_opacity:new r.ca(p),u_pattern_transition:new r.ca(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new r.cc(p),u_opacity:new r.ca(p),u_ao_pass:new r.ca(p),u_meter_to_tile:new r.ca(p),u_ao:new r.cb(p),u_flood_light_intensity:new r.ca(p),u_flood_light_color:new r.c9(p),u_attenuation:new r.ca(p),u_edge_radius:new r.ca(p),u_fb:new r.c8(p),u_fb_size:new r.ca(p),u_dynamic_offset:new r.ca(p)}),fill:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),fillPattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_pattern_transition:new r.ca(p)}),fillOutline:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_world:new r.cb(p),u_ground_shadow_factor:new r.c9(p)}),fillOutlinePattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_world:new r.cb(p),u_image:new r.c8(p),u_texsize:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_tile_units_to_pixels:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_pattern_transition:new r.ca(p)}),building:p=>({u_matrix:new r.cc(p),u_normal_matrix:new r.cc(p),u_opacity:new r.ca(p)}),buildingDepth:p=>({u_matrix:new r.cc(p)}),elevatedStructuresDepth:p=>({u_matrix:new r.cc(p),u_depth_bias:new r.ca(p)}),elevatedStructures:p=>({u_matrix:new r.cc(p),u_ground_shadow_factor:new r.c9(p)}),elevatedStructuresDepthReconstruct:p=>({u_matrix:new r.cc(p),u_camera_pos:new r.c9(p),u_depth_bias:new r.ca(p),u_height_scale:new r.ca(p),u_reset_depth:new r.ca(p)}),circle:r.dH,collisionBox:p=>({u_matrix:new r.cc(p),u_camera_to_center_distance:new r.ca(p),u_extrude_scale:new r.cb(p)}),collisionCircle:p=>({u_matrix:new r.cc(p),u_inv_matrix:new r.cc(p),u_camera_to_center_distance:new r.ca(p),u_viewport_size:new r.cb(p)}),debug:p=>({u_color:new r.di(p),u_matrix:new r.cc(p),u_overlay:new r.c8(p),u_overlay_scale:new r.ca(p)}),clippingMask:p=>({u_matrix:new r.cc(p)}),heatmap:p=>({u_extrude_scale:new r.ca(p),u_intensity:new r.ca(p),u_matrix:new r.cc(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_up_dir:new r.c9(p)}),heatmapTexture:p=>({u_image:new r.c8(p),u_color_ramp:new r.c8(p),u_opacity:new r.ca(p)}),hillshade:p=>({u_matrix:new r.cc(p),u_image:new r.c8(p),u_latrange:new r.cb(p),u_light:new r.cb(p),u_shadow:new r.di(p),u_highlight:new r.di(p),u_emissive_strength:new r.ca(p),u_accent:new r.di(p)}),hillshadePrepare:p=>({u_matrix:new r.cc(p),u_image:new r.c8(p),u_dimension:new r.cb(p),u_zoom:new r.ca(p)}),line:r.dG,linePattern:r.dF,raster:p=>({u_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_grid_matrix:new r.dj(p),u_tl_parent:new r.cb(p),u_scale_parent:new r.ca(p),u_fade_t:new r.ca(p),u_opacity:new r.ca(p),u_image0:new r.c8(p),u_image1:new r.c8(p),u_brightness_low:new r.ca(p),u_brightness_high:new r.ca(p),u_saturation_factor:new r.ca(p),u_contrast_factor:new r.ca(p),u_spin_weights:new r.c9(p),u_perspective_transform:new r.cb(p),u_raster_elevation:new r.ca(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_cutoff_params:new r.cQ(p),u_colorization_mix:new r.cQ(p),u_colorization_offset:new r.ca(p),u_color_ramp:new r.c8(p),u_texture_offset:new r.cb(p),u_texture_res:new r.cb(p),u_emissive_strength:new r.ca(p)}),rasterParticle:p=>({u_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_grid_matrix:new r.dj(p),u_tl_parent:new r.cb(p),u_scale_parent:new r.ca(p),u_fade_t:new r.ca(p),u_opacity:new r.ca(p),u_image0:new r.c8(p),u_image1:new r.c8(p),u_raster_elevation:new r.ca(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_cutoff_params:new r.cQ(p)}),rasterParticleTexture:p=>({u_texture:new r.c8(p),u_opacity:new r.ca(p)}),rasterParticleDraw:p=>({u_particle_texture:new r.c8(p),u_particle_texture_side_len:new r.ca(p),u_tile_offset:new r.cb(p),u_velocity:new r.c8(p),u_color_ramp:new r.c8(p),u_velocity_res:new r.cb(p),u_max_speed:new r.ca(p),u_uv_offset:new r.cb(p),u_data_scale:new r.cb(p),u_data_offset:new r.ca(p),u_particle_pos_scale:new r.ca(p),u_particle_pos_offset:new r.cb(p)}),rasterParticleUpdate:p=>({u_particle_texture:new r.c8(p),u_particle_texture_side_len:new r.ca(p),u_velocity:new r.c8(p),u_velocity_res:new r.cb(p),u_max_speed:new r.ca(p),u_speed_factor:new r.ca(p),u_reset_rate:new r.ca(p),u_rand_seed:new r.ca(p),u_uv_offset:new r.cb(p),u_data_scale:new r.cb(p),u_data_offset:new r.ca(p),u_particle_pos_scale:new r.ca(p),u_particle_pos_offset:new r.cb(p)}),symbol:p=>({u_is_size_zoom_constant:new r.c8(p),u_is_size_feature_constant:new r.c8(p),u_size_t:new r.ca(p),u_size:new r.ca(p),u_camera_to_center_distance:new r.ca(p),u_rotate_symbol:new r.c8(p),u_aspect_ratio:new r.ca(p),u_fade_change:new r.ca(p),u_matrix:new r.cc(p),u_label_plane_matrix:new r.cc(p),u_coord_matrix:new r.cc(p),u_is_text:new r.c8(p),u_elevation_from_sea:new r.c8(p),u_pitch_with_map:new r.c8(p),u_texsize:new r.cb(p),u_texsize_icon:new r.cb(p),u_texture:new r.c8(p),u_texture_icon:new r.c8(p),u_gamma_scale:new r.ca(p),u_device_pixel_ratio:new r.ca(p),u_tile_id:new r.c9(p),u_zoom_transition:new r.ca(p),u_inv_rot_matrix:new r.cc(p),u_merc_center:new r.cb(p),u_camera_forward:new r.c9(p),u_tile_matrix:new r.cc(p),u_up_vector:new r.c9(p),u_ecef_origin:new r.c9(p),u_is_halo:new r.c8(p),u_icon_transition:new r.ca(p),u_color_adj_mat:new r.cc(p),u_scale_factor:new r.ca(p),u_ground_shadow_factor:new r.c9(p),u_inv_matrix:new r.cc(p),u_normal_scale:new r.ca(p)}),background:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_opacity:new r.ca(p),u_color:new r.di(p)}),backgroundPattern:p=>({u_matrix:new r.cc(p),u_emissive_strength:new r.ca(p),u_opacity:new r.ca(p),u_image:new r.c8(p),u_pattern_tl:new r.cb(p),u_pattern_br:new r.cb(p),u_texsize:new r.cb(p),u_pattern_size:new r.cb(p),u_pixel_coord_upper:new r.cb(p),u_pixel_coord_lower:new r.cb(p),u_pattern_units_to_pixels:new r.cb(p)}),terrainRaster:p=>({u_matrix:new r.cc(p),u_image0:new r.c8(p),u_skirt_height:new r.ca(p),u_ground_shadow_factor:new r.c9(p)}),skybox:p=>({u_matrix:new r.cc(p),u_sun_direction:new r.c9(p),u_cubemap:new r.c8(p),u_opacity:new r.ca(p),u_temporal_offset:new r.ca(p)}),skyboxGradient:p=>({u_matrix:new r.cc(p),u_color_ramp:new r.c8(p),u_center_direction:new r.c9(p),u_radius:new r.ca(p),u_opacity:new r.ca(p),u_temporal_offset:new r.ca(p)}),skyboxCapture:p=>({u_matrix_3f:new r.dj(p),u_sun_direction:new r.c9(p),u_sun_intensity:new r.ca(p),u_color_tint_r:new r.cQ(p),u_color_tint_m:new r.cQ(p),u_luminance:new r.ca(p)}),globeRaster:p=>({u_proj_matrix:new r.cc(p),u_globe_matrix:new r.cc(p),u_normalize_matrix:new r.cc(p),u_merc_matrix:new r.cc(p),u_zoom_transition:new r.ca(p),u_merc_center:new r.cb(p),u_image0:new r.c8(p),u_grid_matrix:new r.dj(p),u_skirt_height:new r.ca(p),u_far_z_cutoff:new r.ca(p),u_frustum_tl:new r.c9(p),u_frustum_tr:new r.c9(p),u_frustum_br:new r.c9(p),u_frustum_bl:new r.c9(p),u_globe_pos:new r.c9(p),u_globe_radius:new r.ca(p),u_viewport:new r.cb(p)}),globeAtmosphere:p=>({u_frustum_tl:new r.c9(p),u_frustum_tr:new r.c9(p),u_frustum_br:new r.c9(p),u_frustum_bl:new r.c9(p),u_horizon:new r.ca(p),u_transition:new r.ca(p),u_fadeout_range:new r.ca(p),u_color:new r.cQ(p),u_high_color:new r.cQ(p),u_space_color:new r.cQ(p),u_temporal_offset:new r.ca(p),u_horizon_angle:new r.ca(p)}),model:p=>({u_matrix:new r.cc(p),u_lighting_matrix:new r.cc(p),u_normal_matrix:new r.cc(p),u_node_matrix:new r.cc(p),u_lightpos:new r.c9(p),u_lightintensity:new r.ca(p),u_lightcolor:new r.c9(p),u_camera_pos:new r.c9(p),u_opacity:new r.ca(p),u_baseColorFactor:new r.cQ(p),u_emissiveFactor:new r.cQ(p),u_metallicFactor:new r.ca(p),u_roughnessFactor:new r.ca(p),u_baseTextureIsAlpha:new r.c8(p),u_alphaMask:new r.c8(p),u_alphaCutoff:new r.ca(p),u_baseColorTexture:new r.c8(p),u_metallicRoughnessTexture:new r.c8(p),u_normalTexture:new r.c8(p),u_occlusionTexture:new r.c8(p),u_emissionTexture:new r.c8(p),u_lutTexture:new r.c8(p),u_color_mix:new r.cQ(p),u_aoIntensity:new r.ca(p),u_emissive_strength:new r.ca(p),u_occlusionTextureTransform:new r.cQ(p)}),modelDepth:p=>({u_matrix:new r.cc(p),u_instance:new r.cc(p),u_node_matrix:new r.cc(p)}),groundShadow:p=>({u_matrix:new r.cc(p),u_ground_shadow_factor:new r.c9(p)}),stars:p=>({u_matrix:new r.cc(p),u_up:new r.c9(p),u_right:new r.c9(p),u_intensity_multiplier:new r.ca(p)}),snowParticle:p=>({u_modelview:new r.cc(p),u_projection:new r.cc(p),u_time:new r.ca(p),u_cam_pos:new r.c9(p),u_velocityConeAperture:new r.ca(p),u_velocity:new r.ca(p),u_horizontalOscillationRadius:new r.ca(p),u_horizontalOscillationRate:new r.ca(p),u_boxSize:new r.ca(p),u_billboardSize:new r.ca(p),u_simpleShapeParameters:new r.cb(p),u_screenSize:new r.cb(p),u_thinningCenterPos:new r.cb(p),u_thinningShape:new r.c9(p),u_thinningAffectedRatio:new r.ca(p),u_thinningParticleOffset:new r.ca(p),u_particleColor:new r.cQ(p),u_direction:new r.c9(p)}),rainParticle:p=>({u_modelview:new r.cc(p),u_projection:new r.cc(p),u_time:new r.ca(p),u_cam_pos:new r.c9(p),u_texScreen:new r.c8(p),u_velocityConeAperture:new r.ca(p),u_velocity:new r.ca(p),u_boxSize:new r.ca(p),u_rainDropletSize:new r.cb(p),u_distortionStrength:new r.ca(p),u_rainDirection:new r.c9(p),u_color:new r.cQ(p),u_screenSize:new r.cb(p),u_thinningCenterPos:new r.cb(p),u_thinningShape:new r.c9(p),u_thinningAffectedRatio:new r.ca(p),u_thinningParticleOffset:new r.ca(p),u_shapeDirectionalPower:new r.ca(p),u_shapeNormalPower:new r.ca(p),u_mode:new r.ca(p)}),vignette:p=>({u_vignetteShape:new r.c9(p),u_vignetteColor:new r.cQ(p)}),occlusion:p=>({u_matrix:new r.cc(p),u_anchorPos:new r.c9(p),u_screenSizePx:new r.cb(p),u_occluderSizePx:new r.cb(p),u_color:new r.cQ(p)})};class ys{constructor(n,u,g,x){this.id=ys.uniqueIdxCounter,ys.uniqueIdxCounter++,this.context=n;const w=n.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||x||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=ys.uniqueIdxCounter,ys.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ys.uniqueIdxCounter=0;const co={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Kn{constructor(n,u,g,x,w,S){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.instanceCount=S,this.context=n;const L=n.gl;this.buffer=L.createBuffer(),n.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||w||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let g=0;g<this.attributes.length;g++){const x=u.attributes[this.attributes[g].name];x!==void 0&&n.enableVertexAttribArray(x)}}setVertexAttribPointers(n,u,g){for(let x=0;x<this.attributes.length;x++){const w=this.attributes[x],S=u.attributes[w.name];S!==void 0&&n.vertexAttribPointer(S,w.components,n[co[w.type]],!1,this.itemSize,w.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(n,u,g){for(let x=0;x<this.attributes.length;x++){const w=u.attributes[this.attributes[x].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(w,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $s{constructor(n,u,g,x,w){this.context=n,this.width=u,this.height=g;const S=this.framebuffer=n.gl.createFramebuffer();x&&(this.colorAttachment=new zf(n,S)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new uA(n,S):new dd(n,S))}destroy(){const n=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&n.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&n.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&n.deleteTexture(u)}n.deleteFramebuffer(this.framebuffer)}}class Tl{constructor(n,u){this.gl=n,this.clearColor=new hd(this),this.clearDepth=new Hu(this),this.clearStencil=new Pf(this),this.colorMask=new $A(this),this.depthMask=new ZA(this),this.stencilMask=new nA(this),this.stencilFunc=new yh(this),this.stencilOp=new Rp(this),this.stencilTest=new sA(this),this.depthRange=new kf(this),this.depthTest=new Rf(this),this.depthFunc=new Vh(this),this.blend=new oA(this),this.blendFunc=new JA(this),this.blendColor=new vh(this),this.blendEquation=new Qu(this),this.cullFace=new Cu(this),this.cullFaceSide=new Vu(this),this.frontFace=new Gh(this),this.program=new Df(this),this.activeTexture=new aA(this),this.viewport=new Of(this),this.bindFramebuffer=new Wh(this),this.bindRenderbuffer=new lA(this),this.bindTexture=new cA(this),this.bindVertexBuffer=new Xc(this),this.bindElementBuffer=new Il(this),this.bindVertexArrayOES=new il(this),this.pixelStoreUnpack=new Uf(this),this.pixelStoreUnpackPremultiplyAlpha=new ef(this),this.pixelStoreUnpackFlipY=new Yc(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u,g){return new ys(this,n,u,g)}createVertexBuffer(n,u,g,x,w){return new Kn(this,n,u,g,x,w)}createRenderbuffer(n,u,g){const x=this.gl,w=x.createRenderbuffer();return this.bindRenderbuffer.set(w),x.renderbufferStorage(x.RENDERBUFFER,n,u,g),this.bindRenderbuffer.set(null),w}createFramebuffer(n,u,g,x){return new $s(this,n,u,g,x)}clear({color:n,depth:u,stencil:g,colorMask:x}){const w=this.gl;let S=0;n&&(S|=w.COLOR_BUFFER_BIT,this.clearColor.set(n.toNonPremultipliedRenderColor(null)),this.colorMask.set(x||[!0,!0,!0,!0])),u!==void 0&&(S|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(S|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),w.clear(S)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){r.bv(n.blendFunction,Wr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let wo;function aa(p,n,u,g,x,w,S){const L=p.context,P=L.gl,V=p.transform,Y=p.getOrCreateProgram("collisionBox"),J=[];let Z=0,te=0;for(let We=0;We<g.length;We++){const ut=g[We],at=n.getTile(ut),nt=at.getBucket(u);if(!nt)continue;const qe=Er(ut,nt,V);let ht=qe;x[0]===0&&x[1]===0||(ht=p.translatePosMatrix(qe,at,x,w));const ft=S?nt.textCollisionBox:nt.iconCollisionBox,Rt=nt.collisionCircleArray;if(Rt.length>0){const Ot=r.bz(),ti=ht;r.cB(Ot,nt.placementInvProjMatrix,V.glCoordMatrix),r.cB(Ot,Ot,nt.placementViewportMatrix),J.push({circleArray:Rt,circleOffset:te,transform:ti,invTransform:Ot,projection:nt.getProjection()}),Z+=Rt.length/4,te=Z}ft&&(p.terrain&&p.terrain.setupElevationDraw(at,Y),Y.draw(p,P.LINES,ji.disabled,Pr.disabled,p.colorModeForRenderPass(),wr.disabled,wt(ht,V,at,nt.getProjection()),u.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,null,V.zoom,null,[ft.collisionVertexBuffer,ft.collisionVertexBufferExt]))}if(!S||!J.length)return;const de=p.getOrCreateProgram("collisionCircle"),he=new r.dI;he.resize(4*Z),he._trim();let ge=0;for(const We of J)for(let ut=0;ut<We.circleArray.length/4;ut++){const at=4*ut,nt=We.circleArray[at+0],qe=We.circleArray[at+1],ht=We.circleArray[at+2],ft=We.circleArray[at+3];he.emplace(ge++,nt,qe,ht,ft,0),he.emplace(ge++,nt,qe,ht,ft,1),he.emplace(ge++,nt,qe,ht,ft,2),he.emplace(ge++,nt,qe,ht,ft,3)}(!wo||wo.length<2*Z)&&(wo=function(We){const ut=2*We,at=new r.a_;at.resize(ut),at._trim();for(let nt=0;nt<ut;nt++){const qe=6*nt;at.uint16[qe+0]=4*nt+0,at.uint16[qe+1]=4*nt+1,at.uint16[qe+2]=4*nt+2,at.uint16[qe+3]=4*nt+2,at.uint16[qe+4]=4*nt+3,at.uint16[qe+5]=4*nt+0}return at}(Z));const _e=L.createIndexBuffer(wo,!0),Te=L.createVertexBuffer(he,r.dJ.members,!0);for(const We of J){const ut={u_matrix:We.transform,u_inv_matrix:We.invTransform,u_camera_to_center_distance:(je=V).getCameraToCenterDistance(We.projection),u_viewport_size:[je.width,je.height]};de.draw(p,P.TRIANGLES,ji.disabled,Pr.disabled,p.colorModeForRenderPass(),wr.disabled,ut,u.id,Te,_e,r.bd.simpleSegment(0,2*We.circleOffset,We.circleArray.length,We.circleArray.length/2),null,V.zoom)}var je;Te.destroy(),_e.destroy()}const cs=r.bz();function ja(p){const n=p._camera.getWorldToCamera(p.worldSize,1),u=r.az([],n,p.globeMatrix);r.bi(u,u);const g=[0,0,0],x=[0,1,0,0];return r.aA(x,x,u),g[0]=x[0],g[1]=x[1],g[2]=x[2],r.au(g,g),g}function Ha({width:p,height:n,anchor:u,textOffset:g,textScale:x},w){const{horizontalAlign:S,verticalAlign:L}=r.bT(u),P=-(S-.5)*p,V=-(L-.5)*n,Y=r.bU(u,g);return new r.P((P/x+Y[0])*w,(V/x+Y[1])*w)}function Ca(p,n,u,g,x,w,S,L,P,V){const Y=p.text.placedSymbolArray,J=p.text.dynamicLayoutVertexArray,Z=p.icon.dynamicLayoutVertexArray,te={},de=p.getProjection(),he=fh(S,de,x),ge=x.elevation,_e=de.upVectorScale(S.canonical,x.center.lat,x.worldSize).metersToTile;J.clear();for(let Te=0;Te<Y.length;Te++){const je=Y.get(Te),{tileAnchorX:We,tileAnchorY:ut,numGlyphs:at}=je,nt=je.hidden||!je.crossTileID||p.allowVerticalPlacement&&!je.placedOrientation?null:g[je.crossTileID];if(nt){let qe=0,ht=0,ft=0;if(ge){const oi=ge?ge.getAtTileOffset(S,We,ut):0,[zt,gi,Li]=de.upVector(S.canonical,We,ut);qe=oi*zt*_e,ht=oi*gi*_e,ft=oi*Li*_e}let[Rt,Ot,ti,ri]=Bl(je.projectedAnchorX+qe,je.projectedAnchorY+ht,je.projectedAnchorZ+ft,u?he:w);const vi=zo(x.getCameraToCenterDistance(de),ri);let Pt=r.bJ(p.textSizeData,P,je)*vi/r.bO;u&&(Pt*=p.tilePixelRatio/L);const Qt=Ha(nt,Pt);u?({x:Rt,y:Ot,z:ti}=de.projectTilePoint(We+Qt.x,ut+Qt.y,S.canonical),[Rt,Ot,ti]=Bl(Rt+qe,Ot+ht,ti+ft,w)):(n&&Qt._rotate(-x.angle),Rt+=Qt.x,Ot+=Qt.y,ti=0);const Ct=p.allowVerticalPlacement&&je.placedOrientation===r.bI.vertical?Math.PI/2:0;for(let oi=0;oi<at;oi++)r.bL(J,Rt,Ot,ti,Ct);V&&je.associatedIconIndex>=0&&(te[je.associatedIconIndex]={x:Rt,y:Ot,z:ti,angle:Ct})}else Cl(at,J)}if(V){Z.clear();const Te=p.icon.placedSymbolArray;for(let je=0;je<Te.length;je++){const We=Te.get(je),{numGlyphs:ut}=We,at=te[je];if(We.hidden||!at)Cl(ut,Z);else{const{x:nt,y:qe,z:ht,angle:ft}=at;for(let Rt=0;Rt<ut;Rt++)r.bL(Z,nt,qe,ht,ft)}}p.icon.dynamicLayoutVertexBuffer.updateData(Z)}p.text.dynamicLayoutVertexBuffer.updateData(J)}function uo(p,n,u,g,x,w,S={}){const L=u.paint.get("icon-translate"),P=u.paint.get("text-translate"),V=u.paint.get("icon-translate-anchor"),Y=u.paint.get("text-translate-anchor"),J=u.layout.get("icon-rotation-alignment"),Z=u.layout.get("text-rotation-alignment"),te=u.layout.get("icon-pitch-alignment"),de=u.layout.get("text-pitch-alignment"),he=u.layout.get("icon-keep-upright"),ge=u.layout.get("text-keep-upright"),_e=u.paint.get("icon-color-saturation"),Te=u.paint.get("icon-color-contrast"),je=u.paint.get("icon-color-brightness-min"),We=u.paint.get("icon-color-brightness-max"),ut=u.layout.get("symbol-elevation-reference")==="sea",at=p.context,nt=at.gl,qe=p.transform,ht=J==="map",ft=Z==="map",Rt=te==="map",Ot=de==="map",ti=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ri=!1;const vi=p.depthModeForSublayer(0,ji.ReadOnly),Pt=new ji(p.context.gl.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),Qt=[r.aD(qe.center.lng),r.aH(qe.center.lat)],Ct=u.layout.get("text-variable-anchor"),oi=qe.projection.name==="globe",zt=[],gi=[0,-1,0];for(const Li of g){const ai=n.getTile(Li),Mi=ai.getBucket(u);if(!Mi||Mi.projection.name==="mercator"&&oi||Mi.fullyClipped)continue;const ir=Mi.projection.name==="globe",tr=ir?r.ah(qe.zoom):0,Ki=fh(Li,Mi.getProjection(),qe),pr=qe.calculatePixelsToTileUnitsMatrix(ai),gr=Ct&&Mi.hasTextData(),Cr=Mi.hasIconTextFit()&&gr&&Mi.hasIconData(),Hr=Mi.getProjection().createInversionMatrix(qe,Li.canonical),sn=(1<<ai.tileID.canonical.z)*r.aj/p.transform.worldSize,Zn=Ts=>{let Xn=[0,0,0];if(Ts){const to=p.style.directionalLight,Ln=p.style.ambientLight;to&&Ln&&(Xn=oa(p.style,to,Ln))}return Xn},ws=Ts=>{qe.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||p.terrain)&&(Ts.push("DEPTH_D24"),Ts.push("DEPTH_OCCLUSION"))},rs=()=>{const Ts=ht&&u.layout.get("symbol-placement")!=="point",Xn=[];ws(Xn);const to=Ts||Cr,Ln=Mi.elevationType==="road"&&Rt,Lo=p.shadowRenderer,Ds=Ln&&!!Lo&&Lo.enabled,N=Zn(Ds),O=Ln?Pt:vi,X=u.paint.get("icon-image-cross-fade");p.terrainRenderModeElevated()&&Rt&&Xn.push("PITCH_WITH_MAP_TERRAIN"),ir&&(Xn.push("PROJECTION_GLOBE_VIEW"),to&&Xn.push("PROJECTED_POS_ON_VIEWPORT")),X>0&&Xn.push("ICON_TRANSITION"),Mi.icon.zOffsetVertexBuffer&&Xn.push("Z_OFFSET"),_e===0&&Te===0&&je===0&&We===1||Xn.push("COLOR_ADJUSTMENT"),Mi.sdfIcons&&Xn.push("RENDER_SDF"),Ds&&Xn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ln&&Mi.icon.orientationVertexBuffer&&Xn.push("ELEVATED_ROADS");const W=Mi.icon.programConfigurations.get(u.id),ce=p.getOrCreateProgram("symbol",{config:W,defines:Xn}),Be=ai.imageAtlasTexture?ai.imageAtlasTexture.size:[0,0],De=Mi.iconSizeData,gt=r.bH(De,qe.zoom),pt=Rt||!qe.isOrthographic,Ht=$a(Ki,ai.tileID.canonical,Rt,ht,qe,Mi.getProjection(),pr),si=mu(Ki,ai.tileID.canonical,Rt,ht,qe,Mi.getProjection(),pr),pi=p.translatePosMatrix(si,ai,L,V,!0),Ui=p.translatePosMatrix(Ki,ai,L,V),Gr=to?cs:Ht,vr=ht&&!Rt&&!Ts;let Rr=gi;!oi&&!qe.mercatorFromTransition||ht||(Rr=ja(qe));const Jn=ir?Rr:gi,An=u.getColorAdjustmentMatrix(_e,Te,je,We),rn=Tr(De.kind,gt,vr,Rt,p,Ui,Gr,pi,ut,!1,Be,[0,0],0,Li,tr,Qt,Hr,Jn,Mi.getProjection(),N,sn,An,X,null),Ys=ai.imageAtlasTexture?ai.imageAtlasTexture:null,ns=u.layout.get("icon-size").constantOr(0)!==1||Mi.iconsNeedLinear,Un=Mi.sdfIcons||p.options.rotating||p.options.zooming||ns||pt?nt.LINEAR:nt.NEAREST,Kr=Mi.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,os=p.terrain&&Rt&&Ts?r.bi(r.bz(),Ht):cs;if(Ts&&Mi.icon){const Bs=qe.elevation,Mn=Bs?Bs.getAtTileOffsetFunc(Li,qe.center.lat,qe.worldSize,Mi.getProjection()):null,Mo=gu(Ki,ai.tileID.canonical,Rt,ht,qe,Mi.getProjection(),pr);rc(Mi,Ki,p,!1,Mo,si,Rt,he,Mn,Li)}return{program:ce,buffers:Mi.icon,uniformValues:rn,atlasTexture:Ys,atlasTextureIcon:null,atlasInterpolation:Un,atlasInterpolationIcon:null,isSDF:Mi.sdfIcons,hasHalo:Kr,depthMode:O,tile:ai,renderWithShadows:Ds,labelPlaneMatrixInv:os}},ss=()=>{const Ts=ft&&u.layout.get("symbol-placement")!=="point",Xn=[],to=Ts||Ct||Cr,Ln=Mi.elevationType==="road"&&Ot,Lo=p.shadowRenderer,Ds=Ln&&!!Lo&&Lo.enabled,N=Zn(Ds),O=Ln?Pt:vi;p.terrainRenderModeElevated()&&Ot&&Xn.push("PITCH_WITH_MAP_TERRAIN"),ir&&(Xn.push("PROJECTION_GLOBE_VIEW"),to&&Xn.push("PROJECTED_POS_ON_VIEWPORT")),Mi.text.zOffsetVertexBuffer&&Xn.push("Z_OFFSET"),Mi.iconsInText&&Xn.push("RENDER_TEXT_AND_SYMBOL"),Xn.push("RENDER_SDF"),Ds&&Xn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ln&&Mi.text.orientationVertexBuffer&&Xn.push("ELEVATED_ROADS"),ws(Xn);const X=Mi.text.programConfigurations.get(u.id),W=p.getOrCreateProgram("symbol",{config:X,defines:Xn});let ce,Be=[0,0],De=null;const gt=Mi.textSizeData;Mi.iconsInText&&(Be=ai.imageAtlasTexture?ai.imageAtlasTexture.size:[0,0],De=ai.imageAtlasTexture?ai.imageAtlasTexture:null,ce=Ot||!qe.isOrthographic||p.options.rotating||p.options.zooming||gt.kind==="composite"||gt.kind==="camera"?nt.LINEAR:nt.NEAREST);const pt=ai.glyphAtlasTexture?ai.glyphAtlasTexture.size:[0,0],Ht=u.layout.get("text-size-scale-range"),si=r.ay(p.scaleFactor,Ht[0],Ht[1]),pi=r.bH(gt,qe.zoom,si),Ui=$a(Ki,ai.tileID.canonical,Ot,ft,qe,Mi.getProjection(),pr),Gr=mu(Ki,ai.tileID.canonical,Ot,ft,qe,Mi.getProjection(),pr),vr=p.translatePosMatrix(Gr,ai,P,Y,!0),Rr=p.translatePosMatrix(Ki,ai,P,Y),Jn=to?cs:Ui,An=ft&&!Ot&&!Ts;let rn=gi;!oi&&!qe.mercatorFromTransition||ft||(rn=ja(qe));const Ys=Tr(gt.kind,pi,An,Ot,p,Rr,Jn,vr,ut,!0,pt,Be,0,Li,tr,Qt,Hr,ir?rn:gi,Mi.getProjection(),N,sn,null,null,si),ns=ai.glyphAtlasTexture?ai.glyphAtlasTexture:null,Un=nt.LINEAR,Kr=u.paint.get("text-halo-width").constantOr(1)!==0,os=p.terrain&&Ot&&Ts?r.bi(r.bz(),Ui):cs;if(Ts&&Mi.text){const Bs=qe.elevation,Mn=Bs?Bs.getAtTileOffsetFunc(Li,qe.center.lat,qe.worldSize,Mi.getProjection()):null,Mo=gu(Ki,ai.tileID.canonical,Ot,ft,qe,Mi.getProjection(),pr);rc(Mi,Ki,p,!0,Mo,Gr,Ot,ge,Mn,Li)}return{program:W,buffers:Mi.text,uniformValues:Ys,atlasTexture:ns,atlasTextureIcon:De,atlasInterpolation:Un,atlasInterpolationIcon:ce,isSDF:!0,hasHalo:Kr,depthMode:O,tile:ai,renderWithShadows:Ds,labelPlaneMatrixInv:os}},ho=Mi.icon.segments.get().length,Jr=Mi.text.segments.get().length,ln=ho&&!S.onlyText?rs():null,vn=Jr&&!S.onlyIcons?ss():null,Rs=u.paint.get("icon-opacity").constantOr(1),Vo=u.paint.get("text-opacity").constantOr(1);if(ti&&Mi.canOverlap){ri=!0;const Ts=Rs&&!S.onlyText?Mi.icon.segments.get():[],Xn=Vo&&!S.onlyIcons?Mi.text.segments.get():[];for(const to of Ts)zt.push({segments:new r.bd([to]),sortKey:to.sortKey,state:ln});for(const to of Xn)zt.push({segments:new r.bd([to]),sortKey:to.sortKey,state:vn})}else S.onlyText||zt.push({segments:Rs?Mi.icon.segments:new r.bd([]),sortKey:0,state:ln}),S.onlyIcons||zt.push({segments:Vo?Mi.text.segments:new r.bd([]),sortKey:0,state:vn})}ri&&zt.sort((Li,ai)=>Li.sortKey-ai.sortKey);for(const Li of zt){const ai=Li.state;if(ai)if(p.terrain?p.terrain.setupElevationDraw(ai.tile,ai.program,{useDepthForOcclusion:qe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ai.labelPlaneMatrixInv}):p.setupDepthForOcclusion(qe.depthOcclusionForSymbolsAndCircles,ai.program),at.activeTexture.set(nt.TEXTURE0),ai.atlasTexture&&ai.atlasTexture.bind(ai.atlasInterpolation,nt.CLAMP_TO_EDGE,!0),ai.atlasTextureIcon&&(at.activeTexture.set(nt.TEXTURE1),ai.atlasTextureIcon&&ai.atlasTextureIcon.bind(ai.atlasInterpolationIcon,nt.CLAMP_TO_EDGE,!0)),ai.renderWithShadows&&p.shadowRenderer.setupShadows(ai.tile.tileID.toUnwrapped(),ai.program,"vector-tile",ai.tile.tileID.overscaledZ),p.uploadCommonLightUniforms(p.context,ai.program),ai.hasHalo){const Mi=ai.uniformValues;Mi.u_is_halo=1,Zo(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,x,w,Mi,2),Mi.u_is_halo=0}else{if(ai.isSDF){const Mi=ai.uniformValues;ai.hasHalo&&(Mi.u_is_halo=1,Zo(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,x,w,Mi,1)),Mi.u_is_halo=0}Zo(ai.buffers,Li.segments,u,p,ai.program,ai.depthMode,x,w,ai.uniformValues,1)}}}function Zo(p,n,u,g,x,w,S,L,P,V){const Y=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer,p.orientationVertexBuffer];x.draw(g,g.context.gl.TRIANGLES,w,S,L,wr.disabled,P,u.id,p.layoutVertexBuffer,p.indexBuffer,n,u.paint,g.transform.zoom,p.programConfigurations.get(u.id),Y,V)}function Qa(p,n){const u=1<<p.canonical.z,g=(n.x*u-p.canonical.x-p.wrap*u)*r.aj,x=(n.y*u-p.canonical.y)*r.aj,w=r.dS(n.z,n.y);return r.cS(g,x,w)}function cc(p,n,u,g,x){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const w=p.context.gl,S=new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),L=new ji(p.context.gl.GREATER,ji.ReadWrite,p.depthRangeFor3D),P=function(te){const de=r.cJ(te.pitch);let he=.01;return te.isOrthographic&&(he=r.ai(1e-4,he,r.cN(de>=Io?1:de/Io))),2*he}(p.transform),V=p.transform.getFreeCameraOptions().position,Y="elevatedStructuresDepthReconstruct",J=p.getOrCreateProgram(Y,{defines:["DEPTH_RECONSTRUCTION"]}),Z=p.getOrCreateProgram(Y);for(const te of g){const de=n.getTile(te),he=de.getBucket(u);if(!he)continue;const ge=he.elevatedStructures;if(!ge)continue;const _e=he.elevationBufferData.heightRange,Te=Qa(te.toUnwrapped(),V),je=p.translatePosMatrix(te.projMatrix,de,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let We,ut,at,nt;if(x==="initialize"){if(!_e||_e.min>=1||ge.depthSegments.segments[0].primitiveLength===0)continue;We=dt(je,Te,P,1,0),ut=S,at=ge.depthSegments,nt=J}else if(x==="reset"){if(!_e||_e.min>=0||ge.maskSegments.segments[0].primitiveLength===0)continue;We=dt(je,Te,0,0,1),ut=L,at=ge.maskSegments,nt=J}else if(x==="geometry"){if(ge.depthSegments.segments[0].primitiveLength===0)continue;We=dt(je,Te,P,1,0),ut=S,at=ge.depthSegments,nt=Z}nt.draw(p,w.TRIANGLES,ut,Pr.disabled,Wr.disabled,wr.disabled,We,u.id,ge.vertexBuffer,ge.indexBuffer,at,u.paint,p.transform.zoom)}}function la(p,n,u){const{painter:g,sourceCache:x,layer:w,coords:S,colorMode:L,elevationType:P,terrainEnabled:V,pass:Y}=p,J=g.context.gl,Z=w.paint.get("fill-pattern"),te=w.paint.get("fill-pattern-cross-fade"),de=Z.constantOr(null);let he=P;P!=="road"||n&&!V||(he="none");const ge=he==="road",_e=p.painter.shadowRenderer,Te=ge&&!!_e&&_e.enabled,je=new ji(g.context.gl.LEQUAL,ji.ReadOnly,g.depthRangeFor3D);let We=[0,0,0];if(Te){const nt=g.style.directionalLight,qe=g.style.ambientLight;nt&&qe&&(We=oa(g.style,nt,qe))}const ut=Z&&Z.constantOr(1),at=(nt,qe)=>{let ht,ft,Rt,Ot,ti;qe?(ht=ut&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Rt=J.LINES):(ht=ut?"fillPattern":"fill",Rt=J.TRIANGLES);for(const ri of S){const vi=x.getTile(ri);if(ut&&!vi.patternsLoaded())continue;const Pt=vi.getBucket(w);if(!Pt)continue;const Qt=n?Pt.elevationBufferData:Pt.bufferData;if(Qt.isEmpty())continue;g.prepareDrawTile();const Ct=Qt.programConfigurations.get(w.id),oi=g.isTileAffectedByFog(ri),zt=[],gi=[];ge&&(zt.push("ELEVATED_ROADS"),gi.push(Qt.elevatedLayoutVertexBuffer)),Te&&zt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ut&&(g.context.activeTexture.set(J.TEXTURE0),vi.imageAtlasTexture&&vi.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Ct.updatePaintBuffers());let Li=!1;if(de&&vi.imageAtlas){const Ki=vi.imageAtlas,pr=r.dN.from(de),gr=pr.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),Cr=pr.getSecondary(),Hr=Ki.patternPositions.get(gr),sn=Cr?Ki.patternPositions.get(Cr.scaleSelf(r.q.devicePixelRatio).toString()):null;Li=!!Hr&&!!sn,Hr&&Ct.setConstantPatternPositions(Hr,sn)}te>0&&(Li||Ct.getPatternTransitionVertexBuffer("fill-pattern"))&&zt.push("FILL_PATTERN_TRANSITION");const ai=g.getOrCreateProgram(ht,{config:Ct,overrideFog:oi,defines:zt}),Mi=g.translatePosMatrix(ri.projMatrix,vi,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));Te&&_e.setupShadows(vi.tileID.toUnwrapped(),ai,"vector-tile",vi.tileID.overscaledZ);const ir=w.paint.get("fill-emissive-strength");if(qe){Ot=Qt.lineIndexBuffer,ti=Qt.lineSegments;const Ki=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[J.drawingBufferWidth,J.drawingBufferHeight];ft=ht==="fillOutlinePattern"&&ut?et(Mi,ir,g,vi,Ki,We,te):Ke(Mi,ir,Ki,We)}else Ot=Qt.indexBuffer,ti=Qt.triangleSegments,ft=ut?Oe(Mi,ir,g,vi,We,te):xe(Mi,ir,We);g.uploadCommonUniforms(g.context,ai,ri.toUnwrapped());let tr=nt;(P==="road"&&!V||P==="offset")&&(tr=je),ai.draw(g,Rt,tr,u||g.stencilModeForClipping(ri),L,wr.disabled,ft,w.id,Qt.layoutVertexBuffer,Ot,ti,w.paint,g.transform.zoom,Ct,gi)}};g.renderPass===Y&&at(g.depthModeForSublayer(1,g.renderPass==="opaque"?ji.ReadWrite:ji.ReadOnly),!1),he==="none"&&g.renderPass==="translucent"&&w.paint.get("fill-antialias")&&at(g.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,ji.ReadOnly),!0)}function Va(p,n,u,g,x,w,S,L){u.resetLayerRenderingStats(p);const P=p.context,V=P.gl,Y=p.transform,J=u.paint.get("fill-extrusion-pattern"),Z=u.paint.get("fill-extrusion-pattern-cross-fade"),te=J.constantOr(null),de=J.constantOr(1),he=u.paint.get("fill-extrusion-opacity"),ge=p.style.enable3dLights(),_e=u.paint.get(ge&&!de?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],je=u.layout.get("fill-extrusion-edge-radius"),We=je>0&&!u.paint.get("fill-extrusion-rounded-roof"),ut=We?0:je,at=Y.projection.name==="globe"?r.dV():0,nt=Y.projection.name==="globe",qe=nt?r.ah(Y.zoom):0,ht=[r.aD(Y.center.lng),r.aH(Y.center.lat)],ft=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Rt=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ft?null:u.lut).toArray01().slice(0,3),Ot=u.paint.get("fill-extrusion-flood-light-intensity"),ti=u.paint.get("fill-extrusion-vertical-scale"),ri=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,vi=u.paint.get("fill-extrusion-height-alignment"),Pt=u.paint.get("fill-extrusion-base-alignment"),Qt=cl(p,u.paint.get("fill-extrusion-cutoff-fade-range")),Ct=[];let oi;nt&&Ct.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&Ct.push("FAUX_AO"),We&&Ct.push("ZERO_ROOF_RADIUS"),L&&Ct.push("HAS_CENTROID"),Ot>0&&Ct.push("FLOOD_LIGHT"),Qt.shouldRenderCutoff&&Ct.push("RENDER_CUTOFF"),ri&&Ct.push("RENDER_WALL_MODE");const zt=p.renderPass==="shadow",gi=p.shadowRenderer,Li=zt&&!!gi,ai=zt?wr.disabled:wr.backCCW;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Mi=[0,0,0];if(gi){const Ki=p.style.directionalLight,pr=p.style.ambientLight;Ki&&pr&&(Mi=oa(p.style,Ki,pr)),zt||(Ct.push("RENDER_SHADOWS","DEPTH_TEXTURE"),gi.useNormalOffset&&Ct.push("NORMAL_OFFSET")),oi=Ct.concat(["SHADOWS_SINGLE_CASCADE"])}const ir=Li?"fillExtrusionDepth":de?"fillExtrusionPattern":"fillExtrusion",tr=u.getLayerRenderingStats();for(const Ki of g){const pr=n.getTile(Ki),gr=pr.getBucket(u);if(!gr||gr.projection.name!==Y.projection.name)continue;let Cr=!1;gi&&(Cr=gi.getMaxCascadeForTile(Ki.toUnwrapped())===0);const Hr=p.isTileAffectedByFog(Ki),sn=gr.programConfigurations.get(u.id);let Zn=!1;if(te&&pr.imageAtlas){const vn=pr.imageAtlas,Rs=r.dN.from(te),Vo=Rs.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),Ts=Rs.getSecondary(),Xn=vn.patternPositions.get(Vo),to=Ts?vn.patternPositions.get(Ts.scaleSelf(r.q.devicePixelRatio).toString()):null;Zn=!!Xn&&!!to,Xn&&sn.setConstantPatternPositions(Xn,to)}Z>0&&(Zn||sn.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Ct.push("FILL_EXTRUSION_PATTERN_TRANSITION");const ws=p.getOrCreateProgram(ir,{config:sn,defines:Cr?oi:Ct,overrideFog:Hr});if(p.terrain&&p.terrain.setupElevationDraw(pr,ws,{useMeterToDem:!0}),!gr.centroidVertexBuffer){const vn=ws.attributes.a_centroid_pos;vn!==void 0&&V.vertexAttrib2f(vn,0,0)}!zt&&gi&&gi.setupShadows(pr.tileID.toUnwrapped(),ws,"vector-tile",pr.tileID.overscaledZ),de&&(p.context.activeTexture.set(V.TEXTURE0),pr.imageAtlasTexture&&pr.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),sn.updatePaintBuffers());const rs=u.paint.get("fill-extrusion-vertical-gradient"),ss=1/gr.tileToMeter;let ho;if(zt&&gi){if(Eu(pr.tileID,gr,p))continue;const vn=gi.calculateShadowPassMatrixFromTile(pr.tileID.toUnwrapped());ho=K(vn,ut,ss,ti,vi,Pt)}else{const vn=p.translatePosMatrix(Ki.expandedProjMatrix,pr,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Rs=Y.projection.createInversionMatrix(Y,Ki.canonical);ho=de?se(vn,p,rs,he,Te,ut,ss,Ki,pr,at,vi,Pt,qe,ht,Rs,Rt,ti,Z):D(vn,p,rs,he,Te,ut,ss,Ki,at,vi,Pt,qe,ht,Rs,Rt,ti,Ot,Mi)}p.uploadCommonUniforms(P,ws,Ki.toUnwrapped(),null,Qt);let Jr=gr.segments;if(Y.projection.name==="mercator"&&!zt&&(Jr=gr.getVisibleSegments(pr.tileID,p.terrain,p.transform.getFrustum(0)),!Jr.get().length))continue;if(tr)if(zt)for(const vn of Jr.get())tr.numRenderedVerticesInShadowPass+=vn.primitiveLength;else for(const vn of Jr.get())tr.numRenderedVerticesInTransparentPass+=vn.primitiveLength;const ln=[];(p.terrain||L)&&ln.push(gr.centroidVertexBuffer),nt&&ln.push(gr.layoutVertexExtBuffer),ri&&ln.push(gr.wallVertexBuffer),ws.draw(p,P.gl.TRIANGLES,x,w,S,ai,ho,u.id,gr.layoutVertexBuffer,gr.indexBuffer,Jr,u.paint,p.transform.zoom,sn,ln)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}function Ga(p,n,u,g,x,w,S,L,P,V,Y,J,Z,te,de,he,ge,_e,Te){const je=p.context,We=je.gl,ut=p.transform,at=p.transform.zoom,nt=[],qe=cl(p,u.paint.get("fill-extrusion-cutoff-fade-range"));V==="clear"?(nt.push("CLEAR_SUBPASS"),Te&&(nt.push("CLEAR_FROM_TEXTURE"),je.activeTexture.set(We.TEXTURE0),Te.bind(We.LINEAR,We.CLAMP_TO_EDGE))):V==="sdf"&&nt.push("SDF_SUBPASS"),ge&&nt.push("HAS_CENTROID"),qe.shouldRenderCutoff&&nt.push("RENDER_CUTOFF");const ht=u.layout.get("fill-extrusion-edge-radius"),ft=(Rt,Ot,ti,ri,vi)=>{const Pt=Ot.programConfigurations.get(u.id),Qt=p.isTileAffectedByFog(Rt),Ct=p.getOrCreateProgram("fillExtrusionGroundEffect",{config:Pt,defines:nt,overrideFog:Qt}),oi=((gi,Li,ai,Mi,ir,tr,Ki,pr,gr,Cr,Hr)=>({u_matrix:Li,u_opacity:ai,u_ao_pass:Mi?1:0,u_meter_to_tile:ir,u_ao:tr,u_flood_light_intensity:Ki,u_flood_light_color:pr,u_attenuation:gr,u_edge_radius:Cr,u_fb:0,u_fb_size:Hr,u_dynamic_offset:1}))(0,ri,Y,P,vi,[J,Z*vi],te,de,he,at>=17?0:ht*vi,Te?Te.size[0]:0),zt=[];ge&&zt.push(Ot.hiddenByLandmarkVertexBuffer),p.uploadCommonUniforms(je,Ct,Rt.toUnwrapped(),null,qe),Ct.draw(p,je.gl.TRIANGLES,x,w,S,L,oi,u.id,Ot.vertexBuffer,Ot.indexBuffer,ti,u.paint,at,Pt,zt)};for(const Rt of g){const Ot=n.getTile(Rt),ti=Ot.getBucket(u);if(!ti||ti.projection.name!==ut.projection.name||!ti.groundEffect||ti.groundEffect&&!ti.groundEffect.hasData())continue;const ri=ti.groundEffect,vi=1/ti.tileToMeter;{const Pt=p.translatePosMatrix(Rt.projMatrix,Ot,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Qt=ri.getDefaultSegment();ft(Rt,ri,Qt,Pt,vi)}if(_e)for(let Pt=0;Pt<4;Pt++){const Qt=r.dT[Pt](Rt),Ct=n.getTile(Qt);if(!Ct)continue;const oi=Ct.getBucket(u);if(!oi||oi.projection.name!==ut.projection.name||!oi.groundEffect||oi.groundEffect&&!oi.groundEffect.hasData())continue;const zt=oi.groundEffect;let gi,Li;Pt===0?(gi=[-8192,0,0],Li=1):Pt===1?(gi=[r.aj,0,0],Li=0):Pt===2?(gi=[0,-8192,0],Li=3):(gi=[0,r.aj,0],Li=2);const ai=zt.regionSegments[Li];if(!ai)continue;const Mi=new Float32Array(16);r.bo(Mi,Rt.projMatrix,gi),ft(Rt,zt,ai,p.translatePosMatrix(Mi,Ot,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),vi)}}}function Zi(p,n,u,g,x,w,S){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();const L=w?w.findDEMTileFor(u):null;if(!(L&&L.dem||S))return;w&&L&&L.dem&&g.selfDEMTileTimestamp!==L.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=L.dem._timestamp);const P=_e=>new r.P(Math.ceil((_e+r.dX)*r.dY),0),V=_e=>{const Te=n.getSource().minzoom,je=ut=>{const at=n.getTileByID(ut);if(at&&at.hasData())return at.getBucket(x)},We=[0,-1,1];for(const ut of We){if(_e.overscaledZ+ut<Te)continue;const at=je(_e.calculateScaledKey(_e.overscaledZ+ut));if(at)return at}},Y=[0,0,0],J=(_e,Te)=>(Y[0]=Math.min(_e.min.y,Te.min.y),Y[1]=Math.max(_e.max.y,Te.max.y),Y[2]=r.aj-Te.min.x>_e.max.x?Te.min.x-r.aj:_e.max.x,Y),Z=(_e,Te)=>(Y[0]=Math.min(_e.min.x,Te.min.x),Y[1]=Math.max(_e.max.x,Te.max.x),Y[2]=r.aj-Te.min.y>_e.max.y?Te.min.y-r.aj:_e.max.y,Y),te=[(_e,Te)=>J(_e,Te),(_e,Te)=>J(Te,_e),(_e,Te)=>Z(_e,Te),(_e,Te)=>Z(Te,_e)],de=(_e,Te,je,We,ut,at,nt)=>{if(!w)return 0;const qe=[[at?je:_e,at?_e:je,0],[at?je:Te,at?Te:je,0]],ht=nt<0?r.aj+nt:nt,ft=[at?ht:(_e+Te)/2,at?(_e+Te)/2:ht,0];return je===0&&nt<0||je!==0&&nt>0?w.getForTilePoints(ut,[ft],!0,We):qe.push(ft),w.getForTilePoints(u,qe,!0,L),Math.max(qe[0][2],qe[1][2],ft[2])/w.exaggeration()};for(let _e=0;_e<4;_e++){const Te=g.borderFeatureIndices[_e];if(Te.length===0)continue;const je=r.dT[_e](u),We=V(je);if(!(We&&We instanceof r.dU))continue;const ut=w?w.findDEMTileFor(je):null;if(!(ut&&ut.dem||S)||(w&&ut&&ut.dem&&g.borderDEMTileTimestamp[_e]!==ut.dem._timestamp&&(g.borderDoneWithNeighborZ[_e]=-1,g.borderDEMTileTimestamp[_e]=ut.dem._timestamp),g.borderDoneWithNeighborZ[_e]===We.canonical.z))continue;We.centroidVertexArray.length===0&&We.createCentroidsBuffer();const at=(_e<2?1:5)-_e,nt=We.borderDoneWithNeighborZ[at]!==g.canonical.z,qe=We.borderFeatureIndices[at];let ht=0;if(g.canonical.z!==We.canonical.z){for(const ft of Te)g.showCentroid(g.featuresOnBorder[ft]);if(nt)for(const ft of qe)We.showCentroid(We.featuresOnBorder[ft]);g.borderDoneWithNeighborZ[_e]=We.canonical.z,We.borderDoneWithNeighborZ[at]=g.canonical.z}for(const ft of Te){const Rt=g.featuresOnBorder[ft],Ot=g.centroidData[Rt.centroidDataIndex],ti=Rt.borders[_e];let ri;for(;ht<qe.length;){ri=We.featuresOnBorder[qe[ht]];const vi=ri.borders[at];if(vi[1]>ti[0]+3||vi[0]>ti[0]-3)break;We.showCentroid(ri),ht++}if(ri&&ht<qe.length){const vi=ht;let Pt=0;for(;!(ri.borders[at][0]>ti[1]-3)&&(Pt++,++ht!==qe.length);)ri=We.featuresOnBorder[qe[ht]];ri=We.featuresOnBorder[qe[vi]];let Qt=!1;if(Pt>=1){const zt=ri.borders[at];Math.abs(ti[0]-zt[0])<3&&Math.abs(ti[1]-zt[1])<3&&(Pt=1,Qt=!0,ht=vi+1)}else if(Pt===0){g.showCentroid(Rt);continue}const Ct=We.centroidData[ri.centroidDataIndex];S&&Qt&&(((he=Ot).flags|(ge=Ct).flags)&r.dW?(he.flags|=r.dW,ge.flags|=r.dW):(he.flags&=2147483647,ge.flags&=2147483647));const oi=Rt.intersectsCount()>1||ri.intersectsCount()>1;if(Pt>1)ht=vi,Ot.centroidXY=Ct.centroidXY=new r.P(0,0);else if(ut&&ut.dem&&!oi){const zt=te[_e](Ot,Ct),gi=_e%2?r.aj-1:0,Li=de(zt[0],Math.min(r.aj-1,zt[1]),gi,ut,je,_e<2,zt[2]);Ot.centroidXY=Ct.centroidXY=P(Li)}else oi?Ot.centroidXY=Ct.centroidXY=new r.P(0,0):(Ot.centroidXY=g.encodeBorderCentroid(Rt),Ct.centroidXY=We.encodeBorderCentroid(ri));g.writeCentroidToBuffer(Ot),We.writeCentroidToBuffer(Ct)}else g.showCentroid(Rt)}g.borderDoneWithNeighborZ[_e]=We.canonical.z,We.borderDoneWithNeighborZ[at]=g.canonical.z}var he,ge;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(p)}const Su=[1,0,0],Qo=[0,1,0],qc=[0,0,1];function Eu(p,n,u){const g=u.transform,x=u.shadowRenderer;if(!x)return!0;const w=p.toUnwrapped(),S=g.tileSize*x._cascades[u.currentShadowCascade].scale;let L=n.maxHeight;if(g.elevation){const he=g.elevation.getMinMaxForTile(p);he&&(L+=he.max)}const P=[...x.shadowDirection];P[2]=-P[2];const V=x.computeSimplifiedTileShadowVolume(w,L,S,P);if(!V)return!1;const Y=[Su,Qo,qc,P,[P[0],0,P[2]],[0,P[1],P[2]]],J=g.projection.name==="globe",Z=g.scaleZoom(S),te=r.cn.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,Z,!J),de=x.getCurrentCascadeFrustum();return te.intersectsPrecise(V.vertices,V.planes,Y)===0||de.intersectsPrecise(V.vertices,V.planes,Y)===0}function Br(p){return[p[0]*r.dZ,p[1]*r.dZ,p[2]*r.dZ,0]}function Wu(p,n,u,g,x,w,S,L,P){const V=g.getSource(),Y=u.globeSharedBuffers;if(!Y)return;let J,Z,te;if(n&&(J=g.getTile(n)),V instanceof r.aP?(Z=V.texture,te=r.ds(0,0,u.transform)):J&&n&&(Z=J.texture,te=r.ds(n.canonical.z,n.canonical.x,u.transform)),!Z||!te)return;p||(te=r.cE(r.bz(),te,[1,-1,1]));const de=u.context,he=de.gl,ge=x.paint.get("raster-resampling")==="nearest"?he.NEAREST:he.LINEAR,_e=u.colorModeForDrapableLayerRenderPass(w),Te=S.defines;Te.push("GLOBE_POLES");const je=new ji(he.LEQUAL,ji.ReadWrite,u.depthRangeFor3D),We=Float32Array.from(u.transform.expandedFarZProjMatrix),ut=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),de.activeTexture.set(he.TEXTURE0),Z.bind(ge,he.CLAMP_TO_EDGE),de.activeTexture.set(he.TEXTURE1),Z.bind(ge,he.CLAMP_TO_EDGE),"useMipmap"in Z&&de.extTextureFilterAnisotropic&&u.transform.pitch>20&&he.texParameterf(he.TEXTURE_2D,de.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,de.extTextureFilterAnisotropicMax);const[at,nt,qe,ht]=n?Y.getPoleBuffers(n.canonical.z,!1):Y.getPoleBuffers(0,!0),ft=x.paint.get("raster-elevation");let Rt;p?(Rt=at,u.renderDefaultNorthPole=ft!==0):(Rt=nt,u.renderDefaultSouthPole=ft!==0);const Ot=Br(S.mix),ti=((vi,Pt,Qt,Ct,oi,zt,gi,Li,ai,Mi,ir,tr,Ki)=>Ni(vi,Pt,Qt,new Float32Array(16),new Float32Array(9),[0,0],Ct,[0,0],[0,0,0,0],1,{opacity:1,mix:0},zt,[0,0],Li,2,Mi,ir,tr,1,0,Ki))(We,ut,te,r.ah(u.transform.zoom),0,x,0,ft,0,Ot,S.offset,S.range,w),ri=u.getOrCreateProgram("raster",{defines:Te});u.uploadCommonUniforms(de,ri,null),ri.draw(u,he.TRIANGLES,je,P,_e,L,ti,x.id,Rt,qe,ht)}function gd(p){const n=p._nearZ,u=p.projection.farthestPixelDistance(p),g=u-n,x=.2*p.height,w=n+x;return[n,u,(w-x-n)/g,(w-n)/g]}function md(p,n,u,g){if(p)return n instanceof _c&&p instanceof xl?n.getTextureDescriptor(p,u,!0):{texture:p.texture,mix:Br(g.mix),offset:g.offset,buffer:0,tileSize:1}}var Xl=r.d_([{name:"a_index",type:"Int16",components:1}]);class wh{constructor(n,u,g,x){const w={width:g[0],height:g[1],data:null},S=n.gl;this.targetColorTexture=new r.T(n,w,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(n,w,S.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(u,x),this.lastInvalidatedAt=0}updateParticleTexture(n,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,x=u.width*u.height;this.particleTexture0=new r.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,u,g.RGBA8,{premultiply:!1,useMipmap:!1});const w=new r.d$;w.reserve(x);for(let S=0;S<x;S++)w.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(w,Xl.members,!0),this.particleSegment=r.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Yh(p,n,u){if(!p)return null;const g=n.getTextureDescriptor(p,u,!0);if(!g)return null;let{texture:x,mix:w,offset:S,tileSize:L,buffer:P,format:V}=g;if(!x||!V)return null;let Y=!1;return V==="uint32"&&(Y=!0,w[3]=0,w=ci(r.e0,w,[0,u.paint.get("raster-particle-max-speed")]),S=Hi(r.e0,S,[0,u.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[P/(L+2*P),L/(L+2*P)],tileSize:L,scalarData:Y,scale:w,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[V]]}}function mA(p){const n=p._nearZ,u=p.projection.farthestPixelDistance(p),g=u-n,x=.2*p.height,w=n+x;return[n,u,(w-x-n)/g,(w-n)/g]}const yA=new r.am(1,0,0,1),yd=new r.am(0,1,0,1),Wa=new r.am(0,0,1,1),Bh=new r.am(1,0,1,1),ca=new r.am(0,1,1,1);function Fl(p,n,u,g,x,w){for(let S=0;S<u.length;S++)if(x){const V=new r.am(g.r*.8,g.g*.8,g.b*.8,1);Xu(p,n,u[S],g,-1,-1,w),Xu(p,n,u[S],g,-1,1,w),Xu(p,n,u[S],g,1,1,w),Xu(p,n,u[S],g,1,-1,w),Xu(p,n,u[S],V,0,0,w)}else Xu(p,n,u[S],g,0,0,w)}function Xu(p,n,u,g,x,w,S){const L=p.context,P=p.transform,V=L.gl,Y=P.projection.name==="globe",J=Y?["PROJECTION_GLOBE_VIEW"]:[];let Z=r.bw(u.projMatrix);if(Y&&r.ah(P.zoom)>0){const Ot=r.bg(u.canonical,P),ti=r.e1(Ot);Z=r.az(new Float32Array(16),P.globeMatrix,ti),r.az(Z,P.projMatrix,Z)}const te=r.bz();te[12]+=2*x/(r.q.devicePixelRatio*P.width),te[13]+=2*w/(r.q.devicePixelRatio*P.height),r.az(Z,te,Z);const de=p.getOrCreateProgram("debug",{defines:J}),he=n.getTileByID(u.key);p.terrain&&p.terrain.setupElevationDraw(he,de);const ge=ji.disabled,_e=Pr.disabled,Te=p.colorModeForRenderPass(),je="$debug";L.activeTexture.set(V.TEXTURE0),p.emptyTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Y?he._makeGlobeTileDebugBuffers(p.context,P):he._makeDebugTileBoundsBuffers(p.context,P.projection);const We=he._tileDebugBuffer||p.debugBuffer,ut=he._tileDebugIndexBuffer||p.debugIndexBuffer,at=he._tileDebugSegments||p.debugSegments;if(de.draw(p,V.LINE_STRIP,ge,_e,Te,wr.disabled,Xt(Z,g.toPremultipliedRenderColor(null)),je,We,ut,at,null,null,null,[he._globeTileDebugBorderBuffer]),S){const Ot=he.latestRawTileData,ti=Math.floor((Ot&&Ot.byteLength||0)/1024);let ri=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ri+=` => ${u.overscaledZ}`),ri+=` ${he.state}`,ri+=` ${ti}kb`,function(vi,Pt){vi.initDebugOverlayCanvas();const Qt=vi.debugOverlayCanvas,Ct=vi.context.gl,oi=vi.debugOverlayCanvas.getContext("2d");oi.clearRect(0,0,Qt.width,Qt.height),oi.shadowColor="white",oi.shadowBlur=2,oi.lineWidth=1.5,oi.strokeStyle="white",oi.textBaseline="top",oi.font="bold 36px Open Sans, sans-serif",oi.fillText(Pt,5,5),oi.strokeText(Pt,5,5),vi.debugOverlayTexture.update(Qt),vi.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)}(p,ri)}const nt=n.getTile(u).tileSize,qe=512/Math.min(nt,512)*(u.overscaledZ/P.zoom)*.5,ht=he._tileDebugTextBuffer||p.debugBuffer,ft=he._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,Rt=he._tileDebugTextSegments||p.debugSegments;de.draw(p,V.TRIANGLES,ge,_e,Wr.alphaBlended,wr.disabled,Xt(Z,r.am.transparent.toPremultipliedRenderColor(null),qe),je,ht,ft,Rt,null,null,null,[he._globeTileDebugTextBuffer])}function vA(p,n,u,g){hl(p,0,n+u/2,p.transform.width,u,g)}function Ch(p,n,u,g){hl(p,n-u/2,0,u,p.transform.height,g)}function hl(p,n,u,g,x,w){const S=p.context,L=S.gl;L.enable(L.SCISSOR_TEST),L.scissor(n*r.q.devicePixelRatio,u*r.q.devicePixelRatio,g*r.q.devicePixelRatio,x*r.q.devicePixelRatio),S.clear({color:w}),L.disable(L.SCISSOR_TEST)}const _A=r.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$c}=_A;function $n(p,n,u,g){p.emplaceBack(n,u,g)}class Sh{constructor(n){this.vertexArray=new r.e2,this.indices=new r.a_,$n(this.vertexArray,-1,-1,1),$n(this.vertexArray,1,-1,1),$n(this.vertexArray,-1,1,1),$n(this.vertexArray,1,1,1),$n(this.vertexArray,-1,-1,-1),$n(this.vertexArray,1,-1,-1),$n(this.vertexArray,-1,1,-1),$n(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,$c),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=r.bd.simpleSegment(0,0,36,12)}}function uc(p,n,u,g,x,w){const S=p.context.gl,L=n.paint.get("sky-atmosphere-color"),P=n.paint.get("sky-atmosphere-halo-color"),V=n.paint.get("sky-atmosphere-sun-intensity"),Y=((J,Z,te,de,he)=>({u_matrix_3f:J,u_sun_direction:Z,u_sun_intensity:te,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[he.r,he.g,he.b,he.a],u_luminance:5e-5}))(r.e4(r.dx(),g),x,V,L.toPremultipliedRenderColor(null),P.toPremultipliedRenderColor(null));S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+w,n.skyboxTexture,0),u.draw(p,S.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.frontCW,Y,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const vd=r.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class nf{constructor(n){const u=new r.e5;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new r.a_;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(u,vd.members),this.indexBuffer=n.createIndexBuffer(g),this.segments=r.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const _d=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class sf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ua{constructor(n){this.colorModeAlphaBlendedWriteRGB=new Wr([1,vo,1,vo],r.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Wr([1,0,1,0],r.am.transparent,[!1,!1,!1,!0]),this.params=new sf,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(n){const u=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new nf(u);const g=this.params.sizeRange,x=this.params.intensityRange,w=function(Y){const J=r.e7(30),Z=[];for(let te=0;te<Y;++te){const de=2*Math.PI*J(),he=Math.acos(1-2*J())-.5*Math.PI;Z.push(r.cS(Math.cos(he)*Math.cos(de),Math.cos(he)*Math.sin(de),Math.sin(he)))}return Z}(this.params.starsCount),S=r.e7(300),L=new r.e6,P=new r.a_;let V=0;for(let Y=0;Y<w.length;++Y){const J=r.bY([],w[Y],200),Z=Math.max(0,1+.01*g*(1*S()-.5)),te=Math.max(0,1+.01*x*(1*S()-.5));L.emplaceBack(J[0],J[1],J[2],-1,-1,Z,te),L.emplaceBack(J[0],J[1],J[2],1,-1,Z,te),L.emplaceBack(J[0],J[1],J[2],1,1,Z,te),L.emplaceBack(J[0],J[1],J[2],-1,1,Z,te),P.emplaceBack(V+0,V+1,V+2),P.emplaceBack(V+0,V+2,V+3),V+=4}this.starsVx=u.createVertexBuffer(L,_d.members),this.starsIdx=u.createIndexBuffer(P),this.starsSegments=r.bd.simpleSegment(0,0,L.length,P.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,u){const g=n.context,x=g.gl,w=n.transform,S=new ji(x.LEQUAL,ji.ReadOnly,[0,1]),L=r.ah(w.zoom),P=n.style.getLut(u.scope),V=u.properties.get("color-use-theme")==="none",Y=u.properties.get("color").toNonPremultipliedRenderColor(V?null:P).toArray01(),J=u.properties.get("high-color-use-theme")==="none",Z=u.properties.get("high-color").toNonPremultipliedRenderColor(J?null:P).toArray01(),te=u.properties.get("space-color-use-theme")==="none",de=u.properties.get("space-color").toNonPremultipliedRenderColor(te?null:P).toArray01(),he=5e-4,ge=r.e8(u.properties.get("horizon-blend"),0,1,he,.25),_e=r.dl(n,g,w)&&ge===he?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,Te=n.frameCounter/1e3%1,je=r.ae(w.globeCenterInViewSpace),We=Math.sqrt(Math.pow(je,2)-Math.pow(_e,2)),ut=Math.acos(We/je),at=nt=>{const qe=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];nt&&qe.push("ALPHA_PASS");const ht=n.getOrCreateProgram("globeAtmosphere",{defines:qe}),ft=((Ot,ti,ri,vi,Pt,Qt,Ct,oi,zt,gi,Li,ai)=>({u_frustum_tl:Ot,u_frustum_tr:ti,u_frustum_br:ri,u_frustum_bl:vi,u_horizon:Pt,u_transition:Qt,u_fadeout_range:Ct,u_color:oi,u_high_color:zt,u_space_color:gi,u_temporal_offset:Li,u_horizon_angle:ai}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,L,ge,Y,Z,de,Te,ut);n.uploadCommonUniforms(g,ht);const Rt=this.atmosphereBuffer;Rt&&ht.draw(n,x.TRIANGLES,S,Pr.disabled,nt?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,wr.backCW,ft,nt?"atmosphere_glow_alpha":"atmosphere_glow",Rt.vertexBuffer,Rt.indexBuffer,Rt.segments)};at(!1),at(!0)}drawStars(n,u){const g=r.ay(u.properties.get("star-intensity"),0,1);if(g===0)return;const x=n.context,w=x.gl,S=n.transform,L=n.getOrCreateProgram("stars"),P=r.b_([]);r.c0(P,P,-S._pitch),r.b$(P,P,-S.angle),r.c0(P,P,r.al(S._center.lat)),r.e9(P,P,-r.al(S._center.lng));const V=r.c3(new Float32Array(16),P),Y=r.az([],S.starsProjMatrix,V),J=r.e4([],V),Z=r.ea([],J),te=[0,1,0];r.dz(te,te,Z),r.bY(te,te,this.params.sizeMultiplier);const de=[1,0,0];r.dz(de,de,Z),r.bY(de,de,this.params.sizeMultiplier);const he=(ge=te,_e=de,Te=g,{u_matrix:Float32Array.from(Y),u_up:ge,u_right:_e,u_intensity_multiplier:Te});var ge,_e,Te;n.uploadCommonUniforms(x,L),this.starsVx&&this.starsIdx&&L.draw(n,w.TRIANGLES,ji.disabled,Pr.disabled,this.colorModeAlphaBlendedWriteRGB,wr.disabled,he,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Zc(p,n){const u=[...p],g=n.cameraWorldSizeForFog/n.worldSize,x=r.bx([]);return r.cE(x,x,[g,g,1]),r.az(u,x,u),r.az(u,n.worldToFogMatrix,u),u}function Ei(p,n,u,g,x){const w=u.material,S=g.context,{baseColorTexture:L,metallicRoughnessTexture:P}=w.pbrMetallicRoughness,{normalTexture:V,occlusionTexture:Y,emissionTexture:J}=w;function Z(de,he,ge){if(de&&(p.push(he),S.activeTexture.set(S.gl.TEXTURE0+ge),de.gfxTexture)){const{minFilter:_e,magFilter:Te,wrapS:je,wrapT:We}=de.sampler;de.gfxTexture.bindExtraParam(_e,Te,je,We)}}Z(L,"HAS_TEXTURE_u_baseColorTexture",Ko.BaseColor),Z(P,"HAS_TEXTURE_u_metallicRoughnessTexture",Ko.MetallicRoughness),Z(V,"HAS_TEXTURE_u_normalTexture",Ko.Normal),Z(Y,"HAS_TEXTURE_u_occlusionTexture",Ko.Occlusion),Z(J,"HAS_TEXTURE_u_emissionTexture",Ko.Emission),x&&(x.texture||(x.texture=new r.eh(g.context,x.image,[x.image.height,x.image.height,x.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+Ko.LUT),x.texture&&x.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(u.texcoordBuffer)),u.colorBuffer&&(p.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(u.colorBuffer)),u.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(u.normalBuffer)),u.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(u.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||p.push("DIFFUSE_SHADED");const te=g.shadowRenderer;te&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&p.push("NORMAL_OFFSET"))}function Gi(p,n,u,g,x,w){const S=u.paint.get("model-opacity").constantOr(1),L=n.context,P=new ji(n.context.gl.LEQUAL,ji.ReadWrite,n.depthRangeFor3D),V=n.transform,Y=p.mesh,J=Y.material,Z=J.pbrMetallicRoughness,te=n.style.fog;let de;de=n.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:r.az([],g.zScaleMatrix,p.nodeModelMatrix),r.az(de,g.negCameraPosMatrix,de);const he=r.bi([],de);r.ee(he,he);const ge=u.paint.get("model-color-use-theme").constantOr("default")==="none",_e=u.paint.get("model-emissive-strength").constantOr(0),Te=Vs(new Float32Array(p.worldViewProjection),new Float32Array(de),new Float32Array(he),null,n,S,Z.baseColorFactor,J.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,J,_e,u),je={defines:[]},We=[],ut=n.shadowRenderer;ut&&(ut.useNormalOffset=!1),Ei(je.defines,We,Y,n,ge?null:u.lut);let at=null;if(te){const ht=Zc(p.nodeModelMatrix,n.transform);if(at=new Float32Array(ht),V.projection.name!=="globe"){const ft=Y.aabb.min,Rt=Y.aabb.max,[Ot,ti]=te.getOpacityForBounds(ht,ft[0],ft[1],Rt[0],Rt[1]);je.overrideFog=Ot>=Nt||ti>=Nt}}const nt=cl(n,u.paint.get("model-cutoff-fade-range"));nt.shouldRenderCutoff&&je.defines.push("RENDER_CUTOFF");const qe=n.getOrCreateProgram("model",je);n.uploadCommonUniforms(L,qe,null,at,nt),n.renderPass!=="shadow"&&ut&&ut.setupShadowsFromMatrix(p.nodeModelMatrix,qe),qe.draw(n,L.gl.TRIANGLES,P,x,w,Y.material.doubleSided?wr.disabled:wr.backCCW,Te,u.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,u.paint,n.transform.zoom,void 0,We)}function Yu(p,n,u,g,x,w,S){let L;L=p.projection.name==="globe"?r.ed(u,p):[...u],r.az(L,L,n.matrix);const P=r.az([],g,L);if(n.meshes)for(const V of n.meshes){if(V.material.alphaMode!=="BLEND"){S.push({mesh:V,depth:0,modelIndex:x,worldViewProjection:P,nodeModelMatrix:L});continue}const Y=r.ad([],V.centroid,P);!p.isOrthographic&&Y[2]<=0||w.push({mesh:V,depth:Y[2],modelIndex:x,worldViewProjection:P,nodeModelMatrix:L})}if(n.children)for(const V of n.children)Yu(p,V,u,g,x,w,S)}function Ns(p,n,u,g){const x=u.shadowRenderer;if(!x)return;const w=x.getShadowPassDepthMode(),S=x.getShadowPassColorMode(),L=x.calculateShadowPassMatrixFromMatrix(n),P=Ps(L);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,w,Pr.disabled,S,wr.backCCW,P,g.id,p.vertexBuffer,p.indexBuffer,p.segments,g.paint,u.transform.zoom,void 0,void 0)}function Lt(p,n,u){const g=n.updateZoomBasedPaintProperties(),x=function(w,S,L){let P,V,Y,J=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&J>0){const Z=w.terrain,te=Z.findDEMTileFor(L);te&&te.dem?P=r.ei.create(Z,L,te):J=0}if(J===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),J===S.validForExaggeration&&(J===0||P&&P._demTile&&P._demTile.tileID===S.validForDEMTile.id&&P._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const Z in S.instancesPerModel){const te=S.instancesPerModel[Z];for(let de=0;de<te.instancedDataArray.length;++de){const he=(P?J*P.getElevationAt(0|te.instancedDataArray.float32[16*de],0|te.instancedDataArray.float32[16*de+1],!0,!0):0)+te.instancesEvaluatedElevation[de];te.instancedDataArray.float32[16*de+6]=he,V=V?Math.min(S.terrainElevationMin,he):he,Y=Y?Math.max(S.terrainElevationMax,he):he}}return S.terrainElevationMin=V||0,S.terrainElevationMax=Y||0,S.validForExaggeration=J,S.validForDEMTile=P&&P._demTile?{id:P._demTile.tileID,timestamp:P._dem._timestamp}:{id:void 0,timestamp:0},!0}(p,n,u);(g||x)&&(n.uploaded=!1,n.upload(p.context))}const hc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.cW([0,0,0],[r.aj,r.aj,0])};function xd(p,n){const u=1<<p.canonical.z,g=n.getFreeCameraOptions().position,x=n.elevation,w=p.canonical.x/u,S=(p.canonical.x+1)/u,L=p.canonical.y/u,P=(p.canonical.y+1)/u;let V=n._centerAltitude;if(x){const te=x.getMinMaxForTile(p);te&&te.max>V&&(V=te.max)}const Y=r.ay(g.x,w,S)-g.x,J=r.ay(g.y,L,P)-g.y,Z=r.c6(V,n.center.lat)-g.z;return n._zoomFromMercatorZ(Math.sqrt(Y*Y+J*J+Z*Z))}function xA(p,n,u,g,x,w,S){const L=p.context,P=p.renderPass==="shadow",V=p.shadowRenderer,Y=P&&V?V.getShadowPassDepthMode():new ji(L.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),J=p.isTileAffectedByFog(w);if(u.meshes)for(const Z of u.meshes){const te=["MODEL_POSITION_ON_GPU"],de=[];let he,ge,_e;g.instancedDataArray.length>20&&te.push("INSTANCED_ARRAYS");const Te=cl(p,n.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&te.push("RENDER_CUTOFF"),P&&V)he=p.getOrCreateProgram("modelDepth",{defines:te}),ge=Ps(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(u.matrix)),_e=V.getShadowPassColorMode();else{Ei(te,de,Z,p,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),he=p.getOrCreateProgram("model",{defines:te,overrideFog:J});const We=Z.material,ut=We.pbrMetallicRoughness,at=n.paint.get("model-opacity").constantOr(1),nt=n.paint.get("model-emissive-strength").constantOr(0);ge=Vs(w.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,p,at,ut.baseColorFactor,We.emissiveFactor,ut.metallicFactor,ut.roughnessFactor,We,nt,n,x),V&&(S.shadowUniformsInitialized?he.setShadowUniformValues(L,V.getShadowUniformValues()):(V.setupShadows(w.toUnwrapped(),he,"model-tile",w.overscaledZ),S.shadowUniformsInitialized=!0)),_e=Te.shouldRenderCutoff||at<1||We.alphaMode!=="OPAQUE"?Wr.alphaBlended:Wr.unblended}p.uploadCommonUniforms(L,he,w.toUnwrapped(),null,Te);const je=Z.material.doubleSided?wr.disabled:wr.backCCW;if(g.instancedDataArray.length>20)de.push(g.instancedDataBuffer),he.draw(p,L.gl.TRIANGLES,Y,Pr.disabled,_e,je,ge,n.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,n.paint,p.transform.zoom,void 0,de,g.instancedDataArray.length);else{const We=P?"u_instance":"u_normal_matrix";for(let ut=0;ut<g.instancedDataArray.length;++ut)ge[We]=new Float32Array(g.instancedDataArray.arrayBuffer,64*ut,16),he.draw(p,L.gl.TRIANGLES,Y,Pr.disabled,_e,je,ge,n.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,n.paint,p.transform.zoom,void 0,de)}}if(u.children)for(const Z of u.children)xA(p,n,Z,g,x,w,S)}const bA=[1,-1,1];function Ku(p,n,u,g){if(!u.modelManager)return!0;const x=u.modelManager;if(!u.shadowRenderer)return!0;const w=u.shadowRenderer,S=n.aabb;let L=!0,P=p.maxHeight;if(P===0){let Y=0;for(const J in p.instancesPerModel){const Z=x.getModel(J,g);Z?Y=Math.max(Y,Math.max(Math.max(Z.aabb.max[0],Z.aabb.max[1]),Z.aabb.max[2])):L=!1}P=p.maxScale*Y*1.41+p.maxVerticalOffset,L&&(p.maxHeight=P)}S.max[2]=P,S.min[2]+=p.terrainElevationMin,S.max[2]+=p.terrainElevationMax,r.ad(S.min,S.min,n.tileMatrix),r.ad(S.max,S.max,n.tileMatrix);const V=S.intersects(w.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=V===2),V===0}function Hf(p,n){const u=p.uniformValues.u_cutoff_params[0],g=p.uniformValues.u_cutoff_params[1],x=p.uniformValues.u_cutoff_params[2],w=p.uniformValues.u_cutoff_params[3];return g===u||w===x?1:r.ay(((n-u)/(g-u)-x)/(w-x),0,1)}function Iu(p,n,u,g){if(n.pitch<20)return 1;const x=n.getWorldToCameraMatrix();r.az(x,x,p);const w=r.ej(u.min[0],u.min[1],u.min[2],1);let S=r.aA(r.ek(),w,x),L=S,P=S;w[1]=u.max[1],S=r.aA(r.ek(),w,x),L=S[1]<L[1]?S:L,P=S[1]>P[1]?S:P,w[0]=u.max[0],S=r.aA(r.ek(),w,x),L=S[1]<L[1]?S:L,P=S[1]>P[1]?S:P,w[1]=u.min[1],S=r.aA(r.ek(),w,x),L=S[1]<L[1]?S:L,P=S[1]>P[1]?S:P;const V=r.ay(g[0],0,1),Y=100*n.pixelsPerMeter*r.ay(g[1],0,1),J=r.ay(g[2],0,1),Z=r.el(r.ek(),L,P,V),te=Math.tan(.5*n.fovX),de=-Z[2]*te;if(Y===0)return Z[1]<-Math.abs(de)?J:1;const he=(-Math.abs(de)-Z[1])/Y,ge=(Te,je,We)=>(1-We)*Te+We*je,_e=r.ay(ge(1,J,he),J,1);return ge(1,_e,r.ay((n.pitch-20)/20,0,1))}class Qf{}class Pa{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,u,g){{const J=this._storage.get(u.id);if(J)return J.lastUsedFrameIdx=n,J.buf}const x=g.gl,w=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),S=new ArrayBuffer(w),L=new Int16Array(S);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const P=new r.en;for(let J=0;J<w/2;J+=3){const Z=L[J],te=L[J+1],de=L[J+2];P.emplaceBack(Z,te),P.emplaceBack(te,de),P.emplaceBack(de,Z)}const V=g.bindVertexArrayOES.current,Y=new Qf;return Y.buf=new ys(g,P),Y.lastUsedFrameIdx=n,this._storage.set(u.id,Y),g.bindVertexArrayOES.set(V),Y.buf}update(n){for(const[u,g]of this._storage)n-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(u))}destroy(){for(const[n,u]of this._storage)u.buf.destroy(),this._storage.delete(n)}}class Kh{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const qu=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class bd{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Eh{constructor(n,u){this.revealStart=11,this.revealRange=2,n.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),n.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const dc=r.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class Lc{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,u){const g=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new r.eo,L=new r.a_;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),L.emplaceBack(0,1,2),L.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(S,dc.members),this.vignetteIdx=n.context.createIndexBuffer(L)}const x=r.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,g);const S={u_vignetteShape:(w={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};g.draw(n,n.context.gl.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,x)}var w}}class Ac{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,u){const g=n.getFreeCameraOptions().position,x=g.toAltitude(),w=g.toLngLat(),S=r.al(w.lng),L=r.al(w.lat),P=n.pixelsPerMeter/u,V=S*r.eq,Y=r.eq*Math.log(Math.tan(Math.PI/4+L/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const J=-this._offsetYPrev+Y,Z=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+V)*P,this._accumulatedOffsetY+=J*P,this._accumulatedElevation+=Z*P,this._offsetXPrev=V,this._offsetYPrev=Y,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Jc(p,n){return[-(p[0]-Math.floor(p[0]/n)*n),-(p[1]-Math.floor(p[1]/n)*n),-(p[2]-Math.floor(p[2]/n)*n)]}function wd(p){const n=r.e7(1323123451230),u=[];for(let g=0;g<p;++g){const x=2*n()-1,w=2*n()-1,S=2*n()-1;u.push(r.cS(x,w,S))}return u}function Tu(p,n,u,g,x){const w=r.ay((x-u)/(g-u),0,1);return(1-w)*p+w*n}class Xa{constructor(n){this._movement=new Ac,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Lc,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,u){const g=n.transform;this._movement.update(g,this._ppmScaleFactor);const x=g.starsProjMatrix,w=r.b_([]);r.c0(w,w,r.al(90)-g._pitch),r.b$(w,w,-g.angle);const S=r.c3(new Float32Array(16),w),L=r.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),P=r.ee([],L),V=r.az([],P,S),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*u,this._prevTime=Y,{projectionMatrix:x,modelviewMatrix:V}}}class of extends Xa{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Eh(n.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const g=wd(this.particlesCount),x=new r.er,w=new r.a_;let S=0;const L=r.e7(1323123451230);for(let P=0;P<g.length;++P){const V=g[P],Y=[2*L()-1,L(),L(),L()];x.emplaceBack(V[0],V[1],V[2],-1,-1,...Y),x.emplaceBack(V[0],V[1],V[2],1,-1,...Y),x.emplaceBack(V[0],V[1],V[2],1,1,...Y),x.emplaceBack(V[0],V[1],V[2],-1,1,...Y),w.emplaceBack(S+0,S+1,S+2),w.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(x,qu.members),this.particlesIdx=u.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=n.transform.zoom;if(u.revealStart>g)return;const x=Tu(0,1,u.revealStart,u.revealStart+u.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let S=[-w.direction.x,w.direction.y,-100];r.au(S,S);const L=structuredClone(this._vignetteParams);L.strength*=x,w.overrideStyleParameters||(w.intensity=n.style.rain.state.density,w.timeFactor=n.style.rain.state.intensity,w.color=structuredClone(n.style.rain.state.color),S=structuredClone(n.style.rain.state.direction),w.screenThinning.intensity=n.style.rain.state.centerThinning,w.dropletSizeX=n.style.rain.state.dropletSize[0],w.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],w.distortionStrength=100*n.style.rain.state.distortionStrength,L.strength=1,L.color=structuredClone(n.style.rain.state.vignetteColor));const P=this.updateOnRender(n,w.timeFactor),V=n.context,Y=V.gl,J=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new r.T(V,{width:n.width,height:n.height,data:null},Y.RGBA8)),w.distortionStrength>0&&(V.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const Z=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(V,Z),V.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const te=[w.color.r,w.color.g,w.color.b,w.color.a],de=(he,ge)=>{const _e=Jc(this._movement.getPosition(),he),Te=w.dropletSizeX,je=w.dropletSizeX*w.dropletSizeYScale,We=n.width/2,ut=n.height/2,at=Tu(0,w.screenThinning.start,0,1,w.screenThinning.intensity),nt=Tu(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),qe=Tu(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),ht=(ft={modelview:P.modelviewMatrix,projection:P.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:_e,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:he,rainDropletSize:[Te,je],distortionStrength:w.distortionStrength,rainDirection:S,color:te,screenSize:[J.width,J.height],thinningCenterPos:[We,ut],thinningShape:[at,nt,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:qe,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:ge?0:1},{u_modelview:Float32Array.from(ft.modelview),u_projection:Float32Array.from(ft.projection),u_time:ft.time,u_cam_pos:ft.camPos,u_texScreen:0,u_velocityConeAperture:ft.velocityConeAperture,u_velocity:ft.velocity,u_boxSize:ft.boxSize,u_rainDropletSize:ft.rainDropletSize,u_distortionStrength:ft.distortionStrength,u_rainDirection:ft.rainDirection,u_color:ft.color,u_screenSize:ft.screenSize,u_thinningCenterPos:ft.thinningCenterPos,u_thinningShape:ft.thinningShape,u_thinningAffectedRatio:ft.thinningAffectedRatio,u_thinningParticleOffset:ft.thinningParticleOffset,u_shapeDirectionalPower:ft.shapeDirectionalPower,u_shapeNormalPower:ft.shapeNormalPower,u_mode:ft.mode});var ft;const Rt=Math.round(w.intensity*this.particlesCount),Ot=r.bd.simpleSegment(0,0,4*Rt,2*Rt);Z.draw(n,Y.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,ht,"rain_particles",this.particlesVx,this.particlesIdx,Ot)};w.distortionStrength>0&&de(w.boxSize,!0),de(w.boxSize,!1),this._vignette.draw(n,L)}}const Ih=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class ks extends Xa{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Eh(n.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const g=wd(this.particlesCount),x=new r.es,w=new r.a_;let S=0;const L=r.e7(1323123451230);for(let P=0;P<g.length;++P){const V=g[P],Y=L(),J=L(),Z=L(),te=[P/g.length,Y,J,Z],de=[L(),L()];x.emplaceBack(V[0],V[1],V[2],-1,-1,...te,...de),x.emplaceBack(V[0],V[1],V[2],1,-1,...te,...de),x.emplaceBack(V[0],V[1],V[2],1,1,...te,...de),x.emplaceBack(V[0],V[1],V[2],-1,1,...te,...de),w.emplaceBack(S+0,S+1,S+2),w.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(x,Ih.members),this.particlesIdx=u.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const u=structuredClone(this._params);let g=[-u.direction.x,u.direction.y,-100];r.au(g,g);const x=structuredClone(this._vignetteParams),w=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=n.transform.zoom;if(w.revealStart>S)return;const L=Tu(0,1,w.revealStart,w.revealStart+w.revealRange,S);x.strength*=L,u.overrideStyleParameters||(u.intensity=n.style.snow.state.density,u.timeFactor=n.style.snow.state.intensity,u.color=structuredClone(n.style.snow.state.color),g=structuredClone(n.style.snow.state.direction),u.screenThinning.intensity=n.style.snow.state.centerThinning,u.billboardSize=2.79*n.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(n.style.snow.state.vignetteColor));const P=this.updateOnRender(n,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const V=n.context,Y=V.gl,J=n.transform,Z=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(V,Z),((te,de,he)=>{const ge=Jc(this._movement.getPosition(),te),_e=J.width/2,Te=J.height/2,je=Tu(0,he.screenThinning.start,0,1,he.screenThinning.intensity),We=Tu(.001,he.screenThinning.range,0,1,he.screenThinning.intensity),ut=Tu(0,he.screenThinning.particleOffset,0,1,he.screenThinning.intensity),at=(nt={modelview:P.modelviewMatrix,projection:P.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ge,velocityConeAperture:he.velocityConeAperture,velocity:he.velocity,horizontalOscillationRadius:he.horizontalOscillationRadius,horizontalOscillationRate:he.horizontalOscillationRate,boxSize:te,billboardSize:1*he.billboardSize,simpleShapeParameters:[he.shapeFadeStart,he.shapeFadePower],screenSize:[J.width,J.height],thinningCenterPos:[_e,Te],thinningShape:[je,We,Math.pow(10,he.screenThinning.fadePower)],thinningAffectedRatio:he.screenThinning.affectedRatio,thinningParticleOffset:ut,color:[he.color.r,he.color.g,he.color.b,he.color.a],direction:g},{u_modelview:Float32Array.from(nt.modelview),u_projection:Float32Array.from(nt.projection),u_time:nt.time,u_cam_pos:nt.camPos,u_velocityConeAperture:nt.velocityConeAperture,u_velocity:nt.velocity,u_horizontalOscillationRadius:nt.horizontalOscillationRadius,u_horizontalOscillationRate:nt.horizontalOscillationRate,u_boxSize:nt.boxSize,u_billboardSize:nt.billboardSize,u_simpleShapeParameters:nt.simpleShapeParameters,u_screenSize:nt.screenSize,u_thinningCenterPos:nt.thinningCenterPos,u_thinningShape:nt.thinningShape,u_thinningAffectedRatio:nt.thinningAffectedRatio,u_thinningParticleOffset:nt.thinningParticleOffset,u_particleColor:nt.color,u_direction:nt.direction});var nt;const qe=Math.round(he.intensity*this.particlesCount),ht=r.bd.simpleSegment(0,0,4*qe,2*qe);this.particlesVx&&this.particlesIdx&&Z.draw(n,Y.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,at,"snow_particles",this.particlesVx,this.particlesIdx,ht)})(u.boxSize,0,u),this._vignette.draw(n,x)}}const On={symbol:function(p,n,u,g,x){if(p.renderPass!=="translucent")return;const w=Pr.disabled,S=p.colorModeForRenderPass(),L=u.layout.get("text-variable-anchor"),P=u.layout.get("text-size-scale-range"),V=r.ay(p.scaleFactor,P[0],P[1]);L&&function(Z,te,de,he,ge,_e,Te,je){const We=te.transform,ut=ge==="map",at=_e==="map";for(const nt of Z){const qe=he.getTile(nt),ht=qe.getBucket(de);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const ft=r.bH(ht.textSizeData,We.zoom,je),Rt=fh(nt,ht.getProjection(),We),Ot=We.calculatePixelsToTileUnitsMatrix(qe),ti=$a(Rt,qe.tileID.canonical,at,ut,We,ht.getProjection(),Ot),ri=ht.hasIconTextFit()&&ht.hasIconData();ft&&Ca(ht,ut,at,Te,We,ti,nt,Math.pow(2,We.zoom-qe.tileID.overscaledZ),ft,ri)}}(g,p,u,n,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x,V);const Y=u.paint.get("icon-opacity").constantOr(1)!==0,J=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||J)?uo(p,n,u,g,w,S):(Y&&uo(p,n,u,g,w,S,{onlyIcons:!0}),J&&uo(p,n,u,g,w,S,{onlyText:!0})),n.map.showCollisionBoxes&&(aa(p,n,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),aa(p,n,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(p,n,u,g){if(p.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),w=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),L=u.layout.get("circle-sort-key").constantOr(1)!==void 0,P=u.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(w.constantOr(1)===0||S.constantOr(1)===0))return;const V=p.context,Y=V.gl,J=p.transform,Z=!(!p.terrain||!p.terrain.enabled),te=u.layout.get("circle-elevation-reference"),de=p.depthModeForSublayer(0,ji.ReadOnly),he=new ji(p.context.gl.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),ge=te==="none"||Z?de:he,_e=Pr.disabled,Te=p.colorModeForDrapableLayerRenderPass(P),je=J.projection.name==="globe",We=[r.aD(J.center.lng),r.aH(J.center.lat)],ut=[];for(let nt=0;nt<g.length;nt++){const qe=g[nt],ht=n.getTile(qe),ft=ht.getBucket(u);if(!ft||ft.projection.name!==J.projection.name)continue;const Rt=ft.programConfigurations.get(u.id),Ot=ft.layoutVertexBuffer,ti=ft.globeExtVertexBuffer,ri=ft.indexBuffer,vi=r.dK(u),Pt=[ti],Qt=p.isTileAffectedByFog(qe);je&&vi.push("PROJECTION_GLOBE_VIEW"),vi.push("DEPTH_D24"),p.terrain&&J.depthOcclusionForSymbolsAndCircles&&vi.push("DEPTH_OCCLUSION"),ft.hasElevation&&(vi.push("ELEVATED_ROADS"),Pt.push(ft.elevatedLayoutVertexBuffer));const Ct=p.getOrCreateProgram("circle",{config:Rt,defines:vi,overrideFog:Qt}),oi=J.projection.createInversionMatrix(J,qe.canonical),zt={programConfiguration:Rt,program:Ct,layoutVertexBuffer:Ot,dynamicBuffers:Pt,indexBuffer:ri,uniformValues:r.dL(p,qe,ht,oi,We,u),tile:ht};if(L){const gi=ft.segments.get();for(const Li of gi)ut.push({segments:new r.bd([Li]),sortKey:Li.sortKey,state:zt})}else ut.push({segments:ft.segments,sortKey:0,state:zt})}L&&ut.sort((nt,qe)=>nt.sortKey-qe.sortKey);const at={useDepthForOcclusion:J.depthOcclusionForSymbolsAndCircles};for(const nt of ut){const{programConfiguration:qe,program:ht,layoutVertexBuffer:ft,dynamicBuffers:Rt,indexBuffer:Ot,uniformValues:ti,tile:ri}=nt.state,vi=nt.segments;p.terrain&&p.terrain.setupElevationDraw(ri,ht,at),p.uploadCommonUniforms(V,ht,ri.tileID.toUnwrapped()),ht.draw(p,Y.TRIANGLES,ge,_e,Te,wr.disabled,ti,u.id,ft,Ot,vi,u.paint,J.zoom,qe,Rt)}},heatmap:function(p,n,u,g){if(u.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,w=x.gl,S=Pr.disabled,L=new Wr([w.ONE,w.ONE,w.ONE,w.ONE],r.am.transparent,[!0,!0,!0,!0]);(function(te,de,he,ge){const _e=te.gl,Te=de.width*ge,je=de.height*ge;te.activeTexture.set(_e.TEXTURE1),te.viewport.set([0,0,Te,je]);let We=he.heatmapFbo;if(!We||We&&(We.width!==Te||We.height!==je)){We&&We.destroy();const ut=_e.createTexture();_e.bindTexture(_e.TEXTURE_2D,ut),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),We=he.heatmapFbo=te.createFramebuffer(Te,je,!0,null),function(at,nt,qe,ht,ft,Rt){const Ot=at.gl;Ot.texImage2D(Ot.TEXTURE_2D,0,at.extRenderToTextureHalfFloat?Ot.RGBA16F:Ot.RGBA,ft,Rt,0,Ot.RGBA,at.extRenderToTextureHalfFloat?Ot.HALF_FLOAT:Ot.UNSIGNED_BYTE,null),ht.colorAttachment.set(qe)}(te,0,ut,We,Te,je)}else _e.bindTexture(_e.TEXTURE_2D,We.colorAttachment.get()),te.bindFramebuffer.set(We.framebuffer)})(x,p,u,p.transform.projection.name==="globe"?.5:.25),x.clear({color:r.am.transparent});const P=p.transform,V=P.projection.name==="globe",Y=V?["PROJECTION_GLOBE_VIEW"]:[],J=V?wr.frontCCW:wr.disabled,Z=[r.aD(P.center.lng),r.aH(P.center.lat)];for(let te=0;te<g.length;te++){const de=g[te];if(n.hasRenderableParent(de))continue;const he=n.getTile(de),ge=he.getBucket(u);if(!ge||ge.projection.name!==P.projection.name)continue;const _e=p.isTileAffectedByFog(de),Te=ge.programConfigurations.get(u.id),je=p.getOrCreateProgram("heatmap",{config:Te,defines:Y,overrideFog:_e}),{zoom:We}=p.transform;p.terrain&&p.terrain.setupElevationDraw(he,je),p.uploadCommonUniforms(x,je,de.toUnwrapped());const ut=P.projection.createInversionMatrix(P,de.canonical);je.draw(p,w.TRIANGLES,ji.disabled,S,L,J,Bi(p,de,he,ut,Z,We,u.paint.get("heatmap-intensity")),u.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,u.paint,p.transform.zoom,Te,V?[ge.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(x,w){const S=x.context,L=S.gl,P=w.heatmapFbo;if(!P)return;S.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,P.colorAttachment.get()),S.activeTexture.set(L.TEXTURE1);let V=w.colorRampTexture;V||(V=w.colorRampTexture=new r.T(S,w.colorRamp,L.RGBA8)),V.bind(L.LINEAR,L.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,L.TRIANGLES,ji.disabled,Pr.disabled,x.colorModeForRenderPass(),wr.disabled,((Y,J,Z,te)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,w),w.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,w.paint,x.transform.zoom)}(p,u))},line:function(p,n,u,g){if(p.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),w=u.paint.get("line-width");if(x.constantOr(1)===0||w.constantOr(1)===0)return;const S=u.paint.get("line-emissive-strength"),L=u.paint.get("line-occlusion-opacity"),P=u.layout.get("line-elevation-reference"),V=u.layout.get("line-width-unit")==="meters",Y=P==="sea",J=!(!p.terrain||!p.terrain.enabled),Z=p.context,te=Z.gl;if(u.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const de=u.layout.get("line-cross-slope"),he=de!==void 0,ge=de<1,_e=p.colorModeForDrapableLayerRenderPass(S),Te=p.terrain&&p.terrain.renderingToTexture,je=Te?1:r.q.devicePixelRatio,We=u.paint.get("line-dasharray"),ut=We.constantOr(1),at=u.layout.get("line-cap"),nt=We.constantOr(null),qe=at.constantOr(null),ht=u.paint.get("line-pattern"),ft=ht.constantOr(1),Rt=u.paint.get("line-pattern-cross-fade"),Ot=ht.constantOr(null),ti=u.paint.get("line-opacity").constantOr(1);let ri=!ft&&ti!==1||p.depthOcclusion&&L>0&&L<1;const vi=u.paint.get("line-gradient"),Pt=ft?"linePattern":"line",Qt=r.dM(u);let Ct;if(Te&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ri=!1),L!==0&&p.depthOcclusion){const Li=u.paint._values["line-opacity"];Li&&Li.value&&Li.value.kind==="constant"?Ct=Li.value:r.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&Qt.push("VARIABLE_LINE_WIDTH");const oi=(Li,ai,Mi,ir,tr,Ki)=>{for(const pr of Li){const gr=n.getTile(pr);if(ft&&!gr.patternsLoaded())continue;const Cr=gr.getBucket(u);if(!Cr||Cr.elevationType!=="none"&&!tr||Cr.elevationType==="none"&&tr)continue;p.prepareDrawTile();const Hr=[...ai],sn=p.shadowRenderer,Zn=Cr.elevationType==="road"&&!!sn&&sn.enabled;let ws=[0,0,0];if(Zn){const Ln=p.style.directionalLight,Lo=p.style.ambientLight;Ln&&Lo&&(ws=oa(p.style,Ln,Lo)),Hr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const rs=Cr.programConfigurations.get(u.id);let ss=!1;if(Ot&&gr.imageAtlas){const Ln=r.dN.from(Ot),Lo=Ln.getPrimary().scaleSelf(je).toString(),Ds=gr.imageAtlas.patternPositions.get(Lo),N=Ln.getSecondary(),O=N?gr.imageAtlas.patternPositions.get(N.scaleSelf(je).toString()):null;ss=!!Ds&&!!O,Ds&&rs.setConstantPatternPositions(Ds,O)}Rt>0&&(ss||rs.getPatternTransitionVertexBuffer("line-pattern"))&&Hr.push("LINE_PATTERN_TRANSITION");const ho=p.isTileAffectedByFog(pr),Jr=p.getOrCreateProgram(Pt,{config:rs,defines:Hr,overrideFog:ho,overrideRtt:!tr&&void 0});if(!ft&&nt&&qe&&gr.lineAtlas){const Ln=gr.lineAtlas.getDash(nt,qe);Ln&&rs.setConstantPatternPositions(Ln)}Zn&&sn.setupShadows(gr.tileID.toUnwrapped(),Jr,"vector-tile",gr.tileID.overscaledZ);let[ln,vn]=u.paint.get("line-trim-offset");(qe==="round"||qe==="square")&&ln!==vn&&(ln===0&&(ln-=1),vn===1&&(vn+=1));const Rs=Te?pr.projMatrix:null,Vo=V?1/Cr.tileToMeter/r.aw(gr,1,p.transform.zoom):1,Ts=V?1/Cr.tileToMeter/r.aw(gr,1,Math.floor(p.transform.zoom)):1,Xn=ft?r.dO(p,gr,u,Rs,je,Vo,Ts,[ln,vn],ws,Rt):r.dP(p,gr,u,Rs,Cr.lineClipsArray.length,je,Vo,Ts,[ln,vn],ws);if(vi){const Ln=Cr.gradients[u.id];let Lo=Ln.texture;if(u.gradientVersion!==Ln.version){let Ds=256;if(u.stepInterpolant){const N=n.getSource().maxzoom,O=pr.canonical.z===N?Math.ceil(1<<p.transform.maxZoom-pr.canonical.z):1;Ds=r.ay(r.dQ(Cr.maxLineLength/r.aj*1024*O),256,Z.maxTextureSize)}Ln.gradient=r.dR({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Ds,image:Ln.gradient||void 0,clips:Cr.lineClipsArray}),Ln.texture?Ln.texture.update(Ln.gradient):Ln.texture=new r.T(Z,Ln.gradient,te.RGBA8),Ln.version=u.gradientVersion,Lo=Ln.texture}Z.activeTexture.set(te.TEXTURE1),Lo.bind(u.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}ut&&(Z.activeTexture.set(te.TEXTURE0),gr.lineAtlasTexture&&gr.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),rs.updatePaintBuffers()),ft&&(Z.activeTexture.set(te.TEXTURE0),gr.imageAtlasTexture&&gr.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),rs.updatePaintBuffers()),tr&&!Y&&p.terrain.setupElevationDraw(gr,Jr),p.uploadCommonUniforms(Z,Jr,pr.toUnwrapped());const to=Ln=>{Ct!=null&&(Ct.value=ti*L),Jr.draw(p,te.TRIANGLES,Mi,Ln,_e,wr.disabled,Xn,u.id,Cr.layoutVertexBuffer,Cr.indexBuffer,Cr.segments,u.paint,p.transform.zoom,rs,[Cr.layoutVertexBuffer2,Cr.patternVertexBuffer,Cr.zOffsetVertexBuffer]),Ct!=null&&(Ct.value=ti)};if(ri&&!tr){const Ln=p.stencilModeForClipping(pr).ref;Ln===0&&Te&&Z.clear({stencil:0});const Lo={func:te.EQUAL,mask:255};Xn.u_alpha_discard_threshold=.8,to(new Pr(Lo,Ln,255,te.KEEP,te.KEEP,te.INVERT)),Xn.u_alpha_discard_threshold=0,to(new Pr(Lo,Ln,255,te.KEEP,te.KEEP,te.KEEP))}else Xn.u_alpha_discard_threshold=ri&&tr&&Ki?.8:0,to(tr?ir:p.stencilModeForClipping(pr))}};let zt=p.depthModeForSublayer(0,ji.ReadOnly);const gi=new ji(p.depthOcclusion?te.GREATER:te.LEQUAL,ji.ReadOnly,p.depthRangeFor3D);if(u.hasNonElevatedBuckets){const Li=!Te&&p.terrain;L!==0&&Li?r.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):Li?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):oi(g,Qt,zt,Pr.disabled,!1,!0)}if(u.hasElevatedBuckets){P==="hd-road-markup"?J||(zt=gi,Qt.push("ELEVATED_ROADS")):(Qt.push("ELEVATED"),zt=gi,he&&Qt.push(ge?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&Qt.push("ELEVATION_REFERENCE_SEA"));const Li=ri?p.stencilModeFor3D():Pr.disabled;p.forceTerrainMode=!0,oi(g,Qt,zt,Li,!0,!0),ri&&oi(g,Qt,zt,Li,!0,!1),p.forceTerrainMode=!1}ri&&(p.resetStencilClippingMasks(),Te&&Z.clear({stencil:0})),L===0||p.depthOcclusion||Te||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,n,u,g){const x=u.paint.get("fill-color"),w=u.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const S=u.paint.get("fill-emissive-strength"),L=p.colorModeForDrapableLayerRenderPass(S),P=u.paint.get("fill-pattern"),V=p.opaquePassEnabledForLayer()&&!P.constantOr(1)&&x.constantOr(r.am.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";let Y="none";u.layout.get("fill-elevation-reference")!=="none"?Y="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(Y="offset");const J=!(!p.terrain||!p.terrain.enabled),Z={painter:p,sourceCache:n,layer:u,coords:g,colorMode:L,elevationType:Y,terrainEnabled:J,pass:V};if(p.renderPass!=="shadow")if(Y!=="offset"){if(la(Z,!1),Y==="road"){const te=!J&&p.renderPass==="translucent";te&&cc(p,n,u,g,"geometry"),la(Z,!0,Pr.disabled),te&&function(de){const{painter:he,sourceCache:ge,layer:_e,coords:Te,colorMode:je}=de,We=he.context.gl,ut=de.painter.shadowRenderer,at=!!ut&&ut.enabled,nt=new ji(he.context.gl.LEQUAL,ji.ReadOnly,he.depthRangeFor3D);let qe=[0,0,0];if(at){const ft=he.style.directionalLight,Rt=he.style.ambientLight;ft&&Rt&&(qe=oa(he.style,ft,Rt))}const ht=ft=>{for(const Rt of Te){const Ot=ge.getTile(Rt),ti=Ot.getBucket(_e);if(!ti)continue;const ri=ti.elevatedStructures;if(!ri)continue;let vi,Pt;if(ft?(vi=ri.renderableBridgeSegments,Pt=ri.bridgeProgramConfigurations.get(_e.id)):(vi=ri.renderableTunnelSegments,Pt=ri.tunnelProgramConfigurations.get(_e.id)),!vi||vi.segments[0].primitiveLength===0)continue;Pt.updatePaintBuffers(),he.prepareDrawTile();const Qt=he.isTileAffectedByFog(Rt),Ct=[];at&&Ct.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const oi=he.getOrCreateProgram("elevatedStructures",{config:Pt,overrideFog:Qt,defines:Ct}),zt=he.translatePosMatrix(Rt.projMatrix,Ot,_e.paint.get("fill-translate"),_e.paint.get("fill-translate-anchor"));at&&ut.setupShadows(Ot.tileID.toUnwrapped(),oi,"vector-tile",Ot.tileID.overscaledZ);const gi=st(zt,qe);he.uploadCommonUniforms(he.context,oi,Rt.toUnwrapped()),oi.draw(he,We.TRIANGLES,nt,Pr.disabled,je,wr.backCCW,gi,_e.id,ri.vertexBuffer,ri.indexBuffer,vi,_e.paint,he.transform.zoom,Pt,[ri.vertexBufferNormal])}};ht(!0),ht(!1)}(Z)}}else la(Z,!1,p.stencilModeFor3D());else p.shadowRenderer&&Y==="road"&&!J&&function(te){const{painter:de,sourceCache:he,layer:ge,coords:_e}=te,Te=de.context.gl,je=te.painter.shadowRenderer;for(const We of _e){const ut=he.getTile(We),at=ut.getBucket(ge);if(!at)continue;const nt=at.elevatedStructures;if(!nt||!nt.shadowCasterSegments||nt.shadowCasterSegments.segments[0].primitiveLength===0)continue;de.prepareDrawTile();const qe=at.bufferData.programConfigurations.get(ge.id),ht=de.isTileAffectedByFog(We),ft=de.getOrCreateProgram("elevatedStructuresDepth",{config:qe,overrideFog:ht}),Rt=je.calculateShadowPassMatrixFromTile(ut.tileID.toUnwrapped());de.uploadCommonUniforms(de.context,ft,We.toUnwrapped());const Ot={u_matrix:Rt,u_depth_bias:.001};ft.draw(de,Te.TRIANGLES,je.getShadowPassDepthMode(),Pr.disabled,je.getShadowPassColorMode(),wr.disabled,Ot,ge.id,nt.vertexBuffer,nt.indexBuffer,nt.shadowCasterSegments,ge.paint,de.transform.zoom,qe)}}(Z)},"fill-extrusion":function(p,n,u,g){const x=u.paint.get("fill-extrusion-opacity"),w=p.context,S=w.gl,L=p.terrain,P=L&&L.renderingToTexture;if(x===0)return;const V=p.conflationActive&&p.style.isLayerClipped(u,n.getSource()),Y=p.style.order.indexOf(u.fqid);if(V&&function(J,Z,te,de,he){for(const ge of de){const _e=Z.getTile(ge).getBucket(te);_e&&(_e.updateReplacement(ge,J.replacementSource,he),_e.uploadCentroid(J.context))}}(p,n,u,g,Y),L||V)for(const J of g){const Z=n.getTile(J).getBucket(u);Z&&Zi(p.context,n,J,Z,u,L,V)}if(p.renderPass==="shadow"&&p.shadowRenderer){const J=p.shadowRenderer;if(L&&x<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.ab)return;const Z=J.getShadowPassDepthMode(),te=J.getShadowPassColorMode();Va(p,n,u,g,Z,Pr.disabled,te,V)}else if(p.renderPass==="translucent"){const J=!u.paint.get("fill-extrusion-pattern").constantOr(1),Z=u.paint.get("fill-extrusion-color").constantOr(r.am.white);if(!P&&Z.a!==0){const te=new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D);x===1&&J?Va(p,n,u,g,te,Pr.disabled,Wr.unblended,V):(Va(p,n,u,g,te,Pr.disabled,Wr.disabled,V),Va(p,n,u,g,te,p.stencilModeFor3D(),p.colorModeForRenderPass(),V),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&J&&(!L&&p.transform.projection.name!=="globe"||P)){const te=u.paint.get("fill-extrusion-opacity"),de=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),he=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ge=u.paint.get("fill-extrusion-flood-light-intensity"),_e=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(_e?null:u.lut).toArray01().slice(0,3),je=de>0&&he>0,We=ge>0,ut=(nt,qe,ht)=>(1-ht)*nt+ht*qe,at=nt=>{const qe=p.depthModeForSublayer(1,ji.ReadOnly,S.LEQUAL,!0),ht=u.paint.get(nt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ft=ut(.1,3,ht),Rt=p._showOverdrawInspector;if(!Rt){const Ot=new Pr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),ti=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0],S.MIN);Ga(p,n,u,g,qe,Ot,ti,wr.disabled,nt,"sdf",te,de,he,ge,Te,ft,V,!1)}{const Ot=Rt?Pr.disabled:new Pr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),ti=Rt?p.colorModeForRenderPass():new Wr([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],r.am.transparent,[!0,!0,!0,!0]);Ga(p,n,u,g,qe,Ot,ti,wr.disabled,nt,"color",te,de,he,ge,Te,ft,V,!1)}};if(P){const nt=(qe,ht,ft)=>{const Rt=p.depthModeForSublayer(1,ji.ReadOnly,S.LEQUAL,!1),Ot=u.paint.get(qe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ti=ut(.1,3,Ot);{const ri=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0]);Ga(p,n,u,g,Rt,Pr.disabled,ri,wr.disabled,qe,"clear",te,de,he,ge,Te,ti,V,ht)}{const ri=new Pr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),vi=new Wr([S.ONE,S.ONE,S.ONE,S.ONE],r.am.transparent,[!1,!1,!1,!0],S.MIN);Ga(p,n,u,g,Rt,ri,vi,wr.disabled,qe,"sdf",te,de,he,ge,Te,ti,V,ht)}{const ri=qe?S.ZERO:S.ONE_MINUS_DST_ALPHA,vi=new Pr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),Pt=new Wr([ri,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],r.am.transparent,[!0,!0,!0,!0]);Ga(p,n,u,g,Rt,vi,Pt,wr.disabled,qe,"color",te,de,he,ge,Te,ti,V,ht)}{const ri=new Wr([S.ONE,S.ONE,S.ONE,qe?S.ZERO:S.ONE],r.am.transparent,[!1,!1,!1,!0],qe?S.FUNC_ADD:S.MAX);Ga(p,n,u,g,Rt,Pr.disabled,ri,wr.disabled,qe,"clear",te,de,he,ge,Te,ti,V,ht,ft)}};if(je||We){let qe;if(p.prepareDrawTile(),L){const ht=L.drapeBufferSize[0],ft=L.drapeBufferSize[1];qe=L.framebufferCopyTexture,qe&&(!qe||qe.size[0]===ht&&qe.size[1]===ft)||(qe&&qe.destroy(),qe=L.framebufferCopyTexture=new r.T(w,new r.r({width:ht,height:ft}),S.RGBA8)),qe.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,ht,ft)}je&&nt(!0,!1,qe),We&&nt(!1,!0,qe)}}else je&&at(!0),We&&at(!1),(je||We)&&p.resetStencilClippingMasks()}}},building:function(p,n,u,g){},hillshade:function(p,n,u,g){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const x=p.context,w=p.terrain&&p.terrain.renderingToTexture,[S,L]=p.renderPass!=="translucent"||w?[{},g]:p.stencilConfigForOverlap(g);for(const P of L){const V=n.getTile(P);if(V.needsHillshadePrepare&&p.renderPass==="offscreen")mh(p,V,u);else if(p.renderPass==="translucent"){const Y=p.depthModeForSublayer(0,ji.ReadOnly),J=u.paint.get("hillshade-emissive-strength"),Z=p.colorModeForDrapableLayerRenderPass(J),te=w&&p.terrain?p.terrain.stencilModeForRTTOverlap(P):S[P.overscaledZ];rA(p,P,V,u,Y,te,Z)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,n,u,g,x,w){if(p.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const S=p.transform.projection.name==="globe",L=u.paint.get("raster-elevation")!==0,P=L&&S;if(p.renderElevatedRasterBackface&&!P)return;const V=p.context,Y=V.gl,J=n.getSource(),Z=function(at,nt,qe,ht){const ft=nt.paint.get("raster-color"),Rt=at.type==="raster-array",Ot=[],ti=nt.paint.get("raster-resampling"),ri=nt.paint.get("raster-color-mix");let vi=nt.paint.get("raster-color-range");const Pt=[ri[0],ri[1],ri[2],0],Qt=ri[3];let Ct=ti==="nearest"?ht.NEAREST:ht.LINEAR;if(Rt&&(Ot.push("RASTER_ARRAY"),ft||Ot.push("RASTER_COLOR"),ti==="linear"&&Ot.push("RASTER_ARRAY_LINEAR"),Ct=ht.NEAREST,!vi&&at.rasterLayers)){const oi=at.rasterLayers.find(({id:zt})=>zt===nt.sourceLayer);oi&&oi.fields&&oi.fields.range&&(vi=oi.fields.range)}if(vi=vi||[0,1],ft){Ot.push("RASTER_COLOR"),qe.activeTexture.set(ht.TEXTURE2),nt.updateColorRamp(vi);let oi=nt.colorRampTexture;oi||(oi=nt.colorRampTexture=new r.T(qe,nt.colorRamp,ht.RGBA8)),oi.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}return{mix:Pt,range:vi,offset:Qt,defines:Ot,resampling:Ct}}(J,u,V,Y);if(J instanceof r.aP&&!g.length&&!S)return;const te=u.paint.get("raster-emissive-strength"),de=p.colorModeForDrapableLayerRenderPass(te),he=p.terrain&&p.terrain.renderingToTexture,ge=!p.options.moving,_e=u.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(J instanceof r.aP&&!g.length&&(J.onNorthPole||J.onSouthPole)){const at=L?p.stencilModeFor3D():Pr.disabled;return void Wu(!!J.onNorthPole,null,p,n,u,te,Z,wr.disabled,at)}if(!g.length)return;const[Te,je]=J instanceof r.aP||he?[{},g]:p.stencilConfigForOverlap(g),We=je[je.length-1].overscaledZ;P&&Z.defines.push("PROJECTION_GLOBE_VIEW"),L&&Z.defines.push("RENDER_CUTOFF");const ut=(at,nt,qe)=>{for(const ht of at){const ft=ht.toUnwrapped(),Rt=n.getTile(ht);if(he&&(!Rt||!Rt.hasData()))continue;V.activeTexture.set(Y.TEXTURE0);const Ot=md(Rt,J,u,Z);if(!Ot||!Ot.texture)continue;const{texture:ti,mix:ri,offset:vi,tileSize:Pt,buffer:Qt}=Ot;let Ct,oi;he?(Ct=ji.disabled,oi=ht.projMatrix):L?(Ct=new ji(Y.LEQUAL,ji.ReadWrite,p.depthRangeFor3D),oi=S?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(ft,ge)):(Ct=p.depthModeForSublayer(ht.overscaledZ-We,u.paint.get("raster-opacity")===1?ji.ReadWrite:ji.ReadOnly,Y.LESS),oi=p.transform.calculateProjMatrix(ft,ge));const zt=p.terrain&&he?p.terrain.stencilModeForRTTOverlap(ht):Te[ht.overscaledZ],gi=w?0:u.paint.get("raster-fade-duration");Rt.registerFadeDuration(gi);const Li=n.findLoadedParent(ht,0),ai=Gu(Rt,Li,n,p.transform,gi);let Mi,ir;p.terrain&&p.terrain.prepareDrawTile(),V.activeTexture.set(Y.TEXTURE0),ti.bind(_e,Y.CLAMP_TO_EDGE),V.activeTexture.set(Y.TEXTURE1),Li?(Li.texture&&Li.texture.bind(_e,Y.CLAMP_TO_EDGE),Mi=Math.pow(2,Li.tileID.overscaledZ-Rt.tileID.overscaledZ),ir=[Rt.tileID.canonical.x*Mi%1,Rt.tileID.canonical.y*Mi%1]):ti.bind(_e,Y.CLAMP_TO_EDGE),"useMipmap"in ti&&V.extTextureFilterAnisotropic&&p.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const tr=p.transform;let Ki;const pr=L?gd(tr):[0,0,0,0];let gr,Cr,Hr,sn,Zn,ws=0;if(P&&J instanceof r.aP&&J.coordinates.length>3)gr=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0)))),Cr=Float32Array.from(tr.globeMatrix),Hr=Float32Array.from(r.dm(tr)),sn=[r.aD(tr.center.lng),r.aH(tr.center.lat)],Ki=J.elevatedGlobePerspectiveTransform,Zn=J.elevatedGlobeGridMatrix||new Float32Array(9);else if(P){const Jr=r.dn(ht.canonical);ws=r.dp(Jr.getCenter().lat),gr=Float32Array.from(r.bh(r.dr(ht.canonical))),Cr=Float32Array.from(tr.globeMatrix),Hr=Float32Array.from(r.dm(tr)),sn=[r.aD(tr.center.lng),r.aH(tr.center.lat)],Ki=[0,0],Zn=Float32Array.from(r.dq(ht.canonical,Jr,ws,tr.worldSize/tr._pixelsPerMercatorPixel))}else Ki=J instanceof r.aP?J.perspectiveTransform:[0,0],gr=new Float32Array(16),Cr=new Float32Array(9),Hr=new Float32Array(16),sn=[0,0],Zn=new Float32Array(9);const rs=Ni(oi,gr,Cr,Hr,Zn,ir||[0,0],r.ah(p.transform.zoom),sn,pr,Mi||1,ai,u,Ki,L?u.paint.get("raster-elevation"):0,2,ri,vi,Z.range,Pt,Qt,te),ss=p.isTileAffectedByFog(ht),ho=p.getOrCreateProgram("raster",{defines:Z.defines,overrideFog:ss});if(p.uploadCommonUniforms(V,ho,ft),J instanceof r.aP){const Jr=J.elevatedGlobeVertexBuffer,ln=J.elevatedGlobeIndexBuffer;if(he||!S)J.boundsBuffer&&J.boundsSegments&&ho.draw(p,Y.TRIANGLES,Ct,Pr.disabled,de,wr.disabled,rs,u.id,J.boundsBuffer,p.quadTriangleIndexBuffer,J.boundsSegments);else if(Jr&&ln){const vn=tr.zoom<=r.cL?J.elevatedGlobeSegments:J.getSegmentsForLongitude(tr.center.lng);vn&&ho.draw(p,Y.TRIANGLES,Ct,Pr.disabled,de,nt,rs,u.id,Jr,ln,vn)}}else if(P){Ct=new ji(Y.LEQUAL,ji.ReadOnly,p.depthRangeFor3D);const Jr=p.globeSharedBuffers;if(Jr){const[ln,vn,Rs]=Jr.getGridBuffers(ws,!1);ho.draw(p,Y.TRIANGLES,Ct,qe||zt,p.colorModeForRenderPass(),nt,rs,u.id,ln,vn,Rs)}}else{const{tileBoundsBuffer:Jr,tileBoundsIndexBuffer:ln,tileBoundsSegments:vn}=p.getTileBoundsBuffers(Rt);ho.draw(p,Y.TRIANGLES,Ct,zt,de,wr.disabled,rs,u.id,Jr,ln,vn)}}if(!(J instanceof r.aP)&&P)for(const ht of at){const ft=ht.canonical.y===(1<<ht.canonical.z)-1;ht.canonical.y===0&&Wu(!0,ht,p,n,u,te,Z,nt,qe||Pr.disabled),ft&&Wu(!1,ht,p,n,u,te,Z,nt===wr.frontCW?wr.backCW:wr.frontCW,qe||Pr.disabled)}};P?ut(je,p.renderElevatedRasterBackface?wr.backCW:wr.frontCW,p.stencilModeFor3D()):ut(je,wr.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,n,u,g,x,w){p.renderPass==="offscreen"&&function(S,L,P,V){if(!V.length)return;const Y=S.context,J=Y.gl,Z=L.getSource();if(!(Z instanceof _c))return;const te=Math.ceil(Math.sqrt(P.paint.get("raster-particle-count")));let de=P.particlePositionRGBAImage;if(!de||de.width!==te){const je=function(We){const ut=We*We,at=new Uint8Array(4*ut),nt=function(ht){return ht|=0,ht=Math.imul(2747636419^ht,2654435769),ht=Math.imul(ht^ht>>>16,2654435769),((ht=Math.imul(ht^ht>>>16,2654435769))>>>0)/4294967296},qe=1/1.1;for(let ht=0;ht<ut;ht++){const ft=qe*(nt(2*ht+0)+ei),Rt=qe*(nt(2*ht+1)+ei),Ot=255*ft%1,ti=255*Rt%1,ri=Ot,vi=Rt-ti/255,Pt=ti;at[4*ht+0]=255*(ft-Ot/255),at[4*ht+1]=255*ri,at[4*ht+2]=255*vi,at[4*ht+3]=255*Pt}return at}(te);de=P.particlePositionRGBAImage=new r.r({width:te,height:te},je)}let he=P.particleFramebuffer;he?he.width!==te&&(he.destroy(),he=P.particleFramebuffer=Y.createFramebuffer(te,te,!0,null)):he=P.particleFramebuffer=Y.createFramebuffer(te,te,!0,null);const ge=[];for(const je of V){const We=L.getTile(je);if(!(We instanceof xl))continue;const ut=Yh(We,Z,P);if(!ut)continue;const at=[We.tileSize,We.tileSize];let nt=P.tileFramebuffer;nt||(nt=P.tileFramebuffer=Y.createFramebuffer(at[0],at[1],!0,null));let qe=We.rasterParticleState;qe||(qe=We.rasterParticleState=new wh(Y,je,at,de));const ht=qe.update(P.lastInvalidatedAt);qe.particleTextureDimension!==te&&qe.updateParticleTexture(je,de);const ft=qe.targetColorTexture;qe.targetColorTexture=qe.backgroundColorTexture,qe.backgroundColorTexture=ft;const Rt=qe.particleTexture0;qe.particleTexture0=qe.particleTexture1,qe.particleTexture1=Rt,ge.push([je,ut,qe,ht])}if(ge.length===0)return;const _e=r.q.now(),Te=P.previousDrawTimestamp?.001*(_e-P.previousDrawTimestamp):.0167;if(P.previousDrawTimestamp=_e,P.hasColorMap()){Y.activeTexture.set(J.TEXTURE0+2);let je=P.colorRampTexture;je||(je=P.colorRampTexture=new r.T(Y,P.colorRamp,J.RGBA8)),je.bind(J.LINEAR,J.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(P.tileFramebuffer.framebuffer),function(je,We,ut){const at=je.context,nt=at.gl,qe=We.tileFramebuffer;at.activeTexture.set(nt.TEXTURE0);const ht={u_texture:0,u_opacity:1.05*(Rt=We.paint.get("raster-particle-fade-opacity-factor"))/(Rt+.05)},ft=je.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Rt;for(const Ot of ut){const[,,ti,ri]=Ot;qe.colorAttachment.set(ti.targetColorTexture.texture),at.viewport.set([0,0,qe.width,qe.height]),at.clear({color:r.am.transparent}),ri&&(ti.backgroundColorTexture.bind(nt.NEAREST,nt.CLAMP_TO_EDGE),ft.draw(je,nt.TRIANGLES,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,ht,We.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments))}}(S,P,ge),function(je,We,ut,at){const nt=je.context,qe=nt.gl,ht=ut.tileFramebuffer,ft=je.transform.projection.name==="globe",Rt=ut.paint.get("raster-particle-max-speed");for(const Ot of at){const[ti,ri,vi]=Ot;nt.activeTexture.set(qe.TEXTURE0+0),ri.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),ht.colorAttachment.set(vi.targetColorTexture.texture);const Pt=je.getOrCreateProgram("rasterParticleDraw",{defines:ri.defines,overrideFog:!1});nt.activeTexture.set(qe.TEXTURE0+1);const Qt=ri.scalarData?[]:[0,1,2,3].map(zt=>r.dT[zt](ti));Qt.push(ti);const Ct=ti.canonical.x,oi=ti.canonical.y;for(const zt of Qt){const gi=We.getTile(ft?zt.wrapped():zt);if(!gi)continue;const Li=gi.rasterParticleState;if(!Li)continue;const ai=zt.canonical.x+(1<<zt.canonical.z)*(zt.wrap-ti.wrap),Mi=zt.canonical.y;Li.particleTexture0.bind(qe.NEAREST,qe.CLAMP_TO_EDGE);const ir=cr(1,Li.particleTexture0.size[0],[ai-Ct,Mi-oi],0,ri.texture.size,2,Rt,ri.textureOffset,ri.scale,ri.offset);Pt.draw(je,qe.POINTS,ji.disabled,Pr.disabled,Wr.alphaBlended,wr.disabled,ir,ut.id,Li.particleIndexBuffer,void 0,Li.particleSegment)}}}(S,L,P,ge),Y.bindFramebuffer.set(P.particleFramebuffer.framebuffer),function(je,We,ut,at){const nt=je.context,qe=nt.gl,ht=We.paint.get("raster-particle-max-speed"),ft=at*We.paint.get("raster-particle-speed-factor")*.15,Rt=function(ti){return Math.pow(ti,6)}(.01+1*We.paint.get("raster-particle-reset-rate-factor")),Ot=We.particleFramebuffer;nt.viewport.set([0,0,Ot.width,Ot.height]);for(const ti of ut){const[,ri,vi]=ti;nt.activeTexture.set(qe.TEXTURE0+0),ri.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),nt.activeTexture.set(qe.TEXTURE0+1);const Pt=vi.particleTexture0;Pt.bind(qe.NEAREST,qe.CLAMP_TO_EDGE);const Qt=$i(1,Pt.size[0],0,ri.texture.size,ht,ft,Rt,ri.textureOffset,ri.scale,ri.offset);Ot.colorAttachment.set(vi.particleTexture1.texture),nt.clear({color:r.am.transparent}),je.getOrCreateProgram("rasterParticleUpdate",{defines:ri.defines}).draw(je,qe.TRIANGLES,ji.disabled,Pr.disabled,Wr.unblended,wr.disabled,Qt,We.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments)}}(S,P,ge,Te)}(p,n,u,g),p.renderPass==="translucent"&&(function(S,L,P,V,Y){const J=S.context,Z=J.gl,te=L.getSource().tileSize,de=5*(1-r.af(r.cx,r.cx+1,S.transform.zoom))*te+P.paint.get("raster-particle-elevation"),he=!S.options.moving,ge=S.transform.projection.name==="globe";if(!V.length)return;const[_e,Te]=S.stencilConfigForOverlap(V),je=[];ge&&je.push("PROJECTION_GLOBE_VIEW");const We=S.stencilModeFor3D();for(const ut of Te){const at=ut.toUnwrapped(),nt=L.getTile(ut);if(!nt.rasterParticleState)continue;const qe=nt.rasterParticleState,ht=100;nt.registerFadeDuration(ht);const ft=L.findLoadedParent(ut,0),Rt=Gu(nt,ft,L,S.transform,ht);let Ot,ti;S.terrain&&S.terrain.prepareDrawTile(),J.activeTexture.set(Z.TEXTURE0),qe.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),J.activeTexture.set(Z.TEXTURE1),ft&&ft.rasterParticleState?(ft.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ot=Math.pow(2,ft.tileID.overscaledZ-nt.tileID.overscaledZ),ti=[nt.tileID.canonical.x*Ot%1,nt.tileID.canonical.y*Ot%1]):qe.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const ri=ge?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(at,he),vi=S.transform,Pt=mA(vi),Qt=r.dn(ut.canonical),Ct=r.dp(Qt.getCenter().lat);let oi,zt,gi,Li,ai;ge?(oi=Float32Array.from(r.bh(r.dr(ut.canonical))),zt=Float32Array.from(vi.globeMatrix),gi=Float32Array.from(r.dm(vi)),Li=[r.aD(vi.center.lng),r.aH(vi.center.lat)],ai=Float32Array.from(r.dq(ut.canonical,Qt,Ct,vi.worldSize/vi._pixelsPerMercatorPixel))):(oi=new Float32Array(16),zt=new Float32Array(9),gi=new Float32Array(16),Li=[0,0],ai=new Float32Array(9));const Mi=qi(ri,oi,zt,gi,ai,ti||[0,0],r.ah(S.transform.zoom),Li,Pt,Ot||1,Rt,de),ir=S.isTileAffectedByFog(ut),tr=S.getOrCreateProgram("rasterParticle",{defines:je,overrideFog:ir});if(S.uploadCommonUniforms(J,tr,at),ge){const Ki=new ji(Z.LEQUAL,ji.ReadOnly,S.depthRangeFor3D),pr=0,gr=S.globeSharedBuffers;if(gr){const[Cr,Hr,sn]=gr.getGridBuffers(Ct,pr!==0);tr.draw(S,Z.TRIANGLES,Ki,We,Wr.alphaBlended,S.renderElevatedRasterBackface?wr.frontCCW:wr.backCCW,Mi,P.id,Cr,Hr,sn)}}else{const Ki=S.depthModeForSublayer(0,ji.ReadOnly),pr=_e[ut.overscaledZ],{tileBoundsBuffer:gr,tileBoundsIndexBuffer:Cr,tileBoundsSegments:Hr}=S.getTileBoundsBuffers(nt);tr.draw(S,Z.TRIANGLES,Ki,pr,Wr.alphaBlended,wr.disabled,Mi,P.id,gr,Cr,Hr)}}S.resetStencilClippingMasks()}(p,n,u,g),p.style.map.triggerRepaint())},background:function(p,n,u,g){const x=u.paint.get("background-color"),w=u.paint.get("background-color-use-theme").constantOr("default")==="none",S=u.paint.get("background-opacity"),L=u.paint.get("background-emissive-strength"),P=u.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const V=p.context,Y=V.gl,J=p.transform,Z=J.tileSize,te=u.paint.get("background-pattern");let de;if(te!==void 0&&(te===null||(de=p.imageManager.getPattern(r.I.from(te.toString()),u.scope,p.style.getLut(u.scope)),!de)))return;const he=!te&&x.a===1&&S===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==he)return;const ge=Pr.disabled,_e=p.depthModeForSublayer(0,he==="opaque"?ji.ReadWrite:ji.ReadOnly),Te=p.colorModeForDrapableLayerRenderPass(L),je=te?"backgroundPattern":"background";let We,ut=g;if(ut||(We=p.getBackgroundTiles(),ut=Object.values(We).map(at=>at.tileID)),te&&(V.activeTexture.set(Y.TEXTURE0),p.imageManager.bind(p.context,u.scope)),P){const at=p.getOrCreateProgram(je,{overrideFog:!1,overrideRtt:!0}),nt=new Float32Array(r.bx([])),qe=new r.aM(0,0,0,0,0),ht=te?zr(nt,L,S,p,0,u.scope,de,P,{tileID:qe,tileSize:Z}):wn(nt,L,S,x.toPremultipliedRenderColor(w?null:u.lut));at.draw(p,Y.TRIANGLES,_e,ge,Te,wr.disabled,ht,u.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const at of ut){const nt=p.isTileAffectedByFog(at),qe=p.getOrCreateProgram(je,{overrideFog:nt}),ht=at.toUnwrapped(),ft=g?at.projMatrix:p.transform.calculateProjMatrix(ht);p.prepareDrawTile();const Rt=n?n.getTile(at):We?We[at.key]:new hu(at,Z,J.zoom,p),Ot=te?zr(ft,L,S,p,0,u.scope,de,P,{tileID:at,tileSize:Z}):wn(ft,L,S,x.toPremultipliedRenderColor(w?null:u.lut));p.uploadCommonUniforms(V,qe,ht);const{tileBoundsBuffer:ti,tileBoundsIndexBuffer:ri,tileBoundsSegments:vi}=p.getTileBoundsBuffers(Rt);qe.draw(p,Y.TRIANGLES,_e,ge,Te,wr.disabled,Ot,u.id,ti,ri,vi)}},sky:function(p,n,u){const g=p._atmosphere?r.ah(p.transform.zoom):1,x=u.paint.get("sky-opacity")*g;if(x===0)return;const w=p.context,S=u.paint.get("sky-type"),L=new ji(w.gl.LEQUAL,ji.ReadOnly,[0,1]),P=p.frameCounter/1e3%1;S==="atmosphere"?p.renderPass==="offscreen"?u.needsSkyboxCapture(p)&&(function(V,Y,J,Z){const te=V.context,de=te.gl;let he=Y.skyboxFbo;if(!he){he=Y.skyboxFbo=te.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new Sh(te),Y.skyboxTexture=te.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,Y.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let je=0;je<6;++je)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(he.framebuffer),te.viewport.set([0,0,32,32]);const ge=Y.getCenter(V,!0),_e=V.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);r.bx(Te),r.e3(Te,Te,.5*-Math.PI),uc(V,Y,_e,Te,ge,0),r.bx(Te),r.e3(Te,Te,.5*Math.PI),uc(V,Y,_e,Te,ge,1),r.bx(Te),r.cG(Te,Te,.5*-Math.PI),uc(V,Y,_e,Te,ge,2),r.bx(Te),r.cG(Te,Te,.5*Math.PI),uc(V,Y,_e,Te,ge,3),r.bx(Te),uc(V,Y,_e,Te,ge,4),r.bx(Te),r.e3(Te,Te,Math.PI),uc(V,Y,_e,Te,ge,5),te.viewport.set([0,0,V.width,V.height])}(p,u),u.markSkyboxValid(p)):p.renderPass==="sky"&&function(V,Y,J,Z,te){const de=V.context,he=de.gl,ge=V.transform,_e=V.getOrCreateProgram("skybox");de.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Te=((je,We,ut,at,nt)=>({u_matrix:je,u_sun_direction:We,u_cubemap:0,u_opacity:at,u_temporal_offset:nt}))(ge.skyboxMatrix,Y.getCenter(V,!1),0,Z,te);V.uploadCommonUniforms(de,_e),_e.draw(V,he.TRIANGLES,J,Pr.disabled,V.colorModeForRenderPass(),wr.backCW,Te,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(p,u,L,x,P):S==="gradient"&&p.renderPass==="sky"&&function(V,Y,J,Z,te){const de=V.context,he=de.gl,ge=V.transform,_e=V.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new Sh(de)),de.activeTexture.set(he.TEXTURE0);let Te=Y.colorRampTexture;Te||(Te=Y.colorRampTexture=new r.T(de,Y.colorRamp,he.RGBA8)),Te.bind(he.LINEAR,he.CLAMP_TO_EDGE);const je=((We,ut,at,nt,qe)=>({u_matrix:We,u_color_ramp:0,u_center_direction:ut,u_radius:r.al(at),u_opacity:nt,u_temporal_offset:qe}))(ge.skyboxMatrix,Y.getCenter(V,!1),Y.paint.get("sky-gradient-radius"),Z,te);V.uploadCommonUniforms(de,_e),_e.draw(V,he.TRIANGLES,J,Pr.disabled,V.colorModeForRenderPass(),wr.backCW,je,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(p,u,L,x,P)},custom:function(p,n,u,g){const x=p.context,w=u.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&u.isDraped(n)){if(p.renderPass==="offscreen"){const S=w.prerender;if(S){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const L=p.transform.pointMerc;S.call(w,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),r.ah(p.transform.zoom),[L.x,L.y],p.transform.pixelsPerMeterRatio)}else S.call(w,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const L=w.renderToTile;if(L){const P=g[0].canonical,V={x:P.x+g[0].wrap*(w.wrapTileId?0:1<<P.z),y:P.y,z:P.z};x.setDepthMode(ji.disabled),x.setStencilMode(Pr.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),L.call(w,x.gl,V),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(Pr.disabled);const S=w.renderingMode==="3d"?new ji(p.context.gl.LEQUAL,ji.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,ji.ReadOnly);if(x.setDepthMode(S),p.transform.projection.name==="globe"){const L=p.transform.pointMerc;w.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),r.ah(p.transform.zoom),[L.x,L.y],p.transform.pixelsPerMeterRatio)}else w.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,n,u,g){if(p.renderPass==="opaque")return;const x=u.paint.get("model-opacity").constantOr(1);if(x===0)return;const w=u.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!w||p.terrain&&x<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof r.ab))return;const S=p.shadowRenderer,L=u.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,L||(S.enabled=!1));const P=()=>{S&&(S.useNormalOffset=!0,L||(S.enabled=!0))},V=n.getSource();if(p.renderPass==="light-beam"&&V.type!=="batched-model")return;if(V.type==="vector"||V.type==="geojson")return function(_e,Te,je,We,ut){const at=_e.transform;if(at.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${at.projection.name} projection is not yet implemented`);const nt=at.getFreeCameraOptions().position;if(!_e.modelManager)return;const qe=_e.modelManager;je.modelManager=qe;const ht=_e.shadowRenderer;if(!je._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ft=je._unevaluatedLayout._values["model-id"],Rt=Object.assign({},je.layout.get("model-id").parameters),Ot=_e.style.order.indexOf(je.fqid);for(const ti of We){const ri=Te.getTile(ti).getBucket(je);if(!ri||ri.projection.name!==at.projection.name)continue;const vi=ri.getModelUris();vi&&!ri.modelsRequested&&(qe.addModelsFromBucket(vi,ut),ri.modelsRequested=!0);const Pt=xd(ti,at);Rt.zoom=Pt;const Qt=ft.possiblyEvaluate(Rt);if(Lt(_e,ri,ti),hc.shadowUniformsInitialized=!1,hc.useSingleShadowCascade=!!ht&&ht.getMaxCascadeForTile(ti.toUnwrapped())===0,_e.renderPass==="shadow"&&ht){if(_e.currentShadowCascade===1&&ri.isInsideFirstShadowMapFrustum)continue;const zt=at.calculatePosMatrix(ti.toUnwrapped(),at.worldSize);if(hc.tileMatrix.set(zt),hc.shadowTileMatrix=Float32Array.from(ht.calculateShadowPassMatrixFromMatrix(zt)),hc.aabb.min.fill(0),hc.aabb.max[0]=hc.aabb.max[1]=r.aj,hc.aabb.max[2]=0,Ku(ri,hc,_e,je.scope))continue}const Ct=1<<ti.canonical.z,oi=[((nt.x-ti.wrap)*Ct-ti.canonical.x)*r.aj,(nt.y*Ct-ti.canonical.y)*r.aj,nt.z*Ct*r.aj];_e.conflationActive&&Object.keys(ri.instancesPerModel).length>0&&_e.style.isLayerClipped(je,Te.getSource())&&ri.updateReplacement(ti,_e.replacementSource,Ot,ut)&&(ri.uploaded=!1,ri.upload(_e.context));for(let zt in ri.instancesPerModel){const gi=ri.instancesPerModel[zt];gi.features.length>0&&(zt=Qt.evaluate(gi.features[0].feature,{}));const Li=qe.getModel(zt,ut);if(Li||qe.hasURLBeenRequested(zt)||ri.modelUris.includes(zt)||(ri.modelUris.push(zt),ri.modelsRequested=!1),Li&&Li.uploaded)for(const ai of Li.nodes)xA(_e,je,ai,gi,oi,ti,hc)}}}(p,n,u,g,V.type==="vector"?u.scope:""),void P();if(!V.loaded())return;if(V.type==="batched-model")return function(_e,Te,je,We){je.resetLayerRenderingStats(_e);const ut=_e.context,at=_e.transform,nt=_e.style.fog,qe=_e.shadowRenderer;if(at.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${at.projection.name} projection is not yet implemented`);const ht=_e.transform.getFreeCameraOptions().position,ft=r.bY([],[ht.x,ht.y,ht.z],_e.transform.worldSize),Rt=r.eb([],ft),Ot=r.bx([]),ti=r.ec(at.center.lat,at.zoom),ri=r.bn([],[1,1,1/ti]);r.bo(Ot,Ot,Rt);const vi=je.paint.get("model-opacity").constantOr(1),Pt=new ji(ut.gl.LEQUAL,ji.ReadWrite,_e.depthRangeFor3D),Qt=new ji(ut.gl.LEQUAL,ji.ReadOnly,_e.depthRangeFor3D),Ct=new r.cW([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),oi=_e.renderPass==="shadow",zt=oi&&qe?qe.getCurrentCascadeFrustum():at.getFrustum(at.scaleZoom(at.worldSize)),gi=je.paint.get("model-front-cutoff"),Li=gi[2]<1,ai=cl(_e,je.paint.get("model-cutoff-fade-range")),Mi=je.getLayerRenderingStats();(function(ir,tr,Ki,pr){const gr=ir.terrain?ir.terrain.exaggeration():0,Cr=ir.transform.zoom;for(const Hr of pr){const sn=tr.getTile(Hr).getBucket(Ki);sn&&(sn.setFilter(Ki.filter),ir.conflationActive&&sn.updateReplacement(Hr,ir.replacementSource),sn.evaluateTransform(ir,Ki),ir.terrain&&gr>0&&sn.elevationUpdate(ir.terrain,gr,Hr,Ki.source),sn.needsReEvaluation(ir,Cr,Ki)&&sn.evaluate(Ki))}})(_e,Te,je,We),function(){let ir,tr,Ki;Li?(ir=We.length-1,tr=-1,Ki=-1):(ir=0,tr=We.length,Ki=1);const pr=new Float64Array(16),gr=r.ef(),Cr=new r.P(0,0);for(let Hr=ir;Hr!==tr;Hr+=Ki){const sn=We[Hr],Zn=Te.getTile(sn).getBucket(je);if(!Zn||!Zn.uploaded)continue;let ws=!1;qe&&(ws=qe.getMaxCascadeForTile(sn.toUnwrapped())===0);const rs=at.calculatePosMatrix(sn.toUnwrapped(),at.worldSize),ss=Zn.modelTraits;!oi&&Li&&(r.bi(pr,rs),r.ad(gr,ft,pr),Cr.x=gr[0],Cr.y=gr[1]);const ho=[];Zn.setFilter(je.filter);for(const Jr of Zn.getNodesInfo()){if(Jr.hiddenByReplacement||!Jr.node.meshes)continue;const ln=Jr.node;let vn=0;_e.terrain&&ln.elevation&&(vn=ln.elevation*_e.terrain.exaggeration());const Rs=(()=>{const W=Jr.aabb;return Ct.min=[...W.min],Ct.max=[...W.max],Ct.min[2]+=vn,Ct.max[2]+=vn,r.ad(Ct.min,Ct.min,rs),r.ad(Ct.max,Ct.max,rs),Ct})(),Vo=Jr.evaluatedScale;if(Vo[0]<=1&&Vo[1]<=1&&Vo[2]<=1&&Rs.intersects(zt)===0)continue;if(!oi&&Li){const W=.16666666666666666;Jr.cameraCollisionOpacity=ft[0]>Rs.min[0]&&ft[0]<Rs.max[0]&&ft[1]>Rs.min[1]&&ft[1]<Rs.max[1]&&ft[2]*ti<Rs.max[2]&&ln.footprint&&r.bS(Cr,ln.footprint)?Math.max(Jr.cameraCollisionOpacity-W,0):Math.min(1,Jr.cameraCollisionOpacity+W)}const Ts=[...rs],Xn=1/r.cU(sn.canonical),to=ln.anchor?ln.anchor[0]:0,Ln=ln.anchor?ln.anchor[1]:0;r.bo(Ts,Ts,[to*(Vo[0]-1)+Jr.evaluatedTranslation[0]*Xn,Ln*(Vo[1]-1)+Jr.evaluatedTranslation[1]*Xn,vn+Jr.evaluatedTranslation[2]]),r.ci(Vo,r.eg)||r.cE(Ts,Ts,Vo);const Lo=r.az([],Ts,ln.matrix),Ds=r.az([],at.expandedFarZProjMatrix,Lo),N=r.az([],at.expandedFarZProjMatrix,Ts),O=r.aA([],[to,Ln,vn,1],Ds)[2];ln.hidden=!1;let X=vi;oi||(Li&&(X*=Jr.cameraCollisionOpacity,X*=Iu(Ts,at,Jr.aabb,gi)),X*=Hf(ai,O)),X!==0?ho.push({nodeInfo:Jr,depth:O,opacity:X,wvpForNode:Ds,wvpForTile:N,nodeModelMatrix:Lo,tileModelMatrix:Ts}):ln.hidden=!0}oi||ho.sort((Jr,ln)=>!Li||Jr.opacity===1&&ln.opacity===1?Jr.depth<ln.depth?-1:1:Jr.opacity===1?-1:ln.opacity===1?1:Jr.depth>ln.depth?-1:1);for(const Jr of ho){const ln=Jr.nodeInfo,vn=ln.node;let Rs=r.az([],ri,Jr.tileModelMatrix);r.az(Rs,Ot,Rs);const Vo=r.bi([],Rs);r.ee(Vo,Vo),r.cE(Vo,Vo,bA),Rs=r.az(Rs,Rs,vn.matrix);const Ts=_e.renderPass==="light-beam",Xn=je.paint.get("model-color-use-theme").constantOr("default")==="none",to=ss&r.em.HasMapboxMeshFeatures,Ln=to?0:ln.evaluatedRMEA[0][2];for(let Lo=0;Lo<vn.meshes.length;++Lo){const Ds=vn.meshes[Lo],N=Lo===vn.lightMeshIndex;let O=Jr.wvpForNode;if(N){if(!Ts&&!_e.terrain&&_e.shadowRenderer){_e.currentLayer<_e.firstLightBeamLayer&&(_e.firstLightBeamLayer=_e.currentLayer);continue}O=Jr.wvpForTile}else if(Ts)continue;const X={defines:[]},W=[];if(!oi&&qe&&(qe.useNormalOffset=!!Ds.normalBuffer),Ei(X.defines,W,Ds,_e,Xn?null:je.lut),to||X.defines.push("DIFFUSE_SHADED"),ws&&X.defines.push("SHADOWS_SINGLE_CASCADE"),Mi&&(oi?Mi.numRenderedVerticesInShadowPass+=Ds.vertexArray.length:Mi.numRenderedVerticesInTransparentPass+=Ds.vertexArray.length),oi){Ns(Ds,Jr.nodeModelMatrix,_e,je);continue}let ce=null;if(nt){const si=Zc(Jr.nodeModelMatrix,_e.transform);if(ce=new Float32Array(si),at.projection.name!=="globe"){const pi=Ds.aabb.min,Ui=Ds.aabb.max,[Gr,vr]=nt.getOpacityForBounds(si,pi[0],pi[1],Ui[0],Ui[1]);X.overrideFog=Gr>=Nt||vr>=Nt}}const Be=Ds.material;let De;Be.occlusionTexture&&Be.occlusionTexture.offsetScale&&(De=Be.occlusionTexture.offsetScale,X.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const gt=_e.getOrCreateProgram("model",X);!oi&&qe&&qe.setupShadowsFromMatrix(Jr.tileModelMatrix,gt,qe.useNormalOffset),_e.uploadCommonUniforms(ut,gt,null,ce);const pt=Be.pbrMetallicRoughness;pt.metallicFactor=.9,pt.roughnessFactor=.5;const Ht=Vs(new Float32Array(O),new Float32Array(Rs),new Float32Array(Vo),new Float32Array(vn.matrix),_e,Jr.opacity,pt.baseColorFactor,Be.emissiveFactor,pt.metallicFactor,pt.roughnessFactor,Be,Ln,je,[0,0,0],De);!N&&(ln.hasTranslucentParts||Jr.opacity<1)&&gt.draw(_e,ut.gl.TRIANGLES,Pt,Pr.disabled,Wr.disabled,wr.backCCW,Ht,je.id,Ds.vertexBuffer,Ds.indexBuffer,Ds.segments,je.paint,_e.transform.zoom,void 0,W),gt.draw(_e,ut.gl.TRIANGLES,N?Qt:Pt,Pr.disabled,N||Jr.opacity<1||ln.hasTranslucentParts?Wr.alphaBlended:Wr.unblended,wr.backCCW,Ht,je.id,Ds.vertexBuffer,Ds.indexBuffer,Ds.segments,je.paint,_e.transform.zoom,void 0,W)}}}}()}(p,n,u,g),void P();if(V.type!=="model")return;const Y=V.getModels(),J=[],Z=p.transform.getFreeCameraOptions().position,te=r.bY([],[Z.x,Z.y,Z.z],p.transform.worldSize);r.eb(te,te);const de=[],he=[];let ge=0;for(const _e of Y){const Te=u.paint.get("model-rotation").constantOr(null),je=u.paint.get("model-scale").constantOr(null),We=u.paint.get("model-translation").constantOr(null);_e.computeModelMatrix(p,Te,je,We,!0,!0,!1);const ut=r.bx([]),at=r.ec(_e.position.lat,p.transform.zoom),nt=r.bn([],[1,1,1/at]);r.bo(ut,ut,te),J.push({zScaleMatrix:nt,negCameraPosMatrix:ut});for(const qe of _e.nodes)Yu(p.transform,qe,_e.matrix,p.transform.expandedFarZProjMatrix,ge,de,he);ge++}if(de.sort((_e,Te)=>Te.depth-_e.depth),p.renderPass!=="shadow"){if(x===1)for(const _e of he)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,p.colorModeForRenderPass());else{for(const _e of he)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,Wr.disabled);for(const _e of he)Gi(_e,p,u,J[_e.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const _e of de)Gi(_e,p,u,J[_e.modelIndex],Pr.disabled,p.colorModeForRenderPass());P()}else{for(const _e of he)Ns(_e.mesh,_e.nodeModelMatrix,p,u);for(const _e of de)Ns(_e.mesh,_e.nodeModelMatrix,p,u);P()}}},Vf={line:function(p,n,u){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(n){const g=n.getVisibleCoordinates();for(const x of g){const w=n.getTile(x).getBucket(p);if(w&&(w.elevationType!=="none"?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,n,u){const g=n.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,g.type==="vector"?p.scope:""));if(g.type==="batched-model"||g.type!=="model")return;const x=g.getModels();for(const w of x)w.upload(u.context)},raster:function(p,n,u){const g=n.getSource();if(!(g instanceof _c&&g.loaded()))return;const x=p.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const w=p.paint.get("raster-array-band")||g.getInitialBand(x);if(w==null)return;const S=n.getIds().map(L=>n.getTileByID(L));for(const L of S)L.updateNeeded(x,w)&&g.prepareTile(L,x,w)},"raster-particle":function(p,n,u){const g=n.getSource();if(!(g instanceof _c&&g.loaded()))return;const x=p.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;const w=p.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(w==null)return;const S=n.getIds().map(L=>n.getTileByID(L));for(const L of S)L.updateNeeded(x,w)&&g.prepareTile(L,x,w)}},$u={fill:cc},Bd={fill:function(p,n,u,g){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const x=p.context.gl,w=new ji(x.LEQUAL,ji.ReadOnly,p.depthRangeFor3D),S=new Pr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),L=p.transform.getFreeCameraOptions().position,P=p.getOrCreateProgram("elevatedStructuresDepthReconstruct",{defines:["DEPTH_RECONSTRUCTION"]});for(const V of g){const Y=n.getTile(V),J=Y.getBucket(u);if(!J)continue;const Z=J.elevatedStructures;if(!Z||Z.maskSegments.segments[0].primitiveLength===0)continue;const te=Qa(V.toUnwrapped(),L),de=p.translatePosMatrix(V.projMatrix,Y,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),he=dt(de,te,0,0,0);P.draw(p,x.TRIANGLES,w,S,Wr.disabled,wr.disabled,he,u.id,Z.vertexBuffer,Z.indexBuffer,Z.maskSegments,u.paint,p.transform.zoom)}}};class wA{constructor(n,u,g,x,w,S){this.context=new Tl(n,u),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const L=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const V of L)this._debugParams.enabledLayers[V]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of L)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new Kh(w),this.setup(),this.numSublayers=ko.maxUnderzooming+ko.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new zl(this),this._wireframeDebugCache=new Pa,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const P=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,P,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x,this.worldview=S}updateTerrain(n,u){const g=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new fd(this,n));const x=this._terrain;this.transform.elevation=g?x:null,x.update(n,this.transform,u),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(n){const u=n.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=u.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const w=g+.78*(x-g);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new fd(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,u){if(this.width=n*r.q.devicePixelRatio,this.height=u*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const n=this.context,u=new r.ba;u.emplaceBack(0,0),u.emplaceBack(r.aj,0),u.emplaceBack(0,r.aj),u.emplaceBack(r.aj,r.aj),this.tileExtentBuffer=n.createVertexBuffer(u,r.bc.members),this.tileExtentSegments=r.bd.simpleSegment(0,0,4,2);const g=new r.ba;g.emplaceBack(0,0),g.emplaceBack(r.aj,0),g.emplaceBack(0,r.aj),g.emplaceBack(r.aj,r.aj),this.debugBuffer=n.createVertexBuffer(g,r.bc.members),this.debugSegments=r.bd.simpleSegment(0,0,4,5);const x=new r.ba;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(x,r.bc.members),this.viewportSegments=r.bd.simpleSegment(0,0,4,2);const w=new r.aZ;w.emplaceBack(0,0,0,0),w.emplaceBack(r.aj,0,r.aj,0),w.emplaceBack(0,r.aj,0,r.aj),w.emplaceBack(r.aj,r.aj,r.aj,r.aj),this.mercatorBoundsBuffer=n.createVertexBuffer(w,r.bf.members),this.mercatorBoundsSegments=r.bd.simpleSegment(0,0,4,2);const S=new r.a_;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S);const L=new r.bb;for(const V of[0,1,3,2,0])L.emplaceBack(V);this.debugIndexBuffer=n.createIndexBuffer(L),this.emptyTexture=new r.T(n,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=r.bz();const P=this.context.gl;this.stencilClearMode=new Pr({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,ji.disabled,this.stencilClearMode,Wr.disabled,wr.disabled,_h(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,u,g){if(!u||this.currentStencilSource===u.id||!n.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const P of g)if(this._tileClippingMaskIDs[P.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=u.id;const x=this.context,w=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(Wr.disabled),x.setDepthMode(ji.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of g){const P=u.getTile(L),V=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:J,tileBoundsSegments:Z}=this.getTileBoundsBuffers(P);S.draw(this,w.TRIANGLES,ji.disabled,new Pr({func:w.ALWAYS,mask:0},V,255,w.KEEP,w.KEEP,w.REPLACE),Wr.disabled,wr.disabled,_h(L.projMatrix),"$clipping",Y,J,Z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Pr({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const u=this.context.gl;return new Pr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(n){const u=this.context.gl,g=n.sort((S,L)=>L.overscaledZ-S.overscaledZ),x=g[g.length-1].overscaledZ,w=g[0].overscaledZ-x+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let L=0;L<w;L++)S[L+x]=new Pr({func:u.GEQUAL,mask:255},L+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[S,g]}return[{[x]:Pr.disabled},g]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Wr([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new r.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Wr.unblended:Wr.alphaBlended}colorModeForDrapableLayerRenderPass(n){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Wr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new r.am(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,u,g,x=!1){if(this.depthOcclusion)return new ji(this.context.gl.GREATER,ji.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return ji.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new ji(g||this.context.gl.LEQUAL,u,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,u=Math.ceil(this.width),g=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),w=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&g!==0&&(this.depthFBO=new $s(this.context,u,g,!1,"texture"),this.depthTexture=new r.T(this.context,{width:u,height:g,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),n.bindTexture(n.TEXTURE_2D,w),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,u,g,0,0,u,g,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,u)=>n+u/this._fpsHistory.length,0))}render(n,u){const g=r.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=u;const x=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(w).filter(Pt=>{const Qt=x[Pt];return!(Qt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Qt.type]});let L=S(),P=!1,V=!1;for(const Pt of L){const Qt=x[Pt];Qt.type==="circle"&&(P=!0),Qt.type==="symbol"&&(Qt.hasInitialOcclusionOpacityProperties?V=!0:P=!0)}let Y=L.map(Pt=>x[Pt]);const J=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let Z=0,te=!1;for(const Pt in J){const Qt=J[Pt];Qt.used&&(Qt.prepare(this.context),Qt.getSource().usedInConflation&&++Z)}let de=!1;for(const Pt of Y)Pt.isHidden(this.transform.zoom)||(Pt.type==="clip"&&(de=!0),this.prepareLayer(Pt));const he={},ge={},_e={},Te={},je={};for(const Pt in J){const Qt=J[Pt];he[Pt]=Qt.getVisibleCoordinates(),ge[Pt]=he[Pt].slice().reverse(),_e[Pt]=Qt.getVisibleCoordinates(!0).reverse(),Te[Pt]=Qt.getShadowCasterCoordinates(),je[Pt]=Qt.sortCoordinatesByDistance(he[Pt])}const We=Pt=>{const Qt=this.style.getLayerSourceCache(Pt);return Qt&&Qt.used?Qt.getSource():null};if(Z||de||this._clippingActiveLastFrame){const Pt=[],Qt=[];let Ct=0;for(const oi of Y)this.isSourceForClippingOrConflation(oi,We(oi))&&(Pt.push(oi),Qt.push(Ct)),Ct++;if(Pt&&(de||Pt.length>1)||this._clippingActiveLastFrame){de=!1;const oi=[];for(let zt=0;zt<Pt.length;zt++){const gi=Pt[zt],Li=Qt[zt],ai=this.style.getLayerSourceCache(gi);if(!ai||!ai.used||!ai.getSource().usedInConflation&&gi.type!=="clip")continue;let Mi=r.eu,ir=r.bQ.None;const tr=[];let Ki=!0;if(gi.type==="clip"){Mi=Li;for(const pr of gi.layout.get("clip-layer-types"))ir|=pr==="model"?r.bQ.Model:pr==="symbol"?r.bQ.Symbol:r.bQ.FillExtrusion;for(const pr of gi.layout.get("clip-layer-scope"))tr.push(pr);gi.isHidden(this.transform.zoom)?Ki=!1:de=!0}Ki&&oi.push({layer:gi.fqid,cache:ai,order:Mi,clipMask:ir,clipScope:tr})}this.replacementSource.setSources(oi),te=!0}}this._clippingActiveLastFrame=de,te||this.replacementSource.clear(),this.conflationActive=te,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Pt=0;Pt<Y.length;Pt++){const Qt=Y[Pt],Ct=Qt.cutoffRange();if(this.longestCutoffRange=Math.max(Ct,this.longestCutoffRange),Ct>0){const oi=We(Qt);oi&&(this.minCutoffZoom=Math.max(oi.minzoom,this.minCutoffZoom)),Qt.minzoom&&(this.minCutoffZoom=Math.max(Qt.minzoom,this.minCutoffZoom))}Qt.is3D(w)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Pt),this._lastOcclusionLayer=Pt)}const ut=this.style&&this.style.fog;ut?(this._fogVisible=ut.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=ut.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0,L=S(),Y=L.map(Pt=>x[Pt]));const at=this._shadowRenderer;if(at){at.updateShadowParameters(this.transform,this.style.directionalLight);for(const Pt in J)for(const Qt of he[Pt]){let Ct={min:0,max:0};this.terrain&&(Ct=this.terrain.getMinMaxForTile(Qt)||Ct),at.addShadowReceiver(Qt.toUnwrapped(),Ct.min,Ct.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.ev(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ua(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const nt=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),qe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(nt&&!this._snow&&(this._snow=new ks(this)),!nt&&this._snow&&(this._snow.destroy(),delete this._snow),qe&&!this._rain&&(this._rain=new of(this)),!qe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!mi.has(this.context.gl))return;this.renderPass="offscreen";for(const Pt of Y){const Qt=n.getLayerSourceCache(Pt);if(!Pt.hasOffscreenPass()||Pt.isHidden(this.transform.zoom))continue;const Ct=Qt?ge[Qt.id]:void 0;(Pt.type==="custom"||Pt.type==="raster"||Pt.type==="raster-particle"||Pt.isSky()||Ct&&Ct.length)&&this.renderLayer(this,Qt,Pt,Ct)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ht=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),ft=(()=>{if(u.showOverdrawInspector)return r.am.black;const Pt=this.style.fog;if(Pt&&this.transform.projection.supportsFog){const Qt=this.style.getLut(Pt.scope);if(!ht){const Ct=Pt.properties.get("color-use-theme")==="none",oi=Pt.properties.get("color").toNonPremultipliedRenderColor(Ct?null:Qt).toArray01();return new r.am(...oi)}if(ht){const Ct=Pt.properties.get("space-color-use-theme")==="none",oi=Pt.properties.get("space-color").toNonPremultipliedRenderColor(Ct?null:Qt).toArray01();return new r.am(...oi)}}return r.am.transparent})();if(this.context.clear({color:ft,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ht&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Pt=Y[this.currentLayer],Qt=n.getLayerSourceCache(Pt);if(Pt.isSky())continue;const Ct=Qt?(Pt.is3D(w)?je:ge)[Qt.id]:void 0;this._renderTileClippingMasks(Pt,Qt,Ct),this.renderLayer(this,Qt,Pt,Ct)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ht&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Pt=Y[this.currentLayer],Qt=n.getLayerSourceCache(Pt);Pt.isSky()&&this.renderLayer(this,Qt,Pt,Qt?ge[Qt.id]:void 0)}function Rt(Pt,Qt){let Ct;return Qt&&(Ct=(Pt.type==="symbol"?_e:Pt.is3D(w)?je:ge)[Qt.id]),Ct}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<L.length;){const Pt=Y[this.currentLayer];if(Pt.type==="raster"||Pt.type==="raster-particle"){const Qt=n.getLayerSourceCache(Pt);this.renderLayer(this,Qt,Pt,Rt(Pt,Qt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Ot=0;at&&(Ot=at.getShadowCastingLayerCount());let ti=!1,ri=-1;for(let Pt=0;Pt<L.length;++Pt){const Qt=Y[Pt];Qt.isHidden(this.transform.zoom)||Qt.is3D(w)&&(ri=Pt)}V&&ri===-1&&(P=!0);let vi=!1;for(;this.currentLayer<L.length;){const Pt=Y[this.currentLayer],Qt=n.getLayerSourceCache(Pt);if(Pt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Pt)){if(Pt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!vi&&Pt.is3D(w)&&!w){const Ct=this.currentLayer,oi=zt=>{for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const gi=Y[this.currentLayer];if($u[gi.type]){const Li=this.style.getLayerSourceCache(gi);$u[gi.type](this,Li,gi,Rt(gi,Li),zt)}}};oi("initialize"),oi("reset"),this.currentLayer=Ct,vi=!0}if(P&&!ti&&this.terrain&&!this.transform.isOrthographic&&(ti=!0,this.blitDepth()),V&&ri!==-1&&this.currentLayer===ri+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Pt,Qt,Qt?he[Qt.id]:void 0),this.renderLayer(this,Qt,Pt,Rt(Pt,Qt)),!this.terrain&&at&&Ot>0&&Pt.hasShadowPass()&&--Ot==0){{this.clearStencil();const Ct=this.currentLayer;for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const oi=Y[this.currentLayer];if(Bd[oi.type]){const zt=this.style.getLayerSourceCache(oi);Bd[oi.type](this,zt,oi,Rt(oi,zt))}}this.currentLayer=Ct}if(at.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Ct=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ct;this.currentLayer++){const oi=Y[this.currentLayer];if(!oi.hasLightBeamPass())continue;const zt=n.getLayerSourceCache(oi);this.renderLayer(this,zt,oi,zt?ge[zt.id]:void 0)}this.currentLayer=Ct,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ct=this.currentLayer;this.depthOcclusion=!0;for(const oi of this.layersWithOcclusionOpacity){this.currentLayer=oi;const zt=Y[this.currentLayer],gi=n.getLayerSourceCache(zt),Li=gi?ge[gi.id]:void 0;this.terrain||this._renderTileClippingMasks(zt,gi,gi?he[gi.id]:void 0),this.renderLayer(this,gi,zt,Li)}this.depthOcclusion=!1,this.currentLayer=Ct,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Pt=null;Y.forEach(Qt=>{const Ct=n.getLayerSourceCache(Qt);Ct&&!Qt.isHidden(this.transform.zoom)&&Ct.getVisibleCoordinates().length&&(!Pt||Pt.getSource().maxzoom<Ct.getSource().maxzoom)&&(Pt=Ct)}),Pt&&this.options.showTileBoundaries&&Fl(this,Pt,Pt.getVisibleCoordinates(),r.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Fl(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Pt){const Qt=Pt.transform.padding;vA(Pt,Pt.transform.height-(Qt.top||0),3,yA),vA(Pt,Qt.bottom||0,3,yd),Ch(Pt,Qt.left||0,3,Wa),Ch(Pt,Pt.transform.width-(Qt.right||0),3,Bh);const Ct=Pt.transform.centerPoint;(function(oi,zt,gi,Li){hl(oi,zt-1,gi-10,2,20,Li),hl(oi,zt-10,gi-1,20,2,Li)})(Pt,Ct.x,Pt.transform.height-Ct.y,ca)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),te||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:u}=this.transform.projection,g=!u||!u.includes(n.type);if(Vf[n.type]&&(g||this.terrain&&n.type==="custom")){const x=this.style.getLayerSourceCache(n);Vf[n.type](n,x,this)}this.gpuTimingEnd()}renderLayer(n,u,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(g.type)&&(!n.terrain||g.type!=="custom")||g.type==="clip"||On[g.type](n,u,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,g=this.context.gl;let x=this.gpuTimers[n.id];x||(x=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(u.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,u=this.context.gl,g=u.createQuery();this.deferredRenderGpuTimeQueries.push(g),u.beginQuery(n.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const u={};for(const g in n){const x=n[g],w=this.context.extTimerQuery,S=w.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(x.query),u[g]=S}return u}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let g=0;for(const x of n)g+=u.getQueryParameter(x,u.QUERY_RESULT)/1e6,u.deleteQuery(x);return g}translatePosMatrix(n,u,g,x,w){if(!g[0]&&!g[1])return n;const S=w?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(S){const V=Math.sin(S),Y=Math.cos(S);g=[g[0]*Y-g[1]*V,g[0]*V+g[1]*Y]}const L=[w?g[0]:r.aw(u,g[0],this.transform.zoom),w?g[1]:r.aw(u,g[1],this.transform.zoom),0],P=new Float32Array(16);return r.bo(P,n,L),P}saveTileTexture(n){const u=n.size[0],g=this._tileTextures[u];g?g.push(n):this._tileTextures[u]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,u,g){const x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,w=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||x||u!==void 0&&!u||w.push("FOG","FOG_DITHERING"),x&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(n,u){this.cache=this.cache||{};const g=u&&u.defines||[],x=u&&u.config,w=this.currentGlobalDefines(n,u&&u.overrideFog,u&&u.overrideRtt).concat(g),S=xh.cacheKey(ph[n],n,w,x);return this.cache[S]||(this.cache[S]=new xh(this.context,n,ph[n],x,Ar[n],w)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,u){if(this.style.enable3dLights()){const g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){const w=((S,L,P)=>{const V=S.properties.get("direction"),Y=S.properties.get("color-use-theme")==="none",J=S.properties.get("color").toNonPremultipliedRenderColor(Y?null:P.getLut(S.scope)).toArray01(),Z=S.properties.get("intensity"),te=L.properties.get("color-use-theme")==="none",de=L.properties.get("color").toNonPremultipliedRenderColor(te?null:P.getLut(L.scope)).toArray01(),he=L.properties.get("intensity"),ge=[V.x,V.y,V.z],_e=r.dw(de,he),Te=r.dw(J,Z);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:ge,u_lighting_directional_color:Te,u_ground_radiance:fA(ge,Te,_e)}})(g,x,this.style);u.setLightsUniformValues(n,w)}}}uploadCommonUniforms(n,u,g,x,w){if(this.uploadCommonLightUniforms(n,u),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const L=S.getOpacity(this.transform.pitch),P=((V,Y,J,Z,te,de,he,ge,_e,Te,je,We)=>{const ut=V.transform,at=Y.properties.get("color-use-theme")==="none",nt=Y.properties.get("color").toNonPremultipliedRenderColor(at?null:V.style.getLut(Y.scope)).toArray01();nt[3]=Z;const qe=V.frameCounter/1e3%1,[ht,ft]=Y.properties.get("vertical-range");return{u_fog_matrix:J?ut.calculateFogTileMatrix(J):We||V.identityMat,u_fog_range:Y.getFovAdjustedRange(ut._fov),u_fog_color:nt,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ht,ft),ft],u_fog_temporal_offset:qe,u_frustum_tl:te,u_frustum_tr:de,u_frustum_br:he,u_frustum_bl:ge,u_globe_pos:_e,u_globe_radius:Te,u_viewport:je,u_globe_transition:r.ah(ut.zoom),u_is_globe:+(ut.projection.name==="globe")}})(this,S,g,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],x);u.setFogUniformValues(n,P)}w&&u.setCutoffUniformValues(n,w.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,u=n.createTexture();return n.bindTexture(n.TEXTURE_2D,u),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)u[x.key]=n[x.key]||new hu(x,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,u){return!(!n.is3D(!(!this.terrain||!this.terrain.enabled))||n.type!=="clip"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[n.key];return u||(this._cachedTileFogOpacities[n.key]=u=this.style.fog.getOpacityForTile(n)),u[0]>=Nt||u[1]>=Nt}setupDepthForOcclusion(n,u,g){const x=this.context,w=x.gl,S=!!g;var L;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(w.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((L=this.depthRangeFor3D)[1]-L[0]),-1-2*L[0]/(L[1]-L[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),x.activeTexture.set(w.TEXTURE0),S||u.setTerrainUniformValues(x,g)}}function qh(p,n){let u=!1,g=null;const x=()=>{g=null,u&&(p(),g=setTimeout(x,n),u=!1)};return()=>(u=!0,g||x(),g)}class Dp{constructor(n){this._hashName=n&&encodeURIComponent(n),r.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=qh(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const u=Gf(n);if(this._hashName){const g=this._hashName;let x=!1;const w=location.hash.slice(1).split("&").map(S=>{const L=S.split("=")[0];return L===g?(x=!0,`${L}=${u}`):S}).filter(S=>S);return x||w.push(`${g}=${u}`),`#${w.join("&")}`}return`#${u}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(Number(g)))){const g=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(u[3]||0):n.getBearing();return n.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Gf(p,n){const u=p.getCenter(),g=Math.round(100*p.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,x),S=Math.round(u.lng*w)/w,L=Math.round(u.lat*w)/w,P=p.getBearing(),V=p.getPitch();let Y=n?`/${S}/${L}/${g}`:`${g}/${L}/${S}`;return(P||V)&&(Y+="/"+Math.round(10*P)/10),V&&(Y+=`/${Math.round(V)}`),Y}const Th={linearity:.3,easing:r.ew(0,0,.3,1)},BA=r.h({deceleration:2500,maxSpeed:1400},Th),Zu=r.h({deceleration:20,maxSpeed:1400},Th),Fh=r.h({deceleration:1e3,maxSpeed:360},Th),Cd=r.h({deceleration:1e3,maxSpeed:90},Th);class af{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=r.q.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const w=Ed(u.pan.mag(),g,r.h({},BA,n||{}));x.offset=u.pan.mult(w.amount/u.pan.mag()),x.center=this._map.transform.center,Sd(x,w)}if(u.zoom){const w=Ed(u.zoom,g,Zu);x.zoom=this._map.transform.zoom+w.amount,Sd(x,w)}if(u.bearing){const w=Ed(u.bearing,g,Fh);x.bearing=this._map.transform.bearing+r.ay(w.amount,-179,179),Sd(x,w)}if(u.pitch){const w=Ed(u.pitch,g,Cd);x.pitch=this._map.transform.pitch+w.amount,Sd(x,w)}if(x.zoom||x.bearing){const w=u.pinchAround===void 0?u.around:u.pinchAround;x.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Sd(p,n){(!p.duration||p.duration<n.duration)&&(p.duration=n.duration,p.easing=n.easing)}function Ed(p,n,u){const{maxSpeed:g,linearity:x,deceleration:w}=u,S=r.ay(p*x/(n/1e3),-g,g),L=Math.abs(S)/(w*x);return{easing:u.easing,duration:1e3*L,amount:S*(L/2)}}class Ya extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g,x={}){const w=le(u.getCanvasContainer(),g),S=u.unproject(w);super(n,r.h({point:w,lngLat:S,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class Lh extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,g){const x=n==="touchend"?g.changedTouches:g.touches,w=be(u.getCanvasContainer(),x),S=w.map(P=>u.unproject(P)),L=w.reduce((P,V,Y,J)=>P.add(V.div(J.length)),new r.P(0,0));super(n,{points:w,point:L,lngLats:S,lngLat:u.unproject(L),originalEvent:g}),this._defaultPrevented=!1}}class Mh extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class Wf{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new Mh(this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Ya(n.type,this._map,n))}mouseup(n){this._map.fire(new Ya(n.type,this._map,n))}preclick(n){const u=r.h({},n);u.type="preclick",this._map.fire(new Ya(u.type,this._map,u))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Ya(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Ya(n.type,this._map,n))}mouseover(n){this._map.fire(new Ya(n.type,this._map,n))}mouseout(n){this._map.fire(new Ya(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Lh(n.type,this._map,n))}touchmove(n){this._map.fire(new Lh(n.type,this._map,n))}touchend(n){this._map.fire(new Lh(n.type,this._map,n))}touchcancel(n){this._map.fire(new Lh(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xf{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Ya(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ya("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ya(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Op{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(ne(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const g=u,x=this._startPos,w=this._lastPos;if(!x||!w||w.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=M("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const S=Math.min(x.x,g.x),L=Math.max(x.x,g.x),P=Math.min(x.y,g.y),V=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${P}px)`,this._box.style.width=L-S+"px",this._box.style.height=V-P+"px")})}mouseupWindow(n,u){if(!this._active)return;const g=this._startPos,x=u;if(g&&n.button===0){if(this.reset(),Ae(),g.x!==x.x||g.y!==x.y)return this._map.fire(new r.A("boxzoomend",{originalEvent:n})),{cameraAnimation:w=>w.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),re(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new r.A(n,{originalEvent:u}))}}function CA(p,n){const u={};for(let g=0;g<p.length;g++)u[p[g].identifier]=n[g];return u}class Jo{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const w=new r.P(0,0);for(const S of x)w._add(S);return w.div(x.length)}(u),this.touches=CA(g,u)))}touchmove(n,u,g){if(this.aborted||!this.centroid)return;const x=CA(g,u);for(const w in this.touches){const S=x[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(n,u,g){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Id{constructor(n){this.singleTap=new Jo(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,u,g){this.singleTap.touchstart(n,u,g)}touchmove(n,u,g){this.singleTap.touchmove(n,u,g)}touchend(n,u,g){const x=this.singleTap.touchend(n,u,g);if(x){const w=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(x)<30;if(w&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class SA{constructor(){this._zoomIn=new Id({numTouches:1,numTaps:2}),this._zoomOut=new Id({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,g){this._zoomIn.touchstart(n,u,g),this._zoomOut.touchstart(n,u,g)}touchmove(n,u,g){this._zoomIn.touchmove(n,u,g),this._zoomOut.touchmove(n,u,g)}touchend(n,u,g){const x=this._zoomIn.touchend(n,u,g),w=this._zoomOut.touchend(n,u,g);return x?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(x)},{originalEvent:n})}):w?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Up={0:1,2:2},$h={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class lf{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,u){return!1}_move(n,u){return{}}mousedown(n,u){if(this._lastPoint)return;const g=we(n);this._correctButton(n,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(n,u){const g=this._lastPoint;if(g){if(n.preventDefault(),this._eventButton!=null&&function(x,w){const S=Up[w];return x.buttons===void 0||(x.buttons&S)!==S}(n,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(n){this._lastPoint&&we(n)===this._eventButton&&(this._moved&&Ae(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zp extends lf{mousedown(n,u){super.mousedown(n,u),this._lastPoint&&(this._active=!0)}_correctButton(n,u){return u===0&&!n.ctrlKey}_move(n,u){return{around:u,panDelta:u.sub(n)}}}class cf extends lf{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?$h[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const g=.8*(u.x-n.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class Ph extends lf{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?$h[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const g=-.5*(u.y-n.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class Yf{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),r.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(n,u,g){return this._calculateTransform(n,u,g)}touchmove(n,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!r.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,u,g)}}touchend(n,u,g){this._calculateTransform(n,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,g){g.length>0&&(this._active=!0);const x=CA(g,u),w=new r.P(0,0),S=new r.P(0,0);let L=0;for(const V in x){const Y=x[V],J=this._touches[V];J&&(w._add(Y),S._add(Y.sub(J)),L++,x[V]=Y)}if(this._touches=x,L<this._minTouches||!S.mag())return;const P=S.div(L);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(L),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class EA{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,u,g){return{}}touchstart(n,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,g){const x=this._firstTwoTouches;if(!x)return;n.preventDefault();const[w,S]=x,L=Zh(g,u,w),P=Zh(g,u,S);if(!L||!P)return;const V=this._aroundCenter?null:L.add(P).div(2);return this._move([L,P],V,n)}touchend(n,u,g){if(!this._firstTwoTouches)return;const[x,w]=this._firstTwoTouches,S=Zh(g,u,x),L=Zh(g,u,w);S&&L||(this._active&&Ae(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Zh(p,n,u){for(let g=0;g<p.length;g++)if(p[g].identifier===u)return n[g]}function IA(p,n){return Math.log(p/n)/Math.LN2}class Kf extends EA{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const g=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(IA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:IA(this._distance,g),pinchAround:u}}}function qf(p,n){return 180*p.angleWith(n)/Math.PI}class uf extends EA{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u){const g=this._vector;if(this._vector=n[0].sub(n[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:qf(this._vector,g),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const x=qf(n,g);return Math.abs(x)<u}}function Td(p){return Math.abs(p.y)>Math.abs(p.x)}class Np extends EA{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Td(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,g){const x=this._lastPoints;if(!x)return;const w=n[0].sub(x[0]),S=n[1].sub(x[1]);return this._map._cooperativeGestures&&!r.ex()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(w,S,g.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5})}gestureBeginsVertically(n,u,g){if(this._valid!==void 0)return this._valid;const x=n.mag()>=2,w=u.mag()>=2;if(!x&&!w)return;if(!x||!w)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const S=n.y>0==u.y>0;return Td(n)&&Td(u)&&S}}const jp={panStep:100,bearingStep:15,pitchStep:10};class Fg{constructor(){const n=jp;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,g=0,x=0,w=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?g=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?g=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?x=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?x=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:L=>{const P=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:Hp,zoom:u?Math.round(P)+u*(n.shiftKey?2:1):P,bearing:L.getBearing()+g*this._bearingStep,pitch:L.getPitch()+x*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:L.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Hp(p){return p*(2-p)}const $f=4.000244140625,Lg=1/450;class Mg{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Lg,r.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||r.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const g=r.q.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%$f==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=le(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>$f?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&Y!==0&&(Y=1/Y);const J=u(),Z=Math.pow(2,J),te=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(te*Y))),this._type==="wheel"&&(this._startZoom=J,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,w=this._easing;let S,L=!1;if(this._type==="wheel"&&x&&w){const V=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),Y=w(V);S=r.ai(x,g,Y),V<1?this._frameId||(this._frameId=!0):L=!0}else S=g,L=!0;this._active=!0,L&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let P=S-u();return P*this._lastDelta<0&&(P=0),{noInertia:!0,needsRenderFrame:!L,zoomDelta:P,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=r.ey;if(this._prevEase){const g=this._prevEase,x=(r.q.now()-g.start)/g.duration,w=g.easing(x+.01)-g.easing(x),S=.27/Math.sqrt(w*w+1e-4)*.01,L=Math.sqrt(.0729-S*S);u=r.ew(S,L,.25,1)}return this._prevEase={start:r.q.now(),duration:n,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Fd{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,u){return n.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(n.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ga{constructor(){this._tap=new Id({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,u,g){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(n,u,g))}touchmove(n,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],w=x.y-this._swipePoint.y;return this._swipePoint=x,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,u,g)}touchend(n,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(n,u,g)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jh{constructor(n,u,g){this._el=n,this._mousePan=u,this._touchPan=g}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class TA{constructor(n,u,g){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ed{constructor(n,u,g,x){this._el=n,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fu=p=>p.zoom||p.drag||p.pitch||p.rotate;class Gs extends r.A{}class Ju{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,u){const g=r.at([],u,n);this.radius=r.ae(g[2]<0?r.eA([],g,this.constants):[g[0],g[1],0])}projectRay(n){r.eA(n,n,this.constants),r.au(n,n),r.eB(n,n,this.constants);const u=r.bY([],n,this.radius);if(u[2]>0){const g=r.bY([],[0,0,1],r.bG(u,[0,0,1])),x=r.bY([],r.au([],[u[0],u[1],0]),this.radius),w=r.cV([],u,r.bY([],r.at([],r.cV([],x,g),u),2));u[0]=w[0],u[1]=w[1]}return u}}function hf(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Zf{constructor(n,u){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new af(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ju,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),r.aV(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,w,S]of this._listeners){const L=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(w,L,S)}}destroy(){for(const[n,u,g]of this._listeners){const x=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(u,x,g)}}_addDefaultHandlers(n){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new Wf(u,n));const x=u.boxZoom=new Op(u,n);this._add("boxZoom",x);const w=new SA,S=new Qp;u.doubleClickZoom=new Fd(S,w),this._add("tapZoom",w),this._add("clickZoom",S);const L=new ga;this._add("tapDragZoom",L);const P=u.touchPitch=new Np(u);this._add("touchPitch",P);const V=new cf(n),Y=new Ph(n);u.dragRotate=new TA(n,V,Y),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const J=new zp(n),Z=new Yf(u,n);u.dragPan=new Jh(g,J,Z),this._add("mousePan",J),this._add("touchPan",Z,["touchZoom","touchRotate"]);const te=new uf,de=new Kf;u.touchZoomRotate=new ed(g,de,te,L),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Xf(u));const he=u.scrollZoom=new Mg(u,this);this._add("scrollZoom",he,["mousePan"]);const ge=u.keyboard=new Fg;this._add("keyboard",ge);for(const _e of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[_e]&&u[_e].enable(n[_e])}_add(n,u,g){this._handlers.push({handlerName:n,handler:u,allowed:g}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,u,g){for(const x in n)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const u=[];for(const g of n)this._el.contains(g.target)&&u.push(g);return u}handleEvent(n,u){this._updatingCamera=!0;const g=n.type==="renderFrame",x=g?void 0:n,w={needsRenderFrame:!1},S={},L={},P=n.touches?this._getMapTouches(n.touches):void 0,V=P?be(this._el,P):g?void 0:le(this._el,n);for(const{handlerName:Z,handler:te,allowed:de}of this._handlers){if(!te.isEnabled())continue;let he;this._blockedByActive(L,de,Z)?te.reset():te[u||n.type]&&(he=te[u||n.type](n,V,P),this.mergeHandlerResult(w,S,he,Z,x),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||te.isActive())&&(L[Z]=te)}const Y={};for(const Z in this._previousActiveHandlers)L[Z]||(Y[Z]=x);this._previousActiveHandlers=L,(Object.keys(Y).length||hf(w))&&(this._changes.push([w,S,Y]),this._triggerRenderFrame()),(Object.keys(L).length||hf(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=w;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(n,u,g,x,w){if(!g)return;r.h(n,g);const S={handlerName:x,originalEvent:g.originalEvent||w};g.zoomDelta!==void 0&&(u.zoom=S),g.panDelta!==void 0&&(u.drag=S),g.pitchDelta!==void 0&&(u.pitch=S),g.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const n={},u={},g={};for(const[x,w,S]of this._changes)x.panDelta&&(n.panDelta=(n.panDelta||new r.P(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(n.around=x.around),x.aroundCoord!==void 0&&(n.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),r.h(u,w),r.h(g,S);this._updateMapTransform(n,u,g),this._changes=[]}_updateMapTransform(n,u,g){const x=this._map,w=x.transform,S=Te=>[Te.x,Te.y,Te.z];if((Te=>{const je=this._eventsInProgress.drag;return je&&!this._handlersById[je.handlerName].isActive()})()&&!hf(n)){const Te=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Te!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&x._stop(!0),!hf(n))return void this._fireEvents(u,g,!0);let{panDelta:L,zoomDelta:P,bearingDelta:V,pitchDelta:Y,around:J,aroundCoord:Z,pinchAround:te}=n;w._isCameraConstrained&&(P>0&&(P=0),w._isCameraConstrained=!1),te!==void 0&&(J=te),(P||(Te=>u[Te]&&!this._eventsInProgress[Te])("drag"))&&J&&(this._dragOrigin=S(w.pointCoordinate3D(J)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",x._stop(!0),J=J||x.transform.centerPoint,V&&(w.bearing+=V),Y&&(w.pitch+=Y),w._updateCameraState();const de=[0,0,0];if(L)if(w.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(J).dir),je=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(J.sub(L)).dir);de[0]=je[0]-Te[0],de[1]=je[1]-Te[1]}else{const Te=w.pointCoordinate(J);if(w.projection.name==="globe"){L=L.rotate(-w.angle);const je=w._pixelsPerMercatorPixel/w.worldSize;de[0]=-L.x*r.ez(r.aY(Te.y))*je,de[1]=-L.y*r.ez(w.center.lat)*je}else{const je=w.pointCoordinate(J.sub(L));Te&&je&&(de[0]=je.x-Te.x,de[1]=je.y-Te.y)}}const he=w.zoom,ge=[0,0,0];if(P){const Te=S(Z||w.pointCoordinate3D(J)),je={dir:r.au([],r.at([],Te,w._camera.position))};if(je.dir[2]<0){const We=w.zoomDeltaToMovement(Te,P);r.bY(ge,je.dir,We)}}const _e=r.cV(de,de,ge);w._translateCameraConstrained(_e),P&&Math.abs(w.zoom-he)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,g,!0)}_fireEvents(n,u,g){const x=Fu(this._eventsInProgress),w=Fu(n),S={};for(const Y in n){const{originalEvent:J}=n[Y];this._eventsInProgress[Y]||(S[`${Y}start`]=J),this._eventsInProgress[Y]=n[Y]}!x&&w&&this._fireEvent("movestart",w.originalEvent);for(const Y in S)this._fireEvent(Y,S[Y]);w&&this._fireEvent("move",w.originalEvent);for(const Y in n){const{originalEvent:J}=n[Y];this._fireEvent(Y,J)}const L={};let P;for(const Y in this._eventsInProgress){const{handlerName:J,originalEvent:Z}=this._eventsInProgress[Y];this._handlersById[J].isActive()||(delete this._eventsInProgress[Y],P=u[J]||Z,L[`${Y}end`]=P)}for(const Y in L)this._fireEvent(Y,L[Y]);const V=Fu(this._eventsInProgress);if(g&&(x||w)&&!V){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;Y?(J(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:P})):(this._map.fire(new r.A("moveend",{originalEvent:P})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new r.A(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Gs("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Vp="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ld extends r.E{constructor(n,u){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,r.aV(["_renderFrameCallback"],this)}getCenter(){return new r.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}panBy(n,u,g){return n=r.P.convert(n).mult(-1),this.panTo(this.transform.center,r.h({offset:n},u),g)}panTo(n,u,g){return this.easeTo(r.h({center:n},u),g)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,g){return this.easeTo(r.h({zoom:n},u),g)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,g){return this.easeTo(r.h({bearing:n},u),g)}resetNorth(n,u){return this.rotateTo(0,r.h({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(r.h({bearing:0,pitch:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}cameraForBounds(n,u){n=r.aG.convert(n);const g=u&&u.bearing||0,x=u&&u.pitch||0,w=n.getNorthWest(),S=n.getSouthEast();return this._cameraForBounds(this.transform,w,S,g,x,u)}_extendPadding(n){const u={top:0,right:0,bottom:0,left:0};return n==null?r.h({},u,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:r.h({},u,n)}_extendCameraOptions(n){return(n=r.h({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,u){const g=u.max[0]-u.min[0],x=u.max[1]-u.min[1];return g/x>n.aspect?g/(2*Math.tan(.5*n.fovX)*n.aspect):x/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,u,g,x,w,S){const L=n.clone(),P=this._extendCameraOptions(S);L.bearing=x,L.pitch=w;const V=r.cd.convert(u),Y=r.cd.convert(g),J=.5*(V.lat+Y.lat),Z=.5*(V.lng+Y.lng),te=r.eC(J,Z),de=r.au([],te),he=r.au([],r.bF([],de,[0,1,0])),ge=r.bF([],he,de),_e=[he[0],he[1],he[2],0,ge[0],ge[1],ge[2],0,de[0],de[1],de[2],0,0,0,0,1],Te=[te,r.eC(V.lat,V.lng),r.eC(Y.lat,V.lng),r.eC(Y.lat,Y.lng),r.eC(V.lat,Y.lng),r.eC(J,V.lng),r.eC(J,Y.lng),r.eC(V.lat,Z),r.eC(Y.lat,Z)];let je=r.cW.fromPoints(Te.map(zt=>[r.bG(he,zt),r.bG(ge,zt),r.bG(de,zt)]));const We=r.ad([],je.center,_e);r.eD(We)===0&&r.eE(We,0,0,1),r.au(We,We),r.bY(We,We,r.aB),L.center=r.eF(We);const ut=L.getWorldToCameraMatrix(),at=r.bi(new Float64Array(16),ut);je=r.cW.applyTransform(je,r.az([],ut,_e));const nt=this._extendAABB(je,L,P,x);if(!nt)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");je=nt,r.ad(We,We,ut);const qe=.5*(je.max[2]-je.min[2]),ht=this._minimumAABBFrustumDistance(L,je),ft=r.bY([],[0,0,1],qe),Rt=r.cV(ft,We,ft),Ot=ht+(L.pitch===0?0:r.bD(We,Rt)),ti=L.globeCenterInViewSpace,ri=r.at([],We,[ti[0],ti[1],ti[2]]);r.au(ri,ri),r.bY(ri,ri,Ot);const vi=r.cV([],We,ri);r.ad(vi,vi,at);const Pt=r.eq/r.aB,Qt=r.ae(vi),Ct=r.c6(Math.max(Qt*Pt-r.eq,Number.EPSILON),0),oi=Math.min(L.zoomFromMercatorZAdjusted(Ct),P.maxZoom);return oi>.5*(r.cL+r.cx)?(L.setProjection({name:"mercator"}),L.zoom=oi,this._cameraForBounds(L,u,g,x,w,S)):{center:L.center,zoom:oi,bearing:x,pitch:w}}_extendAABB(n,u,g,x){const w=.5*((g.padding.left||0)+(g.padding.right||0)),S=.5*((g.padding.top||0)+(g.padding.bottom||0)),L=S,P=w,V=w,Y=S,J=u.width-(P+V),Z=u.height-(L+Y),te=r.at([],n.max,n.min),de=Math.min(J/te[0],Z/te[1]),he=Math.min(u.scaleZoom(u.scale*de),g.maxZoom);if(isNaN(he))return null;const ge=u.scale/u.zoomScale(he),_e=new r.cW([n.min[0]-P*ge,n.min[1]-Y*ge,n.min[2]],[n.max[0]+V*ge,n.max[1]+L*ge,n.max[2]]),Te=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new r.P(g.offset.x,g.offset.y):r.P.convert(g.offset)).rotate(-r.al(x));return _e.center[0]-=Te.x*ge,_e.center[1]+=Te.y*ge,_e}queryTerrainElevation(n,u){const g=this.transform.elevation;return g?(u=r.h({},{exaggerated:!0},u),g.getAtPoint(r.ac.fromLngLat(n),null,u.exaggerated)):null}_cameraForBounds(n,u,g,x,w,S){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,u,g,x,w,S);const L=n.clone(),P=this._extendCameraOptions(S);L.bearing=x,L.pitch=w;const V=r.cd.convert(u),Y=r.cd.convert(g),J=new r.cd(V.lng,Y.lat),Z=new r.cd(Y.lng,V.lat),te=L.project(V),de=L.project(Y),he=this.queryTerrainElevation(V),ge=this.queryTerrainElevation(Y),_e=this.queryTerrainElevation(J),Te=this.queryTerrainElevation(Z),je=[[te.x,te.y,Math.min(he||0,ge||0,_e||0,Te||0)],[de.x,de.y,Math.max(he||0,ge||0,_e||0,Te||0)]];let We=r.cW.fromPoints(je);const ut=L.getWorldToCameraMatrix(),at=r.bi(new Float64Array(16),ut);We=r.cW.applyTransform(We,ut);const nt=this._extendAABB(We,L,P,x);if(!nt)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");We=nt;const qe=.5*r.at([],We.max,We.min)[2],ht=this._minimumAABBFrustumDistance(L,We),ft=[0,0,1,0];r.aA(ft,ft,ut),r.eG(ft,ft);const Rt=r.bY([],ft,ht+qe),Ot=r.cV([],We.center,Rt);r.ad(We.center,We.center,at),r.ad(Ot,Ot,at);const ti=L.unproject(new r.P(We.center[0],We.center[1])),ri=r.eH(L.projection,ti),vi=Math.pow(2,ri),Pt=Math.min(L._zoomFromMercatorZ(Ot[2]*L.pixelsPerMeter*vi/L.worldSize),P.maxZoom);return L.mercatorFromTransition&&Pt<.5*(r.cL+r.cx)?(L.setProjection({name:"globe"}),L.zoom=Pt,this._cameraForBounds(L,u,g,x,w,S)):{center:ti,zoom:Pt,bearing:x,pitch:w}}fitBounds(n,u,g){const x=this.cameraForBounds(n,u);return this._fitInternal(x,u,g)}fitScreenCoordinates(n,u,g,x,w){const S=r.P.convert(n),L=r.P.convert(u),P=new r.P(Math.min(S.x,L.x),Math.min(S.y,L.y)),V=new r.P(Math.max(S.x,L.x),Math.max(S.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,L))return this;const Y=this.transform.pointLocation3D(P),J=this.transform.pointLocation3D(V),Z=this.transform.pointLocation3D(new r.P(P.x,V.y)),te=this.transform.pointLocation3D(new r.P(V.x,P.y)),de=[Math.min(Y.lng,J.lng,Z.lng,te.lng),Math.min(Y.lat,J.lat,Z.lat,te.lat)],he=[Math.max(Y.lng,J.lng,Z.lng,te.lng),Math.max(Y.lat,J.lat,Z.lat,te.lat)],ge=x&&x.pitch?x.pitch:this.getPitch(),_e=this._cameraForBounds(this.transform,de,he,g,ge,x);return this._fitInternal(_e,x,w)}_fitInternal(n,u,g){return n?(u=r.h(n,u)).linear?this.easeTo(u,g):this.flyTo(u,g):this}jumpTo(n,u){this.stop();const g=n.preloadOnly?this.transform.clone():this.transform;let x=!1,w=!1,S=!1;"zoom"in n&&g.zoom!==+n.zoom&&(x=!0,g.zoom=+n.zoom),n.center!==void 0&&(g.center=r.cd.convert(n.center)),"bearing"in n&&g.bearing!==+n.bearing&&(w=!0,g.bearing=+n.bearing),"pitch"in n&&g.pitch!==+n.pitch&&(S=!0,g.pitch=+n.pitch);const L=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!g.isPaddingEqual(L))if(n.retainPadding===!1){const P=g.clone();P.padding=L,g.setLocationAtPoint(g.center,P.centerPoint)}else g.padding=L;return n.preloadOnly?(this._preloadTiles(g),this):(this.fire(new r.A("movestart",u)).fire(new r.A("move",u)),x&&this.fire(new r.A("zoomstart",u)).fire(new r.A("zoom",u)).fire(new r.A("zoomend",u)),w&&this.fire(new r.A("rotatestart",u)).fire(new r.A("rotate",u)).fire(new r.A("rotateend",u)),S&&this.fire(new r.A("pitchstart",u)).fire(new r.A("pitch",u)).fire(new r.A("pitchend",u)),this.fire(new r.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(Vp),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return r.w(Vp),this;this.stop();const x=g.zoom,w=g.pitch,S=g.bearing;g.setFreeCameraOptions(n);const L=x!==g.zoom,P=w!==g.pitch,V=S!==g.bearing;return this.fire(new r.A("movestart",u)).fire(new r.A("move",u)),L&&this.fire(new r.A("zoomstart",u)).fire(new r.A("zoom",u)).fire(new r.A("zoomend",u)),V&&this.fire(new r.A("rotatestart",u)).fire(new r.A("rotate",u)).fire(new r.A("rotateend",u)),P&&this.fire(new r.A("pitchstart",u)).fire(new r.A("pitch",u)).fire(new r.A("pitchend",u)),this.fire(new r.A("moveend",u)),this}easeTo(n,u){this._stop(!1,n.easeId),((n=r.h({offset:[0,0],duration:500,easing:r.ey},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const g=this.transform,x=this.getZoom(),w=this.getBearing(),S=this.getPitch(),L=this.getPadding(),P="zoom"in n?+n.zoom:x,V="bearing"in n?this._normalizeBearing(n.bearing,w):w,Y="pitch"in n?+n.pitch:S,J=this._extendPadding(n.padding),Z=r.P.convert(n.offset);let te,de,he;if(g.projection.name==="globe"){const ft=r.ac.fromLngLat(g.center),Rt=Z.rotate(-g.angle);ft.x+=Rt.x/g.worldSize,ft.y+=Rt.y/g.worldSize;const Ot=ft.toLngLat(),ti=r.cd.convert(n.center||Ot);this._normalizeCenter(ti),te=g.centerPoint.add(Rt),de=new r.P(ft.x,ft.y).mult(g.worldSize),he=new r.P(r.aD(ti.lng),r.aH(ti.lat)).mult(g.worldSize).sub(de)}else{te=g.centerPoint.add(Z);const ft=g.pointLocation(te),Rt=r.cd.convert(n.center||ft);this._normalizeCenter(Rt),de=g.project(ft),he=g.project(Rt).sub(de)}const ge=g.zoomScale(P-x);let _e,Te;n.around&&(_e=r.cd.convert(n.around),Te=g.locationPoint(_e));const je=this._zooming||P!==x,We=this._rotating||w!==V,ut=this._pitching||Y!==S,at=!g.isPaddingEqual(J),nt=n.retainPadding===!1?g.clone():g,qe=ft=>Rt=>{if(je&&(ft.zoom=r.ai(x,P,Rt)),We&&(ft.bearing=r.ai(w,V,Rt)),ut&&(ft.pitch=r.ai(S,Y,Rt)),at&&(nt.interpolatePadding(L,J,Rt),te=nt.centerPoint.add(Z)),_e)ft.setLocationAtPoint(_e,Te);else{const Ot=ft.zoomScale(ft.zoom-x),ti=P>x?Math.min(2,ge):Math.max(.5,ge),ri=Math.pow(ti,1-Rt),vi=ft.unproject(de.add(he.mult(Rt*ri)).mult(Ot));ft.setLocationAtPoint(ft.renderWorldCopies?vi.wrap():vi,te)}return n.preloadOnly||this._fireMoveEvents(u),ft};if(n.preloadOnly){const ft=this._emulate(qe,n.duration,g);return this._preloadTiles(ft),this}const ht={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=je,this._rotating=We,this._pitching=ut,this._padding=at,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,ht),this._ease(qe(g),ft=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(u,ft)},n),this}_prepareEase(n,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||g.moving||this.fire(new r.A("movestart",n)),this._zooming&&!g.zooming&&this.fire(new r.A("zoomstart",n)),this._rotating&&!g.rotating&&this.fire(new r.A("rotatestart",n)),this._pitching&&!g.pitching&&this.fire(new r.A("pitchstart",n))}_fireMoveEvents(n){this.fire(new r.A("move",n)),this._zooming&&this.fire(new r.A("zoom",n)),this._rotating&&this.fire(new r.A("rotate",n)),this._pitching&&this.fire(new r.A("pitch",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new r.A("zoomend",n)),x&&this.fire(new r.A("rotateend",n)),w&&this.fire(new r.A("pitchend",n)),this.fire(new r.A("moveend",n))}flyTo(n,u){if(this._prefersReducedMotion(n)){const zt=r.aF(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(zt,u)}this.stop(),n=r.h({offset:[0,0],speed:1.2,curve:1.42,easing:r.ey},n);const g=this.transform,x=this.getZoom(),w=this.getBearing(),S=this.getPitch(),L=this.getPadding(),P="zoom"in n?r.ay(+n.zoom,g.minZoom,g.maxZoom):x,V="bearing"in n?this._normalizeBearing(n.bearing,w):w,Y="pitch"in n?+n.pitch:S,J=this._extendPadding(n.padding),Z=g.zoomScale(P-x),te=r.P.convert(n.offset);let de=g.centerPoint.add(te);const he=g.pointLocation(de),ge=r.cd.convert(n.center||he);this._normalizeCenter(ge);const _e=g.project(he),Te=g.project(ge).sub(_e);let je=n.curve;const We=Math.max(g.width,g.height),ut=We/Z,at=Te.mag();if("minZoom"in n){const zt=r.ay(Math.min(n.minZoom,x,P),g.minZoom,g.maxZoom),gi=We/g.zoomScale(zt-x);je=Math.sqrt(gi/at*2)}const nt=je*je;function qe(zt){const gi=(ut*ut-We*We+(zt?-1:1)*nt*nt*at*at)/(2*(zt?ut:We)*nt*at);return Math.log(Math.sqrt(gi*gi+1)-gi)}function ht(zt){return(Math.exp(zt)-Math.exp(-zt))/2}function ft(zt){return(Math.exp(zt)+Math.exp(-zt))/2}const Rt=qe(0);let Ot=function(zt){return ft(Rt)/ft(Rt+je*zt)},ti=function(zt){return We*((ft(Rt)*(ht(gi=Rt+je*zt)/ft(gi))-ht(Rt))/nt)/at;var gi},ri=(qe(1)-Rt)/je;if(Math.abs(at)<1e-6||!isFinite(ri)){if(Math.abs(We-ut)<1e-6)return this.easeTo(n,u);const zt=ut<We?-1:1;ri=Math.abs(Math.log(ut/We))/je,ti=function(){return 0},Ot=function(gi){return Math.exp(zt*je*gi)}}n.duration="duration"in n?+n.duration:1e3*ri/("screenSpeed"in n?+n.screenSpeed/je:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const vi=w!==V,Pt=Y!==S,Qt=!g.isPaddingEqual(J),Ct=n.retainPadding===!1?g.clone():g,oi=zt=>gi=>{const Li=gi*ri,ai=1/Ot(Li);zt.zoom=gi===1?P:x+zt.scaleZoom(ai),vi&&(zt.bearing=r.ai(w,V,gi)),Pt&&(zt.pitch=r.ai(S,Y,gi)),Qt&&(Ct.interpolatePadding(L,J,gi),de=Ct.centerPoint.add(te));const Mi=gi===1?ge:zt.unproject(_e.add(Te.mult(ti(Li))).mult(ai));return zt.setLocationAtPoint(zt.renderWorldCopies?Mi.wrap():Mi,de),zt._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(u),zt};if(n.preloadOnly){const zt=this._emulate(oi,n.duration,g);return this._preloadTiles(zt),this}return this._zooming=!0,this._rotating=vi,this._pitching=Pt,this._padding=Qt,this._prepareEase(u,!1),this._ease(oi(g),()=>this._afterEase(u),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!n){const g=this.handlers;g&&g.stop(!1)}return this}_ease(n,u,g){g.animate===!1||g.duration===0?(n(1),u()):(this._easeStart=r.q.now(),this._easeOptions=g,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,u){n=r.bX(n,-180,180);const g=Math.abs(n-u);return Math.abs(n-360-u)<g&&(n-=360),Math.abs(n+360-u)<g&&(n+=360),n}_normalizeCenter(n){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const g=n.lng-u.center.lng;n.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,u,g){const x=Math.ceil(15*u/1e3),w=[],S=n(g.clone());for(let L=0;L<=x;L++){const P=S(L/x);w.push(P.clone())}return w}_preloadTiles(n,u){}}class Md{constructor(n={}){this.options=n,r.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const u=this.options&&this.options.compact,g=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const x=M("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",g),this._innerContainer=M("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(n){const g=u.reduce((x,w,S)=>(w.value&&(x+=`${w.key}=${w.value}${S<u.length-1?"&":""}`),x),"?");n.href=`${r.e.FEEDBACK_URL}/${g}#${Gf(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._mergedSourceCaches;for(const x in u){const w=u[x];if(w.used){const S=w.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n.sort((x,w)=>x.length-w.length),n=n.filter((x,w)=>{for(let S=w+1;S<n.length;S++)if(n[S].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const g=n.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class df{constructor(){r.aV(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=M("div","mapboxgl-ctrl");const u=M("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const u in n){const g=n[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const u=n[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class FA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===n)return void(x.cancelled=!0)}run(n=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Mc{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const u=r.dk((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,u,g){this._start=this.getValue(u),this._end=n,this._startTime=u,this._endTime=u+g}}const Jf={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Fo extends r.A{constructor(n,u,g,x){const{point:w,lngLat:S,originalEvent:L,target:P}=n;super(n.type,{point:w,lngLat:S,originalEvent:L,target:P}),this.preventDefault=()=>{n.preventDefault()},this.id=u,this.interaction=g,this.feature=x}}class eh{constructor(n){this.map=n,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(n,u){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const g=u.filter;let x=u.type;g&&this.filters.set(n,r.b3(g)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const w=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(n,u)):w.size===0&&this.map.on(x,this.handleType),w.size===0&&this.interactionsByType.set(x,w),w.set(n,u),this.typeById.set(n,x)}get(n){const u=this.typeById.get(n);if(!u)return;const g=this.interactionsByType.get(u);return g?g.get(n):void 0}remove(n){const u=this.typeById.get(n);if(!u)return;this.typeById.delete(n),this.filters.delete(n);const g=this.interactionsByType.get(u);g&&(g.delete(n),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(n),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):g.size===0&&this.map.off(u,this.handleType))}queryTargets(n,u){const g=[];for(const[x,w]of u)w.target&&g.push({targetId:x,target:w.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(n,g,this.map.transform)}handleMove(n){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(n.point,Array.from(this.delegatedInteractions).reverse());u.length&&(n.type="mouseenter",this.handleType(n,u));const g=new Map;for(const[x,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||g.set(w.id,w);g.size&&(n.type="mouseleave",this.handleType(n,Array.from(g.values())))}handleOut(n){const u=Array.from(this.hoveredFeatures.values()).map(({feature:g})=>g);u.length&&(n.type="mouseleave",this.handleType(n,u)),this.hoveredFeatures.clear()}handleType(n,u){const g=n.type==="mouseenter";if(g&&!this.interactionsByType.has(n.type))return void r.w("mouseenter interaction required for mouseleave to work.");const x=Array.from(this.interactionsByType.get(n.type)).reverse(),w=!!u;u=u||this.queryTargets(n.point,x);let S=!1;const L=new Set;for(const P of u){for(const[V,Y]of x){if(!Y.target)continue;const J=P.variants?P.variants[V]:null;if(J){for(const Z of J){if(Nc(Z,P,L,V))continue;const te=new r.de(P,Z),de=ec(Z,P,V);w&&(te.state=this.map.getFeatureState(te));const he=g?this.prevHoveredFeatures.get(de):null,ge=new Fo(n,V,Y,te),_e=he?he.stop:Y.handler(ge);if(g&&this.hoveredFeatures.set(de,{feature:P,stop:_e}),_e!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[P,V]of x){const{handler:Y,target:J}=V;if(!J&&Y(new Fo(n,P,V,null))!==!1)break}}}function Af(p,n){if(Array.isArray(p)&&Array.isArray(n)){const u=new Set(p),g=new Set(n);return u.size===g.size&&p.every(x=>g.has(x))}return r.bv(p,n)}const ep={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},tp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Sm{constructor(n,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new cf({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,g&&(this.mousePitch=new Ph({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),r.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(n,u){this.mouseRotate.mousedown(n,u),this.mousePitch&&this.mousePitch.mousedown(n,u),ne()}move(n,u){const g=this.map,x=this.mouseRotate.mousemoveWindow(n,u),w=x&&x.bearingDelta;if(w&&g.setBearing(g.getBearing()+w),this.mousePitch){const S=this.mousePitch.mousemoveWindow(n,u),L=S&&S.pitchDelta;L&&g.setPitch(g.getPitch()+L)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){re(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(r.h({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),le(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,le(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=be(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=be(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function LA(p,n,u){if(p=new r.cd(p.lng,p.lat),n){const g=new r.cd(p.lng-360,p.lat),x=new r.cd(p.lng+360,p.lat),w=360*Math.ceil(Math.abs(p.lng-u.center.lng)/360),S=u.locationPoint3D(p).distSqr(n),L=n.x<0||n.y<0||n.x>u.width||n.y>u.height;u.locationPoint3D(g).distSqr(n)<S&&(L||Math.abs(g.lng-u.center.lng)<w)?p=g:u.locationPoint3D(x).distSqr(n)<S&&(L||Math.abs(x.lng-u.center.lng)<w)&&(p=x)}for(;Math.abs(p.lng-u.center.lng)>180;){const g=u.locationPoint3D(p);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;p.lng>u.center.lng?p.lng-=360:p.lng+=360}return p}const Gp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},th={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class ff extends r.E{constructor(n,u){super(),(n instanceof HTMLElement||u)&&(n=r.h({element:n},u)),r.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:g="center",color:x="#3FB1CE",scale:w=1,draggable:S=!1,clickTolerance:L=0,rotation:P=th.rotation,rotationAlignment:V=th.rotationAlignment,pitchAlignment:Y=th.pitchAlignment,occludedOpacity:J=th.occludedOpacity,altitude:Z=th.altitude}=n||{};this._anchor=g,this._color=x,this._scale=w,this._draggable=S,this._clickTolerance=L,this._rotation=P,this._rotationAlignment=V,this._pitchAlignment=Y,this._occludedOpacity=J,this._altitude=Z,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),n&&n.element?(this._element=n.element,this._offset=r.P.convert(n&&n.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=r.P.convert(n&&n.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",he=>{he.preventDefault()}),this._element.addEventListener("mousedown",he=>{he.preventDefault()});const te=this._element.classList;for(const he in Gp)te.remove(`mapboxgl-marker-anchor-${he}`);te.add(`mapboxgl-marker-anchor-${this._anchor}`);const de=n&&n.className?n.className.trim().split(/\s+/):[];te.add(...de),this._popup=null}_createDefaultMarker(){const n=M("div"),u=G("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},n);if(this._altitude===0){const g=G("radialGradient",{id:"shadowGradient"},G("defs",{},u));G("stop",{offset:"10%","stop-opacity":.4},g),G("stop",{offset:"100%","stop-opacity":.05},g),G("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return G("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),G("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),G("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),n}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=r.cd.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(n){return n===this._altitude||(this._defaultMarker&&(this._altitude===0&&n!==0||this._altitude!==0&&n===0)&&(this._element=this._createDefaultMarker()),this._altitude=n||th.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,n._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const u=n.code,g=n.charCode||n.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(n){const u=n.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,u=this._pos;if(!n||!u)return!1;const g=n.unproject(u,this._altitude),x=n.getFreeCameraOptions();if(!x.position)return!1;const w=x.position.toLngLat();return w.distanceTo(g)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const u=this._pos;if(!u||u.x<0||u.x>n.transform.width||u.y<0||u.y>n.transform.height)return void this._clearFadeTimer();const g=n.unproject(u,this._altitude);let x;n._showingGlobe()&&r.eK(n.transform,this._lngLat)?x=0:(x=1-n._queryFogOpacity(g),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Gp[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const n=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!n||g!=="map")return"";if(!u._showingGlobe()){const P=u.getPitch();return P?`rotateX(${P}deg)`:""}const x=r.cJ(r.eL(u.transform,this._lngLat)),w=n.sub(r.eM(u.transform)),S=Math.abs(w.x)+Math.abs(w.y);if(S===0)return"";const L=x/S;return`rotateX(${-w.y*L}deg) rotateY(${w.x*L}deg)`}_calculateZTransform(){const n=this._pos,u=this._map;if(!u||!n)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const w=u.project(new r.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),S=u.project(new r.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(w);g=r.cJ(Math.atan2(S.y,S.x))-90}else g=-u.getBearing();else if(x==="horizon"){const w=r.af(4,6,u.getZoom()),S=r.eM(u.transform);S.y+=w*u.transform.height;const L=n.sub(S),P=r.cJ(Math.atan2(L.y,L.x));g=(P>90?P-270:P+90)*(1-w)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=LA(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=r.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const u=this._map;if(!u)return;const g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){const w=this._clickTolerance||u._clickTolerance;if(n.point.dist(g)<w)return;this._isDragging=!0}this._pos=n.point.sub(x),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.A("dragstart"))),this.fire(new r.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.A("dragend")),this._state="inactive"}_addDragHandler(n){const u=this._map,g=this._pos;u&&g&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(g),this._pointerdownPos=n.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const u=this._map;return u&&(n?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||th.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||th.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||th.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||th.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const pf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Pd={maxWidth:100,unit:"metric"},kd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},kh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Lu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pc(p=new r.P(0,0),n="bottom"){if(typeof p=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(n){case"top":return new r.P(0,p);case"top-left":return new r.P(u,u);case"top-right":return new r.P(-u,u);case"bottom":return new r.P(0,-p);case"bottom-left":return new r.P(u,-u);case"bottom-right":return new r.P(-u,-u);case"left":return new r.P(p,0);case"right":return new r.P(-p,0)}return new r.P(0,0)}return p instanceof r.P||Array.isArray(p)?r.P.convert(p):r.P.convert(p[n]||[0,0])}return{version:y,supported:R.supported,setRTLTextPlugin:r.eQ,getRTLTextPluginStatus:r.eP,Map:class extends Ld{constructor(p){_.mark(b.create);const n=p;if((p=r.h({},ep,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&r.eI(window)&&(p.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ua(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies,null,null),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new FA,this._domRenderTaskQueue=new FA,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.a$(),this._locale=r.h({},Jf,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Mc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new Se(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const u=document.getElementById(p.container);if(!u)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=u}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,r.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new bd),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Zf(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||r.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new jl(this),p.hash&&(this._hash=new Dp(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const u=p.bounds;u&&(this.resize(),this.fitBounds(u,r.h({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new Md({customAttribution:p.customAttribution})),this._logoControl=new df,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new r.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new r.A(`${u.dataType}dataloading`,u))}),this._interactions=new eh(this)}_getMapId(){return this._mapId}addControl(p,n){if(n===void 0&&(n=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new r.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=p.onAdd(this);this._controls.push(p);const g=this._controlPositions[n];return n.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new r.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(p);return n>-1&&this._controls.splice(n,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new r.A("movestart",p)).fire(new r.A("move",p)),this.fire(new r.A("resize",p)),n&&this.fire(new r.A("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(r.aG.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(n=>n.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(n=>n==="auto"?navigator.language:n):p}setLanguage(p){const n=this._parseLanguage(p);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,n=p.projection.name;let u;n==="globe"&&p.zoom>=r.cx?(p.setMercatorFromTransition(),u=!0):n==="mercator"&&p.zoom<r.cx&&(p.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(p,n){return this._updateProjection(p||n||{name:"mercator"})}_updateProjection(p){let n;return n=p.name==="globe"&&this.transform.zoom>=r.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p,n){return this.transform.locationPoint3D(r.cd.convert(p),n)}unproject(p,n){return this.transform.pointLocation3D(r.P.convert(p),n)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,n,u){const g=x=>{let w=[];if(Array.isArray(n)){const S=n.filter(L=>this.getLayer(L));w=S.length?this.queryRenderedFeatures(x,{layers:S}):[]}else w=this.queryRenderedFeatures(x,{target:n});return w};if(p==="mouseenter"||p==="mouseover"){let x=!1;return{listener:u,targets:n,delegates:{mousemove:S=>{const L=g(S.point);L.length?x||(x=!0,u.call(this,new Ya(p,this,S.originalEvent,{features:L}))):x=!1},mouseout:()=>{x=!1}}}}if(p==="mouseleave"||p==="mouseout"){let x=!1;return{listener:u,targets:n,delegates:{mousemove:L=>{g(L.point).length?x=!0:x&&(x=!1,u.call(this,new Ya(p,this,L.originalEvent)))},mouseout:L=>{x&&(x=!1,u.call(this,new Ya(p,this,L.originalEvent)))}}}}{const x=w=>{const S=g(w.point);S.length&&(w.features=S,u.call(this,w),delete w.features)};return{listener:u,targets:n,delegates:{[p]:x}}}}on(p,n,u){if(typeof n=="function"||u===void 0)return super.on(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._createDelegatedListener(p,n,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(p,n,u){if(typeof n=="function"||u===void 0)return super.once(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._createDelegatedListener(p,n,u);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(p,n,u){if(typeof n=="function"||u===void 0)return super.off(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const g=this._delegatedListeners?this._delegatedListeners[p]:void 0;return g&&(x=>{for(let w=0;w<x.length;w++){const S=x[w];if(S.listener===u&&Af(S.targets,n)){for(const L in S.delegates)this.off(L,S.delegates[L]);return x.splice(w,1),this}}})(g),this}queryRenderedFeatures(p,n){if(!this.style)return[];if(p===void 0||p instanceof r.P||Array.isArray(p)||n!==void 0||(n=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!n){const w=this.style.queryRenderedFeatures(p,void 0,this.transform),S=this.style.queryRenderedFeatureset(p,void 0,this.transform);return w.concat(S)}let u=!0;if(n.target&&(u=this._isTargetValid(n.target),u&&!n.layers))return this.style.queryRenderedFeatureset(p,n,this.transform);let g=!0;if(n.layers&&Array.isArray(n.layers)){for(const w of n.layers)if(!this._isValidId(w)){g=!1;break}if(g&&!n.target)return this.style.queryRenderedFeatures(p,n,this.transform)}let x=[];return g&&(x=x.concat(this.style.queryRenderedFeatures(p,n,this.transform))),u&&(x=x.concat(this.style.queryRenderedFeatureset(p,n,this.transform))),x}querySourceFeatures(p,n){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,n)}isPointOnSurface(p){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&r.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(p))}addInteraction(p,n){return this._interactions.add(p,n),this}removeInteraction(p){return this._interactions.remove(p),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this}setStyle(p,n){return n=r.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&p&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(p,(u,g)=>{if(u){const x=typeof u=="string"?u:u instanceof Error?u.message:u.error;r.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(p,n)}else g&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(p,n))}_getUIString(p){const n=this._locale[p];if(n==null)throw new Error(`Missing UI string '${p}'`);return n}_updateStyle(p,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const u=r.h({},n);n&&n.config&&(u.initialConfig=n.config,delete u.config),this.style=new Ho(this,u).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ho(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new r.z(new Error("IDs can't be empty."))),!1):!r.d8(p)||(this.fire(new r.z(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const n of p)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(p)}addSource(p,n){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,n),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,n,u){this._lazyInitEmptyStyle(),this.style.addSourceType(p,n,u)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,n,{pixelRatio:u=1,sdf:g=!1,stretchX:x,stretchY:w,content:S}={}){this._lazyInitEmptyStyle();const L=r.I.from(p);if(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:P,height:V,data:Y}=r.q.getImageData(n);this.style.addImage(L,{data:new r.r({width:P,height:V},Y),pixelRatio:u,stretchX:x,stretchY:w,content:S,sdf:g,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new r.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:V}=n,Y=n;this.style.addImage(L,{data:new r.r({width:P,height:V},new Uint8Array(Y.data)),pixelRatio:u,stretchX:x,stretchY:w,content:S,sdf:g,usvg:!1,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,p)}}updateImage(p,n){this._lazyInitEmptyStyle();const u=r.I.from(p),g=this.style.getImage(u);if(!g)return void this.fire(new r.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?r.q.getImageData(n):n,{width:w,height:S,data:L}=x;if(w===void 0||S===void 0)return void this.fire(new r.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(g.usvg?g.icon.usvg_tree.width:g.data.width)||S!==(g.usvg?g.icon.usvg_tree.height:g.data.height))return void this.fire(new r.z(new Error(`The width and height of the updated image (${w}, ${S})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`)));const P=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let V=!1;g.usvg?(g.data=new r.r({width:w,height:S},new Uint8Array(L)),g.usvg=!1,g.icon=void 0,V=!0):g.data.replace(L,P),this.style.updateImage(u,g,V)}hasImage(p){return p?!!this.style&&!!this.style.getImage(r.I.from(p)):(this.fire(new r.z(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(r.I.from(p))}loadImage(p,n){r.o(this._requestManager.transformRequest(p,r.R.Image),(u,g)=>{n(u,g instanceof HTMLImageElement?r.q.getImageData(g):g)})}listImages(){return this.style.listImages().map(p=>p.name)}addModel(p,n){this._lazyInitEmptyStyle(),this.style.addModel(p,n)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new r.z(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,n){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,n),this._update(!0)):this}getSlot(p){const n=this.getLayer(p);return n&&n.slot||null}setSlot(p,n){return this.style.setSlot(p,n),this.style.mergeLayers(),this._update(!0)}addImport(p,n){return this.style.addImport(p,n).catch(u=>this.fire(new r.z(new Error("Failed to add import",u)))),this}updateImport(p,n){return typeof n!="string"&&n.id!==p?(this.removeImport(p),this.addImport(n)):(this.style.updateImport(p,n),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,n){return this.style.moveImport(p,n),this._update(!0)}moveLayer(p,n){return this._isValidId(p)?(this.style.moveLayer(p,n),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const n=this.style.getOwnLayer(p);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,n,u){return this._isValidId(p)?(this.style.setLayerZoomRange(p,n,u),this._update(!0)):this}setFilter(p,n,u={}){return this._isValidId(p)?(this.style.setFilter(p,n,u),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,n,u,g={}){return this._isValidId(p)?(this.style.setPaintProperty(p,n,u,g),this._update(!0)):this}getPaintProperty(p,n){return this._isValidId(p)?this.style.getPaintProperty(p,n):null}setLayoutProperty(p,n,u,g={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,n,u,g),this._update(!0)):this}getLayoutProperty(p,n){return this._isValidId(p)?this.style.getLayoutProperty(p,n):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(p){return this.style.setGlyphsUrl(p),this._update(!0)}getSchema(p){return this.style.getSchema(p)}setSchema(p,n){return this.style.setSchema(p,n),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,n){return this.style.setConfig(p,n),this._update(!0)}getConfigProperty(p,n){return this.style.getConfigProperty(p,n)}setConfigProperty(p,n,u){return this.style.setConfigProperty(p,n,u),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const n=p[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,n),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.cd.convert(p),this.transform):0}setFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,n),this._update())}removeFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,n),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let u,g,x,w=this._container;for(;w&&(!g||!x);){const S=window.getComputedStyle(w).transform;S&&S!=="none"&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),w=w.parentElement}this._containerWidth=g?Math.abs(p/g):p,this._containerHeight=x?Math.abs(n/x):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=M("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=M("div","mapboxgl-canvas-container",p);this._canvas=M("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=M("div","mapboxgl-control-container",p),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{g[x]=M("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,n){const u=r.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(p),this._canvas.height=u*Math.ceil(n),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${n}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const n=this._markers.indexOf(p);n!==-1&&this._markers.splice(n,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const n=this._popups.indexOf(p);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const p=r.h({},R.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",p);n?(ze(n,!0),this.painter=new wA(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.l.testSupport(n)):this.fire(new r.z(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.A("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new r.A("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let n;this.fire(new r.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,g=r.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=x.createQuery(),x.beginQuery(u.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,Y=this.transform.pitch,J=r.q.now(),Z=new r.aa(V,{now:J,fadeDuration:w,pitch:Y,transition:this.style.transition,worldview:this._worldview});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(g);const L=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),L&&(this._placementDirty=L.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,_.mark(b.load),this.fire(new r.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const V=r.q.now()-g;x.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=x.getQueryParameter(n,x.QUERY_RESULT)/1e6;x.deleteQuery(n),this.fire(new r.A("gpu-timing-frame",{cpuTime:V,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const V=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(V);this.fire(new r.A("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const V=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(V);this.fire(new r.A("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(P||this._repaint)this.triggerRepaint();else{const V=this.idle();if(V&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),V&&(this.fire(new r.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new r.A("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,_.mark(b.fullLoad),this._performanceMetricsCollection&&St(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const n of this._markers)p&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!p||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(p,n=!1){const u=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(n||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const x=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=p;const S=Math.abs(x-w);if(S>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(w),u(w);this._averageElevation.easeTo(w,p,300)}else if(S>1e-4)return this._averageElevation.jumpTo(w),u(w)}return!!this._averageElevation.isEasing(p)&&u(this._averageElevation.getValue(p))}_authenticate(){Gt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===Le||p.status===401)){const n=this.painter.context.gl;ze(n,!1),this._logoControl instanceof df&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),lt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Bt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function x(w){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,w,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(x(p),n.canvasCopies.map(x),n.timeStamps)}_canvasPixelComparison(p,n,u){let g=u[1]-u[0];const x=p.length/4;for(let w=0;w<n.length;w++){const S=n[w];let L=0;for(let P=0;P<S.length;P+=4)S[P]===p[P]&&S[P+1]===p[P+1]&&S[P+2]===p[P+2]&&S[P+3]===p[P+3]&&(L+=1);g+=(u[w+2]-u[w+1])*(1-L/x)}return g}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),mi.delete(this.painter.context.gl),vt.remove(),Je.remove(),this._removed=!0,this.fire(new r.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=r.q.frame(n=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(n)}))}_preloadTiles(p){const n=this.style?this.style.getSourceCaches():[];return r.bt(n,(u,g)=>u._preloadTiles(p,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,n){r.eJ(p,n)}get version(){return y}},NavigationControl:class{constructor(p={}){this.options=r.h({},tp,p),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(r.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),M("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),M("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:n}):u.resetNorth({},{originalEvent:n}))}),this._compassIcon=M("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const n=p.getZoom(),u=n===p.getMaxZoom(),g=n===p.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Sm(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,n){const u=M("button",p,this._container);return u.type="button",u.addEventListener("click",n),u}_setButtonTitle(p,n){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${n}`);p.setAttribute("aria-label",u),p.firstElementChild&&p.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends r.E{constructor(p={}){super();const n=navigator.geolocation;this.options=r.h({geolocation:n},pf,p),r.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=qh(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const n=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,p(u)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>n(u.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(p){const n=this._map.getMaxBounds(),u=p.coords;return!!n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new r.A("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("geolocate",p)),this._finish()}}_updateCamera(p){const n=new r.cd(p.coords.longitude,p.coords.latitude),u=p.coords.accuracy,g=this._map.getBearing(),x=r.h({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(u),x,{geolocateSource:!0})}_updateMarker(p){if(p){const n=new r.cd(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,n=r.c6(1,p._center.lat)*p.worldSize,u=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=M("button","mapboxgl-ctrl-geolocate",this._container),M("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M("div","mapboxgl-user-location"),this._dotElement.appendChild(M("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(M("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ff({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=M("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ff({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.A("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Md,ScaleControl:class{constructor(p={}){this.options=r.h({},Pd,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,n=this._map,u=n._containerHeight/2,g=n._containerWidth/2-p/2,x=n.unproject([g,u]),w=n.unproject([g+p,u]),S=x.distanceTo(w);if(this.options.unit==="imperial"){const L=3.2808*S;L>5280?this._setScale(p,L/5280,"mile"):this._setScale(p,L,"foot")}else this.options.unit==="nautical"?this._setScale(p,S/1852,"nautical-mile"):S>=1e3?this._setScale(p,S/1e3,"kilometer"):this._setScale(p,S,"meter")}_setScale(p,n,u){this._map._requestDomTask(()=>{const g=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let L=w/S;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(P){const V=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*V)/V}(L),S*L}(n),x=g/n;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${kd[u]}`,this._container.style.width=p*x+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:r.w("Full screen control 'container' must be a DOM element.")),r.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=M("button","mapboxgl-ctrl-fullscreen",this._controlContainer);M("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(p){super(),this.options=r.h(Object.create(kh),p),this._altitude=this.options.altitude,r.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new r.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new r.A("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=r.cd.convert(p),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(p){return this._altitude=p,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const n=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=p;g=u.firstChild,g;)n.appendChild(g);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=M("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(p),this.options.closeButton){const u=this._closeButton=M("button","mapboxgl-popup-close-button",n);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let n;return this._classList.delete(p)?n=!1:(this._classList.add(p),n=!0),this._updateClassList(),n}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const n=this._map,u=this._container,g=this._pos;if(!n||!u||!g)return"bottom";const x=u.offsetWidth,w=u.offsetHeight,S=g.x<x/2,L=g.x>n.transform.width-x/2;if(g.y+p<w)return S?"top-left":L?"top-right":"top";if(g.y>n.transform.height-w){if(S)return"bottom-left";if(L)return"bottom-right"}return S?"left":L?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),p.className=n.join(" ")}_update(p){const n=this._map,u=this._content;if(!n||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=M("div","mapboxgl-popup",n.getContainer()),this._tip=M("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=LA(this._lngLat,this._pos,n.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p instanceof r.P?p:n.project(this._lngLat,this._altitude),w=Pc(this.options.offset),S=this._anchor=this._getAnchor(w.y),L=Pc(this.options.offset,S),P=x.add(L).round();n._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Gp[S]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&n._showingGlobe()){const x=r.eK(n.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Lu);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:ff,Style:Ho,LngLat:r.cd,LngLatBounds:r.aG,Point:r.P,MercatorCoordinate:r.ac,FreeCameraOptions:Yo,Evented:r.E,config:r.e,prewarm:r.eO,clearPrewarmedResources:r.eN,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(p){r.e.ACCESS_TOKEN=p},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(p){r.e.API_URL=p},get workerCount(){return r.eX.workerCount},set workerCount(p){r.eX.workerCount=p},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){r.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){r.eW(p)},get workerUrl(){return r.eV.workerUrl},set workerUrl(p){r.eV.workerUrl=p},get workerClass(){return r.eV.workerClass},set workerClass(p){r.eV.workerClass=p},get workerParams(){return r.eV.workerParams},set workerParams(p){r.eV.workerParams=p},get dracoUrl(){return r.eU()},set dracoUrl(p){r.eT(p)},get meshoptUrl(){return r.eS()},set meshoptUrl(p){r.eR(p)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var A=c;return A})}(L0)),L0.exports}var $N=qN();const py=Z1($N),ZN={__name:"MapView",props:{meters:{type:Array,required:!0},role:{type:String,default:"visualizer"}},setup(a){const e=a,t=sr(null);let s=null;return Ff(()=>{py.accessToken="pk.eyJ1IjoibXV4b2RldXMiLCJhIjoiY2lsanBmZGxhNTN5a3ZybTByYjA1YWhqZSJ9.kspPh-wlVRf49UlMVbrDtA",s=new py.Map({container:t.value,style:"mapbox://styles/mapbox/streets-v11",center:[-89.19,13.71],zoom:7}),s.addControl(new py.NavigationControl),s.on("load",()=>{e.meters.forEach(c=>{const h=new py.Popup({offset:25}).setHTML(`
        <strong>${c.name}</strong><br/>
        Estado: ${c.status}<br/>
        ${e.role==="admin"?"<button>Editar</button>":""}
      `);new py.Marker({color:c.status==="activo"?"#3bb2d0":"#d9534f"}).setLngLat([c.lng,c.lat]).setPopup(h).addTo(s)})})}),Ny(()=>{s&&s.remove()}),(c,h)=>(yn(),Nn("div",{class:"map-container",ref_key:"mapContainer",ref:t},null,512))}},JN=ol(ZN,[["__scopeId","data-v-0713e75a"]]);function eF(a,e){return function(){return a.apply(e,arguments)}}const{toString:e6}=Object.prototype,{getPrototypeOf:gw}=Object,{iterator:y_,toStringTag:tF}=Symbol,v_=(a=>e=>{const t=e6.call(e);return a[t]||(a[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),tA=a=>(a=a.toLowerCase(),e=>v_(e)===a),__=a=>e=>typeof e===a,{isArray:Bm}=Array,ev=__("undefined");function t6(a){return a!==null&&!ev(a)&&a.constructor!==null&&!ev(a.constructor)&&oh(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const iF=tA("ArrayBuffer");function i6(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&iF(a.buffer),e}const r6=__("string"),oh=__("function"),rF=__("number"),x_=a=>a!==null&&typeof a=="object",n6=a=>a===!0||a===!1,M0=a=>{if(v_(a)!=="object")return!1;const e=gw(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(tF in a)&&!(y_ in a)},s6=tA("Date"),o6=tA("File"),a6=tA("Blob"),l6=tA("FileList"),c6=a=>x_(a)&&oh(a.pipe),u6=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||oh(a.append)&&((e=v_(a))==="formdata"||e==="object"&&oh(a.toString)&&a.toString()==="[object FormData]"))},h6=tA("URLSearchParams"),[d6,A6,f6,p6]=["ReadableStream","Request","Response","Headers"].map(tA),g6=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function dv(a,e,{allOwnKeys:t=!1}={}){if(a===null||typeof a>"u")return;let s,c;if(typeof a!="object"&&(a=[a]),Bm(a))for(s=0,c=a.length;s<c;s++)e.call(null,a[s],s,a);else{const h=t?Object.getOwnPropertyNames(a):Object.keys(a),A=h.length;let r;for(s=0;s<A;s++)r=h[s],e.call(null,a[r],r,a)}}function nF(a,e){e=e.toLowerCase();const t=Object.keys(a);let s=t.length,c;for(;s-- >0;)if(c=t[s],e===c.toLowerCase())return c;return null}const Ag=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,sF=a=>!ev(a)&&a!==Ag;function w1(){const{caseless:a}=sF(this)&&this||{},e={},t=(s,c)=>{const h=a&&nF(e,c)||c;M0(e[h])&&M0(s)?e[h]=w1(e[h],s):M0(s)?e[h]=w1({},s):Bm(s)?e[h]=s.slice():e[h]=s};for(let s=0,c=arguments.length;s<c;s++)arguments[s]&&dv(arguments[s],t);return e}const m6=(a,e,t,{allOwnKeys:s}={})=>(dv(e,(c,h)=>{t&&oh(c)?a[h]=eF(c,t):a[h]=c},{allOwnKeys:s}),a),y6=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),v6=(a,e,t,s)=>{a.prototype=Object.create(e.prototype,s),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),t&&Object.assign(a.prototype,t)},_6=(a,e,t,s)=>{let c,h,A;const r={};if(e=e||{},a==null)return e;do{for(c=Object.getOwnPropertyNames(a),h=c.length;h-- >0;)A=c[h],(!s||s(A,a,e))&&!r[A]&&(e[A]=a[A],r[A]=!0);a=t!==!1&&gw(a)}while(a&&(!t||t(a,e))&&a!==Object.prototype);return e},x6=(a,e,t)=>{a=String(a),(t===void 0||t>a.length)&&(t=a.length),t-=e.length;const s=a.indexOf(e,t);return s!==-1&&s===t},b6=a=>{if(!a)return null;if(Bm(a))return a;let e=a.length;if(!rF(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=a[e];return t},w6=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&gw(Uint8Array)),B6=(a,e)=>{const s=(a&&a[y_]).call(a);let c;for(;(c=s.next())&&!c.done;){const h=c.value;e.call(a,h[0],h[1])}},C6=(a,e)=>{let t;const s=[];for(;(t=a.exec(e))!==null;)s.push(t);return s},S6=tA("HTMLFormElement"),E6=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,c){return s.toUpperCase()+c}),qE=(({hasOwnProperty:a})=>(e,t)=>a.call(e,t))(Object.prototype),I6=tA("RegExp"),oF=(a,e)=>{const t=Object.getOwnPropertyDescriptors(a),s={};dv(t,(c,h)=>{let A;(A=e(c,h,a))!==!1&&(s[h]=A||c)}),Object.defineProperties(a,s)},T6=a=>{oF(a,(e,t)=>{if(oh(a)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=a[t];if(oh(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},F6=(a,e)=>{const t={},s=c=>{c.forEach(h=>{t[h]=!0})};return Bm(a)?s(a):s(String(a).split(e)),t},L6=()=>{},M6=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function P6(a){return!!(a&&oh(a.append)&&a[tF]==="FormData"&&a[y_])}const k6=a=>{const e=new Array(10),t=(s,c)=>{if(x_(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[c]=s;const h=Bm(s)?[]:{};return dv(s,(A,r)=>{const y=t(A,c+1);!ev(y)&&(h[r]=y)}),e[c]=void 0,h}}return s};return t(a,0)},R6=tA("AsyncFunction"),D6=a=>a&&(x_(a)||oh(a))&&oh(a.then)&&oh(a.catch),aF=((a,e)=>a?setImmediate:e?((t,s)=>(Ag.addEventListener("message",({source:c,data:h})=>{c===Ag&&h===t&&s.length&&s.shift()()},!1),c=>{s.push(c),Ag.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",oh(Ag.postMessage)),O6=typeof queueMicrotask<"u"?queueMicrotask.bind(Ag):typeof process<"u"&&process.nextTick||aF,U6=a=>a!=null&&oh(a[y_]),Qi={isArray:Bm,isArrayBuffer:iF,isBuffer:t6,isFormData:u6,isArrayBufferView:i6,isString:r6,isNumber:rF,isBoolean:n6,isObject:x_,isPlainObject:M0,isReadableStream:d6,isRequest:A6,isResponse:f6,isHeaders:p6,isUndefined:ev,isDate:s6,isFile:o6,isBlob:a6,isRegExp:I6,isFunction:oh,isStream:c6,isURLSearchParams:h6,isTypedArray:w6,isFileList:l6,forEach:dv,merge:w1,extend:m6,trim:g6,stripBOM:y6,inherits:v6,toFlatObject:_6,kindOf:v_,kindOfTest:tA,endsWith:x6,toArray:b6,forEachEntry:B6,matchAll:C6,isHTMLForm:S6,hasOwnProperty:qE,hasOwnProp:qE,reduceDescriptors:oF,freezeMethods:T6,toObjectSet:F6,toCamelCase:E6,noop:L6,toFiniteNumber:M6,findKey:nF,global:Ag,isContextDefined:sF,isSpecCompliantForm:P6,toJSONObject:k6,isAsyncFn:R6,isThenable:D6,setImmediate:aF,asap:O6,isIterable:U6};function Fs(a,e,t,s,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),c&&(this.response=c,this.status=c.status?c.status:null)}Qi.inherits(Fs,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qi.toJSONObject(this.config),code:this.code,status:this.status}}});const lF=Fs.prototype,cF={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{cF[a]={value:a}});Object.defineProperties(Fs,cF);Object.defineProperty(lF,"isAxiosError",{value:!0});Fs.from=(a,e,t,s,c,h)=>{const A=Object.create(lF);return Qi.toFlatObject(a,A,function(y){return y!==Error.prototype},r=>r!=="isAxiosError"),Fs.call(A,a.message,e,t,s,c),A.cause=a,A.name=a.name,h&&Object.assign(A,h),A};const z6=null;function B1(a){return Qi.isPlainObject(a)||Qi.isArray(a)}function uF(a){return Qi.endsWith(a,"[]")?a.slice(0,-2):a}function $E(a,e,t){return a?a.concat(e).map(function(c,h){return c=uF(c),!t&&h?"["+c+"]":c}).join(t?".":""):e}function N6(a){return Qi.isArray(a)&&!a.some(B1)}const j6=Qi.toFlatObject(Qi,{},null,function(e){return/^is[A-Z]/.test(e)});function b_(a,e,t){if(!Qi.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,t=Qi.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,G){return!Qi.isUndefined(G[M])});const s=t.metaTokens,c=t.visitor||_,h=t.dots,A=t.indexes,y=(t.Blob||typeof Blob<"u"&&Blob)&&Qi.isSpecCompliantForm(e);if(!Qi.isFunction(c))throw new TypeError("visitor must be a function");function b(R){if(R===null)return"";if(Qi.isDate(R))return R.toISOString();if(Qi.isBoolean(R))return R.toString();if(!y&&Qi.isBlob(R))throw new Fs("Blob is not supported. Use a Buffer instead.");return Qi.isArrayBuffer(R)||Qi.isTypedArray(R)?y&&typeof Blob=="function"?new Blob([R]):Buffer.from(R):R}function _(R,M,G){let U=R;if(R&&!G&&typeof R=="object"){if(Qi.endsWith(M,"{}"))M=s?M:M.slice(0,-2),R=JSON.stringify(R);else if(Qi.isArray(R)&&N6(R)||(Qi.isFileList(R)||Qi.endsWith(M,"[]"))&&(U=Qi.toArray(R)))return M=uF(M),U.forEach(function(q,ne){!(Qi.isUndefined(q)||q===null)&&e.append(A===!0?$E([M],ne,h):A===null?M:M+"[]",b(q))}),!1}return B1(R)?!0:(e.append($E(G,M,h),b(R)),!1)}const B=[],I=Object.assign(j6,{defaultVisitor:_,convertValue:b,isVisitable:B1});function E(R,M){if(!Qi.isUndefined(R)){if(B.indexOf(R)!==-1)throw Error("Circular reference detected in "+M.join("."));B.push(R),Qi.forEach(R,function(U,Q){(!(Qi.isUndefined(U)||U===null)&&c.call(e,U,Qi.isString(Q)?Q.trim():Q,M,I))===!0&&E(U,M?M.concat(Q):[Q])}),B.pop()}}if(!Qi.isObject(a))throw new TypeError("data must be an object");return E(a),e}function ZE(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function mw(a,e){this._pairs=[],a&&b_(a,this,e)}const hF=mw.prototype;hF.append=function(e,t){this._pairs.push([e,t])};hF.toString=function(e){const t=e?function(s){return e.call(this,s,ZE)}:ZE;return this._pairs.map(function(c){return t(c[0])+"="+t(c[1])},"").join("&")};function H6(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function dF(a,e,t){if(!e)return a;const s=t&&t.encode||H6;Qi.isFunction(t)&&(t={serialize:t});const c=t&&t.serialize;let h;if(c?h=c(e,t):h=Qi.isURLSearchParams(e)?e.toString():new mw(e,t).toString(s),h){const A=a.indexOf("#");A!==-1&&(a=a.slice(0,A)),a+=(a.indexOf("?")===-1?"?":"&")+h}return a}class JE{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Qi.forEach(this.handlers,function(s){s!==null&&e(s)})}}const AF={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Q6=typeof URLSearchParams<"u"?URLSearchParams:mw,V6=typeof FormData<"u"?FormData:null,G6=typeof Blob<"u"?Blob:null,W6={isBrowser:!0,classes:{URLSearchParams:Q6,FormData:V6,Blob:G6},protocols:["http","https","file","blob","url","data"]},yw=typeof window<"u"&&typeof document<"u",C1=typeof navigator=="object"&&navigator||void 0,X6=yw&&(!C1||["ReactNative","NativeScript","NS"].indexOf(C1.product)<0),Y6=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",K6=yw&&window.location.href||"http://localhost",q6=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yw,hasStandardBrowserEnv:X6,hasStandardBrowserWebWorkerEnv:Y6,navigator:C1,origin:K6},Symbol.toStringTag,{value:"Module"})),cu={...q6,...W6};function $6(a,e){return b_(a,new cu.classes.URLSearchParams,Object.assign({visitor:function(t,s,c,h){return cu.isNode&&Qi.isBuffer(t)?(this.append(s,t.toString("base64")),!1):h.defaultVisitor.apply(this,arguments)}},e))}function Z6(a){return Qi.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function J6(a){const e={},t=Object.keys(a);let s;const c=t.length;let h;for(s=0;s<c;s++)h=t[s],e[h]=a[h];return e}function fF(a){function e(t,s,c,h){let A=t[h++];if(A==="__proto__")return!0;const r=Number.isFinite(+A),y=h>=t.length;return A=!A&&Qi.isArray(c)?c.length:A,y?(Qi.hasOwnProp(c,A)?c[A]=[c[A],s]:c[A]=s,!r):((!c[A]||!Qi.isObject(c[A]))&&(c[A]=[]),e(t,s,c[A],h)&&Qi.isArray(c[A])&&(c[A]=J6(c[A])),!r)}if(Qi.isFormData(a)&&Qi.isFunction(a.entries)){const t={};return Qi.forEachEntry(a,(s,c)=>{e(Z6(s),c,t,0)}),t}return null}function ej(a,e,t){if(Qi.isString(a))try{return(e||JSON.parse)(a),Qi.trim(a)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(a)}const Av={transitional:AF,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",c=s.indexOf("application/json")>-1,h=Qi.isObject(e);if(h&&Qi.isHTMLForm(e)&&(e=new FormData(e)),Qi.isFormData(e))return c?JSON.stringify(fF(e)):e;if(Qi.isArrayBuffer(e)||Qi.isBuffer(e)||Qi.isStream(e)||Qi.isFile(e)||Qi.isBlob(e)||Qi.isReadableStream(e))return e;if(Qi.isArrayBufferView(e))return e.buffer;if(Qi.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(h){if(s.indexOf("application/x-www-form-urlencoded")>-1)return $6(e,this.formSerializer).toString();if((r=Qi.isFileList(e))||s.indexOf("multipart/form-data")>-1){const y=this.env&&this.env.FormData;return b_(r?{"files[]":e}:e,y&&new y,this.formSerializer)}}return h||c?(t.setContentType("application/json",!1),ej(e)):e}],transformResponse:[function(e){const t=this.transitional||Av.transitional,s=t&&t.forcedJSONParsing,c=this.responseType==="json";if(Qi.isResponse(e)||Qi.isReadableStream(e))return e;if(e&&Qi.isString(e)&&(s&&!this.responseType||c)){const A=!(t&&t.silentJSONParsing)&&c;try{return JSON.parse(e)}catch(r){if(A)throw r.name==="SyntaxError"?Fs.from(r,Fs.ERR_BAD_RESPONSE,this,null,this.response):r}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cu.classes.FormData,Blob:cu.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qi.forEach(["delete","get","head","post","put","patch"],a=>{Av.headers[a]={}});const tj=Qi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ij=a=>{const e={};let t,s,c;return a&&a.split(`
`).forEach(function(A){c=A.indexOf(":"),t=A.substring(0,c).trim().toLowerCase(),s=A.substring(c+1).trim(),!(!t||e[t]&&tj[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},e5=Symbol("internals");function gy(a){return a&&String(a).trim().toLowerCase()}function P0(a){return a===!1||a==null?a:Qi.isArray(a)?a.map(P0):String(a)}function rj(a){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(a);)e[s[1]]=s[2];return e}const nj=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Tb(a,e,t,s,c){if(Qi.isFunction(s))return s.call(this,e,t);if(c&&(e=t),!!Qi.isString(e)){if(Qi.isString(s))return e.indexOf(s)!==-1;if(Qi.isRegExp(s))return s.test(e)}}function sj(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function oj(a,e){const t=Qi.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(a,s+t,{value:function(c,h,A){return this[s].call(this,e,c,h,A)},configurable:!0})})}let ah=class{constructor(e){e&&this.set(e)}set(e,t,s){const c=this;function h(r,y,b){const _=gy(y);if(!_)throw new Error("header name must be a non-empty string");const B=Qi.findKey(c,_);(!B||c[B]===void 0||b===!0||b===void 0&&c[B]!==!1)&&(c[B||y]=P0(r))}const A=(r,y)=>Qi.forEach(r,(b,_)=>h(b,_,y));if(Qi.isPlainObject(e)||e instanceof this.constructor)A(e,t);else if(Qi.isString(e)&&(e=e.trim())&&!nj(e))A(ij(e),t);else if(Qi.isObject(e)&&Qi.isIterable(e)){let r={},y,b;for(const _ of e){if(!Qi.isArray(_))throw TypeError("Object iterator must return a key-value pair");r[b=_[0]]=(y=r[b])?Qi.isArray(y)?[...y,_[1]]:[y,_[1]]:_[1]}A(r,t)}else e!=null&&h(t,e,s);return this}get(e,t){if(e=gy(e),e){const s=Qi.findKey(this,e);if(s){const c=this[s];if(!t)return c;if(t===!0)return rj(c);if(Qi.isFunction(t))return t.call(this,c,s);if(Qi.isRegExp(t))return t.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=gy(e),e){const s=Qi.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||Tb(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let c=!1;function h(A){if(A=gy(A),A){const r=Qi.findKey(s,A);r&&(!t||Tb(s,s[r],r,t))&&(delete s[r],c=!0)}}return Qi.isArray(e)?e.forEach(h):h(e),c}clear(e){const t=Object.keys(this);let s=t.length,c=!1;for(;s--;){const h=t[s];(!e||Tb(this,this[h],h,e,!0))&&(delete this[h],c=!0)}return c}normalize(e){const t=this,s={};return Qi.forEach(this,(c,h)=>{const A=Qi.findKey(s,h);if(A){t[A]=P0(c),delete t[h];return}const r=e?sj(h):String(h).trim();r!==h&&delete t[h],t[r]=P0(c),s[r]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Qi.forEach(this,(s,c)=>{s!=null&&s!==!1&&(t[c]=e&&Qi.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(c=>s.set(c)),s}static accessor(e){const s=(this[e5]=this[e5]={accessors:{}}).accessors,c=this.prototype;function h(A){const r=gy(A);s[r]||(oj(c,A),s[r]=!0)}return Qi.isArray(e)?e.forEach(h):h(e),this}};ah.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Qi.reduceDescriptors(ah.prototype,({value:a},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(s){this[t]=s}}});Qi.freezeMethods(ah);function Fb(a,e){const t=this||Av,s=e||t,c=ah.from(s.headers);let h=s.data;return Qi.forEach(a,function(r){h=r.call(t,h,c.normalize(),e?e.status:void 0)}),c.normalize(),h}function pF(a){return!!(a&&a.__CANCEL__)}function Cm(a,e,t){Fs.call(this,a??"canceled",Fs.ERR_CANCELED,e,t),this.name="CanceledError"}Qi.inherits(Cm,Fs,{__CANCEL__:!0});function gF(a,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?a(t):e(new Fs("Request failed with status code "+t.status,[Fs.ERR_BAD_REQUEST,Fs.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function aj(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function lj(a,e){a=a||10;const t=new Array(a),s=new Array(a);let c=0,h=0,A;return e=e!==void 0?e:1e3,function(y){const b=Date.now(),_=s[h];A||(A=b),t[c]=y,s[c]=b;let B=h,I=0;for(;B!==c;)I+=t[B++],B=B%a;if(c=(c+1)%a,c===h&&(h=(h+1)%a),b-A<e)return;const E=_&&b-_;return E?Math.round(I*1e3/E):void 0}}function cj(a,e){let t=0,s=1e3/e,c,h;const A=(b,_=Date.now())=>{t=_,c=null,h&&(clearTimeout(h),h=null),a.apply(null,b)};return[(...b)=>{const _=Date.now(),B=_-t;B>=s?A(b,_):(c=b,h||(h=setTimeout(()=>{h=null,A(c)},s-B)))},()=>c&&A(c)]}const $0=(a,e,t=3)=>{let s=0;const c=lj(50,250);return cj(h=>{const A=h.loaded,r=h.lengthComputable?h.total:void 0,y=A-s,b=c(y),_=A<=r;s=A;const B={loaded:A,total:r,progress:r?A/r:void 0,bytes:y,rate:b||void 0,estimated:b&&r&&_?(r-A)/b:void 0,event:h,lengthComputable:r!=null,[e?"download":"upload"]:!0};a(B)},t)},t5=(a,e)=>{const t=a!=null;return[s=>e[0]({lengthComputable:t,total:a,loaded:s}),e[1]]},i5=a=>(...e)=>Qi.asap(()=>a(...e)),uj=cu.hasStandardBrowserEnv?((a,e)=>t=>(t=new URL(t,cu.origin),a.protocol===t.protocol&&a.host===t.host&&(e||a.port===t.port)))(new URL(cu.origin),cu.navigator&&/(msie|trident)/i.test(cu.navigator.userAgent)):()=>!0,hj=cu.hasStandardBrowserEnv?{write(a,e,t,s,c,h){const A=[a+"="+encodeURIComponent(e)];Qi.isNumber(t)&&A.push("expires="+new Date(t).toGMTString()),Qi.isString(s)&&A.push("path="+s),Qi.isString(c)&&A.push("domain="+c),h===!0&&A.push("secure"),document.cookie=A.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function dj(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function Aj(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function mF(a,e,t){let s=!dj(e);return a&&(s||t==!1)?Aj(a,e):e}const r5=a=>a instanceof ah?{...a}:a;function Cg(a,e){e=e||{};const t={};function s(b,_,B,I){return Qi.isPlainObject(b)&&Qi.isPlainObject(_)?Qi.merge.call({caseless:I},b,_):Qi.isPlainObject(_)?Qi.merge({},_):Qi.isArray(_)?_.slice():_}function c(b,_,B,I){if(Qi.isUndefined(_)){if(!Qi.isUndefined(b))return s(void 0,b,B,I)}else return s(b,_,B,I)}function h(b,_){if(!Qi.isUndefined(_))return s(void 0,_)}function A(b,_){if(Qi.isUndefined(_)){if(!Qi.isUndefined(b))return s(void 0,b)}else return s(void 0,_)}function r(b,_,B){if(B in e)return s(b,_);if(B in a)return s(void 0,b)}const y={url:h,method:h,data:h,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:r,headers:(b,_,B)=>c(r5(b),r5(_),B,!0)};return Qi.forEach(Object.keys(Object.assign({},a,e)),function(_){const B=y[_]||c,I=B(a[_],e[_],_);Qi.isUndefined(I)&&B!==r||(t[_]=I)}),t}const yF=a=>{const e=Cg({},a);let{data:t,withXSRFToken:s,xsrfHeaderName:c,xsrfCookieName:h,headers:A,auth:r}=e;e.headers=A=ah.from(A),e.url=dF(mF(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),r&&A.set("Authorization","Basic "+btoa((r.username||"")+":"+(r.password?unescape(encodeURIComponent(r.password)):"")));let y;if(Qi.isFormData(t)){if(cu.hasStandardBrowserEnv||cu.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((y=A.getContentType())!==!1){const[b,..._]=y?y.split(";").map(B=>B.trim()).filter(Boolean):[];A.setContentType([b||"multipart/form-data",..._].join("; "))}}if(cu.hasStandardBrowserEnv&&(s&&Qi.isFunction(s)&&(s=s(e)),s||s!==!1&&uj(e.url))){const b=c&&h&&hj.read(h);b&&A.set(c,b)}return e},fj=typeof XMLHttpRequest<"u",pj=fj&&function(a){return new Promise(function(t,s){const c=yF(a);let h=c.data;const A=ah.from(c.headers).normalize();let{responseType:r,onUploadProgress:y,onDownloadProgress:b}=c,_,B,I,E,R;function M(){E&&E(),R&&R(),c.cancelToken&&c.cancelToken.unsubscribe(_),c.signal&&c.signal.removeEventListener("abort",_)}let G=new XMLHttpRequest;G.open(c.method.toUpperCase(),c.url,!0),G.timeout=c.timeout;function U(){if(!G)return;const q=ah.from("getAllResponseHeaders"in G&&G.getAllResponseHeaders()),re={data:!r||r==="text"||r==="json"?G.responseText:G.response,status:G.status,statusText:G.statusText,headers:q,config:a,request:G};gF(function(Ae){t(Ae),M()},function(Ae){s(Ae),M()},re),G=null}"onloadend"in G?G.onloadend=U:G.onreadystatechange=function(){!G||G.readyState!==4||G.status===0&&!(G.responseURL&&G.responseURL.indexOf("file:")===0)||setTimeout(U)},G.onabort=function(){G&&(s(new Fs("Request aborted",Fs.ECONNABORTED,a,G)),G=null)},G.onerror=function(){s(new Fs("Network Error",Fs.ERR_NETWORK,a,G)),G=null},G.ontimeout=function(){let ne=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const re=c.transitional||AF;c.timeoutErrorMessage&&(ne=c.timeoutErrorMessage),s(new Fs(ne,re.clarifyTimeoutError?Fs.ETIMEDOUT:Fs.ECONNABORTED,a,G)),G=null},h===void 0&&A.setContentType(null),"setRequestHeader"in G&&Qi.forEach(A.toJSON(),function(ne,re){G.setRequestHeader(re,ne)}),Qi.isUndefined(c.withCredentials)||(G.withCredentials=!!c.withCredentials),r&&r!=="json"&&(G.responseType=c.responseType),b&&([I,R]=$0(b,!0),G.addEventListener("progress",I)),y&&G.upload&&([B,E]=$0(y),G.upload.addEventListener("progress",B),G.upload.addEventListener("loadend",E)),(c.cancelToken||c.signal)&&(_=q=>{G&&(s(!q||q.type?new Cm(null,a,G):q),G.abort(),G=null)},c.cancelToken&&c.cancelToken.subscribe(_),c.signal&&(c.signal.aborted?_():c.signal.addEventListener("abort",_)));const Q=aj(c.url);if(Q&&cu.protocols.indexOf(Q)===-1){s(new Fs("Unsupported protocol "+Q+":",Fs.ERR_BAD_REQUEST,a));return}G.send(h||null)})},gj=(a,e)=>{const{length:t}=a=a?a.filter(Boolean):[];if(e||t){let s=new AbortController,c;const h=function(b){if(!c){c=!0,r();const _=b instanceof Error?b:this.reason;s.abort(_ instanceof Fs?_:new Cm(_ instanceof Error?_.message:_))}};let A=e&&setTimeout(()=>{A=null,h(new Fs(`timeout ${e} of ms exceeded`,Fs.ETIMEDOUT))},e);const r=()=>{a&&(A&&clearTimeout(A),A=null,a.forEach(b=>{b.unsubscribe?b.unsubscribe(h):b.removeEventListener("abort",h)}),a=null)};a.forEach(b=>b.addEventListener("abort",h));const{signal:y}=s;return y.unsubscribe=()=>Qi.asap(r),y}},mj=function*(a,e){let t=a.byteLength;if(t<e){yield a;return}let s=0,c;for(;s<t;)c=s+e,yield a.slice(s,c),s=c},yj=async function*(a,e){for await(const t of vj(a))yield*mj(t,e)},vj=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},n5=(a,e,t,s)=>{const c=yj(a,e);let h=0,A,r=y=>{A||(A=!0,s&&s(y))};return new ReadableStream({async pull(y){try{const{done:b,value:_}=await c.next();if(b){r(),y.close();return}let B=_.byteLength;if(t){let I=h+=B;t(I)}y.enqueue(new Uint8Array(_))}catch(b){throw r(b),b}},cancel(y){return r(y),c.return()}},{highWaterMark:2})},w_=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",vF=w_&&typeof ReadableStream=="function",_j=w_&&(typeof TextEncoder=="function"?(a=>e=>a.encode(e))(new TextEncoder):async a=>new Uint8Array(await new Response(a).arrayBuffer())),_F=(a,...e)=>{try{return!!a(...e)}catch{return!1}},xj=vF&&_F(()=>{let a=!1;const e=new Request(cu.origin,{body:new ReadableStream,method:"POST",get duplex(){return a=!0,"half"}}).headers.has("Content-Type");return a&&!e}),s5=64*1024,S1=vF&&_F(()=>Qi.isReadableStream(new Response("").body)),Z0={stream:S1&&(a=>a.body)};w_&&(a=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Z0[e]&&(Z0[e]=Qi.isFunction(a[e])?t=>t[e]():(t,s)=>{throw new Fs(`Response type '${e}' is not supported`,Fs.ERR_NOT_SUPPORT,s)})})})(new Response);const bj=async a=>{if(a==null)return 0;if(Qi.isBlob(a))return a.size;if(Qi.isSpecCompliantForm(a))return(await new Request(cu.origin,{method:"POST",body:a}).arrayBuffer()).byteLength;if(Qi.isArrayBufferView(a)||Qi.isArrayBuffer(a))return a.byteLength;if(Qi.isURLSearchParams(a)&&(a=a+""),Qi.isString(a))return(await _j(a)).byteLength},wj=async(a,e)=>{const t=Qi.toFiniteNumber(a.getContentLength());return t??bj(e)},Bj=w_&&(async a=>{let{url:e,method:t,data:s,signal:c,cancelToken:h,timeout:A,onDownloadProgress:r,onUploadProgress:y,responseType:b,headers:_,withCredentials:B="same-origin",fetchOptions:I}=yF(a);b=b?(b+"").toLowerCase():"text";let E=gj([c,h&&h.toAbortSignal()],A),R;const M=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let G;try{if(y&&xj&&t!=="get"&&t!=="head"&&(G=await wj(_,s))!==0){let re=new Request(e,{method:"POST",body:s,duplex:"half"}),pe;if(Qi.isFormData(s)&&(pe=re.headers.get("content-type"))&&_.setContentType(pe),re.body){const[Ae,le]=t5(G,$0(i5(y)));s=n5(re.body,s5,Ae,le)}}Qi.isString(B)||(B=B?"include":"omit");const U="credentials"in Request.prototype;R=new Request(e,{...I,signal:E,method:t.toUpperCase(),headers:_.normalize().toJSON(),body:s,duplex:"half",credentials:U?B:void 0});let Q=await fetch(R,I);const q=S1&&(b==="stream"||b==="response");if(S1&&(r||q&&M)){const re={};["status","statusText","headers"].forEach(be=>{re[be]=Q[be]});const pe=Qi.toFiniteNumber(Q.headers.get("content-length")),[Ae,le]=r&&t5(pe,$0(i5(r),!0))||[];Q=new Response(n5(Q.body,s5,Ae,()=>{le&&le(),M&&M()}),re)}b=b||"text";let ne=await Z0[Qi.findKey(Z0,b)||"text"](Q,a);return!q&&M&&M(),await new Promise((re,pe)=>{gF(re,pe,{data:ne,headers:ah.from(Q.headers),status:Q.status,statusText:Q.statusText,config:a,request:R})})}catch(U){throw M&&M(),U&&U.name==="TypeError"&&/Load failed|fetch/i.test(U.message)?Object.assign(new Fs("Network Error",Fs.ERR_NETWORK,a,R),{cause:U.cause||U}):Fs.from(U,U&&U.code,a,R)}}),E1={http:z6,xhr:pj,fetch:Bj};Qi.forEach(E1,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const o5=a=>`- ${a}`,Cj=a=>Qi.isFunction(a)||a===null||a===!1,xF={getAdapter:a=>{a=Qi.isArray(a)?a:[a];const{length:e}=a;let t,s;const c={};for(let h=0;h<e;h++){t=a[h];let A;if(s=t,!Cj(t)&&(s=E1[(A=String(t)).toLowerCase()],s===void 0))throw new Fs(`Unknown adapter '${A}'`);if(s)break;c[A||"#"+h]=s}if(!s){const h=Object.entries(c).map(([r,y])=>`adapter ${r} `+(y===!1?"is not supported by the environment":"is not available in the build"));let A=e?h.length>1?`since :
`+h.map(o5).join(`
`):" "+o5(h[0]):"as no adapter specified";throw new Fs("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return s},adapters:E1};function Lb(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Cm(null,a)}function a5(a){return Lb(a),a.headers=ah.from(a.headers),a.data=Fb.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),xF.getAdapter(a.adapter||Av.adapter)(a).then(function(s){return Lb(a),s.data=Fb.call(a,a.transformResponse,s),s.headers=ah.from(s.headers),s},function(s){return pF(s)||(Lb(a),s&&s.response&&(s.response.data=Fb.call(a,a.transformResponse,s.response),s.response.headers=ah.from(s.response.headers))),Promise.reject(s)})}const bF="1.10.0",B_={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{B_[a]=function(s){return typeof s===a||"a"+(e<1?"n ":" ")+a}});const l5={};B_.transitional=function(e,t,s){function c(h,A){return"[Axios v"+bF+"] Transitional option '"+h+"'"+A+(s?". "+s:"")}return(h,A,r)=>{if(e===!1)throw new Fs(c(A," has been removed"+(t?" in "+t:"")),Fs.ERR_DEPRECATED);return t&&!l5[A]&&(l5[A]=!0,console.warn(c(A," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(h,A,r):!0}};B_.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function Sj(a,e,t){if(typeof a!="object")throw new Fs("options must be an object",Fs.ERR_BAD_OPTION_VALUE);const s=Object.keys(a);let c=s.length;for(;c-- >0;){const h=s[c],A=e[h];if(A){const r=a[h],y=r===void 0||A(r,h,a);if(y!==!0)throw new Fs("option "+h+" must be "+y,Fs.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Fs("Unknown option "+h,Fs.ERR_BAD_OPTION)}}const k0={assertOptions:Sj,validators:B_},zA=k0.validators;let xg=class{constructor(e){this.defaults=e||{},this.interceptors={request:new JE,response:new JE}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const h=c.stack?c.stack.replace(/^.+\n/,""):"";try{s.stack?h&&!String(s.stack).endsWith(h.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+h):s.stack=h}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Cg(this.defaults,t);const{transitional:s,paramsSerializer:c,headers:h}=t;s!==void 0&&k0.assertOptions(s,{silentJSONParsing:zA.transitional(zA.boolean),forcedJSONParsing:zA.transitional(zA.boolean),clarifyTimeoutError:zA.transitional(zA.boolean)},!1),c!=null&&(Qi.isFunction(c)?t.paramsSerializer={serialize:c}:k0.assertOptions(c,{encode:zA.function,serialize:zA.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),k0.assertOptions(t,{baseUrl:zA.spelling("baseURL"),withXsrfToken:zA.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let A=h&&Qi.merge(h.common,h[t.method]);h&&Qi.forEach(["delete","get","head","post","put","patch","common"],R=>{delete h[R]}),t.headers=ah.concat(A,h);const r=[];let y=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(t)===!1||(y=y&&M.synchronous,r.unshift(M.fulfilled,M.rejected))});const b=[];this.interceptors.response.forEach(function(M){b.push(M.fulfilled,M.rejected)});let _,B=0,I;if(!y){const R=[a5.bind(this),void 0];for(R.unshift.apply(R,r),R.push.apply(R,b),I=R.length,_=Promise.resolve(t);B<I;)_=_.then(R[B++],R[B++]);return _}I=r.length;let E=t;for(B=0;B<I;){const R=r[B++],M=r[B++];try{E=R(E)}catch(G){M.call(this,G);break}}try{_=a5.call(this,E)}catch(R){return Promise.reject(R)}for(B=0,I=b.length;B<I;)_=_.then(b[B++],b[B++]);return _}getUri(e){e=Cg(this.defaults,e);const t=mF(e.baseURL,e.url,e.allowAbsoluteUrls);return dF(t,e.params,e.paramsSerializer)}};Qi.forEach(["delete","get","head","options"],function(e){xg.prototype[e]=function(t,s){return this.request(Cg(s||{},{method:e,url:t,data:(s||{}).data}))}});Qi.forEach(["post","put","patch"],function(e){function t(s){return function(h,A,r){return this.request(Cg(r||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:h,data:A}))}}xg.prototype[e]=t(),xg.prototype[e+"Form"]=t(!0)});let Ej=class wF{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(h){t=h});const s=this;this.promise.then(c=>{if(!s._listeners)return;let h=s._listeners.length;for(;h-- >0;)s._listeners[h](c);s._listeners=null}),this.promise.then=c=>{let h;const A=new Promise(r=>{s.subscribe(r),h=r}).then(c);return A.cancel=function(){s.unsubscribe(h)},A},e(function(h,A,r){s.reason||(s.reason=new Cm(h,A,r),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new wF(function(c){e=c}),cancel:e}}};function Ij(a){return function(t){return a.apply(null,t)}}function Tj(a){return Qi.isObject(a)&&a.isAxiosError===!0}const I1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(I1).forEach(([a,e])=>{I1[e]=a});function BF(a){const e=new xg(a),t=eF(xg.prototype.request,e);return Qi.extend(t,xg.prototype,e,{allOwnKeys:!0}),Qi.extend(t,e,null,{allOwnKeys:!0}),t.create=function(c){return BF(Cg(a,c))},t}const Ra=BF(Av);Ra.Axios=xg;Ra.CanceledError=Cm;Ra.CancelToken=Ej;Ra.isCancel=pF;Ra.VERSION=bF;Ra.toFormData=b_;Ra.AxiosError=Fs;Ra.Cancel=Ra.CanceledError;Ra.all=function(e){return Promise.all(e)};Ra.spread=Ij;Ra.isAxiosError=Tj;Ra.mergeConfig=Cg;Ra.AxiosHeaders=ah;Ra.formToJSON=a=>fF(Qi.isHTMLForm(a)?new FormData(a):a);Ra.getAdapter=xF.getAdapter;Ra.HttpStatusCode=I1;Ra.default=Ra;const{Axios:mH,AxiosError:yH,CanceledError:vH,isCancel:_H,CancelToken:xH,VERSION:bH,all:wH,Cancel:BH,isAxiosError:CH,spread:SH,toFormData:EH,AxiosHeaders:IH,HttpStatusCode:TH,formToJSON:FH,getAdapter:LH,mergeConfig:MH}=Ra,Fj={key:0,class:"modal-overlay"},Lj={class:"modal"},Mj={class:"form-group"},Pj={class:"form-group"},kj={class:"form-group"},Rj={class:"form-group"},Dj={__name:"AddMeterModal",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","meter-added"],setup(a,{emit:e}){const t=e,s=Eg({name:"",lat:null,lng:null,status:"activo"}),c=()=>{t("update:visible",!1)},h=async()=>{try{const A=await Ra.post("/api/meters",s);s.name="",s.lat=null,s.lng=null,s.status="activo",t("meter-added",A.data),c()}catch(A){console.error("Error al registrar medidor:",A),alert("Error al registrar el medidor.")}};return(A,r)=>a.visible?(yn(),Nn("div",Fj,[ot("div",Lj,[r[10]||(r[10]=ot("h3",null,"Agregar Medidor",-1)),ot("form",{onSubmit:mI(h,["prevent"])},[ot("div",Mj,[r[4]||(r[4]=ot("label",{for:"meterName"},"Nombre:",-1)),ao(ot("input",{id:"meterName","onUpdate:modelValue":r[0]||(r[0]=y=>s.name=y),required:""},null,512),[[Zl,s.name]])]),ot("div",Pj,[r[5]||(r[5]=ot("label",{for:"meterLat"},"Latitud:",-1)),ao(ot("input",{id:"meterLat",type:"number",step:"any","onUpdate:modelValue":r[1]||(r[1]=y=>s.lat=y),required:""},null,512),[[Zl,s.lat,void 0,{number:!0}]])]),ot("div",kj,[r[6]||(r[6]=ot("label",{for:"meterLng"},"Longitud:",-1)),ao(ot("input",{id:"meterLng",type:"number",step:"any","onUpdate:modelValue":r[2]||(r[2]=y=>s.lng=y),required:""},null,512),[[Zl,s.lng,void 0,{number:!0}]])]),ot("div",Rj,[r[8]||(r[8]=ot("label",{for:"meterStatus"},"Estado:",-1)),ao(ot("select",{id:"meterStatus","onUpdate:modelValue":r[3]||(r[3]=y=>s.status=y)},r[7]||(r[7]=[ot("option",{value:"activo"},"Activo",-1),ot("option",{value:"inactivo"},"Inactivo",-1)]),512),[[c_,s.status]])]),ot("div",{class:"modal-buttons"},[ot("button",{type:"button",onClick:c},"Cancelar"),r[9]||(r[9]=ot("button",{type:"submit"},"Registrar",-1))])],32)])])):ym("",!0)}},Oj=ol(Dj,[["__scopeId","data-v-930dce6d"]]);function Uj(){const a=sr("visualizer"),e=sr(null),t=async()=>{try{const s=await Ra.get("/api/auth/me");e.value=s.data,a.value=s.data.role}catch(s){console.error("Error fetching user info:",s),a.value="visualizer"}};return Ff(()=>{t()}),{role:a,user:e}}const zj={class:"fleet-container"},Nj={class:"map-wrapper"},jj={__name:"Fleet",setup(a){const{role:e}=Uj(),t=sr([{id:1,name:"Medidor A",lat:13.715,lng:-89.2,status:"activo"},{id:2,name:"Planta B",lat:13.73,lng:-89.18,status:"inactivo"},{id:3,name:"Nodo C",lat:13.71,lng:-89.25,status:"activo"}]),s=sr(!0),c=sr(!1),h=()=>{c.value=!0},A=r=>{t.value.push(r)};return(r,y)=>(yn(),Nn("div",zj,[Pn(YN,{meters:t.value,role:Po(e),open:s.value,onAddMeter:h},null,8,["meters","role","open"]),ot("div",Nj,[Pn(JN,{meters:t.value,role:Po(e)},null,8,["meters","role"])]),Pn(Oj,{visible:c.value,"onUpdate:visible":y[0]||(y[0]=b=>c.value=b),onMeterAdded:A},null,8,["visible"])]))}},Hj=ol(jj,[["__scopeId","data-v-3cb534db"]]),Qj={class:"meter-detail"},Vj={key:0,class:"error"},Gj={key:1},Wj={key:2,class:"details"},Xj={class:"chart-container"},Yj={__name:"MeterDetail",setup(a){const t=jR().params.id,s=sr(null),c=sr(!0),h=sr(null),A=sr([]),r=sr({chart:{id:"energy-chart",toolbar:{show:!0}},xaxis:{type:"datetime",title:{text:"Fecha/Hora"}},yaxis:{title:{text:"Consumo (kWh)"}},stroke:{curve:"smooth"},tooltip:{x:{format:"dd MMM yyyy HH:mm"}}}),y=async()=>{try{const _=await Ra.get(`/api/meters/${t}`);s.value=_.data}catch(_){h.value="Error obteniendo los detalles del medidor.",console.error(_)}},b=async()=>{try{const I=(await Ra.get(`/api/meters/${t}/chart-data`)).data.map(E=>[E.timestamp,E.consumption]);A.value=[{name:"Consumo Energético",data:I}]}catch(_){h.value="Error obteniendo los datos del gráfico.",console.error(_)}};return Ff(async()=>{await y(),await b(),c.value=!1}),(_,B)=>{var E;const I=nv("apexchart");return yn(),Nn("div",Qj,[ot("h2",null,"Detalle del Medidor - "+Hn((E=s.value)==null?void 0:E.name),1),h.value?(yn(),Nn("div",Vj,Hn(h.value),1)):c.value?(yn(),Nn("div",Gj," Cargando datos... ")):(yn(),Nn("div",Wj,[ot("p",null,[B[0]||(B[0]=ot("strong",null,"Estado:",-1)),xp(" "+Hn(s.value.status),1)]),ot("p",null,[B[1]||(B[1]=ot("strong",null,"Ubicación:",-1)),xp(" "+Hn(s.value.location),1)]),ot("div",Xj,[Pn(I,{type:"line",height:"350",options:r.value,series:A.value},null,8,["options","series"])])]))])}}},Kj=ol(Yj,[["__scopeId","data-v-fb84eaf3"]]),qj=[{path:"/",redirect:"/inicio"},{path:"/inicio",name:"inicio",component:()=>Qy(()=>import("./Inicio-CZMki-St.js"),[],import.meta.url)},{path:"/tiempo-real",name:"tiempo-real",component:MO,meta:{requiresAuth:!0}},{path:"/dashboard",name:"dashboard",component:PO,meta:{requiresAuth:!0}},{path:"/reportes",name:"reportes",component:OO,meta:{requiresAuth:!0}},{path:"/configuracion",name:"configuracion",component:NO,meta:{requiresAuth:!0}},{path:"/consumo",name:"consumo",component:QN,meta:{requiresAuth:!0}},{path:"/historicos/tendencias",name:"tendencias",component:vU,meta:{requiresAuth:!0}},{path:"/historicos/estadisticas",name:"estadisticas",component:Jz,meta:{requiresAuth:!0}},{path:"/historicos/factor-carga",name:"factor-carga",component:aN,meta:{requiresAuth:!0}},{path:"/historicos/anomalias",name:"anomalias",component:UU,meta:{requiresAuth:!0}},{path:"/historicos/patrones",name:"patrones",component:mN,meta:{requiresAuth:!0}},{path:"/fleet",name:"fleet",component:Hj,meta:{requiresAuth:!0}},{path:"/meter/:id",name:"MeterDetail",component:Kj,props:!0,meta:{requiresAuth:!0}},{path:"/map",name:"map",component:()=>Qy(()=>import("./MapaLeaflet-UI5wU5Fl.js"),[],import.meta.url),meta:{requiresAuth:!0}}],CF=UR({history:AR(),routes:qj});CF.beforeEach((a,e,t)=>{const s=bI();if(a.meta.requiresAuth&&!s.isAuthenticated){t({name:"inicio"});return}t()});const C_=r4(k4),$j=o4();C_.use($j);C_.use(CF);C_.mount("#app");C_.component("ApexChart",Ea);export{Al as F,ol as _,Po as a,ot as b,Nn as c,d4 as d,ym as e,ao as f,$d as g,Pn as h,ng as i,nv as j,NR as k,yn as l,xp as m,Ep as n,Ff as o,Z1 as p,h0 as q,sr as r,Wo as s,Hn as t,bI as u,Zl as v,mI as w};
